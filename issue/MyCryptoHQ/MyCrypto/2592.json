{
  "url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/2592",
  "repository_url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto",
  "labels_url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/2592/labels{/name}",
  "comments_url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/2592/comments",
  "events_url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/2592/events",
  "html_url": "https://github.com/MyCryptoHQ/MyCrypto/issues/2592",
  "id": 449038917,
  "node_id": "MDU6SXNzdWU0NDkwMzg5MTc=",
  "number": 2592,
  "title": "Broken input \"Data\" field in section \"View & Send > Send Ether & Tokens\" of MyCrypto Desktop Application v1.6.6",
  "user": {
    "login": "ltfschoen",
    "id": 6226175,
    "node_id": "MDQ6VXNlcjYyMjYxNzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6226175?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ltfschoen",
    "html_url": "https://github.com/ltfschoen",
    "followers_url": "https://api.github.com/users/ltfschoen/followers",
    "following_url": "https://api.github.com/users/ltfschoen/following{/other_user}",
    "gists_url": "https://api.github.com/users/ltfschoen/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ltfschoen/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ltfschoen/subscriptions",
    "organizations_url": "https://api.github.com/users/ltfschoen/orgs",
    "repos_url": "https://api.github.com/users/ltfschoen/repos",
    "events_url": "https://api.github.com/users/ltfschoen/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ltfschoen/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2208577035,
      "node_id": "MDU6TGFiZWwyMjA4NTc3MDM1",
      "url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/labels/wontfix",
      "name": "wontfix",
      "color": "ffffff",
      "default": true,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2019-05-28T02:39:28Z",
  "updated_at": "2020-08-11T01:09:25Z",
  "closed_at": "2020-07-23T14:53:49Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "*Github issues are primarily for reporting bugs or getting assistance with development-related items. If you have a question or need support with our product, please email support@mycrypto.com for faster attention.*\r\n\r\n*If you are reporting an issue, please use the template below so we can reproduce, determine the cause of the issue, and fix it! If you are not reporting an issue, delete this entire thing and type away. Thanks!*\r\n\r\n---\r\n\r\n\r\n### Description of Issue\r\n\r\nMyCrypto Desktop Application's \"Data\" field is broken, because when I go to the section \"View & Send\", unlock a sender account, choose \"Send Ether & Tokens\" from the selection box, then enter a valid \"To Address\", 0 ETH for the \"Amount\", and a specific hex value like `0x012345123451234512345123451234512345123451234512` for the \"Data\" field (Input Data) to send, and then click the \"Send Transaction\" button it opens a popup called \"Confirm Transaction\" but when I click the \"Details\" button in the popup it shows a \"Raw Transaction\" heading where the value of the \"data\" key hasn't been populated with the value\r\nthat I'd just entered as the value of the \"Data\" field.\r\n\r\nIt shows:\r\n```\r\n{\r\n  \"value\": \"0x0\",\r\n  \"data\": \"0x\",\r\n  ...\r\n}\r\n```\r\n\r\nInstead of showing\r\n```\r\n{\r\n  \"value\": \"0x0\",\r\n  \"data\": \"0x012345123451234512345123451234512345123451234512\",\r\n  ...\r\n}\r\n```\r\n\r\n### What exactly were you doing when you encountered this issue?\r\n\r\nI am using Debian 9 (Linux).\r\nI downloaded MyCrypto Desktop file linux-x86-64_1.6.6_MyCrypto.AppImage.\r\nI validated the SHA256 checksum of the downloaded file.\r\nI make the file executable by running `chmod u+x linux-x86-64_1.6.6_MyCrypto.AppImage`.\r\nI double clicked the icon of the file to run the MyCrypto Desktop app\r\nI clicked \"View & Send\" to navigate to \"MyCrypto > View & Send\"\r\nI then chose and unlocked the account I wanted to use to send the transaction.\r\nI then chose \"Send Ether & Tokens\" from the selection box.\r\nI then entered another valid Ethereum mainnet address for the value of the \"To Address\".\r\nI then entered 0 ETH for the \"Amount\".\r\nI then clicked the \"Advanced\" button and it revealed the \"Data\" field.\r\nI then entered a value in the the \"Data\" field (e.g. `0x012345123451234512345123451234512345123451234512`).\r\nI then clicked the \"Send Transaction\" button and it opened a popup called \"Confirm Transaction\" where I could confirm the transaction.\r\nI then clicked the \"Details\" button in the popup and under the \"Raw Transaction\" heading\r\nit showed that the value of the \"data\" key hadn't been populated with the value\r\nthat I'd just entered as the value of the \"Data\" field.\r\n```\r\n{\r\n  \"value\": \"0x0\",\r\n  \"data\": \"0x\",\r\n  ...\r\n  \"chainId\": 1\r\n}\r\n```\r\nI then sent the transaction and after it was mined successfully I went to inspect the transaction at etherscan.io, and found that the value of the transaction's \"Input Data\" was empty. \r\n\r\n### How were you accessing your wallet?\r\n\r\nKeystore File\r\n\r\n### Description of Your Machine\r\n\r\n- Browser: Chrome\r\n- Browser version: Version 73.0.3683.86 (Official Build) (64-bit)\r\n- Operating system: Debian 9\r\n- Device: N/A\r\n- MyCrypto.com vs Desktop Application? MyCrypto Desktop Application\r\n- MyCrypto Version Number: v1.6.6\r\n\r\n### Console Logs / Screenshots\r\n\r\nN/A",
  "closed_by": {
    "login": "stale[bot]",
    "id": 26384082,
    "node_id": "MDM6Qm90MjYzODQwODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/stale%5Bbot%5D",
    "html_url": "https://github.com/apps/stale",
    "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/2592/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/2592/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/comments/496432227",
    "html_url": "https://github.com/MyCryptoHQ/MyCrypto/issues/2592#issuecomment-496432227",
    "issue_url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/2592",
    "id": 496432227,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NjQzMjIyNw==",
    "user": {
      "login": "ltfschoen",
      "id": 6226175,
      "node_id": "MDQ6VXNlcjYyMjYxNzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6226175?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ltfschoen",
      "html_url": "https://github.com/ltfschoen",
      "followers_url": "https://api.github.com/users/ltfschoen/followers",
      "following_url": "https://api.github.com/users/ltfschoen/following{/other_user}",
      "gists_url": "https://api.github.com/users/ltfschoen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ltfschoen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ltfschoen/subscriptions",
      "organizations_url": "https://api.github.com/users/ltfschoen/orgs",
      "repos_url": "https://api.github.com/users/ltfschoen/repos",
      "events_url": "https://api.github.com/users/ltfschoen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ltfschoen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-28T09:09:17Z",
    "updated_at": "2019-05-28T09:53:30Z",
    "author_association": "NONE",
    "body": "When the user enters a value in the \"Data\" field, it calls [`isValid`](https://github.com/MyCryptoHQ/MyCrypto/blob/develop/common/components/DataField.tsx#L15) to check if the field is valid or not. The \"Data\" field is valid if it's an empty string (user hasn't entered a value for it at all) or if the user has entered a non-empty string, it checks if value as an argument to `isHexString(RAW_INPUT_DATA_STRING)` (from the 'ethereumjs-util' library) returns `true`, [as shown here](https://github.com/MyCryptoHQ/MyCrypto/blob/develop/common/components/DataFieldFactory/DataInputFactory.tsx#L37)\r\n\r\nBut it if you [look at that function in the 'ethereumjs-util' library](https://github.com/ethjs/ethjs-util/blob/master/dist/ethjs-util.js#L2104), and you try matching a hex address like `0x0123456789ABCDEFABCDEFABCDEFabcdefabcdefabcdefab` (which contains only 0-9, A-F, and a-f, with that Regular Expression `!value.match(/^0x[0-9A-Fa-f]*$/)`, it returns false. But if you remove the trailing `$` from the regex then it returns true as expected (e.g. https://regexr.com/4eq2s).\r\n\r\nBut doing it this was without the `$`, then if the hex value contains a non-hex characters (i.e. G-Z or g-z), it still returns `true` if it finds are valid hex characters on the left of the non-hex characters.\r\n\r\nIs `isHexString` incorrect? Do we need to raise an issue in the  'ethereumjs-util' repository?\r\nShould we be using `isHexString` from 'ethereumjs-util' with MyCrypto? Or am I using it incorrectly?\r\n\r\nWhat is the purpose of this part of the `isHexString` function?\r\n```\r\nif (length && value.length !== 2 + 2 * length) {\r\n  return false;\r\n}\r\n```\r\n\r\nBased on the signature of the `isHexString` function, I'd write it's body something like the following, instead of the way it has been written in 'ethereumjs-util' :\r\n```\r\nfunction isHexString(value, length) {\r\n  if (typeof value !== 'string') {\r\n    return false;\r\n  }\r\n\r\n  // Check for hex prefix\r\n  if (value.substring(0, 2) !== '0x') {\r\n    return false;\r\n  }\r\n\r\n  // Extract hex value without the 0x prefix\r\n  const postfixValue = value.slice(2);\r\n  if (!postfixValue.length) {\r\n    console.log(\"No characters found after 0x prefix\");\r\n    return false;\r\n  }\r\n  \r\n  // Check if non-hex character exists after 0x prefix\r\n  const match = /[^0-9A-Fa-f]/.exec(postfixValue);\r\n  if (match) {\r\n    console.log(\"Non-hex character match found at \" + match.index);\r\n    return false;\r\n  }\r\n\r\n  // Check if the hex string is the expected length\r\n  if (length && postfixValue.length !== length) {\r\n    console.log(`Hex value length is ${postfixValue.length} but should be ${length}`);\r\n    return false;\r\n  }\r\n\r\n  return true;\r\n}\r\n\r\nconsole.log(isHexString('0x0123456789ABCDEFABCDEFABCDEFabcdefabcdefabcdefab', 48));\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/comments/496432227/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/comments/628955679",
    "html_url": "https://github.com/MyCryptoHQ/MyCrypto/issues/2592#issuecomment-628955679",
    "issue_url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/2592",
    "id": 628955679,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyODk1NTY3OQ==",
    "user": {
      "login": "ltfschoen",
      "id": 6226175,
      "node_id": "MDQ6VXNlcjYyMjYxNzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6226175?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ltfschoen",
      "html_url": "https://github.com/ltfschoen",
      "followers_url": "https://api.github.com/users/ltfschoen/followers",
      "following_url": "https://api.github.com/users/ltfschoen/following{/other_user}",
      "gists_url": "https://api.github.com/users/ltfschoen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ltfschoen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ltfschoen/subscriptions",
      "organizations_url": "https://api.github.com/users/ltfschoen/orgs",
      "repos_url": "https://api.github.com/users/ltfschoen/repos",
      "events_url": "https://api.github.com/users/ltfschoen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ltfschoen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-15T00:27:43Z",
    "updated_at": "2020-05-15T00:27:43Z",
    "author_association": "NONE",
    "body": "Note that at \"View & Send\" if you enter a \"data\" value of 0x123 and click \"Send Transaction\", it opens the \"Confirm Transaction\" window, where if you click \"Details\" and choose \"Raw Transaction\", it then shows that this value is changed to a \"data\" value of 0x0123 (i.e. it added an extra '0')",
    "reactions": {
      "url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/comments/628955679/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/comments/659435369",
    "html_url": "https://github.com/MyCryptoHQ/MyCrypto/issues/2592#issuecomment-659435369",
    "issue_url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/2592",
    "id": 659435369,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1OTQzNTM2OQ==",
    "user": {
      "login": "stale[bot]",
      "id": 26384082,
      "node_id": "MDM6Qm90MjYzODQwODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stale%5Bbot%5D",
      "html_url": "https://github.com/apps/stale",
      "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2020-07-16T14:05:50Z",
    "updated_at": "2020-07-16T14:05:50Z",
    "author_association": "NONE",
    "body": "This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you for your contributions.\n",
    "reactions": {
      "url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/comments/659435369/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/comments/671666339",
    "html_url": "https://github.com/MyCryptoHQ/MyCrypto/issues/2592#issuecomment-671666339",
    "issue_url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/2592",
    "id": 671666339,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTY2NjMzOQ==",
    "user": {
      "login": "mwbailey",
      "id": 98658,
      "node_id": "MDQ6VXNlcjk4NjU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/98658?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mwbailey",
      "html_url": "https://github.com/mwbailey",
      "followers_url": "https://api.github.com/users/mwbailey/followers",
      "following_url": "https://api.github.com/users/mwbailey/following{/other_user}",
      "gists_url": "https://api.github.com/users/mwbailey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mwbailey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mwbailey/subscriptions",
      "organizations_url": "https://api.github.com/users/mwbailey/orgs",
      "repos_url": "https://api.github.com/users/mwbailey/repos",
      "events_url": "https://api.github.com/users/mwbailey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mwbailey/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-11T01:09:25Z",
    "updated_at": "2020-08-11T01:09:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @ltfschoen,\r\n\r\nIs it possible you're inadvertently adding an extra space (or control character) at the end of the data field input? That's the only way I can reproduce the error.\r\n\r\nIt looks like the newer [beta version](https://beta.mycrypto.com) of MyCrypto handles this case better. The user is informed of the invalid hex string before they can hit 'Send' instead of silently omitting the data from the transaction.\r\n\r\n> But it if you look at that function in the 'ethereumjs-util' library, and you try matching a hex address like 0x0123456789ABCDEFABCDEFABCDEFabcdefabcdefabcdefab (which contains only 0-9, A-F, and a-f, with that Regular Expression !value.match(/^0x[0-9A-Fa-f]*$/), it returns false. But if you remove the trailing $ from the regex then it returns true as expected (e.g. https://regexr.com/4eq2s).\r\n\r\nThat should definitely return true (and does for me). If removing the trailing '$' changes the return value from false to true, that would be consistent with a space character at the end.\r\n\r\n> What is the purpose of this part of the `isHexString` function?\r\n> \r\n> ```\r\n> if (length && value.length !== 2 + 2 * length) {\r\n>   return false;\r\n> }\r\n> ```\r\n\r\nThe `length` parameter of `isHexString()` refers to the length in bytes. Since one byte is represented by two hex characters, the length of the hex string after the '0x' should be twice the number of bytes.\r\n\r\n> Note that at \"View & Send\" if you enter a \"data\" value of 0x123 and click \"Send Transaction\", it opens the \"Confirm Transaction\" window, where if you click \"Details\" and choose \"Raw Transaction\", it then shows that this value is changed to a \"data\" value of 0x0123 (i.e. it added an extra '0')\r\n\r\nSince each byte of data is derived from two hex characters, the hex string length needs to be even. Odd-length hex strings are padded with '0' to make it even.",
    "reactions": {
      "url": "https://api.github.com/repos/MyCryptoHQ/MyCrypto/issues/comments/671666339/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
