{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/5758",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/5758/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/5758/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/5758/events",
  "html_url": "https://github.com/ethereum/solidity/issues/5758",
  "id": 396666942,
  "node_id": "MDU6SXNzdWUzOTY2NjY5NDI=",
  "number": 5758,
  "title": "Outputting of ast and bytecode is inconsistent",
  "user": {
    "login": "WyseNynja",
    "id": 624221,
    "node_id": "MDQ6VXNlcjYyNDIyMQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/624221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/WyseNynja",
    "html_url": "https://github.com/WyseNynja",
    "followers_url": "https://api.github.com/users/WyseNynja/followers",
    "following_url": "https://api.github.com/users/WyseNynja/following{/other_user}",
    "gists_url": "https://api.github.com/users/WyseNynja/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/WyseNynja/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/WyseNynja/subscriptions",
    "organizations_url": "https://api.github.com/users/WyseNynja/orgs",
    "repos_url": "https://api.github.com/users/WyseNynja/repos",
    "events_url": "https://api.github.com/users/WyseNynja/events{/privacy}",
    "received_events_url": "https://api.github.com/users/WyseNynja/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2019-01-07T22:00:13Z",
  "updated_at": "2019-01-08T21:43:01Z",
  "closed_at": "2019-01-08T21:43:01Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I am using solc to compile some external contracts and then pass these files to truffle for my repo in an external compile step.\r\n\r\nI have it working, but it requires some workarounds that I don't think should be necessary. Truffle requires both the abi and the bytecode.\r\n\r\n```\r\n$ solc-0.5.2 --help\r\n...\r\nOutput Components:\r\n  --ast                AST of all source files.\r\n  --ast-json           AST of all source files in JSON format.\r\n  --ast-compact-json   AST of all source files in a compact JSON format.\r\n  --asm                EVM assembly of the contracts.\r\n  --asm-json           EVM assembly of the contracts in JSON format.\r\n  --opcodes            Opcodes of the contracts.\r\n  --bin                Binary of the contracts in hex.\r\n  --bin-runtime        Binary of the runtime part of the contracts in hex.\r\n  --abi                ABI specification of the contracts.\r\n  --hashes             Function signature hashes of the contracts.\r\n  --userdoc            Natspec user documentation of all contracts.\r\n  --devdoc             Natspec developer documentation of all contracts.\r\n  --metadata           Combined Metadata JSON whose Swarm hash is stored \r\n                       on-chain.\r\n```\r\n\r\nThere is no `--bytecode` flag, so I had to switch to using `--standard-json` which allows outputing \"evm.bytecode.object\": (More detail on how I did this at https://github.com/trufflesuite/truffle/issues/1607)\r\n\r\nBut I just ran into another problem; the json output doesn't have an `ast` section at all. I've tried setting outputSelection to `[\"*\"]`, `[\"abi\", \"ast\", \"evm\"]`, `[\"abi\", \"legacyAST\", \"evm\"]` and a few other combinations, but none of them included the ast.\r\n\r\nFor now I'm compiling twice. Once with `--ast-json` to get the ast, and once with `--standard-json` to get the bytecode (which I have to prepend with \"0x\"). Let me know if I should open this as a seperate issue.\r\n\r\nThis whole process seems more complicated than it should be. What am I missing?\r\n\r\n## Specification\r\n\r\n1. Add `--bytecode` flag to solc that outputs the evm.bytecode.object. I'm not sure if it should be prefixed with 0x or not. Truffle expects the prefix and expects no new-lines.\r\n2. Fix `ast` missing from JSON output",
  "closed_by": {
    "login": "WyseNynja",
    "id": 624221,
    "node_id": "MDQ6VXNlcjYyNDIyMQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/624221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/WyseNynja",
    "html_url": "https://github.com/WyseNynja",
    "followers_url": "https://api.github.com/users/WyseNynja/followers",
    "following_url": "https://api.github.com/users/WyseNynja/following{/other_user}",
    "gists_url": "https://api.github.com/users/WyseNynja/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/WyseNynja/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/WyseNynja/subscriptions",
    "organizations_url": "https://api.github.com/users/WyseNynja/orgs",
    "repos_url": "https://api.github.com/users/WyseNynja/repos",
    "events_url": "https://api.github.com/users/WyseNynja/events{/privacy}",
    "received_events_url": "https://api.github.com/users/WyseNynja/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/5758/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/5758/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/452116450",
    "html_url": "https://github.com/ethereum/solidity/issues/5758#issuecomment-452116450",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5758",
    "id": 452116450,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MjExNjQ1MA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-07T23:15:10Z",
    "updated_at": "2019-01-07T23:15:10Z",
    "author_association": "MEMBER",
    "body": "You need an output selector of `\"\"` for the ast.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/452116450/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/452116600",
    "html_url": "https://github.com/ethereum/solidity/issues/5758#issuecomment-452116600",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5758",
    "id": 452116600,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MjExNjYwMA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-07T23:15:41Z",
    "updated_at": "2019-01-07T23:15:41Z",
    "author_association": "MEMBER",
    "body": "Also, the ``--bytecode`` flag you are looking for is called ``--bin``.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/452116600/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/452151828",
    "html_url": "https://github.com/ethereum/solidity/issues/5758#issuecomment-452151828",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5758",
    "id": 452151828,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MjE1MTgyOA==",
    "user": {
      "login": "WyseNynja",
      "id": 624221,
      "node_id": "MDQ6VXNlcjYyNDIyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/624221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WyseNynja",
      "html_url": "https://github.com/WyseNynja",
      "followers_url": "https://api.github.com/users/WyseNynja/followers",
      "following_url": "https://api.github.com/users/WyseNynja/following{/other_user}",
      "gists_url": "https://api.github.com/users/WyseNynja/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WyseNynja/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WyseNynja/subscriptions",
      "organizations_url": "https://api.github.com/users/WyseNynja/orgs",
      "repos_url": "https://api.github.com/users/WyseNynja/repos",
      "events_url": "https://api.github.com/users/WyseNynja/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WyseNynja/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-08T02:22:26Z",
    "updated_at": "2019-01-08T02:25:33Z",
    "author_association": "NONE",
    "body": "When I use `--bin` the file I get is different than the output in bytecode. I can share the diff if that would be helpful.\r\n\r\nWhen I deployed the --bin output, I got an error about being out of gas. Although now that I think about it, I might have forgotten to prefix with \"0x\"",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/452151828/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/452153355",
    "html_url": "https://github.com/ethereum/solidity/issues/5758#issuecomment-452153355",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5758",
    "id": 452153355,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MjE1MzM1NQ==",
    "user": {
      "login": "WyseNynja",
      "id": 624221,
      "node_id": "MDQ6VXNlcjYyNDIyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/624221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WyseNynja",
      "html_url": "https://github.com/WyseNynja",
      "followers_url": "https://api.github.com/users/WyseNynja/followers",
      "following_url": "https://api.github.com/users/WyseNynja/following{/other_user}",
      "gists_url": "https://api.github.com/users/WyseNynja/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WyseNynja/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WyseNynja/subscriptions",
      "organizations_url": "https://api.github.com/users/WyseNynja/orgs",
      "repos_url": "https://api.github.com/users/WyseNynja/repos",
      "events_url": "https://api.github.com/users/WyseNynja/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WyseNynja/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-08T02:30:51Z",
    "updated_at": "2019-01-08T02:30:51Z",
    "author_association": "NONE",
    "body": "Oh. I think the output is different because the optimizer runs are different!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/452153355/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/452157278",
    "html_url": "https://github.com/ethereum/solidity/issues/5758#issuecomment-452157278",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5758",
    "id": 452157278,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MjE1NzI3OA==",
    "user": {
      "login": "WyseNynja",
      "id": 624221,
      "node_id": "MDQ6VXNlcjYyNDIyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/624221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WyseNynja",
      "html_url": "https://github.com/WyseNynja",
      "followers_url": "https://api.github.com/users/WyseNynja/followers",
      "following_url": "https://api.github.com/users/WyseNynja/following{/other_user}",
      "gists_url": "https://api.github.com/users/WyseNynja/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WyseNynja/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WyseNynja/subscriptions",
      "organizations_url": "https://api.github.com/users/WyseNynja/orgs",
      "repos_url": "https://api.github.com/users/WyseNynja/repos",
      "events_url": "https://api.github.com/users/WyseNynja/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WyseNynja/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-08T02:53:16Z",
    "updated_at": "2019-01-08T02:53:16Z",
    "author_association": "NONE",
    "body": "Prefixing the output of --bin with \"0x\" made truffle happy. I'll open an issue with them.\r\n\r\nCan you explain why an empty looking selector enables the ast? Is that intentional? It should probably be documented since the docs make it look like \"ast\" will work.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/452157278/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/452256828",
    "html_url": "https://github.com/ethereum/solidity/issues/5758#issuecomment-452256828",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5758",
    "id": 452256828,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MjI1NjgyOA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-08T10:51:37Z",
    "updated_at": "2019-01-08T10:51:37Z",
    "author_association": "MEMBER",
    "body": "We recently clarified that in the documentation: https://solidity.readthedocs.io/en/develop/using-the-compiler.html#input-description\r\n\r\nThe reason is that the AST is associated with a source file and not a contract within the source file, so you use `\"fileName\": { \"\": [\"ast\"]}`.\r\n\r\nPlease tell me if the explanation in the documentation is still insufficient.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/452256828/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/452371369",
    "html_url": "https://github.com/ethereum/solidity/issues/5758#issuecomment-452371369",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5758",
    "id": 452371369,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MjM3MTM2OQ==",
    "user": {
      "login": "WyseNynja",
      "id": 624221,
      "node_id": "MDQ6VXNlcjYyNDIyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/624221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WyseNynja",
      "html_url": "https://github.com/WyseNynja",
      "followers_url": "https://api.github.com/users/WyseNynja/followers",
      "following_url": "https://api.github.com/users/WyseNynja/following{/other_user}",
      "gists_url": "https://api.github.com/users/WyseNynja/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WyseNynja/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WyseNynja/subscriptions",
      "organizations_url": "https://api.github.com/users/WyseNynja/orgs",
      "repos_url": "https://api.github.com/users/WyseNynja/repos",
      "events_url": "https://api.github.com/users/WyseNynja/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WyseNynja/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-08T16:54:06Z",
    "updated_at": "2019-01-08T16:54:06Z",
    "author_association": "NONE",
    "body": "Aha. That explains my confusion. I was reading the docs for 0.4.25 to match the compiler I was using and so the docs still had the old information about the AST. \n\n\n> On Jan 8, 2019, at 2:51 AM, chriseth <notifications@github.com> wrote:\n> \n> We recently clarified that in the documentation: https://solidity.readthedocs.io/en/develop/using-the-compiler.html#input-description\n> \n> The reason is that the AST is associated with a source file and not a contract within the source file, so you use \"fileName\": { \"\": [\"ast\"]}.\n> \n> Please tell me if the explanation in the documentation is still insufficient.\n> \n> —\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub, or mute the thread.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/452371369/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
