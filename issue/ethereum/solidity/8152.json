{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/8152",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/8152/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/8152/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/8152/events",
  "html_url": "https://github.com/ethereum/solidity/issues/8152",
  "id": 550380874,
  "node_id": "MDU6SXNzdWU1NTAzODA4NzQ=",
  "number": 8152,
  "title": "Assignments involving mappings",
  "user": {
    "login": "dddejan",
    "id": 1482564,
    "node_id": "MDQ6VXNlcjE0ODI1NjQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1482564?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dddejan",
    "html_url": "https://github.com/dddejan",
    "followers_url": "https://api.github.com/users/dddejan/followers",
    "following_url": "https://api.github.com/users/dddejan/following{/other_user}",
    "gists_url": "https://api.github.com/users/dddejan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dddejan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dddejan/subscriptions",
    "organizations_url": "https://api.github.com/users/dddejan/orgs",
    "repos_url": "https://api.github.com/users/dddejan/repos",
    "events_url": "https://api.github.com/users/dddejan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dddejan/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2020-01-15T19:22:43Z",
  "updated_at": "2020-01-15T21:17:36Z",
  "closed_at": "2020-01-15T21:17:35Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Assignment gets complicated when the values involved include a mapping. Since mappings cannot be copied, in the context of an assignment they are either disallowed or are silently ignored when deeper inside reference types. This makes for confusing semantics that can lead to strange bugs.\r\n\r\nConsider the following example:\r\n\r\n```solidity\r\ncontract A {\r\n    struct S {\r\n        mapping(int=>int) m;\r\n    }    \r\n    S s1;\r\n    S s2;    \r\n    mapping(int=>int) m1;\r\n    mapping(int=>int) m2;    \r\n    constructor() public {\r\n        s1.m[0] = 1;\r\n        // Assignment 1: compiles OK\r\n        s2 = s1;\r\n        assert(s2.m[0] == 1); // Mapping ignored in copy so this fails\r\n        // Assignment 2: compile error\r\n        m2 = m1;\r\n    }\r\n}\r\n```\r\n\r\nAssignment 1 compiles OK, although there is a mapping within the struct S. This mapping is ignored while copying. Assignment 2 is explicitly disallowed by the compiler.\r\n\r\nThis issue is not about why mappings are not copied (this is an implementation detail), it is to to clarify the rationale for allowing the assignment at all, i.e., why not disallow all assignment that involves a mapping? Or at the very least, should the compiler warn about this behavior? Are there some Solidity coding patterns that require such assignments to be allowed (e.g., for smaller gas cost)?\r\n\r\nThe current \"ignore\" semantics make formal verification more complicated since the copying is not uniform and thus needs to be expanded manually into the logic of the verifier to ignore the mappings. ",
  "closed_by": {
    "login": "dddejan",
    "id": 1482564,
    "node_id": "MDQ6VXNlcjE0ODI1NjQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1482564?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dddejan",
    "html_url": "https://github.com/dddejan",
    "followers_url": "https://api.github.com/users/dddejan/followers",
    "following_url": "https://api.github.com/users/dddejan/following{/other_user}",
    "gists_url": "https://api.github.com/users/dddejan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dddejan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dddejan/subscriptions",
    "organizations_url": "https://api.github.com/users/dddejan/orgs",
    "repos_url": "https://api.github.com/users/dddejan/repos",
    "events_url": "https://api.github.com/users/dddejan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dddejan/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/8152/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/8152/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/574856685",
    "html_url": "https://github.com/ethereum/solidity/issues/8152#issuecomment-574856685",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/8152",
    "id": 574856685,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NDg1NjY4NQ==",
    "user": {
      "login": "leonardoalt",
      "id": 504195,
      "node_id": "MDQ6VXNlcjUwNDE5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/504195?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/leonardoalt",
      "html_url": "https://github.com/leonardoalt",
      "followers_url": "https://api.github.com/users/leonardoalt/followers",
      "following_url": "https://api.github.com/users/leonardoalt/following{/other_user}",
      "gists_url": "https://api.github.com/users/leonardoalt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/leonardoalt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leonardoalt/subscriptions",
      "organizations_url": "https://api.github.com/users/leonardoalt/orgs",
      "repos_url": "https://api.github.com/users/leonardoalt/repos",
      "events_url": "https://api.github.com/users/leonardoalt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/leonardoalt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-15T21:08:02Z",
    "updated_at": "2020-01-15T21:08:02Z",
    "author_association": "MEMBER",
    "body": "We agree with that, and will disallow such behavior in the next breaking release (0.7.0): https://github.com/ethereum/solidity/issues/7739",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/574856685/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/574860222",
    "html_url": "https://github.com/ethereum/solidity/issues/8152#issuecomment-574860222",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/8152",
    "id": 574860222,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NDg2MDIyMg==",
    "user": {
      "login": "dddejan",
      "id": 1482564,
      "node_id": "MDQ6VXNlcjE0ODI1NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1482564?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dddejan",
      "html_url": "https://github.com/dddejan",
      "followers_url": "https://api.github.com/users/dddejan/followers",
      "following_url": "https://api.github.com/users/dddejan/following{/other_user}",
      "gists_url": "https://api.github.com/users/dddejan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dddejan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dddejan/subscriptions",
      "organizations_url": "https://api.github.com/users/dddejan/orgs",
      "repos_url": "https://api.github.com/users/dddejan/repos",
      "events_url": "https://api.github.com/users/dddejan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dddejan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-15T21:17:35Z",
    "updated_at": "2020-01-15T21:17:35Z",
    "author_association": "NONE",
    "body": "Excellent! Closing this then and will comment there if I have any follow-up.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/574860222/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
