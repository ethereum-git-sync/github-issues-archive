{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/2894",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/2894/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/2894/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/2894/events",
  "html_url": "https://github.com/ethereum/solidity/issues/2894",
  "id": 257041329,
  "node_id": "MDU6SXNzdWUyNTcwNDEzMjk=",
  "number": 2894,
  "title": "Setting val to enum element 1 is the same as not being set",
  "user": {
    "login": "ramvi",
    "id": 877417,
    "node_id": "MDQ6VXNlcjg3NzQxNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/877417?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ramvi",
    "html_url": "https://github.com/ramvi",
    "followers_url": "https://api.github.com/users/ramvi/followers",
    "following_url": "https://api.github.com/users/ramvi/following{/other_user}",
    "gists_url": "https://api.github.com/users/ramvi/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ramvi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ramvi/subscriptions",
    "organizations_url": "https://api.github.com/users/ramvi/orgs",
    "repos_url": "https://api.github.com/users/ramvi/repos",
    "events_url": "https://api.github.com/users/ramvi/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ramvi/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2017-09-12T13:23:00Z",
  "updated_at": "2018-03-13T16:45:36Z",
  "closed_at": "2018-03-13T16:45:35Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "The first value of an enum is a 0, as expected.\r\nAll values on the blockchain are 0, if they're not set, as expected.\r\nBut with these two together create unexpected results. `validate` is only supposed to make changes to existing PartnerObj. This is checked by seeing if the status has been set to New. But as you know New = 0, and that means that non existing and New objects all go for the same. In other languages this would throw with a zeropointer. A fix is to add an unused PartnerStatus before the others. But maybe this should be implemented as default - maybe solidity enums should start on 1?\r\n\r\n```\r\npragma solidity ^0.4.15;\r\n\r\ncontract PartnerRegistry {\r\n\r\n    // Get contract address from name\r\n    mapping(bytes12 => PartnerObj) public partnerRegistry;\r\n\r\n    enum PartnerStatus {\r\n        New, Validated, Deleted\r\n    }\r\n\r\n    struct PartnerObj {\r\n        PartnerStatus status;\r\n    }\r\n\r\n    function validate(bytes12 identifier) {\r\n        require(partnerRegistry[identifier].status == PartnerStatus.New);\r\n        partnerRegistry[identifier].status = PartnerStatus.Validated;\r\n    }\r\n}\r\n```",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/2894/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/2894/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/328867415",
    "html_url": "https://github.com/ethereum/solidity/issues/2894#issuecomment-328867415",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/2894",
    "id": 328867415,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyODg2NzQxNQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-12T14:19:04Z",
    "updated_at": "2017-09-12T14:19:04Z",
    "author_association": "MEMBER",
    "body": "Objects in storage are not boxed, they are no objects with pointers to them, they are the actual objects. All values in a mapping exist at the point of creation of the contract. Objects in storage are not allocated.\r\n\r\nIn your case, the three possible values for the enum are `New`, `Validated` and `Deleted`. Which value would you expect `partnerRegistry[0]` to have at construction time? Note that this value has to be of type `PartnerStatus`.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/328867415/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/328980540",
    "html_url": "https://github.com/ethereum/solidity/issues/2894#issuecomment-328980540",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/2894",
    "id": 328980540,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyODk4MDU0MA==",
    "user": {
      "login": "veox",
      "id": 3036030,
      "node_id": "MDQ6VXNlcjMwMzYwMzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3036030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/veox",
      "html_url": "https://github.com/veox",
      "followers_url": "https://api.github.com/users/veox/followers",
      "following_url": "https://api.github.com/users/veox/following{/other_user}",
      "gists_url": "https://api.github.com/users/veox/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/veox/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/veox/subscriptions",
      "organizations_url": "https://api.github.com/users/veox/orgs",
      "repos_url": "https://api.github.com/users/veox/repos",
      "events_url": "https://api.github.com/users/veox/events{/privacy}",
      "received_events_url": "https://api.github.com/users/veox/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-12T20:50:37Z",
    "updated_at": "2017-09-12T20:50:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "> All values on the blockchain are 0, if they're not set, as expected.\r\n> ...\r\n> A fix is to add an unused PartnerStatus before the others. But maybe this should be implemented as default - maybe solidity enums should start on 1?\r\n\r\nWouldn't that make it counter-intuitive?..\r\n\r\nIf you think of the 0th value of an `enum` as its default (\"not set\") value, then, from the example given, `PartnerStatus.New` matches the default value.\r\n\r\nSaying that the default value is \"unused\"... Well, I find that statement questionable. In a sense, the default value _is_ the most used one. :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/328980540/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/332008309",
    "html_url": "https://github.com/ethereum/solidity/issues/2894#issuecomment-332008309",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/2894",
    "id": 332008309,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMjAwODMwOQ==",
    "user": {
      "login": "NathanZook",
      "id": 31952,
      "node_id": "MDQ6VXNlcjMxOTUy",
      "avatar_url": "https://avatars.githubusercontent.com/u/31952?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NathanZook",
      "html_url": "https://github.com/NathanZook",
      "followers_url": "https://api.github.com/users/NathanZook/followers",
      "following_url": "https://api.github.com/users/NathanZook/following{/other_user}",
      "gists_url": "https://api.github.com/users/NathanZook/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NathanZook/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NathanZook/subscriptions",
      "organizations_url": "https://api.github.com/users/NathanZook/orgs",
      "repos_url": "https://api.github.com/users/NathanZook/repos",
      "events_url": "https://api.github.com/users/NathanZook/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NathanZook/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-25T20:50:18Z",
    "updated_at": "2017-09-25T20:50:18Z",
    "author_association": "NONE",
    "body": "BTW, if you don't want the first element of your enum to be 0, just create an value that you never use: `\r\nenum Boolean {FileNotFound, False, True}`",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/332008309/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/372734794",
    "html_url": "https://github.com/ethereum/solidity/issues/2894#issuecomment-372734794",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/2894",
    "id": 372734794,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MjczNDc5NA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-13T16:45:35Z",
    "updated_at": "2018-03-13T16:45:35Z",
    "author_association": "MEMBER",
    "body": "Closing due to inactivity and since it is not clear whether this is a problem or not.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/372734794/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
