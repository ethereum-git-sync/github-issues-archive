{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/12119",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/12119/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/12119/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/12119/events",
  "html_url": "https://github.com/ethereum/solidity/issues/12119",
  "id": 1022835359,
  "node_id": "I_kwDOAm_5kc489zqf",
  "number": 12119,
  "title": "[CLI] Warn when a relative path specified on the CLI ends up being absolute in metadata",
  "user": {
    "login": "cameel",
    "id": 137030,
    "node_id": "MDQ6VXNlcjEzNzAzMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cameel",
    "html_url": "https://github.com/cameel",
    "followers_url": "https://api.github.com/users/cameel/followers",
    "following_url": "https://api.github.com/users/cameel/following{/other_user}",
    "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
    "organizations_url": "https://api.github.com/users/cameel/orgs",
    "repos_url": "https://api.github.com/users/cameel/repos",
    "events_url": "https://api.github.com/users/cameel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cameel/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3515010024,
      "node_id": "LA_kwDOAm_5kc7Rgsvo",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/good%20first%20issue%20candidate",
      "name": "good first issue candidate",
      "color": "91B44D",
      "default": false,
      "description": "Could be a \"good first issue\" but something is blocking it or it has open questions."
    },
    {
      "id": 4438006499,
      "node_id": "LA_kwDOAm_5kc8AAAABCIaa4w",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/low%20effort",
      "name": "low effort",
      "color": "ffb1fa",
      "default": false,
      "description": "There is not much implementation work to be done. The task is very easy or tiny."
    },
    {
      "id": 4438157609,
      "node_id": "LA_kwDOAm_5kc8AAAABCIjpKQ",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/low%20impact",
      "name": "low impact",
      "color": "5d71ff",
      "default": false,
      "description": "Changes are not very noticeable or potential benefits are limited."
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-10-11T15:13:02Z",
  "updated_at": "2022-09-27T00:11:48Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "## Abstract\r\nNow that we have #11408 and #11409 implemented, the compiler always normalizes source paths specified on the command line and only after that attempts to make them relative. If this is not possible, the path remains absolute but it's not apparent unless you inspect the metadata. Many users are probably not even aware of the issue due to this but would want to fix if if they were. I think that it would be helpful if the compiler warned about it.\r\n\r\n#11410 would be another solution to this problem but it's not backwards-compatible and cannot be ignored like a warning - if one is just casually using the compiler to try out something without the intention to actually deploy the contract, the paths might not matter at all.\r\n\r\n## Example\r\nIt's very easy to run into this problem:\r\n```bash\r\necho 'contract C {}' > ../test.sol\r\nsolc --metadata ../test.sol\r\n```\r\n```\r\n======= /tmp/test.sol:C =======\r\nMetadata:\r\n{\"compiler\":{\"version\":\"0.8.9+commit.e5eed63a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"/tmp/test.sol\":\"C\"},\"evmVersion\":\"london\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":false,\"runs\":200},\"remappings\":[]},\"sources\":{\"/tmp/test.sol\":{\"keccak256\":\"0xbe86d3681a198587296ad6d4a834606197e1a8f8944922c501631b04e21eeba2\",\"urls\":[\"bzz-raw://7ef32f5b5f3b1ebe447f46969c01ce0e9190d0b90241cbc228255866326be8be\",\"dweb:/ipfs/QmZRepHCmeSSTfxZvKU5KS7pebBYT4khWhTnqh6GzBFU3M\"]}},\"version\":1}\r\n```\r\n\r\nThe right way to compile such contract is to use `--base-path`:\r\n```bash\r\necho 'contract C {}' > ../test.sol\r\nsolc --metadata ../test.sol --base-path ..\r\n```\r\n```\r\n======= test.sol:C =======\r\nMetadata:\r\n{\"compiler\":{\"version\":\"0.8.9+commit.e5eed63a\"},\"language\":\"Solidity\",\"output\":{\"abi\":[],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"test.sol\":\"C\"},\"evmVersion\":\"london\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":false,\"runs\":200},\"remappings\":[]},\"sources\":{\"test.sol\":{\"keccak256\":\"0xbe86d3681a198587296ad6d4a834606197e1a8f8944922c501631b04e21eeba2\",\"urls\":[\"bzz-raw://7ef32f5b5f3b1ebe447f46969c01ce0e9190d0b90241cbc228255866326be8be\",\"dweb:/ipfs/QmZRepHCmeSSTfxZvKU5KS7pebBYT4khWhTnqh6GzBFU3M\"]}},\"version\":1}\r\n```\r\n\r\n## Specification\r\nIf the file path passed to the compiler on the CLI is not within base path (or working dir if base path is empty) or one of the include paths and the compiler cannot make it relative, it should print a warning. The warning should specify the full path and say why the path cannot be made relative. It should then suggest to use `--base-path` or `--include-paths` as a solution.\r\n\r\nThis is only needed on the CLI. Imports and source unit names specified in Standard JSON input should not be affected.\r\n\r\n## Backwards Compatibility\r\nIt's fully backward-compatible but the warning might annoy users. We could make it an info message at first and promote it to a warning in a breaking release.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/12119/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/12119/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/942260742",
    "html_url": "https://github.com/ethereum/solidity/issues/12119#issuecomment-942260742",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12119",
    "id": 942260742,
    "node_id": "IC_kwDOAm_5kc44KcIG",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-13T12:37:50Z",
    "updated_at": "2021-10-13T12:37:50Z",
    "author_association": "MEMBER",
    "body": "Decision from the call: we do not want to inconvenience people using the compiler just to try stuff out (and that's probably the most common use case of the CLI where one would not use `--base-path` or `--include-path`) so we'll make it a warning but we'll only print it if the user did not specify absolute path on the CLI. If the path was absolute to begin with, we assume that user intentionally wants it like that.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/942260742/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
