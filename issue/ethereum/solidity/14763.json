{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/14763",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/14763/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/14763/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/14763/events",
  "html_url": "https://github.com/ethereum/solidity/issues/14763",
  "id": 2060969122,
  "node_id": "I_kwDOAm_5kc561-Si",
  "number": 14763,
  "title": "solc Compiler optimization error(Optimizes the definition of equivalence to the same goal)",
  "user": {
    "login": "XiaoXiaofanzi",
    "id": 110007022,
    "node_id": "U_kgDOBo6S7g",
    "avatar_url": "https://avatars.githubusercontent.com/u/110007022?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/XiaoXiaofanzi",
    "html_url": "https://github.com/XiaoXiaofanzi",
    "followers_url": "https://api.github.com/users/XiaoXiaofanzi/followers",
    "following_url": "https://api.github.com/users/XiaoXiaofanzi/following{/other_user}",
    "gists_url": "https://api.github.com/users/XiaoXiaofanzi/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/XiaoXiaofanzi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/XiaoXiaofanzi/subscriptions",
    "organizations_url": "https://api.github.com/users/XiaoXiaofanzi/orgs",
    "repos_url": "https://api.github.com/users/XiaoXiaofanzi/repos",
    "events_url": "https://api.github.com/users/XiaoXiaofanzi/events{/privacy}",
    "received_events_url": "https://api.github.com/users/XiaoXiaofanzi/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 249074435,
      "node_id": "MDU6TGFiZWwyNDkwNzQ0MzU=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/bug%20:bug:",
      "name": "bug :bug:",
      "color": "fc1313",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-12-31T07:21:00Z",
  "updated_at": "2024-01-05T04:29:22Z",
  "closed_at": "2023-12-31T16:54:25Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!--## Prerequisites\r\n\r\n- First, many thanks for taking part in the community. We really appreciate that.\r\n- We realize there is a lot of information requested here. We ask only that you do your best to provide as much information as possible so we can better help you.\r\n- Support questions are better asked in one of the following locations:\r\n    - [Solidity chat](https://gitter.im/ethereum/solidity)\r\n    - [Stack Overflow](https://ethereum.stackexchange.com/)\r\n- Ensure the issue isn't already reported.\r\n- The issue should be reproducible with the latest solidity version; however, this isn't a hard requirement and being reproducible with an older version is sufficient.\r\n\r\n*Delete the above section and the instructions in the sections below before submitting*\r\n-->\r\n\r\n## Description\r\nThis is an example of a contract that we found to be faulty using DeSCDT. Inconsistent returns when the optimizer is disabled or enabled. open return true and Otherwise return false.\r\n<!--Please shortly describe the bug you have found, and what you expect instead.-->\r\nContract sample:\r\n\r\n\r\n\r\n\r\n\r\n\r\n    uint public a;\r\n    uint public b;\r\n\r\n    function f1() public { a;}\r\n    function f2() public { b;}\r\n    function f3() public { f1();}\r\n    function f4() public { f2();}\r\n    function f5() external returns(bool) {\r\n        return f3 == f4;\r\n    }\r\n\r\nWe also tried many variations of the contract sample, and found that whether defining functions or variables, solc compiler ignored the effect of identifiers on the contract code when the optimizer was on, only cared about the function statements, and collapsed the storage if the function statements were consistent.\r\n## Environment\r\n\r\n- Compiler version: solc 0.4.24 (In the latest 0.8.23 also exists)\r\n- Target EVM version (as per compiler settings): no\r\n- Framework/IDE (e.g. Truffle or Remix): Remix\r\n- EVM execution environment / backend / blockchain client: no\r\n- Operating system: no\r\n\r\n\r\n",
  "closed_by": {
    "login": "cameel",
    "id": 137030,
    "node_id": "MDQ6VXNlcjEzNzAzMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cameel",
    "html_url": "https://github.com/cameel",
    "followers_url": "https://api.github.com/users/cameel/followers",
    "following_url": "https://api.github.com/users/cameel/following{/other_user}",
    "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
    "organizations_url": "https://api.github.com/users/cameel/orgs",
    "repos_url": "https://api.github.com/users/cameel/repos",
    "events_url": "https://api.github.com/users/cameel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cameel/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/14763/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/14763/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1872993615",
    "html_url": "https://github.com/ethereum/solidity/issues/14763#issuecomment-1872993615",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14763",
    "id": 1872993615,
    "node_id": "IC_kwDOAm_5kc5vo51P",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-12-31T16:54:25Z",
    "updated_at": "2023-12-31T16:54:25Z",
    "author_association": "MEMBER",
    "body": "Thanks for the report! It's a real issue, but we already have one covering it (#13969), so I'm going to close this one as a duplicate.\r\n\r\nOn 0.8.x and earlier it's best to consider the result of comparisons between internal function pointers undefined (i.e. it has a consistent value, but not across compilations; do not rely on this value staying the same regardless of compiler settings or releases). The pointer type has always been (intentionally) treated as opaque in the language. The underlying value cannot be obtained without using assembly and was only indirectly exposed via this kind of comparison. Its usefulness is questionable so hopefully this pattern is pretty rare. A proper fix is breaking so it's only going to be fixed in 0.9, but we're going to start issuing a warning about this pattern soon.\r\n\r\n> solc compiler ignored the effect of identifiers on the contract code when the optimizer was on, only cared about the function statements, and collapsed the storage if the function statements were consistent.\r\n\r\nWell, the values of the storage variables are never used (statements `a;` and `b;` have no side-effects) so the optimizer is very likely to remove them and collapse the function bodies into one.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1872993615/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1877576520",
    "html_url": "https://github.com/ethereum/solidity/issues/14763#issuecomment-1877576520",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14763",
    "id": 1877576520,
    "node_id": "IC_kwDOAm_5kc5v6YtI",
    "user": {
      "login": "XiaoXiaofanzi",
      "id": 110007022,
      "node_id": "U_kgDOBo6S7g",
      "avatar_url": "https://avatars.githubusercontent.com/u/110007022?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/XiaoXiaofanzi",
      "html_url": "https://github.com/XiaoXiaofanzi",
      "followers_url": "https://api.github.com/users/XiaoXiaofanzi/followers",
      "following_url": "https://api.github.com/users/XiaoXiaofanzi/following{/other_user}",
      "gists_url": "https://api.github.com/users/XiaoXiaofanzi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/XiaoXiaofanzi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/XiaoXiaofanzi/subscriptions",
      "organizations_url": "https://api.github.com/users/XiaoXiaofanzi/orgs",
      "repos_url": "https://api.github.com/users/XiaoXiaofanzi/repos",
      "events_url": "https://api.github.com/users/XiaoXiaofanzi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/XiaoXiaofanzi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2024-01-04T18:34:15Z",
    "updated_at": "2024-01-04T18:34:15Z",
    "author_association": "NONE",
    "body": "But I ran into the same problem in a similar example below：I can understand that when f3() is executed, the local variable has been released, so the optimizer considers it consistent.\r\n\r\npragma solidity ^0.8.18;\r\n\r\ncontract Test {\r\n\r\nfunction c() public {uint a = 1;}\r\nfunction b() public {bool a = true;}\r\n\r\nfunction f3() external returns(bool) {\r\n    return c == b;\r\n}\r\n}",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1877576520/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1878107731",
    "html_url": "https://github.com/ethereum/solidity/issues/14763#issuecomment-1878107731",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14763",
    "id": 1878107731,
    "node_id": "IC_kwDOAm_5kc5v8aZT",
    "user": {
      "login": "XiaoXiaofanzi",
      "id": 110007022,
      "node_id": "U_kgDOBo6S7g",
      "avatar_url": "https://avatars.githubusercontent.com/u/110007022?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/XiaoXiaofanzi",
      "html_url": "https://github.com/XiaoXiaofanzi",
      "followers_url": "https://api.github.com/users/XiaoXiaofanzi/followers",
      "following_url": "https://api.github.com/users/XiaoXiaofanzi/following{/other_user}",
      "gists_url": "https://api.github.com/users/XiaoXiaofanzi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/XiaoXiaofanzi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/XiaoXiaofanzi/subscriptions",
      "organizations_url": "https://api.github.com/users/XiaoXiaofanzi/orgs",
      "repos_url": "https://api.github.com/users/XiaoXiaofanzi/repos",
      "events_url": "https://api.github.com/users/XiaoXiaofanzi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/XiaoXiaofanzi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2024-01-05T04:29:22Z",
    "updated_at": "2024-01-05T04:29:22Z",
    "author_association": "NONE",
    "body": "hello，I was wondering if you could still receive my comments after the issue is closed?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1878107731/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
