{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/13523",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/13523/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/13523/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/13523/events",
  "html_url": "https://github.com/ethereum/solidity/issues/13523",
  "id": 1372355622,
  "node_id": "I_kwDOAm_5kc5RzHwm",
  "number": 13523,
  "title": "assertion failed [block != nullptr]: BasicBlock requested for unrecognized address (BuilderBase.h:550 block_for_offset)",
  "user": {
    "login": "Qambar",
    "id": 207497,
    "node_id": "MDQ6VXNlcjIwNzQ5Nw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/207497?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Qambar",
    "html_url": "https://github.com/Qambar",
    "followers_url": "https://api.github.com/users/Qambar/followers",
    "following_url": "https://api.github.com/users/Qambar/following{/other_user}",
    "gists_url": "https://api.github.com/users/Qambar/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Qambar/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Qambar/subscriptions",
    "organizations_url": "https://api.github.com/users/Qambar/orgs",
    "repos_url": "https://api.github.com/users/Qambar/repos",
    "events_url": "https://api.github.com/users/Qambar/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Qambar/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2022-09-14T05:29:34Z",
  "updated_at": "2023-05-13T06:19:53Z",
  "closed_at": "2022-10-19T15:50:14Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!--## Prerequisites\r\n\r\n- First, many thanks for taking part in the community. We really appreciate that.\r\n- We realize there is a lot of information requested here. We ask only that you do your best to provide as much information as possible so we can better help you.\r\n- Support questions are better asked in one of the following locations:\r\n    - [Solidity chat](https://gitter.im/ethereum/solidity)\r\n    - [Stack Overflow](https://ethereum.stackexchange.com/)\r\n- Ensure the issue isn't already reported.\r\n- The issue should be reproducible with the latest solidity version; however, this isn't a hard requirement and being reproducible with an older version is sufficient.\r\n\r\n*Delete the above section and the instructions in the sections below before submitting*\r\n-->\r\n\r\n## Description\r\nThe compiler is crashing with the following error message:\r\n\r\n```\r\n$ yarn test\r\nyarn run v1.22.10\r\n$ npx hardhat compile; truffle test --network local\r\nSolidity 0.8.17 is not fully supported yet. You can still use Hardhat, but some features, like stack traces, might not work correctly.\r\n\r\nLearn more at https://hardhat.org/hardhat-runner/docs/reference/solidity-support\r\n\r\nNothing to compile\r\nUsing network 'local'.\r\n\r\n\r\nCompiling your contracts...\r\n===========================\r\nassertion failed [block != nullptr]: BasicBlock requested for unrecognized address\r\n(BuilderBase.h:550 block_for_offset)\r\n/bin/sh: line 1: 12129 Trace/BPT trap: 5       truffle test --network local\r\nerror Command failed with exit code 133.\r\ninfo Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.\r\n```\r\n\r\nI contacted truffle support, and they advised that it was a compiler bug and it should be reported here.\r\n\r\n\r\n<!--Please shortly describe the bug you have found and what you expect instead.-->\r\n\r\n## Environment\r\n\r\n- Compiler version:\r\nTruffle v5.4.11 (core: 5.4.11)\r\nSolidity - 0.8.17 (solc-js)\r\nNode v18.7.0\r\nWeb3.js v1.5.2\r\n\r\n- Target EVM version (as per compiler settings): 0.8.17\r\n- Framework/IDE (e.g. Truffle or Remix): 5.4.11\r\n- EVM execution environment / backend / blockchain client: ganache v7.4.1 (@ganache/cli: 0.5.1, @ganache/core: 0.5.1)\r\n- Operating system: Mac OS\r\n\r\n## Steps to Reproduce\r\n\r\nThis error is intermittent, I will record a video to demonstrate it and share it in the comments. Also, documenting the steps below\r\n\r\n1. Run truffle test \r\n```\r\n$ yarn test\r\nyarn run v1.22.10\r\n$ npx hardhat compile; truffle test --network local\r\n```\r\n2. It will compile contracts \r\n```\r\nNothing to compile\r\nUsing network 'local'.\r\n\r\n\r\nCompiling your contracts...\r\n===========================\r\nassertion failed [block != nullptr]: BasicBlock requested for unrecognized address\r\n(BuilderBase.h:550 block_for_offset)\r\n/bin/sh: line 1: 12129 Trace/BPT trap: 5       truffle test --network local\r\nerror Command failed with exit code 133.\r\n```\r\n3. Run the truffle test again and it might work \r\n```\r\n$ yarn test\r\nyarn run v1.22.10\r\n$ npx hardhat compile; truffle test --network local\r\nSolidity 0.8.17 is not fully supported yet. You can still use Hardhat, but some features, like stack traces, might not work correctly.\r\n\r\nLearn more at https://hardhat.org/hardhat-runner/docs/reference/solidity-support\r\n\r\nNothing to compile\r\nUsing network 'local'.\r\n\r\n\r\nCompiling your contracts...\r\n===========================\r\n> Compiling ./contracts/Migrations.sol\r\n> Compiling ./contracts/TheAgencyPassContract.sol\r\n> Artifacts written to /var/folders/f_/ll33dc315ldc738pbth9339m0000gp/T/test--12086-Y5KWaRC2tIAx\r\n> Compiled successfully using:\r\n   - solc: 0.8.17+commit.8df45f5f.Emscripten.clang\r\nYour contract is deployed to 0xb2139Df9e18a07AeEA394FE9B70ACDD89e6A0474\r\n\r\n\r\n  Testing contract\r\n    ✔ can run tests\r\n    ✔ contract has royalty equal to 10%\r\n    ✔ should have the max supply of 450\r\n    ✔ Should be able to mint reserved (74ms)\r\n    ✔ Should start at token id 1 (92ms)\r\n    ✔ Should be able to mint reserved 11 items (63ms)\r\n    ✔ Should not be able to mint whitelist if sale is not active  (86ms)\r\n    ✔ Should be able to mint whitelist (109ms)\r\n    ✔ Should be able to mint OG whitelist\r\n    ✔ Should be able to mint OG whitelist (124ms)\r\n    ✔ Should be not able to mint twice OG whitelist (76ms)\r\n    ✔ Should send royalty back to the contract\r\n\r\n\r\n  12 passing (5s)\r\n\r\n✨  Done in 16.35s.\r\n```\r\n\r\n\r\n\r\n<!--\r\nPlease provide a *minimal* source code example to trigger the bug you have found.\r\nPlease also mention any command line flags that are necessary for triggering the bug.\r\nProvide as much information as necessary to reproduce the bug.\r\n\r\n```solidity\r\n// Some *minimal* Solidity source code to reproduce the bug.\r\n// ...\r\n```\r\n-->\r\n",
  "closed_by": {
    "login": "cameel",
    "id": 137030,
    "node_id": "MDQ6VXNlcjEzNzAzMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cameel",
    "html_url": "https://github.com/cameel",
    "followers_url": "https://api.github.com/users/cameel/followers",
    "following_url": "https://api.github.com/users/cameel/following{/other_user}",
    "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
    "organizations_url": "https://api.github.com/users/cameel/orgs",
    "repos_url": "https://api.github.com/users/cameel/repos",
    "events_url": "https://api.github.com/users/cameel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cameel/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/13523/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/13523/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1246829201",
    "html_url": "https://github.com/ethereum/solidity/issues/13523#issuecomment-1246829201",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13523",
    "id": 1246829201,
    "node_id": "IC_kwDOAm_5kc5KURqR",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-14T14:14:01Z",
    "updated_at": "2022-09-14T14:14:40Z",
    "author_association": "MEMBER",
    "body": "Is that error really coming from the compiler? We do have a struct called [`BasicBlock`](https://github.com/ethereum/solidity/blob/v0.8.17/libyul/backends/evm/ControlFlowGraph.h#L172-L207) but no `BuilderBase.h` (it's part of the control flow graph instead).\r\n\r\nIf it's a compiler problem it should be reproducible just by running `solc` (or solc-js) on it without Truffle or Hardhat. Can you show us the input contracts? Or preferably some minimal piece of code needed to trigger this?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1246829201/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1248420226",
    "html_url": "https://github.com/ethereum/solidity/issues/13523#issuecomment-1248420226",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13523",
    "id": 1248420226,
    "node_id": "IC_kwDOAm_5kc5KaWGC",
    "user": {
      "login": "pavbro",
      "id": 28532462,
      "node_id": "MDQ6VXNlcjI4NTMyNDYy",
      "avatar_url": "https://avatars.githubusercontent.com/u/28532462?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pavbro",
      "html_url": "https://github.com/pavbro",
      "followers_url": "https://api.github.com/users/pavbro/followers",
      "following_url": "https://api.github.com/users/pavbro/following{/other_user}",
      "gists_url": "https://api.github.com/users/pavbro/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pavbro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pavbro/subscriptions",
      "organizations_url": "https://api.github.com/users/pavbro/orgs",
      "repos_url": "https://api.github.com/users/pavbro/repos",
      "events_url": "https://api.github.com/users/pavbro/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pavbro/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-15T17:51:56Z",
    "updated_at": "2022-09-15T18:01:34Z",
    "author_association": "NONE",
    "body": "Same for me:\r\n\r\nassertion failed [block != nullptr]: BasicBlock requested for unrecognized address\r\n(BuilderBase.h:550 block_for_offset)\r\n\r\nAnd also on MacOs. Same code on Ubuntu works.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1248420226/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1284130107",
    "html_url": "https://github.com/ethereum/solidity/issues/13523#issuecomment-1284130107",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13523",
    "id": 1284130107,
    "node_id": "IC_kwDOAm_5kc5MikU7",
    "user": {
      "login": "crucialfelix",
      "id": 218738,
      "node_id": "MDQ6VXNlcjIxODczOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/218738?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/crucialfelix",
      "html_url": "https://github.com/crucialfelix",
      "followers_url": "https://api.github.com/users/crucialfelix/followers",
      "following_url": "https://api.github.com/users/crucialfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/crucialfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/crucialfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/crucialfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/crucialfelix/orgs",
      "repos_url": "https://api.github.com/users/crucialfelix/repos",
      "events_url": "https://api.github.com/users/crucialfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/crucialfelix/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-19T14:43:07Z",
    "updated_at": "2022-10-19T14:43:07Z",
    "author_association": "NONE",
    "body": "This error happens running Deno scripts on macos with M1.  It's nothing to do with solidity per se.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1284130107/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1284229124",
    "html_url": "https://github.com/ethereum/solidity/issues/13523#issuecomment-1284229124",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13523",
    "id": 1284229124,
    "node_id": "IC_kwDOAm_5kc5Mi8gE",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-19T15:50:14Z",
    "updated_at": "2022-10-19T15:50:14Z",
    "author_association": "MEMBER",
    "body": "Thanks for confirming @crucialfelix.\r\n\r\nIn that case I'm going to close this.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1284229124/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1544599434",
    "html_url": "https://github.com/ethereum/solidity/issues/13523#issuecomment-1544599434",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13523",
    "id": 1544599434,
    "node_id": "IC_kwDOAm_5kc5cELeK",
    "user": {
      "login": "notVitaliy",
      "id": 3137491,
      "node_id": "MDQ6VXNlcjMxMzc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3137491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/notVitaliy",
      "html_url": "https://github.com/notVitaliy",
      "followers_url": "https://api.github.com/users/notVitaliy/followers",
      "following_url": "https://api.github.com/users/notVitaliy/following{/other_user}",
      "gists_url": "https://api.github.com/users/notVitaliy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/notVitaliy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/notVitaliy/subscriptions",
      "organizations_url": "https://api.github.com/users/notVitaliy/orgs",
      "repos_url": "https://api.github.com/users/notVitaliy/repos",
      "events_url": "https://api.github.com/users/notVitaliy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/notVitaliy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-11T20:01:31Z",
    "updated_at": "2023-05-11T20:14:28Z",
    "author_association": "NONE",
    "body": "# Solved\r\n\r\n## The issue\r\n\r\nFor those who find this and are still stuck with these intermittent errors. The issue (that I had) was that node was installed with x86 arch on an M2 Mac. The underlying issue is with Rosetta, which is used to translate between the x86 instructions to Apple silicon.\r\n\r\nI encountered this particular problem where the integrated terminal in VSCode kept using Rosetta as the default option. \r\n\r\n### You can check the arch in your terminal.\r\n\r\n```\r\n$ node -e 'console.log(process.arch)'\r\n// That will probably output x86\r\n\r\n$ arch\r\n// This will probably output i386\r\n```\r\n\r\n\r\n## Steps to solve\r\n\r\n**If you're using brew, delete node entirely and install `nvm`**\r\n\r\n* open up terminal (I use iTerm)\r\n* Run `arch` and make sure it's `arm64`\r\n* Switch to a different version of node (install it if you have to)\r\n  * `nvm install [OTHER VERSION OF NODE]`\r\n  * `nvm use [OTHER VERSION OF NODE]`\r\n* remove the previously used version of node\r\n  * `nvm uninstall [VERSION OF NODE YOU WANT]`\r\n  * `nvm install [VERSION OF NODE YOU WANT]`\r\n  * `nvm use [VERSION OF NODE YOU WANT]`\r\n  * `nvm alias default [VERSION OF NODE YOU WANT]`\r\n* open a new terminal window and check to make sure `node -v` returns the correct node version\r\n* check the output of `node -e 'console.log(process.arch)'`\r\n  * it should now be `arm64`\r\n* don't forget to `npm i -g truffle` and any other global packages you use\r\n* ????\r\n* PROFIT\r\n\r\n## Steps to solve in VSCode\r\n\r\nAdd this into your `settings.json`\r\n\r\n```\r\n  \"terminal.integrated.profiles.osx\": {\r\n    \"bash\": {\r\n      \"path\": \"arch\",\r\n      \"args\": [\"-arm64\", \"bash\", \"-l\"],\r\n      \"overrideName\": true\r\n    }\r\n  },\r\n  \"terminal.integrated.defaultProfile.osx\": \"bash\"\r\n```\r\n\r\n\r\nThanks for listening to my TED Talk \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1544599434/reactions",
      "total_count": 3,
      "+1": 1,
      "-1": 0,
      "laugh": 1,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 1,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1546541294",
    "html_url": "https://github.com/ethereum/solidity/issues/13523#issuecomment-1546541294",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13523",
    "id": 1546541294,
    "node_id": "IC_kwDOAm_5kc5cLlju",
    "user": {
      "login": "crucialfelix",
      "id": 218738,
      "node_id": "MDQ6VXNlcjIxODczOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/218738?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/crucialfelix",
      "html_url": "https://github.com/crucialfelix",
      "followers_url": "https://api.github.com/users/crucialfelix/followers",
      "following_url": "https://api.github.com/users/crucialfelix/following{/other_user}",
      "gists_url": "https://api.github.com/users/crucialfelix/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/crucialfelix/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/crucialfelix/subscriptions",
      "organizations_url": "https://api.github.com/users/crucialfelix/orgs",
      "repos_url": "https://api.github.com/users/crucialfelix/repos",
      "events_url": "https://api.github.com/users/crucialfelix/events{/privacy}",
      "received_events_url": "https://api.github.com/users/crucialfelix/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-13T06:19:53Z",
    "updated_at": "2023-05-13T06:19:53Z",
    "author_association": "NONE",
    "body": "You can also run brew commands this way:\r\n\r\n`arch -arm64 brew upgrade`",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1546541294/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
