{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/12422",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/12422/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/12422/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/12422/events",
  "html_url": "https://github.com/ethereum/solidity/issues/12422",
  "id": 1082478563,
  "node_id": "I_kwDOAm_5kc5AhU_j",
  "number": 12422,
  "title": "Parallelize macOS build in CI",
  "user": {
    "login": "cameel",
    "id": 137030,
    "node_id": "MDQ6VXNlcjEzNzAzMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cameel",
    "html_url": "https://github.com/cameel",
    "followers_url": "https://api.github.com/users/cameel/followers",
    "following_url": "https://api.github.com/users/cameel/following{/other_user}",
    "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
    "organizations_url": "https://api.github.com/users/cameel/orgs",
    "repos_url": "https://api.github.com/users/cameel/repos",
    "events_url": "https://api.github.com/users/cameel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cameel/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 437863668,
      "node_id": "MDU6TGFiZWw0Mzc4NjM2Njg=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/build%20system%20:building_construction:",
      "name": "build system :building_construction:",
      "color": "1d76db",
      "default": false,
      "description": ""
    },
    {
      "id": 682993385,
      "node_id": "MDU6TGFiZWw2ODI5OTMzODU=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/performance%20:racehorse:",
      "name": "performance :racehorse:",
      "color": "c5def5",
      "default": false,
      "description": ""
    },
    {
      "id": 717596767,
      "node_id": "MDU6TGFiZWw3MTc1OTY3Njc=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/good%20first%20issue",
      "name": "good first issue",
      "color": "006b75",
      "default": true,
      "description": ""
    },
    {
      "id": 1012614086,
      "node_id": "MDU6TGFiZWwxMDEyNjE0MDg2",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/medium%20difficulty",
      "name": "medium difficulty",
      "color": "7dcddb",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2021-12-16T17:44:31Z",
  "updated_at": "2022-01-14T22:50:05Z",
  "closed_at": "2022-01-14T22:50:05Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "In https://github.com/ethereum/solidity/issues/11670#issuecomment-954297346 I discovered that our [macOS build](https://github.com/ethereum/solidity/blob/v0.8.10/.circleci/config.yml#L673-L707) job in CI takes ~20 min regardless of how many cores the machine has. Apparently the `-j` flag we put in `MAKEFLAGS` variable is getting ignored. I think that the build config generated by CMake on macOS is still `make`-based so I'm not sure why this is the case.\r\n\r\nThis needs to be investigated. Once we know how to parallelize it, we should adjust the number of threads/processes and machine resource class in CI for the best cost/benefit ratio.",
  "closed_by": {
    "login": "ekpyron",
    "id": 1347491,
    "node_id": "MDQ6VXNlcjEzNDc0OTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ekpyron",
    "html_url": "https://github.com/ekpyron",
    "followers_url": "https://api.github.com/users/ekpyron/followers",
    "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
    "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
    "organizations_url": "https://api.github.com/users/ekpyron/orgs",
    "repos_url": "https://api.github.com/users/ekpyron/repos",
    "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ekpyron/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/12422/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/12422/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1013440753",
    "html_url": "https://github.com/ethereum/solidity/issues/12422#issuecomment-1013440753",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12422",
    "id": 1013440753,
    "node_id": "IC_kwDOAm_5kc48Z-Dx",
    "user": {
      "login": "willianpaixao",
      "id": 201236,
      "node_id": "MDQ6VXNlcjIwMTIzNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/201236?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/willianpaixao",
      "html_url": "https://github.com/willianpaixao",
      "followers_url": "https://api.github.com/users/willianpaixao/followers",
      "following_url": "https://api.github.com/users/willianpaixao/following{/other_user}",
      "gists_url": "https://api.github.com/users/willianpaixao/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/willianpaixao/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/willianpaixao/subscriptions",
      "organizations_url": "https://api.github.com/users/willianpaixao/orgs",
      "repos_url": "https://api.github.com/users/willianpaixao/repos",
      "events_url": "https://api.github.com/users/willianpaixao/events{/privacy}",
      "received_events_url": "https://api.github.com/users/willianpaixao/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-14T20:08:33Z",
    "updated_at": "2022-01-14T20:08:33Z",
    "author_association": "NONE",
    "body": "Hi @cameel, very interesting issue.\r\n\r\nFor over a decade I only saw the `-j` flag being used without a space as separator, eg, `-j4`, which raised my eyebrows. Maybe Ubuntu can understand that but MacOS can't. So I would remove the space and fire a pipeline to check.\r\n\r\nThat said, assuming this was not the problem, maybe we should try a different flag, here are the cmake equialent:\r\n\r\n- [CMAKE_BUILD_PARALLEL_LEVEL](https://cmake.org/cmake/help/latest/envvar/CMAKE_BUILD_PARALLEL_LEVEL.html#envvar:CMAKE_BUILD_PARALLEL_LEVEL)\r\n- [CMAKE_CXX_FLAGS](https://cmake.org/cmake/help/latest/variable/CMAKE_LANG_FLAGS.html#variable:CMAKE_%3CLANG%3E_FLAGS)\r\n\r\nUnfortunately I don't own a Mac that I can try it myself.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1013440753/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1013467205",
    "html_url": "https://github.com/ethereum/solidity/issues/12422#issuecomment-1013467205",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12422",
    "id": 1013467205,
    "node_id": "IC_kwDOAm_5kc48aEhF",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-14T20:54:50Z",
    "updated_at": "2022-01-14T20:54:50Z",
    "author_association": "MEMBER",
    "body": "That's a great point. Being used to the GNU tools it didn't even cross my mind but it could really be just that.\r\n\r\nHonestly, I don't own a Mac either, I'm only ever using it in CI :) If you would like to try, it's as simple as tweaking our [config.yml](https://github.com/ethereum/solidity/blob/develop/.circleci/config.yml). If you create a PR it will run with your changed config.\r\n\r\nIf you do that you should log into CircleCI though and follow the project if you can because otherwise there are some limits on external PRs. Sometimes mac/windows jobs do not run at all. If that happens, usually a branch created by one of the project members also helps to trigger it so let me know.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1013467205/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1013478923",
    "html_url": "https://github.com/ethereum/solidity/issues/12422#issuecomment-1013478923",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12422",
    "id": 1013478923,
    "node_id": "IC_kwDOAm_5kc48aHYL",
    "user": {
      "login": "willianpaixao",
      "id": 201236,
      "node_id": "MDQ6VXNlcjIwMTIzNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/201236?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/willianpaixao",
      "html_url": "https://github.com/willianpaixao",
      "followers_url": "https://api.github.com/users/willianpaixao/followers",
      "following_url": "https://api.github.com/users/willianpaixao/following{/other_user}",
      "gists_url": "https://api.github.com/users/willianpaixao/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/willianpaixao/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/willianpaixao/subscriptions",
      "organizations_url": "https://api.github.com/users/willianpaixao/orgs",
      "repos_url": "https://api.github.com/users/willianpaixao/repos",
      "events_url": "https://api.github.com/users/willianpaixao/events{/privacy}",
      "received_events_url": "https://api.github.com/users/willianpaixao/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-14T21:16:46Z",
    "updated_at": "2022-01-14T21:16:46Z",
    "author_association": "NONE",
    "body": "Well, I tried but apparently CircleCI wants some schmoney:\r\n\r\n> Apologies! Your build didn’t run because you haven’t selected a plan that includes macOS yet. Please change to a Performance Plan. If you have any questions please feel free to contact support.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1013478923/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1013483628",
    "html_url": "https://github.com/ethereum/solidity/issues/12422#issuecomment-1013483628",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12422",
    "id": 1013483628,
    "node_id": "IC_kwDOAm_5kc48aIhs",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-14T21:24:54Z",
    "updated_at": "2022-01-14T21:24:54Z",
    "author_association": "MEMBER",
    "body": "OK, that's what was afraid would happen. Well, let me try it then.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1013483628/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1013489151",
    "html_url": "https://github.com/ethereum/solidity/issues/12422#issuecomment-1013489151",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12422",
    "id": 1013489151,
    "node_id": "IC_kwDOAm_5kc48aJ3_",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-14T21:34:46Z",
    "updated_at": "2022-01-14T21:34:46Z",
    "author_association": "MEMBER",
    "body": "Here's a PR: #12536. Let's see if your theory is true :) Feel free to review.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1013489151/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
