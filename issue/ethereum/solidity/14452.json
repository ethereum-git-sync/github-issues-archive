{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/14452",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/14452/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/14452/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/14452/events",
  "html_url": "https://github.com/ethereum/solidity/issues/14452",
  "id": 1823237959,
  "node_id": "I_kwDOAm_5kc5srGdH",
  "number": 14452,
  "title": "Getting Yul ASTs requires asking for ast at contract level instead of at file level",
  "user": {
    "login": "haltman-at",
    "id": 35589221,
    "node_id": "MDQ6VXNlcjM1NTg5MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/haltman-at",
    "html_url": "https://github.com/haltman-at",
    "followers_url": "https://api.github.com/users/haltman-at/followers",
    "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
    "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
    "organizations_url": "https://api.github.com/users/haltman-at/orgs",
    "repos_url": "https://api.github.com/users/haltman-at/repos",
    "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
    "received_events_url": "https://api.github.com/users/haltman-at/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 249074435,
      "node_id": "MDU6TGFiZWwyNDkwNzQ0MzU=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/bug%20:bug:",
      "name": "bug :bug:",
      "color": "fc1313",
      "default": false,
      "description": ""
    },
    {
      "id": 4438006499,
      "node_id": "LA_kwDOAm_5kc8AAAABCIaa4w",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/low%20effort",
      "name": "low effort",
      "color": "ffb1fa",
      "default": false,
      "description": "There is not much implementation work to be done. The task is very easy or tiny."
    },
    {
      "id": 4438157609,
      "node_id": "LA_kwDOAm_5kc8AAAABCIjpKQ",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/low%20impact",
      "name": "low impact",
      "color": "5d71ff",
      "default": false,
      "description": "Changes are not very noticeable or potential benefits are limited."
    },
    {
      "id": 4438481746,
      "node_id": "LA_kwDOAm_5kc8AAAABCI3bUg",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/must%20have%20eventually",
      "name": "must have eventually",
      "color": "ffb04d",
      "default": false,
      "description": "Something we consider essential but not enough to prevent us from releasing Solidity 1.0 without it."
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-07-26T21:52:53Z",
  "updated_at": "2023-07-31T14:59:51Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nWhen compiling in Yul mode, including `\"ast\"` in the file-level output selection doesn't result in getting ASTs like it does when compiling Solidity.  Instead you have to set it at the contract level.  This makes no sense, because ASTs are a file-level matter, and is also inconsistent with how the compiler acts when compiling Solidity.\r\n\r\n## Environment\r\n\r\n- Compiler version: 0.8.21\r\n- Target EVM version (as per compiler settings): default\r\n\r\n## Steps to Reproduce\r\n\r\nReally any Yul code will do here!  What's relevant here is the output selection.  An `outputSelection` of\r\n\r\n```\r\n{\r\n  \"*\": {\r\n    \"\": [\"ast\"],\r\n    \"*\": [\r\n      \"evm.bytecode.object\"\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\nwon't get the AST,\r\n\r\nwhereas one of\r\n\r\n```\r\n\r\n{\r\n  \"*\": {\r\n    \"\": [],\r\n    \"*\": [\r\n      \"ast\",\r\n      \"evm.bytecode.object\"\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\nwill.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/14452/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/14452/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1655562901",
    "html_url": "https://github.com/ethereum/solidity/issues/14452#issuecomment-1655562901",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14452",
    "id": 1655562901,
    "node_id": "IC_kwDOAm_5kc5ireKV",
    "user": {
      "login": "r0qs",
      "id": 457348,
      "node_id": "MDQ6VXNlcjQ1NzM0OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/457348?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/r0qs",
      "html_url": "https://github.com/r0qs",
      "followers_url": "https://api.github.com/users/r0qs/followers",
      "following_url": "https://api.github.com/users/r0qs/following{/other_user}",
      "gists_url": "https://api.github.com/users/r0qs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/r0qs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/r0qs/subscriptions",
      "organizations_url": "https://api.github.com/users/r0qs/orgs",
      "repos_url": "https://api.github.com/users/r0qs/repos",
      "events_url": "https://api.github.com/users/r0qs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/r0qs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-28T12:01:56Z",
    "updated_at": "2023-07-28T12:04:36Z",
    "author_association": "MEMBER",
    "body": "Thanks @haltman-at, yeah, the Yul is generated per contract and, currently, only one Yul object can be compiled at the same time (so the ID would be always the same), whereas the solidity AST is cross contract. We may need to change that indeed and include `ast` in the file-level for Yul as well.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1655562901/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1658543050",
    "html_url": "https://github.com/ethereum/solidity/issues/14452#issuecomment-1658543050",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14452",
    "id": 1658543050,
    "node_id": "IC_kwDOAm_5kc5i21vK",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-31T14:58:29Z",
    "updated_at": "2023-07-31T14:59:37Z",
    "author_association": "MEMBER",
    "body": "Yeah, this is definitely a bug in #14177. In Yul there's always one contract per file, so you could technically associate the AST with a contract, but it's really the source unit that has an AST. The original PR confusingly made it a contract-level output so [I pointed it out back then and it was changed](https://github.com/ethereum/solidity/pull/14177#discussion_r1194079448), but looks like this was only done for the output JSON.\r\n\r\nNote that this was really meant to be an experimental feature (even though it looks like we did not make that very clear and even included a changelog entry for it). As such it wasn't very thoroughly reviewed or tested. The intention was to merge it quickly. If anything else about it is off, please do report it :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1658543050/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
