{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/11387",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/11387/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/11387/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/11387/events",
  "html_url": "https://github.com/ethereum/solidity/issues/11387",
  "id": 890336821,
  "node_id": "MDU6SXNzdWU4OTAzMzY4MjE=",
  "number": 11387,
  "title": "Add selector for custom errors in compiler output",
  "user": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1017612679,
      "node_id": "MDU6TGFiZWwxMDE3NjEyNjc5",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/protocol%20design%20:crystal_ball:",
      "name": "protocol design :crystal_ball:",
      "color": "8af77e",
      "default": false,
      "description": "Potential changes to ABI, meta data, standard JSON"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-05-12T17:42:33Z",
  "updated_at": "2022-02-21T16:42:37Z",
  "closed_at": "2022-02-21T16:42:37Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Abstract\r\n\r\nAdd the selector of a custom error to the `sources.contract.ast` entry of the compiler output, similar to how functions have a `functionSelector` property.\r\n\r\n## Motivation\r\n\r\nTo detect which custom error was thrown, you need to inspect the return data of a revert and check the first four bytes to see which signature they match. If a tool wants to use the compiler output to detect this automatically (like Hardhat does), right now you'll need to manually build the signature and hash it. For simple types this is not that hard, but if the signature includes nested data with arrays and or structs, things get way harder. \r\n\r\n## Specification\r\n\r\nI'm not sure about this part. I guess `errorSelector` would work, analog to the `functionSelector` one. I also wonder if it would make sense to have an `errorIdentifiers` entry, similar to the current `methodIdentifiers`.\r\n\r\nAlso, and maybe unrelated to this issue: the same thing happens with events. Since as far as I know custom errors are somewhat modeled after events, maybe it would make sense to include them as part of this change. We don't need that right now, but I think they should be in the output too. (If that would make more sense as a separate issue, please let me know and I'll submit it).\r\n\r\n## Backwards Compatibility\r\n\r\nI think adding a new property in the compiler output is backwards compatible.",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/11387/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/11387/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1034649897",
    "html_url": "https://github.com/ethereum/solidity/issues/11387#issuecomment-1034649897",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11387",
    "id": 1034649897,
    "node_id": "IC_kwDOAm_5kc49q4Ep",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-10T08:50:30Z",
    "updated_at": "2022-02-10T08:50:30Z",
    "author_association": "MEMBER",
    "body": "Notes for implementation: For functions, the `functionSelector` property is added in `bool ASTJsonConverter::visit(FunctionDefinition const& _node)`. For ErrorDefinition, you can get the selector through `_node.functionType(true)->externalIdentifierHex()`\r\n\r\nand I agree that it would be good to also have this for events.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1034649897/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
