{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/12549",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/12549/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/12549/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/12549/events",
  "html_url": "https://github.com/ethereum/solidity/issues/12549",
  "id": 1106467764,
  "node_id": "I_kwDOAm_5kc5B81u0",
  "number": 12549,
  "title": "Getting \"TypeError: This variable is of storage pointer type and can be accessed without prior assignment, which would lead to undefined behaviour.\", when initializing Array of struct inside struct.",
  "user": {
    "login": "miketanto",
    "id": 63898651,
    "node_id": "MDQ6VXNlcjYzODk4NjUx",
    "avatar_url": "https://avatars.githubusercontent.com/u/63898651?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/miketanto",
    "html_url": "https://github.com/miketanto",
    "followers_url": "https://api.github.com/users/miketanto/followers",
    "following_url": "https://api.github.com/users/miketanto/following{/other_user}",
    "gists_url": "https://api.github.com/users/miketanto/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/miketanto/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/miketanto/subscriptions",
    "organizations_url": "https://api.github.com/users/miketanto/orgs",
    "repos_url": "https://api.github.com/users/miketanto/repos",
    "events_url": "https://api.github.com/users/miketanto/events{/privacy}",
    "received_events_url": "https://api.github.com/users/miketanto/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2022-01-18T04:35:07Z",
  "updated_at": "2022-05-10T18:02:42Z",
  "closed_at": "2022-01-18T10:56:21Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### **Is there anyway to initialized a Struct which contains an Array of Structs?**\r\n\r\nFor context the pragma being used is pragma solidity 0.8.6\r\nThe structs in question look like this:\r\n```solidity\r\n    struct MarketSale{\r\n      address seller;\r\n      address owner;\r\n      uint256 price;\r\n    }\r\n  struct MarketItem {\r\n          uint itemId;//Make it a one-to-one mapping with nftContract and tokenID\r\n          address nftContract;\r\n          uint256 tokenId;\r\n          uint256 currentPrice;\r\n          MarketSale[] saleHistory;\r\n          uint256 saleIndex;\r\n          ItemCategories category;\r\n          bool listed;\r\n          address creator;\r\n          address currentOwner;\r\n      }\r\n```\r\nthe problem lies when trying to initialize the MarketItem struct with this code:\r\n```solidity\r\n \r\n    MarketSale[] storage _saleHistory;\r\n    MarketSale memory sale = MarketSale(address(0),address(msg.sender),0)\r\n    _saleHistory.push(sale);\r\n\r\n    //One-to-one mapping itemId to item\r\n    idToMarketItem[itemId] =  MarketItem(itemId, nftContract, tokenId,0,_saleHistory,0,ItemCategories(category), false, address(msg.sender),address(msg.sender));\r\n```\r\n\r\nWhen getting compiled it returns: \r\nTypeError: This variable is of storage pointer type and can be accessed without prior assignment, which would lead to undefined behaviour.\r\n\r\n### **Are there any suggestions on how to go about this?**",
  "closed_by": {
    "login": "ekpyron",
    "id": 1347491,
    "node_id": "MDQ6VXNlcjEzNDc0OTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ekpyron",
    "html_url": "https://github.com/ekpyron",
    "followers_url": "https://api.github.com/users/ekpyron/followers",
    "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
    "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
    "organizations_url": "https://api.github.com/users/ekpyron/orgs",
    "repos_url": "https://api.github.com/users/ekpyron/repos",
    "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ekpyron/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/12549/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/12549/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1015296612",
    "html_url": "https://github.com/ethereum/solidity/issues/12549#issuecomment-1015296612",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12549",
    "id": 1015296612,
    "node_id": "IC_kwDOAm_5kc48hDJk",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-18T10:56:21Z",
    "updated_at": "2022-01-18T10:56:21Z",
    "author_association": "MEMBER",
    "body": "A local variable like ``MarketSale[] storage _saleHistory;`` needs to actually point to a proper state variable (otherwise where in storage would you expect the array to be stored? Only state variables are assigned actual storage slots.).\r\nSo for example:\r\n```\r\ncontract C {\r\n  struct MarketSale { ... }\r\n  MarketSale[] storage saleHistory;\r\n  function f() public {\r\n    MarketSale[] storage _saleHistory = saleHistory; // now the local variable points to an actual state variables in storage.\r\n    MarketSale memory sale = MarketSale(...);\r\n    _saleHistory.push(sale);\r\n  }\r\n}\r\n```\r\n\r\nIn case you don't want the array to actually be permanently stored in storage, you need to make it an ``memory`` array and create it with ``new``.\r\n\r\nAlso note that this bug tracker is not a general support forum for the language use, but rather meant to track bugs in the solidity compiler. A better place to ask questions about language use is for example the solidity chat channel on matrix https://matrix.to/#/#ethereum_solidity:gitter.im or gitter https://gitter.im/ethereum/solidity\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1015296612/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1015869779",
    "html_url": "https://github.com/ethereum/solidity/issues/12549#issuecomment-1015869779",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12549",
    "id": 1015869779,
    "node_id": "IC_kwDOAm_5kc48jPFT",
    "user": {
      "login": "miketanto",
      "id": 63898651,
      "node_id": "MDQ6VXNlcjYzODk4NjUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/63898651?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/miketanto",
      "html_url": "https://github.com/miketanto",
      "followers_url": "https://api.github.com/users/miketanto/followers",
      "following_url": "https://api.github.com/users/miketanto/following{/other_user}",
      "gists_url": "https://api.github.com/users/miketanto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/miketanto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/miketanto/subscriptions",
      "organizations_url": "https://api.github.com/users/miketanto/orgs",
      "repos_url": "https://api.github.com/users/miketanto/repos",
      "events_url": "https://api.github.com/users/miketanto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/miketanto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-18T21:55:44Z",
    "updated_at": "2022-01-18T21:55:44Z",
    "author_association": "NONE",
    "body": "Thanks so much for the help! I'll definitely note to ask these questions on those other channels next time!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1015869779/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1066642444",
    "html_url": "https://github.com/ethereum/solidity/issues/12549#issuecomment-1066642444",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12549",
    "id": 1066642444,
    "node_id": "IC_kwDOAm_5kc4_k6wM",
    "user": {
      "login": "krushangSk17",
      "id": 99399266,
      "node_id": "U_kgDOBey2Yg",
      "avatar_url": "https://avatars.githubusercontent.com/u/99399266?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/krushangSk17",
      "html_url": "https://github.com/krushangSk17",
      "followers_url": "https://api.github.com/users/krushangSk17/followers",
      "following_url": "https://api.github.com/users/krushangSk17/following{/other_user}",
      "gists_url": "https://api.github.com/users/krushangSk17/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/krushangSk17/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/krushangSk17/subscriptions",
      "organizations_url": "https://api.github.com/users/krushangSk17/orgs",
      "repos_url": "https://api.github.com/users/krushangSk17/repos",
      "events_url": "https://api.github.com/users/krushangSk17/events{/privacy}",
      "received_events_url": "https://api.github.com/users/krushangSk17/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-14T10:57:46Z",
    "updated_at": "2022-03-14T10:57:46Z",
    "author_association": "NONE",
    "body": "have you found the solution???\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1066642444/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 1,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1066642950",
    "html_url": "https://github.com/ethereum/solidity/issues/12549#issuecomment-1066642950",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12549",
    "id": 1066642950,
    "node_id": "IC_kwDOAm_5kc4_k64G",
    "user": {
      "login": "krushangSk17",
      "id": 99399266,
      "node_id": "U_kgDOBey2Yg",
      "avatar_url": "https://avatars.githubusercontent.com/u/99399266?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/krushangSk17",
      "html_url": "https://github.com/krushangSk17",
      "followers_url": "https://api.github.com/users/krushangSk17/followers",
      "following_url": "https://api.github.com/users/krushangSk17/following{/other_user}",
      "gists_url": "https://api.github.com/users/krushangSk17/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/krushangSk17/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/krushangSk17/subscriptions",
      "organizations_url": "https://api.github.com/users/krushangSk17/orgs",
      "repos_url": "https://api.github.com/users/krushangSk17/repos",
      "events_url": "https://api.github.com/users/krushangSk17/events{/privacy}",
      "received_events_url": "https://api.github.com/users/krushangSk17/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-14T10:58:16Z",
    "updated_at": "2022-03-14T10:58:16Z",
    "author_association": "NONE",
    "body": "> Thanks so much for the help! I'll definitely note to ask these questions on those other channels next time!\r\n\r\nplease reply if you found any solution for making struct array inside the struct.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1066642950/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1122706362",
    "html_url": "https://github.com/ethereum/solidity/issues/12549#issuecomment-1122706362",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12549",
    "id": 1122706362,
    "node_id": "IC_kwDOAm_5kc5C6yO6",
    "user": {
      "login": "camiinthisthang",
      "id": 15346823,
      "node_id": "MDQ6VXNlcjE1MzQ2ODIz",
      "avatar_url": "https://avatars.githubusercontent.com/u/15346823?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/camiinthisthang",
      "html_url": "https://github.com/camiinthisthang",
      "followers_url": "https://api.github.com/users/camiinthisthang/followers",
      "following_url": "https://api.github.com/users/camiinthisthang/following{/other_user}",
      "gists_url": "https://api.github.com/users/camiinthisthang/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/camiinthisthang/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/camiinthisthang/subscriptions",
      "organizations_url": "https://api.github.com/users/camiinthisthang/orgs",
      "repos_url": "https://api.github.com/users/camiinthisthang/repos",
      "events_url": "https://api.github.com/users/camiinthisthang/events{/privacy}",
      "received_events_url": "https://api.github.com/users/camiinthisthang/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-10T18:02:42Z",
    "updated_at": "2022-05-10T18:02:42Z",
    "author_association": "NONE",
    "body": "Hi! I was running into a similar problem and posted the question and answer here:\r\nhttps://ethereum.stackexchange.com/questions/127954/using-memory-vs-storage-for-arrays-in-structs-in-solidity-qa\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1122706362/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
