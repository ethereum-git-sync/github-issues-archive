{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/11043",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/11043/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/11043/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/11043/events",
  "html_url": "https://github.com/ethereum/solidity/issues/11043",
  "id": 821493792,
  "node_id": "MDU6SXNzdWU4MjE0OTM3OTI=",
  "number": 11043,
  "title": "Compiling in Yul mode doesn't produce sources output",
  "user": {
    "login": "haltman-at",
    "id": 35589221,
    "node_id": "MDQ6VXNlcjM1NTg5MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/haltman-at",
    "html_url": "https://github.com/haltman-at",
    "followers_url": "https://api.github.com/users/haltman-at/followers",
    "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
    "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
    "organizations_url": "https://api.github.com/users/haltman-at/orgs",
    "repos_url": "https://api.github.com/users/haltman-at/repos",
    "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
    "received_events_url": "https://api.github.com/users/haltman-at/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1017612679,
      "node_id": "MDU6TGFiZWwxMDE3NjEyNjc5",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/protocol%20design%20:crystal_ball:",
      "name": "protocol design :crystal_ball:",
      "color": "8af77e",
      "default": false,
      "description": "Potential changes to ABI, meta data, standard JSON"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2021-03-03T21:18:17Z",
  "updated_at": "2022-08-17T13:49:45Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nWhen you use solc to compile Yul, you get `contracts` output but no `sources` output (with source IDs and ASTs).\r\n\r\nNow, strictly speaking, one could say that, since Yul only supports compiling individual files (at least for now), source IDs aren't necessary.  But having this information would allow treating the compiler output in a more uniform manner without having to write special cases.\r\n\r\nAlso, it would be nice to have ASTs.  These exist when Yul is used in an assembly block inside Solidity, and in `generatedSources`, but we don't get them here.  It would be nice to have these for debugging purposes... e.g., Truffle Debugger relies on these to track variables.  It's been able to track Yul variables for some time now, but it wouldn't be able to do it for standalone Yul if there are no ASTs.\r\n\r\nSo, I would like to see `sources` added to the output when using Yul.\r\n\r\nContext: I was working on finally adding [Yul support into Truffle](https://github.com/trufflesuite/truffle/issues/1906) and this came up as one of the problems I encountered.  There will be one more of these issues in a bit. :)\r\n\r\n## Environment\r\n\r\n- Compiler version: 0.8.1",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/11043/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/11043/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/793131208",
    "html_url": "https://github.com/ethereum/solidity/issues/11043#issuecomment-793131208",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11043",
    "id": 793131208,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5MzEzMTIwOA==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-08T22:30:40Z",
    "updated_at": "2021-03-08T22:30:40Z",
    "author_association": "MEMBER",
    "body": "Since we do prepare an AST of inline assembly for the Solidity AST output, technically it should be possible to create a similar JSON output for Yul. We are lacking it right now and given we have seen some reluctance changing the Solidity AST, I would be careful making this output well \"designed\".\r\n\r\nAs a side-note I am not sure it currently would cover Yul objects.\r\n\r\nDo you depend on this for Yul support? Would it be okay if we say this feature is planned in the medium-term?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/793131208/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/793188509",
    "html_url": "https://github.com/ethereum/solidity/issues/11043#issuecomment-793188509",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11043",
    "id": 793188509,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5MzE4ODUwOQ==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-09T00:05:38Z",
    "updated_at": "2021-03-09T00:05:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "Well, it depends on how much support you want and how much we're willing to special-case things to get it to work.\r\n\r\nSo we can distinguish between multiple things here: The presence of `sources` at all (along with `id`), and the presence of `ast` in those sources.  (So possibly I should split this into two separate issues?)\r\n\r\nSo, let's start with `sources` and `id`.  Is this *necessary* for support?  Hm... well, I thought we needed it to avoid having to mess up our code a bunch, but on checking I don't think that's the case and I think we can handle it without doing that.  It would still be nice but I think things should still work without it.  Just to check -- all versions of Yul include source maps, right?  If not I'll have to make some additional alterations.\r\n\r\nAs for how necessary are ASTs, well, this is where the question comes up of, what do you mean by support?  They're not necessary for compilation or most other purposes; they only really affect the debugger.  And (thanks to some recent changes made to support Vyper) they should no longer even be necessary for stepping through with the debugger.  However they will be necessary if you want to be able to see the values of assembly variables with the debugger.  That's basically what we'd need them for.\r\n\r\nSo, yes, I think it's fine if this isn't any sort of immediate priority.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/793188509/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/793197504",
    "html_url": "https://github.com/ethereum/solidity/issues/11043#issuecomment-793197504",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11043",
    "id": 793197504,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5MzE5NzUwNA==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-09T00:25:30Z",
    "updated_at": "2021-03-09T00:25:37Z",
    "author_association": "MEMBER",
    "body": "Thanks, having a nicer introspection support in the debugger for Yul does sound intriguing tough!\r\n\r\nSo are you saying that not even sources with id is necessary (what can one use it for without the ast though?), but to reap the benefits we should have sources with id and ast?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/793197504/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/793199260",
    "html_url": "https://github.com/ethereum/solidity/issues/11043#issuecomment-793199260",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11043",
    "id": 793199260,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5MzE5OTI2MA==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-09T00:29:18Z",
    "updated_at": "2021-03-09T00:30:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yeah I think not even sources with IDs is necessary -- I mean it was never really *necessary* per se, the question was just how much we were willing to muck up our code to support it.  I thought it might be more than would be a good idea.  As it turns out the amount of that required is pretty minimal so I think it's fine.  (I'll probably want to discuss this with some other Truffle people to be sure though, it could possibly have some unintended consequences later, I don't think it's a big deal but I want to be sure.)\r\n\r\nYeah just in case you weren't aware, we added support for inspecting assembly variables within Solidity (including in generated sources) a while back, so it would be somewhat disappointing to be unable to do it in standalone Yul. :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/793199260/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/793360605",
    "html_url": "https://github.com/ethereum/solidity/issues/11043#issuecomment-793360605",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11043",
    "id": 793360605,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5MzM2MDYwNQ==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-09T04:17:28Z",
    "updated_at": "2021-03-09T04:40:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hm OK I've mostly gotten stuff working but there may be more of an issue than I thought with the lack of `sources` -- not in terms of breaking things but in terms of making sure things are arranged sensibly for the future... I'll have to talk about it with other Truffle people, so we'll see what happens there.\r\n\r\nAlso I'm noticing some possible problems with the Yul source maps, but I guess I'll open a separate issue for that.  (Edit: Opened that as #11068.)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/793360605/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/796150523",
    "html_url": "https://github.com/ethereum/solidity/issues/11043#issuecomment-796150523",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11043",
    "id": 796150523,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5NjE1MDUyMw==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-10T21:31:49Z",
    "updated_at": "2021-03-10T21:31:49Z",
    "author_association": "MEMBER",
    "body": "Actually for having the AST we have the issue #9590.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/796150523/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/796152005",
    "html_url": "https://github.com/ethereum/solidity/issues/11043#issuecomment-796152005",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11043",
    "id": 796152005,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5NjE1MjAwNQ==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-10T21:32:35Z",
    "updated_at": "2021-03-10T21:32:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "Oh, I missed that, thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/796152005/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
