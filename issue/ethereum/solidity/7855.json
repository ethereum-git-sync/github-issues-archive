{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/7855/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/7855/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/7855/events",
  "html_url": "https://github.com/ethereum/solidity/issues/7855",
  "id": 531056964,
  "node_id": "MDU6SXNzdWU1MzEwNTY5NjQ=",
  "number": 7855,
  "title": "Memory handling of the libsolc read callback",
  "user": {
    "login": "axic",
    "id": 20340,
    "node_id": "MDQ6VXNlcjIwMzQw",
    "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/axic",
    "html_url": "https://github.com/axic",
    "followers_url": "https://api.github.com/users/axic/followers",
    "following_url": "https://api.github.com/users/axic/following{/other_user}",
    "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
    "organizations_url": "https://api.github.com/users/axic/orgs",
    "repos_url": "https://api.github.com/users/axic/repos",
    "events_url": "https://api.github.com/users/axic/events{/privacy}",
    "received_events_url": "https://api.github.com/users/axic/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "christianparpart",
    "id": 56763,
    "node_id": "MDQ6VXNlcjU2NzYz",
    "avatar_url": "https://avatars.githubusercontent.com/u/56763?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/christianparpart",
    "html_url": "https://github.com/christianparpart",
    "followers_url": "https://api.github.com/users/christianparpart/followers",
    "following_url": "https://api.github.com/users/christianparpart/following{/other_user}",
    "gists_url": "https://api.github.com/users/christianparpart/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/christianparpart/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/christianparpart/subscriptions",
    "organizations_url": "https://api.github.com/users/christianparpart/orgs",
    "repos_url": "https://api.github.com/users/christianparpart/repos",
    "events_url": "https://api.github.com/users/christianparpart/events{/privacy}",
    "received_events_url": "https://api.github.com/users/christianparpart/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "christianparpart",
      "id": 56763,
      "node_id": "MDQ6VXNlcjU2NzYz",
      "avatar_url": "https://avatars.githubusercontent.com/u/56763?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/christianparpart",
      "html_url": "https://github.com/christianparpart",
      "followers_url": "https://api.github.com/users/christianparpart/followers",
      "following_url": "https://api.github.com/users/christianparpart/following{/other_user}",
      "gists_url": "https://api.github.com/users/christianparpart/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/christianparpart/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/christianparpart/subscriptions",
      "organizations_url": "https://api.github.com/users/christianparpart/orgs",
      "repos_url": "https://api.github.com/users/christianparpart/repos",
      "events_url": "https://api.github.com/users/christianparpart/events{/privacy}",
      "received_events_url": "https://api.github.com/users/christianparpart/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 19,
  "created_at": "2019-12-02T11:09:50Z",
  "updated_at": "2019-12-11T15:46:19Z",
  "closed_at": "2019-12-11T15:46:19Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "https://github.com/ethereum/solidity/blob/develop/libsolc/libsolc.h#L37-L40\r\n\r\nCurrently the read callback returns two optional pointers: data and error. If it does return these pointers, they are memory allocated by the callee (e.g. the code which has the callback implemented) but are freed by the caller (e.g. solidity, which calls the callback).\r\n\r\nThis works well in the Javascript use case, because in asm.js the Solidity `malloc` function is exposed and the callee allocates memory using the same allocator which will free it.\r\n\r\nHowever in other use cases, such as Rust or Python, the callee may have its own memory allocation function with a different list of allocations and such can't be freed by Solidity `free`.\r\n\r\nThe solution here would be to let the callee free the pointers. The problem is that the callback can be called multiple times without the main `compile` function returning and hence could amass a large allocation footprint. One option is that each callback invocation in the callee could look for existing allocations and clean them up.\r\n\r\nIn terms of API change I think we have at least three options:\r\n1) Just ensure that the callee frees memory. This can be implemented in solc-js without issues.\r\n2) Add a flag to `compile` which tells who frees the memory. This option would rather mean adding a `flags` field to `compile` and making this the first flag.\r\n3) Leaving it as is and arguing that other integrations should try to work it around. In Rust I haven't found a clean way yet to allocate memory using libsolc's malloc and obviously memory allocated by Rust's allocator can't be freed by libsolc's malloc.\r\n\r\n",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/7855/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/7855/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/560351212",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-560351212",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 560351212,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MDM1MTIxMg==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-02T11:14:04Z",
    "updated_at": "2019-12-02T11:14:04Z",
    "author_association": "MEMBER",
    "body": "Another option would be to split the callback into two - one returning a size, one receiving a buffer allocated by the compiler to which it should write.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/560351212/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/560351345",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-560351345",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 560351345,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MDM1MTM0NQ==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-02T11:14:32Z",
    "updated_at": "2019-12-02T11:14:32Z",
    "author_association": "MEMBER",
    "body": "I'm not a fan of adding a flag in any case.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/560351345/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/560374279",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-560374279",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 560374279,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MDM3NDI3OQ==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-02T12:24:25Z",
    "updated_at": "2019-12-02T12:24:25Z",
    "author_association": "MEMBER",
    "body": "Few more options suggested:\r\n1) Another callback to free a memory pointer.\r\n2) Another callback to free all memory allocated.\r\n3) Expose `malloc` via another public function.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/560374279/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/560378214",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-560378214",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 560378214,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MDM3ODIxNA==",
    "user": {
      "login": "bshastry",
      "id": 2388185,
      "node_id": "MDQ6VXNlcjIzODgxODU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2388185?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bshastry",
      "html_url": "https://github.com/bshastry",
      "followers_url": "https://api.github.com/users/bshastry/followers",
      "following_url": "https://api.github.com/users/bshastry/following{/other_user}",
      "gists_url": "https://api.github.com/users/bshastry/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bshastry/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bshastry/subscriptions",
      "organizations_url": "https://api.github.com/users/bshastry/orgs",
      "repos_url": "https://api.github.com/users/bshastry/repos",
      "events_url": "https://api.github.com/users/bshastry/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bshastry/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-02T12:36:16Z",
    "updated_at": "2019-12-02T12:36:16Z",
    "author_association": "MEMBER",
    "body": "Summary: We have a lot of options that need further discussion.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/560378214/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/560610462",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-560610462",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 560610462,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MDYxMDQ2Mg==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-02T21:35:19Z",
    "updated_at": "2019-12-02T21:35:19Z",
    "author_association": "MEMBER",
    "body": "Point in favour of adding a free-callback: That's the only way that the callback can provide file contents by memory mapping files, which is actually the fastest and nicest way for it to load stuff.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/560610462/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/560737357",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-560737357",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 560737357,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MDczNzM1Nw==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-02T22:19:24Z",
    "updated_at": "2019-12-02T22:19:24Z",
    "author_association": "MEMBER",
    "body": "But yeah, the more I'm thinking about it, the more I lean towards just exporting ``malloc`` as ``solidity_alloc`` and be done with it that way.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/560737357/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/560751240",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-560751240",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 560751240,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MDc1MTI0MA==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-02T22:25:23Z",
    "updated_at": "2019-12-02T22:25:23Z",
    "author_association": "MEMBER",
    "body": "Actually I even think that we should change the way ``solidity_free`` works while we're at it.\r\nWe should implement it in a way that we at least have a chance to make the interface reentrant in the future - so I think ``solidity_free`` should be the counterpart of ``solidity_alloc`` and take an argument. So ``solidity_compile`` returns a buffer that has to be freed by ``solidity_free``.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/560751240/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/560779137",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-560779137",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 560779137,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MDc3OTEzNw==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-02T22:37:40Z",
    "updated_at": "2019-12-02T22:37:40Z",
    "author_association": "MEMBER",
    "body": "Well we should rename `solidity_free` to `solidity_cleanup`/`solidity_reset` or something like that.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/560779137/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561128135",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-561128135",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 561128135,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTEyODEzNQ==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-03T11:33:23Z",
    "updated_at": "2019-12-03T11:33:23Z",
    "author_association": "MEMBER",
    "body": "I think it should be possible to explicitly free whatever ``solidity_compile`` returns and a second call to ``solidity_compile`` shouldn't invalidate the memory the first call returned...",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561128135/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561128821",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-561128821",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 561128821,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTEyODgyMQ==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-03T11:35:44Z",
    "updated_at": "2019-12-03T11:36:19Z",
    "author_association": "MEMBER",
    "body": "By the way: the fact that currently the memory returned from ``solidity_compile`` will be invalid after a second call to ``solidity_compile`` isn't even documented... at least not in libsolc.h...",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561128821/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561198148",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-561198148",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 561198148,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTE5ODE0OA==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-03T14:42:48Z",
    "updated_at": "2019-12-03T14:42:48Z",
    "author_association": "MEMBER",
    "body": "> I think it should be possible to explicitly free whatever solidity_compile returns and a second call to solidity_compile shouldn't invalidate the memory the first call returned...\r\n\r\nThat's not a bad idea. However it would mean an extra memory copy for every case, because currently it uses the extensible `std::string` and just exposes its pointer.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561198148/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561203583",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-561203583",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 561203583,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTIwMzU4Mw==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-03T14:55:02Z",
    "updated_at": "2019-12-03T15:52:40Z",
    "author_association": "MEMBER",
    "body": "We could do something similar, avoiding copying at the cost of linear complexity of \"free\" and a few small allocations...\r\n```\r\nstatic std::list<std::string> allocations;\r\nchar const *solidity_compile(...)  {\r\n  return allocations.emplace_back(compile(...)).c_str();\r\n}\r\nvoid solidity_free(char const* _ptr) {\r\n  for (auto it = allocations.begin(); it != allocations.end(); ++it) {\r\n    if (it->c_str() == _ptr) {\r\n        allocations.erase(it);\r\n        break;\r\n    }\r\n  }\r\n}",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561203583/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561258709",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-561258709",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 561258709,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTI1ODcwOQ==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-03T16:56:29Z",
    "updated_at": "2019-12-03T16:56:29Z",
    "author_association": "MEMBER",
    "body": "@ekpyron you can't use this `solidity_free` with `solidity_alloc` though.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561258709/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561263089",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-561263089",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 561263089,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTI2MzA4OQ==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-03T17:06:00Z",
    "updated_at": "2019-12-03T17:06:00Z",
    "author_association": "MEMBER",
    "body": "Unless we implement\r\n```\r\nchar const* solidity_alloc(size_t len) {\r\n  return allocations.emplace_back(std::string(len, 0)).c_str();\r\n}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561263089/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561263965",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-561263965",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 561263965,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTI2Mzk2NQ==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-03T17:08:05Z",
    "updated_at": "2019-12-03T17:08:05Z",
    "author_association": "MEMBER",
    "body": "The alternative is to use ``malloc``/``free``, resp. ``new[] char`` and ``delete[]``, but then we either need to change how ``StandardCompiler::compile`` returns things (bad idea IMO) or we have one copy in the end (which is probably not too bad).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561263965/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561682252",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-561682252",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 561682252,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTY4MjI1Mg==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-04T14:57:14Z",
    "updated_at": "2019-12-04T14:59:13Z",
    "author_association": "MEMBER",
    "body": "On the meeting we have agreed on a design based on @ekpyron's suggestion:\r\n\r\n- `char *solidity_alloc(size_t len)` - allocates a string and places it into the internal list\r\n- `char *solidity_free(char *ptr)` - frees the string, if the ptr is part of the internal list\r\n- `void solidity_reset()` - frees all the allocations\r\n- `char *solidity_compile(...)` - returns data allocated the same way as `solidity_alloc` works (this also means it must be deallocated explicitly by the caller)\r\n- callbacks must return pointers to the compiler allocated via `solidity_alloc` and the compiler will deallocate these\r\n\r\nWe can use different names and argue about the types used.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561682252/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561683406",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-561683406",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 561683406,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTY4MzQwNg==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-04T14:59:46Z",
    "updated_at": "2019-12-04T14:59:46Z",
    "author_association": "MEMBER",
    "body": "Just as an additional note: the pointers allocated by the callback are freed internally by the compiler, so the callback provider doesn't have to free them.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561683406/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561685207",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-561685207",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 561685207,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTY4NTIwNw==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-04T15:04:06Z",
    "updated_at": "2019-12-04T15:04:06Z",
    "author_association": "MEMBER",
    "body": "Additional discovery (mostly by @ekpyron) that we could avoid copying strings from the callback to the `CompilerStack` if we internally consider these allocations as `std::string`.\r\n\r\nFor example here https://github.com/ethereum/solidity/blob/develop/libsolc/libsolc.cpp#L61-L62, instead of creating a copy, we should move the string and remove it from the list of \"external allocations\".",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561685207/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561700313",
    "html_url": "https://github.com/ethereum/solidity/issues/7855#issuecomment-561700313",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7855",
    "id": 561700313,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MTcwMDMxMw==",
    "user": {
      "login": "christianparpart",
      "id": 56763,
      "node_id": "MDQ6VXNlcjU2NzYz",
      "avatar_url": "https://avatars.githubusercontent.com/u/56763?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/christianparpart",
      "html_url": "https://github.com/christianparpart",
      "followers_url": "https://api.github.com/users/christianparpart/followers",
      "following_url": "https://api.github.com/users/christianparpart/following{/other_user}",
      "gists_url": "https://api.github.com/users/christianparpart/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/christianparpart/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/christianparpart/subscriptions",
      "organizations_url": "https://api.github.com/users/christianparpart/orgs",
      "repos_url": "https://api.github.com/users/christianparpart/repos",
      "events_url": "https://api.github.com/users/christianparpart/events{/privacy}",
      "received_events_url": "https://api.github.com/users/christianparpart/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-04T15:38:51Z",
    "updated_at": "2019-12-04T15:38:51Z",
    "author_association": "MEMBER",
    "body": "NB: My naming proposals are the following:\r\n* `solidity_allocate()` for allocating memory\r\n* `solidity_deallocate()` for deallocating previously allocated memory (not `solidity_free` to not be confused by the old `solidity_free` that we are about to rename)\r\n* `solidity_reset() as rename of old `solidity_free`.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/561700313/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
