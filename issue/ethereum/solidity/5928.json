{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/5928",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/5928/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/5928/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/5928/events",
  "html_url": "https://github.com/ethereum/solidity/issues/5928",
  "id": 406772387,
  "node_id": "MDU6SXNzdWU0MDY3NzIzODc=",
  "number": 5928,
  "title": "Constants in Yul",
  "user": {
    "login": "axic",
    "id": 20340,
    "node_id": "MDQ6VXNlcjIwMzQw",
    "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/axic",
    "html_url": "https://github.com/axic",
    "followers_url": "https://api.github.com/users/axic/followers",
    "following_url": "https://api.github.com/users/axic/following{/other_user}",
    "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
    "organizations_url": "https://api.github.com/users/axic/orgs",
    "repos_url": "https://api.github.com/users/axic/repos",
    "events_url": "https://api.github.com/users/axic/events{/privacy}",
    "received_events_url": "https://api.github.com/users/axic/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 785717317,
      "node_id": "MDU6TGFiZWw3ODU3MTczMTc=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/language%20design%20:rage4:",
      "name": "language design :rage4:",
      "color": "9d76d3",
      "default": false,
      "description": "Any changes to the language, e.g. new features"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2019-02-05T13:02:37Z",
  "updated_at": "2022-08-17T13:48:48Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "From https://github.com/ethereum/solidity/issues/5914#issuecomment-460623404:\r\n\r\nI think introducing support for constants could improve the clarity of the code and the same time helping the optimiser. Currently the lack of constants incentivizes users to duplicate constants several times to avoid using a stack slot for them (as a variable).\r\n\r\nMarking them constant is a hint to the optimiser (a new optimisation stage).\r\n\r\nRegarding syntax I'd propose either `constant x = 0x1324` or `const x = 0x1234`.\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/5928/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/5928/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/460630400",
    "html_url": "https://github.com/ethereum/solidity/issues/5928#issuecomment-460630400",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5928",
    "id": 460630400,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2MDYzMDQwMA==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-05T13:04:53Z",
    "updated_at": "2019-02-05T13:04:53Z",
    "author_association": "MEMBER",
    "body": "I think the optimizer can handle constants quite well without this. If the user duplicates the constant, then that should be detected and if saving stack slots makes sense the optimizer should do so as well, so I don't see the need for a language construct here.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/460630400/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/460630948",
    "html_url": "https://github.com/ethereum/solidity/issues/5928#issuecomment-460630948",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5928",
    "id": 460630948,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2MDYzMDk0OA==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-05T13:06:49Z",
    "updated_at": "2019-02-05T13:06:49Z",
    "author_association": "MEMBER",
    "body": "> I think the optimizer can handle constants quite well without this.\r\n\r\nDoes it? Even if it does, since it is not clearly expressed anywhere, I as a user wouldn't put constants into a let statement.\r\n\r\nIdeally I'd actually prefer Rust's way where `let` is immutable, `let mut` is mutable and shadowing the same variable is by design to help scoping :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/460630948/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/674089931",
    "html_url": "https://github.com/ethereum/solidity/issues/5928#issuecomment-674089931",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5928",
    "id": 674089931,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3NDA4OTkzMQ==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-14T14:01:50Z",
    "updated_at": "2020-08-14T14:01:50Z",
    "author_association": "MEMBER",
    "body": "From gitter (@axic): ``This actually may be a real benefit of constants, right now constants have to be passed to functions via variables and then you end up with this stack issue.``\r\n\r\nWhile true, that's also solved by using ``function constantName() -> x { x := value }`` for the constants...\r\nWe also discussed that since shadowing global variables in functions is an error, constants could have global scope - which is again also the case for (top-level) functions.\r\n\r\nSo *if* we ever decided that we want constants, then I think we could have a simple pre-processing step that does the following:\r\n- Replace any declaration ``constant x := <literal>`` by ``function x() -> r { r := <litearl> }``.\r\n- Replace any reference to ``x`` by ``x()``.\r\n\r\nand we would pretty much get what we want, wouldn't we? So it could be pure sugar that is removed in a step before optimization or codegen.\r\n\r\nSo the main question is probably how much sugar like that we want in Yul. I think having a sugar-full variant of yul could be nice. On the other hand we pretty much deferred that to Yul+ so far - and in inline assembly Solidity constants could be used for exactly this purpose...\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/674089931/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/674098604",
    "html_url": "https://github.com/ethereum/solidity/issues/5928#issuecomment-674098604",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5928",
    "id": 674098604,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3NDA5ODYwNA==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-14T14:21:15Z",
    "updated_at": "2020-08-14T14:22:58Z",
    "author_association": "MEMBER",
    "body": "> While true, that's also solved by using `function constantName() -> x { x := value }` for the constants...\r\n\r\nYes, I did mention that, and also that I am not sold by it being a really convenient option.\r\n\r\n> So it could be pure sugar that is removed in a step before optimization or codegen.\r\n\r\nI thought about it being just a \"sugar\" in the sense there would be an early optimiser step which replaces all assignments from constants with their literal value, or the function madness proposed above.\r\n\r\n> So the main question is probably how much sugar like that we want in Yul. I think having a sugar-full variant of yul could be nice. On the other hand we pretty much deferred that to Yul+ so far\r\n\r\nI do not think it was \"deferred\", rather that Yul+ is a good place to be a playground, but what makes sense, should be included.\r\n\r\n> - and in inline assembly Solidity constants could be used for exactly this purpose...\r\n\r\nI'd say that is a separate issue to this. Inline assembly is a weird beast.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/674098604/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
