{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/12980",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/12980/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/12980/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/12980/events",
  "html_url": "https://github.com/ethereum/solidity/issues/12980",
  "id": 1223858025,
  "node_id": "I_kwDOAm_5kc5I8pdp",
  "number": 12980,
  "title": "Ensure that any contract that compiles with the new optimizer also compiles when disabling optimizations",
  "user": {
    "login": "wuestholz",
    "id": 51156,
    "node_id": "MDQ6VXNlcjUxMTU2",
    "avatar_url": "https://avatars.githubusercontent.com/u/51156?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wuestholz",
    "html_url": "https://github.com/wuestholz",
    "followers_url": "https://api.github.com/users/wuestholz/followers",
    "following_url": "https://api.github.com/users/wuestholz/following{/other_user}",
    "gists_url": "https://api.github.com/users/wuestholz/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wuestholz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wuestholz/subscriptions",
    "organizations_url": "https://api.github.com/users/wuestholz/orgs",
    "repos_url": "https://api.github.com/users/wuestholz/repos",
    "events_url": "https://api.github.com/users/wuestholz/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wuestholz/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4858664852,
      "node_id": "LA_kwDOAm_5kc8AAAABIZlXlA",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/needs%20investigation",
      "name": "needs investigation",
      "color": "9F804C",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2022-05-03T09:16:04Z",
  "updated_at": "2023-05-30T12:44:23Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Abstract\r\n\r\nAccording the discussion with @chriseth at the FV hangout, it may happen that a contract that compiles with the new Yul-based optimizer does not compile when disabling that optimizer. The reason seems to be a new compiler/optimizer pass that spills stack variables to memory. As far as I understand, when disabling the optimizer, this pass is currently not run and contracts may not compile due to lack of stack space. It would be great if this pass could always be run, independently of other (optimization) passes, to make sure the optimizer can always be disabled if needed.\r\n\r\n## Motivation\r\n\r\nUsers should have the option to disable the optimizer. For instance, it seems that without optimization more debug information is preserved and users may want to disable the optimizer when testing/debugging/verifying their code before deployment.\r\n\r\n## Specification\r\n\r\nWhen a user can compile a contract with the new optimizer they should also be able to compile it when disabling the optimizer (e.g., through existing flags/options).\r\n\r\n## Backwards Compatibility\r\n\r\nThis should not break backwards compatibiliy. In fact, it seems like the current (Yul-based) compilation pipeline breaks backwards compatiblity.\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/12980/reactions",
    "total_count": 4,
    "+1": 4,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/12980/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1485026602",
    "html_url": "https://github.com/ethereum/solidity/issues/12980#issuecomment-1485026602",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12980",
    "id": 1485026602,
    "node_id": "IC_kwDOAm_5kc5Yg7Uq",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-03-27T12:05:55Z",
    "updated_at": "2023-03-27T12:05:55Z",
    "author_association": "NONE",
    "body": "This issue has been marked as stale due to inactivity for the last 90 days.\nIt will be automatically closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1485026602/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1485626939",
    "html_url": "https://github.com/ethereum/solidity/issues/12980#issuecomment-1485626939",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12980",
    "id": 1485626939,
    "node_id": "IC_kwDOAm_5kc5YjN47",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-27T18:14:39Z",
    "updated_at": "2023-03-27T18:14:39Z",
    "author_association": "MEMBER",
    "body": "We'll most probably enable some minimal optimizations including stack-to-memory by default in one of the upcoming releases.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1485626939/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1562813429",
    "html_url": "https://github.com/ethereum/solidity/issues/12980#issuecomment-1562813429",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12980",
    "id": 1562813429,
    "node_id": "IC_kwDOAm_5kc5dJqP1",
    "user": {
      "login": "wuestholz",
      "id": 51156,
      "node_id": "MDQ6VXNlcjUxMTU2",
      "avatar_url": "https://avatars.githubusercontent.com/u/51156?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wuestholz",
      "html_url": "https://github.com/wuestholz",
      "followers_url": "https://api.github.com/users/wuestholz/followers",
      "following_url": "https://api.github.com/users/wuestholz/following{/other_user}",
      "gists_url": "https://api.github.com/users/wuestholz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wuestholz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wuestholz/subscriptions",
      "organizations_url": "https://api.github.com/users/wuestholz/orgs",
      "repos_url": "https://api.github.com/users/wuestholz/repos",
      "events_url": "https://api.github.com/users/wuestholz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wuestholz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-25T12:22:23Z",
    "updated_at": "2023-05-25T12:50:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ekpyron Thanks for the update! Do you already have an estimate about when this will be released? I think this would be really useful for various tools that want to provide accurate debug information.\r\n\r\nI found this issue: https://github.com/ethereum/solidity/issues/13972. Is this the issue that you use for tracking this feature?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1562813429/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1568233565",
    "html_url": "https://github.com/ethereum/solidity/issues/12980#issuecomment-1568233565",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12980",
    "id": 1568233565,
    "node_id": "IC_kwDOAm_5kc5deVhd",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-30T11:04:06Z",
    "updated_at": "2023-05-30T11:04:06Z",
    "author_association": "MEMBER",
    "body": "That issue should at least mitigate the problem quite a bit and is currently being actively worked and and is planned for the next release (which may happen some time next month).\r\n\r\nWe will need to see whether and in how many cases we will still run into this issue afterwards, though, the mechanisms are not entirely foolproof currently (we'll separately also be working on changing that, but that may take a bit longer to do).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1568233565/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1568278894",
    "html_url": "https://github.com/ethereum/solidity/issues/12980#issuecomment-1568278894",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12980",
    "id": 1568278894,
    "node_id": "IC_kwDOAm_5kc5deglu",
    "user": {
      "login": "wuestholz",
      "id": 51156,
      "node_id": "MDQ6VXNlcjUxMTU2",
      "avatar_url": "https://avatars.githubusercontent.com/u/51156?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wuestholz",
      "html_url": "https://github.com/wuestholz",
      "followers_url": "https://api.github.com/users/wuestholz/followers",
      "following_url": "https://api.github.com/users/wuestholz/following{/other_user}",
      "gists_url": "https://api.github.com/users/wuestholz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wuestholz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wuestholz/subscriptions",
      "organizations_url": "https://api.github.com/users/wuestholz/orgs",
      "repos_url": "https://api.github.com/users/wuestholz/repos",
      "events_url": "https://api.github.com/users/wuestholz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wuestholz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-30T11:36:38Z",
    "updated_at": "2023-05-30T11:36:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ekpyron Thanks a lot for the update! Are you planning to ensure that the minimal optimizations keep the source maps as accurate as possible? That would be crucial for our use case.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1568278894/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1568359180",
    "html_url": "https://github.com/ethereum/solidity/issues/12980#issuecomment-1568359180",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12980",
    "id": 1568359180,
    "node_id": "IC_kwDOAm_5kc5de0MM",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-30T12:36:17Z",
    "updated_at": "2023-05-30T12:36:17Z",
    "author_association": "MEMBER",
    "body": "We're generally trying to keep source maps as accurate as possible and the minimal optimizations are conservative and shouldn't affect them significantly - but we do also switch to a newer backend to generate bytecode in the end; also for that we of course try to generate accurate source maps, but we don't have good data about the potentially induced change being an issue for tooling or not - if you want you can check yourself with the current PR draft https://github.com/ethereum/solidity/pull/14149 and report back to us if the generated source maps seem workable for you - if they're lacking in some way we can try to remedy that.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1568359180/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1568370463",
    "html_url": "https://github.com/ethereum/solidity/issues/12980#issuecomment-1568370463",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12980",
    "id": 1568370463,
    "node_id": "IC_kwDOAm_5kc5de28f",
    "user": {
      "login": "wuestholz",
      "id": 51156,
      "node_id": "MDQ6VXNlcjUxMTU2",
      "avatar_url": "https://avatars.githubusercontent.com/u/51156?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wuestholz",
      "html_url": "https://github.com/wuestholz",
      "followers_url": "https://api.github.com/users/wuestholz/followers",
      "following_url": "https://api.github.com/users/wuestholz/following{/other_user}",
      "gists_url": "https://api.github.com/users/wuestholz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wuestholz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wuestholz/subscriptions",
      "organizations_url": "https://api.github.com/users/wuestholz/orgs",
      "repos_url": "https://api.github.com/users/wuestholz/repos",
      "events_url": "https://api.github.com/users/wuestholz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wuestholz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-30T12:44:23Z",
    "updated_at": "2023-05-30T12:44:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks! I'll let you know if we notice anything funny. :) We currently use the the unoptimized bytecode when we want to obtain the most accurate source locations. For optimized bytecode we've observed that there are often instructions that do not map to a source location.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1568370463/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
