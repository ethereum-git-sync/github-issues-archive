{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/1374",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/1374/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/1374/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/1374/events",
  "html_url": "https://github.com/ethereum/solidity/issues/1374",
  "id": 189259570,
  "node_id": "MDU6SXNzdWUxODkyNTk1NzA=",
  "number": 1374,
  "title": "Inline Assembly: Stack height unknown after jump",
  "user": {
    "login": "androlo",
    "id": 2809499,
    "node_id": "MDQ6VXNlcjI4MDk0OTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2809499?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/androlo",
    "html_url": "https://github.com/androlo",
    "followers_url": "https://api.github.com/users/androlo/followers",
    "following_url": "https://api.github.com/users/androlo/following{/other_user}",
    "gists_url": "https://api.github.com/users/androlo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/androlo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/androlo/subscriptions",
    "organizations_url": "https://api.github.com/users/androlo/orgs",
    "repos_url": "https://api.github.com/users/androlo/repos",
    "events_url": "https://api.github.com/users/androlo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/androlo/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2016-11-14T23:49:09Z",
  "updated_at": "2016-11-15T11:23:49Z",
  "closed_at": "2016-11-15T11:23:49Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "```\r\ncontract InternalFunctionCall {\r\n\r\n    function add(uint a, uint b) constant returns (uint sum) {\r\n        assembly {\r\n            added\r\n            a\r\n            b\r\n            jump(_add)\r\n            added:\r\n            =: sum\r\n        }\r\n    }\r\n\r\n    function _add(uint a, uint b) internal constant returns (uint) {\r\n        return a + b;\r\n    }\r\n\r\n}\r\n```\r\n\r\nThe `=: sum` assignment at the bottom of the inline assembly block does a `SWAP3` rather then `SWAP1`. The compiler also complains that the stack is not balanced (leaves 2 items on stack), but it is. The reason seems to be that it believes `a` and `b` are still on the stack, even though `_add` treats them as regular function parameters and pops them automatically.",
  "closed_by": {
    "login": "androlo",
    "id": 2809499,
    "node_id": "MDQ6VXNlcjI4MDk0OTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2809499?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/androlo",
    "html_url": "https://github.com/androlo",
    "followers_url": "https://api.github.com/users/androlo/followers",
    "following_url": "https://api.github.com/users/androlo/following{/other_user}",
    "gists_url": "https://api.github.com/users/androlo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/androlo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/androlo/subscriptions",
    "organizations_url": "https://api.github.com/users/androlo/orgs",
    "repos_url": "https://api.github.com/users/androlo/repos",
    "events_url": "https://api.github.com/users/androlo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/androlo/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/1374/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/1374/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/260574309",
    "html_url": "https://github.com/ethereum/solidity/issues/1374#issuecomment-260574309",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/1374",
    "id": 260574309,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MDU3NDMwOQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-15T08:06:49Z",
    "updated_at": "2016-11-15T08:07:11Z",
    "author_association": "MEMBER",
    "body": "It is impossible to tell the stack height at the point where you jump back to `added` because the control flow just leaves the assembly it the jump and comes in at added from somewhere outside its control. In the compiler, this is dealt with my manually adjusting the stack height. We could add such a feature, but I'm not sure that is the right way to go.\n\nSyntax could be:\n\n```\njump(_add)\nadded[-2]:\n=: sum\n```\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/260574309/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/260616487",
    "html_url": "https://github.com/ethereum/solidity/issues/1374#issuecomment-260616487",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/1374",
    "id": 260616487,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MDYxNjQ4Nw==",
    "user": {
      "login": "androlo",
      "id": 2809499,
      "node_id": "MDQ6VXNlcjI4MDk0OTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2809499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/androlo",
      "html_url": "https://github.com/androlo",
      "followers_url": "https://api.github.com/users/androlo/followers",
      "following_url": "https://api.github.com/users/androlo/following{/other_user}",
      "gists_url": "https://api.github.com/users/androlo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/androlo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/androlo/subscriptions",
      "organizations_url": "https://api.github.com/users/androlo/orgs",
      "repos_url": "https://api.github.com/users/androlo/repos",
      "events_url": "https://api.github.com/users/androlo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/androlo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-15T11:23:49Z",
    "updated_at": "2016-11-15T11:23:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "Not very useful feature I suppose. Better wait until it's full support for function calls. Just playing around anyways. Figured I'd bring it up since i saw some other similar issue (the one when the entire block is just a variable declaration).\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/260616487/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
