{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/13719",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/13719/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/13719/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/13719/events",
  "html_url": "https://github.com/ethereum/solidity/issues/13719",
  "id": 1453398202,
  "node_id": "I_kwDOAm_5kc5WoRi6",
  "number": 13719,
  "title": "Performance of the via-IR pipeline",
  "user": {
    "login": "NunoFilipeSantos",
    "id": 2582498,
    "node_id": "MDQ6VXNlcjI1ODI0OTg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2582498?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/NunoFilipeSantos",
    "html_url": "https://github.com/NunoFilipeSantos",
    "followers_url": "https://api.github.com/users/NunoFilipeSantos/followers",
    "following_url": "https://api.github.com/users/NunoFilipeSantos/following{/other_user}",
    "gists_url": "https://api.github.com/users/NunoFilipeSantos/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/NunoFilipeSantos/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/NunoFilipeSantos/subscriptions",
    "organizations_url": "https://api.github.com/users/NunoFilipeSantos/orgs",
    "repos_url": "https://api.github.com/users/NunoFilipeSantos/repos",
    "events_url": "https://api.github.com/users/NunoFilipeSantos/events{/privacy}",
    "received_events_url": "https://api.github.com/users/NunoFilipeSantos/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4806670945,
      "node_id": "LA_kwDOAm_5kc8AAAABHn_6YQ",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/roadmap",
      "name": "roadmap",
      "color": "15B732",
      "default": false,
      "description": ""
    },
    {
      "id": 4828600698,
      "node_id": "LA_kwDOAm_5kc8AAAABH86Zeg",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/viair",
      "name": "viair",
      "color": "5999F7",
      "default": false,
      "description": ""
    },
    {
      "id": 4867045645,
      "node_id": "LA_kwDOAm_5kc8AAAABIhk5DQ",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/epic",
      "name": "epic",
      "color": "BE24FA",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [
    {
      "login": "nikola-matic",
      "id": 4415530,
      "node_id": "MDQ6VXNlcjQ0MTU1MzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4415530?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikola-matic",
      "html_url": "https://github.com/nikola-matic",
      "followers_url": "https://api.github.com/users/nikola-matic/followers",
      "following_url": "https://api.github.com/users/nikola-matic/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikola-matic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikola-matic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikola-matic/subscriptions",
      "organizations_url": "https://api.github.com/users/nikola-matic/orgs",
      "repos_url": "https://api.github.com/users/nikola-matic/repos",
      "events_url": "https://api.github.com/users/nikola-matic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikola-matic/received_events",
      "type": "User",
      "site_admin": false
    },
    {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-11-17T13:58:30Z",
  "updated_at": "2023-07-06T10:10:10Z",
  "closed_at": "2023-07-06T10:10:10Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "### What\r\n\r\nThe Yul optimizer is slow.\r\n\r\n### Why\r\n\r\nParts have quadratic runtime complexity.\r\n\r\n### How\r\n\r\nIdentify the responsible components and reimplement them more efficiently.\r\n\r\nLow-hanging fruits in improving the stack shuffling algorithm (replace per-iteration-regenerated multiplicity maps).\r\n\r\n#### Tasks\r\n\r\n- [x] https://github.com/ethereum/solidity/pull/13705\r\n- [x] https://github.com/ethereum/solidity/pull/13703\r\n- [x] https://github.com/ethereum/solidity/pull/13734\r\n- [x] https://github.com/ethereum/solidity/pull/13760\r\n- [x] https://github.com/ethereum/solidity/pull/13702\r\n- [x] https://github.com/ethereum/solidity/pull/13708\r\n- [x] https://github.com/ethereum/solidity/pull/13688\r\n- [x] https://github.com/ethereum/solidity/pull/13687\r\n- [x] https://github.com/ethereum/solidity/pull/13682\r\n- [x] https://github.com/ethereum/solidity/pull/13752\r\n- [x] https://github.com/ethereum/solidity/pull/12274\r\n- [x] https://github.com/ethereum/solidity/issues/13822\r\n\r\n# Paused\r\n- [ ] https://github.com/ethereum/solidity/pull/14112\r\n- [ ] Community Demo or Blog post\r\n\r\n### Notes\r\n\r\n\r\n### Out of scope\r\n\r\n- At all cost beat the legacy pipeline in runtime.\r\n\r\n---\r\n### Resources\r\n\r\n1. [Performance Statistics](https://github.com/ethereum/solidity/issues/13719#issuecomment-1324133162)\r\n2. https://github.com/ethereum/solidity/issues/13721\r\n",
  "closed_by": {
    "login": "NunoFilipeSantos",
    "id": 2582498,
    "node_id": "MDQ6VXNlcjI1ODI0OTg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2582498?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/NunoFilipeSantos",
    "html_url": "https://github.com/NunoFilipeSantos",
    "followers_url": "https://api.github.com/users/NunoFilipeSantos/followers",
    "following_url": "https://api.github.com/users/NunoFilipeSantos/following{/other_user}",
    "gists_url": "https://api.github.com/users/NunoFilipeSantos/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/NunoFilipeSantos/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/NunoFilipeSantos/subscriptions",
    "organizations_url": "https://api.github.com/users/NunoFilipeSantos/orgs",
    "repos_url": "https://api.github.com/users/NunoFilipeSantos/repos",
    "events_url": "https://api.github.com/users/NunoFilipeSantos/events{/privacy}",
    "received_events_url": "https://api.github.com/users/NunoFilipeSantos/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/13719/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/13719/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1324095059",
    "html_url": "https://github.com/ethereum/solidity/issues/13719#issuecomment-1324095059",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13719",
    "id": 1324095059,
    "node_id": "IC_kwDOAm_5kc5O7BZT",
    "user": {
      "login": "nikola-matic",
      "id": 4415530,
      "node_id": "MDQ6VXNlcjQ0MTU1MzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4415530?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikola-matic",
      "html_url": "https://github.com/nikola-matic",
      "followers_url": "https://api.github.com/users/nikola-matic/followers",
      "following_url": "https://api.github.com/users/nikola-matic/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikola-matic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikola-matic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikola-matic/subscriptions",
      "organizations_url": "https://api.github.com/users/nikola-matic/orgs",
      "repos_url": "https://api.github.com/users/nikola-matic/repos",
      "events_url": "https://api.github.com/users/nikola-matic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikola-matic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-22T18:37:49Z",
    "updated_at": "2022-11-22T18:37:49Z",
    "author_association": "MEMBER",
    "body": "@chriseth would it make sense to cherry pick #13703 into the most recent develop without the optimiser changes that you've introduced in order to have a control/baseline for the optimiser performance prior to actually introducing any patches?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1324095059/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1324133162",
    "html_url": "https://github.com/ethereum/solidity/issues/13719#issuecomment-1324133162",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13719",
    "id": 1324133162,
    "node_id": "IC_kwDOAm_5kc5O7Ksq",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-22T19:15:35Z",
    "updated_at": "2022-11-25T13:30:18Z",
    "author_association": "MEMBER",
    "body": "Performance statistics:\r\n==================\r\n\r\n(note that some changes were merged in between that do not only change the performance but also the optimizer steps themselves, so take these statistics with a grain of salt)\r\n\r\nRun on \"Chains.sol\" on @chriseth's machine with RelWithDebInfo `--via-ir --bin --optimize`.\r\n\r\n--------\r\n\r\nRun on 9a60c06335bb49582a36b17918f2114c44165951 (before https://github.com/ethereum/solidity/pull/13688 was merged)\r\n```\r\n\r\n  0.669% (0.207962 s): FullInliner\r\n  1.087% (0.337953 s): UnusedPruner\r\n  1.193% (0.370938 s): EqualStoreEliminator\r\n  1.530% (0.47585 s): SSATransform\r\n  2.143% (0.666361 s): UnusedStoreEliminator\r\n  5.612% (1.745471 s): ExpressionSimplifier\r\n  8.146% (2.533345 s): LoadResolver\r\n 12.907% (4.014192 s): LiteralRematerialiser\r\n 23.050% (7.168812 s): UnusedAssignEliminator\r\n 41.923% (13.038435 s): CommonSubexpressionEliminator\r\n--------------------------------------\r\n    100% (31.101 s)\r\n\r\n  1.163% (0.148087 s): SSATransform\r\n  1.275% (0.162394 s): UnusedPruner\r\n  1.528% (0.194537 s): UnusedStoreEliminator\r\n  2.109% (0.268484 s): EqualStoreEliminator\r\n  4.215% (0.536716 s): ExpressionSimplifier\r\n  8.557% (1.089507 s): LoadResolver\r\n 10.258% (1.306054 s): LiteralRematerialiser\r\n 28.750% (3.66045 s): UnusedAssignEliminator\r\n 39.864% (5.075496 s): CommonSubexpressionEliminator\r\n--------------------------------------\r\n    100% (12.732 s)\r\n\r\n56.7s\r\n\r\n```\r\n\r\n-----\r\n\r\nRun on 19fc395662c84994f9c4094afd60b83ca69fdf13 (after #13688 was merged)\r\n```\r\n  0.663% (0.196783 s): FullInliner\r\n  1.127% (0.334353 s): UnusedPruner\r\n  1.373% (0.407598 s): EqualStoreEliminator\r\n  1.602% (0.475363 s): SSATransform\r\n  2.005% (0.595169 s): UnusedStoreEliminator\r\n  5.976% (1.77352 s): ExpressionSimplifier\r\n  7.799% (2.31465 s): LoadResolver\r\n 13.117% (3.893043 s): LiteralRematerialiser\r\n 24.148% (7.166617 s): UnusedAssignEliminator\r\n 40.453% (12.005757 s): CommonSubexpressionEliminator\r\n--------------------------------------\r\n    100% (29.678 s)\r\n\r\n  1.235% (0.14263 s): UnusedPruner\r\n  1.254% (0.144803 s): SSATransform\r\n  1.550% (0.178966 s): UnusedStoreEliminator\r\n  2.328% (0.268853 s): EqualStoreEliminator\r\n  4.734% (0.546637 s): ExpressionSimplifier\r\n  8.352% (0.964534 s): LoadResolver\r\n 10.361% (1.196546 s): LiteralRematerialiser\r\n 29.840% (3.445972 s): UnusedAssignEliminator\r\n 38.108% (4.400843 s): CommonSubexpressionEliminator\r\n--------------------------------------\r\n    100% (11.548 s)\r\n\r\n54.0s\r\n```\r\n\r\n----\r\n\r\nRun on 1bd35b1be (after #13682 - use hash for CSE was merged)\r\n```\r\n  0.350% (0.077108 s): DeadCodeEliminator\r\n  0.892% (0.196741 s): FullInliner\r\n  1.451% (0.320119 s): UnusedPruner\r\n  1.650% (0.364055 s): EqualStoreEliminator\r\n  2.129% (0.469621 s): SSATransform\r\n  2.777% (0.612714 s): UnusedStoreEliminator\r\n  7.836% (1.728824 s): ExpressionSimplifier\r\n 10.842% (2.391972 s): LoadResolver\r\n 17.522% (3.865645 s): LiteralRematerialiser\r\n 21.876% (4.826155 s): CommonSubexpressionEliminator\r\n 30.729% (6.779252 s): UnusedAssignEliminator\r\n--------------------------------------\r\n    100% (22.061 s)\r\n\r\n  1.601% (0.144756 s): SSATransform\r\n  1.642% (0.148393 s): UnusedPruner\r\n  1.992% (0.180077 s): UnusedStoreEliminator\r\n  2.712% (0.245104 s): EqualStoreEliminator\r\n  5.861% (0.529793 s): ExpressionSimplifier\r\n 11.542% (1.043309 s): LoadResolver\r\n 13.444% (1.215262 s): LiteralRematerialiser\r\n 21.098% (1.907142 s): CommonSubexpressionEliminator\r\n 37.191% (3.361847 s): UnusedAssignEliminator\r\n--------------------------------------\r\n    100% (9.039 s)\r\n\r\n44.6s\r\n```\r\n\r\n----\r\nRun on be8ecb17d8e8405 (develop as of 2022-11-22 evening)\r\n\r\n```\r\n  0.885% (0.203343 s): FullInliner\r\n  1.530% (0.351829 s): UnusedPruner\r\n  1.616% (0.371587 s): EqualStoreEliminator\r\n  2.070% (0.47594 s): SSATransform\r\n  2.728% (0.627155 s): UnusedStoreEliminator\r\n  7.599% (1.746962 s): ExpressionSimplifier\r\n 10.675% (2.453971 s): LoadResolver\r\n 17.620% (4.050501 s): LiteralRematerialiser\r\n 21.554% (4.954944 s): CommonSubexpressionEliminator\r\n 31.397% (7.217784 s): UnusedAssignEliminator\r\n--------------------------------------\r\n    100% (22.988 s)\r\n\r\n  1.522% (0.149838 s): UnusedPruner\r\n  1.635% (0.16091 s): SSATransform\r\n  2.058% (0.202598 s): UnusedStoreEliminator\r\n  2.954% (0.290798 s): EqualStoreEliminator\r\n  6.055% (0.596098 s): ExpressionSimplifier\r\n 10.950% (1.077955 s): LoadResolver\r\n 12.650% (1.245365 s): LiteralRematerialiser\r\n 20.915% (2.059034 s): CommonSubexpressionEliminator\r\n 38.458% (3.786018 s): UnusedAssignEliminator\r\n--------------------------------------\r\n    100% (9.845 s)\r\n\r\n46.0s\r\n```\r\n\r\n----\r\nRun after https://github.com/ethereum/solidity/pull/13705 was merged:\r\n\r\n```\r\n  0.911% (0.190328 s): FullInliner\r\n  1.370% (0.286232 s): UnusedPruner\r\n  1.694% (0.353885 s): EqualStoreEliminator\r\n  2.234% (0.466618 s): SSATransform\r\n  2.675% (0.558851 s): UnusedStoreEliminator\r\n  8.033% (1.678058 s): ExpressionSimplifier\r\n 10.560% (2.205888 s): LoadResolver\r\n 18.033% (3.766786 s): LiteralRematerialiser\r\n 22.306% (4.659482 s): CommonSubexpressionEliminator\r\n 29.865% (6.238317 s): UnusedAssignEliminator\r\n--------------------------------------\r\n    100% (20.889 s)\r\n\r\n  0.195% (0.016969 s): FullInliner\r\n  0.196% (0.017102 s): LoopInvariantCodeMotion\r\n  0.213% (0.018522 s): ConditionalUnsimplifier\r\n  0.238% (0.020727 s): ControlFlowSimplifier\r\n  0.241% (0.021015 s): ConditionalSimplifier\r\n  0.259% (0.022609 s): DeadCodeEliminator\r\n  0.452% (0.039353 s): Rematerialiser\r\n  0.572% (0.049845 s): ExpressionSplitter\r\n  1.475% (0.12856 s): UnusedPruner\r\n  1.567% (0.136607 s): SSATransform\r\n  2.150% (0.187418 s): UnusedStoreEliminator\r\n  3.064% (0.267053 s): EqualStoreEliminator\r\n  6.249% (0.544632 s): ExpressionSimplifier\r\n 11.037% (0.962025 s): LoadResolver\r\n 13.590% (1.184535 s): LiteralRematerialiser\r\n 21.429% (1.867744 s): CommonSubexpressionEliminator\r\n 36.591% (3.189325 s): UnusedAssignEliminator\r\n--------------------------------------\r\n    100% (8.716 s)\r\n\r\n42.7 s\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1324133162/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1623403367",
    "html_url": "https://github.com/ethereum/solidity/issues/13719#issuecomment-1623403367",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13719",
    "id": 1623403367,
    "node_id": "IC_kwDOAm_5kc5gwytn",
    "user": {
      "login": "NunoFilipeSantos",
      "id": 2582498,
      "node_id": "MDQ6VXNlcjI1ODI0OTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2582498?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NunoFilipeSantos",
      "html_url": "https://github.com/NunoFilipeSantos",
      "followers_url": "https://api.github.com/users/NunoFilipeSantos/followers",
      "following_url": "https://api.github.com/users/NunoFilipeSantos/following{/other_user}",
      "gists_url": "https://api.github.com/users/NunoFilipeSantos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NunoFilipeSantos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NunoFilipeSantos/subscriptions",
      "organizations_url": "https://api.github.com/users/NunoFilipeSantos/orgs",
      "repos_url": "https://api.github.com/users/NunoFilipeSantos/repos",
      "events_url": "https://api.github.com/users/NunoFilipeSantos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NunoFilipeSantos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-06T10:10:10Z",
    "updated_at": "2023-07-06T10:10:10Z",
    "author_association": "MEMBER",
    "body": "The first scope was complete.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1623403367/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
