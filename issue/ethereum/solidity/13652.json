{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/13652",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/13652/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/13652/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/13652/events",
  "html_url": "https://github.com/ethereum/solidity/issues/13652",
  "id": 1422451574,
  "node_id": "I_kwDOAm_5kc5UyON2",
  "number": 13652,
  "title": "`abi.decode()` accepts zero-length arrays",
  "user": {
    "login": "bshastry",
    "id": 2388185,
    "node_id": "MDQ6VXNlcjIzODgxODU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2388185?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bshastry",
    "html_url": "https://github.com/bshastry",
    "followers_url": "https://api.github.com/users/bshastry/followers",
    "following_url": "https://api.github.com/users/bshastry/following{/other_user}",
    "gists_url": "https://api.github.com/users/bshastry/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bshastry/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bshastry/subscriptions",
    "organizations_url": "https://api.github.com/users/bshastry/orgs",
    "repos_url": "https://api.github.com/users/bshastry/repos",
    "events_url": "https://api.github.com/users/bshastry/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bshastry/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 249074435,
      "node_id": "MDU6TGFiZWwyNDkwNzQ0MzU=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/bug%20:bug:",
      "name": "bug :bug:",
      "color": "fc1313",
      "default": false,
      "description": ""
    },
    {
      "id": 717596767,
      "node_id": "MDU6TGFiZWw3MTc1OTY3Njc=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/good%20first%20issue",
      "name": "good first issue",
      "color": "006b75",
      "default": true,
      "description": ""
    },
    {
      "id": 2376148917,
      "node_id": "MDU6TGFiZWwyMzc2MTQ4OTE3",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/should%20report%20better%20error",
      "name": "should report better error",
      "color": "53e0b5",
      "default": false,
      "description": "Error is just badly reported. Should be a proper type error - source is not fine."
    },
    {
      "id": 4438006499,
      "node_id": "LA_kwDOAm_5kc8AAAABCIaa4w",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/low%20effort",
      "name": "low effort",
      "color": "ffb1fa",
      "default": false,
      "description": "There is not much implementation work to be done. The task is very easy or tiny."
    },
    {
      "id": 4438155599,
      "node_id": "LA_kwDOAm_5kc8AAAABCIjhTw",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/medium%20impact",
      "name": "medium impact",
      "color": "001dff",
      "default": false,
      "description": "Default level of impact"
    },
    {
      "id": 4438481746,
      "node_id": "LA_kwDOAm_5kc8AAAABCI3bUg",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/must%20have%20eventually",
      "name": "must have eventually",
      "color": "ffb04d",
      "default": false,
      "description": "Something we consider essential but not enough to prevent us from releasing Solidity 1.0 without it."
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2022-10-25T13:17:32Z",
  "updated_at": "2022-11-10T15:57:16Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "```\r\ncontract C {\r\n  function f() public {\r\n    abi.decode(\"\",  (int[0][]));\r\n  }\r\n}\r\n```\r\n\r\nthrows\r\n\r\nhttps://github.com/ethereum/solidity/blob/84cdcec2cfb1fe9d4a9171d3ed0ffefd6107ee42/libsolidity/codegen/ABIFunctions.cpp#L1174\r\n\r\nRepro\r\n\r\n```\r\n$ solc --ir test.sol\r\n```",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/13652/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/13652/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1292039340",
    "html_url": "https://github.com/ethereum/solidity/issues/13652#issuecomment-1292039340",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13652",
    "id": 1292039340,
    "node_id": "IC_kwDOAm_5kc5NAvSs",
    "user": {
      "login": "NunoFilipeSantos",
      "id": 2582498,
      "node_id": "MDQ6VXNlcjI1ODI0OTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2582498?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NunoFilipeSantos",
      "html_url": "https://github.com/NunoFilipeSantos",
      "followers_url": "https://api.github.com/users/NunoFilipeSantos/followers",
      "following_url": "https://api.github.com/users/NunoFilipeSantos/following{/other_user}",
      "gists_url": "https://api.github.com/users/NunoFilipeSantos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NunoFilipeSantos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NunoFilipeSantos/subscriptions",
      "organizations_url": "https://api.github.com/users/NunoFilipeSantos/orgs",
      "repos_url": "https://api.github.com/users/NunoFilipeSantos/repos",
      "events_url": "https://api.github.com/users/NunoFilipeSantos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NunoFilipeSantos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-26T13:30:13Z",
    "updated_at": "2022-10-26T13:30:13Z",
    "author_association": "MEMBER",
    "body": "@bshastry what is the priority of this bug (High, Medium, Low)?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1292039340/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1292156276",
    "html_url": "https://github.com/ethereum/solidity/issues/13652#issuecomment-1292156276",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13652",
    "id": 1292156276,
    "node_id": "IC_kwDOAm_5kc5NBL10",
    "user": {
      "login": "bshastry",
      "id": 2388185,
      "node_id": "MDQ6VXNlcjIzODgxODU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2388185?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bshastry",
      "html_url": "https://github.com/bshastry",
      "followers_url": "https://api.github.com/users/bshastry/followers",
      "following_url": "https://api.github.com/users/bshastry/following{/other_user}",
      "gists_url": "https://api.github.com/users/bshastry/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bshastry/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bshastry/subscriptions",
      "organizations_url": "https://api.github.com/users/bshastry/orgs",
      "repos_url": "https://api.github.com/users/bshastry/repos",
      "events_url": "https://api.github.com/users/bshastry/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bshastry/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-26T14:39:53Z",
    "updated_at": "2022-10-26T14:39:53Z",
    "author_association": "MEMBER",
    "body": "I would say Low because it is unlikely a legitimate user would try to decode an empty string into a zero length array.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1292156276/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1292287194",
    "html_url": "https://github.com/ethereum/solidity/issues/13652#issuecomment-1292287194",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13652",
    "id": 1292287194,
    "node_id": "IC_kwDOAm_5kc5NBrza",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-26T16:14:49Z",
    "updated_at": "2022-10-26T16:18:17Z",
    "author_association": "MEMBER",
    "body": "Output:\r\n```\r\n/solidity/libsolidity/codegen/ABIFunctions.cpp(1174): Throw in function std::string solidity::frontend::ABIFunctions::abiDecodingFunctionArrayAvailableLength(const solidity::frontend::ArrayType&, bool)\r\nDynamic exception type: boost::wrapexcept<solidity::langutil::InternalCompilerError>\r\nstd::exception::what: Solidity assertion failed\r\n[solidity::util::tag_comment*] = Solidity assertion failed\r\n```\r\n\r\nThis started happening in 0.8.8.\r\n\r\nThe `[0]` part seems important here. I think it should actually be a type error since `int[0]` is not a valid type (i.e. you cannot have a variable of this type). So given that, impact would be indeed low - this code would not work even if it wasn't causing an ICE. \r\n\r\nBut there's another case that's a bit more worrying:\r\n```solidity\r\ncontract C {\r\n    function f() public {\r\n        abi.encode(abi.decode(\"\", (int[0])));\r\n    }\r\n}\r\n```\r\nThis compiles just fine and it shouldn't. You probably cannot assign the result of that decoding to anything (because it's of type that does not exist) but as you can see above you can e.g. encode it again. This has a higher impact but it's still pretty unlikely to happen in practice other than by mistake so still not high enough for `medium`.\r\n\r\nOn the other hand I'd say that the effort is low so it's worth fixing. I think it only needs an extra check at the analysis stage. Cases that do the wrong thing without reporting an error are dangerous. Technically, it could classify as a codegen error.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1292287194/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1294893713",
    "html_url": "https://github.com/ethereum/solidity/issues/13652#issuecomment-1294893713",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13652",
    "id": 1294893713,
    "node_id": "IC_kwDOAm_5kc5NLoKR",
    "user": {
      "login": "Krish-bhardwaj",
      "id": 72294477,
      "node_id": "MDQ6VXNlcjcyMjk0NDc3",
      "avatar_url": "https://avatars.githubusercontent.com/u/72294477?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Krish-bhardwaj",
      "html_url": "https://github.com/Krish-bhardwaj",
      "followers_url": "https://api.github.com/users/Krish-bhardwaj/followers",
      "following_url": "https://api.github.com/users/Krish-bhardwaj/following{/other_user}",
      "gists_url": "https://api.github.com/users/Krish-bhardwaj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Krish-bhardwaj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Krish-bhardwaj/subscriptions",
      "organizations_url": "https://api.github.com/users/Krish-bhardwaj/orgs",
      "repos_url": "https://api.github.com/users/Krish-bhardwaj/repos",
      "events_url": "https://api.github.com/users/Krish-bhardwaj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Krish-bhardwaj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-28T11:41:19Z",
    "updated_at": "2022-10-28T11:41:19Z",
    "author_association": "NONE",
    "body": "Hi @cameel I would like to get started with this issue can you give me a brief overview of how to get started with this ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1294893713/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1294913283",
    "html_url": "https://github.com/ethereum/solidity/issues/13652#issuecomment-1294913283",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13652",
    "id": 1294913283,
    "node_id": "IC_kwDOAm_5kc5NLs8D",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-28T12:02:21Z",
    "updated_at": "2022-10-28T12:06:39Z",
    "author_association": "MEMBER",
    "body": "@Krish-bhardwaj Take this example:\r\n```solidity\r\ncontract C {\r\n    int[0] x;\r\n}\r\n```\r\nIt currently produces an error:\r\n```\r\nError: Array with zero length specified.\r\n --> test.sol:2:9:\r\n  |\r\n2 |     int[0] x;\r\n  |         ^\r\n```\r\n\r\nThe example from this issue should be reporting the same error.\r\n\r\nThe error is reported by [`DeclarationTypeChecker::endVisit(ArrayTypeName)`](https://github.com/ethereum/solidity/blob/v0.8.17/libsolidity/analysis/DeclarationTypeChecker.cpp#L280-L327). Probably one of the conditions in that function makes it skip checking `abi.decode()`. Pass the test case from the issue though `solc` and using a debugger find out why exactly the check is skipped. Then modify the code so that it's no longer skipped. Note that this will likely make other things break so you'll need to find a solution that keeps them working while also solving the problem.\r\n\r\nAlso, try to explore similar cases. When you fix it, try using zero-length arrays in various ways and make sure none of them is broken the same way `abi.decode()` is now. Try various places where it's possible to use a type (`using for`, `type()`, UDVT declarations, parameter lists, error/event declarations, function pointer arguments, type tuples, struct fields and anything else you can think of). Also try wrapping the zero-length part in various ways - e.g. like in this issue it's a part of a dynamic array, which is probably part of the reason why it's not detected. Add the cases you try as new test cases, even if they don't crash the compiler (unless we already have them). They're still useful as regression tests and overall for better coverage of features.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1294913283/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 1
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1295029111",
    "html_url": "https://github.com/ethereum/solidity/issues/13652#issuecomment-1295029111",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13652",
    "id": 1295029111,
    "node_id": "IC_kwDOAm_5kc5NMJN3",
    "user": {
      "login": "Krish-bhardwaj",
      "id": 72294477,
      "node_id": "MDQ6VXNlcjcyMjk0NDc3",
      "avatar_url": "https://avatars.githubusercontent.com/u/72294477?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Krish-bhardwaj",
      "html_url": "https://github.com/Krish-bhardwaj",
      "followers_url": "https://api.github.com/users/Krish-bhardwaj/followers",
      "following_url": "https://api.github.com/users/Krish-bhardwaj/following{/other_user}",
      "gists_url": "https://api.github.com/users/Krish-bhardwaj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Krish-bhardwaj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Krish-bhardwaj/subscriptions",
      "organizations_url": "https://api.github.com/users/Krish-bhardwaj/orgs",
      "repos_url": "https://api.github.com/users/Krish-bhardwaj/repos",
      "events_url": "https://api.github.com/users/Krish-bhardwaj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Krish-bhardwaj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-28T13:53:30Z",
    "updated_at": "2022-10-28T13:53:30Z",
    "author_association": "NONE",
    "body": "@cameel before this i have never worked on developing compiler can you assist me how should i set up this C++ project ! \r\n\r\ni have read through your docs but i don't have much of clarity on the project set up . ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1295029111/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1302212160",
    "html_url": "https://github.com/ethereum/solidity/issues/13652#issuecomment-1302212160",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13652",
    "id": 1302212160,
    "node_id": "IC_kwDOAm_5kc5Nni5A",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-03T14:37:33Z",
    "updated_at": "2022-11-03T14:37:33Z",
    "author_association": "MEMBER",
    "body": "@Krish-bhardwaj I'm off this week, but if you need help please come to the [#solidity-dev](https://app.element.io/#/room/#ethereum_solidity-dev:gitter.im) channel, you'll always find someone from the team there. Setting up for development is mostly a matter of cloning the repo, installing the dependencies and making sure you can run tests. This is covered by the [Contributing](https://docs.soliditylang.org/en/latest/contributing.html) page, but if something is missing, let us know (or just open an issue :)).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1302212160/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
