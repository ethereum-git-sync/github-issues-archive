{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/5826",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/5826/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/5826/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/5826/events",
  "html_url": "https://github.com/ethereum/solidity/issues/5826",
  "id": 401074839,
  "node_id": "MDU6SXNzdWU0MDEwNzQ4Mzk=",
  "number": 5826,
  "title": "reduce gas cost for returning big struct list on deployment",
  "user": {
    "login": "aihuawu",
    "id": 40734222,
    "node_id": "MDQ6VXNlcjQwNzM0MjIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/40734222?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/aihuawu",
    "html_url": "https://github.com/aihuawu",
    "followers_url": "https://api.github.com/users/aihuawu/followers",
    "following_url": "https://api.github.com/users/aihuawu/following{/other_user}",
    "gists_url": "https://api.github.com/users/aihuawu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/aihuawu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/aihuawu/subscriptions",
    "organizations_url": "https://api.github.com/users/aihuawu/orgs",
    "repos_url": "https://api.github.com/users/aihuawu/repos",
    "events_url": "https://api.github.com/users/aihuawu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/aihuawu/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 9,
  "created_at": "2019-01-20T08:27:15Z",
  "updated_at": "2019-01-24T11:42:23Z",
  "closed_at": "2019-01-24T11:42:23Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "It seems the EVM has a hard gas limit around 6.7M for deployment. So I need to reduce gas.\r\n\r\nWhen I return a big struct list from a contract, it can consume a lot of gas for deployment.\r\nIf I have a lot of query functions which return the same kind of struct list, it is obvious they share the\r\nsame kind of serialization code for the struct list, is it possible for me to factor those serialization code out? then I can save gas for deployment.\r\n\r\n\r\n\tfunction f1() \r\n\tpublic view\r\n\treturns(OrderEntry[] memory)\r\n\t{\r\n\t\t//.....\r\n\t}\r\n\r\n\r\n\tfunction f2() \r\n\tpublic view\r\n\treturns(OrderEntry[] memory)\r\n\t{\r\n\t\t//.....\r\n\t}\r\n\t// .......\r\n\r\nGeorge Wu\r\n",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/5826/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/5826/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/456042327",
    "html_url": "https://github.com/ethereum/solidity/issues/5826#issuecomment-456042327",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5826",
    "id": 456042327,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NjA0MjMyNw==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-21T11:29:31Z",
    "updated_at": "2019-01-21T11:29:31Z",
    "author_association": "MEMBER",
    "body": "This should already be the case (at least in ABIEncoderV2, which you need if you return structs). How do the gas requirements grow when you add more functions that return the same type?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/456042327/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/456263309",
    "html_url": "https://github.com/ethereum/solidity/issues/5826#issuecomment-456263309",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5826",
    "id": 456263309,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NjI2MzMwOQ==",
    "user": {
      "login": "aihuawu",
      "id": 40734222,
      "node_id": "MDQ6VXNlcjQwNzM0MjIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/40734222?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aihuawu",
      "html_url": "https://github.com/aihuawu",
      "followers_url": "https://api.github.com/users/aihuawu/followers",
      "following_url": "https://api.github.com/users/aihuawu/following{/other_user}",
      "gists_url": "https://api.github.com/users/aihuawu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aihuawu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aihuawu/subscriptions",
      "organizations_url": "https://api.github.com/users/aihuawu/orgs",
      "repos_url": "https://api.github.com/users/aihuawu/repos",
      "events_url": "https://api.github.com/users/aihuawu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aihuawu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-22T03:56:34Z",
    "updated_at": "2019-01-22T03:56:34Z",
    "author_association": "NONE",
    "body": "Thanks. I see.\r\nSo it is refactored out for the common type. I have not done accurate experiments.\r\nThere is another similar issue:\r\nI return array of struct which is storage reference, so it will be converted to memory, and then be serialized. I am wondering if the storage to memory is also optimized to save deployment gas.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/456263309/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/456338008",
    "html_url": "https://github.com/ethereum/solidity/issues/5826#issuecomment-456338008",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5826",
    "id": 456338008,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NjMzODAwOA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-22T09:54:02Z",
    "updated_at": "2019-01-22T09:54:02Z",
    "author_association": "MEMBER",
    "body": "As far as I can tell, it should directly encode from storage. Which optimizations would you expect for the storage to memory copy?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/456338008/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/456398652",
    "html_url": "https://github.com/ethereum/solidity/issues/5826#issuecomment-456398652",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5826",
    "id": 456398652,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NjM5ODY1Mg==",
    "user": {
      "login": "aihuawu",
      "id": 40734222,
      "node_id": "MDQ6VXNlcjQwNzM0MjIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/40734222?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aihuawu",
      "html_url": "https://github.com/aihuawu",
      "followers_url": "https://api.github.com/users/aihuawu/followers",
      "following_url": "https://api.github.com/users/aihuawu/following{/other_user}",
      "gists_url": "https://api.github.com/users/aihuawu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aihuawu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aihuawu/subscriptions",
      "organizations_url": "https://api.github.com/users/aihuawu/orgs",
      "repos_url": "https://api.github.com/users/aihuawu/repos",
      "events_url": "https://api.github.com/users/aihuawu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aihuawu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-22T13:27:32Z",
    "updated_at": "2019-01-22T13:27:32Z",
    "author_association": "NONE",
    "body": "Currently I must split a big contract to a lot of small contracts.\r\nI am not sure if I am doing the right thing. To deploy a contract, it can't go above the 6.7 M gas.\r\n\r\nEach contract has some storage, it must make the storage be accessible to other contracts.\r\nSo it has to pass memory struct instead of storage struct. I find this is very expensive for the communications between contracts.  I believe it would be good to do memory copy only once if I have a lot of methods to access other contract's storage.\r\n\r\nGeorge Wu",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/456398652/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/456401405",
    "html_url": "https://github.com/ethereum/solidity/issues/5826#issuecomment-456401405",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5826",
    "id": 456401405,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NjQwMTQwNQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-22T13:36:40Z",
    "updated_at": "2019-01-22T13:36:40Z",
    "author_association": "MEMBER",
    "body": "Did you try using libraries and passing actual storage pointers?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/456401405/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/456402022",
    "html_url": "https://github.com/ethereum/solidity/issues/5826#issuecomment-456402022",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5826",
    "id": 456402022,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NjQwMjAyMg==",
    "user": {
      "login": "aihuawu",
      "id": 40734222,
      "node_id": "MDQ6VXNlcjQwNzM0MjIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/40734222?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aihuawu",
      "html_url": "https://github.com/aihuawu",
      "followers_url": "https://api.github.com/users/aihuawu/followers",
      "following_url": "https://api.github.com/users/aihuawu/following{/other_user}",
      "gists_url": "https://api.github.com/users/aihuawu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aihuawu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aihuawu/subscriptions",
      "organizations_url": "https://api.github.com/users/aihuawu/orgs",
      "repos_url": "https://api.github.com/users/aihuawu/repos",
      "events_url": "https://api.github.com/users/aihuawu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aihuawu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-22T13:38:57Z",
    "updated_at": "2019-01-22T13:38:57Z",
    "author_association": "NONE",
    "body": "I really don't know how to do that. You mean I can pass storage pointers between contracts.\r\nThat should save me a lot of gas.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/456402022/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/456402800",
    "html_url": "https://github.com/ethereum/solidity/issues/5826#issuecomment-456402800",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5826",
    "id": 456402800,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NjQwMjgwMA==",
    "user": {
      "login": "aihuawu",
      "id": 40734222,
      "node_id": "MDQ6VXNlcjQwNzM0MjIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/40734222?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aihuawu",
      "html_url": "https://github.com/aihuawu",
      "followers_url": "https://api.github.com/users/aihuawu/followers",
      "following_url": "https://api.github.com/users/aihuawu/following{/other_user}",
      "gists_url": "https://api.github.com/users/aihuawu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aihuawu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aihuawu/subscriptions",
      "organizations_url": "https://api.github.com/users/aihuawu/orgs",
      "repos_url": "https://api.github.com/users/aihuawu/repos",
      "events_url": "https://api.github.com/users/aihuawu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aihuawu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-22T13:41:36Z",
    "updated_at": "2019-01-22T13:41:36Z",
    "author_association": "NONE",
    "body": "Is there a simple example to show me how to access other contract's storage?\r\nIt doesn't even compile for public method with storage references.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/456402800/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/456405581",
    "html_url": "https://github.com/ethereum/solidity/issues/5826#issuecomment-456405581",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5826",
    "id": 456405581,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NjQwNTU4MQ==",
    "user": {
      "login": "aihuawu",
      "id": 40734222,
      "node_id": "MDQ6VXNlcjQwNzM0MjIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/40734222?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aihuawu",
      "html_url": "https://github.com/aihuawu",
      "followers_url": "https://api.github.com/users/aihuawu/followers",
      "following_url": "https://api.github.com/users/aihuawu/following{/other_user}",
      "gists_url": "https://api.github.com/users/aihuawu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aihuawu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aihuawu/subscriptions",
      "organizations_url": "https://api.github.com/users/aihuawu/orgs",
      "repos_url": "https://api.github.com/users/aihuawu/repos",
      "events_url": "https://api.github.com/users/aihuawu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aihuawu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-22T13:50:03Z",
    "updated_at": "2019-01-22T13:50:03Z",
    "author_association": "NONE",
    "body": "You mean pass contract storage reference to library? I am doing that. Just the library can't reduce gas for the contract. Maybe I should deploy library separately. It is a good suggestion. I may try that.\r\nThanks.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/456405581/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/457167817",
    "html_url": "https://github.com/ethereum/solidity/issues/5826#issuecomment-457167817",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/5826",
    "id": 457167817,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NzE2NzgxNw==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-24T11:42:23Z",
    "updated_at": "2019-01-24T11:42:23Z",
    "author_association": "MEMBER",
    "body": "Closing this for now.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/457167817/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
