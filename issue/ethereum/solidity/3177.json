{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/3177",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/3177/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/3177/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/3177/events",
  "html_url": "https://github.com/ethereum/solidity/issues/3177",
  "id": 271714544,
  "node_id": "MDU6SXNzdWUyNzE3MTQ1NDQ=",
  "number": 3177,
  "title": "Using a struct in a public function with ABIEncoderV2",
  "user": {
    "login": "naddison36",
    "id": 6491112,
    "node_id": "MDQ6VXNlcjY0OTExMTI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6491112?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/naddison36",
    "html_url": "https://github.com/naddison36",
    "followers_url": "https://api.github.com/users/naddison36/followers",
    "following_url": "https://api.github.com/users/naddison36/following{/other_user}",
    "gists_url": "https://api.github.com/users/naddison36/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/naddison36/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/naddison36/subscriptions",
    "organizations_url": "https://api.github.com/users/naddison36/orgs",
    "repos_url": "https://api.github.com/users/naddison36/repos",
    "events_url": "https://api.github.com/users/naddison36/events{/privacy}",
    "received_events_url": "https://api.github.com/users/naddison36/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2017-11-07T05:33:29Z",
  "updated_at": "2017-12-04T15:34:13Z",
  "closed_at": "2017-11-16T12:22:39Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "The following code compiles using solidity version 0.4.18+commit.9cf6e910 on Mac OSX\r\n```\r\npragma solidity ^0.4.18;\r\npragma experimental ABIEncoderV2;\r\n\r\ncontract TestContract\r\n{\r\n    struct TestStruct {\r\n        uint256 id;\r\n        string desc;\r\n    }\r\n\r\n    TestStruct[] tests;\r\n\r\n    function addTestStruct(TestStruct testStruct) internal\r\n    {\r\n        tests.push(testStruct);\r\n    }\r\n}\r\n```\r\n\r\nIf I change the `addTestStruct` function from `internal` to `public`, then I get the following error:\r\n`InternalCompilerError: Static memory load of more than 32 bytes requested.`\r\n\r\nI've tried numerous ways of declaring the struct as public.\r\n\r\nExpected result is a struct can be passed into a public function when using `ABIEncoderV2`",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/3177/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/3177/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/344724582",
    "html_url": "https://github.com/ethereum/solidity/issues/3177#issuecomment-344724582",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3177",
    "id": 344724582,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NDcyNDU4Mg==",
    "user": {
      "login": "Tootoot222",
      "id": 300221,
      "node_id": "MDQ6VXNlcjMwMDIyMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/300221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Tootoot222",
      "html_url": "https://github.com/Tootoot222",
      "followers_url": "https://api.github.com/users/Tootoot222/followers",
      "following_url": "https://api.github.com/users/Tootoot222/following{/other_user}",
      "gists_url": "https://api.github.com/users/Tootoot222/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Tootoot222/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Tootoot222/subscriptions",
      "organizations_url": "https://api.github.com/users/Tootoot222/orgs",
      "repos_url": "https://api.github.com/users/Tootoot222/repos",
      "events_url": "https://api.github.com/users/Tootoot222/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Tootoot222/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-15T20:52:23Z",
    "updated_at": "2017-11-15T20:52:45Z",
    "author_association": "NONE",
    "body": "I have the same bug, but it's even worse with libraries\r\n\r\n```\r\npragma solidity ^0.4.18;\r\npragma experimental ABIEncoderV2;\r\n\r\nlibrary Arg {\r\n    struct Struct {\r\n        uint256 a;\r\n        uint256 b;\r\n    }\r\n    \r\n    function modifyStruct(Struct arg)\r\n    //internal\r\n    public\r\n    pure returns (\r\n        uint256,\r\n        uint256\r\n    ) {\r\n        return (arg.a + 5, arg.b + 3);\r\n    }\r\n}\r\n\r\ncontract StructMemArg {\r\n\r\n    function buildStruct(\r\n        uint256 a,\r\n        uint256 b\r\n    ) public pure returns (\r\n        uint256,\r\n        uint256\r\n    ) {\r\n        return (Arg.modifyStruct(Arg.Struct({\r\n            a: a,\r\n            b: b\r\n        })));\r\n    }\r\n}\r\n```\r\n\r\nChanging the function in the library from public to internal makes it work, but the internal keyword \"inlines\" the library code into the main contract, which bloats the main contract and defeats the purpose of separating the code out into a library. You don't even need to link the contract and the library when the library function (the only one in this simple example) is internal, which means that the code is included in the main contract.\r\n\r\nThis is a serious problem for me since the reason I started using libraries was because my contract was getting to be too big... and my structs are much more complex than in this example, which, combined with the 16 local variable limit, makes it impossible to easily pass data around between library functions and the contract that uses them, without approaching the block gas limit due to including all the library code in the main contract.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/344724582/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/344907371",
    "html_url": "https://github.com/ethereum/solidity/issues/3177#issuecomment-344907371",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3177",
    "id": 344907371,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NDkwNzM3MQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-16T12:22:39Z",
    "updated_at": "2017-11-16T12:22:39Z",
    "author_association": "MEMBER",
    "body": "The decoder is not yet finished: https://github.com/ethereum/solidity/pull/2863",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/344907371/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/348835079",
    "html_url": "https://github.com/ethereum/solidity/issues/3177#issuecomment-348835079",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3177",
    "id": 348835079,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODgzNTA3OQ==",
    "user": {
      "login": "naddison36",
      "id": 6491112,
      "node_id": "MDQ6VXNlcjY0OTExMTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6491112?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naddison36",
      "html_url": "https://github.com/naddison36",
      "followers_url": "https://api.github.com/users/naddison36/followers",
      "following_url": "https://api.github.com/users/naddison36/following{/other_user}",
      "gists_url": "https://api.github.com/users/naddison36/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naddison36/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naddison36/subscriptions",
      "organizations_url": "https://api.github.com/users/naddison36/orgs",
      "repos_url": "https://api.github.com/users/naddison36/repos",
      "events_url": "https://api.github.com/users/naddison36/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naddison36/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-04T00:54:04Z",
    "updated_at": "2017-12-04T00:54:04Z",
    "author_association": "NONE",
    "body": "I can confirm this problem has been fixed with Solidity 0.4.19. Thanks",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/348835079/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
