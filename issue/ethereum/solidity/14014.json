{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/14014",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/14014/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/14014/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/14014/events",
  "html_url": "https://github.com/ethereum/solidity/issues/14014",
  "id": 1599278507,
  "node_id": "I_kwDOAm_5kc5fUw2r",
  "number": 14014,
  "title": "Unable to run SMTChecker command line tests",
  "user": {
    "login": "0xPhaze",
    "id": 103113487,
    "node_id": "U_kgDOBiVjDw",
    "avatar_url": "https://avatars.githubusercontent.com/u/103113487?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/0xPhaze",
    "html_url": "https://github.com/0xPhaze",
    "followers_url": "https://api.github.com/users/0xPhaze/followers",
    "following_url": "https://api.github.com/users/0xPhaze/following{/other_user}",
    "gists_url": "https://api.github.com/users/0xPhaze/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/0xPhaze/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/0xPhaze/subscriptions",
    "organizations_url": "https://api.github.com/users/0xPhaze/orgs",
    "repos_url": "https://api.github.com/users/0xPhaze/repos",
    "events_url": "https://api.github.com/users/0xPhaze/events{/privacy}",
    "received_events_url": "https://api.github.com/users/0xPhaze/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-02-24T21:09:17Z",
  "updated_at": "2023-02-25T10:04:21Z",
  "closed_at": "2023-02-25T10:04:20Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nI'm unable to run the SMTChecker command line tests. The warning I get is: `\"Solver z3 was selected for SMTChecker but it is not available\"`. \r\n\r\nWhat I've tried:\r\n- I can run `z3` (Z3 version 4.11.2 - 64 bit) (and the python formal tests for what it's worth)\r\n- Compiled [z3 from the github repository](https://github.com/Z3Prover/z3) and included `libz3.dylib` in `deps`\r\n- added `export DYLD_LIBRARY_PATH=\"/Users/lain/git/tools/z3/build\"`\r\n\r\nWhen searching for the warning in the code, I always see a search for \"libz3.so.\" (a linux library). Perhaps this isn't compatible with mac?\r\n\r\n## Environment\r\n\r\n- Compiler version: 0.8.20\r\n- Operating system: macOS Ventura 13.2.1\r\n\r\n## Steps to Reproduce\r\n\r\nRunning `test/cmdlineTests.sh` produces the following output.\r\n\r\n```\r\nUsing solc binary at /Users/lain/git/eth/solidity/build/solc/solc\r\nChecking that the bug list is up to date...\r\nTesting unknown options...\r\nPassed\r\nTesting passing files that are not found...\r\nTesting passing files that are not files...\r\nTesting passing empty remappings...\r\nRunning general commandline tests...\r\n - abiencoderv2_no_warning\r\n - asm_json\r\n - asm_json_no_pretty_print\r\n - ast_compact_json_no_pretty_json\r\n - ast_compact_json_with_base_path\r\n - ast_json_import_wrong_evmVersion\r\n - combined_json_abi\r\n - combined_json_generated_sources\r\n - combined_json_no_pretty_print\r\n - combined_json_with_base_path\r\n - combined_json_with_devdoc\r\n - combined_json_with_userdoc\r\n - constant_optimizer_yul\r\n - debug_info_in_yul_and_evm_asm_print_all\r\n - debug_info_in_yul_and_evm_asm_print_all_and_none\r\n - debug_info_in_yul_and_evm_asm_print_location_only\r\n - debug_info_in_yul_and_evm_asm_print_none\r\n - debug_info_in_yul_and_evm_asm_print_snippet_only\r\n - debug_info_in_yul_snippet_escaping\r\n - dup_opt_peephole\r\n - error_codes\r\n - evm_to_wasm\r\n - evm_to_wasm_break\r\n - evm_to_wasm_output_selection_asm_only\r\n - evm_to_wasm_output_selection_ewasm_ir_only\r\n - evm_to_wasm_output_selection_ewasm_only\r\n - evm_to_wasm_unsupported_translation\r\n - evmasm_difficulty_post_paris\r\n - evmasm_difficulty_pre_paris\r\n - evmasm_prevrandao_post_paris\r\n - evmasm_prevrandao_pre_paris\r\n - exp_base_literal\r\n - function_debug_info\r\n - function_debug_info_via_yul\r\n - hashes\r\n - inline_assembly_function_name_clash\r\n - ir_compiler_inheritance_nosubobjects\r\n - ir_compiler_subobjects\r\n - ir_with_assembly_no_memoryguard_creation\r\n - ir_with_assembly_no_memoryguard_runtime\r\n - keccak_optimization_deploy_code\r\n - keccak_optimization_low_runs\r\n - linker_mode_invalid_option_no_optimize_yul\r\n - linker_mode_invalid_option_optimize\r\n - linker_mode_invalid_option_optimize_runs\r\n - linker_mode_invalid_option_optimize_yul\r\n - linker_mode_invalid_option_yul_optimizations\r\n - linker_mode_output_selection_invalid\r\n - linking_qualified_library_name\r\n - linking_solidity\r\n - linking_solidity_unresolved_references\r\n - linking_standard_solidity\r\n - linking_standard_solidity_quote_in_file_name\r\n - linking_standard_solidity_unresolved_references\r\n - linking_standard_yul\r\n - linking_standard_yul_quote_in_file_name\r\n - linking_standard_yul_unresolved_references\r\n - linking_strict_assembly\r\n - linking_strict_assembly_duplicate_library_name\r\n - linking_strict_assembly_qualified_library_qualified_reference\r\n - linking_strict_assembly_qualified_library_unqualified_reference\r\n - linking_strict_assembly_same_library_name_different_files\r\n - linking_strict_assembly_same_library_name_different_files_in_link_references\r\n - linking_strict_assembly_unqualified_library_qualified_reference\r\n - linking_strict_assembly_unqualified_library_unqualified_reference\r\n - linking_strict_assembly_unresolved_references\r\n - linking_unqualified_library_name\r\n - message_format\r\n - message_format_utf8\r\n - model_checker_contracts_all\r\nIncorrect output on stderr received. Expected:\r\nWarning: CHC: Assertion violation happens here.\r\nCounterexample:\r\n\r\nx = 0\r\n\r\nTransaction trace:\r\nB.constructor()\r\nB.f(0)\r\n --> model_checker_contracts_all/input.sol:5:3:\r\n  |\r\n5 |             assert(x > 0);\r\n  |             ^^^^^^^^^^^^^\r\n\r\nWarning: CHC: Assertion violation happens here.\r\nCounterexample:\r\n\r\ny = 0\r\n\r\nTransaction trace:\r\nA.constructor()\r\nA.g(0)\r\n  --> model_checker_contracts_all/input.sol:10:3:\r\n   |\r\n10 |            assert(y > 0);\r\n   |            ^^^^^^^^^^^^^\r\nBut got:\r\nWarning: Solver z3 was selected for SMTChecker but it is not available.\r\n\r\nWarning: CHC analysis was not possible since no Horn solver was found and enabled. The accepted solvers for CHC are Eldarica and z3.\r\n\r\nWarning: BMC analysis was not possible since no SMT solver was found and enabled. The accepted solvers for BMC are cvc4 and z3.\r\nWhen running /Users/lain/git/eth/solidity/build/solc/solc --model-checker-engine all model_checker_contracts_all/input.sol </dev/stdin\r\n(e)dit/(u)pdate expectations/(s)kip/(q)uit? \r\n```\r\n\r\nOnly somewhat relevant issue I could find:\r\n- https://github.com/ethereum/solidity/issues/13073",
  "closed_by": {
    "login": "0xPhaze",
    "id": 103113487,
    "node_id": "U_kgDOBiVjDw",
    "avatar_url": "https://avatars.githubusercontent.com/u/103113487?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/0xPhaze",
    "html_url": "https://github.com/0xPhaze",
    "followers_url": "https://api.github.com/users/0xPhaze/followers",
    "following_url": "https://api.github.com/users/0xPhaze/following{/other_user}",
    "gists_url": "https://api.github.com/users/0xPhaze/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/0xPhaze/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/0xPhaze/subscriptions",
    "organizations_url": "https://api.github.com/users/0xPhaze/orgs",
    "repos_url": "https://api.github.com/users/0xPhaze/repos",
    "events_url": "https://api.github.com/users/0xPhaze/events{/privacy}",
    "received_events_url": "https://api.github.com/users/0xPhaze/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/14014/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/14014/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1445038505",
    "html_url": "https://github.com/ethereum/solidity/issues/14014#issuecomment-1445038505",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14014",
    "id": 1445038505,
    "node_id": "IC_kwDOAm_5kc5WIYmp",
    "user": {
      "login": "leonardoalt",
      "id": 504195,
      "node_id": "MDQ6VXNlcjUwNDE5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/504195?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/leonardoalt",
      "html_url": "https://github.com/leonardoalt",
      "followers_url": "https://api.github.com/users/leonardoalt/followers",
      "following_url": "https://api.github.com/users/leonardoalt/following{/other_user}",
      "gists_url": "https://api.github.com/users/leonardoalt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/leonardoalt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leonardoalt/subscriptions",
      "organizations_url": "https://api.github.com/users/leonardoalt/orgs",
      "repos_url": "https://api.github.com/users/leonardoalt/repos",
      "events_url": "https://api.github.com/users/leonardoalt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/leonardoalt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-25T09:19:24Z",
    "updated_at": "2023-02-25T09:19:24Z",
    "author_association": "MEMBER",
    "body": "The SMTChecker only does dynamic loading with dlopen on Linux (the libz3.so you found), on OSX it needs to be linked at compile time (now I'm not sure whether both dynamic and static work here, though I'm sure static does).\n\nIf you're running the solidity tests I'm assuming you're compiling the compiler yourself, is that correct? If that's the case, you can enable USE_Z3 on CMake before compilation which should include z3.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1445038505/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1445045997",
    "html_url": "https://github.com/ethereum/solidity/issues/14014#issuecomment-1445045997",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14014",
    "id": 1445045997,
    "node_id": "IC_kwDOAm_5kc5WIabt",
    "user": {
      "login": "0xPhaze",
      "id": 103113487,
      "node_id": "U_kgDOBiVjDw",
      "avatar_url": "https://avatars.githubusercontent.com/u/103113487?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/0xPhaze",
      "html_url": "https://github.com/0xPhaze",
      "followers_url": "https://api.github.com/users/0xPhaze/followers",
      "following_url": "https://api.github.com/users/0xPhaze/following{/other_user}",
      "gists_url": "https://api.github.com/users/0xPhaze/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/0xPhaze/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0xPhaze/subscriptions",
      "organizations_url": "https://api.github.com/users/0xPhaze/orgs",
      "repos_url": "https://api.github.com/users/0xPhaze/repos",
      "events_url": "https://api.github.com/users/0xPhaze/events{/privacy}",
      "received_events_url": "https://api.github.com/users/0xPhaze/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-25T10:04:20Z",
    "updated_at": "2023-02-25T10:04:20Z",
    "author_association": "NONE",
    "body": "Unable to try this out atm, but I assume that will do the trick. Thanks.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1445045997/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
