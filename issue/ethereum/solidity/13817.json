{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/13817",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/13817/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/13817/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/13817/events",
  "html_url": "https://github.com/ethereum/solidity/issues/13817",
  "id": 1501853166,
  "node_id": "I_kwDOAm_5kc5ZhHXu",
  "number": 13817,
  "title": "Improve documentation on Yul standard cleanup sequence",
  "user": {
    "login": "pcaversaccio",
    "id": 25297591,
    "node_id": "MDQ6VXNlcjI1Mjk3NTkx",
    "avatar_url": "https://avatars.githubusercontent.com/u/25297591?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pcaversaccio",
    "html_url": "https://github.com/pcaversaccio",
    "followers_url": "https://api.github.com/users/pcaversaccio/followers",
    "following_url": "https://api.github.com/users/pcaversaccio/following{/other_user}",
    "gists_url": "https://api.github.com/users/pcaversaccio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pcaversaccio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pcaversaccio/subscriptions",
    "organizations_url": "https://api.github.com/users/pcaversaccio/orgs",
    "repos_url": "https://api.github.com/users/pcaversaccio/repos",
    "events_url": "https://api.github.com/users/pcaversaccio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pcaversaccio/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 275027668,
      "node_id": "MDU6TGFiZWwyNzUwMjc2Njg=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/documentation%20:book:",
      "name": "documentation :book:",
      "color": "006b75",
      "default": false,
      "description": ""
    },
    {
      "id": 4438006499,
      "node_id": "LA_kwDOAm_5kc8AAAABCIaa4w",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/low%20effort",
      "name": "low effort",
      "color": "ffb1fa",
      "default": false,
      "description": "There is not much implementation work to be done. The task is very easy or tiny."
    },
    {
      "id": 4438157609,
      "node_id": "LA_kwDOAm_5kc8AAAABCIjpKQ",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/low%20impact",
      "name": "low impact",
      "color": "5d71ff",
      "default": false,
      "description": "Changes are not very noticeable or potential benefits are limited."
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-12-18T10:30:10Z",
  "updated_at": "2023-02-13T21:43:26Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "This issue is based on a Twitter discussion with @leonardoalt. IMHO it would be very valuable to document what sequence is run if `optimizerSteps = ''` is set. Based on my analysis [here](https://twitter.com/pcaversaccio/status/1604192588352798723), the default Yul cleanup sequence is (which is only documented in the source code currently):\r\n- BlockFlattener (`f`)\r\n- DeadCodeEliminator (`D`)\r\n- ControlFlowSimplifier (`n`)\r\n- LiteralRematerialiser (`T`)\r\n- ForLoopConditionOutOfBody (`O`)\r\n- CommonSubexpressionEliminator (`c`)\r\n\r\nBut further things are actually run (see [here](https://twitter.com/leonardoalt/status/1604214614853668865)). There is further information as pointed out by @leonardoalt [here](https://twitter.com/leonardoalt/status/1604258182360186880), but still not clear what exactly is run in the case `optimizerSteps = ''`. Having a small section on this topic that clarifies everything would be highly valuable since the optimiser itself & its optimiser steps are already extremely complex.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/13817/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/13817/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1428091512",
    "html_url": "https://github.com/ethereum/solidity/issues/13817#issuecomment-1428091512",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13817",
    "id": 1428091512,
    "node_id": "IC_kwDOAm_5kc5VHvJ4",
    "user": {
      "login": "nikola-matic",
      "id": 4415530,
      "node_id": "MDQ6VXNlcjQ0MTU1MzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4415530?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikola-matic",
      "html_url": "https://github.com/nikola-matic",
      "followers_url": "https://api.github.com/users/nikola-matic/followers",
      "following_url": "https://api.github.com/users/nikola-matic/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikola-matic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikola-matic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikola-matic/subscriptions",
      "organizations_url": "https://api.github.com/users/nikola-matic/orgs",
      "repos_url": "https://api.github.com/users/nikola-matic/repos",
      "events_url": "https://api.github.com/users/nikola-matic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikola-matic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-13T15:02:22Z",
    "updated_at": "2023-02-13T15:02:22Z",
    "author_association": "MEMBER",
    "body": "Hey @pcaversaccio, the docs have changed a bit in 0.8.18 and do provide more info, however, are still a bit lacking when it comes to the optimizer step sequence, and this could be improved (especially with regards to completely hidden and undocumented steps like the stack compressor). In the meantime, the standard JSON docs are a bit more detailed.\r\nhttps://docs.soliditylang.org/en/v0.8.18/using-the-compiler.html\r\nNamely\r\n```\r\n        \"yulDetails\": {\r\n          // Improve allocation of stack slots for variables, can free up stack slots early.\r\n          // Activated by default if the Yul optimizer is activated.\r\n          \"stackAllocation\": true,\r\n          // Select optimization steps to be applied. It is also possible to modify both the\r\n          // optimization sequence and the clean-up sequence. Instructions for each sequence\r\n          // are separated with the \":\" delimiter and the values are provided in the form of\r\n          // optimization-sequence:clean-up-sequence. For more information see\r\n          // \"The Optimizer > Selecting Optimizations\".\r\n          // This field is optional, and if not provided, the default sequences for both\r\n          // optimization and clean-up are used. If only one of the options is provivded\r\n          // the other will not be run.\r\n          // If only the delimiter \":\" is provided then neither the optimization nor the clean-up\r\n          // sequence will be run.\r\n          // If set to an empty value, only the default clean-up sequence is used and\r\n          // no optimization steps are applied.\r\n          \"optimizerSteps\": \"dhfoDgvulfnTUtnIf...\"\r\n        }\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1428091512/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1428121323",
    "html_url": "https://github.com/ethereum/solidity/issues/13817#issuecomment-1428121323",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13817",
    "id": 1428121323,
    "node_id": "IC_kwDOAm_5kc5VH2br",
    "user": {
      "login": "pcaversaccio",
      "id": 25297591,
      "node_id": "MDQ6VXNlcjI1Mjk3NTkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25297591?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pcaversaccio",
      "html_url": "https://github.com/pcaversaccio",
      "followers_url": "https://api.github.com/users/pcaversaccio/followers",
      "following_url": "https://api.github.com/users/pcaversaccio/following{/other_user}",
      "gists_url": "https://api.github.com/users/pcaversaccio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pcaversaccio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pcaversaccio/subscriptions",
      "organizations_url": "https://api.github.com/users/pcaversaccio/orgs",
      "repos_url": "https://api.github.com/users/pcaversaccio/repos",
      "events_url": "https://api.github.com/users/pcaversaccio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pcaversaccio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-13T15:17:31Z",
    "updated_at": "2023-02-13T15:17:31Z",
    "author_association": "NONE",
    "body": "@nikola-matic thanks for pointing this out - I also noticed that the documentation for `0.8.18` has been improved. Nevertheless, as you also point out, there are still too many components that are undocumented and I hope this can be improved for solc `0.8.19`. I think this is a very important step in terms of transparency, as the current Yul optimiser is generally very complex and verbose, which can lead to a loss of confidence among engineers who want to understand every detail for security reasons.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1428121323/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1428729885",
    "html_url": "https://github.com/ethereum/solidity/issues/13817#issuecomment-1428729885",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13817",
    "id": 1428729885,
    "node_id": "IC_kwDOAm_5kc5VKLAd",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-13T21:43:25Z",
    "updated_at": "2023-02-13T21:43:25Z",
    "author_association": "MEMBER",
    "body": "At the very latest when we change the default behaviour (this has come up on multiple occasions, but I just explicitly created https://github.com/ethereum/solidity/issues/13972 for it), we definitely have to precisely document the behaviour. We can also try to find the time to improve this before that (since that'll likely not already be 0.8.19).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1428729885/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
