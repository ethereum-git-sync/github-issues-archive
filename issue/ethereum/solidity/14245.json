{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/14245",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/14245/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/14245/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/14245/events",
  "html_url": "https://github.com/ethereum/solidity/issues/14245",
  "id": 1715358538,
  "node_id": "I_kwDOAm_5kc5mPktK",
  "number": 14245,
  "title": "Events used in external library functions are not included in calling contract ABI",
  "user": {
    "login": "davidbrai",
    "id": 351026,
    "node_id": "MDQ6VXNlcjM1MTAyNg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/351026?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/davidbrai",
    "html_url": "https://github.com/davidbrai",
    "followers_url": "https://api.github.com/users/davidbrai/followers",
    "following_url": "https://api.github.com/users/davidbrai/following{/other_user}",
    "gists_url": "https://api.github.com/users/davidbrai/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/davidbrai/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/davidbrai/subscriptions",
    "organizations_url": "https://api.github.com/users/davidbrai/orgs",
    "repos_url": "https://api.github.com/users/davidbrai/repos",
    "events_url": "https://api.github.com/users/davidbrai/events{/privacy}",
    "received_events_url": "https://api.github.com/users/davidbrai/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 249074435,
      "node_id": "MDU6TGFiZWwyNDkwNzQ0MzU=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/bug%20:bug:",
      "name": "bug :bug:",
      "color": "fc1313",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-05-18T10:02:13Z",
  "updated_at": "2023-05-19T18:06:31Z",
  "closed_at": "2023-05-19T18:06:30Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi, it looks like events emitted by libs in functions that are called externally are not included in the calling contract's ABI.\r\nThis is when using solc 0.8.20\r\n\r\nHere's example code:\r\n\r\n```\r\npragma solidity ^0.8.20;\r\n\r\nlibrary L {\r\n\r\n    event E_external(uint256 n);\r\n    event E_internal(uint256 n);\r\n    event E_using_external(uint256 n);\r\n    event E_using_internal(uint256 n);\r\n\r\n    function f_external() external {\r\n        emit E_external(5);\r\n    }\r\n\r\n    function f_internal() internal {\r\n        emit E_internal(5);\r\n    }\r\n\r\n    function f_using_external(uint256 x) external {\r\n        emit E_using_external(x);\r\n    }\r\n\r\n    function f_using_internal(uint256 x) internal {\r\n        emit E_using_internal(x);\r\n    }\r\n}\r\n\r\ncontract Counter {\r\n    uint256 public number;\r\n\r\n    using L for uint256;\r\n\r\n    event E_event(uint256 n);\r\n\r\n    function g(uint256 x) public {\r\n        L.f_external();\r\n\r\n        L.f_internal();\r\n\r\n        emit E_event(7);\r\n\r\n        x.f_using_external();\r\n\r\n        x.f_using_internal();\r\n    }\r\n}\r\n\r\n```\r\n\r\nThe ABI for `Counter` includes the following events:\r\n`E_event`, `E_internal`, `E_using_internal`\r\n\r\nBut not:\r\n`E_external` & `E_using_external`\r\n\r\n",
  "closed_by": {
    "login": "NunoFilipeSantos",
    "id": 2582498,
    "node_id": "MDQ6VXNlcjI1ODI0OTg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2582498?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/NunoFilipeSantos",
    "html_url": "https://github.com/NunoFilipeSantos",
    "followers_url": "https://api.github.com/users/NunoFilipeSantos/followers",
    "following_url": "https://api.github.com/users/NunoFilipeSantos/following{/other_user}",
    "gists_url": "https://api.github.com/users/NunoFilipeSantos/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/NunoFilipeSantos/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/NunoFilipeSantos/subscriptions",
    "organizations_url": "https://api.github.com/users/NunoFilipeSantos/orgs",
    "repos_url": "https://api.github.com/users/NunoFilipeSantos/repos",
    "events_url": "https://api.github.com/users/NunoFilipeSantos/events{/privacy}",
    "received_events_url": "https://api.github.com/users/NunoFilipeSantos/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/14245/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/14245/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1553365533",
    "html_url": "https://github.com/ethereum/solidity/issues/14245#issuecomment-1553365533",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14245",
    "id": 1553365533,
    "node_id": "IC_kwDOAm_5kc5clnod",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-18T17:12:55Z",
    "updated_at": "2023-05-18T17:13:57Z",
    "author_association": "MEMBER",
    "body": "That's by design. The compiler can't be sure what events may be emitted by an external call. It's not just for events - it's been working like this with errors for quite a while now.\r\n\r\nEven if the source is available, in a general case there's no way for the compiler to ensure that at the time the call is executed the address will really contain the contract/library built from that source. It can be easily changed during deployment.\r\n\r\nEven if the compiler assumed that it must match the source, in many cases the source is not available anyway - e.g. when you call a contract via an interface or make a low-level call. In those cases the list of events would still be incomplete.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1553365533/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1554134724",
    "html_url": "https://github.com/ethereum/solidity/issues/14245#issuecomment-1554134724",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14245",
    "id": 1554134724,
    "node_id": "IC_kwDOAm_5kc5cojbE",
    "user": {
      "login": "davidbrai",
      "id": 351026,
      "node_id": "MDQ6VXNlcjM1MTAyNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/351026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/davidbrai",
      "html_url": "https://github.com/davidbrai",
      "followers_url": "https://api.github.com/users/davidbrai/followers",
      "following_url": "https://api.github.com/users/davidbrai/following{/other_user}",
      "gists_url": "https://api.github.com/users/davidbrai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/davidbrai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/davidbrai/subscriptions",
      "organizations_url": "https://api.github.com/users/davidbrai/orgs",
      "repos_url": "https://api.github.com/users/davidbrai/repos",
      "events_url": "https://api.github.com/users/davidbrai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/davidbrai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-19T07:14:01Z",
    "updated_at": "2023-05-19T07:14:01Z",
    "author_association": "NONE",
    "body": "@cameel I see. thanks for the quick reply.\r\n\r\nIs there any best practice on how to deal with it?\r\nCurrently we're copy-pasting the event definitions from the library to the calling contract.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1554134724/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1554583288",
    "html_url": "https://github.com/ethereum/solidity/issues/14245#issuecomment-1554583288",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14245",
    "id": 1554583288,
    "node_id": "IC_kwDOAm_5kc5cqQ74",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-19T13:32:01Z",
    "updated_at": "2023-05-19T13:32:01Z",
    "author_association": "MEMBER",
    "body": "The event is reported in the ABI of the library so I guess if you're interested in that information, you can get it from there if you know your contract uses that library.\r\n\r\nThis is potentially something that could be made easier at a higher level, i.e. in frameworks, which actually know how and where the contract gets deployed and therefore can make more assumptions.\r\n\r\nBy the way, what is your use case? What specifically do you use that information for? And what do you do when your contract calls another contract that emits an event you know nothing about? Especially when you have no access to the source or ABI of that contract.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1554583288/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1555045823",
    "html_url": "https://github.com/ethereum/solidity/issues/14245#issuecomment-1555045823",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14245",
    "id": 1555045823,
    "node_id": "IC_kwDOAm_5kc5csB2_",
    "user": {
      "login": "NunoFilipeSantos",
      "id": 2582498,
      "node_id": "MDQ6VXNlcjI1ODI0OTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2582498?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NunoFilipeSantos",
      "html_url": "https://github.com/NunoFilipeSantos",
      "followers_url": "https://api.github.com/users/NunoFilipeSantos/followers",
      "following_url": "https://api.github.com/users/NunoFilipeSantos/following{/other_user}",
      "gists_url": "https://api.github.com/users/NunoFilipeSantos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NunoFilipeSantos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NunoFilipeSantos/subscriptions",
      "organizations_url": "https://api.github.com/users/NunoFilipeSantos/orgs",
      "repos_url": "https://api.github.com/users/NunoFilipeSantos/repos",
      "events_url": "https://api.github.com/users/NunoFilipeSantos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NunoFilipeSantos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-19T18:06:30Z",
    "updated_at": "2023-05-19T18:06:30Z",
    "author_association": "MEMBER",
    "body": "If this is by design, let's close it.\r\nFeel free to reference it on any of our communication channels.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1555045823/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
