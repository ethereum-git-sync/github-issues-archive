{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/14769",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/14769/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/14769/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/14769/events",
  "html_url": "https://github.com/ethereum/solidity/issues/14769",
  "id": 2068180137,
  "node_id": "I_kwDOAm_5kc57Reyp",
  "number": 14769,
  "title": "Parser treats state variable visibility as function type visibility",
  "user": {
    "login": "alex1448",
    "id": 148193765,
    "node_id": "U_kgDOCNVB5Q",
    "avatar_url": "https://avatars.githubusercontent.com/u/148193765?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alex1448",
    "html_url": "https://github.com/alex1448",
    "followers_url": "https://api.github.com/users/alex1448/followers",
    "following_url": "https://api.github.com/users/alex1448/following{/other_user}",
    "gists_url": "https://api.github.com/users/alex1448/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alex1448/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alex1448/subscriptions",
    "organizations_url": "https://api.github.com/users/alex1448/orgs",
    "repos_url": "https://api.github.com/users/alex1448/repos",
    "events_url": "https://api.github.com/users/alex1448/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alex1448/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2024-01-05T23:27:12Z",
  "updated_at": "2024-01-06T15:02:08Z",
  "closed_at": "2024-01-06T14:59:44Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nParser treats state variable visibility of function types as a visibility for the function type itself in the code given bellow. In this example, ```f``` should be a private state variable of default (internal) function type. Instead it reports an error. The second declaration (of ```g```) works without a problem.\r\n\r\n```solidity\r\n// SPDX-License-Identifier: GPL-3.0\r\n\r\npragma solidity =0.8.23;\r\n\r\ncontract C {\r\n  function () private f;  // this is disallowed\r\n  function () returns (int) private g;  // this is ok\r\n}\r\n```\r\n\r\nCompiler output:\r\n\r\n```\r\nTypeError: Invalid visibility, can only be \"external\" or \"internal\".\r\n --> contracts/4_Test.sol:6:3:\r\n  |\r\n6 |   function () private f;  // this is disallowed\r\n  |   ^^^^^^^^^^^^^^^^^^^^^\r\n```\r\n\r\n## Environment\r\n\r\n- Compiler version: ```0.8.23``` or any older version\r\n",
  "closed_by": {
    "login": "cameel",
    "id": 137030,
    "node_id": "MDQ6VXNlcjEzNzAzMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cameel",
    "html_url": "https://github.com/cameel",
    "followers_url": "https://api.github.com/users/cameel/followers",
    "following_url": "https://api.github.com/users/cameel/following{/other_user}",
    "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
    "organizations_url": "https://api.github.com/users/cameel/orgs",
    "repos_url": "https://api.github.com/users/cameel/repos",
    "events_url": "https://api.github.com/users/cameel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cameel/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/14769/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/14769/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1879721550",
    "html_url": "https://github.com/ethereum/solidity/issues/14769#issuecomment-1879721550",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14769",
    "id": 1879721550,
    "node_id": "IC_kwDOAm_5kc5wCkZO",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2024-01-06T14:59:44Z",
    "updated_at": "2024-01-06T15:02:07Z",
    "author_association": "MEMBER",
    "body": "This works as intended. It's just that both of these visibility specifiers are optional. If you provide only one, the compiler has to make an assumption about which one you meant. In this case it decides to interpret it as the visibility of the function.\r\n\r\nSo `function () private f;` means `function () private internal f;`, which is invalid. If you mean `function () internal private f;` instead, you can bypass this default choice by writing it out in full.\r\n\r\nYou could argue that the compiler should not make this assumption and just reject the shorthand, but IMO in this case it's pretty harmless. It's unambiguous in the two variants that are allowed, so at worst you get an error and not a variable that has a different visibility than you think it does:\r\n- `function () internal f;` must mean `function () internal internal f;` because both visibilities default to `internal`.\r\n- `function () external f;` must mean `function () external internal f;` because state variables cannot have `external` visibility.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1879721550/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
