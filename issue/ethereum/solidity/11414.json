{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/11414",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/11414/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/11414/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/11414/events",
  "html_url": "https://github.com/ethereum/solidity/issues/11414",
  "id": 895399711,
  "node_id": "MDU6SXNzdWU4OTUzOTk3MTE=",
  "number": 11414,
  "title": "[Sol->Yul] Reverts due to underflow because of evaluation order",
  "user": {
    "login": "bshastry",
    "id": 2388185,
    "node_id": "MDQ6VXNlcjIzODgxODU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2388185?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bshastry",
    "html_url": "https://github.com/bshastry",
    "followers_url": "https://api.github.com/users/bshastry/followers",
    "following_url": "https://api.github.com/users/bshastry/following{/other_user}",
    "gists_url": "https://api.github.com/users/bshastry/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bshastry/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bshastry/subscriptions",
    "organizations_url": "https://api.github.com/users/bshastry/orgs",
    "repos_url": "https://api.github.com/users/bshastry/repos",
    "events_url": "https://api.github.com/users/bshastry/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bshastry/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 785717317,
      "node_id": "MDU6TGFiZWw3ODU3MTczMTc=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/language%20design%20:rage4:",
      "name": "language design :rage4:",
      "color": "9d76d3",
      "default": false,
      "description": "Any changes to the language, e.g. new features"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-05-19T12:44:05Z",
  "updated_at": "2021-06-08T19:20:41Z",
  "closed_at": "2021-06-08T19:20:32Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "```\r\ncontract C {\r\n  function f() external returns (bool) {\r\n    uint zero;\r\n    return zero-- != zero++;\r\n  }\r\n}\r\n// ====\r\n// compileViaYul: also\r\n// ----\r\n// f() -> true\r\n```\r\n\r\nThis test fails via Yul because of a change in evaluation order, the post decrement is evaluated first by the new code generator and because this results in an underflow/wraparound, the call reverts. The old code generator (due to eval being the other way round) does not revert and successfully executes through as expected.\r\n\r\nI suppose this is another way of exposing different evaluation orders between the old and new code generators, but filed this issue so more people can comment.",
  "closed_by": {
    "login": "bshastry",
    "id": 2388185,
    "node_id": "MDQ6VXNlcjIzODgxODU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2388185?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bshastry",
    "html_url": "https://github.com/bshastry",
    "followers_url": "https://api.github.com/users/bshastry/followers",
    "following_url": "https://api.github.com/users/bshastry/following{/other_user}",
    "gists_url": "https://api.github.com/users/bshastry/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bshastry/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bshastry/subscriptions",
    "organizations_url": "https://api.github.com/users/bshastry/orgs",
    "repos_url": "https://api.github.com/users/bshastry/repos",
    "events_url": "https://api.github.com/users/bshastry/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bshastry/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/11414/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/11414/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/844070578",
    "html_url": "https://github.com/ethereum/solidity/issues/11414#issuecomment-844070578",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11414",
    "id": 844070578,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NDA3MDU3OA==",
    "user": {
      "login": "bshastry",
      "id": 2388185,
      "node_id": "MDQ6VXNlcjIzODgxODU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2388185?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bshastry",
      "html_url": "https://github.com/bshastry",
      "followers_url": "https://api.github.com/users/bshastry/followers",
      "following_url": "https://api.github.com/users/bshastry/following{/other_user}",
      "gists_url": "https://api.github.com/users/bshastry/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bshastry/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bshastry/subscriptions",
      "organizations_url": "https://api.github.com/users/bshastry/orgs",
      "repos_url": "https://api.github.com/users/bshastry/repos",
      "events_url": "https://api.github.com/users/bshastry/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bshastry/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-19T12:46:01Z",
    "updated_at": "2021-05-19T12:46:01Z",
    "author_association": "MEMBER",
    "body": "The way to make the divergence between old and new code gens go away would be wrapping the return statement in an unchecked block so the underflow would not revert\r\n\r\n```\r\ncontract C {\r\n  function f() external returns (bool) {\r\n    uint zero;\r\n    unchecked { return zero-- != zero++; }\r\n  }\r\n}\r\n// ====\r\n// compileViaYul: also\r\n// ----\r\n// f() -> true\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/844070578/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/845187128",
    "html_url": "https://github.com/ethereum/solidity/issues/11414#issuecomment-845187128",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11414",
    "id": 845187128,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NTE4NzEyOA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-20T14:46:43Z",
    "updated_at": "2021-05-20T14:46:43Z",
    "author_association": "MEMBER",
    "body": "The evaluation order inside expression is documented to be unspecified for the old code generator and it is documented that there can be differences between the old and the new code generator. In my opinion, it is also very bad coding practice to rely on the evaluation order. In my opinion, this issue can just be closed, I don't think we can or should do anything about it, unless you have an idea.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/845187128/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/845316670",
    "html_url": "https://github.com/ethereum/solidity/issues/11414#issuecomment-845316670",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11414",
    "id": 845316670,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NTMxNjY3MA==",
    "user": {
      "login": "bshastry",
      "id": 2388185,
      "node_id": "MDQ6VXNlcjIzODgxODU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2388185?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bshastry",
      "html_url": "https://github.com/bshastry",
      "followers_url": "https://api.github.com/users/bshastry/followers",
      "following_url": "https://api.github.com/users/bshastry/following{/other_user}",
      "gists_url": "https://api.github.com/users/bshastry/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bshastry/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bshastry/subscriptions",
      "organizations_url": "https://api.github.com/users/bshastry/orgs",
      "repos_url": "https://api.github.com/users/bshastry/repos",
      "events_url": "https://api.github.com/users/bshastry/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bshastry/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-20T17:30:31Z",
    "updated_at": "2021-05-20T17:30:31Z",
    "author_association": "MEMBER",
    "body": "Yes, this is documented behavior. I created this issue because I didn't expect code that runs on one code gen to revert on another. I had assumed that such behavior is indicative of a bug but clearly other things can cause it as well. I am fine with closing this issue.\r\n\r\nAt the moment, I am thinking how to filter out false positives like this generated by the fuzzer. I don't have a solution yet.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/845316670/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/857036948",
    "html_url": "https://github.com/ethereum/solidity/issues/11414#issuecomment-857036948",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11414",
    "id": 857036948,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1NzAzNjk0OA==",
    "user": {
      "login": "bshastry",
      "id": 2388185,
      "node_id": "MDQ6VXNlcjIzODgxODU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2388185?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bshastry",
      "html_url": "https://github.com/bshastry",
      "followers_url": "https://api.github.com/users/bshastry/followers",
      "following_url": "https://api.github.com/users/bshastry/following{/other_user}",
      "gists_url": "https://api.github.com/users/bshastry/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bshastry/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bshastry/subscriptions",
      "organizations_url": "https://api.github.com/users/bshastry/orgs",
      "repos_url": "https://api.github.com/users/bshastry/repos",
      "events_url": "https://api.github.com/users/bshastry/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bshastry/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-08T19:20:32Z",
    "updated_at": "2021-06-08T19:20:41Z",
    "author_association": "MEMBER",
    "body": "Closing issue since the consensus is on finding a way to filter out bug reports that are due to difference in evaluation order between old and new code gens.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/857036948/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
