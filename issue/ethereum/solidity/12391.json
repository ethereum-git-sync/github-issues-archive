{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/12391",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/12391/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/12391/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/12391/events",
  "html_url": "https://github.com/ethereum/solidity/issues/12391",
  "id": 1076401154,
  "node_id": "I_kwDOAm_5kc5AKJQC",
  "number": 12391,
  "title": "Members of contracts with the same name within the same file are all available to call, even if only one of the contracts is deployed",
  "user": {
    "login": "avlahos",
    "id": 23620420,
    "node_id": "MDQ6VXNlcjIzNjIwNDIw",
    "avatar_url": "https://avatars.githubusercontent.com/u/23620420?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/avlahos",
    "html_url": "https://github.com/avlahos",
    "followers_url": "https://api.github.com/users/avlahos/followers",
    "following_url": "https://api.github.com/users/avlahos/following{/other_user}",
    "gists_url": "https://api.github.com/users/avlahos/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/avlahos/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/avlahos/subscriptions",
    "organizations_url": "https://api.github.com/users/avlahos/orgs",
    "repos_url": "https://api.github.com/users/avlahos/repos",
    "events_url": "https://api.github.com/users/avlahos/events{/privacy}",
    "received_events_url": "https://api.github.com/users/avlahos/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-12-10T04:01:34Z",
  "updated_at": "2021-12-10T15:57:37Z",
  "closed_at": "2021-12-10T11:48:24Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nGiven a single Solidity file that contains two contracts with the same name but different capitalization (Abc and ABC). Note that the contracts have no interaction with each other and neither one is a parent or child of the other. When one of the two contracts in the file is deployed, the user can execute the functionality of the second contract in the file that was not deployed.\r\n\r\nThe initial hypothesis is that the compiler has trouble differentiating between the two contracts in the file since they have the same name (although different capitalization).\r\n\r\n## Environment\r\n\r\n- Compiler version: v0.6.12+commit.27d51765\r\n- Target EVM version (as per compiler settings): default evmVersion\r\n- Framework/IDE (e.g. Truffle or Remix):\r\n- EVM execution environment / backend / blockchain client: Polygon\r\n- Operating system:\r\n\r\n## Steps to Reproduce\r\n\r\nThe following deployed contract serves as an example of the described issue: https://polygonscan.com/address/0x96551a7873D3528B6C87f0B7456BC35ed2589FBD#code\r\n\r\nThis file features a few contracts, but we're mainly focusing on two (Mgas and MGAS). The Mgas contract is an ERC-20 token and the MGAS contract is intended to be an NFT marketplace (although it may not contain full functionality). Note that the contract ABI, the Read/Write sections all match what they should look like considering the MGAS contract was deployed. However, if you look at the transactions, you can see that functions of the Mgas token contract were called as if the functions on the deployed contract itself were being executed. You can see an initialize and a transfer function were called using code from the Mgas token contract.\r\n",
  "closed_by": {
    "login": "cameel",
    "id": 137030,
    "node_id": "MDQ6VXNlcjEzNzAzMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cameel",
    "html_url": "https://github.com/cameel",
    "followers_url": "https://api.github.com/users/cameel/followers",
    "following_url": "https://api.github.com/users/cameel/following{/other_user}",
    "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
    "organizations_url": "https://api.github.com/users/cameel/orgs",
    "repos_url": "https://api.github.com/users/cameel/repos",
    "events_url": "https://api.github.com/users/cameel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cameel/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/12391/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/12391/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/990905029",
    "html_url": "https://github.com/ethereum/solidity/issues/12391#issuecomment-990905029",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12391",
    "id": 990905029,
    "node_id": "IC_kwDOAm_5kc47EALF",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-10T11:48:24Z",
    "updated_at": "2021-12-10T11:50:49Z",
    "author_association": "MEMBER",
    "body": "> You can see an initialize and a transfer function were called using code from the Mgas token contract.\r\n\r\nThat's not the case here. They were actually handled by `MGAS`. True, the transaction data does contain the selector of `initialize()` or `transfer()` - functions that are not present in `MGAS` - but it does not mean that the contract has to implement these functions. There's another way for a contract to handle such transactions - the [`fallback()` function](https://docs.soliditylang.org/en/latest/contracts.html?highlight=fallback#fallback-function). Note that `Market` (which `MGAS` ultimately inherits from) does have such a function:\r\n```solidity\r\nabstract contract Market {\r\n    fallback() external payable {\r\n        _deal();\r\n    }\r\n    \r\n    receive() external payable {\r\n        _deal();\r\n    }\r\n\r\n    ...\r\n}\r\n```\r\nThe truth is that on the bytecode level there are no functions at all, it's just an abstraction provided by the language. A contract is just a long chain of instructions and is free to use or ignore whatever you include in calldata and interpret it however it likes. In Solidity external functions are simulated by having a big `switch` statement that looks at the selector and decides where to jump. By default the code is generated in such a way that, if a function is not present in the Solidity source, the contract reverts. But if you provide a `fallback` function, a `default` case is added to the `switch` and the code inside that function is executed instead. Unless you decide to revert in `fallback`, this counts as a successful call. This mechanism is often used by proxies to forward all calls to another contract but you can use it in other cases too. Here the author of the contract decided that if a matching function is not present, the specifics of the call should be ignored and `_deal()` should be executed instead. As you can see, this can be pretty confusing.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/990905029/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/991088858",
    "html_url": "https://github.com/ethereum/solidity/issues/12391#issuecomment-991088858",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12391",
    "id": 991088858,
    "node_id": "IC_kwDOAm_5kc47EtDa",
    "user": {
      "login": "avlahos",
      "id": 23620420,
      "node_id": "MDQ6VXNlcjIzNjIwNDIw",
      "avatar_url": "https://avatars.githubusercontent.com/u/23620420?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/avlahos",
      "html_url": "https://github.com/avlahos",
      "followers_url": "https://api.github.com/users/avlahos/followers",
      "following_url": "https://api.github.com/users/avlahos/following{/other_user}",
      "gists_url": "https://api.github.com/users/avlahos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/avlahos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/avlahos/subscriptions",
      "organizations_url": "https://api.github.com/users/avlahos/orgs",
      "repos_url": "https://api.github.com/users/avlahos/repos",
      "events_url": "https://api.github.com/users/avlahos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/avlahos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-10T15:57:37Z",
    "updated_at": "2021-12-10T15:57:37Z",
    "author_association": "NONE",
    "body": "@cameel Thank you so much for taking the time to answer this. I can see now that the MGAS contract serves as a proxy contract and routes calls to another contract containing the implementation code.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/991088858/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
