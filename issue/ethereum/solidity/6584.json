{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/6584",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/6584/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/6584/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/6584/events",
  "html_url": "https://github.com/ethereum/solidity/issues/6584",
  "id": 436683151,
  "node_id": "MDU6SXNzdWU0MzY2ODMxNTE=",
  "number": 6584,
  "title": "Have modifiers JUMP rather than inlining",
  "user": {
    "login": "rainbreak",
    "id": 18486361,
    "node_id": "MDQ6VXNlcjE4NDg2MzYx",
    "avatar_url": "https://avatars.githubusercontent.com/u/18486361?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rainbreak",
    "html_url": "https://github.com/rainbreak",
    "followers_url": "https://api.github.com/users/rainbreak/followers",
    "following_url": "https://api.github.com/users/rainbreak/following{/other_user}",
    "gists_url": "https://api.github.com/users/rainbreak/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rainbreak/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rainbreak/subscriptions",
    "organizations_url": "https://api.github.com/users/rainbreak/orgs",
    "repos_url": "https://api.github.com/users/rainbreak/repos",
    "events_url": "https://api.github.com/users/rainbreak/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rainbreak/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2019-04-24T13:00:19Z",
  "updated_at": "2021-10-19T15:00:16Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "The code of a modifier is currently copied into the function to which it is applied. Instead, I suggest to treat the modifier more like an internal function and to use a `jump` instead.\r\n\r\nThis has some benefits:\r\n\r\n1. Reduces codesize of contracts through code reuse.\r\n2. Some static analysis can be made more efficient (e.g. lemmas can be made for internal functions much more easily than inlined code).\r\n3. Modifiers would no longer contribute to \"stack too deep\" errors.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/6584/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/6584/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486226209",
    "html_url": "https://github.com/ethereum/solidity/issues/6584#issuecomment-486226209",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6584",
    "id": 486226209,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjIyNjIwOQ==",
    "user": {
      "login": "livnev",
      "id": 3964494,
      "node_id": "MDQ6VXNlcjM5NjQ0OTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3964494?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/livnev",
      "html_url": "https://github.com/livnev",
      "followers_url": "https://api.github.com/users/livnev/followers",
      "following_url": "https://api.github.com/users/livnev/following{/other_user}",
      "gists_url": "https://api.github.com/users/livnev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/livnev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/livnev/subscriptions",
      "organizations_url": "https://api.github.com/users/livnev/orgs",
      "repos_url": "https://api.github.com/users/livnev/repos",
      "events_url": "https://api.github.com/users/livnev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/livnev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-24T13:20:44Z",
    "updated_at": "2019-04-24T13:20:44Z",
    "author_association": "NONE",
    "body": "To be precise, what seems to happen when you use modifiers is that the execution jumps to a new location in the bytecode to execute the modifier, similarly to \"internal calls\", however the code that it jumps to seems to be duplicated for every use of the modifier, instead of sharing the same code like you would expect.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486226209/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486246577",
    "html_url": "https://github.com/ethereum/solidity/issues/6584#issuecomment-486246577",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6584",
    "id": 486246577,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjI0NjU3Nw==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-24T14:03:37Z",
    "updated_at": "2019-04-24T14:03:37Z",
    "author_association": "MEMBER",
    "body": "This would require adding a \"jump in PC\" and a \"return PC\" as arguments to each modifier. I think we have to revisit this when we implement modifiers in the Solidity -> Yul code generation, but I don't think this will be feasible to implement with the old code generator.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486246577/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/624950639",
    "html_url": "https://github.com/ethereum/solidity/issues/6584#issuecomment-624950639",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6584",
    "id": 624950639,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDk1MDYzOQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-06T23:51:57Z",
    "updated_at": "2020-05-06T23:51:57Z",
    "author_association": "MEMBER",
    "body": "For modifiers of the form `{... _;}` this might be doable.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/624950639/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/625600055",
    "html_url": "https://github.com/ethereum/solidity/issues/6584#issuecomment-625600055",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6584",
    "id": 625600055,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNTYwMDA1NQ==",
    "user": {
      "login": "nventuro",
      "id": 2530770,
      "node_id": "MDQ6VXNlcjI1MzA3NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2530770?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nventuro",
      "html_url": "https://github.com/nventuro",
      "followers_url": "https://api.github.com/users/nventuro/followers",
      "following_url": "https://api.github.com/users/nventuro/following{/other_user}",
      "gists_url": "https://api.github.com/users/nventuro/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nventuro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nventuro/subscriptions",
      "organizations_url": "https://api.github.com/users/nventuro/orgs",
      "repos_url": "https://api.github.com/users/nventuro/repos",
      "events_url": "https://api.github.com/users/nventuro/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nventuro/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-08T02:49:45Z",
    "updated_at": "2020-05-08T02:49:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "I just came accross [this article](https://blog.polymath.network/solidity-tips-and-tricks-to-save-gas-and-reduce-bytecode-size-c44580b218e6), which recommends using internal functions instead of modifiers to reduce bytecode size.\r\n\r\nI think the existence of these suggestions is an issue: people should not rely on quirks of the compiler's implementation and choose between sintactic constructs because of the bytecode they generate. This is the same case as the one described [on this PR](https://github.com/ethereum/solidity/issues/6075#issuecomment-472622304).\r\n\r\nWe should make sure these sort of codegen decisions are taken by the optimizer based on user settings (e..g the 'runs' parameter, or a size vs 'speed'/gas switch), and not by how a developer wrote chose to write their code.\r\n\r\n(I know much of this will become better once the Solidity -> Yul generation is complete and that work is very much underway, I just wanted to emphasize the importance of this point).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/625600055/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/946813240",
    "html_url": "https://github.com/ethereum/solidity/issues/6584#issuecomment-946813240",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6584",
    "id": 946813240,
    "node_id": "IC_kwDOAm_5kc44bzk4",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-19T15:00:15Z",
    "updated_at": "2021-10-19T15:00:15Z",
    "author_association": "MEMBER",
    "body": "Let's try to see if this is doable in a non-dangerous way for `{... _;}`-modifiers",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/946813240/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
