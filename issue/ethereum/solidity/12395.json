{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/12395",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/12395/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/12395/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/12395/events",
  "html_url": "https://github.com/ethereum/solidity/issues/12395",
  "id": 1077035533,
  "node_id": "I_kwDOAm_5kc5AMkIN",
  "number": 12395,
  "title": "NatSpec of custom revert errors are not correctly generated",
  "user": {
    "login": "clemlak",
    "id": 39790678,
    "node_id": "MDQ6VXNlcjM5NzkwNjc4",
    "avatar_url": "https://avatars.githubusercontent.com/u/39790678?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/clemlak",
    "html_url": "https://github.com/clemlak",
    "followers_url": "https://api.github.com/users/clemlak/followers",
    "following_url": "https://api.github.com/users/clemlak/following{/other_user}",
    "gists_url": "https://api.github.com/users/clemlak/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/clemlak/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/clemlak/subscriptions",
    "organizations_url": "https://api.github.com/users/clemlak/orgs",
    "repos_url": "https://api.github.com/users/clemlak/repos",
    "events_url": "https://api.github.com/users/clemlak/events{/privacy}",
    "received_events_url": "https://api.github.com/users/clemlak/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-12-10T16:44:06Z",
  "updated_at": "2021-12-10T20:38:04Z",
  "closed_at": "2021-12-10T20:38:04Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I've noticed that the NatSpec output (devdoc and userdoc) of custom revert errors is wrapped in an extra array instead of being in a plain object.\r\nI'm not sure if this was intentional or not but I find it weird since it's not the case for events or functions. Is there a real reason behind this behavior?\r\n\r\nQuick example, the following code:\r\n\r\n```solidity\r\n/// @notice Thrown when an error happens.\r\n/// @dev More info about the error.\r\n/// @param expected Expected address\r\n/// @param actual Actual address\r\nerror RandomError(address expected, address actual);\r\n```\r\n\r\nWill generate the following documentation, in userdoc:\r\n\r\n```json\r\n\"errors\": {\r\n    \"RandomError(address,address)\": [\r\n        {\r\n            \"notice\": \"Thrown when an error happens.\"\r\n        }\r\n    ]\r\n}\r\n```\r\n\r\nAnd in devdoc:\r\n\r\n```json\r\n\"errors\": {\r\n    \"RandomError(address,address)\": [\r\n        {\r\n            \"details\": \"More info about the error.\",\r\n            \"params\": {\r\n                \"actual\": \"Actual address\",\r\n                \"expected\": \"Expected address\"\r\n            }\r\n        }\r\n    ]\r\n},\r\n```\r\n\r\nThe expected output would be to have the data directly available at the level of the `RandomError(address,address)` object, instead of having them inside of an extra array.",
  "closed_by": {
    "login": "cameel",
    "id": 137030,
    "node_id": "MDQ6VXNlcjEzNzAzMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cameel",
    "html_url": "https://github.com/cameel",
    "followers_url": "https://api.github.com/users/cameel/followers",
    "following_url": "https://api.github.com/users/cameel/following{/other_user}",
    "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
    "organizations_url": "https://api.github.com/users/cameel/orgs",
    "repos_url": "https://api.github.com/users/cameel/repos",
    "events_url": "https://api.github.com/users/cameel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cameel/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/12395/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/12395/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/991278257",
    "html_url": "https://github.com/ethereum/solidity/issues/12395#issuecomment-991278257",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12395",
    "id": 991278257,
    "node_id": "IC_kwDOAm_5kc47FbSx",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-10T20:38:03Z",
    "updated_at": "2021-12-10T20:38:03Z",
    "author_association": "MEMBER",
    "body": "Yes, that's by design. Multiple error definitions with the same signature can exist and all of them can be documented. See example below. The question is which docs to return in that case. We discussed it at length and came to a conclusion that it's best to make it an array and return them all.\r\n\r\nThe same is true for events (see #11114), it's just that errors were a new feature so we could make it an array from the start. Events would be a breaking change in natspec so they have to wait for v2 (#11156).\r\n\r\n### Example\r\n```solidity\r\ncontract A {\r\n    /// Something failed.\r\n    /// @dev an error.\r\n    /// @param x first parameter\r\n    /// @param y second parameter\r\n    error E(uint x, uint y);\r\n}\r\ncontract test {\r\n    /// X Something failed.\r\n    /// @dev X an error.\r\n    /// @param a X first parameter\r\n    /// @param b X second parameter\r\n    error E(uint a, uint b);\r\n    function f(bool a) public pure {\r\n        if (a)\r\n            revert E(1, 2);\r\n        else\r\n            revert A.E(5, 6);\r\n    }\r\n}\r\n```\r\n```json\r\n{\r\n    \"contracts\": {\r\n        \"test.sol:A\": {\r\n            \"devdoc\": {\r\n                \"errors\": {\r\n                    \"E(uint256,uint256)\": [\r\n                        {\r\n                            \"details\": \"an error.\",\r\n                            \"params\": {\r\n                                \"x\": \"first parameter\",\r\n                                \"y\": \"second parameter\"\r\n                            }\r\n                        }\r\n                    ]\r\n                },\r\n                \"kind\": \"dev\",\r\n                \"methods\": {},\r\n                \"version\": 1\r\n            }\r\n        },\r\n        \"test.sol:test\": {\r\n            \"devdoc\": {\r\n                \"errors\": {\r\n                    \"E(uint256,uint256)\": [\r\n                        {\r\n                            \"details\": \"an error.\",\r\n                            \"params\": {\r\n                                \"x\": \"first parameter\",\r\n                                \"y\": \"second parameter\"\r\n                            }\r\n                        },\r\n                        {\r\n                            \"details\": \"X an error.\",\r\n                            \"params\": {\r\n                                \"a\": \"X first parameter\",\r\n                                \"b\": \"X second parameter\"\r\n                            }\r\n                        }\r\n                    ]\r\n                },\r\n                \"kind\": \"dev\",\r\n                \"methods\": {},\r\n                \"version\": 1\r\n            }\r\n        }\r\n    },\r\n    \"version\": \"0.8.10+commit.fc410830.Linux.g++\"\r\n}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/991278257/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
