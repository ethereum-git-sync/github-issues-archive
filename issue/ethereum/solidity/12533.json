{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/12533",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/12533/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/12533/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/12533/events",
  "html_url": "https://github.com/ethereum/solidity/issues/12533",
  "id": 1102893611,
  "node_id": "I_kwDOAm_5kc5BvNIr",
  "number": 12533,
  "title": "IR-based compilation w/o optimization uses way too many stack slots, easily hits stack too deep errors",
  "user": {
    "login": "haltman-at",
    "id": 35589221,
    "node_id": "MDQ6VXNlcjM1NTg5MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/haltman-at",
    "html_url": "https://github.com/haltman-at",
    "followers_url": "https://api.github.com/users/haltman-at/followers",
    "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
    "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
    "organizations_url": "https://api.github.com/users/haltman-at/orgs",
    "repos_url": "https://api.github.com/users/haltman-at/repos",
    "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
    "received_events_url": "https://api.github.com/users/haltman-at/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1282209978,
      "node_id": "MDU6TGFiZWwxMjgyMjA5OTc4",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/optimizer",
      "name": "optimizer",
      "color": "d4c5f9",
      "default": false,
      "description": ""
    },
    {
      "id": 4437999539,
      "node_id": "LA_kwDOAm_5kc8AAAABCIZ_sw",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/high%20effort",
      "name": "high effort",
      "color": "ff54f4",
      "default": false,
      "description": "A lot to implement but still doable by a single person. The task is large or difficult."
    },
    {
      "id": 4438153180,
      "node_id": "LA_kwDOAm_5kc8AAAABCIjX3A",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/high%20impact",
      "name": "high impact",
      "color": "001dff",
      "default": false,
      "description": "Changes are very prominent and affect users or the project in a major way."
    },
    {
      "id": 4438488423,
      "node_id": "LA_kwDOAm_5kc8AAAABCI31Zw",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/must%20have",
      "name": "must have",
      "color": "ffa12a",
      "default": false,
      "description": "Something we consider an essential part of Solidity 1.0."
    },
    {
      "id": 4525128519,
      "node_id": "LA_kwDOAm_5kc8AAAABDbf7Rw",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/needs%20design",
      "name": "needs design",
      "color": "18F737",
      "default": false,
      "description": "The proposal is too vague to be implemented right away"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 11,
  "created_at": "2022-01-14T03:52:31Z",
  "updated_at": "2022-10-27T16:25:29Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nCompiling Solidity with `viaIR: true` but the optimizer turned off results in bytecode that uses an enormous number of stack slots and runs into \"stack too deep\" errors with high frequency, in situations where the Solidity compiler would normally have plenty of stack space left (see repro example below).\r\n\r\nBasically what's going on here seems to be that, when`viaIR` is set to true, the Solidity compiler generates code that doesn't discard intermediate results after it's done with them.  Ordinarily, Solidity divides each stackframe into a lower area for local variables, and a higher area for working state, and the latter only sticks around as necessary.  But with `viaIR: true`, it's all mixed together, and none of it is discarded promptly.\r\n\r\nFor instance, with the code below (but with the lines about `w` removed so that it actually compiles with `viaIR: true`), the line `uint x = 1`, which would normally result in a single 1 being placed on the stack, in the slot representing `x`, instead results in *two* 1s being placed on the stack; presumably, one for the literal and one for `x`, and the one for the literal then doesn't go away.  All sorts of other intermediate results just remain on the stack as well, even after there's no more need for them, such as the value of `x+y`, the signature of `Num` (multiple times), and the literal `88`.\r\n\r\nAnd, of course, one result of using so many stack slots and not discarding anything is that it's really to hit stack too deep errors, in situations where the Solidity compiler wouldn't normally be anywhere near such an error.\r\n\r\nThanks!\r\n\r\n## Environment\r\n\r\n- Compiler version: 0.8.11\r\n- Target EVM version (as per compiler settings): default\r\n- Framework/IDE (e.g. Truffle or Remix): Truffle\r\n\r\n## Steps to Reproduce\r\n\r\nHere's an exampe of a contract that won't compile with `viaIR` on due to stack-too-deep errors:\r\n\r\n```solidity\r\n//SPDX-License-Identifier: MIT\r\npragma solidity ^0.8.0;\r\n\r\ncontract StackTest {\r\n\r\n  event Num(uint);\r\n\r\n  function doStuff() public {\r\n    uint x = 1;\r\n    uint y = 2;\r\n    uint z = 3;\r\n    uint w = 4;\r\n    emit Num(w);\r\n    emit Num(z);\r\n    emit Num(x);\r\n    emit Num(y);\r\n    emit Num(x + y);\r\n    emit Num(88);\r\n  }\r\n}\r\n```\r\n\r\nCompiling with `viaIR: true` yields the error message:\r\n\r\n```\r\nYulException: Variable var_x_42 is 3 slot(s) too deep inside the stack.\r\n```\r\n\r\nMeanwhile, with `viaIR: false`, this compiles just fine, because the compiler isn't wasting huge numbers of stack slots.\r\n\r\nI'll skip including repro steps for the other stuff, but if you just take the above contract and delete the lines mentioning `w`, you'll get the contract I observed them with.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/12533/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/12533/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1013073350",
    "html_url": "https://github.com/ethereum/solidity/issues/12533#issuecomment-1013073350",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12533",
    "id": 1013073350,
    "node_id": "IC_kwDOAm_5kc48YkXG",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-14T12:22:46Z",
    "updated_at": "2022-01-14T12:25:49Z",
    "author_association": "MEMBER",
    "body": "The IR/Yul code generation from solidity is intentionally \"safe and stupid\", i.e. it indeed produces a local Yul-variable for each intermediate expression (you quickly see it in compiling the contract with ``solc --ir``).\r\nThe unoptimized code transform from Yul code to EVM code is similarly \"safe and stupid\" and, as you say, doesn't do any cleanup after the last use of a Yul variable.\r\n\r\nIn general, the ``viaIR`` pipeline is not intended to be run without at least some degree of optimization.\r\n\r\nSo this is not exactly unexpected or unintentional, but I agree that it's a bad situation in which the default compiler runs fail even on simple contracts - we should probably enable a minimal set of optimizations by default - however, that's something we'd want to coordinate with you, s.t. we can retain debugging.\r\n\r\nThe currently minimal amount of optimization already makes the contract compilable:\r\n```\r\n    \"viaIR\": true,\r\n    \"optimizer\": {\r\n      \"enabled\": true,\r\n      \"details\": {\r\n        \"peephole\": false,\r\n        \"inliner\": false,\r\n        \"jumpdestRemover\": false,\r\n        \"orderLiterals\": false,\r\n        \"deduplicate\": false,\r\n        \"cse\": false,\r\n        \"constantOptimizer\": false,\r\n        \"yul\": true,\r\n        \"yulDetails\": {\r\n          \"stackAllocation\": false,\r\n          \"optimizerSteps\": \"\"\r\n        }\r\n      }\r\n    }\r\n```\r\n(although right now this will run *some* hard-coded Yul optimizer steps, we'll allow to disable those in the near future as well https://github.com/ethereum/solidity/issues/9627)\r\n\r\nIn particular, the ``yulDetails`` option ``stackAllocation`` will have significant effects on the stack-effectiveness of the yul-to-evm transformation.\r\n\r\nLong story short:\r\n- At the moment it's expected that fully unoptimized compilation via IR fails quickly due to stack-too-deep.\r\n- Eventually we may enable some sane minimal optimizations by default, s.t. this stack-too-deep doesn't happen by default all the time.\r\n- We have to figure out how we can help e.g. the Truffle debugger to be able to deal with the compilation result with and without optimization.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1013073350/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1026019388",
    "html_url": "https://github.com/ethereum/solidity/issues/12533#issuecomment-1026019388",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12533",
    "id": 1026019388,
    "node_id": "IC_kwDOAm_5kc49J9A8",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-31T17:20:28Z",
    "updated_at": "2022-01-31T17:20:28Z",
    "author_association": "MEMBER",
    "body": "Would it be an option to disable any code modifications but enable the optimized evm code transforrm?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1026019388/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1270574447",
    "html_url": "https://github.com/ethereum/solidity/issues/12533#issuecomment-1270574447",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12533",
    "id": 1270574447,
    "node_id": "IC_kwDOAm_5kc5Lu21v",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-06T19:22:15Z",
    "updated_at": "2022-10-06T19:22:15Z",
    "author_association": "MEMBER",
    "body": "@haltman-at @fvictorio With #9627 implemented it's now possible to disable pretty much all optimizations without disabling stack optimization. You can do this by setting `--yul-optimizations` (on the CLI) or \r\n`settings.optimizer.details.yulDetails.optimizerSteps` (in Standard JSON) to `:`. An empty string for compatibility still means that the cleanup sequence is there but if you include a colon, you now change both the base sequence and the cleanup sequence. See [Optimizer > Selecting Optimizations](https://docs.soliditylang.org/en/latest/internals/optimizer.html#selecting-optimizations) for details.\r\n\r\nCan you check if this would be enough for you to properly support `viaIR: true`?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1270574447/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1274543644",
    "html_url": "https://github.com/ethereum/solidity/issues/12533#issuecomment-1274543644",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12533",
    "id": 1274543644,
    "node_id": "IC_kwDOAm_5kc5L9_4c",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-11T11:36:23Z",
    "updated_at": "2022-10-11T11:36:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "I get this error if I do that:\r\n\r\n> Invalid optimizer step sequence in \"settings.optimizer.details.optimizerSteps\": ':' is not a valid step abbreviation",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1274543644/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1274625397",
    "html_url": "https://github.com/ethereum/solidity/issues/12533#issuecomment-1274625397",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12533",
    "id": 1274625397,
    "node_id": "IC_kwDOAm_5kc5L-T11",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-11T12:39:47Z",
    "updated_at": "2022-10-11T12:39:47Z",
    "author_association": "MEMBER",
    "body": "Ah, wait. My bad. I was convinced that this feature already went into 0.8.17 but I now realized that we only merged it shortly after the release. Sorry for the confusion.\r\n\r\nIn that case maybe you could try one of the recent builds from our CI? E.g. [this one from `develop`](https://app.circleci.com/pipelines/github/ethereum/solidity/26837/workflows/bb0017c1-0ec1-4e37-bbe1-aaea4806836a/jobs/1189239/artifacts).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1274625397/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1274645473",
    "html_url": "https://github.com/ethereum/solidity/issues/12533#issuecomment-1274645473",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12533",
    "id": 1274645473,
    "node_id": "IC_kwDOAm_5kc5L-Yvh",
    "user": {
      "login": "leonardoalt",
      "id": 504195,
      "node_id": "MDQ6VXNlcjUwNDE5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/504195?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/leonardoalt",
      "html_url": "https://github.com/leonardoalt",
      "followers_url": "https://api.github.com/users/leonardoalt/followers",
      "following_url": "https://api.github.com/users/leonardoalt/following{/other_user}",
      "gists_url": "https://api.github.com/users/leonardoalt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/leonardoalt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leonardoalt/subscriptions",
      "organizations_url": "https://api.github.com/users/leonardoalt/orgs",
      "repos_url": "https://api.github.com/users/leonardoalt/repos",
      "events_url": "https://api.github.com/users/leonardoalt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/leonardoalt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-11T12:55:18Z",
    "updated_at": "2022-10-11T12:55:18Z",
    "author_association": "MEMBER",
    "body": "I'm sure optimizerSteps is already there, I've been using \"optimizerSteps: '' \" for a while. I think he's missing yulDetails in the field chain.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1274645473/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1274908675",
    "html_url": "https://github.com/ethereum/solidity/issues/12533#issuecomment-1274908675",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12533",
    "id": 1274908675,
    "node_id": "IC_kwDOAm_5kc5L_ZAD",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-11T15:44:55Z",
    "updated_at": "2022-10-11T15:44:55Z",
    "author_association": "MEMBER",
    "body": "Yeah, `optimizerSteps` is there but in 0.8.17 it's only the part of the sequence that happens before the stack compressor. The new feature lets you put `:` in it and replace the cleanup sequence that happens after the stack compression.\r\n\r\nActually, it could be that clearing the main sequence is already good enough for Hardhat - might be worth a try - but still, it's not clearing the whole sequence.\r\n\r\n@fvictorio Also, one thing I forgot to mention is that you'll probably want to disable the EVM-based optimizer - clearing the sequence does not automatically do that. You obviously can't just set `settings.optimizer.enabled` to `false` so you need to disable the individual components under `settings.optimizer.details` instead.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1274908675/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1289626713",
    "html_url": "https://github.com/ethereum/solidity/issues/12533#issuecomment-1289626713",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12533",
    "id": 1289626713,
    "node_id": "IC_kwDOAm_5kc5M3iRZ",
    "user": {
      "login": "alcuadrado",
      "id": 176499,
      "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alcuadrado",
      "html_url": "https://github.com/alcuadrado",
      "followers_url": "https://api.github.com/users/alcuadrado/followers",
      "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
      "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
      "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
      "repos_url": "https://api.github.com/users/alcuadrado/repos",
      "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-24T21:15:42Z",
    "updated_at": "2022-10-24T21:15:42Z",
    "author_association": "MEMBER",
    "body": "I mentioned this at our meeting in Bogota, but I want to bring it up again: can `viaIR: true` `\"optimizer\": {\"enabled\": false }` be an alias to \"only do variable spilling\"? I think that's the behavior most users will expect.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1289626713/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1293652661",
    "html_url": "https://github.com/ethereum/solidity/issues/12533#issuecomment-1293652661",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12533",
    "id": 1293652661,
    "node_id": "IC_kwDOAm_5kc5NG5K1",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-27T14:57:41Z",
    "updated_at": "2022-10-27T14:58:03Z",
    "author_association": "MEMBER",
    "body": "Not sure if `\"optimizer\": {\"enabled\": false}` is the best way to achieve that but I do think that an easier way to enable this mode is a good idea.\r\n\r\nBut before we do that, I think we should first hear from you whether this mode is actually enough to work around the root issue here.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1293652661/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1293773486",
    "html_url": "https://github.com/ethereum/solidity/issues/12533#issuecomment-1293773486",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12533",
    "id": 1293773486,
    "node_id": "IC_kwDOAm_5kc5NHWqu",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-27T16:20:42Z",
    "updated_at": "2022-10-27T16:20:42Z",
    "author_association": "MEMBER",
    "body": "I actually misunderstood you in Bogota on this then and thought you wanted something more along the lines of what @cameel proposes, i.e. an independent simple way to enable \"only stack-to-memory, no other optimizations\".\r\nBut you do have a point in that it would actually make sense for ``viaIR: true`` and ``\"optimizer\": {\"enabled\": false }`` itself to behave like that - since it's a prerequisite for compiling most non-trivial code bases in general.\r\nSo I'm actually in favour of exploring this - however, we still need some minimal optimization preprocessing like disambiguating and function hoisting for stack-to-memory - so we'd need to check, if we can either avoid those or want to accept this level of messing with the plain unoptimized yul code. It's worth a thought in any case!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1293773486/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1293778321",
    "html_url": "https://github.com/ethereum/solidity/issues/12533#issuecomment-1293778321",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12533",
    "id": 1293778321,
    "node_id": "IC_kwDOAm_5kc5NHX2R",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-27T16:24:55Z",
    "updated_at": "2022-10-27T16:25:29Z",
    "author_association": "MEMBER",
    "body": "We could also introduce explicit optimization levels. Internally `enabled: false` does not even mean completely disabling the optimizer. It's just the \"minimal\" level. Which has almost everything disabled but is still a notch above \"none\".",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1293778321/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
