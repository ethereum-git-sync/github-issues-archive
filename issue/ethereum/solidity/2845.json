{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/2845",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/2845/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/2845/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/2845/events",
  "html_url": "https://github.com/ethereum/solidity/issues/2845",
  "id": 253601923,
  "node_id": "MDU6SXNzdWUyNTM2MDE5MjM=",
  "number": 2845,
  "title": "Unknown solidity bug",
  "user": {
    "login": "iFA88",
    "id": 18205395,
    "node_id": "MDQ6VXNlcjE4MjA1Mzk1",
    "avatar_url": "https://avatars.githubusercontent.com/u/18205395?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iFA88",
    "html_url": "https://github.com/iFA88",
    "followers_url": "https://api.github.com/users/iFA88/followers",
    "following_url": "https://api.github.com/users/iFA88/following{/other_user}",
    "gists_url": "https://api.github.com/users/iFA88/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iFA88/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iFA88/subscriptions",
    "organizations_url": "https://api.github.com/users/iFA88/orgs",
    "repos_url": "https://api.github.com/users/iFA88/repos",
    "events_url": "https://api.github.com/users/iFA88/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iFA88/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2017-08-29T10:17:31Z",
  "updated_at": "2017-12-01T23:52:50Z",
  "closed_at": "2017-12-01T23:52:50Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Greetings everyone, I have spend a day for _why my code is not working_ and finally have found the problem.\r\n\r\n### My code:\r\n```javascript\r\npragma solidity ^0.4.15;\r\ncontract provider {\r\n    uint8 public rentRate = 20;\r\n    address rewardLibAddress;\r\n    /* Constructor */\r\n    function provider(address rewardLibAddr) {\r\n        rewardLibAddress = rewardLibAddr;\r\n        require( providerRewardLib(rewardLibAddress).ownSign() == sha3(\"providerRewardLib\") );\r\n    }\r\n    /* Constants */\r\n    function checkReward(uint256 providerUID, uint256 roundLimit) public constant returns (uint256 senderReward, uint256 adminReward, uint256 ownerReward, uint256 round) {\r\n        //bytes4 sig = bytes4(sha3(\"checkReward(uint256,uint256)\"));\r\n        assembly {\r\n            let m := mload(0x80)\r\n            mstore(m, 0xbfd8222a00000000000000000000000000000000000000000000000000000000)\r\n            mstore(add(m, 0x04), providerUID)\r\n            mstore(add(m, 0x24), roundLimit)\r\n            let success := delegatecall(gas, sload(rewardLibAddress_slot), m, 0x44, m, 0x80)\r\n            switch success case 0 {\r\n                revert(0,0)\r\n            } default {\r\n                return(m, 0x80)\r\n            }\r\n        }\r\n    }\r\n}\r\ncontract providerRewardLib {\r\n    bytes32 public ownSign = sha3(\"providerRewardLib\");\r\n    /* Constants */\r\n    function checkReward(uint256 providerUID, uint256 roundLimit) public constant returns (uint256 senderReward, uint256 adminReward, uint256 ownerReward, uint256 round) {\r\n        return (1,2,3,4);\r\n    }\r\n}\r\n```\r\n### The issue:\r\nOn `provider.checkReward(1,1)` call I got the `calldata` as return back like:\r\n```\r\n0xbfd8222a00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000000\"\r\n```\r\n\r\n### Solution\r\nIf I change the third line to:\r\n```javascript\r\nuint256 public rentRate = 20;\r\n```\r\nThen works everything as excepted. Return:\r\n```\r\n0x0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000004\r\n```\r\n### Environment \r\nLatest Windows 10\r\nFirefox 55.0.3 64bit\r\nhttps://ethereum.github.io/browser-solidity\r\nI have the same issue with compiler from `0.4.15+commit.bbb8e64f` to `0.4.17-nightly.2017.8.28+commit.d15cde2a`, with enabled or disabled optimization.",
  "closed_by": {
    "login": "axic",
    "id": 20340,
    "node_id": "MDQ6VXNlcjIwMzQw",
    "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/axic",
    "html_url": "https://github.com/axic",
    "followers_url": "https://api.github.com/users/axic/followers",
    "following_url": "https://api.github.com/users/axic/following{/other_user}",
    "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
    "organizations_url": "https://api.github.com/users/axic/orgs",
    "repos_url": "https://api.github.com/users/axic/repos",
    "events_url": "https://api.github.com/users/axic/events{/privacy}",
    "received_events_url": "https://api.github.com/users/axic/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/2845/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/2845/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/325641821",
    "html_url": "https://github.com/ethereum/solidity/issues/2845#issuecomment-325641821",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/2845",
    "id": 325641821,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTY0MTgyMQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-29T12:00:16Z",
    "updated_at": "2017-08-29T12:00:16Z",
    "author_association": "MEMBER",
    "body": "For types that are smaller than 32 bytes (like address) you have to take both `_slot` and `_offset` into account: https://solidity.readthedocs.io/en/develop/miscellaneous.html#layout-of-state-variables-in-storage\r\n\r\nYou can avoid that by packing the address into a struct, which will cause the compiler to put it into a slot of its own.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/325641821/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/325645690",
    "html_url": "https://github.com/ethereum/solidity/issues/2845#issuecomment-325645690",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/2845",
    "id": 325645690,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTY0NTY5MA==",
    "user": {
      "login": "iFA88",
      "id": 18205395,
      "node_id": "MDQ6VXNlcjE4MjA1Mzk1",
      "avatar_url": "https://avatars.githubusercontent.com/u/18205395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iFA88",
      "html_url": "https://github.com/iFA88",
      "followers_url": "https://api.github.com/users/iFA88/followers",
      "following_url": "https://api.github.com/users/iFA88/following{/other_user}",
      "gists_url": "https://api.github.com/users/iFA88/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iFA88/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iFA88/subscriptions",
      "organizations_url": "https://api.github.com/users/iFA88/orgs",
      "repos_url": "https://api.github.com/users/iFA88/repos",
      "events_url": "https://api.github.com/users/iFA88/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iFA88/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-29T12:17:55Z",
    "updated_at": "2017-08-29T12:17:55Z",
    "author_association": "NONE",
    "body": "Alright, how can I use both of them?\r\n`rewardLibAddress_slot_offset` ?\r\nSadly this is not working. I can't find an any documentation how should be that use. ( https://solidity.readthedocs.io/en/develop/search.html?q=_offset&check_keywords=yes&area=default )",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/325645690/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/325648329",
    "html_url": "https://github.com/ethereum/solidity/issues/2845#issuecomment-325648329",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/2845",
    "id": 325648329,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTY0ODMyOQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-29T12:28:27Z",
    "updated_at": "2017-08-29T12:28:27Z",
    "author_association": "MEMBER",
    "body": "Something like `div(sload(rewardLibAddress_slot), exp(2, rewardLibAddress_offset))` could work, but I would strongly advise against that.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/325648329/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/325648405",
    "html_url": "https://github.com/ethereum/solidity/issues/2845#issuecomment-325648405",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/2845",
    "id": 325648405,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTY0ODQwNQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-29T12:28:47Z",
    "updated_at": "2017-08-29T12:28:47Z",
    "author_association": "MEMBER",
    "body": "Oh and you should also perform a cleanup of the address in case there is something after it in the slot.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/325648405/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/348645072",
    "html_url": "https://github.com/ethereum/solidity/issues/2845#issuecomment-348645072",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/2845",
    "id": 348645072,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODY0NTA3Mg==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-01T23:52:50Z",
    "updated_at": "2017-12-01T23:52:50Z",
    "author_association": "MEMBER",
    "body": "Closing as this is part of the documentation (\"Assembly\" chapter).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/348645072/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
