{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/4037",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/4037/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/4037/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/4037/events",
  "html_url": "https://github.com/ethereum/solidity/issues/4037",
  "id": 319095034,
  "node_id": "MDU6SXNzdWUzMTkwOTUwMzQ=",
  "number": 4037,
  "title": "Allow initializing constant structs",
  "user": {
    "login": "wadeAlexC",
    "id": 18387287,
    "node_id": "MDQ6VXNlcjE4Mzg3Mjg3",
    "avatar_url": "https://avatars.githubusercontent.com/u/18387287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wadeAlexC",
    "html_url": "https://github.com/wadeAlexC",
    "followers_url": "https://api.github.com/users/wadeAlexC/followers",
    "following_url": "https://api.github.com/users/wadeAlexC/following{/other_user}",
    "gists_url": "https://api.github.com/users/wadeAlexC/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wadeAlexC/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wadeAlexC/subscriptions",
    "organizations_url": "https://api.github.com/users/wadeAlexC/orgs",
    "repos_url": "https://api.github.com/users/wadeAlexC/repos",
    "events_url": "https://api.github.com/users/wadeAlexC/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wadeAlexC/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 785717317,
      "node_id": "MDU6TGFiZWw3ODU3MTczMTc=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/language%20design%20:rage4:",
      "name": "language design :rage4:",
      "color": "9d76d3",
      "default": false,
      "description": "Any changes to the language, e.g. new features"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2018-05-01T02:05:47Z",
  "updated_at": "2022-08-17T13:48:58Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "It would be very helpful to allow `constant` structs. Currently, the workaround is to define internal functions that return structs.\r\n\r\nExample:\r\n```Solidity\r\npragma solidity ^0.5.0\r\n\r\ncontract ConstStructs {\r\n\r\n    struct SomeStruct {\r\n        uint val1;\r\n        bytes32 val2;\r\n    }\r\n\r\n    SomeStruct public constant CONST_STRUCT = SomeStruct({\r\n       val1: 5,\r\n       val2: bytes32(123)\r\n    });\r\n}\r\n```\r\n\r\nForgot to post the workaround -\r\n\r\n```Solidity\r\npragma solidity ^0.4.23;\r\n\r\ncontract ConstStructs {\r\n\r\n    struct SomeStruct {\r\n        uint val1;\r\n        bytes32 val2;\r\n    }\r\n    \r\n    function getSomeStruct() internal pure returns (SomeStruct memory) {\r\n        return SomeStruct({\r\n           val1: 5,\r\n           val2: bytes32(123)\r\n        });\r\n    }\r\n\r\n    uint public constant SOMESTRUCT_CONST_UINT = getSomeStruct().val1;\r\n    bytes32 public constant SOMESTRUCT_CONST_BYTES32 = getSomeStruct().val2;\r\n}\r\n```",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/4037/reactions",
    "total_count": 4,
    "+1": 3,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 1,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/4037/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/386013425",
    "html_url": "https://github.com/ethereum/solidity/issues/4037#issuecomment-386013425",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/4037",
    "id": 386013425,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NjAxMzQyNQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-02T15:14:00Z",
    "updated_at": "2018-05-02T15:14:00Z",
    "author_association": "MEMBER",
    "body": "This also requires \"immutability checks\" to be implemented, because you obviously do not want `CONST_STRUCT.val1 = 7` to work.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/386013425/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/395174544",
    "html_url": "https://github.com/ethereum/solidity/issues/4037#issuecomment-395174544",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/4037",
    "id": 395174544,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NTE3NDU0NA==",
    "user": {
      "login": "androlo",
      "id": 2809499,
      "node_id": "MDQ6VXNlcjI4MDk0OTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2809499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/androlo",
      "html_url": "https://github.com/androlo",
      "followers_url": "https://api.github.com/users/androlo/followers",
      "following_url": "https://api.github.com/users/androlo/following{/other_user}",
      "gists_url": "https://api.github.com/users/androlo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/androlo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/androlo/subscriptions",
      "organizations_url": "https://api.github.com/users/androlo/orgs",
      "repos_url": "https://api.github.com/users/androlo/repos",
      "events_url": "https://api.github.com/users/androlo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/androlo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-06T18:48:51Z",
    "updated_at": "2018-06-06T18:48:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "Awesome. Guess this would allow structs as arguments to external functions as well.\r\n\r\nSeems like a big update, since it would require constant declaration (and behavior) to work for all possible reference types. Only arrays would be a great start imo. Maybe only constant size arrays at first, if that is simpler. Seems like that change would be easier to do, since immutability checks are already in place (for calldata arrays in external functions). Guess the only thing that would be needed is to make sure that constant arrays are only accessed by constant/literal numbers.\r\n\r\nOn a related note, a thing I would like to be able to do is to declare a constant array, but assign a non constant variable to it and load it into memory that way. It would be much cleaner then having to create a function, or to do it \"on the spot\". Not sure if any of this is a good idea for Solidity though, or worth the trouble.\r\n\r\n```\r\ncontract C {\r\n    uint[4] constant nums = [uint(1), 2, 3, 4];\r\n    \r\n    function something() public {\r\n        uint[4] memory x = nums; // copies nums to memory\r\n        uint varN = 2;\r\n\r\n        x[2]; // allowed\r\n        x[varN]; // allowed.\r\n        x[2] = 5; // allowed, does not change 'nums'\r\n\r\n        nums[2]; // allowed\r\n        nums[varN]; // not allowed.\r\n        nums[2] == 5; // not allowed\r\n// ...\r\n    }\r\n}\r\n```\r\n\r\nMaybe constant types should be possible to declare inside of functions too, and behave the same way as regular constants.\r\n\r\n```\r\ncontract C {\r\n    uint[4] constant nums = [uint(1), 2, 3, 4];\r\n    \r\n    function something() public {\r\n        uint[4] constant x = nums; // does not copy\r\n        uint varN = 2;\r\n        uint constant constN = 2; // would also be possible\r\n\r\n        x[constN]; // allowed\r\n        x[2]; // allowed\r\n        x[varN]; // not allowed.\r\n        x[2] = 5; // not allowed\r\n        // ...\r\n    }\r\n}\r\n```\r\n\r\nSorry for sperging, but I have had some thoughts around this.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/395174544/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/534866477",
    "html_url": "https://github.com/ethereum/solidity/issues/4037#issuecomment-534866477",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/4037",
    "id": 534866477,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNDg2NjQ3Nw==",
    "user": {
      "login": "Pr0methean",
      "id": 4961925,
      "node_id": "MDQ6VXNlcjQ5NjE5MjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4961925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Pr0methean",
      "html_url": "https://github.com/Pr0methean",
      "followers_url": "https://api.github.com/users/Pr0methean/followers",
      "following_url": "https://api.github.com/users/Pr0methean/following{/other_user}",
      "gists_url": "https://api.github.com/users/Pr0methean/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Pr0methean/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Pr0methean/subscriptions",
      "organizations_url": "https://api.github.com/users/Pr0methean/orgs",
      "repos_url": "https://api.github.com/users/Pr0methean/repos",
      "events_url": "https://api.github.com/users/Pr0methean/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Pr0methean/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-25T05:58:36Z",
    "updated_at": "2019-09-25T05:58:36Z",
    "author_association": "NONE",
    "body": "The `pure` modifier isn't very useful without this feature: I've had to use `view` instead, just to avoid re-instantiating a zero BigNumber every time I use one.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/534866477/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
