{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/8032",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/8032/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/8032/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/8032/events",
  "html_url": "https://github.com/ethereum/solidity/issues/8032",
  "id": 539009850,
  "node_id": "MDU6SXNzdWU1MzkwMDk4NTA=",
  "number": 8032,
  "title": "[yul] optimizer's load resolver does not take side effects of user-defined function containing for loop(s) into account",
  "user": {
    "login": "bshastry",
    "id": 2388185,
    "node_id": "MDQ6VXNlcjIzODgxODU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2388185?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bshastry",
    "html_url": "https://github.com/bshastry",
    "followers_url": "https://api.github.com/users/bshastry/followers",
    "following_url": "https://api.github.com/users/bshastry/following{/other_user}",
    "gists_url": "https://api.github.com/users/bshastry/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bshastry/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bshastry/subscriptions",
    "organizations_url": "https://api.github.com/users/bshastry/orgs",
    "repos_url": "https://api.github.com/users/bshastry/repos",
    "events_url": "https://api.github.com/users/bshastry/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bshastry/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 249074435,
      "node_id": "MDU6TGFiZWwyNDkwNzQ0MzU=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/bug%20:bug:",
      "name": "bug :bug:",
      "color": "fc1313",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2019-12-17T11:33:19Z",
  "updated_at": "2019-12-17T19:39:34Z",
  "closed_at": "2019-12-17T19:39:34Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\n```\r\n{\r\n        function foo(x) {\r\n                // codecopy alters contents of mem[0]\r\n                for {} x { x := mload(0) codecopy(0, 77, 32)} {}\r\n        }\r\n        // mem[0] = 1337\r\n        mstore(0, 1337)\r\n        // Function with side-effects that alters memory\r\n        foo(42)\r\n        // mem[0] = 1337 may no longer be valid here\r\n        sstore(0, mload(0))\r\n}\r\n```\r\n\r\nis optimized to\r\n\r\n```\r\n            let _1 := 1337      \r\n            mstore(0, _1)       \r\n            let x := 42                                                \r\n            for { }             \r\n            x                   \r\n            {       \r\n                x := mload(0)\r\n                codecopy(0, 77, 32)\r\n            }\r\n            { }\r\n            // mload(0) is incorrectly resolved to initial assignment\r\n            sstore(0, _1)\r\n        }\r\n```\r\n\r\n## Environment\r\n\r\n- Compiler version: latest develop\r\n\r\n## Steps to Reproduce\r\n\r\n```\r\n$ solc --strict-assembly --optimize <test.yul>\r\n```",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/8032/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/8032/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/566504293",
    "html_url": "https://github.com/ethereum/solidity/issues/8032#issuecomment-566504293",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/8032",
    "id": 566504293,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NjUwNDI5Mw==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-17T11:34:58Z",
    "updated_at": "2019-12-17T11:34:58Z",
    "author_association": "MEMBER",
    "body": "@bshastry is the `codecopy` essential here?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/566504293/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/566505296",
    "html_url": "https://github.com/ethereum/solidity/issues/8032#issuecomment-566505296",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/8032",
    "id": 566505296,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NjUwNTI5Ng==",
    "user": {
      "login": "bshastry",
      "id": 2388185,
      "node_id": "MDQ6VXNlcjIzODgxODU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2388185?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bshastry",
      "html_url": "https://github.com/bshastry",
      "followers_url": "https://api.github.com/users/bshastry/followers",
      "following_url": "https://api.github.com/users/bshastry/following{/other_user}",
      "gists_url": "https://api.github.com/users/bshastry/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bshastry/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bshastry/subscriptions",
      "organizations_url": "https://api.github.com/users/bshastry/orgs",
      "repos_url": "https://api.github.com/users/bshastry/repos",
      "events_url": "https://api.github.com/users/bshastry/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bshastry/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-17T11:38:18Z",
    "updated_at": "2019-12-17T11:38:55Z",
    "author_association": "MEMBER",
    "body": "> @bshastry is the `codecopy` essential here?\r\n\r\nI think so because I've not been able to alter contents of memory in other ways that the load resolver does not see so far. May be I'm missing some trick to do it without codecopy.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/566505296/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/566506659",
    "html_url": "https://github.com/ethereum/solidity/issues/8032#issuecomment-566506659",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/8032",
    "id": 566506659,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NjUwNjY1OQ==",
    "user": {
      "login": "bshastry",
      "id": 2388185,
      "node_id": "MDQ6VXNlcjIzODgxODU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2388185?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bshastry",
      "html_url": "https://github.com/bshastry",
      "followers_url": "https://api.github.com/users/bshastry/followers",
      "following_url": "https://api.github.com/users/bshastry/following{/other_user}",
      "gists_url": "https://api.github.com/users/bshastry/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bshastry/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bshastry/subscriptions",
      "organizations_url": "https://api.github.com/users/bshastry/orgs",
      "repos_url": "https://api.github.com/users/bshastry/repos",
      "events_url": "https://api.github.com/users/bshastry/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bshastry/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-17T11:42:48Z",
    "updated_at": "2019-12-17T11:42:48Z",
    "author_association": "MEMBER",
    "body": "I'm wrong. codecopy is not essential.\r\n\r\n```\r\n{\r\n        function foo(x) {\r\n                for {} x { x := mload(0) mstore(0, 0)} {}\r\n        }\r\n        mstore(0, 1337)\r\n        foo(42)\r\n        sstore(0, mload(0))\r\n}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/566506659/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/566515165",
    "html_url": "https://github.com/ethereum/solidity/issues/8032#issuecomment-566515165",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/8032",
    "id": 566515165,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NjUxNTE2NQ==",
    "user": {
      "login": "bshastry",
      "id": 2388185,
      "node_id": "MDQ6VXNlcjIzODgxODU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2388185?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bshastry",
      "html_url": "https://github.com/bshastry",
      "followers_url": "https://api.github.com/users/bshastry/followers",
      "following_url": "https://api.github.com/users/bshastry/following{/other_user}",
      "gists_url": "https://api.github.com/users/bshastry/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bshastry/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bshastry/subscriptions",
      "organizations_url": "https://api.github.com/users/bshastry/orgs",
      "repos_url": "https://api.github.com/users/bshastry/repos",
      "events_url": "https://api.github.com/users/bshastry/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bshastry/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-17T12:09:55Z",
    "updated_at": "2019-12-17T12:09:55Z",
    "author_association": "MEMBER",
    "body": "This bug affects 0.5.14 as well.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/566515165/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/566717216",
    "html_url": "https://github.com/ethereum/solidity/issues/8032#issuecomment-566717216",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/8032",
    "id": 566717216,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NjcxNzIxNg==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-17T19:39:34Z",
    "updated_at": "2019-12-17T19:39:34Z",
    "author_association": "MEMBER",
    "body": "Fixed in #8034 ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/566717216/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
