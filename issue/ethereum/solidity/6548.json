{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/6548/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/6548/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/6548/events",
  "html_url": "https://github.com/ethereum/solidity/issues/6548",
  "id": 434643915,
  "node_id": "MDU6SXNzdWU0MzQ2NDM5MTU=",
  "number": 6548,
  "title": "Wasm codegen integer type issues",
  "user": {
    "login": "sifmelcara",
    "id": 10496191,
    "node_id": "MDQ6VXNlcjEwNDk2MTkx",
    "avatar_url": "https://avatars.githubusercontent.com/u/10496191?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sifmelcara",
    "html_url": "https://github.com/sifmelcara",
    "followers_url": "https://api.github.com/users/sifmelcara/followers",
    "following_url": "https://api.github.com/users/sifmelcara/following{/other_user}",
    "gists_url": "https://api.github.com/users/sifmelcara/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sifmelcara/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sifmelcara/subscriptions",
    "organizations_url": "https://api.github.com/users/sifmelcara/orgs",
    "repos_url": "https://api.github.com/users/sifmelcara/repos",
    "events_url": "https://api.github.com/users/sifmelcara/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sifmelcara/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 24,
  "created_at": "2019-04-18T08:12:36Z",
  "updated_at": "2019-05-07T03:31:09Z",
  "closed_at": "2019-05-07T03:31:08Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Follow-up of https://github.com/ethereum/solidity/issues/2405#issuecomment-483624120\r\n\r\nFrom my understanding, these are things that we can immediately start working on:\r\n\r\n- Introduce a transformation that turns 256 bit types/operations in yul into 32/64 bits types/operations.\r\n  * This will make the process of wasm codegen easier.\r\n- Make `libsolidity/codegen/ir/IRGenerator` generate yul code that conforms to spec. Currently the code it generate\r\n  * have no type info\r\n  * contains `FunctionalInstruction`s (e.g `add()`, `xor()`) ---- it should only contain functions listed in https://solidity.readthedocs.io/en/v0.5.7/yul.html#low-level-functions\r\n- Make `libyul/backends/evm` able to recognize low-level functions listed in [doc](https://solidity.readthedocs.io/en/v0.5.7/yul.html#low-level-functions) to keep current `--optimize-yul` feature working.",
  "closed_by": {
    "login": "sifmelcara",
    "id": 10496191,
    "node_id": "MDQ6VXNlcjEwNDk2MTkx",
    "avatar_url": "https://avatars.githubusercontent.com/u/10496191?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sifmelcara",
    "html_url": "https://github.com/sifmelcara",
    "followers_url": "https://api.github.com/users/sifmelcara/followers",
    "following_url": "https://api.github.com/users/sifmelcara/following{/other_user}",
    "gists_url": "https://api.github.com/users/sifmelcara/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sifmelcara/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sifmelcara/subscriptions",
    "organizations_url": "https://api.github.com/users/sifmelcara/orgs",
    "repos_url": "https://api.github.com/users/sifmelcara/repos",
    "events_url": "https://api.github.com/users/sifmelcara/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sifmelcara/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/6548/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/6548/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/484436251",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-484436251",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 484436251,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDQzNjI1MQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-18T10:04:39Z",
    "updated_at": "2019-04-18T10:04:39Z",
    "author_association": "MEMBER",
    "body": "Our current plan is to keep the IR generator producing strict assembly for now, because the EVM is still our main backend and because the optimizer is built for this dialect. We want to create a prototype translator for yet another dialect of Yul (#6547) to web assembly. To complete the transformation sequence, a third translation from strict assembly to this restricted wasm-targeted yul dialect would be needed.\r\n\r\nIf you want, you could work on this third transformation, but please keep in mind that the restricted wasm dialect is still subject to change and does not yet define the blockchain-related access functions.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/484436251/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/484782184",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-484782184",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 484782184,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDc4MjE4NA==",
    "user": {
      "login": "sifmelcara",
      "id": 10496191,
      "node_id": "MDQ6VXNlcjEwNDk2MTkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/10496191?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sifmelcara",
      "html_url": "https://github.com/sifmelcara",
      "followers_url": "https://api.github.com/users/sifmelcara/followers",
      "following_url": "https://api.github.com/users/sifmelcara/following{/other_user}",
      "gists_url": "https://api.github.com/users/sifmelcara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sifmelcara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sifmelcara/subscriptions",
      "organizations_url": "https://api.github.com/users/sifmelcara/orgs",
      "repos_url": "https://api.github.com/users/sifmelcara/repos",
      "events_url": "https://api.github.com/users/sifmelcara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sifmelcara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-19T06:37:49Z",
    "updated_at": "2019-04-19T06:37:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "Some questions:\r\n\r\n1. So, are low-level functions listed in https://solidity.readthedocs.io/en/v0.5.7/yul.html#low-level-functions obsolete? Looks like neither EVM nor eWasm dialect follow it. If it is indeed obsolete, we probably should update it before we start working on eWasm dialect.\r\n2. Shouldn't optimizer be dialect-agnostic?\r\n3. (Just for reference) For block-related access functions, I think https://ewasm.readthedocs.io/en/mkdocs/eth_interface/ is quite complete.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/484782184/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/484809826",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-484809826",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 484809826,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NDgwOTgyNg==",
    "user": {
      "login": "sifmelcara",
      "id": 10496191,
      "node_id": "MDQ6VXNlcjEwNDk2MTkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/10496191?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sifmelcara",
      "html_url": "https://github.com/sifmelcara",
      "followers_url": "https://api.github.com/users/sifmelcara/followers",
      "following_url": "https://api.github.com/users/sifmelcara/following{/other_user}",
      "gists_url": "https://api.github.com/users/sifmelcara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sifmelcara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sifmelcara/subscriptions",
      "organizations_url": "https://api.github.com/users/sifmelcara/orgs",
      "repos_url": "https://api.github.com/users/sifmelcara/repos",
      "events_url": "https://api.github.com/users/sifmelcara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sifmelcara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-19T08:34:28Z",
    "updated_at": "2019-04-19T08:34:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "I just found out that some of my questions have already been answered in #6274. So the strict Yul described in the document is planned to be implemented in the future, but not now. Am I correct?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/484809826/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/485390468",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-485390468",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 485390468,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NTM5MDQ2OA==",
    "user": {
      "login": "sifmelcara",
      "id": 10496191,
      "node_id": "MDQ6VXNlcjEwNDk2MTkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/10496191?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sifmelcara",
      "html_url": "https://github.com/sifmelcara",
      "followers_url": "https://api.github.com/users/sifmelcara/followers",
      "following_url": "https://api.github.com/users/sifmelcara/following{/other_user}",
      "gists_url": "https://api.github.com/users/sifmelcara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sifmelcara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sifmelcara/subscriptions",
      "organizations_url": "https://api.github.com/users/sifmelcara/orgs",
      "repos_url": "https://api.github.com/users/sifmelcara/repos",
      "events_url": "https://api.github.com/users/sifmelcara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sifmelcara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-22T10:51:29Z",
    "updated_at": "2019-04-22T10:51:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "So here is my imagination of how will the MVP implementation look like:\r\n```\r\n(A)\r\n  +----------+\r\n  | Solidity |\r\n  +----+-----+\r\n       |\r\n       | libsolidity/codegen/ir/\r\n(B)    v\r\n  +----+------------+\r\n  | strict assembly |\r\n  | (EVMDialect)    |\r\n  +----+------------+\r\n       |\r\n       | type labeler (to be implemented)\r\n       |\r\n(C)    v\r\n  +----+--------------+\r\n  | Yul (EVMDialect)  |\r\n  | All types are     |\r\n  | still u256        |\r\n  +----+--------------+\r\n       |\r\n       | Add WasmDialect builtin function\r\n       | implementation of EVM opcodes to\r\n       | the yul source code.\r\n       |\r\n(D)    v\r\n  +----+------------------+\r\n  | Yul (WasmDialect)     |\r\n  | The code now contains |\r\n  | u32, u64, and u256    |\r\n  +----+------------------+\r\n       |\r\n       | Replace identifiers that have\r\n       | type u256 with four u64 identifiers\r\n       |\r\n(E)    v\r\n  +----+------------------+\r\n  | Yul (WasmDialect)     |\r\n  | All types are u32/u64 |\r\n  +----+------------------+\r\n       |\r\n       | libyul/backends/wasm/\r\n       |\r\n       v\r\n  +----+----+\r\n  | eWasm   |\r\n  +---------+\r\n\r\n```\r\n## Notes\r\n#### (B) -> (C)\r\nI'm not sure if this \"type labeler\" is necessary (to be a separate transformation stage) at this moment. It translates strict assembly to Yul so I guess maybe this can also be useful for solidity to EVM pipeline in the future.\r\n#### (C) -> (D)\r\nWe append our own implementation of EVM opcodes to the yul source code. After this step, we don't need to parse EVM opcodes as `FunctionalInstruction` anymore.\r\n\r\nHere are two examples: (I'm not familiar with wasm, please forgive me if I get something wrong)\r\n```\r\nfunction add(x: u256, y: u256) -> result: u256\r\n{\r\n    let x1, x2, x3, x4 := unpacku256(x)\r\n    let y1, y2, y3, y4 := unpacku256(y)\r\n    let r1 := i64.add(x1, y1)\r\n    let r2 := i64.add(x2, y2)\r\n    let r3 := i64.add(x3, y3)\r\n    let r4 := i64.add(x4, y4)\r\n    // ...\r\n    // dealing with carrying\r\n    // ...\r\n    result := packu256(r1, r2, r3, r4)\r\n}\r\n\r\nfunction mload(location: u256) -> result: u256\r\n{\r\n    let numCurrentMemoryPage := memory.size()\r\n    if i32.le_u(\r\n        i32.mul(numCurrentMemoryPage, i32.mul(64: u32, 1024: u32)) // page size 64k\r\n        i32.add(location, 32: u32) // MLOAD loads 32 bytes at once\r\n       )\r\n    {\r\n        memory.grow(...)\r\n    }\r\n    let location32 := u256tou32(location)\r\n    let r1 := i64.load(i32.add(location32,  0: u32), 5: u32)\r\n    let r2 := i64.load(i32.add(location32,  8: u32), 5: u32)\r\n    let r3 := i64.load(i32.add(location32, 16: u32), 5: u32)\r\n    let r4 := i64.load(i32.add(location32, 24: u32), 5: u32)\r\n    result := packu256(r1, r2, r3, r4)\r\n}\r\n```\r\nNow only type conversion functions (`u256tou32`, `u256tou64`) and `u256 <---> (u64, u64, u64, u64)` conversion functions (`packu256`, `unpacku256`) revolve around `u256` data type. The usage of these functions can be removed at the transformation from (D) to (E).\r\n\r\n#### (D) -> (E)\r\nWe transform something like\r\n```\r\nfunction f(a: u64, b: u256, c: u64) -> result1 := u256, result2 := u64 {}\r\nlet x, y := f(u, v, s)\r\n```\r\nto\r\n```\r\nfunction f(a: u64, b_1: u64, b_2: u64, b_3: u64, b_4: u64, c: u64) -> result1_1: u64, result1_2: u64, result1_3: u64, result1_4: u64, result2 := u64 {}\r\nlet x_1, x_2, x_3, x_4, y := f(u, v_1, v_2, v_3, v_4, s)\r\n```\r\nThus `packu256` and `unpacku256` can be removed.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/485390468/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/485407630",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-485407630",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 485407630,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NTQwNzYzMA==",
    "user": {
      "login": "sifmelcara",
      "id": 10496191,
      "node_id": "MDQ6VXNlcjEwNDk2MTkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/10496191?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sifmelcara",
      "html_url": "https://github.com/sifmelcara",
      "followers_url": "https://api.github.com/users/sifmelcara/followers",
      "following_url": "https://api.github.com/users/sifmelcara/following{/other_user}",
      "gists_url": "https://api.github.com/users/sifmelcara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sifmelcara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sifmelcara/subscriptions",
      "organizations_url": "https://api.github.com/users/sifmelcara/orgs",
      "repos_url": "https://api.github.com/users/sifmelcara/repos",
      "events_url": "https://api.github.com/users/sifmelcara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sifmelcara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-22T12:35:34Z",
    "updated_at": "2019-04-22T12:35:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "Oh, and FWIW, EVM is big-endian while wasm is little-endian. We need to be careful.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/485407630/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/485665107",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-485665107",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 485665107,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NTY2NTEwNw==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-23T06:47:03Z",
    "updated_at": "2019-04-23T06:47:03Z",
    "author_association": "MEMBER",
    "body": "@sifmelcara yep, that's exactly how I imagined it! Note that we might introduce (semantic) types already at the IR generation stage, for example to distinguish between a memory pointer, a storage pointer and a \"regular\" number. There should be an issue about that already.\r\n\r\nI'll try to finish multi-returns for wasm today, so you could already work on (C) -> (D) already, even though without types (i.e. assuming everything is u256 before the transform and u64 after the transform).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/485665107/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486362645",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-486362645",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 486362645,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjM2MjY0NQ==",
    "user": {
      "login": "sifmelcara",
      "id": 10496191,
      "node_id": "MDQ6VXNlcjEwNDk2MTkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/10496191?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sifmelcara",
      "html_url": "https://github.com/sifmelcara",
      "followers_url": "https://api.github.com/users/sifmelcara/followers",
      "following_url": "https://api.github.com/users/sifmelcara/following{/other_user}",
      "gists_url": "https://api.github.com/users/sifmelcara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sifmelcara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sifmelcara/subscriptions",
      "organizations_url": "https://api.github.com/users/sifmelcara/orgs",
      "repos_url": "https://api.github.com/users/sifmelcara/repos",
      "events_url": "https://api.github.com/users/sifmelcara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sifmelcara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-24T18:03:54Z",
    "updated_at": "2019-04-24T18:03:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "I decide to exchange the order of (C) -> (D) and (D) -> (E) pipeline, by doing this, we don't even need `packu256`, `unpacku256` and type conversion functions anymore.\r\n\r\nI remember there was a discussion about whether we want to allow the following code to work, but I can't find the discussion anymore\r\n```\r\n{\r\n    function foo() -> x1, x2 { }\r\n    function bar(x1, x2, x3, x4) { }\r\n    function main()\r\n    {\r\n        bar(1, foo(), 2)\r\n    }\r\n}\r\n```\r\nAny ideas? Maybe I can assume input is always pseudo-SSA to side-step this complicate case of transformation though.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486362645/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486407871",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-486407871",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 486407871,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjQwNzg3MQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-24T20:14:19Z",
    "updated_at": "2019-04-24T20:14:19Z",
    "author_association": "MEMBER",
    "body": "Currently the only place where a function that returns multiple values can be used is in a variable declaration or an assignment.\r\n\r\nWe should probably take a look at some more examples to see whether replacing EVM functions by eWasm functions or removing large types makes more sense to do first. Depending on what is done first, we either need multi-variable versions of EVM opcodes or large-type versions of eWasm functions...",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486407871/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486499542",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-486499542",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 486499542,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjQ5OTU0Mg==",
    "user": {
      "login": "sifmelcara",
      "id": 10496191,
      "node_id": "MDQ6VXNlcjEwNDk2MTkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/10496191?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sifmelcara",
      "html_url": "https://github.com/sifmelcara",
      "followers_url": "https://api.github.com/users/sifmelcara/followers",
      "following_url": "https://api.github.com/users/sifmelcara/following{/other_user}",
      "gists_url": "https://api.github.com/users/sifmelcara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sifmelcara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sifmelcara/subscriptions",
      "organizations_url": "https://api.github.com/users/sifmelcara/orgs",
      "repos_url": "https://api.github.com/users/sifmelcara/repos",
      "events_url": "https://api.github.com/users/sifmelcara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sifmelcara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-25T02:46:30Z",
    "updated_at": "2019-04-25T02:46:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Depending on what is done first, we either need multi-variable versions of EVM opcodes or large-type versions of eWasm functions\r\n\r\nI think the difference is how \"ewasm's implementation of Functional Instruction\" 's interface will look like: `add(u256, u256) -> u256` v.s `add(u64, u64, u64, u64, u64, u64, u64, u64) -> u64, u64, u64, u64`.\r\n\r\nSo... the question is, how can we convert the following code's type from u256 to four u64?\r\n```\r\n{\r\n    function foo() -> r: u256 { }\r\n    function bar(x: u256) -> b:u256 { }\r\n    function main()\r\n    {\r\n        for {} bar(foo()) {} {}\r\n    }\r\n}\r\n```\r\nIf we simply replace u256 by four u64, the code becomes:\r\n```\r\n{\r\n    function foo() -> r: u64, u64, u64, u64 { }\r\n    function bar(x1: u64, x2: u64, x3: u64, x4: u64) -> b1: u64, b2: u64, b3: u64, b4: u64 { }\r\n    function main()\r\n    {\r\n        for {} bar(foo()) {} {}\r\n    }\r\n}\r\n```\r\nwhich is not valid.\r\n\r\nA lazy solution would be to apply #6480 and expression splitter before this transformation...",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486499542/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486545962",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-486545962",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 486545962,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjU0NTk2Mg==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-25T07:06:07Z",
    "updated_at": "2019-04-25T07:06:07Z",
    "author_association": "MEMBER",
    "body": "Yes indeed, we need the expression splitter! Also my hope is that we can have a transform that removes some of those variables if we can show that the values before the transformation are small enough (I think we also have an issue about that).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486545962/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486556144",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-486556144",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 486556144,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjU1NjE0NA==",
    "user": {
      "login": "sifmelcara",
      "id": 10496191,
      "node_id": "MDQ6VXNlcjEwNDk2MTkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/10496191?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sifmelcara",
      "html_url": "https://github.com/sifmelcara",
      "followers_url": "https://api.github.com/users/sifmelcara/followers",
      "following_url": "https://api.github.com/users/sifmelcara/following{/other_user}",
      "gists_url": "https://api.github.com/users/sifmelcara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sifmelcara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sifmelcara/subscriptions",
      "organizations_url": "https://api.github.com/users/sifmelcara/orgs",
      "repos_url": "https://api.github.com/users/sifmelcara/repos",
      "events_url": "https://api.github.com/users/sifmelcara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sifmelcara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-25T07:42:06Z",
    "updated_at": "2019-04-25T07:42:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Also my hope is that we can have a transform that removes some of those variables if we can show that the values before the transformation are small enough\r\n\r\nI agree! I think this is kind of https://en.wikipedia.org/wiki/Value_range_analysis and should be part of the optimization phases.\r\n\r\nI have finished the u256 to four u64 transformation (except `If` and `Switch`, and currently assume we have #6480 and expression splitter). Currently it feels like\r\n\r\n```\r\n$ ./build/test/tools/yulopti code.yul \r\n----------------------\r\n{\r\n    function swap(x, y) -> a, b\r\n    {\r\n        a := y\r\n        b := x\r\n    }\r\n    function main(v1, v2) -> r1, r2\r\n    {\r\n        let tmp := 7\r\n        v1 := 9\r\n        r1, r2 := swap(v1, tmp)\r\n        r1, r2 := swap(42, r2)\r\n    }\r\n}\r\n\r\n\r\n(q)quit/(f)flatten/(c)se/initialize var(d)ecls/(x)plit/(j)oin/(g)rouper/(h)oister/\r\n  (e)xpr inline/(i)nline/(s)implify/varname c(l)eaner/(u)nusedprune/ss(a) transform/\r\n  (r)edundant assign elim./re(m)aterializer/f(o)r-loop-pre-rewriter/\r\n  s(t)ructural simplifier/equi(v)alent function combiner/ssa re(V)erser/? \r\n  stack com(p)ressor/(D)ead code eliminator/(w)ord size transformer/? \r\n w\r\n----------------------\r\n{\r\n    function swap(x_1, x_2, x_3, x_4, y_5, y_6, y_7, y_8) -> a_9, a_10, a_11, a_12, b_13, b_14, b_15, b_16\r\n    {\r\n        a_9 := y_5\r\n        a_10 := y_6\r\n        a_11 := y_7\r\n        a_12 := y_8\r\n        b_13 := x_1\r\n        b_14 := x_2\r\n        b_15 := x_3\r\n        b_16 := x_4\r\n    }\r\n    function main(v1_17, v1_18, v1_19, v1_20, v2_21, v2_22, v2_23, v2_24) -> r1_25, r1_26, r1_27, r1_28, r2_29, r2_30, r2_31, r2_32\r\n    {\r\n        let tmp_33 := 0\r\n        let tmp_34 := 0\r\n        let tmp_35 := 0\r\n        let tmp_36 := 7\r\n        v1_17 := 0\r\n        v1_18 := 0\r\n        v1_19 := 0\r\n        v1_20 := 9\r\n        r1_25, r1_26, r1_27, r1_28, r2_29, r2_30, r2_31, r2_32 := swap(v1_17, v1_18, v1_19, v1_20, tmp_33, tmp_34, tmp_35, tmp_36)\r\n        r1_25, r1_26, r1_27, r1_28, r2_29, r2_30, r2_31, r2_32 := swap(0, 0, 0, 42, r2_29, r2_30, r2_31, r2_32)\r\n    }\r\n}\r\n```\r\nA `Switch` can be implemented by 4-layer nesting `Switch`. And `If` can be translated to `Switch`. (But I'm a little bit afraid that the code size will blow up...)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486556144/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486558311",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-486558311",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 486558311,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjU1ODMxMQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-25T07:48:57Z",
    "updated_at": "2019-04-25T07:48:57Z",
    "author_association": "MEMBER",
    "body": "Looks great! Can you create a pull request for that?\r\nHm, I have to admit that I haven't thought about switch, that is a bit nasty.\r\nIf should be rather easy, though, you can use `if x` -> `if or(or(x_1, x_2), or(x_3, x_4))`. If we had real types, this would not be a problem since a `bool `always fits 64 bits :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486558311/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486578643",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-486578643",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 486578643,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjU3ODY0Mw==",
    "user": {
      "login": "sifmelcara",
      "id": 10496191,
      "node_id": "MDQ6VXNlcjEwNDk2MTkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/10496191?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sifmelcara",
      "html_url": "https://github.com/sifmelcara",
      "followers_url": "https://api.github.com/users/sifmelcara/followers",
      "following_url": "https://api.github.com/users/sifmelcara/following{/other_user}",
      "gists_url": "https://api.github.com/users/sifmelcara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sifmelcara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sifmelcara/subscriptions",
      "organizations_url": "https://api.github.com/users/sifmelcara/orgs",
      "repos_url": "https://api.github.com/users/sifmelcara/repos",
      "events_url": "https://api.github.com/users/sifmelcara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sifmelcara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-25T08:51:04Z",
    "updated_at": "2019-04-25T08:51:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Looks great! Can you create a pull request for that?\r\n\r\nThis work apparently depends on #6547 so I planned to open PR after #6547 merge. (Just to avoid the need to force push again)\r\n\r\n> you can use if x -> if or(or(x_1, x_2), or(x_3, x_4))\r\n\r\nOh! I actually can do this. Previously I was thinking that this will cause trouble because both EVM and eWasm have `or`. But actually one is `FunctionalInstruction` and the other is `FunctionCall`. They are different in memory representation of yul AST.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486578643/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486588435",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-486588435",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 486588435,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjU4ODQzNQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-25T09:19:08Z",
    "updated_at": "2019-04-25T09:19:08Z",
    "author_association": "MEMBER",
    "body": "Don't have any false illusions about not having to force-push :)\r\n\r\nCorncerning the or: What is the set of builtin functions you want to use after splitting up the variables? You do need something in between don't you? Ah, and after https://github.com/ethereum/solidity/pull/6579 we probably plan to rename the wasm functions to `i64.add` (just how they are called in the wasm spec) - so you could actually use a hybrid dialect that defines both sets of functions...",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486588435/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486626829",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-486626829",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 486626829,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjYyNjgyOQ==",
    "user": {
      "login": "sifmelcara",
      "id": 10496191,
      "node_id": "MDQ6VXNlcjEwNDk2MTkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/10496191?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sifmelcara",
      "html_url": "https://github.com/sifmelcara",
      "followers_url": "https://api.github.com/users/sifmelcara/followers",
      "following_url": "https://api.github.com/users/sifmelcara/following{/other_user}",
      "gists_url": "https://api.github.com/users/sifmelcara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sifmelcara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sifmelcara/subscriptions",
      "organizations_url": "https://api.github.com/users/sifmelcara/orgs",
      "repos_url": "https://api.github.com/users/sifmelcara/repos",
      "events_url": "https://api.github.com/users/sifmelcara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sifmelcara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-25T11:02:15Z",
    "updated_at": "2019-04-25T11:02:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "> What is the set of builtin functions you want to use after splitting up the variables?\r\n\r\nProbably only `i64.or` for `If`?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486626829/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486646539",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-486646539",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 486646539,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjY0NjUzOQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-25T12:12:02Z",
    "updated_at": "2019-04-25T12:12:02Z",
    "author_association": "MEMBER",
    "body": "But doesn't that mean that you have to do both steps (splitting variables and changing functions) at the same time?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486646539/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486935139",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-486935139",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 486935139,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjkzNTEzOQ==",
    "user": {
      "login": "sifmelcara",
      "id": 10496191,
      "node_id": "MDQ6VXNlcjEwNDk2MTkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/10496191?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sifmelcara",
      "html_url": "https://github.com/sifmelcara",
      "followers_url": "https://api.github.com/users/sifmelcara/followers",
      "following_url": "https://api.github.com/users/sifmelcara/following{/other_user}",
      "gists_url": "https://api.github.com/users/sifmelcara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sifmelcara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sifmelcara/subscriptions",
      "organizations_url": "https://api.github.com/users/sifmelcara/orgs",
      "repos_url": "https://api.github.com/users/sifmelcara/repos",
      "events_url": "https://api.github.com/users/sifmelcara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sifmelcara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-26T05:54:37Z",
    "updated_at": "2019-04-26T05:54:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hmm... Sorry I don't understand your question. After applying this `WordSizeTransform`, the tasks left is to implement builtins like `add(u64, u64, u64, u64, u64, u64, u64, u64) -> u64, u64, u64, u64` in `WasmDialect`. Am I correct?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486935139/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486936316",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-486936316",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 486936316,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjkzNjMxNg==",
    "user": {
      "login": "sifmelcara",
      "id": 10496191,
      "node_id": "MDQ6VXNlcjEwNDk2MTkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/10496191?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sifmelcara",
      "html_url": "https://github.com/sifmelcara",
      "followers_url": "https://api.github.com/users/sifmelcara/followers",
      "following_url": "https://api.github.com/users/sifmelcara/following{/other_user}",
      "gists_url": "https://api.github.com/users/sifmelcara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sifmelcara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sifmelcara/subscriptions",
      "organizations_url": "https://api.github.com/users/sifmelcara/orgs",
      "repos_url": "https://api.github.com/users/sifmelcara/repos",
      "events_url": "https://api.github.com/users/sifmelcara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sifmelcara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-26T06:00:43Z",
    "updated_at": "2019-04-26T06:00:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "> the tasks left is to implement builtins like `add(u64, u64, u64, u64, u64, u64, u64, u64) -> u64, u64, u64, u64` in `WasmDialect`.\r\n\r\n(This assumes that we want to support both `add(u64, u64, u64, u64, u64, u64, u64, u64) -> u64, u64, u64, u64` and `i64.add()` as builtin)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486936316/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/487564381",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-487564381",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 487564381,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NzU2NDM4MQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-29T12:44:01Z",
    "updated_at": "2019-04-29T12:44:01Z",
    "author_association": "MEMBER",
    "body": "I think I lost some context here. I'll just wait what you come up with, if you don't mind :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/487564381/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/487713507",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-487713507",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 487713507,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NzcxMzUwNw==",
    "user": {
      "login": "sifmelcara",
      "id": 10496191,
      "node_id": "MDQ6VXNlcjEwNDk2MTkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/10496191?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sifmelcara",
      "html_url": "https://github.com/sifmelcara",
      "followers_url": "https://api.github.com/users/sifmelcara/followers",
      "following_url": "https://api.github.com/users/sifmelcara/following{/other_user}",
      "gists_url": "https://api.github.com/users/sifmelcara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sifmelcara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sifmelcara/subscriptions",
      "organizations_url": "https://api.github.com/users/sifmelcara/orgs",
      "repos_url": "https://api.github.com/users/sifmelcara/repos",
      "events_url": "https://api.github.com/users/sifmelcara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sifmelcara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-29T19:33:54Z",
    "updated_at": "2019-04-29T19:37:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "Sorry that I somewhat messed up the discussion. Here is the current planning in my mind (much simpler to implement!):\r\n\r\n```\r\n(A)\r\n  +----------+\r\n  | Solidity |\r\n  +----+-----+\r\n       |\r\n       | libsolidity/codegen/ir/\r\n(B)    |\r\n  +----+------------+\r\n  | strict assembly |\r\n  | (EVMDialect)    |\r\n  +----+------------+\r\n       |\r\n       | Replace u256 identifiers with\r\n       | four u64 identifiers.\r\n       | (libyul/backends/wasm/WordSizeTransform.h)\r\n (C)   |\r\n  +----v--------------+\r\n  | strict assembly   |\r\n  | (WasmDialect)     |\r\n  | All types are u64 |\r\n  +----+--------------+\r\n       |\r\n       | libyul/backends/wasm/EWasmCodeTransform\r\n (D)   |\r\n  +----v---------------------+\r\n  |                          |\r\n  | wasm text representation |\r\n  |                          |\r\n  +----+---------------------+\r\n       |\r\n       | Append wasm implementation of EVM instructions\r\n (E)   |\r\n  +----v---------------------+\r\n  |                          |\r\n  | wasm text representation |\r\n  |                          |\r\n  +--------------------------+\r\n\r\n```\r\n\r\nComparing to previous plan, major differences are:\r\n\r\n1. Use strict assembly for the whole process.\r\n2. Instead of implement EVM instructions in Yul, we implement them in wasm text representation.\r\n\r\n#### (C) -> (D)\r\n\r\nWe should generate a function call In #6556 `wasm::Expression EWasmCodeTransform::operator()(FunctionalInstruction const&)`. For example, when encounter `Instruction::ADD`, we generate a function call to `builtin_evm_add`.\r\n\r\n#### (D) -> (E)\r\n\r\nSimply append (prepend?) something like\r\n```\r\n(func $builtin_evm_add\r\n  (param $arg_1 i64)\r\n  (param $arg_2 i64)\r\n  (param $arg_3 i64)\r\n  (param $arg_4 i64)\r\n  (param $arg_5 i64)\r\n  (param $arg_6 i64)\r\n  (param $arg_7 i64)\r\n  (param $arg_8 i64)\r\n  (result i64)\r\n  ;; actual implementation here\r\n  ;; should follow calling conventions in EWasmCodeTransform (use set_global in case of multiple return values)\r\n)\r\n```\r\n\r\nActually I think we are very close to the MVP (?) that compiles \"Instruction::ADD only\" solidity code to working eWasm.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/487713507/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/489565119",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-489565119",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 489565119,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTU2NTExOQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-06T09:46:27Z",
    "updated_at": "2019-05-06T09:46:27Z",
    "author_association": "MEMBER",
    "body": "I think it would be better to do (D) -> (E) still in strict assembly mode (of course with different types and different builtins), because it allows us to still optimize the code afterwards, for example if we can determine that certain variables do not use higher order bits.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/489565119/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/489568440",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-489568440",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 489568440,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTU2ODQ0MA==",
    "user": {
      "login": "sifmelcara",
      "id": 10496191,
      "node_id": "MDQ6VXNlcjEwNDk2MTkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/10496191?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sifmelcara",
      "html_url": "https://github.com/sifmelcara",
      "followers_url": "https://api.github.com/users/sifmelcara/followers",
      "following_url": "https://api.github.com/users/sifmelcara/following{/other_user}",
      "gists_url": "https://api.github.com/users/sifmelcara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sifmelcara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sifmelcara/subscriptions",
      "organizations_url": "https://api.github.com/users/sifmelcara/orgs",
      "repos_url": "https://api.github.com/users/sifmelcara/repos",
      "events_url": "https://api.github.com/users/sifmelcara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sifmelcara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-06T09:59:47Z",
    "updated_at": "2019-05-06T09:59:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "How about utilizing binaryen's optimization passes? it have wasm-specific optimization so probably is more effective comparing to general-purpose yul optimizations.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/489568440/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/489576697",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-489576697",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 489576697,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTU3NjY5Nw==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-06T10:36:38Z",
    "updated_at": "2019-05-06T10:36:38Z",
    "author_association": "MEMBER",
    "body": "I would still like to use our optimizer if that is an easy thing to do. We can always use binaryen/llvm/whatever afterwards.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/489576697/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/489893995",
    "html_url": "https://github.com/ethereum/solidity/issues/6548#issuecomment-489893995",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6548",
    "id": 489893995,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTg5Mzk5NQ==",
    "user": {
      "login": "sifmelcara",
      "id": 10496191,
      "node_id": "MDQ6VXNlcjEwNDk2MTkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/10496191?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sifmelcara",
      "html_url": "https://github.com/sifmelcara",
      "followers_url": "https://api.github.com/users/sifmelcara/followers",
      "following_url": "https://api.github.com/users/sifmelcara/following{/other_user}",
      "gists_url": "https://api.github.com/users/sifmelcara/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sifmelcara/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sifmelcara/subscriptions",
      "organizations_url": "https://api.github.com/users/sifmelcara/orgs",
      "repos_url": "https://api.github.com/users/sifmelcara/repos",
      "events_url": "https://api.github.com/users/sifmelcara/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sifmelcara/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-07T03:31:08Z",
    "updated_at": "2019-05-07T03:31:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "Ok! Closing this issue for now, as integer type issues are somewhat solved by #6600 ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/489893995/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
