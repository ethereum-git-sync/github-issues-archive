{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/12189",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/12189/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/12189/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/12189/events",
  "html_url": "https://github.com/ethereum/solidity/issues/12189",
  "id": 1035751583,
  "node_id": "I_kwDOAm_5kc49vFCf",
  "number": 12189,
  "title": "\"assert\" example is a poor example",
  "user": {
    "login": "abliss",
    "id": 215283,
    "node_id": "MDQ6VXNlcjIxNTI4Mw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/215283?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/abliss",
    "html_url": "https://github.com/abliss",
    "followers_url": "https://api.github.com/users/abliss/followers",
    "following_url": "https://api.github.com/users/abliss/following{/other_user}",
    "gists_url": "https://api.github.com/users/abliss/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/abliss/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/abliss/subscriptions",
    "organizations_url": "https://api.github.com/users/abliss/orgs",
    "repos_url": "https://api.github.com/users/abliss/repos",
    "events_url": "https://api.github.com/users/abliss/events{/privacy}",
    "received_events_url": "https://api.github.com/users/abliss/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-10-26T02:25:14Z",
  "updated_at": "2021-10-26T08:31:33Z",
  "closed_at": "2021-10-26T08:26:57Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Page\r\n\r\nhttps://docs.soliditylang.org/en/v0.6.2/control-structures.html?highlight=assert#id4\r\n## Abstract\r\n\r\n<!--\r\nPlease describe in detail what is wrong.\r\n-->\r\nThe page describes \"assert\" saying that it \"should only be used to test for internal errors, and to check invariants. Properly functioning code should never reach a failing assert statement; if this happens there is a bug in your contract which you should fix.\" By contrast, \"The require function should be used to ensure valid conditions that cannot be detected until execution time. This includes conditions on inputs or return values from calls to external contracts.\" \r\n\r\nIt then gives this example:\r\n```solidity\r\npragma solidity >=0.5.0 <0.7.0;\r\n\r\ncontract Sharer {\r\n    function sendHalf(address payable addr) public payable returns (uint balance) {\r\n        require(msg.value % 2 == 0, \"Even value required.\");\r\n        uint balanceBeforeTransfer = address(this).balance;\r\n        addr.transfer(msg.value / 2);\r\n        // Since transfer throws an exception on failure and\r\n        // cannot call back here, there should be no way for us to\r\n        // still have half of the money.\r\n        assert(address(this).balance == balanceBeforeTransfer - msg.value / 2);\r\n        return address(this).balance;\r\n    }\r\n} \r\n```\r\n\r\nHowever, I believe the `assert` in this contract can indeed fail, if the passed argument `addr` is a contract whose `receive()` sends some money back to the Sharer before returning. (I don't know why the comment says that transfer \"cannot call back here\".)\r\n\r\n## Suggested fix\r\nPerhaps the `==` in the assert could be replaced with a `>=`?",
  "closed_by": {
    "login": "hrkrshnn",
    "id": 13174375,
    "node_id": "MDQ6VXNlcjEzMTc0Mzc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/13174375?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hrkrshnn",
    "html_url": "https://github.com/hrkrshnn",
    "followers_url": "https://api.github.com/users/hrkrshnn/followers",
    "following_url": "https://api.github.com/users/hrkrshnn/following{/other_user}",
    "gists_url": "https://api.github.com/users/hrkrshnn/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hrkrshnn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hrkrshnn/subscriptions",
    "organizations_url": "https://api.github.com/users/hrkrshnn/orgs",
    "repos_url": "https://api.github.com/users/hrkrshnn/repos",
    "events_url": "https://api.github.com/users/hrkrshnn/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hrkrshnn/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/12189/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/12189/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/951705049",
    "html_url": "https://github.com/ethereum/solidity/issues/12189#issuecomment-951705049",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12189",
    "id": 951705049,
    "node_id": "IC_kwDOAm_5kc44ud3Z",
    "user": {
      "login": "hrkrshnn",
      "id": 13174375,
      "node_id": "MDQ6VXNlcjEzMTc0Mzc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/13174375?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hrkrshnn",
      "html_url": "https://github.com/hrkrshnn",
      "followers_url": "https://api.github.com/users/hrkrshnn/followers",
      "following_url": "https://api.github.com/users/hrkrshnn/following{/other_user}",
      "gists_url": "https://api.github.com/users/hrkrshnn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hrkrshnn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hrkrshnn/subscriptions",
      "organizations_url": "https://api.github.com/users/hrkrshnn/orgs",
      "repos_url": "https://api.github.com/users/hrkrshnn/repos",
      "events_url": "https://api.github.com/users/hrkrshnn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hrkrshnn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-26T08:26:57Z",
    "updated_at": "2021-10-26T08:31:33Z",
    "author_association": "MEMBER",
    "body": "> However, I believe the assert in this contract can indeed fail, if the passed argument addr is a contract whose receive() sends some money back to the Sharer before returning. (I don't know why the comment says that transfer \"cannot call back here\".)\r\n\r\nTransfer currently only forwards at most 2300 gas. A value transferring call needs at least 9000 gas. Therefore, a callback cannot forward ETH. Callbacks can happen, though; but cannot transfer ETH or modify state in other ways.\r\n\r\nClosing this for now. Feel free to comment if you have questions.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/951705049/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
