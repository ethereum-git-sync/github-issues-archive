{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/13879",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/13879/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/13879/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/13879/events",
  "html_url": "https://github.com/ethereum/solidity/issues/13879",
  "id": 1537050469,
  "node_id": "I_kwDOAm_5kc5bnYdl",
  "number": 13879,
  "title": "Overload resolution between functions taking view and non-view function pointers results in a compiler error",
  "user": {
    "login": "wadealexc",
    "id": 18387287,
    "node_id": "MDQ6VXNlcjE4Mzg3Mjg3",
    "avatar_url": "https://avatars.githubusercontent.com/u/18387287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wadealexc",
    "html_url": "https://github.com/wadealexc",
    "followers_url": "https://api.github.com/users/wadealexc/followers",
    "following_url": "https://api.github.com/users/wadealexc/following{/other_user}",
    "gists_url": "https://api.github.com/users/wadealexc/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wadealexc/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wadealexc/subscriptions",
    "organizations_url": "https://api.github.com/users/wadealexc/orgs",
    "repos_url": "https://api.github.com/users/wadealexc/repos",
    "events_url": "https://api.github.com/users/wadealexc/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wadealexc/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-01-17T21:19:28Z",
  "updated_at": "2023-01-19T19:42:13Z",
  "closed_at": "2023-01-17T22:19:21Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nOverloaded library functions cannot be passed function types with different mutability modifiers - this causes a compiler error, instead.\r\n\r\n## Environment\r\n\r\n- Compiler version: 0.8.17\r\n- Target EVM version (as per compiler settings): default remix EVM (merge)\r\n- Framework/IDE (e.g. Truffle or Remix): tested using both Remix and solc-js\r\n- EVM execution environment / backend / blockchain client:\r\n- Operating system: Ubuntu 22.04\r\n\r\n## Steps to Reproduce\r\n\r\nThe lines in User.setup cause a compilation error:\r\n\r\n```solidity\r\n// SPDX-License-Identifier: UNLICENSED\r\npragma solidity ^0.8.0;\r\n\r\nlibrary TestLib {\r\n\r\n    function add(function() external view f) internal {\r\n        f();\r\n    }\r\n\r\n    function add(function() external f) internal {\r\n        f();\r\n    }\r\n}\r\n\r\ncontract User {\r\n\r\n    using TestLib for *;\r\n\r\n    function setup() public {\r\n        this.testOne.add();\r\n        this.testTwo.add();\r\n    }\r\n\r\n    function testOne() external view {\r\n        require(msg.sender != address(0), \"test value\");\r\n    }\r\n\r\n    function testTwo() external {\r\n        require(msg.sender != address(0), \"test value 2\");\r\n    }\r\n}\r\n```\r\n",
  "closed_by": {
    "login": "cameel",
    "id": 137030,
    "node_id": "MDQ6VXNlcjEzNzAzMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cameel",
    "html_url": "https://github.com/cameel",
    "followers_url": "https://api.github.com/users/cameel/followers",
    "following_url": "https://api.github.com/users/cameel/following{/other_user}",
    "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
    "organizations_url": "https://api.github.com/users/cameel/orgs",
    "repos_url": "https://api.github.com/users/cameel/repos",
    "events_url": "https://api.github.com/users/cameel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cameel/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/13879/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/13879/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1386159430",
    "html_url": "https://github.com/ethereum/solidity/issues/13879#issuecomment-1386159430",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13879",
    "id": 1386159430,
    "node_id": "IC_kwDOAm_5kc5Snx1G",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-17T22:19:21Z",
    "updated_at": "2023-01-17T22:19:21Z",
    "author_association": "MEMBER",
    "body": "This does not look like a bug.\r\n\r\nFirst, I think you meant functions attached with `using for` rather than modifiers (modifiers are declared with the `modifier` keyword). Second, this does not have anything to do with such functions. You can reproduce the same error without them:\r\n\r\n```solidity\r\nlibrary L {\r\n    function add(function() external view f) internal {}\r\n    function add(function() external f) internal {}\r\n}\r\n\r\ncontract C {\r\n    function test() public {\r\n        L.add(this.ext);\r\n        L.add(this.extView);\r\n    }\r\n\r\n    function ext() external view {}\r\n    function extView() external {}\r\n}\r\n```\r\n```\r\nError: Member \"add\" not unique after argument-dependent lookup in type(library L).\r\n --> test.sol:8:9:\r\n  |\r\n8 |         L.add(this.ext);\r\n  |         ^^^^^\r\n```\r\n\r\nBut the thing is, this works as designed. One of your calls is ambiguous and matches both overloads. That's because a pointer to a view function can be passed both into a view and non-view parameter.\r\n\r\nThe non-view pointer on the other hand works only with the second overload and it does not cause an error. You can check that this code will compiler if you comment-out `L.add(this.ext)`.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1386159430/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1397129413",
    "html_url": "https://github.com/ethereum/solidity/issues/13879#issuecomment-1397129413",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13879",
    "id": 1397129413,
    "node_id": "IC_kwDOAm_5kc5TRoDF",
    "user": {
      "login": "wadealexc",
      "id": 18387287,
      "node_id": "MDQ6VXNlcjE4Mzg3Mjg3",
      "avatar_url": "https://avatars.githubusercontent.com/u/18387287?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wadealexc",
      "html_url": "https://github.com/wadealexc",
      "followers_url": "https://api.github.com/users/wadealexc/followers",
      "following_url": "https://api.github.com/users/wadealexc/following{/other_user}",
      "gists_url": "https://api.github.com/users/wadealexc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wadealexc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wadealexc/subscriptions",
      "organizations_url": "https://api.github.com/users/wadealexc/orgs",
      "repos_url": "https://api.github.com/users/wadealexc/repos",
      "events_url": "https://api.github.com/users/wadealexc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wadealexc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-19T15:13:13Z",
    "updated_at": "2023-01-19T15:13:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "By \"modifier\" I meant the words that affect the mutability of the function. i.e. \"view\" or \"payable\" were the \"mutabillity modifiers\". Sorry for the confusing wording!\r\n\r\nI see, your explanation makes sense. It's frustrating that it works this way, because the usecase I have is that I want the `add` function to ultimately call the passed-in function type with either a `CALL` or `STATICCALL`, depending on the mutability of the function type.\r\n\r\nI'm having to use different function names to accomplish this (`addView` and `addMut` etc), which is not as nice to read.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1397129413/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1397507915",
    "html_url": "https://github.com/ethereum/solidity/issues/13879#issuecomment-1397507915",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13879",
    "id": 1397507915,
    "node_id": "IC_kwDOAm_5kc5TTEdL",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-19T19:42:12Z",
    "updated_at": "2023-01-19T19:42:12Z",
    "author_association": "MEMBER",
    "body": "Well, this is something that we want to solve eventually. There's an issue about making the compiler automatically choose the more fitting overload: #1256. It focuses on integer types but your case is actually something that would fit that too.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1397507915/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
