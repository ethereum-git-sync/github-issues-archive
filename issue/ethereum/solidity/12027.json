{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/12027",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/12027/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/12027/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/12027/events",
  "html_url": "https://github.com/ethereum/solidity/issues/12027",
  "id": 1007343331,
  "node_id": "I_kwDOAm_5kc48Ctbj",
  "number": 12027,
  "title": "Compile ASTJsonConverter.cpp failed to \"error C3861: 'iter_swap': identifier not found\" and \"error C2672: 'ranges::iter_swap': no matching overloaded function found\"",
  "user": {
    "login": "YangYang129",
    "id": 86757616,
    "node_id": "MDQ6VXNlcjg2NzU3NjE2",
    "avatar_url": "https://avatars.githubusercontent.com/u/86757616?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/YangYang129",
    "html_url": "https://github.com/YangYang129",
    "followers_url": "https://api.github.com/users/YangYang129/followers",
    "following_url": "https://api.github.com/users/YangYang129/following{/other_user}",
    "gists_url": "https://api.github.com/users/YangYang129/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/YangYang129/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/YangYang129/subscriptions",
    "organizations_url": "https://api.github.com/users/YangYang129/orgs",
    "repos_url": "https://api.github.com/users/YangYang129/repos",
    "events_url": "https://api.github.com/users/YangYang129/events{/privacy}",
    "received_events_url": "https://api.github.com/users/YangYang129/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 249074435,
      "node_id": "MDU6TGFiZWwyNDkwNzQ0MzU=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/bug%20:bug:",
      "name": "bug :bug:",
      "color": "fc1313",
      "default": false,
      "description": ""
    },
    {
      "id": 249074438,
      "node_id": "MDU6TGFiZWwyNDkwNzQ0Mzg=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/help%20wanted",
      "name": "help wanted",
      "color": "159818",
      "default": true,
      "description": null
    },
    {
      "id": 437863668,
      "node_id": "MDU6TGFiZWw0Mzc4NjM2Njg=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/build%20system%20:building_construction:",
      "name": "build system :building_construction:",
      "color": "1d76db",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-09-26T10:03:12Z",
  "updated_at": "2022-08-15T19:41:07Z",
  "closed_at": "2022-08-15T15:32:17Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Compile ASTJsonConverter.cpp failed to \"error C3861: 'iter_swap': identifier not found\" and \"error C2672: 'ranges::iter_swap': no matching overloaded function found\", can you help look? Thank you very much\r\n\r\n**Environment**\r\n- Compiler version: VS2019 (16.11.2)\r\n- Operating system: Windows server 2016\r\n\r\n**Reproduce steps:**\r\n1. git clone https://github.com/ethereum/solidity\r\n2. cd solidity\r\n3. mkdir build_amd64\r\n4. cd build_amd64\r\n5. cmake -G \"Visual Studio 16 2019\" -A x64 -DCMAKE_SYSTEM_VERSION=10.0.18362.0 -DBoost_INCLUDE_DIR=\"F:\\tools\\boost_1_67_0\\x64\" ..\r\n6. msbuild /p:Configuration=Release;Platform=x64 solidity.sln /t:Rebuild /m\r\n\r\n**Error log:**\r\n[msbuild_x64.log](https://github.com/ethereum/solidity/files/7231141/msbuild_x64.log)\r\n\r\n\r\n**Error info:**\r\n1. F:\\solidity\\build_mad64\\deps\\include\\range/v3/algorithm/sort.hpp(92,25): error C3861: 'iter_swap': identifier not found (compiling source file F:\\solidity\\libsolidity\\ast\\ASTJsonConverter.cpp) [F:\\solidity\\build_mad64\\libsolidity\\solidity.vcxproj]\r\n2. F:\\solidity\\build_mad64\\deps\\include\\range/v3/algorithm/sort.hpp(92,25): error C2672: 'ranges::iter_swap': no matching overloaded function found (compiling source file F:\\solidity\\libsolidity\\ast\\ASTJsonConverter.cpp) [F:\\solidity\\build_mad64\\libsolidity\\solidity.vcxproj]\r\n\r\n**Note:**\r\nThese errors is due to compile ASTJsonConverter.i (cl /EHsc /permissive- /std:c++20 /TP ASTJsonConverter.i) \r\n[ASTJsonConverter.i.zip](https://github.com/ethereum/solidity/files/7231159/ASTJsonConverter.i.zip)\r\n \r\n",
  "closed_by": {
    "login": "ekpyron",
    "id": 1347491,
    "node_id": "MDQ6VXNlcjEzNDc0OTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ekpyron",
    "html_url": "https://github.com/ekpyron",
    "followers_url": "https://api.github.com/users/ekpyron/followers",
    "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
    "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
    "organizations_url": "https://api.github.com/users/ekpyron/orgs",
    "repos_url": "https://api.github.com/users/ekpyron/repos",
    "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ekpyron/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/12027/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/12027/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/927379610",
    "html_url": "https://github.com/ethereum/solidity/issues/12027#issuecomment-927379610",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12027",
    "id": 927379610,
    "node_id": "IC_kwDOAm_5kc43RrCa",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-26T22:03:35Z",
    "updated_at": "2021-09-26T22:03:35Z",
    "author_association": "MEMBER",
    "body": "I think that the error is coming from `ranges::sort()` added in #11837 (we were using `boost::range::sort()` until then). The question is why.\r\n\r\nIt does not fail in our CI - [`b_win` job passed on that PR](https://app.circleci.com/pipelines/github/ethereum/solidity/18301/workflows/aae7c2d7-b365-4930-84b1-26bef9f1ac32/jobs/816098) with MSVC 16.11.0+0538acc04 and is still passing in newer PRs.\r\n\r\nAt first I wanted to suggest that it might be because you're mixing c++17 and c++20 but you don't have `/std:c++20` in your repro (only in the command to generate the .i file) so that can't be it.\r\n\r\nranges-v3 generally has [tons of workarounds for weird MSVC behaviors](https://github.com/ericniebler/range-v3/blob/0.11.0/include/range/v3/detail/config.hpp#L222-L277), including [one specifically for `iter_swap`](https://github.com/ericniebler/range-v3/blob/0.11.0/include/range/v3/iterator/access.hpp#L194-L196) and this might have something to do with them. Your compiler is slightly newer than the one we're using so you might be just running into something new that needs another workaround.\r\n\r\nTo debug this, we need someone with Windows env that can reproduce it, so it looks like a task for @christianparpart :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/927379610/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/927382105",
    "html_url": "https://github.com/ethereum/solidity/issues/12027#issuecomment-927382105",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12027",
    "id": 927382105,
    "node_id": "IC_kwDOAm_5kc43RrpZ",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-26T22:21:06Z",
    "updated_at": "2021-09-26T22:22:01Z",
    "author_association": "MEMBER",
    "body": "By the way, this is how we build it on Windows in CI: [`build_win.ps1`](https://github.com/ethereum/solidity/blob/develop/.circleci/build_win.ps1) (this gets executed by the [`b_win` job](https://github.com/ethereum/solidity/blob/develop/.circleci/config.yml#L880-L910)). The options are not identical to yours but I don't see anything that would be an obvious cause of the errors your getting. Still, if you could try to build it with options as close to ours as possible, we'd at least be able to exclude this as a cause.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/927382105/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/930878898",
    "html_url": "https://github.com/ethereum/solidity/issues/12027#issuecomment-930878898",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12027",
    "id": 930878898,
    "node_id": "IC_kwDOAm_5kc43fBWy",
    "user": {
      "login": "YangYang129",
      "id": 86757616,
      "node_id": "MDQ6VXNlcjg2NzU3NjE2",
      "avatar_url": "https://avatars.githubusercontent.com/u/86757616?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/YangYang129",
      "html_url": "https://github.com/YangYang129",
      "followers_url": "https://api.github.com/users/YangYang129/followers",
      "following_url": "https://api.github.com/users/YangYang129/following{/other_user}",
      "gists_url": "https://api.github.com/users/YangYang129/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/YangYang129/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/YangYang129/subscriptions",
      "organizations_url": "https://api.github.com/users/YangYang129/orgs",
      "repos_url": "https://api.github.com/users/YangYang129/repos",
      "events_url": "https://api.github.com/users/YangYang129/events{/privacy}",
      "received_events_url": "https://api.github.com/users/YangYang129/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-30T06:56:44Z",
    "updated_at": "2021-09-30T06:56:44Z",
    "author_association": "NONE",
    "body": "@cameel Thanks for your reply and info. According to [build_win.ps1](https://github.com/ethereum/solidity/blob/develop/.circleci/build_win.ps1) and [install_deps.ps1](https://github.com/ethereum/solidity/blob/develop/scripts/install_deps.ps1), I install cmake-3.18.2-win64-x64 and  and boost_1_74_0, then try to msbuild, still display these two errors. Please help me to look at this issue, thanks for advance.\r\n\r\n**Reproduce steps:**\r\n1. git clone https://github.com/ethereum/solidity\r\n2. cd solidity\r\n3. mkdir build_amd64\r\n4. cd build_amd64\r\n5. cmake ..\\deps\\cmakex64\\cmake-3.18.2-win64-x64\\bin\\cmake -G \"Visual Studio 16 2019\" -A x64 -DCMAKE_SYSTEM_VERSION=10.0.18362.0 -DBoost_DIR=\"F:\\solidity\\deps\\boost\\x64\\lib\\cmake\\Boost-1.74.0\" -DCMAKE_MSVC_RUNTIME_LIBRARY=MultiThreaded -DCMAKE_INSTALL_PREFIX=\"F:\\solidity\\upload\" ..\r\n6. msbuild /p:Configuration=Release;Platform=x64 solidity.sln /t:Rebuild /m\r\n\r\n**Error log:**\r\n[msbuild_x640930.log](https://github.com/ethereum/solidity/files/7257327/msbuild_x640930.log)\r\n\r\n**Note:** I do not install Z3\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/930878898/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/932529325",
    "html_url": "https://github.com/ethereum/solidity/issues/12027#issuecomment-932529325",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12027",
    "id": 932529325,
    "node_id": "IC_kwDOAm_5kc43lUSt",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-01T20:26:43Z",
    "updated_at": "2022-08-15T19:41:07Z",
    "author_association": "MEMBER",
    "body": "You actually need Boost 1.77 now, because of #12024/#11688 but looking at the log, that's what you used. In any case, it should not affect this.\r\n\r\nSo looks like it's not because of the differences in options. In that case I really can't help much more since I don't have an environment where I could reproduce this. @christianparpart, we need you here :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/932529325/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
