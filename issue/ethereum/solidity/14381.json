{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/14381",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/14381/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/14381/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/14381/events",
  "html_url": "https://github.com/ethereum/solidity/issues/14381",
  "id": 1788145893,
  "node_id": "I_kwDOAm_5kc5qlPDl",
  "number": 14381,
  "title": "Infinite loop in view functions",
  "user": {
    "login": "ZigBalthazar",
    "id": 42387185,
    "node_id": "MDQ6VXNlcjQyMzg3MTg1",
    "avatar_url": "https://avatars.githubusercontent.com/u/42387185?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ZigBalthazar",
    "html_url": "https://github.com/ZigBalthazar",
    "followers_url": "https://api.github.com/users/ZigBalthazar/followers",
    "following_url": "https://api.github.com/users/ZigBalthazar/following{/other_user}",
    "gists_url": "https://api.github.com/users/ZigBalthazar/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ZigBalthazar/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ZigBalthazar/subscriptions",
    "organizations_url": "https://api.github.com/users/ZigBalthazar/orgs",
    "repos_url": "https://api.github.com/users/ZigBalthazar/repos",
    "events_url": "https://api.github.com/users/ZigBalthazar/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ZigBalthazar/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 249074435,
      "node_id": "MDU6TGFiZWwyNDkwNzQ0MzU=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/bug%20:bug:",
      "name": "bug :bug:",
      "color": "fc1313",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2023-07-04T15:34:00Z",
  "updated_at": "2023-12-06T11:30:06Z",
  "closed_at": "2023-12-06T11:12:01Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "\r\n## Description\r\n\r\nIn Solidity View functions, by creating a loop, the code can be forced to repeat that loop many times, and this process creates free processing pressure for EVM.\r\n\r\n## Environment\r\n\r\n- Framework/IDE (e.g. Truffle or Remix): Remix / HardHat\r\n- EVM execution environment / backend / blockchain client: blockchain \r\n\r\n## Steps to Reproduce\r\n\r\n```solidity\r\npragma solidity ^0.8.0;\r\n\r\ncontract MyContract {\r\n    uint[] myArray;\r\n\r\n    function getMyArray() public view returns (uint[] memory) {\r\n        uint[] memory result = new uint[](myArray.length);\r\n        for (uint i = 0; i < myArray.length; i++) {\r\n            result[i] = myArray[i];\r\n        }\r\n        return result;\r\n    }\r\n}\r\n```\r\n",
  "closed_by": {
    "login": "nikola-matic",
    "id": 4415530,
    "node_id": "MDQ6VXNlcjQ0MTU1MzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4415530?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nikola-matic",
    "html_url": "https://github.com/nikola-matic",
    "followers_url": "https://api.github.com/users/nikola-matic/followers",
    "following_url": "https://api.github.com/users/nikola-matic/following{/other_user}",
    "gists_url": "https://api.github.com/users/nikola-matic/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nikola-matic/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nikola-matic/subscriptions",
    "organizations_url": "https://api.github.com/users/nikola-matic/orgs",
    "repos_url": "https://api.github.com/users/nikola-matic/repos",
    "events_url": "https://api.github.com/users/nikola-matic/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nikola-matic/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/14381/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/14381/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1622077731",
    "html_url": "https://github.com/ethereum/solidity/issues/14381#issuecomment-1622077731",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14381",
    "id": 1622077731,
    "node_id": "IC_kwDOAm_5kc5grvEj",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-05T16:13:04Z",
    "updated_at": "2023-07-05T16:13:04Z",
    "author_association": "MEMBER",
    "body": "I can't reproduce it. I just tried your code on 0.8.20 in Remix and it properly exits and returns an empty array.\r\n\r\nCan you provide more details? Which version are you using? Are you using the legacy pipeline or via IR? What exactly are you seeing and what are you expecting?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1622077731/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1627765975",
    "html_url": "https://github.com/ethereum/solidity/issues/14381#issuecomment-1627765975",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14381",
    "id": 1627765975,
    "node_id": "IC_kwDOAm_5kc5hBbzX",
    "user": {
      "login": "Sachin737",
      "id": 89219332,
      "node_id": "MDQ6VXNlcjg5MjE5MzMy",
      "avatar_url": "https://avatars.githubusercontent.com/u/89219332?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sachin737",
      "html_url": "https://github.com/Sachin737",
      "followers_url": "https://api.github.com/users/Sachin737/followers",
      "following_url": "https://api.github.com/users/Sachin737/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sachin737/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sachin737/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sachin737/subscriptions",
      "organizations_url": "https://api.github.com/users/Sachin737/orgs",
      "repos_url": "https://api.github.com/users/Sachin737/repos",
      "events_url": "https://api.github.com/users/Sachin737/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sachin737/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-09T16:31:22Z",
    "updated_at": "2023-07-09T16:31:22Z",
    "author_association": "NONE",
    "body": "It's working fine. can you please elaborate on the issue?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1627765975/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1647612822",
    "html_url": "https://github.com/ethereum/solidity/issues/14381#issuecomment-1647612822",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14381",
    "id": 1647612822,
    "node_id": "IC_kwDOAm_5kc5iNJOW",
    "user": {
      "login": "ZigBalthazar",
      "id": 42387185,
      "node_id": "MDQ6VXNlcjQyMzg3MTg1",
      "avatar_url": "https://avatars.githubusercontent.com/u/42387185?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ZigBalthazar",
      "html_url": "https://github.com/ZigBalthazar",
      "followers_url": "https://api.github.com/users/ZigBalthazar/followers",
      "following_url": "https://api.github.com/users/ZigBalthazar/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZigBalthazar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ZigBalthazar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZigBalthazar/subscriptions",
      "organizations_url": "https://api.github.com/users/ZigBalthazar/orgs",
      "repos_url": "https://api.github.com/users/ZigBalthazar/repos",
      "events_url": "https://api.github.com/users/ZigBalthazar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ZigBalthazar/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-24T10:08:40Z",
    "updated_at": "2023-07-24T10:08:40Z",
    "author_association": "NONE",
    "body": "Hi @Sachin737 , @cameel \r\n\r\nWrite another function to push many items to the array in the above code(try to push a few hundred items to the array, for example)\r\n\r\nThen, using the `getMyArray ` function, you can read all the items by creating a loop\r\n\r\nNow, instead of a few hundred items, for example, several thousand items are in the array. In that case, does reading this information using `for` in a function with the `View` property not have high computational pressure?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1647612822/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1737031064",
    "html_url": "https://github.com/ethereum/solidity/issues/14381#issuecomment-1737031064",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14381",
    "id": 1737031064,
    "node_id": "IC_kwDOAm_5kc5niP2Y",
    "user": {
      "login": "Derixtar54",
      "id": 86204779,
      "node_id": "MDQ6VXNlcjg2MjA0Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/86204779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Derixtar54",
      "html_url": "https://github.com/Derixtar54",
      "followers_url": "https://api.github.com/users/Derixtar54/followers",
      "following_url": "https://api.github.com/users/Derixtar54/following{/other_user}",
      "gists_url": "https://api.github.com/users/Derixtar54/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Derixtar54/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Derixtar54/subscriptions",
      "organizations_url": "https://api.github.com/users/Derixtar54/orgs",
      "repos_url": "https://api.github.com/users/Derixtar54/repos",
      "events_url": "https://api.github.com/users/Derixtar54/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Derixtar54/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-27T09:22:35Z",
    "updated_at": "2023-09-27T09:22:35Z",
    "author_association": "NONE",
    "body": "Hi @ZigBalthazar \r\nI  think i have understood your  problem correctly , correct me if I am wrong\r\nIf you want to push a large number of items to the array and then read all of them using the getMyArray function, you may indeed encounter high computational pressure if the array becomes very large. Solidity view functions are executed locally on each node, and their execution time depends on the complexity of the code. Reading a large array in a view function using a loop can lead to higher gas consumption and longer execution times, which can be problematic if the array contains thousands of items.\r\n\r\nHere's an example of how you can push items to the array and then read them using the getMyArray function:\r\npragma solidity ^0.8.0;\r\n\r\ncontract MyContract {\r\n    uint[] myArray;\r\n\r\n    function pushToMyArray(uint[] memory values) public {\r\n        for (uint i = 0; i < values.length; i++) {\r\n            myArray.push(values[i]);\r\n        }\r\n    }\r\n\r\n    function getMyArray() public view returns (uint[] memory) {\r\n        uint[] memory result = new uint[](myArray.length);\r\n        for (uint i = 0; i < myArray.length; i++) {\r\n            result[i] = myArray[i];\r\n        }\r\n        return result;\r\n    }\r\n}\r\nIn this example, the pushToMyArray function allows you to push an array of values into myArray. The getMyArray function reads the entire array using a loop.\r\n\r\nAs the size of myArray grows, the gas cost and execution time of the getMyArray function will increase. If myArray contains several thousand items, reading it in a view function could become computationally expensive and may exceed gas limits.\r\n\r\nTo handle large datasets more efficiently, you might consider using pagination or off-chain processing techniques. Additionally, keep in mind that Ethereum 2.0 and other scaling solutions aim to improve the scalability of the Ethereum network, which can help mitigate some of these issues in the future.\r\nplease reply asap\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1737031064/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1842663700",
    "html_url": "https://github.com/ethereum/solidity/issues/14381#issuecomment-1842663700",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14381",
    "id": 1842663700,
    "node_id": "IC_kwDOAm_5kc5t1NEU",
    "user": {
      "login": "nikola-matic",
      "id": 4415530,
      "node_id": "MDQ6VXNlcjQ0MTU1MzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4415530?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikola-matic",
      "html_url": "https://github.com/nikola-matic",
      "followers_url": "https://api.github.com/users/nikola-matic/followers",
      "following_url": "https://api.github.com/users/nikola-matic/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikola-matic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikola-matic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikola-matic/subscriptions",
      "organizations_url": "https://api.github.com/users/nikola-matic/orgs",
      "repos_url": "https://api.github.com/users/nikola-matic/repos",
      "events_url": "https://api.github.com/users/nikola-matic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikola-matic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-12-06T11:12:01Z",
    "updated_at": "2023-12-06T11:12:01Z",
    "author_association": "MEMBER",
    "body": "Closing this, as it's not really a compiler bug per-se, rather an EVM limitation.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1842663700/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1842689458",
    "html_url": "https://github.com/ethereum/solidity/issues/14381#issuecomment-1842689458",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14381",
    "id": 1842689458,
    "node_id": "IC_kwDOAm_5kc5t1TWy",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-12-06T11:30:04Z",
    "updated_at": "2023-12-06T11:30:04Z",
    "author_association": "MEMBER",
    "body": "Exactly. If you loop over unbounded arrays you may easily run out of gas. That's common knowledge. The limitation is just that the EVM environment is very resource constrained and this will happen even for moderately sized ones. That's why there are patterns like \"pull over push\" that you use instead.\r\n\r\nThe compiler also tries to avoid forcing a loop in such cases to some extent - note for example that if you create a getter for an array, it will return items one by one, and not the whole array. But this is not without downsides and compiler can't force that in every place where arrays are used. Dealing with it requires assumptions about what is being built. Ultimately it's up to the programmer in most cases to design their contract in such a way that it avoids running into this kind of problem.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1842689458/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
