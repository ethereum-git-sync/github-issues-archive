{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/12518",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/12518/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/12518/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/12518/events",
  "html_url": "https://github.com/ethereum/solidity/issues/12518",
  "id": 1100242716,
  "node_id": "I_kwDOAm_5kc5BlF8c",
  "number": 12518,
  "title": "Wrong stack construction.",
  "user": {
    "login": "freaker2k7",
    "id": 5237609,
    "node_id": "MDQ6VXNlcjUyMzc2MDk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5237609?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/freaker2k7",
    "html_url": "https://github.com/freaker2k7",
    "followers_url": "https://api.github.com/users/freaker2k7/followers",
    "following_url": "https://api.github.com/users/freaker2k7/following{/other_user}",
    "gists_url": "https://api.github.com/users/freaker2k7/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/freaker2k7/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/freaker2k7/subscriptions",
    "organizations_url": "https://api.github.com/users/freaker2k7/orgs",
    "repos_url": "https://api.github.com/users/freaker2k7/repos",
    "events_url": "https://api.github.com/users/freaker2k7/events{/privacy}",
    "received_events_url": "https://api.github.com/users/freaker2k7/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-01-12T11:43:48Z",
  "updated_at": "2022-01-13T12:09:01Z",
  "closed_at": "2022-01-13T12:09:01Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nThe stack is built wrong!!!\r\n\r\nDear Vitali,\r\n\r\nYou mate the stack enter a function before checking/parsing the arguments.\r\n\r\n## Environment\r\n\r\n- Compiler version: 0.8.11\r\n- Target EVM version (as per compiler settings): 0.8.11\r\n- Framework/IDE (e.g. Truffle or Remix): Remix\r\n- EVM execution environment / backend / blockchain client: blockchain\r\n- Operating system: MacOS\r\n\r\n## Steps to Reproduce\r\n\r\n\r\nI have the following code in my contract:\r\n\r\n```\r\n\tfunction slot(address user, address[] memory _helpers, address affiliate, string[] memory chains) external {\r\n\t\tuint8 plan = USERS.getUserPlan(user);\r\n\t\tUSERS.setUser(WPEG, ROUTERS, dev, _helpers, CA, affiliate, user, CHAIN_STR, address(0), chains, plan, block.timestamp);\r\n\t}\r\n```\r\n\r\nNow this works while the following throughs me a \"stack to deep\":\r\n\r\n```\r\n\tfunction slot(address user, address[] memory _helpers, address affiliate, string[] memory chains) external {\r\n\t\tUSERS.setUser(WPEG, ROUTERS, dev, _helpers, CA, affiliate, user, CHAIN_STR, address(0), chains, USERS.getUserPlan(user), block.timestamp);\r\n\t}\r\n```\r\n\r\nWhich means you parse from the inside out. That's a vital mistake!\r\n",
  "closed_by": {
    "login": "ekpyron",
    "id": 1347491,
    "node_id": "MDQ6VXNlcjEzNDc0OTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ekpyron",
    "html_url": "https://github.com/ekpyron",
    "followers_url": "https://api.github.com/users/ekpyron/followers",
    "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
    "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
    "organizations_url": "https://api.github.com/users/ekpyron/orgs",
    "repos_url": "https://api.github.com/users/ekpyron/repos",
    "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ekpyron/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/12518/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/12518/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1012078259",
    "html_url": "https://github.com/ethereum/solidity/issues/12518#issuecomment-1012078259",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12518",
    "id": 1012078259,
    "node_id": "IC_kwDOAm_5kc48Uxaz",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-13T12:09:01Z",
    "updated_at": "2022-01-13T12:09:01Z",
    "author_association": "MEMBER",
    "body": "The stack construction is not \"wrong\" per se, it just works as it does by convention and any convention will cause issues in some particular cases. The underlying issue is that the EVM only allows access to 16 stack slots, which we can only try to circumvent on the language level.\r\nIn general, \"stack too deep\" errors are known issues and we are working on mitigating them as far as possible.\r\nYou can try using the latest version of the compiler and compile using the experimental \"via-ir\" pipeline and enable the optimizer (i.e. ``--experimental-via-ir --optimize``) - we expect fewer stack-too-deep errors to occur in that compiler mode.\r\n\r\nSince the general issue of stack too deep errors is tracked elsewhere (https://github.com/ethereum/solidity/issues?q=is%3Aissue+is%3Aopen+stack+too+deep+), I'm closing this.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1012078259/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
