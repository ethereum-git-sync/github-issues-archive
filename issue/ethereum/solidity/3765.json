{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/3765",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/3765/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/3765/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/3765/events",
  "html_url": "https://github.com/ethereum/solidity/issues/3765",
  "id": 306803073,
  "node_id": "MDU6SXNzdWUzMDY4MDMwNzM=",
  "number": 3765,
  "title": "Unused code generated when creating arrays in memory",
  "user": {
    "login": "winterkasten",
    "id": 8171794,
    "node_id": "MDQ6VXNlcjgxNzE3OTQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8171794?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/winterkasten",
    "html_url": "https://github.com/winterkasten",
    "followers_url": "https://api.github.com/users/winterkasten/followers",
    "following_url": "https://api.github.com/users/winterkasten/following{/other_user}",
    "gists_url": "https://api.github.com/users/winterkasten/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/winterkasten/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/winterkasten/subscriptions",
    "organizations_url": "https://api.github.com/users/winterkasten/orgs",
    "repos_url": "https://api.github.com/users/winterkasten/repos",
    "events_url": "https://api.github.com/users/winterkasten/events{/privacy}",
    "received_events_url": "https://api.github.com/users/winterkasten/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1282209978,
      "node_id": "MDU6TGFiZWwxMjgyMjA5OTc4",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/optimizer",
      "name": "optimizer",
      "color": "d4c5f9",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2018-03-20T10:17:36Z",
  "updated_at": "2020-10-30T20:59:47Z",
  "closed_at": "2020-10-30T20:59:46Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Im currently running version 0.4.21 of solc on my linux platform. When compilig this code \r\n```solidity\r\npragma solidity ^0.4.0;\r\n\r\ncontract ArrayAccessV1 {\r\n    uint x;\r\n\r\n    function setStorageItem() external {\r\n        uint[3] memory a = [uint(1),2,3];\r\n        x = a[1];\r\n    }\r\n}\r\n```\r\nwith optimization to evm assembly language, I recognized some instructions, which seems to me as unused. At the end of the assembly file there are two jump addresses:\r\n```\r\ntag_7:\r\n      0x60\r\n      mload(0x40)\r\n      swap1\r\n      dup2\r\n      add\r\n      0x40 \r\n      mstore\r\n      0x3\r\n      dup2\r\ntag_10:\r\n      0x0\r\n      dup2\r\n      mstore\r\n      0x20\r\n      add\r\n      swap1\r\n      0x1\r\n      swap1\r\n      sub\r\n      swap1\r\n      dup2\r\n      tag_10\r\n      jumpi\r\n      swap1\r\n      pop\r\n      pop\r\n      swap1\r\n      jump\t// out\r\n```\r\nwhich are never jumped to during execution. These adresses are never placed on the stack for jumping. The only appearance of tag_7 beside this is in a commentary:\r\n```\r\ntag_5:\r\n        /* \"ArrayAccessV1.sol\":112:128  uint[3] memory a */\r\n      tag_6\r\n      jump\t// in(tag_7)\r\n```\r\nThe instruction before tag_7 perform a unconditional jump to the stop instruction. So I think these basic blocks are unused and can be removed from the assembly. Or am I missing something?",
  "closed_by": {
    "login": "axic",
    "id": 20340,
    "node_id": "MDQ6VXNlcjIwMzQw",
    "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/axic",
    "html_url": "https://github.com/axic",
    "followers_url": "https://api.github.com/users/axic/followers",
    "following_url": "https://api.github.com/users/axic/following{/other_user}",
    "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
    "organizations_url": "https://api.github.com/users/axic/orgs",
    "repos_url": "https://api.github.com/users/axic/repos",
    "events_url": "https://api.github.com/users/axic/events{/privacy}",
    "received_events_url": "https://api.github.com/users/axic/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/3765/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/3765/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/374597861",
    "html_url": "https://github.com/ethereum/solidity/issues/3765#issuecomment-374597861",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3765",
    "id": 374597861,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NDU5Nzg2MQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-20T13:30:20Z",
    "updated_at": "2018-03-20T13:30:20Z",
    "author_association": "MEMBER",
    "body": "We disabled the unused code remover some time ago because removing blocks that start with tags that are not referenced can lead to invalid code. There are two situations where this can happen:\r\n\r\n1. inline assembly that uses things like `jump(x)` where `x` is a variable\r\n2. internal function identifiers stored in storage, especially when used inside the constructor\r\n\r\nThe first situation can only happen in deprecated code and we should certainly revisit the second one.\r\n\r\nI created an issue for that: https://github.com/ethereum/solidity/issues/3766",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/374597861/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/374606429",
    "html_url": "https://github.com/ethereum/solidity/issues/3765#issuecomment-374606429",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3765",
    "id": 374606429,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NDYwNjQyOQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-20T13:55:44Z",
    "updated_at": "2018-03-20T13:55:44Z",
    "author_association": "MEMBER",
    "body": "On the other hand, the code should of course not be generated in the first place.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/374606429/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/719796691",
    "html_url": "https://github.com/ethereum/solidity/issues/3765#issuecomment-719796691",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3765",
    "id": 719796691,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxOTc5NjY5MQ==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-30T20:59:46Z",
    "updated_at": "2020-10-30T20:59:46Z",
    "author_association": "MEMBER",
    "body": "Also unused jumpdests are removed since #2657. Closing this since #3766 covers the problem.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/719796691/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
