{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/6581",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/6581/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/6581/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/6581/events",
  "html_url": "https://github.com/ethereum/solidity/issues/6581",
  "id": 436649254,
  "node_id": "MDU6SXNzdWU0MzY2NDkyNTQ=",
  "number": 6581,
  "title": "Don't restrict use of callvalue in assembly",
  "user": {
    "login": "rainbreak",
    "id": 18486361,
    "node_id": "MDQ6VXNlcjE4NDg2MzYx",
    "avatar_url": "https://avatars.githubusercontent.com/u/18486361?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rainbreak",
    "html_url": "https://github.com/rainbreak",
    "followers_url": "https://api.github.com/users/rainbreak/followers",
    "following_url": "https://api.github.com/users/rainbreak/following{/other_user}",
    "gists_url": "https://api.github.com/users/rainbreak/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rainbreak/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rainbreak/subscriptions",
    "organizations_url": "https://api.github.com/users/rainbreak/orgs",
    "repos_url": "https://api.github.com/users/rainbreak/repos",
    "events_url": "https://api.github.com/users/rainbreak/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rainbreak/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 785717317,
      "node_id": "MDU6TGFiZWw3ODU3MTczMTc=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/language%20design%20:rage4:",
      "name": "language design :rage4:",
      "color": "9d76d3",
      "default": false,
      "description": "Any changes to the language, e.g. new features"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2019-04-24T11:43:54Z",
  "updated_at": "2019-05-23T10:07:07Z",
  "closed_at": "2019-05-23T10:07:07Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "From the 0.5.7 changelog:\r\n\r\n> Inline Assembly: Issue error when using callvalue() inside nonpayable function (in the same way that msg.value already does).\r\n\r\nThis is a fairly annoying change for libraries that use `callvalue` in a general setting as they now have to specialise into payable and non-payable forms.\r\n\r\nThe restriction on use of `msg.value` was perhaps reasonable, but restricting specific opcodes in inline-assembly is overly restrictive.",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/6581/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/6581/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486188923",
    "html_url": "https://github.com/ethereum/solidity/issues/6581#issuecomment-486188923",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6581",
    "id": 486188923,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NjE4ODkyMw==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-24T11:46:09Z",
    "updated_at": "2019-04-24T11:46:09Z",
    "author_association": "MEMBER",
    "body": "I tend to agree here, also not checking `callvalue` does not \"hurt\" too much.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/486188923/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/490485908",
    "html_url": "https://github.com/ethereum/solidity/issues/6581#issuecomment-490485908",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6581",
    "id": 490485908,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5MDQ4NTkwOA==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-08T13:29:33Z",
    "updated_at": "2019-05-08T13:29:33Z",
    "author_association": "MEMBER",
    "body": "I think there are two cases here:\r\n1) checking call value in an externally visible function\r\n2) checking call value in an internal helper\r\n\r\nIn case 1) it is probably not what you want to do, because the function guarantees (when externally executed) to always have a call value equal to 0.\r\n\r\nIn case 2) it may be a helper (including a modifier) where it may be useful. Perhaps we should allow this for case 2) -- in internally visible functions and modifiers.\r\n\r\nAs noted by @chriseth on the weekly meeting, this feature is about warning the user about doing something unintended. It would also be a good option to only issue warning for call values, but a long standing debate is that if warnings are issued there must be a way to disable them and we do not have a way to disable warnings.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/490485908/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/490488854",
    "html_url": "https://github.com/ethereum/solidity/issues/6581#issuecomment-490488854",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6581",
    "id": 490488854,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5MDQ4ODg1NA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-08T13:38:08Z",
    "updated_at": "2019-05-08T13:38:08Z",
    "author_association": "MEMBER",
    "body": "If we move the check to \"external function only\" - does it also apply to public functions? We could do that and mention in the message to create an internal version of the function that is called by the public (or then external) one.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/490488854/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/490520454",
    "html_url": "https://github.com/ethereum/solidity/issues/6581#issuecomment-490520454",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6581",
    "id": 490520454,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5MDUyMDQ1NA==",
    "user": {
      "login": "rainbreak",
      "id": 18486361,
      "node_id": "MDQ6VXNlcjE4NDg2MzYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/18486361?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rainbreak",
      "html_url": "https://github.com/rainbreak",
      "followers_url": "https://api.github.com/users/rainbreak/followers",
      "following_url": "https://api.github.com/users/rainbreak/following{/other_user}",
      "gists_url": "https://api.github.com/users/rainbreak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rainbreak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rainbreak/subscriptions",
      "organizations_url": "https://api.github.com/users/rainbreak/orgs",
      "repos_url": "https://api.github.com/users/rainbreak/repos",
      "events_url": "https://api.github.com/users/rainbreak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rainbreak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-08T14:56:55Z",
    "updated_at": "2019-05-08T14:56:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "@axic a warning would be ok, although it is still fairly annoying being warned about assembly blocks and a way to disable assembly related warnings would be great. The problem currently here is that it is an error.\r\n\r\nI'm not sure I see a simple way to split cases 1 and 2, without introducing some restrictions on the use of assembly `callvalue`.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/490520454/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/490760497",
    "html_url": "https://github.com/ethereum/solidity/issues/6581#issuecomment-490760497",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6581",
    "id": 490760497,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5MDc2MDQ5Nw==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-09T06:24:18Z",
    "updated_at": "2019-05-09T06:24:18Z",
    "author_association": "MEMBER",
    "body": "@rainbreak I agree that a warning is not much better than an error. I didn't quite understand the second part of your message - would it solve your problem if we only issue an error in assembly blocks in external functions (and not in modifiers)?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/490760497/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/490879807",
    "html_url": "https://github.com/ethereum/solidity/issues/6581#issuecomment-490879807",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6581",
    "id": 490879807,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5MDg3OTgwNw==",
    "user": {
      "login": "rainbreak",
      "id": 18486361,
      "node_id": "MDQ6VXNlcjE4NDg2MzYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/18486361?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rainbreak",
      "html_url": "https://github.com/rainbreak",
      "followers_url": "https://api.github.com/users/rainbreak/followers",
      "following_url": "https://api.github.com/users/rainbreak/following{/other_user}",
      "gists_url": "https://api.github.com/users/rainbreak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rainbreak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rainbreak/subscriptions",
      "organizations_url": "https://api.github.com/users/rainbreak/orgs",
      "repos_url": "https://api.github.com/users/rainbreak/repos",
      "events_url": "https://api.github.com/users/rainbreak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rainbreak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-09T12:19:35Z",
    "updated_at": "2019-05-09T12:19:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "@chriseth my problem would be solved if use of `callvalue` in assembly was possible in all cases. I think that `payable` / `nonpayable` should be enforced at run-time, not compile-time.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/490879807/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
