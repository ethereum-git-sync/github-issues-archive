{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/14380",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/14380/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/14380/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/14380/events",
  "html_url": "https://github.com/ethereum/solidity/issues/14380",
  "id": 1787864288,
  "node_id": "I_kwDOAm_5kc5qkKTg",
  "number": 14380,
  "title": "can't compile code when using a combination of pure math",
  "user": {
    "login": "0x0OZ",
    "id": 52073989,
    "node_id": "MDQ6VXNlcjUyMDczOTg5",
    "avatar_url": "https://avatars.githubusercontent.com/u/52073989?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/0x0OZ",
    "html_url": "https://github.com/0x0OZ",
    "followers_url": "https://api.github.com/users/0x0OZ/followers",
    "following_url": "https://api.github.com/users/0x0OZ/following{/other_user}",
    "gists_url": "https://api.github.com/users/0x0OZ/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/0x0OZ/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/0x0OZ/subscriptions",
    "organizations_url": "https://api.github.com/users/0x0OZ/orgs",
    "repos_url": "https://api.github.com/users/0x0OZ/repos",
    "events_url": "https://api.github.com/users/0x0OZ/events{/privacy}",
    "received_events_url": "https://api.github.com/users/0x0OZ/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 249074435,
      "node_id": "MDU6TGFiZWwyNDkwNzQ0MzU=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/bug%20:bug:",
      "name": "bug :bug:",
      "color": "fc1313",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-07-04T12:45:21Z",
  "updated_at": "2023-07-04T20:48:28Z",
  "closed_at": "2023-07-04T20:48:28Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!--## Prerequisites\r\n*Delete the above section and the instructions in the sections below before submitting*\r\n-->\r\n\r\n## Description\r\nwhen doing pure math multiplication, division, and subtraction, the compilers give some weird error. However, when doing the same math instead of using constant numbers and variables containing the values, it didn't result in errors and gave weird results.\r\n\r\n## Environment\r\n- Compiler version: 0.8.20\r\n- Target EVM version (as per compiler settings): defaults\r\n- Framework/IDE (e.g. Truffle or Remix): Foundry, Remix, and a solidity-shell tool (it' compiler issue)\r\n- EVM execution environment / backend / blockchain client:\r\n- Operating system:\r\nManjaro Linux, Kernel: 6.1.31-2-MANJARO\r\n## Steps to Reproduce\r\n\r\n\r\n\r\n```solidity\r\n// SPDX-License-Identifier: GPL-3.0\r\npragma solidity 0.8.20;\r\ncontract Monate{\r\n    // will compile\r\n    function pureMath() public pure returns(uint x){\r\n        uint y = 1 ether;\r\n        x = uint((y * y)/(10 ether-1000));\r\n        x = uint((1 ether * 1 ether)/(10 ether));\r\n        x = uint((1 * 1)/(1));\r\n    }\r\n\r\n    // will not compile\r\n    function math() public pure returns(uint x){\r\n        //Each of the following lines will cause an error\r\n        x = uint((1 ether * 1 ether)/(10 ether-1000));\r\n        x = uint((1 * 1)/(1-1000));\r\n        x = uint((1 * 1)/(1 ether));\r\n        x = uint((1 * 1)/(1 + 1));\r\n    }\r\n}\r\n```\r\n\r\n",
  "closed_by": {
    "login": "0x0OZ",
    "id": 52073989,
    "node_id": "MDQ6VXNlcjUyMDczOTg5",
    "avatar_url": "https://avatars.githubusercontent.com/u/52073989?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/0x0OZ",
    "html_url": "https://github.com/0x0OZ",
    "followers_url": "https://api.github.com/users/0x0OZ/followers",
    "following_url": "https://api.github.com/users/0x0OZ/following{/other_user}",
    "gists_url": "https://api.github.com/users/0x0OZ/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/0x0OZ/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/0x0OZ/subscriptions",
    "organizations_url": "https://api.github.com/users/0x0OZ/orgs",
    "repos_url": "https://api.github.com/users/0x0OZ/repos",
    "events_url": "https://api.github.com/users/0x0OZ/events{/privacy}",
    "received_events_url": "https://api.github.com/users/0x0OZ/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/14380/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/14380/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1620729699",
    "html_url": "https://github.com/ethereum/solidity/issues/14380#issuecomment-1620729699",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14380",
    "id": 1620729699,
    "node_id": "IC_kwDOAm_5kc5gml9j",
    "user": {
      "login": "0x0OZ",
      "id": 52073989,
      "node_id": "MDQ6VXNlcjUyMDczOTg5",
      "avatar_url": "https://avatars.githubusercontent.com/u/52073989?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/0x0OZ",
      "html_url": "https://github.com/0x0OZ",
      "followers_url": "https://api.github.com/users/0x0OZ/followers",
      "following_url": "https://api.github.com/users/0x0OZ/following{/other_user}",
      "gists_url": "https://api.github.com/users/0x0OZ/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/0x0OZ/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0x0OZ/subscriptions",
      "organizations_url": "https://api.github.com/users/0x0OZ/orgs",
      "repos_url": "https://api.github.com/users/0x0OZ/repos",
      "events_url": "https://api.github.com/users/0x0OZ/events{/privacy}",
      "received_events_url": "https://api.github.com/users/0x0OZ/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-04T20:48:27Z",
    "updated_at": "2023-07-04T20:48:27Z",
    "author_association": "NONE",
    "body": "I figured it's not a bug but how the compiler act, Friends from CryptoDevs explained it well:\r\n\r\n> caweren: My guess is the compiler wants to optimize it and tries to convert it to ufixed<256>x<59> on the fly, since it's a constant calculation. While your x = y * y / (1-ether) will make an integer division.\r\n\r\n> dev_doggo:  It's because the ones that error result in a fraction instead of a whole number\r\nIf you use x = uint(1 * 1)/(1 + 1); it will work (as it will with x = uint256(1)/2 and it will fail with x = 1/2)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1620729699/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
