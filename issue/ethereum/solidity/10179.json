{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/10179",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/10179/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/10179/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/10179/events",
  "html_url": "https://github.com/ethereum/solidity/issues/10179",
  "id": 734610969,
  "node_id": "MDU6SXNzdWU3MzQ2MTA5Njk=",
  "number": 10179,
  "title": "[yul] Support special/priority objects in object format",
  "user": {
    "login": "axic",
    "id": 20340,
    "node_id": "MDQ6VXNlcjIwMzQw",
    "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/axic",
    "html_url": "https://github.com/axic",
    "followers_url": "https://api.github.com/users/axic/followers",
    "following_url": "https://api.github.com/users/axic/following{/other_user}",
    "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
    "organizations_url": "https://api.github.com/users/axic/orgs",
    "repos_url": "https://api.github.com/users/axic/repos",
    "events_url": "https://api.github.com/users/axic/events{/privacy}",
    "received_events_url": "https://api.github.com/users/axic/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2020-11-02T15:43:58Z",
  "updated_at": "2021-06-21T16:35:21Z",
  "closed_at": "2021-06-21T16:35:21Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "The \"contract metadata\" is expected to be the trailing bytes in the bytecode.\r\n\r\nWhile the Yul object format allows for code and data sections, there is no clarity whether those sections must be laid out the same order in the binary as they were defined in the text format, and in fact, the implementation considers the objects in a hashmap so their order depends on their names.\r\n\r\nIn order to support metadata (at least in the EVM output), we have a couple of options:\r\na) Introduce defined ordering\r\nb) Consider a special field as the last (such as `metadata` or `contractMetadata`)\r\nc) Introduce a new field for metadata in the object format\r\nd) Introduce a special call in the implementation to set the metadata (outside of the object format)\r\n\r\nAnd perhaps other options.\r\n\r\nPart of #10152.",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/10179/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/10179/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/722354138",
    "html_url": "https://github.com/ethereum/solidity/issues/10179#issuecomment-722354138",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/10179",
    "id": 722354138,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyMjM1NDEzOA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-05T12:42:43Z",
    "updated_at": "2020-11-05T12:42:43Z",
    "author_association": "MEMBER",
    "body": "subObjects is actually a vector, so the order is retained. Unless the assembler re-arranges them, defining the metadata to be last should \"just work\".",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/722354138/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/722355926",
    "html_url": "https://github.com/ethereum/solidity/issues/10179#issuecomment-722355926",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/10179",
    "id": 722355926,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyMjM1NTkyNg==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-05T12:46:26Z",
    "updated_at": "2020-11-05T12:46:26Z",
    "author_association": "MEMBER",
    "body": "You're right it is a vector in the AST, but the assemblers may do their own thing. However under \"Introduce defined ordering\" I also mean to explicitly state that for the text representation of Yul so that an IR file can be compiled correctly.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/722355926/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/758675582",
    "html_url": "https://github.com/ethereum/solidity/issues/10179#issuecomment-758675582",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/10179",
    "id": 758675582,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1ODY3NTU4Mg==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-12T14:04:29Z",
    "updated_at": "2021-01-12T14:04:29Z",
    "author_association": "MEMBER",
    "body": "@ekpyron any opinion on this one?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/758675582/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/758680299",
    "html_url": "https://github.com/ethereum/solidity/issues/10179#issuecomment-758680299",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/10179",
    "id": 758680299,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1ODY4MDI5OQ==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-12T14:12:31Z",
    "updated_at": "2021-01-12T14:12:31Z",
    "author_association": "MEMBER",
    "body": "I'd not give the order in the sources a special meaning - I'd consider the yul object files like a generic object file format like an ELF object that just defines some section - what we're doing when compiling to bytecode is basically creating something like an old ``COM`` binary, which does have a fixed internal layout, but I'd say making sure that's the way it's supposed to is the job of the assembler/linker in the end. We should have the compiler output the layout of yul objects in the bytecode, though, if requested.\r\n\r\nIn general I don't think the metadata should be defined as data parts in the yul objects at all. Similarly to the \"section order\" thing, I'd say this is something specific to the EVM bytecode format that's independent of Yul and job of the linker only.\r\n\r\nBut I only thought about it for 5 minutes, so don't put too much weight on what I just said :-).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/758680299/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/762837335",
    "html_url": "https://github.com/ethereum/solidity/issues/10179#issuecomment-762837335",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/10179",
    "id": 762837335,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MjgzNzMzNQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-19T13:25:20Z",
    "updated_at": "2021-01-19T13:25:20Z",
    "author_association": "MEMBER",
    "body": "Putting this up for discussion for tomorrow.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/762837335/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/768343021",
    "html_url": "https://github.com/ethereum/solidity/issues/10179#issuecomment-768343021",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/10179",
    "id": 768343021,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2ODM0MzAyMQ==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-27T14:58:49Z",
    "updated_at": "2021-01-27T14:58:49Z",
    "author_association": "MEMBER",
    "body": "> I'd not give the order in the sources a special meaning - I'd consider the yul object files like a generic object file format like an ELF object that just defines some section - what we're doing when compiling to bytecode is basically creating something like an old COM binary, which does have a fixed internal layout, but I'd say making sure that's the way it's supposed to is the job of the assembler/linker in the end. We should have the compiler output the layout of yul objects in the bytecode, though, if requested.\r\n\r\nI agree Yul object format is pretty similar to ELF (and WebAssembly) in intent and purposes. I disagree with your assessment though, given ELF specifically has metadata sections, which are demarcated properly (prefixed with `.` mostly).\r\n\r\n> In general I don't think the metadata should be defined as data parts in the yul objects at all. Similarly to the \"section order\" thing, I'd say this is something specific to the EVM bytecode format that's independent of Yul and job of the linker only.\r\n\r\nThis may have its merit, but it seems that metadata is a bit more closely coupled currently.\r\n\r\nOn today's call we have agreed to go with something like `@metadata` or `.metadata` as the object name, but also place the metadata as the last.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/768343021/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
