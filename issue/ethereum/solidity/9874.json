{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/9874",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/9874/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/9874/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/9874/events",
  "html_url": "https://github.com/ethereum/solidity/issues/9874",
  "id": 707580549,
  "node_id": "MDU6SXNzdWU3MDc1ODA1NDk=",
  "number": 9874,
  "title": "No compilation error present when attempting to create a 4 dimensional struct array",
  "user": {
    "login": "jamesdawsonWD",
    "id": 26853217,
    "node_id": "MDQ6VXNlcjI2ODUzMjE3",
    "avatar_url": "https://avatars.githubusercontent.com/u/26853217?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jamesdawsonWD",
    "html_url": "https://github.com/jamesdawsonWD",
    "followers_url": "https://api.github.com/users/jamesdawsonWD/followers",
    "following_url": "https://api.github.com/users/jamesdawsonWD/following{/other_user}",
    "gists_url": "https://api.github.com/users/jamesdawsonWD/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jamesdawsonWD/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jamesdawsonWD/subscriptions",
    "organizations_url": "https://api.github.com/users/jamesdawsonWD/orgs",
    "repos_url": "https://api.github.com/users/jamesdawsonWD/repos",
    "events_url": "https://api.github.com/users/jamesdawsonWD/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jamesdawsonWD/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 249074435,
      "node_id": "MDU6TGFiZWwyNDkwNzQ0MzU=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/bug%20:bug:",
      "name": "bug :bug:",
      "color": "fc1313",
      "default": false,
      "description": ""
    },
    {
      "id": 455256446,
      "node_id": "MDU6TGFiZWw0NTUyNTY0NDY=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/waiting%20for%20more%20input",
      "name": "waiting for more input",
      "color": "fef2c0",
      "default": false,
      "description": "Issues waiting for more input by the reporter"
    },
    {
      "id": 3104779662,
      "node_id": "MDU6TGFiZWwzMTA0Nzc5NjYy",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/should%20report%20error",
      "name": "should report error",
      "color": "666666",
      "default": false,
      "description": "Compiles without errors but should not."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2020-09-23T18:21:59Z",
  "updated_at": "2021-06-23T19:42:06Z",
  "closed_at": "2021-06-22T13:16:50Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nI recieved the following bug today:\r\n\r\n```\r\nCompileError: InternalCompilerError:\r\n\r\nCompilation failed. See above.\r\n```\r\n\r\nI narrowed  down the issue to the following line:\r\n\r\n```        \r\n    struct State {\r\n        // ...other struct stufff\r\n        StarSystem.Info[4][7][20][10000] stars;\r\n     }\r\n```\r\n\r\nI am not sure if nested arrays can work with structs in this way or if this is valid code at all, but it definitely should have a compilation error message if someone else tries what I have done. Save them an hour or two :) \r\n\r\n\r\n## Environment\r\n\r\n- Compiler version: 0.6.12\r\n- Target EVM version (as per compiler settings): solc (not sure if this is what you mean?)\r\n- Framework/IDE (e.g. Truffle or Remix): truffle\r\n- EVM execution environment / backend / blockchain client: local dev blockchain\r\n- Operating system: windows\r\n\r\n## Steps to Reproduce\r\n\r\nI have the following library\r\n```\r\nlibrary StarSystem {\r\n\r\n    struct Info {\r\n        uint256 tokenId;\r\n        bool hasFleet;\r\n    }\r\n\r\n}\r\n```\r\n\r\nMy storage Library imports it and when I remove the stars from the state struct everything compiles fine.\r\n```\r\nimport {StarSystem} from './StarSystem.sol';\r\nlibrary Storage {\r\n\r\n    struct State {\r\n        // ...other struct stufff\r\n        StarSystem.Info[4][7][20][10000] stars;\r\n     }\r\n\r\n}\r\n```\r\n\r\nI replaced the stars with this nesting mapping and it compiled fine.\r\n\r\n```\r\n   mapping(uint8 => mapping(uint8 => mapping(uint8 => mapping(uint32 => StarSystem.Info)))) stars;\r\n```\r\n\r\n\r\n",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/9874/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/9874/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/697946340",
    "html_url": "https://github.com/ethereum/solidity/issues/9874#issuecomment-697946340",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/9874",
    "id": 697946340,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5Nzk0NjM0MA==",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-23T20:11:10Z",
    "updated_at": "2020-09-23T20:11:10Z",
    "author_association": "MEMBER",
    "body": "Could you try to create a minimal failing example (.sol file) that has this problem? I tried to reproduce your error with just the snippets you posted but it compiles just fine both on 0.6.2 and on 0.7.1 for me.\r\n\r\nIf you try to compile the contract directly with `solc`, you should get more details - at least the file name and line number pointing at the place in `solc` source where it failed. In any case, anything that triggers `InternalCompilerError` is definitely a bug in the compiler.\r\n\r\n> Target EVM version (as per compiler settings): solc (not sure if this is what you mean?)\r\n\r\nSee https://solidity.readthedocs.io/en/v0.7.1/using-the-compiler.html#setting-the-evm-version-to-target\r\n\r\nBut if you didn't set it yourself then you're most likely targetting the default one (`istanbul`).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/697946340/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/865975163",
    "html_url": "https://github.com/ethereum/solidity/issues/9874#issuecomment-865975163",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/9874",
    "id": 865975163,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2NTk3NTE2Mw==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-22T13:16:50Z",
    "updated_at": "2021-06-22T13:16:50Z",
    "author_association": "MEMBER",
    "body": "I think we fixed that when we overhauled the \"type too large for storage\" check.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/865975163/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
