{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/11219",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/11219/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/11219/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/11219/events",
  "html_url": "https://github.com/ethereum/solidity/issues/11219",
  "id": 852371504,
  "node_id": "MDU6SXNzdWU4NTIzNzE1MDQ=",
  "number": 11219,
  "title": "Transaction reverts if tx.gasprice is used IN ANY WAY in transfer/send/call's value",
  "user": {
    "login": "Daniel-K-Ivanov",
    "id": 12232750,
    "node_id": "MDQ6VXNlcjEyMjMyNzUw",
    "avatar_url": "https://avatars.githubusercontent.com/u/12232750?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Daniel-K-Ivanov",
    "html_url": "https://github.com/Daniel-K-Ivanov",
    "followers_url": "https://api.github.com/users/Daniel-K-Ivanov/followers",
    "following_url": "https://api.github.com/users/Daniel-K-Ivanov/following{/other_user}",
    "gists_url": "https://api.github.com/users/Daniel-K-Ivanov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Daniel-K-Ivanov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Daniel-K-Ivanov/subscriptions",
    "organizations_url": "https://api.github.com/users/Daniel-K-Ivanov/orgs",
    "repos_url": "https://api.github.com/users/Daniel-K-Ivanov/repos",
    "events_url": "https://api.github.com/users/Daniel-K-Ivanov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Daniel-K-Ivanov/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-04-07T12:44:56Z",
  "updated_at": "2021-10-22T03:41:22Z",
  "closed_at": "2021-04-07T13:06:31Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\nSolidity contract compiled in 0.6.2, 0.7.0, 0.7.4 and even 0.8.0 reverts with `OUT_OF_GAS` if `tx.gasprice` is used in any way for transferring `ETH` on `Ropsten` and `Goerli` networks!\r\n\r\nThe issue is reproduced when using `send` or `call` as-well\r\n\r\nThe same contract call is working fine on the local ganache or hardhat node.\r\n\r\nExample:\r\n```Solidity\r\npragma solidity 0.8.0;\r\n\r\ncontract Test {\r\n\r\n    // reverts\r\n    function test() external {\r\n        address payable addr = payable(msg.sender);\r\n        addr.transfer(tx.gasprice);\r\n    }\r\n    // works\r\n    function test1() external {\r\n        address payable addr = payable(msg.sender);\r\n        addr.transfer(1000000000); // 1gwei\r\n    }\r\n\r\n    receive() external payable {}\r\n}\r\n```\r\nExpectation:\r\nThe transaction call not to revert and the msg sender to be refunded with the correct amount.\r\n\r\n## Environment\r\n\r\n- Compiler version: `0.6.2`, `0.7.0`, `0.7.4`, `0.8.0`\r\n- Target EVM version (as per compiler settings): \r\n- Framework/IDE (e.g. Truffle or Remix): `Hardhat`\r\n- EVM execution environment / backend / blockchain client: Infura\r\n- Operating system: MacOS BigSur 11.2.1\r\n\r\n## Steps to Reproduce\r\n\r\n1. Deploy the provided source code on Ropsten/Goerli\r\n2. Send 1 ETH to the contract\r\n3. Call the `test` function\r\n\r\n\r\nExample TX:\r\n`test` -> https://ropsten.etherscan.io/tx/0x89c74a6951116783aa1568d1c3d79d71d1a6aee3b027fc58144c5103377dddc8\r\n`test1` -> https://ropsten.etherscan.io/tx/0x4fa187cb9c3cfcaaa79f199db8cbabeea2956faab2b962911f0fd76871486b75",
  "closed_by": {
    "login": "Daniel-K-Ivanov",
    "id": 12232750,
    "node_id": "MDQ6VXNlcjEyMjMyNzUw",
    "avatar_url": "https://avatars.githubusercontent.com/u/12232750?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Daniel-K-Ivanov",
    "html_url": "https://github.com/Daniel-K-Ivanov",
    "followers_url": "https://api.github.com/users/Daniel-K-Ivanov/followers",
    "following_url": "https://api.github.com/users/Daniel-K-Ivanov/following{/other_user}",
    "gists_url": "https://api.github.com/users/Daniel-K-Ivanov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Daniel-K-Ivanov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Daniel-K-Ivanov/subscriptions",
    "organizations_url": "https://api.github.com/users/Daniel-K-Ivanov/orgs",
    "repos_url": "https://api.github.com/users/Daniel-K-Ivanov/repos",
    "events_url": "https://api.github.com/users/Daniel-K-Ivanov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Daniel-K-Ivanov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/11219/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/11219/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/814897789",
    "html_url": "https://github.com/ethereum/solidity/issues/11219#issuecomment-814897789",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11219",
    "id": 814897789,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNDg5Nzc4OQ==",
    "user": {
      "login": "Daniel-K-Ivanov",
      "id": 12232750,
      "node_id": "MDQ6VXNlcjEyMjMyNzUw",
      "avatar_url": "https://avatars.githubusercontent.com/u/12232750?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Daniel-K-Ivanov",
      "html_url": "https://github.com/Daniel-K-Ivanov",
      "followers_url": "https://api.github.com/users/Daniel-K-Ivanov/followers",
      "following_url": "https://api.github.com/users/Daniel-K-Ivanov/following{/other_user}",
      "gists_url": "https://api.github.com/users/Daniel-K-Ivanov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Daniel-K-Ivanov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Daniel-K-Ivanov/subscriptions",
      "organizations_url": "https://api.github.com/users/Daniel-K-Ivanov/orgs",
      "repos_url": "https://api.github.com/users/Daniel-K-Ivanov/repos",
      "events_url": "https://api.github.com/users/Daniel-K-Ivanov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Daniel-K-Ivanov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-07T13:06:28Z",
    "updated_at": "2021-04-07T13:06:28Z",
    "author_association": "NONE",
    "body": "Closing this issue, since it turns out that the automated `estimateGas` functionality is providing invalid number. I hardcoded a big `gasLimit` and the same transaction went through:\r\nhttps://ropsten.etherscan.io/tx/0x813b34273ac699ed0294f32c1a86a4172eb808577ceff893ef04d1482beb8bf5\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/814897789/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/949258385",
    "html_url": "https://github.com/ethereum/solidity/issues/11219#issuecomment-949258385",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11219",
    "id": 949258385,
    "node_id": "IC_kwDOAm_5kc44lIiR",
    "user": {
      "login": "lopezdp",
      "id": 5707191,
      "node_id": "MDQ6VXNlcjU3MDcxOTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5707191?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lopezdp",
      "html_url": "https://github.com/lopezdp",
      "followers_url": "https://api.github.com/users/lopezdp/followers",
      "following_url": "https://api.github.com/users/lopezdp/following{/other_user}",
      "gists_url": "https://api.github.com/users/lopezdp/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lopezdp/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lopezdp/subscriptions",
      "organizations_url": "https://api.github.com/users/lopezdp/orgs",
      "repos_url": "https://api.github.com/users/lopezdp/repos",
      "events_url": "https://api.github.com/users/lopezdp/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lopezdp/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-22T03:33:09Z",
    "updated_at": "2021-10-22T03:41:22Z",
    "author_association": "NONE",
    "body": "im seeing that today too. I tested `tx.gasprice` on its own today and it just returns 0... I need this guy!\r\n\r\nI get the same out of gas error in Koran too:\r\n\r\nhttps://kovan.etherscan.io/tx/0x82d562f100e866a9ac9a913c7d95a4d5c4b330e51fa5291bc63a6669bf3121f1\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/949258385/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
