{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/8959",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/8959/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/8959/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/8959/events",
  "html_url": "https://github.com/ethereum/solidity/issues/8959",
  "id": 619463220,
  "node_id": "MDU6SXNzdWU2MTk0NjMyMjA=",
  "number": 8959,
  "title": "ICE in solidity::yul::CodeGenerator::assemble: [Variable headStart is 2 slot(s) too deep inside the stack.]",
  "user": {
    "login": "agroce",
    "id": 967816,
    "node_id": "MDQ6VXNlcjk2NzgxNg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/967816?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/agroce",
    "html_url": "https://github.com/agroce",
    "followers_url": "https://api.github.com/users/agroce/followers",
    "following_url": "https://api.github.com/users/agroce/following{/other_user}",
    "gists_url": "https://api.github.com/users/agroce/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/agroce/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/agroce/subscriptions",
    "organizations_url": "https://api.github.com/users/agroce/orgs",
    "repos_url": "https://api.github.com/users/agroce/repos",
    "events_url": "https://api.github.com/users/agroce/events{/privacy}",
    "received_events_url": "https://api.github.com/users/agroce/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 249074435,
      "node_id": "MDU6TGFiZWwyNDkwNzQ0MzU=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/bug%20:bug:",
      "name": "bug :bug:",
      "color": "fc1313",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2020-05-16T12:32:36Z",
  "updated_at": "2020-07-02T18:49:55Z",
  "closed_at": "2020-07-02T18:49:55Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nThis contract:\r\n```solidity\r\npragma experimental ABIEncoderV2;\r\n\r\ncontract C {\r\n\t function f1 (byte[][] memory, int[] memory, int16, string [] memory, address) public returns (int16[] memory, int16[] memory)\r\n\t {}\r\n\t function f2 (C, address) public returns (byte[] memory, int16[]memory)\r\n\t {}\r\n}\r\n```\r\n\r\nproduces:\r\n\r\n```\r\nException during compilation: /home/user/solidity/libyul/backends/evm/AsmCodeGen.cpp(225): Throw in function static void solidity::yul::CodeGenerator::assemble(const solidity::yul::Block &, solidity::yul::AsmAnalysisInfo &, evmasm::Assembly &, langutil::EVMVersion, const solidity::yul::ExternalIdentifierAccess &, bool, bool)\r\nDynamic exception type: boost::exception_detail::clone_impl<solidity::yul::YulAssertion>\r\nstd::exception::what: Stack too deep when compiling inline assembly: Variable headStart is 2 slot(s) too deep inside the stack.\r\n[solidity::util::tag_comment*] = Stack too deep when compiling inline assembly: Variable headStart is 2 slot(s) too deep inside the stack.\r\n```\r\n\r\nwhen compiled with solc, only with `--optimize`\r\n\r\nSimilar to #8369 except that happens with or without `--optimize`, and I'm speculating the `headStart` vs `dataEnd` may mean different problems with the assembly, so reporting separately.  The minimized code is sort of different also, the returns of tuples seem to be required here.\r\n\r\nOn master, using AFL fuzzing.  Another discovery using https://github.com/agroce/afl-compiler-fuzzer.\r\n\r\n## Environment\r\n\r\n- Compiler version:  0.6.8-develop.2020.5.13+commit.1700bdc4.Linux.clang\r\n- Target EVM version (as per compiler settings): N/A\r\n- Framework/IDE (e.g. Truffle or Remix): N/A\r\n- EVM execution environment / backend / blockchain client: N/A\r\n- Operating system: Ubuntu 18.04 in docker\r\n\r\n## Steps to Reproduce\r\n\r\nAbove shows pretty clearly, I think.\r\n",
  "closed_by": {
    "login": "bshastry",
    "id": 2388185,
    "node_id": "MDQ6VXNlcjIzODgxODU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2388185?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bshastry",
    "html_url": "https://github.com/bshastry",
    "followers_url": "https://api.github.com/users/bshastry/followers",
    "following_url": "https://api.github.com/users/bshastry/following{/other_user}",
    "gists_url": "https://api.github.com/users/bshastry/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bshastry/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bshastry/subscriptions",
    "organizations_url": "https://api.github.com/users/bshastry/orgs",
    "repos_url": "https://api.github.com/users/bshastry/repos",
    "events_url": "https://api.github.com/users/bshastry/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bshastry/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/8959/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/8959/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/636859036",
    "html_url": "https://github.com/ethereum/solidity/issues/8959#issuecomment-636859036",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/8959",
    "id": 636859036,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNjg1OTAzNg==",
    "user": {
      "login": "wighawag",
      "id": 790580,
      "node_id": "MDQ6VXNlcjc5MDU4MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/790580?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wighawag",
      "html_url": "https://github.com/wighawag",
      "followers_url": "https://api.github.com/users/wighawag/followers",
      "following_url": "https://api.github.com/users/wighawag/following{/other_user}",
      "gists_url": "https://api.github.com/users/wighawag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wighawag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wighawag/subscriptions",
      "organizations_url": "https://api.github.com/users/wighawag/orgs",
      "repos_url": "https://api.github.com/users/wighawag/repos",
      "events_url": "https://api.github.com/users/wighawag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wighawag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-01T13:24:23Z",
    "updated_at": "2020-06-01T13:24:23Z",
    "author_association": "NONE",
    "body": "I got a similar compiler issue : `YulException: Stack too deep when compiling inline assembly: Variable headStart is 1 slot(s) too deep inside the stack.`\r\n\r\nThe weird thing is that the issue appears after I add natspec doc on events.\r\n\r\nCan't share the code right now, and will try to isolate more but maybe that can already help to know that simply adding natspec comment can cause this issue ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/636859036/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/652333555",
    "html_url": "https://github.com/ethereum/solidity/issues/8959#issuecomment-652333555",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/8959",
    "id": 652333555,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MjMzMzU1NQ==",
    "user": {
      "login": "bshastry",
      "id": 2388185,
      "node_id": "MDQ6VXNlcjIzODgxODU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2388185?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bshastry",
      "html_url": "https://github.com/bshastry",
      "followers_url": "https://api.github.com/users/bshastry/followers",
      "following_url": "https://api.github.com/users/bshastry/following{/other_user}",
      "gists_url": "https://api.github.com/users/bshastry/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bshastry/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bshastry/subscriptions",
      "organizations_url": "https://api.github.com/users/bshastry/orgs",
      "repos_url": "https://api.github.com/users/bshastry/repos",
      "events_url": "https://api.github.com/users/bshastry/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bshastry/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-01T10:22:32Z",
    "updated_at": "2020-07-01T10:22:32Z",
    "author_association": "MEMBER",
    "body": "@agroce Does this issue still reproduce against the latest develop commit `9d6413df8`?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/652333555/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/653076399",
    "html_url": "https://github.com/ethereum/solidity/issues/8959#issuecomment-653076399",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/8959",
    "id": 653076399,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MzA3NjM5OQ==",
    "user": {
      "login": "agroce",
      "id": 967816,
      "node_id": "MDQ6VXNlcjk2NzgxNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/967816?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/agroce",
      "html_url": "https://github.com/agroce",
      "followers_url": "https://api.github.com/users/agroce/followers",
      "following_url": "https://api.github.com/users/agroce/following{/other_user}",
      "gists_url": "https://api.github.com/users/agroce/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/agroce/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/agroce/subscriptions",
      "organizations_url": "https://api.github.com/users/agroce/orgs",
      "repos_url": "https://api.github.com/users/agroce/repos",
      "events_url": "https://api.github.com/users/agroce/events{/privacy}",
      "received_events_url": "https://api.github.com/users/agroce/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-02T15:32:36Z",
    "updated_at": "2020-07-02T15:32:36Z",
    "author_association": "NONE",
    "body": "Just grabbed latest (probably past that one) and am running, have a few possible new things to report I'm checking, will check this too.  (Backlog of possible new bugs; I had mistyped a directory name in a triage script, and so was seeing last month's fuzz results, noticed eventually the hash was identical on four runs, which is impossible).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/653076399/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/653088866",
    "html_url": "https://github.com/ethereum/solidity/issues/8959#issuecomment-653088866",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/8959",
    "id": 653088866,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MzA4ODg2Ng==",
    "user": {
      "login": "agroce",
      "id": 967816,
      "node_id": "MDQ6VXNlcjk2NzgxNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/967816?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/agroce",
      "html_url": "https://github.com/agroce",
      "followers_url": "https://api.github.com/users/agroce/followers",
      "following_url": "https://api.github.com/users/agroce/following{/other_user}",
      "gists_url": "https://api.github.com/users/agroce/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/agroce/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/agroce/subscriptions",
      "organizations_url": "https://api.github.com/users/agroce/orgs",
      "repos_url": "https://api.github.com/users/agroce/repos",
      "events_url": "https://api.github.com/users/agroce/events{/privacy}",
      "received_events_url": "https://api.github.com/users/agroce/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-02T15:53:14Z",
    "updated_at": "2020-07-02T15:53:14Z",
    "author_association": "NONE",
    "body": "On 3d96e2b1 I get:\r\n\r\n```\r\nuser@239d7503a8e2:~/solidity/test$ ../build/solc/solc cs.sol --optimize\r\nCompiler error: Stack too deep when compiling inline assembly: Variable headStart is 2 slot(s) too deep inside the stack.\r\n```\r\n\r\nso \"looks fixed to me\"",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/653088866/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/653167961",
    "html_url": "https://github.com/ethereum/solidity/issues/8959#issuecomment-653167961",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/8959",
    "id": 653167961,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MzE2Nzk2MQ==",
    "user": {
      "login": "bshastry",
      "id": 2388185,
      "node_id": "MDQ6VXNlcjIzODgxODU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2388185?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bshastry",
      "html_url": "https://github.com/bshastry",
      "followers_url": "https://api.github.com/users/bshastry/followers",
      "following_url": "https://api.github.com/users/bshastry/following{/other_user}",
      "gists_url": "https://api.github.com/users/bshastry/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bshastry/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bshastry/subscriptions",
      "organizations_url": "https://api.github.com/users/bshastry/orgs",
      "repos_url": "https://api.github.com/users/bshastry/repos",
      "events_url": "https://api.github.com/users/bshastry/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bshastry/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-02T18:49:55Z",
    "updated_at": "2020-07-02T18:49:55Z",
    "author_association": "MEMBER",
    "body": "Thank you @agroce Marking the issue as closed",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/653167961/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
