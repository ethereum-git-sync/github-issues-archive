{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/7373",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/7373/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/7373/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/7373/events",
  "html_url": "https://github.com/ethereum/solidity/issues/7373",
  "id": 490285021,
  "node_id": "MDU6SXNzdWU0OTAyODUwMjE=",
  "number": 7373,
  "title": "Trailing spaces in JSON output",
  "user": {
    "login": "ekpyron",
    "id": 1347491,
    "node_id": "MDQ6VXNlcjEzNDc0OTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ekpyron",
    "html_url": "https://github.com/ekpyron",
    "followers_url": "https://api.github.com/users/ekpyron/followers",
    "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
    "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
    "organizations_url": "https://api.github.com/users/ekpyron/orgs",
    "repos_url": "https://api.github.com/users/ekpyron/repos",
    "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ekpyron/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2019-09-06T11:50:13Z",
  "updated_at": "2019-10-04T15:57:57Z",
  "closed_at": "2019-10-04T15:57:57Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Came up in https://github.com/ethereum/solidity/pull/7372.\r\n\r\nOur JSON AST output (and potentially other json output) has trailing spaces, which required a workaround in our check_style script for the recovery_ast_constructor commandline test and for all ASTJSON tests.\r\n\r\nThe whitespace is needlessly generated by json-cpp, so we need to postprocess its output.\r\n\r\nThe task is to adjust ``ASTJsonConverter`` to remove all trailing whitespace generated by json-cpp before printing.\r\nA possible approach would be to change ``ASTJsonConverter::print`` to write to a temporary ``std::stringstream`` first. Then the contents of that can be read back line by line, stripped of whitespace and written to the desired ``std::ostream``.",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/7373/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/7373/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/528829783",
    "html_url": "https://github.com/ethereum/solidity/issues/7373#issuecomment-528829783",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7373",
    "id": 528829783,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyODgyOTc4Mw==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-06T12:10:45Z",
    "updated_at": "2019-09-06T12:10:45Z",
    "author_association": "MEMBER",
    "body": "Lets get rid of that.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/528829783/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/537505245",
    "html_url": "https://github.com/ethereum/solidity/issues/7373#issuecomment-537505245",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7373",
    "id": 537505245,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNzUwNTI0NQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-02T13:58:54Z",
    "updated_at": "2019-10-02T13:59:16Z",
    "author_association": "MEMBER",
    "body": "Maybe also investigate whether the function `jsonPrettyPrint` in `libdevcore/JSON.cpp` or its settings could be of value.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/537505245/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/537524430",
    "html_url": "https://github.com/ethereum/solidity/issues/7373#issuecomment-537524430",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7373",
    "id": 537524430,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNzUyNDQzMA==",
    "user": {
      "login": "ghallak",
      "id": 8301939,
      "node_id": "MDQ6VXNlcjgzMDE5Mzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8301939?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghallak",
      "html_url": "https://github.com/ghallak",
      "followers_url": "https://api.github.com/users/ghallak/followers",
      "following_url": "https://api.github.com/users/ghallak/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghallak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghallak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghallak/subscriptions",
      "organizations_url": "https://api.github.com/users/ghallak/orgs",
      "repos_url": "https://api.github.com/users/ghallak/repos",
      "events_url": "https://api.github.com/users/ghallak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghallak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-02T14:39:12Z",
    "updated_at": "2019-10-02T14:39:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "@chriseth This can either be solved by using `jsonPrettyPrint(toJson(_node))` instead of `toJson(_node)` here https://github.com/ethereum/solidity/blob/634da933fafae7486cb9db3feb10f01d258bb884/libsolidity/ast/ASTJsonConverter.cpp#L190-L193\r\nand this will require changing the [test/cmdlineTests/recovery_ast_constructor/output](https://github.com/ethereum/solidity/blob/f88437314290cb6fc8b5ab856769ee53852b276a/test/cmdlineTests/recovery_ast_constructor/output) to use 2 spaces for indention instead of using tabs, since that's what `jsonPrettyPrint` uses https://github.com/ethereum/solidity/blob/f88437314290cb6fc8b5ab856769ee53852b276a/libdevcore/JSON.cpp#L94\r\n\r\nOr it can be solved by writing the JSON value to a string in the function `ASTJsonConverter::print` using `Json::writeString` and then using `boost::replace_all` to remove the spaces from the ends of lines. This won't require any change to [test/cmdlineTests/recovery_ast_constructor/output](https://github.com/ethereum/solidity/blob/f88437314290cb6fc8b5ab856769ee53852b276a/test/cmdlineTests/recovery_ast_constructor/output).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/537524430/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/537526131",
    "html_url": "https://github.com/ethereum/solidity/issues/7373#issuecomment-537526131",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7373",
    "id": 537526131,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNzUyNjEzMQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-02T14:42:46Z",
    "updated_at": "2019-10-02T14:42:46Z",
    "author_association": "MEMBER",
    "body": "So the \"yaml compatibility\" removes the trailing whitespace? Then I would say that `jsonPrettyPrint` is the way to go, even if it uses spaces for indentation.\r\nNote that if you run the commandline tests, it will auto-update the expectation after asking for confirmation, so manually changing `test/cmdlineTests/recovery_ast_constructor/output` is not necessary.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/537526131/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/537526583",
    "html_url": "https://github.com/ethereum/solidity/issues/7373#issuecomment-537526583",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7373",
    "id": 537526583,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNzUyNjU4Mw==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-02T14:43:45Z",
    "updated_at": "2019-10-02T14:44:07Z",
    "author_association": "MEMBER",
    "body": "That's what removes the trailing whitespace:\r\nhttps://github.com/ethereum/solidity/blob/f88437314290cb6fc8b5ab856769ee53852b276a/libdevcore/JSON.cpp#L97\r\nSo I'd say that's probably the way to go...",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/537526583/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/537526813",
    "html_url": "https://github.com/ethereum/solidity/issues/7373#issuecomment-537526813",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7373",
    "id": 537526813,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNzUyNjgxMw==",
    "user": {
      "login": "ghallak",
      "id": 8301939,
      "node_id": "MDQ6VXNlcjgzMDE5Mzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8301939?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ghallak",
      "html_url": "https://github.com/ghallak",
      "followers_url": "https://api.github.com/users/ghallak/followers",
      "following_url": "https://api.github.com/users/ghallak/following{/other_user}",
      "gists_url": "https://api.github.com/users/ghallak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ghallak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ghallak/subscriptions",
      "organizations_url": "https://api.github.com/users/ghallak/orgs",
      "repos_url": "https://api.github.com/users/ghallak/repos",
      "events_url": "https://api.github.com/users/ghallak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ghallak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-02T14:44:14Z",
    "updated_at": "2019-10-02T14:52:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ekpyron is right, I couldn't find out what yaml compatibility is doing.\r\n\r\nEdit: yaml cmpatibility is actually removing the space between the key and the colon, so enabling yaml compatibility will result in `\"key\": x` instead of `\"key\" : x`.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/537526813/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
