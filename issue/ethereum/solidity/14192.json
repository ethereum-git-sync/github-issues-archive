{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/14192",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/14192/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/14192/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/14192/events",
  "html_url": "https://github.com/ethereum/solidity/issues/14192",
  "id": 1699804638,
  "node_id": "I_kwDOAm_5kc5lUPXe",
  "number": 14192,
  "title": "[AST] Reference id to import directive alias inconsistency",
  "user": {
    "login": "michprev",
    "id": 7281754,
    "node_id": "MDQ6VXNlcjcyODE3NTQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7281754?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/michprev",
    "html_url": "https://github.com/michprev",
    "followers_url": "https://api.github.com/users/michprev/followers",
    "following_url": "https://api.github.com/users/michprev/following{/other_user}",
    "gists_url": "https://api.github.com/users/michprev/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/michprev/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michprev/subscriptions",
    "organizations_url": "https://api.github.com/users/michprev/orgs",
    "repos_url": "https://api.github.com/users/michprev/repos",
    "events_url": "https://api.github.com/users/michprev/events{/privacy}",
    "received_events_url": "https://api.github.com/users/michprev/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 249074435,
      "node_id": "MDU6TGFiZWwyNDkwNzQ0MzU=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/bug%20:bug:",
      "name": "bug :bug:",
      "color": "fc1313",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-05-08T08:41:23Z",
  "updated_at": "2023-05-08T18:08:01Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nImport directives allow creating of symbol aliases, for example:\r\n\r\n```solidity\r\nimport { symbol as symbolAlias } from \"./Foo.sol\";\r\n```\r\n\r\nand source unit aliases:\r\n\r\n```solidity\r\nimport * as unitAlias from \"./Foo.sol\";\r\n```\r\n\r\nWhen referencing these aliases through an Identifier node, there is an inconsistency. When referencing `symbolAlias`, referenced declaration AST node ID is the ID of the symbol itself (can be a contract definition, for example) and not the ID of the import directive, where the symbol alias was declared.\r\n\r\nWhen referencing `unitAlias`, referenced declaration AST node ID points to the import directive, where the unit alias was declared and not to the source unit itself.\r\n\r\n## Environment\r\n\r\n- Compiler version: 0.8.19\r\n- Target EVM version (as per compiler settings): latest\r\n- Framework/IDE (e.g. Truffle or Remix): n/a\r\n- EVM execution environment / backend / blockchain client: n/a\r\n- Operating system: Linux\r\n\r\n## Steps to Reproduce\r\n\r\nPlease see the example here: https://github.com/michprev/solc-ast-import-alias-inconsistency. It contains generated ASTs of all files.\r\n\r\nIn file A, `Base` (https://github.com/michprev/solc-ast-import-alias-inconsistency/blob/c399cdcda566c5e2b86472422ac5ca47425d8b0b/contracts/A.sol#L8) is an Identifier node and it's referenced declaration ID points to the import directive (https://github.com/michprev/solc-ast-import-alias-inconsistency/blob/c399cdcda566c5e2b86472422ac5ca47425d8b0b/contracts/A.sol#L4).\r\n\r\nIn file B, `Base2` (https://github.com/michprev/solc-ast-import-alias-inconsistency/blob/c399cdcda566c5e2b86472422ac5ca47425d8b0b/contracts/B.sol#L8) is an Identifier node and it's referenced declaration ID points to the contract definition (https://github.com/michprev/solc-ast-import-alias-inconsistency/blob/c399cdcda566c5e2b86472422ac5ca47425d8b0b/contracts/Base.sol#L4-L6).\r\n\r\nThis introduces inconsistency - an import directive is referenced from a source unit alias but is not referenced from a symbol alias.\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/14192/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/14192/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1538815596",
    "html_url": "https://github.com/ethereum/solidity/issues/14192#issuecomment-1538815596",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/14192",
    "id": 1538815596,
    "node_id": "IC_kwDOAm_5kc5buHZs",
    "user": {
      "login": "michprev",
      "id": 7281754,
      "node_id": "MDQ6VXNlcjcyODE3NTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7281754?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michprev",
      "html_url": "https://github.com/michprev",
      "followers_url": "https://api.github.com/users/michprev/followers",
      "following_url": "https://api.github.com/users/michprev/following{/other_user}",
      "gists_url": "https://api.github.com/users/michprev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michprev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michprev/subscriptions",
      "organizations_url": "https://api.github.com/users/michprev/orgs",
      "repos_url": "https://api.github.com/users/michprev/repos",
      "events_url": "https://api.github.com/users/michprev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michprev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-08T18:08:01Z",
    "updated_at": "2023-05-08T18:08:01Z",
    "author_association": "NONE",
    "body": "I have created one more example with red arrows showing actual referenced declaration IDs and the green arrow showing what I would expect as the correct behavior. There is one problem though. Symbol aliases inside an import directive do not have AST IDs and so cannot be directly referenced.\r\n\r\nBecause of this issue, many language servers do not correctly perform LSP rename of the `Bar2` symbol (https://marketplace.visualstudio.com/items?itemName=AckeeBlockchain.tools-for-solidity, https://marketplace.visualstudio.com/items?itemName=NomicFoundation.hardhat-solidity).\r\n![image](https://user-images.githubusercontent.com/7281754/236898315-86d45803-d3fc-4125-8f54-3dea03206398.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1538815596/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
