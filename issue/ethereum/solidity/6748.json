{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/6748",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/6748/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/6748/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/6748/events",
  "html_url": "https://github.com/ethereum/solidity/issues/6748",
  "id": 443729885,
  "node_id": "MDU6SXNzdWU0NDM3Mjk4ODU=",
  "number": 6748,
  "title": "Question about JSON outputSelection performance",
  "user": {
    "login": "cgewecke",
    "id": 7332026,
    "node_id": "MDQ6VXNlcjczMzIwMjY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cgewecke",
    "html_url": "https://github.com/cgewecke",
    "followers_url": "https://api.github.com/users/cgewecke/followers",
    "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
    "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
    "organizations_url": "https://api.github.com/users/cgewecke/orgs",
    "repos_url": "https://api.github.com/users/cgewecke/repos",
    "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cgewecke/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 838064207,
      "node_id": "MDU6TGFiZWw4MzgwNjQyMDc=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/annoys%20users%20:cry:",
      "name": "annoys users :cry:",
      "color": "ea2cab",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "leonardoalt",
    "id": 504195,
    "node_id": "MDQ6VXNlcjUwNDE5NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/504195?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/leonardoalt",
    "html_url": "https://github.com/leonardoalt",
    "followers_url": "https://api.github.com/users/leonardoalt/followers",
    "following_url": "https://api.github.com/users/leonardoalt/following{/other_user}",
    "gists_url": "https://api.github.com/users/leonardoalt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/leonardoalt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/leonardoalt/subscriptions",
    "organizations_url": "https://api.github.com/users/leonardoalt/orgs",
    "repos_url": "https://api.github.com/users/leonardoalt/repos",
    "events_url": "https://api.github.com/users/leonardoalt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/leonardoalt/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "leonardoalt",
      "id": 504195,
      "node_id": "MDQ6VXNlcjUwNDE5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/504195?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/leonardoalt",
      "html_url": "https://github.com/leonardoalt",
      "followers_url": "https://api.github.com/users/leonardoalt/followers",
      "following_url": "https://api.github.com/users/leonardoalt/following{/other_user}",
      "gists_url": "https://api.github.com/users/leonardoalt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/leonardoalt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leonardoalt/subscriptions",
      "organizations_url": "https://api.github.com/users/leonardoalt/orgs",
      "repos_url": "https://api.github.com/users/leonardoalt/repos",
      "events_url": "https://api.github.com/users/leonardoalt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/leonardoalt/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2019-05-14T06:20:05Z",
  "updated_at": "2019-07-03T12:11:43Z",
  "closed_at": "2019-07-03T12:11:43Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "If I pass a large number of contract sources to solc via JSON I/O but only specify a small number of these as compilation targets (listing them as  outputSelection keys), is that faster than compiling all sources (using `*` as an output selector)? \r\n\r\nTruffle has a profiler which uses this strategy to shorten compilation times but it  seems to perform like `compile all`.\r\n\r\n### Reproduction\r\n+ Install [colonyNetwork](https://github.com/JoinColony/colonyNetwork)\r\n```\r\ngit clone https://github.com/JoinColony/colonyNetwork.git\r\ncd colonyNetwork\r\nyarn\r\ngit submodule update --init\r\n```\r\n+ Comment out `docker: true` in the truffle.js compilers config. (Truffle has a bug with solc docker at the moment causing compilation to hang)\r\n\r\n+ Run `time npx truffle compile`, (compiling all contracts takes ~ 2 minutes)\r\n+ Create a new file (Example.sol) in the contracts folder:\r\n```solidity\r\npragma solidity >=0.5.3;\r\n\r\ncontract Example {\r\n  constructor() public {}\r\n}\r\n```\r\n+ Run `time npx truffle compile` again (will compile just Example since it's the only change)\r\n\r\nThe JSON I/O object [truffle passes to solc](https://github.com/trufflesuite/truffle/blob/develop/packages/truffle-compile/index.js#L119) for this last step it looks correct. All the sources in the contracts folder are present (so solc can resolve imports if it needs to) and Example is the only target.\r\n```javascript\r\n{\r\n \"language\": \"Solidity\",\r\n \"sources\": {\r\n  \"/Users/cgewecke/code/colonyNetwork/contracts/Colony.sol\": {\r\n   \"content\": \"/*\\n... \r\n\r\n     .... etc...  dozens of contracts\r\n   \"\r\n  }\r\n },\r\n \"settings\": {\r\n  \"evmVersion\": \"petersburg\",\r\n  \"optimizer\": {\r\n   \"enabled\": true,\r\n   \"runs\": 200\r\n  },\r\n  \"outputSelection\": {\r\n   \"/Users/cgewecke/code/colonyNetwork/contracts/Example.sol\": {\r\n    \"\": [\r\n     \"legacyAST\",\r\n     \"ast\"\r\n    ],\r\n    \"*\": [\r\n     \"abi\",\r\n     \"metadata\",\r\n     \"evm.bytecode.object\",\r\n     \"evm.bytecode.sourceMap\",\r\n     \"evm.deployedBytecode.object\",\r\n     \"evm.deployedBytecode.sourceMap\",\r\n     \"userdoc\",\r\n     \"devdoc\"\r\n    ]\r\n   }\r\n  }\r\n }\r\n}\r\n``` \r\n\r\n\r\n\r\nHowever compilation still takes two minutes and solc outputs a large number of warnings which suggest that the entire contract set is being processed.\r\n\r\n### Environment\r\n`solc version`: 0.5.6\r\n`os`: OSX",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/6748/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/6748/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/492176594",
    "html_url": "https://github.com/ethereum/solidity/issues/6748#issuecomment-492176594",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6748",
    "id": 492176594,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5MjE3NjU5NA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-14T10:13:12Z",
    "updated_at": "2019-05-14T10:13:12Z",
    "author_association": "MEMBER",
    "body": "You are right, if you use `*`, then all contracts will be compiled, even if you specified only a single file. Thanks for bringing this to our attention!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/492176594/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/492177333",
    "html_url": "https://github.com/ethereum/solidity/issues/6748#issuecomment-492177333",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6748",
    "id": 492177333,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5MjE3NzMzMw==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-14T10:15:29Z",
    "updated_at": "2019-05-14T10:15:29Z",
    "author_association": "MEMBER",
    "body": "Note to implementer: The function should be `requestedContractNames` in `StandardCompiler.cpp`, but subsequently called functions could also be relevant.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/492177333/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/492339918",
    "html_url": "https://github.com/ethereum/solidity/issues/6748#issuecomment-492339918",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6748",
    "id": 492339918,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5MjMzOTkxOA==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-14T17:48:29Z",
    "updated_at": "2019-05-14T17:48:29Z",
    "author_association": "NONE",
    "body": "@chriseth If I currently had \r\n```\r\n\"Example\": [\r\n     \"abi\",\r\n     \"metadata\",\r\n     \"etc\"\r\n```\r\nin the second layer of the outputSelection object would that make it behave the way I was hoping? \r\n\r\nDo I have to do something similar to:\r\n```\r\n\"\": [\r\n     \"legacyAST\",\r\n     \"ast\"\r\n    ],\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/492339918/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
