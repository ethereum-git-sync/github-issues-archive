{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/6287",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/6287/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/6287/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/6287/events",
  "html_url": "https://github.com/ethereum/solidity/issues/6287",
  "id": 421015205,
  "node_id": "MDU6SXNzdWU0MjEwMTUyMDU=",
  "number": 6287,
  "title": "Multiple token transfer in exchange site",
  "user": {
    "login": "blockchain-app12",
    "id": 48212011,
    "node_id": "MDQ6VXNlcjQ4MjEyMDEx",
    "avatar_url": "https://avatars.githubusercontent.com/u/48212011?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/blockchain-app12",
    "html_url": "https://github.com/blockchain-app12",
    "followers_url": "https://api.github.com/users/blockchain-app12/followers",
    "following_url": "https://api.github.com/users/blockchain-app12/following{/other_user}",
    "gists_url": "https://api.github.com/users/blockchain-app12/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/blockchain-app12/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/blockchain-app12/subscriptions",
    "organizations_url": "https://api.github.com/users/blockchain-app12/orgs",
    "repos_url": "https://api.github.com/users/blockchain-app12/repos",
    "events_url": "https://api.github.com/users/blockchain-app12/events{/privacy}",
    "received_events_url": "https://api.github.com/users/blockchain-app12/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2019-03-14T13:22:57Z",
  "updated_at": "2019-03-19T14:47:27Z",
  "closed_at": "2019-03-14T13:47:40Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!--## Prerequisites\r\n-->\r\n## Description\r\nHi, I am working on token exchange site. In which I wrote functions for transferring multiple tokens. When I tried to transfer token in my contract it shows gas estimation failed. It's not calling the approve function. If I call approve function of token contract from my contract, it takes msg.sender as my contract address by that it process as my contract address (instead of my wallet address) approving spender address.Kindly go throw the below contract and help finding the solution.\r\n\r\n    function transfer(address token, uint256 tokens)public payable                         // deposit perticular token balance to contract address (site address), can depoit multiple token   \r\n    {\r\n        if(Token(token).approve(address(this),tokens))\r\n        {\r\n            dep_token[msg.sender][token] = safeAdd(dep_token[msg.sender][token], tokens);\r\n            Token(token).transferFrom(msg.sender,address(this), tokens);\r\n        }\r\n    }\r\n    \r\n    function token_withdraw(address token, uint256 tokens)public payable                    // withdraw perticular token balance from contract to user    \r\n    {\r\n        dep_token[msg.sender][token] = safeSub(dep_token[msg.sender][token] , tokens) ;   \r\n        Token(token).transfer(msg.sender, tokens);\r\n    }\r\n\r\n\r\n<!--\r\nPlease describe the purpose of your ticket.\r\n-->\r\n",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/6287/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/6287/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/472861647",
    "html_url": "https://github.com/ethereum/solidity/issues/6287#issuecomment-472861647",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6287",
    "id": 472861647,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3Mjg2MTY0Nw==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-14T13:47:40Z",
    "updated_at": "2019-03-14T13:47:40Z",
    "author_association": "MEMBER",
    "body": "\"gas estimation failed\" looks like you are triggering a revert, for example due to an overflow.\r\nThis question is better asked at https://ethereum.stackexchange.com - you will get faster and better replies there. If you think this might be a bug in the compiler, please reopen the issue.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/472861647/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/473156880",
    "html_url": "https://github.com/ethereum/solidity/issues/6287#issuecomment-473156880",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6287",
    "id": 473156880,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MzE1Njg4MA==",
    "user": {
      "login": "blockchain-app12",
      "id": 48212011,
      "node_id": "MDQ6VXNlcjQ4MjEyMDEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/48212011?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/blockchain-app12",
      "html_url": "https://github.com/blockchain-app12",
      "followers_url": "https://api.github.com/users/blockchain-app12/followers",
      "following_url": "https://api.github.com/users/blockchain-app12/following{/other_user}",
      "gists_url": "https://api.github.com/users/blockchain-app12/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/blockchain-app12/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/blockchain-app12/subscriptions",
      "organizations_url": "https://api.github.com/users/blockchain-app12/orgs",
      "repos_url": "https://api.github.com/users/blockchain-app12/repos",
      "events_url": "https://api.github.com/users/blockchain-app12/events{/privacy}",
      "received_events_url": "https://api.github.com/users/blockchain-app12/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-15T04:42:47Z",
    "updated_at": "2019-03-15T04:42:47Z",
    "author_association": "NONE",
    "body": "My actual question is, with multi token when I call approve function from exchange contract, nor my address and spender get approved. Instead only the exchange address and spender gets approved. \r\nIts like when I call approve with spender as my contract address, in token contract it takes msg.sender as my contract address.\r\n\r\nHelp me resolving this.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/473156880/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/474403779",
    "html_url": "https://github.com/ethereum/solidity/issues/6287#issuecomment-474403779",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6287",
    "id": 474403779,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NDQwMzc3OQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-19T14:47:27Z",
    "updated_at": "2019-03-19T14:47:27Z",
    "author_association": "MEMBER",
    "body": "I'm sorry, but this is really not the right place for such questions.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/474403779/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
