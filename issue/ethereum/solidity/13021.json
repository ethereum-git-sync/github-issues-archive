{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/13021",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/13021/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/13021/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/13021/events",
  "html_url": "https://github.com/ethereum/solidity/issues/13021",
  "id": 1235842339,
  "node_id": "I_kwDOAm_5kc5JqXUj",
  "number": 13021,
  "title": "Why I can`t pop() an array into a map with Solidity 0.8?",
  "user": {
    "login": "JTorresConsulta",
    "id": 22349981,
    "node_id": "MDQ6VXNlcjIyMzQ5OTgx",
    "avatar_url": "https://avatars.githubusercontent.com/u/22349981?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/JTorresConsulta",
    "html_url": "https://github.com/JTorresConsulta",
    "followers_url": "https://api.github.com/users/JTorresConsulta/followers",
    "following_url": "https://api.github.com/users/JTorresConsulta/following{/other_user}",
    "gists_url": "https://api.github.com/users/JTorresConsulta/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/JTorresConsulta/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/JTorresConsulta/subscriptions",
    "organizations_url": "https://api.github.com/users/JTorresConsulta/orgs",
    "repos_url": "https://api.github.com/users/JTorresConsulta/repos",
    "events_url": "https://api.github.com/users/JTorresConsulta/events{/privacy}",
    "received_events_url": "https://api.github.com/users/JTorresConsulta/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-05-14T02:54:01Z",
  "updated_at": "2022-05-14T09:55:55Z",
  "closed_at": "2022-05-14T09:55:55Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I think there is a bug with pop() of arrays of mapping.\r\n\r\n**OwnerIndexes[msg.sender].pop();  //Problem with this line !!!!!!!**\r\n\r\n\r\n```\r\npragma solidity ^0.8.0;\r\n\r\n// SPDX-License-Identifier:  \r\n\r\ncontract Map {\r\n\r\n    uint[] All;\r\n\r\n    mapping (string => uint) NameIndex;  \r\n    mapping (address => uint[]) OwnerIndexes;\r\n\r\n    constructor() {\r\n        All.push();\r\n        NameIndex[\"0x0000000000000000000000000000000000000000\"]=0;\r\n        OwnerIndexes[0x0000000000000000000000000000000000000000].push(0);\r\n    }\r\n\r\n    function ADD( string memory Name) public {\r\n        if(NameIndex[Name]==0){\r\n            NameIndex[Name] = All.length;\r\n            OwnerIndexes[msg.sender].push(All.length);\r\n            All.push();\r\n        }\r\n    }\r\n\r\n    function READ_Name( string memory Name) public view returns (uint) {\r\n        return NameIndex[Name];\r\n    }\r\n    function READ_Indexes() public view returns (uint[] memory) {\r\n        return OwnerIndexes[msg.sender];\r\n    }\r\n\r\n    function DELETE_Name( string memory Name) public payable {\r\n        uint index = NameIndex[Name];\r\n\r\n        for (uint i = 0; i < All.length-1; i++) {\r\n            if (OwnerIndexes[msg.sender][i] == index) {\r\n                //OwnerIndexes[msg.sender][i]=0;\r\n                //delete OwnerIndexes[msg.sender][i];\r\n\r\n                OwnerIndexes[msg.sender][i] = OwnerIndexes[msg.sender][ OwnerIndexes[msg.sender].length -1 ];\r\n                //Delete last array position\r\n                delete OwnerIndexes[msg.sender][ OwnerIndexes[msg.sender].length -1 ];\r\n                OwnerIndexes[msg.sender].pop();  //Problem with this line !!!!!!!\r\n            }\r\n        }\r\n\r\n        NameIndex[Name] = 0; \r\n    }\r\n\r\n    function GetIndexOfOwner( uint i ) public view returns (uint) {\r\n        return OwnerIndexes[msg.sender][i];\r\n    }\r\n\r\n    function Total_OwnerIndexes( ) public view returns (uint) {\r\n        return OwnerIndexes[msg.sender].length;\r\n    }\r\n\r\n    function TotalIndexes( ) public view returns (uint) {\r\n        return All.length;\r\n    }\r\n}\r\n```",
  "closed_by": {
    "login": "leonardoalt",
    "id": 504195,
    "node_id": "MDQ6VXNlcjUwNDE5NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/504195?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/leonardoalt",
    "html_url": "https://github.com/leonardoalt",
    "followers_url": "https://api.github.com/users/leonardoalt/followers",
    "following_url": "https://api.github.com/users/leonardoalt/following{/other_user}",
    "gists_url": "https://api.github.com/users/leonardoalt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/leonardoalt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/leonardoalt/subscriptions",
    "organizations_url": "https://api.github.com/users/leonardoalt/orgs",
    "repos_url": "https://api.github.com/users/leonardoalt/repos",
    "events_url": "https://api.github.com/users/leonardoalt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/leonardoalt/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/13021/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/13021/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1126682792",
    "html_url": "https://github.com/ethereum/solidity/issues/13021#issuecomment-1126682792",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13021",
    "id": 1126682792,
    "node_id": "IC_kwDOAm_5kc5DJ9Co",
    "user": {
      "login": "leonardoalt",
      "id": 504195,
      "node_id": "MDQ6VXNlcjUwNDE5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/504195?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/leonardoalt",
      "html_url": "https://github.com/leonardoalt",
      "followers_url": "https://api.github.com/users/leonardoalt/followers",
      "following_url": "https://api.github.com/users/leonardoalt/following{/other_user}",
      "gists_url": "https://api.github.com/users/leonardoalt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/leonardoalt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leonardoalt/subscriptions",
      "organizations_url": "https://api.github.com/users/leonardoalt/orgs",
      "repos_url": "https://api.github.com/users/leonardoalt/repos",
      "events_url": "https://api.github.com/users/leonardoalt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/leonardoalt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-14T09:55:55Z",
    "updated_at": "2022-05-14T09:55:55Z",
    "author_association": "MEMBER",
    "body": "Popping an array of mappings is not allowed because you don't know which keys are dirty or not, so the deleting of the mapping does not actually happen.\r\nIf you have an array of mappings, write to it, delete the array, and read the mapping again, the information is still there.\r\nPlease see https://docs.soliditylang.org/en/v0.8.13/security-considerations.html#clearing-mappings.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1126682792/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
