{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/13590",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/13590/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/13590/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/13590/events",
  "html_url": "https://github.com/ethereum/solidity/issues/13590",
  "id": 1391656317,
  "node_id": "I_kwDOAm_5kc5S8v19",
  "number": 13590,
  "title": "Wrong behaviour achieved by example code - Voting example",
  "user": {
    "login": "lazaralex98",
    "id": 28998786,
    "node_id": "MDQ6VXNlcjI4OTk4Nzg2",
    "avatar_url": "https://avatars.githubusercontent.com/u/28998786?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/lazaralex98",
    "html_url": "https://github.com/lazaralex98",
    "followers_url": "https://api.github.com/users/lazaralex98/followers",
    "following_url": "https://api.github.com/users/lazaralex98/following{/other_user}",
    "gists_url": "https://api.github.com/users/lazaralex98/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/lazaralex98/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/lazaralex98/subscriptions",
    "organizations_url": "https://api.github.com/users/lazaralex98/orgs",
    "repos_url": "https://api.github.com/users/lazaralex98/repos",
    "events_url": "https://api.github.com/users/lazaralex98/events{/privacy}",
    "received_events_url": "https://api.github.com/users/lazaralex98/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-09-30T00:32:22Z",
  "updated_at": "2023-03-08T12:25:33Z",
  "closed_at": "2023-03-08T12:25:33Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Page\r\n\r\n[Solidity by Example - Voting](https://docs.soliditylang.org/en/latest/solidity-by-example.html#voting)\r\n\r\n## Abstract\r\n\r\nIn the example of the voting contract, the `delegate` method, at its very end, has this piece of code:\r\n\r\n```solidity\r\nif (delegate_.voted) {\r\n    // If the delegate already voted,\r\n    // directly add to the number of votes\r\n    proposals[delegate_.vote].voteCount += sender.weight;\r\n} else {\r\n    // If the delegate did not vote yet,\r\n    // add to her weight.\r\n    delegate_.weight += sender.weight;\r\n}\r\n```\r\n\r\nThe above code does indeed compile, but doesn't achieve the wanted behaviour. \r\n\r\nTo exemplify what I mean, imagine: a dev would build on top of the example to implement a 'revokeVote` method. Whenever the delegate revokes his votes he loses out on the weight that has been assigned to him by the voter when his vote was already cast.\r\n\r\nIt doesn't make sense to use an `if/else`. The delegate should be receiving the weight regardless, like this:\r\n\r\n```solidity\r\ndelegate_.weight += sender.weight;\r\nif (delegate_.voted) {\r\n    proposals[delegate_.vote].voteCount += sender.weight;\r\n}  \r\n```\r\n\r\n## Pull request\r\n\r\nI'm used to adding a PR after the issue, so I'll keep this empty for the moment and update later.",
  "closed_by": {
    "login": "nikola-matic",
    "id": 4415530,
    "node_id": "MDQ6VXNlcjQ0MTU1MzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4415530?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nikola-matic",
    "html_url": "https://github.com/nikola-matic",
    "followers_url": "https://api.github.com/users/nikola-matic/followers",
    "following_url": "https://api.github.com/users/nikola-matic/following{/other_user}",
    "gists_url": "https://api.github.com/users/nikola-matic/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nikola-matic/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nikola-matic/subscriptions",
    "organizations_url": "https://api.github.com/users/nikola-matic/orgs",
    "repos_url": "https://api.github.com/users/nikola-matic/repos",
    "events_url": "https://api.github.com/users/nikola-matic/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nikola-matic/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/13590/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/13590/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1460078895",
    "html_url": "https://github.com/ethereum/solidity/issues/13590#issuecomment-1460078895",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/13590",
    "id": 1460078895,
    "node_id": "IC_kwDOAm_5kc5XBwkv",
    "user": {
      "login": "nikola-matic",
      "id": 4415530,
      "node_id": "MDQ6VXNlcjQ0MTU1MzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4415530?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikola-matic",
      "html_url": "https://github.com/nikola-matic",
      "followers_url": "https://api.github.com/users/nikola-matic/followers",
      "following_url": "https://api.github.com/users/nikola-matic/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikola-matic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikola-matic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikola-matic/subscriptions",
      "organizations_url": "https://api.github.com/users/nikola-matic/orgs",
      "repos_url": "https://api.github.com/users/nikola-matic/repos",
      "events_url": "https://api.github.com/users/nikola-matic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikola-matic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-08T12:25:33Z",
    "updated_at": "2023-03-08T12:25:33Z",
    "author_association": "MEMBER",
    "body": "The behaviour is only wrong *if* a `revokeVote` method were to be implemented; however, it isn't, so the example in its current state is not wrong, at least from what I can see. I'll be closing this issue, since it's technically wrong, however, if you feel a `revokeVote` method should be implemented in the example, and thus the tail end of the `delegate` method be reworked, you can open a separate issue for this, and if you're so inclined, even open a PR yourself to address.\r\n\r\n If I was somehow wrong in my interpretation of the example, feel free to reply in this issue, since we can always re-open it. Cheers, and thanks for contributing.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1460078895/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
