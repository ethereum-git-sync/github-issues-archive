{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/12090",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/12090/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/12090/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/12090/events",
  "html_url": "https://github.com/ethereum/solidity/issues/12090",
  "id": 1016036011,
  "node_id": "I_kwDOAm_5kc48j3qr",
  "number": 12090,
  "title": "`Duplicate tag position` when compiling Yul code defining multiple functions with the same name",
  "user": {
    "login": "d-xo",
    "id": 6689924,
    "node_id": "MDQ6VXNlcjY2ODk5MjQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6689924?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/d-xo",
    "html_url": "https://github.com/d-xo",
    "followers_url": "https://api.github.com/users/d-xo/followers",
    "following_url": "https://api.github.com/users/d-xo/following{/other_user}",
    "gists_url": "https://api.github.com/users/d-xo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/d-xo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/d-xo/subscriptions",
    "organizations_url": "https://api.github.com/users/d-xo/orgs",
    "repos_url": "https://api.github.com/users/d-xo/repos",
    "events_url": "https://api.github.com/users/d-xo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/d-xo/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 249074435,
      "node_id": "MDU6TGFiZWwyNDkwNzQ0MzU=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/bug%20:bug:",
      "name": "bug :bug:",
      "color": "fc1313",
      "default": false,
      "description": ""
    },
    {
      "id": 838064207,
      "node_id": "MDU6TGFiZWw4MzgwNjQyMDc=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/annoys%20users%20:cry:",
      "name": "annoys users :cry:",
      "color": "ea2cab",
      "default": false,
      "description": ""
    },
    {
      "id": 2376134343,
      "node_id": "MDU6TGFiZWwyMzc2MTM0MzQz",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/should%20compile%20without%20error",
      "name": "should compile without error",
      "color": "c48f13",
      "default": false,
      "description": "Error is reported even though it shouldn't. Source is fine."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2021-10-05T08:28:27Z",
  "updated_at": "2021-10-25T15:50:30Z",
  "closed_at": "2021-10-25T15:50:30Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "\r\n\r\n## Description\r\n\r\nWhile updating dapptools to solc0.8.9 we noticed that the following yul program now produces a c++ exception when compiling with 0.8.9 (it was fine with 0.8.7).\r\n\r\n```\r\n> solc-0.8.9 --strict-assembly hi.yul\r\nWarning: Yul is still experimental. Please use the output with care.\r\n\r\n======= hi.yul (EVM) =======\r\n\r\nPretty printed source:\r\nobject \"object\" {\r\n    code {\r\n        calldatacopy(0, 0, 1024)\r\n        {\r\n            function z() -> x\r\n            { x := y() }\r\n            function y() -> x\r\n            { x := z() }\r\n        }\r\n        {\r\n            function z() -> x\r\n            { x := y() }\r\n            function y() -> x\r\n            { x := z() }\r\n        }\r\n    }\r\n}\r\n\r\nException while assembling: /solidity/libevmasm/Assembly.cpp(720): Throw in function const solidity::evmasm::LinkerObject& solidity::evmasm::Assembly::assemble() const\r\nDynamic exception type: boost::wrapexcept<solidity::evmasm::AssemblyException>\r\nstd::exception::what: Duplicate tag position.\r\n[solidity::util::tag_comment*] = Duplicate tag position.\r\n```\r\n\r\n## Environment\r\n\r\n- Compiler version: 0.8.9\r\n- Target EVM version (as per compiler settings): london\r\n- Framework/IDE (e.g. Truffle or Remix): none\r\n- EVM execution environment / backend / blockchain client: none\r\n- Operating system: linux\r\n",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/12090/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/12090/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/934212613",
    "html_url": "https://github.com/ethereum/solidity/issues/12090#issuecomment-934212613",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12090",
    "id": 934212613,
    "node_id": "IC_kwDOAm_5kc43rvQF",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-05T09:03:24Z",
    "updated_at": "2021-10-05T09:03:24Z",
    "author_association": "MEMBER",
    "body": "Thanks for reporting! My first hunch is that a workaround could be to rename the functions so that the names are unique, but of course, this should also compile as is.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/934212613/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/945192513",
    "html_url": "https://github.com/ethereum/solidity/issues/12090#issuecomment-945192513",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12090",
    "id": 945192513,
    "node_id": "IC_kwDOAm_5kc44Vn5B",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-17T20:50:23Z",
    "updated_at": "2021-10-17T20:55:12Z",
    "author_association": "MEMBER",
    "body": "I found a case that triggers an assertion at a different position in the same file on 0.8.9. Seems to be related to this issue - it's caused by Yul functions with the same name and different returns defined in different Solidity functions:\r\n\r\n`contract.sol`:\r\n``` solidity\r\ncontract C {\r\n    function f() external {\r\n        assembly {\r\n            function x(i) -> a {}\r\n        }\r\n    }\r\n    function g() external {\r\n        assembly {\r\n            function x(i) {}\r\n        }\r\n    }\r\n}\r\n```\r\n```bash\r\nsolc --bin --experimental-via-ir contract.sol\r\n```\r\n```\r\nException during compilation: /solidity/libevmasm/Assembly.cpp(350): Throw in function solidity::evmasm::AssemblyItem solidity::evmasm::Assembly::namedTag(const string&, size_t, size_t, std::optional<long unsigned int>)\r\nDynamic exception type: boost::wrapexcept<solidity::evmasm::AssemblyException>\r\nstd::exception::what:\r\n[solidity::util::tag_comment*] =\r\n```\r\n\r\nEDIT: The example above is actually inline assembly while this issue is about Yul but I think the cause might be the same and #12139 might be a fix too.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/945192513/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/945199327",
    "html_url": "https://github.com/ethereum/solidity/issues/12090#issuecomment-945199327",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12090",
    "id": 945199327,
    "node_id": "IC_kwDOAm_5kc44Vpjf",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-17T21:39:53Z",
    "updated_at": "2021-10-17T21:42:17Z",
    "author_association": "MEMBER",
    "body": "I decided to report this case as a separate issue after all (#12158) because maybe for inline assembly solution should be different (we don't necessarily have to disable named labels) and because it can't be triggered by only giving the functions the same name.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/945199327/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
