{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/11721",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/11721/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/11721/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/11721/events",
  "html_url": "https://github.com/ethereum/solidity/issues/11721",
  "id": 956559258,
  "node_id": "MDU6SXNzdWU5NTY1NTkyNTg=",
  "number": 11721,
  "title": "Allow unchecked increments of for loops indexes",
  "user": {
    "login": "The-3D",
    "id": 37953689,
    "node_id": "MDQ6VXNlcjM3OTUzNjg5",
    "avatar_url": "https://avatars.githubusercontent.com/u/37953689?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/The-3D",
    "html_url": "https://github.com/The-3D",
    "followers_url": "https://api.github.com/users/The-3D/followers",
    "following_url": "https://api.github.com/users/The-3D/following{/other_user}",
    "gists_url": "https://api.github.com/users/The-3D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/The-3D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/The-3D/subscriptions",
    "organizations_url": "https://api.github.com/users/The-3D/orgs",
    "repos_url": "https://api.github.com/users/The-3D/repos",
    "events_url": "https://api.github.com/users/The-3D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/The-3D/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-07-30T09:09:23Z",
  "updated_at": "2021-08-02T10:33:02Z",
  "closed_at": "2021-08-02T10:33:02Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Abstract\r\n\r\nAfter the (welcomed) introduction of the checked math operators in solidity 0.8.x, developers can allow safe unchecked operations by wrapping them in a `unchecked {}` block. Safety checks of course apply to pre and post increment/decrement operators (++/--) which are commonly used to increase indexes in for loops; unfortunately the safety checks in this case are enabled by default, and there is no way of disabling it in a developer friendly way. This may force to refactor the for loop in a while, or change the for increment in an unnatural way. Not doing it can get (very) expensive.\r\n\r\n## Motivation\r\n\r\nLoops are in most cases bounded by definition (the bounding is represented by the exit condition). Therefore in the vast majority of cases, checking for overflows is really not needed, and can get very gas expensive. Consider the following examples:\r\n\r\n```\r\npragma solidity ^0.8.0;\r\n\r\ncontract Test1 {\r\n    \r\n    \r\n    function loop() public pure {\r\n        \r\n        for(uint256 i = 0; i < 100; i++) {\r\n        }\r\n        \r\n    }\r\n}\r\n```\r\n```\r\npragma solidity ^0.8.0;\r\n\r\ncontract Test {\r\n    \r\n    \r\n    function loop() public pure {\r\n        \r\n        for(uint256 i = 0; i < 100;) {\r\n            \r\n            unchecked {\r\n                i++;\r\n            }\r\n        }\r\n        \r\n    }\r\n}\r\n```\r\n`loop()` in Test1 costs more than 31K gas, vs 25.5K gas for `loop()` in Test2\r\n\r\n## Specification\r\n\r\nallow to specify unchecked increments in for loops as follows\r\n\r\n`for(uint256 i = 0; i < 100; unchecked i++)`\r\n\r\n",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/11721/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/11721/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/890887740",
    "html_url": "https://github.com/ethereum/solidity/issues/11721#issuecomment-890887740",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11721",
    "id": 890887740,
    "node_id": "IC_kwDOAm_5kc41Gd48",
    "user": {
      "login": "hrkrshnn",
      "id": 13174375,
      "node_id": "MDQ6VXNlcjEzMTc0Mzc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/13174375?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hrkrshnn",
      "html_url": "https://github.com/hrkrshnn",
      "followers_url": "https://api.github.com/users/hrkrshnn/followers",
      "following_url": "https://api.github.com/users/hrkrshnn/following{/other_user}",
      "gists_url": "https://api.github.com/users/hrkrshnn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hrkrshnn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hrkrshnn/subscriptions",
      "organizations_url": "https://api.github.com/users/hrkrshnn/orgs",
      "repos_url": "https://api.github.com/users/hrkrshnn/repos",
      "events_url": "https://api.github.com/users/hrkrshnn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hrkrshnn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-02T09:49:01Z",
    "updated_at": "2021-08-02T09:49:01Z",
    "author_association": "MEMBER",
    "body": "This has been proposed and discussed in https://github.com/ethereum/solidity/issues/10698 and https://github.com/ethereum/solidity/issues/10695",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/890887740/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/890917517",
    "html_url": "https://github.com/ethereum/solidity/issues/11721#issuecomment-890917517",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11721",
    "id": 890917517,
    "node_id": "IC_kwDOAm_5kc41GlKN",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-02T10:33:02Z",
    "updated_at": "2021-08-02T10:33:02Z",
    "author_association": "MEMBER",
    "body": "The solution for now is to define a function `function uncheckedInc(uint x) pure returns (uint) { unchecked { return x + 1; } }` and use it as\r\n```\r\n for(uint256 i = 0; i < 100; i = uncheckedInc(i) {\r\n    ...\r\n  }\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/890917517/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
