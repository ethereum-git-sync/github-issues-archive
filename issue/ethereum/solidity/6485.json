{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/6485",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/6485/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/6485/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/6485/events",
  "html_url": "https://github.com/ethereum/solidity/issues/6485",
  "id": 429832973,
  "node_id": "MDU6SXNzdWU0Mjk4MzI5NzM=",
  "number": 6485,
  "title": "PC for JUMPDESTS of functions in compiler meta data",
  "user": {
    "login": "MrChico",
    "id": 8930559,
    "node_id": "MDQ6VXNlcjg5MzA1NTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8930559?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/MrChico",
    "html_url": "https://github.com/MrChico",
    "followers_url": "https://api.github.com/users/MrChico/followers",
    "following_url": "https://api.github.com/users/MrChico/following{/other_user}",
    "gists_url": "https://api.github.com/users/MrChico/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/MrChico/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/MrChico/subscriptions",
    "organizations_url": "https://api.github.com/users/MrChico/orgs",
    "repos_url": "https://api.github.com/users/MrChico/repos",
    "events_url": "https://api.github.com/users/MrChico/events{/privacy}",
    "received_events_url": "https://api.github.com/users/MrChico/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1017612679,
      "node_id": "MDU6TGFiZWwxMDE3NjEyNjc5",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/protocol%20design%20:crystal_ball:",
      "name": "protocol design :crystal_ball:",
      "color": "8af77e",
      "default": false,
      "description": "Potential changes to ABI, meta data, standard JSON"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2019-04-05T16:13:30Z",
  "updated_at": "2021-11-08T09:10:22Z",
  "closed_at": "2021-11-08T09:10:22Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "## Abstract\r\n\r\nFor symbolic analysis of solidity generated bytecode, it is often useful to be able to extract the program counter associated with a particular solidity function. I propose to add an optional field to the meta-data AST called `pc`, which for nodes associated with functions contains the JUMPDEST associated with that method.\r\n\r\n## Motivation\r\n\r\nCurrently, the only way to figure out the JUMPDEST associated with a particular solidity function is to reverse engineer it from the sourcemapping in the AST, which is cumbersome and error prone. Having pc counters associated with solidity methods would make formal analysis of solidity generated bytecode a lot easier.\r\n\r\n## Specification\r\n\r\nHere's the suggested node AST structure of the function.\r\n`  function add(uint x, uint y) internal pure returns (uint z) {`:\r\nThe new entry being the `pc` header.\r\n```\r\n              {\r\n                \"attributes\": {\r\n                  \"constant\": true,\r\n                  \"documentation\": null,\r\n                  \"implemented\": true,\r\n                  \"isConstructor\": false,\r\n                  \"modifiers\": [ null ],\r\n                  \"name\": \"add\",\r\n                  \"payable\": false,\r\n                  \"scope\": 40,\r\n                  \"stateMutability\": \"pure\",\r\n                  \"superFunction\": null,\r\n                  \"visibility\": \"internal\"\r\n                },\r\n                \"children\": [...],\r\n                \"id\": 39,\r\n                \"name\": \"FunctionDefinition\",\r\n                \"src\": \"153:101:0\",\r\n                \"pc\": 129\r\n              }\r\n```\r\n",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/6485/reactions",
    "total_count": 4,
    "+1": 4,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/6485/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/482238800",
    "html_url": "https://github.com/ethereum/solidity/issues/6485#issuecomment-482238800",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6485",
    "id": 482238800,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MjIzODgwMA==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-11T18:16:21Z",
    "updated_at": "2019-04-11T18:16:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "Not on the Solidity project, just commenting as someone else who might find this useful -- due to inheritance, there'd have to be a bit more to it, wouldn't there?  Like, a function in `Base` could have one PC in `Base` but a different PC in `Derived`, right?  If it just listed the PC in `Base`, that would be pretty incomplete information.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/482238800/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/483427560",
    "html_url": "https://github.com/ethereum/solidity/issues/6485#issuecomment-483427560",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6485",
    "id": 483427560,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MzQyNzU2MA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-15T21:34:02Z",
    "updated_at": "2019-04-15T21:34:02Z",
    "author_association": "MEMBER",
    "body": "I would defer such features until we have proper debugging metadata. I think adding the PC to the AST is not a good solution because the AST mostly concerns syntactical features. Furthermore, connecting the bytecode offset start to a function is a very delicate matter. The PC is only really determined at the very last stage in the compiler called the assembly stage. At this point, functions are fully erased from the data structures that the compiler deals with. Furthermore, more or less anything can happen to a function at these stages: Two functions could be combined, a function might even be split into two separate code pieces and of course it could be fully inlined to whereever it is used. On top of that, we have the added complications that due to inheritance and the fact that a function can be used both in creation and deployed context, it is not really clear which function we are referring to.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/483427560/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/621970387",
    "html_url": "https://github.com/ethereum/solidity/issues/6485#issuecomment-621970387",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6485",
    "id": 621970387,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMTk3MDM4Nw==",
    "user": {
      "login": "MrChico",
      "id": 8930559,
      "node_id": "MDQ6VXNlcjg5MzA1NTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8930559?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MrChico",
      "html_url": "https://github.com/MrChico",
      "followers_url": "https://api.github.com/users/MrChico/followers",
      "following_url": "https://api.github.com/users/MrChico/following{/other_user}",
      "gists_url": "https://api.github.com/users/MrChico/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MrChico/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MrChico/subscriptions",
      "organizations_url": "https://api.github.com/users/MrChico/orgs",
      "repos_url": "https://api.github.com/users/MrChico/repos",
      "events_url": "https://api.github.com/users/MrChico/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MrChico/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-30T16:45:09Z",
    "updated_at": "2020-04-30T16:45:27Z",
    "author_association": "MEMBER",
    "body": "@chriseth here is the issue for `PC` values for functionss and modifiers. If you think the AST is the wrong place for this, I'm open for other suggestions",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/621970387/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/621978068",
    "html_url": "https://github.com/ethereum/solidity/issues/6485#issuecomment-621978068",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6485",
    "id": 621978068,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMTk3ODA2OA==",
    "user": {
      "login": "MrChico",
      "id": 8930559,
      "node_id": "MDQ6VXNlcjg5MzA1NTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8930559?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MrChico",
      "html_url": "https://github.com/MrChico",
      "followers_url": "https://api.github.com/users/MrChico/followers",
      "following_url": "https://api.github.com/users/MrChico/following{/other_user}",
      "gists_url": "https://api.github.com/users/MrChico/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MrChico/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MrChico/subscriptions",
      "organizations_url": "https://api.github.com/users/MrChico/orgs",
      "repos_url": "https://api.github.com/users/MrChico/repos",
      "events_url": "https://api.github.com/users/MrChico/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MrChico/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-30T16:58:04Z",
    "updated_at": "2020-04-30T16:58:04Z",
    "author_association": "MEMBER",
    "body": "Specifically, it would be very helpful to get `PC` values for:\r\n- Functions, especially internal functions\r\n- Modifiers\r\n- Loop headers \r\n\r\nan additional thing I mentioned in the talk is to also get the (stack or memory) location or the arguments given to internal functions, but perhaps this is better to keep in a separate issue?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/621978068/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/848699216",
    "html_url": "https://github.com/ethereum/solidity/issues/6485#issuecomment-848699216",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6485",
    "id": 848699216,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0ODY5OTIxNg==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-26T11:42:25Z",
    "updated_at": "2021-05-26T11:42:25Z",
    "author_association": "MEMBER",
    "body": "@MrChico is https://github.com/ethereum/solidity/pull/8868 sufficient for your needs for now? I would prefer to close this issue and create new issues for further features.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/848699216/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/962949238",
    "html_url": "https://github.com/ethereum/solidity/issues/6485#issuecomment-962949238",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6485",
    "id": 962949238,
    "node_id": "IC_kwDOAm_5kc45ZXB2",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-08T09:10:22Z",
    "updated_at": "2021-11-08T09:10:22Z",
    "author_association": "MEMBER",
    "body": "The core of this issue has been implemented both in the old and the new code generator. Please create new issues for further information you need.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/962949238/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
