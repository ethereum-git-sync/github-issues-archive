{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/11412",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/11412/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/11412/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/11412/events",
  "html_url": "https://github.com/ethereum/solidity/issues/11412",
  "id": 894937373,
  "node_id": "MDU6SXNzdWU4OTQ5MzczNzM=",
  "number": 11412,
  "title": "Detect platform-dependent paths in default file loader (path spec v3)",
  "user": {
    "login": "cameel",
    "id": 137030,
    "node_id": "MDQ6VXNlcjEzNzAzMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cameel",
    "html_url": "https://github.com/cameel",
    "followers_url": "https://api.github.com/users/cameel/followers",
    "following_url": "https://api.github.com/users/cameel/following{/other_user}",
    "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
    "organizations_url": "https://api.github.com/users/cameel/orgs",
    "repos_url": "https://api.github.com/users/cameel/repos",
    "events_url": "https://api.github.com/users/cameel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cameel/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4438006499,
      "node_id": "LA_kwDOAm_5kc8AAAABCIaa4w",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/low%20effort",
      "name": "low effort",
      "color": "ffb1fa",
      "default": false,
      "description": "There is not much implementation work to be done. The task is very easy or tiny."
    },
    {
      "id": 4438157609,
      "node_id": "LA_kwDOAm_5kc8AAAABCIjpKQ",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/low%20impact",
      "name": "low impact",
      "color": "001dff",
      "default": false,
      "description": "Changes are not very noticeable or potential benefits are limited."
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-05-19T02:50:43Z",
  "updated_at": "2022-09-27T18:48:52Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Related to #6608 and https://github.com/nomiclabs/hardhat/issues/538.\r\nPart of a set of issues that replaces #11138.\r\n\r\n## Abstract\r\nCurrently the default file loader interprets the source unit names it receives as platform-dependent paths. For example on case-insensitive filesystems it resolves file names in a case-insensitive way and on Windows it recognizes backslashes as valid path separators. This may lead to users unwittingly creating contracts that compile only on their platform.\r\n\r\nThe file loader should prevent this by recognizing and reporting situations that may result in such problems.\r\n\r\n## Motivation\r\nHere's an example of an import that will result in completely different files being expected on different platforms if the default file loader is involved:\r\n```solidity\r\nimport \"C:\\\\project\\\\lib\\\\token.sol\"; // source unit name: C:\\project\\lib\\token.sol\r\n```\r\n\r\nOn Windows `C:` is seen as the root directory and backslashes as directory separators. On Linux it's all just one weird long file name.\r\n\r\n## Specification\r\nThe default file loader should report a problem when:\r\n- The canonical path of the file to be loaded matches the requested path only in a case-insensitive way.\r\n- The underlying system allows backslashes as directory separators and the requested path contains one or more such slashes.\r\n    - Or, better, when a source unit name contains backslashes at all.\r\n- The requested path does not start with a forward slash but despite this is recognized as an absolute path.\r\n- (Optional) The path contains characters known to be disallowed in paths on some platforms. E.g. `<` or `>` on Windows or `\\0` characters on Linux.\r\n\r\nIf any of these are detected, at least warn the user about consequences. We should also consider disallowing them completely. That's what Hardhat did already: https://github.com/nomiclabs/hardhat/issues/538#issuecomment-843170204.\r\n\r\nNote that this should be done at the file loader level. All of these are perfectly fine as long as they're only used in compiler's virtual filesystem. It's only when the actual filesystem is involved that they can cause problems.\r\n\r\n## Backwards Compatibility\r\nIt's only a warning so it's fully backwards-compatible. Making it an error would make the change backwards-incompatible for any contract that uses such platform-dependent paths.\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/11412/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/11412/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/844899612",
    "html_url": "https://github.com/ethereum/solidity/issues/11412#issuecomment-844899612",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11412",
    "id": 844899612,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NDg5OTYxMg==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-20T09:17:02Z",
    "updated_at": "2021-05-20T09:17:02Z",
    "author_association": "MEMBER",
    "body": "Maybe we should just disallow `\\\\` in import statements (or warn about them)?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/844899612/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/844900088",
    "html_url": "https://github.com/ethereum/solidity/issues/11412#issuecomment-844900088",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11412",
    "id": 844900088,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NDkwMDA4OA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-20T09:17:36Z",
    "updated_at": "2021-05-20T09:17:36Z",
    "author_association": "MEMBER",
    "body": "About the case, I'm not so sure, it could create problems with recompilation on a case-insensitive file system.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/844900088/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/848699786",
    "html_url": "https://github.com/ethereum/solidity/issues/11412#issuecomment-848699786",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11412",
    "id": 848699786,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0ODY5OTc4Ng==",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-26T11:43:24Z",
    "updated_at": "2021-05-26T11:43:24Z",
    "author_association": "MEMBER",
    "body": "> About the case, I'm not so sure, it could create problems with recompilation on a case-insensitive file system.\r\n\r\nAFAIK the most commonly used case-insensitive filesystems are at least [case-preserving](https://en.wikipedia.org/wiki/Case_preservation). So user would not get this warning just by checking out code in git. He would have to e.g. use one case to name the file and a different case in the import. And then wonder why the code does not compile on Linux.\r\n\r\nI think that the biggest argument for this is that frameworks already report this a a problem (e.g. Hardhat reports an error as mentioned in https://github.com/nomiclabs/hardhat/issues/538#issuecomment-843170204) and I can see how this might be good for reducing support requests from confused users.\r\n\r\n> Maybe we should just disallow `\\\\` in import statements (or warn about them)?\r\n\r\nThat sounds like a good idea. I'll add it to the description.\r\n\r\nNot sure whether to disallow or just warn. Personally I'd rather ban all of these but the downside is that the change becomes breaking. Maybe we could discuss it on the call.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/848699786/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/849739767",
    "html_url": "https://github.com/ethereum/solidity/issues/11412#issuecomment-849739767",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/11412",
    "id": 849739767,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0OTczOTc2Nw==",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-27T15:43:01Z",
    "updated_at": "2021-05-27T15:43:01Z",
    "author_association": "MEMBER",
    "body": "We decided to put off work on this for now. We want to deal with #11408, #11409 and #11410 first and go back to this once that's done and working.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/849739767/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
