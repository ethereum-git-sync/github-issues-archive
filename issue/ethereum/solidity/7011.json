{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/7011",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/7011/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/7011/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/7011/events",
  "html_url": "https://github.com/ethereum/solidity/issues/7011",
  "id": 461118112,
  "node_id": "MDU6SXNzdWU0NjExMTgxMTI=",
  "number": 7011,
  "title": "SMTChecker throws InternalCompilerError",
  "user": {
    "login": "elenadimitrova",
    "id": 703848,
    "node_id": "MDQ6VXNlcjcwMzg0OA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/703848?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/elenadimitrova",
    "html_url": "https://github.com/elenadimitrova",
    "followers_url": "https://api.github.com/users/elenadimitrova/followers",
    "following_url": "https://api.github.com/users/elenadimitrova/following{/other_user}",
    "gists_url": "https://api.github.com/users/elenadimitrova/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/elenadimitrova/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/elenadimitrova/subscriptions",
    "organizations_url": "https://api.github.com/users/elenadimitrova/orgs",
    "repos_url": "https://api.github.com/users/elenadimitrova/repos",
    "events_url": "https://api.github.com/users/elenadimitrova/events{/privacy}",
    "received_events_url": "https://api.github.com/users/elenadimitrova/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 249074435,
      "node_id": "MDU6TGFiZWwyNDkwNzQ0MzU=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/bug%20:bug:",
      "name": "bug :bug:",
      "color": "fc1313",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2019-06-26T18:27:32Z",
  "updated_at": "2019-08-12T12:34:18Z",
  "closed_at": "2019-08-12T12:34:18Z",
  "author_association": "COLLABORATOR",
  "active_lock_reason": null,
  "body": "## Description\r\n`InternalCompilerError` on SMTChecker compilation of Colony contracts from https://github.com/JoinColony/colonyNetwork/contracts\r\n\r\nA couple of examples below\r\n\r\n```\r\n$ solc ./contracts/ColonyTask.sol --allow-paths lib/dappsys/*.sol\r\nInternal compiler error during compilation:\r\n/Users/Elena/Source/solidity/libsolidity/formal/SMTChecker.cpp(1622): Throw in function smt::Expression dev::solidity::SMTChecker::currentValue(const dev::solidity::VariableDeclaration &)\r\nDynamic exception type: boost::wrapexcept<langutil::InternalCompilerError>\r\nstd::exception::what:\r\n[dev::tag_comment*] =\r\n```\r\n\r\n```\r\n$ solc ./contracts/ColonyNetworkAuction.sol --allow-paths lib/dappsys/*.sol\r\nInternal compiler error during compilation:\r\n/Users/Elena/Source/solidity/libsolidity/formal/SMTChecker.cpp(1622): Throw in function smt::Expression dev::solidity::SMTChecker::currentValue(const dev::solidity::VariableDeclaration &)\r\nDynamic exception type: boost::wrapexcept<langutil::InternalCompilerError>\r\nstd::exception::what:\r\n[dev::tag_comment*] =\r\n```\r\n\r\nAnd a successful run with a contract that has no imports:\r\n```\r\n$ solc ./contracts/ColonyNetworkDataTypes.sol --allow-paths lib/dappsys/*.sol\r\nCompiler run successful, no output requested.\r\n```\r\n\r\n## Environment\r\n\r\n- Compiler version: 0.5.8\r\n- Target EVM version (as per compiler settings): (default)\r\n- Framework/IDE (e.g. Truffle or Remix): `truffle compile` also errors, originally logged this issue with them https://github.com/trufflesuite/truffle/issues/2132 but upon further analysis it's coming from the compiler.\r\n- EVM execution environment / backend / blockchain client:\r\n- Operating system: OSX\r\n\r\n## Steps to Reproduce\r\n\r\nI am keeping a log of the steps taken so far to enable the SMTChecker on the Colony contracts here https://github.com/JoinColony/colonyNetwork/issues/547",
  "closed_by": {
    "login": "leonardoalt",
    "id": 504195,
    "node_id": "MDQ6VXNlcjUwNDE5NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/504195?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/leonardoalt",
    "html_url": "https://github.com/leonardoalt",
    "followers_url": "https://api.github.com/users/leonardoalt/followers",
    "following_url": "https://api.github.com/users/leonardoalt/following{/other_user}",
    "gists_url": "https://api.github.com/users/leonardoalt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/leonardoalt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/leonardoalt/subscriptions",
    "organizations_url": "https://api.github.com/users/leonardoalt/orgs",
    "repos_url": "https://api.github.com/users/leonardoalt/repos",
    "events_url": "https://api.github.com/users/leonardoalt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/leonardoalt/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/7011/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/7011/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/506267612",
    "html_url": "https://github.com/ethereum/solidity/issues/7011#issuecomment-506267612",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7011",
    "id": 506267612,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjI2NzYxMg==",
    "user": {
      "login": "leonardoalt",
      "id": 504195,
      "node_id": "MDQ6VXNlcjUwNDE5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/504195?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/leonardoalt",
      "html_url": "https://github.com/leonardoalt",
      "followers_url": "https://api.github.com/users/leonardoalt/followers",
      "following_url": "https://api.github.com/users/leonardoalt/following{/other_user}",
      "gists_url": "https://api.github.com/users/leonardoalt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/leonardoalt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leonardoalt/subscriptions",
      "organizations_url": "https://api.github.com/users/leonardoalt/orgs",
      "repos_url": "https://api.github.com/users/leonardoalt/repos",
      "events_url": "https://api.github.com/users/leonardoalt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/leonardoalt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-27T09:22:16Z",
    "updated_at": "2019-06-27T09:22:45Z",
    "author_association": "MEMBER",
    "body": "Hi @elenadimitrova , thanks for reporting. It's nice to know that more projects are trying out the SMTChecker.\r\nI ran your example and actually got a different error, I'll need to debug a bit more.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/506267612/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/516841484",
    "html_url": "https://github.com/ethereum/solidity/issues/7011#issuecomment-516841484",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7011",
    "id": 516841484,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNjg0MTQ4NA==",
    "user": {
      "login": "leonardoalt",
      "id": 504195,
      "node_id": "MDQ6VXNlcjUwNDE5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/504195?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/leonardoalt",
      "html_url": "https://github.com/leonardoalt",
      "followers_url": "https://api.github.com/users/leonardoalt/followers",
      "following_url": "https://api.github.com/users/leonardoalt/following{/other_user}",
      "gists_url": "https://api.github.com/users/leonardoalt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/leonardoalt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leonardoalt/subscriptions",
      "organizations_url": "https://api.github.com/users/leonardoalt/orgs",
      "repos_url": "https://api.github.com/users/leonardoalt/repos",
      "events_url": "https://api.github.com/users/leonardoalt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/leonardoalt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-07-31T13:09:11Z",
    "updated_at": "2019-07-31T13:09:11Z",
    "author_association": "MEMBER",
    "body": "Simplified code that triggers the bug, two files:\r\n```\r\n// one.sol\r\nlibrary L {\r\n\tuint constant one = 1;\r\n\tfunction f() internal pure returns (uint) {\r\n\t\treturn one;\r\n\t}\r\n}\r\n```\r\n\r\n```\r\npragma experimental SMTChecker;\r\n\r\nimport 'one.sol';\r\n\r\ncontract C {\r\n\tfunction g(uint x) public pure {\r\n\t\tuint y = L.f();\r\n\t\tassert(x > y);\r\n\t}\r\n}\r\n```\r\n\r\nThe cause of the bug is that state variables in imported code are not handled properly. If the library and the contract are in the same file it works fine.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/516841484/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/517719256",
    "html_url": "https://github.com/ethereum/solidity/issues/7011#issuecomment-517719256",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7011",
    "id": 517719256,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzcxOTI1Ng==",
    "user": {
      "login": "leonardoalt",
      "id": 504195,
      "node_id": "MDQ6VXNlcjUwNDE5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/504195?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/leonardoalt",
      "html_url": "https://github.com/leonardoalt",
      "followers_url": "https://api.github.com/users/leonardoalt/followers",
      "following_url": "https://api.github.com/users/leonardoalt/following{/other_user}",
      "gists_url": "https://api.github.com/users/leonardoalt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/leonardoalt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leonardoalt/subscriptions",
      "organizations_url": "https://api.github.com/users/leonardoalt/orgs",
      "repos_url": "https://api.github.com/users/leonardoalt/repos",
      "events_url": "https://api.github.com/users/leonardoalt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/leonardoalt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-02T14:21:48Z",
    "updated_at": "2019-08-12T12:33:30Z",
    "author_association": "MEMBER",
    "body": "I've found multiple bugs in the SMTChecker while fixing this one. Will create separate issues/PRs for each one.\r\n\r\n- [x] State vars from another source https://github.com/ethereum/solidity/issues/7162\r\n- [x] Unsupported compound assignment inside branch breaks SSA https://github.com/ethereum/solidity/issues/7163\r\n- [x] Unsupported type as element of returned tuple https://github.com/ethereum/solidity/issues/7164\r\n- [x] StringLiteral type mismatch https://github.com/ethereum/solidity/issues/7165\r\n- [x] Scanner from different source causes ICE when retrieving models https://github.com/ethereum/solidity/issues/7168",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/517719256/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/520406320",
    "html_url": "https://github.com/ethereum/solidity/issues/7011#issuecomment-520406320",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7011",
    "id": 520406320,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMDQwNjMyMA==",
    "user": {
      "login": "leonardoalt",
      "id": 504195,
      "node_id": "MDQ6VXNlcjUwNDE5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/504195?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/leonardoalt",
      "html_url": "https://github.com/leonardoalt",
      "followers_url": "https://api.github.com/users/leonardoalt/followers",
      "following_url": "https://api.github.com/users/leonardoalt/following{/other_user}",
      "gists_url": "https://api.github.com/users/leonardoalt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/leonardoalt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leonardoalt/subscriptions",
      "organizations_url": "https://api.github.com/users/leonardoalt/orgs",
      "repos_url": "https://api.github.com/users/leonardoalt/repos",
      "events_url": "https://api.github.com/users/leonardoalt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/leonardoalt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-12T12:34:18Z",
    "updated_at": "2019-08-12T12:34:18Z",
    "author_association": "MEMBER",
    "body": "After all the bugs above were fixed I ran\r\n`solc ./contracts/ColonyTask.sol --allow-paths lib/dappsys/*.sol`\r\nand didn't see any more bugs, so closing this one.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/520406320/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
