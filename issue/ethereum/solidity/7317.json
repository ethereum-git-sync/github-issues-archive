{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/7317",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/7317/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/7317/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/7317/events",
  "html_url": "https://github.com/ethereum/solidity/issues/7317",
  "id": 486505915,
  "node_id": "MDU6SXNzdWU0ODY1MDU5MTU=",
  "number": 7317,
  "title": "\"require\" helper in assembly",
  "user": {
    "login": "axic",
    "id": 20340,
    "node_id": "MDQ6VXNlcjIwMzQw",
    "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/axic",
    "html_url": "https://github.com/axic",
    "followers_url": "https://api.github.com/users/axic/followers",
    "following_url": "https://api.github.com/users/axic/following{/other_user}",
    "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
    "organizations_url": "https://api.github.com/users/axic/orgs",
    "repos_url": "https://api.github.com/users/axic/repos",
    "events_url": "https://api.github.com/users/axic/events{/privacy}",
    "received_events_url": "https://api.github.com/users/axic/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 9,
  "created_at": "2019-08-28T17:14:13Z",
  "updated_at": "2020-04-06T14:28:09Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "It would be nice to start introducing helper functions in assembly. This was previously discussed in #474 and #1319.\r\n\r\nA lot of contracts/libraries deal with calling precompiles directly to avoid cost overheads. They do this with `if iszero(staticcall(..)) { revert(0, 0) }`. It would be nice to support `require` and/or `assert`:\r\n- `require(expr)` -> `if iszero(expr) { revert(0, 0) }`\r\n- `assert(expr)` -> `if iszero(expr) { invalid }`\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/7317/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/7317/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/527405700",
    "html_url": "https://github.com/ethereum/solidity/issues/7317#issuecomment-527405700",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7317",
    "id": 527405700,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNzQwNTcwMA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-03T10:44:28Z",
    "updated_at": "2019-09-03T10:44:28Z",
    "author_association": "MEMBER",
    "body": "Same argument I always give: Hidden library functions are hard to debug or verify. It would be much better to support importing assembly functions by source. Then it is easier to check what actually happens.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/527405700/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/527418021",
    "html_url": "https://github.com/ethereum/solidity/issues/7317#issuecomment-527418021",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7317",
    "id": 527418021,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNzQxODAyMQ==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-03T11:26:18Z",
    "updated_at": "2019-09-03T11:26:18Z",
    "author_association": "MEMBER",
    "body": "I actually think ``require`` and ``assert`` might be an exception here, though, and it might be beneficial to have them as primitive - that way we or someone could implement something like the SMTChecker for Yul that just uses them as assumptions and verification targets (ping @leonardoalt), right? We would translate require to require and assert to assert and change our reverts on a case-by-case basis, e.g. ABI decoding reverts would be require...",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/527418021/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/527418304",
    "html_url": "https://github.com/ethereum/solidity/issues/7317#issuecomment-527418304",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7317",
    "id": 527418304,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNzQxODMwNA==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-03T11:27:12Z",
    "updated_at": "2019-09-03T11:27:12Z",
    "author_association": "MEMBER",
    "body": "So for these particular two it might actually make verifying *easier*, if we add them...",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/527418304/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/527424560",
    "html_url": "https://github.com/ethereum/solidity/issues/7317#issuecomment-527424560",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7317",
    "id": 527424560,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNzQyNDU2MA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-03T11:49:00Z",
    "updated_at": "2019-09-03T11:49:00Z",
    "author_association": "MEMBER",
    "body": "I don't see the difference to checking whether `invalid` is reachable or not.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/527424560/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/527425335",
    "html_url": "https://github.com/ethereum/solidity/issues/7317#issuecomment-527425335",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7317",
    "id": 527425335,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNzQyNTMzNQ==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-03T11:51:34Z",
    "updated_at": "2019-09-03T11:51:34Z",
    "author_association": "MEMBER",
    "body": "As verification target maybe, yes, but for assumptions?\r\nI'm not sure ``revert`` is used only in places where it's conceptually a ``require``...",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/527425335/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/527427080",
    "html_url": "https://github.com/ethereum/solidity/issues/7317#issuecomment-527427080",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7317",
    "id": 527427080,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNzQyNzA4MA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-03T11:57:47Z",
    "updated_at": "2019-09-03T11:57:47Z",
    "author_association": "MEMBER",
    "body": "The (one?) purpose of require/assert is that you can do bytecode-level verification.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/527427080/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/608339115",
    "html_url": "https://github.com/ethereum/solidity/issues/7317#issuecomment-608339115",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7317",
    "id": 608339115,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwODMzOTExNQ==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-03T09:41:25Z",
    "updated_at": "2020-04-03T09:41:25Z",
    "author_association": "MEMBER",
    "body": "@MicahZoltu brought this up in the chat again and there is actually another good argument for having this for requires with message.\r\n\r\nThe argument so far was that one can always just define a function, but for reverts with reason this becomes a problem. Say we define\r\n```\r\nfunction require(condition, message, length) {\r\n  if iszero(condition) {\r\n    mstore(0, <sig>)\r\n    mstore(4, 0x20)\r\n    mstore(0x24, length)\r\n    mstore(0x44, message)\r\n    revert(0, add(0x44, length))\r\n  }\r\n}\r\n```\r\nAnd then use it several times, the optimizer likely won't inline this. This results in the message being pushed on the stack needlessly when the condition is true.\r\n\r\nSince we need builtins with mixed \"required literal\" and arbitrary arguments anyways for the immutables, this might be quite a good reason to introduce a ``require`` builtin...\r\nSo far I suggested to just use ``if condition { revertWithReason(\"msg\", 3) }`` with a custom defined function ``revertWithReason``, but that's (1) less readable and (2) inconvenient and error prone in that it requires the length to be explicitly stated.\r\nA builtin ``require(condition, <requiredLiteralReasonString>)`` would solve those problems and could potentially conveniently allow reason strings longer than 32-bytes transparently.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/608339115/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/609823051",
    "html_url": "https://github.com/ethereum/solidity/issues/7317#issuecomment-609823051",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7317",
    "id": 609823051,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwOTgyMzA1MQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-06T14:17:32Z",
    "updated_at": "2020-04-06T14:17:32Z",
    "author_association": "MEMBER",
    "body": "I don't think we should introduce a builtin function only to save 3 gas.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/609823051/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/609829218",
    "html_url": "https://github.com/ethereum/solidity/issues/7317#issuecomment-609829218",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/7317",
    "id": 609829218,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwOTgyOTIxOA==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-06T14:28:09Z",
    "updated_at": "2020-04-06T14:28:09Z",
    "author_association": "MEMBER",
    "body": "Hm, true - for some reason I was thinking about the data gas being expensive, but that's paid either way...\r\nBut there's still the difference between jumping to the function and back or not, since if it isn't inlined the condition is only checked after the call, not inside... but that actually sounds much more like something we could fine-tune the optimizer for...",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/609829218/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
