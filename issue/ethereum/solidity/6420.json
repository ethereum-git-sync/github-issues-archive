{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/6420/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/6420/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/6420/events",
  "html_url": "https://github.com/ethereum/solidity/issues/6420",
  "id": 427416945,
  "node_id": "MDU6SXNzdWU0Mjc0MTY5NDU=",
  "number": 6420,
  "title": "ABIEncoderV2: wrong function signature in libraries",
  "user": {
    "login": "Alirun",
    "id": 3462173,
    "node_id": "MDQ6VXNlcjM0NjIxNzM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3462173?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Alirun",
    "html_url": "https://github.com/Alirun",
    "followers_url": "https://api.github.com/users/Alirun/followers",
    "following_url": "https://api.github.com/users/Alirun/following{/other_user}",
    "gists_url": "https://api.github.com/users/Alirun/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Alirun/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Alirun/subscriptions",
    "organizations_url": "https://api.github.com/users/Alirun/orgs",
    "repos_url": "https://api.github.com/users/Alirun/repos",
    "events_url": "https://api.github.com/users/Alirun/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Alirun/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 18,
  "created_at": "2019-03-31T16:47:00Z",
  "updated_at": "2019-11-26T12:57:52Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nFunction signatures in libraries public functions with structs in arguments are calculated in wrong way.\r\n\r\nProbably somehow related to #6001 , which seems to be fixed already.\r\nAnd also probably somehow related to #3400 , but author didn't provided enough information to finally solve this issue and it was closed.\r\n\r\n## Steps to Reproduce\r\nIf you write a code in this way\r\n\r\n```\r\npragma solidity ^0.5.4;\r\npragma experimental ABIEncoderV2;\r\n\r\nlibrary LibStructTest {\r\n    struct CoolStruct {\r\n        uint256 coolValue;\r\n    }\r\n\r\n    function getHash(CoolStruct memory self) public pure returns (bytes32 hash) {\r\n        hash = keccak256(abi.encodePacked(\r\n            self.coolValue\r\n        ));\r\n    }\r\n}\r\n```\r\nYou expect `getHash` function to have signature\r\n`keccak256(\"getHash((uint256))\") // 0xe1c67ed8`\r\nBut we get\r\n`keccak256(\"getHash(LibStructTest.CoolStruct)\") // 0x54d08d7a`\r\n\r\nThen if you change the code and add one more parameter to struct this way\r\n```\r\npragma solidity ^0.5.4;\r\npragma experimental ABIEncoderV2;\r\n\r\nlibrary LibStructTest {\r\n    struct CoolStruct {\r\n        uint256 coolValue;\r\n        uint256 otherCoolValue;\r\n    }\r\n\r\n    function getHash(CoolStruct memory self) public pure returns (bytes32 hash) {\r\n        hash = keccak256(abi.encodePacked(\r\n            self.coolValue\r\n        ));\r\n    }\r\n}\r\n```\r\nYou expect `getHash` function to have signature\r\n`keccak256(\"getHash((uint256,uint256))\") // 0x31183ed7`\r\nBut we still get\r\n`keccak256(\"getHash(LibStructTest.CoolStruct)\") // 0x54d08d7a`\r\n\r\n<!--Please shortly describe the bug you have found, and what you expect instead.-->\r\n\r\n## Environment\r\n\r\n- Compiler version: 0.5.7\r\n- Framework/IDE (e.g. Truffle or Remix): both\r\n- Operating system: All of them\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/6420/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/6420/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/478481370",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-478481370",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 478481370,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3ODQ4MTM3MA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-01T08:16:49Z",
    "updated_at": "2019-04-01T08:16:49Z",
    "author_association": "MEMBER",
    "body": "As libraries are (or at least were) an internal construct of Solidity, their functions are not meant to be called \"from outside\". This allowed us to introduce the concept of (especially storage) structs much earlier than for contract functions and just chose an internal representation for computing the function signature.\r\n\r\nFor pure functions, it does make sense to call library functions, so we might change the behaviour in the future. The problem is that this will be a serious breaking change and any contract linking to such a library function will silently fail.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/478481370/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/478481533",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-478481533",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 478481533,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3ODQ4MTUzMw==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-01T08:17:18Z",
    "updated_at": "2019-04-01T08:17:18Z",
    "author_association": "MEMBER",
    "body": "One option to allow this in a backwards-compatible manner is to allow both signatures (old style and new style) to lead to the same function.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/478481533/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/478482528",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-478482528",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 478482528,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3ODQ4MjUyOA==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-01T08:20:17Z",
    "updated_at": "2019-04-01T08:20:17Z",
    "author_association": "MEMBER",
    "body": "Allowing both signatures for now sounds reasonable, yes.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/478482528/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/542557208",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-542557208",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 542557208,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0MjU1NzIwOA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-16T07:11:44Z",
    "updated_at": "2019-10-16T07:11:44Z",
    "author_association": "MEMBER",
    "body": "Adding it to the scope of 0.6.0 since this has come up a lot lately.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/542557208/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/543408928",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-543408928",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 543408928,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0MzQwODkyOA==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-17T23:36:16Z",
    "updated_at": "2019-10-17T23:37:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "Some notes on this, since I've been thinking about this lately: (some of these should possibly be separate issues but oh well)\r\n\r\n1. Of course, there are `pure` and `view` functions that are excluded from the ABI, namely, those that take or return storage pointers.  I notice that at the moment, despite being excluded from the ABI, these functions still lack the `DELEGATECALL` guard.  Maybe they should get it, and only those functions that actually go in the ABI should not have it?\r\n\r\n2. Similarly, functions that take or return storage pointers should probably be excluded from getting new-style selectors (to the extent that's even meaningful in this case!) even if they're `pure` or `view`.  Well, OK, I guess that's obvious since they *can't* really get new-style selectors, but...\r\n\r\n3. Thought: Once new-style selectors are implemented for `pure` and `view` functions (that don't take or return storage pointers), you could allow storing such functions in `function external` variables!  Currently storing library functions in such variables is illegal, and for good reason, but once they have new-style selectors there no longer seems to be any reason to exclude them.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/543408928/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/553476677",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-553476677",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 553476677,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1MzQ3NjY3Nw==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-13T16:20:22Z",
    "updated_at": "2019-11-13T16:20:22Z",
    "author_association": "MEMBER",
    "body": "After some discussion we are actually hesitant to implement this for 0.6.0.\r\nAmong the open questions: if we use allow both old and new signatures, which one would we use when compiling new library calls? If we use the new ones, we break all calls to existing pre-0.6.0-libraries - if we use the old one, the new ones are kind of useless...\r\n\r\nSo far our plan is to first document how library signatures are computed right now and allow accessing the signatures using member accesses to the library functions just like for regular external contract functions - both of which would at least clarify the current situation.\r\n\r\nFor actually moving to a new kind of selectors we're open to suggestions on how to properly solve the backwards- and forwards-compatibility issues.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/553476677/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/553630932",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-553630932",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 553630932,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1MzYzMDkzMg==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-13T22:19:21Z",
    "updated_at": "2019-11-13T22:19:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "> After some discussion we are actually hesitant to implement this for 0.6.0.\r\nAmong the open questions: if we use allow both old and new signatures, which one would we use when compiling new library calls? If we use the new ones, we break all calls to existing pre-0.6.0-libraries - if we use the old one, the new ones are kind of useless...\r\n\r\nI thought the idea was to always use the old one when compiling library calls, and the point of the new one would be to allow calls from outside Solidity, based on the ABI JSON, using something like Truffle or `web3.eth.Contract`, to work properly?\r\n\r\nThe alternative, I suppose, is what's been discussed elsewhere -- adding a `selector` or `signature` field to the ABI JSON.  Then people wouldn't need to compute it since they could just read it out of the JSON.  I suppose that's a lot simpler than making two styles of selector work!\r\n\r\n> So far our plan is to first document how library signatures are computed right now and allow accessing the signatures using member accesses to the library functions just like for regular external contract functions - both of which would at least clarify the current situation.\r\n\r\nOoh, that's nice.  This raises a question though about typing.  Currently, `Lib.f` is of internal type, even if `f` was declared `external`.  Does this mean it's now going to be possible for it to be treated as external instead in some contexts?  Hard to take a selector otherwise, right?\r\n\r\nBut also if so... does that mean if `f` is a `view` or `pure` function -- where we might want to possibly make the additional restriction that `f` must have no `storage` parameters, either input or output -- it might now be possible to store it in a `function external` variable?  Because currently that isn't possible.  (Allowing this for more general functions probably doesn't make sense, but for those ones you could do it.)\r\n\r\n> For actually moving to a new kind of selectors we're open to suggestions on how to properly solve the backwards- and forwards-compatibility issues.\r\n\r\nWell, my suggestion (or rather pair of suggestions, either of which work) is above. :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/553630932/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/553820985",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-553820985",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 553820985,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1MzgyMDk4NQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-14T10:16:37Z",
    "updated_at": "2019-11-14T10:16:37Z",
    "author_association": "MEMBER",
    "body": "@haltman-at the feature of libraries was originally meant to use delegatecall only. At some point, people wanted functions to be inlined, so we allowed internal library functions to be inlined. I'm really not sure we should extend the use of libraries for non-delegatecall any more, because for that purpose, you can also just use contracts.\r\n\r\nMaybe we could have a call where we can talk more about the use-cases?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/553820985/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554290138",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-554290138",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 554290138,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDI5MDEzOA==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-15T09:46:43Z",
    "updated_at": "2019-11-15T09:46:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "Honestly, I just wanted to see about making things consistent!  It's just a little confusing when there are these hidden limitations and exceptions.  I'll admit I didn't have a real use case in mind.\r\n\r\nAlthough -- and at this point I'm repeating what I said above, but -- I think there's one way in which you should probably *restrict* it a bit more, in that I noticed there's no delegatecall guard on library functions which are `view` or `pure` but have storage parameters in the input or output.  You're clearly doing something to distinguish such functions as they're excluded from the ABI; maybe it would make sense to add a delegatecall guard to them as well?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554290138/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554301551",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-554301551",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 554301551,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDMwMTU1MQ==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-15T10:18:01Z",
    "updated_at": "2019-11-15T10:18:01Z",
    "author_association": "MEMBER",
    "body": "@haltman-at The current draft for addressing this, respectively at least documenting what's currently happening is here https://github.com/ethereum/solidity/pull/7719 (there may be a lot of room for improvements in the documentation part).\r\n\r\nIn fact I don't think anything is actually \"excluded from the ABI\" - rather its not really an \"ABI\", but rather an internal calling convention that works differently from the regular ABI.\r\n\r\nI'll have a look into the ``delegatecall`` guards. For ``pure`` functions it should be fine *not* having them, because while they can receive storage pointers, they won't be able to actually read from (let alone write to) them - That may sound weird, but think:\r\n```\r\nlibrary L {\r\n    function decideWhichStoragePointerToUse(uint256[] storage a, uint256[] storage b, ComplexStruct memory s) public pure returns(uint256[] storage) {\r\n        if (someFancyProperty(s))\r\n            return a;\r\n        else\r\n            return b;\r\n    }\r\n}\r\n```\r\nNo need for a ``delegatecall`` guard in that one and it's in fact perfectly ``pure`` - it just passes offsets to/slots in storage around, but doesn't actually care about storage itself.\r\n\r\nFor ``view``, though, things may be different, though - I'll look into that.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554301551/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554304926",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-554304926",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 554304926,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDMwNDkyNg==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-15T10:27:59Z",
    "updated_at": "2019-11-15T10:27:59Z",
    "author_association": "MEMBER",
    "body": "Ah, ok - you meant excluded from the json ABI, right...",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554304926/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554305581",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-554305581",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 554305581,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDMwNTU4MQ==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-15T10:29:48Z",
    "updated_at": "2019-11-15T10:29:48Z",
    "author_association": "MEMBER",
    "body": "I'll add some documentation about what goes into the json ABI and why to #7719 - and I'll check for consistency along the way.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554305581/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554324644",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-554324644",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 554324644,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDMyNDY0NA==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-15T11:27:31Z",
    "updated_at": "2019-11-15T11:27:31Z",
    "author_association": "MEMBER",
    "body": "@haltman-at You're right - view library functions *should* have a delegatecall guard- at least if they do in fact read from storage, but currently they don't.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554324644/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554326007",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-554326007",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 554326007,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDMyNjAwNw==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-15T11:32:08Z",
    "updated_at": "2019-11-15T11:32:08Z",
    "author_association": "MEMBER",
    "body": "Is there a case for a view library function, in which it actually makes sense to call it without delegatecall, but in which it couldn't just as well be declared pure?\r\n\r\nI wonder whether all view library functions should get the guard - and only pure library functions don't...\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554326007/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554333153",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-554333153",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 554333153,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDMzMzE1Mw==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-15T11:59:24Z",
    "updated_at": "2019-11-15T11:59:24Z",
    "author_association": "MEMBER",
    "body": "There is a case - the view library function could staticcall other contracts - that's fine, since it doesn't read from its own storage, but it's not ``pure``...",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554333153/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554336341",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-554336341",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 554336341,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDMzNjM0MQ==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-15T12:11:29Z",
    "updated_at": "2019-11-15T12:11:29Z",
    "author_association": "MEMBER",
    "body": "Yeah ok - I agree - we should put in the delegatecall guard for view functions that have storage pointers in the signature.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554336341/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554353352",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-554353352",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 554353352,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDM1MzM1Mg==",
    "user": {
      "login": "ekpyron",
      "id": 1347491,
      "node_id": "MDQ6VXNlcjEzNDc0OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1347491?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ekpyron",
      "html_url": "https://github.com/ekpyron",
      "followers_url": "https://api.github.com/users/ekpyron/followers",
      "following_url": "https://api.github.com/users/ekpyron/following{/other_user}",
      "gists_url": "https://api.github.com/users/ekpyron/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ekpyron/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ekpyron/subscriptions",
      "organizations_url": "https://api.github.com/users/ekpyron/orgs",
      "repos_url": "https://api.github.com/users/ekpyron/repos",
      "events_url": "https://api.github.com/users/ekpyron/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ekpyron/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-15T13:11:49Z",
    "updated_at": "2019-11-15T13:11:49Z",
    "author_association": "MEMBER",
    "body": "This is kind of tricky to get *exactly* right... Consider calling ``L.f`` without ``delegatecall`` in the following:\r\n\r\nThis is fine:\r\n```\r\nlibrary L {\r\n    function f(uint256[] storage a, uint256[] storage b, bool c) external pure returns (uint256[] storage)\r\n    {\r\n        return c ? a : b;\r\n    }\r\n}\r\n```\r\n\r\n\r\nAnd this is fine:\r\n```\r\ncontract D { uint256 s; function f() external view returns (bool) { return s > 1; } }\r\nlibrary L {\r\n    function f(uint256[] storage a, uint256[] storage b, D d) external view returns (uint256[] storage)\r\n    {\r\n        return d.f() ? a : b;\r\n    }\r\n}\r\n```\r\n\r\n\r\nBut this is not fine:\r\n```\r\nlibrary L {\r\n    function f(uint256[] storage a, uint256[] storage b) external view returns (uint256[] storage)\r\n    {\r\n        return a.length > 0 ? a : b;\r\n    }\r\n}\r\n```\r\n\r\nThe *really* correct and tight notion is somewhere between ``view`` and ``pure``... Well, it's actually exactly being ``pure`` plus allowing staticcalls...\r\nBut my guess is that all of these are highly artificial cases...",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554353352/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554621571",
    "html_url": "https://github.com/ethereum/solidity/issues/6420#issuecomment-554621571",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/6420",
    "id": 554621571,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDYyMTU3MQ==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-16T09:41:56Z",
    "updated_at": "2019-11-16T09:41:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "OK thinking about things some more I'm realizing my idea of \"ooh, you could even put these in variables now!\" would probably require some type weirdness that would likely not actually be easy to do without messing some things up.  So, uh, maybe just ignore that suggestion.  I was thinking \"oh if you can take selectors\" it's an external, but I guess the sensible way to implement that is actually just to add that capability to things that are `delegatecall`, not add some weird thing where sometimes `delegatecall` gets turned into `external`.  Oops.  So, that suggestion should probably be ignored.\r\n\r\nBut yeah being able to take selectors would be useful!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/554621571/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
