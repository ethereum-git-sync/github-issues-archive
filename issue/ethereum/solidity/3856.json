{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/3856",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/3856/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/3856/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/3856/events",
  "html_url": "https://github.com/ethereum/solidity/issues/3856",
  "id": 313326897,
  "node_id": "MDU6SXNzdWUzMTMzMjY4OTc=",
  "number": 3856,
  "title": "Solidity Multiple inheritance resolution",
  "user": {
    "login": "boorac",
    "id": 25860364,
    "node_id": "MDQ6VXNlcjI1ODYwMzY0",
    "avatar_url": "https://avatars.githubusercontent.com/u/25860364?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/boorac",
    "html_url": "https://github.com/boorac",
    "followers_url": "https://api.github.com/users/boorac/followers",
    "following_url": "https://api.github.com/users/boorac/following{/other_user}",
    "gists_url": "https://api.github.com/users/boorac/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/boorac/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/boorac/subscriptions",
    "organizations_url": "https://api.github.com/users/boorac/orgs",
    "repos_url": "https://api.github.com/users/boorac/repos",
    "events_url": "https://api.github.com/users/boorac/events{/privacy}",
    "received_events_url": "https://api.github.com/users/boorac/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2018-04-11T13:35:28Z",
  "updated_at": "2018-04-30T14:58:12Z",
  "closed_at": "2018-04-30T14:58:12Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "# Environment\r\n\r\n```\r\nTruffle v4.1.5 (core: 4.1.5)\r\nSolidity v0.4.21 (solc-js)\r\nnode v8.10.0\r\nUbuntu 16.04\r\n```\r\n\r\n# Issue\r\nI'm attempting to understand how solidity resolves multiple inheritance. As explained in the docs, Solidity uses C3 linearization. The relation between my classes is displayed on the image below: \r\n![hjzsp](https://user-images.githubusercontent.com/25860364/38619929-9718d218-3d9d-11e8-8683-01eb720bed7e.png)\r\n\r\nI want to understand in which order super is working when called from SampleCrowdsale. I ran the C3 linearization algorithm manually as well as using [this](https://github.com/federicobond/c3-linearization) tool. The results I get:\r\n\r\n```\r\n1) SampleCrowdsale\r\n2) CappedCrowdsale\r\n3) RefundableCrowdsale\r\n4) FinalizableCrowdsale\r\n5) TimedCrowdsale\r\n6) MintedCrowdsale\r\n7) IndividuallyCappedCrowdsale\r\n8) TieredCrowdsale\r\n9) Crowdsale\r\n10) Ownable\r\n```\r\nThen I tried to confirm my findings empirically. I added a method `log` to every contract in the inheritance chain, the method fires an event with the contract name. My findings using this method differ from the analytical approach:\r\n\r\n```\r\n1) SampleCrowdsale\r\n2) TieredCrowdsale\r\n3) IndividuallyCappedCrowdsale\r\n4) MintedCrowdsale\r\n5) RefundableCrowdsale\r\n6) FinalizableCrowdsale\r\n7) TimedCrowdsale\r\n8) CappedCrowdsale\r\n9) Crowdsale\r\n10) Ownable\r\n```\r\nCan anyone explain to me how to solve this?\r\n",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/3856/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/3856/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/380474860",
    "html_url": "https://github.com/ethereum/solidity/issues/3856#issuecomment-380474860",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3856",
    "id": 380474860,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDQ3NDg2MA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-11T14:35:02Z",
    "updated_at": "2018-04-11T14:35:02Z",
    "author_association": "MEMBER",
    "body": "My first hunch would be that the tool you mention uses a different order of the direct parents.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/380474860/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/380510735",
    "html_url": "https://github.com/ethereum/solidity/issues/3856#issuecomment-380510735",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3856",
    "id": 380510735,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDUxMDczNQ==",
    "user": {
      "login": "federicobond",
      "id": 138426,
      "node_id": "MDQ6VXNlcjEzODQyNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/138426?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/federicobond",
      "html_url": "https://github.com/federicobond",
      "followers_url": "https://api.github.com/users/federicobond/followers",
      "following_url": "https://api.github.com/users/federicobond/following{/other_user}",
      "gists_url": "https://api.github.com/users/federicobond/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/federicobond/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/federicobond/subscriptions",
      "organizations_url": "https://api.github.com/users/federicobond/orgs",
      "repos_url": "https://api.github.com/users/federicobond/repos",
      "events_url": "https://api.github.com/users/federicobond/events{/privacy}",
      "received_events_url": "https://api.github.com/users/federicobond/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-11T16:17:08Z",
    "updated_at": "2018-04-11T16:17:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "@boorac can you post the Solidity code you are using for the empirical part?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/380510735/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/381077094",
    "html_url": "https://github.com/ethereum/solidity/issues/3856#issuecomment-381077094",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3856",
    "id": 381077094,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MTA3NzA5NA==",
    "user": {
      "login": "boorac",
      "id": 25860364,
      "node_id": "MDQ6VXNlcjI1ODYwMzY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/25860364?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/boorac",
      "html_url": "https://github.com/boorac",
      "followers_url": "https://api.github.com/users/boorac/followers",
      "following_url": "https://api.github.com/users/boorac/following{/other_user}",
      "gists_url": "https://api.github.com/users/boorac/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/boorac/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/boorac/subscriptions",
      "organizations_url": "https://api.github.com/users/boorac/orgs",
      "repos_url": "https://api.github.com/users/boorac/repos",
      "events_url": "https://api.github.com/users/boorac/events{/privacy}",
      "received_events_url": "https://api.github.com/users/boorac/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-13T09:18:52Z",
    "updated_at": "2018-04-13T09:18:52Z",
    "author_association": "NONE",
    "body": "@federicobond I can't post the exact code, however I mashed up a quick repo with the same features:\r\nhttps://github.com/boorac/solidity-multiple-inheritance-resolution\r\n\r\nFor completion, the same discussion on [stackexchange](https://ethereum.stackexchange.com/questions/43650/solidity-and-multiple-inheritance)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/381077094/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/383176896",
    "html_url": "https://github.com/ethereum/solidity/issues/3856#issuecomment-383176896",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3856",
    "id": 383176896,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MzE3Njg5Ng==",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-20T18:04:51Z",
    "updated_at": "2018-04-20T18:04:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "@chriseth What order of direct parents is passed to the C3 algorithm in the Solidity compiler?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/383176896/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/383490611",
    "html_url": "https://github.com/ethereum/solidity/issues/3856#issuecomment-383490611",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3856",
    "id": 383490611,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MzQ5MDYxMQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-23T08:09:49Z",
    "updated_at": "2018-04-23T08:09:49Z",
    "author_association": "MEMBER",
    "body": "Let's check with the compiler:\r\n\r\nThis one compiles:\r\n```\r\ncontract A { }\r\ncontract B is A { }\r\ncontract C is A, B { }\r\n```\r\nBut that one does not:\r\n```\r\ncontract A { }\r\ncontract B is A { }\r\ncontract C is B, A { }\r\n```\r\n\r\nSo the order in the inheritance specifier (the direct parents) is base-to-derived (read from left to right).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/383490611/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/383491057",
    "html_url": "https://github.com/ethereum/solidity/issues/3856#issuecomment-383491057",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3856",
    "id": 383491057,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MzQ5MTA1Nw==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-23T08:11:25Z",
    "updated_at": "2018-04-23T08:11:25Z",
    "author_association": "MEMBER",
    "body": "Of course it might also be that there is a bug in the C3 implementation, and not in the way the inheritance graph is passed to the algorithm.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/383491057/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/384288919",
    "html_url": "https://github.com/ethereum/solidity/issues/3856#issuecomment-384288919",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3856",
    "id": 384288919,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDI4ODkxOQ==",
    "user": {
      "login": "federicobond",
      "id": 138426,
      "node_id": "MDQ6VXNlcjEzODQyNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/138426?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/federicobond",
      "html_url": "https://github.com/federicobond",
      "followers_url": "https://api.github.com/users/federicobond/followers",
      "following_url": "https://api.github.com/users/federicobond/following{/other_user}",
      "gists_url": "https://api.github.com/users/federicobond/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/federicobond/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/federicobond/subscriptions",
      "organizations_url": "https://api.github.com/users/federicobond/orgs",
      "repos_url": "https://api.github.com/users/federicobond/repos",
      "events_url": "https://api.github.com/users/federicobond/events{/privacy}",
      "received_events_url": "https://api.github.com/users/federicobond/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-25T13:36:36Z",
    "updated_at": "2018-04-25T13:37:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "We talked this a bit with @frangio yesterday. The problem here is that Solidity does the linearization from right to left while Python does it from left to right. In Python, for example, you always put mixins before the base class whereas in Solidity you always put them after.\r\n\r\nHere's some sample Python code:\r\n\r\n```python\r\nclass ERC721Basic:\r\n    pass\r\n\r\nclass ERC721Metadata(ERC721Basic):\r\n    pass\r\n\r\nclass ERC721Enumerable(ERC721Basic):\r\n    pass\r\n\r\nclass ERC721(ERC721Metadata, ERC721Enumerable, ERC721Basic):\r\n    pass\r\n\r\nprint(ERC721.__mro__)\r\n# (<class '__main__.ERC721'>, <class '__main__.ERC721Metadata'>, <class '__main__.ERC721Enumerable'>, <class '__main__.ERC721Basic'>, <class 'object'>)\r\n```\r\nTo get the same method resolution order in Solidity, you have to do:\r\n````solidity\r\ncontract ERC721Basic {}\r\n\r\ncontract ERC721Metadata is ERC721Basic {}\r\n\r\ncontract ERC721Enumerable is ERC721Basic {}\r\n\r\ncontract ERC721 is ERC721Basic, ERC721Enumerable, ERC721Metadata {}\r\n````\r\nNotice the reversed order of parents in ERC721.\r\n\r\nThis is not properly explained in the documentation, which on one hand says:\r\n> Solidity follows the path of Python and uses “C3 Linearization” to force a specific order in the DAG of base classes.\r\n\r\nBut then states:\r\n> A simple rule to remember is to specify the base classes in the order from “most base-like” to “most derived”.\r\n\r\nWhich is not what you would do in Python.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/384288919/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
