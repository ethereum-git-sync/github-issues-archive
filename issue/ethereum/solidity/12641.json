{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/12641",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/12641/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/12641/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/12641/events",
  "html_url": "https://github.com/ethereum/solidity/issues/12641",
  "id": 1125823768,
  "node_id": "I_kwDOAm_5kc5DGrUY",
  "number": 12641,
  "title": "Enable plain `assert()` in non-release builds in CI",
  "user": {
    "login": "cameel",
    "id": 137030,
    "node_id": "MDQ6VXNlcjEzNzAzMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cameel",
    "html_url": "https://github.com/cameel",
    "followers_url": "https://api.github.com/users/cameel/followers",
    "following_url": "https://api.github.com/users/cameel/following{/other_user}",
    "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
    "organizations_url": "https://api.github.com/users/cameel/orgs",
    "repos_url": "https://api.github.com/users/cameel/repos",
    "events_url": "https://api.github.com/users/cameel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cameel/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 437863668,
      "node_id": "MDU6TGFiZWw0Mzc4NjM2Njg=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/build%20system%20:building_construction:",
      "name": "build system :building_construction:",
      "color": "1d76db",
      "default": false,
      "description": ""
    },
    {
      "id": 717596767,
      "node_id": "MDU6TGFiZWw3MTc1OTY3Njc=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/good%20first%20issue",
      "name": "good first issue",
      "color": "006b75",
      "default": true,
      "description": ""
    },
    {
      "id": 1012613901,
      "node_id": "MDU6TGFiZWwxMDEyNjEzOTAx",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/easy%20difficulty",
      "name": "easy difficulty",
      "color": "0b3f89",
      "default": false,
      "description": ""
    },
    {
      "id": 1018738457,
      "node_id": "MDU6TGFiZWwxMDE4NzM4NDU3",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/testing%20:hammer:",
      "name": "testing :hammer:",
      "color": "ffc6db",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2022-02-07T10:54:54Z",
  "updated_at": "2022-02-08T14:37:32Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Apparently we have the [`assert`](https://en.cppreference.com/w/cpp/error/assert) macro disabled in CI, even in non-release builds - at least on Windows (see https://github.com/ethereum/solidity/pull/12634#discussion_r800191742). While this macro is generally discouraged in our project in favor of the `solAssert()` family of macros, we still do have them in some places and I think that they should not be disabled. I wouldn't disable them even if we did not have any - some of the libraries we depend on might also be using `assert` for example.\r\n\r\nWe do not define `NDEBUG` so I'm not really sure why they're disabled. Is that maybe because we default to `RelWithDebInfo` mode rather than `Debug`? The task here is to investigate, enable the macro and verify that it does actually work in non-release builds on all platforms.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/12641/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/12641/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1032187076",
    "html_url": "https://github.com/ethereum/solidity/issues/12641#issuecomment-1032187076",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12641",
    "id": 1032187076,
    "node_id": "IC_kwDOAm_5kc49hezE",
    "user": {
      "login": "a3d4",
      "id": 60588784,
      "node_id": "MDQ6VXNlcjYwNTg4Nzg0",
      "avatar_url": "https://avatars.githubusercontent.com/u/60588784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/a3d4",
      "html_url": "https://github.com/a3d4",
      "followers_url": "https://api.github.com/users/a3d4/followers",
      "following_url": "https://api.github.com/users/a3d4/following{/other_user}",
      "gists_url": "https://api.github.com/users/a3d4/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/a3d4/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/a3d4/subscriptions",
      "organizations_url": "https://api.github.com/users/a3d4/orgs",
      "repos_url": "https://api.github.com/users/a3d4/repos",
      "events_url": "https://api.github.com/users/a3d4/events{/privacy}",
      "received_events_url": "https://api.github.com/users/a3d4/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-08T03:53:32Z",
    "updated_at": "2022-02-08T03:53:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "PR #12644 enables `assert`s for MSVC `RelWithDevInfo` by adjusting `CMAKE_CXX_FLAGS_RELWITHDEBINFO`:\r\n```\r\nstring(REPLACE \"/DNDEBUG\" \" \" CMAKE_CXX_FLAGS_RELWITHDEBINFO \"${CMAKE_CXX_FLAGS_RELWITHDEBINFO}\")\r\n```\r\n\r\nImplementation differs from setting `CMAKE_CXX_FLAGS` for GNU/Clang though:\r\n```\r\nset(CMAKE_CXX_FLAGS_DEBUG          \"-O0 -g3 -DETH_DEBUG\")\r\nset(CMAKE_CXX_FLAGS_MINSIZEREL     \"-Os -DNDEBUG\")\r\nset(CMAKE_CXX_FLAGS_RELEASE        \"-O3 -DNDEBUG\")\r\nset(CMAKE_CXX_FLAGS_RELWITHDEBINFO \"-O2 -g3\")\r\n```\r\n\r\nIt fails locally, as expected, but succeeds on CI, which runs `Release`.\r\n\r\nI do support the idea to enable the standard C++ `assert`s. I would even consider doing it in `Release`, even if that sounds unorthodox.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1032187076/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1032314192",
    "html_url": "https://github.com/ethereum/solidity/issues/12641#issuecomment-1032314192",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12641",
    "id": 1032314192,
    "node_id": "IC_kwDOAm_5kc49h91Q",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-08T07:59:30Z",
    "updated_at": "2022-02-08T07:59:30Z",
    "author_association": "MEMBER",
    "body": "Please check the performance. For boost multiprecision, it makes a huge difference if it is built in debug or release mode. I would not be surprised if they also use some assertions.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1032314192/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1032664737",
    "html_url": "https://github.com/ethereum/solidity/issues/12641#issuecomment-1032664737",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12641",
    "id": 1032664737,
    "node_id": "IC_kwDOAm_5kc49jTah",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-08T14:24:04Z",
    "updated_at": "2022-02-08T14:24:26Z",
    "author_association": "MEMBER",
    "body": "Does not seem to affect runtime performance in a significant way:\r\n| CI workflow | `t_win_soltest` | `b_bytecode_win` | `t_win_release_soltest` |\r\n|---|---------------|----------------|-----------------------|\r\n| [`develop`](https://app.circleci.com/pipelines/github/ethereum/solidity/22088/workflows/1d787445-6ac4-4115-b2d9-5001f999bff2) | 12:18 | 10:05 | 12:32 |\r\n| [PR #12664](https://app.circleci.com/pipelines/github/ethereum/solidity/22059/workflows/0d99fa7b-9fe4-431a-8aa4-8a51704a2f9d) | 12:34 | 10:47 | 12:28 |\r\n\r\nThe non-release jobs ran slightly slower but still within the normal variability we see in CI so it might not even be actual slowdown. Even if it is, it seems to be small enough to be acceptable.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1032664737/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1032676186",
    "html_url": "https://github.com/ethereum/solidity/issues/12641#issuecomment-1032676186",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12641",
    "id": 1032676186,
    "node_id": "IC_kwDOAm_5kc49jWNa",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-08T14:34:50Z",
    "updated_at": "2022-02-08T14:34:50Z",
    "author_association": "MEMBER",
    "body": "> It fails locally, as expected, but succeeds on CI, which runs `Release`.\r\n\r\nI think it runs `RelWithDebInfo` actually (as long as we're talking about Linux runs). For example for `b_ubu` we do not specify build type in `.circleci/config.yml` so it should be `RelWithDebInfo`. So I guess assertions should be enabled there? Have you checked this one specifically?\r\n\r\nIt looks like we should add `CMAKE_BUILD_TYPE=Release` to some release jobs though, like `b_ubu_release`. Right now it does not specify anything so it must be running `RelWithDebInfo` too. Unless we're doing that on purpose?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1032676186/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1032679135",
    "html_url": "https://github.com/ethereum/solidity/issues/12641#issuecomment-1032679135",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12641",
    "id": 1032679135,
    "node_id": "IC_kwDOAm_5kc49jW7f",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-08T14:37:32Z",
    "updated_at": "2022-02-08T14:37:32Z",
    "author_association": "MEMBER",
    "body": "We should check some more computation-intensive examples. Most of our tests do not need a lot of computation on bigints, but for example the linear solver will.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1032679135/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
