{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/12290",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/12290/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/12290/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/12290/events",
  "html_url": "https://github.com/ethereum/solidity/issues/12290",
  "id": 1055234532,
  "node_id": "I_kwDOAm_5kc4-5Znk",
  "number": 12290,
  "title": "Custom errors raised from external calls are not recognized by Remix",
  "user": {
    "login": "Nielsbishere",
    "id": 28758736,
    "node_id": "MDQ6VXNlcjI4NzU4NzM2",
    "avatar_url": "https://avatars.githubusercontent.com/u/28758736?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Nielsbishere",
    "html_url": "https://github.com/Nielsbishere",
    "followers_url": "https://api.github.com/users/Nielsbishere/followers",
    "following_url": "https://api.github.com/users/Nielsbishere/following{/other_user}",
    "gists_url": "https://api.github.com/users/Nielsbishere/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Nielsbishere/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Nielsbishere/subscriptions",
    "organizations_url": "https://api.github.com/users/Nielsbishere/orgs",
    "repos_url": "https://api.github.com/users/Nielsbishere/repos",
    "events_url": "https://api.github.com/users/Nielsbishere/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Nielsbishere/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-11-16T19:18:36Z",
  "updated_at": "2022-01-02T15:36:15Z",
  "closed_at": "2022-01-02T15:36:15Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nUnfortunately, calling revert Error(...) in a library won't show a proper message to the caller. It works fine if you call the library manually. This makes it almost impossible to use, since it's not clear which error occurred:\r\n\r\n## Environment\r\n\r\n- Compiler version: 0.8.10\r\n- Target EVM version (as per compiler settings): ^\r\n- Framework/IDE (e.g. Truffle or Remix): Remix\r\n- EVM execution environment / backend / blockchain client: ^\r\n- Operating system: N/A\r\n\r\n## Steps to Reproduce\r\n\r\n```sol\r\n// SPDX-License-Identifier: MIT\r\npragma solidity 0.8.10;\r\n\r\nlibrary Test {\r\n    \r\n    error TestError(uint32);\r\n    \r\n    function answer(uint32 i) external pure {\r\n        \r\n        if(i != 42)\r\n            revert TestError(i);\r\n            \r\n        //You receive unlimited riches here\r\n    }\r\n}\r\n\r\ncontract TestC {\r\n    \r\n    function callMeWrong() external pure {\r\n        Test.answer(41);\r\n    }\r\n    \r\n    function callMeRight() external pure {\r\n        Test.answer(42);\r\n    }\r\n}\r\n```\r\ncallMeWrong() only says:\r\n```\r\nrevert\r\n\tThe transaction has been reverted to the initial state.\r\nNote: The called function should be payable if you send value and the value you send should be less than your current balance.\r\nDebug the transaction to get more information.\r\n```\r\ninstead of the expected\r\n```\r\nrevert\r\n\tThe transaction has been reverted to the initial state.\r\nError provided by the contract:\r\nTestError\r\nParameters:\r\n{\r\n \"0\": {\r\n  \"value\": \"41\"\r\n }\r\n}\r\nDebug the transaction to get more information.\r\n```",
  "closed_by": {
    "login": "Nielsbishere",
    "id": 28758736,
    "node_id": "MDQ6VXNlcjI4NzU4NzM2",
    "avatar_url": "https://avatars.githubusercontent.com/u/28758736?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Nielsbishere",
    "html_url": "https://github.com/Nielsbishere",
    "followers_url": "https://api.github.com/users/Nielsbishere/followers",
    "following_url": "https://api.github.com/users/Nielsbishere/following{/other_user}",
    "gists_url": "https://api.github.com/users/Nielsbishere/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Nielsbishere/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Nielsbishere/subscriptions",
    "organizations_url": "https://api.github.com/users/Nielsbishere/orgs",
    "repos_url": "https://api.github.com/users/Nielsbishere/repos",
    "events_url": "https://api.github.com/users/Nielsbishere/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Nielsbishere/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/12290/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/12290/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/971418553",
    "html_url": "https://github.com/ethereum/solidity/issues/12290#issuecomment-971418553",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12290",
    "id": 971418553,
    "node_id": "IC_kwDOAm_5kc455qu5",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-17T09:58:54Z",
    "updated_at": "2021-11-17T09:58:54Z",
    "author_association": "MEMBER",
    "body": "I'm pretty sure this is a problem with remix (it cannot decode the error data) - the data is correctly returned.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/971418553/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/971419386",
    "html_url": "https://github.com/ethereum/solidity/issues/12290#issuecomment-971419386",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12290",
    "id": 971419386,
    "node_id": "IC_kwDOAm_5kc455q76",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-17T09:59:58Z",
    "updated_at": "2021-11-17T09:59:58Z",
    "author_association": "MEMBER",
    "body": "@yann300 can you please have a look if this might be a bug in remix? Thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/971419386/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/971769773",
    "html_url": "https://github.com/ethereum/solidity/issues/12290#issuecomment-971769773",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12290",
    "id": 971769773,
    "node_id": "IC_kwDOAm_5kc457Aet",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-17T16:55:23Z",
    "updated_at": "2021-11-17T16:58:26Z",
    "author_association": "MEMBER",
    "body": "This is not limited only to libraries. Same happens if an external call to a contract reverts with an error:\r\n\r\n```solidity\r\ncontract C {\r\n    error E(string);\r\n\r\n    function triggerError(bool fail) external pure returns (bool) {\r\n        if (fail)\r\n            revert E(\"Failed!\");\r\n        else\r\n            return true;\r\n    }\r\n}\r\n\r\ncontract Test {\r\n    function good() external returns (bool) {\r\n        return new C().triggerError(false);\r\n    }\r\n\r\n    function bad() external returns (bool) {\r\n        return new C().triggerError(true);\r\n    }\r\n}\r\n```\r\n```\r\ntransact to Test.bad errored: VM error: revert.\r\n\r\nrevert\r\n\tThe transaction has been reverted to the initial state.\r\nNote: The called function should be payable if you send value and the value you send should be less than your current balance.\r\nDebug the transaction to get more information.\r\n```\r\n\r\nI think Remix is not detecting the error because it's not listed in the ABI for a contract unless that contract uses that error directly. And that's because our call graph does not follow external calls.\r\n\r\nAnd we can't follow them unless we have the source. For libraries currently you always have to provide the source at compilation time (though #12096/#11695 would change that) so it might be technically feasible for the compiler to include errors from libraries. For contracts you might only have an interface though. The same effect can be achieved much easier if the tool just gathers possible errors from the ABI of all contracts included in the compilation so yeah, it's probably something best done on Remix side.\r\n\r\nBTW, decoding errors is something that tools in general seem to be struggling with. For example some related Hardhat issues: https://github.com/nomiclabs/hardhat/issues/1618, https://github.com/nomiclabs/hardhat/issues/1919, https://github.com/nomiclabs/hardhat/issues/1875. When an error is propagated through a chain of external calls where you do not have the source of all the contracts in the chain, you might not be able to decode it. This is definitely a disadvantage compared to just passing an error message.\r\n\r\nI wonder if it would be a good idea to have an auto-generated file with all errors in the project that people could share along with interfaces. The file would also transitively include all errors from other such files added as input along with the sources.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/971769773/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1003733634",
    "html_url": "https://github.com/ethereum/solidity/issues/12290#issuecomment-1003733634",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/12290",
    "id": 1003733634,
    "node_id": "IC_kwDOAm_5kc4708KC",
    "user": {
      "login": "Nielsbishere",
      "id": 28758736,
      "node_id": "MDQ6VXNlcjI4NzU4NzM2",
      "avatar_url": "https://avatars.githubusercontent.com/u/28758736?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Nielsbishere",
      "html_url": "https://github.com/Nielsbishere",
      "followers_url": "https://api.github.com/users/Nielsbishere/followers",
      "following_url": "https://api.github.com/users/Nielsbishere/following{/other_user}",
      "gists_url": "https://api.github.com/users/Nielsbishere/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Nielsbishere/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Nielsbishere/subscriptions",
      "organizations_url": "https://api.github.com/users/Nielsbishere/orgs",
      "repos_url": "https://api.github.com/users/Nielsbishere/repos",
      "events_url": "https://api.github.com/users/Nielsbishere/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Nielsbishere/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-02T15:36:15Z",
    "updated_at": "2022-01-02T15:36:15Z",
    "author_association": "NONE",
    "body": "Seems like this is now applied in the latest Remix, thanks @yann300",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/1003733634/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
