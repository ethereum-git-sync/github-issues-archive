{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/4264",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/4264/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/4264/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/4264/events",
  "html_url": "https://github.com/ethereum/solidity/issues/4264",
  "id": 331238396,
  "node_id": "MDU6SXNzdWUzMzEyMzgzOTY=",
  "number": 4264,
  "title": "Memory corruption issues resulting in OOG from solc-v0.4.22-nightly.2018.4.5+commit.c6adad93.js onwards",
  "user": {
    "login": "D-Nice",
    "id": 2888248,
    "node_id": "MDQ6VXNlcjI4ODgyNDg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2888248?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/D-Nice",
    "html_url": "https://github.com/D-Nice",
    "followers_url": "https://api.github.com/users/D-Nice/followers",
    "following_url": "https://api.github.com/users/D-Nice/following{/other_user}",
    "gists_url": "https://api.github.com/users/D-Nice/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/D-Nice/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/D-Nice/subscriptions",
    "organizations_url": "https://api.github.com/users/D-Nice/orgs",
    "repos_url": "https://api.github.com/users/D-Nice/repos",
    "events_url": "https://api.github.com/users/D-Nice/events{/privacy}",
    "received_events_url": "https://api.github.com/users/D-Nice/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 275027668,
      "node_id": "MDU6TGFiZWwyNzUwMjc2Njg=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/documentation%20:book:",
      "name": "documentation :book:",
      "color": "006b75",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 12,
  "created_at": "2018-06-11T15:28:26Z",
  "updated_at": "2018-06-26T13:33:02Z",
  "closed_at": "2018-06-25T13:35:07Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Starting with this solc, usage of Oraclize's Random and Computation datasources (both dependent on array types and assembly), now fail in creating a query. The error appears to be at creation of the query [(line)](https://github.com/oraclize/ethereum-examples/blob/master/solidity/computation-datasource/bitcoin/getBitcoinAddressBalance.sol#L28) it pushes the datasource string onto the stack, does unexpected operations, like multiplying the bytes, and then eventually storing those bytes into the free memory pointer, causing an exception at the next MSTORE op.\r\n\r\nTwo changes that appear to affect this are the commit at https://github.com/ethereum/solidity/commit/be797cb796f058c65452531755687da42867050f and after the gas buffer was dropped with byzantium vm. Re-introducing pre-byzantium calls (where a little gas would be left over within calling contract, aka bringing back SUB opcode for calls via asm: `call(sub(gas, 700), addy, 0, 0, 8, 0, 0x20)` avoids the aforementioned corruption.\r\n\r\n",
  "closed_by": {
    "login": "D-Nice",
    "id": 2888248,
    "node_id": "MDQ6VXNlcjI4ODgyNDg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2888248?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/D-Nice",
    "html_url": "https://github.com/D-Nice",
    "followers_url": "https://api.github.com/users/D-Nice/followers",
    "following_url": "https://api.github.com/users/D-Nice/following{/other_user}",
    "gists_url": "https://api.github.com/users/D-Nice/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/D-Nice/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/D-Nice/subscriptions",
    "organizations_url": "https://api.github.com/users/D-Nice/orgs",
    "repos_url": "https://api.github.com/users/D-Nice/repos",
    "events_url": "https://api.github.com/users/D-Nice/events{/privacy}",
    "received_events_url": "https://api.github.com/users/D-Nice/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/4264/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/4264/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/396980534",
    "html_url": "https://github.com/ethereum/solidity/issues/4264#issuecomment-396980534",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/4264",
    "id": 396980534,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5Njk4MDUzNA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-13T15:30:25Z",
    "updated_at": "2018-06-13T15:30:25Z",
    "author_association": "MEMBER",
    "body": "Can you provide a bit more details about what oraclize actually does? What do you mean by \"unexpected operations\"?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/396980534/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/397396737",
    "html_url": "https://github.com/ethereum/solidity/issues/4264#issuecomment-397396737",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/4264",
    "id": 397396737,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NzM5NjczNw==",
    "user": {
      "login": "D-Nice",
      "id": 2888248,
      "node_id": "MDQ6VXNlcjI4ODgyNDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2888248?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/D-Nice",
      "html_url": "https://github.com/D-Nice",
      "followers_url": "https://api.github.com/users/D-Nice/followers",
      "following_url": "https://api.github.com/users/D-Nice/following{/other_user}",
      "gists_url": "https://api.github.com/users/D-Nice/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/D-Nice/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/D-Nice/subscriptions",
      "organizations_url": "https://api.github.com/users/D-Nice/orgs",
      "repos_url": "https://api.github.com/users/D-Nice/repos",
      "events_url": "https://api.github.com/users/D-Nice/events{/privacy}",
      "received_events_url": "https://api.github.com/users/D-Nice/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-14T18:37:06Z",
    "updated_at": "2018-06-14T18:37:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "The point at which it screws up is when using some assembly, namely Nick Johnson's cbor lib for converting a string array into cbor, but we also get an exception when our Random datasource is used, I haven't explored that one that much yet.\r\n\r\nWhat I mean by unexpected operations is that is the string computation is loaded from memory (mistakenly) and then various operations are done to the bytes equivalent of computation on the stack such as ADD/MUL (as the region should be empty, but `computation` string is there from uncleared calldata that was used) and eventually this operated string finds its way into being stored into the freemem pointer.\r\n\r\nThat should be a quick summary, I'll try and pinpoint the exact points of issue for you here, so we can come up with a solution.\r\n\r\nI would ask that you use this link to a debugged transaction that had this issue: http://rinkeby.etherscan.io/remix?txhash=0x9e81f89a75e8af1425e14a7a88e219242ee13415a362d5bd8e1ff8a4b8c9277f\r\n\r\nThe contract + function being debugged is the following: https://github.com/oraclize/ethereum-examples/blob/master/solidity/computation-datasource/url-requests/urlRequests.sol#L77\r\n\r\nI'll mention `@ step ####`, which refers to the specific vm trace step in the debugger.\r\n\r\n### @ step 2219\r\n`buf.buf.length + 1` - [link](https://github.com/oraclize/ethereum-api/blob/master/oraclizeAPI_0.4.sol#L167)\r\n\r\nThe expected result here is `0x1` (that is what pre-solc 0.4.22 returns, will refer to as pre from now). \r\n\r\nCurrent one gives `0xb636f6d7075746174696f6e0000000000000000000000000000000001` which is the computation string appended with a 1 byte. The memory region it's loading from should be empty, as it is in pre, however, here it is 'polluted' with the `computation` string, which it then picks up as the length of the buffer.\r\n\r\n\r\n### @ step 1633\r\n`oraclize.getPrice(datasource);`  - [link](https://github.com/oraclize/ethereum-api/blob/master/oraclizeAPI_0.4.sol#L417)\r\n\r\nThis is where the leftover `computation` string stems from. Call occurs @ 1706\r\n\r\n### @ step 2128\r\n`Buffer.buffer memory buf;` - [link](https://github.com/oraclize/ethereum-api/blob/master/oraclizeAPI_0.4.sol#L909)\r\n\r\nThis appears to be the major deviation in modus operandi between the working and non-working solc which leads to newer solc failing. \r\n\r\nWhat pre-does here is increment freemem from 0x460 to 0x4a0 and then 0x4c0, and starts clearing out the previous calldata slots. \r\n\r\nHere's a view of the pertinent memory slots on solc 0.4.20 \r\n\r\nbegin buffer declaration:\r\n```\r\n0x40: 00000000000000000000000000000000\t????????????????\r\n0x50: 00000000000000000000000000000460\t????????????????\r\n...\r\n0x450: 00000000000000000000000000000000\t????????????????\r\n0x460: 00000020000000000000000000000000\t????????????????\r\n0x470: 00000000000000000000000000000000\t????????????????\r\n0x480: 0000000b636f6d7075746174696f6e00\t????computation?\r\n0x490: 00000000000000000000000000000000\t????????????????\r\n```\r\n\r\nend buffer declaration:\r\n```\r\n0x40: 00000000000000000000000000000000\t????????????????\r\n0x50: 000000000000000000000000000004c0\t????????????????\r\n...\r\n0x450: 00000000000000000000000000000000\t????????????????\r\n0x460: 00000000000000000000000000000000\t????????????????\r\n0x470: 000000000000000000000000000004a0\t????????????????\r\n0x480: 00000000000000000000000000000000\t????????????????\r\n0x490: 00000000000000000000000000000000\t????????????????\r\n```\r\n\r\nHere's what happens to that memory region with solc 0.4.22 instead:\r\n\r\nbegin:\r\n```\r\n0x40: 00000000000000000000000000000000\t????????????????\r\n0x50: 00000000000000000000000000000360\t????????????????\r\n...\r\n0x370: 00000000000000000015057aeb22d000\t???????????z????\r\n0x380: 00000020000000000000000000000000\t????????????????\r\n0x390: 00000000000000000000000000000000\t????????????????\r\n0x3a0: 0000000b636f6d7075746174696f6e00\t????computation?\r\n0x3b0: 00000000000000000000000000000000\t????????????????\r\n```\r\n\r\nend @ 2151\r\n```\r\n0x40: 00000000000000000000000000000000\t????????????????\r\n0x50: 000000000000000000000000000003a0\t????????????????\r\n...\r\n0x370: 00000000000000000000000000000060\t????????????????\r\n0x380: 00000000000000000000000000000000\t????????????????\r\n0x390: 00000000000000000000000000000000\t????????????????\r\n0x3a0: 0000000b636f6d7075746174696f6e00\t????computation?\r\n0x3b0: 00000000000000000000000000000000\t????????????????\r\n```\r\n\r\nLet me know if this helps. I had also discussed this with @axic at a conference, and we weren't able to specifically diagnose this issue, but there were other oddities noticed by @axic with the newer solcs while trying to debug this.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/397396737/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/399530551",
    "html_url": "https://github.com/ethereum/solidity/issues/4264#issuecomment-399530551",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/4264",
    "id": 399530551,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTUzMDU1MQ==",
    "user": {
      "login": "D-Nice",
      "id": 2888248,
      "node_id": "MDQ6VXNlcjI4ODgyNDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2888248?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/D-Nice",
      "html_url": "https://github.com/D-Nice",
      "followers_url": "https://api.github.com/users/D-Nice/followers",
      "following_url": "https://api.github.com/users/D-Nice/following{/other_user}",
      "gists_url": "https://api.github.com/users/D-Nice/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/D-Nice/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/D-Nice/subscriptions",
      "organizations_url": "https://api.github.com/users/D-Nice/orgs",
      "repos_url": "https://api.github.com/users/D-Nice/repos",
      "events_url": "https://api.github.com/users/D-Nice/events{/privacy}",
      "received_events_url": "https://api.github.com/users/D-Nice/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-22T18:09:08Z",
    "updated_at": "2018-06-22T18:09:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "Here's an isolated example:\r\n\r\n```solidity\r\npragma solidity ^0.4.19;\r\n\r\nlibrary Buffer {\r\n    struct buffer {\r\n        bytes buf;\r\n        uint capacity;\r\n    }\r\n    \r\n    function init(buffer memory buf, uint capacity) internal constant {\r\n        if(capacity % 32 != 0) capacity += 32 - (capacity % 32);\r\n        // Allocate space for the buffer data\r\n        buf.capacity = capacity;\r\n        assembly {\r\n            let ptr := mload(0x40)\r\n            mstore(buf, ptr) // this is the incompatibility, as it expects the memory to be clear beyond freemem\r\n            mstore(0x40, add(ptr, capacity))\r\n        }\r\n    }\r\n}\r\n\r\ncontract A {\r\n    // function sig ends up as length of .buf\r\n    function someExternalFnc() external {\r\n    }\r\n    \r\n    function test() returns(bytes32) {\r\n        this.someExternalFnc();\r\n        Buffer.buffer memory buf;\r\n        Buffer.init(buf, 64);\r\n        return bytes32(buf.buf.length);\r\n    }\r\n}\r\n```\r\n\r\nIs every native type's memory initialization guaranteed not to be affected by the above issue, by clearing/overwriting the address space it will end up pointing to? It would be nice to mention to not assume any memory after the free memory pointer (even without dropping down to assembly), to actually be cleared/zeroed out, as this assumption was even made by an EF dev as seen above.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/399530551/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/399577507",
    "html_url": "https://github.com/ethereum/solidity/issues/4264#issuecomment-399577507",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/4264",
    "id": 399577507,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTU3NzUwNw==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-22T20:48:26Z",
    "updated_at": "2018-06-22T20:48:26Z",
    "author_association": "MEMBER",
    "body": "I've tried the isolated example in Remix with 0.4.19 and 0.4.24, but both finish successfully when calling `A.test()`.\r\n\r\nUnder what conditions is the isolated example failing for you?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/399577507/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/399616546",
    "html_url": "https://github.com/ethereum/solidity/issues/4264#issuecomment-399616546",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/4264",
    "id": 399616546,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTYxNjU0Ng==",
    "user": {
      "login": "D-Nice",
      "id": 2888248,
      "node_id": "MDQ6VXNlcjI4ODgyNDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2888248?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/D-Nice",
      "html_url": "https://github.com/D-Nice",
      "followers_url": "https://api.github.com/users/D-Nice/followers",
      "following_url": "https://api.github.com/users/D-Nice/following{/other_user}",
      "gists_url": "https://api.github.com/users/D-Nice/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/D-Nice/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/D-Nice/subscriptions",
      "organizations_url": "https://api.github.com/users/D-Nice/orgs",
      "repos_url": "https://api.github.com/users/D-Nice/repos",
      "events_url": "https://api.github.com/users/D-Nice/events{/privacy}",
      "received_events_url": "https://api.github.com/users/D-Nice/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-23T00:39:57Z",
    "updated_at": "2018-06-23T00:39:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "Apologies, it's not made to fail, but it's showcasing the length of buf in the buffer struct being set to the function sig of the last external call. If some additional operation were done dependent on that length, it could cause issues/throws.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/399616546/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/399674780",
    "html_url": "https://github.com/ethereum/solidity/issues/4264#issuecomment-399674780",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/4264",
    "id": 399674780,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTY3NDc4MA==",
    "user": {
      "login": "androlo",
      "id": 2809499,
      "node_id": "MDQ6VXNlcjI4MDk0OTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2809499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/androlo",
      "html_url": "https://github.com/androlo",
      "followers_url": "https://api.github.com/users/androlo/followers",
      "following_url": "https://api.github.com/users/androlo/following{/other_user}",
      "gists_url": "https://api.github.com/users/androlo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/androlo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/androlo/subscriptions",
      "organizations_url": "https://api.github.com/users/androlo/orgs",
      "repos_url": "https://api.github.com/users/androlo/repos",
      "events_url": "https://api.github.com/users/androlo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/androlo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-23T12:35:39Z",
    "updated_at": "2018-06-23T12:35:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "Memory at (and after) `mload(0x40)` can not be assumed to be empty. This has been the case for as long as i can remember: https://solidity.readthedocs.io/en/v0.4.24/miscellaneous.html#layout-in-memory",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/399674780/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/399953708",
    "html_url": "https://github.com/ethereum/solidity/issues/4264#issuecomment-399953708",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/4264",
    "id": 399953708,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTk1MzcwOA==",
    "user": {
      "login": "D-Nice",
      "id": 2888248,
      "node_id": "MDQ6VXNlcjI4ODgyNDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2888248?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/D-Nice",
      "html_url": "https://github.com/D-Nice",
      "followers_url": "https://api.github.com/users/D-Nice/followers",
      "following_url": "https://api.github.com/users/D-Nice/following{/other_user}",
      "gists_url": "https://api.github.com/users/D-Nice/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/D-Nice/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/D-Nice/subscriptions",
      "organizations_url": "https://api.github.com/users/D-Nice/orgs",
      "repos_url": "https://api.github.com/users/D-Nice/repos",
      "events_url": "https://api.github.com/users/D-Nice/events{/privacy}",
      "received_events_url": "https://api.github.com/users/D-Nice/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-25T13:35:06Z",
    "updated_at": "2018-06-25T13:35:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "Got it, thanks @androlo. The worry of course is that some making libraries in assembly are working under the assumption that it in fact is, so at least I see that the official stance is it is not. \r\n\r\nI would normally associate free memory with empty memory, so to me it may appear like a misnomer to call it free memory pointer, but more appropriate to refer as new memory pointer, as any new memory should point to that, but if doing it on a lower-level, you need to ensure that region is cleaned up for your use.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/399953708/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/400084647",
    "html_url": "https://github.com/ethereum/solidity/issues/4264#issuecomment-400084647",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/4264",
    "id": 400084647,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDA4NDY0Nw==",
    "user": {
      "login": "androlo",
      "id": 2809499,
      "node_id": "MDQ6VXNlcjI4MDk0OTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2809499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/androlo",
      "html_url": "https://github.com/androlo",
      "followers_url": "https://api.github.com/users/androlo/followers",
      "following_url": "https://api.github.com/users/androlo/following{/other_user}",
      "gists_url": "https://api.github.com/users/androlo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/androlo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/androlo/subscriptions",
      "organizations_url": "https://api.github.com/users/androlo/orgs",
      "repos_url": "https://api.github.com/users/androlo/repos",
      "events_url": "https://api.github.com/users/androlo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/androlo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-25T20:28:38Z",
    "updated_at": "2018-06-25T20:33:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "@D-Nice Maybe use `msize` instead of `mload(0x40)`. I see some people use that. The memory at address `msize` (and beyond) should always be clear, since it is guaranteed to never have been used. From the YP, section 9.1: *\"All locations in both storage and memory are well-defined initially as zero\"*.\r\n\r\nEDIT: obviously `0x40` would still have to be updated like normal...",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/400084647/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/400135032",
    "html_url": "https://github.com/ethereum/solidity/issues/4264#issuecomment-400135032",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/4264",
    "id": 400135032,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDEzNTAzMg==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-26T00:15:16Z",
    "updated_at": "2018-06-26T00:15:16Z",
    "author_association": "MEMBER",
    "body": "I wouldn't advise using `msize` without updating the free memory point at `0x40`. Is it a problem relying on `0x40`, but zeroing out the memory before using, if that is a requirement for the use case?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/400135032/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/400135702",
    "html_url": "https://github.com/ethereum/solidity/issues/4264#issuecomment-400135702",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/4264",
    "id": 400135702,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDEzNTcwMg==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-26T00:18:49Z",
    "updated_at": "2018-06-26T00:18:49Z",
    "author_association": "MEMBER",
    "body": "> I would normally associate free memory with empty memory, so to me it may appear like a misnomer to call it free memory pointer\r\n\r\n@D-Nice It actually matches how malloc libraries work on POSIX. Only `calloc` is guaranteed to be zeroed out by doing a manual zeroing after allocation. (Now a malloc library may decide to do some optimisations.)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/400135702/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/400136125",
    "html_url": "https://github.com/ethereum/solidity/issues/4264#issuecomment-400136125",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/4264",
    "id": 400136125,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDEzNjEyNQ==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-26T00:20:51Z",
    "updated_at": "2018-06-26T00:20:51Z",
    "author_association": "MEMBER",
    "body": "This should be less of an issue once built in helpers are made available to inline assembly, such as #474.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/400136125/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/400309947",
    "html_url": "https://github.com/ethereum/solidity/issues/4264#issuecomment-400309947",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/4264",
    "id": 400309947,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDMwOTk0Nw==",
    "user": {
      "login": "D-Nice",
      "id": 2888248,
      "node_id": "MDQ6VXNlcjI4ODgyNDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2888248?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/D-Nice",
      "html_url": "https://github.com/D-Nice",
      "followers_url": "https://api.github.com/users/D-Nice/followers",
      "following_url": "https://api.github.com/users/D-Nice/following{/other_user}",
      "gists_url": "https://api.github.com/users/D-Nice/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/D-Nice/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/D-Nice/subscriptions",
      "organizations_url": "https://api.github.com/users/D-Nice/orgs",
      "repos_url": "https://api.github.com/users/D-Nice/repos",
      "events_url": "https://api.github.com/users/D-Nice/events{/privacy}",
      "received_events_url": "https://api.github.com/users/D-Nice/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-26T13:33:02Z",
    "updated_at": "2018-06-26T13:33:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for that @axic I was contemplating on whether it is indeed better to zero out the memory using `codecopy` as solidity natively seems to do, or just extending freemem to msize, but I guess the former is recommended, and would have lower costs if working with more memory-hungry code. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/400309947/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
