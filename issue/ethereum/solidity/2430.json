{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/2430",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/2430/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/2430/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/2430/events",
  "html_url": "https://github.com/ethereum/solidity/issues/2430",
  "id": 237408086,
  "node_id": "MDU6SXNzdWUyMzc0MDgwODY=",
  "number": 2430,
  "title": "Solidity By Example Voting contract bug fix",
  "user": {
    "login": "DillonBArevalo",
    "id": 24831997,
    "node_id": "MDQ6VXNlcjI0ODMxOTk3",
    "avatar_url": "https://avatars.githubusercontent.com/u/24831997?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/DillonBArevalo",
    "html_url": "https://github.com/DillonBArevalo",
    "followers_url": "https://api.github.com/users/DillonBArevalo/followers",
    "following_url": "https://api.github.com/users/DillonBArevalo/following{/other_user}",
    "gists_url": "https://api.github.com/users/DillonBArevalo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/DillonBArevalo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/DillonBArevalo/subscriptions",
    "organizations_url": "https://api.github.com/users/DillonBArevalo/orgs",
    "repos_url": "https://api.github.com/users/DillonBArevalo/repos",
    "events_url": "https://api.github.com/users/DillonBArevalo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/DillonBArevalo/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2017-06-21T03:55:13Z",
  "updated_at": "2017-06-21T15:55:03Z",
  "closed_at": "2017-06-21T15:54:56Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "issue: function `giveRightToVote` can destroy weight given by function `delegate`.\r\n\r\nFor example:\r\n\r\n1. chairperson makes ballot\r\n2. chairperson gives right to vote to voter1\r\n3. chairperson delegates to voter1\r\n4. voter1 votes for prop\r\n5. total votes = 2\r\n\r\nvs\r\n\r\n1. chairperson makes ballot\r\n2. chairperson gives right to voter1\r\n3. chairperson delegates to voter1\r\n4. chairperson gives right to voter1 again #this is a problem. as it removes the votes from everyone who delegated to voter1\r\n5. voter1 votes for prop\r\n6. total votes = 1\r\n\r\nThis can be easily shown by taking five voters, giving them all the right to vote and creating two proxies: voter1 which has been delegated to twice (now with a weight of 3) and voter2 who has been delegated to once (now with a weight of 2). Then give voter1 the right to vote again, have them vote on different propositions and see that voter2's choice wins despite the greater support for voter1's choice.\r\n\r\nproposed solution is to add the condition\r\n`&& (voters[voter].weight == 0)`\r\nwhen trying to give right to vote.\r\n\r\n```\r\nfunction giveRightToVote(address voter) {\r\n            // If the argument of `require` evaluates to `false`,\r\n            // it terminates and reverts all changes to\r\n            // the state and to Ether balances. It is often\r\n            // a good idea to use this if functions are\r\n            // called incorrectly. But watch out, this\r\n            // will currently also consume all provided gas\r\n            // (this is planned to change in the future).\r\n            require((msg.sender == chairperson) && !voters[voter].voted && (voters[voter].weight == 0));\r\n            voters[voter].weight = 1;\r\n        }\r\n}\r\n```\r\n\r\nI understand that the intended use of the `giveRightToVote` function is to allot votes at the beginning of a voting cycle, but there is nothing explicit in the program that prevents either an accident deleting votes or someone with access to the chairperson's keys from seriously tampering with results. There is currently no way to see what has happened or correct for it after votes are deleted. The votes cannot be given back to the voters who delegated because they already have a status of having voted.\r\n\r\nI have made a PR with this very small change.",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/2430/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/2430/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/310123980",
    "html_url": "https://github.com/ethereum/solidity/issues/2430#issuecomment-310123980",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/2430",
    "id": 310123980,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMDEyMzk4MA==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-21T15:55:03Z",
    "updated_at": "2017-06-21T15:55:03Z",
    "author_association": "MEMBER",
    "body": "Thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/310123980/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
