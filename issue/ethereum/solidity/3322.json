{
  "url": "https://api.github.com/repos/ethereum/solidity/issues/3322",
  "repository_url": "https://api.github.com/repos/ethereum/solidity",
  "labels_url": "https://api.github.com/repos/ethereum/solidity/issues/3322/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/solidity/issues/3322/comments",
  "events_url": "https://api.github.com/repos/ethereum/solidity/issues/3322/events",
  "html_url": "https://github.com/ethereum/solidity/issues/3322",
  "id": 282058727,
  "node_id": "MDU6SXNzdWUyODIwNTg3Mjc=",
  "number": 3322,
  "title": "SOL-003 RAM Blow-up by constants cycles",
  "user": {
    "login": "mvglasenapp",
    "id": 32960326,
    "node_id": "MDQ6VXNlcjMyOTYwMzI2",
    "avatar_url": "https://avatars.githubusercontent.com/u/32960326?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mvglasenapp",
    "html_url": "https://github.com/mvglasenapp",
    "followers_url": "https://api.github.com/users/mvglasenapp/followers",
    "following_url": "https://api.github.com/users/mvglasenapp/following{/other_user}",
    "gists_url": "https://api.github.com/users/mvglasenapp/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mvglasenapp/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mvglasenapp/subscriptions",
    "organizations_url": "https://api.github.com/users/mvglasenapp/orgs",
    "repos_url": "https://api.github.com/users/mvglasenapp/repos",
    "events_url": "https://api.github.com/users/mvglasenapp/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mvglasenapp/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 249074435,
      "node_id": "MDU6TGFiZWwyNDkwNzQ0MzU=",
      "url": "https://api.github.com/repos/ethereum/solidity/labels/bug%20:bug:",
      "name": "bug :bug:",
      "color": "fc1313",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2017-12-14T10:53:06Z",
  "updated_at": "2018-04-17T07:51:08Z",
  "closed_at": "2018-04-17T07:49:37Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "**Description**\r\n\r\nThe solidity compiler has code to detect if a set of constant definitions posses a cycle by cross-reference. By forcing the compiler to recompute the cycles over and over, the compiler needs to allocate huge amounts of RAM, and compilation time can be made arbitrary long.\r\n\r\nWe’ve attached the file Exploit3.sol as an working example. The file defines a chain of constant\r\nreferences of length 5000. Constant names are encoded using an alphabet of 62 characters.\r\nThe file structure is the following:\r\n\r\n```\r\npragma solidity ^0.4.16;\r\ncontract a {}\r\ncontract XX {\r\na constant A=B;a constant B=C;a constant C=D;a constant D=E;a constant\r\nE=F;a constant F=G;a constant G=H;a constant H=I;a constant I=J;a constant\r\nJ=K;\r\na constant K=L;a constant L=M;a constant M=N;a constant N=O;a constant\r\nO=P;a constant P=Q;a constant Q=R;a constant R=S;a constant S=T;a constant\r\nT=U;\r\na constant U=V;a constant V=W;a constant W=X;a constant X=Y;a constant\r\nY=Z;a constant Z=_a;a constant _a=_b;a constant _b=_c;a constant _c=_d;a\r\nconstant _d=_e;\r\n….. continued….\r\n\r\na constant FMQ=FMR;a constant FMR=FMS;a constant FMS=FMT;a constant\r\nFMT=FMU;a constant FMU=FMV;a constant FMV=FMW;a constant FMW=FMX;a\r\nconstant FMX=FMY;a constant FMY=FMZ;a constant FMZ=FMa;\r\na constant FMa=FMb;a constant FMb=FMc;a constant FMc=FMd;a constant\r\nFMd=FMe;a constant FMe=FMf;a constant FMf=FMg;a constant FMg=FMh;a\r\nconstant FMh=FMi;a constant FMi=FMj;a constant FMj=FMk;\r\n\r\na constant FMk = a(0x00);\r\n\r\n}\r\n```\r\n\r\nThis example forces the compiler to allocate 10 GB of RAM very rapidly. Also it will take a lot of\r\ntime to finish compiling (e.g. days). As memory allocation is quadratic, the attacker can force the\r\ntarget system to start trashing. The source code is about 372 Kbytes.\r\n\r\n**Recommendations**\r\n\r\nRewrite cycle-finding algorithm to avoid copying states while traversing or set a limit in\r\nthe depth of constants references.\r\n",
  "closed_by": {
    "login": "chriseth",
    "id": 9073706,
    "node_id": "MDQ6VXNlcjkwNzM3MDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chriseth",
    "html_url": "https://github.com/chriseth",
    "followers_url": "https://api.github.com/users/chriseth/followers",
    "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
    "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
    "organizations_url": "https://api.github.com/users/chriseth/orgs",
    "repos_url": "https://api.github.com/users/chriseth/repos",
    "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chriseth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/3322/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/solidity/issues/3322/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/352416948",
    "html_url": "https://github.com/ethereum/solidity/issues/3322#issuecomment-352416948",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3322",
    "id": 352416948,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MjQxNjk0OA==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-18T12:50:19Z",
    "updated_at": "2017-12-18T12:50:19Z",
    "author_association": "MEMBER",
    "body": "@SergioDemianLerner The above code doesn't compile for me, it misses `_e`. Do you have a proper example which triggers this? We do have new checks for circular dependencies (limited at depth of 32) in constants since #3142.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/352416948/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/354004478",
    "html_url": "https://github.com/ethereum/solidity/issues/3322#issuecomment-354004478",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3322",
    "id": 354004478,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NDAwNDQ3OA==",
    "user": {
      "login": "federicobond",
      "id": 138426,
      "node_id": "MDQ6VXNlcjEzODQyNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/138426?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/federicobond",
      "html_url": "https://github.com/federicobond",
      "followers_url": "https://api.github.com/users/federicobond/followers",
      "following_url": "https://api.github.com/users/federicobond/following{/other_user}",
      "gists_url": "https://api.github.com/users/federicobond/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/federicobond/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/federicobond/subscriptions",
      "organizations_url": "https://api.github.com/users/federicobond/orgs",
      "repos_url": "https://api.github.com/users/federicobond/repos",
      "events_url": "https://api.github.com/users/federicobond/events{/privacy}",
      "received_events_url": "https://api.github.com/users/federicobond/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-26T19:30:55Z",
    "updated_at": "2017-12-26T19:30:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "I created this test program to generate a chain of constant references like the one described in the report and I could not reproduce the RAM blow-up. Here's the source if you want to play with it:\r\n```python\r\nimport string\r\n\r\ndef var_name(num):\r\n    name = \"\"\r\n    while num != 0:\r\n        mod = len(string.ascii_uppercase)\r\n        name = string.ascii_uppercase[num % mod] + name\r\n        num = num // mod\r\n    return name\r\n\r\nprint(\"pragma solidity ^0.4.16;\\n\")\r\nprint(\"contract a {}\")\r\nprint(\"contract XX {\")\r\nfor x in range(1, 5000):\r\n    print(\"    a constant %s = %s;\" % (var_name(x), var_name(x+1)))\r\nprint(\"    a constant %s = a(0x00);\" % var_name(x+1))\r\nprint(\"}\")\r\n```\r\n\r\nAnd here's the generated [Solidity code](https://gist.github.com/federicobond/92f15000563dd2e5cc5c7b7429f677c5).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/354004478/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/354625336",
    "html_url": "https://github.com/ethereum/solidity/issues/3322#issuecomment-354625336",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3322",
    "id": 354625336,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NDYyNTMzNg==",
    "user": {
      "login": "SergioDemianLerner",
      "id": 1752347,
      "node_id": "MDQ6VXNlcjE3NTIzNDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1752347?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SergioDemianLerner",
      "html_url": "https://github.com/SergioDemianLerner",
      "followers_url": "https://api.github.com/users/SergioDemianLerner/followers",
      "following_url": "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
      "gists_url": "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SergioDemianLerner/subscriptions",
      "organizations_url": "https://api.github.com/users/SergioDemianLerner/orgs",
      "repos_url": "https://api.github.com/users/SergioDemianLerner/repos",
      "events_url": "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SergioDemianLerner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-31T21:54:39Z",
    "updated_at": "2017-12-31T21:54:39Z",
    "author_association": "NONE",
    "body": "Here is the full code:\r\n[Exploit3.zip](https://github.com/ethereum/solidity/files/1595486/Exploit3.zip)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/354625336/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/354625400",
    "html_url": "https://github.com/ethereum/solidity/issues/3322#issuecomment-354625400",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3322",
    "id": 354625400,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NDYyNTQwMA==",
    "user": {
      "login": "SergioDemianLerner",
      "id": 1752347,
      "node_id": "MDQ6VXNlcjE3NTIzNDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1752347?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SergioDemianLerner",
      "html_url": "https://github.com/SergioDemianLerner",
      "followers_url": "https://api.github.com/users/SergioDemianLerner/followers",
      "following_url": "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
      "gists_url": "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SergioDemianLerner/subscriptions",
      "organizations_url": "https://api.github.com/users/SergioDemianLerner/orgs",
      "repos_url": "https://api.github.com/users/SergioDemianLerner/repos",
      "events_url": "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SergioDemianLerner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-31T21:57:01Z",
    "updated_at": "2017-12-31T21:57:01Z",
    "author_association": "NONE",
    "body": "Here is the generator:\r\n\r\n[genref.zip](https://github.com/ethereum/solidity/files/1595487/genref.zip)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/354625400/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/354625558",
    "html_url": "https://github.com/ethereum/solidity/issues/3322#issuecomment-354625558",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3322",
    "id": 354625558,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NDYyNTU1OA==",
    "user": {
      "login": "SergioDemianLerner",
      "id": 1752347,
      "node_id": "MDQ6VXNlcjE3NTIzNDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1752347?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SergioDemianLerner",
      "html_url": "https://github.com/SergioDemianLerner",
      "followers_url": "https://api.github.com/users/SergioDemianLerner/followers",
      "following_url": "https://api.github.com/users/SergioDemianLerner/following{/other_user}",
      "gists_url": "https://api.github.com/users/SergioDemianLerner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SergioDemianLerner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SergioDemianLerner/subscriptions",
      "organizations_url": "https://api.github.com/users/SergioDemianLerner/orgs",
      "repos_url": "https://api.github.com/users/SergioDemianLerner/repos",
      "events_url": "https://api.github.com/users/SergioDemianLerner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SergioDemianLerner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-31T22:01:43Z",
    "updated_at": "2017-12-31T22:01:43Z",
    "author_association": "NONE",
    "body": "Version 1:0.4.19-0ubuntu1~xenial still shows the same behavior",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/354625558/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/381885149",
    "html_url": "https://github.com/ethereum/solidity/issues/3322#issuecomment-381885149",
    "issue_url": "https://api.github.com/repos/ethereum/solidity/issues/3322",
    "id": 381885149,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MTg4NTE0OQ==",
    "user": {
      "login": "chriseth",
      "id": 9073706,
      "node_id": "MDQ6VXNlcjkwNzM3MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9073706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chriseth",
      "html_url": "https://github.com/chriseth",
      "followers_url": "https://api.github.com/users/chriseth/followers",
      "following_url": "https://api.github.com/users/chriseth/following{/other_user}",
      "gists_url": "https://api.github.com/users/chriseth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chriseth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chriseth/subscriptions",
      "organizations_url": "https://api.github.com/users/chriseth/orgs",
      "repos_url": "https://api.github.com/users/chriseth/repos",
      "events_url": "https://api.github.com/users/chriseth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chriseth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-17T07:51:08Z",
    "updated_at": "2018-04-17T07:51:08Z",
    "author_association": "MEMBER",
    "body": "This still takes a long time, but no RAM blowup.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/solidity/issues/comments/381885149/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
