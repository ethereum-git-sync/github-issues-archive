{
  "url": "https://api.github.com/repos/ethereum/EIPs/issues/1165",
  "repository_url": "https://api.github.com/repos/ethereum/EIPs",
  "labels_url": "https://api.github.com/repos/ethereum/EIPs/issues/1165/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/EIPs/issues/1165/comments",
  "events_url": "https://api.github.com/repos/ethereum/EIPs/issues/1165/events",
  "html_url": "https://github.com/ethereum/EIPs/issues/1165",
  "id": 334054451,
  "node_id": "MDU6SXNzdWUzMzQwNTQ0NTE=",
  "number": 1165,
  "title": "ERC: Descriptions for Smart Contracts and Functions",
  "user": {
    "login": "toliuyi",
    "id": 10511951,
    "node_id": "MDQ6VXNlcjEwNTExOTUx",
    "avatar_url": "https://avatars.githubusercontent.com/u/10511951?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/toliuyi",
    "html_url": "https://github.com/toliuyi",
    "followers_url": "https://api.github.com/users/toliuyi/followers",
    "following_url": "https://api.github.com/users/toliuyi/following{/other_user}",
    "gists_url": "https://api.github.com/users/toliuyi/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/toliuyi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/toliuyi/subscriptions",
    "organizations_url": "https://api.github.com/users/toliuyi/orgs",
    "repos_url": "https://api.github.com/users/toliuyi/repos",
    "events_url": "https://api.github.com/users/toliuyi/events{/privacy}",
    "received_events_url": "https://api.github.com/users/toliuyi/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2328627851,
      "node_id": "MDU6TGFiZWwyMzI4NjI3ODUx",
      "url": "https://api.github.com/repos/ethereum/EIPs/labels/stale",
      "name": "stale",
      "color": "000000",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2018-06-20T12:28:17Z",
  "updated_at": "2021-12-19T06:13:23Z",
  "closed_at": "2021-12-19T06:13:23Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "---\r\neip: <to be assigned>\r\ntitle: Descriptions for Smart Contracts and Functions\r\nauthor: Yi Liu (@toliuyi)\r\ndiscussions-to: lum.wang@gmail.com rivers.yang@icloud.com hayeah@gmail.com\r\nstatus: WIP\r\ntype: Standards Track\r\ncategory: ERC\r\ncreated: 2018-06-15\r\n---\r\n<!--You can leave these HTML comments in your merged EIP and delete the visible duplicate text guides, they will not appear and may be helpful to refer to if you edit it again. This is the suggested template for new EIPs. Note that an EIP number will be assigned by an editor. When opening a pull request to submit your EIP, please use an abbreviated title in the filename, `eip-draft_title_abbrev.md`. The title should be 44 characters or less.-->\r\n\r\n## Simple Summary\r\n<!--\"If you can't explain it simply, you don't understand it well enough.\" Provide a simplified and layman-accessible explanation of the EIP.-->\r\nA standard for dApp developers to register descriptions of their smart contracts, then wallet apps could display those descriptions to users when signing transactions, providing better user experience.\r\n\r\n## Abstract\r\n<!--A short (~200 word) description of the technical issue being addressed.-->\r\nThis EIP specifies a registry for human-readable contract descriptions, permitting contracts owners to register descriptions for contract functions and then wallet apps(such as MetaMask, ImToken, Status, Toshi etc.) could query and display those descriptions to users when users are about to sign Ethereum transactions.\r\n\r\n## Motivation\r\n<!--The motivation is critical for EIPs that want to change the Ethereum protocol. It should clearly explain why the existing protocol specification is inadequate to address the problem that the EIP solves. EIP submissions without sufficient motivation may be rejected outright.-->\r\nWhen users interact with dApps, they often need to confirm transactions. But the confirmation UI presented by installed wallet(such as MetaMask, Imtoken, Status, Toshi etc.) does NOT show proper information of what the transaction is about. This situation often made user confused and hesitated to confirm. Considered that there is EIP-926, address metadata registry could be used to associate description messages with contract address, a simple and consistent standard could fix this issue far more efficiently. Then the overall Ethereum dApp user experience would be improved. \r\n\r\n## Specification\r\n<!--The technical specification should describe the syntax and semantics of any new feature. The specification should be detailed enough to allow competing, interoperable implementations for any of the current Ethereum platforms (go-ethereum, parity, cpp-ethereum, ethereumj, ethereumjs, and [others](https://github.com/ethereum/wiki/wiki/Clients)).-->\r\n\r\n### Interface\r\n\r\n```\r\npragma solidity ^0.4.20;\r\n\r\n/**\r\n   @title Owned, a standard interface to check smart contract owner\r\n\r\n   Any contract implementing ERC*** should support this interface, having public ower() function to return contract owner's address\r\n\r\n */\r\ninterface Owned {\r\n  /**\r\n   * @dev Return contract owner address. \r\n   * @return owner address\r\n   */\r\n  function owner() external view returns (address);\r\n}\r\n\r\n/**\r\n   @title ContractDescRegistry Human readable contract description registry. Implementation of ERC***.\r\n\r\n   Allow contract owners register human-readable descriptions to contract functions. Wallets such as\r\n   MetaMask, Imtoken, Status, Toshi etc. could display those descriptions to users when they about to sign\r\n   Ethereum transactions.\r\n\r\n */\r\ncontract ContractDescRegistry {\r\n\r\n  //inforamtion storage, contract address => function selector => language code => description\r\n  mapping (address => mapping( bytes4 =>mapping (bytes5 => string))) public desc_store;\r\n\r\n  //event emitted after a contract description registered\r\n  event DescRegistered(address indexed contractAddr, bytes4 selector, bytes5 lang, string desc);\r\n\r\n  /**\r\n   * @dev Throws if called by any account other than contract owner.\r\n   */\r\n  modifier onlyContractOwner(address contractAddr){\r\n    require(Owned(contractAddr).owner() == msg.sender);\r\n    _;\r\n  }\r\n\r\n  /**\r\n   * @dev Allows the contract owner to register human-readable description of contract and it's functions.\r\n   * @param contractAddr The address of the contract which description associated with.\r\n   * @param selector The selector of function which description associated with, use empty bytes to associate description to the whole contract.\r\n   * @param lang ISO 639 language code of the description. Every contract should at least register description in English which language code is \"en\".\r\n   * @param desc Description string in UTF8 encoding which supports argument injection, such as \"Deposite $(_value)[18]$ Ether\".\r\n   */\r\n  function attachDesc(address contractAddr, bytes4 selector, bytes5 lang, string desc) external onlyContractOwner(contractAddr){\r\n    desc_store[contractAddr][selector][lang] = desc;\r\n    emit DescRegistered(contractAddr, selector, lang, desc);\r\n  }\r\n\r\n  /**\r\n   * @dev Allows anyone query contract description messages from this registry.\r\n   * @param contractAddr The address of the contract to query.\r\n   * @param selector The selector of function to query, use contract name's selector to query description of the whole contract.\r\n   * @param lang ISO 639 language code of the description. If there is no description in specified language, \"en\" used as default.\r\n   * @return Description string in UTF8 encoding which supports argument injection,such as \"Deposite $(_value)[18]$ Ether\".\r\n   */\r\n  function getDesc(address contractAddr, bytes4 selector, bytes5 lang) view external returns (string) {\r\n    if(bytes(desc_store[contractAddr][selector][lang]).length != 0) return desc_store[contractAddr][selector][lang];\r\n    else return desc_store[contractAddr][selector][\"en\"];\r\n  }\r\n\r\n}\r\n```\r\n\r\n`attachDesc()` submit a description to be associated with contract address, function selector and specified language, while `getDesc()` returns the description of supplied contract address, function select and language. Any contract utilizes this registry should have public owner() function for the registry to check description submitter is contract owner.\r\n\r\n### Parameters\r\n* contractAddr, The address of the contract which descriptions are assciatated with.\r\n* selector, The selector of function which description is associated with. Use empty bytes to associate description to the whole contract. Since user doesn't interact with constructor function, so no description is needed.\r\n* lang, ISO 639 language code of the description, such as en/de/ru/zh_CN. Default language is en.\r\n* desc, Description message in UTF8 encoding which supports argument injection, such as \"Deposit $(_value)[18]$ Ether\".\r\n\r\n### Argument Injection\r\nDescription messages can be added by client software with transaction parameters. This would help in showing end-users that the expected values are being passed to the function. To inject a function argument into the text, use the opening and closing pairs: \"$(\" and \")$\", for example, $(ARGUMENT_NAME)$.\r\n\r\nAn optional helper can be included in this syntax to display numeric values (such as a token's value) with their appropriate decimal places. To do this, square brackets containing the number of decimal places between 0 and 18 can be included before the ending $ character: $(ARGUMENT_NAME)[18]$. All variables can be parsed and displayed automatically by client software by simply looking at the parameter name and type defined in the ABI.\r\n\r\nThis part draw lessons from [ERC: URI Format for Calling Functions #1138](https://github.com/ethereum/EIPs/issues/1138)\r\n\r\n## Rationale\r\n<!--The rationale fleshes out the specification by describing what motivated the design and why particular design decisions were made. It should describe alternate designs that were considered and related work, e.g. how the feature is supported in other languages. The rationale may also provide evidence of consensus within the community, and should discuss important objections or concerns raised during discussion.-->\r\n### Self-contained or central registry\r\nHuman readable descriptions could be embedded in the contract and exposed by a standard interface. But since there is no commonly accepted standard for this purpose and so many contracts had already published onto Ethererum, set up a central registry would allow both existing and upcoming contracts to use the same mechanism.\r\n\r\n### Store hash or message\r\nAn alternative design is to store hash rather than description message itself. This approach would surely cost less gas to submit descriptions than the current one, but it will bring other issues such as:\r\n* Description consumers (most likely wallet software) have to resort to off-chain web service to retrieve messages, make the architecture more complex and vulnerable to censorship and network outrage.\r\n* Contract owners may intend to introduce their contract in detail, which makes the messages too long to read. If message stored on Ethereum blockchain, the cost and gas limit may lead more refined message which is easy to read by users.\r\n\r\n\r\n## Backwards Compatibility\r\n<!--All EIPs that introduce backwards incompatibilities must include a section describing these incompatibilities and their severity. The EIP must explain how the author proposes to deal with these incompatibilities. EIP submissions without a sufficient backwards compatibility treatise may be rejected outright.-->\r\nThere are no backwards compatibility concerns.\r\n\r\n## Test Cases and Reference Implementation\r\n<!--Test cases for an implementation are mandatory for EIPs that are affecting consensus changes. Other EIPs can choose to include links to test cases if applicable.-->\r\n<!--The implementations must be completed before any EIP is given status \"Final\", but it need not be completed before the EIP is accepted. While there is merit to the approach of reaching consensus on the specification and rationale before writing code, the principle of \"rough consensus and running code\" is still useful when it comes to resolving many discussions of API details.-->\r\nTest cases and a reference implementation are available at [https://github.com/toliuyi/contract-description/](https://github.com/toliuyi/contract-description/)\r\n\r\n## Copyright\r\nCopyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/).\r\n",
  "closed_by": {
    "login": "github-actions[bot]",
    "id": 41898282,
    "node_id": "MDM6Qm90NDE4OTgyODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/github-actions%5Bbot%5D",
    "html_url": "https://github.com/apps/github-actions",
    "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/EIPs/issues/1165/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/EIPs/issues/1165/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/986173611",
    "html_url": "https://github.com/ethereum/EIPs/issues/1165#issuecomment-986173611",
    "issue_url": "https://api.github.com/repos/ethereum/EIPs/issues/1165",
    "id": 986173611,
    "node_id": "IC_kwDOAq426M46x9Cr",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2021-12-05T06:13:21Z",
    "updated_at": "2021-12-05T06:13:21Z",
    "author_association": "NONE",
    "body": "There has been no activity on this issue for two months. It will be closed in a week if no further activity occurs. If you would like to move this EIP forward, please respond to any outstanding feedback or add a comment indicating that you have addressed all required feedback and are ready for a review.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/986173611/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/997336275",
    "html_url": "https://github.com/ethereum/EIPs/issues/1165#issuecomment-997336275",
    "issue_url": "https://api.github.com/repos/ethereum/EIPs/issues/1165",
    "id": 997336275,
    "node_id": "IC_kwDOAq426M47ciTT",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2021-12-19T06:13:23Z",
    "updated_at": "2021-12-19T06:13:23Z",
    "author_association": "NONE",
    "body": "This issue was closed due to inactivity. If you are still pursuing it, feel free to reopen it and respond to any feedback or request a review in a comment.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/997336275/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
