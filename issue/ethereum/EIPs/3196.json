{
  "url": "https://api.github.com/repos/ethereum/EIPs/issues/3196",
  "repository_url": "https://api.github.com/repos/ethereum/EIPs",
  "labels_url": "https://api.github.com/repos/ethereum/EIPs/issues/3196/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/EIPs/issues/3196/comments",
  "events_url": "https://api.github.com/repos/ethereum/EIPs/issues/3196/events",
  "html_url": "https://github.com/ethereum/EIPs/issues/3196",
  "id": 783863337,
  "node_id": "MDU6SXNzdWU3ODM4NjMzMzc=",
  "number": 3196,
  "title": "ERC777 based token standard that simplifies on-chain voting",
  "user": {
    "login": "seniorjoinu",
    "id": 15361624,
    "node_id": "MDQ6VXNlcjE1MzYxNjI0",
    "avatar_url": "https://avatars.githubusercontent.com/u/15361624?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/seniorjoinu",
    "html_url": "https://github.com/seniorjoinu",
    "followers_url": "https://api.github.com/users/seniorjoinu/followers",
    "following_url": "https://api.github.com/users/seniorjoinu/following{/other_user}",
    "gists_url": "https://api.github.com/users/seniorjoinu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/seniorjoinu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/seniorjoinu/subscriptions",
    "organizations_url": "https://api.github.com/users/seniorjoinu/orgs",
    "repos_url": "https://api.github.com/users/seniorjoinu/repos",
    "events_url": "https://api.github.com/users/seniorjoinu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/seniorjoinu/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2021-01-12T02:52:19Z",
  "updated_at": "2021-01-18T12:26:27Z",
  "closed_at": "2021-01-18T12:26:27Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Question\r\nI have an implemented idea of ERC777-based token smart-contract that makes weighted (based on amount of tokens a user has) on-chain votings simple, cheap (~0.002 eth for a vote) and secure.\r\n\r\nWith this token any organization can also implement any other protocol that requires from its token holders some kind of proof of token possession at some point in time.\r\n\r\nShould I submit it as an EIP (e.g. EIP-787)?\r\n\r\n## Details\r\n### The idea\r\nThe token is based on ERC777 standard and utilizes it's `_beforeTokenTransfer` hook to store account balance history on-chain.\r\nEach time tokens move between accounts, so called `balance snapshots` for these accounts are stored. A `balance snapshot` is just a record \r\n```\r\n{\r\n    uint256 timestamp;  // block timestamp\r\n    uint256 balance;    // account balance at this timestamp\r\n}\r\n```\r\nSequential `balance snapshots` form `balance history` of some account. This history is naturally sorted by `timestamp` and can be searched through in O(logn) time.\r\n\r\nThis enables us to introduce a new public token method `balanceAt(address account, uint256 timestamp)` that can provide the caller with reliable information about an account balance at any given point of time.\r\n\r\nThere is also `clearAccountHistory()` method that removes `balance history` of the caller except for the last entry. This method can be used when even a O(logn) search becomes pricy.\r\n\r\n### Usage\r\nThe idea of a voting system based on this token is very simple. When a `Voting` object is created, it should also store a timestamp of its creation (or some other timestamp that would represent a moment in time from which it is legitimate to place votes). \r\n\r\nThen, when a user places a vote, the voting system should simply check the user's balance at the timestamp of `Voting` creation and use this balance as a value of voting power. This set of balances is used as a single source of truth for this particular voting process. \r\nOne can see that it also very easy to `re-vote` or implement `one-account-one-vote` scheme in such a voting system.\r\n\r\n##### There is also a little drawback.\r\n> If a user decide to `clearAccountHistory` of theirs, `balanceAt` method might return 0 (if their last transfer was after the `Voting` creation timestamp), that would be recognized by the voting system simply as \"no balance - no voting power\". Users should be informed that they should make their votes before clearing their `account history`.\r\n\r\n##### Why do we even need this?\r\n> Let's imagine the same dead simple voting system that operates weighted votes (vote power) but without `account histories`. It wouldn't work, because there is a vulnerability - a malicious voter is able to vote multiple times simply voting and transferring their funds to another account and then voting again.\r\n\r\nOne can also easily imagine other use-cases for this token. For example, weighted dividends distribution system (the more tokens you possess, the more dividends you receive).\r\n\r\n### FAQ\r\n#### Are there another solutions?\r\n> I believe there is, but I couldn't find them to be as simple as the proposed one. This is why I'm making this github issue instead of submitting a PR with EIP - if there is a better solution, someone will just leave a comment about it here.\r\n\r\n#### Why is this cheaper?\r\n> This particular design can be easily implemented in `gradual-fashion` - when no bulk reads/writes are performed and only a little portion of data is modified per transaction. Also, the design is very simple and can be done in very compact implementation; less code - less errors and cheaper execution.\r\n\r\n#### Why should this token be an ERC?\r\n> As I mentioned above, this token can be useful for many DAOs (or other organizations).\r\n\r\n#### Who will be the champion of this EIP?\r\n> I will.",
  "closed_by": {
    "login": "seniorjoinu",
    "id": 15361624,
    "node_id": "MDQ6VXNlcjE1MzYxNjI0",
    "avatar_url": "https://avatars.githubusercontent.com/u/15361624?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/seniorjoinu",
    "html_url": "https://github.com/seniorjoinu",
    "followers_url": "https://api.github.com/users/seniorjoinu/followers",
    "following_url": "https://api.github.com/users/seniorjoinu/following{/other_user}",
    "gists_url": "https://api.github.com/users/seniorjoinu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/seniorjoinu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/seniorjoinu/subscriptions",
    "organizations_url": "https://api.github.com/users/seniorjoinu/orgs",
    "repos_url": "https://api.github.com/users/seniorjoinu/repos",
    "events_url": "https://api.github.com/users/seniorjoinu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/seniorjoinu/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/EIPs/issues/3196/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/EIPs/issues/3196/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/758360181",
    "html_url": "https://github.com/ethereum/EIPs/issues/3196#issuecomment-758360181",
    "issue_url": "https://api.github.com/repos/ethereum/EIPs/issues/3196",
    "id": 758360181,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1ODM2MDE4MQ==",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2021-01-12T02:53:00Z",
    "updated_at": "2021-01-12T02:53:00Z",
    "author_association": "NONE",
    "body": "Since this is your first issue, we kindly remind you to check out [EIP-1](https://eips.ethereum.org/EIPS/eip-1) for guidance.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/758360181/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/759843967",
    "html_url": "https://github.com/ethereum/EIPs/issues/3196#issuecomment-759843967",
    "issue_url": "https://api.github.com/repos/ethereum/EIPs/issues/3196",
    "id": 759843967,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1OTg0Mzk2Nw==",
    "user": {
      "login": "MicahZoltu",
      "id": 886059,
      "node_id": "MDQ6VXNlcjg4NjA1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886059?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MicahZoltu",
      "html_url": "https://github.com/MicahZoltu",
      "followers_url": "https://api.github.com/users/MicahZoltu/followers",
      "following_url": "https://api.github.com/users/MicahZoltu/following{/other_user}",
      "gists_url": "https://api.github.com/users/MicahZoltu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MicahZoltu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MicahZoltu/subscriptions",
      "organizations_url": "https://api.github.com/users/MicahZoltu/orgs",
      "repos_url": "https://api.github.com/users/MicahZoltu/repos",
      "events_url": "https://api.github.com/users/MicahZoltu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MicahZoltu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-14T00:28:03Z",
    "updated_at": "2021-01-14T00:28:03Z",
    "author_association": "MEMBER",
    "body": "You could save some gas by having `{ uint64 timestamp; uint192 balance; }` as a struct so it can be packed into a single storage slot.\r\n\r\nI'm not sure an EIP is necessary here because there isn't a many-to-many relationship that needs to be satisfied.  Standards are useful when interop is necessary.  When no interop is necessary, then something can just be a Good Idea and shared via GitHub, blog posts, libraries, etc.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/759843967/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/760120196",
    "html_url": "https://github.com/ethereum/EIPs/issues/3196#issuecomment-760120196",
    "issue_url": "https://api.github.com/repos/ethereum/EIPs/issues/3196",
    "id": 760120196,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MDEyMDE5Ng==",
    "user": {
      "login": "seniorjoinu",
      "id": 15361624,
      "node_id": "MDQ6VXNlcjE1MzYxNjI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/15361624?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/seniorjoinu",
      "html_url": "https://github.com/seniorjoinu",
      "followers_url": "https://api.github.com/users/seniorjoinu/followers",
      "following_url": "https://api.github.com/users/seniorjoinu/following{/other_user}",
      "gists_url": "https://api.github.com/users/seniorjoinu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/seniorjoinu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/seniorjoinu/subscriptions",
      "organizations_url": "https://api.github.com/users/seniorjoinu/orgs",
      "repos_url": "https://api.github.com/users/seniorjoinu/repos",
      "events_url": "https://api.github.com/users/seniorjoinu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/seniorjoinu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-14T10:55:17Z",
    "updated_at": "2021-01-14T10:55:17Z",
    "author_association": "NONE",
    "body": "Thank you. One more opinion and I'm closing it.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/760120196/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
