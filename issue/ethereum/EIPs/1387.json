{
  "url": "https://api.github.com/repos/ethereum/EIPs/issues/1387",
  "repository_url": "https://api.github.com/repos/ethereum/EIPs",
  "labels_url": "https://api.github.com/repos/ethereum/EIPs/issues/1387/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/EIPs/issues/1387/comments",
  "events_url": "https://api.github.com/repos/ethereum/EIPs/issues/1387/events",
  "html_url": "https://github.com/ethereum/EIPs/issues/1387",
  "id": 358270068,
  "node_id": "MDU6SXNzdWUzNTgyNzAwNjg=",
  "number": 1387,
  "title": "ERC1387 - Buy beer in a smart contract - Privacy enabled Merkle Tree Attestations",
  "user": {
    "login": "James-Sangalli",
    "id": 16630514,
    "node_id": "MDQ6VXNlcjE2NjMwNTE0",
    "avatar_url": "https://avatars.githubusercontent.com/u/16630514?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/James-Sangalli",
    "html_url": "https://github.com/James-Sangalli",
    "followers_url": "https://api.github.com/users/James-Sangalli/followers",
    "following_url": "https://api.github.com/users/James-Sangalli/following{/other_user}",
    "gists_url": "https://api.github.com/users/James-Sangalli/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/James-Sangalli/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/James-Sangalli/subscriptions",
    "organizations_url": "https://api.github.com/users/James-Sangalli/orgs",
    "repos_url": "https://api.github.com/users/James-Sangalli/repos",
    "events_url": "https://api.github.com/users/James-Sangalli/events{/privacy}",
    "received_events_url": "https://api.github.com/users/James-Sangalli/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2328627851,
      "node_id": "MDU6TGFiZWwyMzI4NjI3ODUx",
      "url": "https://api.github.com/repos/ethereum/EIPs/labels/stale",
      "name": "stale",
      "color": "000000",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2018-09-08T06:41:28Z",
  "updated_at": "2021-12-18T21:11:51Z",
  "closed_at": "2021-12-18T21:11:51Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## ERC - Merkle Tree Attestations\r\n\r\n### Introduction\r\n\r\nIt's often needed that an Ethereum smart contract must verify a claim (I live in Australia) attested by a valid attester.\r\n\r\nFor example, an ICO contract might require that the participant, Alice, lives in Australia before she participates. Alice's claim of residency could come from a local Justice of the Peace who could attest that \"Alice is a resident of Australia in NSW\".\r\n\r\nUnlike previous attempts, we assume that the attestation is signed and issued off the blockchain in a Merkle Tree format. Only a part of the Merkle tree is revealed by Alice at each use. Therefore we avoid the privacy problem often associated with issuing attestations on chain. We also assume that Alice has multiple signed Merkle Trees for the same factual claim to avoid her transactions being linkable.\r\n\r\n## Purpose\r\nThis ERC provides an interface and reference implementation for smart contracts that need users to provide an attestation and validate it.\r\n\r\n### Draft implementation\r\n```\r\ncontract MerkleTreeAttestationInterface {\r\n    struct Attestation\r\n    {\r\n        bytes32[] merklePath;\r\n        bool valid;\r\n        uint8 v;\r\n        bytes32 r;\r\n        bytes32 s;\r\n        address attester;\r\n        address recipient;\r\n        bytes32 salt;\r\n        bytes32 key;\r\n        bytes32 val;\r\n    }\r\n\r\n    function validate(Attestation attestation) public returns(bool);\r\n}\r\n\r\n```\r\n### Relevant implementation examples\r\n[Here](https://github.com/alpha-wallet/blockchain-attestation/blob/master/ethereum/lib/MerkleTreeAttestation.sol) is an example implementation of the MerkleTreeAttestationInterface\r\n[Here](https://github.com/alpha-wallet/blockchain-attestation/blob/master/ethereum/example-james-squire/james-squire.sol) is an example service which would use such a merkle tree attestation\r\n\r\n### Related ERC's\r\n#1388 #1386 \r\n\r\n### Copyright\r\nCopyright and related rights waived via CC0.",
  "closed_by": {
    "login": "github-actions[bot]",
    "id": 41898282,
    "node_id": "MDM6Qm90NDE4OTgyODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/github-actions%5Bbot%5D",
    "html_url": "https://github.com/apps/github-actions",
    "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/EIPs/issues/1387/reactions",
    "total_count": 4,
    "+1": 4,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/EIPs/issues/1387/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/421986300",
    "html_url": "https://github.com/ethereum/EIPs/issues/1387#issuecomment-421986300",
    "issue_url": "https://api.github.com/repos/ethereum/EIPs/issues/1387",
    "id": 421986300,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMTk4NjMwMA==",
    "user": {
      "login": "PhABC",
      "id": 9306422,
      "node_id": "MDQ6VXNlcjkzMDY0MjI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9306422?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PhABC",
      "html_url": "https://github.com/PhABC",
      "followers_url": "https://api.github.com/users/PhABC/followers",
      "following_url": "https://api.github.com/users/PhABC/following{/other_user}",
      "gists_url": "https://api.github.com/users/PhABC/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PhABC/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PhABC/subscriptions",
      "organizations_url": "https://api.github.com/users/PhABC/orgs",
      "repos_url": "https://api.github.com/users/PhABC/repos",
      "events_url": "https://api.github.com/users/PhABC/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PhABC/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-17T12:02:00Z",
    "updated_at": "2018-09-17T12:02:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "Instead of a merkle tree, why not just signed messages directly? Few arguments : \r\n\r\n1. Verifying a merkle proof is more expensive than just a signed message.\r\n2. Merkle tree are inflexible, meaning you can't update the whitelist without storing a new root and recontacting everyone to provide new merkle proofs.\r\n\r\nI'm not sure what more privacy a Merkle tree provides, but perhaps I am misunderstanding the workflow. \r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/421986300/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/422313833",
    "html_url": "https://github.com/ethereum/EIPs/issues/1387#issuecomment-422313833",
    "issue_url": "https://api.github.com/repos/ethereum/EIPs/issues/1387",
    "id": 422313833,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMjMxMzgzMw==",
    "user": {
      "login": "James-Sangalli",
      "id": 16630514,
      "node_id": "MDQ6VXNlcjE2NjMwNTE0",
      "avatar_url": "https://avatars.githubusercontent.com/u/16630514?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/James-Sangalli",
      "html_url": "https://github.com/James-Sangalli",
      "followers_url": "https://api.github.com/users/James-Sangalli/followers",
      "following_url": "https://api.github.com/users/James-Sangalli/following{/other_user}",
      "gists_url": "https://api.github.com/users/James-Sangalli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/James-Sangalli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/James-Sangalli/subscriptions",
      "organizations_url": "https://api.github.com/users/James-Sangalli/orgs",
      "repos_url": "https://api.github.com/users/James-Sangalli/repos",
      "events_url": "https://api.github.com/users/James-Sangalli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/James-Sangalli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-18T08:59:32Z",
    "updated_at": "2019-08-29T03:55:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @PhABC Thanks for your comment! \r\n\r\nWe choose to use merkle trees because it will allow multiple different predicates and predicate combos to be used from one root signature; e.g. above 16, above 18, isAnAustralianResident etc. \r\n\r\nIf we just sign messages directly, there could potentially be millions of different combos which would all require a signature and message to be stored inside the users mobile phone. In contrast, a merkle tree will only require a single root signature and can be used for all the predicates that are compatible with the attestation. \r\n\r\nAs for privacy, with a merkle tree you can salt it and use it for multiple predicates with proof it came from the origin. While you could keep this level of privacy with individual signatures, you cannot link them back to the origin and you have many different signatures and messages to store. \r\n\r\nAn attestor may also have different levels of attestation with different implications, for example, a drivers license is a stronger form of identity than a school ID, but the authority might be able to issue both types. \r\n\r\nThe tree structure can also be standardized so that everyone has a consistent format while revocations/additions to a whitelist are stored elsewhere (see #1386 & #1388); similar to how cacerts are listed.\r\n\r\nIn other words, the main benefits of a merkle tree structure is linkability to the source attestation, privacy (only reveal one node) and the ability to distinguish between attestation types.  \r\n\r\nHope this clarifies your questions! \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/422313833/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/422854355",
    "html_url": "https://github.com/ethereum/EIPs/issues/1387#issuecomment-422854355",
    "issue_url": "https://api.github.com/repos/ethereum/EIPs/issues/1387",
    "id": 422854355,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMjg1NDM1NQ==",
    "user": {
      "login": "James-Sangalli",
      "id": 16630514,
      "node_id": "MDQ6VXNlcjE2NjMwNTE0",
      "avatar_url": "https://avatars.githubusercontent.com/u/16630514?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/James-Sangalli",
      "html_url": "https://github.com/James-Sangalli",
      "followers_url": "https://api.github.com/users/James-Sangalli/followers",
      "following_url": "https://api.github.com/users/James-Sangalli/following{/other_user}",
      "gists_url": "https://api.github.com/users/James-Sangalli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/James-Sangalli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/James-Sangalli/subscriptions",
      "organizations_url": "https://api.github.com/users/James-Sangalli/orgs",
      "repos_url": "https://api.github.com/users/James-Sangalli/repos",
      "events_url": "https://api.github.com/users/James-Sangalli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/James-Sangalli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-19T15:47:25Z",
    "updated_at": "2018-09-19T15:47:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "@PhABC this might be of help: https://www.linkedin.com/pulse/merkle-tree-forgotten-university-melbourne-blockchain-wei-wu-zhang/",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/422854355/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/495399701",
    "html_url": "https://github.com/ethereum/EIPs/issues/1387#issuecomment-495399701",
    "issue_url": "https://api.github.com/repos/ethereum/EIPs/issues/1387",
    "id": 495399701,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5NTM5OTcwMQ==",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-23T21:56:57Z",
    "updated_at": "2019-05-23T21:56:57Z",
    "author_association": "MEMBER",
    "body": "@James-Sangalli this EIP doesn't have a copyright statement. Can you please add one? EIP-1 suggests CC0 - see the `eip-x.md` template.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/495399701/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/986093397",
    "html_url": "https://github.com/ethereum/EIPs/issues/1387#issuecomment-986093397",
    "issue_url": "https://api.github.com/repos/ethereum/EIPs/issues/1387",
    "id": 986093397,
    "node_id": "IC_kwDOAq426M46xpdV",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2021-12-04T21:11:14Z",
    "updated_at": "2021-12-04T21:11:14Z",
    "author_association": "NONE",
    "body": "There has been no activity on this issue for two months. It will be closed in a week if no further activity occurs. If you would like to move this EIP forward, please respond to any outstanding feedback or add a comment indicating that you have addressed all required feedback and are ready for a review.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/986093397/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/997285312",
    "html_url": "https://github.com/ethereum/EIPs/issues/1387#issuecomment-997285312",
    "issue_url": "https://api.github.com/repos/ethereum/EIPs/issues/1387",
    "id": 997285312,
    "node_id": "IC_kwDOAq426M47cV3A",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2021-12-18T21:11:51Z",
    "updated_at": "2021-12-18T21:11:51Z",
    "author_association": "NONE",
    "body": "This issue was closed due to inactivity. If you are still pursuing it, feel free to reopen it and respond to any feedback or request a review in a comment.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/997285312/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
