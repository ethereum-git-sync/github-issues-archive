{
  "url": "https://api.github.com/repos/ethereum/EIPs/issues/4804",
  "repository_url": "https://api.github.com/repos/ethereum/EIPs",
  "labels_url": "https://api.github.com/repos/ethereum/EIPs/issues/4804/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/EIPs/issues/4804/comments",
  "events_url": "https://api.github.com/repos/ethereum/EIPs/issues/4804/events",
  "html_url": "https://github.com/ethereum/EIPs/issues/4804",
  "id": 1137914403,
  "node_id": "I_kwDOAq426M5D0zIj",
  "number": 4804,
  "title": "EIP-4804: Web3",
  "user": {
    "login": "qizhou",
    "id": 2541286,
    "node_id": "MDQ6VXNlcjI1NDEyODY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2541286?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/qizhou",
    "html_url": "https://github.com/qizhou",
    "followers_url": "https://api.github.com/users/qizhou/followers",
    "following_url": "https://api.github.com/users/qizhou/following{/other_user}",
    "gists_url": "https://api.github.com/users/qizhou/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/qizhou/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/qizhou/subscriptions",
    "organizations_url": "https://api.github.com/users/qizhou/orgs",
    "repos_url": "https://api.github.com/users/qizhou/repos",
    "events_url": "https://api.github.com/users/qizhou/events{/privacy}",
    "received_events_url": "https://api.github.com/users/qizhou/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-02-14T22:16:48Z",
  "updated_at": "2022-07-18T18:08:53Z",
  "closed_at": "2022-02-15T07:07:30Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "---\r\neip: 4804\r\ntitle: Web3 URL to EVM Call Message Translation\r\nauthor: Qi Zhou (@qizhou)\r\ndiscussions-to: https://ethereum-magicians.org/t/eip-4804-web3-url-to-evm-call-message-translation/8300\r\ntype: Standards Track\r\ncategory: ERC\r\nstatus: Draft\r\ncreated: 2022-02-14\r\nrequires: N/A\r\n---\r\n\r\n## Simple Summary\r\n\r\nA translation of an HTTP-style Web3 URL to an EVM call message\r\n\r\n## Abstract\r\n\r\nThe standard translates an HTTP-style Web3 URL like\r\n\r\n```web3://uniswap.eth/```\r\n\r\nto an EVM message such as \r\n```\r\nEVMMessage {\r\n   To: 0xaabbccddee.... // where uniswap.eth's address registered at ENS\r\n   Calldata: 0x\r\n   ...\r\n}\r\n```\r\n## Motivation\r\n\r\nCurrently, reading data from Web3 generally relies on a translation done by a Web2 proxy to Web3 blockchain.  The translation is mostly done by the proxies such as dApp webistes/node service provider/etherscan, which are out of the control of users.  The standard here aims to provide a simple way for Web2 users to directly access the content of Web3.\r\n\r\n## Specification\r\n\r\nThe specification here only specifies for the read EVM message.  Write message will be defined in the future EIPs.\r\n\r\nA Web3 URL is in the following form\r\n\r\n```\r\nWeb3URL = \"web3://\" [userinfo \"@\"] contractName [\":\" chainid] path\r\ncontractName = [ address | name \".\" nsProvider]\r\npath = [\"/\" method [\"/\" argument_0 [\"/\" argument_1 ... ]]]\r\nargument = [type \"#\"] value\r\n```\r\nwhere \r\n- \"web3://\" indicates the Web3 URL **schema**.\r\n- **userinfo** indicates which user is calling the EVM, i.e., \"From\" field in EVM call message.  If not specified, the protocol will use 0x0 as the sender address.\r\n- **contractName** indicates the contract to be called, i.e., \"To\" field in the EVM call message. If the **contractName** is an **address**, i.e., 0x + 20-byte-data hex, then \"To\" will be the address.  Otherwise, the name is from a name service.  In the second case, **nsProvider** will be the short name of name service providers such as \"ens\", \"w3q\", etc.  The way to translate the name from a name service to an address will be defined in future EIPs.\r\n- **chainid** indicates which chain to call the message.  If not specified, the protocol will use the same chain as the name service provider, e.g., 1 for eth, and 333 for w3q.  If no name service provider is available, the default chainid is 1.\r\n\r\n### Resolver Mode\r\n\r\nOnce the \"To\" address and chainid are determined, the protocol will check the resolver mode of contract by calling \"resolverMode\" method.  The protocol currently supports two resolver modes:\r\n#### Manual Mode\r\nThe manual mode will not do any interpretation of **path**, and put **path** as calldata of the message directly.\r\n\r\n#### Auto Mode\r\nThe auto mode is the default mode of resolver (also applies when the \"resolverMode\" method is unavailable in the target contract).  In the auto mode, if **path** is empty, then the protocol will call the target contract with empty calldata.  Otherwise, the calldata of the EVM message will use standard Eterheum contract ABI https://docs.soliditylang.org/en/v0.8.3/abi-spec.html, where\r\n- **method** is a string of function method be called\r\n- **argument_i** is the ith argument of the method.  If **type** is specified, the value will be translated to the corresponding type.  The protocol currently supports the basic types such as uint256, bytes32, address, and bytes.  If **type** is not specific, then the type will be automatically detected using the following rule\r\n1. **type** = \"uint256\", if **value** is numeric\r\n2. **type**=\"bytes32\", if **value** is in the form of 0x+32-byte-data hex\r\n3. **type**=\"address\", if **value** is in the form of 0x+20-byte-data hex\r\n4. else **type**=\"bytes\"\r\n\r\n## Examples\r\n\r\n#### Example 1\r\n``` web3://uniswap.eth ```\r\n\r\nThe protocol will find the address of **uniswap.eth** from ENS, and then call the address with \"From\" = \"0x00...0\" and \"Calldata\" = \"0x\" with chainid = 1.\r\n\r\n#### Example 2\r\n```web3://opensea.eth:333```\r\n\r\nThe protocol will find the address of **opensea.eth** from ENS, and then call the address with \"From\" = \"0x00...0\" and \"Calldata\" = \"0x\" with chainid = 333.\r\n\r\n#### Example 3\r\n```web3://twitter.w3q/view/15235234234234```\r\n\r\nThe protocol will find the address of **twitter.w3q** from W3NS, and then call the address with \"From\" = \"0x00...0\" and \"Calldata\" = \"0x\" + keccak(\"view(uint256)\")[0:4] + abi.encode(uint256(15235234234234)) with chainid = 333.\r\n\r\n#### Exmaple 4\r\n```web3://qizhou.w3q/files/index.html```\r\n\r\nThe protocol will find the address of **qizhou.w3q** from W3NS, and then call the address with \"From\" = \"0x00...0\" and \"Calldata\" = \"0x\" + keccak(\"files(bytes)\")[0:4] + abi.encode(bytes(\"index.html\")) with chainid = 333.\r\n\r\n## Copyright\r\n\r\nCopyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/).",
  "closed_by": {
    "login": "MicahZoltu",
    "id": 886059,
    "node_id": "MDQ6VXNlcjg4NjA1OQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/886059?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/MicahZoltu",
    "html_url": "https://github.com/MicahZoltu",
    "followers_url": "https://api.github.com/users/MicahZoltu/followers",
    "following_url": "https://api.github.com/users/MicahZoltu/following{/other_user}",
    "gists_url": "https://api.github.com/users/MicahZoltu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/MicahZoltu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/MicahZoltu/subscriptions",
    "organizations_url": "https://api.github.com/users/MicahZoltu/orgs",
    "repos_url": "https://api.github.com/users/MicahZoltu/repos",
    "events_url": "https://api.github.com/users/MicahZoltu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/MicahZoltu/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/EIPs/issues/4804/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/EIPs/issues/4804/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/1039927600",
    "html_url": "https://github.com/ethereum/EIPs/issues/4804#issuecomment-1039927600",
    "issue_url": "https://api.github.com/repos/ethereum/EIPs/issues/4804",
    "id": 1039927600,
    "node_id": "IC_kwDOAq426M49_Akw",
    "user": {
      "login": "MicahZoltu",
      "id": 886059,
      "node_id": "MDQ6VXNlcjg4NjA1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886059?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MicahZoltu",
      "html_url": "https://github.com/MicahZoltu",
      "followers_url": "https://api.github.com/users/MicahZoltu/followers",
      "following_url": "https://api.github.com/users/MicahZoltu/following{/other_user}",
      "gists_url": "https://api.github.com/users/MicahZoltu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MicahZoltu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MicahZoltu/subscriptions",
      "organizations_url": "https://api.github.com/users/MicahZoltu/orgs",
      "repos_url": "https://api.github.com/users/MicahZoltu/repos",
      "events_url": "https://api.github.com/users/MicahZoltu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MicahZoltu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-15T07:07:30Z",
    "updated_at": "2022-02-15T07:07:30Z",
    "author_association": "MEMBER",
    "body": "Please either open a pull request with this EIP if you are ready to submit a draft, or create a thread on Ethereum Magicians forum to discuss it if you aren't ready to create a draft yet.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/EIPs/issues/comments/1039927600/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
