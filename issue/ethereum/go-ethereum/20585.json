{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20585",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20585/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20585/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20585/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/20585",
  "id": 552722368,
  "node_id": "MDU6SXNzdWU1NTI3MjIzNjg=",
  "number": 20585,
  "title": "segmentation violation on interrupt",
  "user": {
    "login": "businessfriendlyusername",
    "id": 44851744,
    "node_id": "MDQ6VXNlcjQ0ODUxNzQ0",
    "avatar_url": "https://avatars.githubusercontent.com/u/44851744?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/businessfriendlyusername",
    "html_url": "https://github.com/businessfriendlyusername",
    "followers_url": "https://api.github.com/users/businessfriendlyusername/followers",
    "following_url": "https://api.github.com/users/businessfriendlyusername/following{/other_user}",
    "gists_url": "https://api.github.com/users/businessfriendlyusername/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/businessfriendlyusername/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/businessfriendlyusername/subscriptions",
    "organizations_url": "https://api.github.com/users/businessfriendlyusername/orgs",
    "repos_url": "https://api.github.com/users/businessfriendlyusername/repos",
    "events_url": "https://api.github.com/users/businessfriendlyusername/events{/privacy}",
    "received_events_url": "https://api.github.com/users/businessfriendlyusername/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-01-21T09:20:23Z",
  "updated_at": "2021-06-03T09:02:29Z",
  "closed_at": "2021-06-03T09:02:29Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: `1.9.10-stable`\r\nOS & Version: Ubuntu 18.04.3\r\nCommit hash : 58cf5686eab9019cc01e202e846a6bbc70a3301d\r\n\r\n#### Expected behaviour\r\nexpected graceful shutdown on keyboard interrupt\r\n\r\n#### Actual behaviour\r\n\r\nsegmentation violation\r\n```\r\nINFO [01-21|01:07:26.843] Got interrupt, shutting down... \r\nINFO [01-21|01:07:27.044] Imported new state entries               count=366  elapsed=1.227ms      processed=63737646 pending=8865  retry=0   duplicate=139 unexpected=1055\r\nINFO [01-21|01:07:27.058] IPC endpoint closed                      url=/home/USER/.ethereum/geth.ipc\r\nINFO [01-21|01:07:27.249] Blockchain manager stopped \r\nINFO [01-21|01:07:27.289] Stopping Ethereum protocol \r\nINFO [01-21|01:07:27.332] Ethereum protocol stopped \r\nINFO [01-21|01:07:27.332] Transaction pool stopped \r\npanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x957723]\r\n```\r\n#### Steps to reproduce the behaviour\r\nnot reproducible to my knowledge\r\n\r\n#### Backtrace\r\n\r\n```\r\npanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x957723]\r\n\r\ngoroutine 32039 [running]:\r\ngithub.com/ethereum/go-ethereum/core/types.(*Block).NumberU64(...)\r\n\t/build/ethereum-k5K5KF/ethereum-1.9.10+build21009+bionic/core/types/block.go:309\r\ngithub.com/ethereum/go-ethereum/core.(*BlockChain).Rollback(0xc004dae000, 0xc02fd29800, 0x12b, 0x12b)\r\n\t/build/ethereum-k5K5KF/ethereum-1.9.10+build21009+bionic/core/blockchain.go:921 +0x5a3\r\ngithub.com/ethereum/go-ethereum/eth/downloader.(*Downloader).processHeaders.func1(0xc024639d90, 0xc004fe0000)\r\n\t/build/ethereum-k5K5KF/ethereum-1.9.10+build21009+bionic/eth/downloader/downloader.go:1374 +0x1e5\r\ngithub.com/ethereum/go-ethereum/eth/downloader.(*Downloader).processHeaders(0xc004fe0000, 0x8e45a8, 0x8e4441, 0xc0ef3feec0, 0x13d6180, 0xc0001d2490)\r\n\t/build/ethereum-k5K5KF/ethereum-1.9.10+build21009+bionic/eth/downloader/downloader.go:1393 +0x12cc\r\ngithub.com/ethereum/go-ethereum/eth/downloader.(*Downloader).syncWithPeer.func6(0xc0137a4f70, 0x671efb301529ee16)\r\n\t/build/ethereum-k5K5KF/ethereum-1.9.10+build21009+bionic/eth/downloader/downloader.go:517 +0x48\r\ngithub.com/ethereum/go-ethereum/eth/downloader.(*Downloader).spawnSync.func1(0xc004fe0000, 0xc01724b200, 0xc0130e05d0)\r\n\t/build/ethereum-k5K5KF/ethereum-1.9.10+build21009+bionic/eth/downloader/downloader.go:534 +0x63\r\ncreated by github.com/ethereum/go-ethereum/eth/downloader.(*Downloader).spawnSync\r\n\t/build/ethereum-k5K5KF/ethereum-1.9.10+build21009+bionic/eth/downloader/downloader.go:534 +0xaf\r\n\r\n```",
  "closed_by": {
    "login": "ligi",
    "id": 111600,
    "node_id": "MDQ6VXNlcjExMTYwMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/111600?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ligi",
    "html_url": "https://github.com/ligi",
    "followers_url": "https://api.github.com/users/ligi/followers",
    "following_url": "https://api.github.com/users/ligi/following{/other_user}",
    "gists_url": "https://api.github.com/users/ligi/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ligi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ligi/subscriptions",
    "organizations_url": "https://api.github.com/users/ligi/orgs",
    "repos_url": "https://api.github.com/users/ligi/repos",
    "events_url": "https://api.github.com/users/ligi/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ligi/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20585/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20585/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/584726941",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20585#issuecomment-584726941",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20585",
    "id": 584726941,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NDcyNjk0MQ==",
    "user": {
      "login": "timkuijsten",
      "id": 321966,
      "node_id": "MDQ6VXNlcjMyMTk2Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/321966?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/timkuijsten",
      "html_url": "https://github.com/timkuijsten",
      "followers_url": "https://api.github.com/users/timkuijsten/followers",
      "following_url": "https://api.github.com/users/timkuijsten/following{/other_user}",
      "gists_url": "https://api.github.com/users/timkuijsten/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/timkuijsten/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/timkuijsten/subscriptions",
      "organizations_url": "https://api.github.com/users/timkuijsten/orgs",
      "repos_url": "https://api.github.com/users/timkuijsten/repos",
      "events_url": "https://api.github.com/users/timkuijsten/events{/privacy}",
      "received_events_url": "https://api.github.com/users/timkuijsten/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-11T16:38:11Z",
    "updated_at": "2020-02-11T16:38:11Z",
    "author_association": "NONE",
    "body": "I can confirm the same issue with geth 1.9.10-stable on macOS 10.15.2.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/584726941/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/588694434",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20585#issuecomment-588694434",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20585",
    "id": 588694434,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4ODY5NDQzNA==",
    "user": {
      "login": "PyrateAkananto",
      "id": 11444373,
      "node_id": "MDQ6VXNlcjExNDQ0Mzcz",
      "avatar_url": "https://avatars.githubusercontent.com/u/11444373?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PyrateAkananto",
      "html_url": "https://github.com/PyrateAkananto",
      "followers_url": "https://api.github.com/users/PyrateAkananto/followers",
      "following_url": "https://api.github.com/users/PyrateAkananto/following{/other_user}",
      "gists_url": "https://api.github.com/users/PyrateAkananto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PyrateAkananto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PyrateAkananto/subscriptions",
      "organizations_url": "https://api.github.com/users/PyrateAkananto/orgs",
      "repos_url": "https://api.github.com/users/PyrateAkananto/repos",
      "events_url": "https://api.github.com/users/PyrateAkananto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PyrateAkananto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-20T07:43:26Z",
    "updated_at": "2020-02-20T07:43:26Z",
    "author_association": "NONE",
    "body": "I can confirm the same issue with geth 1.9.10 on Windows 10 (`geth-windows-amd64-1.9.10-58cf5686.zip`). Happens every time I press Ctrl-C within the `cmd.exe` window. `geth.exe` was started with `--syncmode fast`. Never fully syncs, always around 100 blocks missing.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/588694434/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/594414521",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20585#issuecomment-594414521",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20585",
    "id": 594414521,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5NDQxNDUyMQ==",
    "user": {
      "login": "PyrateAkananto",
      "id": 11444373,
      "node_id": "MDQ6VXNlcjExNDQ0Mzcz",
      "avatar_url": "https://avatars.githubusercontent.com/u/11444373?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PyrateAkananto",
      "html_url": "https://github.com/PyrateAkananto",
      "followers_url": "https://api.github.com/users/PyrateAkananto/followers",
      "following_url": "https://api.github.com/users/PyrateAkananto/following{/other_user}",
      "gists_url": "https://api.github.com/users/PyrateAkananto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PyrateAkananto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PyrateAkananto/subscriptions",
      "organizations_url": "https://api.github.com/users/PyrateAkananto/orgs",
      "repos_url": "https://api.github.com/users/PyrateAkananto/repos",
      "events_url": "https://api.github.com/users/PyrateAkananto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PyrateAkananto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-03-04T09:29:46Z",
    "updated_at": "2020-03-04T09:29:46Z",
    "author_association": "NONE",
    "body": "Still happens with geth 1.9.11 on Windows 10 (`geth-windows-amd64-1.9.11-6a62fe39.zip`).\r\n\r\n```\r\nINFO [03-04|10:27:12.082] Got interrupt, shutting down...\r\nINFO [03-04|10:27:12.602] HTTP endpoint closed                     url=http://127.0.0.1:8545\r\nINFO [03-04|10:27:12.605] IPC endpoint closed                      url=\\\\\\\\.\\\\pipe\\\\geth.ipc\r\nINFO [03-04|10:27:12.608] Blockchain manager stopped\r\nINFO [03-04|10:27:12.668] Stopping Ethereum protocol\r\nINFO [03-04|10:27:12.672] Ethereum protocol stopped\r\nINFO [03-04|10:27:12.673] Transaction pool stopped\r\nWARN [03-04|10:27:12.876] Synchronisation failed, retrying         err=\"DB write error: leveldb: closed\"\r\nINFO [03-04|10:27:12.894] Initialized fast sync bloom              items=6462708 errorrate=0.000 elapsed=3m38.684s\r\npanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal 0xc0000005 code=0x0 addr=0x1c0 pc=0x95fe19]\r\n\r\ngoroutine 494 [running]:\r\ngithub.com/ethereum/go-ethereum/core.(*HeaderChain).SetCurrentHeader(0xc0000c4360, 0x0)\r\n        C:/gopath/src/github.com/ethereum/go-ethereum/core/headerchain.go:477 +0xa9\r\ngithub.com/ethereum/go-ethereum/core.(*BlockChain).Rollback(0xc000e86000, 0xc089cd0000, 0x800, 0x800)\r\n        C:/gopath/src/github.com/ethereum/go-ethereum/core/blockchain.go:915 +0x380\r\ngithub.com/ethereum/go-ethereum/eth/downloader.(*Downloader).processHeaders.func1(0xc07128bd90, 0xc00061e000)\r\n        C:/gopath/src/github.com/ethereum/go-ethereum/eth/downloader/downloader.go:1374 +0x1ec\r\ngithub.com/ethereum/go-ethereum/eth/downloader.(*Downloader).processHeaders(0xc00061e000, 0x71b41f, 0x71b3d7, 0xc003eea240, 0x16bd540, 0xc0000f1c00)\r\n        C:/gopath/src/github.com/ethereum/go-ethereum/eth/downloader/downloader.go:1393 +0x12d3\r\ngithub.com/ethereum/go-ethereum/eth/downloader.(*Downloader).syncWithPeer.func6(0xc04c41ff70, 0xa932c7)\r\n        C:/gopath/src/github.com/ethereum/go-ethereum/eth/downloader/downloader.go:517 +0x4f\r\ngithub.com/ethereum/go-ethereum/eth/downloader.(*Downloader).spawnSync.func1(0xc00061e000, 0xc006998f00, 0xc002dbc5a0)\r\n        C:/gopath/src/github.com/ethereum/go-ethereum/eth/downloader/downloader.go:534 +0x6a\r\ncreated by github.com/ethereum/go-ethereum/eth/downloader.(*Downloader).spawnSync\r\n        C:/gopath/src/github.com/ethereum/go-ethereum/eth/downloader/downloader.go:534 +0xb6\r\nBatchvorgang abbrechen (J/N)?\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/594414521/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/853710927",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20585#issuecomment-853710927",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20585",
    "id": 853710927,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MzcxMDkyNw==",
    "user": {
      "login": "ligi",
      "id": 111600,
      "node_id": "MDQ6VXNlcjExMTYwMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/111600?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ligi",
      "html_url": "https://github.com/ligi",
      "followers_url": "https://api.github.com/users/ligi/followers",
      "following_url": "https://api.github.com/users/ligi/following{/other_user}",
      "gists_url": "https://api.github.com/users/ligi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ligi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ligi/subscriptions",
      "organizations_url": "https://api.github.com/users/ligi/orgs",
      "repos_url": "https://api.github.com/users/ligi/repos",
      "events_url": "https://api.github.com/users/ligi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ligi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-03T09:02:29Z",
    "updated_at": "2021-06-03T09:02:29Z",
    "author_association": "MEMBER",
    "body": "This should not happen anymore - if it does again please reopen.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/853710927/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
