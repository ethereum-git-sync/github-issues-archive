{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25004",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25004/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25004/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25004/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/25004",
  "id": 1255689813,
  "node_id": "I_kwDOAOvK985K2E5V",
  "number": 25004,
  "title": "POA private network integration testing, rarely returns replacement transaction underpriced",
  "user": {
    "login": "anthonyoliai",
    "id": 61785803,
    "node_id": "MDQ6VXNlcjYxNzg1ODAz",
    "avatar_url": "https://avatars.githubusercontent.com/u/61785803?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/anthonyoliai",
    "html_url": "https://github.com/anthonyoliai",
    "followers_url": "https://api.github.com/users/anthonyoliai/followers",
    "following_url": "https://api.github.com/users/anthonyoliai/following{/other_user}",
    "gists_url": "https://api.github.com/users/anthonyoliai/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/anthonyoliai/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/anthonyoliai/subscriptions",
    "organizations_url": "https://api.github.com/users/anthonyoliai/orgs",
    "repos_url": "https://api.github.com/users/anthonyoliai/repos",
    "events_url": "https://api.github.com/users/anthonyoliai/events{/privacy}",
    "received_events_url": "https://api.github.com/users/anthonyoliai/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 268304226,
      "node_id": "MDU6TGFiZWwyNjgzMDQyMjY=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:docs",
      "name": "type:docs",
      "color": "fef2c0",
      "default": false,
      "description": null
    },
    {
      "id": 1132689577,
      "node_id": "MDU6TGFiZWwxMTMyNjg5NTc3",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/status:triage",
      "name": "status:triage",
      "color": "6be514",
      "default": false,
      "description": ""
    },
    {
      "id": 1132754722,
      "node_id": "MDU6TGFiZWwxMTMyNzU0NzIy",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/need:more-information",
      "name": "need:more-information",
      "color": "db6fa3",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-06-01T11:03:28Z",
  "updated_at": "2022-06-16T08:29:30Z",
  "closed_at": "2022-06-16T08:29:30Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi, i've been using abigen to generate go code to simplify interactions (do unit tests & integration tests) on my smart contracts,  which are deployed on my private network. One issue I am facing right now is that on rare occasions I get a `replacement transaction underpriced` when running the tests, everytime, for one specific tx. E.g\r\n\r\nTX 1 submitted, mined and concluded within a block\r\nTX 2 submitted, mined and concluded within a block\r\nTX 3 submitted, ERROR: replacement transaction underpriced\r\nTX 4 submitted, mined and concluded within a block\r\n\r\nI am running the tests within a CI, using docker to boot up a private POA node which consists of the smart contracts. Due to this behaviour my CI run sometimes fails, albeit not often.\r\n\r\nI run about 20 transactions one after another, waiting for each transaction to be mined first, before submitting the next one. (I'm using WaitMined for that). \r\n\r\nUsing abigen, and \"Transact\" which comes with the generated contract go code,  I assume the nonces are managed automatically, when the tx are submitted.\r\n\r\nOne thing to note is that I changed the gasprice of the transactions\r\n`opts.GasPrice = big.NewInt(1000000000) `\r\n\r\nHowever when I boot up the node, all the transactions that are submitted have exactly this same gas price. So it's not like 1 tx during the test has a different gas price set than another tx. \r\n\r\nCould this be one of the causes?\r\n\r\nI'm using `geth@v1.10.15`.",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25004/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25004/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1144584100",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25004#issuecomment-1144584100",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25004",
    "id": 1144584100,
    "node_id": "IC_kwDOAOvK985EOPek",
    "user": {
      "login": "ligi",
      "id": 111600,
      "node_id": "MDQ6VXNlcjExMTYwMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/111600?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ligi",
      "html_url": "https://github.com/ligi",
      "followers_url": "https://api.github.com/users/ligi/followers",
      "following_url": "https://api.github.com/users/ligi/following{/other_user}",
      "gists_url": "https://api.github.com/users/ligi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ligi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ligi/subscriptions",
      "organizations_url": "https://api.github.com/users/ligi/orgs",
      "repos_url": "https://api.github.com/users/ligi/repos",
      "events_url": "https://api.github.com/users/ligi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ligi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-02T08:19:35Z",
    "updated_at": "2022-06-02T08:19:35Z",
    "author_association": "MEMBER",
    "body": "Can you provide logs and the code you use?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1144584100/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1144585570",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25004#issuecomment-1144585570",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25004",
    "id": 1144585570,
    "node_id": "IC_kwDOAOvK985EOP1i",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-02T08:21:14Z",
    "updated_at": "2022-06-02T08:21:14Z",
    "author_association": "MEMBER",
    "body": "It might be interesting to see what the root issue is, and we can investigate if you provide the code that you run on CI. \r\n\r\nHowever, I also think that you could solve this by just setting the 20 nonces sequentitally. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1144585570/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1157383174",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25004#issuecomment-1157383174",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25004",
    "id": 1157383174,
    "node_id": "IC_kwDOAOvK985E_EQG",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-16T08:29:30Z",
    "updated_at": "2022-06-16T08:29:30Z",
    "author_association": "MEMBER",
    "body": "Closing this due to inactivity",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1157383174/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
