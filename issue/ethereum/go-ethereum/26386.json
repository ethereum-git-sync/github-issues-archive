{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26386",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26386/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26386/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26386/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/26386",
  "id": 1511578375,
  "node_id": "I_kwDOAOvK985aGNsH",
  "number": 26386,
  "title": "geth not sync with fullnode sync mode",
  "user": {
    "login": "zaneran9",
    "id": 58467733,
    "node_id": "MDQ6VXNlcjU4NDY3NzMz",
    "avatar_url": "https://avatars.githubusercontent.com/u/58467733?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/zaneran9",
    "html_url": "https://github.com/zaneran9",
    "followers_url": "https://api.github.com/users/zaneran9/followers",
    "following_url": "https://api.github.com/users/zaneran9/following{/other_user}",
    "gists_url": "https://api.github.com/users/zaneran9/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/zaneran9/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/zaneran9/subscriptions",
    "organizations_url": "https://api.github.com/users/zaneran9/orgs",
    "repos_url": "https://api.github.com/users/zaneran9/repos",
    "events_url": "https://api.github.com/users/zaneran9/events{/privacy}",
    "received_events_url": "https://api.github.com/users/zaneran9/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-12-27T08:49:13Z",
  "updated_at": "2022-12-28T01:49:47Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: `1.10.23-stable`\r\nCL client & version: `prysm@v3.1.2`\r\nOS & Version: `Linux`\r\nCommit hash :  `d901d85377c2c2f05f09f423c7d739c0feecd90a`\r\n\r\n#### Expected behaviour\r\nrun stably\r\n\r\n#### Actual behaviour\r\nSometime yesterday I restarted the node, and then the node is no longer in sync, restarting it again or waiting for it to automatically repair does not take effect, is there a way to fix it? It takes too much time and resources to do another full node synchronization, thank youï¼\r\n\r\n#### Steps to reproduce the behaviour\r\n##### Server configs\r\n```\r\ncpu 64 (Intel(R) Xeon(R) CPU E5-2678 v3 @ 2.50GHz)\r\nmemory 64G\r\nhard disk(ssd) 4T\r\n```\r\n\r\n##### run command\r\n```\r\n/data/ethereum/execution/geth --identity prod2-geth --mainnet --networkid 1 --datadir=/data/chain/geth/main --authrpc.vhosts=\"localhost\" --authrpc.jwtsecret=/data/ethereum/consensus/jwt.hex --allow-insecure-unlock --syncmode=snap --http --http.addr 0.0.0.0 --http.port 31000 --http.api admin,web3,eth,txpool,personal,net --http.corsdomain * --http.vhosts * --ws --ws.addr 0.0.0.0 --ws.port 32000 --ws.api admin,web3,eth,txpool,personal,net --ws.origins * --maxpeers 100 --cache 4096\r\n```\r\n\r\n\r\n#### Backtrace\r\n\r\n````\r\n[backtrace]\r\n````\r\n\r\nWhen submitting logs: please submit them as text and not screenshots.\r\n[log here](https://raw.githubusercontent.com/zaneran9/logs/main/getherr2.log)",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26386/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26386/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1365768556",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/26386#issuecomment-1365768556",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26386",
    "id": 1365768556,
    "node_id": "IC_kwDOAOvK985RZ_ls",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-27T09:53:57Z",
    "updated_at": "2022-12-27T09:53:57Z",
    "author_association": "MEMBER",
    "body": "Sorry, I can't watch this without commenting: \r\nWhy are you using `--allow-insecure-unlock ` ? When binding to `--http.addr 0.0.0.0 `, what possible usecase do you have for doing `unlock` and giving access to anyone who happens to find your node on the internet? Especially since you are also exposing `--http.api admin,web3,eth,txpool,personal,net` ? \r\n\r\nAs for why the sync is failing, I am not sure. This seems to be the blocker: \r\n\r\n```\r\nINFO [12-26|20:17:35.739] Forkchoice requested sync to new head    number=16,268,286 hash=cbe843..8a3deb\r\nINFO [12-26|20:17:36.325] Forkchoice requested sync to new head    number=16,268,287 hash=9892cd..21c22e\r\nWARN [12-26|20:17:36.749] Snapshot extension registration failed   peer=88f932f1 err=\"peer connected on snap without compatible eth support\"\r\nINFO [12-26|20:17:36.909] Forkchoice requested sync to new head    number=16,268,288 hash=7e4277..d6dc49\r\nINFO [12-26|20:17:37.605] Forkchoice requested sync to new head    number=16,268,289 hash=77a35d..3042e4\r\nINFO [12-26|20:17:38.298] Forkchoice requested sync to new head    number=16,268,290 hash=cbe40b..872f5a\r\nINFO [12-26|20:17:38.952] Forkchoice requested sync to new head    number=16,268,291 hash=4ebd20..cc9cb5\r\nERROR[12-26|20:17:38.993] Beacon backfilling failed                err=\"retrieved hash chain is invalid: missing parent\"\r\nINFO [12-26|20:17:39.587] Forkchoice requested sync to new head    number=16,268,292 hash=b3552a..2b73ff\r\nINFO [12-26|20:17:40.216] Forkchoice requested sync to new head    number=16,268,293 hash=4e6677..83cdb0\r\nINFO [12-26|20:17:40.759] Forkchoice requested sync to new head    number=16,268,294 hash=ab7f72..bbfaa3\r\nINFO [12-26|20:17:40.811] Generating state snapshot                root=a68983..67f9bc in=008f65..483efb at=d5387b..56f0a7 accounts=396,801 slots=6,867,851 storage=595.86MiB dangling=0 elapsed=10m8.634s   eta=77h5m51.816s\r\nINFO [12-26|20:17:41.394] Forkchoice requested sync to new head    number=16,268,295 hash=1c6132..ec4f1b\r\nINFO [12-26|20:17:41.571] Downloader queue stats                   receiptTasks=0 blockTasks=455 itemSize=67.04KiB throttle=3911\r\n```\r\nBut I do not know why it happens. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1365768556/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1366021609",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/26386#issuecomment-1366021609",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26386",
    "id": 1366021609,
    "node_id": "IC_kwDOAOvK985Ra9Xp",
    "user": {
      "login": "Aheyachy",
      "id": 93622791,
      "node_id": "U_kgDOBZSSBw",
      "avatar_url": "https://avatars.githubusercontent.com/u/93622791?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Aheyachy",
      "html_url": "https://github.com/Aheyachy",
      "followers_url": "https://api.github.com/users/Aheyachy/followers",
      "following_url": "https://api.github.com/users/Aheyachy/following{/other_user}",
      "gists_url": "https://api.github.com/users/Aheyachy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Aheyachy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Aheyachy/subscriptions",
      "organizations_url": "https://api.github.com/users/Aheyachy/orgs",
      "repos_url": "https://api.github.com/users/Aheyachy/repos",
      "events_url": "https://api.github.com/users/Aheyachy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Aheyachy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-27T16:19:07Z",
    "updated_at": "2022-12-27T16:19:07Z",
    "author_association": "NONE",
    "body": "Hi",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1366021609/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1366307678",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/26386#issuecomment-1366307678",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26386",
    "id": 1366307678,
    "node_id": "IC_kwDOAOvK985RcDNe",
    "user": {
      "login": "zaneran9",
      "id": 58467733,
      "node_id": "MDQ6VXNlcjU4NDY3NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/58467733?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zaneran9",
      "html_url": "https://github.com/zaneran9",
      "followers_url": "https://api.github.com/users/zaneran9/followers",
      "following_url": "https://api.github.com/users/zaneran9/following{/other_user}",
      "gists_url": "https://api.github.com/users/zaneran9/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zaneran9/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zaneran9/subscriptions",
      "organizations_url": "https://api.github.com/users/zaneran9/orgs",
      "repos_url": "https://api.github.com/users/zaneran9/repos",
      "events_url": "https://api.github.com/users/zaneran9/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zaneran9/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-28T01:49:47Z",
    "updated_at": "2022-12-28T01:49:47Z",
    "author_association": "NONE",
    "body": "> \r\nThanks for your reply. \r\nI wonder if there is a way to fix it, like go back to some altitude in the past and have it resync or something? @holiman ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1366307678/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
