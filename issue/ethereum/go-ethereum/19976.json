{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19976",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19976/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19976/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19976/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/19976",
  "id": 481988348,
  "node_id": "MDU6SXNzdWU0ODE5ODgzNDg=",
  "number": 19976,
  "title": "PoA private network clique: call contract method but got: Uncaught (in promise) Error: Returned values aren't valid, did it run Out of Gas?",
  "user": {
    "login": "a10000005588",
    "id": 12505827,
    "node_id": "MDQ6VXNlcjEyNTA1ODI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/12505827?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/a10000005588",
    "html_url": "https://github.com/a10000005588",
    "followers_url": "https://api.github.com/users/a10000005588/followers",
    "following_url": "https://api.github.com/users/a10000005588/following{/other_user}",
    "gists_url": "https://api.github.com/users/a10000005588/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/a10000005588/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/a10000005588/subscriptions",
    "organizations_url": "https://api.github.com/users/a10000005588/orgs",
    "repos_url": "https://api.github.com/users/a10000005588/repos",
    "events_url": "https://api.github.com/users/a10000005588/events{/privacy}",
    "received_events_url": "https://api.github.com/users/a10000005588/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2019-08-18T12:28:28Z",
  "updated_at": "2019-10-03T22:34:33Z",
  "closed_at": "2019-08-19T12:46:14Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi there,\r\nWhen I created a 2 nodes private network with POA consensus and it works fine when I sent a simple transaction. \r\nBut when I deploy a simple contract `SimpleStorage.sol` with Truffle, I want to call the `get()` method by using the [myetherwallet](https://vintage.myetherwallet.com/#contracts), but it returns 0 , not 100. \r\n\r\nThe detailed of `SimpleStorage` is as shown below:\r\n```\r\npragma solidity >=0.4.17;\r\n\r\ncontract SimpleStorage {\r\n    uint storedData = 100;\r\n\r\n    function set(uint x) public {\r\n        storedData = x;\r\n    }\r\n\r\n    function get() public view returns (uint) {\r\n        return storedData;\r\n    }\r\n}\r\n```\r\n\r\n#### System information\r\n```\r\nGeth Version: 1.8.23-stable\r\nGit Commit: c942700427557e3ff6de3aaf6b916e2f056c1ec2\r\nArchitecture: amd64\r\nProtocol Versions: [63 62]\r\nNetwork Id: 1\r\nGo Version: go1.11.5\r\nOperating System: darwin (MacOs)\r\nGOPATH=\r\nGOROOT=/Users/travis/.gimme/versions/go1.11.5.darwin.amd64\r\n\r\nTruffle v5.0.7 (core: 5.0.7)\r\nSolidity v0.5.0 (solc-js)\r\nNode v9.10.0\r\n```\r\n\r\n#### Behavior to reproduce\r\n##### Genesis.json\r\n```\r\n{\r\n  \"config\": {\r\n    \"chainId\": 1515,\r\n    \"homesteadBlock\": 1,\r\n    \"eip150Block\": 2,\r\n    \"eip150Hash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n    \"eip155Block\": 3,\r\n    \"eip158Block\": 3,\r\n    \"byzantiumBlock\": 4,\r\n    \"clique\": {\r\n      \"period\": 2,\r\n      \"epoch\": 30000\r\n    }\r\n  },\r\n  \"nonce\": \"0x0\",\r\n  \"timestamp\": \"0x5d5769ad\",\r\n  \"extraData\": \"0x00000000000000000000000000000000000000000000000000000000000000003b50d35ed4032c984992ad0d757ba65338523919fc0f1c754a2dfa18640ce2a0950aea20d1d206940000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\r\n  \"gasLimit\": \"0x7FFFFFFFFFFFF\",\r\n  \"difficulty\": \"0x1\",\r\n  \"mixHash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n  \"coinbase\": \"0x0000000000000000000000000000000000000000\",\r\n  \"alloc\": {\r\n    \"3b50d35ed4032c984992ad0d757ba65338523919\": {\r\n      \"balance\": \"0x200000000000000000000000000000000000000000000000000000000000000\"\r\n    },\r\n    \"fc0f1c754a2dfa18640ce2a0950aea20d1d20694\": {\r\n      \"balance\": \"0x200000000000000000000000000000000000000000000000000000000000000\"\r\n    }\r\n  },\r\n  \"number\": \"0x0\",\r\n  \"gasUsed\": \"0x0\",\r\n  \"parentHash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\"\r\n}\r\n```\r\n\r\n##### Geth start command\r\n```\r\ngeth --datadir node1/ --syncmode 'full' --port 30312 --rpc --rpcaddr 0.0.0.0 --rpcport 8502 --rpccorsdomain \"*\" --ws --wsaddr 0.0.0.0 --wsport 8602 --wsorigins \"*\" --rpcapi admin,db,eth,debug,miner,net,shh,txpool,personal,web3 --wsapi admin,db,eth,debug,miner,net,shh,txpool,personal,web3 --bootnodes 'enode://4765bd12afddce5bb5a2ea55e58ffcdbade132a593bddd9f2723e18460b407039bf07e3fa851b12b0b20c8e0b4c2d3518c9578f201b4efe6ab4d9243e28cccaa@127.0.0.1:30310' --networkid 1515 --gasprice '1' -unlock '0x3b50d35ed4032c984992ad0d757ba65338523919' --password node1/password.txt --mine --targetgaslimit 2251799813685247\r\n```\r\n\r\n#### Truffle set up\r\n\r\ntruffle-config.js\r\n```\r\n\r\nmodule.exports = {\r\n  networks: {\r\n    geth: {\r\n      host: \"127.0.0.1\",\r\n      port: 8501,\r\n      from: \"0xfc0f1c754a2dfa18640ce2a0950aea20d1d20694\",\r\n      network_id: \"*\",\r\n      gasPrice: \"0x47B7600\",\r\n      gas: \"0x47B7600\"\r\n    }\r\n  },\r\n\r\n  // Set default mocha options here, use special reporters etc.\r\n  mocha: {\r\n    // timeout: 100000\r\n  },\r\n  // Configure your compilers\r\n  compilers: {\r\n    solc: {\r\n      // version: \"0.5.1\",    // Fetch exact version from solc-bin (default: truffle's version)\r\n      // docker: true,        // Use \"0.5.1\" you've installed locally with docker (default: false)\r\n      // settings: {          // See the solidity docs for advice about optimization and evmVersion\r\n      //  optimizer: {\r\n      //    enabled: false,\r\n      //    runs: 200\r\n      //  },\r\n      //  evmVersion: \"byzantium\"\r\n      // }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nmigration script\r\n```\r\ntruffle migrate --network geth --reset\r\n```\r\n\r\n#### Expected behaviour\r\nWhen called `get()` method, it should return `100`.\r\n\r\n#### Actual behaviour\r\nIt returned `0`\r\n\r\nI found that there's other one ran into the similar issue as me:\r\nhttps://stackoverflow.com/questions/57175052/one-of-ethereum-solidity-methods-is-not-working-properly-got-error-returned-valu\r\n\r\nCan anyone help me to address this issue? Thanks.",
  "closed_by": {
    "login": "a10000005588",
    "id": 12505827,
    "node_id": "MDQ6VXNlcjEyNTA1ODI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/12505827?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/a10000005588",
    "html_url": "https://github.com/a10000005588",
    "followers_url": "https://api.github.com/users/a10000005588/followers",
    "following_url": "https://api.github.com/users/a10000005588/following{/other_user}",
    "gists_url": "https://api.github.com/users/a10000005588/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/a10000005588/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/a10000005588/subscriptions",
    "organizations_url": "https://api.github.com/users/a10000005588/orgs",
    "repos_url": "https://api.github.com/users/a10000005588/repos",
    "events_url": "https://api.github.com/users/a10000005588/events{/privacy}",
    "received_events_url": "https://api.github.com/users/a10000005588/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19976/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19976/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/522524158",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19976#issuecomment-522524158",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19976",
    "id": 522524158,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMjUyNDE1OA==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-19T11:11:42Z",
    "updated_at": "2019-08-19T11:11:42Z",
    "author_association": "MEMBER",
    "body": "Latest Solidity compilers depend on features introduced in Constantinople. Please enable it for your own network. The simplest way (if you don't need to retain your old network) is to just restart a fresh one with Constantinople and Petersburg forks enabled:\r\n\r\n```\r\n  \"config\": {\r\n    \"chainId\": 1515,\r\n    \"homesteadBlock\": 0,\r\n    \"eip150Block\": 0,\r\n    \"eip155Block\": 0,\r\n    \"eip158Block\": 0,\r\n    \"byzantiumBlock\": 0,\r\n    \"constantinopleBlock\": 0,\r\n    \"petersburgBlock\": 0,\r\n    \"clique\": {\r\n      \"period\": 2,\r\n      \"epoch\": 30000\r\n    }\r\n  },\r\n```\r\n\r\nIf you want to retain your existing network, pick a block number that hasn't yet passed, and put that into of the `constantinopleBlock` and `petersburgBlock` fields.\r\n\r\n```\r\n  \"config\": {\r\n    \"chainId\": 1515,\r\n    \"homesteadBlock\": 1,\r\n    \"eip150Block\": 2,\r\n    \"eip155Block\": 3,\r\n    \"eip158Block\": 3,\r\n    \"byzantiumBlock\": 4,\r\n    \"byzantiumBlock\": SOME-FUTURE-BLOCK,\r\n    \"constantinopleBlock\": SOME-FUTURE-BLOCK,\r\n    \"clique\": {\r\n      \"period\": 2,\r\n      \"epoch\": 30000\r\n    }\r\n```\r\n\r\nThen reinit your nodes with the updated config via `geth init`.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/522524158/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/522556761",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19976#issuecomment-522556761",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19976",
    "id": 522556761,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMjU1Njc2MQ==",
    "user": {
      "login": "a10000005588",
      "id": 12505827,
      "node_id": "MDQ6VXNlcjEyNTA1ODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/12505827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/a10000005588",
      "html_url": "https://github.com/a10000005588",
      "followers_url": "https://api.github.com/users/a10000005588/followers",
      "following_url": "https://api.github.com/users/a10000005588/following{/other_user}",
      "gists_url": "https://api.github.com/users/a10000005588/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/a10000005588/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/a10000005588/subscriptions",
      "organizations_url": "https://api.github.com/users/a10000005588/orgs",
      "repos_url": "https://api.github.com/users/a10000005588/repos",
      "events_url": "https://api.github.com/users/a10000005588/events{/privacy}",
      "received_events_url": "https://api.github.com/users/a10000005588/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-19T12:46:02Z",
    "updated_at": "2019-08-19T12:47:22Z",
    "author_association": "NONE",
    "body": "@karalabe, Thank you so much, it solves my problem! \r\nBecause I was using `puppeth` to create my private blockchain network. \r\nHowever, it did not include the extra information in its initial setting (genesis.json).\r\nMaybe I was using the old version of `puppeth`, I guess so.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/522556761/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/522558267",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19976#issuecomment-522558267",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19976",
    "id": 522558267,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMjU1ODI2Nw==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-19T12:49:33Z",
    "updated_at": "2019-08-19T12:49:33Z",
    "author_association": "MEMBER",
    "body": "Glad it worked out! Puppeth does generate the Constantinople and Petersburg fields too, but maybe you used an older version to create the chain configs. Might want to update Puppeth and Geth too to 1.9.2.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/522558267/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 1,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/538154979",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19976#issuecomment-538154979",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19976",
    "id": 538154979,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzODE1NDk3OQ==",
    "user": {
      "login": "himanshu9345",
      "id": 8727605,
      "node_id": "MDQ6VXNlcjg3Mjc2MDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8727605?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/himanshu9345",
      "html_url": "https://github.com/himanshu9345",
      "followers_url": "https://api.github.com/users/himanshu9345/followers",
      "following_url": "https://api.github.com/users/himanshu9345/following{/other_user}",
      "gists_url": "https://api.github.com/users/himanshu9345/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/himanshu9345/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/himanshu9345/subscriptions",
      "organizations_url": "https://api.github.com/users/himanshu9345/orgs",
      "repos_url": "https://api.github.com/users/himanshu9345/repos",
      "events_url": "https://api.github.com/users/himanshu9345/events{/privacy}",
      "received_events_url": "https://api.github.com/users/himanshu9345/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-03T22:34:32Z",
    "updated_at": "2019-10-03T22:34:32Z",
    "author_association": "NONE",
    "body": "> Latest Solidity compilers depend on features introduced in Constantinople. Please enable it for your own network. The simplest way (if you don't need to retain your old network) is to just restart a fresh one with Constantinople and Petersburg forks enabled:\r\n> \r\n> ```\r\n>   \"config\": {\r\n>     \"chainId\": 1515,\r\n>     \"homesteadBlock\": 0,\r\n>     \"eip150Block\": 0,\r\n>     \"eip155Block\": 0,\r\n>     \"eip158Block\": 0,\r\n>     \"byzantiumBlock\": 0,\r\n>     \"constantinopleBlock\": 0,\r\n>     \"petersburgBlock\": 0,\r\n>     \"clique\": {\r\n>       \"period\": 2,\r\n>       \"epoch\": 30000\r\n>     }\r\n>   },\r\n> ```\r\n> \r\n> If you want to retain your existing network, pick a block number that hasn't yet passed, and put that into of the `constantinopleBlock` and `petersburgBlock` fields.\r\n> \r\n> ```\r\n>   \"config\": {\r\n>     \"chainId\": 1515,\r\n>     \"homesteadBlock\": 1,\r\n>     \"eip150Block\": 2,\r\n>     \"eip155Block\": 3,\r\n>     \"eip158Block\": 3,\r\n>     \"byzantiumBlock\": 4,\r\n>     \"byzantiumBlock\": SOME-FUTURE-BLOCK,\r\n>     \"constantinopleBlock\": SOME-FUTURE-BLOCK,\r\n>     \"clique\": {\r\n>       \"period\": 2,\r\n>       \"epoch\": 30000\r\n>     }\r\n> ```\r\n> \r\n> Then reinit your nodes with the updated config via `geth init`.\r\n\r\nAfter this change the in truffle-config.js I was getting below error\r\n\r\n> panic: runtime error: makeslice: len out of range\r\n> \r\n> goroutine 102 [running]:\r\n> github.com/ethereum/go-ethereum/consensus/clique.(*Clique).snapshot(0xc0000ceaf0, 0x1413ac0, 0xc008da4000, 0x0, 0xaac6e103b63bbd6e, 0x344759a6bb79484d, 0x9384c2d164497f24, 0xfd71970b657934f5, 0x0, 0x0, ...)\r\n> \t/home/himanshu/go-ethereum/build/_workspace/src/github.com/ethereum/go-ethereum/consensus/clique/clique.go:377 +0x53d\r\n> github.com/ethereum/go-ethereum/consensus/clique.(*Clique).Prepare(0xc0000ceaf0, 0x1413ac0, 0xc008da4000, 0xc0003ba000, 0xfd71970b657934f5, 0x436855)\r\n> \t/home/himanshu/go-ethereum/build/_workspace/src/github.com/ethereum/go-ethereum/consensus/clique/clique.go:497 +0xee\r\n> github.com/ethereum/go-ethereum/miner.(*worker).commitNewWork(0xc0001e4680, 0xc0002d4070, 0x0, 0x5d967236)\r\n> \t/home/himanshu/go-ethereum/build/_workspace/src/github.com/ethereum/go-ethereum/miner/worker.go:865 +0x393\r\n> github.com/ethereum/go-ethereum/miner.(*worker).mainLoop(0xc0001e4680)\r\n> \t/home/himanshu/go-ethereum/build/_workspace/src/github.com/ethereum/go-ethereum/miner/worker.go:408 +0xc2f\r\n> created by github.com/ethereum/go-ethereum/miner.newWorker\r\n> \t/home/himanshu/go-ethereum/build/_workspace/src/github.com/ethereum/go-ethereum/miner/worker.go:216 +0x502\r\n\r\n\r\nThen I changed the above config setting with below.\r\n\r\n> ```\r\n>   \"config\": {\r\n>     \"constantinopleBlock\": 0,\r\n>     \"petersburgBlock\": 0\r\n>   },\r\n> ```\r\nIt worked!!!.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/538154979/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
