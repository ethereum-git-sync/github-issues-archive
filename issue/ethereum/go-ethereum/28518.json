{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28518",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28518/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28518/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28518/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/28518",
  "id": 1990301001,
  "node_id": "I_kwDOAOvK9852oZVJ",
  "number": 28518,
  "title": "Geth does not broadcast transactions and stuck in pending transaction",
  "user": {
    "login": "testuse111",
    "id": 150666195,
    "node_id": "U_kgDOCPr70w",
    "avatar_url": "https://avatars.githubusercontent.com/u/150666195?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/testuse111",
    "html_url": "https://github.com/testuse111",
    "followers_url": "https://api.github.com/users/testuse111/followers",
    "following_url": "https://api.github.com/users/testuse111/following{/other_user}",
    "gists_url": "https://api.github.com/users/testuse111/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/testuse111/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/testuse111/subscriptions",
    "organizations_url": "https://api.github.com/users/testuse111/orgs",
    "repos_url": "https://api.github.com/users/testuse111/repos",
    "events_url": "https://api.github.com/users/testuse111/events{/privacy}",
    "received_events_url": "https://api.github.com/users/testuse111/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-11-13T10:03:09Z",
  "updated_at": "2023-11-13T10:08:22Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Setup three Geth private network nodes(Clique) via docker container. They are deployed on three different VMs. Among 3 nodes, there is a miner node to mine the block, a RPC node to accept RPC request, and a boot peer node to connect both of them. This boot node connect to miner and RPC node peer by peer while RPC and miner node has no directly connection.\r\n\r\nSometimes when there are transactions, they are stuck in pending state and never broadcast. This situation happens randomly, sometimes the transactions can be mined by miner but sometimes they just stuck in pending transaction. \r\n\r\nThere is no problem with the gas and the nonce. **Also, if I connect my RPC node to miner node by admin.addPeer(), then this situation totally disappear and everything become normal.** The question seems to be the RPC node sometimes does not broadcast my transactions if it does not connect to a miner directly.\r\n\r\nAnother situation worth mentioning: the blocks can sync within the private network, get the same number when eth.blockNumber, but sometimes RPC node may sync slow, for example the miner has now mined 100 blocks, and the RPC may only sync to 80 blocks while eth.syncing returns false, although finally it will catch up with the block, it sometimes lag behind the miner. \r\n\r\n#### System information\r\n\r\nGeth version: Geth/v1.11.6\r\nOS & Version: Ubuntu 22.04\r\nMiner start commands:\r\n      --nodekey=miner.key\r\n      --bootnodes=\"enode://${BOOTNODE_KEY}@${BOOTNODE_IP}:${BOOTNODE_PORT}\"\r\n      --syncmode=full\r\n      --gcmode=archive\r\n      --miner.etherbase=${ADDR}\r\n      --mine\r\n      --miner.threads=1\r\n      --networkid=${NETWORK_ID}\r\n      --unlock=${ADDR}\r\n      --password=password\r\n      --allow-insecure-unlock\r\n      --verbosity=5\r\nRPC start commands:\r\n      --nodekey=rpc.key\r\n      --bootnodes=\"enode://${BOOTNODE_KEY}@${BOOTNODE_IP}:${BOOTNODE_PORT}\"\r\n      --syncmode=full\r\n      --gcmode=archive\r\n      --networkid=${NETWORK_ID}\r\n      --http\r\n      --http.vhosts=\"*\"\r\n      --http.addr=\"0.0.0.0\"\r\n      --http.port=8545\r\n      --http.corsdomain=\"*\"\r\n#### Expected behaviour\r\n\r\nTransactions are successfully broadcasted and mined.\r\n\r\n#### Actual behaviour\r\n\r\nTransaction sometime not broadcast within the private network.\r\ntxpool of RPC\r\ntxpool.inspect\r\n{\r\n  pending: {\r\n    0x55FAac070a63F809eDF68D72856Ea88c183171C8: {\r\n      0: \"contract creation: 0 wei + 5171633 gas × 2000000000 wei\",\r\n      1: \"contract creation: 0 wei + 4398916 gas × 2000000000 wei\",\r\n      2: \"contract creation: 0 wei + 5131938 gas × 2000000000 wei\"\r\n    }\r\n  },\r\n  queued: {}\r\n}\r\n\r\ntxpool of miner and boot node\r\n\r\ntxpool.inspect\r\n{\r\n  pending: {},\r\n  queued: {}\r\n}\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28518/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28518/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1807848497",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/28518#issuecomment-1807848497",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28518",
    "id": 1807848497,
    "node_id": "IC_kwDOAOvK985rwZQx",
    "user": {
      "login": "testuse111",
      "id": 150666195,
      "node_id": "U_kgDOCPr70w",
      "avatar_url": "https://avatars.githubusercontent.com/u/150666195?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/testuse111",
      "html_url": "https://github.com/testuse111",
      "followers_url": "https://api.github.com/users/testuse111/followers",
      "following_url": "https://api.github.com/users/testuse111/following{/other_user}",
      "gists_url": "https://api.github.com/users/testuse111/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/testuse111/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/testuse111/subscriptions",
      "organizations_url": "https://api.github.com/users/testuse111/orgs",
      "repos_url": "https://api.github.com/users/testuse111/repos",
      "events_url": "https://api.github.com/users/testuse111/events{/privacy}",
      "received_events_url": "https://api.github.com/users/testuse111/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-11-13T10:08:22Z",
    "updated_at": "2023-11-13T10:08:22Z",
    "author_association": "NONE",
    "body": "It seems that the issue is very similar to https://github.com/ethereum/go-ethereum/issues/22308#issuecomment-781940794",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1807848497/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
