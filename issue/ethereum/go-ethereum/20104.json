{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20104",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20104/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20104/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20104/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/20104",
  "id": 496484511,
  "node_id": "MDU6SXNzdWU0OTY0ODQ1MTE=",
  "number": 20104,
  "title": "Question: ID or NodeID",
  "user": {
    "login": "trung",
    "id": 24930,
    "node_id": "MDQ6VXNlcjI0OTMw",
    "avatar_url": "https://avatars.githubusercontent.com/u/24930?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/trung",
    "html_url": "https://github.com/trung",
    "followers_url": "https://api.github.com/users/trung/followers",
    "following_url": "https://api.github.com/users/trung/following{/other_user}",
    "gists_url": "https://api.github.com/users/trung/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/trung/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/trung/subscriptions",
    "organizations_url": "https://api.github.com/users/trung/orgs",
    "repos_url": "https://api.github.com/users/trung/repos",
    "events_url": "https://api.github.com/users/trung/events{/privacy}",
    "received_events_url": "https://api.github.com/users/trung/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2019-09-20T18:16:05Z",
  "updated_at": "2019-09-25T16:05:34Z",
  "closed_at": "2019-09-25T16:05:34Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Node identifier is mentioned in 2 places:\r\n\r\n1. As 32-byte `ID` type which is returned via `admin.nodeInfo`\r\nhttps://github.com/ethereum/go-ethereum/blob/63b18027dc9e5ad86992b3e7acbd3f033a458192/p2p/enode/node.go#L189-L192\r\n\r\n1. As 64-byte `NodeID` type which is used in p2p\r\nhttps://github.com/ethereum/go-ethereum/blob/461291882edce0ac4a28f64c4e8725b7f57cbeae/p2p/discv5/node.go#L260-L265\r\n\r\nWhich one is the *real* node identifier? I would say `NodeID`. But not sure why there are two.",
  "closed_by": {
    "login": "trung",
    "id": 24930,
    "node_id": "MDQ6VXNlcjI0OTMw",
    "avatar_url": "https://avatars.githubusercontent.com/u/24930?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/trung",
    "html_url": "https://github.com/trung",
    "followers_url": "https://api.github.com/users/trung/followers",
    "following_url": "https://api.github.com/users/trung/following{/other_user}",
    "gists_url": "https://api.github.com/users/trung/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/trung/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/trung/subscriptions",
    "organizations_url": "https://api.github.com/users/trung/orgs",
    "repos_url": "https://api.github.com/users/trung/repos",
    "events_url": "https://api.github.com/users/trung/events{/privacy}",
    "received_events_url": "https://api.github.com/users/trung/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20104/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20104/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/533837347",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20104#issuecomment-533837347",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20104",
    "id": 533837347,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzMzgzNzM0Nw==",
    "user": {
      "login": "dherbst",
      "id": 136589,
      "node_id": "MDQ6VXNlcjEzNjU4OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/136589?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dherbst",
      "html_url": "https://github.com/dherbst",
      "followers_url": "https://api.github.com/users/dherbst/followers",
      "following_url": "https://api.github.com/users/dherbst/following{/other_user}",
      "gists_url": "https://api.github.com/users/dherbst/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dherbst/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dherbst/subscriptions",
      "organizations_url": "https://api.github.com/users/dherbst/orgs",
      "repos_url": "https://api.github.com/users/dherbst/repos",
      "events_url": "https://api.github.com/users/dherbst/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dherbst/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-21T23:33:22Z",
    "updated_at": "2019-09-21T23:33:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "From https://github.com/ethereum/devp2p/wiki/Discovery-Overview#discovery-v4\r\n\r\n> All nodes are identified by their 64-byte elliptic curve public key. However, the Kademlia table identifies nodes as the 32-byte SHA256 hash of the node id.\r\n\r\nAnd then https://github.com/ethereum/devp2p/wiki/Discovery-Overview#discovery-v5-aka-discv5\r\n\r\n>  'discv5' as a software package will be deprecated in geth.\r\n\r\nFurther down the page:\r\n> Discovery v5 wire protocol will attempt to offer a backwards compatible method of relaying ENRs in FindNode responses. The Kademlia tables should maintain ENR s, not discovery v4 tuples.\r\n\r\nand\r\n\r\n> Discovery v4 accepts the 64-byte public key, the node id, as the target to search for in a FindNode call. It is converted to a SHA256(node id) 32-byte Kademlia id. This means it is practically impossible to implement the Kademlia bucket-refresh scheme by selecting a random id in the bucket range.\r\n\r\nIf you look at the ENR https://eips.ethereum.org/EIPS/eip-778 which references https://github.com/ethereum/devp2p/issues/43 there is good information on the discussion about the EIP.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/533837347/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/535094118",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20104#issuecomment-535094118",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20104",
    "id": 535094118,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNTA5NDExOA==",
    "user": {
      "login": "trung",
      "id": 24930,
      "node_id": "MDQ6VXNlcjI0OTMw",
      "avatar_url": "https://avatars.githubusercontent.com/u/24930?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/trung",
      "html_url": "https://github.com/trung",
      "followers_url": "https://api.github.com/users/trung/followers",
      "following_url": "https://api.github.com/users/trung/following{/other_user}",
      "gists_url": "https://api.github.com/users/trung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/trung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/trung/subscriptions",
      "organizations_url": "https://api.github.com/users/trung/orgs",
      "repos_url": "https://api.github.com/users/trung/repos",
      "events_url": "https://api.github.com/users/trung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/trung/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-25T16:05:34Z",
    "updated_at": "2019-09-25T16:05:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for the detail response. I guess the answer is \"both are ok\". \r\nHowever, `NodeId` in `discv5` package is going to be moved/deprecated, despite the fact that its intention is still correct. It represents the node public key and also known as `hex node id` portion in the enode URL. \r\n\r\n`ID` is used in Kademlia table\r\nhttps://github.com/ethereum/go-ethereum/blob/0568e817012753a9f71fffa50160990dbc3779a2/p2p/discover/table.go#L164-L176\r\n\r\nFew things I noticed:\r\n1. `NodeId` in `discv5` can be obtained via:\r\nhttps://github.com/ethereum/go-ethereum/blob/461291882edce0ac4a28f64c4e8725b7f57cbeae/p2p/discv5/node.go#L305-L314\r\n   However, there's another calculation using similar logic but with explicit curve `S256()`\r\nhttps://github.com/ethereum/go-ethereum/blob/461291882edce0ac4a28f64c4e8725b7f57cbeae/crypto/crypto.go#L136-L141\r\n1. `ID` is indeed `keccak256()` and not SHA256()\r\nhttps://github.com/ethereum/go-ethereum/blob/0568e817012753a9f71fffa50160990dbc3779a2/p2p/enode/idscheme.go#L80-L90",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/535094118/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
