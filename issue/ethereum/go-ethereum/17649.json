{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17649",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17649/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17649/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17649/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/17649",
  "id": 359298207,
  "node_id": "MDU6SXNzdWUzNTkyOTgyMDc=",
  "number": 17649,
  "title": "POA client nodes crash",
  "user": {
    "login": "matrixpool",
    "id": 23418837,
    "node_id": "MDQ6VXNlcjIzNDE4ODM3",
    "avatar_url": "https://avatars.githubusercontent.com/u/23418837?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/matrixpool",
    "html_url": "https://github.com/matrixpool",
    "followers_url": "https://api.github.com/users/matrixpool/followers",
    "following_url": "https://api.github.com/users/matrixpool/following{/other_user}",
    "gists_url": "https://api.github.com/users/matrixpool/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/matrixpool/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/matrixpool/subscriptions",
    "organizations_url": "https://api.github.com/users/matrixpool/orgs",
    "repos_url": "https://api.github.com/users/matrixpool/repos",
    "events_url": "https://api.github.com/users/matrixpool/events{/privacy}",
    "received_events_url": "https://api.github.com/users/matrixpool/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2018-09-12T03:07:04Z",
  "updated_at": "2018-11-19T11:02:41Z",
  "closed_at": "2018-11-19T11:02:41Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\nGeth version: \r\nVersion: 1.8.12-stable\r\nArchitecture: amd64\r\nProtocol Versions: [63 62]\r\nNetwork Id: 1\r\nGo Version: go1.9.4\r\nOperating System: linux\r\nGOPATH=\r\nGOROOT=/usr/lib/golang\r\nOS & Version: \r\nCentOS Linux release 7.5.1804 (Core)\r\n\r\n#### Actual behaviour\r\n I deployed the POA clique network, one access node and three miner nodes. It was running for a week. It was suddenly interrupted last night, the access node crashed, and the two miner nodes collapsed.If all nodes crash, it will result in data loss, it is a disaster!\r\naccess node start.sh:\r\n```\r\nscreen  geth --datadir data --rpc --rpcapi \"eth,net,web3,personal\" --rpcport xxxx \\\r\n --rpcaddr 127.0.0.1 --rpccorsdomain localhost --ws --wsapi \"net,eth,web3\" \\\r\n--wsport xxxxx --wsaddr 127.0.0.1 --wsorigins \"*\" \\\r\n --networkid xx --port xxxx --nodiscover console\r\n```\r\nminer node start.sh:\r\n```\r\nscreen geth --datadir data --networkid xx --port xxxxx \\\r\n--unlock xxxxxxa4551238316c5e0f4026c33f6xxxxxx --password \"./password\" \\\r\n--preload \"./start.js\" --cache 128 --nodiscover console\r\n```\r\n\r\nI have some questions:\r\n1. How to capture geth crash dump messages?\r\n2. How to ensure that data is not lost when all nodes are crashing?\r\n3. Why does the access node change from the default of 18Gwei to 50Gwei after running for a while, and the miner node is still the default of 18Gwei?",
  "closed_by": {
    "login": "adamschmideg",
    "id": 208822,
    "node_id": "MDQ6VXNlcjIwODgyMg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/208822?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/adamschmideg",
    "html_url": "https://github.com/adamschmideg",
    "followers_url": "https://api.github.com/users/adamschmideg/followers",
    "following_url": "https://api.github.com/users/adamschmideg/following{/other_user}",
    "gists_url": "https://api.github.com/users/adamschmideg/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/adamschmideg/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/adamschmideg/subscriptions",
    "organizations_url": "https://api.github.com/users/adamschmideg/orgs",
    "repos_url": "https://api.github.com/users/adamschmideg/repos",
    "events_url": "https://api.github.com/users/adamschmideg/events{/privacy}",
    "received_events_url": "https://api.github.com/users/adamschmideg/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17649/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17649/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/421266935",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17649#issuecomment-421266935",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17649",
    "id": 421266935,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMTI2NjkzNQ==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-14T08:07:52Z",
    "updated_at": "2018-09-14T08:07:52Z",
    "author_association": "MEMBER",
    "body": "1. Since you're using `screen`, I'd suggest `screen -L -Logfile minerlog <cmd>` and  `screen -L -Logfile node1log <cmd>` etc. If those are on separate machines, then `screen -L <cmd>` would suffice. \r\n  * You could alternatively use the `geth ..args.. &> log.txt`, to capture both `stdout` and `stderr` to the file `log.txt`. \r\n2. If it crashes via `panic`, it may lose some state and need to replay some blocks. That's about it. \r\n3. Change what? If it's the estimated gasPrice, that is determined dynamically by looking at the transaction history of txs getting mined. The miner should respond similarly to the others. Could you provide some more details?\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/421266935/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/421268452",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17649#issuecomment-421268452",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17649",
    "id": 421268452,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMTI2ODQ1Mg==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-14T08:14:04Z",
    "updated_at": "2018-09-14T08:14:04Z",
    "author_association": "MEMBER",
    "body": "Oh, and `1.8.12` is fairly ancient, please upgrade to a recent version -- it's no fun hunting for bugs only to discover it's something that's already been patched a month ago. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/421268452/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/421916357",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17649#issuecomment-421916357",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17649",
    "id": 421916357,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMTkxNjM1Nw==",
    "user": {
      "login": "matrixpool",
      "id": 23418837,
      "node_id": "MDQ6VXNlcjIzNDE4ODM3",
      "avatar_url": "https://avatars.githubusercontent.com/u/23418837?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matrixpool",
      "html_url": "https://github.com/matrixpool",
      "followers_url": "https://api.github.com/users/matrixpool/followers",
      "following_url": "https://api.github.com/users/matrixpool/following{/other_user}",
      "gists_url": "https://api.github.com/users/matrixpool/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matrixpool/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matrixpool/subscriptions",
      "organizations_url": "https://api.github.com/users/matrixpool/orgs",
      "repos_url": "https://api.github.com/users/matrixpool/repos",
      "events_url": "https://api.github.com/users/matrixpool/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matrixpool/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-17T07:40:54Z",
    "updated_at": "2018-09-17T07:42:09Z",
    "author_association": "NONE",
    "body": "@holiman Thanks! \r\n2. There seems to be no way to replay the block if all nodes are crashing. can geth achieve the function that when generate a block and write it to the hard disk immediately?\r\n3.I'm sorry! Can you give me a hint about some more details? In addition, genesis setting of gasLimit = 900000000, now changed to 4712388. why?\r\neth.getBlock(0)\r\n{\r\n  difficulty: 1,\r\n  extraData: \r\n\r\n\"0x0000000000000000000000000000000000000000000000000000000000000000a7467a9bc3c28791623ef489f13541f6908286850000000000000000000000000000000000000000000000000000000000000000000000\r\n\r\n000000000000000000000000000000000000000000000000000000000000\",\r\n  gasLimit: 900000000,\r\n  gasUsed: 0,\r\n  hash: \"0xc5b205dca6e16808f3bb377e8098d4b62d1498344ff2e372d76b31bd273b8cd9\",\r\n  logsBloom: \r\n\r\n\"0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\r\n\r\n000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\r\n\r\n00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\r\n  miner: \"0x0000000000000000000000000000000000000000\",\r\n  mixHash: \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n  nonce: \"0x0000000000000000\",\r\n  number: 0,\r\n  parentHash: \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n  receiptsRoot: \"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421\",\r\n  sha3Uncles: \"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347\",\r\n  size: 627,\r\n  stateRoot: \"0xb1c5709d0cfb02f0a9d51ffef4ae3784856dbcaa7f2fe3c7c9beace626daa96a\",\r\n  timestamp: 1527757475,\r\n  totalDifficulty: 1,\r\n  transactions: [],\r\n  transactionsRoot: \"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421\",\r\n  uncles: []\r\n}\r\n\r\neth.getBlock(3116848)\r\n{\r\n  difficulty: 1,\r\n  extraData: \r\n\r\n\"0xd783010806846765746887676f312e392e35856c696e75780000000000000000bddd9702ca676c2c9492890e83eca107698e3e46a6c39ff8f5eb5472d5365a8b5d7a91347c68a00d1caea2d961b1b592d5cef1e773b38e\r\n\r\n14d2230f69b2a4648e01\",\r\n  gasLimit: 4712388,\r\n  gasUsed: 0,\r\n  hash: \"0x5dd899cefbd197e50447f5ec3dfccf7f670ad07fb20992d404c01959d8033d20\",\r\n  logsBloom: \r\n\r\n\"0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\r\n\r\n000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\r\n\r\n00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\r\n  miner: \"0x0000000000000000000000000000000000000000\",\r\n  mixHash: \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n  nonce: \"0x0000000000000000\",\r\n  number: 3116848,\r\n  parentHash: \"0x8e3ce03f83ff7fab162cd7305f1e7e1da57a6e96dbc2921554fc4fe48dd00a4b\",\r\n  receiptsRoot: \"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421\",\r\n  sha3Uncles: \"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347\",\r\n  size: 609,\r\n  stateRoot: \"0x5e358a316e4eaab9ed8dd7a2079c335980afbe86010c1a73ebba2d98c6a4a91d\",\r\n  timestamp: 1537155146,\r\n  totalDifficulty: 3116850,\r\n  transactions: [],\r\n  transactionsRoot: \"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421\",\r\n  uncles: []\r\n}",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/421916357/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/422343993",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17649#issuecomment-422343993",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17649",
    "id": 422343993,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMjM0Mzk5Mw==",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-18T10:39:31Z",
    "updated_at": "2018-09-18T10:39:31Z",
    "author_association": "MEMBER",
    "body": "@matrixpool Hi here. \r\n\r\nRegarding the gaslimit, geth node will adjust the gaslimit for new block dynamically according to parent block. Here is the latest adjustment logic https://github.com/ethereum/go-ethereum/blob/master/core/block_validator.go#L108.\r\n\r\nBasically, geth node will decrease the gaslimit of current block if the parent block is not full.\r\n\r\nNOTE: Since you are using an old version geth, the adjustment logic in v1.8.12 is little bit different from the latest one.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/422343993/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/439854766",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17649#issuecomment-439854766",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17649",
    "id": 439854766,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzOTg1NDc2Ng==",
    "user": {
      "login": "adamschmideg",
      "id": 208822,
      "node_id": "MDQ6VXNlcjIwODgyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/208822?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/adamschmideg",
      "html_url": "https://github.com/adamschmideg",
      "followers_url": "https://api.github.com/users/adamschmideg/followers",
      "following_url": "https://api.github.com/users/adamschmideg/following{/other_user}",
      "gists_url": "https://api.github.com/users/adamschmideg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/adamschmideg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adamschmideg/subscriptions",
      "organizations_url": "https://api.github.com/users/adamschmideg/orgs",
      "repos_url": "https://api.github.com/users/adamschmideg/repos",
      "events_url": "https://api.github.com/users/adamschmideg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/adamschmideg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-19T11:02:41Z",
    "updated_at": "2018-11-19T11:02:41Z",
    "author_association": "MEMBER",
    "body": "@matrixpool \r\nI assume your 3 questions were answered. If you think any of them hasn't been addressed, please, open a separate issue for that.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/439854766/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
