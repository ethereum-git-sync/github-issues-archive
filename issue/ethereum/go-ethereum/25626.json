{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25626",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25626/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25626/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25626/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/25626",
  "id": 1353799081,
  "node_id": "I_kwDOAOvK985QsVWp",
  "number": 25626,
  "title": "Geth 1.10.21 -> 1.10.23 fail to start, the follow error was got. Fatal: Failed to register the Ethereum service: ancient chain segments already extracted, please set --datadir.ancient to the correct path",
  "user": {
    "login": "lansehuiyi6",
    "id": 34824924,
    "node_id": "MDQ6VXNlcjM0ODI0OTI0",
    "avatar_url": "https://avatars.githubusercontent.com/u/34824924?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/lansehuiyi6",
    "html_url": "https://github.com/lansehuiyi6",
    "followers_url": "https://api.github.com/users/lansehuiyi6/followers",
    "following_url": "https://api.github.com/users/lansehuiyi6/following{/other_user}",
    "gists_url": "https://api.github.com/users/lansehuiyi6/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/lansehuiyi6/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/lansehuiyi6/subscriptions",
    "organizations_url": "https://api.github.com/users/lansehuiyi6/orgs",
    "repos_url": "https://api.github.com/users/lansehuiyi6/repos",
    "events_url": "https://api.github.com/users/lansehuiyi6/events{/privacy}",
    "received_events_url": "https://api.github.com/users/lansehuiyi6/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 9,
  "created_at": "2022-08-29T06:55:55Z",
  "updated_at": "2022-12-08T21:38:01Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nI'ver run 1.10.21 to sync to the latest blocknum, and the beacon version is 3.0.0, and beacon run well too.\r\nThen i upgrade geth from 1.10.21 to 1.10.23, i founc geth cannot start up, docker restart in every 10 seconds.\r\n\r\n\r\nGeth 1.10.23 failed with those logs:\r\n\r\n```\r\n2022-08-29T11:00:53.979+08:00 | INFO [08-29\\|03:00:53.979] Starting Geth on Görli testnet...\r\n   2022-08-29T11:00:53.980+08:00 | INFO [08-29\\|03:00:53.980] Maximum peer count ETH=32 LES=0 total=32\r\n   2022-08-29T11:00:53.981+08:00 | INFO [08-29\\|03:00:53.981] Smartcard socket not found, disabling err=\"stat /run/pcscd/pcscd.comm: no such file or directory\"\r\n  2022-08-29T11:00:53.982+08:00 | DEBUG[08-29\\|03:00:53.982] FS scan times list=\"35.07µs\" set=450ns diff=730ns\r\n  2022-08-29T11:00:53.984+08:00 | DEBUG[08-29\\|03:00:53.984] Sanitizing Go's GC trigger percent=100\r\n  2022-08-29T11:00:53.984+08:00 | INFO [08-29\\|03:00:53.984] Set global gas cap cap=50,000,000\r\n  2022-08-29T11:00:53.987+08:00 | INFO [08-29\\|03:00:53.986] Allocated trie memory caches clean=153.00MiB dirty=256.00MiB\r\n  2022-08-29T11:00:53.987+08:00 | INFO [08-29\\|03:00:53.987] Allocated cache and file handles database=/gethTestnetData/geth/chaindata cache=512.00MiB handles=2048\r\n  2022-08-29T11:00:54.247+08:00 | DEBUG[08-29\\|03:00:54.247] Chain freezer table opened database=/gethTestnetData/geth/chaindata/ancient/chain table=headers items=0 size=0.00B\r\n  2022-08-29T11:00:54.247+08:00 | DEBUG[08-29\\|03:00:54.247] Chain freezer table opened database=/gethTestnetData/geth/chaindata/ancient/chain table=hashes items=0 size=0.00B\r\n  2022-08-29T11:00:54.247+08:00 | DEBUG[08-29\\|03:00:54.247] Chain freezer table opened database=/gethTestnetData/geth/chaindata/ancient/chain table=bodies items=0 size=0.00B\r\n  2022-08-29T11:00:54.247+08:00 | DEBUG[08-29\\|03:00:54.247] Chain freezer table opened database=/gethTestnetData/geth/chaindata/ancient/chain table=receipts items=0 size=0.00B\r\n  2022-08-29T11:00:54.247+08:00 | DEBUG[08-29\\|03:00:54.247] Chain freezer table opened database=/gethTestnetData/geth/chaindata/ancient/chain table=diffs items=0 size=0.00B\r\n  2022-08-29T11:00:54.247+08:00 | INFO [08-29\\|03:00:54.247] Opened ancient database database=/gethTestnetData/geth/chaindata/ancient/chain readonly=false\r\n  2022-08-29T11:00:54.253+08:00 | Fatal: Failed to register the Ethereum service: ancient chain segments already extracted, please set --datadir.ancient to the correct path\r\n  2022-08-29T11:00:54.253+08:00CopyFatal: Failed to register the Ethereum service: ancient chain segments already extracted, please set --datadir.ancient to the correct path | Fatal: Failed to register the Ethereum service: ancient chain segments already extracted, please set --datadir.ancient to the correct path\r\n\r\n\r\nGeth 1.10.21 stop with those logs.:\r\n  2022-08-29T10:59:46.618+08:00 | DEBUG[08-29\\|02:59:46.618] Dereferenced trie from memory database nodes=498 size=210.70KiB time=\"743.817µs\" gcnodes=21924 gcsize=8.40MiB gctime=33.208228ms livenodes=1122 livesize=426.12KiB\r\n  2022-08-29T10:59:46.618+08:00 | DEBUG[08-29\\|02:59:46.618] Dereferenced trie from memory database nodes=320 size=115.90KiB time=\"403.284µs\" gcnodes=22244 gcsize=8.51MiB gctime=33.611312ms livenodes=802 livesize=310.23KiB\r\n 2022-08-29T10:59:46.619+08:00 | DEBUG[08-29\\|02:59:46.619] Dereferenced trie from memory database nodes=596 size=231.02KiB time=\"765.277µs\" gcnodes=22840 gcsize=8.74MiB gctime=34.376319ms livenodes=206 livesize=79.21KiB\r\n  2022-08-29T10:59:46.619+08:00 | DEBUG[08-29\\|02:59:46.619] Dereferenced trie from memory database nodes=205 size=79.21KiB time=\"295.893µs\" gcnodes=23045 gcsize=8.81MiB gctime=34.671962ms livenodes=1 livesize=0.00B\r\n  2022-08-29T10:59:46.619+08:00 | DEBUG[08-29\\|02:59:46.619] Dereferenced trie from memory database nodes=0 size=0.00B time=560ns gcnodes=23045 gcsize=8.81MiB gctime=34.672402ms livenodes=1 livesize=0.00B\r\n 2022-08-29T10:59:46.619+08:00 | DEBUG[08-29\\|02:59:46.619] Dereferenced trie from memory database nodes=0 size=0.00B time=690ns gcnodes=23045 gcsize=8.81MiB gctime=34.673012ms livenodes=1 livesize=0.00B\r\n  2022-08-29T10:59:46.619+08:00 | INFO [08-29\\|02:59:46.619] Writing clean trie cache to disk path=/gethTestnetData/geth/triecache threads=4\r\n2022-08-29T10:59:46.678+08:00 | INFO [08-29\\|02:59:46.678] Looking for peers peercount=0 tried=36 static=0\r\n 2022-08-29T10:59:46.679+08:00 | INFO [08-29\\|02:59:46.679] Persisted the clean trie cache path=/gethTestnetData/geth/triecache elapsed=59.803ms\r\n 2022-08-29T10:59:46.679+08:00 | INFO [08-29\\|02:59:46.679] Blockchain stopped\r\n2022-08-29T10:59:46.688+08:00 | DEBUG[08-29\\|02:59:46.688] Read error err=\"accept tcp [::]:30303: use of closed network connection\"\r\n2022-08-29T10:59:46.688+08:00 | DEBUG[08-29\\|02:59:46.688] Deleting port mapping proto=tcp extport=30303 intport=30303 interface=\"UPnP or NAT-PMP\"\r\n 2022-08-29T10:59:46.688+08:00 | DEBUG[08-29\\|02:59:46.688] Deleting port mapping proto=udp extport=30303 intport=30303 interface=\"UPnP or NAT-PMP\"\r\n 2022-08-29T10:59:46.688+08:00 | DEBUG[08-29\\|02:59:46.688] UDP read error err=\"read udp [::]:30303: use of closed network connection\"\r\n\r\n```\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25626/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25626/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1229884671",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25626#issuecomment-1229884671",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25626",
    "id": 1229884671,
    "node_id": "IC_kwDOAOvK985JToz_",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-29T07:25:22Z",
    "updated_at": "2022-08-29T07:25:22Z",
    "author_association": "MEMBER",
    "body": "What's the ancient path of your original setup? Looks like this folder is empty `/gethTestnetData/geth/chaindata/ancient/`. You need to specify the path to your ancient directory if you ever specified it.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1229884671/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1231105652",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25626#issuecomment-1231105652",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25626",
    "id": 1231105652,
    "node_id": "IC_kwDOAOvK985JYS50",
    "user": {
      "login": "lansehuiyi6",
      "id": 34824924,
      "node_id": "MDQ6VXNlcjM0ODI0OTI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/34824924?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lansehuiyi6",
      "html_url": "https://github.com/lansehuiyi6",
      "followers_url": "https://api.github.com/users/lansehuiyi6/followers",
      "following_url": "https://api.github.com/users/lansehuiyi6/following{/other_user}",
      "gists_url": "https://api.github.com/users/lansehuiyi6/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lansehuiyi6/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lansehuiyi6/subscriptions",
      "organizations_url": "https://api.github.com/users/lansehuiyi6/orgs",
      "repos_url": "https://api.github.com/users/lansehuiyi6/repos",
      "events_url": "https://api.github.com/users/lansehuiyi6/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lansehuiyi6/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-30T03:46:22Z",
    "updated_at": "2022-08-30T03:46:22Z",
    "author_association": "NONE",
    "body": "> extracted\r\n\r\nI‘ve checked the folder /gethTestnetData/geth/chaindata/ancient/, it's not empty. I've not config datadir.ancient, so it should be default value.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1231105652/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1231390935",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25626#issuecomment-1231390935",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25626",
    "id": 1231390935,
    "node_id": "IC_kwDOAOvK985JZYjX",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-30T09:13:40Z",
    "updated_at": "2022-08-30T09:13:40Z",
    "author_association": "MEMBER",
    "body": "But there is no item according to the log `/gethTestnetData/geth/chaindata/ancient/chain table=headers items=0`\r\n\r\nCan you please ls the folder `/gethTestnetData/geth/chaindata/ancient` and `/gethTestnetData/geth/chaindata/ancient/chain`?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1231390935/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1232739818",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25626#issuecomment-1232739818",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25626",
    "id": 1232739818,
    "node_id": "IC_kwDOAOvK985Jeh3q",
    "user": {
      "login": "lansehuiyi6",
      "id": 34824924,
      "node_id": "MDQ6VXNlcjM0ODI0OTI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/34824924?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lansehuiyi6",
      "html_url": "https://github.com/lansehuiyi6",
      "followers_url": "https://api.github.com/users/lansehuiyi6/followers",
      "following_url": "https://api.github.com/users/lansehuiyi6/following{/other_user}",
      "gists_url": "https://api.github.com/users/lansehuiyi6/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lansehuiyi6/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lansehuiyi6/subscriptions",
      "organizations_url": "https://api.github.com/users/lansehuiyi6/orgs",
      "repos_url": "https://api.github.com/users/lansehuiyi6/repos",
      "events_url": "https://api.github.com/users/lansehuiyi6/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lansehuiyi6/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-31T10:09:13Z",
    "updated_at": "2022-09-01T01:36:14Z",
    "author_association": "NONE",
    "body": "> But there is no item according to the log `/gethTestnetData/geth/chaindata/ancient/chain table=headers items=0`\r\n> \r\n> Can you please ls the folder `/gethTestnetData/geth/chaindata/ancient` and `/gethTestnetData/geth/chaindata/ancient/chain`?\r\n\r\nI start with docker, and mount /blockchain-data/geth-testnet to /gethTestnetData;\r\nI only have the ancient/chain record, because i already resync with 1.10.23.\r\n\r\n```\r\n[ec2-user@ip-10-1-2-245 ~]$ sudo ls /blockchain-data/geth-testnet/geth/chaindata/ancient\r\nbodies.0000.cdat  bodies.0005.cdat  bodies.0010.cdat  bodies.0015.cdat  bodies.0020.cdat  bodies.0025.cdat  diffs.0000.rdat   hashes.meta        headers.meta        receipts.0004.cdat\r\nbodies.0001.cdat  bodies.0006.cdat  bodies.0011.cdat  bodies.0016.cdat  bodies.0021.cdat  bodies.0026.cdat  diffs.meta        hashes.ridx        receipts.0000.cdat  receipts.cidx\r\nbodies.0002.cdat  bodies.0007.cdat  bodies.0012.cdat  bodies.0017.cdat  bodies.0022.cdat  bodies.cidx       diffs.ridx        headers.0000.cdat  receipts.0001.cdat  receipts.meta\r\nbodies.0003.cdat  bodies.0008.cdat  bodies.0013.cdat  bodies.0018.cdat  bodies.0023.cdat  bodies.meta       FLOCK             headers.0001.cdat  receipts.0002.cdat\r\nbodies.0004.cdat  bodies.0009.cdat  bodies.0014.cdat  bodies.0019.cdat  bodies.0024.cdat  chain             hashes.0000.rdat  headers.cidx       receipts.0003.cdat\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1232739818/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1233633394",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25626#issuecomment-1233633394",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25626",
    "id": 1233633394,
    "node_id": "IC_kwDOAOvK985Jh8By",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-01T01:40:43Z",
    "updated_at": "2022-09-01T01:40:57Z",
    "author_association": "MEMBER",
    "body": "@lansehuiyi6 interesting. In your ancient folder, you have both legacy data in the `/geth/chaindata/ancient` and new ancient data in `/geth/chaindata/ancient/chain`. In this case the legacy data can't be identified(ignored).\r\n\r\nI am curious how did you setup the whole thing? Since theoretically if the ancient store is not empty, the sub-folder `/geth/chaindata/ancient/chain` will not be created.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1233633394/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1248378795",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25626#issuecomment-1248378795",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25626",
    "id": 1248378795,
    "node_id": "IC_kwDOAOvK985KaL-r",
    "user": {
      "login": "begetan",
      "id": 17225934,
      "node_id": "MDQ6VXNlcjE3MjI1OTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/17225934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/begetan",
      "html_url": "https://github.com/begetan",
      "followers_url": "https://api.github.com/users/begetan/followers",
      "following_url": "https://api.github.com/users/begetan/following{/other_user}",
      "gists_url": "https://api.github.com/users/begetan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/begetan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/begetan/subscriptions",
      "organizations_url": "https://api.github.com/users/begetan/orgs",
      "repos_url": "https://api.github.com/users/begetan/repos",
      "events_url": "https://api.github.com/users/begetan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/begetan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-15T17:08:24Z",
    "updated_at": "2022-09-15T17:08:24Z",
    "author_association": "NONE",
    "body": "I got the same error when troubleshooting broken fresh sync issue for geth 1.10.23\r\nYou can replace v1.10.21 with v1.10.23 unless it is not syncing  at least at the beginning)  ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1248378795/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1261673571",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25626#issuecomment-1261673571",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25626",
    "id": 1261673571,
    "node_id": "IC_kwDOAOvK985LM5xj",
    "user": {
      "login": "goleft4E",
      "id": 111165766,
      "node_id": "U_kgDOBqBBRg",
      "avatar_url": "https://avatars.githubusercontent.com/u/111165766?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/goleft4E",
      "html_url": "https://github.com/goleft4E",
      "followers_url": "https://api.github.com/users/goleft4E/followers",
      "following_url": "https://api.github.com/users/goleft4E/following{/other_user}",
      "gists_url": "https://api.github.com/users/goleft4E/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/goleft4E/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/goleft4E/subscriptions",
      "organizations_url": "https://api.github.com/users/goleft4E/orgs",
      "repos_url": "https://api.github.com/users/goleft4E/repos",
      "events_url": "https://api.github.com/users/goleft4E/events{/privacy}",
      "received_events_url": "https://api.github.com/users/goleft4E/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-29T02:48:38Z",
    "updated_at": "2022-09-29T02:48:38Z",
    "author_association": "NONE",
    "body": "> \r\n\r\ngeth/chaindata/ancient/chain",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1261673571/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1343309669",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25626#issuecomment-1343309669",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25626",
    "id": 1343309669,
    "node_id": "IC_kwDOAOvK985QEUdl",
    "user": {
      "login": "memekas",
      "id": 29024423,
      "node_id": "MDQ6VXNlcjI5MDI0NDIz",
      "avatar_url": "https://avatars.githubusercontent.com/u/29024423?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/memekas",
      "html_url": "https://github.com/memekas",
      "followers_url": "https://api.github.com/users/memekas/followers",
      "following_url": "https://api.github.com/users/memekas/following{/other_user}",
      "gists_url": "https://api.github.com/users/memekas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/memekas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/memekas/subscriptions",
      "organizations_url": "https://api.github.com/users/memekas/orgs",
      "repos_url": "https://api.github.com/users/memekas/repos",
      "events_url": "https://api.github.com/users/memekas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/memekas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-08T20:24:08Z",
    "updated_at": "2022-12-08T21:16:30Z",
    "author_association": "NONE",
    "body": "I get the same error in my private chain.\r\nI wanted to update geth from v1.10.18 to v1.10.26.\r\nDatadir is the same for both versions\r\n\r\nv1.10.18 logs (OK):\r\n```\r\n➜  geth \\                                                         \r\n--datadir ./node --syncmode full \\\r\n--http --http.addr 0.0.0.0 --http.port 8545 \\\r\n--ws --ws.addr 0.0.0.0 --ws.port 8545 \\\r\n--port 30305 \\\r\n--allow-insecure-unlock --password ./password --unlock $MY_ADDR \\\r\n--verbosity 5 --nodiscover console\r\n                                                \r\nINFO [12-08|23:03:40.137] Starting Geth on Ethereum mainnet... \r\nINFO [12-08|23:03:40.137] Bumping default cache on mainnet         provided=1024 updated=4096\r\nINFO [12-08|23:03:40.139] Maximum peer count                       ETH=50 LES=0 total=50\r\nTRACE[12-08|23:03:40.141] Started watching keystore folder         path=/.../node/keystore\r\nDEBUG[12-08|23:03:40.142] FS scan times                            list=1.18975ms set=\"30.208µs\" diff=\"3.959µs\"\r\nTRACE[12-08|23:03:40.143] Handled keystore changes                 time=\"840.667µs\"\r\nDEBUG[12-08|23:03:40.143] Sanitizing Go's GC trigger               percent=25\r\nINFO [12-08|23:03:40.143] Set global gas cap                       cap=50,000,000\r\nINFO [12-08|23:03:40.143] Allocated trie memory caches             clean=614.00MiB dirty=1024.00MiB\r\nINFO [12-08|23:03:40.144] Allocated cache and file handles         database=/.../node/geth/chaindata cache=2.00GiB handles=5120\r\nDEBUG[12-08|23:03:40.288] Chain freezer table opened               database=/.../node/geth/chaindata/ancient table=headers items=1,776,902 size=515.87MiB\r\nDEBUG[12-08|23:03:40.342] Chain freezer table opened               database=/.../node/geth/chaindata/ancient table=hashes  items=1,776,902 size=54.23MiB\r\nDEBUG[12-08|23:03:40.396] Chain freezer table opened               database=/.../node/geth/chaindata/ancient table=bodies  items=1,776,902 size=62.94MiB\r\nDEBUG[12-08|23:03:40.450] Chain freezer table opened               database=/.../node/geth/chaindata/ancient table=receipts items=1,776,902 size=10.34MiB\r\nDEBUG[12-08|23:03:40.504] Chain freezer table opened               database=/.../node/geth/chaindata/ancient table=diffs    items=1,776,902 size=6.75MiB\r\nINFO [12-08|23:03:40.504] Opened ancient database                  database=/.../node/geth/chaindata/ancient readonly=false\r\nINFO [12-08|23:03:40.512] Initialised chain configuration          config=\"{ChainID: MY_CHAINID Homestead: 0 DAO: <nil> DAOSupport: false EIP150: 0 EIP155: 0 EIP158: 0 Byzantium: 0 Constantinople: 0 Petersburg: 0 Istanbul: 0, Muir Glacier: <nil>, Berlin: <nil>, London: <nil>, Arrow Glacier: <nil>, MergeFork: <nil>, Terminal TD: <nil>, Engine: clique}\"\r\nINFO [12-08|23:03:40.516] Initialising Ethereum protocol           network=1 dbversion=8\r\n...\r\n```\r\n\r\nv1.10.26 logs (error):\r\n```\r\n➜  geth \\\r\n--datadir ./node --syncmode full \\\r\n--http --http.addr 0.0.0.0 --http.port 8545 \\\r\n--ws --ws.addr 0.0.0.0 --ws.port 8545 \\\r\n--port 30305 \\\r\n--allow-insecure-unlock --password ./password --unlock $MY_ADDR \\\r\n--verbosity 5 --nodiscover console\r\n\r\nINFO [12-08|23:18:32.200] Starting Geth on Ethereum mainnet... \r\nINFO [12-08|23:18:32.201] Bumping default cache on mainnet         provided=1024 updated=4096\r\nINFO [12-08|23:18:32.202] Maximum peer count                       ETH=50 LES=0 total=50\r\nDEBUG[12-08|23:18:32.205] FS scan times                            list=\"218.875µs\" set=\"26.667µs\" diff=\"2.5µs\"\r\nTRACE[12-08|23:18:32.205] Started watching keystore folder         path=/.../node/keystore\r\nTRACE[12-08|23:18:32.206] Handled keystore changes                 time=\"754.5µs\"\r\nDEBUG[12-08|23:18:32.207] Sanitizing Go's GC trigger               percent=25\r\nINFO [12-08|23:18:32.208] Set global gas cap                       cap=50,000,000\r\nINFO [12-08|23:18:32.209] Allocated trie memory caches             clean=614.00MiB dirty=1024.00MiB\r\nINFO [12-08|23:18:32.210] Allocated cache and file handles         database=/.../node/geth/chaindata cache=2.00GiB handles=5120\r\nDEBUG[12-08|23:18:32.328] Chain freezer table opened               database=/.../node/geth/chaindata/ancient/chain table=headers items=0 size=0.00B\r\nDEBUG[12-08|23:18:32.329] Chain freezer table opened               database=/.../node/geth/chaindata/ancient/chain table=hashes  items=0 size=0.00B\r\nDEBUG[12-08|23:18:32.329] Chain freezer table opened               database=/.../node/geth/chaindata/ancient/chain table=bodies  items=0 size=0.00B\r\nDEBUG[12-08|23:18:32.330] Chain freezer table opened               database=/.../node/geth/chaindata/ancient/chain table=receipts items=0 size=0.00B\r\nDEBUG[12-08|23:18:32.330] Chain freezer table opened               database=/.../node/geth/chaindata/ancient/chain table=diffs    items=0 size=0.00B\r\nINFO [12-08|23:18:32.330] Opened ancient database                  database=/.../node/geth/chaindata/ancient/chain readonly=false\r\nFatal: Failed to register the Ethereum service: ancient chain segments already extracted, please set --datadir.ancient to the correct path\r\n```\r\n\r\nAs you can see, I have `items=1,776,902` but the new version can't find them\r\n\r\nUPD:\r\nv1.10.18 uses `/.../node/geth/chaindata/ancient`\r\nv1.10.26 uses `/.../node/geth/chaindata/ancient/chain` that has empty files\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1343309669/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1343401120",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25626#issuecomment-1343401120",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25626",
    "id": 1343401120,
    "node_id": "IC_kwDOAOvK985QEqyg",
    "user": {
      "login": "memekas",
      "id": 29024423,
      "node_id": "MDQ6VXNlcjI5MDI0NDIz",
      "avatar_url": "https://avatars.githubusercontent.com/u/29024423?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/memekas",
      "html_url": "https://github.com/memekas",
      "followers_url": "https://api.github.com/users/memekas/followers",
      "following_url": "https://api.github.com/users/memekas/following{/other_user}",
      "gists_url": "https://api.github.com/users/memekas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/memekas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/memekas/subscriptions",
      "organizations_url": "https://api.github.com/users/memekas/orgs",
      "repos_url": "https://api.github.com/users/memekas/repos",
      "events_url": "https://api.github.com/users/memekas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/memekas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-08T21:38:00Z",
    "updated_at": "2022-12-08T21:38:00Z",
    "author_association": "NONE",
    "body": "UPD 2.0 HOW TO FIX:\r\n\r\n1. Delete files in `/.../node/geth/chaindata/ancient/chain`\r\n2. Copy files from `/.../node/geth/chaindata/ancient` to `/.../node/geth/chaindata/ancient/chain`\r\n\r\nOr you can edit code [here](https://github.com/ethereum/go-ethereum/blob/e5eb32acee19cc9fca6a03b10283b7484246b15a/core/rawdb/database.go#L179) -> `freezer := ancient`\r\nhttps://github.com/ethereum/go-ethereum/blob/e5eb32acee19cc9fca6a03b10283b7484246b15a/core/rawdb/database.go#L179\r\n\r\n@rjl493456442 It is just hotfix for me. I think you should do something with backward compatibility\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1343401120/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
