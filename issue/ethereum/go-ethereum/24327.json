{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24327",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24327/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24327/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24327/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/24327",
  "id": 1121526522,
  "node_id": "I_kwDOAOvK985C2SL6",
  "number": 24327,
  "title": "erc20 transfer issue in Geth Mobile API iOS",
  "user": {
    "login": "shchoi82",
    "id": 5986501,
    "node_id": "MDQ6VXNlcjU5ODY1MDE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5986501?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/shchoi82",
    "html_url": "https://github.com/shchoi82",
    "followers_url": "https://api.github.com/users/shchoi82/followers",
    "following_url": "https://api.github.com/users/shchoi82/following{/other_user}",
    "gists_url": "https://api.github.com/users/shchoi82/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/shchoi82/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/shchoi82/subscriptions",
    "organizations_url": "https://api.github.com/users/shchoi82/orgs",
    "repos_url": "https://api.github.com/users/shchoi82/repos",
    "events_url": "https://api.github.com/users/shchoi82/events{/privacy}",
    "received_events_url": "https://api.github.com/users/shchoi82/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 268304226,
      "node_id": "MDU6TGFiZWwyNjgzMDQyMjY=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:docs",
      "name": "type:docs",
      "color": "fef2c0",
      "default": false,
      "description": null
    },
    {
      "id": 1132754722,
      "node_id": "MDU6TGFiZWwxMTMyNzU0NzIy",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/need:more-information",
      "name": "need:more-information",
      "color": "db6fa3",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-02-02T05:21:49Z",
  "updated_at": "2022-02-09T20:00:05Z",
  "closed_at": "2022-02-09T20:00:05Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi guys\r\nI am developing a transfer of the ERC20 token using GETH.\r\nusing mobile api. ( [https://geth.ethereum.org/docs/dapp/mobile](https://geth.ethereum.org/docs/dapp/mobile) )\r\nI bound the smart contract from abi.\r\nand I prepared the parameters according to the API.\r\nand then call transact method function.\r\nApp crash occurs.\r\nI cannot check any error messages.\r\nCould you tell me what's wrong?\r\n\r\n**System information**\r\nVersion : geth-ios-all-1.10.3-991384a7\r\nOperating System : iOS : 14.8.1\r\n\r\n**Expected behaviour**\r\nSubmission of transaction\r\n\r\n**Actual behaviour**\r\nabnormal exit with no error log\r\n\r\n**Steps to reproduce the behaviour**\r\nthis is my code.\r\n\r\n```swift\r\n// bind contract\r\nlet boundContract = Geth.GethBindContract(contractAddress, abi_json, client, bindError)\r\nlet datadir = NSSearchPathForDirectoriesInDomains(.documentDirectory, .userDomainMask, true)[0]      \r\n\r\n// key store\r\nlet ks = GethNewKeyStore(ksPath, GethLightScryptN, GethLightScryptP);\r\nlet account = try ks?.importECDSAKey(privateKey, passphrase: xxx)\r\n\r\n// from\r\nlet fromAddress = GethNewAddressFromHex(address, addressError)\r\n\r\n// to\r\nlet toAddress = GethNewAddressFromHex(to, addressError)\r\n\r\n// amount\r\nlet amountB = GethNewBigIntFromString(amount, 10)\r\n\r\n// nonce\r\nvar nonce:Int64 = 0;\r\ntry client?.getPendingNonce(at: GethContext(), account: Geth.GethNewAddressFromHex(address, addressError), nonce: &nonce)\r\n\r\n// gasPrice\r\nlet suggestGasPrice = try client?.suggestGasPrice(GethContext())\r\n\r\nlet transactOpts = GethTransactOpts()\r\ntransactOpts?.setContext(GethContext());\r\ntransactOpts?.setGasLimit(100000);\r\ntransactOpts?.setGasPrice(suggestGasPrice);\r\ntransactOpts?.setNonce(nonce);\r\ntransactOpts?.setFrom(fromAddress);\r\n\r\nif ks == nil || account == nil {\r\n  return;\r\n}\r\n\r\nlet mySigner = MySigner()\r\nmySigner.setP(ks: ks!, account: account!, GETH_KSPW: \"pw\", chainId: chainId)\r\ntransactOpts?.setSigner(mySigner)\r\n\r\n// params\r\nlet paramToAddress = GethNewInterface()\r\nparamToAddress?.setAddress(toAddress)\r\nlet paramAmount = GethNewInterface()\r\nparamAmount?.setBigInt(amountB)\r\nlet params = GethNewInterfaces(2)\r\ntry params?.set(0, object: paramToAddress)\r\ntry params?.set(1, object: paramAmount)\r\n\r\n// app crash\r\nlet transaction = try boundContract?.transact(transactOpts, method: \"transfer\", args: params)\r\n\r\n```\r\n\r\nI also declared my own MySigner to make an argument for setSigner. conforming `GethSignerProtocol`\r\nsetSigner signature **`func** setSigner(_ s: GethSignerProtocol?)`\r\n\r\n```swift\r\nclass MySigner: GethMobileSigner {\r\n\tvar _ks : GethKeyStore!\r\n\tvar _account : GethAccount!\r\n\tvar _GETH_KSPW : String!\r\n\tvar _chainId : String!\r\n\r\n\toverride func sign(_ addr: GethAddress?, unsignedTx: GethTransaction?) throws -> GethTransaction {\r\n\t  if(_ks == nil || _account == nil || _GETH_KSPW == nil){\r\n\t    throw MyError.gethError\r\n\t  }\r\n\t  \r\n\t  return try _ks.signTxPassphrase(_account, passphrase: _GETH_KSPW, tx: unsignedTx, chainID: GethNewBigIntFromString(_chainId, 10))\r\n\t}\r\n\t\r\n\tfunc setP(ks: GethKeyStore, account: GethAccount, GETH_KSPW: String, chainId: String) -> Void {\r\n\t  _ks = ks\r\n\t  _account = account\r\n\t\t_GETH_KSPW = GETH_KSPW\r\n\t  _chainId = chainId\r\n\t}\r\n}\r\n```",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24327/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24327/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1028797277",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/24327#issuecomment-1028797277",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24327",
    "id": 1028797277,
    "node_id": "IC_kwDOAOvK9849UjNd",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-03T09:49:17Z",
    "updated_at": "2022-02-03T09:49:17Z",
    "author_association": "MEMBER",
    "body": "If you can run this in an emulator and maybe catch a crash dump we could try to look at it. None of us are mobile devs here so we can't repro it. If the crash is in Go, we could try to fix it, but we won't be able to support iOS.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1028797277/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
