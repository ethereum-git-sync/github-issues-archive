{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20999",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20999/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20999/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20999/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/20999",
  "id": 608806912,
  "node_id": "MDU6SXNzdWU2MDg4MDY5MTI=",
  "number": 20999,
  "title": "Generating state snapshot blocks syncing",
  "user": {
    "login": "bert2002",
    "id": 1042226,
    "node_id": "MDQ6VXNlcjEwNDIyMjY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1042226?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bert2002",
    "html_url": "https://github.com/bert2002",
    "followers_url": "https://api.github.com/users/bert2002/followers",
    "following_url": "https://api.github.com/users/bert2002/following{/other_user}",
    "gists_url": "https://api.github.com/users/bert2002/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bert2002/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bert2002/subscriptions",
    "organizations_url": "https://api.github.com/users/bert2002/orgs",
    "repos_url": "https://api.github.com/users/bert2002/repos",
    "events_url": "https://api.github.com/users/bert2002/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bert2002/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2020-04-29T06:18:17Z",
  "updated_at": "2020-04-29T07:14:43Z",
  "closed_at": "2020-04-29T07:14:43Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\n```\r\n$ geth version\r\nGeth\r\nVersion: 1.9.13-stable\r\nGit Commit: cbc4ac264e9671898bff6ec7e434da3eca4bd273\r\nGit Commit Date: 20200416\r\nArchitecture: amd64\r\nProtocol Versions: [65 64 63]\r\nGo Version: go1.14.2\r\nOperating System: linux\r\nGOPATH=\r\nGOROOT=/home/travis/.gimme/versions/go1.14.2.linux.amd64\r\n```\r\n\r\n#### Expected behaviour\r\nSyncing with the blockchain while creating state snapshot.\r\n\r\n#### Actual behaviour\r\nSynchronization stops when generating state snapshot.\r\n\r\n```\r\n...\r\nApr 29 05:54:33 geth geth[13559]: INFO [04-29|05:54:33.557] Generating state snapshot                at=09ef1f…06ae2f accounts=1105478 slots=4455684 storage=399.65MiB elapsed=7m28.429s eta=34h33m15.843s\r\nApr 29 05:54:41 geth geth[13559]: INFO [04-29|05:54:41.558] Generating state snapshot                at=09f2bf…c544d1 accounts=1107083 slots=4458926 storage=400.00MiB elapsed=7m36.430s eta=34h36m58.82s\r\nApr 29 05:54:49 geth geth[13559]: INFO [04-29|05:54:49.559] Generating state snapshot                at=09f819…ec74b2 accounts=1109386 slots=4461388 storage=400.32MiB elapsed=7m44.431s eta=34h25m17.865s\r\nApr 29 05:54:57 geth geth[13559]: INFO [04-29|05:54:57.565] Generating state snapshot                at=09fd8e…8f898d accounts=1111784 slots=4463726 storage=400.64MiB elapsed=7m52.438s eta=34h13m15.761s\r\nApr 29 05:55:12 geth geth[13559]: INFO [04-29|05:55:12.020] Generating state snapshot                at=0a037e…aa8717 accounts=1114406 slots=4470047 storage=401.34MiB elapsed=8m6.892s  eta=34h25m7.744s\r\nApr 29 05:55:21 geth geth[13559]: INFO [04-29|05:55:21.099] Generating state snapshot                at=0a079d…826abf accounts=1116248 slots=4474003 storage=401.74MiB elapsed=8m15.971s eta=34h29m0.926s\r\nApr 29 05:55:29 geth geth[13559]: INFO [04-29|05:55:29.456] Generating state snapshot                at=0a0cba…a728f0 accounts=1118451 slots=4476243 storage=402.03MiB elapsed=8m24.328s eta=34h21m48.783s\r\nApr 29 05:55:37 geth geth[13559]: INFO [04-29|05:55:37.457] Generating state snapshot                at=0a112f…0b1dbc accounts=1120376 slots=4478595 storage=402.32MiB elapsed=8m32.329s eta=34h18m37.505s\r\nApr 29 05:55:45 geth geth[13559]: INFO [04-29|05:55:45.458] Generating state snapshot                at=0a1597…cac3df accounts=1122322 slots=4480889 storage=402.61MiB elapsed=8m40.330s eta=34h15m55.816s\r\nApr 29 05:55:52 geth geth[13559]: INFO [04-29|05:55:52.276] Aborting state snapshot generation       at=0a1b1e…98df91 accounts=1124759 slots=4483047 storage=402.92MiB elapsed=8m47.148s eta=34h0m14.202s\r\nApr 29 05:55:52 geth geth[13559]: INFO [04-29|05:55:52.277] Resuming state snapshot generation       at=0a1b1e…98df91 accounts=1124759 slots=4483047 storage=402.92MiB elapsed=8m47.149s eta=34h0m14.434s\r\nApr 29 05:55:52 geth geth[13559]: INFO [04-29|05:55:52.293] Imported new chain segment               blocks=1 txs=75 mgas=7.997 elapsed=408.613ms mgasps=19.571 number=7808450 hash=0a0573…ed8396 age=5m22s dirty=0.00B\r\nApr 29 05:56:00 geth geth[13559]: INFO [04-29|05:56:00.279] Generating state snapshot                at=0a1fdd…dd182c accounts=1126777 slots=4485099 storage=403.19MiB elapsed=8m55.152s eta=33h55m25.702s\r\nApr 29 05:56:05 geth geth[13559]: INFO [04-29|05:56:05.467] Deep froze chain segment                 blocks=1 elapsed=38.249ms  number=7718449 hash=dc1945…14aa13\r\nApr 29 05:56:08 geth geth[13559]: INFO [04-29|05:56:08.281] Generating state snapshot                at=0a23b7…237424 accounts=1128487 slots=4488374 storage=403.55MiB elapsed=9m3.153s  eta=33h57m16.19s\r\nApr 29 05:56:25 geth geth[13559]: INFO [04-29|05:56:25.509] Generating state snapshot                at=0a23ca…7562e3 accounts=1128530 slots=4497807 storage=404.33MiB elapsed=9m20.381s eta=35h1m20.806s\r\nApr 29 05:56:33 geth geth[13559]: INFO [04-29|05:56:33.528] Generating state snapshot                at=0a2829…dd0e6c accounts=1130502 slots=4500885 storage=404.66MiB elapsed=9m28.401s eta=34h58m29.118s\r\nApr 29 05:56:41 geth geth[13559]: INFO [04-29|05:56:41.530] Generating state snapshot                at=0a2c92…2c691d accounts=1132431 slots=4504139 storage=405.02MiB elapsed=9m36.402s eta=34h55m20.85s\r\nApr 29 05:56:49 geth geth[13559]: INFO [04-29|05:56:49.531] Generating state snapshot                at=0a3217…6c9334 accounts=1134870 slots=4506943 storage=405.37MiB elapsed=9m44.403s eta=34h44m21.987s\r\nApr 29 05:56:53 geth geth[13559]: INFO [04-29|05:56:53.154] Aborting state snapshot generation       at=0a355b…ec2868 accounts=1136259 slots=4507958 storage=405.53MiB elapsed=9m48.026s eta=34h34m9.024s\r\nApr 29 05:56:53 geth geth[13559]: INFO [04-29|05:56:53.156] Resuming state snapshot generation       at=0a355b…ec2868 accounts=1136259 slots=4507958 storage=405.53MiB elapsed=9m48.028s eta=34h34m9.447s\r\nApr 29 05:56:53 geth geth[13559]: INFO [04-29|05:56:53.169] Imported new chain segment               blocks=1 txs=20 mgas=7.999 elapsed=433.197ms mgasps=18.464 number=7808451 hash=d94941…837891 age=1m2s  dirty=0.00B\r\nApr 29 05:57:01 geth geth[13559]: INFO [04-29|05:57:01.166] Generating state snapshot                at=0a3ab0…04516d accounts=1138547 slots=4510539 storage=405.86MiB elapsed=9m56.039s eta=34h25m10.647s\r\nApr 29 05:57:05 geth geth[13559]: INFO [04-29|05:57:05.775] Deep froze chain segment                 blocks=1 elapsed=307.912ms number=7718450 hash=3e486b…be7f39\r\nApr 29 05:57:28 geth geth[13559]: INFO [04-29|05:57:28.164] Generating state snapshot                at=0a3c2d…f98b4c accounts=1139203 slots=4524881 storage=406.91MiB elapsed=10m23.036s eta=35h48m6.41s\r\nApr 29 05:57:36 geth geth[13559]: INFO [04-29|05:57:36.164] Generating state snapshot                at=0a41b3…62b147 accounts=1141603 slots=4527588 storage=407.25MiB elapsed=10m31.036s eta=35h36m42.614s\r\nApr 29 05:57:51 geth geth[13559]: INFO [04-29|05:57:51.694] Generating state snapshot                at=0a4704…25199c accounts=1143896 slots=4534432 storage=407.87MiB elapsed=10m46.566s eta=35h52m9.111s\r\nApr 29 05:57:59 geth geth[13559]: INFO [04-29|05:57:59.694] Generating state snapshot                at=0a4dc6…ca9595 accounts=1146804 slots=4536888 storage=408.22MiB elapsed=10m54.567s eta=35h32m47.041s\r\nApr 29 05:58:12 geth geth[13559]: INFO [04-29|05:58:12.144] Generating state snapshot                at=0a522d…142503 accounts=1148683 slots=4542899 storage=408.80MiB elapsed=11m7.016s  eta=35h43m51.542s\r\nApr 29 05:58:20 geth geth[13559]: INFO [04-29|05:58:20.145] Generating state snapshot                at=0a562d…34c7de accounts=1150432 slots=4546235 storage=409.13MiB elapsed=11m15.017s eta=35h43m9.577s\r\nApr 29 05:58:28 geth geth[13559]: INFO [04-29|05:58:28.157] Generating state snapshot                at=0a5c6c…94d8d1 accounts=1153142 slots=4549148 storage=409.51MiB elapsed=11m23.029s eta=35h28m7.424s\r\nApr 29 05:58:36 geth geth[13559]: INFO [04-29|05:58:36.158] Generating state snapshot                at=0a62e9…2d422c accounts=1156039 slots=4551385 storage=409.85MiB elapsed=11m31.030s eta=35h12m5.072s\r\nApr 29 05:58:44 geth geth[13559]: INFO [04-29|05:58:44.400] Generating state snapshot                at=0a6770…a34e68 accounts=1158021 slots=4554576 storage=410.20MiB elapsed=11m39.273s eta=35h9m16.179s\r\nApr 29 05:58:52 geth geth[13559]: INFO [04-29|05:58:52.444] Generating state snapshot                at=0a6ce5…71837f accounts=1160435 slots=4557172 storage=410.54MiB elapsed=11m47.317s eta=35h0m21.744s\r\nApr 29 05:59:00 geth geth[13559]: INFO [04-29|05:59:00.446] Generating state snapshot                at=0a731e…002057 accounts=1163074 slots=4559644 storage=410.88MiB elapsed=11m55.318s eta=34h47m5.967s\r\nApr 29 05:59:08 geth geth[13559]: INFO [04-29|05:59:08.448] Generating state snapshot                at=0a78fc…b83cf2 accounts=1165671 slots=4562234 storage=411.23MiB elapsed=12m3.320s  eta=34h36m19.684s\r\nApr 29 05:59:16 geth geth[13559]: INFO [04-29|05:59:16.468] Generating state snapshot                at=0a7eb2…88d3af accounts=1168166 slots=4565111 storage=411.59MiB elapsed=12m11.340s eta=34h26m48.403s\r\nApr 29 05:59:24 geth geth[13559]: INFO [04-29|05:59:24.471] Generating state snapshot                at=0a840c…535561 accounts=1170558 slots=4568162 storage=411.95MiB elapsed=12m19.343s eta=34h19m31.335s\r\nApr 29 05:59:32 geth geth[13559]: INFO [04-29|05:59:32.574] Generating state snapshot                at=0a8673…2a07f9 accounts=1171613 slots=4572084 storage=412.28MiB elapsed=12m27.446s eta=34h28m47.827s\r\nApr 29 05:59:40 geth geth[13559]: INFO [04-29|05:59:40.575] Generating state snapshot                at=0a8cf3…c06a9d accounts=1174442 slots=4574659 storage=412.64MiB elapsed=12m35.448s eta=34h15m24.568s\r\nApr 29 05:59:56 geth geth[13559]: INFO [04-29|05:59:56.742] Generating state snapshot                at=0a8e33…c44d46 accounts=1174976 slots=4583264 storage=413.32MiB elapsed=12m51.614s eta=34h52m33.658s\r\nApr 29 06:00:04 geth geth[13559]: INFO [04-29|06:00:04.744] Generating state snapshot                at=0a932d…782fe1 accounts=1177058 slots=4585540 storage=413.62MiB elapsed=12m59.616s eta=34h47m11.993s\r\nApr 29 06:00:12 geth geth[13559]: INFO [04-29|06:00:12.746] Generating state snapshot                at=0a98ca…bbaf78 accounts=1179445 slots=4588316 storage=413.97MiB elapsed=13m7.618s  eta=34h38m35.906s\r\nApr 29 06:00:20 geth geth[13559]: INFO [04-29|06:00:20.747] Generating state snapshot                at=0a9e89…180d68 accounts=1181991 slots=4591162 storage=414.34MiB elapsed=13m15.620s eta=34h29m33.685s\r\nApr 29 06:00:29 geth geth[13559]: INFO [04-29|06:00:29.119] Generating state snapshot                at=0aa586…a1bf88 accounts=1185010 slots=4593847 storage=414.71MiB elapsed=13m23.992s eta=34h15m25.143s\r\nApr 29 06:00:37 geth geth[13559]: INFO [04-29|06:00:37.135] Generating state snapshot                at=0aab1b…dac011 accounts=1187463 slots=4596548 storage=415.06MiB elapsed=13m32.008s eta=34h7m47.911s\r\nApr 29 06:00:45 geth geth[13559]: INFO [04-29|06:00:45.137] Generating state snapshot                at=0ab1e6…735ba8 accounts=1190403 slots=4598892 storage=415.41MiB elapsed=13m40.009s eta=33h54m27.273s\r\nApr 29 06:00:53 geth geth[13559]: INFO [04-29|06:00:53.138] Generating state snapshot                at=0ab5cb…89454e accounts=1192032 slots=4601471 storage=415.70MiB elapsed=13m48.011s eta=33h55m23.621s\r\nApr 29 06:01:01 geth geth[13559]: INFO [04-29|06:01:01.144] Generating state snapshot                at=0abb03…2edabf accounts=1194314 slots=4603882 storage=416.01MiB elapsed=13m56.016s eta=33h50m1.633s\r\nApr 29 06:01:09 geth geth[13559]: INFO [04-29|06:01:09.166] Generating state snapshot                at=0abf26…a09df2 accounts=1196119 slots=4605903 storage=416.28MiB elapsed=14m4.038s  eta=33h49m53.295s\r\nApr 29 06:01:17 geth geth[13559]: INFO [04-29|06:01:17.167] Generating state snapshot                at=0ac481…70773d accounts=1198477 slots=4608846 storage=416.64MiB elapsed=14m12.039s eta=33h44m2.442s\r\nApr 29 06:01:25 geth geth[13559]: INFO [04-29|06:01:25.167] Generating state snapshot                at=0acb20…c0c3ce accounts=1201399 slots=4611268 storage=416.99MiB elapsed=14m20.040s eta=33h32m34.029s\r\nApr 29 06:01:33 geth geth[13559]: INFO [04-29|06:01:33.170] Generating state snapshot                at=0ad1c0…e1ecf3 accounts=1204275 slots=4613913 storage=417.35MiB elapsed=14m28.042s eta=33h21m26.013s\r\nApr 29 06:02:07 geth geth[13559]: INFO [04-29|06:02:07.861] Generating state snapshot                at=0ad707…cd07b1 accounts=1206512 slots=4632496 storage=418.83MiB elapsed=15m2.733s  eta=34h17m18.46s\r\nApr 29 06:02:15 geth geth[13559]: INFO [04-29|06:02:15.912] Generating state snapshot                at=0add7b…4c1eb5 accounts=1209312 slots=4635175 storage=419.20MiB elapsed=15m10.784s eta=34h6m40.434s\r\nApr 29 06:02:23 geth geth[13559]: INFO [04-29|06:02:23.918] Generating state snapshot                at=0ae2a2…66101e accounts=1211685 slots=4638388 storage=419.57MiB elapsed=15m18.790s eta=34h1m53.098s\r\nApr 29 06:02:31 geth geth[13559]: INFO [04-29|06:02:31.918] Generating state snapshot                at=0ae9ab…364bda accounts=1214683 slots=4640960 storage=419.94MiB elapsed=15m26.791s eta=33h49m5.946s\r\nApr 29 06:02:39 geth geth[13559]: INFO [04-29|06:02:39.922] Generating state snapshot                at=0aed66…7a1d30 accounts=1216368 slots=4644419 storage=420.33MiB elapsed=15m34.794s eta=33h50m38.219s\r\nApr 29 06:02:48 geth geth[13559]: INFO [04-29|06:02:48.981] Generating state snapshot                at=0af3a4…a0d610 accounts=1219011 slots=4647693 storage=420.73MiB elapsed=15m43.853s eta=33h43m51.878s\r\nApr 29 06:02:56 geth geth[13559]: INFO [04-29|06:02:56.983] Generating state snapshot                at=0af6c9…dc342a accounts=1220336 slots=4651545 storage=421.07MiB elapsed=15m51.855s eta=33h47m51.086s\r\n...\r\n```\r\nAfter the upgrade to 1.9.13 on ropsten the node wants to create a snapshot which is blocking synchronization with the blockchain. As you can see in the ETA it will take more tan 30hrs to create the snapshot. \r\nIt seems that at some point the `Aborting state snapshot` is happening and a new chain segment gets imported, but then freezes again.\r\nMy disks are not fully utilized and cpu is more than available.\r\n\r\nIs this happening to someone else or know why this is happening? \r\n\r\nMany thanks,\r\nbert",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20999/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20999/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/621030130",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20999#issuecomment-621030130",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20999",
    "id": 621030130,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMTAzMDEzMA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-29T07:14:43Z",
    "updated_at": "2020-04-29T07:14:43Z",
    "author_association": "MEMBER",
    "body": "This is not an error. If you ignore the `Generating ... `, then you have: \r\n```\r\nApr 29 05:55:52 geth geth[13559]: INFO [04-29|05:55:52.293] Imported new chain segment               blocks=1 txs=75 mgas=7.997 elapsed=408.613ms mgasps=19.571 number=7808450 hash=0a0573…ed8396 age=5m22s dirty=0.00B\r\nApr 29 05:56:53 geth geth[13559]: INFO [04-29|05:56:53.169] Imported new chain segment               blocks=1 txs=20 mgas=7.999 elapsed=433.197ms mgasps=18.464 number=7808451 hash=d94941…837891 age=1m2s  dirty=0.00B\r\n```\r\nAs you see, the blocks are imported one by one, as they trickle in. \r\n\r\nThe snapshot generator is set to spit out a bit of info every 8 seconds, so that's why you have so much output. It appears that the ropsten blocks have very long time between them -- which is not surprising, since ropsten is a PoW testnetwork, with huge fluctuations in mining power. \r\n\r\nThe snapshotter correctly pauses generation whenever there's a new block to import, and resumes after the block has been imported. \r\n\r\nNevertheless, thanks for trying out this feature, we'd love to get as much coverage of it as possible, since sooner or later, it will be enabled by default. \r\n\r\nAnd yes, it takes a very long time to generate -- it needs to traverse the entire trie. That's why it's been implemented to run in the background, and not as a one-time 20+ hour step. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/621030130/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
