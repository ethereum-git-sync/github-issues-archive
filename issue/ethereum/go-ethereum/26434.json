{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26434",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26434/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26434/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26434/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/26434",
  "id": 1519981184,
  "node_id": "I_kwDOAOvK985amRKA",
  "number": 26434,
  "title": "Etherscan contract interface does not check for authentication, Large number of admin functions callable by public, XSS vulnerability in etherscan.",
  "user": {
    "login": "amritabithi",
    "id": 48937881,
    "node_id": "MDQ6VXNlcjQ4OTM3ODgx",
    "avatar_url": "https://avatars.githubusercontent.com/u/48937881?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/amritabithi",
    "html_url": "https://github.com/amritabithi",
    "followers_url": "https://api.github.com/users/amritabithi/followers",
    "following_url": "https://api.github.com/users/amritabithi/following{/other_user}",
    "gists_url": "https://api.github.com/users/amritabithi/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/amritabithi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/amritabithi/subscriptions",
    "organizations_url": "https://api.github.com/users/amritabithi/orgs",
    "repos_url": "https://api.github.com/users/amritabithi/repos",
    "events_url": "https://api.github.com/users/amritabithi/events{/privacy}",
    "received_events_url": "https://api.github.com/users/amritabithi/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-01-05T03:11:11Z",
  "updated_at": "2023-01-05T07:36:49Z",
  "closed_at": "2023-01-05T07:28:36Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### Expected behaviour\r\n- Many functions across all contracts are publicly callable that are clearly only intended for admins of the contract to use, it is as though there is no authentication happening in most contracts for some contract function calls whatsoever.\r\n- The 'Write Contract' interface should prompt for authentication to make clicking the writable functions more difficult.\r\n- The form processing done on input from text boxes on the smart contract interface screens of \"Read Contract\" / \"Write Contract\" should filter special characters when receiving input, at least for double quotes and their various representations in hex, decimal, unicode, html entities, escaped JavaScript, etc.  Code can currently be injected into function calls by escaping the double quotes character and at a minimum cause exceptions as a method of burning gas on purpose ( not all gas is reverted upon certain exceptions).\r\n\r\n#### Actual behaviour\r\nThe public can manipulate some of the top contracts, potential for data corruption via XSS on etherscan, writeable panel of contract interface issues network requests on button clicks even if user is not logged in.  ( No error message or success message is displayed, but the request is sent and received and processed by the server when the button is pressed. )\r\nSome contracts that I was able to look at on goerli had nearly every writable function callable anonymously by the public without doing a proper transaction or requiring coins to issue.\r\n\r\n#### Steps to reproduce the behaviour\r\nView a contract on testnet like this one, go to \"Write Contract\" and enter zeros into each field, hit submit, and you have written to the contract without spending coins. - https://goerli.etherscan.io/address/0x8ae7063d03213d4d90103c16f048b3f64de2d4d0#code\r\n\r\nI have been trying to submit and get attention to these problems for some time now, to both an almost comical and embarassing degree, and after being completely ignored and seeing as this is being obviously abused I decided it better to post here so that people are made aware of the situation sooner than later.  I had reported this to solidity but have not heard back anything from them and in my opinion it is too late to siliently roll out a fix.\r\n",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26434/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26434/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1371870041",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/26434#issuecomment-1371870041",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26434",
    "id": 1371870041,
    "node_id": "IC_kwDOAOvK985RxRNZ",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-05T07:28:36Z",
    "updated_at": "2023-01-05T07:36:49Z",
    "author_association": "MEMBER",
    "body": "Hey there,\r\n\r\n  The are a number of issues with your report:\r\n\r\n- First up, this is not Etherscan's repos, so it's a bit misplace. But I understand you're trying to raise awareness. Still.\r\n- Contracts on the Ethereum network are all public and anything Etherscan can call, so can anyone directly via a transaction. Etherscan adding any authentication is irrelevant, because that's just one UI out of many to access contracts.\r\n- I wouldn't agree with your evaluation that many top contracts are publicly writable. All of them are restricted within the contracts deployed on Ethereum, that's where the authorization happens, not on the UI level. If you were to find any case where a top contract can be abused, the bounties paid by most teams are in the millions (so def go for it).\r\n- Writing a contract via etherscan is not free. You need an Ethereum account that can \"sign\" the transaction, meaning that whatever signs it will bear the costs. Etherscan won't bear the cost for you.\r\n- Side note, on testnets, I'd assume there are many many many contracts where people just play around with things, so that's not really the best baseline to say how many contracts are problematic. Those contracts are mostly test / play things that are works in progress with possibly many problems. The interesting ones are the mainnet ones.\r\n- Data sanitization is again not really the taks of Etherscan. They should submit whatever data they get to the contracts, that's the user's intent. Of course, if they display any data *out of* a contract they should ensure there's no XSS and similar vector, but that's on the read/display side, not when submitting.\r\n\r\nAll in all everything seems to work as intended. Perhaps you're missing a few insights on how exactly the smart contracts work, one thing that could help you understand the ecosystem a bit better is if you did just a couple starter tutorials on solidity and contract dev. That would allow you to see how contracts do authorization, what is callable/not, etc.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1371870041/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
