{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3628",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3628/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3628/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3628/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/3628",
  "id": 204697731,
  "node_id": "MDU6SXNzdWUyMDQ2OTc3MzE=",
  "number": 3628,
  "title": "crash while generating DAG: `unexpected signal during runtime execution`",
  "user": {
    "login": "SCBuergel",
    "id": 11379673,
    "node_id": "MDQ6VXNlcjExMzc5Njcz",
    "avatar_url": "https://avatars.githubusercontent.com/u/11379673?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/SCBuergel",
    "html_url": "https://github.com/SCBuergel",
    "followers_url": "https://api.github.com/users/SCBuergel/followers",
    "following_url": "https://api.github.com/users/SCBuergel/following{/other_user}",
    "gists_url": "https://api.github.com/users/SCBuergel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/SCBuergel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/SCBuergel/subscriptions",
    "organizations_url": "https://api.github.com/users/SCBuergel/orgs",
    "repos_url": "https://api.github.com/users/SCBuergel/repos",
    "events_url": "https://api.github.com/users/SCBuergel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/SCBuergel/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2017-02-01T20:36:24Z",
  "updated_at": "2017-02-02T14:04:52Z",
  "closed_at": "2017-02-02T14:04:51Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: Version: 1.5.5-unstable\r\nOS & Version: Ubuntu 16.04x64\r\n\r\n#### Expected behaviour\r\nGeth should just run fine.\r\n\r\n#### Actual behaviour\r\nGeth crashed at some point randomly while generating DAG while running for a few days in a private testnet.\r\n\r\n#### Steps to reproduce the behaviour\r\nI ran the following script for some days before it seems to randomly crash:\r\n```\r\ngeth --nodiscover --maxpeers 0 --datadir \"./chainData\" --targetgaslimit \"123123123\" --mine --minerthreads=1 --rpc --rpcapi \"eth,net,web3,personal\" --rpccorsdomain \"*\" --rpcaddr \"0.0.0.0\" --unlock 0xddba7cdc7601cf0b5f11de7cb8aaee66320e2972 --password /dev/null\r\n```",
  "closed_by": {
    "login": "SCBuergel",
    "id": 11379673,
    "node_id": "MDQ6VXNlcjExMzc5Njcz",
    "avatar_url": "https://avatars.githubusercontent.com/u/11379673?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/SCBuergel",
    "html_url": "https://github.com/SCBuergel",
    "followers_url": "https://api.github.com/users/SCBuergel/followers",
    "following_url": "https://api.github.com/users/SCBuergel/following{/other_user}",
    "gists_url": "https://api.github.com/users/SCBuergel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/SCBuergel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/SCBuergel/subscriptions",
    "organizations_url": "https://api.github.com/users/SCBuergel/orgs",
    "repos_url": "https://api.github.com/users/SCBuergel/repos",
    "events_url": "https://api.github.com/users/SCBuergel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/SCBuergel/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3628/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3628/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/276809491",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/3628#issuecomment-276809491",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3628",
    "id": 276809491,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NjgwOTQ5MQ==",
    "user": {
      "login": "dbblackdiamond",
      "id": 11542603,
      "node_id": "MDQ6VXNlcjExNTQyNjAz",
      "avatar_url": "https://avatars.githubusercontent.com/u/11542603?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dbblackdiamond",
      "html_url": "https://github.com/dbblackdiamond",
      "followers_url": "https://api.github.com/users/dbblackdiamond/followers",
      "following_url": "https://api.github.com/users/dbblackdiamond/following{/other_user}",
      "gists_url": "https://api.github.com/users/dbblackdiamond/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dbblackdiamond/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dbblackdiamond/subscriptions",
      "organizations_url": "https://api.github.com/users/dbblackdiamond/orgs",
      "repos_url": "https://api.github.com/users/dbblackdiamond/repos",
      "events_url": "https://api.github.com/users/dbblackdiamond/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dbblackdiamond/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-01T22:52:45Z",
    "updated_at": "2017-02-01T22:52:45Z",
    "author_association": "NONE",
    "body": "@SCBuergel : we used to have the same issue on our private chain and it turned out to be a memory issue. Geth was running out of memory during the DAG generation process at random time and would just crash. I increased the virtual memory on my nodes by increasing the swap space and it has been fine since. Try it out and see how it works for you.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/276809491/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/276818061",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/3628#issuecomment-276818061",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3628",
    "id": 276818061,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NjgxODA2MQ==",
    "user": {
      "login": "SCBuergel",
      "id": 11379673,
      "node_id": "MDQ6VXNlcjExMzc5Njcz",
      "avatar_url": "https://avatars.githubusercontent.com/u/11379673?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SCBuergel",
      "html_url": "https://github.com/SCBuergel",
      "followers_url": "https://api.github.com/users/SCBuergel/followers",
      "following_url": "https://api.github.com/users/SCBuergel/following{/other_user}",
      "gists_url": "https://api.github.com/users/SCBuergel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SCBuergel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SCBuergel/subscriptions",
      "organizations_url": "https://api.github.com/users/SCBuergel/orgs",
      "repos_url": "https://api.github.com/users/SCBuergel/repos",
      "events_url": "https://api.github.com/users/SCBuergel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SCBuergel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-01T23:32:18Z",
    "updated_at": "2017-02-01T23:32:18Z",
    "author_association": "NONE",
    "body": "Thanks @dbblackdiamond, how big a swap file did you give it? ATM, I have 3.5GB memory in total but no swap file at all (default cloud machine).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/276818061/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/276864487",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/3628#issuecomment-276864487",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3628",
    "id": 276864487,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3Njg2NDQ4Nw==",
    "user": {
      "login": "dbblackdiamond",
      "id": 11542603,
      "node_id": "MDQ6VXNlcjExNTQyNjAz",
      "avatar_url": "https://avatars.githubusercontent.com/u/11542603?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dbblackdiamond",
      "html_url": "https://github.com/dbblackdiamond",
      "followers_url": "https://api.github.com/users/dbblackdiamond/followers",
      "following_url": "https://api.github.com/users/dbblackdiamond/following{/other_user}",
      "gists_url": "https://api.github.com/users/dbblackdiamond/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dbblackdiamond/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dbblackdiamond/subscriptions",
      "organizations_url": "https://api.github.com/users/dbblackdiamond/orgs",
      "repos_url": "https://api.github.com/users/dbblackdiamond/repos",
      "events_url": "https://api.github.com/users/dbblackdiamond/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dbblackdiamond/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-02T04:18:51Z",
    "updated_at": "2017-02-02T04:18:51Z",
    "author_association": "NONE",
    "body": "@SCBuergel : I have 16GB of RAM on my nodes and I created a 32GB swap partition. My nodes are starting with a `--cache=4096` value. From what I can see though, my nodes are barely using any swap, so I would think that for your installation, using 4GB of swap should probably be sufficient. Give that a try and see if you still have the issue.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/276864487/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/276935957",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/3628#issuecomment-276935957",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3628",
    "id": 276935957,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NjkzNTk1Nw==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-02T11:43:36Z",
    "updated_at": "2017-02-02T11:43:36Z",
    "author_association": "MEMBER",
    "body": "@SCBuergel 3.5GB memory in total is a bit pushing it for mining. The first DAG is about 1GB in size. Couple that with Go's garbage collector strategy to only run when at least as much memory is allocated that the previous sweep left, and you're at 2GB memory requirement already, and we haven't even talked about how much Geth uses for it's normal operation. I'm not sure exactly what happens during epoch transitions when a new DAG is generated but the old is still available, but I can imagine that being a problematic transition, since it possibly doubles the memory needed for the DAG for a short time span.\r\n\r\n@dbblackdiamond 4GB memory for the database cache may be a bit much, since the more live memory, the higher the burden on the garbage collector (should be a lot better with Go 1.8 though). Not saying that you should use less, just that it might worth a check to see how it would perform :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/276935957/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/276946478",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/3628#issuecomment-276946478",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3628",
    "id": 276946478,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3Njk0NjQ3OA==",
    "user": {
      "login": "SCBuergel",
      "id": 11379673,
      "node_id": "MDQ6VXNlcjExMzc5Njcz",
      "avatar_url": "https://avatars.githubusercontent.com/u/11379673?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SCBuergel",
      "html_url": "https://github.com/SCBuergel",
      "followers_url": "https://api.github.com/users/SCBuergel/followers",
      "following_url": "https://api.github.com/users/SCBuergel/following{/other_user}",
      "gists_url": "https://api.github.com/users/SCBuergel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SCBuergel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SCBuergel/subscriptions",
      "organizations_url": "https://api.github.com/users/SCBuergel/orgs",
      "repos_url": "https://api.github.com/users/SCBuergel/repos",
      "events_url": "https://api.github.com/users/SCBuergel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SCBuergel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-02T12:37:35Z",
    "updated_at": "2017-02-02T12:37:35Z",
    "author_association": "NONE",
    "body": "@karalabe thanks for the explanation. It would be advantageous to have a more meaningful crash report than [this lengthy crash output](https://gist.github.com/SCBuergel/8018cc902efb76bd1edf4e287d62109f) that geth currently produces though. It takes people a while to figure that this is a memory issue.\r\n\r\n@dbblackdiamond so far running ok with 4GB swap file.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/276946478/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/276947366",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/3628#issuecomment-276947366",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3628",
    "id": 276947366,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3Njk0NzM2Ng==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-02T12:42:39Z",
    "updated_at": "2017-02-02T12:42:39Z",
    "author_association": "MEMBER",
    "body": "Unfortunately this isn't generated by Go. We are using the C++ ethash implementation and if that code crashes, it is beyond the capacity of Go to recover from it to even print a decent error message. Go would have output a nice error message explicitly stating it it out of memory if it were to happen within Go code, but in this case C++ code crashes and takes the entire process down with it.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/276947366/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/276947504",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/3628#issuecomment-276947504",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3628",
    "id": 276947504,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3Njk0NzUwNA==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-02T12:43:20Z",
    "updated_at": "2017-02-02T12:43:20Z",
    "author_association": "MEMBER",
    "body": "Would have been nice to reimplement ethash in Go, alas there's little benefit, especially with plans being to transition to PoS.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/276947504/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/276965693",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/3628#issuecomment-276965693",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3628",
    "id": 276965693,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3Njk2NTY5Mw==",
    "user": {
      "login": "SCBuergel",
      "id": 11379673,
      "node_id": "MDQ6VXNlcjExMzc5Njcz",
      "avatar_url": "https://avatars.githubusercontent.com/u/11379673?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SCBuergel",
      "html_url": "https://github.com/SCBuergel",
      "followers_url": "https://api.github.com/users/SCBuergel/followers",
      "following_url": "https://api.github.com/users/SCBuergel/following{/other_user}",
      "gists_url": "https://api.github.com/users/SCBuergel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SCBuergel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SCBuergel/subscriptions",
      "organizations_url": "https://api.github.com/users/SCBuergel/orgs",
      "repos_url": "https://api.github.com/users/SCBuergel/repos",
      "events_url": "https://api.github.com/users/SCBuergel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SCBuergel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-02T14:04:51Z",
    "updated_at": "2017-02-02T14:04:51Z",
    "author_association": "NONE",
    "body": "Interesting insight @karalabe. Ok I will open if this is re-appearing for other reasons.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/276965693/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
