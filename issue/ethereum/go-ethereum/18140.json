{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/18140",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/18140/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/18140/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/18140/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/18140",
  "id": 382604629,
  "node_id": "MDU6SXNzdWUzODI2MDQ2Mjk=",
  "number": 18140,
  "title": "Potential decoding error",
  "user": {
    "login": "ireneGP",
    "id": 44623557,
    "node_id": "MDQ6VXNlcjQ0NjIzNTU3",
    "avatar_url": "https://avatars.githubusercontent.com/u/44623557?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ireneGP",
    "html_url": "https://github.com/ireneGP",
    "followers_url": "https://api.github.com/users/ireneGP/followers",
    "following_url": "https://api.github.com/users/ireneGP/following{/other_user}",
    "gists_url": "https://api.github.com/users/ireneGP/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ireneGP/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ireneGP/subscriptions",
    "organizations_url": "https://api.github.com/users/ireneGP/orgs",
    "repos_url": "https://api.github.com/users/ireneGP/repos",
    "events_url": "https://api.github.com/users/ireneGP/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ireneGP/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2018-11-20T10:48:20Z",
  "updated_at": "2018-11-20T13:18:31Z",
  "closed_at": "2018-11-20T13:07:03Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hello,\r\n\r\n- Go EVM version: evm version 1.8.18-unstable-68109336\r\n- Parity EVM version: Parity-Ethereum/v2.2.0-nightly-f4c421f77-20181024/x86_64-linux-gnu/rustc1.29.2\r\n- Operating system: Ubuntu 18.04\r\n- Fully synchronized: NA\r\n- Network: NA\r\n- Restarted: NA\r\n\r\nSo I tried to execute this bytecode sequences (https://etherscan.io/address/d4b9680837c1c40923c096cba6fed6303a7f3f36#code) with  `evm`, and it seems that `evm` incorrectly decodes this bytecode when reaching to `pc=407`:\r\n\r\n````\r\n{\"pc\":406,\"op\":136,\"gas\":\"0x25408b01d\",\"gasCost\":\"0x3\",\"memory\":\"0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001800000000000000000000$\r\n0000000000000000000000000000000000000000000000000000000000000000000001d95406787463b7c6e8091bfe6324556acf1ad8000000000000000000000000a450877812d120315f343aec62b5cf1ad39e8468000000000000000000000000e4b0aca9d6043400b3fcbd17b0d253403aa096db000000000000000000000000bf1e01f61ee33a6113$\r\n75502ee23bad06dcce52c0000000000000000000000008071db89a3660c4d11a7b845bfc6a9e0597cf76f000000000000000000000000f14228fbd920145d9f4d4d5e38760d9410e9977500000000000000000000000002082526872ac686196ba39bbe3c816bf370ba940000000000000000000000000000000000000000000000000000000000000000\"$\r\n\"memSize\":384,\"stack\":[\"0x0\",\"0x126\",\"0x30\",\"0x8fc\",\"0x0\",\"0x180\",\"0x0\",\"0x180\",\"0x0\",\"0x180\",\"0x0\",\"0x30\"],\"depth\":1,\"refund\":0,\"opName\":\"DUP9\",\"error\":\"\"}\r\n{\"pc\":407,\"op\":241,\"gas\":\"0x25408b01a\",\"gasCost\":\"0xbb8\",\"memory\":\"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000018000000000000000000$\r\n000000000000000000000000000000000000000000000000000000000000000000000001d95406787463b7c6e8091bfe6324556acf1ad8000000000000000000000000a450877812d120315f343aec62b5cf1ad39e8468000000000000000000000000e4b0aca9d6043400b3fcbd17b0d253403aa096db000000000000000000000000bf1e01f61ee33a61$\r\n3875502ee23bad06dcce52c0000000000000000000000008071db89a3660c4d11a7b845bfc6a9e0597cf76f000000000000000000000000f14228fbd920145d9f4d4d5e38760d9410e9977500000000000000000000000002082526872ac686196ba39bbe3c816bf370ba94000000000000000000000000000000000000000000000000000000000000000$\r\n\",\"memSize\":384,\"stack\":[\"0x0\",\"0x126\",\"0x30\",\"0x8fc\",\"0x0\",\"0x180\",\"0x0\",\"0x180\",\"0x0\",\"0x180\",\"0x0\",\"0x30\",\"0x8fc\"],\"depth\":1,\"refund\":0,\"opName\":\"CALL\",\"error\":\"\"}\r\n{\"pc\":0,\"op\":100,\"gas\":\"0x8fc\",\"gasCost\":\"0x3\",\"memory\":\"0x\",\"memSize\":0,\"stack\":[],\"depth\":2,\"refund\":0,\"opName\":\"PUSH5\",\"error\":\"\"}\r\n````\r\n\r\nIn contrast: when I use `https://etherscan.io/opcode-tool`, this is how it looks:\r\n\r\n````\r\n[390] SWAP1 \r\n[391] CALLVALUE \r\n[392] DUP1 \r\n[393] ISZERO \r\n[396] PUSH2 0x08fc \r\n[397] MUL \r\n[398] SWAP2 \r\n[400] PUSH1 0x00 \r\n[401] DUP2 \r\n[402] DUP2 \r\n[403] DUP2 \r\n[404] DUP6 \r\n[405] DUP9 \r\n[406] DUP9 \r\n[407] CALL \r\n[408] SWAP4 \r\n[409] POP \r\n````\r\n\r\nIndeed I also tried `parity-evm`, and it gives the same output with `etherscan`. \r\n\r\nCould anyone shed some lights on this? Thanks.",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/18140/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/18140/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/440266853",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/18140#issuecomment-440266853",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/18140",
    "id": 440266853,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MDI2Njg1Mw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-20T13:07:03Z",
    "updated_at": "2018-11-20T13:07:50Z",
    "author_association": "MEMBER",
    "body": "In the `evm` trace: \r\n```\r\n{\"pc\":406,... opName\":\"DUP9\",\"error\":\"\"}\r\n{\"pc\":407 ,... opName\":\"CALL\",\"error\":\"\"}\r\n   {\"pc\":0,  \"depth\":2,\"refund\":0,\"opName\":\"PUSH5\",\"error\":\"\"}\r\n```\r\n\r\nThat's a trace, it does a call into another contract. The opcode tool will only show you the current contract, not code of contracts it may call into. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/440266853/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/440270252",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/18140#issuecomment-440270252",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/18140",
    "id": 440270252,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MDI3MDI1Mg==",
    "user": {
      "login": "ireneGP",
      "id": 44623557,
      "node_id": "MDQ6VXNlcjQ0NjIzNTU3",
      "avatar_url": "https://avatars.githubusercontent.com/u/44623557?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ireneGP",
      "html_url": "https://github.com/ireneGP",
      "followers_url": "https://api.github.com/users/ireneGP/followers",
      "following_url": "https://api.github.com/users/ireneGP/following{/other_user}",
      "gists_url": "https://api.github.com/users/ireneGP/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ireneGP/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ireneGP/subscriptions",
      "organizations_url": "https://api.github.com/users/ireneGP/orgs",
      "repos_url": "https://api.github.com/users/ireneGP/repos",
      "events_url": "https://api.github.com/users/ireneGP/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ireneGP/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-20T13:18:31Z",
    "updated_at": "2018-11-20T13:18:31Z",
    "author_association": "NONE",
    "body": "@holiman  I tested the `evm` within a local environment. So there is no other contract to be called I guess? `parity-evm` gives the identical trace as shown in the decoded instructions. So this is again some default configuration issue? ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/440270252/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
