{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23396",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23396/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23396/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23396/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/23396",
  "id": 970676403,
  "node_id": "MDU6SXNzdWU5NzA2NzY0MDM=",
  "number": 23396,
  "title": "--dev: transactions get stuck in pending",
  "user": {
    "login": "domohawk",
    "id": 7667046,
    "node_id": "MDQ6VXNlcjc2NjcwNDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7667046?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/domohawk",
    "html_url": "https://github.com/domohawk",
    "followers_url": "https://api.github.com/users/domohawk/followers",
    "following_url": "https://api.github.com/users/domohawk/following{/other_user}",
    "gists_url": "https://api.github.com/users/domohawk/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/domohawk/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/domohawk/subscriptions",
    "organizations_url": "https://api.github.com/users/domohawk/orgs",
    "repos_url": "https://api.github.com/users/domohawk/repos",
    "events_url": "https://api.github.com/users/domohawk/events{/privacy}",
    "received_events_url": "https://api.github.com/users/domohawk/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2021-08-13T20:00:55Z",
  "updated_at": "2021-08-23T21:14:46Z",
  "closed_at": "2021-08-23T21:14:46Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n```\r\n$ geth version\r\nGeth\r\nVersion: 1.10.6-stable\r\nGit Commit: 576681f29b895dd39e559b7ba17fcd89b42e4833\r\nGit Commit Date: 20210722\r\nArchitecture: amd64\r\nGo Version: go1.16.6\r\nOperating System: linux\r\nGOPATH=\r\nGOROOT=go\r\n```\r\nOS & Version: Linux casper 5.10.56-1-MANJARO #1 SMP PREEMPT Thu Aug 5 10:51:27 UTC 2021 x86_64 GNU/Linux\r\n\r\nI'm was trying to follow the [directions here](https://geth.ethereum.org/docs/getting-started/dev-mode) to use `geth --dev` as a drop-in replacement for my ganache-cli tests as an entry to switching to geth, and while I connect to RPC and it lists the dev account with balance etc, when I submit my contract it gets promoted into the queue but gets stuck pending in the pool and never mined. This happens both with rust-web3 and truffle web3js clients.\r\n\r\nThis happens both with --dev.period=0 (default) and --dev.period=1 (I see new blocks mined, but the contract is still stuck in the pool).\r\n\r\n```rm -rf /tmp/geth_testchain/* && geth --datadir /tmp/geth_testchain/ --http --dev --verbosity 7 --miner.gasprice 1 --dev.period=1```\r\n[period1.log](https://github.com/ethereum/go-ethereum/files/6984879/period1.log)\r\n```geth attach /tmp/geth_testchain/geth.ipc --exec \"eth.pendingTransactions\"```  (run twice a few blocks apart)\r\n[p1.txpool.log](https://github.com/ethereum/go-ethereum/files/6984883/p1.txpool.log)\r\n\r\nThe same thing happens with --dev.period=0, just without the extra mined blocks.\r\n\r\nAs you can see from the log it gets promoted to queued transaction, but just stays as executable in the transaction pool as new blocks are mined.\r\n```\r\nTRACE[08-13|12:47:22.000] Promoted queued transactions             count=1\r\nDEBUG[08-13|12:47:22.000] Transaction broadcast                    txs=1 announce packs=0 announced hashes=0 tx packs=0 broadcast txs=0\r\nINFO [08-13|12:47:22.000] Submitted contract creation              hash=0x4d8faf757d4b378a40bf868092843ef38dc306df64c79a7e7a323ac2a5ee9420 from=0xA812A32F96fe8EBAc00Dbeb0E3259b261E16172e nonce=0 contract=0xbfE7E235682D9E1C47e31A8d3Bc0c2789f7389A3 value=0\r\nDEBUG[08-13|12:47:22.491] Transaction pool status report           executable=1 queued=0 stales=0\r\n```\r\n\r\n\r\nThis seems very similar to #21951, however:\r\n\r\n1. The logs show all forks are already starting at block# 0, which is the workaround for that issue\r\n2. --dev.period=1 also works around that issue, but not here",
  "closed_by": {
    "login": "domohawk",
    "id": 7667046,
    "node_id": "MDQ6VXNlcjc2NjcwNDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7667046?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/domohawk",
    "html_url": "https://github.com/domohawk",
    "followers_url": "https://api.github.com/users/domohawk/followers",
    "following_url": "https://api.github.com/users/domohawk/following{/other_user}",
    "gists_url": "https://api.github.com/users/domohawk/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/domohawk/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/domohawk/subscriptions",
    "organizations_url": "https://api.github.com/users/domohawk/orgs",
    "repos_url": "https://api.github.com/users/domohawk/repos",
    "events_url": "https://api.github.com/users/domohawk/events{/privacy}",
    "received_events_url": "https://api.github.com/users/domohawk/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23396/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23396/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/901042066",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23396#issuecomment-901042066",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23396",
    "id": 901042066,
    "node_id": "IC_kwDOAOvK9841tM-S",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-18T11:38:46Z",
    "updated_at": "2021-08-18T11:38:46Z",
    "author_association": "MEMBER",
    "body": "If you look at the genesis block\r\n\r\n```\r\n> eth.getBlock(0)\r\n{\r\n  baseFeePerGas: 1000000000,\r\n  difficulty: 1,\r\n  extraData: \"0x000000000000000000000000000000000000000000000000000000000000000085d4f4e5bd07bd0caa14163d7700ebf0514f14510000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\r\n  gasLimit: 11500000,\r\n  gasUsed: 0,\r\n  hash: \"0x4a8ac612e1e95e935b81a11db5d673ebfca1df12c68eb5f00509df8dd3818205\",\r\n  logsBloom: \"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\r\n  miner: \"0x0000000000000000000000000000000000000000\",\r\n  mixHash: \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n  nonce: \"0x0000000000000000\",\r\n  number: 0,\r\n  parentHash: \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n  receiptsRoot: \"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421\",\r\n  sha3Uncles: \"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347\",\r\n  size: 627,\r\n  stateRoot: \"0x109690f5f2a189f3b39f8e8935f9958eac3ce05af4799463d351c283a1bf1eb3\",\r\n  timestamp: 0,\r\n  totalDifficulty: 1,\r\n  transactions: [],\r\n  transactionsRoot: \"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421\",\r\n  uncles: []\r\n}\r\n```\r\n\r\nYou'll see that `baseFeePerGas` is 1 gwei starting from London. Your transactions specified a gas price of 50wei, so they cannot be included in blocks until the base fee drops below that. If you raise your prices above 1 gwei, it should work again.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/901042066/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/901518147",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23396#issuecomment-901518147",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23396",
    "id": 901518147,
    "node_id": "IC_kwDOAOvK9841vBND",
    "user": {
      "login": "domohawk",
      "id": 7667046,
      "node_id": "MDQ6VXNlcjc2NjcwNDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7667046?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/domohawk",
      "html_url": "https://github.com/domohawk",
      "followers_url": "https://api.github.com/users/domohawk/followers",
      "following_url": "https://api.github.com/users/domohawk/following{/other_user}",
      "gists_url": "https://api.github.com/users/domohawk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/domohawk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/domohawk/subscriptions",
      "organizations_url": "https://api.github.com/users/domohawk/orgs",
      "repos_url": "https://api.github.com/users/domohawk/repos",
      "events_url": "https://api.github.com/users/domohawk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/domohawk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-19T00:29:47Z",
    "updated_at": "2021-08-19T00:29:47Z",
    "author_association": "NONE",
    "body": "@karalabe Thank you!\r\n\r\nSo I take it baseFeePerGas price is different from the ```--miner.gasprice 1``` I was specifying? Or if they are the same, the protocol overrides this? If the latter, perhaps we could print a warning or error if this value is invalid?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/901518147/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/903855693",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23396#issuecomment-903855693",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23396",
    "id": 903855693,
    "node_id": "IC_kwDOAOvK9841375N",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-23T15:04:25Z",
    "updated_at": "2021-08-23T15:04:25Z",
    "author_association": "MEMBER",
    "body": "`--miner.gasprice` is the target the miner pushes towards, but the basefee can only change 1/1024th on every block, so it takes a while to push it down. Also the minimum is 7.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/903855693/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/903856238",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23396#issuecomment-903856238",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23396",
    "id": 903856238,
    "node_id": "IC_kwDOAOvK984138Bu",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-23T15:04:58Z",
    "updated_at": "2021-08-23T15:04:58Z",
    "author_association": "MEMBER",
    "body": "Actually, it's a bit more, I think it can go `/2` in 5 blocks. Either way, long way down to 7 :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/903856238/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/904137833",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23396#issuecomment-904137833",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23396",
    "id": 904137833,
    "node_id": "IC_kwDOAOvK98415Axp",
    "user": {
      "login": "domohawk",
      "id": 7667046,
      "node_id": "MDQ6VXNlcjc2NjcwNDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7667046?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/domohawk",
      "html_url": "https://github.com/domohawk",
      "followers_url": "https://api.github.com/users/domohawk/followers",
      "following_url": "https://api.github.com/users/domohawk/following{/other_user}",
      "gists_url": "https://api.github.com/users/domohawk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/domohawk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/domohawk/subscriptions",
      "organizations_url": "https://api.github.com/users/domohawk/orgs",
      "repos_url": "https://api.github.com/users/domohawk/repos",
      "events_url": "https://api.github.com/users/domohawk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/domohawk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-23T21:14:46Z",
    "updated_at": "2021-08-23T21:14:46Z",
    "author_association": "NONE",
    "body": "Thanks for the explanation! Indeed after waiting for many blocks my initial fee of 50 does go through from pending in the original setup.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/904137833/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
