{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27197",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27197/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27197/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27197/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/27197",
  "id": 1689317168,
  "node_id": "I_kwDOAOvK985ksO8w",
  "number": 27197,
  "title": "eth_getBlockByHash with the hash of the latest block",
  "user": {
    "login": "1ee5c807",
    "id": 45994721,
    "node_id": "MDQ6VXNlcjQ1OTk0NzIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/45994721?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/1ee5c807",
    "html_url": "https://github.com/1ee5c807",
    "followers_url": "https://api.github.com/users/1ee5c807/followers",
    "following_url": "https://api.github.com/users/1ee5c807/following{/other_user}",
    "gists_url": "https://api.github.com/users/1ee5c807/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/1ee5c807/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/1ee5c807/subscriptions",
    "organizations_url": "https://api.github.com/users/1ee5c807/orgs",
    "repos_url": "https://api.github.com/users/1ee5c807/repos",
    "events_url": "https://api.github.com/users/1ee5c807/events{/privacy}",
    "received_events_url": "https://api.github.com/users/1ee5c807/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "s1na",
    "id": 1591639,
    "node_id": "MDQ6VXNlcjE1OTE2Mzk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1591639?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/s1na",
    "html_url": "https://github.com/s1na",
    "followers_url": "https://api.github.com/users/s1na/followers",
    "following_url": "https://api.github.com/users/s1na/following{/other_user}",
    "gists_url": "https://api.github.com/users/s1na/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/s1na/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/s1na/subscriptions",
    "organizations_url": "https://api.github.com/users/s1na/orgs",
    "repos_url": "https://api.github.com/users/s1na/repos",
    "events_url": "https://api.github.com/users/s1na/events{/privacy}",
    "received_events_url": "https://api.github.com/users/s1na/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "s1na",
      "id": 1591639,
      "node_id": "MDQ6VXNlcjE1OTE2Mzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1591639?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/s1na",
      "html_url": "https://github.com/s1na",
      "followers_url": "https://api.github.com/users/s1na/followers",
      "following_url": "https://api.github.com/users/s1na/following{/other_user}",
      "gists_url": "https://api.github.com/users/s1na/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/s1na/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/s1na/subscriptions",
      "organizations_url": "https://api.github.com/users/s1na/orgs",
      "repos_url": "https://api.github.com/users/s1na/repos",
      "events_url": "https://api.github.com/users/s1na/events{/privacy}",
      "received_events_url": "https://api.github.com/users/s1na/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-04-29T02:03:25Z",
  "updated_at": "2023-08-31T12:34:21Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: geth version 1.11.7-unstable-523fe430-20230428\r\nCL client & version: prysm@v4.0.3\r\nOS & Version: Linux\r\nCommit hash : (if `develop`)\r\n\r\n#### Expected behaviour\r\nOn an Ethereum client, after subscribing to geth, immediately after a new blockheader arrives, a lookup with eth_getBlockByHash using the block's hash should result in a lookup.\r\n\r\n#### Actual behaviour\r\nReturns not_found as the result.\r\n\r\n#### Steps to reproduce the behaviour\r\n1. Subscribe the NewHead to the Geth.\r\n2. When a new header arrives, call eth_getBlockByHash with the hash of the arrived header.\r\n3. Check for not_found.\r\n\r\n#### Backtrace\r\nN/A\r\n\r\n#### Please Note Below\r\nI have also conducted a test with a few code modification,  wherein I utilized the eth_getBlockByNumber method under the exact same circumstances as described above,\r\nand it worked perfectly fine. \r\n\r\nAnd my code was working fine before, but it breaks with the latest version of geth.\r\n\r\nI didn't analyze it in detail because I didn't have time. \r\n\r\nHowever, I strongly suspect that the bug is in the code that notifies the client of the arrival of a new blockheader before the code that maps the block hash to the block number and stores it.\r\n\r\nI'm hoping that someone who is an expert on the issue will fix it soon.\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27197/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27197/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1531925882",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/27197#issuecomment-1531925882",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27197",
    "id": 1531925882,
    "node_id": "IC_kwDOAOvK985bT1V6",
    "user": {
      "login": "0xall",
      "id": 26502092,
      "node_id": "MDQ6VXNlcjI2NTAyMDky",
      "avatar_url": "https://avatars.githubusercontent.com/u/26502092?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/0xall",
      "html_url": "https://github.com/0xall",
      "followers_url": "https://api.github.com/users/0xall/followers",
      "following_url": "https://api.github.com/users/0xall/following{/other_user}",
      "gists_url": "https://api.github.com/users/0xall/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/0xall/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0xall/subscriptions",
      "organizations_url": "https://api.github.com/users/0xall/orgs",
      "repos_url": "https://api.github.com/users/0xall/repos",
      "events_url": "https://api.github.com/users/0xall/events{/privacy}",
      "received_events_url": "https://api.github.com/users/0xall/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-02T18:09:23Z",
    "updated_at": "2023-05-02T18:09:23Z",
    "author_association": "NONE",
    "body": "Which node does it happen? Light node or full node?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1531925882/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1534327787",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/27197#issuecomment-1534327787",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27197",
    "id": 1534327787,
    "node_id": "IC_kwDOAOvK985bc_vr",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-04T08:48:27Z",
    "updated_at": "2023-05-04T08:48:27Z",
    "author_association": "MEMBER",
    "body": "Thanks for the report, we'll investigate!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1534327787/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1700951944",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/27197#issuecomment-1700951944",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27197",
    "id": 1700951944,
    "node_id": "IC_kwDOAOvK985lYneI",
    "user": {
      "login": "s1na",
      "id": 1591639,
      "node_id": "MDQ6VXNlcjE1OTE2Mzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1591639?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/s1na",
      "html_url": "https://github.com/s1na",
      "followers_url": "https://api.github.com/users/s1na/followers",
      "following_url": "https://api.github.com/users/s1na/following{/other_user}",
      "gists_url": "https://api.github.com/users/s1na/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/s1na/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/s1na/subscriptions",
      "organizations_url": "https://api.github.com/users/s1na/orgs",
      "repos_url": "https://api.github.com/users/s1na/repos",
      "events_url": "https://api.github.com/users/s1na/events{/privacy}",
      "received_events_url": "https://api.github.com/users/s1na/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-31T12:34:21Z",
    "updated_at": "2023-08-31T12:34:21Z",
    "author_association": "MEMBER",
    "body": "I haven't been able to reproduce this issue. I have a subscription to newHeads running for a while and doing `getBlockByHash` of the result which works. Does it still persist for you on the latest version?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1700951944/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
