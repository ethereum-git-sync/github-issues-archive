{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3601",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3601/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3601/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3601/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/3601",
  "id": 202562316,
  "node_id": "MDU6SXNzdWUyMDI1NjIzMTY=",
  "number": 3601,
  "title": "swarm --recursive up failes on directories that contain linked(aliesed) files",
  "user": {
    "login": "him2him2",
    "id": 10393491,
    "node_id": "MDQ6VXNlcjEwMzkzNDkx",
    "avatar_url": "https://avatars.githubusercontent.com/u/10393491?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/him2him2",
    "html_url": "https://github.com/him2him2",
    "followers_url": "https://api.github.com/users/him2him2/followers",
    "following_url": "https://api.github.com/users/him2him2/following{/other_user}",
    "gists_url": "https://api.github.com/users/him2him2/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/him2him2/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/him2him2/subscriptions",
    "organizations_url": "https://api.github.com/users/him2him2/orgs",
    "repos_url": "https://api.github.com/users/him2him2/repos",
    "events_url": "https://api.github.com/users/him2him2/events{/privacy}",
    "received_events_url": "https://api.github.com/users/him2him2/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2017-01-23T15:19:08Z",
  "updated_at": "2018-12-14T13:30:37Z",
  "closed_at": "2018-08-08T16:49:29Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth Version: 1.5.8-unstable\r\nProtocol Versions: [63 62]\r\nGo Version: go1.7.4\r\nOS: linux\r\n\r\nSwarm Version: 0.2\r\nGo Version: go1.7.4\r\nOS: linux\r\n\r\n#### Expected behaviour\r\nWhen using the swarm command swarm --recursive up /direcrtory that contains linked(aliesed) files the links should resolve.\r\n\r\n#### Actual behaviour\r\nThe upload process fails because the content length is set to the file system link size and the content of the upload body is set to the linked to file, creating a ContentLength/Body Length mismatch, producing the following error:\r\n\r\nI0122 20:17:25.999399 upload.go:195] uploading file ngprogress/1.1.2/ngProgress.js (13 bytes) and adding path ngprogress/1.1.2/ngProgress.js\r\n\r\nI0122 20:17:25.999522 upload.go:67] Put http://127.0.0.1:8500/bzz:/3257223060b22aadd6364292dffb44009f6eba767516c978961970af07e3e9ff/ngprogress/1.1.2/ngProgress.js:  **http: ContentLength=13 with Body length 10141**\r\n\r\nThis is the directory being uploaded:\r\n$ ls -la\r\ntotal 24\r\ndrwxrwxr-x  2 ron ron  4096 Jan 22 19:51 .\r\ndrwxrwxr-x 17 ron ron  4096 Jan 22 19:51 ..\r\n-rw-rw-r--  1 ron ron 10141 Jan 22 19:33 ngprogress.js\r\nlrwxrwxrwx  1 ron ron    13 Jan 22 19:51 ngProgress.js -> ngprogress.js\r\n-rw-rw-r--  1 ron ron  3856 Jan 22 19:33 ngprogress.min.js\r\nlrwxrwxrwx  1 ron ron    17 Jan 22 19:51 ngProgress.min.js -> ngprogress.min.js\r\n\r\n#### Steps to reproduce the behaviour\r\nswarm --recursive up /direcrtory that contains linked(aliesed) files\r\n\r\n#### Backtrace\r\n\r\n````\r\n\r\nI0122 20:17:25.999399 upload.go:195] uploading file ngprogress/1.1.2/ngProgress.js (13 bytes) and adding path ngprogress/1.1.2/ngProgress.js\r\n\r\nI0122 20:17:25.999522 upload.go:67] Put http://127.0.0.1:8500/bzz:/3257223060b22aadd6364292dffb44009f6eba767516c978961970af07e3e9ff/ngprogress/1.1.2/ngProgress.js: \r\nhttp: ContentLength=13 with Body length 10141\r\n\r\n\r\n\r\n````\r\n",
  "closed_by": {
    "login": "cobordism",
    "id": 12838530,
    "node_id": "MDQ6VXNlcjEyODM4NTMw",
    "avatar_url": "https://avatars.githubusercontent.com/u/12838530?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cobordism",
    "html_url": "https://github.com/cobordism",
    "followers_url": "https://api.github.com/users/cobordism/followers",
    "following_url": "https://api.github.com/users/cobordism/following{/other_user}",
    "gists_url": "https://api.github.com/users/cobordism/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cobordism/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cobordism/subscriptions",
    "organizations_url": "https://api.github.com/users/cobordism/orgs",
    "repos_url": "https://api.github.com/users/cobordism/repos",
    "events_url": "https://api.github.com/users/cobordism/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cobordism/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3601/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3601/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/277504062",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/3601#issuecomment-277504062",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3601",
    "id": 277504062,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NzUwNDA2Mg==",
    "user": {
      "login": "zelig",
      "id": 769725,
      "node_id": "MDQ6VXNlcjc2OTcyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/769725?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zelig",
      "html_url": "https://github.com/zelig",
      "followers_url": "https://api.github.com/users/zelig/followers",
      "following_url": "https://api.github.com/users/zelig/following{/other_user}",
      "gists_url": "https://api.github.com/users/zelig/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zelig/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zelig/subscriptions",
      "organizations_url": "https://api.github.com/users/zelig/orgs",
      "repos_url": "https://api.github.com/users/zelig/repos",
      "events_url": "https://api.github.com/users/zelig/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zelig/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-05T08:11:35Z",
    "updated_at": "2017-02-05T08:11:35Z",
    "author_association": "MEMBER",
    "body": "a quick fix will take the length of the file referenced by the link if the orig path is within the uploadedd dir tree.\r\n\r\nlong term, relative-path links should translate to redirects back and forth even if broken\r\nwhile absolute path links should be ignored with a warning",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/277504062/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/371286059",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/3601#issuecomment-371286059",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3601",
    "id": 371286059,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MTI4NjA1OQ==",
    "user": {
      "login": "stale[bot]",
      "id": 26384082,
      "node_id": "MDM6Qm90MjYzODQwODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stale%5Bbot%5D",
      "html_url": "https://github.com/apps/stale",
      "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2018-03-07T21:11:25Z",
    "updated_at": "2018-03-07T21:11:25Z",
    "author_association": "NONE",
    "body": "This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you for your contributions.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/371286059/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/371484797",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/3601#issuecomment-371484797",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3601",
    "id": 371484797,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MTQ4NDc5Nw==",
    "user": {
      "login": "lmars",
      "id": 488515,
      "node_id": "MDQ6VXNlcjQ4ODUxNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/488515?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lmars",
      "html_url": "https://github.com/lmars",
      "followers_url": "https://api.github.com/users/lmars/followers",
      "following_url": "https://api.github.com/users/lmars/following{/other_user}",
      "gists_url": "https://api.github.com/users/lmars/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lmars/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lmars/subscriptions",
      "organizations_url": "https://api.github.com/users/lmars/orgs",
      "repos_url": "https://api.github.com/users/lmars/repos",
      "events_url": "https://api.github.com/users/lmars/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lmars/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-08T13:22:01Z",
    "updated_at": "2018-03-08T13:22:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "This is no longer an issue:\r\n\r\n```\r\n$ ls -l\r\ntotal 8\r\nlrwxr-xr-x 1 lmars lmars 7 Mar  8 14:19 bar.txt -> foo.txt\r\n-rw-r--r-- 1 lmars lmars 5 Mar  8 14:18 foo.txt\r\n\r\n$ swarm --recursive up .\r\n5b1508b55acd0feb9a74e53cc326f7fa964b490953ef60b15ff8530b05ff9053\r\n\r\n$ curl http://localhost:8500/bzz:/5b1508b55acd0feb9a74e53cc326f7fa964b490953ef60b15ff8530b05ff9053/foo.txt\r\ndata\r\n\r\n$ curl http://localhost:8500/bzz:/5b1508b55acd0feb9a74e53cc326f7fa964b490953ef60b15ff8530b05ff9053/bar.txt\r\ndata\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/371484797/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/411475076",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/3601#issuecomment-411475076",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/3601",
    "id": 411475076,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMTQ3NTA3Ng==",
    "user": {
      "login": "cobordism",
      "id": 12838530,
      "node_id": "MDQ6VXNlcjEyODM4NTMw",
      "avatar_url": "https://avatars.githubusercontent.com/u/12838530?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cobordism",
      "html_url": "https://github.com/cobordism",
      "followers_url": "https://api.github.com/users/cobordism/followers",
      "following_url": "https://api.github.com/users/cobordism/following{/other_user}",
      "gists_url": "https://api.github.com/users/cobordism/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cobordism/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cobordism/subscriptions",
      "organizations_url": "https://api.github.com/users/cobordism/orgs",
      "repos_url": "https://api.github.com/users/cobordism/repos",
      "events_url": "https://api.github.com/users/cobordism/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cobordism/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-08T16:49:29Z",
    "updated_at": "2018-08-08T16:49:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "user@eth-work:~$ mkdir  uploadtest\r\nuser@eth-work:~$ cd uploadtest\r\nuser@eth-work:~/uploadtest$ echo \"one\" > file1\r\nuser@eth-work:~/uploadtest$ ln file1 file2\r\nuser@eth-work:~/uploadtest$ ln -s file1 file3\r\nuser@eth-work:~/uploadtest$ ls -l\r\ntotal 8\r\n-rw-r--r-- 2 user user 4 Aug  8 18:47 file1\r\n-rw-r--r-- 2 user user 4 Aug  8 18:47 file2\r\nlrwxrwxrwx 1 user user 5 Aug  8 18:47 file3 -> file1\r\n\r\nuser@eth-work:~$ swarm --recursive up /home/user/uploadtest/\r\n9200062ff5f4c9cf9fee77e396f8e7db6b1ad1fcbd4492b34377aba2e2c82f98\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/411475076/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
