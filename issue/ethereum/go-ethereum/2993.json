{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2993",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2993/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2993/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2993/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/2993",
  "id": 176288758,
  "node_id": "MDU6SXNzdWUxNzYyODg3NTg=",
  "number": 2993,
  "title": "personal_newAccount JSON RPC calls always timeout after blockchain sync starts",
  "user": {
    "login": "BlameByte",
    "id": 6662327,
    "node_id": "MDQ6VXNlcjY2NjIzMjc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6662327?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/BlameByte",
    "html_url": "https://github.com/BlameByte",
    "followers_url": "https://api.github.com/users/BlameByte/followers",
    "following_url": "https://api.github.com/users/BlameByte/following{/other_user}",
    "gists_url": "https://api.github.com/users/BlameByte/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/BlameByte/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/BlameByte/subscriptions",
    "organizations_url": "https://api.github.com/users/BlameByte/orgs",
    "repos_url": "https://api.github.com/users/BlameByte/repos",
    "events_url": "https://api.github.com/users/BlameByte/events{/privacy}",
    "received_events_url": "https://api.github.com/users/BlameByte/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2016-09-12T03:40:50Z",
  "updated_at": "2016-09-23T00:37:52Z",
  "closed_at": "2016-09-23T00:37:52Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\n\nGeth version: 1.4.10\nOS & Version: Linux CentOS 7\nCommit hash : release/1.4\n#### Expected behaviour\n\nFor calls via the personal_newAccount to succeed and return a new address like what happens before blockchain sync starts.\n#### Actual behaviour\n\nAs soon as it states \"Block synchronisation started\" it no longer accepts personal_newAccount requests despite having personal in the rpcapi param and the request simply is ignored and no error is returned.\n\nNote: This still does not work even if we are fully synced (at the maximum height).\n#### Steps to reproduce the behaviour\n\nEnable the rpc using --rpc --rpcapi \"eth,personal\" and then try a request, if it is done before the block sync it will work, if it is during / after it will simply time out.\n\nYou can use --nodiscover --maxpeers 0 and you can always create new accounts; but then you are no longer in sync with the network.\n#### Backtrace\n\nIs there any way to keep access to the personal_newAccount(\"passphrase\") calls so I can generate new addresses while still having an up to date node?\n",
  "closed_by": {
    "login": "BlameByte",
    "id": 6662327,
    "node_id": "MDQ6VXNlcjY2NjIzMjc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6662327?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/BlameByte",
    "html_url": "https://github.com/BlameByte",
    "followers_url": "https://api.github.com/users/BlameByte/followers",
    "following_url": "https://api.github.com/users/BlameByte/following{/other_user}",
    "gists_url": "https://api.github.com/users/BlameByte/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/BlameByte/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/BlameByte/subscriptions",
    "organizations_url": "https://api.github.com/users/BlameByte/orgs",
    "repos_url": "https://api.github.com/users/BlameByte/repos",
    "events_url": "https://api.github.com/users/BlameByte/events{/privacy}",
    "received_events_url": "https://api.github.com/users/BlameByte/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2993/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2993/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/246290855",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2993#issuecomment-246290855",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2993",
    "id": 246290855,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NjI5MDg1NQ==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-12T09:10:51Z",
    "updated_at": "2016-09-12T09:10:51Z",
    "author_association": "MEMBER",
    "body": "Are you sure your machine is not overloaded and simply cannot generate the account? Creating a new account is an expensive operation. It requires 256MB memory and on a modern processor should take at least 1 sec, possibly more. If your machine is being hammered (e.g. during sync), it may take much longer to do the account crypto. Of course it should still succeed eventually. What machine are you running this on?\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/246290855/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/246538270",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2993#issuecomment-246538270",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2993",
    "id": 246538270,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NjUzODI3MA==",
    "user": {
      "login": "BlameByte",
      "id": 6662327,
      "node_id": "MDQ6VXNlcjY2NjIzMjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6662327?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BlameByte",
      "html_url": "https://github.com/BlameByte",
      "followers_url": "https://api.github.com/users/BlameByte/followers",
      "following_url": "https://api.github.com/users/BlameByte/following{/other_user}",
      "gists_url": "https://api.github.com/users/BlameByte/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BlameByte/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BlameByte/subscriptions",
      "organizations_url": "https://api.github.com/users/BlameByte/orgs",
      "repos_url": "https://api.github.com/users/BlameByte/repos",
      "events_url": "https://api.github.com/users/BlameByte/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BlameByte/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-13T00:33:27Z",
    "updated_at": "2016-09-13T00:33:27Z",
    "author_association": "NONE",
    "body": "The instance I am using is fairly low spec: 1 CPU, 512MB ram (2GB swap), 20GB for os / swap and 100GB hdd for blockchain / storage.\n\nIt seems to fail even when it is fully synced and not using any CPU, there is little physical memory free while geth is running but there is plenty of swap on a separate drive. (1929004 free, 168144 used)\n\nThe rpc request times out and does not appear to process the request and still times out even when setting the timeout value to like 1 minute. \n\nBefore Geth starts syncing the requests work as they should within a few seconds but then it seems as soon as it starts syncing a couple of blocks requests no longer work. Despite working before sync and even though it is fully synced and cpu usage drops to almost nothing (memory committed still remains high).\n\nIs this due to the memory allocated during the sync loading the blockchain and it no longer has any left to create an address? Is swap unable to be used instead of physical ram for some reason (some swap is being used for syncing). \n\nIs there any way to check to see if a request succeeded, or pending requests?\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/246538270/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/246650095",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2993#issuecomment-246650095",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2993",
    "id": 246650095,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NjY1MDA5NQ==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-13T11:16:26Z",
    "updated_at": "2016-09-13T11:16:26Z",
    "author_association": "MEMBER",
    "body": "If you are hitting the swap space, it will probably slow down to an unusable crawl. Please reduce the database caching to something way less (e.g. `--cache=32`) so that even with caches and other memory usage you'll still have enough memory for the 256MB key operations. If you hit swap, say goodbye to responsiveness. \n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/246650095/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/246897156",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2993#issuecomment-246897156",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2993",
    "id": 246897156,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0Njg5NzE1Ng==",
    "user": {
      "login": "BlameByte",
      "id": 6662327,
      "node_id": "MDQ6VXNlcjY2NjIzMjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6662327?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BlameByte",
      "html_url": "https://github.com/BlameByte",
      "followers_url": "https://api.github.com/users/BlameByte/followers",
      "following_url": "https://api.github.com/users/BlameByte/following{/other_user}",
      "gists_url": "https://api.github.com/users/BlameByte/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BlameByte/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BlameByte/subscriptions",
      "organizations_url": "https://api.github.com/users/BlameByte/orgs",
      "repos_url": "https://api.github.com/users/BlameByte/repos",
      "events_url": "https://api.github.com/users/BlameByte/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BlameByte/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-14T03:37:11Z",
    "updated_at": "2016-09-14T03:37:11Z",
    "author_association": "NONE",
    "body": "I tried again with an instance with 1GB ram and no swap as that was likely impacting performance, you are right it is definitely due to memory exhaustion.\n\nSetting cache down didn't help much on either machine, it seems like it just continues to consume memory and then we no longer have enough to generate addresses (with 32mb cache we still use more than 800mb), and the only difference I have noticed is that the memory usage stays smaller but eventually goes up to the same regardless of caches.\n\nRight now it is keeping a free 70mb and so creating an address is working perfectly but I will have to do some further testing to make sure that it will not run out of memory for address generation.\n\nHow much memory is considered adequate for a geth server and is 1GB too low? Also is a fast node a lot more memory intensive and would I require less if I were to sync from scratch without the --fast option?\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/246897156/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
