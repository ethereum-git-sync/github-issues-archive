{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28017",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28017/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28017/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28017/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/28017",
  "id": 1868677401,
  "node_id": "I_kwDOAOvK985vYcEZ",
  "number": 28017,
  "title": "Support BlockHash in contract bindings",
  "user": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233652,
      "node_id": "MDU6TGFiZWw3MjIzMzY1Mg==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:feature",
      "name": "type:feature",
      "color": "84b6eb",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-08-27T23:51:14Z",
  "updated_at": "2023-10-17T12:34:03Z",
  "closed_at": "2023-10-17T12:34:03Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "# Rationale\r\n\r\nTo allow users of contract bindings to get a consistent view of the chain across multiple calls it would be useful for `bind.CallOpts` to support a `BlockHash` option instead of just `BlockNumber`.  This also allows callers to track changes in specific blocks more easily - for example if they're subscribed to head or log updates and then requesting additional data from the contract, they could do so with block hash, whereas block number may return incorrect data if there is a reorg.\r\n\r\n# Implementation\r\n\r\nHappy to implement this if it is something that would be accepted upstream.\r\n\r\nI'd suggest following the same pattern as the pending block support uses by introducing a new `bind.BlockHashContractCaller` that provides the required `CallContractAtHash` and `GetCodeAtHash` (`GetCodeAtHash` would also have to be added to `ethclient.Client` but the underlying `eth_getCode` rpc method already supports passing a block number or block hash).\r\n\r\nLike pending calls, if a `CallOpts.BlockHash` is specified but the backend doesn't implement `BlockHashContractCaller` an error would be returned. It would also be an error to specify both `BlockHash` and `BlockNumber`.",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28017/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28017/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1706551634",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/28017#issuecomment-1706551634",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28017",
    "id": 1706551634,
    "node_id": "IC_kwDOAOvK985lt-lS",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-05T12:44:03Z",
    "updated_at": "2023-09-05T12:44:03Z",
    "author_association": "MEMBER",
    "body": "> Happy to implement this if it is something that would be accepted upstream.\r\n\r\nTriage discussion: yeah, sounds good to us! ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1706551634/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
