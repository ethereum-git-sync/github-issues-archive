{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21505",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21505/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21505/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21505/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/21505",
  "id": 688921314,
  "node_id": "MDU6SXNzdWU2ODg5MjEzMTQ=",
  "number": 21505,
  "title": "Panic on reorgOnNewHead",
  "user": {
    "login": "andrewheadricke",
    "id": 36428679,
    "node_id": "MDQ6VXNlcjM2NDI4Njc5",
    "avatar_url": "https://avatars.githubusercontent.com/u/36428679?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/andrewheadricke",
    "html_url": "https://github.com/andrewheadricke",
    "followers_url": "https://api.github.com/users/andrewheadricke/followers",
    "following_url": "https://api.github.com/users/andrewheadricke/following{/other_user}",
    "gists_url": "https://api.github.com/users/andrewheadricke/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/andrewheadricke/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/andrewheadricke/subscriptions",
    "organizations_url": "https://api.github.com/users/andrewheadricke/orgs",
    "repos_url": "https://api.github.com/users/andrewheadricke/repos",
    "events_url": "https://api.github.com/users/andrewheadricke/events{/privacy}",
    "received_events_url": "https://api.github.com/users/andrewheadricke/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2020-08-31T05:43:42Z",
  "updated_at": "2020-09-13T11:26:46Z",
  "closed_at": "2020-09-09T15:37:38Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Geth 1.9.20 - Linux\r\n\r\n```\r\nINFO [08-31|21:47:06.926] Imported new block headers               count=2   elapsed=15.987ms  number=10768509 hash=\"7fa573…25a30f\" ignored=1\r\nINFO [08-31|21:47:07.134] Loaded most recent local header          number=10766460 hash=\"b45f35…72944b\" td=17121215388538268308988 age=7h35m7s\r\nWARN [08-31|21:47:07.135] Rolled back chain segment                header=10768509->10766460 fast=0->0 block=0->0     reason=\"syncing canceled (requested)\"\r\nWARN [08-31|21:47:07.135] Synchronisation failed, retrying         err=\"no peers to keep download active\"\r\nINFO [08-31|21:47:14.766] Looking for peers                        peercount=0 tried=13 static=0\r\nINFO [08-31|21:47:24.770] Looking for peers                        peercount=0 tried=8  static=0\r\nINFO [08-31|21:47:34.774] Looking for peers                        peercount=0 tried=10 static=0\r\nINFO [08-31|21:47:44.778] Looking for peers                        peercount=0 tried=14 static=0\r\nINFO [08-31|21:47:54.781] Looking for peers                        peercount=0 tried=6  static=0\r\nINFO [08-31|21:48:04.785] Looking for peers                        peercount=0 tried=7  static=0\r\nINFO [08-31|21:48:14.788] Looking for peers                        peercount=0 tried=9  static=0\r\nINFO [08-31|21:48:24.792] Looking for peers                        peercount=0 tried=9  static=0\r\nWARN [08-31|21:48:33.698] Synchronisation failed, dropping peer    peer=09b73c91a98e588184b67e95baa15602fa63301c69814c27193a55f48e370a3e err=timeout\r\nINFO [08-31|21:48:34.795] Looking for peers                        peercount=1 tried=12 static=0\r\nINFO [08-31|21:48:41.295] Imported new block headers               count=192 elapsed=829.917ms number=10766652 hash=\"433ff3…2749ba\" age=6h53m\r\npanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x1c0 pc=0xd20998]\r\n\r\ngoroutine 49 [running]:\r\ngithub.com/ethereum/go-ethereum/light.(*TxPool).reorgOnNewHead(0xc000f5c000, 0x1491740, 0xc002d776e0, 0xc003abb200, 0xc002d776e0, 0xc0047ff020, 0x4664ac)\r\n        github.com/ethereum/go-ethereum/light/txpool.go:229 +0x238\r\ngithub.com/ethereum/go-ethereum/light.(*TxPool).setNewHead(0xc000f5c000, 0xc003abb200)\r\n        github.com/ethereum/go-ethereum/light/txpool.go:310 +0xf7\r\ngithub.com/ethereum/go-ethereum/light.(*TxPool).eventLoop(0xc000f5c000)\r\n        github.com/ethereum/go-ethereum/light/txpool.go:291 +0x56\r\ncreated by github.com/ethereum/go-ethereum/light.NewTxPool\r\n        github.com/ethereum/go-ethereum/light/txpool.go:108 +0x3da\r\n```",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21505/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21505/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/691478551",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21505#issuecomment-691478551",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21505",
    "id": 691478551,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5MTQ3ODU1MQ==",
    "user": {
      "login": "andrewheadricke",
      "id": 36428679,
      "node_id": "MDQ6VXNlcjM2NDI4Njc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/36428679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/andrewheadricke",
      "html_url": "https://github.com/andrewheadricke",
      "followers_url": "https://api.github.com/users/andrewheadricke/followers",
      "following_url": "https://api.github.com/users/andrewheadricke/following{/other_user}",
      "gists_url": "https://api.github.com/users/andrewheadricke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/andrewheadricke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andrewheadricke/subscriptions",
      "organizations_url": "https://api.github.com/users/andrewheadricke/orgs",
      "repos_url": "https://api.github.com/users/andrewheadricke/repos",
      "events_url": "https://api.github.com/users/andrewheadricke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/andrewheadricke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-12T12:11:30Z",
    "updated_at": "2020-09-12T12:14:16Z",
    "author_association": "NONE",
    "body": "I seem to be getting the same issue on 1.9.21, might need to re-open the issue. @karalabe \r\n\r\n```\r\nINFO [09-12|10:04:18.465] Imported new block headers               count=2    elapsed=13.159ms    number=10843759 hash=\"be8fd1…1a25b2\" ignored=1\r\nINFO [09-12|10:04:18.662] Loaded most recent local header          number=10841710 hash=\"c34027…6bbc97\" td=17342157617971815106040 age=7h24m6s\r\nWARN [09-12|10:04:18.662] Rolled back chain segment                header=10843759->10841710 fast=0->0 block=0->0     reason=\"syncing canceled (requested)\"\r\nWARN [09-12|10:04:18.662] Synchronisation failed, retrying         err=\"no peers to keep download active\"\r\nINFO [09-12|10:04:22.236] Looking for peers                        peercount=0 tried=15 static=0\r\n\r\n... 12 minutes later ...\r\n\r\nINFO [09-12|10:16:23.602] Looking for peers                        peercount=1 tried=8  static=0\r\nINFO [09-12|10:16:32.153] Imported new block headers               count=192  elapsed=811.391ms   number=10841902 hash=\"966147…888e86\" age=6h51m55s\r\npanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x1c0 pc=0xda5a78]\r\n\r\ngoroutine 60 [running]:\r\ngithub.com/ethereum/go-ethereum/light.(*TxPool).reorgOnNewHead(0xc0002bd600, 0x1520660, 0xc00254fb00, 0xc002e64fc0, 0xc00254fb00, 0xc003cb6bc0, 0x4664ac)  \r\n        github.com/ethereum/go-ethereum/light/txpool.go:229 +0x238\r\ngithub.com/ethereum/go-ethereum/light.(*TxPool).setNewHead(0xc0002bd600, 0xc002e64fc0)\r\n        github.com/ethereum/go-ethereum/light/txpool.go:310 +0xf7\r\ngithub.com/ethereum/go-ethereum/light.(*TxPool).eventLoop(0xc0002bd600)\r\n        github.com/ethereum/go-ethereum/light/txpool.go:291 +0x56\r\ncreated by github.com/ethereum/go-ethereum/light.NewTxPool\r\n        github.com/ethereum/go-ethereum/light/txpool.go:108 +0x3da\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/691478551/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/691487982",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21505#issuecomment-691487982",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21505",
    "id": 691487982,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5MTQ4Nzk4Mg==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-12T13:28:34Z",
    "updated_at": "2020-09-12T13:28:34Z",
    "author_association": "MEMBER",
    "body": "It was fixed on master (unfortunately after the 1.9.21 release). You could\nrun that (or stick to 1.9.18? or wait one more week until 1.9.22).\n\nOn Sat, Sep 12, 2020, 15:11 AndrewH <notifications@github.com> wrote:\n\n> I seem to be getting the same issue on 1.9.21\n>\n> INFO [09-12|10:04:18.465] Imported new block headers               count=2    elapsed=13.159ms    number=10843759 hash=\"be8fd1…1a25b2\" ignor\n>\n> ed=1\n>\n> INFO [09-12|10:04:18.662] Loaded most recent local header          number=10841710 hash=\"c34027…6bbc97\" td=17342157617971815106040 age=7h24m\n>\n> 6s\n>\n> WARN [09-12|10:04:18.662] Rolled back chain segment                header=10843759->10841710 fast=0->0 block=0->0     reason=\"syncing cancel\n>\n> ed (requested)\"\n>\n> WARN [09-12|10:04:18.662] Synchronisation failed, retrying         err=\"no peers to keep download active\"\n>\n> INFO [09-12|10:04:22.236] Looking for peers                        peercount=0 tried=15 static=0\n>\n>\n>\n> ... 12 minutes later ...\n>\n>\n>\n> INFO [09-12|10:16:23.602] Looking for peers                        peercount=1 tried=8  static=0\n>\n> INFO [09-12|10:16:32.153] Imported new block headers               count=192  elapsed=811.391ms   number=10841902 hash=\"966147…888e86\" age=6h51m55s\n>\n> panic: runtime error: invalid memory address or nil pointer dereference\n>\n> [signal SIGSEGV: segmentation violation code=0x1 addr=0x1c0 pc=0xda5a78]\n>\n>\n>\n> goroutine 60 [running]:\n> github.com/ethereum/go-ethereum/light.(*TxPool).reorgOnNewHead(0xc0002bd600, 0x1520660, 0xc00254fb00, 0xc002e64fc0, 0xc00254fb00, 0xc003cb6bc0, 0x4664ac)\n>\n>         github.com/ethereum/go-ethereum/light/txpool.go:229 +0x238\n> github.com/ethereum/go-ethereum/light.(*TxPool).setNewHead(0xc0002bd600, 0xc002e64fc0)\n>\n>         github.com/ethereum/go-ethereum/light/txpool.go:310 +0xf7\n> github.com/ethereum/go-ethereum/light.(*TxPool).eventLoop(0xc0002bd600)\n>\n>         github.com/ethereum/go-ethereum/light/txpool.go:291 +0x56\n>\n> created by github.com/ethereum/go-ethereum/light.NewTxPool\n>\n>         github.com/ethereum/go-ethereum/light/txpool.go:108 +0x3da\n>\n>\n> —\n> You are receiving this because you modified the open/close state.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/ethereum/go-ethereum/issues/21505#issuecomment-691478551>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AAA7UGIFYEAUYOIZRHIN3RTSFNQP7ANCNFSM4QQDTYYQ>\n> .\n>\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/691487982/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/691659115",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21505#issuecomment-691659115",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21505",
    "id": 691659115,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5MTY1OTExNQ==",
    "user": {
      "login": "andrewheadricke",
      "id": 36428679,
      "node_id": "MDQ6VXNlcjM2NDI4Njc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/36428679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/andrewheadricke",
      "html_url": "https://github.com/andrewheadricke",
      "followers_url": "https://api.github.com/users/andrewheadricke/followers",
      "following_url": "https://api.github.com/users/andrewheadricke/following{/other_user}",
      "gists_url": "https://api.github.com/users/andrewheadricke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/andrewheadricke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andrewheadricke/subscriptions",
      "organizations_url": "https://api.github.com/users/andrewheadricke/orgs",
      "repos_url": "https://api.github.com/users/andrewheadricke/repos",
      "events_url": "https://api.github.com/users/andrewheadricke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/andrewheadricke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-13T11:26:46Z",
    "updated_at": "2020-09-13T11:26:46Z",
    "author_association": "NONE",
    "body": "Ah ok, no problem. Will wait for next release.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/691659115/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
