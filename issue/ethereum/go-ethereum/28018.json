{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28018",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28018/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28018/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28018/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/28018",
  "id": 1868755700,
  "node_id": "I_kwDOAOvK985vYvL0",
  "number": 28018,
  "title": "Some transactions  stuck in pool with enough gas price (in a private network)",
  "user": {
    "login": "aweneagle",
    "id": 5202055,
    "node_id": "MDQ6VXNlcjUyMDIwNTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5202055?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/aweneagle",
    "html_url": "https://github.com/aweneagle",
    "followers_url": "https://api.github.com/users/aweneagle/followers",
    "following_url": "https://api.github.com/users/aweneagle/following{/other_user}",
    "gists_url": "https://api.github.com/users/aweneagle/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/aweneagle/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/aweneagle/subscriptions",
    "organizations_url": "https://api.github.com/users/aweneagle/orgs",
    "repos_url": "https://api.github.com/users/aweneagle/repos",
    "events_url": "https://api.github.com/users/aweneagle/events{/privacy}",
    "received_events_url": "https://api.github.com/users/aweneagle/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    },
    {
      "id": 1132689577,
      "node_id": "MDU6TGFiZWwxMTMyNjg5NTc3",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/status:triage",
      "name": "status:triage",
      "color": "6be514",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-08-28T01:13:33Z",
  "updated_at": "2023-09-11T07:57:27Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\nGeth version: v1.101200.0\r\nOS & Version: Linux\r\n\r\n#### Background:\r\nWe built a private network, in which we deployed a set of geth nodes as p2p layer( which we called p2p nodes ) before miner nodes for high availability. All transactions go to the p2p nodes first, then broadcasted to the miner nodes later.\r\n\r\n#### Expected behavior\r\nAll transactions with enough price and correct nonce should be mined when the miner's pool is empty and gas price goes down.\r\n\r\n#### Actual behavior\r\nSome transactions are stuck in the p2p node's pool forever after a traffic jam.\r\n\r\n#### Steps to reproduce the behavior\r\n1. Prepare some addresses (let's say 100k+)\r\n2. Send transactions between them, in a high throughput(say 4k+/s tps), and keep it for a while (say 30mins)\r\n3. Make sure to trigger the traffic jam. (By watching meter indicated whether the miner's pool size has reach the limit or not)\r\n4. After the load testing finished, there might be some transactions stuck in the p2p nodes forever.\r\n\r\nWe found the root cause here :\r\nthey are caught in this [underpriced buffer](https://github.com/ethereum/go-ethereum/blob/master/eth/fetcher/tx_fetcher.go#L306). After adding a frequent cleaner to this buffer, the blocking issue disappeared.\r\n\r\nWhen the traffic is jamming, some transactions may be rejected as 'underpriced', and might be rejected forever even the chain's gas price has went down, unless other 'underpriced' transaction replace it. it's seems unfair.\r\n\r\nSo, i am wondering that, maybe we should make this buffer cleared frequently?",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28018/reactions",
    "total_count": 1,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 1,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28018/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1713362108",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/28018#issuecomment-1713362108",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28018",
    "id": 1713362108,
    "node_id": "IC_kwDOAOvK985mH9S8",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-11T07:57:19Z",
    "updated_at": "2023-09-11T07:57:19Z",
    "author_association": "MEMBER",
    "body": "Yeah I think thats a good point, we kinda have to decide between dos resistance and ux here. Will discuss in our next triage",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1713362108/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
