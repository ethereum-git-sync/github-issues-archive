{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23511",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23511/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23511/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23511/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/23511",
  "id": 983676096,
  "node_id": "MDU6SXNzdWU5ODM2NzYwOTY=",
  "number": 23511,
  "title": "`Header.Hash` returns wrong values on testnets (not on mainnet)",
  "user": {
    "login": "sebastianst",
    "id": 2607372,
    "node_id": "MDQ6VXNlcjI2MDczNzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2607372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sebastianst",
    "html_url": "https://github.com/sebastianst",
    "followers_url": "https://api.github.com/users/sebastianst/followers",
    "following_url": "https://api.github.com/users/sebastianst/following{/other_user}",
    "gists_url": "https://api.github.com/users/sebastianst/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sebastianst/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sebastianst/subscriptions",
    "organizations_url": "https://api.github.com/users/sebastianst/orgs",
    "repos_url": "https://api.github.com/users/sebastianst/repos",
    "events_url": "https://api.github.com/users/sebastianst/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sebastianst/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-08-31T10:02:40Z",
  "updated_at": "2021-08-31T10:18:42Z",
  "closed_at": "2021-08-31T10:18:42Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth versions: Tested with 1.10.5, 1.10.6 and 1.10.8\r\nOS & Version: Linux\r\n\r\n#### Expected behaviour\r\n\r\n`Header.Hash()` returns the hash value of the block.\r\n\r\n#### Actual behaviour\r\n\r\n`Header.Hash()` returns a different hash value, not obviously connected to the actual hash value.\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\nRun the minimal example at https://github.com/sebastianst/geth-header-test\r\n\r\nIt will output something like\r\n````\r\n$ go run main.go\r\n2021/08/31 11:58:20 üêõ HeaderByNumber Hash mismatch, expected 0xb85f4e8338828821a821217fbc8c501b21b8752d71b77fe0dae35783d74423d3, got 0x72be6a592a523e8bfc6f0c3ce6f0a4b2734e48a787ffce1d8928416ba1fde03f\r\n2021/08/31 11:58:20 Num: 5410648, Hash: 0x72be6a592a523e8bfc6f0c3ce6f0a4b2734e48a787ffce1d8928416ba1fde03f, Header:\r\n&{ParentHash:0x73fd53ef990d4f1e88cfafecc0b132d17bb8a27600b80e3bcddc30142c11759f UncleHash:0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347 Coinbase:0x22eA9f6b28DB76A7162054c05ed812dEb2f519Cd Root:0x18b2631a67836bf527f3511e4aadd42b9af0851b01857c6520b1d5531fa07f4c TxHash:0x47d6aad498c1999db862c1f2edf2f23963b988dbad4ffc6e785aac017276e835 ReceiptHash:0xd6d54e095b74af213df0a70e7c5becdd5adfd05a832162cd7ac0ef162b7aaf0a Bloom:[0 0 1 0 0 0 0 0 2 32 0 0 4 0 0 0 0 0 0 0 0 0 0 128 1 128 0 0 0 4 0 0 0 0 0 0 0 2 0 0 0 0 0 16 0 0 0 0 64 0 64 0 0 0 0 0 0 8 0 0 0 4 0 0 0 0 0 0 128 0 0 0 1 0 0 44 0 2 0 0 16 5 0 0 0 36 0 0 0 0 0 0 2 0 0 0 0 1 0 1 2 0 0 8 0 128 0 16 0 0 8 0 0 0 0 64 0 32 136 0 0 0 0 16 0 16 0 64 0 0 0 64 32 3 32 0 0 8 0 0 0 0 0 0 0 0 0 5 0 8 0 0 0 0 0 8 0 192 0 32 0 0 0 0 32 0 0 16 0 2 0 0 0 0 0 0 16 0 0 0 8 0 0 64 0 0 0 0 8 1 0 0 0 0 0 2 0 128 0 4 0 0 0 0 0 0 0 0 65 4 8 0 0 0 0 0 0 0 0 0 0 0 96 0 0 0 64 0 1 0 0 16 0 1 0 0 0 8 0 0 0 64 0 8 0 0 0 0 8 0 0 0 0 0 32 0] Difficulty:+2 Number:+5410648 GasLimit:29999944 GasUsed:5221524 Time:1630330898 Extra:[0 0 0 0 0 0 67 111 110 115 101 110 83 121 115 32 72 121 112 101 114 108 101 100 103 101 114 32 66 101 115 117 140 189 122 128 207 27 95 5 126 170 83 166 44 168 253 171 86 171 44 227 18 46 147 221 50 189 42 121 91 240 244 67 49 238 219 103 90 42 14 193 116 160 70 44 169 131 235 211 136 141 199 50 13 144 21 180 179 220 18 227 228 102 234 65 1] MixDigest:0x0000000000000000000000000000000000000000000000000000000000000000 Nonce:[0 0 0 0 0 0 0 0] BaseFee:+8}\r\n2021/08/31 11:58:20 üêõ HeaderByHash Hash mismatch, expected 0xb85f4e8338828821a821217fbc8c501b21b8752d71b77fe0dae35783d74423d3, got 0x72be6a592a523e8bfc6f0c3ce6f0a4b2734e48a787ffce1d8928416ba1fde03f\r\n2021/08/31 11:58:20 Num: 5410648, Hash: 0x72be6a592a523e8bfc6f0c3ce6f0a4b2734e48a787ffce1d8928416ba1fde03f, Header:\r\n&{ParentHash:0x73fd53ef990d4f1e88cfafecc0b132d17bb8a27600b80e3bcddc30142c11759f UncleHash:0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347 Coinbase:0x22eA9f6b28DB76A7162054c05ed812dEb2f519Cd Root:0x18b2631a67836bf527f3511e4aadd42b9af0851b01857c6520b1d5531fa07f4c TxHash:0x47d6aad498c1999db862c1f2edf2f23963b988dbad4ffc6e785aac017276e835 ReceiptHash:0xd6d54e095b74af213df0a70e7c5becdd5adfd05a832162cd7ac0ef162b7aaf0a Bloom:[0 0 1 0 0 0 0 0 2 32 0 0 4 0 0 0 0 0 0 0 0 0 0 128 1 128 0 0 0 4 0 0 0 0 0 0 0 2 0 0 0 0 0 16 0 0 0 0 64 0 64 0 0 0 0 0 0 8 0 0 0 4 0 0 0 0 0 0 128 0 0 0 1 0 0 44 0 2 0 0 16 5 0 0 0 36 0 0 0 0 0 0 2 0 0 0 0 1 0 1 2 0 0 8 0 128 0 16 0 0 8 0 0 0 0 64 0 32 136 0 0 0 0 16 0 16 0 64 0 0 0 64 32 3 32 0 0 8 0 0 0 0 0 0 0 0 0 5 0 8 0 0 0 0 0 8 0 192 0 32 0 0 0 0 32 0 0 16 0 2 0 0 0 0 0 0 16 0 0 0 8 0 0 64 0 0 0 0 8 1 0 0 0 0 0 2 0 128 0 4 0 0 0 0 0 0 0 0 65 4 8 0 0 0 0 0 0 0 0 0 0 0 96 0 0 0 64 0 1 0 0 16 0 1 0 0 0 8 0 0 0 64 0 8 0 0 0 0 8 0 0 0 0 0 32 0] Difficulty:+2 Number:+5410648 GasLimit:29999944 GasUsed:5221524 Time:1630330898 Extra:[0 0 0 0 0 0 67 111 110 115 101 110 83 121 115 32 72 121 112 101 114 108 101 100 103 101 114 32 66 101 115 117 140 189 122 128 207 27 95 5 126 170 83 166 44 168 253 171 86 171 44 227 18 46 147 221 50 189 42 121 91 240 244 67 49 238 219 103 90 42 14 193 116 160 70 44 169 131 235 211 136 141 199 50 13 144 21 180 179 220 18 227 228 102 234 65 1] MixDigest:0x0000000000000000000000000000000000000000000000000000000000000000 Nonce:[0 0 0 0 0 0 0 0] BaseFee:+8}\r\n2021/08/31 11:58:20 ‚úÖ HeaderbyNumber/Hash return headers with same hash value.\r\n2021/08/31 11:58:20 üêõ (Expected) error getting header again with own hash: not found\r\n2021/08/31 11:58:20 üêõ ParentHash mismatch, expected 0xb85f4e8338828821a821217fbc8c501b21b8752d71b77fe0dae35783d74423d3, got 0x72be6a592a523e8bfc6f0c3ce6f0a4b2734e48a787ffce1d8928416ba1fde03f\r\n````\r\nTested to fail on Goerli and Rinkeby.\r\n\r\nPossibly connected to #23509 but this issue is about the Go API.",
  "closed_by": {
    "login": "sebastianst",
    "id": 2607372,
    "node_id": "MDQ6VXNlcjI2MDczNzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2607372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sebastianst",
    "html_url": "https://github.com/sebastianst",
    "followers_url": "https://api.github.com/users/sebastianst/followers",
    "following_url": "https://api.github.com/users/sebastianst/following{/other_user}",
    "gists_url": "https://api.github.com/users/sebastianst/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sebastianst/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sebastianst/subscriptions",
    "organizations_url": "https://api.github.com/users/sebastianst/orgs",
    "repos_url": "https://api.github.com/users/sebastianst/repos",
    "events_url": "https://api.github.com/users/sebastianst/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sebastianst/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23511/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23511/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/909093106",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23511#issuecomment-909093106",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23511",
    "id": 909093106,
    "node_id": "IC_kwDOAOvK9842L6jy",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-31T10:07:51Z",
    "updated_at": "2021-08-31T10:07:51Z",
    "author_association": "MEMBER",
    "body": "This should be fixed in current master by https://github.com/ethereum/go-ethereum/pull/23466",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/909093106/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/909101333",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23511#issuecomment-909101333",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23511",
    "id": 909101333,
    "node_id": "IC_kwDOAOvK9842L8kV",
    "user": {
      "login": "sebastianst",
      "id": 2607372,
      "node_id": "MDQ6VXNlcjI2MDczNzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2607372?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sebastianst",
      "html_url": "https://github.com/sebastianst",
      "followers_url": "https://api.github.com/users/sebastianst/followers",
      "following_url": "https://api.github.com/users/sebastianst/following{/other_user}",
      "gists_url": "https://api.github.com/users/sebastianst/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sebastianst/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sebastianst/subscriptions",
      "organizations_url": "https://api.github.com/users/sebastianst/orgs",
      "repos_url": "https://api.github.com/users/sebastianst/repos",
      "events_url": "https://api.github.com/users/sebastianst/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sebastianst/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-31T10:18:42Z",
    "updated_at": "2021-08-31T10:18:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "I can confirm that running the example on `v1.10.8` against a node running on `master` (currently 067084fed) fixes the problem.\r\n\r\nAlso seems like a duplicate of #23463",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/909101333/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
