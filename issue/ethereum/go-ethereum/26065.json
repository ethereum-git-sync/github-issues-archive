{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26065",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26065/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26065/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26065/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/26065",
  "id": 1428099414,
  "node_id": "I_kwDOAOvK985VHxFW",
  "number": 26065,
  "title": "Geth prune consistently Killed",
  "user": {
    "login": "arielmelendez",
    "id": 7692385,
    "node_id": "MDQ6VXNlcjc2OTIzODU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7692385?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/arielmelendez",
    "html_url": "https://github.com/arielmelendez",
    "followers_url": "https://api.github.com/users/arielmelendez/followers",
    "following_url": "https://api.github.com/users/arielmelendez/following{/other_user}",
    "gists_url": "https://api.github.com/users/arielmelendez/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/arielmelendez/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/arielmelendez/subscriptions",
    "organizations_url": "https://api.github.com/users/arielmelendez/orgs",
    "repos_url": "https://api.github.com/users/arielmelendez/repos",
    "events_url": "https://api.github.com/users/arielmelendez/events{/privacy}",
    "received_events_url": "https://api.github.com/users/arielmelendez/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1132754722,
      "node_id": "MDU6TGFiZWwxMTMyNzU0NzIy",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/need:more-information",
      "name": "need:more-information",
      "color": "db6fa3",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "rjl493456442",
    "id": 5959481,
    "node_id": "MDQ6VXNlcjU5NTk0ODE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rjl493456442",
    "html_url": "https://github.com/rjl493456442",
    "followers_url": "https://api.github.com/users/rjl493456442/followers",
    "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
    "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
    "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
    "repos_url": "https://api.github.com/users/rjl493456442/repos",
    "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-10-29T05:28:15Z",
  "updated_at": "2023-04-26T16:08:12Z",
  "closed_at": "2023-04-26T16:08:12Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "geth info:\r\nVersion: 1.11.0-unstable\r\nGit Commit: ada603fab5c854b36a1d7d9af0ba5aeeafa49d15\r\nGit Commit Date: 20220916\r\nArchitecture: amd64\r\nGo Version: go1.19.1\r\nOperating System: linux (Ubuntu 20.04.5 LTS - focal)\r\n\r\nAttempted running a geth prune on a 1000GB NVMe drive with ~38GB in remaining storage space. I killed the geth process and waited a few minutes for a graceful exit (though I neglected to actually double check). I ran the prune command on my data-dir. Within a few minutes, I received logs like the following, ending with `Killed` and no other message:\r\n\r\n```\r\ntmpfs              814824      1052    813772   1% /run\r\nERROR[10-29|04:49:34.069] Error in block freeze operation          err=\"block receipts missing, can't freeze block 15624205\"\r\nERROR[10-29|04:50:34.067] Error in block freeze operation          err=\"block receipts missing, can't freeze block 15624205\"\r\nERROR[10-29|04:51:34.079] Error in block freeze operation          err=\"block receipts missing, can't freeze block 15624205\"\r\nERROR[10-29|04:52:34.068] Error in block freeze operation          err=\"block receipts missing, can't freeze block 15624205\"\r\nERROR[10-29|04:53:34.068] Error in block freeze operation          err=\"block receipts missing, can't freeze block 15624205\"\r\nERROR[10-29|04:54:34.068] Error in block freeze operation          err=\"block receipts missing, can't freeze block 15624205\"\r\nERROR[10-29|04:55:34.088] Error in block freeze operation          err=\"block receipts missing, can't freeze block 15624205\"\r\nINFO [10-29|04:55:43.307] Pruning state data                       nodes=1 size=564.00B elapsed=12m7.036s eta=1h7m1.526s\r\nINFO [10-29|04:55:51.311] Pruning state data                       nodes=1,075,917 size=396.83MiB elapsed=12m15.039s eta=1h7m3.971s\r\nINFO [10-29|04:55:59.316] Pruning state data                       nodes=2,051,690 size=757.08MiB elapsed=12m23.045s eta=1h7m9.998s\r\nINFO [10-29|04:56:07.325] Pruning state data                       nodes=3,027,201 size=1.09GiB   elapsed=12m31.053s eta=1h7m15.874s\r\nINFO [10-29|04:56:15.333] Pruning state data                       nodes=3,956,312 size=1.43GiB   elapsed=12m39.062s eta=1h7m23.249s\r\nINFO [10-29|04:56:23.333] Pruning state data                       nodes=4,979,120 size=1.79GiB   elapsed=12m47.062s eta=1h7m26.891s\r\nINFO [10-29|04:56:31.334] Pruning state data                       nodes=5,993,691 size=2.16GiB   elapsed=12m55.062s eta=1h7m30.654s\r\nERROR[10-29|04:56:34.094] Error in block freeze operation          err=\"block receipts missing, can't freeze block 15624205\"\r\nINFO [10-29|04:56:39.336] Pruning state data                       nodes=6,871,600 size=2.48GiB   elapsed=13m3.064s  eta=1h7m39.322s\r\nINFO [10-29|04:56:47.341] Pruning state data                       nodes=7,748,973 size=2.79GiB   elapsed=13m11.069s eta=1h7m47.76s\r\nINFO [10-29|04:56:55.348] Pruning state data                       nodes=8,696,527 size=3.14GiB   elapsed=13m19.076s eta=1h7m53.437s\r\nINFO [10-29|04:57:03.355] Pruning state data                       nodes=9,662,247 size=3.48GiB   elapsed=13m27.083s eta=1h7m58.194s\r\nINFO [10-29|04:57:11.361] Pruning state data                       nodes=10,650,597 size=3.84GiB   elapsed=13m35.089s eta=1h8m1.951s\r\nKilled\r\n```\r\nThe error lines appeared periodically throughout the process, but it continued without termination. But termination did later come after seemingly ordinary `Pruning state data` logs.\r\n\r\nI reran the command a number of times to see if any other clues would present themselves or whether the process might be flaky and simply complete. In each of the subsequent runs, I noticed logs with a warning like \"The clean trie cache is not found.\", \"... delete it after pruning...\", but again the process continued without termination for a while.\r\n\r\nConcerned that I'd let my disk get too full to complete a pruning, I expanded the cloud server's block storage another 300GB just to be sure, but the same premature process termination behavior continues to occur without obvious crash logs.",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26065/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26065/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1295753488",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/26065#issuecomment-1295753488",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26065",
    "id": 1295753488,
    "node_id": "IC_kwDOAOvK985NO6EQ",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-29T06:54:06Z",
    "updated_at": "2022-10-29T06:54:06Z",
    "author_association": "MEMBER",
    "body": "Could you check the syslog? Typically journalctl or /var/log/syslog , depending on system. Check for the OOM-reaper, it probably killed the process due to memory getting low. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1295753488/reactions",
      "total_count": 2,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 1
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1366594363",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/26065#issuecomment-1366594363",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26065",
    "id": 1366594363,
    "node_id": "IC_kwDOAOvK985RdJM7",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-28T11:52:15Z",
    "updated_at": "2022-12-28T11:52:15Z",
    "author_association": "MEMBER",
    "body": "This has been stale for a while and holiman's suggestion to check the logs and see if an OOM occurred would probably show the issue. Would be good to see if we can reduce the memory consumption while pruning a bit, I looked around the code a bit but didn't find any obvious quick fixes",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1366594363/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1523682163",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/26065#issuecomment-1523682163",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26065",
    "id": 1523682163,
    "node_id": "IC_kwDOAOvK985a0Ytz",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-26T16:08:12Z",
    "updated_at": "2023-04-26T16:08:12Z",
    "author_association": "MEMBER",
    "body": "Seems abandoned",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1523682163/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
