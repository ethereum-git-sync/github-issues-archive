{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/21430",
  "id": 675321012,
  "node_id": "MDU6SXNzdWU2NzUzMjEwMTI=",
  "number": 21430,
  "title": "Calls for block/transaction information sometimes don't return",
  "user": {
    "login": "wbt",
    "id": 563406,
    "node_id": "MDQ6VXNlcjU2MzQwNg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/563406?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wbt",
    "html_url": "https://github.com/wbt",
    "followers_url": "https://api.github.com/users/wbt/followers",
    "following_url": "https://api.github.com/users/wbt/following{/other_user}",
    "gists_url": "https://api.github.com/users/wbt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wbt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wbt/subscriptions",
    "organizations_url": "https://api.github.com/users/wbt/orgs",
    "repos_url": "https://api.github.com/users/wbt/repos",
    "events_url": "https://api.github.com/users/wbt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wbt/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "MariusVanDerWijden",
    "id": 16664698,
    "node_id": "MDQ6VXNlcjE2NjY0Njk4",
    "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/MariusVanDerWijden",
    "html_url": "https://github.com/MariusVanDerWijden",
    "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
    "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
    "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
    "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
    "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
    "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
    "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 13,
  "created_at": "2020-08-07T22:32:18Z",
  "updated_at": "2022-12-07T13:02:15Z",
  "closed_at": "2022-12-07T13:02:15Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "This is intended to be a migration of [this issue](https://github.com/ethereum/web3.js/issues/3656) originally filed on web3.  However, I dove all the way in to the W3CWebSocket used by web3 and found that the requests are being sent but the responses were not being received at all from geth, so I don't think it's a web3 issue.\r\n\r\nAdditionally, I have an odd observation from Geth which might help in debugging.\r\n\r\n#### System information\r\nGeth version: 1.9.18\r\nOS & Version: Windows/Linux/OSX: Windows 10\r\n\r\n\r\n#### Steps to reproduce the behaviour\r\nFollow the setup [here](https://github.com/ethereum/web3.js/issues/3656#issuecomment-668108119). Use a WebSocket URL when connecting to geth (in truffle-config) and in `migrations/3_increment_counter.js` you can set `batchSize` to 100 without an issue.  This should produce a blockchain with >100K transactions in just over 1000 blocks, with most blocks containing 100 transactions (sometimes that's split across a couple). \r\n\r\nThe expected and actual behavior are as listed there.  If the responses are not going to be responded to, some error is expected; if no error at least some logging and documentation about how to configure the threshold would be better than status quo silent failure. \r\n\r\nNow here's the twist.  If I make all three of the following changes (from the code as of the 1.9.18 release tag), I get the expected results.  The changes are all Geth console logging and *shouldn't* affect correctness of operation, but in combination, these three log statements do. The changes are:\r\n  - In internal/ethapi/api.go, the getBlockByNumber function, add at the start of the function `log.Info(\"In api.go GetBlockByNumber\", \"number\", number);`\r\n  - In core/blockchain.go, the getBlock function, add at the start of the function `log.Info(\"In getBlock for number\", \"number\", number);`\r\n  - In core/blockchain.go, the getBlock function, add at the start of the if block for checking the cache `log.Info(\"Returning from getBlock (cached) for number\", \"number\", number);`\r\n\r\nThe third one gets lots of use because of how the transaction generation and querying process works; if yours isn't doing that you could add a similar log statement (without \"cached\") just before the return statement.\r\n\r\nComment out any of those three and Geth only returns data for roughly 325 blocks and 0 transactions out of an expected 100K of each. Include all three, and you get the expected 100K block and 100K transactions returned.\r\n\r\nI suspect that there may be some buffer or limit that is being overwhelmed, causing some glitch that leads Geth to stop sending responses to queries for at least a little while, and that these log statements slow down processing just enough that the issue threshold is never exceeded.  However, I'm not yet quite sure where that threshold is set.",
  "closed_by": {
    "login": "fjl",
    "id": 6915,
    "node_id": "MDQ6VXNlcjY5MTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fjl",
    "html_url": "https://github.com/fjl",
    "followers_url": "https://api.github.com/users/fjl/followers",
    "following_url": "https://api.github.com/users/fjl/following{/other_user}",
    "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
    "organizations_url": "https://api.github.com/users/fjl/orgs",
    "repos_url": "https://api.github.com/users/fjl/repos",
    "events_url": "https://api.github.com/users/fjl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fjl/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/670986321",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21430#issuecomment-670986321",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430",
    "id": 670986321,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MDk4NjMyMQ==",
    "user": {
      "login": "GriffGreen",
      "id": 14945613,
      "node_id": "MDQ6VXNlcjE0OTQ1NjEz",
      "avatar_url": "https://avatars.githubusercontent.com/u/14945613?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/GriffGreen",
      "html_url": "https://github.com/GriffGreen",
      "followers_url": "https://api.github.com/users/GriffGreen/followers",
      "following_url": "https://api.github.com/users/GriffGreen/following{/other_user}",
      "gists_url": "https://api.github.com/users/GriffGreen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/GriffGreen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GriffGreen/subscriptions",
      "organizations_url": "https://api.github.com/users/GriffGreen/orgs",
      "repos_url": "https://api.github.com/users/GriffGreen/repos",
      "events_url": "https://api.github.com/users/GriffGreen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/GriffGreen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-08T23:56:33Z",
    "updated_at": "2020-08-08T23:56:33Z",
    "author_association": "NONE",
    "body": "This issue we were thinking was with web3... but maybe its geth...? https://github.com/ethereum/web3.js/issues/3671 ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/670986321/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/671030661",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21430#issuecomment-671030661",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430",
    "id": 671030661,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTAzMDY2MQ==",
    "user": {
      "login": "GregTheGreek",
      "id": 16929357,
      "node_id": "MDQ6VXNlcjE2OTI5MzU3",
      "avatar_url": "https://avatars.githubusercontent.com/u/16929357?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/GregTheGreek",
      "html_url": "https://github.com/GregTheGreek",
      "followers_url": "https://api.github.com/users/GregTheGreek/followers",
      "following_url": "https://api.github.com/users/GregTheGreek/following{/other_user}",
      "gists_url": "https://api.github.com/users/GregTheGreek/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/GregTheGreek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GregTheGreek/subscriptions",
      "organizations_url": "https://api.github.com/users/GregTheGreek/orgs",
      "repos_url": "https://api.github.com/users/GregTheGreek/repos",
      "events_url": "https://api.github.com/users/GregTheGreek/events{/privacy}",
      "received_events_url": "https://api.github.com/users/GregTheGreek/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-09T09:42:14Z",
    "updated_at": "2020-08-09T09:42:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "@GriffGreen I don't think those two issues are related...",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/671030661/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/671057133",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21430#issuecomment-671057133",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430",
    "id": 671057133,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTA1NzEzMw==",
    "user": {
      "login": "GriffGreen",
      "id": 14945613,
      "node_id": "MDQ6VXNlcjE0OTQ1NjEz",
      "avatar_url": "https://avatars.githubusercontent.com/u/14945613?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/GriffGreen",
      "html_url": "https://github.com/GriffGreen",
      "followers_url": "https://api.github.com/users/GriffGreen/followers",
      "following_url": "https://api.github.com/users/GriffGreen/following{/other_user}",
      "gists_url": "https://api.github.com/users/GriffGreen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/GriffGreen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GriffGreen/subscriptions",
      "organizations_url": "https://api.github.com/users/GriffGreen/orgs",
      "repos_url": "https://api.github.com/users/GriffGreen/repos",
      "events_url": "https://api.github.com/users/GriffGreen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/GriffGreen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-09T14:15:32Z",
    "updated_at": "2020-08-09T14:50:14Z",
    "author_association": "NONE",
    "body": "Cool :-D Thx! @GregTheGreek we are scrambling over here chasing the problem down :-D We tried both the Consensys abi-decoder and ethers.js and neither has worked... but now we see that they both use ethers.js's abi encoder! So we made an issue there https://github.com/ethers-io/ethers.js/issues/992\r\n\r\n\r\n\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/671057133/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/671110854",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21430#issuecomment-671110854",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430",
    "id": 671110854,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3MTExMDg1NA==",
    "user": {
      "login": "GregTheGreek",
      "id": 16929357,
      "node_id": "MDQ6VXNlcjE2OTI5MzU3",
      "avatar_url": "https://avatars.githubusercontent.com/u/16929357?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/GregTheGreek",
      "html_url": "https://github.com/GregTheGreek",
      "followers_url": "https://api.github.com/users/GregTheGreek/followers",
      "following_url": "https://api.github.com/users/GregTheGreek/following{/other_user}",
      "gists_url": "https://api.github.com/users/GregTheGreek/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/GregTheGreek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GregTheGreek/subscriptions",
      "organizations_url": "https://api.github.com/users/GregTheGreek/orgs",
      "repos_url": "https://api.github.com/users/GregTheGreek/repos",
      "events_url": "https://api.github.com/users/GregTheGreek/events{/privacy}",
      "received_events_url": "https://api.github.com/users/GregTheGreek/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-09T22:56:28Z",
    "updated_at": "2020-08-09T22:56:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "@GriffGreen amazing! I did a little debugging and noticed that as well... best of luck!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/671110854/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/688250729",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21430#issuecomment-688250729",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430",
    "id": 688250729,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4ODI1MDcyOQ==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-07T11:02:11Z",
    "updated_at": "2020-09-07T11:02:11Z",
    "author_association": "MEMBER",
    "body": "@wbt I've been trying to repro the issue today but I'm not sure what the problem is.\r\nThe only problem I encounter is in truffle migrate\r\n```\r\nCounter value estimate: 202471\r\nReturned error: already known\r\n```\r\nwhich can be mitigated by `yarn truffle migrate -f 3` as you wrote.\r\n\r\nThe successful completions tick by normally.\r\n```\r\nSuccessful completions:  308798\r\nSuccessful completions:  308799\r\nSo far have received 308799 events and successfully queried for 308799 blocks and 308799 transactions.\r\n```\r\n\r\nAm I missing something?\r\nI'm using geth 1.9.20.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/688250729/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 1,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/688363482",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21430#issuecomment-688363482",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430",
    "id": 688363482,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4ODM2MzQ4Mg==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-07T14:32:47Z",
    "updated_at": "2020-09-07T14:32:47Z",
    "author_association": "MEMBER",
    "body": "I ran it for 2.4 mil contract calls now, 570.000 blocks and I haven't seen a problem yet",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/688363482/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/688566769",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21430#issuecomment-688566769",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430",
    "id": 688566769,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4ODU2Njc2OQ==",
    "user": {
      "login": "ricmoo",
      "id": 975687,
      "node_id": "MDQ6VXNlcjk3NTY4Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/975687?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ricmoo",
      "html_url": "https://github.com/ricmoo",
      "followers_url": "https://api.github.com/users/ricmoo/followers",
      "following_url": "https://api.github.com/users/ricmoo/following{/other_user}",
      "gists_url": "https://api.github.com/users/ricmoo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ricmoo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ricmoo/subscriptions",
      "organizations_url": "https://api.github.com/users/ricmoo/orgs",
      "repos_url": "https://api.github.com/users/ricmoo/repos",
      "events_url": "https://api.github.com/users/ricmoo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ricmoo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-08T01:26:49Z",
    "updated_at": "2020-09-08T01:26:49Z",
    "author_association": "MEMBER",
    "body": "I've added support in ethers [5.0.12](https://github.com/ethers-io/ethers.js/releases/tag/v5.0.12) for supporting legacy Solidity 0.4 external event data.\r\n\r\nFor more details, please see https://github.com/ethers-io/ethers.js/issues/891.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/688566769/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/688889818",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21430#issuecomment-688889818",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430",
    "id": 688889818,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4ODg4OTgxOA==",
    "user": {
      "login": "wbt",
      "id": 563406,
      "node_id": "MDQ6VXNlcjU2MzQwNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/563406?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wbt",
      "html_url": "https://github.com/wbt",
      "followers_url": "https://api.github.com/users/wbt/followers",
      "following_url": "https://api.github.com/users/wbt/following{/other_user}",
      "gists_url": "https://api.github.com/users/wbt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wbt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wbt/subscriptions",
      "organizations_url": "https://api.github.com/users/wbt/orgs",
      "repos_url": "https://api.github.com/users/wbt/repos",
      "events_url": "https://api.github.com/users/wbt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wbt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-08T13:52:17Z",
    "updated_at": "2020-09-08T13:52:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ricmoo Thanks for your efforts on that other issue around log parsing, which definitely caused us a lot of problems.  However, I don't think this one was one of them.  In this issue, the blockchain node isn't sending *anything* back to web3; this one isn't an issue where there is an incorrectly formatted log getting returned and not handled well in parsing.\r\n\r\n@MariusVanDerWijden It is possible that your computer is significantly more powerful than mine; maybe try running it with a compute-intensive background job? Slower is also a possibility, if your machine's resource limits cause the requests to be spaced out enough to \"fix\" the issue, similar to what happened when I added those three log statements.  I'm not quite sure what to suggest there.\r\n\r\nI also noticed what I think is the same issue when subscribing to events, where there are many distinct events, some of which have many instances, and the subscription goes back to the beginning of the chain: sometimes I didn't even get the events back.  \r\n\r\nI wound up implementing a workaround which limits the number of requests outstanding to the blockchain node at any given time.  This mostly works but requires a dedicated node and/or enough other controls so that requests from other clients/processes, combined with the limited one, remain under the yet-unknown limit for the node as a whole. It's not an elegant or complete solution, just usually practical for this particular application.  I would like to see a better solution as described in the OP above.  ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/688889818/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/849457003",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21430#issuecomment-849457003",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430",
    "id": 849457003,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0OTQ1NzAwMw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-27T08:48:44Z",
    "updated_at": "2021-05-27T08:48:44Z",
    "author_association": "MEMBER",
    "body": "> I wound up implementing a workaround which limits the number of requests outstanding to the blockchain node at any given time. \r\n\r\nIf that solves it, sounds like the node was overloaded, and there was an RPC timeout. According to @fjl, rpc timouts do not issue a proper error-response, which is something that could be improved. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/849457003/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/849541660",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21430#issuecomment-849541660",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430",
    "id": 849541660,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0OTU0MTY2MA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-27T11:04:09Z",
    "updated_at": "2021-05-27T11:04:26Z",
    "author_association": "MEMBER",
    "body": "Interesting. \r\n```golang\r\nfunc (api *PublicDebugAPI) TimeMeOut(ctx context.Context) (string, error) {\r\n\tlog.Info(\"TimeMeOut sleeping for 10 minutes...\")\r\n\ttime.Sleep(time.Minute * 10)\r\n\tlog.Info(\"TimeMeOut waking up!\")\r\n\treturn \"Good morning\", nil\r\n}\r\n```\r\nWhen invoked, the node says: \r\n```\r\nINFO [05-27|11:36:46.314] TimeMeOut sleeping for 10 minutes... \r\nINFO [05-27|11:46:46.315] TimeMeOut waking up! \r\n```\r\nOn the caller-side (taken at a different time): \r\n```\r\ndate && echo \"{\\\"method\\\": \\\"debug_timeMeOut\\\", \\\"params\\\": [], \\\"id\\\": \\\"123\\\"}\" | nc -U /home/user/.ethereum/geth.ipc  && date\r\nThu May 27 12:02:26 CEST 2021\r\n{\"jsonrpc\":\"2.0\",\"id\":\"123\",\"result\":\"Good morning\"}\r\nThu May 27 12:12:26 CEST 2021\r\n```\r\nSo the IPC connection does not time out, and it does return the data. \r\n\r\nFor http, however\r\n```\r\n$ date && curl --data '{\"method\":\"debug_timeMeOut\",\"params\":[],\"id\":1,\"jsonrpc\":\"2.0\"}' -H \"Content-Type: application/json\" -X POST localhost:8545 ; date\r\nThu May 27 12:50:37 CEST 2021\r\n\r\n\r\ncurl: (52) Empty reply from server\r\nThu May 27 13:00:46 CEST 2021\r\n```\r\nIt doesn't time out either, but after the `10m`, when it _does_ reply, the reply becomes an empty reply. cc @fjl ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/849541660/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/853695381",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21430#issuecomment-853695381",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430",
    "id": 853695381,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MzY5NTM4MQ==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-03T08:39:25Z",
    "updated_at": "2021-06-03T08:39:25Z",
    "author_association": "MEMBER",
    "body": "```diff\r\ndiff --git a/internal/ethapi/api.go b/internal/ethapi/api.go\r\nindex 02368aac14..ea7e0347fb 100644\r\n--- a/internal/ethapi/api.go\r\n+++ b/internal/ethapi/api.go\r\n@@ -1792,11 +1792,11 @@ func (api *PublicDebugAPI) GetBlockRlp(ctx context.Context, number uint64) (stri\r\n        return fmt.Sprintf(\"%x\", encoded), nil\r\n }\r\n \r\n-func (api *PublicDebugAPI) TimeMeOut(ctx context.Context) (bool, error) {\r\n-       log.Info(\"TimeMeOut sleeping for 10 minutes...\")\r\n-       time.Sleep(time.Minute * 10)\r\n+func (api *PublicDebugAPI) TimeMeOut(ctx context.Context, seconds uint64) (string, error) {\r\n+       log.Info(\"TimeMeOut sleeping...\", \"seconds\", seconds)\r\n+       time.Sleep(time.Second * time.Duration(seconds))\r\n        log.Info(\"TimeMeOut waking up!\")\r\n-       return false, nil\r\n+       return \"Oll korrekt!\", nil\r\n }\r\n \r\n // TestSignCliqueBlock fetches the given block number, and attempts to sign it as a clique header with the\r\n```\r\nAfter 30 seconds, we hit it: \r\n```\r\n[user@work go-ethereum]$ curl --data '{\"method\":\"debug_timeMeOut\",\"params\":[25],\"id\":1,\"jsonrpc\":\"2.0\"}' -H \"Content-Type: application/json\" -X POST localhost:8545\r\n{\"jsonrpc\":\"2.0\",\"id\":1,\"result\":\"Oll korrekt!\"}\r\n[user@work go-ethereum]$ curl --data '{\"method\":\"debug_timeMeOut\",\"params\":[30],\"id\":1,\"jsonrpc\":\"2.0\"}' -H \"Content-Type: application/json\" -X POST localhost:8545\r\ncurl: (52) Empty reply from server\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/853695381/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/853750762",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21430#issuecomment-853750762",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430",
    "id": 853750762,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1Mzc1MDc2Mg==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-03T10:04:24Z",
    "updated_at": "2021-06-03T10:04:24Z",
    "author_association": "MEMBER",
    "body": "The actual parameter deciding this is `h.server.WriteTimeout` in `node/rpcstack.go`. If set to `1` second, the issue is easier to debug",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/853750762/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/853751873",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21430#issuecomment-853751873",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21430",
    "id": 853751873,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1Mzc1MTg3Mw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-03T10:06:06Z",
    "updated_at": "2021-06-03T10:06:06Z",
    "author_association": "MEMBER",
    "body": "I don't think we need to set a timeout there. The `jsonCodec` has it's own internal timeout for the writes. \r\n```\r\n\tdefaultWriteTimeout = 10 * time.Second // used if context has no deadline\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/853751873/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
