{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22259",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22259/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22259/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22259/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/22259",
  "id": 797971909,
  "node_id": "MDU6SXNzdWU3OTc5NzE5MDk=",
  "number": 22259,
  "title": "Light client crashes",
  "user": {
    "login": "rjl493456442",
    "id": 5959481,
    "node_id": "MDQ6VXNlcjU5NTk0ODE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rjl493456442",
    "html_url": "https://github.com/rjl493456442",
    "followers_url": "https://api.github.com/users/rjl493456442/followers",
    "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
    "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
    "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
    "repos_url": "https://api.github.com/users/rjl493456442/repos",
    "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    },
    {
      "id": 841716348,
      "node_id": "MDU6TGFiZWw4NDE3MTYzNDg=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/area:les",
      "name": "area:les",
      "color": "c2e0c6",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "zsfelfoldi",
    "id": 9884311,
    "node_id": "MDQ6VXNlcjk4ODQzMTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9884311?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/zsfelfoldi",
    "html_url": "https://github.com/zsfelfoldi",
    "followers_url": "https://api.github.com/users/zsfelfoldi/followers",
    "following_url": "https://api.github.com/users/zsfelfoldi/following{/other_user}",
    "gists_url": "https://api.github.com/users/zsfelfoldi/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/zsfelfoldi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/zsfelfoldi/subscriptions",
    "organizations_url": "https://api.github.com/users/zsfelfoldi/orgs",
    "repos_url": "https://api.github.com/users/zsfelfoldi/repos",
    "events_url": "https://api.github.com/users/zsfelfoldi/events{/privacy}",
    "received_events_url": "https://api.github.com/users/zsfelfoldi/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "zsfelfoldi",
      "id": 9884311,
      "node_id": "MDQ6VXNlcjk4ODQzMTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9884311?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zsfelfoldi",
      "html_url": "https://github.com/zsfelfoldi",
      "followers_url": "https://api.github.com/users/zsfelfoldi/followers",
      "following_url": "https://api.github.com/users/zsfelfoldi/following{/other_user}",
      "gists_url": "https://api.github.com/users/zsfelfoldi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zsfelfoldi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zsfelfoldi/subscriptions",
      "organizations_url": "https://api.github.com/users/zsfelfoldi/orgs",
      "repos_url": "https://api.github.com/users/zsfelfoldi/repos",
      "events_url": "https://api.github.com/users/zsfelfoldi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zsfelfoldi/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2021-02-01T05:29:00Z",
  "updated_at": "2021-02-25T20:08:34Z",
  "closed_at": "2021-02-25T20:08:34Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Light client will crash if the first connection comes too fast\r\n\r\n```\r\n[b607cc39] panic: state machine not started yet\r\n[b607cc39]\r\n[b607cc39] goroutine 232 [running]:\r\n[b607cc39] github.com/ethereum/go-ethereum/p2p/nodestate.(*NodeStateMachine).checkStarted(...)\r\n[f489634f] DEBUG[02-01|05:13:30.443] Adding p2p peer                          peercount=1 id=298480aacb598f29 conn=inbound          addr=172.17.0.4:49732 name=Geth/v1.9.26-unstabl..\r\n.\r\n[f489634f] TRACE[02-01|05:13:30.443] Starting protocol les/3                  id=298480aacb598f29 conn=inbound\r\n[f489634f] DEBUG[02-01|05:13:30.443] Light Ethereum peer connected            id=298480aacb598f29 conn=inbound          name=Geth/v1.9.26-unstabl...\r\n[f489634f] DEBUG[02-01|05:13:30.443] Client connected                         id=298480aacb598f29\r\n[f489634f] DEBUG[02-01|05:13:30.443] Client activated                         id=298480aacb598f29\r\n[f489634f] DEBUG[02-01|05:13:30.447] Light Ethereum message handling failed   id=298480aacb598f29 conn=inbound          err=EOF\r\n[f489634f] DEBUG[02-01|05:13:30.447] Client disconnected                      id=298480aacb598f29\r\n[f489634f] DEBUG[02-01|05:13:30.448] Removing p2p peer                        peercount=0 id=298480aacb598f29 duration=4.600ms req=false err=EOF\r\n[b607cc39]      github.com/ethereum/go-ethereum/p2p/nodestate/nodestate.go:412\r\n[b607cc39] github.com/ethereum/go-ethereum/p2p/nodestate.(*NodeStateMachine).setState(0xc0006da620, 0xc0001aa1c0, 0x40, 0x1c44220, 0x30, 0x1c44220, 0x0)\r\n[b607cc39]      github.com/ethereum/go-ethereum/p2p/nodestate/nodestate.go:647 +0x746\r\n[b607cc39] github.com/ethereum/go-ethereum/p2p/nodestate.(*NodeStateMachine).SetState(0xc0006da620, 0xc0001aa1c0, 0x40, 0x1c44220, 0x30, 0x1c44220, 0x0, 0x0, 0x0)\r\n[b607cc39]      github.com/ethereum/go-ethereum/p2p/nodestate/nodestate.go:631 +0xdc\r\n[b607cc39] github.com/ethereum/go-ethereum/les.(*serverPool).registerPeer(0xc00000c3c0, 0xc000bf88c0)\r\n[b607cc39]      github.com/ethereum/go-ethereum/les/serverpool.go:283 +0xe5\r\n[b607cc39] github.com/ethereum/go-ethereum/les.(*serverPeerSet).register(0xc00033f080, 0xc000bf88c0, 0x0, 0x0)\r\n[b607cc39]      github.com/ethereum/go-ethereum/les/peer.go:1133 +0x165\r\n[b607cc39] github.com/ethereum/go-ethereum/les.(*clientHandler).handle(0xc000510ae0, 0xc000bf88c0, 0x0, 0x0)\r\n[b607cc39]      github.com/ethereum/go-ethereum/les/client_handler.go:118 +0x445\r\n[b607cc39] github.com/ethereum/go-ethereum/les.(*clientHandler).runPeer(0xc000510ae0, 0x3, 0xc0006dd080, 0x156f720, 0xc000342640, 0x0, 0x0)\r\n[b607cc39]      github.com/ethereum/go-ethereum/les/client_handler.go:101 +0x158\r\n[b607cc39] github.com/ethereum/go-ethereum/les.(*lesCommons).makeProtocols.func1(0xc0006dd080, 0x156f720, 0xc000342640, 0x0, 0x0)\r\n[b607cc39]      github.com/ethereum/go-ethereum/les/commons.go:85 +0x4c\r\n[b607cc39] github.com/ethereum/go-ethereum/p2p.(*Peer).startProtocols.func1(0xc0006dd080, 0xc000342640, 0x156f720, 0xc000342640)\r\n[b607cc39]      github.com/ethereum/go-ethereum/p2p/peer.go:389 +0x98\r\n[b607cc39] created by github.com/ethereum/go-ethereum/p2p.(*Peer).startProtocols\r\n[b607cc39]      github.com/ethereum/go-ethereum/p2p/peer.go:387 +0x205\r\n```",
  "closed_by": {
    "login": "zsfelfoldi",
    "id": 9884311,
    "node_id": "MDQ6VXNlcjk4ODQzMTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9884311?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/zsfelfoldi",
    "html_url": "https://github.com/zsfelfoldi",
    "followers_url": "https://api.github.com/users/zsfelfoldi/followers",
    "following_url": "https://api.github.com/users/zsfelfoldi/following{/other_user}",
    "gists_url": "https://api.github.com/users/zsfelfoldi/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/zsfelfoldi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/zsfelfoldi/subscriptions",
    "organizations_url": "https://api.github.com/users/zsfelfoldi/orgs",
    "repos_url": "https://api.github.com/users/zsfelfoldi/repos",
    "events_url": "https://api.github.com/users/zsfelfoldi/events{/privacy}",
    "received_events_url": "https://api.github.com/users/zsfelfoldi/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22259/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22259/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/781180476",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22259#issuecomment-781180476",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22259",
    "id": 781180476,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MTE4MDQ3Ng==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-18T08:42:49Z",
    "updated_at": "2021-02-18T08:42:49Z",
    "author_association": "MEMBER",
    "body": "```\r\nfunc (ns *NodeStateMachine) checkStarted() {\r\n\tif !ns.started {\r\n\t\tpanic(\"state machine not started yet\")\r\n\t}\r\n}\r\n```\r\nSeems like this should be pretty trivial to fix, @zsfelfoldi ?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/781180476/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/781946652",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22259#issuecomment-781946652",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22259",
    "id": 781946652,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MTk0NjY1Mg==",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-19T09:18:47Z",
    "updated_at": "2021-02-19T09:18:47Z",
    "author_association": "MEMBER",
    "body": "It's detected by hive framework. In order to fix it, an ugly hack is added https://github.com/ethereum/hive/pull/424/files#diff-45f4450112c9a4f924a720ea987fe5f2ec14674f3df283df011547a2eb6dc9a6R138",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/781946652/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/782061264",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22259#issuecomment-782061264",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22259",
    "id": 782061264,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MjA2MTI2NA==",
    "user": {
      "login": "zsfelfoldi",
      "id": 9884311,
      "node_id": "MDQ6VXNlcjk4ODQzMTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9884311?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zsfelfoldi",
      "html_url": "https://github.com/zsfelfoldi",
      "followers_url": "https://api.github.com/users/zsfelfoldi/followers",
      "following_url": "https://api.github.com/users/zsfelfoldi/following{/other_user}",
      "gists_url": "https://api.github.com/users/zsfelfoldi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zsfelfoldi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zsfelfoldi/subscriptions",
      "organizations_url": "https://api.github.com/users/zsfelfoldi/orgs",
      "repos_url": "https://api.github.com/users/zsfelfoldi/repos",
      "events_url": "https://api.github.com/users/zsfelfoldi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zsfelfoldi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-19T13:03:56Z",
    "updated_at": "2021-02-19T13:03:56Z",
    "author_association": "MEMBER",
    "body": "Fixed by https://github.com/ethereum/go-ethereum/pull/22297",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/782061264/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
