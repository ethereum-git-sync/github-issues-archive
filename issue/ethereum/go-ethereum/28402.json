{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28402",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28402/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28402/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28402/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/28402",
  "id": 1956669873,
  "node_id": "I_kwDOAOvK9850oGmx",
  "number": 28402,
  "title": "Are we fetching too many transactions?",
  "user": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 268304226,
      "node_id": "MDU6TGFiZWwyNjgzMDQyMjY=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:docs",
      "name": "type:docs",
      "color": "fef2c0",
      "default": false,
      "description": null
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2023-10-23T08:51:01Z",
  "updated_at": "2023-10-23T11:46:10Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Below is `DEBUG`-level output from one second on a production machine. \r\nDuring that second, \r\n\r\n- It does `70` \"Fetching batch of transactions\"\r\n  - 12 from `60ad9f046ceac43f`\r\n  - 10 from `8df6b3d30d5b1dd2`\r\n  - 6 from `935199c26a6b8066`\r\n  - 6 from `5ce74318dc0c8d1f`\r\n  - 5 from `fca6d1693fb53456`\r\n  - 4 from `d6b1f836c730c197`\r\n  - 2 from `eb434f99c7c466c2`\r\n  - 4 from `7d77ade6067f2acd`\r\n\r\nIt seems to me a bit over-eager. Should we perhaps add a delay, so that instead of fetching from a peer 10 times during one second, we instead \r\nfetch only once, and lump together the requests a bit? \r\n```\r\nDEBUG[10-23|08:38:49.254] Fetching batch of transactions id=8df6b3d30d5b1dd2 conn=dyndial count=1\r\nDEBUG[10-23|08:38:49.272] Distributed transactions plaintxs=1 blobtxs=0 largetxs=0 bcastpeers=7 bcastcount=7 annpeers=42 anncount=42\r\nDEBUG[10-23|08:38:49.279] Distributed transactions plaintxs=1 blobtxs=0 largetxs=0 bcastpeers=2 bcastcount=2 annpeers=4 anncount=4\r\nDEBUG[10-23|08:38:49.372] Distributed transactions plaintxs=1 blobtxs=0 largetxs=0 bcastpeers=7 bcastcount=7 annpeers=42 anncount=42\r\nDEBUG[10-23|08:38:49.414] Fetching batch of transactions id=fca6d1693fb53456 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.414] Fetching batch of transactions id=d6b1f836c730c197 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.414] Fetching batch of transactions id=60ad9f046ceac43f conn=inbound count=4\r\nDEBUG[10-23|08:38:49.522] Fetching batch of transactions id=60ad9f046ceac43f conn=inbound count=2\r\nDEBUG[10-23|08:38:49.522] Fetching batch of transactions id=eb434f99c7c466c2 conn=inbound count=4\r\nDEBUG[10-23|08:38:49.522] Fetching batch of transactions id=8df6b3d30d5b1dd2 conn=dyndial count=1\r\nDEBUG[10-23|08:38:49.522] Fetching batch of transactions id=7d77ade6067f2acd conn=inbound count=5\r\nDEBUG[10-23|08:38:49.529] Fetching batch of transactions id=935199c26a6b8066 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.532] Fetching batch of transactions id=fca6d1693fb53456 conn=inbound count=3\r\nDEBUG[10-23|08:38:49.547] Fetching batch of transactions id=60ad9f046ceac43f conn=inbound count=1\r\nDEBUG[10-23|08:38:49.547] Fetching batch of transactions id=8df6b3d30d5b1dd2 conn=dyndial count=1\r\nDEBUG[10-23|08:38:49.569] Fetching batch of transactions id=d6b1f836c730c197 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.569] Fetching batch of transactions id=60ad9f046ceac43f conn=inbound count=1\r\nDEBUG[10-23|08:38:49.575] Fetching batch of transactions id=62eb69d4dbfa5016 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.630] Distributed transactions plaintxs=1 blobtxs=0 largetxs=0 bcastpeers=7 bcastcount=7 annpeers=42 anncount=42\r\nDEBUG[10-23|08:38:49.630] Fetching batch of transactions id=60ad9f046ceac43f conn=inbound count=7\r\nDEBUG[10-23|08:38:49.630] Fetching batch of transactions id=e1c148dda73fa838 conn=inbound count=2\r\nDEBUG[10-23|08:38:49.630] Fetching batch of transactions id=eb434f99c7c466c2 conn=inbound count=7\r\nDEBUG[10-23|08:38:49.630] Fetching batch of transactions id=46ba5b396a9e6695 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.630] Fetching batch of transactions id=5ce74318dc0c8d1f conn=inbound count=3\r\nDEBUG[10-23|08:38:49.630] Fetching batch of transactions id=935199c26a6b8066 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.630] Fetching batch of transactions id=b0a3fc0969234520 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.637] Fetching batch of transactions id=60ad9f046ceac43f conn=inbound count=5\r\nDEBUG[10-23|08:38:49.642] Fetching batch of transactions id=7d77ade6067f2acd conn=inbound count=5\r\nDEBUG[10-23|08:38:49.650] Fetching batch of transactions id=fca6d1693fb53456 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.673] Distributed transactions plaintxs=2 blobtxs=0 largetxs=0 bcastpeers=14 bcastcount=14 annpeers=49 anncount=84\r\nDEBUG[10-23|08:38:49.724] Fetching batch of transactions id=935199c26a6b8066 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.724] Fetching batch of transactions id=d6b1f836c730c197 conn=inbound count=4\r\nDEBUG[10-23|08:38:49.730] Distributed transactions plaintxs=2 blobtxs=0 largetxs=0 bcastpeers=13 bcastcount=13 annpeers=49 anncount=82\r\nDEBUG[10-23|08:38:49.734] Fetching batch of transactions id=9d891b45f6beba34 conn=inbound count=4\r\nDEBUG[10-23|08:38:49.734] Fetching batch of transactions id=0dbf9621bd977317 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.734] Fetching batch of transactions id=8df6b3d30d5b1dd2 conn=dyndial count=20\r\nDEBUG[10-23|08:38:49.734] Fetching batch of transactions id=62eb69d4dbfa5016 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.734] Fetching batch of transactions id=60ad9f046ceac43f conn=inbound count=15\r\nDEBUG[10-23|08:38:49.734] Fetching batch of transactions id=5ce74318dc0c8d1f conn=inbound count=2\r\nDEBUG[10-23|08:38:49.742] Fetching batch of transactions id=60ad9f046ceac43f conn=inbound count=3\r\nDEBUG[10-23|08:38:49.761] Fetching batch of transactions id=8df6b3d30d5b1dd2 conn=dyndial count=8\r\nDEBUG[10-23|08:38:49.782] Fetching batch of transactions id=7d77ade6067f2acd conn=inbound count=6\r\nDEBUG[10-23|08:38:49.786] Fetching batch of transactions id=fca6d1693fb53456 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.794] Fetching batch of transactions id=7ad49d593837d6d5 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.794] Fetching batch of transactions id=5ce74318dc0c8d1f conn=inbound count=1\r\nDEBUG[10-23|08:38:49.813] Fetching batch of transactions id=935199c26a6b8066 conn=inbound count=20\r\nDEBUG[10-23|08:38:49.823] Fetching batch of transactions id=5e751719ec614b1e conn=dyndial count=2\r\nDEBUG[10-23|08:38:49.838] Fetching batch of transactions id=62eb69d4dbfa5016 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.838] Fetching batch of transactions id=0dbf9621bd977317 conn=inbound count=6\r\nDEBUG[10-23|08:38:49.838] Fetching batch of transactions id=60ad9f046ceac43f conn=inbound count=13\r\nDEBUG[10-23|08:38:49.838] Fetching batch of transactions id=8df6b3d30d5b1dd2 conn=dyndial count=14\r\nDEBUG[10-23|08:38:49.852] Fetching batch of transactions id=5ce74318dc0c8d1f conn=inbound count=1\r\nDEBUG[10-23|08:38:49.860] Fetching batch of transactions id=7ad49d593837d6d5 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.863] Fetching batch of transactions id=46ba5b396a9e6695 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.863] Fetching batch of transactions id=8df6b3d30d5b1dd2 conn=dyndial count=2\r\nDEBUG[10-23|08:38:49.863] Fetching batch of transactions id=60ad9f046ceac43f conn=inbound count=1\r\nDEBUG[10-23|08:38:49.872] Distributed transactions plaintxs=1 blobtxs=0 largetxs=0 bcastpeers=7 bcastcount=7 annpeers=42 anncount=42\r\nDEBUG[10-23|08:38:49.879] Fetching batch of transactions id=d6b1f836c730c197 conn=inbound count=13\r\nDEBUG[10-23|08:38:49.888] Fetching batch of transactions id=8df6b3d30d5b1dd2 conn=dyndial count=1\r\nDEBUG[10-23|08:38:49.902] Fetching batch of transactions id=935199c26a6b8066 conn=inbound count=18\r\nDEBUG[10-23|08:38:49.904] Fetching batch of transactions id=5e751719ec614b1e conn=dyndial count=4\r\nDEBUG[10-23|08:38:49.904] Fetching batch of transactions id=fca6d1693fb53456 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.919] Fetching batch of transactions id=9d891b45f6beba34 conn=inbound count=4\r\nDEBUG[10-23|08:38:49.919] Fetching batch of transactions id=5ce74318dc0c8d1f conn=inbound count=1\r\nDEBUG[10-23|08:38:49.919] Fetching batch of transactions id=8df6b3d30d5b1dd2 conn=dyndial count=3\r\nDEBUG[10-23|08:38:49.929] Fetching batch of transactions id=0dbf9621bd977317 conn=inbound count=2\r\nDEBUG[10-23|08:38:49.932] Fetching batch of transactions id=7d77ade6067f2acd conn=inbound count=12\r\nDEBUG[10-23|08:38:49.939] Fetching batch of transactions id=5e5b9c481ea0bcf8 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.939] Fetching batch of transactions id=62eb69d4dbfa5016 conn=inbound count=29\r\nDEBUG[10-23|08:38:49.939] Fetching batch of transactions id=c1bfd165d52871d8 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.939] Fetching batch of transactions id=7ad49d593837d6d5 conn=inbound count=1\r\nDEBUG[10-23|08:38:49.939] Fetching batch of transactions id=60ad9f046ceac43f conn=inbound count=2\r\nDEBUG[10-23|08:38:49.943] Fetching batch of transactions id=8df6b3d30d5b1dd2 conn=dyndial count=4\r\nDEBUG[10-23|08:38:49.946] Fetching batch of transactions id=60ad9f046ceac43f conn=inbound count=1\r\nDEBUG[10-23|08:38:49.977] Fetching batch of transactions id=5ce74318dc0c8d1f conn=inbound count=7\r\nDEBUG[10-23|08:38:49.986] Fetching batch of transactions id=5e751719ec614b1e conn=dyndial count=4\r\nDEBUG[10-23|08:38:49.992] Fetching batch of transactions id=935199c26a6b8066 conn=inbound count=12\r\n```\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28402/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28402/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[

]
