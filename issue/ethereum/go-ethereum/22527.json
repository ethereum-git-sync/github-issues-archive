{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22527",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22527/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22527/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22527/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/22527",
  "id": 834970401,
  "node_id": "MDU6SXNzdWU4MzQ5NzA0MDE=",
  "number": 22527,
  "title": "Can't get a viable ws or http connection to geth via node console",
  "user": {
    "login": "cyrusadkisson",
    "id": 2284720,
    "node_id": "MDQ6VXNlcjIyODQ3MjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2284720?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cyrusadkisson",
    "html_url": "https://github.com/cyrusadkisson",
    "followers_url": "https://api.github.com/users/cyrusadkisson/followers",
    "following_url": "https://api.github.com/users/cyrusadkisson/following{/other_user}",
    "gists_url": "https://api.github.com/users/cyrusadkisson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cyrusadkisson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cyrusadkisson/subscriptions",
    "organizations_url": "https://api.github.com/users/cyrusadkisson/orgs",
    "repos_url": "https://api.github.com/users/cyrusadkisson/repos",
    "events_url": "https://api.github.com/users/cyrusadkisson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cyrusadkisson/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-03-18T15:44:05Z",
  "updated_at": "2021-03-19T20:02:56Z",
  "closed_at": "2021-03-19T16:33:26Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: 1.10.1 from ubuntu ppas\r\nOS & Version: Ubuntu Linux 20.04.1 64-bit\r\n\r\nMoving \"side issue\" discussion from another bug report:\r\n\r\nme: \"(Side issue: can't connect to ws or http or ipc and spent all day trying. Internally, from another computer, ports, firewalls, tried to sideload web3, etc. I finally gave up, loaded web3 into node console, started using an Infura endpoint and gave up on geth entirely.)\"\r\n\r\n@holiman \"Now this is a lot more concerning to me. Please provide more info, because connecting to ws or http always works like a charm for me, and it's very important that this works well.\"\r\n\r\n-------\r\n\r\nAt first I was doing \"geth --syncmode fast\" (and letting it fully sync to eth.syncing false) and then \"geth attach\" in another terminal window. But because web3 is so out of date I had to scrap that plan.\r\n\r\nSo I stared geth with ws and/or http and attempted to connect from node console on another computer. \r\n\r\nThese commands work against infura but not against the geth instance.\r\n\r\n```\r\nvar Web3 = require('web3');\r\nvar web3 = new Web3('ws://192.168.1.121:8546');\r\n//var web3 = new Web3('https://mainnet.infura.io/v3/MYHEXENDPOINT');\r\nvar abi = [{\"constant\":false,\"inputs\":[],\"name\":\"setLocked\",\"outputs\":[],\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getWhatHappened\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getLocked\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"col\",\"type\":\"uint8\"},{\"name\":\"row\",\"type\":\"uint8\"}],\"name\":\"buyTile\",\"outputs\":[],\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"kill\",\"outputs\":[],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"col\",\"type\":\"uint8\"},{\"name\":\"row\",\"type\":\"uint8\"},{\"name\":\"_s\",\"type\":\"string\"}],\"name\":\"setStatus\",\"outputs\":[],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"col\",\"type\":\"uint8\"},{\"name\":\"row\",\"type\":\"uint8\"},{\"name\":\"newowner\",\"type\":\"address\"}],\"name\":\"setOwner\",\"outputs\":[],\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"col\",\"type\":\"uint8\"},{\"name\":\"row\",\"type\":\"uint8\"}],\"name\":\"getLastFarm\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"col\",\"type\":\"uint8\"},{\"name\":\"row\",\"type\":\"uint8\"},{\"name\":\"index\",\"type\":\"uint256\"},{\"name\":\"_block\",\"type\":\"int8[5]\"}],\"name\":\"editBlock\",\"outputs\":[],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"col\",\"type\":\"uint8\"},{\"name\":\"row\",\"type\":\"uint8\"},{\"name\":\"blocktype\",\"type\":\"int8\"}],\"name\":\"farmTile\",\"outputs\":[],\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"col\",\"type\":\"uint8\"},{\"name\":\"row\",\"type\":\"uint8\"},{\"name\":\"_n\",\"type\":\"string\"}],\"name\":\"setName\",\"outputs\":[],\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"col\",\"type\":\"uint8\"},{\"name\":\"row\",\"type\":\"uint8\"}],\"name\":\"getName\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"col\",\"type\":\"uint8\"},{\"name\":\"row\",\"type\":\"uint8\"}],\"name\":\"getStatus\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"col\",\"type\":\"uint8\"},{\"name\":\"row\",\"type\":\"uint8\"}],\"name\":\"getOwner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"empty\",\"outputs\":[],\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"col\",\"type\":\"uint8\"},{\"name\":\"row\",\"type\":\"uint8\"}],\"name\":\"getBlocks\",\"outputs\":[{\"name\":\"\",\"type\":\"int8[5][]\"}],\"type\":\"function\"},{\"inputs\":[],\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"col\",\"type\":\"uint8\"},{\"indexed\":false,\"name\":\"row\",\"type\":\"uint8\"}],\"name\":\"TileChanged\",\"type\":\"event\"}];\r\netheria = new web3.eth.Contract(abi,\"0xb21f8684f23dbb1008508b4de91a0aaedebdb7e4\");\r\netheria.methods.getOwner(15,9).call(function(error, result) { console.log(result) });\r\n```\r\nresult when working against infura (which is the correct response)\r\n```\r\n> etheria.methods.getOwner(15,9).call(function(error, result) { console.log(result) });\r\nPromise { <pending> }\r\n> 0xcf684DFB8304729355B58315E8019B1aa2AD1Bac\r\n```\r\nresult when failing against the geth ws or http\r\n```\r\n> etheria.methods.getOwner(15,9).call(function(error, result) { console.log(result) });\r\nPromise { <pending> }\r\n>\r\n```\r\nI have verified that the firewall of the geth instance is off (ufw disabled) and that installing something like httpd or sshd on that computer shows ports 80 and 22 open on the host computer from the client computer. nmap never shows any other ports listening for connections.\r\n\r\nAny thoughts here? It's highly likely I'm just doing something dumb. (I've been out of the game for a long time.)",
  "closed_by": {
    "login": "cyrusadkisson",
    "id": 2284720,
    "node_id": "MDQ6VXNlcjIyODQ3MjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2284720?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cyrusadkisson",
    "html_url": "https://github.com/cyrusadkisson",
    "followers_url": "https://api.github.com/users/cyrusadkisson/followers",
    "following_url": "https://api.github.com/users/cyrusadkisson/following{/other_user}",
    "gists_url": "https://api.github.com/users/cyrusadkisson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cyrusadkisson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cyrusadkisson/subscriptions",
    "organizations_url": "https://api.github.com/users/cyrusadkisson/orgs",
    "repos_url": "https://api.github.com/users/cyrusadkisson/repos",
    "events_url": "https://api.github.com/users/cyrusadkisson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cyrusadkisson/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22527/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22527/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/802628119",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22527#issuecomment-802628119",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22527",
    "id": 802628119,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMjYyODExOQ==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-19T07:52:25Z",
    "updated_at": "2021-03-19T07:52:25Z",
    "author_association": "MEMBER",
    "body": "In order to start http or ws, you need to do `geth --http`. or `--ws`",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/802628119/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/802950597",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22527#issuecomment-802950597",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22527",
    "id": 802950597,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMjk1MDU5Nw==",
    "user": {
      "login": "cyrusadkisson",
      "id": 2284720,
      "node_id": "MDQ6VXNlcjIyODQ3MjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2284720?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cyrusadkisson",
      "html_url": "https://github.com/cyrusadkisson",
      "followers_url": "https://api.github.com/users/cyrusadkisson/followers",
      "following_url": "https://api.github.com/users/cyrusadkisson/following{/other_user}",
      "gists_url": "https://api.github.com/users/cyrusadkisson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cyrusadkisson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cyrusadkisson/subscriptions",
      "organizations_url": "https://api.github.com/users/cyrusadkisson/orgs",
      "repos_url": "https://api.github.com/users/cyrusadkisson/repos",
      "events_url": "https://api.github.com/users/cyrusadkisson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cyrusadkisson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-19T16:18:48Z",
    "updated_at": "2021-03-19T16:18:48Z",
    "author_association": "NONE",
    "body": "I definitely am starting with \r\n\r\n`geth --ws --ws.port 8546 --ws.origins \"*\" --ws.api eth,net,web3`\r\n\r\nThe geth logs then say \r\n\r\n`WebSocket enabled url=ws://127.0.0.1:8546`\r\n\r\nAnd yet when I try to use this endpoint from another computer, I get\r\n\r\n```\r\n> (node:26905) UnhandledPromiseRejectionWarning: Error: connection not open on send()\r\n    at Object.ConnectionError (/home/cyrus/node_modules/web3-core-helpers/lib/errors.js:66:23)\r\n    at Object.ConnectionNotOpenError (/home/cyrus/node_modules/web3-core-helpers/lib/errors.js:49:21)\r\n```\r\nufw on the host machine is inactive\r\nnmap shows \r\n\r\n```\r\nHost is up (0.00013s latency).\r\nNot shown: 9999 closed ports\r\nPORT   STATE SERVICE\r\n22/tcp open  ssh\r\n\r\nNmap done: 1 IP address (1 host up) scanned in 0.12 seconds\r\n```\r\nI can ssh across the local network so it seems unlikely the router isn't doing something funky. \r\n\r\nNetstat on the host machine shows tcp running on 127.0.0.1:8546 and shows /geth at the line.\r\n\r\nSo why is my local machine reporting the connection error when attempting to interact with it?\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/802950597/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/802959919",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22527#issuecomment-802959919",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22527",
    "id": 802959919,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMjk1OTkxOQ==",
    "user": {
      "login": "cyrusadkisson",
      "id": 2284720,
      "node_id": "MDQ6VXNlcjIyODQ3MjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2284720?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cyrusadkisson",
      "html_url": "https://github.com/cyrusadkisson",
      "followers_url": "https://api.github.com/users/cyrusadkisson/followers",
      "following_url": "https://api.github.com/users/cyrusadkisson/following{/other_user}",
      "gists_url": "https://api.github.com/users/cyrusadkisson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cyrusadkisson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cyrusadkisson/subscriptions",
      "organizations_url": "https://api.github.com/users/cyrusadkisson/orgs",
      "repos_url": "https://api.github.com/users/cyrusadkisson/repos",
      "events_url": "https://api.github.com/users/cyrusadkisson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cyrusadkisson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-19T16:33:25Z",
    "updated_at": "2021-03-19T16:33:25Z",
    "author_association": "NONE",
    "body": "Nevermind. I got it. I had to explicitly set the ws.addr to the local network hostname 192.168.1.121.\r\n\r\nThanks for your help.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/802959919/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/803087490",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22527#issuecomment-803087490",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22527",
    "id": 803087490,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzA4NzQ5MA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-19T20:02:55Z",
    "updated_at": "2021-03-19T20:02:55Z",
    "author_association": "MEMBER",
    "body": "Yeah 127.0.0.1 is localhost, you want to use 0.0.0.0 , or, what you eventually did. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/803087490/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
