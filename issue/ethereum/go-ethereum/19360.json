{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19360",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19360/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19360/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19360/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/19360",
  "id": 427586463,
  "node_id": "MDU6SXNzdWU0Mjc1ODY0NjM=",
  "number": 19360,
  "title": "Impossible reorg, please file an issue",
  "user": {
    "login": "zulhfreelancer",
    "id": 3416976,
    "node_id": "MDQ6VXNlcjM0MTY5NzY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3416976?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/zulhfreelancer",
    "html_url": "https://github.com/zulhfreelancer",
    "followers_url": "https://api.github.com/users/zulhfreelancer/followers",
    "following_url": "https://api.github.com/users/zulhfreelancer/following{/other_user}",
    "gists_url": "https://api.github.com/users/zulhfreelancer/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/zulhfreelancer/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/zulhfreelancer/subscriptions",
    "organizations_url": "https://api.github.com/users/zulhfreelancer/orgs",
    "repos_url": "https://api.github.com/users/zulhfreelancer/repos",
    "events_url": "https://api.github.com/users/zulhfreelancer/events{/privacy}",
    "received_events_url": "https://api.github.com/users/zulhfreelancer/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/milestones/61",
    "html_url": "https://github.com/ethereum/go-ethereum/milestone/61",
    "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/milestones/61/labels",
    "id": 3111008,
    "node_id": "MDk6TWlsZXN0b25lMzExMTAwOA==",
    "number": 61,
    "title": "1.9.0",
    "description": "",
    "creator": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 370,
    "state": "closed",
    "created_at": "2018-02-13T11:59:08Z",
    "updated_at": "2019-12-02T09:49:38Z",
    "due_on": null,
    "closed_at": "2019-07-11T11:36:40Z"
  },
  "comments": 1,
  "created_at": "2019-04-01T08:56:11Z",
  "updated_at": "2019-05-10T14:04:11Z",
  "closed_at": "2019-05-10T14:04:11Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: 1.8.23-stable\r\nOS & Version: Ubuntu 16.04.5 LTS\r\nCommit hash: N/A\r\n\r\n#### Expected behaviour\r\n\r\nAble to sync with other nodes listed in _static-nodes.json_ file without any problems.\r\n\r\n#### Actual behaviour\r\n\r\nGot a lot of `Impossible reorg, please file an issue` errors. Looks like it's coming [from this line of code](https://github.com/ethereum/go-ethereum/blob/7fb89697fd248879a0fd1ac0b925b91b3dda0e22/core/blockchain.go#L1539).\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\n1. Setup a PoA Clique node (private blockchain). Let's call this Node A.\r\n2. Using same genesis file, now setup Node B.\r\n3. Add Node A's `enode` in Node B's _static-nodes.json_ file.\r\n4. Start Node A, followed by Node B\r\n\r\n#### Backtrace\r\n\r\n````\r\n$ geth --networkid=\"4242\"\r\n\r\nINFO [04-01|08:40:19.613] Maximum peer count                       ETH=25 LES=0 total=25\r\nWARN [04-01|08:40:19.615] Found deprecated node list file /home/zulh/.ethereum/geth/static-nodes.json, please use the TOML config file instead.\r\nINFO [04-01|08:40:19.616] Starting peer-to-peer node               instance=Geth/v1.8.23-stable-c9427004/linux-amd64/go1.11.5\r\nINFO [04-01|08:40:19.616] Allocated cache and file handles         database=/home/zulh/.ethereum/geth/chaindata cache=512 handles=524288\r\nINFO [04-01|08:40:19.669] Initialised chain configuration          config=\"{ChainID: 4242 Homestead: 1 DAO: <nil> DAOSupport: false EIP150: 2 EIP155: 3 EIP158: 3 Byzantium: 4 Constantinople: 5  ConstantinopleFix: <nil> Engine: clique}\"\r\nINFO [04-01|08:40:19.673] Initialising Ethereum protocol           versions=\"[63 62]\" network=4242\r\nINFO [04-01|08:40:19.958] Loaded most recent local header          number=645 hash=a45075…d1e8cd td=1291 age=1mo1w3d\r\nINFO [04-01|08:40:19.959] Loaded most recent local full block      number=7900 hash=3f00b8…0769cb td=15801 age=1mo1w2d\r\nINFO [04-01|08:40:19.959] Loaded most recent local fast block      number=645  hash=a45075…d1e8cd td=1291  age=1mo1w3d\r\nINFO [04-01|08:40:19.970] Setting new local account                address=0x3d1c6298dabE77A4DB35619b88bC4b33fc1fE5E4\r\nINFO [04-01|08:40:21.044] Setting new local account                address=0x1125682759547c0010C2950D012B2546e508a6cf\r\nINFO [04-01|08:40:21.187] Setting new local account                address=0x4F2017754715968540760577651a5aCce4D74caa\r\nINFO [04-01|08:40:21.198] Loaded local transaction journal         transactions=1924 dropped=0\r\nINFO [04-01|08:40:21.237] Regenerated local transaction journal    transactions=1924 accounts=5\r\nWARN [04-01|08:40:21.237] Blockchain not empty, fast sync disabled\r\nINFO [04-01|08:40:23.263] New local node record                    seq=53 id=f14f9c533b6fb0b1 ip=127.0.0.1 udp=30303 tcp=30303\r\nINFO [04-01|08:40:23.287] Started P2P networking                   self=enode://4a64_redacted_924f@127.0.0.1:30303\r\nINFO [04-01|08:40:23.303] IPC endpoint opened                      url=/home/zulh/.ethereum/geth.ipc\r\nINFO [04-01|08:40:33.289] Block synchronisation started\r\nWARN [04-01|08:40:33.306] Synchronisation failed, dropping peer    peer=04522a693dc7495b err=\"no peers available or all tried for download\"\r\nINFO [04-01|08:40:44.283] New local node record                    seq=54 id=f14f9c533b6fb0b1 ip=3.1.171.126 udp=30303 tcp=30303\r\nINFO [04-01|08:40:51.262] Importing heavy sidechain segment        blocks=2048 start=7920 end=9967\r\nERROR[04-01|08:40:51.376] Impossible reorg, please file an issue   oldnum=7900 oldhash=3f00b8…0769cb newnum=7900 newhash=3f00b8…0769cb\r\nWARN [04-01|08:40:51.413] Synchronisation failed, dropping peer    peer=38e16b9a033bc4ab err=\"retrieved hash chain is invalid\"\r\nWARN [04-01|08:40:53.295] Synchronisation failed, dropping peer    peer=04522a693dc7495b err=\"no peers available or all tried for download\"\r\nINFO [04-01|08:41:10.631] Importing heavy sidechain segment        blocks=2048 start=7960 end=10007\r\nERROR[04-01|08:41:10.642] Impossible reorg, please file an issue   oldnum=7920 oldhash=698e93…e3030b newnum=7920 newhash=698e93…e3030b\r\nWARN [04-01|08:41:10.681] Synchronisation failed, dropping peer    peer=38e16b9a033bc4ab err=\"retrieved hash chain is invalid\"\r\nWARN [04-01|08:41:13.292] Synchronisation failed, dropping peer    peer=04522a693dc7495b err=\"no peers available or all tried for download\"\r\nWARN [04-01|08:41:23.293] Synchronisation failed, dropping peer    peer=04522a693dc7495b err=\"no peers available or all tried for download\"\r\nINFO [04-01|08:41:38.912] Importing heavy sidechain segment        blocks=2048 start=7980 end=10027\r\nERROR[04-01|08:41:39.071] Impossible reorg, please file an issue   oldnum=7960 oldhash=66a61a…9351a6 newnum=7960 newhash=66a61a…9351a6\r\nWARN [04-01|08:41:39.099] Synchronisation failed, dropping peer    peer=38e16b9a033bc4ab err=\"retrieved hash chain is invalid\"\r\nWARN [04-01|08:41:43.293] Synchronisation failed, dropping peer    peer=04522a693dc7495b err=\"no peers available or all tried for download\"\r\nWARN [04-01|08:41:53.294] Synchronisation failed, dropping peer    peer=04522a693dc7495b err=\"no peers available or all tried for download\"\r\nINFO [04-01|08:42:09.110] Importing heavy sidechain segment        blocks=2048 start=8000 end=10047\r\nERROR[04-01|08:42:09.277] Impossible reorg, please file an issue   oldnum=7980 oldhash=e8041a…ac45cb newnum=7980 newhash=e8041a…ac45cb\r\nWARN [04-01|08:42:09.278] Synchronisation failed, dropping peer    peer=38e16b9a033bc4ab err=\"retrieved hash chain is invalid\"\r\nWARN [04-01|08:42:13.293] Synchronisation failed, dropping peer    peer=04522a693dc7495b err=\"no peers available or all tried for download\"\r\nWARN [04-01|08:42:23.297] Synchronisation failed, dropping peer    peer=04522a693dc7495b err=\"no peers available or all tried for download\"\r\nINFO [04-01|08:42:40.727] Importing heavy sidechain segment        blocks=2048 start=8020 end=10067\r\nERROR[04-01|08:42:40.762] Impossible reorg, please file an issue   oldnum=8000 oldhash=18eb3e…58af59 newnum=8000 newhash=18eb3e…58af59\r\nWARN [04-01|08:42:40.762] Synchronisation failed, dropping peer    peer=38e16b9a033bc4ab err=\"retrieved hash chain is invalid\"\r\nWARN [04-01|08:42:43.296] Synchronisation failed, dropping peer    peer=04522a693dc7495b err=\"no peers available or all tried for download\"\r\nINFO [04-01|08:43:03.186] Importing heavy sidechain segment        blocks=2048 start=8040 end=10087\r\nERROR[04-01|08:43:03.395] Impossible reorg, please file an issue   oldnum=8020 oldhash=7d0ebf…941b5e newnum=8020 newhash=7d0ebf…941b5e\r\nWARN [04-01|08:43:03.396] Synchronisation failed, dropping peer    peer=38e16b9a033bc4ab err=\"retrieved hash chain is invalid\"\r\nWARN [04-01|08:43:03.526] Synchronisation failed, dropping peer    peer=04522a693dc7495b err=\"no peers available or all tried for download\"\r\n^CINFO [04-01|08:43:05.881] Got interrupt, shutting down...\r\nINFO [04-01|08:43:05.882] IPC endpoint closed                      url=/home/zulh/.ethereum/geth.ipc\r\nINFO [04-01|08:43:05.882] Writing cached state to disk             block=8040 hash=ac0083…1851ff root=1290d2…0ad15f\r\nINFO [04-01|08:43:05.882] Persisted trie from memory database      nodes=17 size=5.96kB time=265.651µs gcnodes=0 gcsize=0.00B gctime=0s livenodes=86 livesize=29.77kB\r\nINFO [04-01|08:43:05.882] Writing cached state to disk             block=8039 hash=f983d4…e672d7 root=3af22b…afa217\r\nINFO [04-01|08:43:05.883] Persisted trie from memory database      nodes=17 size=5.96kB time=170.042µs gcnodes=0 gcsize=0.00B gctime=0s livenodes=69 livesize=23.82kB\r\nINFO [04-01|08:43:05.883] Writing cached state to disk             block=7913 hash=5d17ab…b53051 root=ed9178…5139f3\r\nINFO [04-01|08:43:05.883] Persisted trie from memory database      nodes=0  size=0.00B  time=1.78µs    gcnodes=0 gcsize=0.00B gctime=0s livenodes=69 livesize=23.82kB\r\nINFO [04-01|08:43:05.883] Blockchain manager stopped\r\nINFO [04-01|08:43:05.883] Stopping Ethereum protocol\r\nINFO [04-01|08:43:05.883] Ethereum protocol stopped\r\nINFO [04-01|08:43:05.883] Transaction pool stopped\r\nINFO [04-01|08:43:05.909] Database closed                          database=/home/zulh/.ethereum/geth/chaindata\r\n````\r\n\r\nThis issue is related to https://github.com/ethereum/go-ethereum/issues/19302 and https://github.com/ethereum/go-ethereum/issues/16641.",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19360/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19360/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/490877207",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19360#issuecomment-490877207",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19360",
    "id": 490877207,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5MDg3NzIwNw==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-09T12:10:58Z",
    "updated_at": "2019-05-09T12:10:58Z",
    "author_association": "MEMBER",
    "body": "Managed to trace down the issue, will be fixed by https://github.com/ethereum/go-ethereum/pull/19544.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/490877207/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
