{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16145",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16145/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16145/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16145/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/16145",
  "id": 298614221,
  "node_id": "MDU6SXNzdWUyOTg2MTQyMjE=",
  "number": 16145,
  "title": "Geth evicts all peers, does not attempt to add new peers",
  "user": {
    "login": "DaveWK",
    "id": 13626476,
    "node_id": "MDQ6VXNlcjEzNjI2NDc2",
    "avatar_url": "https://avatars.githubusercontent.com/u/13626476?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/DaveWK",
    "html_url": "https://github.com/DaveWK",
    "followers_url": "https://api.github.com/users/DaveWK/followers",
    "following_url": "https://api.github.com/users/DaveWK/following{/other_user}",
    "gists_url": "https://api.github.com/users/DaveWK/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/DaveWK/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/DaveWK/subscriptions",
    "organizations_url": "https://api.github.com/users/DaveWK/orgs",
    "repos_url": "https://api.github.com/users/DaveWK/repos",
    "events_url": "https://api.github.com/users/DaveWK/events{/privacy}",
    "received_events_url": "https://api.github.com/users/DaveWK/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2018-02-20T14:30:25Z",
  "updated_at": "2018-06-01T13:41:22Z",
  "closed_at": "2018-06-01T13:41:21Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "\r\n#### System information\r\n\r\nGeth version: 1.8.0\r\nOS & Version: Linux (RHEL variant)\r\n\r\n#### Expected behaviour\r\n\r\nGeth should attempt to get more peers if it drops all the peers. \r\n\r\n#### Actual behaviour\r\n\r\nWill eventually state  \r\n`Synchronisation failed, dropping peer peer=xxxxx err=\"retrieved hash chain is invalid\"`\r\nfor each peer at some point and evict every peer from it's loop. It then will spin with  \"Regenerated local transaction journal transactions=0 accounts=0\" and not have any peers, leaving blockchain stuck at whatever value.\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\nLeave a node on for a couple days in AWS and it will enter this state. Can be fixed by restarting node, but the logic should be smart enough to start adding new peers and refresh blacklist if it gets down to 0 peers.",
  "closed_by": {
    "login": "DaveWK",
    "id": 13626476,
    "node_id": "MDQ6VXNlcjEzNjI2NDc2",
    "avatar_url": "https://avatars.githubusercontent.com/u/13626476?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/DaveWK",
    "html_url": "https://github.com/DaveWK",
    "followers_url": "https://api.github.com/users/DaveWK/followers",
    "following_url": "https://api.github.com/users/DaveWK/following{/other_user}",
    "gists_url": "https://api.github.com/users/DaveWK/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/DaveWK/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/DaveWK/subscriptions",
    "organizations_url": "https://api.github.com/users/DaveWK/orgs",
    "repos_url": "https://api.github.com/users/DaveWK/repos",
    "events_url": "https://api.github.com/users/DaveWK/events{/privacy}",
    "received_events_url": "https://api.github.com/users/DaveWK/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16145/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16145/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/367246290",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16145#issuecomment-367246290",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16145",
    "id": 367246290,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NzI0NjI5MA==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-21T08:17:22Z",
    "updated_at": "2018-02-21T08:17:22Z",
    "author_association": "MEMBER",
    "body": "That's an odd one. It most definitely should not do that. If it happens again, could you do a `debug.vmodule(\"downloader=5\")` let it run for a while and then copy paste the logs here?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/367246290/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/383277679",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16145#issuecomment-383277679",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16145",
    "id": 383277679,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MzI3NzY3OQ==",
    "user": {
      "login": "upers",
      "id": 12727242,
      "node_id": "MDQ6VXNlcjEyNzI3MjQy",
      "avatar_url": "https://avatars.githubusercontent.com/u/12727242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/upers",
      "html_url": "https://github.com/upers",
      "followers_url": "https://api.github.com/users/upers/followers",
      "following_url": "https://api.github.com/users/upers/following{/other_user}",
      "gists_url": "https://api.github.com/users/upers/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/upers/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/upers/subscriptions",
      "organizations_url": "https://api.github.com/users/upers/orgs",
      "repos_url": "https://api.github.com/users/upers/repos",
      "events_url": "https://api.github.com/users/upers/events{/privacy}",
      "received_events_url": "https://api.github.com/users/upers/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-21T08:27:11Z",
    "updated_at": "2018-04-21T08:27:11Z",
    "author_association": "NONE",
    "body": "Geth version: 1.8.4\r\nOS: Ubuntu 16.04\r\nI have the same problems. Only after reboot node start sync.\r\nLogs:\r\nSynchronisation failed, dropping peer    peer=c75bbe644a9e4908 err=timeout\r\nSynchronisation failed, dropping peer    peer=c718dac93fc9db1b err=timeout\r\nSynchronisation failed, retrying         err=\"block header download canceled (requested)\"\r\nSynchronisation failed, retrying         err=\"block download canceled (requested)\"\r\n[04-21|05:39:36] Synchronisation failed, retrying         err=\"block header download canceled (requested)\"\r\nFailed to unregister sync peer           peer=1c551df83c9ec5e5 err=\"peer is not registered\"\r\nImported new chain segment               blocks=1  txs=190  mgas=7.977   elapsed=4.830s    mgasps=1.651   number=5478302 hash=f4ce5câ€¦366\r\nRegenerated local transaction journal    transactions=0 accounts=0\r\nRegenerated local transaction journal    transactions=0 accounts=0\r\nRegenerated local transaction journal    transactions=0 accounts=0\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/383277679/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/393884138",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16145#issuecomment-393884138",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16145",
    "id": 393884138,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5Mzg4NDEzOA==",
    "user": {
      "login": "DaveWK",
      "id": 13626476,
      "node_id": "MDQ6VXNlcjEzNjI2NDc2",
      "avatar_url": "https://avatars.githubusercontent.com/u/13626476?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DaveWK",
      "html_url": "https://github.com/DaveWK",
      "followers_url": "https://api.github.com/users/DaveWK/followers",
      "following_url": "https://api.github.com/users/DaveWK/following{/other_user}",
      "gists_url": "https://api.github.com/users/DaveWK/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DaveWK/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DaveWK/subscriptions",
      "organizations_url": "https://api.github.com/users/DaveWK/orgs",
      "repos_url": "https://api.github.com/users/DaveWK/repos",
      "events_url": "https://api.github.com/users/DaveWK/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DaveWK/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-01T13:41:21Z",
    "updated_at": "2018-06-01T13:41:21Z",
    "author_association": "NONE",
    "body": "Closing; this seems to have been fixed sometime before 1.8.8",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/393884138/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
