{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16781",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16781/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16781/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16781/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/16781",
  "id": 325266188,
  "node_id": "MDU6SXNzdWUzMjUyNjYxODg=",
  "number": 16781,
  "title": "admin.addPeer does not work",
  "user": {
    "login": "SvenMeyer",
    "id": 25609,
    "node_id": "MDQ6VXNlcjI1NjA5",
    "avatar_url": "https://avatars.githubusercontent.com/u/25609?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/SvenMeyer",
    "html_url": "https://github.com/SvenMeyer",
    "followers_url": "https://api.github.com/users/SvenMeyer/followers",
    "following_url": "https://api.github.com/users/SvenMeyer/following{/other_user}",
    "gists_url": "https://api.github.com/users/SvenMeyer/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/SvenMeyer/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/SvenMeyer/subscriptions",
    "organizations_url": "https://api.github.com/users/SvenMeyer/orgs",
    "repos_url": "https://api.github.com/users/SvenMeyer/repos",
    "events_url": "https://api.github.com/users/SvenMeyer/events{/privacy}",
    "received_events_url": "https://api.github.com/users/SvenMeyer/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2018-05-22T12:12:29Z",
  "updated_at": "2018-06-07T15:07:58Z",
  "closed_at": "2018-05-29T03:26:14Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: `1.8.8-stable`\r\nOS : Linux Mint 18.3\r\nGit Commit: 2688dab48c9b8ae71b8d95c7678817eaa17f2b53\r\nArchitecture: amd64\r\nProtocol Versions: [63 62]\r\nNetwork Id: 1\r\nGo Version: go1.10\r\nOperating System: linux\r\nGOPATH=\r\nGOROOT=/usr/lib/go-1.10\r\n\r\nNetwork : `mainnet`\r\n\r\n#### Expected behaviour\r\n`admin.addPeer` should add the specifies peer which should show up in `admin.peers`\r\n\r\n#### Actual behaviour\r\nadded peer does not show up\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\nI have a full node (which has not yet fully synced) , also Version: 1.8.8-stable , but on Lubuntu 18.04 running on 192.168.1.110\r\n\r\nI started a 2nd node (Geth version: `1.8.8-stable` , OS : Linux Mint 18.3) specifying the first node as a boot node. Looks like as if this worked ...\r\n\r\n```\r\n$ geth --syncmode \"fast\" --bootnodesv4 \"enode://81b95b9bc444563d3defb4cf3b1e66308d8ce9f2e072562325f596c82a03f1d349e57dfe93736afacac4428fe9b55b8a3ce6b9b19a1ec70d34aab21931d31178@192.168.1.110:30303\"\r\nINFO [05-22|20:50:16] Maximum peer count                       ETH=25 LES=0 total=25\r\nINFO [05-22|20:50:16] Starting peer-to-peer node               instance=Geth/v1.8.8-stable-2688dab4/linux-amd64/go1.10\r\nINFO [05-22|20:50:16] Allocated cache and file handles         database=/home/sum/.ethereum/geth/chaindata cache=768 handles=512\r\nINFO [05-22|20:50:16] Writing default main-net genesis block \r\nINFO [05-22|20:50:22] Persisted trie from memory database      nodes=12356 size=2.34mB time=574.057327ms gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B\r\nINFO [05-22|20:50:22] Initialised chain configuration          config=\"{ChainID: 1 Homestead: 1150000 DAO: 1920000 DAOSupport: true EIP150: 2463000 EIP155: 2675000 EIP158: 2675000 Byzantium: 4370000 Constantinople: <nil> Engine: ethash}\"\r\nINFO [05-22|20:50:22] Disk storage enabled for ethash caches   dir=/home/sum/.ethereum/geth/ethash count=3\r\nINFO [05-22|20:50:22] Disk storage enabled for ethash DAGs     dir=/home/sum/.ethash               count=2\r\nINFO [05-22|20:50:22] Initialising Ethereum protocol           versions=\"[63 62]\" network=1\r\nINFO [05-22|20:50:22] Loaded most recent local header          number=0 hash=d4e567…cb8fa3 td=17179869184\r\nINFO [05-22|20:50:22] Loaded most recent local full block      number=0 hash=d4e567…cb8fa3 td=17179869184\r\nINFO [05-22|20:50:22] Loaded most recent local fast block      number=0 hash=d4e567…cb8fa3 td=17179869184\r\nINFO [05-22|20:50:22] Loaded local transaction journal         transactions=0 dropped=0\r\nINFO [05-22|20:50:22] Regenerated local transaction journal    transactions=0 accounts=0\r\nINFO [05-22|20:50:22] Starting P2P networking \r\nINFO [05-22|20:50:24] UDP listener up                          self=enode://81b95b9bc444563d3defb4cf3b1e66308d8ce9f2e072562325f596c82a03f1d349e57dfe93736afacac4428fe9b55b8a3ce6b9b19a1ec70d34aab21931d31178@[::]:30303\r\nINFO [05-22|20:50:24] RLPx listener up                         self=enode://81b95b9bc444563d3defb4cf3b1e66308d8ce9f2e072562325f596c82a03f1d349e57dfe93736afacac4428fe9b55b8a3ce6b9b19a1ec70d34aab21931d31178@[::]:30303\r\nINFO [05-22|20:50:24] IPC endpoint opened                      url=/home/sum/.ethereum/geth.ipc\r\nINFO [05-22|20:50:44] Block synchronisation started \r\nWARN [05-22|20:50:46] Node data write error                    err=\"state node 210462…31a821 failed with all peers (1 tries, 1 peers)\"\r\nWARN [05-22|20:50:46] Synchronisation failed, retrying         err=\"state node 210462…31a821 failed with all peers (1 tries, 1 peers)\"\r\nWARN [05-22|20:51:01] Synchronisation failed, retrying         err=\"block download canceled (requested)\"\r\nINFO [05-22|20:51:10] Generating ethash verification cache     epoch=0 percentage=28 elapsed=3.002s\r\nINFO [05-22|20:51:10] Imported new state entries               count=1350 elapsed=1.135ms processed=1350 pending=15532 retry=2 duplicate=0 unexpected=0\r\nINFO [05-22|20:51:13] Imported new state entries               count=1152 elapsed=12.500ms processed=2502 pending=14745 retry=2 duplicate=0 unexpected=0\r\nINFO [05-22|20:51:13] Generating ethash verification cache     epoch=0 percentage=52 elapsed=6.003s\r\nINFO [05-22|20:51:16] Generating ethash verification cache     epoch=0 percentage=74 elapsed=9.003s\r\nINFO [05-22|20:51:16] Imported new state entries               count=1178 elapsed=28.098ms processed=3680 pending=14691 retry=0 duplicate=0 unexpected=0\r\nINFO [05-22|20:51:18] Generated ethash verification cache      epoch=0 elapsed=11.378s\r\nINFO [05-22|20:51:18] Imported new block headers               count=576  elapsed=11.792s  number=576 hash=41a746…6a8b38 ignored=0\r\nINFO [05-22|20:51:18] Imported new block receipts              count=2    elapsed=1.318ms  number=2   hash=b495a1…4698c9 size=8.00B  ignored=0\r\nINFO [05-22|20:51:19] Imported new state entries               count=1152 elapsed=12.076ms processed=4832 pending=14123 retry=2 duplicate=0 unexpected=0\r\nINFO [05-22|20:51:21] Generating ethash verification cache     epoch=1 percentage=33 elapsed=3.014s\r\nINFO [05-22|20:51:22] Imported new state entries               count=1239 elapsed=9.987ms  processed=6071 pending=14069 retry=2 duplicate=0 unexpected=0\r\nINFO [05-22|20:51:24] Generating ethash verification cache     epoch=1 percentage=65 elapsed=6.014s\r\nINFO [05-22|20:51:24] Imported new state entries               count=1152 elapsed=12.482ms processed=7223 pending=14561 retry=0 duplicate=0 unexpected=0\r\nINFO [05-22|20:51:24] Imported new block receipts              count=574  elapsed=29.499ms number=576 hash=41a746…6a8b38 size=90.42kB ignored=0\r\nINFO [05-22|20:51:26] Imported new state entries               count=1152 elapsed=15.405ms processed=8375 pending=13383 retry=2 duplicate=0 unexpected=0\r\nINFO [05-22|20:51:27] Generating ethash verification cache     epoch=1 percentage=96 elapsed=9.015s\r\nINFO [05-22|20:51:28] Generated ethash verification cache      epoch=1 elapsed=9.544s\r\nINFO [05-22|20:51:28] Imported new state entries               count=1152 elapsed=10.926ms processed=9527 pending=13395 retry=0 duplicate=0 unexpected=0\r\nINFO [05-22|20:51:30] Imported new state entries               count=1251 elapsed=27.375ms processed=10778 pending=12723 retry=0 duplicate=0 unexpected=0\r\nINFO [05-22|20:51:32] Imported new state entries               count=1152 elapsed=13.817ms processed=11930 pending=13179 retry=2 duplicate=0 unexpected=0\r\nINFO [05-22|20:51:34] Imported new state entries               count=1234 elapsed=11.728ms processed=13164 pending=12299 retry=2 duplicate=0 unexpected=0\r\nINFO [05-22|20:51:36] Imported new state entries               count=1259 elapsed=9.926ms  processed=14423 pending=12337 retry=0 duplicate=0 unexpected=0\r\n```\r\n\r\nI attached with another geth, listed the list of nodes, but it did not include the boot node.\r\nI added the first (boot) node, got true as a result, but it does not show up in the list:\r\n\r\n```\r\n> admin.addPeer(\"enode://81b95b9bc444563d3defb4cf3b1e66308d8ce9f2e072562325f596c82a03f1d349e57dfe93736afacac4428fe9b55b8a3ce6b9b19a1ec70d34aab21931d31178@192.168.1.110:30303\")\r\ntrue\r\n\r\n> admin.peers.forEach(function(value){console.log(value.network.remoteAddress+\"\\t\"+value.name)})\r\n35.198.162.222:30303\tGeth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9\r\n47.105.42.115:30303\tGeth/v1.8.2-stable-b8b9f7f4/linux-amd64/go1.9.4\r\n111.231.57.95:30303\tGeth/v1.8.3-stable/linux-amd64/go1.10.2\r\n47.90.56.177:30303\tGeth/v1.5.5-stable-ff07d548/linux/go1.7.3\r\n18.196.93.171:30303\tGeth/v1.8.2-stable-b8b9f7f4/linux-amd64/go1.9.4\r\n51.15.203.238:30303\tGeth/v1.8.6-stable-12683fec/linux-amd64/go1.10\r\n```\r\n\r\n",
  "closed_by": {
    "login": "SvenMeyer",
    "id": 25609,
    "node_id": "MDQ6VXNlcjI1NjA5",
    "avatar_url": "https://avatars.githubusercontent.com/u/25609?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/SvenMeyer",
    "html_url": "https://github.com/SvenMeyer",
    "followers_url": "https://api.github.com/users/SvenMeyer/followers",
    "following_url": "https://api.github.com/users/SvenMeyer/following{/other_user}",
    "gists_url": "https://api.github.com/users/SvenMeyer/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/SvenMeyer/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/SvenMeyer/subscriptions",
    "organizations_url": "https://api.github.com/users/SvenMeyer/orgs",
    "repos_url": "https://api.github.com/users/SvenMeyer/repos",
    "events_url": "https://api.github.com/users/SvenMeyer/events{/privacy}",
    "received_events_url": "https://api.github.com/users/SvenMeyer/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16781/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16781/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/391209456",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16781#issuecomment-391209456",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16781",
    "id": 391209456,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MTIwOTQ1Ng==",
    "user": {
      "login": "wcw84",
      "id": 7152596,
      "node_id": "MDQ6VXNlcjcxNTI1OTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7152596?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wcw84",
      "html_url": "https://github.com/wcw84",
      "followers_url": "https://api.github.com/users/wcw84/followers",
      "following_url": "https://api.github.com/users/wcw84/following{/other_user}",
      "gists_url": "https://api.github.com/users/wcw84/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wcw84/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wcw84/subscriptions",
      "organizations_url": "https://api.github.com/users/wcw84/orgs",
      "repos_url": "https://api.github.com/users/wcw84/repos",
      "events_url": "https://api.github.com/users/wcw84/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wcw84/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-23T03:32:12Z",
    "updated_at": "2018-05-23T03:32:12Z",
    "author_association": "NONE",
    "body": "I have the same problem, it seems that It does not mean the peer is connected after you get \"true\" from \"admin.addPeer\". The geth may connect the peer after a while.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/391209456/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/391243520",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16781#issuecomment-391243520",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16781",
    "id": 391243520,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MTI0MzUyMA==",
    "user": {
      "login": "SvenMeyer",
      "id": 25609,
      "node_id": "MDQ6VXNlcjI1NjA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/25609?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SvenMeyer",
      "html_url": "https://github.com/SvenMeyer",
      "followers_url": "https://api.github.com/users/SvenMeyer/followers",
      "following_url": "https://api.github.com/users/SvenMeyer/following{/other_user}",
      "gists_url": "https://api.github.com/users/SvenMeyer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SvenMeyer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SvenMeyer/subscriptions",
      "organizations_url": "https://api.github.com/users/SvenMeyer/orgs",
      "repos_url": "https://api.github.com/users/SvenMeyer/repos",
      "events_url": "https://api.github.com/users/SvenMeyer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SvenMeyer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-23T07:08:33Z",
    "updated_at": "2018-05-23T07:08:33Z",
    "author_association": "NONE",
    "body": "The other node in my local network hasn't been added even a few hours later and even then the question would be if they found themselves or if it was actually a very late action based on my admin.addPeer command.\r\nActually I could not check 19h later, as the geth node crashed in the meantime. See #16785",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/391243520/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/392642641",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16781#issuecomment-392642641",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16781",
    "id": 392642641,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MjY0MjY0MQ==",
    "user": {
      "login": "SvenMeyer",
      "id": 25609,
      "node_id": "MDQ6VXNlcjI1NjA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/25609?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SvenMeyer",
      "html_url": "https://github.com/SvenMeyer",
      "followers_url": "https://api.github.com/users/SvenMeyer/followers",
      "following_url": "https://api.github.com/users/SvenMeyer/following{/other_user}",
      "gists_url": "https://api.github.com/users/SvenMeyer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SvenMeyer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SvenMeyer/subscriptions",
      "organizations_url": "https://api.github.com/users/SvenMeyer/orgs",
      "repos_url": "https://api.github.com/users/SvenMeyer/repos",
      "events_url": "https://api.github.com/users/SvenMeyer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SvenMeyer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-29T03:26:14Z",
    "updated_at": "2018-05-29T03:30:41Z",
    "author_association": "NONE",
    "body": "I upgraded both my local nodes from geth 1.8.8 to geth 1.8.9 and that seem to have solved the problem!\r\nI have to admit that now I can not tell if the problem was on the initiating node or the other one.\r\n```\r\n> admin.peers.forEach(function(value){console.log(value.network.remoteAddress+\"\\t\"+value.network.localAddress+\"\\t\"+value.name)})\r\n78.84.3.49:30303\t192.168.1.202:39218\tGeth/v1.8.8-stable-2688dab4/windows-amd64/go1.10.1\r\n35.205.225.38:30303\t192.168.1.202:58634\tGeth/v1.8.5/linux-amd64/go1.10.2\r\nundefined\r\n> admin.addPeer(\"enode://81b95b9bc444563d3defb4cf3b1e66308d8ce9f2e072562325f596c82a03f1d349e57dfe93736afacac4428fe9b55b8a3ce6b9b19a1ec70d34aab21931d31178@192.168.1.201:30303\")\r\ntrue\r\n> admin.peers.forEach(function(value){console.log(value.network.remoteAddress+\"\\t\"+value.network.localAddress+\"\\t\"+value.name)})\r\n78.84.3.49:30303\t192.168.1.202:39218\tGeth/v1.8.8-stable-2688dab4/windows-amd64/go1.10.1\r\n193.164.131.66:30303\t192.168.1.202:42184\tGeth/v1.8.7-stable-66432f38/linux-amd64/go1.10.1\r\n192.168.1.201:30303\t192.168.1.202:51400\tGeth/v1.8.9-stable-ff9b1461/linux-amd64/go1.10.1\r\n119.23.15.87:30303\t192.168.1.202:53304\tGeth/v1.8.3-stable-329ac18e/linux-amd64/go1.10\r\n```\r\nMy other local node at 192.168.1.201:30303 is now within the node list ... and vice versa.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/392642641/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
