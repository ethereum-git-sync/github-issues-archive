{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16372",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16372/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16372/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16372/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/16372",
  "id": 307743154,
  "node_id": "MDU6SXNzdWUzMDc3NDMxNTQ=",
  "number": 16372,
  "title": "Rootkits can infect kernel RNG and cause attacker previsibility in key generation?",
  "user": {
    "login": "3esmit",
    "id": 224810,
    "node_id": "MDQ6VXNlcjIyNDgxMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/3esmit",
    "html_url": "https://github.com/3esmit",
    "followers_url": "https://api.github.com/users/3esmit/followers",
    "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
    "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
    "organizations_url": "https://api.github.com/users/3esmit/orgs",
    "repos_url": "https://api.github.com/users/3esmit/repos",
    "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
    "received_events_url": "https://api.github.com/users/3esmit/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 856638432,
      "node_id": "MDU6TGFiZWw4NTY2Mzg0MzI=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/status:inactive",
      "name": "status:inactive",
      "color": "ffffff",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2018-03-22T17:30:03Z",
  "updated_at": "2019-05-04T22:31:54Z",
  "closed_at": "2019-05-04T22:31:54Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I am researching regarding security of key generation, while I imagine geth use a safe random generation source as kernel RNG.\r\n\r\nI figured out that this is an point of rootkit attack, where could replace the RNG with predicatable values. \r\nThis attack is not only high impact but also \"invisible\". To attack the affected accounts the attacker dont need to connect with victim computers, it can just run the tampered-RNG itself and figure out the keys.\r\nEven computers airgapped, if infected with a tampered-RGN, will generate previsible RNG. \r\n\r\nKernel RNG is suppoused to have a buffer of entropy based on sensors inputs, but geth might not notice that it had been tampered.\r\n\r\nA way to mitigate this would be geth accepting an application seed at key generation, and mix with the kernel RNG, meaning that both sources need to be tampered to predict RNG.",
  "closed_by": {
    "login": "stale[bot]",
    "id": 26384082,
    "node_id": "MDM6Qm90MjYzODQwODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/stale%5Bbot%5D",
    "html_url": "https://github.com/apps/stale",
    "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16372/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16372/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/375399171",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16372#issuecomment-375399171",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16372",
    "id": 375399171,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTM5OTE3MQ==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-22T17:50:33Z",
    "updated_at": "2018-03-22T17:51:55Z",
    "author_association": "NONE",
    "body": "Keys generated in servers and virtual envoirements are really random?\r\n\r\nSo in example of an exchange that generates keys in their server for user depositing funds might not be so random, because the kernel RNG relay on sensors that are usually not available in servers. \r\nHow they would create non predictable keys in their servers?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/375399171/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/375442309",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16372#issuecomment-375442309",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16372",
    "id": 375442309,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTQ0MjMwOQ==",
    "user": {
      "login": "ligi",
      "id": 111600,
      "node_id": "MDQ6VXNlcjExMTYwMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/111600?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ligi",
      "html_url": "https://github.com/ligi",
      "followers_url": "https://api.github.com/users/ligi/followers",
      "following_url": "https://api.github.com/users/ligi/following{/other_user}",
      "gists_url": "https://api.github.com/users/ligi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ligi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ligi/subscriptions",
      "organizations_url": "https://api.github.com/users/ligi/orgs",
      "repos_url": "https://api.github.com/users/ligi/repos",
      "events_url": "https://api.github.com/users/ligi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ligi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-22T20:14:35Z",
    "updated_at": "2018-03-22T20:14:35Z",
    "author_association": "MEMBER",
    "body": "I think this issue is not really go-ethereum specific but more a general thought on security that perhaps should be discussed in another place and not this issue tracker for a specific implementation. \r\nGenerating keys on servers sounds like a bad idea IMHO anyway. Thought getting rid of servers like this was the plan ..-)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/375442309/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/375458215",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16372#issuecomment-375458215",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16372",
    "id": 375458215,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTQ1ODIxNQ==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-22T21:08:48Z",
    "updated_at": "2018-03-22T21:08:48Z",
    "author_association": "NONE",
    "body": "@ligi Agreed that we are trying to remove servers, I'm totally about it, however some services still use this practice (exchanges), and this should be pointed out if they already don't know.\r\n\r\nBut in case of personal computers, geth should suggest to also use another source of entropy (such as a random drawing in the screen). I imagine a scenario where a hardware company, such smart phone or laptop company, start using some tampered kernel in the o.s. and their users arent aware of it, and get invisibly attacked. \r\n\r\nFor sure a targeted rootkit could also affect application layer, but solely tampering RNG right now would affect all application relaying sole on it. \r\nIf geth suggest the use of application defined entropy + internal (kernel) entropy than a rootkit would have to target specifically the application. \r\nThis geth suggestion also make clearer that RNG dont work well on server/virtual env. \r\nIf not suggested, at least should be documented somewhere.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/375458215/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/375461011",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16372#issuecomment-375461011",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16372",
    "id": 375461011,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTQ2MTAxMQ==",
    "user": {
      "login": "ligi",
      "id": 111600,
      "node_id": "MDQ6VXNlcjExMTYwMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/111600?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ligi",
      "html_url": "https://github.com/ligi",
      "followers_url": "https://api.github.com/users/ligi/followers",
      "following_url": "https://api.github.com/users/ligi/following{/other_user}",
      "gists_url": "https://api.github.com/users/ligi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ligi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ligi/subscriptions",
      "organizations_url": "https://api.github.com/users/ligi/orgs",
      "repos_url": "https://api.github.com/users/ligi/repos",
      "events_url": "https://api.github.com/users/ligi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ligi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-22T21:19:27Z",
    "updated_at": "2018-03-22T21:19:27Z",
    "author_association": "MEMBER",
    "body": "> @ligi Agreed that we are trying to remove servers, I'm totally about it, however some services still use this practice (exchanges)\r\n\r\nIMHO we should not use these services and push the movement towards decentralized exchanges.\r\n\r\n> But in case of personal computers, geth should suggest to also use another source of entropy (such as a random drawing in the screen). \r\n\r\nI do not think this is responsibility of go-etherum. This is already done by operating systems like the linux kernel entropy pool. I think this is a good place to do it and better separation of concerns than doing it in go-ethereum. I do not see the security benefit in doing it also in the application layer.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/375461011/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/475906468",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16372#issuecomment-475906468",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16372",
    "id": 475906468,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTkwNjQ2OA==",
    "user": {
      "login": "stale[bot]",
      "id": 26384082,
      "node_id": "MDM6Qm90MjYzODQwODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stale%5Bbot%5D",
      "html_url": "https://github.com/apps/stale",
      "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2019-03-23T21:32:24Z",
    "updated_at": "2019-03-23T21:32:24Z",
    "author_association": "NONE",
    "body": "This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you for your contributions.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/475906468/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
