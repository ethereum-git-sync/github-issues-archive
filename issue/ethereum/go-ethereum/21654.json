{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21654",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21654/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21654/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21654/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/21654",
  "id": 713934085,
  "node_id": "MDU6SXNzdWU3MTM5MzQwODU=",
  "number": 21654,
  "title": "Clique POA keeps changing coinbase / miner account and stops working due to unknown node connection",
  "user": {
    "login": "Ronak-59",
    "id": 8841124,
    "node_id": "MDQ6VXNlcjg4NDExMjQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8841124?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Ronak-59",
    "html_url": "https://github.com/Ronak-59",
    "followers_url": "https://api.github.com/users/Ronak-59/followers",
    "following_url": "https://api.github.com/users/Ronak-59/following{/other_user}",
    "gists_url": "https://api.github.com/users/Ronak-59/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Ronak-59/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Ronak-59/subscriptions",
    "organizations_url": "https://api.github.com/users/Ronak-59/orgs",
    "repos_url": "https://api.github.com/users/Ronak-59/repos",
    "events_url": "https://api.github.com/users/Ronak-59/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Ronak-59/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2020-10-02T22:28:34Z",
  "updated_at": "2020-10-02T23:03:08Z",
  "closed_at": "2020-10-02T23:03:08Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: 1.9.19-stable-3e064192\r\nOS & Version: Linux -  Ubuntu 18.04.5 LTS\r\n\r\nI have set up a Geth POA network of 2 nodes on different cloud instances. Network was running good for 2 months but now suddenly it's getting connections from unknown peers and mining stops working.\r\n\r\nGeth Command:\r\n\r\n`geth --datadir ethdata/ --syncmode 'full' --port 30312 --rpc --rpcaddr '0.0.0.0' --rpcport 8545 --rpccorsdomain '<URL1>,<URL2>' --rpcapi 'personal,db,eth,net,web3,txpool,miner,admin' --ws --wsport 8546 --wsapi 'eth,net,web3' --wsorigins '<URL1>' --networkid <NETWORKID> --gasprice '1' --unlock <ACCOUNT1> --password pass.txt --mine --etherbase <ACCOUNT1> --allow-insecure-unlock --nat extip:<NODEIP> --nodiscover --netrestrict <NODE2IP>/32`\r\n\r\nError Logs:\r\n\r\n```\r\n0|ethNode1  | INFO [10-02|21:10:19.001] ðŸ”¨ mined potential block                  number=394283 hash=\"2ef239â€¦81cd72\"\r\n0|ethNode1  | INFO [10-02|21:10:19.002] Commit new mining work                   number=394284 sealhash=\"3377daâ€¦5031cd\" uncles=0 txs=0 gas=0 fees=0 elapsed=\"318.567Âµs\"\r\n0|ethNode1  | INFO [10-02|21:10:19.002] Signed recently, must wait for others\r\n0|ethNode1  | INFO [10-02|21:10:29.002] Imported new chain segment               blocks=1 txs=0 mgas=0.000 elapsed=\"442.732Âµs\" mgasps=0.000 number=394284 hash=\"0612d1â€¦139ef9\" dirty=0.00B\r\n0|ethNode1  | INFO [10-02|21:10:29.003] ðŸ”— block reached canonical chain          number=394277 hash=\"825454â€¦683852\"\r\n0|ethNode1  | INFO [10-02|21:10:29.003] Commit new mining work                   number=394285 sealhash=\"f90c28â€¦da2cd8\" uncles=0 txs=0 gas=0 fees=0 elapsed=\"268.822Âµs\"\r\n0|ethNode1  | INFO [10-02|21:10:39.000] Successfully sealed new block            number=394285 sealhash=\"f90c28â€¦da2cd8\" hash=\"7f408câ€¦1fe2df\" elapsed=9.997s\r\n0|ethNode1  | INFO [10-02|21:10:39.001] Signed recently, must wait for others\r\n0|ethNode1  | INFO [10-02|21:10:39.000] ðŸ”¨ mined potential block                  number=394285 hash=\"7f408câ€¦1fe2df\"\r\n0|ethNode1  | INFO [10-02|21:10:39.002] Commit new mining work                   number=394286 sealhash=\"190914â€¦a34e63\" uncles=0 txs=0 gas=0 fees=0 elapsed=1.583ms\r\n0|ethNode1  | INFO [10-02|21:10:43.852] Transaction pool price threshold updated price=1\r\n0|ethNode1  | ERROR[10-02|21:10:43.854] Etherbase account unavailable locally    err=\"unknown account\"\r\n0|ethNode1  | WARN [10-02|21:10:43.854] Served miner_start                       conn=217.227.191.41:61800 reqid=1643 t=2.034872ms err=\"signer missing: unknown account\"\r\n0|ethNode1  | WARN [10-02|21:10:44.863] Gas estimation capped by limited funds   original=8000000 balance=98712 sent=78962 gasprice=1 fundable=19750\r\n0|ethNode1  | WARN [10-02|21:10:44.864] Served eth_sendTransaction               conn=217.227.191.41:61805 reqid=1125 t=3.726913ms err=\"gas required exceeds allowance (19750)\"\r\n0|ethNode1  | WARN [10-02|21:10:45.755] Served eth_sendTransaction               conn=217.227.191.41:61807 reqid=831  t=4.255632ms err=\"authentication needed: password or unlock\"\r\n0|ethNode1  | INFO [10-02|21:10:49.002] Imported new chain segment               blocks=1 txs=0 mgas=0.000 elapsed=\"301.13Âµs\"  mgasps=0.000 number=394286 hash=\"5ae579â€¦8ae413\" dirty=0.00B\r\n0|ethNode1  | INFO [10-02|21:10:54.250] Deep froze chain segment                 blocks=6 elapsed=7.777ms     number=304285 hash=\"2951e1â€¦0aa545\"\r\n```\r\n\r\nConnection from IP Address \"217.227.191.41\" seems to be from an unknown node. I've set --nodiscover as well as --netrestrict. Also blocked the IP address from Firewall using command:\r\n\r\n`ufw deny from 217.227.191.41 to any`\r\n\r\nBut still, the issue keeps happening and when I reload geth command, it works for a minute but same issue happens again. I'm also blocking RPC access as you can see in the GETH command. How do I prevent incoming connection that changes my miner account?",
  "closed_by": {
    "login": "Ronak-59",
    "id": 8841124,
    "node_id": "MDQ6VXNlcjg4NDExMjQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8841124?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Ronak-59",
    "html_url": "https://github.com/Ronak-59",
    "followers_url": "https://api.github.com/users/Ronak-59/followers",
    "following_url": "https://api.github.com/users/Ronak-59/following{/other_user}",
    "gists_url": "https://api.github.com/users/Ronak-59/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Ronak-59/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Ronak-59/subscriptions",
    "organizations_url": "https://api.github.com/users/Ronak-59/orgs",
    "repos_url": "https://api.github.com/users/Ronak-59/repos",
    "events_url": "https://api.github.com/users/Ronak-59/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Ronak-59/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21654/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21654/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/702992939",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21654#issuecomment-702992939",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21654",
    "id": 702992939,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMjk5MjkzOQ==",
    "user": {
      "login": "Ronak-59",
      "id": 8841124,
      "node_id": "MDQ6VXNlcjg4NDExMjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8841124?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Ronak-59",
      "html_url": "https://github.com/Ronak-59",
      "followers_url": "https://api.github.com/users/Ronak-59/followers",
      "following_url": "https://api.github.com/users/Ronak-59/following{/other_user}",
      "gists_url": "https://api.github.com/users/Ronak-59/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Ronak-59/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Ronak-59/subscriptions",
      "organizations_url": "https://api.github.com/users/Ronak-59/orgs",
      "repos_url": "https://api.github.com/users/Ronak-59/repos",
      "events_url": "https://api.github.com/users/Ronak-59/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Ronak-59/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-02T23:03:08Z",
    "updated_at": "2020-10-02T23:03:08Z",
    "author_association": "NONE",
    "body": "It turns out that I had exposed miner RPC API which was being used by a bot to reset etherBase account as suggested by @Semisol here: https://ethereum.stackexchange.com/a/88006/50064 \r\n\r\nIt fixed my issue so I'm closing this issue here. Thanks @Semisol for helping out quickly!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/702992939/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
