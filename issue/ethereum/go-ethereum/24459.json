{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24459",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24459/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24459/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24459/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/24459",
  "id": 1147570224,
  "node_id": "I_kwDOAOvK985EZogw",
  "number": 24459,
  "title": "gas required exceeds allowance (8000000)",
  "user": {
    "login": "msak222",
    "id": 19371846,
    "node_id": "MDQ6VXNlcjE5MzcxODQ2",
    "avatar_url": "https://avatars.githubusercontent.com/u/19371846?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/msak222",
    "html_url": "https://github.com/msak222",
    "followers_url": "https://api.github.com/users/msak222/followers",
    "following_url": "https://api.github.com/users/msak222/following{/other_user}",
    "gists_url": "https://api.github.com/users/msak222/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/msak222/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/msak222/subscriptions",
    "organizations_url": "https://api.github.com/users/msak222/orgs",
    "repos_url": "https://api.github.com/users/msak222/repos",
    "events_url": "https://api.github.com/users/msak222/events{/privacy}",
    "received_events_url": "https://api.github.com/users/msak222/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 268304226,
      "node_id": "MDU6TGFiZWwyNjgzMDQyMjY=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:docs",
      "name": "type:docs",
      "color": "fef2c0",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-02-23T02:43:34Z",
  "updated_at": "2022-02-24T09:17:56Z",
  "closed_at": "2022-02-24T09:17:56Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "My smart contract runs normally on local ganache and the public test network, but in the private chain built by myself, it always prompts gas required exceeds allowance (8000000).I can not find the solution to solve the problem at all.help me\r\n\r\nSource code:\r\n\r\n```\r\nIERC20 diamond;\r\n\r\nfunction upgradePre(\r\n        uint256 recordNo,\r\n        uint256 tokenType,\r\n        uint256 tokenId,\r\n        uint256 expireTime,\r\n        uint256 diamondquantity\r\n    ) public payable {\r\n        //is it timed out\r\n        require(expireTime >= block.timestamp, \"request expired\");\r\n        //Check for duplicate submissions\r\n        require(!orders[recordNo].isCompletePre, \"repeat transaction\");\r\n        //Ownership of the token\r\n        require(\r\n            msg.sender == _getOwnerByTokenIdAndTokenType(tokenId, tokenType),\r\n            \"owner exception\"\r\n        );\r\n        //token's current level\r\n        uint256 currentLevel = _getLevelByTokenIdAndTokenType(\r\n            tokenId,\r\n            tokenType\r\n        );\r\n\r\n        UpgradeConfItem memory upgradeConfItem = _getUpradeConf(tokenId, tokenType, currentLevel + 1);\r\n        //start transfer\r\n        require(upgradeConfItem.diamondquantity > 0 && diamondquantity >= upgradeConfItem.diamondquantity, \"diamondquantity too small\");\r\n        require(\r\n            diamond.balanceOf(msg.sender) >= diamondquantity,\r\n            \"Insufficient balance\"\r\n        );\r\n        require(\r\n            (diamond.allowance(msg.sender, address(this)) >= (diamondquantity)),\r\n            \"0xSUB: Allowance required\"\r\n        );\r\n        require(\r\n            diamond.transferFrom(msg.sender, receiveAddress, diamondquantity),\r\n            \"payment failed\"\r\n        );\r\n\r\n        //init upgrade order\r\n        _initUpgradeOrder(recordNo, tokenId, tokenType, currentLevel);\r\n        //request random number\r\n        logService.requestRandomNum(1, recordNo);\r\n        //print biz log\r\n        _logUpgradePre(\r\n            recordNo,\r\n            tokenId,\r\n            tokenType,\r\n            diamondquantity,\r\n            currentLevel\r\n        );\r\n    }\r\n```",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24459/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24459/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1049647131",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/24459#issuecomment-1049647131",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24459",
    "id": 1049647131,
    "node_id": "IC_kwDOAOvK984-kFgb",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-24T09:17:56Z",
    "updated_at": "2022-02-24T09:17:56Z",
    "author_association": "MEMBER",
    "body": "Please make sure your local chain has all the forks enabled in the genesis.json file.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1049647131/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
