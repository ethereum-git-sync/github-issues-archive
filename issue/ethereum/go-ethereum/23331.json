{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23331",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23331/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23331/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23331/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/23331",
  "id": 960748990,
  "node_id": "MDU6SXNzdWU5NjA3NDg5OTA=",
  "number": 23331,
  "title": "eth: channel operations found blocking forever during fuzzing",
  "user": {
    "login": "BurtonQin",
    "id": 11943383,
    "node_id": "MDQ6VXNlcjExOTQzMzgz",
    "avatar_url": "https://avatars.githubusercontent.com/u/11943383?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/BurtonQin",
    "html_url": "https://github.com/BurtonQin",
    "followers_url": "https://api.github.com/users/BurtonQin/followers",
    "following_url": "https://api.github.com/users/BurtonQin/following{/other_user}",
    "gists_url": "https://api.github.com/users/BurtonQin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/BurtonQin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/BurtonQin/subscriptions",
    "organizations_url": "https://api.github.com/users/BurtonQin/orgs",
    "repos_url": "https://api.github.com/users/BurtonQin/repos",
    "events_url": "https://api.github.com/users/BurtonQin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/BurtonQin/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2021-08-04T17:07:46Z",
  "updated_at": "2021-10-27T05:02:25Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: `geth version`\r\nOS & Version: Windows/Linux/OSX\r\nCommit hash : 56e9001a1a8ddecc478943170b00207ef46109b9\r\n\r\n#### Expected behaviour\r\nThe channel sending/receiving/select operation shall not block forever whatever the order of the concurrent messages.\r\n\r\n#### Actual behaviour\r\nWe found 8 blocking issues by fuzzing the code from\r\n\r\n- Entry point 1:\r\nhttps://github.com/ethereum/go-ethereum/blob/56e9001a1a8ddecc478943170b00207ef46109b9/eth/downloader/downloader_test.go#L1517\r\n1.\tBlocked at the receiving operation at\r\nhttps://github.com/ethereum/go-ethereum/blob/56e9001a1a8ddecc478943170b00207ef46109b9/eth/downloader/downloader.go#L584 \r\n2.\tBlocked at the `select` operation at\r\nhttps://github.com/ethereum/go-ethereum/blob/56e9001a1a8ddecc478943170b00207ef46109b9/eth/downloader/downloader.go#L2005-L2010 \r\n- Entry point 2:\r\nhttps://github.com/ethereum/go-ethereum/blob/56e9001a1a8ddecc478943170b00207ef46109b9/eth/fetcher/tx_fetcher_test.go#L1127\r\n3.\tBlocked at the receiving operation at\r\nhttps://github.com/ethereum/go-ethereum/blob/56e9001a1a8ddecc478943170b00207ef46109b9/eth/fetcher/tx_fetcher.go#L680-L682\r\n- Entry point 3:\r\nhttps://github.com/ethereum/go-ethereum/blob/d8ff53dfb8a516f47db37dbc7fd7ad18a1e8a125/eth/fetcher/tx_fetcher_test.go#L1213\r\n4.\tBlocked at the receiving operation at\r\nhttps://github.com/ethereum/go-ethereum/blob/56e9001a1a8ddecc478943170b00207ef46109b9/eth/fetcher/tx_fetcher_test.go#L313-L315\r\n- Entry point 4:\r\nhttps://github.com/ethereum/go-ethereum/blob/56e9001a1a8ddecc478943170b00207ef46109b9/eth/filters/filter_system_test.go#L217\r\n5.\tBlocked at the `select` operation at\r\nhttps://github.com/ethereum/go-ethereum/blob/56e9001a1a8ddecc478943170b00207ef46109b9/eth/filters/api.go#L124-L136\r\n- Entry point 5:\r\nhttps://github.com/ethereum/go-ethereum/blob/56e9001a1a8ddecc478943170b00207ef46109b9/eth/filters/filter_system_test.go#L274\r\n6.\tBlocked at the `select` operation at\r\nhttps://github.com/ethereum/go-ethereum/blob/56e9001a1a8ddecc478943170b00207ef46109b9/eth/filters/api.go#L311-L323\r\n7.\tBlocked at the `select` operation at\r\nhttps://github.com/ethereum/go-ethereum/blob/56e9001a1a8ddecc478943170b00207ef46109b9/eth/filters/filter_system.go#L459-L460\r\n- Entry point 6:\r\nhttps://github.com/ethereum/go-ethereum/blob/56e9001a1a8ddecc478943170b00207ef46109b9/eth/filters/filter_system_test.go#L477\r\n8.\tBlocked at the receiving operation at\r\nhttps://github.com/ethereum/go-ethereum/blob/56e9001a1a8ddecc478943170b00207ef46109b9/eth/filters/filter_system_test.go#L580\r\nThe channel is created at\r\nhttps://github.com/ethereum/go-ethereum/blob/56e9001a1a8ddecc478943170b00207ef46109b9/eth/filters/filter_system_test.go#L569\r\n#### Steps to reproduce the behaviour\r\nWe found the blocking issues through a WIP Fuzzing project by system-pclub, PSU.\r\n\r\n#### Backtrace\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23331/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23331/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/894708394",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23331#issuecomment-894708394",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23331",
    "id": 894708394,
    "node_id": "IC_kwDOAOvK9841VCqq",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-07T21:24:19Z",
    "updated_at": "2021-08-07T21:24:19Z",
    "author_association": "MEMBER",
    "body": "To understand this more properly.. Is it the case that the fuzzing performed is more or less the following: \r\n\r\n- Execute a test. \r\n   - On all/targeted channels, add random timeouts, so some sends take (much) longer time than other sends (but the ordering and other channel-guarantees remain correct)\r\n- Repeat with same test, but change the timeouts. \r\n\r\nAnd then do it again with more 'base-tests'? \r\n\r\nIf so, that sounds like a very good idea indeed. I just want to clarify so I can better understand how to go about reproducing and/or fixing these issues. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/894708394/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/894994946",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23331#issuecomment-894994946",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23331",
    "id": 894994946,
    "node_id": "IC_kwDOAOvK9841WIoC",
    "user": {
      "login": "BurtonQin",
      "id": 11943383,
      "node_id": "MDQ6VXNlcjExOTQzMzgz",
      "avatar_url": "https://avatars.githubusercontent.com/u/11943383?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BurtonQin",
      "html_url": "https://github.com/BurtonQin",
      "followers_url": "https://api.github.com/users/BurtonQin/followers",
      "following_url": "https://api.github.com/users/BurtonQin/following{/other_user}",
      "gists_url": "https://api.github.com/users/BurtonQin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BurtonQin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BurtonQin/subscriptions",
      "organizations_url": "https://api.github.com/users/BurtonQin/orgs",
      "repos_url": "https://api.github.com/users/BurtonQin/repos",
      "events_url": "https://api.github.com/users/BurtonQin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BurtonQin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-09T06:55:49Z",
    "updated_at": "2021-08-09T06:55:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thx. Your description is close, but not exactly. We are still busy working on the output parts of the tool for more info. We will provide the info as soon as the work is done.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/894994946/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/952540617",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23331#issuecomment-952540617",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23331",
    "id": 952540617,
    "node_id": "IC_kwDOAOvK9844xp3J",
    "user": {
      "login": "charlesxsh",
      "id": 8362565,
      "node_id": "MDQ6VXNlcjgzNjI1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8362565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/charlesxsh",
      "html_url": "https://github.com/charlesxsh",
      "followers_url": "https://api.github.com/users/charlesxsh/followers",
      "following_url": "https://api.github.com/users/charlesxsh/following{/other_user}",
      "gists_url": "https://api.github.com/users/charlesxsh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/charlesxsh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/charlesxsh/subscriptions",
      "organizations_url": "https://api.github.com/users/charlesxsh/orgs",
      "repos_url": "https://api.github.com/users/charlesxsh/repos",
      "events_url": "https://api.github.com/users/charlesxsh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/charlesxsh/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-27T05:02:25Z",
    "updated_at": "2021-10-27T05:02:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi there, kindly ask do we have any update on this PR?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/952540617/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
