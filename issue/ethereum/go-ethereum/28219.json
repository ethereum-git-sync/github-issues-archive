{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28219",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28219/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28219/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28219/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/28219",
  "id": 1917402535,
  "node_id": "I_kwDOAOvK985yST2n",
  "number": 28219,
  "title": "Holesky: State download starts after genesis",
  "user": {
    "login": "etan-status",
    "id": 89844309,
    "node_id": "MDQ6VXNlcjg5ODQ0MzA5",
    "avatar_url": "https://avatars.githubusercontent.com/u/89844309?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/etan-status",
    "html_url": "https://github.com/etan-status",
    "followers_url": "https://api.github.com/users/etan-status/followers",
    "following_url": "https://api.github.com/users/etan-status/following{/other_user}",
    "gists_url": "https://api.github.com/users/etan-status/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/etan-status/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/etan-status/subscriptions",
    "organizations_url": "https://api.github.com/users/etan-status/orgs",
    "repos_url": "https://api.github.com/users/etan-status/repos",
    "events_url": "https://api.github.com/users/etan-status/events{/privacy}",
    "received_events_url": "https://api.github.com/users/etan-status/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    },
    {
      "id": 1132754722,
      "node_id": "MDU6TGFiZWwxMTMyNzU0NzIy",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/need:more-information",
      "name": "need:more-information",
      "color": "db6fa3",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-09-28T12:19:40Z",
  "updated_at": "2023-10-12T08:55:20Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: `1.13.2-stable`\r\nGit Commit: dc34fe8291bfcaefbce97f559e9610beffb2e470\r\nArchitecture: amd64\r\nGo Version: go1.21.1\r\nOperating System: darwin\r\nGOPATH=\r\nGOROOT=\r\n\r\nCL client & version: Nimbus v23.9.1\r\nOS & Version: macOS 14.0 Sonoma (23A344)\r\n\r\n#### Expected behaviour\r\n\r\nGenesis should work\r\n\r\n#### Actual behaviour\r\n\r\n- State download via snap sync is started only after the chain is already operating.\r\n- `Beacon backfilling failed                err=\"retrieved hash chain is invalid: missing parent\"` errors are spammed every slot\r\n- Nimbus reports optimistically synced / Geth doesn't reply `VALID` on engine\r\n\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\n1. Clear Geth and Nimbus data directories\r\n2. `geth --holesky --log.vmodule='rpc=5' --state.scheme path`\r\n3. `build/nimbus_beacon_node --data-dir=\"$HOME/Downloads/nimbus/data/holesky\" --network=holesky --rest --tcp-port=9010 --udp-port=9010 --history=prune --el=http://127.0.0.1:8551 --jwt-secret=/Users/etan/Library/Ethereum/holesky/geth/jwtsecret --log-level=DEBUG`\r\n\r\n\r\n#### Backtrace\r\n[holesky-geth-fail.txt](https://github.com/ethereum/go-ethereum/files/12749247/holesky-geth-fail.txt)\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28219/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28219/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1759182959",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/28219#issuecomment-1759182959",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28219",
    "id": 1759182959,
    "node_id": "IC_kwDOAOvK985o2wBv",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-12T08:40:15Z",
    "updated_at": "2023-10-12T08:40:15Z",
    "author_association": "MEMBER",
    "body": "Did this issue keep persisting? We don't know which head block was being requested in the engine API. From Geth's perspective, the beacon client is requesting sync to a header that isn't in the chain.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1759182959/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1759184411",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/28219#issuecomment-1759184411",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28219",
    "id": 1759184411,
    "node_id": "IC_kwDOAOvK985o2wYb",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-12T08:41:06Z",
    "updated_at": "2023-10-12T08:41:06Z",
    "author_association": "MEMBER",
    "body": "I suspect this is an issue related to hash computation mismatch between CL and EL. Please provide additional information / dumps of the engine API requests.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1759184411/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1759205887",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/28219#issuecomment-1759205887",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28219",
    "id": 1759205887,
    "node_id": "IC_kwDOAOvK985o21n_",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-12T08:55:20Z",
    "updated_at": "2023-10-12T08:55:20Z",
    "author_association": "MEMBER",
    "body": "This (and another issue) was opened just as holesky launched, snapsyncing during launch. It seems that the sync fails, state-sync completes but the chain-sync does not, and maybe the final \"trigger\" to complete the sync never happens, so the snapsync doesn't finish. \r\n\r\nWe could probably reproduce this locally, if someone wants to spend an hour or two setting up a similar environment. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1759205887/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
