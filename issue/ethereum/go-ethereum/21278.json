{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21278",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21278/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21278/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21278/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/21278",
  "id": 648245682,
  "node_id": "MDU6SXNzdWU2NDgyNDU2ODI=",
  "number": 21278,
  "title": "geth out of memory",
  "user": {
    "login": "FantomJoker",
    "id": 60769611,
    "node_id": "MDQ6VXNlcjYwNzY5NjEx",
    "avatar_url": "https://avatars.githubusercontent.com/u/60769611?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/FantomJoker",
    "html_url": "https://github.com/FantomJoker",
    "followers_url": "https://api.github.com/users/FantomJoker/followers",
    "following_url": "https://api.github.com/users/FantomJoker/following{/other_user}",
    "gists_url": "https://api.github.com/users/FantomJoker/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/FantomJoker/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/FantomJoker/subscriptions",
    "organizations_url": "https://api.github.com/users/FantomJoker/orgs",
    "repos_url": "https://api.github.com/users/FantomJoker/repos",
    "events_url": "https://api.github.com/users/FantomJoker/events{/privacy}",
    "received_events_url": "https://api.github.com/users/FantomJoker/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1132687333,
      "node_id": "MDU6TGFiZWwxMTMyNjg3MzMz",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/need:check-with-current-version",
      "name": "need:check-with-current-version",
      "color": "d3b300",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2020-06-30T14:55:24Z",
  "updated_at": "2020-08-26T10:49:45Z",
  "closed_at": "2020-08-26T10:49:44Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Geth killed because of out of memory;\r\n````\r\n[1276584.844268] Out of memory: Kill process 13181 (geth) score 772 or sacrifice child\r\n[1276584.844943] Killed process 13181 (geth) total-vm:8796292kB, anon-rss:6144964kB, file-rss:0kB, shmem-rss:0kB\r\n````\r\nAppears when multiple transfer requests are initiated. About 20 transfer requests at the same time.\r\nIn the beginning, when this problem occurs with geth1.9.11, then I use geth1.9.15 instead.\r\nThe problem remains unsolved. \r\nEven occurs after trying to use 16g of memory.\r\nHas anyone been in the same situation?\r\n\r\nThis is the log, I replaced the address.\r\n````\r\nINFO [06-30|17:38:59.816] Setting new local account                address=0x.....\r\nINFO [06-30|17:38:59.817] Submitted transaction                    fullhash=0x..... recipient=0x....\r\nINFO [06-30|17:39:00.671] Setting new local account                address=0x....\r\nINFO [06-30|17:39:00.672] Submitted transaction                    fullhash=0x.... recipient=0x...\r\nINFO [06-30|17:39:01.520] Setting new local account                address=0x....\r\nINFO [06-30|17:39:01.521] Submitted transaction                    fullhash=0x.... recipient=0x...\r\nINFO [06-30|17:39:02.373] Setting new local account                address=0x....\r\nINFO [06-30|17:39:02.374] Submitted transaction                    fullhash=0x.... recipient=0x...\r\nINFO [06-30|17:44:42.947] Starting Geth on Ethereum mainnet... \r\nINFO [06-30|17:44:42.950] Maximum peer count                       ETH=70 LES=0 total=70\r\nWARN [06-30|17:44:42.950] The flag --rpc is deprecated and will be removed in the future, please use --http \r\nWARN [06-30|17:44:42.951] The flag --rpcaddr is deprecated and will be removed in the future, please use --http.addr \r\nWARN [06-30|17:44:42.951] The flag --rpcport is deprecated and will be removed in the future, please use --http.port \r\nWARN [06-30|17:44:42.951] The flag --rpcapi is deprecated and will be removed in the future, please use --http.api \r\n````\r\n\r\n#### command\r\ngeth --maxpeers 70 --cache 1024 --txpool.globalslots 1024 --syncmode fast --datadir /home/.ethereum -rpcapi debug,txpool,admin,net,personal,eth,web3 --rpc --rpcport 8549 --rpcaddr 127.0.0.1 --allow-insecure-unlock\r\n\r\n#### System information\r\n\r\nGeth version: `v1.9.15-stable-0f77f34b`\r\nOS & Version: `Linux version 3.10.0-693.2.2.el7.x86_64`\r\nRam: 8g\r\n\r\n\r\n\r\n",
  "closed_by": {
    "login": "adamschmideg",
    "id": 208822,
    "node_id": "MDQ6VXNlcjIwODgyMg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/208822?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/adamschmideg",
    "html_url": "https://github.com/adamschmideg",
    "followers_url": "https://api.github.com/users/adamschmideg/followers",
    "following_url": "https://api.github.com/users/adamschmideg/following{/other_user}",
    "gists_url": "https://api.github.com/users/adamschmideg/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/adamschmideg/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/adamschmideg/subscriptions",
    "organizations_url": "https://api.github.com/users/adamschmideg/orgs",
    "repos_url": "https://api.github.com/users/adamschmideg/repos",
    "events_url": "https://api.github.com/users/adamschmideg/events{/privacy}",
    "received_events_url": "https://api.github.com/users/adamschmideg/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21278/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21278/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/652836770",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21278#issuecomment-652836770",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21278",
    "id": 652836770,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MjgzNjc3MA==",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-02T07:30:07Z",
    "updated_at": "2020-07-02T07:30:07Z",
    "author_association": "MEMBER",
    "body": "> About 20 transfer requests at the same time.\r\n\r\nDo you mean that you are sending the transactions with TPS as 20?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/652836770/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/652840580",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21278#issuecomment-652840580",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21278",
    "id": 652840580,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1Mjg0MDU4MA==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-02T07:37:55Z",
    "updated_at": "2020-07-02T07:37:55Z",
    "author_association": "MEMBER",
    "body": "If you are using personal_sendTransaction (where you supply the password too), then each call will decrypt the private key individually (security). Decrypting the private key is explicitly made CPU intensive and memory hard, so it takes about 1 second and 256MB RAM / decrypt. With 20 concurrent sends, that's 5GB RAM just for the barebone decryption.\r\n\r\nThat said, you are also running with `--allow-insecure-unlock`, so you are perhaps unlocking once and then doing eth_sendTransaction? That shouldn't take any memory at all. (mind you, please take care with that flag/unlock to avoid someone else accessing your node via RPC, otherwise they could access your funds).\r\n\r\nCould you provide some more details about your use case? Might help us pin point what might be off.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/652840580/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/652955292",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21278#issuecomment-652955292",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21278",
    "id": 652955292,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1Mjk1NTI5Mg==",
    "user": {
      "login": "FantomJoker",
      "id": 60769611,
      "node_id": "MDQ6VXNlcjYwNzY5NjEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/60769611?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/FantomJoker",
      "html_url": "https://github.com/FantomJoker",
      "followers_url": "https://api.github.com/users/FantomJoker/followers",
      "following_url": "https://api.github.com/users/FantomJoker/following{/other_user}",
      "gists_url": "https://api.github.com/users/FantomJoker/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/FantomJoker/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/FantomJoker/subscriptions",
      "organizations_url": "https://api.github.com/users/FantomJoker/orgs",
      "repos_url": "https://api.github.com/users/FantomJoker/repos",
      "events_url": "https://api.github.com/users/FantomJoker/events{/privacy}",
      "received_events_url": "https://api.github.com/users/FantomJoker/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-02T11:38:40Z",
    "updated_at": "2020-07-02T11:38:40Z",
    "author_association": "NONE",
    "body": "> Could you provide some more details about your use case? Might help us pin point what might be off.\r\n\r\nThis is an operation to aggregate the balances of multiple addresses into a single address;\r\nUsing java `org.web3j.core 4.2.0` access wallet;\r\n\r\nA single transfer will be executed to the following wallet operations:\r\n````\r\npersonal_unlockAccount\r\neth_gasPrice\r\neth_getTransactionCount\r\neth_sendTransaction\r\n````\r\nThe content of the transfer is usdt token contract transaction;\r\nThis process uses the for loop to execute the transfer without any interval;\r\n\r\nThis problem has not occurred before using geth's light mode; The fast mode appears later.\r\nIt is not inevitable OOM, but it usually appears after running for 2-3 days;\r\nBefore operation, geth takes up about 4G of memory.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/652955292/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/652955967",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21278#issuecomment-652955967",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21278",
    "id": 652955967,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1Mjk1NTk2Nw==",
    "user": {
      "login": "FantomJoker",
      "id": 60769611,
      "node_id": "MDQ6VXNlcjYwNzY5NjEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/60769611?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/FantomJoker",
      "html_url": "https://github.com/FantomJoker",
      "followers_url": "https://api.github.com/users/FantomJoker/followers",
      "following_url": "https://api.github.com/users/FantomJoker/following{/other_user}",
      "gists_url": "https://api.github.com/users/FantomJoker/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/FantomJoker/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/FantomJoker/subscriptions",
      "organizations_url": "https://api.github.com/users/FantomJoker/orgs",
      "repos_url": "https://api.github.com/users/FantomJoker/repos",
      "events_url": "https://api.github.com/users/FantomJoker/events{/privacy}",
      "received_events_url": "https://api.github.com/users/FantomJoker/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-02T11:40:33Z",
    "updated_at": "2020-07-02T11:40:33Z",
    "author_association": "NONE",
    "body": "> > About 20 transfer requests at the same time.\r\n> \r\n> Do you mean that you are sending the transactions with TPS as 20?\r\n\r\nThis process uses the for loop to execute the transfer without any interval;",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/652955967/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/653502266",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21278#issuecomment-653502266",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21278",
    "id": 653502266,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MzUwMjI2Ng==",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-03T11:30:40Z",
    "updated_at": "2020-07-03T11:30:40Z",
    "author_association": "MEMBER",
    "body": "We have merged one PR for fixing one issue in the txpool. Perhaps this issue is relevant. \r\n\r\nMaybe you can try the next release to see whether the issue is resolved.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/653502266/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/680806004",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21278#issuecomment-680806004",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21278",
    "id": 680806004,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4MDgwNjAwNA==",
    "user": {
      "login": "adamschmideg",
      "id": 208822,
      "node_id": "MDQ6VXNlcjIwODgyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/208822?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/adamschmideg",
      "html_url": "https://github.com/adamschmideg",
      "followers_url": "https://api.github.com/users/adamschmideg/followers",
      "following_url": "https://api.github.com/users/adamschmideg/following{/other_user}",
      "gists_url": "https://api.github.com/users/adamschmideg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/adamschmideg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adamschmideg/subscriptions",
      "organizations_url": "https://api.github.com/users/adamschmideg/orgs",
      "repos_url": "https://api.github.com/users/adamschmideg/repos",
      "events_url": "https://api.github.com/users/adamschmideg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/adamschmideg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-26T10:49:44Z",
    "updated_at": "2020-08-26T10:49:44Z",
    "author_association": "MEMBER",
    "body": "I assume this issue is resolved. If you have this problem again, please open a new issue.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/680806004/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
