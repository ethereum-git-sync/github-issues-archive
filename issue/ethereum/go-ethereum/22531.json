{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22531",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22531/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22531/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22531/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/22531",
  "id": 835638734,
  "node_id": "MDU6SXNzdWU4MzU2Mzg3MzQ=",
  "number": 22531,
  "title": "Faucet / LES not working since v1.10.1",
  "user": {
    "login": "maxsam4",
    "id": 7436022,
    "node_id": "MDQ6VXNlcjc0MzYwMjI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7436022?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/maxsam4",
    "html_url": "https://github.com/maxsam4",
    "followers_url": "https://api.github.com/users/maxsam4/followers",
    "following_url": "https://api.github.com/users/maxsam4/following{/other_user}",
    "gists_url": "https://api.github.com/users/maxsam4/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/maxsam4/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/maxsam4/subscriptions",
    "organizations_url": "https://api.github.com/users/maxsam4/orgs",
    "repos_url": "https://api.github.com/users/maxsam4/repos",
    "events_url": "https://api.github.com/users/maxsam4/events{/privacy}",
    "received_events_url": "https://api.github.com/users/maxsam4/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    },
    {
      "id": 841716348,
      "node_id": "MDU6TGFiZWw4NDE3MTYzNDg=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/area:les",
      "name": "area:les",
      "color": "c2e0c6",
      "default": false,
      "description": null
    },
    {
      "id": 1132689577,
      "node_id": "MDU6TGFiZWwxMTMyNjg5NTc3",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/status:triage",
      "name": "status:triage",
      "color": "6be514",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2021-03-19T07:11:40Z",
  "updated_at": "2021-03-22T21:00:03Z",
  "closed_at": "2021-03-22T21:00:03Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "I've tried v1.10.1 and latest master but the (Goerli) faucet is not able to connect to any nodes. I've reset/resynced both the faucet and the node but still no connection. The node is added as a bootnode to the faucet so it is discovered, just not connected.\r\n\r\n```\r\npeercount=0 tried=1 static=1\r\n```\r\n\r\nReverting to an older version of the faucet does not fix the problem. Reverting to an older version of the node is not possible since Goerli has already upgraded to Berlin.\r\n\r\nEdit, I increased logging and found the following in faucet's logs against my node\r\n```\r\n\"ForkID rejected - local incompatible or needs update\"\r\n```\r\nBoth the faucet and the node are updated so it's a bit weird.\r\n\r\nSome more potentially interesting logs from the faucet:\r\n```\r\nINFO [03-19|12:55:16.457] Initialised chain configuration          config=\"{ChainID: 5 Homestead: 0 DAO: <nil> DAOSupport: false EIP150: 0 EIP155: 0 EIP158: 0 Byzantium: 0 Constantinople: 0 Petersburg: 0 Istanbul: <nil>, Muir Glacier: <nil>, Berlin: <nil>, YOLO v3: <nil>, Engine: clique}\"\r\nINFO [03-19|12:55:16.457] Added trusted checkpoint                 block=4358143 hash=\"29fa24…7c5324\"\r\nINFO [03-19|12:55:16.457] Loaded most recent local header          number=0 hash=\"bf7e33…b88c1a\" td=1 age=2y1mo4w\r\nINFO [03-19|12:55:16.458] Configured checkpoint oracle             address=0x18CA0E045F0D772a851BC7e48357Bcaab0a0795D signers=5 threshold=2\r\nINFO [03-19|12:55:16.458] Starting peer-to-peer node               instance=Geth/v1.10.2-unstable-91726e8a-20210316/linux-amd64/go1.16.2\r\n```",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22531/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22531/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/802970235",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22531#issuecomment-802970235",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22531",
    "id": 802970235,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMjk3MDIzNQ==",
    "user": {
      "login": "maxsam4",
      "id": 7436022,
      "node_id": "MDQ6VXNlcjc0MzYwMjI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7436022?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maxsam4",
      "html_url": "https://github.com/maxsam4",
      "followers_url": "https://api.github.com/users/maxsam4/followers",
      "following_url": "https://api.github.com/users/maxsam4/following{/other_user}",
      "gists_url": "https://api.github.com/users/maxsam4/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maxsam4/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maxsam4/subscriptions",
      "organizations_url": "https://api.github.com/users/maxsam4/orgs",
      "repos_url": "https://api.github.com/users/maxsam4/repos",
      "events_url": "https://api.github.com/users/maxsam4/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maxsam4/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-19T16:49:39Z",
    "updated_at": "2021-03-19T16:49:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "Replacing https://github.com/ethereum/go-ethereum/blob/d3040a80d7a0721297cfac93b82e0e9428ddd3d1/cmd/faucet/faucet.go#L253\r\nwith \r\n```\r\ncfg.Genesis = core.DefaultGoerliGenesisBlock()\r\n```\r\nfixes the issue.\r\n\r\nThis means that old genesis configs are no longer being processed properly. I'm using https://github.com/goerli/testnet/blob/master/geth/goerli.genesis as the genesis file and it was working fine till a couple of of upgrades ago.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/802970235/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/803817050",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22531#issuecomment-803817050",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22531",
    "id": 803817050,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzgxNzA1MA==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-22T07:05:19Z",
    "updated_at": "2021-03-22T07:05:19Z",
    "author_association": "MEMBER",
    "body": "@maxsam4 AFAIK the faucet uses a custom network/chain config (i.e. there's no notion of --goerli or whatnot). If so, you'll need to reinit the faucet with the updated goerli chain spec (`geth --datadir /path/to/your/faucet init goerli.json`) to set the berlin fork number, otherwise it will be unaware of it. Did you do that?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/803817050/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/803817765",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22531#issuecomment-803817765",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22531",
    "id": 803817765,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzgxNzc2NQ==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-22T07:06:31Z",
    "updated_at": "2021-03-22T07:06:31Z",
    "author_association": "MEMBER",
    "body": "Ah, apologies, there's a genesis flag for the faucet. Hmmm, did you specify the updated spec with the Berlin number in there?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/803817765/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/803818230",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22531#issuecomment-803818230",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22531",
    "id": 803818230,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzgxODIzMA==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-22T07:07:22Z",
    "updated_at": "2021-03-22T07:07:22Z",
    "author_association": "MEMBER",
    "body": "Doesn't seem so `INFO [03-19|12:55:16.457] Initialised chain configuration          config=\"{ChainID: 5 Homestead: 0 DAO: <nil> DAOSupport: false EIP150: 0 EIP155: 0 EIP158: 0 Byzantium: 0 Constantinople: 0 Petersburg: 0 Istanbul: <nil>, Muir Glacier: <nil>, Berlin: <nil>, YOLO v3: <nil>, Engine: clique}\"`\r\n\r\nThis said even Istanbul is `nil`, and Berlin too. You need to get an updated genesis json from the goerli team.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/803818230/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/803818816",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22531#issuecomment-803818816",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22531",
    "id": 803818816,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzgxODgxNg==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-22T07:08:30Z",
    "updated_at": "2021-03-22T07:08:30Z",
    "author_association": "MEMBER",
    "body": "I guess this worked previously because the faucet didn't execute anything, so it didn't care what fork it's in. However AFAIK @zsfelfoldi added the fork ID to les/4, so from now on even light clients care about being on the same fork (which in general is a good thing to do).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/803818816/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/803834489",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22531#issuecomment-803834489",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22531",
    "id": 803834489,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzgzNDQ4OQ==",
    "user": {
      "login": "maxsam4",
      "id": 7436022,
      "node_id": "MDQ6VXNlcjc0MzYwMjI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7436022?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maxsam4",
      "html_url": "https://github.com/maxsam4",
      "followers_url": "https://api.github.com/users/maxsam4/followers",
      "following_url": "https://api.github.com/users/maxsam4/following{/other_user}",
      "gists_url": "https://api.github.com/users/maxsam4/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maxsam4/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maxsam4/subscriptions",
      "organizations_url": "https://api.github.com/users/maxsam4/orgs",
      "repos_url": "https://api.github.com/users/maxsam4/repos",
      "events_url": "https://api.github.com/users/maxsam4/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maxsam4/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-22T07:31:25Z",
    "updated_at": "2021-03-22T07:31:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks @karalabe, that explains it. \r\n\r\nHonestly, I don't really want to keep updating the genesis file manually. Would it be fine if I submit a PR that adds `--goerli` and `--rinkeby` flags to the faucet?\r\n\r\nps Remember to update the genesis file when upgrading the Rinkeby faucet :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/803834489/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/804390927",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22531#issuecomment-804390927",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22531",
    "id": 804390927,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNDM5MDkyNw==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-22T21:00:03Z",
    "updated_at": "2021-03-22T21:00:03Z",
    "author_association": "MEMBER",
    "body": "I'm going to close this issue as not-a-bug, but we can debate your proposal on the PR.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/804390927/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
