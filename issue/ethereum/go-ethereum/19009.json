{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19009",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19009/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19009/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19009/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/19009",
  "id": 407406000,
  "node_id": "MDU6SXNzdWU0MDc0MDYwMDA=",
  "number": 19009,
  "title": "Event Subscription Error: leveldb: not found",
  "user": {
    "login": "pooleja",
    "id": 1794421,
    "node_id": "MDQ6VXNlcjE3OTQ0MjE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1794421?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pooleja",
    "html_url": "https://github.com/pooleja",
    "followers_url": "https://api.github.com/users/pooleja/followers",
    "following_url": "https://api.github.com/users/pooleja/following{/other_user}",
    "gists_url": "https://api.github.com/users/pooleja/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pooleja/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pooleja/subscriptions",
    "organizations_url": "https://api.github.com/users/pooleja/orgs",
    "repos_url": "https://api.github.com/users/pooleja/repos",
    "events_url": "https://api.github.com/users/pooleja/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pooleja/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2019-02-06T20:00:31Z",
  "updated_at": "2020-08-27T09:10:38Z",
  "closed_at": "2020-04-16T08:43:27Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "After upgrading to the latest release, I am seeing a failure to listen to events.  This is being reproduced on Ropsten.  This happens only if I start listening for a long scan (e.g. starting filter from block 0)\r\n\r\nPointing to infura as web3 provider does note see this issue.\r\n\r\n#### System information\r\n\r\nGeth version: `geth version`\r\n```\r\nGeth\r\nVersion: 1.8.22-stable\r\nGit Commit: 7fa3509e2eaf1a4ebc12344590e5699406690f15\r\nArchitecture: amd64\r\nProtocol Versions: [63 62]\r\nNetwork Id: 1\r\nGo Version: go1.10.4\r\nOperating System: linux\r\nGOPATH=\r\nGOROOT=/usr/lib/go-1.10\r\n```\r\nOS & Version: Windows/Linux/OSX\r\nUbuntu Linux\r\n\r\n#### Expected behaviour\r\nEven subscriptions should handle callbacks without and errors.\r\n\r\n#### Actual behaviour\r\nCallback handler in web3 gets called with error parameter:\r\n\r\n```\r\nError: Node error: {\"code\":-32000,\"message\":\"leveldb: not found\"}\r\n    at Function.validate (/app/node_modules/web3-providers/dist/web3-providers.cjs.js:67:18)\r\n    at /app/node_modules/web3-providers/dist/web3-providers.cjs.js:495:57\r\n    at process._tickCallback (internal/process/next_tick.js:68:7)\r\n```\r\n\r\n#### Steps to reproduce the behaviour\r\nI have a simple subscription for a contract deployed in ropsten.  Starting to listen triggers this behavior.\r\n\r\n```\r\n    contractInst.events.MyTestEvent(\r\n      {\r\n        filter: {},\r\n        fromBlock: 0\r\n      },\r\n      async (error, params) => {\r\n        if (error) {\r\n          console.log(error)\r\n          logger.error(`ERROR during callback: ${error}`)\r\n          process.exit(-1)\r\n        }\r\n```\r\n#### Logs\r\nI see this in the logs if it fails:\r\n```\r\nERROR[02-06|19:55:23.551] write tcp 10.0.18.XXX:8546->10.0.29.XXX:60806: write: broken pipe\r\n```\r\n",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19009/reactions",
    "total_count": 5,
    "+1": 5,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19009/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/466738487",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19009#issuecomment-466738487",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19009",
    "id": 466738487,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NjczODQ4Nw==",
    "user": {
      "login": "xiaods",
      "id": 37678,
      "node_id": "MDQ6VXNlcjM3Njc4",
      "avatar_url": "https://avatars.githubusercontent.com/u/37678?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xiaods",
      "html_url": "https://github.com/xiaods",
      "followers_url": "https://api.github.com/users/xiaods/followers",
      "following_url": "https://api.github.com/users/xiaods/following{/other_user}",
      "gists_url": "https://api.github.com/users/xiaods/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xiaods/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xiaods/subscriptions",
      "organizations_url": "https://api.github.com/users/xiaods/orgs",
      "repos_url": "https://api.github.com/users/xiaods/repos",
      "events_url": "https://api.github.com/users/xiaods/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xiaods/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-24T06:24:43Z",
    "updated_at": "2019-02-24T06:24:43Z",
    "author_association": "NONE",
    "body": "maybe caused by the contract, so cloud you please some sample testing to help me to investigate the environment, i can have try deeply on source code to find the potential bug.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/466738487/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/471528269",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19009#issuecomment-471528269",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19009",
    "id": 471528269,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MTUyODI2OQ==",
    "user": {
      "login": "jleeh",
      "id": 10528926,
      "node_id": "MDQ6VXNlcjEwNTI4OTI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/10528926?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jleeh",
      "html_url": "https://github.com/jleeh",
      "followers_url": "https://api.github.com/users/jleeh/followers",
      "following_url": "https://api.github.com/users/jleeh/following{/other_user}",
      "gists_url": "https://api.github.com/users/jleeh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jleeh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jleeh/subscriptions",
      "organizations_url": "https://api.github.com/users/jleeh/orgs",
      "repos_url": "https://api.github.com/users/jleeh/repos",
      "events_url": "https://api.github.com/users/jleeh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jleeh/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-11T12:58:54Z",
    "updated_at": "2019-03-11T12:58:54Z",
    "author_association": "NONE",
    "body": "I'm seeing this issue as well. Tried updating Geth to the latest stable version of `1.8.23` which didn't fix it. @pooleja What flags are you using to start geth locally?\r\n\r\nWhen going through the source code, it seems that this error is thrown when leveldb cannot find a key in it's db. So to me this seems like a genuine issue rather than configuration. This is where the error is defined:\r\nhttps://github.com/syndtr/goleveldb/blob/master/leveldb/errors/errors.go#L20",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/471528269/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/471531022",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19009#issuecomment-471531022",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19009",
    "id": 471531022,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MTUzMTAyMg==",
    "user": {
      "login": "jleeh",
      "id": 10528926,
      "node_id": "MDQ6VXNlcjEwNTI4OTI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/10528926?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jleeh",
      "html_url": "https://github.com/jleeh",
      "followers_url": "https://api.github.com/users/jleeh/followers",
      "following_url": "https://api.github.com/users/jleeh/following{/other_user}",
      "gists_url": "https://api.github.com/users/jleeh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jleeh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jleeh/subscriptions",
      "organizations_url": "https://api.github.com/users/jleeh/orgs",
      "repos_url": "https://api.github.com/users/jleeh/repos",
      "events_url": "https://api.github.com/users/jleeh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jleeh/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-11T13:08:06Z",
    "updated_at": "2019-03-11T13:08:06Z",
    "author_association": "NONE",
    "body": "Ok, this was a simple fix. I just removed the existing Geth db locally, restarted it and it was fine. No idea on the causation of the issue.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/471531022/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/476258607",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19009#issuecomment-476258607",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19009",
    "id": 476258607,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjI1ODYwNw==",
    "user": {
      "login": "offerm",
      "id": 9712754,
      "node_id": "MDQ6VXNlcjk3MTI3NTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9712754?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/offerm",
      "html_url": "https://github.com/offerm",
      "followers_url": "https://api.github.com/users/offerm/followers",
      "following_url": "https://api.github.com/users/offerm/following{/other_user}",
      "gists_url": "https://api.github.com/users/offerm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/offerm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/offerm/subscriptions",
      "organizations_url": "https://api.github.com/users/offerm/orgs",
      "repos_url": "https://api.github.com/users/offerm/repos",
      "events_url": "https://api.github.com/users/offerm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/offerm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-25T15:51:59Z",
    "updated_at": "2019-03-25T15:51:59Z",
    "author_association": "NONE",
    "body": "I face the same problem. Using a private chain. \r\nWhat exactly did you remove? @jleeh ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/476258607/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/476527325",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19009#issuecomment-476527325",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19009",
    "id": 476527325,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NjUyNzMyNQ==",
    "user": {
      "login": "zulhfreelancer",
      "id": 3416976,
      "node_id": "MDQ6VXNlcjM0MTY5NzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3416976?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zulhfreelancer",
      "html_url": "https://github.com/zulhfreelancer",
      "followers_url": "https://api.github.com/users/zulhfreelancer/followers",
      "following_url": "https://api.github.com/users/zulhfreelancer/following{/other_user}",
      "gists_url": "https://api.github.com/users/zulhfreelancer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zulhfreelancer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zulhfreelancer/subscriptions",
      "organizations_url": "https://api.github.com/users/zulhfreelancer/orgs",
      "repos_url": "https://api.github.com/users/zulhfreelancer/repos",
      "events_url": "https://api.github.com/users/zulhfreelancer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zulhfreelancer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-26T08:45:27Z",
    "updated_at": "2019-03-26T08:45:27Z",
    "author_association": "NONE",
    "body": "@offerm I think he ran `geth removedb` command.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/476527325/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/509173923",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19009#issuecomment-509173923",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19009",
    "id": 509173923,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwOTE3MzkyMw==",
    "user": {
      "login": "bellaj",
      "id": 16008163,
      "node_id": "MDQ6VXNlcjE2MDA4MTYz",
      "avatar_url": "https://avatars.githubusercontent.com/u/16008163?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bellaj",
      "html_url": "https://github.com/bellaj",
      "followers_url": "https://api.github.com/users/bellaj/followers",
      "following_url": "https://api.github.com/users/bellaj/following{/other_user}",
      "gists_url": "https://api.github.com/users/bellaj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bellaj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bellaj/subscriptions",
      "organizations_url": "https://api.github.com/users/bellaj/orgs",
      "repos_url": "https://api.github.com/users/bellaj/repos",
      "events_url": "https://api.github.com/users/bellaj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bellaj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-07-08T10:37:39Z",
    "updated_at": "2019-07-08T10:38:20Z",
    "author_association": "NONE",
    "body": " \r\nThis issue showed up after a previous one (in geth 1.8.23-stable running as a single node)\r\n\r\n> ERROR[07-08|10:36:18.001] Section processing failed                type=bloombits error=\"chain reorged during section processing\"\r\n\r\nI think they are connected ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/509173923/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/614505179",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19009#issuecomment-614505179",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19009",
    "id": 614505179,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNDUwNTE3OQ==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-16T08:43:27Z",
    "updated_at": "2020-04-16T08:43:27Z",
    "author_association": "MEMBER",
    "body": "This should definitely be caused by a crash, which lead to a database corruption. Not much we can do, but please open a new issue if it happens again and you have more information.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/614505179/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
