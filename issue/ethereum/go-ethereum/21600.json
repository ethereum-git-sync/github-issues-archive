{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21600",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21600/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21600/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21600/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/21600",
  "id": 707189445,
  "node_id": "MDU6SXNzdWU3MDcxODk0NDU=",
  "number": 21600,
  "title": "Transactions are not ordered by gasprice in the same block",
  "user": {
    "login": "DbIsFantastic",
    "id": 71758522,
    "node_id": "MDQ6VXNlcjcxNzU4NTIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/71758522?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/DbIsFantastic",
    "html_url": "https://github.com/DbIsFantastic",
    "followers_url": "https://api.github.com/users/DbIsFantastic/followers",
    "following_url": "https://api.github.com/users/DbIsFantastic/following{/other_user}",
    "gists_url": "https://api.github.com/users/DbIsFantastic/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/DbIsFantastic/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/DbIsFantastic/subscriptions",
    "organizations_url": "https://api.github.com/users/DbIsFantastic/orgs",
    "repos_url": "https://api.github.com/users/DbIsFantastic/repos",
    "events_url": "https://api.github.com/users/DbIsFantastic/events{/privacy}",
    "received_events_url": "https://api.github.com/users/DbIsFantastic/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-09-23T09:12:29Z",
  "updated_at": "2020-09-24T07:05:17Z",
  "closed_at": "2020-09-23T11:17:53Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi there,\r\n\r\nI found some blocks mined by SparkPool are not ordered by `gasprice` anymore.\r\nFor example, take a look at this [transaction](https://etherscan.io/tx/0x64363d2366392a5f2c4950479a3d9c3a3ed412bad4d55a6e559273b31d5cdfd8), \r\n<img width=\"1164\" alt=\"image\" src=\"https://user-images.githubusercontent.com/71758522/93991189-942fde00-fdbe-11ea-9192-2673b563d3a7.png\">\r\nwhich is in the block [10917864](https://etherscan.io/block/10917864),  mined by SparkPool, which is on the position 199. And its gasprice is 111 Gwei, but in the same block, there are a lot of transaction which has lower gasprice, but located in the position before that transaction.  Here are some screenshots:\r\n1.  \r\n[](https://user-images.githubusercontent.com/71758522/93991422-dd802d80-fdbe-11ea-801d-347ce4d2c6e0.png)\r\n2.\r\n<img width=\"1064\" alt=\"image\" src=\"https://user-images.githubusercontent.com/71758522/93991450-e8d35900-fdbe-11ea-87c5-aa9d572902fe.png\">\r\n3.\r\n<img width=\"1243\" alt=\"image\" src=\"https://user-images.githubusercontent.com/71758522/93991477-f1c42a80-fdbe-11ea-9d9c-02eeb47ac5ae.png\">\r\n\r\nCurrently, I could only find blocks from Sparkpool follow this rule, but is it new feature?  If not, does it affect the blockchain system?\r\n\r\n#### System information\r\n\r\nGeth version: `geth version`\r\nOS & Version: Windows/Linux/OSX\r\nCommit hash : (if `develop`)\r\n\r\n#### Expected behaviour\r\nIn the same block, txs are ordered by gasprice.\r\n\r\n#### Actual behaviour\r\nIn the same block, txs are no longer ordered by gasprice.\r\n\r\n#### Steps to reproduce the behaviour\r\nPlease take a look at the links and screenshots I posted. \r\n\r\n#### Backtrace\r\n\r\n````\r\n[backtrace]\r\n````\r\n",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21600/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21600/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/697245292",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21600#issuecomment-697245292",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21600",
    "id": 697245292,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NzI0NTI5Mg==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-23T09:24:29Z",
    "updated_at": "2020-09-23T09:24:29Z",
    "author_association": "MEMBER",
    "body": "Etherscan sorts the transactions in reverse order (i.e. latest transaction first), so the price list is actually reverse.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/697245292/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/697246602",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21600#issuecomment-697246602",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21600",
    "id": 697246602,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NzI0NjYwMg==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-23T09:26:58Z",
    "updated_at": "2020-09-23T09:26:58Z",
    "author_association": "MEMBER",
    "body": "There is 1 transaction - the very first - at 10 gwei. That is probably a \"local\" transaction. Miners will always include those first at arbitrary price points. If there are other inversions, please point them out.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/697246602/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/697298758",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21600#issuecomment-697298758",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21600",
    "id": 697298758,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NzI5ODc1OA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-23T11:17:53Z",
    "updated_at": "2020-09-23T11:17:53Z",
    "author_association": "MEMBER",
    "body": "There are a lot of unknowns here, sparkpool may be running some custom miner (the extradata is `\r\neth-pro-hzo-t005 `), or other non-geth, like Parity. ISTR that parity supports setting various strategies for how to select transactions. \r\n\r\n> Currently, I could only find blocks from Sparkpool follow this rule, but is it new feature? If not, does it affect the blockchain system?\r\n\r\nNo, it doesn't matter for the ethereum blockchain if transactions are ordered by price or by random. It's totally up to the miner to put the together in a way to maximize profit. \r\n\r\nI don't think this ticket points to a a bug in geth, so I'm going to close this. If you find any evidence that geth erroneously packs transactions into blocks, please reopen.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/697298758/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/698158108",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21600#issuecomment-698158108",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21600",
    "id": 698158108,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5ODE1ODEwOA==",
    "user": {
      "login": "wsy2220",
      "id": 7259503,
      "node_id": "MDQ6VXNlcjcyNTk1MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7259503?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wsy2220",
      "html_url": "https://github.com/wsy2220",
      "followers_url": "https://api.github.com/users/wsy2220/followers",
      "following_url": "https://api.github.com/users/wsy2220/following{/other_user}",
      "gists_url": "https://api.github.com/users/wsy2220/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wsy2220/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wsy2220/subscriptions",
      "organizations_url": "https://api.github.com/users/wsy2220/orgs",
      "repos_url": "https://api.github.com/users/wsy2220/repos",
      "events_url": "https://api.github.com/users/wsy2220/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wsy2220/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-24T07:05:17Z",
    "updated_at": "2020-09-24T07:05:17Z",
    "author_association": "NONE",
    "body": "Txs are sorted by gasprice and nonce, and nonce order must be enforced. See https://github.com/ethereum/go-ethereum/blob/master/core/types/transaction.go#L349\r\n\r\nThis account has 2 txs in that block. The first one has lower gasprice, so it is arranged at later half of the block. The second one has higher price but can not be placed before the first one. This happens very often.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/698158108/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
