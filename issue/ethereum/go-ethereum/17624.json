{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17624",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17624/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17624/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17624/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/17624",
  "id": 358655933,
  "node_id": "MDU6SXNzdWUzNTg2NTU5MzM=",
  "number": 17624,
  "title": "Out of memory issue",
  "user": {
    "login": "srqdev",
    "id": 11214013,
    "node_id": "MDQ6VXNlcjExMjE0MDEz",
    "avatar_url": "https://avatars.githubusercontent.com/u/11214013?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/srqdev",
    "html_url": "https://github.com/srqdev",
    "followers_url": "https://api.github.com/users/srqdev/followers",
    "following_url": "https://api.github.com/users/srqdev/following{/other_user}",
    "gists_url": "https://api.github.com/users/srqdev/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/srqdev/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/srqdev/subscriptions",
    "organizations_url": "https://api.github.com/users/srqdev/orgs",
    "repos_url": "https://api.github.com/users/srqdev/repos",
    "events_url": "https://api.github.com/users/srqdev/events{/privacy}",
    "received_events_url": "https://api.github.com/users/srqdev/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2018-09-10T14:43:44Z",
  "updated_at": "2018-09-11T21:57:53Z",
  "closed_at": "2018-09-11T21:57:53Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "The last few versions of Geth (1.8.x) seem to be generating an out of memory condition with a few minutes of starting. I'm running a Test mining instance (all in one) on an AWS AMI Linux T2 instance. Geth runs and slowly at first uses up memory. Then for some reason it burn's through most of the memory very quickly and finally crashes.  \r\n\r\nThe geth info is\r\n```\r\nGeth\r\nVersion: 1.8.15-stable\r\nGit Commit: 89451f7c382ad2185987ee369f16416f89c28a7d\r\nArchitecture: amd64\r\nProtocol Versions: [63 62]\r\nNetwork Id: 1\r\nGo Version: go1.10.4\r\nOperating System: linux\r\nGOPATH=\r\nGOROOT=/home/travis/.gimme/versions/go1.10.4.linux.amd64\r\n\r\n```\r\n\r\nMy startup script is \r\n`screen -L geth --maxpeers 0 --identity \"VertexTest\" --nodiscover --rpc --rpcaddr 168.0.0.215 --rpccorsdomain \"*\" --rpcport 8545 --rpcapi \"db,eth,net,web3,personal,miner\" --mine --miner.threads=2\r\n`\r\nThe genesis file is \r\n```\r\n\r\n{\r\n  \"config\": {\r\n    \"chainId\": 15,\r\n    \"homesteadBlock\": 0,\r\n    \"eip155Block\": 0,\r\n    \"eip158Block\": 0\r\n  },\r\n  \"nonce\": \"0x0000000000000042\",\r\n  \"difficulty\": \"0x020000\",\r\n  \"mixhash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n  \"coinbase\": \"0x0000000000000000000000000000000000000000\",\r\n  \"timestamp\": \"0x00\",\r\n  \"parentHash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n  \"extraData\": \"0x11bbe8db4e347b4e8c937c1c8370e4b5ed33adb3db69cbdb7a38e1e50b1b82fa\",\r\n  \"gasLimit\": \"0x4c4b40\",\r\n  \"alloc\": {\r\n     \"45c11a62bf5f44ae065b26992631dd1036026ede\": { \"balance\": \"1000000000000000000000000000000\" },\r\n     \"1c1c32b4fa60097da407921fe14687d7a5149710\": { \"balance\": \"1000000000000000000000000000000\" },\r\n     \"926ecfa4bf042f66ff5b3e7a0a59fda98a4cd990\": { \"balance\": \"1000000000000000000000000000000\" },\r\n     \"3c842dfbb6f791517d1c4ca26366e8609b303ee5\": { \"balance\": \"1000000000000000000000000000000\" }\r\n  }\r\n}\r\n```\r\n\r\nAnd the crash as roughly\r\n```\r\nINFO [09-10|14:13:29.716] Successfully sealed new block            number=659 sealhash=a504c2â€¦003ccf hash=95fe50â€¦c35354 elapsed=5.374s\r\nINFO [09-10|14:13:29.716] ðŸ”— block reached canonical chain          number=652 hash=17ddbdâ€¦46cf06\r\nINFO [09-10|14:13:29.716] ðŸ”¨ mined potential block                  number=659 hash=95fe50â€¦c35354\r\nINFO [09-10|14:13:29.717] Commit new mining work                   number=660 sealhash=701864â€¦1c391c uncles=0 txs=0 gas=0       fees=0          elapsed=151.013Âµs\r\nfatal error: runtime: out of memory\r\n\r\nruntime stack:\r\nruntime.throw(0xf6b30e, 0x16)\r\n        /home/travis/.gimme/versions/go1.10.4.linux.amd64/src/runtime/panic.go:616 +0x81\r\nruntime.sysMap(0xc5eb200000, 0x10000000, 0x0, 0x1ba3b18)\r\n        /home/travis/.gimme/versions/go1.10.4.linux.amd64/src/runtime/mem_linux.go:216 +0x20a\r\nruntime.(*mheap).sysAlloc(0x1b8a100, 0x10000000, 0x5e7eaa)\r\n        /home/travis/.gimme/versions/go1.10.4.linux.amd64/src/runtime/malloc.go:470 +0xd4\r\nruntime.(*mheap).grow(0x1b8a100, 0x8000, 0x0)\r\n        /home/travis/.gimme/versions/go1.10.4.linux.amd64/src/runtime/mheap.go:907 +0x60\r\nruntime.(*mheap).allocSpanLocked(0x1b8a100, 0x8000, 0x1ba3b28, 0x1b79c10)\r\n        /home/travis/.gimme/versions/go1.10.4.linux.amd64/src/runtime/mheap.go:820 +0x301\r\nruntime.(*mheap).alloc_m(0x1b8a100, 0x8000, 0xffffffffffff0101, 0x7f674b721db8)\r\n        /home/travis/.gimme/versions/go1.10.4.linux.amd64/src/runtime/mheap.go:686 +0x118\r\nruntime.(*mheap).alloc.func1()\r\n        /home/travis/.gimme/versions/go1.10.4.linux.amd64/src/runtime/mheap.go:753 +0x4d\r\nruntime.(*mheap).alloc(0x1b8a100, 0x8000, 0x7f674b010101, 0x429f0c)\r\n        /home/travis/.gimme/versions/go1.10.4.linux.amd64/src/runtime/mheap.go:752 +0x8a\r\nruntime.largeAlloc(0x10000000, 0x460101, 0x7f674d4256c8)\r\n        /home/travis/.gimme/versions/go1.10.4.linux.amd64/src/runtime/malloc.go:826 +0x94\r\nruntime.mallocgc.func1()\r\n        /home/travis/.gimme/versions/go1.10.4.linux.amd64/src/runtime/malloc.go:721 +0x46\r\nruntime.systemstack(0xc400000000)\r\n        /home/travis/.gimme/versions/go1.10.4.linux.amd64/src/runtime/asm_amd64.s:409 +0x79\r\nruntime.mstart()\r\n        /home/travis/.gimme/versions/go1.10.4.linux.amd64/src/runtime/proc.go:1175\r\n\r\n```\r\n\r\n",
  "closed_by": {
    "login": "srqdev",
    "id": 11214013,
    "node_id": "MDQ6VXNlcjExMjE0MDEz",
    "avatar_url": "https://avatars.githubusercontent.com/u/11214013?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/srqdev",
    "html_url": "https://github.com/srqdev",
    "followers_url": "https://api.github.com/users/srqdev/followers",
    "following_url": "https://api.github.com/users/srqdev/following{/other_user}",
    "gists_url": "https://api.github.com/users/srqdev/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/srqdev/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/srqdev/subscriptions",
    "organizations_url": "https://api.github.com/users/srqdev/orgs",
    "repos_url": "https://api.github.com/users/srqdev/repos",
    "events_url": "https://api.github.com/users/srqdev/events{/privacy}",
    "received_events_url": "https://api.github.com/users/srqdev/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17624/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17624/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/419965988",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17624#issuecomment-419965988",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17624",
    "id": 419965988,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxOTk2NTk4OA==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-10T15:59:51Z",
    "updated_at": "2018-09-10T15:59:51Z",
    "author_association": "MEMBER",
    "body": "Please don't expose your machine to the world. People are actively scanning for open ports and trying to brute force unlocking accounts. That's what is using up all the memory (my hunch).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/419965988/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/420439833",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17624#issuecomment-420439833",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17624",
    "id": 420439833,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDQzOTgzMw==",
    "user": {
      "login": "srqdev",
      "id": 11214013,
      "node_id": "MDQ6VXNlcjExMjE0MDEz",
      "avatar_url": "https://avatars.githubusercontent.com/u/11214013?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/srqdev",
      "html_url": "https://github.com/srqdev",
      "followers_url": "https://api.github.com/users/srqdev/followers",
      "following_url": "https://api.github.com/users/srqdev/following{/other_user}",
      "gists_url": "https://api.github.com/users/srqdev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/srqdev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/srqdev/subscriptions",
      "organizations_url": "https://api.github.com/users/srqdev/orgs",
      "repos_url": "https://api.github.com/users/srqdev/repos",
      "events_url": "https://api.github.com/users/srqdev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/srqdev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-11T21:57:53Z",
    "updated_at": "2018-09-11T21:57:53Z",
    "author_association": "NONE",
    "body": "Looks like that may have been the issue. Found a misconfiguration in the inbound, outbound rules in AWS, that would open up the instance to the world. That said, it would help to have some better messaging from Geth about it's status. Curiously, this did not happen under 1.6.7. It may have been pure luck or perhaps it's memory handling was better. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/420439833/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
