{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25915",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25915/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25915/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25915/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/25915",
  "id": 1393677866,
  "node_id": "I_kwDOAOvK985TEdYq",
  "number": 25915,
  "title": "Blocks are always behind",
  "user": {
    "login": "messagebox-link",
    "id": 62049714,
    "node_id": "MDQ6VXNlcjYyMDQ5NzE0",
    "avatar_url": "https://avatars.githubusercontent.com/u/62049714?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/messagebox-link",
    "html_url": "https://github.com/messagebox-link",
    "followers_url": "https://api.github.com/users/messagebox-link/followers",
    "following_url": "https://api.github.com/users/messagebox-link/following{/other_user}",
    "gists_url": "https://api.github.com/users/messagebox-link/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/messagebox-link/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/messagebox-link/subscriptions",
    "organizations_url": "https://api.github.com/users/messagebox-link/orgs",
    "repos_url": "https://api.github.com/users/messagebox-link/repos",
    "events_url": "https://api.github.com/users/messagebox-link/events{/privacy}",
    "received_events_url": "https://api.github.com/users/messagebox-link/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 268304226,
      "node_id": "MDU6TGFiZWwyNjgzMDQyMjY=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:docs",
      "name": "type:docs",
      "color": "fef2c0",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-10-02T07:52:04Z",
  "updated_at": "2022-10-04T13:09:44Z",
  "closed_at": "2022-10-04T10:20:49Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Since the merger, the block has not been able to catch up with the latest block, and has always been behind by about 100 blocks. How should the configuration be used to catch up.\r\nNode runs on docker\r\ndocker-compose.yaml file :\r\n``` yaml\r\nversion: \"3\"\r\nservices:\r\n    beacon_node:\r\n        image: sigp/lighthouse:v3.1.2\r\n        volumes:\r\n          - /data/ligthouse:/root\r\n        ports:\r\n          - 127.0.0.1:5052:5052/tcp\r\n          - 9000:9000/tcp\r\n          - 9000:9000/udp\r\n        entrypoint: [\"lighthouse\", \"--network\", \"mainnet\", \"--datadir\", \"/root/\", \"beacon_node\", \"--http\", \"--http-address\", \"0.0.0.0\", \"--execution-endpoint\", \"http://geth:8551\", \"--execution-jwt\", \"/root/jwtsecret\"]\r\n        restart: on-failure\r\n        stop_grace_period: 3m\r\n    geth:\r\n        image: ethereum/client-go:v1.10.25\r\n        volumes:\r\n         - /data/geth-data:/root\r\n        ports:\r\n          - 30303:30303/tcp\r\n          - 30303:30303/udp\r\n          - 46834:46834/udp\r\n          - 8546:8546/tcp\r\n        expose:\r\n            - 8551\r\n        entrypoint: [\"geth\", \"--ipcdisable\", \"--syncmode\", \"snap\", \"--mainnet\", \"--datadir\", \"/root\", \"--http\",  \"--http.addr\", \"0.0.0.0\", \"--http.vhosts\", \"*\", \"--authrpc.addr\",\"0.0.0.0\", \"--authrpc.vhosts\": \"*\", \"--authrpc.jwtsecret\", \"/root/jwtsecret\", \"--http.api\", \"eth,net\", \"--ws\", \"--ws.addr\", \"0.0.0.0\", \"--ws.vhosts\", \"*\"]\r\n        restart: on-failure\r\n        stop_grace_period: 3m\r\n```\r\n\r\n\r\n#### Some check cases:\r\n\r\n1. By checking the consensus node synchronization status\r\n\r\n``` shell\r\n    Request: curl http://127.0.0.1:5052/lighthouse/syncing  \r\n    Result: {\"data\":\"Synced\"}\r\n```\r\n2. Obtaining finalized checkpoint & state root\r\n\r\n``` shell\r\n    Request: curl http://127.0.0.1:5052/eth/v1/beacon/headers/finalized \r\n    Result:  {\"execution_optimistic\":true,\"data\":{\"root\":\"0x5b14dff435f7d1775c51e979d21f1f32d6a0a34621ae59ea28e9951f56cc05bc\",\"canonical\":true,\"header\":{\"message\":{\"slot\":\"4822464\",\"proposer_index\":\"178599\",\"parent_root\":\"0xbafb6eb299e6853450d53f571a729d17915a1513eb551ad7ff2cba86c917eea8\",\"state_root\":\"0xd43efd1917a711ac5e5ea419ad44b41d96ffcc1f637c775cbbcf3bafebb807ec\",\"body_root\":\"0x73897dc8a0626973122df73e5ace05a6b9dcb5d6c373042222e46f22e785a5cc\"},\"signature\":\"0xa270f4461965fd571b02f0b9f80808ad9aa063ec961660b200225ffd770212a8a8dbb3e1f6c59286a56c4040f3144ed61326264248976421c47dafc94a4c3a7ba62161cc2882506c73845b732e327fcc24ec808f976dd28bea4fa9ff4f7b99d2\"}}}\r\n```\r\n3. Check execution node sync status\r\n\r\n```shell\r\n    Request: curl -X POST --data '{\"jsonrpc\": \"2.0\", \"method\":\"eth_syncing\", \"params\":[],\"id\": 1}' http://127.0.0.1:8545 -H \"Content-Type: application/json\"   \r\n    Result:  {\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"currentBlock\":\"0xeeef19\",\"healedBytecodeBytes\":\"0x2b2875f9\",\"healedBytecodes\":\"0x16d16\",\"healedTrienodeBytes\":\"0x29d7eedfc1\",\"healedTrienodes\":\"0x23e1c6f3\",\"healingBytecode\":\"0x0\",\"healingTrienodes\":\"0x461\",\"highestBlock\":\"0xeeef83\",\"startingBlock\":\"0xeed623\",\"syncedAccountBytes\":\"0x9b2c4360a\",\"syncedAccounts\":\"0xa5e0b6a\",\"syncedBytecodeBytes\":\"0xc418a4c4\",\"syncedBytecodes\":\"0x81bae\",\"syncedStorage\":\"0x26e0bebc\",\"syncedStorageBytes\":\"0x208521c47f\"}}\r\n```\r\n\r\n4. getSyncingStatus  \r\n\r\n```shell\r\n    Request: curl http://127.0.0.1:5052/lighthouse/eth1/syncing \r\n    Result: {\"data\":{\"head_block_number\":null,\"head_block_timestamp\":null,\"latest_cached_block_number\":null,\"latest_cached_block_timestamp\":null,\"voting_target_timestamp\":1664647255,\"eth1_node_sync_status_percentage\":0.0,\"lighthouse_is_cached_and_ready\":false}}\r\n```\r\n\r\n#### Some log information:\r\n1. beacon_node\r\n``` log\r\nbeacon_node_1  | Oct 02 07:29:52.247 WARN Execution endpoint is not synced        action: trying fallback, last_seen_block_unix_timestamp: 0, endpoint: http://geth:8551/, auth=true, service: deposit_contract_rpc                                                                             \r\nbeacon_node_1  | Oct 02 07:29:52.247 ERRO No synced execution endpoint            advice: ensure you have an execution node configured via --execution-endpoint or if pre-merge, --eth1-endpoints, service: deposit_contract_rpc                                                                \r\nbeacon_node_1  | Oct 02 07:29:52.247 ERRO Error updating deposit contract cache   error: \"All fallbacks errored: http://geth:8551/, auth=true => EndpointError(FarBehind)\", retry_millis: 60000, service: deposit_contract_rpc                                                                  \r\nbeacon_node_1  | Oct 02 07:29:53.001 WARN Head is optimistic                      execution_block_hash: 0x5d945e42ed84a6dd76c9461668e41a477384f2e967a9f9e19758266d75f469e1, info: chain not fully verified, block and attestation production disabled until execution engine syncs, service: slot_notifier                                                                                                                                      \r\nbeacon_node_1  | Oct 02 07:29:53.001 INFO Synced                                  slot: 4822647, block: 0xf17d…eea9, epoch: 150707, finalized_epoch: 150705, finalized_root: 0x28c6…8b0e, exec_hash: 0x5d94…69e1 (unverified), peers: 14, service: slot_notifier                                \r\nbeacon_node_1  | Oct 02 07:29:53.001 WARN Syncing deposit contract block cache    est_blocks_remaining: initializing deposits, service: slot_notifier                                                                                    \r\n\r\n```",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25915/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25915/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1266728585",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25915#issuecomment-1266728585",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25915",
    "id": 1266728585,
    "node_id": "IC_kwDOAOvK985LgL6J",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-04T10:20:49Z",
    "updated_at": "2022-10-04T10:20:49Z",
    "author_association": "MEMBER",
    "body": "Geth is still snap syncing (the healing phase). You can use the master branch to sync faster, it contains a lot of sync fixes. Otherwise it's just gonna take a bit more time.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1266728585/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1266972075",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25915#issuecomment-1266972075",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25915",
    "id": 1266972075,
    "node_id": "IC_kwDOAOvK985LhHWr",
    "user": {
      "login": "messagebox-link",
      "id": 62049714,
      "node_id": "MDQ6VXNlcjYyMDQ5NzE0",
      "avatar_url": "https://avatars.githubusercontent.com/u/62049714?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/messagebox-link",
      "html_url": "https://github.com/messagebox-link",
      "followers_url": "https://api.github.com/users/messagebox-link/followers",
      "following_url": "https://api.github.com/users/messagebox-link/following{/other_user}",
      "gists_url": "https://api.github.com/users/messagebox-link/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/messagebox-link/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/messagebox-link/subscriptions",
      "organizations_url": "https://api.github.com/users/messagebox-link/orgs",
      "repos_url": "https://api.github.com/users/messagebox-link/repos",
      "events_url": "https://api.github.com/users/messagebox-link/events{/privacy}",
      "received_events_url": "https://api.github.com/users/messagebox-link/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-04T13:09:44Z",
    "updated_at": "2022-10-04T13:09:44Z",
    "author_association": "NONE",
    "body": "> Geth is still snap syncing (the healing phase). You can use the master branch to sync faster, it contains a lot of sync fixes. Otherwise it's just gonna take a bit more time.\r\n\r\nYes, it has been synchronized normally, but should you modify the prompt information? The current prompt information is easy to cause misunderstandings",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1266972075/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
