{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23226",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23226/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23226/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23226/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/23226",
  "id": 946220413,
  "node_id": "MDU6SXNzdWU5NDYyMjA0MTM=",
  "number": 23226,
  "title": "geth 1.10.3 and newer download blocks much slower than previous versions on the same machine",
  "user": {
    "login": "imb590",
    "id": 24669202,
    "node_id": "MDQ6VXNlcjI0NjY5MjAy",
    "avatar_url": "https://avatars.githubusercontent.com/u/24669202?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/imb590",
    "html_url": "https://github.com/imb590",
    "followers_url": "https://api.github.com/users/imb590/followers",
    "following_url": "https://api.github.com/users/imb590/following{/other_user}",
    "gists_url": "https://api.github.com/users/imb590/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/imb590/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/imb590/subscriptions",
    "organizations_url": "https://api.github.com/users/imb590/orgs",
    "repos_url": "https://api.github.com/users/imb590/repos",
    "events_url": "https://api.github.com/users/imb590/events{/privacy}",
    "received_events_url": "https://api.github.com/users/imb590/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-07-16T11:48:15Z",
  "updated_at": "2021-07-16T13:31:31Z",
  "closed_at": "2021-07-16T13:31:31Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I'm running geth with `--syncmode=full --gcmode=archive cache=4096` on a Linux machine with 16Gb RAM and 15000 IOPS SSD. The versions 1.10.1 and 1.10.2 work absolutely fine, after initial synchronization it stays synchronized and gets new blocks within seconds after they are mined. After update to 1.10.3 or anything newer, however, the synchronization starts to lag, downloading a single block takes 25 to 75 seconds and synchronization logs look like this:\r\n\r\n```\r\nINFO [07-16|10:53:43.627] Imported new chain segment               blocks=1 txs=146 mgas=14.990 elapsed=33.948s     mgasps=0.442 number=12,832,490 hash=650557..e93214 age=18h46m28s dirty=0.00B\r\nINFO [07-16|10:54:30.040] Imported new chain segment               blocks=1 txs=152 mgas=14.973 elapsed=46.413s     mgasps=0.323 number=12,832,491 hash=24442d..b02bc8 age=18h47m12s dirty=0.00B\r\nINFO [07-16|10:55:06.575] Imported new chain segment               blocks=1 txs=158 mgas=14.962 elapsed=36.535s     mgasps=0.410 number=12,832,492 hash=02b437..2d3a90 age=18h47m34s dirty=0.00B\r\nINFO [07-16|10:55:52.481] Imported new chain segment               blocks=1 txs=187 mgas=14.944 elapsed=45.905s     mgasps=0.326 number=12,832,493 hash=382daa..6b97a5 age=18h48m3s  dirty=0.00B\r\nINFO [07-16|10:56:31.136] Imported new chain segment               blocks=1 txs=177 mgas=14.952 elapsed=38.655s     mgasps=0.387 number=12,832,494 hash=070b25..1b0f83 age=18h48m33s dirty=0.00B\r\nINFO [07-16|10:57:12.763] Imported new chain segment               blocks=1 txs=171 mgas=14.533 elapsed=41.626s     mgasps=0.349 number=12,832,495 hash=ed5beb..3a9f6d age=18h49m7s  dirty=0.00B\r\nINFO [07-16|10:57:52.758] Imported new chain segment               blocks=1 txs=164 mgas=14.766 elapsed=39.995s     mgasps=0.369 number=12,832,496 hash=ff7733..6b5ecf age=18h49m46s dirty=0.00B\r\nINFO [07-16|10:58:33.237] Imported new chain segment               blocks=1 txs=174 mgas=14.956 elapsed=40.478s     mgasps=0.369 number=12,832,497 hash=a3dcbf..6b29e6 age=18h50m17s dirty=0.00B\r\nINFO [07-16|10:59:16.703] Imported new chain segment               blocks=1 txs=202 mgas=14.542 elapsed=43.465s     mgasps=0.335 number=12,832,498 hash=510f3e..55fdca age=18h50m57s dirty=0.00B\r\nINFO [07-16|10:59:54.676] Imported new chain segment               blocks=1 txs=204 mgas=14.770 elapsed=37.973s     mgasps=0.389 number=12,832,499 hash=fb3488..20fff0 age=18h51m31s dirty=0.00B\r\n```\r\n\r\nFor comparison, after reverting to 1.10.1 on the same machine it looks like this:\r\n\r\n```\r\nINFO [07-16|11:16:12.073] Imported new chain segment               blocks=3 txs=583 mgas=44.345 elapsed=8.979s      mgasps=4.939 number=12832510 hash=\"37ac3a…0e745d\" age=19h6m23s dirty=0.00B\r\nINFO [07-16|11:16:20.394] Imported new chain segment               blocks=4 txs=1023 mgas=59.935 elapsed=8.321s      mgasps=7.203 number=12832514 hash=\"138636…b3f8fc\" age=19h5m43s dirty=0.00B\r\nINFO [07-16|11:16:24.961] Imported new chain segment               blocks=3 txs=552  mgas=44.711 elapsed=4.567s      mgasps=9.789 number=12832517 hash=\"0b4143…2ab7e9\" age=19h5m6s  dirty=0.00B\r\nINFO [07-16|11:16:35.225] Imported new chain segment               blocks=2 txs=297  mgas=27.892 elapsed=10.242s     mgasps=2.723 number=12832519 hash=\"0700c9…0d2c5c\" age=19h5m11s dirty=0.00B\r\nINFO [07-16|11:16:45.990] Imported new chain segment               blocks=3 txs=652  mgas=44.938 elapsed=10.764s     mgasps=4.175 number=12832522 hash=\"b5be4a…52d29c\" age=19h4m24s dirty=0.00B\r\nINFO [07-16|11:16:54.598] Imported new chain segment               blocks=4 txs=897  mgas=59.975 elapsed=8.607s      mgasps=6.967 number=12832526 hash=\"9f2eb8…b9facc\" age=19h3m49s dirty=0.00B\r\nINFO [07-16|11:17:03.009] Imported new chain segment               blocks=7  txs=1113 mgas=104.658 elapsed=8.411s      mgasps=12.442 number=12832533 hash=\"722f0b…6cf267\" age=19h2m27s dirty=0.00B\r\nINFO [07-16|11:17:12.389] Imported new chain segment               blocks=6  txs=1384 mgas=89.260  elapsed=9.380s      mgasps=9.516  number=12832539 hash=\"95129a…9c866e\" age=19h1m48s dirty=0.00B\r\nINFO [07-16|11:17:21.939] Imported new chain segment               blocks=7  txs=1341 mgas=104.829 elapsed=9.549s      mgasps=10.977 number=12832546 hash=\"abcd63…cda896\" age=19h12s   dirty=0.00B\r\nINFO [07-16|11:17:31.444] Imported new chain segment               blocks=6  txs=1157 mgas=89.908  elapsed=9.505s      mgasps=9.458  number=12832552 hash=\"c5c101…c9369b\" age=18h58m28s dirty=0.00B\r\n```\r\n\r\nWhat can cause such performance degradation on 1.10.3? Can it be related to eth/64 support removal?\r\n",
  "closed_by": {
    "login": "imb590",
    "id": 24669202,
    "node_id": "MDQ6VXNlcjI0NjY5MjAy",
    "avatar_url": "https://avatars.githubusercontent.com/u/24669202?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/imb590",
    "html_url": "https://github.com/imb590",
    "followers_url": "https://api.github.com/users/imb590/followers",
    "following_url": "https://api.github.com/users/imb590/following{/other_user}",
    "gists_url": "https://api.github.com/users/imb590/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/imb590/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/imb590/subscriptions",
    "organizations_url": "https://api.github.com/users/imb590/orgs",
    "repos_url": "https://api.github.com/users/imb590/repos",
    "events_url": "https://api.github.com/users/imb590/events{/privacy}",
    "received_events_url": "https://api.github.com/users/imb590/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23226/reactions",
    "total_count": 1,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 1,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23226/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/881452675",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23226#issuecomment-881452675",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23226",
    "id": 881452675,
    "node_id": "IC_kwDOAOvK9840ieaD",
    "user": {
      "login": "imb590",
      "id": 24669202,
      "node_id": "MDQ6VXNlcjI0NjY5MjAy",
      "avatar_url": "https://avatars.githubusercontent.com/u/24669202?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/imb590",
      "html_url": "https://github.com/imb590",
      "followers_url": "https://api.github.com/users/imb590/followers",
      "following_url": "https://api.github.com/users/imb590/following{/other_user}",
      "gists_url": "https://api.github.com/users/imb590/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/imb590/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/imb590/subscriptions",
      "organizations_url": "https://api.github.com/users/imb590/orgs",
      "repos_url": "https://api.github.com/users/imb590/repos",
      "events_url": "https://api.github.com/users/imb590/events{/privacy}",
      "received_events_url": "https://api.github.com/users/imb590/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-16T13:31:31Z",
    "updated_at": "2021-07-16T13:31:31Z",
    "author_association": "NONE",
    "body": "duplicate of #22839",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/881452675/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
