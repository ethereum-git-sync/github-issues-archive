{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2401",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2401/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2401/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2401/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/2401",
  "id": 144981530,
  "node_id": "MDU6SXNzdWUxNDQ5ODE1MzA=",
  "number": 2401,
  "title": "p2p/discover: vicious loop with local node inserted into kademlia table",
  "user": {
    "login": "christoph2806",
    "id": 431015,
    "node_id": "MDQ6VXNlcjQzMTAxNQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/431015?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/christoph2806",
    "html_url": "https://github.com/christoph2806",
    "followers_url": "https://api.github.com/users/christoph2806/followers",
    "following_url": "https://api.github.com/users/christoph2806/following{/other_user}",
    "gists_url": "https://api.github.com/users/christoph2806/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/christoph2806/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/christoph2806/subscriptions",
    "organizations_url": "https://api.github.com/users/christoph2806/orgs",
    "repos_url": "https://api.github.com/users/christoph2806/repos",
    "events_url": "https://api.github.com/users/christoph2806/events{/privacy}",
    "received_events_url": "https://api.github.com/users/christoph2806/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "fjl",
    "id": 6915,
    "node_id": "MDQ6VXNlcjY5MTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fjl",
    "html_url": "https://github.com/fjl",
    "followers_url": "https://api.github.com/users/fjl/followers",
    "following_url": "https://api.github.com/users/fjl/following{/other_user}",
    "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
    "organizations_url": "https://api.github.com/users/fjl/orgs",
    "repos_url": "https://api.github.com/users/fjl/repos",
    "events_url": "https://api.github.com/users/fjl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fjl/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/milestones/29",
    "html_url": "https://github.com/ethereum/go-ethereum/milestone/29",
    "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/milestones/29/labels",
    "id": 1721558,
    "node_id": "MDk6TWlsZXN0b25lMTcyMTU1OA==",
    "number": 29,
    "title": "1.4.1",
    "description": "",
    "creator": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 16,
    "state": "closed",
    "created_at": "2016-04-20T21:44:45Z",
    "updated_at": "2016-05-10T10:44:27Z",
    "due_on": null,
    "closed_at": "2016-05-10T10:44:27Z"
  },
  "comments": 2,
  "created_at": "2016-03-31T18:31:40Z",
  "updated_at": "2016-05-10T09:57:45Z",
  "closed_at": "2016-05-10T09:57:39Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\n\nGeth version: \nVersion: 1.3.5\nProtocol Versions: [63 62 61]\nNetwork Id: 1\nGo Version: go1.5.1\nOS: windows\nGOPATH=\nGOROOT=c:\\go\nOS & Version: Windows 7\n#### Expected behaviour\n\nGeth starts with empty blockchain and syncs up to the last best block.\n#### Actual behaviour\n\nGeth starts, syncs up to block 82656 and then looses connection to all peers. \nI watched geth syncing using the console and command admin.peers.\nAt the beginning, I have 5-9 active peers. After about 20minutes, the number of peers decreases, then only one peer is left, then 0 peers. Geth never recovers or finds new nodes afterwards.\n\nIf I install a file \"static-nodes.json\" (see below) in the datadir with some node addresses, geth succeeds in a full sync of the blockchain. \n#### Steps to reproduce the behaviour\n\nInstall Mist 0.5.2.\ncd Ethereum-Wallet-win64-0-5-2\\resources\\node\\geth\ngeth -verbosity \"6\" console 2>>log.txt\n\n(a shortened log is attached, the original log is about 80MB).\n#### Backtrace\n\nn/a\n\n[static-nodes.json.txt](https://github.com/ethereum/go-ethereum/files/198343/static-nodes.json.txt)\n[log_short.txt](https://github.com/ethereum/go-ethereum/files/198331/log_short.txt)\n",
  "closed_by": {
    "login": "obscuren",
    "id": 6264126,
    "node_id": "MDQ6VXNlcjYyNjQxMjY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6264126?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/obscuren",
    "html_url": "https://github.com/obscuren",
    "followers_url": "https://api.github.com/users/obscuren/followers",
    "following_url": "https://api.github.com/users/obscuren/following{/other_user}",
    "gists_url": "https://api.github.com/users/obscuren/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/obscuren/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/obscuren/subscriptions",
    "organizations_url": "https://api.github.com/users/obscuren/orgs",
    "repos_url": "https://api.github.com/users/obscuren/repos",
    "events_url": "https://api.github.com/users/obscuren/events{/privacy}",
    "received_events_url": "https://api.github.com/users/obscuren/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2401/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2401/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/205218780",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2401#issuecomment-205218780",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2401",
    "id": 205218780,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIwNTIxODc4MA==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-04-04T09:50:55Z",
    "updated_at": "2016-04-04T09:50:55Z",
    "author_association": "MEMBER",
    "body": "@fjl This may actually be the log we've been so keen on receiving.\n\nThey show that the node manages to place itself and itself only in its discovery table, which results in only asking itself for remote nodes, which seems to return itself again. This results in some weird scenario where the bootnodes aren't consulted any more and we constantly self-discover and self-connect.\n\nAt least this is the scenario that looks likely to me if you check that the single remaining node at the end of the log is actually the current node's enode ide (if you check the start of the log).\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/205218780/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/205242249",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2401#issuecomment-205242249",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2401",
    "id": 205242249,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIwNTI0MjI0OQ==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-04-04T10:59:26Z",
    "updated_at": "2016-04-04T10:59:26Z",
    "author_association": "MEMBER",
    "body": "Thanks for the analysis. We should definitely fix this case (how did the local node even get into the table?). Before it goes into this loop though, it exhausts the cache of previously known nodes and receives very few replies. My guess is that machine time is in the past as well.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/205242249/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
