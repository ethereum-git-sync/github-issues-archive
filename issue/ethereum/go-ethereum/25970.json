{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25970",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25970/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25970/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25970/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/25970",
  "id": 1405345263,
  "node_id": "I_kwDOAOvK985Tw93v",
  "number": 25970,
  "title": "geth cache width CPU",
  "user": {
    "login": "Black-Memory",
    "id": 18435334,
    "node_id": "MDQ6VXNlcjE4NDM1MzM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/18435334?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Black-Memory",
    "html_url": "https://github.com/Black-Memory",
    "followers_url": "https://api.github.com/users/Black-Memory/followers",
    "following_url": "https://api.github.com/users/Black-Memory/following{/other_user}",
    "gists_url": "https://api.github.com/users/Black-Memory/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Black-Memory/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Black-Memory/subscriptions",
    "organizations_url": "https://api.github.com/users/Black-Memory/orgs",
    "repos_url": "https://api.github.com/users/Black-Memory/repos",
    "events_url": "https://api.github.com/users/Black-Memory/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Black-Memory/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 268304226,
      "node_id": "MDU6TGFiZWwyNjgzMDQyMjY=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:docs",
      "name": "type:docs",
      "color": "fef2c0",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-10-11T23:24:14Z",
  "updated_at": "2022-10-13T08:43:27Z",
  "closed_at": "2022-10-13T08:43:26Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Configuration: 32 cores, 1.8T SSD disk, memory 257G, geth 1.10.25\r\nEnable configuration for the first time\r\n\r\n```\r\ngeth --cache 30720 --datadir /data/eth/geth --http --http.port 8545 --http.vhosts '*' --http.corsdomain '*' --http.api eth,web3,net - -ws --ws.addr 0.0.0.0 --ws.port 8545 --ws.api eth,net,web3 --ws.origins '*' --graphql --graphql.corsdomain '*' --graphql.vhosts '*' --authrpc.jwtsecret=/data/eth/jwtsecret --allow-insecure-unlock\r\n```\r\n\r\nSecond enable configuration\r\n\r\n```\r\ngeth --cache 4096 --datadir /data/eth/geth --http --http.port 8545 --http.vhosts '*' --http.corsdomain '*' --http.api eth,web3,net - -ws --ws.addr 0.0.0.0 --ws.port 8545 --ws.api eth,net,web3 --ws.origins '*' --graphql --graphql.corsdomain '*' --graphql.vhosts '*' --authrpc.jwtsecret=/data/eth/jwtsecret --allow-insecure-unlock\r\n```\r\n\r\nThe CPU would be fully loaded before. In order to find the problem, I modified the cache configuration. After restarting, the CPU obviously increased, and 100% will not appear. Is there any problem here?\r\n![image](https://user-images.githubusercontent.com/18435334/195216188-1f1fe84a-d121-4a2e-a4d9-d8f17dcc2add.png)\r\n",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25970/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25970/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1275515457",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25970#issuecomment-1275515457",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25970",
    "id": 1275515457,
    "node_id": "IC_kwDOAOvK985MBtJB",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-12T02:53:22Z",
    "updated_at": "2022-10-12T02:53:22Z",
    "author_association": "MEMBER",
    "body": "Thanks for the report. It might be relevant with the cache library we are using and should be worthwhile for investigation.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1275515457/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1276913341",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25970#issuecomment-1276913341",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25970",
    "id": 1276913341,
    "node_id": "IC_kwDOAOvK985MHCa9",
    "user": {
      "login": "jsvisa",
      "id": 3627395,
      "node_id": "MDQ6VXNlcjM2MjczOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3627395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jsvisa",
      "html_url": "https://github.com/jsvisa",
      "followers_url": "https://api.github.com/users/jsvisa/followers",
      "following_url": "https://api.github.com/users/jsvisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/jsvisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jsvisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jsvisa/subscriptions",
      "organizations_url": "https://api.github.com/users/jsvisa/orgs",
      "repos_url": "https://api.github.com/users/jsvisa/repos",
      "events_url": "https://api.github.com/users/jsvisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jsvisa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-13T01:31:43Z",
    "updated_at": "2022-10-13T01:31:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "@Black-Memory could you please give more metrics about the before && after's geth's status, eg: \r\n\r\n- syncing status;\r\n- rpc requests;\r\n- ...\r\n\r\nIf you have enabled Prometheus + Grafana, maybe you can use [dashboards/13877-single-geth-dashboard/)](https://grafana.com/grafana/dashboards/13877-single-geth-dashboard/) to view more metrics.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1276913341/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1277254972",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25970#issuecomment-1277254972",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25970",
    "id": 1277254972,
    "node_id": "IC_kwDOAOvK985MIV08",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-13T08:43:26Z",
    "updated_at": "2022-10-13T08:43:26Z",
    "author_association": "MEMBER",
    "body": "Having `30G` cache instead of `4` means we juggle a lot more data in-app. We do more work on pruning, and leveldb has a lot more memory caches to search. Less memory means we wait more for IO. \r\n\r\nYou also seem to have exposed ws on the public `0.0.0.0` interface. Is it possible that someone was performing resource-intensive queries until you shut it off? \r\n\r\nAlso, the logs from when it was doing 100% would be relevant. Not much we can say at this point. When geth is in sync and just processing blocks every now and then, it should look more like it does on the latter end, than the former end. \r\n\r\nI don't see any actionable item from us here. I'm closing, but feel free to reopen if you think there's some bug here that I'm missing, and that you can provide information about. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1277254972/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
