{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16507",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16507/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16507/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16507/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/16507",
  "id": 314468877,
  "node_id": "MDU6SXNzdWUzMTQ0Njg4Nzc=",
  "number": 16507,
  "title": "Don't silently accept RPC requests directed to IP address",
  "user": {
    "login": "lionello",
    "id": 591860,
    "node_id": "MDQ6VXNlcjU5MTg2MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/591860?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/lionello",
    "html_url": "https://github.com/lionello",
    "followers_url": "https://api.github.com/users/lionello/followers",
    "following_url": "https://api.github.com/users/lionello/following{/other_user}",
    "gists_url": "https://api.github.com/users/lionello/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/lionello/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/lionello/subscriptions",
    "organizations_url": "https://api.github.com/users/lionello/orgs",
    "repos_url": "https://api.github.com/users/lionello/repos",
    "events_url": "https://api.github.com/users/lionello/events{/privacy}",
    "received_events_url": "https://api.github.com/users/lionello/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2018-04-16T00:48:23Z",
  "updated_at": "2018-12-14T09:41:30Z",
  "closed_at": "2018-12-14T09:41:30Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "I was surprised to discover that `--rpcvhosts` does not prevent connection by IP address. I could connect with `http://127.0.0.1:8545` even though `--rpcvhosts` defaults to `localhost`.\r\n\r\nThis line seems to suggest that this behavior was intentional: https://github.com/ethereum/go-ethereum/blob/e9b5e22ad121ef2251d1c72526c0994c03d2caf0/rpc/http.go#L234\r\n\r\n## Actual:\r\nRPC requests directed to host's IP address, with `Host` header set, are always accepted, even when `--rpcvhosts` explicitly mentions which host names to serve.\r\n\r\n## Expected:\r\nThe `Host` header of all RPC requests should be checked against the `--rpcvhosts` or `HTTPVirtualHosts` settings, regardless of whether it's an IP address or host name.\r\n",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16507/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16507/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/383035773",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16507#issuecomment-383035773",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16507",
    "id": 383035773,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MzAzNTc3Mw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-20T09:09:53Z",
    "updated_at": "2018-04-20T09:09:53Z",
    "author_association": "MEMBER",
    "body": "The `rpcvhosts` setting is in place to prevent dns rebinding attacks. Raw ip addresses are not subject to DNS rebinding attacks, hence it is allowed. \r\nIf we were to change that behaviour, it would mean that all users everywhere would run into problems attaching to their nodes. \r\n\r\nCan you explain why you would want this behaviour to change? I do not see any drawbacks with it being the way it is, but perhaps I'm overlooking something. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/383035773/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/389028035",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16507#issuecomment-389028035",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16507",
    "id": 389028035,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4OTAyODAzNQ==",
    "user": {
      "login": "lionello",
      "id": 591860,
      "node_id": "MDQ6VXNlcjU5MTg2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/591860?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lionello",
      "html_url": "https://github.com/lionello",
      "followers_url": "https://api.github.com/users/lionello/followers",
      "following_url": "https://api.github.com/users/lionello/following{/other_user}",
      "gists_url": "https://api.github.com/users/lionello/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lionello/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lionello/subscriptions",
      "organizations_url": "https://api.github.com/users/lionello/orgs",
      "repos_url": "https://api.github.com/users/lionello/repos",
      "events_url": "https://api.github.com/users/lionello/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lionello/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-15T03:03:11Z",
    "updated_at": "2018-05-15T03:03:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "@holiman  I hadn't noticed that this feature was only for preventing DNS-rebinding attacks. I found it useful to prevent robots from connecting to RPC on nodes that are found through the usual Ethereum network peer discovery.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/389028035/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/447270575",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16507#issuecomment-447270575",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16507",
    "id": 447270575,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NzI3MDU3NQ==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-14T09:40:39Z",
    "updated_at": "2018-12-14T09:40:39Z",
    "author_association": "MEMBER",
    "body": "Sorry for not answering until now, I didn't notice your response. \r\nSo, the `rpcvhosts` is not the correct protection mechanism against an attacker which can create fully custom arbitrary requests. It is solely meant to prevent attacks originating from your own browser, where the attacker (a webpage) has certain restrictions about what types of requests can be made. \r\n\r\nIf an attacker has your ip, and you are allowing network traffic over the port, then it's a bit futile to rely on rpcvhosts as a protection mechanism: the only thing preventing the attacker from interacting with your node is that he doesn't know the correct name to use. \r\n\r\nHowever, if you have a public DNS, then a simple RDNS lookup would yield it, and the attacker could also try to bruteforce names. I'm not even sure that we don't leak it ourselves in certain circumstance, e.g. if we supply origin headers in the responses and the same origin is used as the vhost. \r\n\r\nSo it's kind of solving the wrong problem and giving people a false sense of security. A better approach is to simply not allow internet access ot the port(s). ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/447270575/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
