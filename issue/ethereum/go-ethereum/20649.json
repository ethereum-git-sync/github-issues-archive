{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20649",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20649/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20649/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20649/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/20649",
  "id": 563459812,
  "node_id": "MDU6SXNzdWU1NjM0NTk4MTI=",
  "number": 20649,
  "title": "`eth_estimateGas` uses impossible `block.number`.",
  "user": {
    "login": "3esmit",
    "id": 224810,
    "node_id": "MDQ6VXNlcjIyNDgxMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/3esmit",
    "html_url": "https://github.com/3esmit",
    "followers_url": "https://api.github.com/users/3esmit/followers",
    "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
    "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
    "organizations_url": "https://api.github.com/users/3esmit/orgs",
    "repos_url": "https://api.github.com/users/3esmit/repos",
    "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
    "received_events_url": "https://api.github.com/users/3esmit/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1157707837,
      "node_id": "MDU6TGFiZWwxMTU3NzA3ODM3",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/area:rpc",
      "name": "area:rpc",
      "color": "d4c5f9",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 10,
  "created_at": "2020-02-11T20:32:37Z",
  "updated_at": "2020-10-23T14:03:00Z",
  "closed_at": "2020-07-09T08:54:19Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### Expected behaviour\r\n\r\n`eth_estimateGas` should use the pending `block.number`;\r\n\r\n#### Actual behaviour\r\n\r\n`eth_estimateGas` uses the latest `block.number`, making estimations fail in certain conditions.\r\n\r\n#### Steps to reproduce the behavior\r\n\r\n1. Create a contract which check if last changed block is current block number, if no, do a very expansive operation, if yes, do a very cheap operation & deploy it.\r\n2. Estimate at first block & submit: success transaction/estimation\r\n3. Estimate while the latest block is still the last change block in the contract & submit: failed transaction/estimation.\r\n\r\nI am working on a test contract and script to demonstrate and test the issue, which I will update here. \r\n\r\n#### Notes \r\n\r\nThe same behavior should be applied to `eth_call`. \r\n\r\nDetails on how the bug was found and affects users here: https://github.com/status-im/status-go/issues/1849",
  "closed_by": {
    "login": "rjl493456442",
    "id": 5959481,
    "node_id": "MDQ6VXNlcjU5NTk0ODE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rjl493456442",
    "html_url": "https://github.com/rjl493456442",
    "followers_url": "https://api.github.com/users/rjl493456442/followers",
    "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
    "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
    "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
    "repos_url": "https://api.github.com/users/rjl493456442/repos",
    "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20649/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20649/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/584853607",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20649#issuecomment-584853607",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20649",
    "id": 584853607,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NDg1MzYwNw==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-11T21:10:05Z",
    "updated_at": "2020-02-11T21:10:05Z",
    "author_association": "NONE",
    "body": "Looks like it should be using pending block: https://github.com/ethereum/go-ethereum/blob/master/internal/ethapi/api.go#L1423-L1424\r\n\r\nI assume that the API is being used here, so pending block don't need to be passed https://github.com/ethereum/go-ethereum/blob/master/accounts/abi/bind/base.go#L221-L222\r\n\r\nGraphQL seems to be correct  https://github.com/ethereum/go-ethereum/blob/master/graphql/graphql.go#L887-L888\r\n\r\n\r\nAll seems good here... ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/584853607/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/585111456",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20649#issuecomment-585111456",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20649",
    "id": 585111456,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NTExMTQ1Ng==",
    "user": {
      "login": "ligi",
      "id": 111600,
      "node_id": "MDQ6VXNlcjExMTYwMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/111600?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ligi",
      "html_url": "https://github.com/ligi",
      "followers_url": "https://api.github.com/users/ligi/followers",
      "following_url": "https://api.github.com/users/ligi/following{/other_user}",
      "gists_url": "https://api.github.com/users/ligi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ligi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ligi/subscriptions",
      "organizations_url": "https://api.github.com/users/ligi/orgs",
      "repos_url": "https://api.github.com/users/ligi/repos",
      "events_url": "https://api.github.com/users/ligi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ligi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-12T09:24:48Z",
    "updated_at": "2020-02-12T09:24:48Z",
    "author_association": "MEMBER",
    "body": "Thanks for the report! Just wondering: is status also using a multiplicator like MetaMask is  doing (currently 1.5 AFAIR) - because otherwise even if pending-block is used there is still a way to fail. E.g. when 2 transactions are submitted at the sameIsh time one with a lower-fee - one with a higher fee - then you basically can end up in the same situation. Also do not like these multiplicators (and the attached magic numbers) - but currently also do not see a good way out of this. That said I agree that we should use the pending-block here.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/585111456/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/585630235",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20649#issuecomment-585630235",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20649",
    "id": 585630235,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NTYzMDIzNQ==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-13T09:22:34Z",
    "updated_at": "2020-02-13T09:22:34Z",
    "author_association": "MEMBER",
    "body": "Odd, it does seem like it's already using the pending: https://github.com/ethereum/go-ethereum/blob/master/internal/ethapi/api.go#L952 ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/585630235/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/585650074",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20649#issuecomment-585650074",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20649",
    "id": 585650074,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NTY1MDA3NA==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-13T10:09:57Z",
    "updated_at": "2020-02-13T10:09:57Z",
    "author_association": "NONE",
    "body": "I noticed that in your sources is using pending block. \r\n\r\nDo you know if this is a recent change? status-go might be used an outdated version. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/585650074/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/585652004",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20649#issuecomment-585652004",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20649",
    "id": 585652004,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NTY1MjAwNA==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-13T10:14:37Z",
    "updated_at": "2020-02-13T10:14:37Z",
    "author_association": "NONE",
    "body": "Ah, got it... there is a race condition there... \r\n\r\nIts possible that, sometimes, when pending block is retrieved a block just get mined, and this block number is then passed to gas estimate which would use the latest block, causing the wrong estimation.\r\n\r\nInstead of using \"pending block\", maybe a flag should be passed to estimator, like block number = \"0xFFFFFFFFFFF\", where it would understand it should use the pending block for estimation.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/585652004/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/656001714",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20649#issuecomment-656001714",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20649",
    "id": 656001714,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NjAwMTcxNA==",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-09T08:54:19Z",
    "updated_at": "2020-07-09T08:54:19Z",
    "author_association": "MEMBER",
    "body": "> Instead of using \"pending block\", maybe a flag should be passed to estimator, like block number = \"0xFFFFFFFFFFF\"\r\n\r\nUsing an arbitrary number won't fix this issue.  Also the scenario you describe is hard to be fixed in the Geth side. \r\nFor Geth we can only return a gas estimation based on the current pending block(or whatever state specified by API). \r\n\r\nWhen you submit the transaction with the suggested gas limit, but in this time the block state is changed(include more blocks) so that the original gas limit doesn't work. I think it's more or less an issue at the application level. \r\n\r\nSo I will close the issue now, but feel free to reopen it.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/656001714/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/656020079",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20649#issuecomment-656020079",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20649",
    "id": 656020079,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NjAyMDA3OQ==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-09T09:29:51Z",
    "updated_at": "2020-07-09T09:30:44Z",
    "author_association": "NONE",
    "body": "I don't see how this could be fixed at application level, as application cannot foresee the condition, as it's caused by the gas being calculated considering that multiple pending transactions will occur in the same block, when in reality they usually happen in different blocks (depends on miners).\r\n\r\nThe only way to \"fix this at application level\" would be to use a hard coded gas limit for the \"worst condition\", therefore I consider it's a bug in the `eth_estimateGas`, not in the application level. \r\n\r\nThis bug will cause random transaction fails out of gas due wrong calculation of gas by geth.\r\n\r\n\r\n# Reproduction\r\n1. Create a contract which check if last changed block is current block number, if no, do a very expansive operation, if yes, do a very cheap operation & deploy it.\r\n2. Estimate at first block & submit: success transaction/estimation\r\n3. Estimate while the latest block is still the last change block in the contract & submit: failed transaction/estimation.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/656020079/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/656462393",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20649#issuecomment-656462393",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20649",
    "id": 656462393,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NjQ2MjM5Mw==",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-10T03:33:57Z",
    "updated_at": "2020-07-10T03:33:57Z",
    "author_association": "MEMBER",
    "body": "@3esmit If I understand correctly, the contract has a very high execution environment dependence.\r\n\r\n> if last changed block is current block number, do A; else do B\r\n\r\nWe can never give the correct estimation because we can't decide whether these two transactions will\r\nbe eventually put into the same block. \r\n\r\nTo be honest, I would suggest the change in the contract level.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/656462393/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/656677399",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20649#issuecomment-656677399",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20649",
    "id": 656677399,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NjY3NzM5OQ==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-10T13:29:36Z",
    "updated_at": "2020-07-10T13:29:36Z",
    "author_association": "NONE",
    "body": "The contract is an ERC20 token, MiniMeToken. The function failing to gas estimate is the transfer. \r\n\r\nMiniMeToken saves the balance of the accounts on each block. When estimate function runs and it consider that there are two transactions to/from the same address, it will be cheaper to update then to add a new position, so it would calculate a lower gas cost. \r\n\r\nTransactions should be estimated as they are isolated in the block. \r\n\r\n\r\nThis is the estimation that have lower cost https://github.com/Giveth/minime/blob/ea04d950eea153a04c51fa510b068b9dded390cb/contracts/MiniMeToken.sol#L459\r\n\r\nAnd this is the normal case, a new entry to the array https://github.com/Giveth/minime/blob/ea04d950eea153a04c51fa510b068b9dded390cb/contracts/MiniMeToken.sol#L455",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/656677399/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/715362155",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20649#issuecomment-715362155",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20649",
    "id": 715362155,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNTM2MjE1NQ==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-23T14:03:00Z",
    "updated_at": "2020-10-23T14:03:00Z",
    "author_association": "NONE",
    "body": "I don't think this should be closed. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/715362155/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
