{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17431",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17431/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17431/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17431/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/17431",
  "id": 351684976,
  "node_id": "MDU6SXNzdWUzNTE2ODQ5NzY=",
  "number": 17431,
  "title": "debug.traceTransaction with reexec crashes",
  "user": {
    "login": "computerality",
    "id": 464609,
    "node_id": "MDQ6VXNlcjQ2NDYwOQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/464609?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/computerality",
    "html_url": "https://github.com/computerality",
    "followers_url": "https://api.github.com/users/computerality/followers",
    "following_url": "https://api.github.com/users/computerality/following{/other_user}",
    "gists_url": "https://api.github.com/users/computerality/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/computerality/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/computerality/subscriptions",
    "organizations_url": "https://api.github.com/users/computerality/orgs",
    "repos_url": "https://api.github.com/users/computerality/repos",
    "events_url": "https://api.github.com/users/computerality/events{/privacy}",
    "received_events_url": "https://api.github.com/users/computerality/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2018-08-17T17:54:47Z",
  "updated_at": "2018-08-21T19:58:18Z",
  "closed_at": "2018-08-21T19:58:18Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "\r\n#### System information\r\n\r\nGeth version: `geth version`\r\n```\r\nVersion: 1.8.12-stable\r\nGit Commit: 37685930d953bcbe023f9bc65b135a8d8b8f1488\r\nArchitecture: amd64\r\nProtocol Versions: [63 62]\r\nNetwork Id: 1\r\nGo Version: go1.10.3\r\nOperating System: linux\r\nGOPATH=\r\nGOROOT=/home/travis/.gimme/versions/go1.10.3.linux.amd64\r\n```\r\n\r\nOS & Version: Linux\r\nCommit hash : (if `develop`)\r\n\r\n#### Expected behaviour\r\nA trace returned \r\n\r\n#### Actual behaviour\r\ngeth crashes on a null deref\r\n\r\n#### Steps to reproduce the behaviour\r\nRun geth with `./geth --cache 2048  --syncmode=full --gcmode=archive`\r\n\r\nExecute this in the geth attach console:\r\n`debug.traceTransaction('0xf49e45d3ddc33432f14b156d9fd30fba52c17a6562ec57eaf1f2bcede94c8eb7', {reexec:6000000})`\r\n\r\n#### Backtrace\r\n\r\n````\r\n[backtrace]\r\nINFO [08-05|12:51:54.611] Regenerating historical state            block=2087976 target=2378876 elapsed=892ns\r\npanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x18 pc=0x69d00e]\r\n\r\ngoroutine 2818 [running]:\r\ngithub.com/ethereum/go-ethereum/trie.(*Database).reference(...)\r\n        /home/travis/gopath/src/github.com/ethereum/go-ethereum/trie/database.go:423\r\ngithub.com/ethereum/go-ethereum/trie.(*Database).Reference(0xc4efc03680, 0x28f3d621d5fc274b, 0xd5978f1247278fe9, 0xdda1357433f5cd0f, 0x77f4fbd53a73065c, 0x0, 0x0, 0x0, 0x0)\r\n        /home/travis/gopath/src/github.com/ethereum/go-ethereum/trie/database.go:412 +0x18e\r\ngithub.com/ethereum/go-ethereum/eth.(*PrivateDebugAPI).computeStateDB(0xc422287420, 0xc47664da70, 0x5b8d80, 0x80342b59eeb74931, 0x3c9d831662bfd1ac, 0x244c7c)\r\n        /home/travis/gopath/src/github.com/ethereum/go-ethereum/eth/api_tracer.go:528 +0x4e9\r\ngithub.com/ethereum/go-ethereum/eth.(*PrivateDebugAPI).computeTxEnv(0xc422287420, 0x5fcaba9a2e8d564e, 0x791342efca6fff4, 0x1dbae953d52f8df0, 0x9946cf265ea8a0b6, 0x8, 0x5b8d80, 0x5fcaba9a2e8d564e, 0x791342efca6fff4, 0x0, ...)\r\n        /home/travis/gopath/src/github.com/ethereum/go-ethereum/eth/api_tracer.go:629 +0x184\r\ngithub.com/ethereum/go-ethereum/eth.(*PrivateDebugAPI).TraceTransaction(0xc422287420, 0x10c8a60, 0xc484094b10, 0x3234c3ddd3459ef4, 0xba0fd39f6d154bf1, 0xea57ec62657ac152, 0xb78e4ce9edbcf2f1, 0xc48996ce60, 0x0, 0x0, ...)\r\n        /home/travis/gopath/src/github.com/ethereum/go-ethereum/eth/api_tracer.go:549 +0x16c\r\nreflect.Value.call(0xc4275c9180, 0xc4275b90c8, 0x13, 0xf38b2d, 0x4, 0xc445f13da0, 0x4, 0x4, 0xc42036bd80, 0xc445f13da0, ...)\r\n        /home/travis/.gimme/versions/go1.10.3.linux.amd64/src/reflect/value.go:447 +0x969\r\nreflect.Value.Call(0xc4275c9180, 0xc4275b90c8, 0x13, 0xc445f13da0, 0x4, 0x4, 0x2, 0x2, 0x941d31af3d)\r\n        /home/travis/.gimme/versions/go1.10.3.linux.amd64/src/reflect/value.go:308 +0xa4\r\ngithub.com/ethereum/go-ethereum/rpc.(*Server).handle(0xc4275e1060, 0x10c8a60, 0xc484094b10, 0x10cdd00, 0xc454a9db80, 0xc445f13d40, 0xc42036bf38, 0x43f799, 0x8)\r\n        /home/travis/gopath/src/github.com/ethereum/go-ethereum/rpc/server.go:312 +0x676\r\ngithub.com/ethereum/go-ethereum/rpc.(*Server).exec(0xc4275e1060, 0x10c8a60, 0xc484094b10, 0x10cdd00, 0xc454a9db80, 0xc445f13d40)\r\n        /home/travis/gopath/src/github.com/ethereum/go-ethereum/rpc/server.go:333 +0x1a6\r\ngithub.com/ethereum/go-ethereum/rpc.(*Server).serveRequest.func2(0xc46cbc0a20, 0xc4275e1060, 0xc481a8f870, 0x10cdd00, 0xc454a9db80, 0xc49eeeaef8, 0x1, 0x1, 0x0)\r\n        /home/travis/gopath/src/github.com/ethereum/go-ethereum/rpc/server.go:207 +0xad\r\ncreated by github.com/ethereum/go-ethereum/rpc.(*Server).serveRequest\r\n        /home/travis/gopath/src/github.com/ethereum/go-ethereum/rpc/server.go:202 +0x2b7\r\n````\r\n",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17431/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17431/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/413967893",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17431#issuecomment-413967893",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17431",
    "id": 413967893,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMzk2Nzg5Mw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-17T19:35:31Z",
    "updated_at": "2018-08-17T19:35:31Z",
    "author_association": "MEMBER",
    "body": "I suspect this is a duplicate of https://github.com/ethereum/go-ethereum/issues/17355 (which is fixed already)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/413967893/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/414268752",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17431#issuecomment-414268752",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17431",
    "id": 414268752,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNDI2ODc1Mg==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-20T10:21:02Z",
    "updated_at": "2018-08-20T10:21:02Z",
    "author_association": "MEMBER",
    "body": "Yes, this was already fixed on master. Will be shipped today or tomorrow.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/414268752/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
