{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/2358",
  "id": 141358268,
  "node_id": "MDU6SXNzdWUxNDEzNTgyNjg=",
  "number": 2358,
  "title": "Too many open files , leading to panic",
  "user": {
    "login": "azulmarino",
    "id": 17141152,
    "node_id": "MDQ6VXNlcjE3MTQxMTUy",
    "avatar_url": "https://avatars.githubusercontent.com/u/17141152?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/azulmarino",
    "html_url": "https://github.com/azulmarino",
    "followers_url": "https://api.github.com/users/azulmarino/followers",
    "following_url": "https://api.github.com/users/azulmarino/following{/other_user}",
    "gists_url": "https://api.github.com/users/azulmarino/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/azulmarino/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/azulmarino/subscriptions",
    "organizations_url": "https://api.github.com/users/azulmarino/orgs",
    "repos_url": "https://api.github.com/users/azulmarino/repos",
    "events_url": "https://api.github.com/users/azulmarino/events{/privacy}",
    "received_events_url": "https://api.github.com/users/azulmarino/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 20,
  "created_at": "2016-03-16T18:20:17Z",
  "updated_at": "2016-11-23T10:31:03Z",
  "closed_at": "2016-08-25T13:42:39Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\n\nGeth version: `1.3.5`\nOS & Version: /OSX - El Capitan\nCommit hash : (if `develop`)\n#### Expected behaviour\n\nNever exhausted open file count on previous version.\nAre more resources being used ?\n#### Actual behaviour\n\n``` text\n#1152160 [257f7d2b / e9adf4fd]\nI0315 08:38:58.796412    8257 downloader.go:267] Synchronisation failed: no peers to keep download active\nI0315 08:39:09.079656    8257 blockchain.go:1251] imported 6 block(s) (0 queued 0 ignored) including 14 txs in 5.071856738s. #1152166 [9f1cf0bf / 349c5bae]\nI0315 08:39:25.953231    8257 blockchain.go:1251] imported 26 block(s) (0 queued 0 ignored) including 108 txs in 16.860866201s. #1152192 [4fda4e6f / 80c21b78]\nE0315 08:42:17.805896    8257 trie.go:309] Dangling hash node ref 3c356434386136366362383834633732316235633664396262383565663331633535663161326636386264636435656239316165313064653561623132356265633e20: open /Users/Dean/Library/Ethereum/chaindata/1406313.ldb: too many open files\nE0315 08:42:17.805984    8257 trie.go:309] Dangling hash node ref 3c356434386136366362383834633732316235633664396262383565663331633535663161326636386264636435656239316165313064653561623132356265633e20: open /Users/Dean/Library/Ethereum/chaindata/1406313.ldb: too many open files\nI0315 08:42:24.598658    8257 server.go:2161] http: Accept error: accept tcp 127.0.0.1:8545: accept: too many open files; retrying in 5ms\nI0315 08:42:24.640457    8257 server.go:2161] http: Accept error: accept tcp 127.0.0.1:8545: accept: too many open files; retrying in 10ms\n```\n#### Steps to reproduce the behaviour\n#### Backtrace\n\n```\n\nE0315 08:42:30.591436    8257 state_object.go:108] can't create account trie with root ccab66672ed1a6b84aed445efb59576417ffc887a7e3e9658736e784b72e789b: missing root node\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x0 pc=0x415aad2]\n\ngoroutine 47 [running]:\npanic(0x49c16a0, 0xc8200100d0)\n    /usr/local/opt/go/libexec/src/runtime/panic.go:464 +0x3e6\ngithub.com/ethereum/go-ethereum/core/state.(*StateDB).GetStateObject(0xc8212e7980, 0xe4fcbbd9c420c20e, 0xa755aac026edceb4, 0xa0c0b878, 0x0)\n    /private/tmp/ethereum20160303-33799-1typukk/src/github.com/ethereum/go-ethereum/core/state/statedb.go:242 +0x392\ngithub.com/ethereum/go-ethereum/core/state.(*StateDB).Exist(0xc8212e7980, 0xe4fcbbd9c420c20e, 0xa755aac026edceb4, 0xa0c0b878, 0xc821cf7ae0)\n    /private/tmp/ethereum20160303-33799-1typukk/src/github.com/ethereum/go-ethereum/core/state/statedb.go:105 +0x33\ngithub.com/ethereum/go-ethereum/core.(*StateTransition).to(0xc8244990d8, 0x0, 0x0)\n    /private/tmp/ethereum20160303-33799-1typukk/src/github.com/ethereum/go-ethereum/core/state_transition.go:149 +0xc6\ngithub.com/ethereum/go-ethereum/core.(*StateTransition).transitionDb(0xc8244990d8, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0)\n    /private/tmp/ethereum20160303-33799-1typukk/src/github.com/ethereum/go-ethereum/core/state_transition.go:241 +0xa04\ngithub.com/ethereum/go-ethereum/core.ApplyMessage(0x5f86308, 0xc8255c1b80, 0x5fc1200, 0xc824f85a70, 0xc822b0c5a0, 0x0, 0x0, 0x0, 0x4d2fc34, 0x0, ...)\n    /private/tmp/ethereum20160303-33799-1typukk/src/github.com/ethereum/go-ethereum/core/state_transition.go:119 +0x1f7\ngithub.com/ethereum/go-ethereum/core.ApplyTransaction(0xc8200b6280, 0xc822b0c5a0, 0xc8212e7980, 0xc821886240, 0xc824f85a70, 0xc8245920a0, 0xc8244995b0, 0x0, 0x0, 0x0, ...)\n    /private/tmp/ethereum20160303-33799-1typukk/src/github.com/ethereum/go-ethereum/core/state_processor.go:64 +0x228\ngithub.com/ethereum/go-ethereum/miner.(*Work).commitTransaction(0xc823517800, 0xc824f85a70, 0xc8200b6280, 0xc822b0c5a0, 0x0, 0x0)\n    /private/tmp/ethereum20160303-33799-1typukk/src/github.com/ethereum/go-ethereum/miner/worker.go:652 +0xa3\ngithub.com/ethereum/go-ethereum/miner.(*Work).commitTransactions(0xc823517800, 0xc8231c9c00, 0x61, 0x61, 0xc820457fe0, 0xc8200b6280)\n    /private/tmp/ethereum20160303-33799-1typukk/src/github.com/ethereum/go-ethereum/miner/worker.go:630 +0xc7e\ngithub.com/ethereum/go-ethereum/miner.(*worker).commitNewWork(0xc8202dfb30)\n    /private/tmp/ethereum20160303-33799-1typukk/src/github.com/ethereum/go-ethereum/miner/worker.go:531 +0xa5d\ngithub.com/ethereum/go-ethereum/miner.(*worker).update(0xc8202dfb30)\n    /private/tmp/ethereum20160303-33799-1typukk/src/github.com/ethereum/go-ethereum/miner/worker.go:237 +0x39a\ncreated by github.com/ethereum/go-ethereum/miner.newWorker\n    /private/tmp/ethereum20160303-33799-1typukk/src/github.com/ethereum/go-ethereum/miner/worker.go:141 +0x3c3\n```\n",
  "closed_by": {
    "login": "fjl",
    "id": 6915,
    "node_id": "MDQ6VXNlcjY5MTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fjl",
    "html_url": "https://github.com/fjl",
    "followers_url": "https://api.github.com/users/fjl/followers",
    "following_url": "https://api.github.com/users/fjl/following{/other_user}",
    "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
    "organizations_url": "https://api.github.com/users/fjl/orgs",
    "repos_url": "https://api.github.com/users/fjl/repos",
    "events_url": "https://api.github.com/users/fjl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fjl/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/197817541",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-197817541",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 197817541,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NzgxNzU0MQ==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-17T10:53:05Z",
    "updated_at": "2016-03-17T10:53:05Z",
    "author_association": "MEMBER",
    "body": "What is your --maxpeers setting?\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/197817541/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/199187541",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-199187541",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 199187541,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5OTE4NzU0MQ==",
    "user": {
      "login": "BenTuras",
      "id": 973228,
      "node_id": "MDQ6VXNlcjk3MzIyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/973228?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BenTuras",
      "html_url": "https://github.com/BenTuras",
      "followers_url": "https://api.github.com/users/BenTuras/followers",
      "following_url": "https://api.github.com/users/BenTuras/following{/other_user}",
      "gists_url": "https://api.github.com/users/BenTuras/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BenTuras/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BenTuras/subscriptions",
      "organizations_url": "https://api.github.com/users/BenTuras/orgs",
      "repos_url": "https://api.github.com/users/BenTuras/repos",
      "events_url": "https://api.github.com/users/BenTuras/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BenTuras/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-21T09:17:50Z",
    "updated_at": "2016-03-21T09:19:13Z",
    "author_association": "NONE",
    "body": "I also run into this problem a lot. One of the things that I noticed is the number of files that appear to be opened 11(!) times?! With only one geth running(cut -c90- returns the name of the open file, sort -u sorts them unique, wc -l gives me the number of open files[1$]/unique open files[2$]):\n[1$] lsof|grep geth|cut -c90-|sort|wc -l\n473\n[2$] lsof|grep geth|cut -c90-|sort -u|wc -l\n41\nI am running experiments on a local testnet with up to 4 nodes(N=1..4), each started like this:\n$ geth --datadir=~/eth/6N --bootnodes ABC --verbosity 3 --networkid=311258 --port 3036N --rpc --rpcaddr 192.168.11.24 --rpcport 816N --mine --minerthreads=1 --etherbase=ABC --dev --nodiscover --genesis development_genesis.json --rpccorsdomain \"*\" console\n(I left out the values(ABC above) for bootnodes and etherbase)\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/199187541/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/199188177",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-199188177",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 199188177,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5OTE4ODE3Nw==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-21T09:19:54Z",
    "updated_at": "2016-03-21T09:19:54Z",
    "author_association": "MEMBER",
    "body": "@BenTuras If you're doing this for dev purposes, please try the latest develop branch of Geth. It should already have the file descriptor thing fixed. Also could you report back on whether it indeed fixes it for you or not?\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/199188177/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/199695647",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-199695647",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 199695647,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5OTY5NTY0Nw==",
    "user": {
      "login": "BenTuras",
      "id": 973228,
      "node_id": "MDQ6VXNlcjk3MzIyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/973228?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BenTuras",
      "html_url": "https://github.com/BenTuras",
      "followers_url": "https://api.github.com/users/BenTuras/followers",
      "following_url": "https://api.github.com/users/BenTuras/following{/other_user}",
      "gists_url": "https://api.github.com/users/BenTuras/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BenTuras/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BenTuras/subscriptions",
      "organizations_url": "https://api.github.com/users/BenTuras/orgs",
      "repos_url": "https://api.github.com/users/BenTuras/repos",
      "events_url": "https://api.github.com/users/BenTuras/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BenTuras/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-22T08:21:33Z",
    "updated_at": "2016-03-22T08:22:29Z",
    "author_association": "NONE",
    "body": "$ git describe\nv0.9.39-507-g506c927\n$ lsof|grep geth|cut -c93-|sort -u|wc -l\n145\n$ lsof|grep geth|cut -c93-|sort|wc -l\n3425\nI am running:\n$ ps -ef|grep geth\nben      27075 27074 63 08:38 pts/17   00:24:41 /home/ben/go-ethereum/build/bin/geth --datadir=~/eth/61 --bootnodes ABC --verbosity 6 --networkid=311258 --port 30361 --rpc --rpcaddr 192.168.11.24 --rpcport 8161 --mine --minerthreads=1 --etherbase=DEF --nodiscover --dev --genesis development_genesis.json --rpccorsdomain \"_\" --maxpeers 248 console 2>> ~/eth/61.log\nben      27086 27085 72 08:38 pts/4    00:28:26 /home/ben/go-ethereum/build/bin/geth --datadir=~/eth/62 --bootnodes ABC --verbosity 6 --networkid=311258 --port 30362 --rpc --rpcaddr 192.168.11.24 --rpcport 8162 --mine --minerthreads=1 --etherbase=DEF --nodiscover --dev --genesis development_genesis.json --rpccorsdomain \"_\" --maxpeers 248 console 2>> ~/eth/62.log\nben      27097 27096 65 08:38 pts/19   00:25:30 /home/ben/go-ethereum/build/bin/geth --datadir=~/eth/63 --bootnodes ABC --verbosity 6 --networkid=311258 --port 30363 --rpc --rpcaddr 192.168.11.24 --rpcport 8163 --mine --minerthreads=1 --etherbase=DEF --nodiscover --dev --genesis development_genesis.json --rpccorsdomain \"*\" --maxpeers 248 console 2>> ~/eth/63.log\n\nI have the log files if you're interested.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/199695647/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/199713540",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-199713540",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 199713540,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5OTcxMzU0MA==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-22T09:23:46Z",
    "updated_at": "2016-03-22T09:23:46Z",
    "author_association": "MEMBER",
    "body": "You are on the stable branch (https://github.com/ethereum/go-ethereum/commit/506c9277911746dfbab0a585aee736bd3095f206), please check out `develop` and try that. \n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/199713540/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/199755768",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-199755768",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 199755768,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5OTc1NTc2OA==",
    "user": {
      "login": "BenTuras",
      "id": 973228,
      "node_id": "MDQ6VXNlcjk3MzIyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/973228?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BenTuras",
      "html_url": "https://github.com/BenTuras",
      "followers_url": "https://api.github.com/users/BenTuras/followers",
      "following_url": "https://api.github.com/users/BenTuras/following{/other_user}",
      "gists_url": "https://api.github.com/users/BenTuras/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BenTuras/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BenTuras/subscriptions",
      "organizations_url": "https://api.github.com/users/BenTuras/orgs",
      "repos_url": "https://api.github.com/users/BenTuras/repos",
      "events_url": "https://api.github.com/users/BenTuras/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BenTuras/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-22T11:00:35Z",
    "updated_at": "2016-03-22T11:00:35Z",
    "author_association": "NONE",
    "body": "$ git describe\nv0.9.39-745-ge189fb8\n$ lsof|grep geth|cut -c93-|sort|wc -l\n3108\n$ lsof|grep geth|cut -c93-|sort -u|wc -l\n190\n$ lsof|grep \"^geth\"|cut -c93-|grep chaindata|sort -u|head -5\nben/eth/61/chaindata/017846.ldb\nben/eth/61/chaindata/018745.ldb\nben/eth/61/chaindata/018780.ldb\nben/eth/61/chaindata/018781.ldb\nben/eth/61/chaindata/018790.ldb\n$ lsof|grep \"^geth\"|cut -c93-|grep chaindata|grep ben/eth/61/chaindata/017846.ldb\nben/eth/61/chaindata/017846.ldb\nben/eth/61/chaindata/017846.ldb\nben/eth/61/chaindata/017846.ldb\nben/eth/61/chaindata/017846.ldb\nben/eth/61/chaindata/017846.ldb\nben/eth/61/chaindata/017846.ldb\nben/eth/61/chaindata/017846.ldb\nben/eth/61/chaindata/017846.ldb\nben/eth/61/chaindata/017846.ldb\nben/eth/61/chaindata/017846.ldb\nben/eth/61/chaindata/017846.ldb\nben/eth/61/chaindata/017846.ldb\nben/eth/61/chaindata/017846.ldb\nben/eth/61/chaindata/017846.ldb\nben/eth/61/chaindata/017846.ldb\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/199755768/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/199773641",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-199773641",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 199773641,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5OTc3MzY0MQ==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-22T11:37:52Z",
    "updated_at": "2016-03-22T11:37:52Z",
    "author_association": "MEMBER",
    "body": "I just ran \n\n```\n$ lsof -n|grep geth|grep chaindata|grep LOCK\n\ngeth      29911               karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29912         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29913         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29914         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29915         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29916         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29917         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29918         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29919         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29920         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29921         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29922         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29923         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29925         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29926         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29927         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29928         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29929         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29957         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29969         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29970         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29975         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 29977         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 30049         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 30050         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\ngeth      29911 30051         karalabe    3uW     REG                8,1         0    2005696 /home/karalabe/.ethereum/chaindata/LOCK\n```\n\nThis gives an interesting insight: although it would seem that we have a ton of file descriptors open for the database lock, it wouldn't make much sense, as it's an exclusive lock. If you look at the file descriptor column, it reports to every single instance `3uW`, meaning that `lsof` is actually reporting the same file descriptor a ton of times.\n\nDigging a bit deeper reveals that `lsof` is actually reporting file descriptors separately for every single OS thread within a process that has access to the descriptor. This is the second column of numbers in my dump. However, all those threads share the FD between them, so they are actually one and the same, not separate ones, only `lsfo` reports them as duplicate.\n\nIf I filter out lsof lines reported for individual threads and only leave those reported for the process itself (i.e. TID field empty, I filtered it containing my user as such), I get:\n\n```\n$ lsof -n|grep geth|grep chaindata|awk '$3 == \"karalabe\" {print $0}'|cut -c95-|sort|wc -l\n1015\n\n$ lsof -n|grep geth|grep chaindata|cut -c95-|sort -u|wc -l\n1011\n```\n\nWhich is the correct answer (minor diff due to geth running in the background and doing its stuff on the database). **Note, the reason my FD count is much higher than yours is because on develop we've got an update that raises the processes FD limit to avoid database thrashing. It's set to 1024.**\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/199773641/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/199908565",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-199908565",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 199908565,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5OTkwODU2NQ==",
    "user": {
      "login": "azulmarino",
      "id": 17141152,
      "node_id": "MDQ6VXNlcjE3MTQxMTUy",
      "avatar_url": "https://avatars.githubusercontent.com/u/17141152?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/azulmarino",
      "html_url": "https://github.com/azulmarino",
      "followers_url": "https://api.github.com/users/azulmarino/followers",
      "following_url": "https://api.github.com/users/azulmarino/following{/other_user}",
      "gists_url": "https://api.github.com/users/azulmarino/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/azulmarino/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/azulmarino/subscriptions",
      "organizations_url": "https://api.github.com/users/azulmarino/orgs",
      "repos_url": "https://api.github.com/users/azulmarino/repos",
      "events_url": "https://api.github.com/users/azulmarino/events{/privacy}",
      "received_events_url": "https://api.github.com/users/azulmarino/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-22T17:03:01Z",
    "updated_at": "2016-03-22T17:03:01Z",
    "author_association": "NONE",
    "body": "I haven't seen this again , be running virtually non-stop since my last update\n\nulimit -a 256\n\nlsof -n|grep geth|grep chaindata|cut -c95-|sort -u|wc -l\n      36\nDeans-MacBook-Pro:eth-net-intelligence-api Dean$  lsof|grep geth|cut -c93-|sort|wc -l\n      55\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/199908565/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/206115730",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-206115730",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 206115730,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIwNjExNTczMA==",
    "user": {
      "login": "anton44eg",
      "id": 896114,
      "node_id": "MDQ6VXNlcjg5NjExNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/896114?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/anton44eg",
      "html_url": "https://github.com/anton44eg",
      "followers_url": "https://api.github.com/users/anton44eg/followers",
      "following_url": "https://api.github.com/users/anton44eg/following{/other_user}",
      "gists_url": "https://api.github.com/users/anton44eg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/anton44eg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/anton44eg/subscriptions",
      "organizations_url": "https://api.github.com/users/anton44eg/orgs",
      "repos_url": "https://api.github.com/users/anton44eg/repos",
      "events_url": "https://api.github.com/users/anton44eg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/anton44eg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-04-06T04:42:49Z",
    "updated_at": "2016-04-06T04:42:49Z",
    "author_association": "NONE",
    "body": "Have same problem on Linux. After homestead release geth node crashes every 5 days with \"too many open files\"\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/206115730/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/242390644",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-242390644",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 242390644,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0MjM5MDY0NA==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-08-25T13:42:38Z",
    "updated_at": "2016-08-25T13:42:38Z",
    "author_association": "MEMBER",
    "body": "We have increased fd limits to 1028 on supported platforms starting with the 1.4 release.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/242390644/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/248635278",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-248635278",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 248635278,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0ODYzNTI3OA==",
    "user": {
      "login": "miohtama",
      "id": 49922,
      "node_id": "MDQ6VXNlcjQ5OTIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/49922?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/miohtama",
      "html_url": "https://github.com/miohtama",
      "followers_url": "https://api.github.com/users/miohtama/followers",
      "following_url": "https://api.github.com/users/miohtama/following{/other_user}",
      "gists_url": "https://api.github.com/users/miohtama/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/miohtama/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/miohtama/subscriptions",
      "organizations_url": "https://api.github.com/users/miohtama/orgs",
      "repos_url": "https://api.github.com/users/miohtama/repos",
      "events_url": "https://api.github.com/users/miohtama/events{/privacy}",
      "received_events_url": "https://api.github.com/users/miohtama/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-21T14:48:14Z",
    "updated_at": "2016-09-21T14:48:14Z",
    "author_association": "NONE",
    "body": "Still on testnet, Ubuntu 14.04, geth 1.4.12:\n\n```\nI0921 14:45:35.972432 server.go:1934] http: Accept error: accept tcp 127.0.0.1:8545: accept4: too many open files; retrying in 1s\nI0921 14:45:36.993952 server.go:1934] http: Accept error: accept tcp 127.0.0.1:8545: accept4: too many open files; retrying in 1s\nI0921 14:45:38.005507 server.go:1934] http: Accept error: accept tcp 127.0.0.1:8545: accept4: too many open files; retrying in 1s\n\nVERSION:\n   1.4.12-stable\n```\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/248635278/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/248636948",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-248636948",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 248636948,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0ODYzNjk0OA==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-21T14:53:24Z",
    "updated_at": "2016-09-21T14:53:24Z",
    "author_association": "MEMBER",
    "body": "@miohtama Can you post the log messages that are generated at startup? It should print out how many fds were allocated to the database.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/248636948/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/248670870",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-248670870",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 248670870,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0ODY3MDg3MA==",
    "user": {
      "login": "miohtama",
      "id": 49922,
      "node_id": "MDQ6VXNlcjQ5OTIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/49922?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/miohtama",
      "html_url": "https://github.com/miohtama",
      "followers_url": "https://api.github.com/users/miohtama/followers",
      "following_url": "https://api.github.com/users/miohtama/following{/other_user}",
      "gists_url": "https://api.github.com/users/miohtama/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/miohtama/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/miohtama/subscriptions",
      "organizations_url": "https://api.github.com/users/miohtama/orgs",
      "repos_url": "https://api.github.com/users/miohtama/repos",
      "events_url": "https://api.github.com/users/miohtama/events{/privacy}",
      "received_events_url": "https://api.github.com/users/miohtama/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-21T16:42:45Z",
    "updated_at": "2016-09-21T16:53:40Z",
    "author_association": "NONE",
    "body": "Here:\n\n```\n  I0921 16:42:14.250216 ethdb/database.go:82] Alloted 128MB cache and 1024 file handles to /home/ubuntu/.ethereum/testnet/chaindata\n```\n\nAlso 1024 is the system limit:\n\n```\nulimit -a\n\ncore file size          (blocks, -c) 0\ndata seg size           (kbytes, -d) unlimited\nscheduling priority             (-e) 0\nfile size               (blocks, -f) unlimited\npending signals                 (-i) 15926\nmax locked memory       (kbytes, -l) 64\nmax memory size         (kbytes, -m) unlimited\nopen files                      (-n) 1024\npipe size            (512 bytes, -p) 8\nPOSIX message queues     (bytes, -q) 819200\nreal-time priority              (-r) 0\nstack size              (kbytes, -s) 8192\ncpu time               (seconds, -t) unlimited\nmax user processes              (-u) 15926\nvirtual memory          (kbytes, -v) unlimited\nfile locks                      (-x) unlimited\n```\n\nI suspect it's leaking file handles or sockets?\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/248670870/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/258666954",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-258666954",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 258666954,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODY2Njk1NA==",
    "user": {
      "login": "JMLX42",
      "id": 998703,
      "node_id": "MDQ6VXNlcjk5ODcwMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/998703?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JMLX42",
      "html_url": "https://github.com/JMLX42",
      "followers_url": "https://api.github.com/users/JMLX42/followers",
      "following_url": "https://api.github.com/users/JMLX42/following{/other_user}",
      "gists_url": "https://api.github.com/users/JMLX42/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JMLX42/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JMLX42/subscriptions",
      "organizations_url": "https://api.github.com/users/JMLX42/orgs",
      "repos_url": "https://api.github.com/users/JMLX42/repos",
      "events_url": "https://api.github.com/users/JMLX42/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JMLX42/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-06T09:26:09Z",
    "updated_at": "2016-11-06T14:29:52Z",
    "author_association": "NONE",
    "body": "Got the same issue: I don't know why, but since yesterday my private chain (which is around block 95000) does this kind of errors:\n\n```\nI1106 08:16:20.383703 server.go:1934] http: Accept error: accept tcp 127.0.0.1:8545: accept4: too many open files; retrying in 5ms\n```\n\nYet the number of file descriptors look OK to me:\n\n```\nroot@laprimaire:~# lsof -p 12478 | grep localhost | wc -l\n1704\n```\n\n```\nroot@laprimaire:~# cat /proc/32706/limits \nLimit                     Soft Limit           Hard Limit           Units     \nMax cpu time              unlimited            unlimited            seconds   \nMax file size             unlimited            unlimited            bytes     \nMax data size             unlimited            unlimited            bytes     \nMax stack size            8388608              unlimited            bytes     \nMax core file size        0                    unlimited            bytes     \nMax resident set          unlimited            unlimited            bytes     \nMax processes             64058                64058                processes \nMax open files            2048                 4096                 files     \nMax locked memory         65536                65536                bytes     \nMax address space         unlimited            unlimited            bytes     \nMax file locks            unlimited            unlimited            locks     \nMax pending signals       64058                64058                signals   \nMax msgqueue size         819200               819200               bytes     \nMax nice priority         0                    0                    \nMax realtime priority     0                    0                    \nMax realtime timeout      unlimited            unlimited            us\n```\n\nI suspected I left too many filters on some leftover Web3 instances. But now I'm calling `web3.reset()` when I'm done and the problem still exists...\n\nIn my case, it looks like it happens:\n- when there is a traffic surge (but again, fds look fine)\n- when the backup process launches: it rsync the blockchain data to a backup server, I'm suspecting the chain data files are locked and it makes geth go crazy somehow. But this backup process has been there for a week without issues and it doesn't explain why it's anHTTP  \"accept\" error.\n\n**Update:** the issue might be related to unclosed socket connections:\n\n```\nroot@laprimaire:~# lsof -p 32706 | grep localhost | wc -l\n1612\nroot@laprimaire:~# lsof -p 32706 | wc -l\n1976\n```\n\n1612 socket fds, and yet I'm calling `web3.reset()`. I have 80 workers so I expect a maximum of 80 socket fds. But I have more than 20x that... The exact same configuration worked for a week, and now it's failing every hour or so.\n\n**Update 2**: tried to set the following but it didn't change anything:\n\nnet.ipv4.tcp_fin_timeout=15\nnet.ipv4.tcp_tw_recycle=1\nnet.ipv4.tcp_tw_reuse=1\n\n```\nroot@laprimaire:~# netstat -a | grep 8545 | wc -l\n3258\n```\n\n**Update 3:** listing the nodejs processes reveal some very strange stuff!\n\n```\nroot@laprimaire:~# ps aux | grep node\nroot       932  9.6  0.6 1173872 106856 ?      Rl   13:40   4:32 /usr/bin/nodejs /srv/cocorico/blockchain-worker/dist/ballot/index.js\nrabbitmq  1557  4.7  0.5 2323044 86444 ?       Sl   13:37   2:24 /usr/lib/erlang/erts-5.10.4/bin/beam.smp -W w -K true -A30 -P 1048576 -- -root /usr/lib/erlang -progname erl -- -home /var/lib/rabbitmq -- -pa /usr/lib/rabbitmq/lib/rabbitmq_server-3.2.4/sbin/../ebin -noshell -noinput -s rabbit boot -sname rabbit@laprimaire -boot start_sasl -kernel inet_default_connect_options [{nodelay,true}] -sasl errlog_type error -sasl sasl_error_logger false -rabbit error_logger {file,\"/var/log/rabbitmq/rabbit@laprimaire.log\"} -rabbit sasl_error_logger {file,\"/var/log/rabbitmq/rabbit@laprimaire-sasl.log\"} -rabbit enabled_plugins_file \"/etc/rabbitmq/enabled_plugins\" -rabbit plugins_dir \"/usr/lib/rabbitmq/lib/rabbitmq_server-3.2.4/sbin/../plugins\" -rabbit plugins_expand_dir \"/var/lib/rabbitmq/mnesia/rabbit@laprimaire-plugins-expand\" -os_mon start_cpu_sup false -os_mon start_disksup false -os_mon start_memsup false -mnesia dir \"/var/lib/rabbitmq/mnesia/rabbit@laprimaire\"\nroot      2100  0.1  0.1 942076 32384 ?        Ssl  13:37   0:03 /usr/bin/nodejs /usr/lib/node_modules/forever/bin/monitor index.js\nroot      2113  0.0  0.2 907752 36540 ?        Sl   13:37   0:01 /usr/bin/nodejs /srv/cocorico/webhook/dist/index.js\nroot      2127  0.3  0.3 1233892 58604 ?       Sl   13:37   0:11 /usr/bin/nodejs /srv/cocorico/webhook/dist/index.js\nroot      2133  0.3  0.3 1232744 58316 ?       Sl   13:37   0:11 /usr/bin/nodejs /srv/cocorico/webhook/dist/index.js\nroot      2139  0.3  0.3 1233468 56428 ?       Sl   13:37   0:11 /usr/bin/nodejs /srv/cocorico/webhook/dist/index.js\nroot      2145  0.3  0.3 1229696 53500 ?       Sl   13:37   0:11 /usr/bin/nodejs /srv/cocorico/webhook/dist/index.js\nroot      2146  0.3  0.3 1233656 58736 ?       Sl   13:37   0:11 /usr/bin/nodejs /srv/cocorico/webhook/dist/index.js\nroot      2437  0.1  0.1 942268 30100 ?        Ssl  13:37   0:03 /usr/bin/nodejs /usr/lib/node_modules/forever/bin/monitor index.js\nroot      2450 32.9  1.7 1477512 281172 ?      Sl   13:37  16:34 /usr/bin/nodejs /srv/cocorico/api/dist/index.js\nroot     16258  0.0  0.0      0     0 ?        Z    14:19   0:00 [nodejs] <defunct>\nroot     16274  0.0  0.0      0     0 ?        Z    14:19   0:00 [nodejs] <defunct>\nroot     16281  0.0  0.0      0     0 ?        Z    14:19   0:00 [nodejs] <defunct>\nroot     16437  0.0  0.0      0     0 ?        Z    14:19   0:00 [nodejs] <defunct>\nroot     16443  0.0  0.0      0     0 ?        Z    14:19   0:00 [nodejs] <defunct>\nroot     16466  0.0  0.0      0     0 ?        Z    14:19   0:00 [nodejs] <defunct>\nroot     16506  0.0  0.0      0     0 ?        Z    14:19   0:00 [nodejs] <defunct>\nroot     16507  0.0  0.0      0     0 ?        Z    14:19   0:00 [nodejs] <defunct>\nroot     16543  0.0  0.0      0     0 ?        Z    14:19   0:00 [nodejs] <defunct>\nroot     16611  0.0  0.0      0     0 ?        Z    14:19   0:00 [nodejs] <defunct>\nroot     16612  0.0  0.0      0     0 ?        Z    14:19   0:00 [nodejs] <defunct>\nroot     16651  0.0  0.0      0     0 ?        Z    14:19   0:00 [nodejs] <defunct>\nroot     16652  0.0  0.0      0     0 ?        Z    14:19   0:00 [nodejs] <defunct>\nroot     16703  0.0  0.0      0     0 ?        Z    14:19   0:00 [nodejs] <defunct>\nroot     17103  0.0  0.0      0     0 ?        Z    14:24   0:00 [nodejs] <defunct>\nroot     17109  0.0  0.0      0     0 ?        Z    14:24   0:00 [nodejs] <defunct>\nroot     17115  0.0  0.0      0     0 ?        Z    14:24   0:00 [nodejs] <defunct>\nroot     17127  0.0  0.0      0     0 ?        Z    14:24   0:00 [nodejs] <defunct>\nroot     17133  0.0  0.0      0     0 ?        Z    14:24   0:00 [nodejs] <defunct>\nroot     17134  0.0  0.0      0     0 ?        Z    14:24   0:00 [nodejs] <defunct>\nroot     17135  0.0  0.0      0     0 ?        Z    14:24   0:00 [nodejs] <defunct>\nroot     17151  0.0  0.0      0     0 ?        Z    14:24   0:00 [nodejs] <defunct>\nroot     17152  0.0  0.0      0     0 ?        Z    14:24   0:00 [nodejs] <defunct>\nroot     17153  0.0  0.0      0     0 ?        Z    14:24   0:00 [nodejs] <defunct>\nroot     17165  0.0  0.0      0     0 ?        Z    14:24   0:00 [nodejs] <defunct>\nroot     17166  0.0  0.0      0     0 ?        Z    14:24   0:00 [nodejs] <defunct>\nroot     17210  0.1  0.1 772392 23488 ?        Sl   14:24   0:00 /usr/bin/nodejs -e var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http.request;var options = {\"host\":\"127.0.0.1\",\"port\":\"8545\",\"path\":\"/\",\"method\":\"POST\",\"headers\":{\"User-Agent\":\"node-XMLHttpRequest\",\"Accept\":\"*/*\",\"Content-Type\":\"application/json\",\"Host\":\"127.0.0.1:8545\",\"Content-Length\":107},\"agent\":false,\"withCredentials\":false};var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('.node-xmlhttprequest-content-19845', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19845');});response.on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19845', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19845');});}).on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19845', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19845');});req.write('{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"id\\\":11370,\\\"method\\\":\\\"eth_uninstallFilter\\\",\\\"params\\\":[\\\"0x15fa9c82e44478492256af3ac6e4ea6c\\\"]}');req.end();\nroot     17252  0.1  0.1 772392 23488 ?        Sl   14:25   0:00 /usr/bin/nodejs -e var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http.request;var options = {\"host\":\"127.0.0.1\",\"port\":\"8545\",\"path\":\"/\",\"method\":\"POST\",\"headers\":{\"User-Agent\":\"node-XMLHttpRequest\",\"Accept\":\"*/*\",\"Content-Type\":\"application/json\",\"Host\":\"127.0.0.1:8545\",\"Content-Length\":107},\"agent\":false,\"withCredentials\":false};var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('.node-xmlhttprequest-content-19913', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19913');});response.on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19913', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19913');});}).on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19913', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19913');});req.write('{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"id\\\":20254,\\\"method\\\":\\\"eth_uninstallFilter\\\",\\\"params\\\":[\\\"0x2a48dc5436e6b982b8149468eed4d94e\\\"]}');req.end();\nroot     17320  0.1  0.1 772392 23576 ?        Sl   14:26   0:00 /usr/bin/nodejs -e var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http.request;var options = {\"host\":\"127.0.0.1\",\"port\":\"8545\",\"path\":\"/\",\"method\":\"POST\",\"headers\":{\"User-Agent\":\"node-XMLHttpRequest\",\"Accept\":\"*/*\",\"Content-Type\":\"application/json\",\"Host\":\"127.0.0.1:8545\",\"Content-Length\":107},\"agent\":false,\"withCredentials\":false};var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('.node-xmlhttprequest-content-19881', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19881');});response.on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19881', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19881');});}).on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19881', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19881');});req.write('{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"id\\\":15973,\\\"method\\\":\\\"eth_uninstallFilter\\\",\\\"params\\\":[\\\"0xec72c5f7ba8f0a9c4b25d0bca8363302\\\"]}');req.end();\nroot     17326  0.1  0.1 772392 23524 ?        Sl   14:26   0:00 /usr/bin/nodejs -e var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http.request;var options = {\"host\":\"127.0.0.1\",\"port\":\"8545\",\"path\":\"/\",\"method\":\"POST\",\"headers\":{\"User-Agent\":\"node-XMLHttpRequest\",\"Accept\":\"*/*\",\"Content-Type\":\"application/json\",\"Host\":\"127.0.0.1:8545\",\"Content-Length\":107},\"agent\":false,\"withCredentials\":false};var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('.node-xmlhttprequest-content-19956', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19956');});response.on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19956', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19956');});}).on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19956', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19956');});req.write('{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"id\\\":15454,\\\"method\\\":\\\"eth_uninstallFilter\\\",\\\"params\\\":[\\\"0x1412fac025998f83a270b115c3847219\\\"]}');req.end();\nroot     17343  0.1  0.1 772392 23556 ?        Sl   14:26   0:00 /usr/bin/nodejs -e var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http.request;var options = {\"host\":\"127.0.0.1\",\"port\":\"8545\",\"path\":\"/\",\"method\":\"POST\",\"headers\":{\"User-Agent\":\"node-XMLHttpRequest\",\"Accept\":\"*/*\",\"Content-Type\":\"application/json\",\"Host\":\"127.0.0.1:8545\",\"Content-Length\":107},\"agent\":false,\"withCredentials\":false};var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('.node-xmlhttprequest-content-19896', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19896');});response.on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19896', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19896');});}).on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19896', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19896');});req.write('{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"id\\\":17699,\\\"method\\\":\\\"eth_uninstallFilter\\\",\\\"params\\\":[\\\"0xc7359c6ddd861a2d313e0d1ff6bd333e\\\"]}');req.end();\nroot     17350  0.3  0.1 772392 23560 ?        Sl   14:26   0:00 /usr/bin/nodejs -e var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http.request;var options = {\"host\":\"127.0.0.1\",\"port\":\"8545\",\"path\":\"/\",\"method\":\"POST\",\"headers\":{\"User-Agent\":\"node-XMLHttpRequest\",\"Accept\":\"*/*\",\"Content-Type\":\"application/json\",\"Host\":\"127.0.0.1:8545\",\"Content-Length\":107},\"agent\":false,\"withCredentials\":false};var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('.node-xmlhttprequest-content-932', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-932');});response.on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-932', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-932');});}).on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-932', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-932');});req.write('{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"id\\\":14995,\\\"method\\\":\\\"eth_uninstallFilter\\\",\\\"params\\\":[\\\"0xd8382bdf1abb1558de34ba7921152fe1\\\"]}');req.end();\nroot     17359  0.2  0.1 772392 23488 ?        Sl   14:26   0:00 /usr/bin/nodejs -e var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http.request;var options = {\"host\":\"127.0.0.1\",\"port\":\"8545\",\"path\":\"/\",\"method\":\"POST\",\"headers\":{\"User-Agent\":\"node-XMLHttpRequest\",\"Accept\":\"*/*\",\"Content-Type\":\"application/json\",\"Host\":\"127.0.0.1:8545\",\"Content-Length\":107},\"agent\":false,\"withCredentials\":false};var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('.node-xmlhttprequest-content-19974', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19974');});response.on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19974', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19974');});}).on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19974', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19974');});req.write('{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"id\\\":15814,\\\"method\\\":\\\"eth_uninstallFilter\\\",\\\"params\\\":[\\\"0x8cc67933a7d1d8a842f5437b4c4dbcd2\\\"]}');req.end();\nroot     17360  0.1  0.1 772392 23472 ?        Sl   14:26   0:00 /usr/bin/nodejs -e var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http.request;var options = {\"host\":\"127.0.0.1\",\"port\":\"8545\",\"path\":\"/\",\"method\":\"POST\",\"headers\":{\"User-Agent\":\"node-XMLHttpRequest\",\"Accept\":\"*/*\",\"Content-Type\":\"application/json\",\"Host\":\"127.0.0.1:8545\",\"Content-Length\":107},\"agent\":false,\"withCredentials\":false};var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('.node-xmlhttprequest-content-19950', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19950');});response.on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19950', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19950');});}).on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19950', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19950');});req.write('{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"id\\\":17367,\\\"method\\\":\\\"eth_uninstallFilter\\\",\\\"params\\\":[\\\"0x1d2e633300766b93ef6c3269aeeae248\\\"]}');req.end();\nroot     17371  0.1  0.1 772392 23472 ?        Sl   14:26   0:00 /usr/bin/nodejs -e var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http.request;var options = {\"host\":\"127.0.0.1\",\"port\":\"8545\",\"path\":\"/\",\"method\":\"POST\",\"headers\":{\"User-Agent\":\"node-XMLHttpRequest\",\"Accept\":\"*/*\",\"Content-Type\":\"application/json\",\"Host\":\"127.0.0.1:8545\",\"Content-Length\":107},\"agent\":false,\"withCredentials\":false};var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('.node-xmlhttprequest-content-19967', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19967');});response.on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19967', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19967');});}).on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19967', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19967');});req.write('{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"id\\\":14780,\\\"method\\\":\\\"eth_uninstallFilter\\\",\\\"params\\\":[\\\"0xe1a132e785b071516d7e44fde99333e2\\\"]}');req.end();\nroot     17388  0.2  0.1 772392 23504 ?        Sl   14:26   0:00 /usr/bin/nodejs -e var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http.request;var options = {\"host\":\"127.0.0.1\",\"port\":\"8545\",\"path\":\"/\",\"method\":\"POST\",\"headers\":{\"User-Agent\":\"node-XMLHttpRequest\",\"Accept\":\"*/*\",\"Content-Type\":\"application/json\",\"Host\":\"127.0.0.1:8545\",\"Content-Length\":107},\"agent\":false,\"withCredentials\":false};var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('.node-xmlhttprequest-content-19925', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19925');});response.on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19925', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19925');});}).on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19925', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19925');});req.write('{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"id\\\":13825,\\\"method\\\":\\\"eth_uninstallFilter\\\",\\\"params\\\":[\\\"0x4bd61ea94b280aadadc5bab0281c6d2e\\\"]}');req.end();\nroot     17394  0.1  0.1 772392 23600 ?        Sl   14:26   0:00 /usr/bin/nodejs -e var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http.request;var options = {\"host\":\"127.0.0.1\",\"port\":\"8545\",\"path\":\"/\",\"method\":\"POST\",\"headers\":{\"User-Agent\":\"node-XMLHttpRequest\",\"Accept\":\"*/*\",\"Content-Type\":\"application/json\",\"Host\":\"127.0.0.1:8545\",\"Content-Length\":107},\"agent\":false,\"withCredentials\":false};var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('.node-xmlhttprequest-content-19911', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19911');});response.on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19911', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19911');});}).on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19911', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19911');});req.write('{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"id\\\":16665,\\\"method\\\":\\\"eth_uninstallFilter\\\",\\\"params\\\":[\\\"0xf675a1e29bcaabb50df3112852d77f67\\\"]}');req.end();\nroot     17464  0.2  0.1 772392 23576 ?        Sl   14:26   0:00 /usr/bin/nodejs -e var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http.request;var options = {\"host\":\"127.0.0.1\",\"port\":\"8545\",\"path\":\"/\",\"method\":\"POST\",\"headers\":{\"User-Agent\":\"node-XMLHttpRequest\",\"Accept\":\"*/*\",\"Content-Type\":\"application/json\",\"Host\":\"127.0.0.1:8545\",\"Content-Length\":107},\"agent\":false,\"withCredentials\":false};var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('.node-xmlhttprequest-content-19877', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19877');});response.on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19877', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19877');});}).on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19877', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19877');});req.write('{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"id\\\":18279,\\\"method\\\":\\\"eth_uninstallFilter\\\",\\\"params\\\":[\\\"0x61041f652fb3f2cbd380cf574e9e3793\\\"]}');req.end();\nroot     17505  1.2  0.1 772392 23576 ?        Sl   14:27   0:00 /usr/bin/nodejs -e var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http.request;var options = {\"host\":\"127.0.0.1\",\"port\":\"8545\",\"path\":\"/\",\"method\":\"POST\",\"headers\":{\"User-Agent\":\"node-XMLHttpRequest\",\"Accept\":\"*/*\",\"Content-Type\":\"application/json\",\"Host\":\"127.0.0.1:8545\",\"Content-Length\":107},\"agent\":false,\"withCredentials\":false};var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('.node-xmlhttprequest-content-19820', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19820');});response.on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19820', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19820');});}).on('error', function(error) {fs.writeFileSync('.node-xmlhttprequest-content-19820', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('.node-xmlhttprequest-sync-19820');});req.write('{\\\"jsonrpc\\\":\\\"2.0\\\",\\\"id\\\":13302,\\\"method\\\":\\\"eth_uninstallFilter\\\",\\\"params\\\":[\\\"0x709bbb650d12aac4c05b9370e96c93f5\\\"]}');req.end();\n```\n\nWhat could be the problem?\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/258666954/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/258687771",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-258687771",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 258687771,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODY4Nzc3MQ==",
    "user": {
      "login": "JMLX42",
      "id": 998703,
      "node_id": "MDQ6VXNlcjk5ODcwMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/998703?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JMLX42",
      "html_url": "https://github.com/JMLX42",
      "followers_url": "https://api.github.com/users/JMLX42/followers",
      "following_url": "https://api.github.com/users/JMLX42/following{/other_user}",
      "gists_url": "https://api.github.com/users/JMLX42/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JMLX42/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JMLX42/subscriptions",
      "organizations_url": "https://api.github.com/users/JMLX42/orgs",
      "repos_url": "https://api.github.com/users/JMLX42/repos",
      "events_url": "https://api.github.com/users/JMLX42/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JMLX42/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-06T15:21:57Z",
    "updated_at": "2016-11-06T15:22:13Z",
    "author_association": "NONE",
    "body": "OK solved it.\nThe connections were kept alive because geth was super busy replying to some filters.\nSo I changed this:\n\n``` javascript\nconst ballotEvent = contract.Ballot(\n  {voter: address},\n  {fromBlock: 0, toBlock: 'latest'}\n);\n```\n\ninto this:\n\n``` javascript\nconst blockNumber = await promise((cb)=>web3.eth.getBlockNumber(cb))();\nconst ballotEvent = contract.Ballot(\n  {voter: address},\n  {fromBlock: blockNumber, toBlock: 'latest'}\n);\n```\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/258687771/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/258703624",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-258703624",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 258703624,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1ODcwMzYyNA==",
    "user": {
      "login": "miohtama",
      "id": 49922,
      "node_id": "MDQ6VXNlcjQ5OTIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/49922?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/miohtama",
      "html_url": "https://github.com/miohtama",
      "followers_url": "https://api.github.com/users/miohtama/followers",
      "following_url": "https://api.github.com/users/miohtama/following{/other_user}",
      "gists_url": "https://api.github.com/users/miohtama/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/miohtama/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/miohtama/subscriptions",
      "organizations_url": "https://api.github.com/users/miohtama/orgs",
      "repos_url": "https://api.github.com/users/miohtama/repos",
      "events_url": "https://api.github.com/users/miohtama/events{/privacy}",
      "received_events_url": "https://api.github.com/users/miohtama/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-06T19:23:16Z",
    "updated_at": "2016-11-06T19:23:16Z",
    "author_association": "NONE",
    "body": "Yeah. Looks like there is pathological behavior when geth is under stress (network being dos'ed?)\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/258703624/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/262064263",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-262064263",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 262064263,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MjA2NDI2Mw==",
    "user": {
      "login": "eiabea",
      "id": 688128,
      "node_id": "MDQ6VXNlcjY4ODEyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/688128?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eiabea",
      "html_url": "https://github.com/eiabea",
      "followers_url": "https://api.github.com/users/eiabea/followers",
      "following_url": "https://api.github.com/users/eiabea/following{/other_user}",
      "gists_url": "https://api.github.com/users/eiabea/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eiabea/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eiabea/subscriptions",
      "organizations_url": "https://api.github.com/users/eiabea/orgs",
      "repos_url": "https://api.github.com/users/eiabea/repos",
      "events_url": "https://api.github.com/users/eiabea/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eiabea/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-21T20:55:19Z",
    "updated_at": "2016-11-21T20:55:19Z",
    "author_association": "NONE",
    "body": "Having the same issues on Debian. Synced the chain with an older version (afaik 1.4.x) without any troubles. On Debian i have to remove LOCK and a *.ldb file manually and restart geth about every hour.\r\n\r\ninstance: Geth/v1.5.2-stable-c8695209/linux/go1.7.3\r\nDebian 3.16.36-1+deb8u1 (2016-09-03) x86_64 GNU/Linux",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/262064263/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/262064902",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-262064902",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 262064902,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MjA2NDkwMg==",
    "user": {
      "login": "miohtama",
      "id": 49922,
      "node_id": "MDQ6VXNlcjQ5OTIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/49922?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/miohtama",
      "html_url": "https://github.com/miohtama",
      "followers_url": "https://api.github.com/users/miohtama/followers",
      "following_url": "https://api.github.com/users/miohtama/following{/other_user}",
      "gists_url": "https://api.github.com/users/miohtama/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/miohtama/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/miohtama/subscriptions",
      "organizations_url": "https://api.github.com/users/miohtama/orgs",
      "repos_url": "https://api.github.com/users/miohtama/repos",
      "events_url": "https://api.github.com/users/miohtama/events{/privacy}",
      "received_events_url": "https://api.github.com/users/miohtama/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-21T20:57:49Z",
    "updated_at": "2016-11-21T20:57:49Z",
    "author_association": "NONE",
    "body": "@eiabea Do you have excessive JSON-RPC traffic or what kind of usage you have for the node?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/262064902/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/262066023",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-262066023",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 262066023,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MjA2NjAyMw==",
    "user": {
      "login": "eiabea",
      "id": 688128,
      "node_id": "MDQ6VXNlcjY4ODEyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/688128?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eiabea",
      "html_url": "https://github.com/eiabea",
      "followers_url": "https://api.github.com/users/eiabea/followers",
      "following_url": "https://api.github.com/users/eiabea/following{/other_user}",
      "gists_url": "https://api.github.com/users/eiabea/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eiabea/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eiabea/subscriptions",
      "organizations_url": "https://api.github.com/users/eiabea/orgs",
      "repos_url": "https://api.github.com/users/eiabea/repos",
      "events_url": "https://api.github.com/users/eiabea/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eiabea/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-21T21:02:11Z",
    "updated_at": "2016-11-21T21:02:11Z",
    "author_association": "NONE",
    "body": "Just trying to sync the chain\r\n\r\ntop\r\n```\r\n  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                                                                                                                   \r\n28300 eiabea    20   0 1717896 990.6m  11428 S  15.3 12.5   4:37.73 geth  \r\n```\r\nfree -h\r\n```\r\n             total       used       free     shared    buffers     cached\r\nMem:          7.7G       7.5G       221M        28M       586M       2.1G\r\n```\r\niotop\r\n```\r\n90% geth\r\n```\r\ngeth - net\r\n```\r\n  listening: true,\r\n  peerCount: 7,\r\n  version: \"1\",\r\n```\r\n\r\nhope this gives an overview over my node",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/262066023/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/262479122",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2358#issuecomment-262479122",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2358",
    "id": 262479122,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2MjQ3OTEyMg==",
    "user": {
      "login": "eiabea",
      "id": 688128,
      "node_id": "MDQ6VXNlcjY4ODEyOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/688128?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eiabea",
      "html_url": "https://github.com/eiabea",
      "followers_url": "https://api.github.com/users/eiabea/followers",
      "following_url": "https://api.github.com/users/eiabea/following{/other_user}",
      "gists_url": "https://api.github.com/users/eiabea/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eiabea/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eiabea/subscriptions",
      "organizations_url": "https://api.github.com/users/eiabea/orgs",
      "repos_url": "https://api.github.com/users/eiabea/repos",
      "events_url": "https://api.github.com/users/eiabea/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eiabea/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-11-23T10:31:03Z",
    "updated_at": "2016-11-23T10:31:03Z",
    "author_association": "NONE",
    "body": "I think i \"fixed\" it...\r\n\r\n```\r\n#!/bin/bash\r\n\r\nwhile true; do \r\n\tgeth --fast --cache=512\r\n\trm -rf /home/eiabea/.ethereum/geth/LOCK\r\ndone\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/262479122/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
