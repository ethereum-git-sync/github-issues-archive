{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22713",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22713/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22713/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22713/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/22713",
  "id": 864110655,
  "node_id": "MDU6SXNzdWU4NjQxMTA2NTU=",
  "number": 22713,
  "title": "Increase resiliency to better handle Ropsten's deep reorgs",
  "user": {
    "login": "evertonfraga",
    "id": 47108,
    "node_id": "MDQ6VXNlcjQ3MTA4",
    "avatar_url": "https://avatars.githubusercontent.com/u/47108?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/evertonfraga",
    "html_url": "https://github.com/evertonfraga",
    "followers_url": "https://api.github.com/users/evertonfraga/followers",
    "following_url": "https://api.github.com/users/evertonfraga/following{/other_user}",
    "gists_url": "https://api.github.com/users/evertonfraga/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/evertonfraga/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/evertonfraga/subscriptions",
    "organizations_url": "https://api.github.com/users/evertonfraga/orgs",
    "repos_url": "https://api.github.com/users/evertonfraga/repos",
    "events_url": "https://api.github.com/users/evertonfraga/events{/privacy}",
    "received_events_url": "https://api.github.com/users/evertonfraga/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233652,
      "node_id": "MDU6TGFiZWw3MjIzMzY1Mg==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:feature",
      "name": "type:feature",
      "color": "84b6eb",
      "default": false,
      "description": null
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-04-21T17:25:28Z",
  "updated_at": "2021-04-29T07:19:03Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "# Rationale\r\n\r\nHi all,\r\n\r\nthis weekend we had two deep reorgs on the Ropsten network, causing problems to some nodes trying to fetch local state data older than 128 blocks.\r\n\r\nBelow, the amount of reorgs deeper than 12 blocks that we had in the last 10 days:\r\n\r\n<img width=\"966\" alt=\"image\" src=\"https://user-images.githubusercontent.com/47108/115593457-8681fe80-a2a2-11eb-8b45-984b881690d6.png\">\r\n\r\n_Source: https://ropsten.etherscan.io/blocks_forked_\r\n\r\nWhat are good strategies to mitigate/solve this problem?\r\nOn a node level, we wonder if it would be beneficial to increase the state retention for Ropsten to an arbitrary number, let's say, 512 — or as a user-defined flag. On an network level, maybe deploying more mining power might help as well?\r\n\r\nAdditionally, is there a forkmon for Ropsten that could be used for network monitoring?\r\n\r\n\r\nTYSM!\r\n\r\n# Implementation\r\n\r\nAre you willing to implement this feature?\r\n\r\n✅",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22713/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22713/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/824648873",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22713#issuecomment-824648873",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22713",
    "id": 824648873,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyNDY0ODg3Mw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-22T08:29:46Z",
    "updated_at": "2021-04-22T08:29:46Z",
    "author_association": "MEMBER",
    "body": "Triage discussion, there are two things that need to be changed. \r\n\r\n- Pruning: right now, we explicitly do not memory-prune the most recent `128` blocks. We would need to make this limit configurable, so the \"pruning avoidance\" can be set larger. \r\n- Snapshot diff layers. Right now, we maintain \"difflayers\" for the most recent 128 blocks, to support reorgs. We would either need to make this limit configurable (which increases the memory consumption), _or_ make it so that once you reorg over the threshold, things at least keep working (I hope they already do -- we simply don't find the snapshot root and will execute trie-only). ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/824648873/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/824649380",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22713#issuecomment-824649380",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22713",
    "id": 824649380,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyNDY0OTM4MA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-22T08:30:29Z",
    "updated_at": "2021-04-22T08:30:29Z",
    "author_association": "MEMBER",
    "body": "> Additionally, is there a forkmon for Ropsten that could be used for network monitoring?\r\n\r\nWe had https://testnet.forkmon.ethdevops.io/ up temporarily, and reused it for the testnets. It's not active any longer, however. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/824649380/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
