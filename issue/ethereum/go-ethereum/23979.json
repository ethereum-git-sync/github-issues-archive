{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23979",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23979/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23979/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23979/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/23979",
  "id": 1064080202,
  "node_id": "I_kwDOAOvK984_bJNK",
  "number": 23979,
  "title": "Transaction.AsMessage   error:  invalid transaction v, r, s values",
  "user": {
    "login": "wangruics",
    "id": 88173849,
    "node_id": "MDQ6VXNlcjg4MTczODQ5",
    "avatar_url": "https://avatars.githubusercontent.com/u/88173849?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wangruics",
    "html_url": "https://github.com/wangruics",
    "followers_url": "https://api.github.com/users/wangruics/followers",
    "following_url": "https://api.github.com/users/wangruics/following{/other_user}",
    "gists_url": "https://api.github.com/users/wangruics/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wangruics/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wangruics/subscriptions",
    "organizations_url": "https://api.github.com/users/wangruics/orgs",
    "repos_url": "https://api.github.com/users/wangruics/repos",
    "events_url": "https://api.github.com/users/wangruics/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wangruics/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 268304226,
      "node_id": "MDU6TGFiZWwyNjgzMDQyMjY=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:docs",
      "name": "type:docs",
      "color": "fef2c0",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-11-26T03:54:10Z",
  "updated_at": "2021-11-26T07:21:17Z",
  "closed_at": "2021-11-26T06:27:48Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "tx : 0x570ce19176bd0002b04a9179309129bbdaf0c4252ffeb76aedbb038cdf662850    block_number: 46205\r\n\r\n\r\n\r\n```go\r\nfunc  TestTx(){\r\n\r\n\ttxStr := \"0x570ce19176bd0002b04a9179309129bbdaf0c4252ffeb76aedbb038cdf662850\"\r\n\ttransaction,_,err := client.TransactionByHash(context.Background(),common.HexToHash(txStr))\r\n\tif err!= nil{\r\n\t\tlog.Fatal(\"get Transaction error\")\r\n\t}\r\n\r\n\tblock,err :=  client.BlockByNumber(context.Background(),big.NewInt(46205))\r\n\tif err != nil{\r\n\t\tlog.Panic(\"get block error\")\r\n\t}\r\n\r\n\tlog.Println(transaction.Hash().String() , block.Number().String())\r\n\tlog.Println(block.BaseFee()) // BaseFee is nil\r\n\tasMessage, e := transaction.AsMessage(types.LatestSignerForChainID(big.NewInt(1)), block.BaseFee())\r\n\tif e == nil {\r\n\t\tlog.Println(asMessage.From())\r\n\t\tasMessage.GasPrice().String()\r\n\t}else{\r\n\t\tlog.Println(e)  // here     invalid transaction v, r, s values\r\n\t}\r\n\r\n\r\n}\r\n```",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23979/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23979/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/979726483",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23979#issuecomment-979726483",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23979",
    "id": 979726483,
    "node_id": "IC_kwDOAOvK9846ZXCT",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-26T06:27:48Z",
    "updated_at": "2021-11-26T06:27:48Z",
    "author_association": "MEMBER",
    "body": "Block 46205 is part of Frontier, which did not have chain-id based replay protection yet. That was introduced at a later fork. You'll need to use a `nil` chain ID to recover signatures up until block `#2675000` https://eips.ethereum.org/EIPS/eip-607",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/979726483/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/979734123",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23979#issuecomment-979734123",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23979",
    "id": 979734123,
    "node_id": "IC_kwDOAOvK9846ZY5r",
    "user": {
      "login": "wangruics",
      "id": 88173849,
      "node_id": "MDQ6VXNlcjg4MTczODQ5",
      "avatar_url": "https://avatars.githubusercontent.com/u/88173849?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wangruics",
      "html_url": "https://github.com/wangruics",
      "followers_url": "https://api.github.com/users/wangruics/followers",
      "following_url": "https://api.github.com/users/wangruics/following{/other_user}",
      "gists_url": "https://api.github.com/users/wangruics/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wangruics/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wangruics/subscriptions",
      "organizations_url": "https://api.github.com/users/wangruics/orgs",
      "repos_url": "https://api.github.com/users/wangruics/repos",
      "events_url": "https://api.github.com/users/wangruics/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wangruics/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-26T06:50:05Z",
    "updated_at": "2021-11-26T07:21:17Z",
    "author_association": "NONE",
    "body": "> Block 46205 is part of Frontier, which did not have chain-id based replay protection yet. That was introduced at a later fork. You'll need to use a `nil` chain ID to recover signatures up until block `#2675000` https://eips.ethereum.org/EIPS/eip-607\r\n\r\n```\r\nasMessage, e := transaction.AsMessage(types.LatestSignerForChainID(nil),nil)\r\n\tif e == nil {\r\n\t\tlog.Println(asMessage.From())\r\n\t\tasMessage.GasPrice().String()\r\n\t}else{\r\n\t\tlog.Println(e)  // here     invalid transaction v, r, s values\r\n\t}\r\n\r\n```\r\n\r\nthe  same  error   .  ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/979734123/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/979736772",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23979#issuecomment-979736772",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23979",
    "id": 979736772,
    "node_id": "IC_kwDOAOvK9846ZZjE",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-26T06:57:08Z",
    "updated_at": "2021-11-26T06:57:08Z",
    "author_association": "MEMBER",
    "body": "Hmm, seems `LatestSignerForChainID` will at max go down until Homestead, but not Frontier. There are a few signatures that are valid in Frontier but not any more in Homestead. Could you try `types.MakeSigner(params.MainnetChainConfig, big.NewInt(46205))` to create the signer? That should also support Frontier signatures that were invalidated later https://github.com/ethereum/go-ethereum/blob/master/core/types/transaction_signing.go#L40",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/979736772/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/979738613",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23979#issuecomment-979738613",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23979",
    "id": 979738613,
    "node_id": "IC_kwDOAOvK9846ZZ_1",
    "user": {
      "login": "wangruics",
      "id": 88173849,
      "node_id": "MDQ6VXNlcjg4MTczODQ5",
      "avatar_url": "https://avatars.githubusercontent.com/u/88173849?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wangruics",
      "html_url": "https://github.com/wangruics",
      "followers_url": "https://api.github.com/users/wangruics/followers",
      "following_url": "https://api.github.com/users/wangruics/following{/other_user}",
      "gists_url": "https://api.github.com/users/wangruics/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wangruics/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wangruics/subscriptions",
      "organizations_url": "https://api.github.com/users/wangruics/orgs",
      "repos_url": "https://api.github.com/users/wangruics/repos",
      "events_url": "https://api.github.com/users/wangruics/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wangruics/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-26T07:01:58Z",
    "updated_at": "2021-11-26T07:01:58Z",
    "author_association": "NONE",
    "body": "> \r\n` types.MakeSigner(params.MainnetChainConfig, big.NewInt(46205)) `\r\nThanks. It is ok, I  got the correct from of this transaction",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/979738613/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
