{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17199",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17199/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17199/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17199/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/17199",
  "id": 342428933,
  "node_id": "MDU6SXNzdWUzNDI0Mjg5MzM=",
  "number": 17199,
  "title": "Block Syncing Freezes Intermittently",
  "user": {
    "login": "jakecraige",
    "id": 3799709,
    "node_id": "MDQ6VXNlcjM3OTk3MDk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3799709?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jakecraige",
    "html_url": "https://github.com/jakecraige",
    "followers_url": "https://api.github.com/users/jakecraige/followers",
    "following_url": "https://api.github.com/users/jakecraige/following{/other_user}",
    "gists_url": "https://api.github.com/users/jakecraige/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jakecraige/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jakecraige/subscriptions",
    "organizations_url": "https://api.github.com/users/jakecraige/orgs",
    "repos_url": "https://api.github.com/users/jakecraige/repos",
    "events_url": "https://api.github.com/users/jakecraige/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jakecraige/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 856638432,
      "node_id": "MDU6TGFiZWw4NTY2Mzg0MzI=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/status:inactive",
      "name": "status:inactive",
      "color": "ffffff",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2018-07-18T17:49:17Z",
  "updated_at": "2019-08-02T21:23:52Z",
  "closed_at": "2019-08-02T21:23:52Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: At least `1.8.7`, `1.8.11` and `1.8.12`\r\nArchive Node: Database is 1.2 TB+\r\nOS & Version: Linux\r\n\r\n#### Expected behaviour\r\nConsistently syncing blocks as they are propagated around the network without long delays\r\n\r\n#### Actual behaviour\r\nSyncing seems freeze for periods of time and then eventually recover as can be seen on this graph of block heights. The top two are running 1.8.11 and the bottom two 1.8.12. The logs below are from the one in yellow.\r\n\r\n1hr period for detail which matches log further down. Time zone is Pacific\r\n![screen shot 2018-07-18 at 9 24 11 am](https://user-images.githubusercontent.com/3799709/42894687-5c99020e-8a6c-11e8-91b9-78ffef9b41e4.png)\r\n\r\n24hours\r\n![screen shot 2018-07-18 at 12 43 19 pm](https://user-images.githubusercontent.com/3799709/42903966-424968e6-8a88-11e8-8113-90afc54f75ff.png)\r\n\r\nThe first time we saw this sort of thing was on 2018-05-15 with 1.8.7 but it wasn't too bad. In the past few weeks this has become more regular and problematic.\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\nThis is intermittent, sometimes it happens sometimes it doesn't. No method I'm aware of to reproduce. Last night (July 17-18) was particularly bad and we saw large periods of times like in the graph.\r\n\r\n#### Logs\r\n\r\nI've done a brief analysis on the logs and noticed a massive spike in the \"Fetching batch of block bodies\" log message when this is happening. Here's a screenshot of counts of that specific message. \r\n\r\n![screen shot 2018-07-18 at 9 30 02 am](https://user-images.githubusercontent.com/3799709/42895002-5695425e-8a6d-11e8-9a62-9057f76338f1.png)\r\n\r\nHere's a sample of the logs during this period. Time zone is UTC:\r\nhttps://gist.github.com/jakecraige/34c2aa32a46b90406d1482a2f196c16b#file-geth-csv\r\n\r\nAny guidance here would be helpful.",
  "closed_by": {
    "login": "jakecraige",
    "id": 3799709,
    "node_id": "MDQ6VXNlcjM3OTk3MDk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3799709?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jakecraige",
    "html_url": "https://github.com/jakecraige",
    "followers_url": "https://api.github.com/users/jakecraige/followers",
    "following_url": "https://api.github.com/users/jakecraige/following{/other_user}",
    "gists_url": "https://api.github.com/users/jakecraige/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jakecraige/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jakecraige/subscriptions",
    "organizations_url": "https://api.github.com/users/jakecraige/orgs",
    "repos_url": "https://api.github.com/users/jakecraige/repos",
    "events_url": "https://api.github.com/users/jakecraige/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jakecraige/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17199/reactions",
    "total_count": 6,
    "+1": 6,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17199/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/407304859",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17199#issuecomment-407304859",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17199",
    "id": 407304859,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNzMwNDg1OQ==",
    "user": {
      "login": "SvenMeyer",
      "id": 25609,
      "node_id": "MDQ6VXNlcjI1NjA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/25609?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SvenMeyer",
      "html_url": "https://github.com/SvenMeyer",
      "followers_url": "https://api.github.com/users/SvenMeyer/followers",
      "following_url": "https://api.github.com/users/SvenMeyer/following{/other_user}",
      "gists_url": "https://api.github.com/users/SvenMeyer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SvenMeyer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SvenMeyer/subscriptions",
      "organizations_url": "https://api.github.com/users/SvenMeyer/orgs",
      "repos_url": "https://api.github.com/users/SvenMeyer/repos",
      "events_url": "https://api.github.com/users/SvenMeyer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SvenMeyer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-24T07:10:43Z",
    "updated_at": "2018-07-24T07:10:43Z",
    "author_association": "NONE",
    "body": "likely same issue as #16825 ... nice graphs though ;-)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/407304859/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/514934777",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17199#issuecomment-514934777",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17199",
    "id": 514934777,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNDkzNDc3Nw==",
    "user": {
      "login": "stale[bot]",
      "id": 26384082,
      "node_id": "MDM6Qm90MjYzODQwODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stale%5Bbot%5D",
      "html_url": "https://github.com/apps/stale",
      "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2019-07-25T07:41:21Z",
    "updated_at": "2019-07-25T07:41:21Z",
    "author_association": "NONE",
    "body": "This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you for your contributions.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/514934777/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/517848456",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17199#issuecomment-517848456",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17199",
    "id": 517848456,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzg0ODQ1Ng==",
    "user": {
      "login": "jakecraige",
      "id": 3799709,
      "node_id": "MDQ6VXNlcjM3OTk3MDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3799709?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakecraige",
      "html_url": "https://github.com/jakecraige",
      "followers_url": "https://api.github.com/users/jakecraige/followers",
      "following_url": "https://api.github.com/users/jakecraige/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakecraige/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakecraige/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakecraige/subscriptions",
      "organizations_url": "https://api.github.com/users/jakecraige/orgs",
      "repos_url": "https://api.github.com/users/jakecraige/repos",
      "events_url": "https://api.github.com/users/jakecraige/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakecraige/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-02T21:23:52Z",
    "updated_at": "2019-08-02T21:23:52Z",
    "author_association": "NONE",
    "body": "Closing as we haven't seen this issue in quite awhile now 👍 ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/517848456/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
