{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21001",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21001/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21001/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21001/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/21001",
  "id": 608901436,
  "node_id": "MDU6SXNzdWU2MDg5MDE0MzY=",
  "number": 21001,
  "title": "Sync panic: runtime error: invalid memory address or nil pointer dereference (*Downloader).findAncestor",
  "user": {
    "login": "ethers",
    "id": 6937903,
    "node_id": "MDQ6VXNlcjY5Mzc5MDM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6937903?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ethers",
    "html_url": "https://github.com/ethers",
    "followers_url": "https://api.github.com/users/ethers/followers",
    "following_url": "https://api.github.com/users/ethers/following{/other_user}",
    "gists_url": "https://api.github.com/users/ethers/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ethers/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ethers/subscriptions",
    "organizations_url": "https://api.github.com/users/ethers/orgs",
    "repos_url": "https://api.github.com/users/ethers/repos",
    "events_url": "https://api.github.com/users/ethers/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ethers/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2020-04-29T09:15:51Z",
  "updated_at": "2020-08-27T08:55:36Z",
  "closed_at": "2020-08-20T08:54:52Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Running geth-linux-amd64-1.9.13-cbc4ac26\r\n\r\n```\r\nINFO [04-29|05:12:22.854] Importing sidechain segment              start=2603003 end=2603945                                                                       [1/1929]\r\nERROR[04-29|05:12:25.442] \r\n########## BAD BLOCK #########\r\nChain config: {ChainID: 5 Homestead: 0 DAO: <nil> DAOSupport: true EIP150: 0 EIP155: 0 EIP158: 0 Byzantium: 0 Constantinople: 0 Petersburg: 0 Istanbul: 1561651, Muir Glaci\r\ner: <nil>, Engine: clique}\r\n\r\nNumber: 2603095\r\nHash: 0x01484227c43905bc055d9009b9a1b79d7997d4a54a574379e0302141f69221c9\r\n         0: cumulative: 21000 gas: 21000 contract: 0x0000000000000000000000000000000000000000 status: 1 tx: 0x4469d486c75064a80c41e7ca35d5e95f8ed85f89c6ee25019391222b969fe\r\n77c logs: [] bloom: 0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\r\n000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\r\n000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\r\n0000000000000000000 state: \r\n         1: cumulative: 3737295 gas: 3716295 contract: 0x0000000000000000000000000000000000000000 status: 1 tx: 0xcb55e49e6d1f92b8e8c26533573fc72bf6c959d2d18964ee13e159fff\r\ncdaeacc logs: [] bloom: 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\r\n000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\r\n000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\r\n00000000000000000000000 state: \r\n\r\n\r\nError: invalid merkle root (remote: 0475158b868e75fae8f71e0814d38fcec08056da9e413335e1e42b347ad952a8 local: db71c3fc0eda721f479cbc907659b1893414e9a2ba24dc841304145888b5f1f\r\n1)\r\n##############################\r\n \r\nWARN [04-29|05:12:25.443] Synchronisation failed, dropping peer    peer=8ddd4ff70f007631 err=\"retrieved hash chain is invalid\"\r\nINFO [04-29|05:12:31.204] Looking for peers                        peercount=1 tried=5 static=0\r\npanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x1c0 pc=0xb106dc]\r\n\r\ngoroutine 546 [running]:\r\ngithub.com/ethereum/go-ethereum/eth/downloader.(*Downloader).findAncestor(0xc00134d340, 0xc004558e10, 0xc000b34fc0, 0x0, 0x0, 0xa)\r\n        /home/travis/gopath/src/github.com/ethereum/go-ethereum/eth/downloader/downloader.go:877 +0x14fc\r\ngithub.com/ethereum/go-ethereum/eth/downloader.(*Downloader).syncWithPeer(0xc00134d340, 0xc004558e10, 0x3c0784b3c4c884e2, 0xed832ec9a1495358, 0x5640864266891aeb, 0xb54f627\r\n0a5a63cd3, 0xc00c4f6160, 0x0, 0x0)\r\n        /home/travis/gopath/src/github.com/ethereum/go-ethereum/eth/downloader/downloader.go:443 +0x3da\r\ngithub.com/ethereum/go-ethereum/eth/downloader.(*Downloader).synchronise(0xc00134d340, 0xc000d86710, 0x10, 0x3c0784b3c4c884e2, 0xed832ec9a1495358, 0x5640864266891aeb, 0xb5\r\n4f6270a5a63cd3, 0xc00c4f6160, 0x0, 0x0, ...)\r\n        /home/travis/gopath/src/github.com/ethereum/go-ethereum/eth/downloader/downloader.go:411 +0x36c\r\ngithub.com/ethereum/go-ethereum/eth/downloader.(*Downloader).Synchronise(0xc00134d340, 0xc000d86710, 0x10, 0x3c0784b3c4c884e2, 0xed832ec9a1495358, 0x5640864266891aeb, 0xb5\r\n4f6270a5a63cd3, 0xc00c4f6160, 0x0, 0x1000000000001, ...)\r\n        /home/travis/gopath/src/github.com/ethereum/go-ethereum/eth/downloader/downloader.go:323 +0x8e\r\ngithub.com/ethereum/go-ethereum/eth.(*ProtocolManager).doSync(0xc0013be5a0, 0xc00c4d2580, 0xf2c5cd888491b0b9, 0x3b88e5f085e0315c)\r\n        /home/travis/gopath/src/github.com/ethereum/go-ethereum/eth/sync.go:289 +0x98\r\ngithub.com/ethereum/go-ethereum/eth.(*chainSyncer).startSync.func1(0xc0013926f0, 0xc00c4d2580)\r\n        /home/travis/gopath/src/github.com/ethereum/go-ethereum/eth/sync.go:283 +0x38\r\ncreated by github.com/ethereum/go-ethereum/eth.(*chainSyncer).startSync\r\n        /home/travis/gopath/src/github.com/ethereum/go-ethereum/eth/sync.go:283 +0x7a\r\n```",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21001/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21001/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/621161585",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21001#issuecomment-621161585",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21001",
    "id": 621161585,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMTE2MTU4NQ==",
    "user": {
      "login": "ligi",
      "id": 111600,
      "node_id": "MDQ6VXNlcjExMTYwMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/111600?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ligi",
      "html_url": "https://github.com/ligi",
      "followers_url": "https://api.github.com/users/ligi/followers",
      "following_url": "https://api.github.com/users/ligi/following{/other_user}",
      "gists_url": "https://api.github.com/users/ligi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ligi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ligi/subscriptions",
      "organizations_url": "https://api.github.com/users/ligi/orgs",
      "repos_url": "https://api.github.com/users/ligi/repos",
      "events_url": "https://api.github.com/users/ligi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ligi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-29T12:09:19Z",
    "updated_at": "2020-04-29T12:09:19Z",
    "author_association": "MEMBER",
    "body": "Did you have an unclean shutdown before this crash?\r\nWe really need #20859 to not need to ask this question anymore",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/621161585/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/631339127",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21001#issuecomment-631339127",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21001",
    "id": 631339127,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMTMzOTEyNw==",
    "user": {
      "login": "ethers",
      "id": 6937903,
      "node_id": "MDQ6VXNlcjY5Mzc5MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6937903?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ethers",
      "html_url": "https://github.com/ethers",
      "followers_url": "https://api.github.com/users/ethers/followers",
      "following_url": "https://api.github.com/users/ethers/following{/other_user}",
      "gists_url": "https://api.github.com/users/ethers/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ethers/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ethers/subscriptions",
      "organizations_url": "https://api.github.com/users/ethers/orgs",
      "repos_url": "https://api.github.com/users/ethers/repos",
      "events_url": "https://api.github.com/users/ethers/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ethers/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-20T08:55:18Z",
    "updated_at": "2020-05-20T08:57:18Z",
    "author_association": "MEMBER",
    "body": "Yes it crashed before this one.  #20859 looks very helpful and as another idea related to it, in some cases where Geth crashes with CRIT, should a message be provided to the user at that time, what they need to do next?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/631339127/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/677469650",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21001#issuecomment-677469650",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21001",
    "id": 677469650,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3NzQ2OTY1MA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-20T08:54:30Z",
    "updated_at": "2020-08-20T08:54:30Z",
    "author_association": "MEMBER",
    "body": "The root cause here is that the db has been corrupted. There's not a whole lot that can be done about it, right now, but @karalabe is working on making rollback-scenarios a lot better. We've also done some work trying to ensure that things like currentBlock etc are stored in the right order, to minimize the impacts of crashes. \r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/677469650/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
