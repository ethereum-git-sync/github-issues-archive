{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16097",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16097/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16097/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16097/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/16097",
  "id": 297353740,
  "node_id": "MDU6SXNzdWUyOTczNTM3NDA=",
  "number": 16097,
  "title": "Import fails after restart",
  "user": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2018-02-15T07:41:16Z",
  "updated_at": "2019-02-19T08:52:24Z",
  "closed_at": "2018-02-15T10:34:33Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: `Geth/v1.8.1-unstable-dc7ca52b/linux-amd64/go1.9.2`\r\nOS & Version: Linux\r\n\r\n#### Problem\r\n\r\nI got the hive suite running again yesterday. Now we're getting all failures\r\nhttp://hivetests.ethstats.net/#displayLog=artefacts/20180215_050945-go-ethereum%3Amaster/client-775e2b79.log\r\nFirst we do a successfull import of some blocks: \r\n```\r\nINFO [02-15|05:27:18] Importing blockchain                     file=0001.rlp\r\nINFO [02-15|05:27:18] Imported new chain segment               blocks=1 txs=1 mgas=0.128 elapsed=7.165ms mgasps=17.884 number=1 hash=7af679…5d3ccd cache=1.31kB\r\nERROR[02-15|05:27:18] Dangling trie nodes after full cleanup \r\nINFO [02-15|05:27:18] Blockchain manager stopped \r\nImport done in 7.628636ms.\r\n\r\nCompactions\r\n Level |   Tables   |    Size(MB)   |    Time(sec)  |    Read(MB)   |   Write(MB)\r\n-------+------------+---------------+---------------+---------------+---------------\r\n   0   |          1 |       0.00123 |       0.00000 |       0.00000 |       0.00000\r\n\r\nTrie cache misses:  7\r\nTrie cache unloads: 0\r\n\r\nObject memory: 194.594 MB current, 194.143 MB peak\r\nSystem memory: 404.662 MB current, 404.412 MB peak\r\nAllocations:   0.018 million\r\nGC pause:      813.405µs\r\n\r\n```\r\nThen after restart, it rewinds the blockchain and removes the block we imported: \r\n```\r\nINFO [02-15|05:27:18] Initialising Ethereum protocol           versions=\"[63 62]\" network=1\r\nWARN [02-15|05:27:18] Head state missing, repairing chain      number=1 hash=7af679…5d3ccd\r\nINFO [02-15|05:27:18] Rewound blockchain to past state         number=0 hash=743b09…0f5488\r\nINFO [02-15|05:27:18] Loaded most recent local header          number=1 hash=7af679…5d3ccd td=262144\r\nINFO [02-15|05:27:18] Loaded most recent local full block      number=0 hash=743b09…0f5488 td=131072\r\nINFO [02-15|05:27:18] Loaded most recent local fast block      number=1 hash=7af679…5d3ccd td=262144\r\n```\r\n",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16097/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16097/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/394098909",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16097#issuecomment-394098909",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16097",
    "id": 394098909,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NDA5ODkwOQ==",
    "user": {
      "login": "upers",
      "id": 12727242,
      "node_id": "MDQ6VXNlcjEyNzI3MjQy",
      "avatar_url": "https://avatars.githubusercontent.com/u/12727242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/upers",
      "html_url": "https://github.com/upers",
      "followers_url": "https://api.github.com/users/upers/followers",
      "following_url": "https://api.github.com/users/upers/following{/other_user}",
      "gists_url": "https://api.github.com/users/upers/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/upers/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/upers/subscriptions",
      "organizations_url": "https://api.github.com/users/upers/orgs",
      "repos_url": "https://api.github.com/users/upers/repos",
      "events_url": "https://api.github.com/users/upers/events{/privacy}",
      "received_events_url": "https://api.github.com/users/upers/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-02T16:21:31Z",
    "updated_at": "2018-06-02T16:21:31Z",
    "author_association": "NONE",
    "body": "I have same problem in my private POA net.\r\nI got error:\r\n---------------------------------ERROR--------------------------------------\r\nError: invalid merkle root\r\n########## BAD BLOCK #########\r\nChain config: {ChainID: 452 Homestead: 1 DAO: <nil> DAOSupport: false EIP150: 2 EIP155: 3 EIP158: 3 Byzantium: 4 Constantinople: <nil> Engine: clique}\r\n\r\nNumber: 1626771\r\nHash: 0x53e5c4ded722ddbe00dbd8c153aa3b64741d15b5d731f5ffe745b2e1bca2d259\r\n----------------------------------------------------------------------------------------\r\nI fixed this by restarting all nodes and adding peers manually through the get.ipc.\r\n\r\nBut in 10 hours  all my nodes stopped synchronizing and accordingly ceased to create blocks.\r\nMessage from log: \"ERROR[06-01|17:58:24] Dangling trie nodes after full cleanup.\"\r\nI can not clean the block because there is valuable information there.\r\nI tried restart nodes and added peers manually, it didn't work.\r\n\r\nAnd there no error messages in log, only: \"Signed recently, must wait for others.\"\r\nGeth version: 1.8.3-stable.\r\nGo version: go1.10.1\r\nOS: ubuntu 16.04\r\nGenesis file:\r\n{\r\n  \"config\": {\r\n    \"chainId\": 452,\r\n    \"homesteadBlock\": 1,\r\n    \"eip150Block\": 2,\r\n    \"eip150Hash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n    \"eip155Block\": 3,\r\n    \"eip158Block\": 3,\r\n    \"byzantiumBlock\": 4,\r\n    \"clique\": {\r\n      \"period\": 3,\r\n      \"epoch\": 30000\r\n    }\r\n  },\r\n  \"nonce\": \"0x0\",\r\n  \"timestamp\": \"0x5ac632c4\",\r\n  \"extraData\": \"0x00000000000000000000000000000000000000000000000000000000000000002368c95eb9ea3578a20d6887ccb40773499b93d5c67be939661d2559acfb059fc1737a2ceaaed4ae0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\r\n  \"gasLimit\": \"0x47b760\",\r\n  \"difficulty\": \"0x1\",\r\n  \"mixHash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n  \"coinbase\": \"0x0000000000000000000000000000000000000000\",\r\n  \"alloc\": {\r\n    \"2368c95eb9ea3578a20d6887ccb40773499b93d5\": {\r\n      \"balance\": \"0x200000000000000000000000000000000000000000000000000000000000000\"\r\n    },\r\n    \"c67be939661d2559acfb059fc1737a2ceaaed4ae\": {\r\n      \"balance\": \"0x200000000000000000000000000000000000000000000000000000000000000\"\r\n    }\r\n  },\r\n  \"number\": \"0x0\",\r\n  \"gasUsed\": \"0x0\",\r\n  \"parentHash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\"\r\n}",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/394098909/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/465043348",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16097#issuecomment-465043348",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16097",
    "id": 465043348,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2NTA0MzM0OA==",
    "user": {
      "login": "relaxbao",
      "id": 19773804,
      "node_id": "MDQ6VXNlcjE5NzczODA0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19773804?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/relaxbao",
      "html_url": "https://github.com/relaxbao",
      "followers_url": "https://api.github.com/users/relaxbao/followers",
      "following_url": "https://api.github.com/users/relaxbao/following{/other_user}",
      "gists_url": "https://api.github.com/users/relaxbao/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/relaxbao/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/relaxbao/subscriptions",
      "organizations_url": "https://api.github.com/users/relaxbao/orgs",
      "repos_url": "https://api.github.com/users/relaxbao/repos",
      "events_url": "https://api.github.com/users/relaxbao/events{/privacy}",
      "received_events_url": "https://api.github.com/users/relaxbao/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-19T08:52:24Z",
    "updated_at": "2019-02-19T08:52:24Z",
    "author_association": "NONE",
    "body": "hello, have you solve the problem yet?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/465043348/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
