{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25322",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25322/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25322/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25322/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/25322",
  "id": 1307929285,
  "node_id": "I_kwDOAOvK985N9WrF",
  "number": 25322,
  "title": "`gasprice` value in `eth_call` and `eth_estimateGas`",
  "user": {
    "login": "fredlacs",
    "id": 32464905,
    "node_id": "MDQ6VXNlcjMyNDY0OTA1",
    "avatar_url": "https://avatars.githubusercontent.com/u/32464905?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fredlacs",
    "html_url": "https://github.com/fredlacs",
    "followers_url": "https://api.github.com/users/fredlacs/followers",
    "following_url": "https://api.github.com/users/fredlacs/following{/other_user}",
    "gists_url": "https://api.github.com/users/fredlacs/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fredlacs/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fredlacs/subscriptions",
    "organizations_url": "https://api.github.com/users/fredlacs/orgs",
    "repos_url": "https://api.github.com/users/fredlacs/repos",
    "events_url": "https://api.github.com/users/fredlacs/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fredlacs/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    },
    {
      "id": 1132689577,
      "node_id": "MDU6TGFiZWwxMTMyNjg5NTc3",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/status:triage",
      "name": "status:triage",
      "color": "6be514",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-07-18T13:04:28Z",
  "updated_at": "2022-07-21T08:27:11Z",
  "closed_at": "2022-07-21T08:27:11Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\nNot system dependent\r\n\r\n#### Expected behaviour\r\n`gasprice` should return the basefee even when set to `0` in an `eth_call` / `eth_estimateGas`\r\n\r\n#### Actual behaviour\r\n`gasprice` returns `0`\r\nThis value is never actually valid input in a live chain, I see it more as a way to short-circuit the charging for the current execution.\r\nEnds up being a bit unexpected behaviour to me since eip 1559\r\n\r\n#### Steps to reproduce the behaviour\r\n```solidity\r\npragma solidity ^0.8.0;\r\ncontract tester {\r\n    uint256 public gasPrice;\r\n    function setGasPrice() external {\r\n        gasPrice = tx.gasprice;\r\n    }\r\n}\r\n```\r\nfun fact, gas estimation never works on the first tx against the above since it sets the storage slot to `0` during estimation.\r\n\r\n#### Backtrace\r\n\r\n````\r\n[backtrace]\r\n````\r\n\r\nWhen submitting logs: please submit them as text and not screenshots.",
  "closed_by": {
    "login": "ligi",
    "id": 111600,
    "node_id": "MDQ6VXNlcjExMTYwMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/111600?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ligi",
    "html_url": "https://github.com/ligi",
    "followers_url": "https://api.github.com/users/ligi/followers",
    "following_url": "https://api.github.com/users/ligi/following{/other_user}",
    "gists_url": "https://api.github.com/users/ligi/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ligi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ligi/subscriptions",
    "organizations_url": "https://api.github.com/users/ligi/orgs",
    "repos_url": "https://api.github.com/users/ligi/repos",
    "events_url": "https://api.github.com/users/ligi/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ligi/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25322/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25322/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1187434284",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25322#issuecomment-1187434284",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25322",
    "id": 1187434284,
    "node_id": "IC_kwDOAOvK985Gxs8s",
    "user": {
      "login": "lightclient",
      "id": 14004106,
      "node_id": "MDQ6VXNlcjE0MDA0MTA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14004106?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lightclient",
      "html_url": "https://github.com/lightclient",
      "followers_url": "https://api.github.com/users/lightclient/followers",
      "following_url": "https://api.github.com/users/lightclient/following{/other_user}",
      "gists_url": "https://api.github.com/users/lightclient/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lightclient/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lightclient/subscriptions",
      "organizations_url": "https://api.github.com/users/lightclient/orgs",
      "repos_url": "https://api.github.com/users/lightclient/repos",
      "events_url": "https://api.github.com/users/lightclient/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lightclient/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-18T13:30:07Z",
    "updated_at": "2022-07-18T13:30:07Z",
    "author_association": "MEMBER",
    "body": "In order to allow users to simulate calls with 0 gas price, some invariant needs to break. So either:\r\n\r\n* We do not deduct the gas fees from the user, but propagate the base fee into the EVM so that it is available via `GASPRICE` - causing the tx origin's balance to not accurately reflect the simulation.\r\n* We deduct the gas fees (since the gas price is 0) and propagate the 0 gas price into the EVM, so that the account's balance is accurately reflected, but the simulation is contrived because it is below the network's base fee.\r\n\r\nWe are currently doing the later. It isn't immediately obvious that the former is \"more correct\".",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1187434284/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
