{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15826",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15826/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15826/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15826/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/15826",
  "id": 286580384,
  "node_id": "MDU6SXNzdWUyODY1ODAzODQ=",
  "number": 15826,
  "title": "debug.traceTransaction is a memory hog",
  "user": {
    "login": "kumarde",
    "id": 3020845,
    "node_id": "MDQ6VXNlcjMwMjA4NDU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3020845?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kumarde",
    "html_url": "https://github.com/kumarde",
    "followers_url": "https://api.github.com/users/kumarde/followers",
    "following_url": "https://api.github.com/users/kumarde/following{/other_user}",
    "gists_url": "https://api.github.com/users/kumarde/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kumarde/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kumarde/subscriptions",
    "organizations_url": "https://api.github.com/users/kumarde/orgs",
    "repos_url": "https://api.github.com/users/kumarde/repos",
    "events_url": "https://api.github.com/users/kumarde/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kumarde/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2018-01-07T16:19:02Z",
  "updated_at": "2018-01-08T15:30:31Z",
  "closed_at": "2018-01-08T14:59:19Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: `1.7.3 stable`\r\nOS & Version: Linux\r\n\r\nI'm trying to run a moderate number of transaction traces (10K+) using `debug.traceTransaction` on a fairly beefy machine (128GB of RAM, 32 cores), but I can only get through about ~1K before it uses all the RAM AND all the swap and gets killed by the OS. \r\n\r\nIs there any intuition as to why this is happening? Is this \"bug\" worthy? ",
  "closed_by": {
    "login": "kumarde",
    "id": 3020845,
    "node_id": "MDQ6VXNlcjMwMjA4NDU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3020845?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kumarde",
    "html_url": "https://github.com/kumarde",
    "followers_url": "https://api.github.com/users/kumarde/followers",
    "following_url": "https://api.github.com/users/kumarde/following{/other_user}",
    "gists_url": "https://api.github.com/users/kumarde/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kumarde/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kumarde/subscriptions",
    "organizations_url": "https://api.github.com/users/kumarde/orgs",
    "repos_url": "https://api.github.com/users/kumarde/repos",
    "events_url": "https://api.github.com/users/kumarde/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kumarde/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15826/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15826/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/355900506",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/15826#issuecomment-355900506",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15826",
    "id": 355900506,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NTkwMDUwNg==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-08T07:48:28Z",
    "updated_at": "2018-01-08T07:48:44Z",
    "author_association": "MEMBER",
    "body": "The entire tracing is rewritten on master already. We're also introducing much more capable JavaScript tracing functionality, which allows users to write their own tracers as well as use a few ones built in (https://github.com/ethereum/go-ethereum/pull/15516).\r\n\r\nThat being said, tracing a transaction and **creating a dump of all opcodes** will always be humongous since some transactions simply run *that* many VM instructions. That's why our suggestion is to either use the built in custom tracers, or to write your own that only collects what you need, and doesn't export everything and the kitchen sink. These custom tracers run in the node, so there's no communication overhead and the memory overhead is only what your tracer personally needs.\r\n  ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/355900506/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/355989288",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/15826#issuecomment-355989288",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15826",
    "id": 355989288,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NTk4OTI4OA==",
    "user": {
      "login": "kumarde",
      "id": 3020845,
      "node_id": "MDQ6VXNlcjMwMjA4NDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3020845?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kumarde",
      "html_url": "https://github.com/kumarde",
      "followers_url": "https://api.github.com/users/kumarde/followers",
      "following_url": "https://api.github.com/users/kumarde/following{/other_user}",
      "gists_url": "https://api.github.com/users/kumarde/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kumarde/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kumarde/subscriptions",
      "organizations_url": "https://api.github.com/users/kumarde/orgs",
      "repos_url": "https://api.github.com/users/kumarde/repos",
      "events_url": "https://api.github.com/users/kumarde/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kumarde/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-08T14:59:19Z",
    "updated_at": "2018-01-08T14:59:19Z",
    "author_association": "NONE",
    "body": "Interesting. \r\n\r\nFor my purpose, I need the entirety of the opcodes and all state from the VM, so on that matter I don't think I can budge.\r\n\r\nHowever, it's nice that things have been rewritten, I can see how this improves memory performance. Thanks! ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/355989288/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/355998488",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/15826#issuecomment-355998488",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15826",
    "id": 355998488,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NTk5ODQ4OA==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-08T15:30:31Z",
    "updated_at": "2018-01-08T15:30:31Z",
    "author_association": "MEMBER",
    "body": "Tracing each opcode and everything along with it won't get any less resource intensive, since the node needs to assemble everything into one gigantic trace in memory, which is enormous.\r\n\r\nWhy do you need **everything**? If you write your own .js tracer, that has access to everything whilst running inside the node, so you can gather and export whatever you need without pulling all the useless data too that you don't need.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/355998488/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
