{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26292",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26292/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26292/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26292/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/26292",
  "id": 1473253925,
  "node_id": "I_kwDOAOvK985X0BIl",
  "number": 26292,
  "title": "`rlpHash` doesn't return expected hash",
  "user": {
    "login": "TmLev",
    "id": 22966523,
    "node_id": "MDQ6VXNlcjIyOTY2NTIz",
    "avatar_url": "https://avatars.githubusercontent.com/u/22966523?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/TmLev",
    "html_url": "https://github.com/TmLev",
    "followers_url": "https://api.github.com/users/TmLev/followers",
    "following_url": "https://api.github.com/users/TmLev/following{/other_user}",
    "gists_url": "https://api.github.com/users/TmLev/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/TmLev/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/TmLev/subscriptions",
    "organizations_url": "https://api.github.com/users/TmLev/orgs",
    "repos_url": "https://api.github.com/users/TmLev/repos",
    "events_url": "https://api.github.com/users/TmLev/events{/privacy}",
    "received_events_url": "https://api.github.com/users/TmLev/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2022-12-02T18:08:28Z",
  "updated_at": "2022-12-08T11:59:06Z",
  "closed_at": "2022-12-08T10:50:29Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### Expected behaviour\r\n\r\nI'm fetching transaction by its hash and comparing original hash with hash of the received transaction.\r\n\r\nHashes must be equal.\r\n\r\n#### Actual behaviour\r\n\r\nThey differ when interacting with [Meter](https://meter.io/):\r\n\r\n```log\r\n2022/12/02 18:59:16 BSC:\r\n2022/12/02 18:59:16 original tx hash:  0xb72a06e15ccf3af1283d71f66abff02cdc4c023f673203f2c319538d96bdf50c\r\n2022/12/02 18:59:16 tx hash from node: 0xb72a06e15ccf3af1283d71f66abff02cdc4c023f673203f2c319538d96bdf50c\r\n2022/12/02 18:59:17 Meter:\r\n2022/12/02 18:59:17 original tx hash:  0x37656fc5eb232510cb47b2db7b90fe0763d6ebbc2ef0578409a6aac3ae24dcf5\r\n2022/12/02 18:59:17 tx hash from node: 0x1476a74942ce0326f667955838bb3213530aad7b22fa801c816ca17c2300b84b\r\n```\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\nHere's the MRE: https://github.com/TmLev/go-ethereum-rlphash-repro\r\n\r\n<details>\r\n  <summary>Here's how to request transaction via `curl`</summary>\r\n  \r\n  ```shell\r\n  curl -H \"Content-Type: application/json\" -X POST \\\r\n      --data '{\"jsonrpc\":\"2.0\",\"method\":\"eth_getTransactionByHash\",\"params\":[\"0x37656fc5eb232510cb47b2db7b90fe0763d6ebbc2ef0578409a6aac3ae24dcf5\"],\"id\":0}' \\\r\n      https://rpc.meter.io\r\n  ```\r\n  ```log\r\n  {\r\n    \"jsonrpc\": \"2.0\",\r\n    \"result\": {\r\n      \"hash\": \"0x37656fc5eb232510cb47b2db7b90fe0763d6ebbc2ef0578409a6aac3ae24dcf5\",\r\n      \"nonce\": \"0xdc1e3978\",\r\n      \"blockHash\": \"0x01d68657a0a9c760756b86626ec02b03c5a03b60b001175e9124ae780a7ac201\",\r\n      \"blockNumber\": \"0x1d68657\",\r\n      \"transactionIndex\": \"0x0\",\r\n      \"from\": \"0x4021fc4306c61f56b354be72896c95d80c458fd6\",\r\n      \"to\": \"0x18232c46a19f803d2b29c73dd78d194245ab96d4\",\r\n      \"value\": \"0x0\",\r\n      \"gas\": \"0xd7a24\",\r\n      \"gasPrice\": \"0x1\",\r\n      \"input\": \"0x84c3e951000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000003e900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000005fa41671c48e3c951afc30816947126ccc8c162effffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000005fa41671c48e3c951afc30816947126ccc8c162e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000000000000000000000\",\r\n      \"r\": \"0x3e8f58ae2b604d94a488cb9c59353d58a95538055be1822ed6d433e4d4cf535b\",\r\n      \"s\": \"0x7ee8da896f27e9245cea6ac850626193f45500ea0d2004fe848348887feb2c4d\",\r\n      \"v\": \"0xc7\"\r\n    },\r\n    \"id\": 0\r\n  }\r\n  ```\r\n</details>\r\n\r\n#### Comment\r\n\r\nBoth BSC and Meter use `LegacyTx` for which `rlpHash(tx.inner)` is called when accessing `tx.Hash()`. The output differs between those chains.\r\n\r\nI suspect this may happen because of the Meter response, though I'm not sure which piece of the response leads to the observed difference.\r\n\r\n#### System information\r\n\r\nGeth version: -\r\nCL client & version: go-ethereum@v1.10.16\r\nOS & Version: MacOS X 12.4\r\n",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26292/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26292/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1342384197",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/26292#issuecomment-1342384197",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26292",
    "id": 1342384197,
    "node_id": "IC_kwDOAOvK985QAyhF",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-08T09:45:12Z",
    "updated_at": "2022-12-08T09:45:12Z",
    "author_association": "MEMBER",
    "body": "Is `0x37656fc5eb232510cb47b2db7b90fe0763d6ebbc2ef0578409a6aac3ae24dcf5 ` an ethereum transaction?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1342384197/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1342386637",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/26292#issuecomment-1342386637",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26292",
    "id": 1342386637,
    "node_id": "IC_kwDOAOvK985QAzHN",
    "user": {
      "login": "TmLev",
      "id": 22966523,
      "node_id": "MDQ6VXNlcjIyOTY2NTIz",
      "avatar_url": "https://avatars.githubusercontent.com/u/22966523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TmLev",
      "html_url": "https://github.com/TmLev",
      "followers_url": "https://api.github.com/users/TmLev/followers",
      "following_url": "https://api.github.com/users/TmLev/following{/other_user}",
      "gists_url": "https://api.github.com/users/TmLev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TmLev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TmLev/subscriptions",
      "organizations_url": "https://api.github.com/users/TmLev/orgs",
      "repos_url": "https://api.github.com/users/TmLev/repos",
      "events_url": "https://api.github.com/users/TmLev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TmLev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-08T09:46:07Z",
    "updated_at": "2022-12-08T09:46:07Z",
    "author_association": "NONE",
    "body": "I think so, yes\r\nhttps://scan.meter.io/tx/0x37656fc5eb232510cb47b2db7b90fe0763d6ebbc2ef0578409a6aac3ae24dcf5",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1342386637/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1342403726",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/26292#issuecomment-1342403726",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26292",
    "id": 1342403726,
    "node_id": "IC_kwDOAOvK985QA3SO",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-08T09:54:35Z",
    "updated_at": "2022-12-08T09:54:35Z",
    "author_association": "MEMBER",
    "body": "But it belongs to Meter fork chain? I can't find it on etherscan.\r\n\r\nWe have no idea what changes are introduced in the Meter fork chain. It might be possible that some extra fields are ignored by ethclient because they are not defined in ethereum.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1342403726/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1342408275",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/26292#issuecomment-1342408275",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26292",
    "id": 1342408275,
    "node_id": "IC_kwDOAOvK985QA4ZT",
    "user": {
      "login": "TmLev",
      "id": 22966523,
      "node_id": "MDQ6VXNlcjIyOTY2NTIz",
      "avatar_url": "https://avatars.githubusercontent.com/u/22966523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TmLev",
      "html_url": "https://github.com/TmLev",
      "followers_url": "https://api.github.com/users/TmLev/followers",
      "following_url": "https://api.github.com/users/TmLev/following{/other_user}",
      "gists_url": "https://api.github.com/users/TmLev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TmLev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TmLev/subscriptions",
      "organizations_url": "https://api.github.com/users/TmLev/orgs",
      "repos_url": "https://api.github.com/users/TmLev/repos",
      "events_url": "https://api.github.com/users/TmLev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TmLev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-08T09:57:41Z",
    "updated_at": "2022-12-08T09:58:00Z",
    "author_association": "NONE",
    "body": "Yes, the transaction is from Meter fork chain.\r\n\r\n> It might be possible that some extra fields are ignored by ethclient because they are not defined in ethereum.\r\n\r\nI see, thanks. So I should probably take it up to Meter developers?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1342408275/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1342416514",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/26292#issuecomment-1342416514",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26292",
    "id": 1342416514,
    "node_id": "IC_kwDOAOvK985QA6aC",
    "user": {
      "login": "TmLev",
      "id": 22966523,
      "node_id": "MDQ6VXNlcjIyOTY2NTIz",
      "avatar_url": "https://avatars.githubusercontent.com/u/22966523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TmLev",
      "html_url": "https://github.com/TmLev",
      "followers_url": "https://api.github.com/users/TmLev/followers",
      "following_url": "https://api.github.com/users/TmLev/following{/other_user}",
      "gists_url": "https://api.github.com/users/TmLev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TmLev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TmLev/subscriptions",
      "organizations_url": "https://api.github.com/users/TmLev/orgs",
      "repos_url": "https://api.github.com/users/TmLev/repos",
      "events_url": "https://api.github.com/users/TmLev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TmLev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-08T10:02:30Z",
    "updated_at": "2022-12-08T10:02:30Z",
    "author_association": "NONE",
    "body": "I was also curious why `.Hash()` computes hash from scratch when it's present in the response from blockchain node?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1342416514/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1342520505",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/26292#issuecomment-1342520505",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26292",
    "id": 1342520505,
    "node_id": "IC_kwDOAOvK985QBTy5",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-08T10:50:28Z",
    "updated_at": "2022-12-08T10:50:28Z",
    "author_association": "MEMBER",
    "body": "We don't support non-ethereum chains",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1342520505/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1342619406",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/26292#issuecomment-1342619406",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/26292",
    "id": 1342619406,
    "node_id": "IC_kwDOAOvK985QBr8O",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-08T11:59:06Z",
    "updated_at": "2022-12-08T11:59:06Z",
    "author_association": "MEMBER",
    "body": "> I see, thanks. So I should probably take it up to Meter developers?\r\n\r\nYes please.\r\n\r\n> I was also curious why .Hash() computes hash from scratch when it's present in the response from blockchain node?\r\n\r\nDon't trust, verify it?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1342619406/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
