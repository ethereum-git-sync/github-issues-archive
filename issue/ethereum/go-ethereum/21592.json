{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21592",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21592/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21592/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21592/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/21592",
  "id": 705836131,
  "node_id": "MDU6SXNzdWU3MDU4MzYxMzE=",
  "number": 21592,
  "title": "Clef does not derive ledger accounts consistently; No option to control HD paths",
  "user": {
    "login": "KPrasch",
    "id": 679404,
    "node_id": "MDQ6VXNlcjY3OTQwNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/679404?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/KPrasch",
    "html_url": "https://github.com/KPrasch",
    "followers_url": "https://api.github.com/users/KPrasch/followers",
    "following_url": "https://api.github.com/users/KPrasch/following{/other_user}",
    "gists_url": "https://api.github.com/users/KPrasch/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/KPrasch/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/KPrasch/subscriptions",
    "organizations_url": "https://api.github.com/users/KPrasch/orgs",
    "repos_url": "https://api.github.com/users/KPrasch/repos",
    "events_url": "https://api.github.com/users/KPrasch/events{/privacy}",
    "received_events_url": "https://api.github.com/users/KPrasch/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1132689577,
      "node_id": "MDU6TGFiZWwxMTMyNjg5NTc3",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/status:triage",
      "name": "status:triage",
      "color": "6be514",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2020-09-21T18:53:16Z",
  "updated_at": "2020-10-15T08:27:59Z",
  "closed_at": "2020-10-15T08:27:59Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: 1.9.15-stable+\r\nOS & Version: Ubuntu 20.04\r\n\r\n#### Expected behaviour\r\n\r\n* A way to control which HD paths are derived from clef with a CLI option or command.\r\n* Clef correctly and derives accounts from Ledger hardware wallets everytime it is plugged in an unlocked.\r\n\r\n#### Actual behaviour\r\n\r\n* There is no way to control which key paths are derived from clef. (This is problematic since ledger now has *Ledger Live* and *Legacy* differences.)\r\n* Each time the Ledger Nano S is plugged into the USB port and unlocked, either the warning `account derivation failed  error=\"reply lacks public key entry\"` or \"legacy\" key paths are derived.\r\n\r\n#### Steps to reproduce the behavior\r\n\r\n1. Start clef `clef`\r\n2. Attach and unlock a ledger nano s several times\r\n3. View warnings / derived addresses in clef's console\r\n\r\n\r\n#### Notes\r\n\r\nThanks for all your hard work on clef - Let me know how I can best support this Issue or if there is any additional information I can provide. :-)",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21592/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21592/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/696568510",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21592#issuecomment-696568510",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21592",
    "id": 696568510,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NjU2ODUxMA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-22T07:59:11Z",
    "updated_at": "2020-09-22T07:59:11Z",
    "author_association": "MEMBER",
    "body": "Well, it's true that Clef does not derive accounts consistently, the reason being that ledger itself is inconsistent. Some more context is here: https://github.com/ethereum/go-ethereum/pull/21517 , but the TLDR: is that ledger started using one path, and then switched to another -- which is kind of crazy if you're a hardware wallet. \r\n\r\nSo what geth does is that it checks both, and \"latches on\" to those addresses which appears to be used -- have a nonzero nonce/balance. \r\n\r\nClef, however, is meant to be usable fully offline, and is not backed by a chain. And it's extremely bad UX to suddenly _not_ show accounts that were previously present, just because we also changed path. So the middle ground that Clef went with was to derive on both paths. \r\n\r\nYes, we could add another cli option. But that requires the user to be sufficiently knowledgable about derivation paths to know the problem, and such users are very rare, and can probably use the UI interface to tell clef to derive whatever paths they desire. \r\n\r\nBut if you have a good suggestion for a command line switch, please specify it, and maybe we can fix it. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/696568510/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/696867697",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21592#issuecomment-696867697",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21592",
    "id": 696867697,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5Njg2NzY5Nw==",
    "user": {
      "login": "KPrasch",
      "id": 679404,
      "node_id": "MDQ6VXNlcjY3OTQwNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/679404?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/KPrasch",
      "html_url": "https://github.com/KPrasch",
      "followers_url": "https://api.github.com/users/KPrasch/followers",
      "following_url": "https://api.github.com/users/KPrasch/following{/other_user}",
      "gists_url": "https://api.github.com/users/KPrasch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/KPrasch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KPrasch/subscriptions",
      "organizations_url": "https://api.github.com/users/KPrasch/orgs",
      "repos_url": "https://api.github.com/users/KPrasch/repos",
      "events_url": "https://api.github.com/users/KPrasch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/KPrasch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-22T17:30:49Z",
    "updated_at": "2020-09-22T17:30:49Z",
    "author_association": "NONE",
    "body": "@holiman - Thanks for your answer - it is very helpful for troubleshooting.  Let me think it over a bit.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/696867697/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/708989233",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21592#issuecomment-708989233",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21592",
    "id": 708989233,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwODk4OTIzMw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-15T08:27:59Z",
    "updated_at": "2020-10-15T08:27:59Z",
    "author_association": "MEMBER",
    "body": "Closing this, I'm open to suggestions as to how to improve the UX. \r\nPlease file a separate ticket about the error logs, it's not something I've noticed myself. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/708989233/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
