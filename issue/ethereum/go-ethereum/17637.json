{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17637",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17637/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17637/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17637/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/17637",
  "id": 358953778,
  "node_id": "MDU6SXNzdWUzNTg5NTM3Nzg=",
  "number": 17637,
  "title": "Clef: cliui mixes extraneous and approval-specific Data",
  "user": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1053006445,
      "node_id": "MDU6TGFiZWwxMDUzMDA2NDQ1",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/area:clef",
      "name": "area:clef",
      "color": "1d76db",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2018-09-11T09:06:42Z",
  "updated_at": "2021-08-15T04:11:54Z",
  "closed_at": "2018-09-25T20:03:42Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Ref: NCC-EF-Clef-006 \r\n\r\nWhen Clef receives a request through its exposed API, metadata is displayed to the user in\r\ncharge of handling it. This metadata includes a variety of fields unrelated to what is being\r\nsigned like IP address, user-agent, origin, etc. There are 6 calls to showMetadata() within\r\nsigner/core/cliui.go that drive this functionality. Some of these fields can be trivially\r\ntampered with and might provide a false understanding as users could rely too heavily on\r\nthem instead of the important fields.\r\nThe following ‘malicious’ request (with the redacted JSON taken from Go code example com-\r\nments) will be accepted by Clef.\r\n```\r\ncurl-i http://localhost:8550/ \\\r\n-H \"Content-Type: application/json\"\\ \r\n-X POST --data '{...}' \\\r\n-A \"indicates INVALID CHECKSUM IS EXPECTED\" \\\r\n-H \"Origin: NCC Group requires IMMEDIATE APPROVAL per direction of J Smith\"\r\n```\r\n![cliui](https://user-images.githubusercontent.com/142290/45349751-6f3ee880-b5b2-11e8-9663-e7d5fc3598db.png)\r\n\r\nAs currently presented, the metadata provides little benefit to legitimate requests but may\r\nfacilitate illegitimate requests. A naive user may consider the extraneous request data as\r\nsuperseding the true warning above and mistakenly approve this transaction.\r\n\r\n## Recommendation\r\n\r\nDo not present request metadata alongside approval-specific data without clear delineation\r\nand warnings. Either clearly label the categories presented and warn that request data\r\ncannot be relied upon, or simply remove all request data.\r\n\r\n----\r\nTodo: look into if we can make this even more clear than it is currently. ",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17637/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17637/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/420562522",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17637#issuecomment-420562522",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17637",
    "id": 420562522,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDU2MjUyMg==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-12T08:39:10Z",
    "updated_at": "2018-09-12T08:39:10Z",
    "author_association": "MEMBER",
    "body": "I made a slight change, now it looks like this:\r\n```\r\n--------- Transaction request-------------\r\nto:    0x07a565b7ed7d7a678680a4c162885bedbb695fe0\r\n\r\nWARNING: Invalid checksum on to-address!\r\n\r\nfrom:     0x82A2A876D39022B3019932D30Cd9c97ad5616813 [chksum ok]\r\nvalue:    16 wei\r\ngas:      0x333 (819)\r\ngasprice: 291 wei\r\nnonce:    0x0 (0)\r\ndata:     0x4401a6e40000000000000000000000000000000000000000000000000000000000000012\r\n\r\nTransaction validation:\r\n  * WARNING : Invalid checksum on to-address\r\n  * Info : safeSend(address: 0x0000000000000000000000000000000000000012)\r\n\r\n\r\nRequest context:\r\n\t127.0.0.1:47808 -> HTTP/1.1 -> localhost:8551\r\n\r\nAdditional HTTP header data, provided by the external caller:\r\n\tUser-Agent: indicates INVALID CHECKSUM IS EXPECTED\r\n\tOrigin: NCC Group requires IMMEDIATE APPROVAL per direction of J Smith\r\n-------------------------------------------\r\nApprove? [y/N]:\r\n\r\n```\r\nI think that should be sufficient. We cannot remove all request data, in 99.9% of the cases, it's highly valuable information which can protect against drive-by-download types of attacks, where a webpage spuriously sends a request to the signer. By showing origin, the user would see what webpage is doing this. By showing user-agent, the user could see if it's his own browser or something else doing the requests -- assuming an attacker does not know what browser the user is using/ \r\n\r\nSo overall, I think it's better to have it than to remove it.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/420562522/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/898992646",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17637#issuecomment-898992646",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17637",
    "id": 898992646,
    "node_id": "IC_kwDOAOvK9841lYoG",
    "user": {
      "login": "matias904",
      "id": 59459038,
      "node_id": "MDQ6VXNlcjU5NDU5MDM4",
      "avatar_url": "https://avatars.githubusercontent.com/u/59459038?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matias904",
      "html_url": "https://github.com/matias904",
      "followers_url": "https://api.github.com/users/matias904/followers",
      "following_url": "https://api.github.com/users/matias904/following{/other_user}",
      "gists_url": "https://api.github.com/users/matias904/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matias904/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matias904/subscriptions",
      "organizations_url": "https://api.github.com/users/matias904/orgs",
      "repos_url": "https://api.github.com/users/matias904/repos",
      "events_url": "https://api.github.com/users/matias904/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matias904/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-15T04:11:54Z",
    "updated_at": "2021-08-15T04:11:54Z",
    "author_association": "NONE",
    "body": "Hohono",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/898992646/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
