{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16123",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16123/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16123/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16123/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/16123",
  "id": 298096157,
  "node_id": "MDU6SXNzdWUyOTgwOTYxNTc=",
  "number": 16123,
  "title": "Missing trie node errors when calling contract method with past block number",
  "user": {
    "login": "vladb",
    "id": 266635,
    "node_id": "MDQ6VXNlcjI2NjYzNQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/266635?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vladb",
    "html_url": "https://github.com/vladb",
    "followers_url": "https://api.github.com/users/vladb/followers",
    "following_url": "https://api.github.com/users/vladb/following{/other_user}",
    "gists_url": "https://api.github.com/users/vladb/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vladb/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vladb/subscriptions",
    "organizations_url": "https://api.github.com/users/vladb/orgs",
    "repos_url": "https://api.github.com/users/vladb/repos",
    "events_url": "https://api.github.com/users/vladb/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vladb/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2018-02-18T16:09:21Z",
  "updated_at": "2021-10-20T11:59:25Z",
  "closed_at": "2018-02-18T17:49:51Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Since updating to 1.8.0, calling contract methods at past block numbers results in errors such as `missing trie node f424a914a3fabb903dbc7c1d78db44508db8e31315d4009e377c4193757b9c9d (path )`. Calling the same method at the latest block works as expected.\r\n\r\nI have tested with both `--gcmode=archive` and `--gcmode=full` and got the same result. In both cases a new (fast) sync was done.\r\n\r\nCalls were made via web3 1.0.0.beta.27 over websockets.\r\n\r\n#### System information\r\n\r\nGeth version: 1.8.0-stable\r\nOS & Version: Ubuntu 16.04\r\nCommit hash: 5f54075760748ae7f249bf735565924ea885c477",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16123/reactions",
    "total_count": 6,
    "+1": 6,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16123/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/366533523",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16123#issuecomment-366533523",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16123",
    "id": 366533523,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NjUzMzUyMw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-18T17:49:51Z",
    "updated_at": "2018-02-18T17:49:51Z",
    "author_association": "MEMBER",
    "body": "The `--gcmode` doesn't matter here. The issue is that when you fast-sync, you don't have all historic states. After a fast-sync is complete, you will start to do an \"archiving\" sync, block by block sync, _from that point on_ . \r\n\r\nSo, your old setup had an earlier \"pivot point\" than your new setup, and thus had the full state for everything after that pivot point. Your new setup does not have that. It's an effect of doing a new fast-sync, not because you upgrade to 1.8.0. \r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/366533523/reactions",
      "total_count": 6,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 1,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/381753033",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16123#issuecomment-381753033",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16123",
    "id": 381753033,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MTc1MzAzMw==",
    "user": {
      "login": "Deams51",
      "id": 6062062,
      "node_id": "MDQ6VXNlcjYwNjIwNjI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6062062?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Deams51",
      "html_url": "https://github.com/Deams51",
      "followers_url": "https://api.github.com/users/Deams51/followers",
      "following_url": "https://api.github.com/users/Deams51/following{/other_user}",
      "gists_url": "https://api.github.com/users/Deams51/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Deams51/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Deams51/subscriptions",
      "organizations_url": "https://api.github.com/users/Deams51/orgs",
      "repos_url": "https://api.github.com/users/Deams51/repos",
      "events_url": "https://api.github.com/users/Deams51/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Deams51/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-16T21:18:28Z",
    "updated_at": "2018-04-16T21:27:29Z",
    "author_association": "NONE",
    "body": "Same as https://github.com/ethereum/go-ethereum/issues/16471\r\n@holiman Does it mean that to request contract data on past blocks on a fresh node we are forced to run a full sync (--gcmode=archive --syncmode=full) instead of a fast sync (--gcmode=archive --syncmode=fast) ? ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/381753033/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/393794467",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16123#issuecomment-393794467",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16123",
    "id": 393794467,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5Mzc5NDQ2Nw==",
    "user": {
      "login": "malt93",
      "id": 39435398,
      "node_id": "MDQ6VXNlcjM5NDM1Mzk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/39435398?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/malt93",
      "html_url": "https://github.com/malt93",
      "followers_url": "https://api.github.com/users/malt93/followers",
      "following_url": "https://api.github.com/users/malt93/following{/other_user}",
      "gists_url": "https://api.github.com/users/malt93/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/malt93/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/malt93/subscriptions",
      "organizations_url": "https://api.github.com/users/malt93/orgs",
      "repos_url": "https://api.github.com/users/malt93/repos",
      "events_url": "https://api.github.com/users/malt93/events{/privacy}",
      "received_events_url": "https://api.github.com/users/malt93/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-01T07:42:20Z",
    "updated_at": "2018-06-01T07:42:20Z",
    "author_association": "NONE",
    "body": "@Deams51  I think the answer of your question is `yes`.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/393794467/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/393798571",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16123#issuecomment-393798571",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16123",
    "id": 393798571,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5Mzc5ODU3MQ==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-01T07:56:22Z",
    "updated_at": "2018-06-01T07:56:22Z",
    "author_association": "MEMBER",
    "body": "Not quite, but almost. Say you want to do a trace on block `B`. Now there are a couple of cases:\r\n\r\n1. You did a fast-sync, pivot block `P` where `P <= B`.\r\n2. You did a fast-sync, pivot block `P` where `P > B`. \r\n3. You did a full-sync, with pruning\r\n4. You did a full-sync, without pruning (`--gcmode=archive`)\r\n\r\nHere's what happens:\r\n\r\n1. Geth will regenerate the desired state by replaying blocks from the closest point in time before `B` where it has full state. This defaults to [`128`](https://github.com/ethereum/go-ethereum/blob/master/eth/api_tracer.go#L52) blocks max, but you can specify more in the actual call `... \"reexec\":1000 .. }` to the tracer. \r\n2. Sorry, can't be done without replaying from genesis.   \r\n3. Same as 1)\r\n4. Does not need to replay anything, can immediately load up the state and serve the request. \r\n\r\nThere is one other option available to you, which may or may not suit your needs. That is to use [Evmlab]( https://github.com/holiman/evmlab). \r\n```\r\ndocker pull holiman/evmlab && docker run -it holiman/evmlab\r\n```\r\nThere you can use the reproducer. The reproducer will incrementally fetch data from infura until it has all the information required to create the trace locally on an evm which is bundled with the image. It will create a custom genesis containing the state that the transaction touches (balances, code, nonce etc). \r\n\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/393798571/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/393800808",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16123#issuecomment-393800808",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16123",
    "id": 393800808,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MzgwMDgwOA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-01T08:03:19Z",
    "updated_at": "2018-06-01T08:03:19Z",
    "author_association": "MEMBER",
    "body": "Added this to the docs: https://github.com/ethereum/go-ethereum/wiki/Tracing:-Introduction#pruning ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/393800808/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/947594604",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16123#issuecomment-947594604",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16123",
    "id": 947594604,
    "node_id": "IC_kwDOAOvK9844eyVs",
    "user": {
      "login": "nikhilupadhyay1709",
      "id": 80529715,
      "node_id": "MDQ6VXNlcjgwNTI5NzE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/80529715?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nikhilupadhyay1709",
      "html_url": "https://github.com/nikhilupadhyay1709",
      "followers_url": "https://api.github.com/users/nikhilupadhyay1709/followers",
      "following_url": "https://api.github.com/users/nikhilupadhyay1709/following{/other_user}",
      "gists_url": "https://api.github.com/users/nikhilupadhyay1709/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nikhilupadhyay1709/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nikhilupadhyay1709/subscriptions",
      "organizations_url": "https://api.github.com/users/nikhilupadhyay1709/orgs",
      "repos_url": "https://api.github.com/users/nikhilupadhyay1709/repos",
      "events_url": "https://api.github.com/users/nikhilupadhyay1709/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nikhilupadhyay1709/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-20T11:59:02Z",
    "updated_at": "2021-10-20T11:59:25Z",
    "author_association": "NONE",
    "body": "> The `--gcmode` doesn't matter here. The issue is that when you fast-sync, you don't have all historic states. After a fast-sync is complete, you will start to do an \"archiving\" sync, block by block sync, _from that point on_ .\r\n> \r\n> So, your old setup had an earlier \"pivot point\" than your new setup, and thus had the full state for everything after that pivot point. Your new setup does not have that. It's an effect of doing a new fast-sync, not because you upgrade to 1.8.0.\r\n\r\nhey!  i got the same error while deploying contract using remix for my private network \r\nhow  i can resolve this, **here is  the error**  \r\n\r\ncreation of owned errored: [ethjs-query] while formatting outputs from RPC '{\"value\":{\"code\":-32603,\"data\":{\"code\":-32000,\"message\":\"missing trie node 0998d3e6528cb83771b71fb0469e46e319c77cb1070d19ba2fbad489308c2e0d (path )\"}}}'\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/947594604/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
