{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25333",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25333/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25333/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25333/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/25333",
  "id": 1309067258,
  "node_id": "I_kwDOAOvK985OBsf6",
  "number": 25333,
  "title": "Why is fillTransactions() of worker.go executed TWICE every block?",
  "user": {
    "login": "joonha97",
    "id": 26410791,
    "node_id": "MDQ6VXNlcjI2NDEwNzkx",
    "avatar_url": "https://avatars.githubusercontent.com/u/26410791?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/joonha97",
    "html_url": "https://github.com/joonha97",
    "followers_url": "https://api.github.com/users/joonha97/followers",
    "following_url": "https://api.github.com/users/joonha97/following{/other_user}",
    "gists_url": "https://api.github.com/users/joonha97/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/joonha97/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/joonha97/subscriptions",
    "organizations_url": "https://api.github.com/users/joonha97/orgs",
    "repos_url": "https://api.github.com/users/joonha97/repos",
    "events_url": "https://api.github.com/users/joonha97/events{/privacy}",
    "received_events_url": "https://api.github.com/users/joonha97/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 268304226,
      "node_id": "MDU6TGFiZWwyNjgzMDQyMjY=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:docs",
      "name": "type:docs",
      "color": "fef2c0",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-07-19T06:54:51Z",
  "updated_at": "2022-07-21T01:21:45Z",
  "closed_at": "2022-07-21T01:21:45Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I tried to understand why fillTransactions() function of miner>worker.go is executed TWICE every block, but I have no idea. \r\nAt first, I thought it was for prefetching, but even when I inactivated prefetching, fillTransactions() is run twice.\r\nAlso, I suspected the first run for processing local txs, and the second for the remote txs, but I think that is not the reason too.\r\n\r\nCan anyone be so kind and explain why?\r\nThank you!",
  "closed_by": {
    "login": "rjl493456442",
    "id": 5959481,
    "node_id": "MDQ6VXNlcjU5NTk0ODE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rjl493456442",
    "html_url": "https://github.com/rjl493456442",
    "followers_url": "https://api.github.com/users/rjl493456442/followers",
    "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
    "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
    "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
    "repos_url": "https://api.github.com/users/rjl493456442/repos",
    "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25333/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25333/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1189454486",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25333#issuecomment-1189454486",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25333",
    "id": 1189454486,
    "node_id": "IC_kwDOAOvK985G5aKW",
    "user": {
      "login": "victorkingi",
      "id": 65971651,
      "node_id": "MDQ6VXNlcjY1OTcxNjUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/65971651?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/victorkingi",
      "html_url": "https://github.com/victorkingi",
      "followers_url": "https://api.github.com/users/victorkingi/followers",
      "following_url": "https://api.github.com/users/victorkingi/following{/other_user}",
      "gists_url": "https://api.github.com/users/victorkingi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/victorkingi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/victorkingi/subscriptions",
      "organizations_url": "https://api.github.com/users/victorkingi/orgs",
      "repos_url": "https://api.github.com/users/victorkingi/repos",
      "events_url": "https://api.github.com/users/victorkingi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/victorkingi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-19T19:08:53Z",
    "updated_at": "2022-07-19T19:08:53Z",
    "author_association": "NONE",
    "body": "From my understanding, we have 2 functions in `worker.go` that calls `fillTransactions()`, that is `commitWork` and `generateWork`.\r\n\r\n`generateWork` requires some settings to assemble a block, making it like a 'final call', hence, the `FinalizeAndAssemble` as the return value. `commitWork` however doesn't require these settings, it's more of predicting how the next blocks will look like. This makes block production by miners more efficient as if it misses the reward on block i.e. `15,000,000` it can quickly start working on the next block.\r\n\r\nAlthough i might be totally waaay off lol! better wait for a valid response from the devs.\r\n\r\nCheers",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1189454486/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1190930968",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25333#issuecomment-1190930968",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25333",
    "id": 1190930968,
    "node_id": "IC_kwDOAOvK985G_CoY",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-21T01:21:45Z",
    "updated_at": "2022-07-21T01:21:45Z",
    "author_association": "MEMBER",
    "body": "@joonha97 Geth will re-create mining block every 3 seconds by default. For reason for this mechanism is during this period, a few transactions with higher fee can arrive and re-creation can maximize the profit for miners. I think it's the phenomenon you mentioned.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1190930968/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
