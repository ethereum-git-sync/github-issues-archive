{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16079",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16079/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16079/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16079/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/16079",
  "id": 296669289,
  "node_id": "MDU6SXNzdWUyOTY2NjkyODk=",
  "number": 16079,
  "title": "Accept error: accept tcp 127.0.0.1:8545: too many open files; retrying in 1s",
  "user": {
    "login": "ghost",
    "id": 10137,
    "node_id": "MDQ6VXNlcjEwMTM3",
    "avatar_url": "https://avatars.githubusercontent.com/u/10137?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ghost",
    "html_url": "https://github.com/ghost",
    "followers_url": "https://api.github.com/users/ghost/followers",
    "following_url": "https://api.github.com/users/ghost/following{/other_user}",
    "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
    "organizations_url": "https://api.github.com/users/ghost/orgs",
    "repos_url": "https://api.github.com/users/ghost/repos",
    "events_url": "https://api.github.com/users/ghost/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ghost/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2018-02-13T09:35:00Z",
  "updated_at": "2018-04-03T14:10:04Z",
  "closed_at": "2018-04-03T13:34:26Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I want to re-open https://github.com/ethereum/go-ethereum/issues/1460, we're running Geth 1.7.3 with the following options:\r\n\r\n    geth --rpcport=9545 --datadir=/var/geth --rpcaddr=127.0.0.1 --rpc --rpcapi=admin,debug,eth,net,web3\r\n\r\nand keep hitting the following error:\r\n\r\n    http: Accept error: accept tcp 127.0.0.1:9545: accept4: too many open files; retrying in 1s\r\n\r\nour unit file looks like this:\r\n\r\n    [Unit]\r\n    Description=geth\r\n    Wants=network.target\r\n    After=network.target\r\n\r\n    [Service]\r\n    ExecStart=/opt/geth/1.7.3-4bb3c89d/bin/geth --rpcport=9545 --datadir=/var/geth --rpcaddr=127.0.0.1 --rpc --rpcapi=admin,debug,eth,net,web3\r\n    ExecReload=/bin/kill -HUP $MAINPID\r\n    KillSignal=TERM\r\n    Restart=on-failure\r\n    RestartSec=15s\r\n    User=geth\r\n    LimitNOFILE=65536\r\n\r\n    [Install]\r\n    WantedBy=multi-user.target\r\n\r\nNote `LimitNOFILE=65536`.\r\n\r\nHowever, when I run `lsof` on the process I see nowhere near 65k open files:\r\n\r\n    lsof -p 31006 | wc -l\r\n    2059\r\n\r\nHere is the output from `/proc/31006/limits`:\r\n\r\n    cat /proc/31006/limits\r\n    Limit                     Soft Limit           Hard Limit           Units\r\n    Max cpu time              unlimited            unlimited            seconds\r\n    Max file size             unlimited            unlimited            bytes\r\n    Max data size             unlimited            unlimited            bytes\r\n    Max stack size            8388608              unlimited            bytes\r\n    Max core file size        0                    unlimited            bytes\r\n    Max resident set          unlimited            unlimited            bytes\r\n    Max processes             29849                29849                processes\r\n    Max open files            2048                 65536                files\r\n    Max locked memory         65536                65536                bytes\r\n    Max address space         unlimited            unlimited            bytes\r\n    Max file locks            unlimited            unlimited            locks\r\n    Max pending signals       29849                29849                signals\r\n    Max msgqueue size         819200               819200               bytes\r\n    Max nice priority         0                    0\r\n    Max realtime priority     0                    0\r\n    Max realtime timeout      unlimited            unlimited            us\r\n\r\nHow can I increase the soft limit/is it possible?",
  "closed_by": {
    "login": "fjl",
    "id": 6915,
    "node_id": "MDQ6VXNlcjY5MTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fjl",
    "html_url": "https://github.com/fjl",
    "followers_url": "https://api.github.com/users/fjl/followers",
    "following_url": "https://api.github.com/users/fjl/following{/other_user}",
    "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
    "organizations_url": "https://api.github.com/users/fjl/orgs",
    "repos_url": "https://api.github.com/users/fjl/repos",
    "events_url": "https://api.github.com/users/fjl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fjl/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16079/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16079/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/365362425",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16079#issuecomment-365362425",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16079",
    "id": 365362425,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NTM2MjQyNQ==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-13T18:40:04Z",
    "updated_at": "2018-02-13T18:40:04Z",
    "author_association": "MEMBER",
    "body": "Geth v1.7.3 hard limited the number of open file descriptors to 2K, even if you specified more on startup. This was fixed in v1.8.0 to not decrease it https://github.com/ethereum/go-ethereum/pull/16009. \r\n\r\nThat being said, if you are hitting this error, it usually means you are wasting TCP connections on single shot http requests. You might want to try to check your client and ensure it reuses the connections instead of making a new one for each request.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/365362425/reactions",
      "total_count": 4,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/378263384",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/16079#issuecomment-378263384",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16079",
    "id": 378263384,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3ODI2MzM4NA==",
    "user": {
      "login": "chfast",
      "id": 573380,
      "node_id": "MDQ6VXNlcjU3MzM4MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/573380?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chfast",
      "html_url": "https://github.com/chfast",
      "followers_url": "https://api.github.com/users/chfast/followers",
      "following_url": "https://api.github.com/users/chfast/following{/other_user}",
      "gists_url": "https://api.github.com/users/chfast/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chfast/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chfast/subscriptions",
      "organizations_url": "https://api.github.com/users/chfast/orgs",
      "repos_url": "https://api.github.com/users/chfast/repos",
      "events_url": "https://api.github.com/users/chfast/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chfast/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-03T14:10:04Z",
    "updated_at": "2018-04-03T14:10:04Z",
    "author_association": "MEMBER",
    "body": "I confirm the fix is working.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/378263384/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
