{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25228",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25228/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25228/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25228/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/25228",
  "id": 1292103593,
  "node_id": "I_kwDOAOvK985NA--p",
  "number": 25228,
  "title": "geth spending its time mostly on `futex_wait_queue`, no iops/cpu bottleneck",
  "user": {
    "login": "ycyraum",
    "id": 107963634,
    "node_id": "U_kgDOBm9k8g",
    "avatar_url": "https://avatars.githubusercontent.com/u/107963634?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ycyraum",
    "html_url": "https://github.com/ycyraum",
    "followers_url": "https://api.github.com/users/ycyraum/followers",
    "following_url": "https://api.github.com/users/ycyraum/following{/other_user}",
    "gists_url": "https://api.github.com/users/ycyraum/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ycyraum/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ycyraum/subscriptions",
    "organizations_url": "https://api.github.com/users/ycyraum/orgs",
    "repos_url": "https://api.github.com/users/ycyraum/repos",
    "events_url": "https://api.github.com/users/ycyraum/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ycyraum/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 268304226,
      "node_id": "MDU6TGFiZWwyNjgzMDQyMjY=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:docs",
      "name": "type:docs",
      "color": "fef2c0",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-07-02T17:35:45Z",
  "updated_at": "2022-07-07T08:55:19Z",
  "closed_at": "2022-07-07T08:55:19Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "It is often assumed that `geth` is iops bound and the answer to the never-ending `State heal in progress` is to get a better disk. However, is this really the case?\r\n\r\nThe specs (truncated):\r\n\r\n```\r\ngolem% sudo lshw -short\r\nH/W path           Device        Class          Description\r\n===========================================================\r\n                                 system         MS-7D25 (Default string)\r\n/0                               bus            PRO Z690-A (MS-7D25)\r\n/0/3a/1                          memory         32GiB DIMM Synchronous 4800 MHz (0.2 ns)\r\n/0/3a/3                          memory         32GiB DIMM Synchronous 4800 MHz (0.2 ns)\r\n/0/50                            processor      12th Gen Intel(R) Core(TM) i9-12900K\r\n/0/100/1a/0        /dev/nvme0    storage        KINGSTON SNVS1000G\r\n/0/100/1a/0/1      /dev/nvme0n1  volume         931GiB EXT4 volume\r\n```\r\n\r\nThe `KINGSTON SNVS1000G` is a NVMe 3.0 disk and `randrw` gives `read: IOPS=33.8k` `write: IOPS=11.3k` (ext4 fs):\r\n\r\n```\r\ngolem% sudo fio --ioengine=io_uring --direct=1 --buffered=0 --sync=1 --sync=0 --verify=0 --norandommap=1 --randrepeat=0 --iodepth=64 --gtod_reduce=1 --readwrite=randrw --size=4G --bs=4k --rwmixread=75 --name=randrw\r\nrandrw: (g=0): rw=randrw, bs=(R) 4096B-4096B, (W) 4096B-4096B, (T) 4096B-4096B, ioengine=io_uring, iodepth=64\r\nfio-3.30\r\nStarting 1 process\r\nJobs: 1 (f=1): [m(1)][100.0%][r=183MiB/s,w=61.6MiB/s][r=46.7k,w=15.8k IOPS][eta 00m:00s]\r\nrandrw: (groupid=0, jobs=1): err= 0: pid=12853: Sat Jul  2 19:21:39 2022\r\n  read: IOPS=33.8k, BW=132MiB/s (138MB/s)(3071MiB/23267msec)\r\n   bw (  KiB/s): min=22512, max=190216, per=99.72%, avg=134770.78, stdev=70914.62, samples=46\r\n   iops        : min= 5628, max=47554, avg=33692.70, stdev=17728.66, samples=46\r\n  write: IOPS=11.3k, BW=44.1MiB/s (46.2MB/s)(1025MiB/23267msec); 0 zone resets\r\n   bw (  KiB/s): min= 7256, max=64392, per=99.72%, avg=44990.61, stdev=23786.75, samples=46\r\n   iops        : min= 1814, max=16100, avg=11247.65, stdev=5946.69, samples=46\r\n  cpu          : usr=5.14%, sys=29.79%, ctx=72482, majf=0, minf=6\r\n  IO depths    : 1=0.1%, 2=0.1%, 4=0.1%, 8=0.1%, 16=0.1%, 32=0.1%, >=64=100.0%\r\n     submit    : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.0%, >=64=0.0%\r\n     complete  : 0=0.0%, 4=100.0%, 8=0.0%, 16=0.0%, 32=0.0%, 64=0.1%, >=64=0.0%\r\n     issued rwts: total=786151,262425,0,0 short=0,0,0,0 dropped=0,0,0,0\r\n     latency   : target=0, window=0, percentile=100.00%, depth=64\r\n\r\nRun status group 0 (all jobs):\r\n   READ: bw=132MiB/s (138MB/s), 132MiB/s-132MiB/s (138MB/s-138MB/s), io=3071MiB (3220MB), run=23267-23267msec\r\n  WRITE: bw=44.1MiB/s (46.2MB/s), 44.1MiB/s-44.1MiB/s (46.2MB/s-46.2MB/s), io=1025MiB (1075MB), run=23267-23267msec\r\n\r\nDisk stats (read/write):\r\n  nvme0n1: ios=780515/260609, merge=0/4, ticks=997347/412299, in_queue=1409650, util=99.70%\r\n```\r\n\r\nImportantly, `dstat` running during the benchmark gives even higher but similar numbers:\r\n\r\n```\r\ngolem% sudo dstat -pcmrdny\r\n---procs--- --total-cpu-usage-- ------memory-usage----- --io/total- -dsk/total- -net/total- ---system--\r\nrun blk new|usr sys idl wai stl| used  free  buff  cach| read  writ| read  writ| recv  send| int   csw\r\n  0   0 1.4|  1   0  99   0   0| 443M 21.8G  760M 39.0G|1593   182 |  12M 2514k|   0     0 |3907  6307\r\n  0   0   0|  0   2  98   0   0| 444M 21.8G  760M 39.0G|47.1k 15.6k| 184M   61M| 456B 1148B|  72k   15k\r\n  0   0   0|  0   2  98   0   0| 446M 21.8G  760M 39.0G|46.9k 15.6k| 183M   61M| 132B  970B|  72k   12k\r\n1.0   0   0|  0   2  98   0   0| 447M 21.8G  760M 39.0G|47.0k 15.8k| 184M   62M| 132B  734B|  73k   13k\r\n  0   0   0|  0   2  98   0   0| 446M 21.8G  760M 39.0G|47.2k 15.6k| 184M   61M| 306B  652B|  73k   13k\r\n  0   0   0|  0   2  98   0   0| 444M 21.8G  760M 39.0G|47.0k 15.6k| 184M   61M| 132B  644B|  72k   13k\r\n  0   0   0|  0   2  98   0   0| 446M 21.8G  760M 39.0G|47.0k 15.5k| 184M   60M| 132B  644B|  71k   13k\r\n1.0   0   0|  0   1  98   0   0| 447M 21.8G  760M 39.0G|47.0k 15.7k| 184M   61M| 306B  644B|  71k   13k\r\n  0   0   0|  0   2  98   0   0| 444M 21.8G  760M 39.0G|47.2k 15.7k| 184M   61M| 132B  652B|  71k   13k\r\n  0   0   0|  0   2  98   0   0| 446M 21.8G  760M 39.0G|47.1k 15.4k| 184M   60M| 132B  644B|  71k   13k\r\n  0   0   0|  0   2  98   0   0| 443M 21.8G  760M 39.0G|47.3k 15.7k| 185M   61M| 306B  644B|  71k   13k\r\n1.0   0   0|  0   2  98   0   0| 444M 21.8G  760M 39.0G|47.0k 15.5k| 184M   61M| 132B  644B|  71k   12k\r\n  0   0   0|  0   1  98   0   0| 445M 21.8G  760M 39.0G|40.3k 13.3k| 157M   52M| 132B  652B|  60k   10k\r\n1.0   0   0|  0   2  98   0   0| 446M 21.8G  760M 39.0G|46.8k 15.5k| 183M   61M| 306B  644B|  71k   13k\r\n  0   0   0|  0   2  98   0   0| 447M 21.8G  760M 39.0G|47.2k 15.6k| 184M   61M| 132B  652B|  72k   13k\r\n  0   0   0|  0   2  98   0   0| 443M 21.8G  760M 39.0G|47.0k 15.8k| 184M   62M| 132B  644B|  71k   13k\r\n  0   0   0|  0   2  98   0   0| 444M 21.8G  760M 39.0G|46.6k 15.6k| 182M   61M| 306B  644B|  70k   13k\r\n  0   0   0|  0   1  98   0   0| 427M 21.8G  760M 39.0G|38.4k 12.8k| 150M   50M| 132B 2456B|  58k   11k\r\n  0   0   0|  0   0 100   0   0| 427M 21.8G  760M 39.0G|   0     0 |   0     0 |  66B  454B|  68   112 ^C\r\n```\r\n\r\nWhile running the `geth` (de1cecb22e2a18ad70d4cb92bee122f4549c5b79) and importing new block receipts and headers:\r\n\r\n```\r\ngolem% ./build/bin/geth --datadir /media/geth/Ethereum\r\nINFO [07-02|19:23:53.470] Starting Geth on Ethereum mainnet...\r\n\r\nINFO [07-02|19:24:39.898] Imported new block receipts              count=17  elapsed=26.272ms  number=15,063,522 hash=01a402..7a7516 age=3h21m10s  size=2.78MiB\r\nINFO [07-02|19:24:40.160] Imported new block receipts              count=21  elapsed=16.081ms  number=15,063,543 hash=66c4a9..6947c1 age=3h17m2s   size=2.67MiB\r\nINFO [07-02|19:24:40.436] Imported new block receipts              count=20  elapsed=14.937ms  number=15,063,563 hash=4e6f7d..bf2197 age=3h12m34s  size=2.88MiB\r\nINFO [07-02|19:24:40.715] Imported new block receipts              count=27  elapsed=14.976ms  number=15,063,590 hash=8ddc53..664210 age=3h8m14s   size=2.83MiB\r\nINFO [07-02|19:24:40.989] Imported new block receipts              count=20  elapsed=25.349ms  number=15,063,610 hash=28bfb9..d71cc1 age=3h4m52s   size=2.82MiB\r\nINFO [07-02|19:24:41.250] Imported new block receipts              count=17  elapsed=16.688ms  number=15,063,627 hash=fd31a4..119306 age=3h21s     size=2.87MiB\r\nINFO [07-02|19:24:41.524] Imported new block receipts              count=20  elapsed=15.948ms  number=15,063,647 hash=463a4e..69bf02 age=2h56m43s  size=3.01MiB\r\nINFO [07-02|19:24:41.791] Imported new block receipts              count=16  elapsed=14.087ms  number=15,063,663 hash=4fdfd6..0dd253 age=2h53m46s  size=2.62MiB\r\n```\r\n\r\nthe iops is close to zero:\r\n\r\n```\r\ngolem% sudo dstat -pcmrdny\r\n---procs--- --total-cpu-usage-- ------memory-usage----- --io/total- -dsk/total- -net/total- ---system--\r\nrun blk new|usr sys idl wai stl| used  free  buff  cach| read  writ| read  writ| recv  send| int   csw\r\n  0   0 1.4|  1   0  99   0   0| 948M 21.2G  764M 39.0G|1652   207 |  12M 2652k|   0     0 |3986  6247\r\n  0   0   0|  2   0  98   0   0| 958M 21.2G  764M 39.0G|3.00     0 | 168k    0 |5342k  140k|6072    10k\r\n2.0   0   0|  2   0  98   0   0| 981M 21.2G  764M 39.0G|4.00     0 | 248k    0 |6282k  151k|6733    11k\r\n  0   0   0|  2   0  98   0   0| 998M 21.1G  764M 39.0G|3.00     0 | 156k    0 |4437k  121k|5066  7774\r\n1.0   0   0|  2   0  98   0   0|1021M 21.1G  764M 39.1G|4.00  53.0 | 180k  232k|6214k  157k|6889    11k\r\n1.0   0   0|  1   0  98   0   0|1033M 21.1G  764M 39.1G|3.00     0 |  84k    0 |5350k  139k|5845    10k\r\n  0   0   0|  2   0  97   0   0|1060M 21.0G  764M 39.1G|4.00  8.00 | 128k   64k|5630k  148k|6296    10k\r\n  0   0   0|  2   0  98   0   0|1072M 21.0G  764M 39.1G|3.00     0 | 252k    0 |4687k  118k|5009  7778\r\n  0   0   0|  2   0  98   0   0|1092M 21.0G  764M 39.1G|4.00     0 | 220k    0 |5511k  140k|5309  7661\r\n  0   0   0|  2   0  98   0   0|1104M 21.0G  764M 39.1G|4.00  2.00 | 220k   16k|4066k  103k|3165  3266\r\n1.0   0   0|  1   0  99   0   0|1132M 20.9G  764M 39.1G|3.00     0 | 208k    0 |1952k   66k|1738  1921\r\n  0   0   0|  2   0  98   0   0|1153M 20.9G  764M 39.1G|4.00     0 | 160k    0 |1456k   64k|1524  1629\r\n  0   0   0|  1   0  99   0   0|1169M 20.9G  764M 39.1G|3.00     0 | 104k    0 |1607k   61k|1535  1645\r\n  0   0   0|  2   0  98   0   0|1176M 20.9G  764M 39.1G|4.00     0 | 172k    0 |1922k   77k|2716  4570\r\n1.0   0   0|  1   0  99   0   0|1184M 20.8G  764M 39.1G|3.00  2.00 | 128k   16k|1803k   61k|2594  4769\r\n```\r\n\r\nSoon running into `State heal in progress`:\r\n\r\n```\r\nINFO [07-02|19:25:38.461] State heal in progress                   accounts=1074@56.41KiB slots=50@4.10KiB codes=29066@234.15MiB nodes=99,015,133@14.12GiB pending=21029\r\nINFO [07-02|19:25:46.562] State heal in progress                   accounts=1851@96.64KiB slots=544@41.98KiB codes=29066@234.15MiB nodes=99,019,892@14.12GiB pending=19579\r\nINFO [07-02|19:25:54.671] State heal in progress                   accounts=2717@144.32KiB slots=650@50.12KiB codes=29066@234.15MiB nodes=99,024,249@14.13GiB pending=19605\r\nINFO [07-02|19:26:03.085] State heal in progress                   accounts=3957@210.66KiB slots=703@54.17KiB codes=29066@234.15MiB nodes=99,029,377@14.13GiB pending=19011\r\nINFO [07-02|19:26:11.116] State heal in progress                   accounts=5079@270.68KiB slots=779@59.83KiB codes=29066@234.15MiB nodes=99,034,325@14.13GiB pending=18579\r\n```\r\n\r\nbut still the `io/total` is an order of magnitude lower than possible:\r\n\r\n```\r\n---procs--- --total-cpu-usage-- ------memory-usage----- --io/total- -dsk/total- -net/total- ---system--\r\nrun blk new|usr sys idl wai stl| used  free  buff  cach| read  writ| read  writ| recv  send| int   csw\r\n2.0   0   0|  1   0  98   0   0|2734M 18.9G  764M 39.6G|2872     0 |  28M    0 | 154k   19k|5380  8548\r\n  0 1.0   0|  2   1  98   0   0|2738M 18.8G  764M 39.6G|2852  2.00 |  29M  224k| 194k   32k|5110  7734\r\n  0 1.0   0|  1   1  98   0   0|2738M 18.8G  764M 39.7G|3004     0 |  30M    0 | 296k   29k|5641  8644\r\n1.0   0   0|  2   0  98   0   0|2739M 18.8G  764M 39.7G|2929     0 |  29M    0 | 167k   14k|5473  8506\r\n  0 1.0   0|  2   0  97   0   0|2745M 18.7G  764M 39.7G|2889     0 |  29M    0 | 193k   19k|5565  8480\r\n1.0   0   0|  2   0  98   0   0|2749M 18.7G  764M 39.8G|2867  44.0 |  29M  220k| 262k   25k|5903  9268\r\n  0 1.0   0|  2   0  98   0   0|2766M 18.7G  764M 39.8G|2881  2.00 |  29M  180k| 225k   31k|5443  8228\r\n1.0   0   0|  1   1  98   0   0|2787M 18.6G  764M 39.8G|2777     0 |  27M    0 | 112k   23k|5501  8832\r\n  0 1.0   0|  2   1  98   0   0|2812M 18.6G  764M 39.8G|2984     0 |  30M    0 | 184k   21k|6050  9507\r\n1.0   0   0|  1   0  98   0   0|2842M 18.5G  764M 39.9G|2873     0 |  29M    0 | 150k   32k|4946  7592\r\n1.0   0   0|  2   1  97   0   0|2876M 18.4G  764M 39.9G|2813  15.0 |  29M 1924k| 260k   24k|5620  8841\r\n  0 1.0   0|  3   1  96   0   0|2906M 18.4G  764M 39.9G|2973  2.00 |  30M  204k| 175k   23k|9038  8376\r\n  0 1.0   0|  2   0  98   0   0|2906M 18.3G  764M 40.0G|2851     0 |  28M    0 | 166k   30k|5697  8899\r\n  0 1.0   0|  2   0  98   0   0|2906M 18.3G  764M 40.0G|2994     0 |  30M    0 | 333k   34k|5906  9137\r\n```\r\n\r\nSampling `wchan`, using [0xtools](https://github.com/tanelpoder/0xtools), indicates that the `geth` process is mostly waiting, and neither `epoll(2)` (to put aside its efficiency) nor `pread64(2)` syscalls occupy it:\r\n\r\n```\r\ngolem# ./psn -G syscall,wchan,kstack -a -p '^geth'\r\nLinux Process Snapper v1.1.0 by Tanel Poder [https://0x.tools]\r\nSampling /proc/stat, syscall, wchan, stack for 5 seconds...\r\nfinished.\r\n=== Active Threads =============================================================================================================================================================================================\r\n samples | avg_threads | comm   | state                  | syscall     | wchan                 | kstack\r\n----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n    2796 |       27.96 | (geth) | Sleep (Interruptible)  | futex       | futex_wait_queue      | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n     100 |        1.00 | (geth) | Sleep (Interruptible)  | epoll_wait  | do_epoll_wait         | __x64_sys_epoll_wait()->do_epoll_wait()\r\n      97 |        0.97 | (geth) | Sleep (Interruptible)  | nanosleep   | hrtimer_nanosleep     | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n      96 |        0.96 | (geth) | Sleep (Interruptible)  | epoll_pwait | do_epoll_wait         | __x64_sys_epoll_pwait()->do_compat_epoll_pwait.part.0()->do_epoll_wait()\r\n      37 |        0.37 | (geth) | Running (ON CPU)       | [running]   | 0                     | -\r\n      33 |        0.33 | (geth) | Disk (Uninterruptible) | pread64     | folio_wait_bit_common | __x64_sys_pread64()->vfs_read()->new_sync_read()->filemap_read()->filemap_get_pages()->folio_wait_bit_common()\r\n       9 |        0.09 | (geth) | Disk (Uninterruptible) | pread64     | 0                     | -\r\n       7 |        0.07 | (geth) | Running (ON CPU)       | pread64     | folio_wait_bit_common | __x64_sys_pread64()->vfs_read()->new_sync_read()->filemap_read()->filemap_get_pages()->folio_wait_bit_common()\r\n       5 |        0.05 | (geth) | Disk (Uninterruptible) | [running]   | 0                     | -\r\n       5 |        0.05 | (geth) | Running (ON CPU)       | [running]   | 0                     | __x64_sys_pread64()->vfs_read()->new_sync_read()->filemap_read()->filemap_get_pages()->folio_wait_bit_common()\r\n       4 |        0.04 | (geth) | Running (ON CPU)       | [running]   | folio_wait_bit_common | __x64_sys_pread64()->vfs_read()->new_sync_read()->filemap_read()->filemap_get_pages()->folio_wait_bit_common()\r\n       3 |        0.03 | (geth) | Sleep (Interruptible)  | epoll_pwait | 0                     | __x64_sys_epoll_pwait()->do_compat_epoll_pwait.part.0()->do_epoll_wait()\r\n       2 |        0.02 | (geth) | Disk (Uninterruptible) | pread64     | 0                     | __x64_sys_pread64()->vfs_read()->new_sync_read()->filemap_read()->filemap_get_pages()->folio_wait_bit_common()\r\n       2 |        0.02 | (geth) | Sleep (Interruptible)  | [running]   | hrtimer_nanosleep     | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n       1 |        0.01 | (geth) | Disk (Uninterruptible) | [running]   | 0                     | __x64_sys_pread64()->vfs_read()->new_sync_read()->filemap_read()->filemap_get_pages()->folio_wait_bit_common()\r\n       1 |        0.01 | (geth) | Disk (Uninterruptible) | pread64     | folio_wait_bit_common | -\r\n       1 |        0.01 | (geth) | Sleep (Interruptible)  | [running]   | 0                     | -\r\n       1 |        0.01 | (geth) | Sleep (Interruptible)  | nanosleep   | 0                     | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\nsamples: 100\r\n(expected: 100)\r\ntotal processes: 1, threads: 32\r\nruntime: 5.01, measure time: 0.57\r\n```",
  "closed_by": {
    "login": "fjl",
    "id": 6915,
    "node_id": "MDQ6VXNlcjY5MTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fjl",
    "html_url": "https://github.com/fjl",
    "followers_url": "https://api.github.com/users/fjl/followers",
    "following_url": "https://api.github.com/users/fjl/following{/other_user}",
    "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
    "organizations_url": "https://api.github.com/users/fjl/orgs",
    "repos_url": "https://api.github.com/users/fjl/repos",
    "events_url": "https://api.github.com/users/fjl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fjl/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25228/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25228/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1173455197",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25228#issuecomment-1173455197",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25228",
    "id": 1173455197,
    "node_id": "IC_kwDOAOvK985F8YFd",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-04T07:31:16Z",
    "updated_at": "2022-07-04T07:31:16Z",
    "author_association": "MEMBER",
    "body": "Receipt downloads is bandwidth bound until about 30-35MB/s, then CPU bound.\r\n\r\nState heal is network latency + serving latency + bandwidth + local disk. A mix of various things.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1173455197/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 1
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1173457145",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25228#issuecomment-1173457145",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25228",
    "id": 1173457145,
    "node_id": "IC_kwDOAOvK985F8Yj5",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-04T07:33:23Z",
    "updated_at": "2022-07-04T07:33:23Z",
    "author_association": "MEMBER",
    "body": "The IOPS bound mostly refers to block execution, though with a good enough network connection, state sync (not heal) can also max out your SSD. You can see that it \"database compacting\" warnings start to appear.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1173457145/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1173725860",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25228#issuecomment-1173725860",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25228",
    "id": 1173725860,
    "node_id": "IC_kwDOAOvK985F9aKk",
    "user": {
      "login": "ycyraum",
      "id": 107963634,
      "node_id": "U_kgDOBm9k8g",
      "avatar_url": "https://avatars.githubusercontent.com/u/107963634?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ycyraum",
      "html_url": "https://github.com/ycyraum",
      "followers_url": "https://api.github.com/users/ycyraum/followers",
      "following_url": "https://api.github.com/users/ycyraum/following{/other_user}",
      "gists_url": "https://api.github.com/users/ycyraum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ycyraum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ycyraum/subscriptions",
      "organizations_url": "https://api.github.com/users/ycyraum/orgs",
      "repos_url": "https://api.github.com/users/ycyraum/repos",
      "events_url": "https://api.github.com/users/ycyraum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ycyraum/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-04T11:49:57Z",
    "updated_at": "2022-07-04T12:34:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thank you for your answer.\r\n\r\nThe node is now synced:\r\n\r\n```\r\ngolem% ./build/bin/geth --datadir /media/geth/Ethereum attach\r\nWelcome to the Geth JavaScript console!\r\n\r\ninstance: Geth/v1.10.21-unstable-de1cecb2-20220701/linux-amd64/go1.18.3\r\nat block: 15075866 (Mon Jul 04 2022 13:49:22 GMT+0200 (CEST))\r\n datadir: /media/geth/Ethereum\r\n modules: admin:1.0 debug:1.0 eth:1.0 ethash:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0\r\n\r\nTo exit, press ctrl-d or type exit\r\n> eth.syncing\r\nfalse\r\n```\r\n\r\n```\r\nINFO [07-04|13:40:08.256] Imported new chain segment               blocks=1   txs=366   mgas=29.999  elapsed=109.763ms   mgasps=273.307  number=15,075,817 hash=0b7c6d..af73e3 age=1m30s     dirty=1.14GiB\r\nINFO [07-04|13:40:08.257] Unindexed transactions                   blocks=1   txs=185   tail=12,725,818 elapsed=1.195ms\r\nINFO [07-04|13:40:20.010] Imported new chain segment               blocks=1   txs=418   mgas=29.983  elapsed=90.251ms    mgasps=332.215  number=15,075,818 hash=c168de..9d82cd dirty=1.15GiB\r\nINFO [07-04|13:40:20.010] Unindexed transactions                   blocks=1   txs=107   tail=12,725,819 elapsed=\"708.001µs\"\r\nINFO [07-04|13:40:28.412] Imported new chain segment               blocks=1   txs=240   mgas=30.029  elapsed=83.498ms    mgasps=359.633  number=15,075,819 hash=0aa156..3d36af dirty=1.15GiB\r\nINFO [07-04|13:40:28.413] Unindexed transactions                   blocks=1   txs=104   tail=12,725,820 elapsed=\"735.649µs\"\r\n```\r\n\r\nI still don't see many iops:\r\n\r\n```\r\ngolem# iostat -kty -d nvme0n1 1\r\n```\r\n\r\n```\r\n07/04/2022 01:40:07 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1           1.00         4.00         0.00         0.00          4          0          0\r\n\r\n\r\n07/04/2022 01:40:08 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1         443.00      3964.00         4.00         0.00       3964          4          0\r\n\r\n\r\n07/04/2022 01:40:09 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1           0.00         0.00         0.00         0.00          0          0          0\r\n\r\n\r\n07/04/2022 01:40:10 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1         533.00      4932.00         0.00         0.00       4932          0          0\r\n\r\n\r\n07/04/2022 01:40:11 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1           3.00        20.00         0.00         0.00         20          0          0\r\n\r\n\r\n07/04/2022 01:40:12 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1           1.00         8.00         0.00         0.00          8          0          0\r\n\r\n\r\n07/04/2022 01:40:13 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1           2.00         0.00       432.00         0.00          0        432          0\r\n\r\n\r\n07/04/2022 01:40:14 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1           0.00         0.00         0.00         0.00          0          0          0\r\n\r\n\r\n07/04/2022 01:40:15 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1           1.00         8.00         0.00         0.00          8          0          0\r\n\r\n\r\n07/04/2022 01:40:16 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1           0.00         0.00         0.00         0.00          0          0          0\r\n\r\n\r\n07/04/2022 01:40:17 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1           1.00         8.00         0.00         0.00          8          0          0\r\n\r\n\r\n07/04/2022 01:40:18 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1           3.00        24.00         0.00         0.00         24          0          0\r\n\r\n\r\n07/04/2022 01:40:19 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1          34.00      2684.00         0.00         0.00       2684          0          0\r\n\r\n\r\n07/04/2022 01:40:20 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1         125.00      2668.00         0.00         0.00       2668          0          0\r\n\r\n\r\n07/04/2022 01:40:21 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1         603.00      6388.00       376.00         0.00       6388        376          0\r\n\r\n\r\n07/04/2022 01:40:22 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1          27.00      1988.00         0.00         0.00       1988          0          0\r\n\r\n\r\n07/04/2022 01:40:23 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1          35.00      2136.00         0.00         0.00       2136          0          0\r\n\r\n\r\n07/04/2022 01:40:24 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1           2.00         8.00         0.00         0.00          8          0          0\r\n\r\n\r\n07/04/2022 01:40:25 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1          30.00      2192.00         0.00         0.00       2192          0          0\r\n\r\n\r\n07/04/2022 01:40:26 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1           7.00       284.00         4.00         0.00        284          4          0\r\n\r\n\r\n07/04/2022 01:40:27 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1           4.00        56.00         0.00         0.00         56          0          0\r\n\r\n\r\n07/04/2022 01:40:28 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1         110.00      4892.00         0.00         0.00       4892          0          0\r\n\r\n\r\n07/04/2022 01:40:29 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1          30.00      2512.00         0.00         0.00       2512          0          0\r\n\r\n\r\n07/04/2022 01:40:30 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1         501.00      5448.00         0.00         0.00       5448          0          0\r\n\r\n\r\n07/04/2022 01:40:31 PM\r\nDevice             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd\r\nnvme0n1          10.00       100.00         0.00         0.00        100          0          0\r\n```\r\n\r\n`dstat -pcmrdny` paints a very similar picture:\r\n\r\n```\r\n---procs--- --total-cpu-usage-- ------memory-usage----- --io/total- -dsk/total- -net/total- ---system--\r\nrun blk new|usr sys idl wai stl| used  free  buff  cach| read  writ| read  writ| recv  send| int   csw\r\n 25   0   0| 32   1  67   0   0|22.8G 2339M 1167M 34.7G| 106  4.00 | 952k   44k|1244k 1186k|  22k   24k\r\n  0 1.0   0| 22   0  78   0   0|22.8G 2337M 1167M 34.7G|83.0     0 | 768k    0 | 776k  677k|  15k   16k\r\n4.0   0   0|  3   0  97   0   0|22.8G 2337M 1167M 34.7G|33.0     0 | 304k    0 | 730k  672k|  14k   22k\r\n1.0   0   0|  1   0  99   0   0|22.8G 2337M 1167M 34.7G|5.00     0 |  40k    0 | 412k  351k|  10k   16k\r\n1.0   0   0|  2   0  97   0   0|22.8G 2337M 1167M 34.7G|27.0     0 | 252k    0 | 541k  561k|  13k   20k\r\n1.0   0   0|  3   0  97   0   0|22.8G 2336M 1167M 34.7G|41.0  1.00 | 308k 4096B| 836k  823k|  16k   24k\r\n  0   0   0|  2   0  97   0   0|22.8G 2332M 1167M 34.7G|26.0     0 | 256k    0 | 904k 1009k|  19k   28k\r\n  0   0   0|  3   0  97   0   0|22.8G 2332M 1167M 34.7G|24.0     0 | 232k    0 | 740k  693k|  15k   24k\r\n  0   0   0|  1   0  98   0   0|22.8G 2332M 1167M 34.7G|11.0  7.00 |  80k  104k| 443k  527k|  11k   17k\r\n1.0   0   0|  1   0  98   0   0|22.8G 2331M 1167M 34.7G|5.00  44.0 |  40k  204k| 371k  275k|9765    15k\r\n2.0   0   0|  5   0  94   0   0|22.8G 2336M 1167M 34.7G|11.0  4.00 | 100k   76k|4145k 2251k|  24k   36k\r\n  0   0   0|  7   0  93   0   0|22.8G 2329M 1167M 34.7G|39.0  2.00 | 364k  476k|6820k  903k|  42k   55k\r\n  0   0   0|  5   1  94   0   0|22.8G 2329M 1167M 34.7G|8.00     0 |  88k    0 |3016k  940k|  33k   57k\r\n1.0   0 2.0|  6   1  93   0   0|22.8G 2328M 1167M 34.7G|33.0  6.00 | 288k   24k|2189k 1417k|  28k   47k\r\n  0   0   0|  4   0  95   0   0|22.8G 2327M 1167M 34.7G|15.0     0 | 104k    0 |1629k  814k|  24k   42k\r\n1.0   0   0|  3   0  97   0   0|22.8G 2327M 1167M 34.7G|17.0     0 | 152k    0 |1097k  543k|  19k   32k\r\n  0   0   0|  3   0  97   0   0|22.8G 2363M 1167M 34.7G|61.0  1.00 | 532k 4096B| 983k  601k|  18k   29k\r\n  0   0   0|  3   0  97   0   0|22.8G 2362M 1167M 34.7G|24.0     0 | 180k    0 | 781k  553k|  15k   25k\r\n1.0   0   0|  3   0  97   0   0|22.8G 2361M 1167M 34.7G|8.00  4.00 |  60k   92k| 845k  599k|  16k   26k\r\n1.0   0   0|  5   0  95   0   0|22.8G 2357M 1167M 34.7G|9.00     0 |  72k    0 |4010k 1445k|  27k   42k\r\n1.0   0   0|  5   0  95   0   0|22.8G 2354M 1167M 34.7G|49.0  4.00 | 492k   44k|2134k  807k|  21k   31k\r\n2.0   0   0|  3   0  97   0   0|22.8G 2352M 1167M 34.7G|44.0     0 | 392k    0 |1203k  793k|  21k   34k\r\n  0   0   0|  3   0  97   0   0|22.8G 2352M 1167M 34.7G|30.0  2.00 | 232k  248k|1206k  809k|  20k   33k\r\n  0 1.0   0|  2   0  97   0   0|22.8G 2351M 1167M 34.7G|9.00     0 |  72k    0 | 974k  576k|  18k   31k\r\n  0   0   0|  3   0  97   0   0|22.8G 2351M 1167M 34.7G|27.0     0 | 220k    0 | 855k  614k|  17k   29k\r\n  0   0   0|  3   1  96   0   0|22.8G 2351M 1167M 34.7G|22.0     0 | 192k    0 | 696k  449k|  15k   25k\r\n1.0   0   0|  4   1  95   0   0|22.8G 2367M 1167M 34.7G|30.0  1.00 | 296k 4096B|1039k  973k|  16k   25k\r\n 24   0   0| 27   0  73   0   0|22.8G 2367M 1167M 34.7G|4.00  22.0 | 416k  716k|2922k  629k|  26k   33k\r\n1.0   0   0| 26   0  74   0   0|22.8G 2363M 1167M 34.7G|69.0  7.00 | 684k  108k| 943k  540k|  14k   17k\r\n1.0   0   0|  2   1  97   0   0|22.8G 2359M 1167M 34.7G|7.00  13.0 |  56k   64k| 581k  484k|  13k   20k\r\n2.0   0   0|  3   1  96   0   0|22.8G 2358M 1167M 34.7G|35.0  4.00 | 276k   48k| 875k  812k|  18k   28k\r\n1.0 1.0   0|  3   1  96   0   0|22.8G 2357M 1167M 34.7G|14.0     0 | 176k    0 | 806k  563k|  17k   28k\r\n1.0   0   0|  4   1  95   0   0|22.8G 2356M 1167M 34.7G|27.0  2.00 | 208k 8192B| 871k  530k|  18k   28k\r\n2.0   0   0|  4   1  95   0   0|22.8G 2356M 1167M 34.7G|20.0     0 | 160k    0 | 981k  824k|  19k   29k\r\n  0   0   0|  5   1  94   0   0|22.8G 2354M 1167M 34.7G|40.0     0 | 392k    0 | 948k  813k|  18k   29k\r\n1.0   0 1.0|  4   1  95   0   0|22.8G 2352M 1167M 34.7G|55.0  1.00 | 592k   44k| 839k  752k|  17k   26k\r\n  0   0   0|  3   1  96   0   0|22.8G 2351M 1167M 34.7G| 130     0 |1372k    0 | 660k  553k|  14k   22k\r\n  0   0   0|  4   1  94   0   0|22.8G 2351M 1167M 34.7G|37.0  2.00 | 380k  128k| 786k  723k|  17k   26k\r\n1.0   0   0|  4   1  95   0   0|22.8G 2349M 1167M 34.7G|84.0  7.00 | 808k  144k| 658k  546k|  15k   23k\r\n  0   0   0|  4   1  95   0   0|22.8G 2346M 1167M 34.7G|36.0  25.0 | 360k  116k| 666k  635k|  15k   22k\r\n  0   0   0|  3   1  96   0   0|22.8G 2346M 1167M 34.7G|10.0  5.00 |  76k   48k| 472k  431k|  12k   18k\r\n1.0   0   0|  4   1  96   0   0|22.8G 2345M 1167M 34.7G|32.0     0 | 288k    0 | 512k  465k|  13k   19k\r\n  0   0   0|  4   1  96   0   0|22.8G 2345M 1167M 34.7G|49.0     0 | 408k    0 | 728k  823k|  15k   23k\r\n  0   0   0|  2   0  97   0   0|22.8G 2344M 1167M 34.7G|10.0     0 |  72k    0 | 507k  524k|  12k   19k\r\n  0   0   0|  4   1  95   0   0|22.8G 2344M 1167M 34.7G|25.0  42.0 | 220k  196k| 680k  624k|  14k   21k\r\n```\r\n\r\n`wchan` sampling:\r\n\r\n```\r\ngolem# ./psn -G syscall,wchan,kstack -d 180 -r -a -p '^geth'\r\nLinux Process Snapper v1.1.0 by Tanel Poder [https://0x.tools]\r\nSampling /proc/stat, syscall, wchan, stack for 180 seconds...\r\nfinished.\r\n=== Active Threads ======================================================================================================================================================================================================================================\r\n samples | avg_threads | comm      | state                  | syscall         | wchan                 | kstack\r\n---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n  142662 |       39.63 | (geth)    | Sleep (Interruptible)  | futex           | futex_wait_queue      | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n    4107 |        1.14 | (geth)    | Running (ON CPU)       | [running]       | 0                     | -\r\n    3600 |        1.00 | (geth)    | Sleep (Interruptible)  | epoll_wait      | do_epoll_wait         | __x64_sys_epoll_wait()->do_epoll_wait()\r\n    3600 |        1.00 | (geth.sh) | Sleep (Interruptible)  | wait4           | do_wait               | kernel_wait4()->do_wait()\r\n    2684 |        0.75 | (geth)    | Sleep (Interruptible)  | epoll_pwait     | do_epoll_wait         | __x64_sys_epoll_pwait()->do_compat_epoll_pwait.part.0()->do_epoll_wait()\r\n    2313 |        0.64 | (geth)    | Sleep (Interruptible)  | nanosleep       | hrtimer_nanosleep     | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n     351 |        0.10 | (geth)    | Running (ON CPU)       | futex           | futex_wait_queue      | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n     191 |        0.05 | (geth)    | Sleep (Interruptible)  | [running]       | 0                     | -\r\n     172 |        0.05 | (geth)    | Running (ON CPU)       | [running]       | futex_wait_queue      | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n     166 |        0.05 | (geth)    | Sleep (Interruptible)  | futex           | futex_wait_queue      | -\r\n     155 |        0.04 | (geth)    | Sleep (Interruptible)  | epoll_pwait     | 0                     | -\r\n     135 |        0.04 | (geth)    | Running (ON CPU)       | [running]       | 0                     | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n     126 |        0.04 | (geth)    | Running (ON CPU)       | epoll_pwait     | do_epoll_wait         | __x64_sys_epoll_pwait()->do_compat_epoll_pwait.part.0()->do_epoll_wait()\r\n     125 |        0.03 | (geth)    | Sleep (Interruptible)  | [running]       | 0                     | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n     118 |        0.03 | (geth)    | Sleep (Interruptible)  | epoll_pwait     | do_epoll_wait         | -\r\n     111 |        0.03 | (geth)    | Sleep (Interruptible)  | [running]       | futex_wait_queue      | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n     103 |        0.03 | (geth)    | Sleep (Interruptible)  | futex           | 0                     | -\r\n      96 |        0.03 | (geth)    | Disk (Uninterruptible) | pread64         | folio_wait_bit_common | __x64_sys_pread64()->vfs_read()->new_sync_read()->filemap_read()->filemap_get_pages()->folio_wait_bit_common()\r\n      79 |        0.02 | (geth)    | Sleep (Interruptible)  | nanosleep       | futex_wait_queue      | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n      76 |        0.02 | (geth)    | Sleep (Interruptible)  | futex           | 0                     | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n      74 |        0.02 | (geth)    | Sleep (Interruptible)  | [running]       | do_epoll_wait         | __x64_sys_epoll_pwait()->do_compat_epoll_pwait.part.0()->do_epoll_wait()\r\n      71 |        0.02 | (geth)    | Running (ON CPU)       | [running]       | 0                     | irqentry_exit_to_user_mode()->exit_to_user_mode_prepare()\r\n      65 |        0.02 | (geth)    | Sleep (Interruptible)  | futex           | futex_wait_queue      | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n      59 |        0.02 | (geth)    | Sleep (Interruptible)  | nanosleep       | hrtimer_nanosleep     | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n      58 |        0.02 | (geth)    | Running (ON CPU)       | nanosleep       | hrtimer_nanosleep     | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n      58 |        0.02 | (geth)    | Sleep (Interruptible)  | futex           | hrtimer_nanosleep     | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n      49 |        0.01 | (geth)    | Sleep (Interruptible)  | futex           | do_epoll_wait         | __x64_sys_epoll_pwait()->do_compat_epoll_pwait.part.0()->do_epoll_wait()\r\n      48 |        0.01 | (geth)    | Sleep (Interruptible)  | futex           | 0                     | __x64_sys_epoll_pwait()->do_compat_epoll_pwait.part.0()->do_epoll_wait()\r\n      41 |        0.01 | (geth)    | Sleep (Interruptible)  | nanosleep       | 0                     | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n      36 |        0.01 | (geth)    | Sleep (Interruptible)  | [running]       | hrtimer_nanosleep     | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n      36 |        0.01 | (geth)    | Sleep (Interruptible)  | futex           | 0                     | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n      35 |        0.01 | (geth)    | Sleep (Interruptible)  | [running]       | 0                     | __x64_sys_epoll_pwait()->do_compat_epoll_pwait.part.0()->do_epoll_wait()\r\n      34 |        0.01 | (geth)    | Sleep (Interruptible)  | futex           | futex_wait_queue      | __x64_sys_epoll_pwait()->do_compat_epoll_pwait.part.0()->do_epoll_wait()\r\n      28 |        0.01 | (geth)    | Running (ON CPU)       | [running]       | do_epoll_wait         | __x64_sys_epoll_pwait()->do_compat_epoll_pwait.part.0()->do_epoll_wait()\r\n      28 |        0.01 | (geth)    | Sleep (Interruptible)  | nanosleep       | 0                     | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n      26 |        0.01 | (geth)    | Sleep (Interruptible)  | nanosleep       | hrtimer_nanosleep     | -\r\n      25 |        0.01 | (geth)    | Running (ON CPU)       | nanosleep       | futex_wait_queue      | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n      24 |        0.01 | (geth)    | Running (ON CPU)       | [running]       | 0                     | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n      21 |        0.01 | (geth)    | Sleep (Interruptible)  | [running]       | hrtimer_nanosleep     | -\r\n      18 |        0.01 | (geth)    | Running (ON CPU)       | [running]       | 0                     | __x64_sys_epoll_pwait()->do_compat_epoll_pwait.part.0()->do_epoll_wait()\r\n      15 |        0.00 | (geth)    | Running (ON CPU)       | [running]       | hrtimer_nanosleep     | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n      13 |        0.00 | (geth)    | Running (ON CPU)       | [running]       | 0                     | __do_sys_sched_yield()\r\n      12 |        0.00 | (geth)    | Sleep (Interruptible)  | epoll_pwait     | 0                     | __x64_sys_epoll_pwait()->do_compat_epoll_pwait.part.0()->do_epoll_wait()\r\n      11 |        0.00 | (geth)    | Sleep (Interruptible)  | epoll_pwait     | 0                     | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n      10 |        0.00 | (geth)    | Sleep (Interruptible)  | [running]       | 0                     | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n      10 |        0.00 | (geth)    | Sleep (Interruptible)  | [running]       | hrtimer_nanosleep     | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n       9 |        0.00 | (geth)    | Running (ON CPU)       | futex           | futex_wait_queue      | -\r\n       8 |        0.00 | (geth)    | Running (ON CPU)       | epoll_pwait     | 0                     | __x64_sys_epoll_pwait()->do_compat_epoll_pwait.part.0()->do_epoll_wait()\r\n       8 |        0.00 | (geth)    | Running (ON CPU)       | epoll_pwait     | do_epoll_wait         | -\r\n       8 |        0.00 | (geth)    | Running (ON CPU)       | nanosleep       | hrtimer_nanosleep     | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n       7 |        0.00 | (geth)    | Running (ON CPU)       | futex           | 0                     | -\r\n       7 |        0.00 | (geth)    | Running (ON CPU)       | futex           | 0                     | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n       7 |        0.00 | (geth)    | Running (ON CPU)       | nanosleep       | 0                     | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n       5 |        0.00 | (geth)    | Sleep (Interruptible)  | [running]       | futex_wait_queue      | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n       5 |        0.00 | (geth)    | Sleep (Interruptible)  | nanosleep       | futex_wait_queue      | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n       4 |        0.00 | (geth)    | Sleep (Interruptible)  | futex           | hrtimer_nanosleep     | -\r\n       3 |        0.00 | (geth)    | Running (ON CPU)       | [running]       | 0                     | syscall_exit_to_user_mode()->exit_to_user_mode_prepare()\r\n       3 |        0.00 | (geth)    | Running (ON CPU)       | [running]       | futex_wait_queue      | -\r\n       3 |        0.00 | (geth)    | Running (ON CPU)       | [running]       | hrtimer_nanosleep     | -\r\n       3 |        0.00 | (geth)    | Running (ON CPU)       | nanosleep       | 0                     | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n       3 |        0.00 | (geth)    | Sleep (Interruptible)  | [running]       | do_epoll_wait         | -\r\n       3 |        0.00 | (geth)    | Sleep (Interruptible)  | [running]       | futex_wait_queue      | -\r\n       2 |        0.00 | (geth)    | Disk (Uninterruptible) | pread64         | 0                     | -\r\n       2 |        0.00 | (geth)    | Running (ON CPU)       | [running]       | 0                     | __x64_sys_pread64()->vfs_read()->new_sync_read()->filemap_read()->filemap_get_pages()->folio_wait_bit_common()\r\n       2 |        0.00 | (geth)    | Running (ON CPU)       | [running]       | do_epoll_wait         | -\r\n       2 |        0.00 | (geth)    | Running (ON CPU)       | epoll_pwait     | 0                     | -\r\n       2 |        0.00 | (geth)    | Running (ON CPU)       | futex           | futex_wait_queue      | __x64_sys_epoll_pwait()->do_compat_epoll_pwait.part.0()->do_epoll_wait()\r\n       2 |        0.00 | (geth)    | Running (ON CPU)       | futex           | hrtimer_nanosleep     | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n       2 |        0.00 | (geth)    | Running (ON CPU)       | nanosleep       | hrtimer_nanosleep     | -\r\n       2 |        0.00 | (geth)    | Running (ON CPU)       | pread64         | folio_wait_bit_common | __x64_sys_pread64()->vfs_read()->new_sync_read()->filemap_read()->filemap_get_pages()->folio_wait_bit_common()\r\n       2 |        0.00 | (geth)    | Sleep (Interruptible)  | epoll_pwait     | futex_wait_queue      | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n       2 |        0.00 | (geth)    | Sleep (Interruptible)  | futex           | hrtimer_nanosleep     | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n       2 |        0.00 | (geth)    | Sleep (Interruptible)  | nanosleep       | 0                     | -\r\n       1 |        0.00 | (geth)    | Disk (Uninterruptible) | [kernel_thread] | folio_wait_bit_common | exc_page_fault()->do_user_addr_fault()->handle_mm_fault()->__handle_mm_fault()->do_swap_page()->__folio_lock_or_retry()->folio_wait_bit_common()\r\n       1 |        0.00 | (geth)    | Disk (Uninterruptible) | [running]       | 0                     | -\r\n       1 |        0.00 | (geth)    | Disk (Uninterruptible) | pread64         | 0                     | __x64_sys_pread64()->vfs_read()->new_sync_read()->filemap_read()->filemap_get_pages()->folio_wait_bit_common()\r\n       1 |        0.00 | (geth)    | Running (ON CPU)       | [running]       | futex_wait_queue      | irqentry_exit_to_user_mode()->exit_to_user_mode_prepare()\r\n       1 |        0.00 | (geth)    | Running (ON CPU)       | [running]       | hrtimer_nanosleep     | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n       1 |        0.00 | (geth)    | Running (ON CPU)       | epoll_pwait     | 0                     | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n       1 |        0.00 | (geth)    | Running (ON CPU)       | futex           | 0                     | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n       1 |        0.00 | (geth)    | Running (ON CPU)       | futex           | futex_wait_queue      | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n       1 |        0.00 | (geth)    | Running (ON CPU)       | nanosleep       | 0                     | -\r\n       1 |        0.00 | (geth)    | Running (ON CPU)       | nanosleep       | 0                     | __x64_sys_epoll_pwait()->do_compat_epoll_pwait.part.0()->do_epoll_wait()\r\n       1 |        0.00 | (geth)    | Running (ON CPU)       | nanosleep       | hrtimer_nanosleep     | __x64_sys_epoll_pwait()->do_compat_epoll_pwait.part.0()->do_epoll_wait()\r\n       1 |        0.00 | (geth)    | Running (ON CPU)       | pread64         | 0                     | -\r\n       1 |        0.00 | (geth)    | Sleep (Interruptible)  | [running]       | hrtimer_nanosleep     | __x64_sys_epoll_pwait()->do_compat_epoll_pwait.part.0()->do_epoll_wait()\r\n       1 |        0.00 | (geth)    | Sleep (Interruptible)  | epoll_pwait     | 0                     | __x64_sys_nanosleep()->hrtimer_nanosleep()\r\n       1 |        0.00 | (geth)    | Sleep (Interruptible)  | epoll_pwait     | do_epoll_wait         | __x64_sys_futex()->do_futex()->futex_wait()->futex_wait_queue()\r\n       1 |        0.00 | (geth)    | Sleep (Interruptible)  | futex           | do_epoll_wait         | -\r\n       1 |        0.00 | (geth)    | Sleep (Interruptible)  | nanosleep       | futex_wait_queue      | -\r\nsamples: 3600\r\n(expected: 3600)\r\ntotal processes: 2, threads: 45\r\nruntime: 180.33, measure time: 25.77\r\ngolem#\r\n```\r\n\r\nI'm running the node with:\r\n\r\n```\r\n./build/bin/geth --datadir /media/geth/Ethereum \\\r\n    --cache 49152 \\\r\n    --maxpeers 4096 \\\r\n    --metrics \\\r\n    --metrics.influxdb \\\r\n    --metrics.influxdb.endpoint \"http://0.0.0.0:8086\" \\\r\n    --metrics.influxdb.username \"geth\" \\\r\n    --metrics.influxdb.password \"password\" \\\r\n    --txpool.globalslots 262144 \\\r\n    --txpool.globalqueue 262144 \\\r\n    --txpool.accountqueue 65536 \\\r\n    --txpool.accountslots 65536\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1173725860/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1177274567",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25228#issuecomment-1177274567",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25228",
    "id": 1177274567,
    "node_id": "IC_kwDOAOvK985GK8jH",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-07T08:55:19Z",
    "updated_at": "2022-07-07T08:55:19Z",
    "author_association": "MEMBER",
    "body": "There is no actionable information in this issue. The dumps you created are interesting, but it does not seem like there is any particular code we could make here to improve things.\r\n\r\nIf you have an idea about something we can improve, let us know.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1177274567/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
