{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1657",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1657/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1657/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1657/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/1657",
  "id": 100901520,
  "node_id": "MDU6SXNzdWUxMDA5MDE1MjA=",
  "number": 1657,
  "title": "Contract works in the realitime compiler, but not when running locally (using web3 and solc)",
  "user": {
    "login": "aakilfernandes",
    "id": 1577353,
    "node_id": "MDQ6VXNlcjE1NzczNTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1577353?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/aakilfernandes",
    "html_url": "https://github.com/aakilfernandes",
    "followers_url": "https://api.github.com/users/aakilfernandes/followers",
    "following_url": "https://api.github.com/users/aakilfernandes/following{/other_user}",
    "gists_url": "https://api.github.com/users/aakilfernandes/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/aakilfernandes/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/aakilfernandes/subscriptions",
    "organizations_url": "https://api.github.com/users/aakilfernandes/orgs",
    "repos_url": "https://api.github.com/users/aakilfernandes/repos",
    "events_url": "https://api.github.com/users/aakilfernandes/events{/privacy}",
    "received_events_url": "https://api.github.com/users/aakilfernandes/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2015-08-14T00:35:06Z",
  "updated_at": "2015-08-18T10:07:09Z",
  "closed_at": "2015-08-18T10:07:09Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Contract below.\n\nRun `Lotto.addBuyer(10,10)` then `Lotto.getBuyerAddrs()`. Works in the realtiem compiler but not locally. Not exactly sure where to submit this issue. Sorry if this is the wrong place.\n\n```\ncontract Lotto {\n    uint blocksPerRound=6800;\n\n    struct Buyer{\n        address addr;\n        uint amount;\n    }\n\n    struct Round {\n        address[] buyerAddrs;\n        mapping(address=>Buyer) buyers;\n    }\n\n    mapping(uint => Round) rounds;\n\n    function getRoundIndex() constant returns (uint){\n        return block.number/blocksPerRound;\n    }\n\n    function getBuyerAddrs() constant returns (address[]){\n        return rounds[getRoundIndex()].buyerAddrs;\n    }\n\n\nfunction addBuyer(address buyerAddr,uint buyerAmount) constant returns(address[]){\n\n    var roundIndex = getRoundIndex();\n    var buyerExists = false;\n    var buyerIndex = 0;\n    var buyersLength = rounds[roundIndex].buyerAddrs.length;\n\n    rounds[roundIndex].buyerAddrs.length++;\n    rounds[roundIndex].buyerAddrs[buyersLength]=buyerAddr;\n\n    return rounds[roundIndex].buyerAddrs;\n\n    //rounds[roundIndex].buyers[buyerAddr] = Buyer(buyerAddr,buyerAmount);\n\n}\n\n    function getBuyersLength() constant returns(uint){\n        return rounds[getRoundIndex()].buyerAddrs.length;\n    }\n\n}\n```\n",
  "closed_by": {
    "login": "tgerring",
    "id": 731472,
    "node_id": "MDQ6VXNlcjczMTQ3Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/731472?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tgerring",
    "html_url": "https://github.com/tgerring",
    "followers_url": "https://api.github.com/users/tgerring/followers",
    "following_url": "https://api.github.com/users/tgerring/following{/other_user}",
    "gists_url": "https://api.github.com/users/tgerring/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tgerring/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tgerring/subscriptions",
    "organizations_url": "https://api.github.com/users/tgerring/orgs",
    "repos_url": "https://api.github.com/users/tgerring/repos",
    "events_url": "https://api.github.com/users/tgerring/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tgerring/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1657/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1657/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/131012158",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/1657#issuecomment-131012158",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1657",
    "id": 131012158,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMTAxMjE1OA==",
    "user": {
      "login": "obscuren",
      "id": 6264126,
      "node_id": "MDQ6VXNlcjYyNjQxMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6264126?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/obscuren",
      "html_url": "https://github.com/obscuren",
      "followers_url": "https://api.github.com/users/obscuren/followers",
      "following_url": "https://api.github.com/users/obscuren/following{/other_user}",
      "gists_url": "https://api.github.com/users/obscuren/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/obscuren/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/obscuren/subscriptions",
      "organizations_url": "https://api.github.com/users/obscuren/orgs",
      "repos_url": "https://api.github.com/users/obscuren/repos",
      "events_url": "https://api.github.com/users/obscuren/events{/privacy}",
      "received_events_url": "https://api.github.com/users/obscuren/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-08-14T08:02:55Z",
    "updated_at": "2015-08-14T08:02:55Z",
    "author_association": "MEMBER",
    "body": "What goes wrong?\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/131012158/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/131013374",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/1657#issuecomment-131013374",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1657",
    "id": 131013374,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMTAxMzM3NA==",
    "user": {
      "login": "maran",
      "id": 20855,
      "node_id": "MDQ6VXNlcjIwODU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/20855?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maran",
      "html_url": "https://github.com/maran",
      "followers_url": "https://api.github.com/users/maran/followers",
      "following_url": "https://api.github.com/users/maran/following{/other_user}",
      "gists_url": "https://api.github.com/users/maran/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maran/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maran/subscriptions",
      "organizations_url": "https://api.github.com/users/maran/orgs",
      "repos_url": "https://api.github.com/users/maran/repos",
      "events_url": "https://api.github.com/users/maran/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maran/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-08-14T08:09:03Z",
    "updated_at": "2015-08-14T08:09:03Z",
    "author_association": "MEMBER",
    "body": "I think you are trying to compile locally with an old solc version. What does `solc --version` give you? \n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/131013374/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/131109155",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/1657#issuecomment-131109155",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1657",
    "id": 131109155,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMTEwOTE1NQ==",
    "user": {
      "login": "aakilfernandes",
      "id": 1577353,
      "node_id": "MDQ6VXNlcjE1NzczNTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1577353?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aakilfernandes",
      "html_url": "https://github.com/aakilfernandes",
      "followers_url": "https://api.github.com/users/aakilfernandes/followers",
      "following_url": "https://api.github.com/users/aakilfernandes/following{/other_user}",
      "gists_url": "https://api.github.com/users/aakilfernandes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aakilfernandes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aakilfernandes/subscriptions",
      "organizations_url": "https://api.github.com/users/aakilfernandes/orgs",
      "repos_url": "https://api.github.com/users/aakilfernandes/repos",
      "events_url": "https://api.github.com/users/aakilfernandes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aakilfernandes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-08-14T13:43:15Z",
    "updated_at": "2015-08-14T13:44:07Z",
    "author_association": "NONE",
    "body": "Solc is\n\n```\nsolc, the solidity compiler commandline interface\nVersion: 0.1.1-ac9911c1/Release-Darwin/clang/JIT\n```\n\nI ran `homebrew update` and reinstalled `ethereum-cpp` (master). I believe that should of updated it to the latest version.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/131109155/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/131109458",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/1657#issuecomment-131109458",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1657",
    "id": 131109458,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMTEwOTQ1OA==",
    "user": {
      "login": "aakilfernandes",
      "id": 1577353,
      "node_id": "MDQ6VXNlcjE1NzczNTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1577353?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aakilfernandes",
      "html_url": "https://github.com/aakilfernandes",
      "followers_url": "https://api.github.com/users/aakilfernandes/followers",
      "following_url": "https://api.github.com/users/aakilfernandes/following{/other_user}",
      "gists_url": "https://api.github.com/users/aakilfernandes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aakilfernandes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aakilfernandes/subscriptions",
      "organizations_url": "https://api.github.com/users/aakilfernandes/orgs",
      "repos_url": "https://api.github.com/users/aakilfernandes/repos",
      "events_url": "https://api.github.com/users/aakilfernandes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aakilfernandes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-08-14T13:45:05Z",
    "updated_at": "2015-08-14T13:45:22Z",
    "author_association": "NONE",
    "body": "@obscuren `getBuyerAddrs` always returns an empty array locally, returns the desired address array in the realitme compiler\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/131109458/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/131252444",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/1657#issuecomment-131252444",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1657",
    "id": 131252444,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMTI1MjQ0NA==",
    "user": {
      "login": "aakilfernandes",
      "id": 1577353,
      "node_id": "MDQ6VXNlcjE1NzczNTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1577353?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aakilfernandes",
      "html_url": "https://github.com/aakilfernandes",
      "followers_url": "https://api.github.com/users/aakilfernandes/followers",
      "following_url": "https://api.github.com/users/aakilfernandes/following{/other_user}",
      "gists_url": "https://api.github.com/users/aakilfernandes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aakilfernandes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aakilfernandes/subscriptions",
      "organizations_url": "https://api.github.com/users/aakilfernandes/orgs",
      "repos_url": "https://api.github.com/users/aakilfernandes/repos",
      "events_url": "https://api.github.com/users/aakilfernandes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aakilfernandes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-08-14T22:11:10Z",
    "updated_at": "2015-08-14T22:11:16Z",
    "author_association": "NONE",
    "body": "So it looks like there is a bug in the contract, and the realtime compiler is actually the one thats too forgiving (solc is accurate). I removed the `constant` from `addBuyer` and got the desired results.\n\nSo it looks like the bug is with the realtime compiler. Not sure where (if) issues for that go, so I'll keep this open until one of the devs decide where it goes.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/131252444/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/132154422",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/1657#issuecomment-132154422",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1657",
    "id": 132154422,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEzMjE1NDQyMg==",
    "user": {
      "login": "tgerring",
      "id": 731472,
      "node_id": "MDQ6VXNlcjczMTQ3Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/731472?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tgerring",
      "html_url": "https://github.com/tgerring",
      "followers_url": "https://api.github.com/users/tgerring/followers",
      "following_url": "https://api.github.com/users/tgerring/following{/other_user}",
      "gists_url": "https://api.github.com/users/tgerring/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tgerring/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tgerring/subscriptions",
      "organizations_url": "https://api.github.com/users/tgerring/orgs",
      "repos_url": "https://api.github.com/users/tgerring/repos",
      "events_url": "https://api.github.com/users/tgerring/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tgerring/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-08-18T10:07:09Z",
    "updated_at": "2015-08-18T10:07:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "@aakilfernandes solc is written by the C++ team over at https://github.com/ethereum/cpp-ethereum. Closing issue... if there's something specific to Geth, please reopen\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/132154422/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
