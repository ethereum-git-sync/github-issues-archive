{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19305",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19305/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19305/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19305/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/19305",
  "id": 423352246,
  "node_id": "MDU6SXNzdWU0MjMzNTIyNDY=",
  "number": 19305,
  "title": "geth panics while syncing:  invalid memory address or nil pointer dereference",
  "user": {
    "login": "darren",
    "id": 12817,
    "node_id": "MDQ6VXNlcjEyODE3",
    "avatar_url": "https://avatars.githubusercontent.com/u/12817?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/darren",
    "html_url": "https://github.com/darren",
    "followers_url": "https://api.github.com/users/darren/followers",
    "following_url": "https://api.github.com/users/darren/following{/other_user}",
    "gists_url": "https://api.github.com/users/darren/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/darren/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/darren/subscriptions",
    "organizations_url": "https://api.github.com/users/darren/orgs",
    "repos_url": "https://api.github.com/users/darren/repos",
    "events_url": "https://api.github.com/users/darren/events{/privacy}",
    "received_events_url": "https://api.github.com/users/darren/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2019-03-20T16:31:36Z",
  "updated_at": "2019-03-20T18:00:51Z",
  "closed_at": "2019-03-20T18:00:51Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth\r\nVersion: 1.8.22-stable\r\nArchitecture: amd64\r\nProtocol Versions: [63 62]\r\nNetwork Id: 1\r\nGo Version: go1.11.5\r\nOperating System: darwin\r\nGOPATH=/Users/darren/Sources/go\r\nGOROOT=/usr/local/Cellar/go/1.11.5/libexec\r\n\r\n#### Expected behaviour\r\nsync ok\r\n\r\n#### Actual behaviour\r\npanic\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\ngeth --cache 4096 --datadir /Volumes/MDisk/ether/\r\n\r\n#### Backtrace\r\n\r\n````\r\nINFO [03-20|22:27:11.720] Imported new state entries               count=1152 elapsed=5.538ms   processed=119829382 pending=13681 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:13.752] Imported new state entries               count=1920 elapsed=10.120ms  processed=119831302 pending=12742 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:17.060] Imported new state entries               count=1152 elapsed=4.878ms   processed=119832454 pending=15913 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:19.261] Imported new state entries               count=1920 elapsed=9.002ms   processed=119834374 pending=15503 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:21.084] Imported new state entries               count=1920 elapsed=10.071ms  processed=119836294 pending=14558 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:23.332] Imported new state entries               count=1920 elapsed=9.324ms   processed=119838214 pending=13961 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:25.375] Imported new state entries               count=1920 elapsed=9.758ms   processed=119840134 pending=13090 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:27.408] Imported new state entries               count=1920 elapsed=9.720ms   processed=119842054 pending=12581 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:30.078] Imported new state entries               count=768  elapsed=3.764ms   processed=119842822 pending=15352 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:32.208] Imported new state entries               count=1920 elapsed=8.991ms   processed=119844742 pending=15004 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:33.877] Imported new state entries               count=1536 elapsed=7.506ms   processed=119846278 pending=14556 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:35.932] Imported new state entries               count=1920 elapsed=10.103ms  processed=119848198 pending=13604 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:37.481] Imported new state entries               count=1536 elapsed=7.182ms   processed=119849734 pending=13288 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:38.677] Imported new block headers               count=1    elapsed=3.833ms   number=7406241 hash=abd7fe…1c4f42                                                                                                                        \r\nINFO [03-20|22:27:39.545] Imported new state entries               count=1920 elapsed=10.359ms  processed=119851654 pending=12305 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:41.405] Imported new state entries               count=768  elapsed=3.665ms   processed=119852422 pending=13989 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:43.399] Imported new state entries               count=1920 elapsed=9.100ms   processed=119854342 pending=13442 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:45.081] Imported new state entries               count=1536 elapsed=7.724ms   processed=119855878 pending=13067 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:47.454] Imported new state entries               count=1920 elapsed=10.092ms  processed=119857798 pending=11981 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:51.509] Imported new state entries               count=1152 elapsed=5.367ms   processed=119858950 pending=15368 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:53.350] Imported new state entries               count=1536 elapsed=7.270ms   processed=119860486 pending=15025 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:55.442] Imported new state entries               count=1920 elapsed=9.239ms   processed=119862406 pending=14615 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:56.950] Imported new block headers               count=1    elapsed=3.871ms   number=7406242 hash=55b304…fe4573                                                                                                                        \r\nINFO [03-20|22:27:57.732] Imported new state entries               count=1920 elapsed=10.066ms  processed=119864326 pending=13603 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:27:59.747] Imported new state entries               count=1920 elapsed=9.868ms   processed=119866246 pending=13024 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:28:01.663] Imported new state entries               count=1536 elapsed=8.100ms   processed=119867782 pending=12532 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:28:03.645] Imported new state entries               count=1920 elapsed=10.107ms  processed=119869702 pending=11624 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:28:05.548] Imported new state entries               count=1536 elapsed=7.662ms   processed=119871238 pending=11671 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:28:09.019] Imported new state entries               count=768  elapsed=3.641ms   processed=119872006 pending=13688 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:28:11.139] Imported new state entries               count=1920 elapsed=8.790ms   processed=119873926 pending=13460 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nINFO [03-20|22:28:12.202] Imported new block headers               count=2    elapsed=4.103ms   number=7406244 hash=4fbded…8f5b50                                                                                                                        \r\nINFO [03-20|22:28:13.095] Imported new state entries               count=1920 elapsed=10.386ms  processed=119875846 pending=12323 retry=0   duplicate=11365 unexpected=40005                                                                             \r\nWARN [03-20|22:28:13.173] Pivot became stale, moving               old=7406114 new=7406180\r\nWARN [03-20|22:28:14.364] Rolled back headers                      count=2048 header=7406244->7404196 fast=7406113->7404196 block=0->0                                                                                                                   \r\nWARN [03-20|22:28:14.364] Synchronisation failed, dropping peer    peer=4631cdc0dd565234 err=\"retrieved hash chain is invalid\"                                                                                                                           \r\nINFO [03-20|22:28:14.701] Imported new block headers               count=0    elapsed=1.556ms   number=7406244 hash=4fbded…8f5b50 ignored=96                                                                                                             \r\nINFO [03-20|22:28:15.086] Imported new block receipts              count=0    elapsed=68.363µs  number=7406150 hash=58fa28…9229b9 age=23m56s    size=0.00B    ignored=2                                                                                  \r\nINFO [03-20|22:28:16.951] Imported new block receipts              count=0    elapsed=78.643µs  number=7406157 hash=d8f9e5…4a845e age=21m46s    size=0.00B    ignored=7                                                                                  \r\nINFO [03-20|22:28:17.778] Imported new block headers               count=1    elapsed=3.966ms   number=7406245 hash=6d8ced…8523cd                                                                                                                        \r\nERROR[03-20|22:28:20.838] Failed to unregister sync peer           peer=b6de6f4ff9f0aa27 err=\"peer is not registered\"\r\nERROR[03-20|22:28:20.838] Peer removal failed                      peer=b6de6f4ff9f0aa27 err=\"peer is not registered\"\r\nWARN [03-20|22:28:21.469] Rolled back headers                      count=1    header=7406245->7406244 fast=7406157->7406157 block=0->0                                                                                                                   \r\nWARN [03-20|22:28:21.469] Synchronisation failed, dropping peer    peer=5745aa00c4cf5e15 err=\"retrieved hash chain is invalid\"                                                                                                                           \r\nINFO [03-20|22:28:21.834] Imported new block headers               count=0    elapsed=1.412ms   number=7406245 hash=6d8ced…8523cd ignored=88                                                                                                             \r\nINFO [03-20|22:28:22.518] Imported new block receipts              count=0    elapsed=69.892µs  number=7406159 hash=7b9d9f…87a0d1 age=21m46s    size=0.00B    ignored=2                                                                                  \r\nINFO [03-20|22:28:22.916] Imported new block receipts              count=0    elapsed=68.786µs  number=7406161 hash=5f9db2…b456d3 age=21m28s    size=0.00B    ignored=2                                                                                  \r\nWARN [03-20|22:28:24.006] Synchronisation failed, dropping peer    peer=4631cdc0dd565234 err=\"retrieved hash chain is invalid\"                                                                                                                           \r\nWARN [03-20|22:28:32.110] Ancestor below allowance                 peer=5745aa00c4cf5e15 number=7316161 hash=000000…000000 allowance=7316161                                                                                                             \r\nWARN [03-20|22:28:32.110] Synchronisation failed, dropping peer    peer=5745aa00c4cf5e15 err=\"retrieved ancestor is invalid\"\r\npanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x1c0 pc=0x4657d03]\r\n\r\ngoroutine 292567 [running]:\r\ngithub.com/ethereum/go-ethereum/eth/downloader.(*Downloader).findAncestor(0xc0001e7040, 0xc05dd96780, 0xc0a41ce480, 0x0, 0x0, 0xc000040570)                                                                                                              \r\n        /private/tmp/ethereum-20190201-36073-iknusg/go-ethereum-1.8.22/build/_workspace/src/github.com/ethereum/go-ethereum/eth/downloader/downloader.go:825 +0x15d3                                                                                     \r\ngithub.com/ethereum/go-ethereum/eth/downloader.(*Downloader).syncWithPeer(0xc0001e7040, 0xc05dd96780, 0x7531f7f2e0e9eba6, 0xba76e3968879c024, 0xf7e6aad56a139493, 0x78fb64a843612319, 0xc07da44980, 0x0, 0x0)                                            \r\n        /private/tmp/ethereum-20190201-36073-iknusg/go-ethereum-1.8.22/build/_workspace/src/github.com/ethereum/go-ethereum/eth/downloader/downloader.go:437 +0x37d                                                                                      \r\ngithub.com/ethereum/go-ethereum/eth/downloader.(*Downloader).synchronise(0xc0001e7040, 0xc0978c4990, 0x10, 0x7531f7f2e0e9eba6, 0xba76e3968879c024, 0xf7e6aad56a139493, 0x78fb64a843612319, 0xc07da44980, 0x1, 0x0, ...)                                  \r\n        /private/tmp/ethereum-20190201-36073-iknusg/go-ethereum-1.8.22/build/_workspace/src/github.com/ethereum/go-ethereum/eth/downloader/downloader.go:406 +0x362                                                                                      \r\ngithub.com/ethereum/go-ethereum/eth/downloader.(*Downloader).Synchronise(0xc0001e7040, 0xc0978c4990, 0x10, 0x7531f7f2e0e9eba6, 0xba76e3968879c024, 0xf7e6aad56a139493, 0x78fb64a843612319, 0xc07da44980, 0x1, 0x4db4c00, ...)                            \r\n        /private/tmp/ethereum-20190201-36073-iknusg/go-ethereum-1.8.22/build/_workspace/src/github.com/ethereum/go-ethereum/eth/downloader/downloader.go:324 +0x91                                                                                       \r\ngithub.com/ethereum/go-ethereum/eth.(*ProtocolManager).synchronise(0xc0001bf6c0, 0xc01e637080)\r\n        /private/tmp/ethereum-20190201-36073-iknusg/go-ethereum-1.8.22/build/_workspace/src/github.com/ethereum/go-ethereum/eth/sync.go:200 +0x313                                                                                                       \r\ncreated by github.com/ethereum/go-ethereum/eth.(*ProtocolManager).syncer\r\n        /private/tmp/ethereum-20190201-36073-iknusg/go-ethereum-1.8.22/build/_workspace/src/github.com/ethereum/go-ethereum/eth/sync.go:151 +0x269    \r\n````\r\n",
  "closed_by": {
    "login": "darren",
    "id": 12817,
    "node_id": "MDQ6VXNlcjEyODE3",
    "avatar_url": "https://avatars.githubusercontent.com/u/12817?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/darren",
    "html_url": "https://github.com/darren",
    "followers_url": "https://api.github.com/users/darren/followers",
    "following_url": "https://api.github.com/users/darren/following{/other_user}",
    "gists_url": "https://api.github.com/users/darren/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/darren/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/darren/subscriptions",
    "organizations_url": "https://api.github.com/users/darren/orgs",
    "repos_url": "https://api.github.com/users/darren/repos",
    "events_url": "https://api.github.com/users/darren/events{/privacy}",
    "received_events_url": "https://api.github.com/users/darren/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19305/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19305/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/474940586",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19305#issuecomment-474940586",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19305",
    "id": 474940586,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NDk0MDU4Ng==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-20T17:19:04Z",
    "updated_at": "2019-03-20T17:19:04Z",
    "author_association": "MEMBER",
    "body": "That's 1.8.22. I'm fairly certain we fixed this on master and also backported to 1.8, so should be fixed in 1.8.23. Leaving this open until confirmed (on mobile)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/474940586/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
