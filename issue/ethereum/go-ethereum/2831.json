{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2831",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2831/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2831/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2831/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/2831",
  "id": 166006906,
  "node_id": "MDU6SXNzdWUxNjYwMDY5MDY=",
  "number": 2831,
  "title": "Library contract method failing",
  "user": {
    "login": "brendan87",
    "id": 11881233,
    "node_id": "MDQ6VXNlcjExODgxMjMz",
    "avatar_url": "https://avatars.githubusercontent.com/u/11881233?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/brendan87",
    "html_url": "https://github.com/brendan87",
    "followers_url": "https://api.github.com/users/brendan87/followers",
    "following_url": "https://api.github.com/users/brendan87/following{/other_user}",
    "gists_url": "https://api.github.com/users/brendan87/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/brendan87/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/brendan87/subscriptions",
    "organizations_url": "https://api.github.com/users/brendan87/orgs",
    "repos_url": "https://api.github.com/users/brendan87/repos",
    "events_url": "https://api.github.com/users/brendan87/events{/privacy}",
    "received_events_url": "https://api.github.com/users/brendan87/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2016-07-18T01:31:16Z",
  "updated_at": "2016-10-12T18:52:48Z",
  "closed_at": "2016-07-21T10:22:24Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\n\nGeth version: 1.5.0\nOS & Version: Windows 10\nInterface - chriseth's browser-solidity (implements web3)\n#### Expected behaviour\n\nCall simple library function to update a simple storage variable.\n#### Actual behaviour\n\nGas required exceeds limit: 50000000\n#### Steps to reproduce the behaviour\n\nContract 1:\n\n```\nimport \"./test2.sol\";\n\ncontract test1 {\n    uint8 stor1;\n    function runLibFunc () {\n        stor1 = test2.foo();\n    }\n}\n```\n\nContract 2:\n\n```\nlibrary test2 {\n    function foo () constant returns (uint8) {\n        return 2;\n    }\n}\n```\n\nOnce test1 is deployed, run 'runLibFunc()'.\n### Comments\n\nNot sure if this is an interface (web3) issue or geth\n",
  "closed_by": {
    "login": "brendan87",
    "id": 11881233,
    "node_id": "MDQ6VXNlcjExODgxMjMz",
    "avatar_url": "https://avatars.githubusercontent.com/u/11881233?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/brendan87",
    "html_url": "https://github.com/brendan87",
    "followers_url": "https://api.github.com/users/brendan87/followers",
    "following_url": "https://api.github.com/users/brendan87/following{/other_user}",
    "gists_url": "https://api.github.com/users/brendan87/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/brendan87/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/brendan87/subscriptions",
    "organizations_url": "https://api.github.com/users/brendan87/orgs",
    "repos_url": "https://api.github.com/users/brendan87/repos",
    "events_url": "https://api.github.com/users/brendan87/events{/privacy}",
    "received_events_url": "https://api.github.com/users/brendan87/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2831/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2831/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/233957163",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2831#issuecomment-233957163",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2831",
    "id": 233957163,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzMzk1NzE2Mw==",
    "user": {
      "login": "bas-vk",
      "id": 4280775,
      "node_id": "MDQ6VXNlcjQyODA3NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4280775?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bas-vk",
      "html_url": "https://github.com/bas-vk",
      "followers_url": "https://api.github.com/users/bas-vk/followers",
      "following_url": "https://api.github.com/users/bas-vk/following{/other_user}",
      "gists_url": "https://api.github.com/users/bas-vk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bas-vk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bas-vk/subscriptions",
      "organizations_url": "https://api.github.com/users/bas-vk/orgs",
      "repos_url": "https://api.github.com/users/bas-vk/repos",
      "events_url": "https://api.github.com/users/bas-vk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bas-vk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-07-20T13:58:33Z",
    "updated_at": "2016-07-20T15:48:59Z",
    "author_association": "MEMBER",
    "body": "You probably run geth with the `--dev` option to create a private network? In that case use the init subcommand to create a private chain. Instructions can be found in the [wiki](https://github.com/ethereum/go-ethereum/wiki/Command-Line-Options#init). Or use the testnet.\n\nThe problem is that this code uses the delegatecall which is added in the homestead release. The `--dev` flag uses the homestead block number of the mainnet which is 1150000. Any transaction before this block will encounter an invalid opcode, consumes all gas and all state changes are reverted.\n\n@obscuren, initially I thought there was an invalid opcode but it turns out I had a pre homestead copy of the yellow paper.  Instead of setting the homestead block for the development chain can we drop the entire `--dev` flag in favor of the init subcommand?\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/233957163/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/234104185",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2831#issuecomment-234104185",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2831",
    "id": 234104185,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNDEwNDE4NQ==",
    "user": {
      "login": "brendan87",
      "id": 11881233,
      "node_id": "MDQ6VXNlcjExODgxMjMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/11881233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brendan87",
      "html_url": "https://github.com/brendan87",
      "followers_url": "https://api.github.com/users/brendan87/followers",
      "following_url": "https://api.github.com/users/brendan87/following{/other_user}",
      "gists_url": "https://api.github.com/users/brendan87/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brendan87/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brendan87/subscriptions",
      "organizations_url": "https://api.github.com/users/brendan87/orgs",
      "repos_url": "https://api.github.com/users/brendan87/repos",
      "events_url": "https://api.github.com/users/brendan87/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brendan87/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-07-20T22:31:33Z",
    "updated_at": "2016-07-21T08:30:51Z",
    "author_association": "NONE",
    "body": "Thanks @bas-vk. Apologies for not providing more information on the geth environment. I wasn't using the --dev option - I am running geth using the following command line args:\n\n```\ngeth init genesis.json \ngeth --identity \"node150\" --rpc --rpcport \"8777\" --rpccorsdomain \"*\" --datadir \"D:\\testNode\\data\" --port \"30303\" --maxpeers 0 --nodiscover --ipcapi \"admin,db,eth,debug,miner,net,shh,txpool,personal,web3\" --rpcapi \"db,eth,net,web3\" --autodag --networkid 1150 --nat \"any\" console\n```\n\nWhere genesis is as follows:\n\n```\n{\n    \"nonce\": \"0x0000000000000042\",\n    \"timestamp\": \"0x0\",\n    \"parentHash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\n    \"extraData\": \"0x0\",\n    \"gasLimit\": \"0x8000000\",\n    \"difficulty\": \"0x400\",\n    \"mixhash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\n    \"coinbase\": \"0x3333333333333333333333333333333333333333\",\n    \"alloc\": {\n    }\n}\n```\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/234104185/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/234176817",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2831#issuecomment-234176817",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2831",
    "id": 234176817,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNDE3NjgxNw==",
    "user": {
      "login": "bas-vk",
      "id": 4280775,
      "node_id": "MDQ6VXNlcjQyODA3NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4280775?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bas-vk",
      "html_url": "https://github.com/bas-vk",
      "followers_url": "https://api.github.com/users/bas-vk/followers",
      "following_url": "https://api.github.com/users/bas-vk/following{/other_user}",
      "gists_url": "https://api.github.com/users/bas-vk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bas-vk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bas-vk/subscriptions",
      "organizations_url": "https://api.github.com/users/bas-vk/orgs",
      "repos_url": "https://api.github.com/users/bas-vk/repos",
      "events_url": "https://api.github.com/users/bas-vk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bas-vk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-07-21T07:21:59Z",
    "updated_at": "2016-07-21T07:21:59Z",
    "author_association": "MEMBER",
    "body": "That is actually the same issue. The genesis config file supports a config section. Currently the only thing you can configure is the homestead block number. If you don't specify it, it will be defaulted to the mainnet number which is 1150000. So basically your contract will work after this block.\n\nTry the following genesis file:\n\n```\n{\n   \"config\":{\n      \"homesteadBlock\":\"5\"\n   },\n   \"nonce\":\"0x0000000000000042\",\n   \"timestamp\":\"0x0\",\n   \"parentHash\":\"0x0000000000000000000000000000000000000000000000000000000000000000\",\n   \"extraData\":\"0x0\",\n   \"gasLimit\":\"0x8000000\",\n   \"difficulty\":\"0x400\",\n   \"mixhash\":\"0x0000000000000000000000000000000000000000000000000000000000000000\",\n   \"coinbase\":\"0x3333333333333333333333333333333333333333\",\n   \"alloc\":{\n\n   }\n}\n```\n\nIf the contract is deployed in block <5 it will give the gas limit problem. \nDeployed in block >= 5 it should work as intended.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/234176817/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/234192576",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2831#issuecomment-234192576",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2831",
    "id": 234192576,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNDE5MjU3Ng==",
    "user": {
      "login": "brendan87",
      "id": 11881233,
      "node_id": "MDQ6VXNlcjExODgxMjMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/11881233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brendan87",
      "html_url": "https://github.com/brendan87",
      "followers_url": "https://api.github.com/users/brendan87/followers",
      "following_url": "https://api.github.com/users/brendan87/following{/other_user}",
      "gists_url": "https://api.github.com/users/brendan87/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brendan87/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brendan87/subscriptions",
      "organizations_url": "https://api.github.com/users/brendan87/orgs",
      "repos_url": "https://api.github.com/users/brendan87/repos",
      "events_url": "https://api.github.com/users/brendan87/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brendan87/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-07-21T08:42:13Z",
    "updated_at": "2016-07-21T08:42:13Z",
    "author_association": "NONE",
    "body": "I managed to get geth to accept the new genesis file after changing the config section to:\n\n```\n\"config\":{\n      \"homesteadBlock\": 5\n   }\n```\n\n(It didn't like the quotation marks around the 5)\nHowever, I still encounter the same gas limit problem (or, if setting the function to a constant function in Contract 1, nothing is returned).\nDo you think there could be any issues with updating the genesis file on an existing chain?\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/234192576/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/234203065",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2831#issuecomment-234203065",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2831",
    "id": 234203065,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNDIwMzA2NQ==",
    "user": {
      "login": "bas-vk",
      "id": 4280775,
      "node_id": "MDQ6VXNlcjQyODA3NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4280775?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bas-vk",
      "html_url": "https://github.com/bas-vk",
      "followers_url": "https://api.github.com/users/bas-vk/followers",
      "following_url": "https://api.github.com/users/bas-vk/following{/other_user}",
      "gists_url": "https://api.github.com/users/bas-vk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bas-vk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bas-vk/subscriptions",
      "organizations_url": "https://api.github.com/users/bas-vk/orgs",
      "repos_url": "https://api.github.com/users/bas-vk/repos",
      "events_url": "https://api.github.com/users/bas-vk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bas-vk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-07-21T09:28:08Z",
    "updated_at": "2016-07-21T09:28:08Z",
    "author_association": "MEMBER",
    "body": "Not sure what you mean with updating the genesis file on an existing chain?\n\nNormally if you modify the genesis block you should create a fresh private chain. This is just the homestead block number, so the genesis block should look the same. I _think_ you can just rewrite the genesis block into an existing chain but I'm not sure.\n\nI just tried your example library/contract and it runs fine with a fresh chain. `runLibFunc` should not return anything. If you want to verify if `stor1` is updated retrieve its storage.\n\nFrom the geth console:\n\n```\n> eth.getStorageAt(contractAddress, \"0x0\")\n\"0x0000000000000000000000000000000000000000000000000000000000000000\"\n```\n\ncall `runLibFunc` in a transaction, after the transaction is mined the storage should be 2.\n\n```\n> eth.getStorageAt(contractAddress, \"0x0\")\n\"0x0000000000000000000000000000000000000000000000000000000000000002\"\n```\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/234203065/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/234215004",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2831#issuecomment-234215004",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2831",
    "id": 234215004,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNDIxNTAwNA==",
    "user": {
      "login": "brendan87",
      "id": 11881233,
      "node_id": "MDQ6VXNlcjExODgxMjMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/11881233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brendan87",
      "html_url": "https://github.com/brendan87",
      "followers_url": "https://api.github.com/users/brendan87/followers",
      "following_url": "https://api.github.com/users/brendan87/following{/other_user}",
      "gists_url": "https://api.github.com/users/brendan87/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brendan87/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brendan87/subscriptions",
      "organizations_url": "https://api.github.com/users/brendan87/orgs",
      "repos_url": "https://api.github.com/users/brendan87/repos",
      "events_url": "https://api.github.com/users/brendan87/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brendan87/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-07-21T10:22:24Z",
    "updated_at": "2016-07-21T10:22:24Z",
    "author_association": "NONE",
    "body": "That's cool. I'll close it if you can get it running - it must be something on my end. I have been trying to test it on a new chain but I can't get the new chain to mine anything sadly.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/234215004/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/253303098",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/2831#issuecomment-253303098",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2831",
    "id": 253303098,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI1MzMwMzA5OA==",
    "user": {
      "login": "avatar-lavventura",
      "id": 18537398,
      "node_id": "MDQ6VXNlcjE4NTM3Mzk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/18537398?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/avatar-lavventura",
      "html_url": "https://github.com/avatar-lavventura",
      "followers_url": "https://api.github.com/users/avatar-lavventura/followers",
      "following_url": "https://api.github.com/users/avatar-lavventura/following{/other_user}",
      "gists_url": "https://api.github.com/users/avatar-lavventura/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/avatar-lavventura/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/avatar-lavventura/subscriptions",
      "organizations_url": "https://api.github.com/users/avatar-lavventura/orgs",
      "repos_url": "https://api.github.com/users/avatar-lavventura/repos",
      "events_url": "https://api.github.com/users/avatar-lavventura/events{/privacy}",
      "received_events_url": "https://api.github.com/users/avatar-lavventura/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-10-12T18:48:37Z",
    "updated_at": "2016-10-12T18:52:48Z",
    "author_association": "NONE",
    "body": "Community guided me to you @bas-vk. I am having same trouble with my Private Ethereum Blockchain. I have done @bas-vk suggestions but I am still facing with same error. Could you able to help me on my case?\nI have asked my question on ethereum stack:\nhttp://ethereum.stackexchange.com/q/9178/4575\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/253303098/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
