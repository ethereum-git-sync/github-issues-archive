{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/22567",
  "id": 839666215,
  "node_id": "MDU6SXNzdWU4Mzk2NjYyMTU=",
  "number": 22567,
  "title": "Frequent OOMs and High CPU Usage While Serving Eth Calls",
  "user": {
    "login": "nisdas",
    "id": 33201827,
    "node_id": "MDQ6VXNlcjMzMjAxODI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nisdas",
    "html_url": "https://github.com/nisdas",
    "followers_url": "https://api.github.com/users/nisdas/followers",
    "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
    "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
    "organizations_url": "https://api.github.com/users/nisdas/orgs",
    "repos_url": "https://api.github.com/users/nisdas/repos",
    "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nisdas/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    },
    {
      "id": 1132689577,
      "node_id": "MDU6TGFiZWwxMTMyNjg5NTc3",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/status:triage",
      "name": "status:triage",
      "color": "6be514",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 18,
  "created_at": "2021-03-24T12:20:42Z",
  "updated_at": "2021-10-01T00:05:44Z",
  "closed_at": "2021-03-31T09:38:49Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: `v1.10.1`\r\nOS & Version: `Linux`\r\n\r\n#### Expected behaviour\r\n\r\nAfter the geth node is synced it is able to serve and incoming `eth_calls` without any issues. \r\n\r\n#### Actual behaviour\r\n\r\nThe geth node frequently OOMs the moment it starts serving `eth_calls` , with execution taking a very long time and eventually timing out. The node is immediately killed as it OOMs with memory usage spiking to from 1gb to 10 - 12 gb in a matter of seconds. This behaviour wasn't observed in earlier releases ( 1.9.25 and earlier).\r\n  \r\n#### Steps to reproduce the behaviour\r\n\r\nRun geth with the following flags \r\n\r\n```\r\n      --v5disc\r\n      --http\r\n      --http.addr=0.0.0.0\r\n      --http.corsdomain=*\r\n      --http.vhosts=*\r\n      --ws\r\n      --ws.addr=0.0.0.0\r\n      --ws.origins=*\r\n      --datadir=/ethereum\r\n      --keystore=/keystore\r\n      --verbosity=3\r\n      --light.serve=50\r\n      --metrics\r\n      --ethstats=/ethstats_secret\r\n      --goerli\r\n      --snapshot=false\r\n      --txlookuplimit=0\r\n      --cache.preimages\r\n      --rpc.allow-unprotected-txs\r\n      --pprof\r\n```\r\n\r\nWe have reverted all the big changes from v1.10 onwards however it hasn't made a difference.\r\n\r\n#### Backtrace\r\n\r\n````\r\nINFO [03-24|11:39:23.079] Loaded local transaction journal         transactions=3130 dropped=0\r\nINFO [03-24|11:39:23.092] Regenerated local transaction journal    transactions=3130 accounts=536\r\nWARN [03-24|11:39:23.092] Switch sync mode from fast sync to full sync \r\nINFO [03-24|11:39:23.140] Unprotected transactions allowed \r\nWARN [03-24|11:39:23.141] Old unclean shutdowns found              count=141\r\nWARN [03-24|11:39:23.141] Unclean shutdown detected                booted=2021-03-24T10:59:08+0000 age=40m15s\r\nWARN [03-24|11:39:23.142] Unclean shutdown detected                booted=2021-03-24T11:04:52+0000 age=34m31s\r\nWARN [03-24|11:39:23.142] Unclean shutdown detected                booted=2021-03-24T11:10:32+0000 age=28m51s\r\nWARN [03-24|11:39:23.142] Unclean shutdown detected                booted=2021-03-24T11:14:56+0000 age=24m27s\r\nWARN [03-24|11:39:23.142] Unclean shutdown detected                booted=2021-03-24T11:18:12+0000 age=21m11s\r\nWARN [03-24|11:39:23.142] Unclean shutdown detected                booted=2021-03-24T11:21:23+0000 age=18m\r\nWARN [03-24|11:39:23.142] Unclean shutdown detected                booted=2021-03-24T11:23:03+0000 age=16m20s\r\nWARN [03-24|11:39:23.142] Unclean shutdown detected                booted=2021-03-24T11:24:49+0000 age=14m34s\r\nWARN [03-24|11:39:23.142] Unclean shutdown detected                booted=2021-03-24T11:27:13+0000 age=12m10s\r\nWARN [03-24|11:39:23.142] Unclean shutdown detected                booted=2021-03-24T11:31:47+0000 age=7m36s\r\nWARN [03-24|11:39:23.142] Unclean shutdown detected                booted=2021-03-24T11:35:22+0000 age=4m1s\r\nINFO [03-24|11:39:23.142] Allocated cache and file handles         database=/ethereum/geth/les.server        cache=16.00MiB  handles=16\r\nINFO [03-24|11:39:23.174] Configured checkpoint oracle             address=0x18CA0E045F0D772a851BC7e48357Bcaab0a0795D signers=5 threshold=2\r\nINFO [03-24|11:39:23.185] Loaded latest checkpoint                 section=136 head=\"cb1485…e62327\" chtroot=\"4fb6c4…a2b521\" bloomroot=\"443066…099a79\"\r\nINFO [03-24|11:39:23.185] Starting peer-to-peer node               instance=Geth/v1.10.1-stable-c2d2f4ed/linux-amd64/go1.16\r\nINFO [03-24|11:39:23.276] New local node record                    seq=470 id=xxxxxxxxxxxx ip=127.0.0.1 udp=30303 tcp=30303\r\nINFO [03-24|11:39:23.305] Started P2P networking                   self=enode://xxxxxxxx@127.0.0.1:30303\r\nINFO [03-24|11:39:23.306] IPC endpoint opened                      url=/ethereum/geth.ipc\r\nINFO [03-24|11:39:23.308] HTTP server started                      endpoint=[::]:8545 prefix= cors=* vhosts=*\r\nINFO [03-24|11:39:23.308] WebSocket enabled                        url=ws://[::]:8546\r\nINFO [03-24|11:39:23.308] Stats daemon started \r\nINFO [03-24|11:39:33.721] Looking for peers                        peercount=1 tried=35 static=0\r\nINFO [03-24|11:39:37.922] Block synchronisation started \r\nINFO [03-24|11:39:38.849] New local node record                    seq=471 id=xxxxxxx ip=xxxxxxxxx udp=xxxxx tcp=30303\r\nWARN [03-24|11:39:39.683] Served eth_call                          conn=127.0.0.1:49070 reqid=107580 t=6.568050388s err=\"execution aborted (timeout = 5s)\"\r\nWARN [03-24|11:39:43.317] Served eth_call                          conn=127.0.0.1:53254 reqid=1      t=10.147648933s err=\"execution aborted (timeout = 5s)\"\r\nINFO [03-24|11:39:43.987] Looking for peers                        peercount=1 tried=24 static=0\r\nWARN [03-24|11:39:46.515] Served eth_call                          conn=127.0.0.1:35870 reqid=1      t=\"559.32µs\"    err=\"execution reverted\"\r\nWARN [03-24|11:39:46.622] Served eth_call                          conn=127.0.0.1:60854 reqid=1      t=\"479.825µs\"   err=\"execution reverted\"\r\nINFO [03-24|11:39:46.683] Submitted transaction                    hash=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx from=xxxxxxxxxxxxxxxxxxxxx nonce=xxxx recipient=xxxxxxxxxxxxxxxxxx value=0\r\nWARN [03-24|11:39:47.966] Served eth_call                          conn=127.0.0.1:42870 reqid=290669 t=10.325244195s err=\"execution aborted (timeout = 5s)\"\r\nWARN [03-24|11:39:48.460] Failed to retrieve stats server message  err=\"websocket: close 1006 (abnormal closure): unexpected EOF\"\r\nWARN [03-24|11:39:51.966] Served eth_estimateGas                   conn=127.0.0.1:60412 reqid=3971546 t=5.387361441s  err=\"execution aborted (timeout = 0s)\"\r\nWARN [03-24|11:39:54.181] Full stats report failed                 err=\"use of closed network connection\"\r\n\r\n````\r\n\r\nThese are the last logs before it gets killed due to an OOM. A restart doesn't help as it goes through this whole process again and gets killed in the next few minutes again while serving an `eth_call` . While it is expected for our geth node to have higher than normal memory usage due to serving public rpc requests, this hasn't come up before for us which is the reason this issue has been opened.\r\n\r\nThis is the heap profile of geth right before it gets killed. \r\n![geth_heap](https://user-images.githubusercontent.com/33201827/112308185-d2aa4500-8cdc-11eb-95b7-ce216c4c1fa4.png)\r\n\r\n\r\nThis is the cpu profile right before it gets killed. \r\n\r\n![geth_profile](https://user-images.githubusercontent.com/33201827/112308318-fa011200-8cdc-11eb-8f0d-31f0a2fe0199.png)\r\n\r\n\r\n\r\nFrom both the above figures, it appears that serving these RPC requests causes great stress to the node, and large increases in memory usage due to encoding the response to the request.\r\n\r\nThese are the raw profiles if it will help you debug this further:\r\n\r\n[cpu_profile.pb.gz](https://github.com/ethereum/go-ethereum/files/6196982/pprof.geth.samples.cpu.002.pb.gz)\r\n\r\n[heap_profile.pb.gz](https://github.com/ethereum/go-ethereum/files/6196991/pprof.geth.alloc_objects.alloc_space.inuse_objects.inuse_space.015.pb.gz)\r\n\r\n",
  "closed_by": {
    "login": "nisdas",
    "id": 33201827,
    "node_id": "MDQ6VXNlcjMzMjAxODI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nisdas",
    "html_url": "https://github.com/nisdas",
    "followers_url": "https://api.github.com/users/nisdas/followers",
    "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
    "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
    "organizations_url": "https://api.github.com/users/nisdas/orgs",
    "repos_url": "https://api.github.com/users/nisdas/repos",
    "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nisdas/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/805787575",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-805787575",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 805787575,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNTc4NzU3NQ==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-24T12:40:26Z",
    "updated_at": "2021-03-24T12:40:26Z",
    "author_association": "MEMBER",
    "body": "We did some investigation of a similar issue here: https://github.com/ethereum/go-ethereum/issues/22529\r\nCan you provide some example eth_calls that you are running on your node?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/805787575/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/805813356",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-805813356",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 805813356,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNTgxMzM1Ng==",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-24T13:19:14Z",
    "updated_at": "2021-03-24T13:19:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "@MariusVanDerWijden These are unfortunately public rpc requests, we do not have direct control over them. The linked issue is interesting, we do have frequent `eth_getLog` requests also running through our endpoint. I tried running with trace logs, but it mostly showed `eth_getTransactionByHash` and `eth_getTransactionReceipt` in the debug logs, which matches with what has been shown in the above profile. Is there a flag that can be used to capture all the incoming rpc calls ?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/805813356/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/805830857",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-805830857",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 805830857,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNTgzMDg1Nw==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-24T13:40:54Z",
    "updated_at": "2021-03-24T13:40:54Z",
    "author_association": "MEMBER",
    "body": "Unfortunately there's no such flag. I'll take a look at your memdumps now",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/805830857/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/805869167",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-805869167",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 805869167,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNTg2OTE2Nw==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-24T14:30:07Z",
    "updated_at": "2021-03-24T14:30:07Z",
    "author_association": "MEMBER",
    "body": "Yeah so what I think happens is that someone tries to use your node for fronrunning/backrunning. There are a lot of `eth_getTransaction` and `eth_getTransactionReceipt` calls. The return data for these calls are pretty huge and thus are compressed using gzip. Gzip internally uses a flate compression. This compression is pretty memory intensive, see also https://github.com/golang/go/issues/32371. Since the GzipWriter is closed after every request, the memory for the flate compression has to be allocated anew on every request. I think can use `writer.Flush()` instead of `write.Close` which might improve memory consumption a bit, but I have to look into it further",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/805869167/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/805873164",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-805873164",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 805873164,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNTg3MzE2NA==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-24T14:35:17Z",
    "updated_at": "2021-03-24T14:35:17Z",
    "author_association": "MEMBER",
    "body": "Yeah nvm we can not use `writer.Flush()` instead of `writer.Close()`\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/805873164/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/805877639",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-805877639",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 805877639,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNTg3NzYzOQ==",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-24T14:41:11Z",
    "updated_at": "2021-03-24T14:41:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for looking into it, that explains the constant OOMs that we do see. However, do you know if there was any PR in the update to v1.10.x that might have made this worse ? We werent having issues with v1.9.25, while this came up almost immediately while we updated to v1.10.1",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/805877639/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/805894627",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-805894627",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 805894627,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNTg5NDYyNw==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-24T15:01:01Z",
    "updated_at": "2021-03-24T15:22:03Z",
    "author_association": "MEMBER",
    "body": "Not sure, It could also be something that changed within the standard library between go versions. \r\nAs a super quick fix, you could drop all requests that have `accept-encoding gzip` in their header\r\n\r\nSo flate allocates 2^16 bytes on every call to `initDeflate` and another 4*2^15+1 bytes, resulting in 196612 bytes per `init` or ~192kb.\r\nMore memory is also retained by the writer object which has a compressor struct within that has two uint32 slices with 2^17 and 2^15 elements, thus another 655360 bytes. \r\n```\r\nROUTINE ======================== compress/flate.NewWriter in compress/flate/deflate.go\r\n  610.83MB   752.18MB (flat, cum) 42.00% of Total\r\n         .          .    665:// compression efficiency.\r\n         .          .    666://\r\n         .          .    667:// If level is in the range [-2, 9] then the error returned will be nil.\r\n         .          .    668:// Otherwise the error returned will be non-nil.\r\n         .          .    669:func NewWriter(w io.Writer, level int) (*Writer, error) {\r\n  610.83MB   610.83MB    670:\tvar dw Writer\r\n         .   141.35MB    671:\tif err := dw.d.init(w, level); err != nil {\r\n         .          .    672:\t\treturn nil, err\r\n         .          .    673:\t}\r\n         .          .    674:\treturn &dw, nil\r\n         .          .    675:}\r\n```\r\n```\r\n  138.85MB   138.85MB (flat, cum)  7.75% of Total\r\n         .          .    367:\td.err = d.w.err\r\n         .          .    368:\td.windowEnd = 0\r\n         .          .    369:}\r\n         .          .    370:\r\n         .          .    371:func (d *compressor) initDeflate() {\r\n   65.96MB    65.96MB    372:\td.window = make([]byte, 2*windowSize)\r\n         .          .    373:\td.hashOffset = 1\r\n   72.89MB    72.89MB    374:\td.tokens = make([]token, 0, maxFlateBlockTokens+1)\r\n         .          .    375:\td.length = minMatchLength - 1\r\n         .          .    376:\td.offset = 0\r\n         .          .    377:\td.byteAvailable = false\r\n         .          .    378:\td.index = 0\r\n         .          .    379:\td.hash = 0\r\n```\r\n\r\nThis means we allocate (only for compression) roughly 1 MB of data.\r\n```\r\nb.Run(\"gzip2\", func(b *testing.B) {\r\n\t\t\tb.ReportAllocs()\r\n\t\t\tbb := &bytes.Buffer{}\r\n\t\t\tfor i := 0; i < b.N; i++ {\r\n\t\t\t\tw := gzip.NewWriter(nil)\r\n\t\t\t\tw.Reset(bb)\r\n\t\t\t\tw.Write([]byte{0x00})\r\n\t\t\t\tw.Close()\r\n\t\t\t}\r\n\t\t})\r\n\r\nBenchmarkCompress/writer/gzip2-16   \t    6040\t    186304 ns/op\t  813977 B/op\t      18 allocs/op\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/805894627/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/806865197",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-806865197",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 806865197,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNjg2NTE5Nw==",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-25T14:36:33Z",
    "updated_at": "2021-03-25T14:36:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "That would make sense, as a short term solution we can drop gzip requests. Although I looked at the implementation and we do use a sync pool to store the relevant gzip writers. So these writers are re-used for the most part or at least should be for the next few rpc requests (with gzip). The fact that even with the re-use of older writers, memory usage spikes very quickly seems odd. Is there any flag I can use to debug this further ?  ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/806865197/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/806976475",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-806976475",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 806976475,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNjk3NjQ3NQ==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-25T15:44:39Z",
    "updated_at": "2021-03-25T15:57:32Z",
    "author_association": "MEMBER",
    "body": "Not really, but you can always dump the current memory with `debug.writeMemProfile(\"file\")` in the console. \r\nYeah my hunch is that something prevents the GC from deleting the objects from the sync pool once they are not used anymore.\r\n\r\nEdit: What would really help would be if we had more information about the calls that get executed",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/806976475/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/807093508",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-807093508",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 807093508,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNzA5MzUwOA==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-25T16:56:20Z",
    "updated_at": "2021-03-25T16:56:20Z",
    "author_association": "MEMBER",
    "body": "@nisdas I made a test fix here: https://github.com/MariusVanDerWijden/go-ethereum/tree/rpc-test maybe you can try running this and see if the memory blowup still persists",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/807093508/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/807974457",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-807974457",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 807974457,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNzk3NDQ1Nw==",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-26T06:32:19Z",
    "updated_at": "2021-03-26T06:32:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Edit: What would really help would be if we had more information about the calls that get executed\r\n\r\nLet me see what I can do, we can try to capture all the incoming requests and see which one of them are responsible for the blowups. \r\n\r\n> @nisdas I made a test fix here: https://github.com/MariusVanDerWijden/go-ethereum/tree/rpc-test maybe you can try running this and see if the memory blowup still persists\r\n\r\nGreat thanks ! Will give this a shot\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/807974457/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/810422350",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-810422350",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 810422350,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxMDQyMjM1MA==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-30T16:57:10Z",
    "updated_at": "2021-03-30T16:57:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "Here's a brief log of requests made to our nodes. [requests.log.gz](https://github.com/ethereum/go-ethereum/files/6230784/requests.log.gz) These requests were captured across a span of less than 5 minutes. It seems that someone is abusing our endpoint to run swarm Bee nodes, or something similar to that.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/810422350/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/810792511",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-810792511",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 810792511,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxMDc5MjUxMQ==",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-31T06:04:44Z",
    "updated_at": "2021-03-31T06:05:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "@MariusVanDerWijden From the above posted logs, it does seem to be some users running a swarm bee node and requesting a lot of transactions by hash. Would the newly introduced change of transaction unindexing have an effect over here ? We initially ran our nodes without any special flags, but after having difficulties keeping it up we added in these flags :\r\n```\r\n--snapshot=false \r\n--txlookuplimit=0 \r\n--cache.preimages \r\n--rpc.allow-unprotected-txs \r\n```  \r\n\r\nSo the transaction re-indexing was introduced later. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/810792511/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/810880804",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-810880804",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 810880804,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxMDg4MDgwNA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-31T08:27:36Z",
    "updated_at": "2021-03-31T08:28:47Z",
    "author_association": "MEMBER",
    "body": "From that request-log, `152108`  calls to `eth_getTransactionByHash`, and `52706` to `eth_getTransactionReceipt`. If the `txlookup` does not cover the txhash, then it should exit pretty quickly -- but each one causes a db lookup. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/810880804/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/810927337",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-810927337",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 810927337,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxMDkyNzMzNw==",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-31T09:38:49Z",
    "updated_at": "2021-03-31T09:38:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "That makes sense, would explain the largely increased CPU usage here. Each transaction hits the db, so leads to a db lookup + deserialization from RLP. Although not sure, why it only became an issue on v1.10.x for us, but from what we have captured it does look like the large amount of external rpc requests here are the main issue. We should be either dropping or rate limiting them. I will be closing the issue now unless something else pops up on our end. Thanks for helping us investigate this issue @MariusVanDerWijden @holiman .",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/810927337/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/871101534",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-871101534",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 871101534,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3MTEwMTUzNA==",
    "user": {
      "login": "binhgo",
      "id": 10021934,
      "node_id": "MDQ6VXNlcjEwMDIxOTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/10021934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/binhgo",
      "html_url": "https://github.com/binhgo",
      "followers_url": "https://api.github.com/users/binhgo/followers",
      "following_url": "https://api.github.com/users/binhgo/following{/other_user}",
      "gists_url": "https://api.github.com/users/binhgo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/binhgo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/binhgo/subscriptions",
      "organizations_url": "https://api.github.com/users/binhgo/orgs",
      "repos_url": "https://api.github.com/users/binhgo/repos",
      "events_url": "https://api.github.com/users/binhgo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/binhgo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-30T05:12:46Z",
    "updated_at": "2021-06-30T05:12:46Z",
    "author_association": "NONE",
    "body": "hey guys, any update for the CPU consuming here? I am also face the same issues, the CPU is very high, 80-90% of the server. I am using 8 core and 32gb RAM and 700SSD now\r\n\r\n@nisdas do you have solution for this yet?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/871101534/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/871434958",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-871434958",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 871434958,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3MTQzNDk1OA==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-30T14:05:01Z",
    "updated_at": "2021-06-30T14:05:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "@binhgo Our solution was to terminate our public API offering. The root cause was abuse of our free service for the goerli testnet.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/871434958/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/931790651",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22567#issuecomment-931790651",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22567",
    "id": 931790651,
    "node_id": "IC_kwDOAOvK9843if87",
    "user": {
      "login": "lurchinms",
      "id": 12227665,
      "node_id": "MDQ6VXNlcjEyMjI3NjY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/12227665?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lurchinms",
      "html_url": "https://github.com/lurchinms",
      "followers_url": "https://api.github.com/users/lurchinms/followers",
      "following_url": "https://api.github.com/users/lurchinms/following{/other_user}",
      "gists_url": "https://api.github.com/users/lurchinms/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lurchinms/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lurchinms/subscriptions",
      "organizations_url": "https://api.github.com/users/lurchinms/orgs",
      "repos_url": "https://api.github.com/users/lurchinms/repos",
      "events_url": "https://api.github.com/users/lurchinms/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lurchinms/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-01T00:05:44Z",
    "updated_at": "2021-10-01T00:05:44Z",
    "author_association": "NONE",
    "body": "I am running the same issue.....\r\n![ETH_Node](https://user-images.githubusercontent.com/12227665/135546387-24a87c7c-f0cb-42f8-a1d5-76102cf25111.jpg)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/931790651/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
