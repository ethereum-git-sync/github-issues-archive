{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24203",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24203/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24203/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24203/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/24203",
  "id": 1094721593,
  "node_id": "I_kwDOAOvK985BQCA5",
  "number": 24203,
  "title": "[Clef] Don't close process if trying to connect with wrong address",
  "user": {
    "login": "tmm360",
    "id": 7620704,
    "node_id": "MDQ6VXNlcjc2MjA3MDQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7620704?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tmm360",
    "html_url": "https://github.com/tmm360",
    "followers_url": "https://api.github.com/users/tmm360/followers",
    "following_url": "https://api.github.com/users/tmm360/following{/other_user}",
    "gists_url": "https://api.github.com/users/tmm360/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tmm360/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tmm360/subscriptions",
    "organizations_url": "https://api.github.com/users/tmm360/orgs",
    "repos_url": "https://api.github.com/users/tmm360/repos",
    "events_url": "https://api.github.com/users/tmm360/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tmm360/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-01-05T20:32:28Z",
  "updated_at": "2022-01-10T07:21:19Z",
  "closed_at": "2022-01-10T07:21:18Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nI'm using Clef from Bee-Clef derivation with Docker. I've reported original issue here (https://github.com/ethersphere/bee-clef/issues/56), and I've been redirected on this repo.\r\n\r\n#### Expected behaviour\r\n\r\nWhen I try to ask to Clef an address, if the address is not recognized and error have to be reported, but process doesn't have to terminate.\r\n\r\n#### Actual behaviour\r\n\r\nThe process terminate after the error {{Key does not exist}}.\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\nI'm trying to use Bee-Clef with multiple addresses. For unknown issue, an address was not recognized, and this showed the issue.\r\n\r\n#### Backtrace\r\n\r\n````\r\nINFO [01-02|23:28:23.208] Using stdin/stdout as UI-channel\r\nINFO [01-02|23:28:23.778] Loaded 4byte database                    embeds=146,841 locals=8 local=/app/config/4byte.json\r\n{\"jsonrpc\":\"2.0\",\"id\":1,\"method\":\"ui_onInputRequired\",\"params\":[{\"title\":\"Master Password\",\"prompt\":\"Please enter the password to decrypt the master seed\",\"isPassword\":true}]}\r\nINFO [01-02|23:28:26.065] Rule engine configured                   file=/app/config/rules.js\r\nINFO [01-02|23:28:26.065] Starting signer                          chainid=100 keystore=/app/data/keystore light-kdf=true advanced=false\r\nINFO [01-02|23:28:26.094] HTTP endpoint opened                     url=http://[::]:8550/\r\n{\"jsonrpc\":\"2.0\",\"method\":\"ui_onSignerStartup\",\"params\":[{\"info\":{\"extapi_http\":\"http://[::]:8550/\",\"extapi_ipc\":\"n/a\",\"extapi_version\":\"6.1.0\",\"intapi_version\":\"7.0.1\"}}]}\r\nINFO [01-02|23:28:28.593] Op approved\r\nINFO [01-02|23:28:28.611] Op approved\r\nINFO [01-02|23:28:29.362] Op approved\r\nINFO [01-02|23:28:29.380] Op approved\r\nWARN [01-02|23:28:29.380] Key does not exist                       key=0x *************MyEtherAddress***************\r\n````\r\nprocess killed here.",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24203/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24203/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1006611734",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/24203#issuecomment-1006611734",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24203",
    "id": 1006611734,
    "node_id": "IC_kwDOAOvK9847_60W",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-06T13:58:03Z",
    "updated_at": "2022-01-06T13:58:03Z",
    "author_association": "MEMBER",
    "body": "Could you share exactly what and how you're running? How ar eyou requesting these keys from Clef?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1006611734/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1006817642",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/24203#issuecomment-1006817642",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24203",
    "id": 1006817642,
    "node_id": "IC_kwDOAOvK9848AtFq",
    "user": {
      "login": "tmm360",
      "id": 7620704,
      "node_id": "MDQ6VXNlcjc2MjA3MDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7620704?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tmm360",
      "html_url": "https://github.com/tmm360",
      "followers_url": "https://api.github.com/users/tmm360/followers",
      "following_url": "https://api.github.com/users/tmm360/following{/other_user}",
      "gists_url": "https://api.github.com/users/tmm360/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tmm360/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tmm360/subscriptions",
      "organizations_url": "https://api.github.com/users/tmm360/orgs",
      "repos_url": "https://api.github.com/users/tmm360/repos",
      "events_url": "https://api.github.com/users/tmm360/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tmm360/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-06T18:28:07Z",
    "updated_at": "2022-01-06T18:28:07Z",
    "author_association": "NONE",
    "body": "I was running bee-clef with docker-compose as this:\r\n\r\n```\r\n  bee-clef:\r\n    image: ethersphere/clef:0.9.0\r\n    environment:\r\n      - CLEF_CHAINID=100\r\n    networks:\r\n      - bee-back\r\n    volumes:\r\n      - bee-clef-data:/app/data\r\n    command: full\r\n    restart: unless-stopped\r\n```\r\n\r\nso I was trying to connect with a swarm bee instance, with a service like this:\r\n\r\n```\r\n  bee1:\r\n    image: ethersphere/bee:1.4.1\r\n    restart: unless-stopped\r\n    environment:\r\n      - BEE_CLEF_SIGNER_ENABLE=true\r\n      - BEE_CLEF_SIGNER_ENDPOINT=http://bee-clef:8550\r\n      - BEE_DEBUG_API_ENABLE=true\r\n      - BEE_GATEWAY_MODE=true\r\n      - BEE_GLOBAL_PINNING_ENABLE=true\r\n      - BEE_FULL_NODE=true\r\n      - BEE_NETWORK_ID=1 #mainnet\r\n      - BEE_PASSWORD=mypsw\r\n      - BEE_SWAP_ENDPOINT=ws://nethermind-xdai:8545\r\n    ports:\r\n      - 1634:1634 #p2p\r\n    networks:\r\n      - bee-back\r\n    volumes:\r\n      - bee1-data:/home/bee/.bee\r\n    command: start --clef-signer-ethereum-address=0x*************MyEtherAddress***************\r\n    depends_on:\r\n      - bee-clef\r\n      - nethermind-xdai\r\n```\r\n\r\nwhen bee tries to connect to clef, if the address is recognized it works. If it is not recognized, the docker container restarts.\r\n(Bee is also connected to a Nethermind instance synced on Gnosis Chain. Omitted because not relevant)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1006817642/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1007263277",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/24203#issuecomment-1007263277",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24203",
    "id": 1007263277,
    "node_id": "IC_kwDOAOvK9848CZ4t",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-07T09:33:18Z",
    "updated_at": "2022-01-07T09:34:40Z",
    "author_association": "MEMBER",
    "body": "Clef does not exit/crash if something is attempted with an account that does not exist. It does, however, return a json rpc error. You're using ethersphere bee-clef, which afaict is wrapping clef with this script: https://github.com/ethersphere/bee-clef/blob/master/packaging/docker/entrypoint.sh . I suspect that this wrapper doesn't properly handle error conditions, which causes the docker script, and thus the docker image, to exit. \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1007263277/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1008598332",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/24203#issuecomment-1008598332",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/24203",
    "id": 1008598332,
    "node_id": "IC_kwDOAOvK9848Hf08",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-10T07:21:18Z",
    "updated_at": "2022-01-10T07:21:18Z",
    "author_association": "MEMBER",
    "body": "This has been answered in https://github.com/ethersphere/bee-clef/issues/56#issuecomment-1008350090 . If the password cannot be provided by the storage, clef sends a query to the next UI, to ask for the password. The bee-script does not handle the message coming over stdin, and exits. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1008598332/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
