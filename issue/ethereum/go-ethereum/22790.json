{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22790",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22790/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22790/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22790/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/22790",
  "id": 872843761,
  "node_id": "MDU6SXNzdWU4NzI4NDM3NjE=",
  "number": 22790,
  "title": "eth_getTransactionReceipt returns null",
  "user": {
    "login": "tanmaster",
    "id": 3981445,
    "node_id": "MDQ6VXNlcjM5ODE0NDU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3981445?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tanmaster",
    "html_url": "https://github.com/tanmaster",
    "followers_url": "https://api.github.com/users/tanmaster/followers",
    "following_url": "https://api.github.com/users/tanmaster/following{/other_user}",
    "gists_url": "https://api.github.com/users/tanmaster/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tanmaster/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tanmaster/subscriptions",
    "organizations_url": "https://api.github.com/users/tanmaster/orgs",
    "repos_url": "https://api.github.com/users/tanmaster/repos",
    "events_url": "https://api.github.com/users/tanmaster/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tanmaster/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2021-04-30T16:40:36Z",
  "updated_at": "2021-08-02T11:22:28Z",
  "closed_at": "2021-05-05T12:35:41Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: `>=1.10.0`\r\nOS & Version: Linux 5.4.0-54-generic\r\nCommit hash : (if `develop`)\r\n\r\nWhen using the `eth_getTransactionReceipt` command over the RPC interface it results in null from version 1.10.0 onwards.\r\n\r\n#### Expected behaviour\r\n\r\nWhen issuing the following command over the JSON RPC interface\r\n```{\"id\": 1, \"method\": \"eth_getTransactionReceipt\", \"params\": [\"0x5c504ed432cb51138bcf09aa5e8a410dd4a1e204ef84bfed1be16dfba1b22060\"]}```\r\n\r\nI expect the following result:\r\n\r\n```{\"jsonrpc\":\"2.0\",\"id\":1,\"result\":{\"blockHash\":\"0x4e3a3754410177e6937ef1f84bba68ea139e8d1a2258c5f85db9f1cd715a1bdd\",\"blockNumber\":\"0xb443\",\"contractAddress\":null,\"cumulativeGasUsed\":\"0x5208\",\"from\":\"0xa1e4380a3b1f749673e270229993ee55f35663b4\",\"gasUsed\":\"0x5208\",\"logs\":[],\"logsBloom\":\"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"root\":\"0x96a8e009d2b88b1483e6941e6812e32263b05683fac202abc622a3e31aed1957\",\"to\":\"0x5df9b87991262f6ba471f09758cde1c0fc1de734\",\"transactionHash\":\"0x5c504ed432cb51138bcf09aa5e8a410dd4a1e204ef84bfed1be16dfba1b22060\",\"transactionIndex\":\"0x0\"}}```\r\n\r\n\r\n#### Actual behaviour\r\n\r\nThe result under >=1.10.0 is:\r\n\r\n`{\"jsonrpc\":\"2.0\",\"id\":1,\"result\":null}`\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\nThe easiest way to reproduce is to create a new db by specifying a new datadir:\r\n\r\n```\r\ngit checkout tags/v1.10.0\r\nmake geth && ./build/bin/geth --datadir='./ethereum1.10.0/'\r\n# let this sync till block ~47k\r\n`nc -U geth.ipc`\r\n# issue command > result is null\r\n```\r\n\r\n\r\n```\r\ngit checkout tags/v1.9.25\r\nmake geth && ./build/bin/geth --datadir='./ethereum1.9.25/'\r\n# let this sync till block ~47k\r\n`nc -U geth.ipc`\r\n# issue command > result is correct\r\n```\r\n\r\n\r\n#### Further info\r\nWhen at first starting the node with version 1.9.25 and letting it sync till block ~47k, then compiling v1.10.0 and starting it with the same datadir as 1.9.25, the RPC command will return the correct result. However, after a while (I dont know how long, but eventually), the result of the RPC request will again be null. Without knowing, my guess would be that geth does some background processing to the chaindata at some point of time. Downgrading back to 1.9.25 (and using again the same datadir) does then not fix the issue, at least not in the first couple minutes of running it. \r\n\r\nMaybe I should also add that I have a fully synced node running on  1.10.2 where this problem persists, so it's not a matter of synchronization progress. \r\n\r\nI hope I was able to explain the problem precisely.\r\n\r\n\r\n\r\n",
  "closed_by": {
    "login": "tanmaster",
    "id": 3981445,
    "node_id": "MDQ6VXNlcjM5ODE0NDU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3981445?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tanmaster",
    "html_url": "https://github.com/tanmaster",
    "followers_url": "https://api.github.com/users/tanmaster/followers",
    "following_url": "https://api.github.com/users/tanmaster/following{/other_user}",
    "gists_url": "https://api.github.com/users/tanmaster/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tanmaster/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tanmaster/subscriptions",
    "organizations_url": "https://api.github.com/users/tanmaster/orgs",
    "repos_url": "https://api.github.com/users/tanmaster/repos",
    "events_url": "https://api.github.com/users/tanmaster/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tanmaster/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22790/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22790/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/832324048",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22790#issuecomment-832324048",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22790",
    "id": 832324048,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzMjMyNDA0OA==",
    "user": {
      "login": "Neurone",
      "id": 562943,
      "node_id": "MDQ6VXNlcjU2Mjk0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/562943?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Neurone",
      "html_url": "https://github.com/Neurone",
      "followers_url": "https://api.github.com/users/Neurone/followers",
      "following_url": "https://api.github.com/users/Neurone/following{/other_user}",
      "gists_url": "https://api.github.com/users/Neurone/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Neurone/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Neurone/subscriptions",
      "organizations_url": "https://api.github.com/users/Neurone/orgs",
      "repos_url": "https://api.github.com/users/Neurone/repos",
      "events_url": "https://api.github.com/users/Neurone/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Neurone/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-04T23:42:46Z",
    "updated_at": "2021-05-04T23:42:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "geth 1.10.0 introduced the [Transaction unindexing feature](https://blog.ethereum.org/2021/03/03/geth-v1-10-0/), it is activated by default. Maybe is it that? Try to pass `--txlookuplimit=0` and check the result.\r\n\r\n> Can we shave some - for us - useless data off of our nodes? Yes! Geth v1.10.0 switches on transaction unindexing by default and sets it to 2,350,000 blocks (about 1 year). The transaction unindexer will linger in the background, and every time a new block arrives, it ensures that only transactions from the most recent N blocks are indexed, deleting older ones. If a user decides they want access to older transactions, they can restart Geth with a higher --txlookuplimit value, and any blocks missing from the updated range will be reindexed (note, the trigger is still block import, you have to wait for 1 new block).\r\n> \r\n> Since about 1/3rd of Ethereum’s transaction load happened in 2020, keeping an entire year’s worth of transaction index will still have a noticeable weight on the database. The goal of transaction unindexing is not to remove an existing feature in the name of saving space. The goal is to move towards a mode of operation where space does not grow indefinitely with chain history.\r\n> \r\n> If you wish to disable transaction unindexing altogether, you can run Geth with --txlookuplimit=0, which reverts to the old behavior of retaining the lookup map for every transaction since genesis.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/832324048/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/832651526",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22790#issuecomment-832651526",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22790",
    "id": 832651526,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzMjY1MTUyNg==",
    "user": {
      "login": "tanmaster",
      "id": 3981445,
      "node_id": "MDQ6VXNlcjM5ODE0NDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3981445?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tanmaster",
      "html_url": "https://github.com/tanmaster",
      "followers_url": "https://api.github.com/users/tanmaster/followers",
      "following_url": "https://api.github.com/users/tanmaster/following{/other_user}",
      "gists_url": "https://api.github.com/users/tanmaster/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tanmaster/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tanmaster/subscriptions",
      "organizations_url": "https://api.github.com/users/tanmaster/orgs",
      "repos_url": "https://api.github.com/users/tanmaster/repos",
      "events_url": "https://api.github.com/users/tanmaster/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tanmaster/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-05T12:35:41Z",
    "updated_at": "2021-05-05T12:35:41Z",
    "author_association": "NONE",
    "body": "> geth 1.10.0 introduced the [Transaction unindexing feature](https://blog.ethereum.org/2021/03/03/geth-v1-10-0/), it is activated by default. Maybe is it that? Try to pass `--txlookuplimit=0` and check the result.\r\n\r\nThanks a lot, it was exactly that! Next time I'll read the change logs before posting a question! \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/832651526/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/890673194",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22790#issuecomment-890673194",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22790",
    "id": 890673194,
    "node_id": "IC_kwDOAOvK9841Fpgq",
    "user": {
      "login": "xloem",
      "id": 279585,
      "node_id": "MDQ6VXNlcjI3OTU4NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/279585?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xloem",
      "html_url": "https://github.com/xloem",
      "followers_url": "https://api.github.com/users/xloem/followers",
      "following_url": "https://api.github.com/users/xloem/following{/other_user}",
      "gists_url": "https://api.github.com/users/xloem/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xloem/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xloem/subscriptions",
      "organizations_url": "https://api.github.com/users/xloem/orgs",
      "repos_url": "https://api.github.com/users/xloem/repos",
      "events_url": "https://api.github.com/users/xloem/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xloem/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-02T02:58:31Z",
    "updated_at": "2021-08-02T02:58:31Z",
    "author_association": "NONE",
    "body": "Is there any way to work around this when running a light node, to get receipts for historical transactions?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/890673194/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/890819155",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22790#issuecomment-890819155",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22790",
    "id": 890819155,
    "node_id": "IC_kwDOAOvK9841GNJT",
    "user": {
      "login": "Neurone",
      "id": 562943,
      "node_id": "MDQ6VXNlcjU2Mjk0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/562943?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Neurone",
      "html_url": "https://github.com/Neurone",
      "followers_url": "https://api.github.com/users/Neurone/followers",
      "following_url": "https://api.github.com/users/Neurone/following{/other_user}",
      "gists_url": "https://api.github.com/users/Neurone/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Neurone/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Neurone/subscriptions",
      "organizations_url": "https://api.github.com/users/Neurone/orgs",
      "repos_url": "https://api.github.com/users/Neurone/repos",
      "events_url": "https://api.github.com/users/Neurone/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Neurone/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-02T08:12:41Z",
    "updated_at": "2021-08-02T08:12:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "I don't think so. As a light client, you relay on the data stored by the full node, so there's no way to do that but connecting to another full node actually storing historical transactions you need.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/890819155/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/890946585",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22790#issuecomment-890946585",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22790",
    "id": 890946585,
    "node_id": "IC_kwDOAOvK9841GsQZ",
    "user": {
      "login": "xloem",
      "id": 279585,
      "node_id": "MDQ6VXNlcjI3OTU4NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/279585?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xloem",
      "html_url": "https://github.com/xloem",
      "followers_url": "https://api.github.com/users/xloem/followers",
      "following_url": "https://api.github.com/users/xloem/following{/other_user}",
      "gists_url": "https://api.github.com/users/xloem/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xloem/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xloem/subscriptions",
      "organizations_url": "https://api.github.com/users/xloem/orgs",
      "repos_url": "https://api.github.com/users/xloem/repos",
      "events_url": "https://api.github.com/users/xloem/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xloem/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-02T11:22:28Z",
    "updated_at": "2021-08-02T11:22:28Z",
    "author_association": "NONE",
    "body": "Thank you.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/890946585/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
