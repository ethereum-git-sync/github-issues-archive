{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1087",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1087/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1087/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1087/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/1087",
  "id": 80225575,
  "node_id": "MDU6SXNzdWU4MDIyNTU3NQ==",
  "number": 1087,
  "title": "panic on addPeer() if client started with --maxpeers 0",
  "user": {
    "login": "zelig",
    "id": 769725,
    "node_id": "MDQ6VXNlcjc2OTcyNQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/769725?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/zelig",
    "html_url": "https://github.com/zelig",
    "followers_url": "https://api.github.com/users/zelig/followers",
    "following_url": "https://api.github.com/users/zelig/following{/other_user}",
    "gists_url": "https://api.github.com/users/zelig/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/zelig/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/zelig/subscriptions",
    "organizations_url": "https://api.github.com/users/zelig/orgs",
    "repos_url": "https://api.github.com/users/zelig/repos",
    "events_url": "https://api.github.com/users/zelig/events{/privacy}",
    "received_events_url": "https://api.github.com/users/zelig/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2015-05-24T17:59:43Z",
  "updated_at": "2015-05-26T21:34:37Z",
  "closed_at": "2015-05-26T21:34:36Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "We should be able to start the p2p server with 0 dynamic peers and add static or forced peers. \nBut at the moment maxpeers 0 has the effect that the p2p server is not started and therefore adding a peer on the console or script will result in a panic on a non-initialised map.\np2p.Server.AddPeer should check if map is nil or Start the server. \nMaybe a nicer solution is to have an explicit cli option to disable the network and keep maxpeers=0 with its intended semantics: zero dynamic peers.\n\n```\ngeth --maxpeers 0 js <(echo \"admin.addPeer('enode://89d7a76cb0d1b48f51d5e809c267ea9d6657438ad8710386375c7e235f72ccd955410896a21826059ad8cc818d728bbaf51d1802178adcda859afaf5e649f731@92.234.60.25:30301')\")\n...\npanic: assignment to entry in nil map [recovered]\n        panic: assignment to entry in nil map\ngoroutine 110 [running]:\ngithub.com/robertkrimen/otto.func·024()\n        /Users/tron/Work/ethereum/go-ethereum/Godeps/_workspace/src/github.com/robertkrimen/otto/error.go:240 +0x5c7\ngithub.com/ethereum/go-ethereum/p2p.(*Server).AddPeer(0xc2080f4000, 0xc20a1cee00)\n        /Users/tron/Work/ethereum/go/src/github.com/ethereum/go-ethereum/p2p/server.go:159 +0xb5\ngithub.com/ethereum/go-ethereum/eth.(*Ethereum).AddPeer(0xc208214580, 0xc20a136dcf, 0x9b, 0x0, 0x0)\n        /Users/tron/Work/ethereum/go/src/github.com/ethereum/go-ethereum/eth/backend.go:563 +0x16e\nmain.(*jsre).addPeer(0xc208ab1e60, 0xc2080da840, 0x0, 0x0, 0x5, 0x489d140, 0xc209f74a80, 0xc20a16dde0, 0x1, 0x1, ...)\n        /Users/tron/Work/ethereum/go/src/github.com/ethereum/go-ethereum/cmd/geth/admin.go:416 +0x27d\nmain.*jsre.(main.addPeer)·fm(0xc2080da840, 0x0, 0x0, 0x5, 0x489d140, 0xc209f74a80, 0xc20a16dde0, 0x1, 0x1, 0xc208b76df0, ...)\n...\n```\n",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1087/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1087/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/105215304",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/1087#issuecomment-105215304",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1087",
    "id": 105215304,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNTIxNTMwNA==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-05-25T11:40:33Z",
    "updated_at": "2015-05-25T11:40:33Z",
    "author_association": "MEMBER",
    "body": "There is a big PR coming in with dialler fixes that will most definitely affect maxpeers too. I don't know if this issue is still present in that new code, but I'll try to check it.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/105215304/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/105227278",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/1087#issuecomment-105227278",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1087",
    "id": 105227278,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNTIyNzI3OA==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-05-25T12:47:16Z",
    "updated_at": "2015-05-25T12:47:16Z",
    "author_association": "MEMBER",
    "body": "```\n                                                                                  This has not been addressed. AddPeer will hang indefinitely in the new code because it'll block on two nil channels. We'll fix this after the big PR.\n```\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/105227278/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/105455297",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/1087#issuecomment-105455297",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1087",
    "id": 105455297,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNTQ1NTI5Nw==",
    "user": {
      "login": "zelig",
      "id": 769725,
      "node_id": "MDQ6VXNlcjc2OTcyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/769725?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zelig",
      "html_url": "https://github.com/zelig",
      "followers_url": "https://api.github.com/users/zelig/followers",
      "following_url": "https://api.github.com/users/zelig/following{/other_user}",
      "gists_url": "https://api.github.com/users/zelig/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zelig/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zelig/subscriptions",
      "organizations_url": "https://api.github.com/users/zelig/orgs",
      "repos_url": "https://api.github.com/users/zelig/repos",
      "events_url": "https://api.github.com/users/zelig/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zelig/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-05-26T08:59:22Z",
    "updated_at": "2015-05-26T08:59:22Z",
    "author_association": "MEMBER",
    "body": "@fjl can we please have\n- forced peers (non-dynamic, connects irrespective of maxpeers, but non-static = not retried)\n- option to switch off discovery (will this happen with `--bootnodes=\"\"` \n- maxpeers=0 should be allowed = 0 dynamic peers this could also mean no discovery\n- option to switch off p2p/networking entirely\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/105455297/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/105465945",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/1087#issuecomment-105465945",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1087",
    "id": 105465945,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNTQ2NTk0NQ==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-05-26T09:35:35Z",
    "updated_at": "2015-05-26T09:35:35Z",
    "author_association": "MEMBER",
    "body": "@zelig \n- What is your use case for _forced_ peers?\n- This will be done, but probably a separate flag. Disabling needs to be done at 3 different conceptual places, the bootnodes are only one. Using the bootnodes flag for this would be very very ambiguous. We'll have this in after the dialer PR.\n- maxpeer == 0 panic is a bug. It will be fixed.\n- Why do you want to switch of p2p?\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/105465945/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/105479535",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/1087#issuecomment-105479535",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1087",
    "id": 105479535,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNTQ3OTUzNQ==",
    "user": {
      "login": "zelig",
      "id": 769725,
      "node_id": "MDQ6VXNlcjc2OTcyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/769725?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zelig",
      "html_url": "https://github.com/zelig",
      "followers_url": "https://api.github.com/users/zelig/followers",
      "following_url": "https://api.github.com/users/zelig/following{/other_user}",
      "gists_url": "https://api.github.com/users/zelig/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zelig/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zelig/subscriptions",
      "organizations_url": "https://api.github.com/users/zelig/orgs",
      "repos_url": "https://api.github.com/users/zelig/repos",
      "events_url": "https://api.github.com/users/zelig/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zelig/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-05-26T10:20:37Z",
    "updated_at": "2015-05-26T10:21:23Z",
    "author_association": "MEMBER",
    "body": "- bzz\n- agreed (I just thought i saw it mentioned by @fjl somewhere very recently that you want `--bootnodes=\"\"` to mean this, I cannot find this now)s\n- the panic should be fixed but in a way that allows 0 maxpeers (if i allow 0 in eth/backend and still start p2p.server, p2p still stops with a fatal error, so it needs to be allowed there too.\n- for testing contracts and transaction with private mining etc\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/105479535/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/105600832",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/1087#issuecomment-105600832",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1087",
    "id": 105600832,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNTYwMDgzMg==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-05-26T16:53:21Z",
    "updated_at": "2015-05-26T16:53:21Z",
    "author_association": "MEMBER",
    "body": "Please see PR #1108:\n- Static peers and `addPeer` could cover this for now. Is there a particular reason you would like to omit reconnects?\n- Fixed, `--nodiscover`\n- Fixed, server is always started, so you shouldn't hit uninited state.\n- `--nodiscover`, `--maxpeers=0` and no static peers should get you on your own isolated island.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/105600832/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/105671238",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/1087#issuecomment-105671238",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/1087",
    "id": 105671238,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEwNTY3MTIzOA==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-05-26T21:34:36Z",
    "updated_at": "2015-05-26T21:34:36Z",
    "author_association": "MEMBER",
    "body": "I'll close this issue as the core problem has been resolved and merged by the previously mentioned PR. But if you, @zelig, feel than the mechanics are not enough for the bzz use case, we can come up with a solution to it a more focused thread/issue :)\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/105671238/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
