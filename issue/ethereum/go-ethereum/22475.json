{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22475",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22475/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22475/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22475/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/22475",
  "id": 827958392,
  "node_id": "MDU6SXNzdWU4Mjc5NTgzOTI=",
  "number": 22475,
  "title": "debug_traceTransaction gas usage doesn't match transaction receipt",
  "user": {
    "login": "nebojsa94",
    "id": 15905908,
    "node_id": "MDQ6VXNlcjE1OTA1OTA4",
    "avatar_url": "https://avatars.githubusercontent.com/u/15905908?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nebojsa94",
    "html_url": "https://github.com/nebojsa94",
    "followers_url": "https://api.github.com/users/nebojsa94/followers",
    "following_url": "https://api.github.com/users/nebojsa94/following{/other_user}",
    "gists_url": "https://api.github.com/users/nebojsa94/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nebojsa94/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nebojsa94/subscriptions",
    "organizations_url": "https://api.github.com/users/nebojsa94/orgs",
    "repos_url": "https://api.github.com/users/nebojsa94/repos",
    "events_url": "https://api.github.com/users/nebojsa94/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nebojsa94/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2021-03-10T15:58:24Z",
  "updated_at": "2021-03-14T15:13:25Z",
  "closed_at": "2021-03-14T15:13:25Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: ` v1.10.1` \r\nOS & Version: OSX 10.15.7\r\n\r\n#### Expected behaviour\r\nSame gas usage in receipt and transaction trace\r\n\r\n#### Actual behaviour\r\nGas usage in the receipt is 2000 more than gas usage in the transaction trace\r\n\r\n#### Steps to reproduce the behaviour\r\n`curl --data '{\"method\":\"debug_traceTransaction\",\"params\":[\"0xa89255b87420be7b3d3e08defcbfd7575b46b7528a573c180e45603ea13bb1fc\", {\"disableStorage\": true, \"disableMemory\": true, \"disableStack\": true}],\"id\":1,\"jsonrpc\":\"2.0\"}' -H \"Content-Type: application/json\" -X POST ropsten-node`\r\n`curl --data '{\"method\":\"eth_getTransactionReceipt\",\"params\":[\"0xa89255b87420be7b3d3e08defcbfd7575b46b7528a573c180e45603ea13bb1fc\"],\"id\":1,\"jsonrpc\":\"2.0\"}' -H \"Content-Type: application/json\" -X POST ropsten-node`\r\n\r\n#### Possible reason\r\nI think the reason for this is because accessList in StateDB is not cleaned when performing the transaction trace. In this case, there is a transaction prior to this one in the same block that looks identical `0xdf3001f0166f01ebbc81aecec0da66988f896482887275ac589e50ecbf73fcc1`",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22475/reactions",
    "total_count": 1,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 1,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22475/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/796596297",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22475#issuecomment-796596297",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22475",
    "id": 796596297,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5NjU5NjI5Nw==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-11T09:25:25Z",
    "updated_at": "2021-03-11T09:25:25Z",
    "author_association": "MEMBER",
    "body": "```\r\n> debug.traceTransaction(\"0xa89255b87420be7b3d3e08defcbfd7575b46b7528a573c180e45603ea13bb1fc\", {\"disableStorage\": true, \"disableMemory\": true, \"disableStack\": true, reexec: 50000})\r\n{\r\n  failed: false,\r\n  gas: 44159,\r\n  returnValue: \"\",\r\n  structLogs: [{\r\n      depth: 1,\r\n      gas: 121983,\r\n      gasCost: 3,\r\n      op: \"PUSH1\",\r\n      pc: 0\r\n  }, {\r\n      depth: 1,\r\n      gas: 121980,\r\n      gasCost: 3,\r\n      op: \"PUSH1\",\r\n      pc: 2\r\n  }, {\r\n      depth: 1,\r\n      gas: 121977,\r\n      gasCost: 12,\r\n      op: \"MSTORE\",\r\n      pc: 4\r\n  }, {\r\n      depth: 1,\r\n      gas: 121965,\r\n      gasCost: 2,\r\n      op: \"CALLVALUE\",\r\n      pc: 5\r\n  }, {\r\n      depth: 1,\r\n      gas: 121963,\r\n      gasCost: 3,\r\n      op: \"DUP1\",\r\n      pc: 6\r\n  }, {\r\n      depth: 1,\r\n      gas: 121960,\r\n      gasCost: 3,\r\n      op: \"ISZERO\",\r\n      pc: 7\r\n  }, {\r\n      depth: 1,\r\n      gas: 121957,\r\n      gasCost: 3,\r\n      op: \"PUSH2\",\r\n      pc: 8\r\n  }, {\r\n      depth: 1,\r\n      gas: 121954,\r\n      gasCost: 10,\r\n      op: \"JUMPI\",\r\n      pc: 11\r\n  }, {\r\n      depth: 1,\r\n      gas: 121944,\r\n      gasCost: 1,\r\n      op: \"JUMPDEST\",\r\n      pc: 16\r\n  }, {\r\n      depth: 1,\r\n      gas: 121943,\r\n      gasCost: 2,\r\n      op: \"POP\",\r\n      pc: 17\r\n  }, {\r\n      depth: 1,\r\n      gas: 121941,\r\n      gasCost: 3,\r\n      op: \"PUSH1\",\r\n      pc: 18\r\n  }, {\r\n      depth: 1,\r\n      gas: 121938,\r\n      gasCost: 2,\r\n      op: \"CALLDATASIZE\",\r\n      pc: 20\r\n  }, {\r\n      depth: 1,\r\n      gas: 121936,\r\n      gasCost: 3,\r\n      op: \"LT\",\r\n      pc: 21\r\n  }, {\r\n      depth: 1,\r\n      gas: 121933,\r\n      gasCost: 3,\r\n      op: \"PUSH2\",\r\n      pc: 22\r\n  }, {\r\n      depth: 1,\r\n      gas: 121930,\r\n      gasCost: 10,\r\n      op: \"JUMPI\",\r\n      pc: 25\r\n  }, {\r\n      depth: 1,\r\n      gas: 121920,\r\n      gasCost: 3,\r\n      op: \"PUSH1\",\r\n      pc: 26\r\n  }, {\r\n      depth: 1,\r\n      gas: 121917,\r\n      gasCost: 3,\r\n      op: \"CALLDATALOAD\",\r\n      pc: 28\r\n  }, {\r\n      depth: 1,\r\n      gas: 121914,\r\n      gasCost: 3,\r\n      op: \"PUSH1\",\r\n      pc: 29\r\n  }, {\r\n      depth: 1,\r\n      gas: 121911,\r\n      gasCost: 3,\r\n      op: \"SHR\",\r\n      pc: 31\r\n  }, {\r\n      depth: 1,\r\n      gas: 121908,\r\n      gasCost: 3,\r\n      op: \"DUP1\",\r\n      pc: 32\r\n  }, {\r\n      depth: 1,\r\n      gas: 121905,\r\n      gasCost: 3,\r\n      op: \"PUSH4\",\r\n      pc: 33\r\n  }, {\r\n      depth: 1,\r\n      gas: 121902,\r\n      gasCost: 3,\r\n      op: \"EQ\",\r\n      pc: 38\r\n  }, {\r\n      depth: 1,\r\n      gas: 121899,\r\n      gasCost: 3,\r\n      op: \"PUSH2\",\r\n      pc: 39\r\n  }, {\r\n      depth: 1,\r\n      gas: 121896,\r\n      gasCost: 10,\r\n      op: \"JUMPI\",\r\n      pc: 42\r\n  }, {\r\n      depth: 1,\r\n      gas: 121886,\r\n      gasCost: 3,\r\n      op: \"DUP1\",\r\n      pc: 43\r\n  }, {\r\n      depth: 1,\r\n      gas: 121883,\r\n      gasCost: 3,\r\n      op: \"PUSH4\",\r\n      pc: 44\r\n  }, {\r\n      depth: 1,\r\n      gas: 121880,\r\n      gasCost: 3,\r\n      op: \"EQ\",\r\n      pc: 49\r\n  }, {\r\n      depth: 1,\r\n      gas: 121877,\r\n      gasCost: 3,\r\n      op: \"PUSH2\",\r\n      pc: 50\r\n  }, {\r\n      depth: 1,\r\n      gas: 121874,\r\n      gasCost: 10,\r\n      op: \"JUMPI\",\r\n      pc: 53\r\n  }, {\r\n      depth: 1,\r\n      gas: 121864,\r\n      gasCost: 3,\r\n      op: \"DUP1\",\r\n      pc: 54\r\n  }, {\r\n      depth: 1,\r\n      gas: 121861,\r\n      gasCost: 3,\r\n      op: \"PUSH4\",\r\n      pc: 55\r\n  }, {\r\n      depth: 1,\r\n      gas: 121858,\r\n      gasCost: 3,\r\n      op: \"EQ\",\r\n      pc: 60\r\n  }, {\r\n      depth: 1,\r\n      gas: 121855,\r\n      gasCost: 3,\r\n      op: \"PUSH2\",\r\n      pc: 61\r\n  }, {\r\n      depth: 1,\r\n      gas: 121852,\r\n      gasCost: 10,\r\n      op: \"JUMPI\",\r\n      pc: 64\r\n  }, {\r\n      depth: 1,\r\n      gas: 121842,\r\n      gasCost: 3,\r\n      op: \"DUP1\",\r\n      pc: 65\r\n  }, {\r\n      depth: 1,\r\n      gas: 121839,\r\n      gasCost: 3,\r\n      op: \"PUSH4\",\r\n      pc: 66\r\n  }, {\r\n      depth: 1,\r\n      gas: 121836,\r\n      gasCost: 3,\r\n      op: \"EQ\",\r\n      pc: 71\r\n  }, {\r\n      depth: 1,\r\n      gas: 121833,\r\n      gasCost: 3,\r\n      op: \"PUSH2\",\r\n      pc: 72\r\n  }, {\r\n      depth: 1,\r\n      gas: 121830,\r\n      gasCost: 10,\r\n      op: \"JUMPI\",\r\n      pc: 75\r\n  }, {\r\n      depth: 1,\r\n      gas: 121820,\r\n      gasCost: 1,\r\n      op: \"JUMPDEST\",\r\n      pc: 263\r\n  }, {\r\n      depth: 1,\r\n      gas: 121819,\r\n      gasCost: 3,\r\n      op: \"PUSH2\",\r\n      pc: 264\r\n  }, {\r\n      depth: 1,\r\n      gas: 121816,\r\n      gasCost: 3,\r\n      op: \"PUSH1\",\r\n      pc: 267\r\n  }, {\r\n      depth: 1,\r\n      gas: 121813,\r\n      gasCost: 3,\r\n      op: \"DUP1\",\r\n      pc: 269\r\n  }, {\r\n      depth: 1,\r\n      gas: 121810,\r\n      gasCost: 2,\r\n      op: \"CALLDATASIZE\",\r\n      pc: 270\r\n  }, {\r\n      depth: 1,\r\n      gas: 121808,\r\n      gasCost: 3,\r\n      op: \"SUB\",\r\n      pc: 271\r\n  }, {\r\n      depth: 1,\r\n      gas: 121805,\r\n      gasCost: 3,\r\n      op: \"PUSH1\",\r\n      pc: 272\r\n  }, {\r\n      depth: 1,\r\n      gas: 121802,\r\n      gasCost: 3,\r\n      op: \"DUP2\",\r\n      pc: 274\r\n  }, {\r\n      depth: 1,\r\n      gas: 121799,\r\n      gasCost: 3,\r\n      op: \"LT\",\r\n      pc: 275\r\n  }, {\r\n      depth: 1,\r\n      gas: 121796,\r\n      gasCost: 3,\r\n      op: \"ISZERO\",\r\n      pc: 276\r\n  }, {\r\n      depth: 1,\r\n      gas: 121793,\r\n      gasCost: 3,\r\n      op: \"PUSH2\",\r\n      pc: 277\r\n  }, {\r\n      depth: 1,\r\n      gas: 121790,\r\n      gasCost: 10,\r\n      op: \"JUMPI\",\r\n      pc: 280\r\n  }, {\r\n      depth: 1,\r\n      gas: 121780,\r\n      gasCost: 1,\r\n      op: \"JUMPDEST\",\r\n      pc: 285\r\n  }, {\r\n      depth: 1,\r\n      gas: 121779,\r\n      gasCost: 2,\r\n      op: \"POP\",\r\n      pc: 286\r\n  }, {\r\n      depth: 1,\r\n      gas: 121777,\r\n      gasCost: 3,\r\n      op: \"CALLDATALOAD\",\r\n      pc: 287\r\n  }, {\r\n      depth: 1,\r\n      gas: 121774,\r\n      gasCost: 3,\r\n      op: \"PUSH2\",\r\n      pc: 288\r\n  }, {\r\n      depth: 1,\r\n      gas: 121771,\r\n      gasCost: 8,\r\n      op: \"JUMP\",\r\n      pc: 291\r\n  }, {\r\n      depth: 1,\r\n      gas: 121763,\r\n      gasCost: 1,\r\n      op: \"JUMPDEST\",\r\n      pc: 352\r\n  }, {\r\n      depth: 1,\r\n      gas: 121762,\r\n      gasCost: 3,\r\n      op: \"PUSH2\",\r\n      pc: 353\r\n  }, {\r\n      depth: 1,\r\n      gas: 121759,\r\n      gasCost: 3,\r\n      op: \"DUP2\",\r\n      pc: 356\r\n  }, {\r\n      depth: 1,\r\n      gas: 121756,\r\n      gasCost: 3,\r\n      op: \"PUSH2\",\r\n      pc: 357\r\n  }, {\r\n      depth: 1,\r\n      gas: 121753,\r\n      gasCost: 8,\r\n      op: \"JUMP\",\r\n      pc: 360\r\n  }, {\r\n      depth: 1,\r\n      gas: 121745,\r\n      gasCost: 1,\r\n      op: \"JUMPDEST\",\r\n      pc: 385\r\n  }, {\r\n      depth: 1,\r\n      gas: 121744,\r\n      gasCost: 3,\r\n      op: \"PUSH1\",\r\n      pc: 386\r\n  }, {\r\n      depth: 1,\r\n      gas: 121741,\r\n      gasCost: 3,\r\n      op: \"DUP2\",\r\n      pc: 388\r\n  }, {\r\n      depth: 1,\r\n      gas: 121738,\r\n      gasCost: 3,\r\n      op: \"DUP2\",\r\n      pc: 389\r\n  }, {\r\n      depth: 1,\r\n      gas: 121735,\r\n      gasCost: 3,\r\n      op: \"MSTORE\",\r\n      pc: 390\r\n  }, {\r\n      depth: 1,\r\n      gas: 121732,\r\n      gasCost: 3,\r\n      op: \"PUSH1\",\r\n      pc: 391\r\n  }, {\r\n      depth: 1,\r\n      gas: 121729,\r\n      gasCost: 3,\r\n      op: \"DUP2\",\r\n      pc: 393\r\n  }, {\r\n      depth: 1,\r\n      gas: 121726,\r\n      gasCost: 3,\r\n      op: \"SWAP1\",\r\n      pc: 394\r\n  }, {\r\n      depth: 1,\r\n      gas: 121723,\r\n      gasCost: 3,\r\n      op: \"MSTORE\",\r\n      pc: 395\r\n  }, {\r\n      depth: 1,\r\n      gas: 121720,\r\n      gasCost: 3,\r\n      op: \"PUSH1\",\r\n      pc: 396\r\n  }, {\r\n      depth: 1,\r\n      gas: 121717,\r\n      gasCost: 3,\r\n      op: \"SWAP1\",\r\n      pc: 398\r\n  }, {\r\n      depth: 1,\r\n      gas: 121714,\r\n      gasCost: 42,\r\n      op: \"SHA3\",\r\n      pc: 399\r\n  }, {\r\n      depth: 1,\r\n      gas: 121672,\r\n      gasCost: 3,\r\n      op: \"DUP1\",\r\n      pc: 400\r\n  }, {\r\n      depth: 1,\r\n      gas: 121669,\r\n      gasCost: 2100,\r\n      op: \"SLOAD\",\r\n      pc: 401\r\n  }, {\r\n      depth: 1,\r\n      gas: 119569,\r\n      gasCost: 3,\r\n      op: \"PUSH1\",\r\n      pc: 402\r\n  }, {\r\n      depth: 1,\r\n      gas: 119566,\r\n      gasCost: 3,\r\n      op: \"NOT\",\r\n      pc: 404\r\n  }, {\r\n      depth: 1,\r\n      gas: 119563,\r\n      gasCost: 3,\r\n      op: \"AND\",\r\n      pc: 405\r\n  }, {\r\n      depth: 1,\r\n      gas: 119560,\r\n      gasCost: 3,\r\n      op: \"PUSH1\",\r\n      pc: 406\r\n  }, {\r\n      depth: 1,\r\n      gas: 119557,\r\n      gasCost: 3,\r\n      op: \"SWAP1\",\r\n      pc: 408\r\n  }, {\r\n      depth: 1,\r\n      gas: 119554,\r\n      gasCost: 3,\r\n      op: \"DUP2\",\r\n      pc: 409\r\n  }, {\r\n      depth: 1,\r\n      gas: 119551,\r\n      gasCost: 3,\r\n      op: \"OR\",\r\n      pc: 410\r\n  }, {\r\n      depth: 1,\r\n      gas: 119548,\r\n      gasCost: 3,\r\n      op: \"SWAP1\",\r\n      pc: 411\r\n  }, {\r\n      depth: 1,\r\n      gas: 119545,\r\n      gasCost: 3,\r\n      op: \"SWAP2\",\r\n      pc: 412\r\n  }, {\r\n      depth: 1,\r\n      gas: 119542,\r\n      gasCost: 20000,\r\n      op: \"SSTORE\",\r\n      pc: 413\r\n  }, {\r\n      depth: 1,\r\n      gas: 99542,\r\n      gasCost: 100,\r\n      op: \"SLOAD\",\r\n      pc: 414\r\n  }, {\r\n      depth: 1,\r\n      gas: 99442,\r\n      gasCost: 3,\r\n      op: \"PUSH1\",\r\n      pc: 415\r\n  }, {\r\n      depth: 1,\r\n      gas: 99439,\r\n      gasCost: 3,\r\n      op: \"AND\",\r\n      pc: 417\r\n  }, {\r\n      depth: 1,\r\n      gas: 99436,\r\n      gasCost: 3,\r\n      op: \"PUSH2\",\r\n      pc: 418\r\n  }, {\r\n      depth: 1,\r\n      gas: 99433,\r\n      gasCost: 10,\r\n      op: \"JUMPI\",\r\n      pc: 421\r\n  }, {\r\n      depth: 1,\r\n      gas: 99423,\r\n      gasCost: 1,\r\n      op: \"JUMPDEST\",\r\n      pc: 361\r\n  }, {\r\n      depth: 1,\r\n      gas: 99422,\r\n      gasCost: 2,\r\n      op: \"POP\",\r\n      pc: 362\r\n  }, {\r\n      depth: 1,\r\n      gas: 99420,\r\n      gasCost: 8,\r\n      op: \"JUMP\",\r\n      pc: 363\r\n  }, {\r\n      depth: 1,\r\n      gas: 99412,\r\n      gasCost: 1,\r\n      op: \"JUMPDEST\",\r\n      pc: 361\r\n  }, {\r\n      depth: 1,\r\n      gas: 99411,\r\n      gasCost: 2,\r\n      op: \"POP\",\r\n      pc: 362\r\n  }, {\r\n      depth: 1,\r\n      gas: 99409,\r\n      gasCost: 8,\r\n      op: \"JUMP\",\r\n      pc: 363\r\n  }, {\r\n      depth: 1,\r\n      gas: 99401,\r\n      gasCost: 1,\r\n      op: \"JUMPDEST\",\r\n      pc: 292\r\n  }, {\r\n      depth: 1,\r\n      gas: 99400,\r\n      gasCost: 0,\r\n      op: \"STOP\",\r\n      pc: 293\r\n  }]\r\n}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/796596297/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/796596730",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22475#issuecomment-796596730",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22475",
    "id": 796596730,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5NjU5NjczMA==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-11T09:26:04Z",
    "updated_at": "2021-03-11T09:26:04Z",
    "author_association": "MEMBER",
    "body": "```\r\n> eth.getTransactionReceipt(\"0xa89255b87420be7b3d3e08defcbfd7575b46b7528a573c180e45603ea13bb1fc\")\r\n{\r\n  blockHash: \"0x1902b1b38a16d6239ce673127cc9a5c9ffa85d01069503c918940f8b17b34676\",\r\n  blockNumber: 9812189,\r\n  contractAddress: null,\r\n  cumulativeGasUsed: 3885570,\r\n  from: \"0x7f1bc2acf0638510a2b8c98e86cf1d1a9cbee943\",\r\n  gasUsed: 46159,\r\n  logs: [],\r\n  logsBloom: \"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\r\n  status: \"0x1\",\r\n  to: \"0xe6f4839f9b76219a662549a2184b17e8cc95ac98\",\r\n  transactionHash: \"0xa89255b87420be7b3d3e08defcbfd7575b46b7528a573c180e45603ea13bb1fc\",\r\n  transactionIndex: 10,\r\n  type: \"0x0\"\r\n}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/796596730/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/796597415",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22475#issuecomment-796597415",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22475",
    "id": 796597415,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5NjU5NzQxNQ==",
    "user": {
      "login": "nebojsa94",
      "id": 15905908,
      "node_id": "MDQ6VXNlcjE1OTA1OTA4",
      "avatar_url": "https://avatars.githubusercontent.com/u/15905908?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nebojsa94",
      "html_url": "https://github.com/nebojsa94",
      "followers_url": "https://api.github.com/users/nebojsa94/followers",
      "following_url": "https://api.github.com/users/nebojsa94/following{/other_user}",
      "gists_url": "https://api.github.com/users/nebojsa94/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nebojsa94/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nebojsa94/subscriptions",
      "organizations_url": "https://api.github.com/users/nebojsa94/orgs",
      "repos_url": "https://api.github.com/users/nebojsa94/repos",
      "events_url": "https://api.github.com/users/nebojsa94/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nebojsa94/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-11T09:27:09Z",
    "updated_at": "2021-03-11T09:27:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "This is probably because `Prepare()` function in StateDB wasn't invoked prior the transaction trace.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/796597415/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/796598079",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22475#issuecomment-796598079",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22475",
    "id": 796598079,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5NjU5ODA3OQ==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-11T09:28:18Z",
    "updated_at": "2021-03-11T09:28:18Z",
    "author_association": "MEMBER",
    "body": "Proposed fix: \r\n```diff\r\ndiff --git a/eth/state_accessor.go b/eth/state_accessor.go\r\nindex 869b3d7636..b6c99d4127 100644\r\n--- a/eth/state_accessor.go\r\n+++ b/eth/state_accessor.go\r\n@@ -212,6 +212,7 @@ func (eth *Ethereum) stateAtTransaction(block *types.Block, txIndex int, reexec\r\n                msg, _ := tx.AsMessage(signer)\r\n                txContext := core.NewEVMTxContext(msg)\r\n                context := core.NewEVMBlockContext(block.Header(), eth.blockchain, nil)\r\n+               statedb.Prepare(tx.Hash(), block.Hash(), idx)\r\n                if idx == txIndex {\r\n                        return msg, context, statedb, release, nil\r\n                }\r\n\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/796598079/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/796626003",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22475#issuecomment-796626003",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22475",
    "id": 796626003,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5NjYyNjAwMw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-11T10:14:09Z",
    "updated_at": "2021-03-11T10:14:09Z",
    "author_association": "MEMBER",
    "body": "Does https://github.com/ethereum/go-ethereum/pull/22480 fix the issue for you? ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/796626003/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/796626006",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22475#issuecomment-796626006",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22475",
    "id": 796626006,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5NjYyNjAwNg==",
    "user": {
      "login": "ligi",
      "id": 111600,
      "node_id": "MDQ6VXNlcjExMTYwMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/111600?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ligi",
      "html_url": "https://github.com/ligi",
      "followers_url": "https://api.github.com/users/ligi/followers",
      "following_url": "https://api.github.com/users/ligi/following{/other_user}",
      "gists_url": "https://api.github.com/users/ligi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ligi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ligi/subscriptions",
      "organizations_url": "https://api.github.com/users/ligi/orgs",
      "repos_url": "https://api.github.com/users/ligi/repos",
      "events_url": "https://api.github.com/users/ligi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ligi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-11T10:14:09Z",
    "updated_at": "2021-03-11T10:14:09Z",
    "author_association": "MEMBER",
    "body": "@nebojsa94 thanks for the valuable and detailed issue!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/796626006/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
