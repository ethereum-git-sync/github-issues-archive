{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/20192",
  "id": 510443908,
  "node_id": "MDU6SXNzdWU1MTA0NDM5MDg=",
  "number": 20192,
  "title": "Memory leak caused by repeated usage of the pointer of price in the func SuggestPrice",
  "user": {
    "login": "james-ray",
    "id": 26137182,
    "node_id": "MDQ6VXNlcjI2MTM3MTgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/26137182?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/james-ray",
    "html_url": "https://github.com/james-ray",
    "followers_url": "https://api.github.com/users/james-ray/followers",
    "following_url": "https://api.github.com/users/james-ray/following{/other_user}",
    "gists_url": "https://api.github.com/users/james-ray/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/james-ray/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/james-ray/subscriptions",
    "organizations_url": "https://api.github.com/users/james-ray/orgs",
    "repos_url": "https://api.github.com/users/james-ray/repos",
    "events_url": "https://api.github.com/users/james-ray/events{/privacy}",
    "received_events_url": "https://api.github.com/users/james-ray/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 18,
  "created_at": "2019-10-22T05:55:19Z",
  "updated_at": "2019-10-23T09:11:47Z",
  "closed_at": "2019-10-23T09:09:24Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "About #20172  \r\n@holiman \r\nI've used flj's memsize tool, and located the problem seems inside the \r\n```\r\ntype TxPool struct {\r\n\r\n\tconfig       TxPoolConfig\r\n\tchainconfig  *params.ChainConfig\r\n\tchain        blockChain              //inside this structure\r\n\r\n\r\n```\r\n\r\nand is inside this\r\n```\r\nblockCache   *lru.Cache \r\n```\r\n```\r\n \r\n\r\nALL                19556118  1318.964 MB\r\nbig.Int            13968186   831.223 MB\r\ntypes.Transaction   2793452   412.935 MB\r\ncommon.Address      2793452    53.281 MB\r\ntypes.Block             256    21.353 MB\r\ntypes.Header            256   136.000 KB\r\nsimplelru.entry         256    16.000 KB\r\nsimplelru.LRU             1    14.031 KB\r\nlist.Element            256    10.000 KB\r\nlist.List                 1         48 B\r\nlru.Cache                 1         32 B\r\n*lru.Cache                1          8 B\r\n\r\n\r\nALL                19822764  1336.947 MB\r\nbig.Int            14158648   842.557 MB\r\ntypes.Transaction   2831544   418.566 MB\r\ncommon.Address      2831544    54.007 MB\r\ntypes.Block             256    21.644 MB\r\ntypes.Header            256   136.000 KB\r\nsimplelru.entry         256    16.000 KB\r\nsimplelru.LRU             1    14.031 KB\r\nlist.Element            256    10.000 KB\r\nlist.List                 1         48 B\r\nlru.Cache                 1         32 B\r\n*lru.Cache                1          8 B\r\n\r\n\r\n\r\nRoot: \"blockCache\"\r\nDate: 2019-10-22 13:39:37 +0800 CST\r\nDuration: 38.909950976s\r\nBitmap Size: 612.625 MB\r\nBitmap Utilization: 0.2918385\r\nALL                21555977  1453.832 MB\r\nbig.Int            15396661   916.231 MB\r\ntypes.Transaction   3079144   455.167 MB\r\ncommon.Address      3079144    58.730 MB\r\ntypes.Block             256    23.533 MB\r\ntypes.Header            256   136.000 KB\r\nsimplelru.entry         256    16.000 KB\r\nsimplelru.LRU             1    14.031 KB\r\nlist.Element            256    10.000 KB\r\nlist.List                 1         48 B\r\nlru.Cache                 1         32 B\r\n*lru.Cache                1          8 B\r\n\r\n\r\nRoot: \"blockCache\"\r\nDate: 2019-10-22 13:49:27 +0800 CST\r\nDuration: 40.977649022s\r\nBitmap Size: 634.375 MB\r\nBitmap Utilization: 0.32366452\r\nALL                24755736  1669.621 MB\r\nbig.Int            17682210  1052.242 MB\r\ntypes.Transaction   3536249   522.737 MB\r\ncommon.Address      3536249    67.449 MB\r\ntypes.Block             256    27.020 MB\r\ntypes.Header            256   136.000 KB\r\nsimplelru.entry         256    16.000 KB\r\nsimplelru.LRU             1    14.031 KB\r\nlist.Element            256    10.000 KB\r\nlist.List                 1         48 B\r\nlru.Cache                 1         32 B\r\n*lru.Cache                1          8 B\r\n\r\n```\r\nFrom the reports, we could see the transaction number is continuously rising. Strangely, when debugging in local, the transaction number did not exceed 418181, while the number of list.Element was 256 too.\r\nI don't know why when debugging in multiple nodes, the transaction number continuously rises.\r\n",
  "closed_by": {
    "login": "james-ray",
    "id": 26137182,
    "node_id": "MDQ6VXNlcjI2MTM3MTgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/26137182?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/james-ray",
    "html_url": "https://github.com/james-ray",
    "followers_url": "https://api.github.com/users/james-ray/followers",
    "following_url": "https://api.github.com/users/james-ray/following{/other_user}",
    "gists_url": "https://api.github.com/users/james-ray/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/james-ray/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/james-ray/subscriptions",
    "organizations_url": "https://api.github.com/users/james-ray/orgs",
    "repos_url": "https://api.github.com/users/james-ray/repos",
    "events_url": "https://api.github.com/users/james-ray/events{/privacy}",
    "received_events_url": "https://api.github.com/users/james-ray/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544817206",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-544817206",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 544817206,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDgxNzIwNg==",
    "user": {
      "login": "james-ray",
      "id": 26137182,
      "node_id": "MDQ6VXNlcjI2MTM3MTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/26137182?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/james-ray",
      "html_url": "https://github.com/james-ray",
      "followers_url": "https://api.github.com/users/james-ray/followers",
      "following_url": "https://api.github.com/users/james-ray/following{/other_user}",
      "gists_url": "https://api.github.com/users/james-ray/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/james-ray/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/james-ray/subscriptions",
      "organizations_url": "https://api.github.com/users/james-ray/orgs",
      "repos_url": "https://api.github.com/users/james-ray/repos",
      "events_url": "https://api.github.com/users/james-ray/events{/privacy}",
      "received_events_url": "https://api.github.com/users/james-ray/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T06:02:33Z",
    "updated_at": "2019-10-22T06:30:41Z",
    "author_association": "NONE",
    "body": "By the way, may I ask, how can I update the vendors? Seems like some dependent projects like golang-lru is an old version one in my forked Ethereum.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544817206/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544819504",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-544819504",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 544819504,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDgxOTUwNA==",
    "user": {
      "login": "james-ray",
      "id": 26137182,
      "node_id": "MDQ6VXNlcjI2MTM3MTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/26137182?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/james-ray",
      "html_url": "https://github.com/james-ray",
      "followers_url": "https://api.github.com/users/james-ray/followers",
      "following_url": "https://api.github.com/users/james-ray/following{/other_user}",
      "gists_url": "https://api.github.com/users/james-ray/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/james-ray/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/james-ray/subscriptions",
      "organizations_url": "https://api.github.com/users/james-ray/orgs",
      "repos_url": "https://api.github.com/users/james-ray/repos",
      "events_url": "https://api.github.com/users/james-ray/events{/privacy}",
      "received_events_url": "https://api.github.com/users/james-ray/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T06:11:53Z",
    "updated_at": "2019-10-22T08:32:35Z",
    "author_association": "NONE",
    "body": "```\r\nRoot: \"blockCache\"\r\nDate: 2019-10-22 14:10:24 +0800 CST\r\nDuration: 1m9.836089148s\r\nBitmap Size: 742.750 MB\r\nBitmap Utilization: 0.3374587\r\nALL                30220530  2038.160 MB\r\nbig.Int            21585646  1284.534 MB\r\ntypes.Transaction   4316928   638.139 MB\r\ncommon.Address      4316928    82.339 MB\r\ntypes.Block             256    32.977 MB\r\ntypes.Header            256   136.000 KB\r\nsimplelru.entry         256    16.000 KB\r\nsimplelru.LRU             1    14.031 KB\r\nlist.Element            256    10.000 KB\r\nlist.List                 1         48 B\r\nlru.Cache                 1         32 B\r\n*lru.Cache                1          8 B\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544819504/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544827291",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-544827291",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 544827291,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDgyNzI5MQ==",
    "user": {
      "login": "james-ray",
      "id": 26137182,
      "node_id": "MDQ6VXNlcjI2MTM3MTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/26137182?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/james-ray",
      "html_url": "https://github.com/james-ray",
      "followers_url": "https://api.github.com/users/james-ray/followers",
      "following_url": "https://api.github.com/users/james-ray/following{/other_user}",
      "gists_url": "https://api.github.com/users/james-ray/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/james-ray/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/james-ray/subscriptions",
      "organizations_url": "https://api.github.com/users/james-ray/orgs",
      "repos_url": "https://api.github.com/users/james-ray/repos",
      "events_url": "https://api.github.com/users/james-ray/events{/privacy}",
      "received_events_url": "https://api.github.com/users/james-ray/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T06:45:08Z",
    "updated_at": "2019-10-22T08:31:23Z",
    "author_association": "NONE",
    "body": "The LRU insertion is called by GetBlock,  I debug and find it is called by this func:\r\n\r\n```\r\n func (gpo *Oracle) getBlockPrices(ctx context.Context, signer types.Signer, blockNum uint64, ch chan getBlockPricesResult) {\r\n\r\n\tblock, err := gpo.backend.BlockByNumber(ctx, rpc.BlockNumber(blockNum))\r\n\tif block == nil {\r\n\t\tch <- getBlockPricesResult{nil, err}\r\n\t\treturn\r\n\t}\r\n\r\n\tblockTxs := block.Transactions()\r\n\ttxs := make([]*types.Transaction, len(blockTxs))\r\n\tcopy(txs, blockTxs)\r\n\tsort.Sort(transactionsByGasPrice(txs))\r\n\r\n\tfor _, tx := range txs {\r\n\t\tsender, err := types.Sender(signer, tx)\r\n\t\tif err == nil && sender != block.Coinbase() {\r\n\t\t\tch <- getBlockPricesResult{tx.GasPrice(), nil}\r\n\t\t\treturn\r\n\t\t}\r\n\t}\r\n\tch <- getBlockPricesResult{nil, nil}\r\n}\r\n```\r\n> \r\n\r\nAnd this is called by \r\n```\r\nfunc (args *SendTxArgs) setDefaults(ctx context.Context, b Backend) error {\r\n\tif args.Gas == nil {\r\n\t\targs.Gas = new(hexutil.Uint64)\r\n\t\t*(*uint64)(args.Gas) = 90000\r\n\t}\r\n\tif args.GasPrice == nil {\r\n\t\tprice, err := b.SuggestPrice(ctx)\r\n\t\tif err != nil {\r\n\t\t\treturn err\r\n\t\t}\r\n\t\targs.GasPrice = (*hexutil.Big)(price)\r\n\t}\r\n\r\n```\r\nIf the args.GasPrice is nil, the pointer of the price is repeatedly used, is this the reason why the memory of the *big.int is held?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544827291/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544860614",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-544860614",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 544860614,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDg2MDYxNA==",
    "user": {
      "login": "james-ray",
      "id": 26137182,
      "node_id": "MDQ6VXNlcjI2MTM3MTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/26137182?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/james-ray",
      "html_url": "https://github.com/james-ray",
      "followers_url": "https://api.github.com/users/james-ray/followers",
      "following_url": "https://api.github.com/users/james-ray/following{/other_user}",
      "gists_url": "https://api.github.com/users/james-ray/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/james-ray/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/james-ray/subscriptions",
      "organizations_url": "https://api.github.com/users/james-ray/orgs",
      "repos_url": "https://api.github.com/users/james-ray/repos",
      "events_url": "https://api.github.com/users/james-ray/events{/privacy}",
      "received_events_url": "https://api.github.com/users/james-ray/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T08:36:46Z",
    "updated_at": "2019-10-22T09:03:01Z",
    "author_association": "NONE",
    "body": "Now I edit our test tool, set the price in the sendArgs, and the memory in the server side is OK.\r\nSeems like I have found the cause.\r\n\r\n```\r\nfunc SendTransaction(web3 *web3.Web3, from string, to string) (txID string) {\r\n\ttransaction := new(dto.TransactionParameters)\r\n\ttransaction.From = from\r\n\ttransaction.To = to\r\n\ttransaction.Value = big.NewInt(1)\r\n\ttransaction.Gas = big.NewInt(30000)\r\n\ttransaction.GasPrice = big.NewInt(10000)  //this line is newly added\r\n\ttransaction.Data = goWebType.ComplexString(string(time.Now().UTC().UnixNano()))\r\n\r\n\tvar err error\r\n\ttxID, err = web3.Eth.SendTransaction(transaction)\r\n\r\n\tif err != nil {\r\n\t\tfmt.Println(fmt.Sprintf(\"send Transaction error %v\", err))\r\n\t} else {\r\n\t\t//fmt.Println(\"transactionHash \" + txID)\r\n\t}\r\n\treturn\r\n}\r\n```\r\n\r\nThe pprof heap result:\r\n```\r\nType: inuse_space\r\nTime: Oct 22, 2019 at 5:01pm (CST)\r\nEntering interactive mode (type \"help\" for commands, \"o\" for options)\r\n(pprof) top20\r\nShowing nodes accounting for 350.37MB, 88.90% of 394.11MB total\r\nDropped 75 nodes (cum <= 1.97MB)\r\nShowing top 20 nodes out of 215\r\n      flat  flat%   sum%        cum   cum%\r\n     192MB 48.72% 48.72%      192MB 48.72%  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/memdb.New\r\n   26.12MB  6.63% 55.34%    26.12MB  6.63%  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/util.(*BufferPool).Get\r\n   20.01MB  5.08% 60.42%    20.01MB  5.08%  github.com/tendermint/tendermint/vendor/github.com/syndtr/goleveldb/leveldb/memdb.New\r\n   15.27MB  3.87% 64.29%    15.27MB  3.87%  github.com/ethereum/go-ethereum/eth/filters.(*EventSystem).eventLoop\r\n   11.26MB  2.86% 67.15%    11.26MB  2.86%  github.com/tendermint/tendermint/vendor/github.com/syndtr/goleveldb/leveldb/util.(*BufferPool).Get\r\n      11MB  2.79% 69.94%    12.50MB  3.17%  github.com/tendermint/tendermint/libs/clist.(*CList).PushBack\r\n    7.82MB  1.98% 71.93%     7.82MB  1.98%  github.com/tendermint/tendermint/libs/pubsub/query.(*QueryParser).Init\r\n    7.50MB  1.90% 73.83%    15.74MB  3.99%  sync.(*Map).Store\r\n    7.24MB  1.84% 75.67%     7.24MB  1.84%  sync.(*Map).dirtyLocked\r\n       7MB  1.78% 77.44%        7MB  1.78%  math/big.nat.make\r\n    6.94MB  1.76% 79.20%     6.94MB  1.76%  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/memdb.(*DB).Put\r\n    6.06MB  1.54% 80.74%     6.06MB  1.54%  fmt.(*fmt).fmtSbx\r\n    5.50MB  1.40% 82.13%     5.50MB  1.40%  github.com/ethereum/go-ethereum/rlp.(*encbuf).toBytes\r\n    5.30MB  1.34% 83.48%     5.30MB  1.34%  github.com/ethereum/go-ethereum/core.(*TxPool).enqueueTx\r\n    4.09MB  1.04% 84.52%     4.09MB  1.04%  github.com/green-element-chain/gelchain/ethereum.(*Backend).InsertCachedTxFrom\r\n    3.85MB  0.98% 85.49%     3.85MB  0.98%  bytes.makeSlice\r\n    3.50MB  0.89% 86.38%       15MB  3.81%  github.com/tendermint/tendermint/abci/client.(*localClient).DeliverTxAsync\r\n    3.50MB  0.89% 87.27%     3.50MB  0.89%  github.com/ethereum/go-ethereum/core/types.Sender\r\n    3.43MB  0.87% 88.14%     3.43MB  0.87%  github.com/tendermint/tendermint/p2p/conn.newChannel\r\n       3MB  0.76% 88.90%     6.50MB  1.65%  github.com/ethereum/go-ethereum/core/types.(*Transaction).WithSignature\r\n```\r\nIt is very good now.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544860614/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544864160",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-544864160",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 544864160,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDg2NDE2MA==",
    "user": {
      "login": "james-ray",
      "id": 26137182,
      "node_id": "MDQ6VXNlcjI2MTM3MTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/26137182?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/james-ray",
      "html_url": "https://github.com/james-ray",
      "followers_url": "https://api.github.com/users/james-ray/followers",
      "following_url": "https://api.github.com/users/james-ray/following{/other_user}",
      "gists_url": "https://api.github.com/users/james-ray/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/james-ray/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/james-ray/subscriptions",
      "organizations_url": "https://api.github.com/users/james-ray/orgs",
      "repos_url": "https://api.github.com/users/james-ray/repos",
      "events_url": "https://api.github.com/users/james-ray/events{/privacy}",
      "received_events_url": "https://api.github.com/users/james-ray/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T08:47:12Z",
    "updated_at": "2019-10-22T08:57:28Z",
    "author_association": "NONE",
    "body": "I think the reason why a local node test does not leak memory is because all the blocks are proposed by itself, so though the new tx reuses  the price pointer, the pointer is still inside its own memory.\r\nWhile in the test of multiple nodes, there are other blocks and the txs in those blocks are not in its LRU cache. The txs in the block in the LRU cache continuously link the price pointer to some previous txs of others' blocks.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544864160/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544869855",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-544869855",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 544869855,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDg2OTg1NQ==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T09:03:26Z",
    "updated_at": "2019-10-22T11:05:27Z",
    "author_association": "MEMBER",
    "body": "Yes, there's a ~~mem leak regarding the gas prices.~~ Thanks for diving into it!\r\n\r\nHere: https://github.com/ethereum/go-ethereum/blob/e8f229b82ef99213f8f84b8a71f752b236024494/eth/gasprice/gasprice.go#L106-L107 \r\n\r\nWe start `n` goroutines, that each will 'hold' a block and try to return one value over a channel. However, if any one of them returns an error, we will stop listening to the channel: https://github.com/ethereum/go-ethereum/blob/e8f229b82ef99213f8f84b8a71f752b236024494/eth/gasprice/gasprice.go#L114-L116 \r\n\r\nBefore we figure out how to fix this, we need to figure out a good testcase that repros this\r\n\r\nEDIT: no, I don't think there's an issue there",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544869855/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544870337",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-544870337",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 544870337,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDg3MDMzNw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T09:04:52Z",
    "updated_at": "2019-10-22T09:04:52Z",
    "author_association": "MEMBER",
    "body": "Sponteneously, a better approach would be to not keep track of `exp`, but always keep reading until the channel is emptied",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544870337/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544870987",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-544870987",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 544870987,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDg3MDk4Nw==",
    "user": {
      "login": "james-ray",
      "id": 26137182,
      "node_id": "MDQ6VXNlcjI2MTM3MTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/26137182?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/james-ray",
      "html_url": "https://github.com/james-ray",
      "followers_url": "https://api.github.com/users/james-ray/followers",
      "following_url": "https://api.github.com/users/james-ray/following{/other_user}",
      "gists_url": "https://api.github.com/users/james-ray/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/james-ray/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/james-ray/subscriptions",
      "organizations_url": "https://api.github.com/users/james-ray/orgs",
      "repos_url": "https://api.github.com/users/james-ray/repos",
      "events_url": "https://api.github.com/users/james-ray/events{/privacy}",
      "received_events_url": "https://api.github.com/users/james-ray/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T09:06:56Z",
    "updated_at": "2019-10-22T09:06:56Z",
    "author_association": "NONE",
    "body": "Would you please allow me to propose a PR for this? I will feel honored if I could make some contribution to Ethereum.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544870987/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544874753",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-544874753",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 544874753,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDg3NDc1Mw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T09:17:20Z",
    "updated_at": "2019-10-22T09:17:20Z",
    "author_association": "MEMBER",
    "body": "That'd be great, thanks",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544874753/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544875132",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-544875132",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 544875132,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDg3NTEzMg==",
    "user": {
      "login": "james-ray",
      "id": 26137182,
      "node_id": "MDQ6VXNlcjI2MTM3MTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/26137182?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/james-ray",
      "html_url": "https://github.com/james-ray",
      "followers_url": "https://api.github.com/users/james-ray/followers",
      "following_url": "https://api.github.com/users/james-ray/following{/other_user}",
      "gists_url": "https://api.github.com/users/james-ray/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/james-ray/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/james-ray/subscriptions",
      "organizations_url": "https://api.github.com/users/james-ray/orgs",
      "repos_url": "https://api.github.com/users/james-ray/repos",
      "events_url": "https://api.github.com/users/james-ray/events{/privacy}",
      "received_events_url": "https://api.github.com/users/james-ray/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T09:18:20Z",
    "updated_at": "2019-10-22T09:19:17Z",
    "author_association": "NONE",
    "body": "I suppose a code of copying big.int, like copiedPrice:=new(big.Int).Set(price)  will fix this.\r\nThe logic of exp is fine,  from my point of view.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544875132/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544876564",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-544876564",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 544876564,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDg3NjU2NA==",
    "user": {
      "login": "james-ray",
      "id": 26137182,
      "node_id": "MDQ6VXNlcjI2MTM3MTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/26137182?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/james-ray",
      "html_url": "https://github.com/james-ray",
      "followers_url": "https://api.github.com/users/james-ray/followers",
      "following_url": "https://api.github.com/users/james-ray/following{/other_user}",
      "gists_url": "https://api.github.com/users/james-ray/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/james-ray/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/james-ray/subscriptions",
      "organizations_url": "https://api.github.com/users/james-ray/orgs",
      "repos_url": "https://api.github.com/users/james-ray/repos",
      "events_url": "https://api.github.com/users/james-ray/events{/privacy}",
      "received_events_url": "https://api.github.com/users/james-ray/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T09:22:08Z",
    "updated_at": "2019-10-22T09:22:08Z",
    "author_association": "NONE",
    "body": "I don't know how to write a UT to produce a memory problem, do you mean we have to repro it in a UT?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544876564/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544876734",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-544876734",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 544876734,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDg3NjczNA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T09:22:36Z",
    "updated_at": "2019-10-22T09:22:36Z",
    "author_association": "MEMBER",
    "body": "Hm... I actually don't see why holding on to that bigint pointer matters, tbh. I mean, if it fixes your problem, great, but I don't understand how..\r\n\r\nYes, would be nice with a unit test for this",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544876734/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544878386",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-544878386",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 544878386,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDg3ODM4Ng==",
    "user": {
      "login": "james-ray",
      "id": 26137182,
      "node_id": "MDQ6VXNlcjI2MTM3MTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/26137182?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/james-ray",
      "html_url": "https://github.com/james-ray",
      "followers_url": "https://api.github.com/users/james-ray/followers",
      "following_url": "https://api.github.com/users/james-ray/following{/other_user}",
      "gists_url": "https://api.github.com/users/james-ray/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/james-ray/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/james-ray/subscriptions",
      "organizations_url": "https://api.github.com/users/james-ray/orgs",
      "repos_url": "https://api.github.com/users/james-ray/repos",
      "events_url": "https://api.github.com/users/james-ray/events{/privacy}",
      "received_events_url": "https://api.github.com/users/james-ray/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T09:27:05Z",
    "updated_at": "2019-10-22T09:31:57Z",
    "author_association": "NONE",
    "body": "```\r\nBlock A             Block B             Block C\r\ntx a1                tx b1               tx c1\r\ntx a2                tx b2               tx c2\r\ntx a3                tx b3               tx c3\r\n```\r\n\r\nIf b1 reuses a1's price pointer, and a1 is generated by itself, it is fine.\r\nBut if Block A is generated by some other proposer, then the block and the txs in it are RLP decoded and allocated a new memory space and inserted to LRU cache. The LRU cache keeps rotating, new block comes in and out, but the price pointer is always held by new coming tx so the space of previous txs never released.\r\nThe GC won't recycle a struct instance if some field of this instance is still held by others, right?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544878386/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544894280",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-544894280",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 544894280,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDg5NDI4MA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T10:14:46Z",
    "updated_at": "2019-10-22T10:14:46Z",
    "author_association": "MEMBER",
    "body": "> The GC won't recycle a struct instance if some field of this instance is still held by others, right?\r\n\r\nAs far as I understand, holding a member wouldn't prevent the struct from being GC:ed - so that wouldn't explain the issue. cc @fjl ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/544894280/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/545278252",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-545278252",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 545278252,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NTI3ODI1Mg==",
    "user": {
      "login": "james-ray",
      "id": 26137182,
      "node_id": "MDQ6VXNlcjI2MTM3MTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/26137182?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/james-ray",
      "html_url": "https://github.com/james-ray",
      "followers_url": "https://api.github.com/users/james-ray/followers",
      "following_url": "https://api.github.com/users/james-ray/following{/other_user}",
      "gists_url": "https://api.github.com/users/james-ray/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/james-ray/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/james-ray/subscriptions",
      "organizations_url": "https://api.github.com/users/james-ray/orgs",
      "repos_url": "https://api.github.com/users/james-ray/repos",
      "events_url": "https://api.github.com/users/james-ray/events{/privacy}",
      "received_events_url": "https://api.github.com/users/james-ray/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-23T05:49:54Z",
    "updated_at": "2019-10-23T05:49:54Z",
    "author_association": "NONE",
    "body": "Indeed, I've modified code to copy the big.int, but the mem problem still appears, I temporally close this, if I have some new discovery, I might open a new issue.\r\n```\r\nALL                32049475  2161.502 MB\r\nbig.Int            22892037  1362.276 MB\r\ntypes.Transaction   4578205   676.761 MB\r\ncommon.Address      4578205    87.322 MB\r\ntypes.Block             256    34.970 MB\r\ntypes.Header            256   136.000 KB\r\nsimplelru.entry         256    16.000 KB\r\nsimplelru.LRU             1    14.031 KB\r\nlist.Element            256    10.000 KB\r\nlist.List                 1         48 B\r\nlru.Cache                 1         32 B\r\n*lru.Cache                1          8 B\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/545278252/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/545339639",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-545339639",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 545339639,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NTMzOTYzOQ==",
    "user": {
      "login": "james-ray",
      "id": 26137182,
      "node_id": "MDQ6VXNlcjI2MTM3MTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/26137182?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/james-ray",
      "html_url": "https://github.com/james-ray",
      "followers_url": "https://api.github.com/users/james-ray/followers",
      "following_url": "https://api.github.com/users/james-ray/following{/other_user}",
      "gists_url": "https://api.github.com/users/james-ray/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/james-ray/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/james-ray/subscriptions",
      "organizations_url": "https://api.github.com/users/james-ray/orgs",
      "repos_url": "https://api.github.com/users/james-ray/repos",
      "events_url": "https://api.github.com/users/james-ray/events{/privacy}",
      "received_events_url": "https://api.github.com/users/james-ray/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-23T08:49:52Z",
    "updated_at": "2019-10-23T09:05:49Z",
    "author_association": "NONE",
    "body": "It might be a normal case. We have nearly 20000 txs in each block, so 256*20000=512 0000 txs, it is not a small number, the allocated memory may exceeds limit because of this. The total memory on our test virtual machine is 8G.\r\nWe have modified the 256 to 64 to confirm this.\r\nThanks for recommending the memsize tool which helps us find the cause of the issue.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/545339639/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/545346314",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-545346314",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 545346314,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NTM0NjMxNA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-23T09:06:03Z",
    "updated_at": "2019-10-23T09:06:03Z",
    "author_association": "MEMBER",
    "body": "> We have nearly 20000 txs in each block, so 256*20000=512 0000 txs, \r\n\r\nOh, right, yes, that definitely explains it :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/545346314/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/545347609",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20192#issuecomment-545347609",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20192",
    "id": 545347609,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NTM0NzYwOQ==",
    "user": {
      "login": "james-ray",
      "id": 26137182,
      "node_id": "MDQ6VXNlcjI2MTM3MTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/26137182?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/james-ray",
      "html_url": "https://github.com/james-ray",
      "followers_url": "https://api.github.com/users/james-ray/followers",
      "following_url": "https://api.github.com/users/james-ray/following{/other_user}",
      "gists_url": "https://api.github.com/users/james-ray/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/james-ray/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/james-ray/subscriptions",
      "organizations_url": "https://api.github.com/users/james-ray/orgs",
      "repos_url": "https://api.github.com/users/james-ray/repos",
      "events_url": "https://api.github.com/users/james-ray/events{/privacy}",
      "received_events_url": "https://api.github.com/users/james-ray/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-23T09:09:19Z",
    "updated_at": "2019-10-23T09:11:47Z",
    "author_association": "NONE",
    "body": "Yes, the reason why local test cannot reproduce it is because the consensus of a single node is very fast, less than 1 second per block, while in multiple nodes, it may need at least 3 seconds, and if we think they take turns to make block, then 7 nodes means 21 seconds to make a block, so the in txs > the output capability, the memPool got full filled, causing each block carries the maximum txs---nearly 20000.\r\nWhile in local mode, the block commits so fast that each block carries only less than 2000 txs, so the allocated memory wouldn't be that large.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/545347609/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
