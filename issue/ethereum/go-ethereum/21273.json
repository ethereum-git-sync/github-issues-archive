{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/21273",
  "id": 647813079,
  "node_id": "MDU6SXNzdWU2NDc4MTMwNzk=",
  "number": 21273,
  "title": "It takes much more time to gracefully shutdown",
  "user": {
    "login": "haihongS",
    "id": 8394303,
    "node_id": "MDQ6VXNlcjgzOTQzMDM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8394303?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/haihongS",
    "html_url": "https://github.com/haihongS",
    "followers_url": "https://api.github.com/users/haihongS/followers",
    "following_url": "https://api.github.com/users/haihongS/following{/other_user}",
    "gists_url": "https://api.github.com/users/haihongS/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/haihongS/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/haihongS/subscriptions",
    "organizations_url": "https://api.github.com/users/haihongS/orgs",
    "repos_url": "https://api.github.com/users/haihongS/repos",
    "events_url": "https://api.github.com/users/haihongS/events{/privacy}",
    "received_events_url": "https://api.github.com/users/haihongS/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1486629004,
      "node_id": "MDU6TGFiZWwxNDg2NjI5MDA0",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/priority:2",
      "name": "priority:2",
      "color": "f76ac8",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 19,
  "created_at": "2020-06-30T02:55:03Z",
  "updated_at": "2021-01-27T13:26:44Z",
  "closed_at": "2021-01-27T13:26:44Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## System information\r\n\r\nGeth version: `geth 1.9.14-stable` `geth 1.9.15-stable`\r\nOS & Version: Linux-Ubuntu-18.04\r\n\r\n#### Expected behaviour\r\nAfter using `kill` command (without -9) to realize the gracefully shutdown, the node will usually take several minutes to fullfil it.\r\n\r\n#### Actual behaviour\r\nIt took much more time and I don't have the real duration time right now cuz I can't wait so much time.\r\n\r\nIt worked fine in old version, or at least before 1.9.13.",
  "closed_by": {
    "login": "MariusVanDerWijden",
    "id": 16664698,
    "node_id": "MDQ6VXNlcjE2NjY0Njk4",
    "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/MariusVanDerWijden",
    "html_url": "https://github.com/MariusVanDerWijden",
    "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
    "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
    "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
    "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
    "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
    "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
    "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/651604094",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-651604094",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 651604094,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MTYwNDA5NA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-30T07:28:47Z",
    "updated_at": "2020-06-30T07:28:47Z",
    "author_association": "MEMBER",
    "body": "It can still take quite some time, however, we had one regression in this area -- see https://github.com/ethereum/go-ethereum/issues/21087 . Fixed here: https://github.com/ethereum/go-ethereum/pull/21114 -- so this should not be an issue as of `1.9.15`. What times are you seeing with `1.9.15-stable` ? ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/651604094/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/653299885",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-653299885",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 653299885,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MzI5OTg4NQ==",
    "user": {
      "login": "haihongS",
      "id": 8394303,
      "node_id": "MDQ6VXNlcjgzOTQzMDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8394303?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haihongS",
      "html_url": "https://github.com/haihongS",
      "followers_url": "https://api.github.com/users/haihongS/followers",
      "following_url": "https://api.github.com/users/haihongS/following{/other_user}",
      "gists_url": "https://api.github.com/users/haihongS/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haihongS/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haihongS/subscriptions",
      "organizations_url": "https://api.github.com/users/haihongS/orgs",
      "repos_url": "https://api.github.com/users/haihongS/repos",
      "events_url": "https://api.github.com/users/haihongS/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haihongS/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-03T02:21:33Z",
    "updated_at": "2020-07-03T02:21:33Z",
    "author_association": "NONE",
    "body": "not be much certain about it, the version of go seems to affect it.\r\nbtw, I have shut it down gracefully with go-1.14.4",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/653299885/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/655049946",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-655049946",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 655049946,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NTA0OTk0Ng==",
    "user": {
      "login": "pyggie",
      "id": 56756534,
      "node_id": "MDQ6VXNlcjU2NzU2NTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/56756534?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pyggie",
      "html_url": "https://github.com/pyggie",
      "followers_url": "https://api.github.com/users/pyggie/followers",
      "following_url": "https://api.github.com/users/pyggie/following{/other_user}",
      "gists_url": "https://api.github.com/users/pyggie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pyggie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pyggie/subscriptions",
      "organizations_url": "https://api.github.com/users/pyggie/orgs",
      "repos_url": "https://api.github.com/users/pyggie/repos",
      "events_url": "https://api.github.com/users/pyggie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pyggie/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-07T18:40:21Z",
    "updated_at": "2020-07-07T18:45:50Z",
    "author_association": "NONE",
    "body": "In my experience with `1.9.15-stable` on Linux, attempts to do a graceful shutdown (with `kill -INT`) fail close to half the time. Here is an example where it hung for 12 minutes before I killed it:\r\n```\r\nINFO [07-07|18:07:24.530] Imported new chain segment               blocks=1  txs=142  mgas=11.432  elapsed=204.086ms mgasps=56.015  number=10413888 hash=\"07fbdc…623da6\" dirty=1.16GiB\r\nINFO [07-07|18:08:00.490] Deep froze chain segment                 blocks=3  elapsed=29.468ms  number=10323887 hash=\"ea9e4e…1bc503\"\r\nINFO [07-07|18:08:33.645] Imported new chain segment               blocks=1  txs=219  mgas=11.445  elapsed=285.878ms mgasps=40.033  number=10413889 hash=\"ef4184…d6a5d5\" age=1m9s  dirty=1.16GiB\r\nINFO [07-07|18:08:36.592] Imported new chain segment               blocks=1  txs=148  mgas=11.445  elapsed=206.105ms mgasps=55.531  number=10413890 hash=\"6df938…414e97\" dirty=1.16GiB\r\nINFO [07-07|18:09:00.518] Deep froze chain segment                 blocks=2  elapsed=27.171ms  number=10323889 hash=\"9c028a…d8623a\"\r\nINFO [07-07|18:09:05.858] Imported new chain segment               blocks=1  txs=209  mgas=11.453  elapsed=264.543ms mgasps=43.292  number=10413891 hash=\"6bc225…7a5786\" dirty=1.16GiB\r\nINFO [07-07|18:09:35.854] Got interrupt, shutting down...\r\nINFO [07-07|18:09:35.857] WebSocket endpoint closed                url=ws://127.0.0.1:8546\r\nINFO [07-07|18:09:35.857] HTTP endpoint closed                     url=http://127.0.0.1:8545/\r\nINFO [07-07|18:09:35.857] IPC endpoint closed                      url=/mnt/data/geth/geth.ipc\r\nINFO [07-07|18:10:00.548] Deep froze chain segment                 blocks=1  elapsed=25.745ms  number=10323890 hash=\"f97e43…dc7cc3\"\r\nINFO [07-07|18:11:40.334] Regenerated local transaction journal    transactions=0 accounts=0\r\nWARN [07-07|18:21:08.194] Already shutting down, interrupt more to panic. times=9\r\nWARN [07-07|18:21:38.055] Already shutting down, interrupt more to panic. times=8\r\nWARN [07-07|18:21:38.330] Already shutting down, interrupt more to panic. times=7\r\nWARN [07-07|18:21:38.561] Already shutting down, interrupt more to panic. times=6\r\nWARN [07-07|18:21:38.755] Already shutting down, interrupt more to panic. times=5\r\nWARN [07-07|18:21:38.969] Already shutting down, interrupt more to panic. times=4\r\nWARN [07-07|18:21:39.158] Already shutting down, interrupt more to panic. times=3\r\nWARN [07-07|18:21:39.446] Already shutting down, interrupt more to panic. times=2\r\nWARN [07-07|18:21:39.706] Already shutting down, interrupt more to panic. times=1\r\npanic: boom\r\n```\r\n\r\nAfter this type of shutdown, geth needs to resync 12+ hours of blocks. Here is the start of the next log:\r\n```\r\n...\r\nWARN [07-07|18:22:03.665] Head state missing, repairing chain      number=10413891 hash=\"6bc225…7a5786\"\r\nINFO [07-07|18:22:08.179] Rewound blockchain to past state         number=10409573 hash=\"45c1b9…7b0b34\"\r\nINFO [07-07|18:22:08.180] Loaded most recent local header          number=10413891 hash=\"6bc225…7a5786\" td=16231628092636980686757 age=13m32s\r\nINFO [07-07|18:22:08.181] Loaded most recent local full block      number=10409573 hash=\"45c1b9…7b0b34\" td=16221582921520066392361 age=16h13m6s\r\nINFO [07-07|18:22:08.181] Loaded most recent local fast block      number=10413891 hash=\"6bc225…7a5786\" td=16231628092636980686757 age=13m32s\r\nINFO [07-07|18:22:08.187] Regenerated local transaction journal    transactions=0 accounts=0\r\nWARN [07-07|18:22:08.187] Switch sync mode from fast sync to full sync\r\n...\r\nINFO [07-07|18:22:35.253] Block synchronisation started\r\nINFO [07-07|18:22:38.720] Looking for peers                        peercount=4 tried=50 static=0\r\nINFO [07-07|18:22:46.053] Importing heavy sidechain segment        blocks=1748 start=10409574 end=10411321\r\nINFO [07-07|18:22:48.735] Looking for peers                        peercount=6 tried=53 static=0\r\nINFO [07-07|18:22:55.354] Imported new chain segment               blocks=7    txs=1129 mgas=83.824 elapsed=9.298s mgasps=9.014 number=10409580 hash=\"df460b…efe538\" age=16h12m27s dirty=10.12MiB\r\nINFO [07-07|18:22:58.756] Looking for peers                        peercount=7 tried=64 static=0\r\nINFO [07-07|18:23:04.398] Imported new chain segment               blocks=9    txs=1612 mgas=107.734 elapsed=9.044s mgasps=11.911 number=10409589 hash=\"be8532…b9cce0\" age=16h10m11s dirty=23.58MiB\r\n```\r\n\r\nThe shutdown problem wouldn't be so bad if there were some way to tell geth it should persist the trie data to disk more frequently. Is there a way to trigger this via the admin interface?\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/655049946/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/655054494",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-655054494",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 655054494,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NTA1NDQ5NA==",
    "user": {
      "login": "pyggie",
      "id": 56756534,
      "node_id": "MDQ6VXNlcjU2NzU2NTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/56756534?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pyggie",
      "html_url": "https://github.com/pyggie",
      "followers_url": "https://api.github.com/users/pyggie/followers",
      "following_url": "https://api.github.com/users/pyggie/following{/other_user}",
      "gists_url": "https://api.github.com/users/pyggie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pyggie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pyggie/subscriptions",
      "organizations_url": "https://api.github.com/users/pyggie/orgs",
      "repos_url": "https://api.github.com/users/pyggie/repos",
      "events_url": "https://api.github.com/users/pyggie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pyggie/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-07T18:49:39Z",
    "updated_at": "2020-07-07T18:49:39Z",
    "author_association": "NONE",
    "body": "As a contrast, here is a successful graceful shutdown. Notice several messages that are missing from my previous comment: \"Ethereum protocol stopped\", \"Transaction pool stopped\", \"Writing cached state to disk\", etc.\r\n```\r\nINFO [07-07|18:46:49.369] Imported new chain segment               blocks=1    txs=161  mgas=11.685  elapsed=489.591ms mgasps=23.867 number=10414060 hash=\"f67e17…d5f503\" dirty=1.20GiB\r\nINFO [07-07|18:46:49.464] Got interrupt, shutting down...\r\nINFO [07-07|18:46:49.465] WebSocket endpoint closed                url=ws://127.0.0.1:8546\r\nINFO [07-07|18:46:49.467] HTTP endpoint closed                     url=http://127.0.0.1:8545/\r\nINFO [07-07|18:46:49.467] IPC endpoint closed                      url=/mnt/data/geth/geth.ipc\r\nINFO [07-07|18:46:50.283] Ethereum protocol stopped\r\nINFO [07-07|18:46:51.551] Transaction pool stopped\r\nINFO [07-07|18:46:51.551] Writing cached state to disk             block=10414060 hash=\"f67e17…d5f503\" root=\"cdac03…34b3e3\"\r\nINFO [07-07|18:46:53.395] Looking for peers                        peercount=3  tried=110 static=0\r\nINFO [07-07|18:47:03.396] Looking for peers                        peercount=1  tried=126 static=0\r\nINFO [07-07|18:47:13.043] Deep froze chain segment                 blocks=6    elapsed=2.205s    number=10324059 hash=\"e42831…9eacc6\"\r\nINFO [07-07|18:47:13.495] Looking for peers                        peercount=0  tried=96  static=0\r\nINFO [07-07|18:47:23.555] Looking for peers                        peercount=0  tried=89  static=0\r\nINFO [07-07|18:47:33.715] Looking for peers                        peercount=0  tried=38  static=0\r\nINFO [07-07|18:47:38.952] Persisted trie from memory database      nodes=3311178 size=771.17MiB time=54.864502019s gcnodes=10625002 gcsize=4.19GiB gctime=1m6.848151152s livenodes=301947 livesize=122.08MiB\r\nINFO [07-07|18:47:38.952] Writing cached state to disk             block=10414059 hash=\"c74f92…d3da0f\" root=\"fc2dc7…0d09e2\"\r\nINFO [07-07|18:47:39.001] Persisted trie from memory database      nodes=2811    size=1.13MiB   time=49.192309ms   gcnodes=0        gcsize=0.00B   gctime=0s             livenodes=299136 livesize=120.95MiB\r\nINFO [07-07|18:47:39.001] Writing cached state to disk             block=10413933 hash=\"e83f59…231923\" root=\"531dd1…8a453c\"\r\nINFO [07-07|18:47:42.101] Persisted trie from memory database      nodes=106837  size=42.34MiB  time=3.099705433s  gcnodes=0        gcsize=0.00B   gctime=0s             livenodes=192299 livesize=78.61MiB\r\nINFO [07-07|18:47:42.947] Blockchain stopped\r\nINFO [07-07|18:47:43.791] Looking for peers                        peercount=1  tried=73  static=0\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/655054494/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/655097133",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-655097133",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 655097133,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NTA5NzEzMw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-07T20:03:02Z",
    "updated_at": "2020-07-07T20:03:02Z",
    "author_association": "MEMBER",
    "body": "If you still have the stack trace following the 'boom', then we might be able to figure it out...?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/655097133/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/655150684",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-655150684",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 655150684,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NTE1MDY4NA==",
    "user": {
      "login": "pyggie",
      "id": 56756534,
      "node_id": "MDQ6VXNlcjU2NzU2NTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/56756534?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pyggie",
      "html_url": "https://github.com/pyggie",
      "followers_url": "https://api.github.com/users/pyggie/followers",
      "following_url": "https://api.github.com/users/pyggie/following{/other_user}",
      "gists_url": "https://api.github.com/users/pyggie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pyggie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pyggie/subscriptions",
      "organizations_url": "https://api.github.com/users/pyggie/orgs",
      "repos_url": "https://api.github.com/users/pyggie/repos",
      "events_url": "https://api.github.com/users/pyggie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pyggie/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-07T21:40:55Z",
    "updated_at": "2020-07-07T21:40:55Z",
    "author_association": "NONE",
    "body": "I do, it's large, what is the best way to share?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/655150684/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/655156764",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-655156764",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 655156764,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NTE1Njc2NA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-07T21:55:59Z",
    "updated_at": "2020-07-07T21:55:59Z",
    "author_association": "MEMBER",
    "body": "Maybe pastebin or something similar? Or a github repo? ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/655156764/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/655192129",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-655192129",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 655192129,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NTE5MjEyOQ==",
    "user": {
      "login": "pyggie",
      "id": 56756534,
      "node_id": "MDQ6VXNlcjU2NzU2NTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/56756534?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pyggie",
      "html_url": "https://github.com/pyggie",
      "followers_url": "https://api.github.com/users/pyggie/followers",
      "following_url": "https://api.github.com/users/pyggie/following{/other_user}",
      "gists_url": "https://api.github.com/users/pyggie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pyggie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pyggie/subscriptions",
      "organizations_url": "https://api.github.com/users/pyggie/orgs",
      "repos_url": "https://api.github.com/users/pyggie/repos",
      "events_url": "https://api.github.com/users/pyggie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pyggie/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-07T23:29:28Z",
    "updated_at": "2020-07-07T23:29:28Z",
    "author_association": "NONE",
    "body": "I created a gist for the panic log: https://gist.github.com/pyggie/e63de7001a07974b81c111f82a7f302e",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/655192129/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/656220631",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-656220631",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 656220631,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NjIyMDYzMQ==",
    "user": {
      "login": "pyggie",
      "id": 56756534,
      "node_id": "MDQ6VXNlcjU2NzU2NTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/56756534?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pyggie",
      "html_url": "https://github.com/pyggie",
      "followers_url": "https://api.github.com/users/pyggie/followers",
      "following_url": "https://api.github.com/users/pyggie/following{/other_user}",
      "gists_url": "https://api.github.com/users/pyggie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pyggie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pyggie/subscriptions",
      "organizations_url": "https://api.github.com/users/pyggie/orgs",
      "repos_url": "https://api.github.com/users/pyggie/repos",
      "events_url": "https://api.github.com/users/pyggie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pyggie/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-09T16:16:04Z",
    "updated_at": "2020-07-09T16:16:04Z",
    "author_association": "NONE",
    "body": "The next time I tried to stop this same geth instance, it hung again. During the shutdown process it reported \"Submitted transaction\" for some local transactions that were about an hour old. It never reported \"Ethereum protocol stopped\", \"Transaction pool stopped\", \"Writing cached state to disk\", etc. This time I let the shutdown process run for many hours (CPU load and network load remained high, disk load dropped) but it never completed:\r\n```\r\nINFO [07-09|08:35:04.334] Imported new chain segment               blocks=1  txs=193 mgas=11.892 elapsed=269.299ms mgasps=44.158  number=10424284 hash=\"603061…812cbd\" dirty=1.08GiB\r\nINFO [07-09|08:35:13.998] Imported new chain segment               blocks=1  txs=245 mgas=11.870 elapsed=257.851ms mgasps=46.033  number=10424285 hash=\"21969e…feaa73\" dirty=1.08GiB\r\nINFO [07-09|08:35:14.526] Deep froze chain segment                 blocks=6  elapsed=47.092ms  number=10334284 hash=\"3b0064…405c2b\"\r\nINFO [07-09|08:35:34.137] Imported new chain segment               blocks=1  txs=233 mgas=11.852 elapsed=3.725s    mgasps=3.181   number=10424286 hash=\"1e851c…f27647\" dirty=1.08GiB\r\nINFO [07-09|08:35:38.324] Got interrupt, shutting down...\r\nINFO [07-09|08:35:38.330] WebSocket endpoint closed                url=ws://127.0.0.1:8546\r\nINFO [07-09|08:35:38.336] HTTP endpoint closed                     url=http://127.0.0.1:8545/\r\nINFO [07-09|08:35:38.337] IPC endpoint closed                      url=/mnt/data/geth/geth.ipc\r\nINFO [07-09|08:35:38.618] Imported new chain segment               blocks=1  txs=169 mgas=11.819 elapsed=3.136s    mgasps=3.768   number=10424287 hash=\"830031…4ed9c7\" dirty=1.08GiB\r\nINFO [07-09|08:35:44.186] Submitted transaction                    fullhash=0x... recipient=0x...\r\nINFO [07-09|08:35:44.187] Submitted transaction                    fullhash=0x... recipient=0x...\r\nINFO [07-09|08:35:44.187] Submitted transaction                    fullhash=0x... recipient=0x...\r\nINFO [07-09|08:36:14.553] Deep froze chain segment                 blocks=2  elapsed=27.038ms  number=10334286 hash=\"dbe99c…0acbd6\"\r\nINFO [07-09|08:56:18.618] Regenerated local transaction journal    transactions=0 accounts=0\r\nINFO [07-09|09:56:18.657] Regenerated local transaction journal    transactions=0 accounts=0\r\nINFO [07-09|10:56:18.636] Regenerated local transaction journal    transactions=0 accounts=0\r\nINFO [07-09|11:56:18.683] Regenerated local transaction journal    transactions=0 accounts=0\r\nINFO [07-09|12:56:18.694] Regenerated local transaction journal    transactions=0 accounts=0\r\nINFO [07-09|13:56:18.617] Regenerated local transaction journal    transactions=0 accounts=0\r\nINFO [07-09|14:56:18.598] Regenerated local transaction journal    transactions=0 accounts=0\r\nINFO [07-09|15:56:18.665] Regenerated local transaction journal    transactions=0 accounts=0\r\nWARN [07-09|16:01:27.385] Already shutting down, interrupt more to panic. times=9\r\nWARN [07-09|16:01:34.931] Already shutting down, interrupt more to panic. times=8\r\nWARN [07-09|16:01:35.298] Already shutting down, interrupt more to panic. times=7\r\nWARN [07-09|16:01:35.651] Already shutting down, interrupt more to panic. times=6\r\nWARN [07-09|16:01:35.962] Already shutting down, interrupt more to panic. times=5\r\nWARN [07-09|16:01:36.350] Already shutting down, interrupt more to panic. times=4\r\nWARN [07-09|16:01:36.716] Already shutting down, interrupt more to panic. times=3\r\nWARN [07-09|16:01:37.095] Already shutting down, interrupt more to panic. times=2\r\nWARN [07-09|16:01:37.440] Already shutting down, interrupt more to panic. times=1\r\npanic: boom\r\n```\r\n\r\nUpon restart it needed to resync 21 hours of blocks:\r\n```\r\n...\r\nWARN [07-09|16:02:20.290] Head state missing, repairing chain      number=10424287 hash=\"830031…4ed9c7\"\r\nINFO [07-09|16:02:25.355] Rewound blockchain to past state         number=10420582 hash=\"a18f55…90a05b\"\r\nINFO [07-09|16:02:25.356] Loaded most recent local header          number=10424287 hash=\"830031…4ed9c7\" td=16256859510604898421154 age=7h26m55s\r\nINFO [07-09|16:02:25.356] Loaded most recent local full block      number=10420582 hash=\"a18f55…90a05b\" td=16247815226581652244543 age=21h11m52s\r\nINFO [07-09|16:02:25.356] Loaded most recent local fast block      number=10424287 hash=\"830031…4ed9c7\" td=16256859510604898421154 age=7h26m55s\r\nINFO [07-09|16:02:25.357] Regenerated local transaction journal    transactions=0 accounts=0\r\nWARN [07-09|16:02:25.357] Switch sync mode from fast sync to full sync\r\n...\r\nINFO [07-09|16:02:47.241] Imported new chain segment               blocks=5    txs=670 mgas=47.138 elapsed=9.101s mgasps=5.179 number=10420587 hash=\"403eed…132732\" age=21h11m18s dirty=6.48MiB\r\nINFO [07-09|16:02:55.360] Imported new chain segment               blocks=8    txs=1497 mgas=82.279 elapsed=8.118s mgasps=10.135 number=10420595 hash=\"0fedf2…672650\" age=21h9m10s  dirty=17.34MiB\r\nINFO [07-09|16:03:04.535] Imported new chain segment               blocks=9    txs=1629 mgas=105.345 elapsed=9.175s mgasps=11.481 number=10420604 hash=\"bb4cc5…e03648\" age=21h5m36s  dirty=31.35MiB\r\n```\r\n\r\nAs a workaround, is there any way I can ask geth to write the trie data to disk? Or increase the frequency that is done automatically?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/656220631/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/656233504",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-656233504",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 656233504,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NjIzMzUwNA==",
    "user": {
      "login": "pyggie",
      "id": 56756534,
      "node_id": "MDQ6VXNlcjU2NzU2NTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/56756534?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pyggie",
      "html_url": "https://github.com/pyggie",
      "followers_url": "https://api.github.com/users/pyggie/followers",
      "following_url": "https://api.github.com/users/pyggie/following{/other_user}",
      "gists_url": "https://api.github.com/users/pyggie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pyggie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pyggie/subscriptions",
      "organizations_url": "https://api.github.com/users/pyggie/orgs",
      "repos_url": "https://api.github.com/users/pyggie/repos",
      "events_url": "https://api.github.com/users/pyggie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pyggie/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-09T16:42:43Z",
    "updated_at": "2020-07-09T16:42:52Z",
    "author_association": "NONE",
    "body": " I added the boom stack trace for the second incident as a second file (geth.2.log) in the same gist:\r\nhttps://gist.github.com/pyggie/e63de7001a07974b81c111f82a7f302e\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/656233504/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/659244591",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-659244591",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 659244591,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1OTI0NDU5MQ==",
    "user": {
      "login": "adamschmideg",
      "id": 208822,
      "node_id": "MDQ6VXNlcjIwODgyMg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/208822?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/adamschmideg",
      "html_url": "https://github.com/adamschmideg",
      "followers_url": "https://api.github.com/users/adamschmideg/followers",
      "following_url": "https://api.github.com/users/adamschmideg/following{/other_user}",
      "gists_url": "https://api.github.com/users/adamschmideg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/adamschmideg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adamschmideg/subscriptions",
      "organizations_url": "https://api.github.com/users/adamschmideg/orgs",
      "repos_url": "https://api.github.com/users/adamschmideg/repos",
      "events_url": "https://api.github.com/users/adamschmideg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/adamschmideg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-16T08:22:47Z",
    "updated_at": "2020-07-16T08:22:47Z",
    "author_association": "MEMBER",
    "body": "One more step for us: write a script that starts Geth and kills it after a few minutes and keeps repeating this.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/659244591/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/659562635",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-659562635",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 659562635,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1OTU2MjYzNQ==",
    "user": {
      "login": "pyggie",
      "id": 56756534,
      "node_id": "MDQ6VXNlcjU2NzU2NTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/56756534?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pyggie",
      "html_url": "https://github.com/pyggie",
      "followers_url": "https://api.github.com/users/pyggie/followers",
      "following_url": "https://api.github.com/users/pyggie/following{/other_user}",
      "gists_url": "https://api.github.com/users/pyggie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pyggie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pyggie/subscriptions",
      "organizations_url": "https://api.github.com/users/pyggie/orgs",
      "repos_url": "https://api.github.com/users/pyggie/repos",
      "events_url": "https://api.github.com/users/pyggie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pyggie/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-16T17:35:36Z",
    "updated_at": "2020-07-16T17:35:36Z",
    "author_association": "NONE",
    "body": "> One more step for us: write a script that starts Geth and kills it after a few minutes and keeps repeating this.\r\n\r\nNot sure I understand: Is something you would like me to do? And then post logs?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/659562635/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/660118746",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-660118746",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 660118746,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2MDExODc0Ng==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-17T13:51:50Z",
    "updated_at": "2020-07-17T13:51:50Z",
    "author_association": "MEMBER",
    "body": "@pyggie No that is something the geth team will take care off. We have weekly meetings where we look at pressing issues and sometimes we add some reminder for ourselves into the issues s.th. we don't forget about it.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/660118746/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/660464002",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-660464002",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 660464002,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2MDQ2NDAwMg==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-18T10:42:53Z",
    "updated_at": "2020-07-18T10:44:57Z",
    "author_association": "MEMBER",
    "body": "This trace is interesting. The blockchain is fully spun down (no activity), as also evidenced by this line: \r\n```\r\nINFO [07-07|18:47:42.947] Blockchain stopped\r\n```\r\n\r\nEDIT: No wait, that log is from the example where it stopped gracefully. Odd. \r\nAlso the downloader and sync are no longer active. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/660464002/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/660465024",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-660465024",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 660465024,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2MDQ2NTAyNA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-18T10:51:58Z",
    "updated_at": "2020-07-18T10:51:58Z",
    "author_association": "MEMBER",
    "body": "So, it seems to be hung waiting in the ProtocolManager\r\n\r\n```golang\r\nfunc (pm *ProtocolManager) Stop() {\r\n\tpm.txsSub.Unsubscribe()        // quits txBroadcastLoop\r\n\tpm.minedBlockSub.Unsubscribe() // quits blockBroadcastLoop\r\n\r\n\t// Quit chainSync and txsync64.\r\n\t// After this is done, no new peers will be accepted.\r\n\tclose(pm.quitSync)\r\n\tpm.wg.Wait()\r\n```\r\n```\r\ngoroutine 45904157 [semacquire, 446 minutes]:\r\nsync.runtime_Semacquire(0xc00019e7e0)\r\n\t/home/travis/.gimme/versions/go1.14.4.linux.amd64/src/runtime/sema.go:56 +0x42\r\nsync.(*WaitGroup).Wait(0xc00019e7d8)\r\n\t/home/travis/.gimme/versions/go1.14.4.linux.amd64/src/sync/waitgroup.go:130 +0x64\r\ngithub.com/ethereum/go-ethereum/eth.(*ProtocolManager).Stop(0xc00019e700)\r\n\t/home/travis/gopath/src/github.com/ethereum/go-ethereum/eth/handler.go:280 +0x7d\r\ngithub.com/ethereum/go-ethereum/eth.(*Ethereum).Stop(0xc0002ded20, 0xc000182a20, 0xc146839f48)\r\n```\r\n\r\nThe 'runaway' goroutine seems to be this one: \r\n```\r\ngoroutine 42380773 [select, 1239 minutes]:\r\ngithub.com/ethereum/go-ethereum/eth.(*peer).AsyncSendPooledTransactionHashes(0xc0d6a4dad0, 0xc05c728000, 0x185d0, 0x185d0)\r\n\t/home/travis/gopath/src/github.com/ethereum/go-ethereum/eth/peer.go:397 +0xfb\r\ngithub.com/ethereum/go-ethereum/eth.(*ProtocolManager).syncTransactions(0xc00019e700, 0xc0d6a4dad0)\r\n\t/home/travis/gopath/src/github.com/ethereum/go-ethereum/eth/sync.go:71 +0x2a2\r\ngithub.com/ethereum/go-ethereum/eth.(*ProtocolManager).handle(0xc00019e700, 0xc0d6a4dad0, 0x0, 0x0)\r\n```\r\nOn `1.9.15`, that line is here: https://github.com/ethereum/go-ethereum/blob/v1.9.15/eth/peer.go#L397 \r\n\r\nI _suspect_ this is an issue that was fixed by https://github.com/ethereum/go-ethereum/commit/34ed2d834a7786e4ae3c24fbcea6cc236bc644f7 , which should be included in `1.9.16`. @karalabe do you agree? ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/660465024/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/768264284",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-768264284",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 768264284,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2ODI2NDI4NA==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-27T12:51:17Z",
    "updated_at": "2021-01-27T12:51:17Z",
    "author_association": "MEMBER",
    "body": "I wrote a script that runs a goerli node for 5 minutes at a time and interrupts it afterwards. If geth didn't shutdown in 2 minutes it will notify me. I'll let it run for some iterations and check back. Script is here: https://github.com/MariusVanDerWijden/go-snippets/tree/master/gethshutdown",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/768264284/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/768267735",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-768267735",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 768267735,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2ODI2NzczNQ==",
    "user": {
      "login": "haihongS",
      "id": 8394303,
      "node_id": "MDQ6VXNlcjgzOTQzMDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8394303?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haihongS",
      "html_url": "https://github.com/haihongS",
      "followers_url": "https://api.github.com/users/haihongS/followers",
      "following_url": "https://api.github.com/users/haihongS/following{/other_user}",
      "gists_url": "https://api.github.com/users/haihongS/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haihongS/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haihongS/subscriptions",
      "organizations_url": "https://api.github.com/users/haihongS/orgs",
      "repos_url": "https://api.github.com/users/haihongS/repos",
      "events_url": "https://api.github.com/users/haihongS/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haihongS/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-27T12:57:55Z",
    "updated_at": "2021-01-27T12:57:55Z",
    "author_association": "NONE",
    "body": "almost forgot it :)\r\n\r\nhas this problem been solved?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/768267735/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/768270002",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-768270002",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 768270002,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2ODI3MDAwMg==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-27T13:02:04Z",
    "updated_at": "2021-01-27T13:02:04Z",
    "author_association": "MEMBER",
    "body": "Well almost, it still takes a long time to shutdown (1-2 minutes), but I don't think it deadlocks anymore. I'll run my script for a bit and see if I can repro any deadlocks. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/768270002/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/768282793",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21273#issuecomment-768282793",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21273",
    "id": 768282793,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2ODI4Mjc5Mw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-27T13:24:24Z",
    "updated_at": "2021-01-27T13:24:24Z",
    "author_association": "MEMBER",
    "body": "We have had deadlocks during shutdown, as far as I can remember, we've found and fixed two such issues since june 2020. I think it's safe to close this",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/768282793/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
