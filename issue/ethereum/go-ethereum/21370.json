{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/21370",
  "id": 665213733,
  "node_id": "MDU6SXNzdWU2NjUyMTM3MzM=",
  "number": 21370,
  "title": "UPnP does not work",
  "user": {
    "login": "3esmit",
    "id": 224810,
    "node_id": "MDQ6VXNlcjIyNDgxMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/3esmit",
    "html_url": "https://github.com/3esmit",
    "followers_url": "https://api.github.com/users/3esmit/followers",
    "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
    "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
    "organizations_url": "https://api.github.com/users/3esmit/orgs",
    "repos_url": "https://api.github.com/users/3esmit/repos",
    "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
    "received_events_url": "https://api.github.com/users/3esmit/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "fjl",
    "id": 6915,
    "node_id": "MDQ6VXNlcjY5MTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fjl",
    "html_url": "https://github.com/fjl",
    "followers_url": "https://api.github.com/users/fjl/followers",
    "following_url": "https://api.github.com/users/fjl/following{/other_user}",
    "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
    "organizations_url": "https://api.github.com/users/fjl/orgs",
    "repos_url": "https://api.github.com/users/fjl/repos",
    "events_url": "https://api.github.com/users/fjl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fjl/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 30,
  "created_at": "2020-07-24T14:39:15Z",
  "updated_at": "2020-08-05T07:51:38Z",
  "closed_at": "2020-08-05T07:51:38Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nVersion: 1.9.17-stable\r\nGit Commit: 748f22c192d24082723f935afd0b0b63e7fd50f4\r\nArchitecture: amd64\r\nProtocol Versions: [65 64 63]\r\nGo Version: go1.14.2\r\nOperating System: linux\r\nGOPATH=\r\nGOROOT=/build/ethereum-oJIima/.go\r\n\r\nRouter = ZTE F660\r\n\r\n#### Expected behaviour\r\n\r\nUPnP gets mapped into the router.\r\n\r\nEven when using flag `--nat upnp` don't works.\r\n\r\n#### Actual behaviour\r\n\r\nNothing happens.\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\nNot sure.",
  "closed_by": {
    "login": "fjl",
    "id": 6915,
    "node_id": "MDQ6VXNlcjY5MTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fjl",
    "html_url": "https://github.com/fjl",
    "followers_url": "https://api.github.com/users/fjl/followers",
    "following_url": "https://api.github.com/users/fjl/following{/other_user}",
    "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
    "organizations_url": "https://api.github.com/users/fjl/orgs",
    "repos_url": "https://api.github.com/users/fjl/repos",
    "events_url": "https://api.github.com/users/fjl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fjl/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/664857755",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-664857755",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 664857755,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NDg1Nzc1NQ==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-28T08:29:38Z",
    "updated_at": "2020-07-28T08:29:38Z",
    "author_association": "MEMBER",
    "body": "Can you share logs with `--vmodule=p2p/nat=6` please?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/664857755/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/665295144",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-665295144",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 665295144,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NTI5NTE0NA==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-28T21:33:32Z",
    "updated_at": "2020-07-28T21:33:32Z",
    "author_association": "NONE",
    "body": "I'm running with this flags: `--maxpeers 200 --light.serve 75 --light.maxpeers 100 --nat upnp --vmodule=p2p/nat=6 `\r\nThis errors appear:\r\n\r\n```\r\nDEBUG[07-28|18:23:07.277] Couldn't add port mapping                proto=tcp extport=30303 intport=30303 interface=UPnP err=\"no UPnP router discovered\"\r\nDEBUG[07-28|18:23:07.277] Couldn't add port mapping                proto=udp extport=30303 intport=30303 interface=UPnP err=\"no UPnP router discovered\" \r\n```\r\n\r\nIf I disable the firewall on my computer, the log changes:\r\n\r\n```\r\nDEBUG[07-28|18:29:45.201] Couldn't add port mapping                proto=tcp extport=30303 intport=30303 interface=\"UPNP IGDv1-IP1\" err=\"goupnp: error performing SOAP HTTP request: Post \\\"http://192.168.1.1:52869/upnp/control/WANIPConn1\\\": EOF\"\r\nDEBUG[07-28|18:29:45.203] Couldn't add port mapping                proto=udp extport=30303 intport=30303 interface=\"UPNP IGDv1-IP1\" err=\"goupnp: error performing SOAP HTTP request: Post \\\"http://192.168.1.1:52869/upnp/control/WANIPConn1\\\": EOF\"\r\n``` \r\n\r\nLog screenshot:\r\n![image](https://user-images.githubusercontent.com/224810/88723718-b62f1c00-d0ff-11ea-929b-bb1e6795ccbb.png)\r\n\r\n\r\nRouter config screenshot:\r\n![image](https://user-images.githubusercontent.com/224810/88723795-dc54bc00-d0ff-11ea-8e3f-e465020b3ef8.png)\r\n\r\n\r\nI'm trying to light.serv, but not sure if its working because of this error in UPnP. My router clearly supports UPnP, and it's enabled.\r\n\r\nIf I use the torrent client Transmission, it maps the UPnP in the router, see:\r\n![image](https://user-images.githubusercontent.com/224810/88724380-be3b8b80-d100-11ea-942d-1a7bf159c9cb.png)\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/665295144/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/665297782",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-665297782",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 665297782,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NTI5Nzc4Mg==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-28T21:40:11Z",
    "updated_at": "2020-07-28T21:40:11Z",
    "author_association": "NONE",
    "body": "IPFS also maps UPnP with no problems:\r\n![image](https://user-images.githubusercontent.com/224810/88724976-c1834700-d101-11ea-9437-ca0ec2330735.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/665297782/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/665858367",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-665858367",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 665858367,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NTg1ODM2Nw==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-29T19:30:21Z",
    "updated_at": "2020-07-29T19:30:21Z",
    "author_association": "MEMBER",
    "body": "Thank you, your responses are very helpful! It looks like either the router isn't responding correctly or we're not processing the response correctly. It would be nice to also get packet trace, but only if you have the time to create it.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/665858367/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/665963852",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-665963852",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 665963852,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NTk2Mzg1Mg==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-29T22:30:19Z",
    "updated_at": "2020-07-29T22:30:19Z",
    "author_association": "NONE",
    "body": "Sure, I love messing with wireshark!!! \r\n\r\nI captured before running geth and closed it. I did this for `--nat upnp` (geth_upnp.pcapng) and for `--nat any` (geth_nat_any.pcapng).  For the `--nat any` I simply removed the flags in the geth init script, as this is the default behavior. I was using `--nat upnp` flag in geth trying to fix the issue, but ideally it should work with no flag.\r\n\r\nAlso, I did the same running `ipfs daemon` (ipfs_upnp.pcapng) and `enabling/disabling transmission upnp` (transmission_unp.pcapng), which are cases where UPnP works with ZTE F660 router. \r\n\r\nThe files were exported from wireshark 2.6.0 with the following filter: `tcp.port == 52869 || ip.dst == 192.168.1.1`\r\n\r\n[wire_captures.zip](https://github.com/ethereum/go-ethereum/files/4997783/wire_captures.zip)\r\n\r\nLet me know if you need anything else! Thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/665963852/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666004464",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-666004464",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 666004464,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NjAwNDQ2NA==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-30T00:38:30Z",
    "updated_at": "2020-07-30T00:39:15Z",
    "author_association": "MEMBER",
    "body": "Hmm, very interesting. Looks like the router simply closes the connection when it receives the AddPortMapping request from geth. That's also why the error message says EOF in the log.\r\n\r\nThe port mapping requests from Geth and IPFS are almost identical, except for two minor differences:\r\n\r\n- Geth requests a port mapping lease time of 1200 seconds, IPFS wants 60 seconds.\r\n- In Geth's request, the NewPortMappingDescription XML element contains a space character.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666004464/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666040556",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-666040556",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 666040556,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NjA0MDU1Ng==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-30T02:13:38Z",
    "updated_at": "2020-07-30T02:24:11Z",
    "author_association": "NONE",
    "body": "I was trying to intercept the packets in Webscarab, for IPFS I could with no problem, however for geth my MITM attack is not working... I get this strange error:\r\n\r\n```\r\nDEBUG[07-29|22:57:56.896] Couldn't add port mapping                proto=udp extport=30303 intport=30303 interface=\"UPNP IGDv1-IP1\" err=\"goupnp: SOAP request got HTTP 500 WebScarab error\"\r\nDEBUG[07-29|22:57:56.906] Couldn't add port mapping                proto=tcp extport=30303 intport=30303 interface=\"UPNP IGDv1-IP1\" err=\"goupnp: SOAP request got HTTP 500 WebScarab error\"\r\n```\r\n\r\nI don't see why, it's a unsecure \"http\" call, should be easy to intercept and alter the packet... I was going to try to change the lease time to 60 and also to remove the space character to see if it helps... Do you have any suggestion of other MITM tool or some special configuration I need to do in OWASP WebScarab?\r\n\r\nIn WebScarab I get this error: \r\n```\r\n23:23:25 Listener-127.0.0.1:8008-22(ConnectionHandler.run): IOException retrieving the response for http://192.168.1.1:52869/upnp/control/WANIPConn1 : java.io.IOException: No data received from the server\r\n```\r\n\r\nMaybe it would be easier to modify geth source and compile it, I can do that as well, I would just have to know what to change, then I can test it. \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666040556/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666047531",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-666047531",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 666047531,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NjA0NzUzMQ==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-30T02:30:11Z",
    "updated_at": "2020-07-30T02:30:11Z",
    "author_association": "NONE",
    "body": "I captured the packets and send them manually, and then it works fine.\r\n\r\n```\r\nPOST http://192.168.1.1:52869/upnp/control/WANIPConn1 HTTP/1.1\r\nHost: 192.168.1.1:52869\r\nUser-Agent: Go-http-client/1.1\r\nContent-length: 612\r\nCONTENT-TYPE: text/xml; charset=\"utf-8\"\r\nSOAPACTION: \"urn:schemas-upnp-org:service:WANIPConnection:1#AddPortMapping\"\r\nAccept-Encoding: gzip\r\n\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\" s:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><s:Body><u:AddPortMapping xmlns:u=\"urn:schemas-upnp-org:service:WANIPConnection:1\"><NewRemoteHost></NewRemoteHost><NewExternalPort>30303</NewExternalPort><NewProtocol>TCP</NewProtocol><NewInternalPort>30303</NewInternalPort><NewInternalClient>192.168.1.3</NewInternalClient><NewEnabled>1</NewEnabled><NewPortMappingDescription>ethereum p2p</NewPortMappingDescription><NewLeaseDuration>1200</NewLeaseDuration></u:AddPortMapping></s:Body></s:Envelope>\r\n```\r\n\r\n```\r\nPOST http://192.168.1.1:52869/upnp/control/WANIPConn1 HTTP/1.1\r\nHost: 192.168.1.1:52869\r\nUser-Agent: Go-http-client/1.1\r\nContent-length: 618\r\nCONTENT-TYPE: text/xml; charset=\"utf-8\"\r\nSOAPACTION: \"urn:schemas-upnp-org:service:WANIPConnection:1#AddPortMapping\"\r\nAccept-Encoding: gzip\r\n\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\" s:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\"><s:Body><u:AddPortMapping xmlns:u=\"urn:schemas-upnp-org:service:WANIPConnection:1\"><NewRemoteHost></NewRemoteHost><NewExternalPort>30303</NewExternalPort><NewProtocol>UDP</NewProtocol><NewInternalPort>30303</NewInternalPort><NewInternalClient>192.168.1.3</NewInternalClient><NewEnabled>1</NewEnabled><NewPortMappingDescription>ethereum discovery</NewPortMappingDescription><NewLeaseDuration>1200</NewLeaseDuration></u:AddPortMapping></s:Body></s:Envelope>\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666047531/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666054280",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-666054280",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 666054280,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NjA1NDI4MA==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-30T02:45:46Z",
    "updated_at": "2020-07-30T02:53:22Z",
    "author_association": "NONE",
    "body": "Analyzing the pcaps I attached in the message above\r\n\r\n> [wire_captures.zip](https://github.com/ethereum/go-ethereum/files/4997783/wire_captures.zip)\r\n\r\nI noticed that geth is being too agressive in the requests, this might be causing the bug on ZTE F660, but might not happen on all routers.\r\n\r\nThis is the order of callings:\r\n\r\ngeth --> router: GET /gatedesc.xml\r\nrouter --> geth: responds gatedesc.xml (200 OK)\r\ngeth --> router: <u:GetNATRSIPStatus xmlns:u=\"urn:schemas-upnp-org:service:WANIPConnection:1\">\r\nrouter --> geth: <u:GetNATRSIPStatusResponse xmlns:u=\"urn:schemas-upnp-org:service:WANIPConnection:1\">\r\n**geth --> router: <u:GetExternalIPAddress xmlns:u=\"urn:schemas-upnp-org:service:WANIPConnection:1\">\r\ngeth --> router: <u:DeletePortMapping xmlns:u=\"urn:schemas-upnp-org:service:WANIPConnection:1\"> _(UDP 30303)_\r\ngeth --> router: <u:DeletePortMapping xmlns:u=\"urn:schemas-upnp-org:service:WANIPConnection:1\">_(TCP 30303)_**\r\nrouter --> geth: <u:DeletePortMappingResponse xmlns:u=\"urn:schemas-upnp-org:service:WANIPConnection:1\">\r\ngeth --> router: <u:AddPortMapping xmlns:u=\"urn:schemas-upnp-org:service:WANIPConnection:1\"> _(UDP 30303)_\r\nrouter --> geth: **DROPs connection**\r\nrouter --> geth: <u:DeletePortMappingResponse xmlns:u=\"urn:schemas-upnp-org:service:WANIPConnection:1\">\r\ngeth --> router: <u:AddPortMapping xmlns:u=\"urn:schemas-upnp-org:service:WANIPConnection:1\"> _(TCP 30303)_\r\nrouter --> geth: **never answers**\r\n\r\nNotice that the geth asks for ExternalIPAddress, DeletePortMapping (for TCP 30303) and DeletePortMapping (for UDP 30303) without waiting a response. Router dont have time to response, and never responds the GetExternalIP, and just responds one DeletePorMapping. \r\n\r\nIf I reproduce the packets sent by geth, manually, one by one, it works fine, it just errors in geth, probably due this asyncronous calls to the router. \r\n\r\nTo fix this, probably geth should do one thing, wait response, and then do other. (or add some delays)\r\n\r\n\r\n\r\n\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666054280/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666505379",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-666505379",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 666505379,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NjUwNTM3OQ==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-30T16:25:05Z",
    "updated_at": "2020-07-30T16:25:05Z",
    "author_association": "MEMBER",
    "body": "Please try the linked PR.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666505379/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666800244",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-666800244",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 666800244,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NjgwMDI0NA==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-31T00:02:57Z",
    "updated_at": "2020-07-31T00:02:57Z",
    "author_association": "NONE",
    "body": "It works! Thanks a lot for the fix!\r\n\r\n![image](https://user-images.githubusercontent.com/224810/88985950-01842e80-d2a8-11ea-9230-aa3023dd2805.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666800244/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666853224",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-666853224",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 666853224,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2Njg1MzIyNA==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-31T01:07:24Z",
    "updated_at": "2020-07-31T01:07:24Z",
    "author_association": "NONE",
    "body": "Strange, it worked once... And now it's again showing this error:\r\n```\r\nDEBUG[07-30|22:05:00.832] Couldn't add port mapping                proto=tcp extport=30303 intport=30303 interface=\"UPNP IGDv1-IP1\" err=\"goupnp: error performing SOAP HTTP request: Post \\\"http://192.168.1.1:52869/upnp/control/WANIPConn1\\\": EOF\"\r\nDEBUG[07-30|22:05:00.844] Couldn't add port mapping                proto=udp extport=30303 intport=30303 interface=\"UPNP IGDv1-IP1\" err=\"goupnp: error performing SOAP HTTP request: Post \\\"http://192.168.1.1:52869/upnp/control/WANIPConn1\\\": EOF\"\r\n``` \r\n\r\n![image](https://user-images.githubusercontent.com/224810/88989035-04375180-d2b1-11ea-8e36-281d44c79fd9.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666853224/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666855978",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-666855978",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 666855978,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2Njg1NTk3OA==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-31T01:15:06Z",
    "updated_at": "2020-07-31T01:15:06Z",
    "author_association": "NONE",
    "body": "\r\nHere are the captures using the PR version...\r\n[geth_pr_wire_capture.zip](https://github.com/ethereum/go-ethereum/files/5004507/geth_pr_wire_capture.zip)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666855978/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666874556",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-666874556",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 666874556,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2Njg3NDU1Ng==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-31T02:17:14Z",
    "updated_at": "2020-07-31T02:17:47Z",
    "author_association": "NONE",
    "body": "My computer have WiFi and Wired connection. When I use WiFi connection, it works fine, when I use Wired connection it errors, even in the stable geth or in the PR.\r\n\r\nThe first time I tried the stable on WiFi it errored, but subsequent times it worked fine.  \r\n\r\nEverytime I run geth PR on WiFi, stops, and then run geth stable on Wifi, it errors, but after I close it and run again geth stable, it works fine. \r\n\r\nCaptures: [geth_over_wifi_captures.zip](https://github.com/ethereum/go-ethereum/files/5004655/geth_over_wifi_captures.zip)\r\n\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666874556/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666884372",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-666884372",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 666884372,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2Njg4NDM3Mg==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-31T02:53:20Z",
    "updated_at": "2020-07-31T06:17:51Z",
    "author_association": "NONE",
    "body": "I was able to alter the code of your PR, add a `time.Sleep(time.Millisecond)` on ExternalIP(), and now it works fine... What the frick? :laughing: \r\n\r\nI created a PR in your personal repo with the exact line I changed, I used 100 ms of wait there because when using only 1 ms, it sometimes works, it sometimes doesn't. \r\n \r\nhttps://github.com/fjl/go-ethereum/pull/6\r\n\r\n I am not sure if this is the best solution, or neither why this happens with this router, I guess the ZTE F660 is a shitty router. \r\n\r\nI am happy to test any other solution you might want to use instead of this ugly Sleep. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/666884372/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667134225",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-667134225",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 667134225,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NzEzNDIyNQ==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-31T13:59:47Z",
    "updated_at": "2020-07-31T14:00:02Z",
    "author_association": "MEMBER",
    "body": "I think the issue might be that the router can't process the requests if they're coming too fast?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667134225/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667143355",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-667143355",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 667143355,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NzE0MzM1NQ==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-31T14:18:49Z",
    "updated_at": "2020-07-31T14:18:49Z",
    "author_association": "MEMBER",
    "body": "I've updated the PR to use a rate limiter instead of avoiding concurrent requests. The rate limit is super high at 500ms.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667143355/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667240256",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-667240256",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 667240256,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NzI0MDI1Ng==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-31T17:22:55Z",
    "updated_at": "2020-07-31T17:22:55Z",
    "author_association": "NONE",
    "body": "I tried the new commit and it doesn't works...\r\n\r\n![image](https://user-images.githubusercontent.com/224810/89060368-4e641580-d339-11ea-8cd8-95d9ece1fac4.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667240256/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667244206",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-667244206",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 667244206,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NzI0NDIwNg==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-31T17:32:13Z",
    "updated_at": "2020-07-31T17:32:13Z",
    "author_association": "NONE",
    "body": "Here are the wireshark captures:\r\n[geth_pr_abd4b950_nat_captures.zip](https://github.com/ethereum/go-ethereum/files/5008258/geth_pr_abd4b950_nat_captures.zip)\r\n\r\nThere is 3 files:\r\n\r\n- geth_pr_abd4b950_nat_pnp.pcapng: When using Ethernet cable connected directly to Router, always errors.\r\n- geth_pr_abd4b950_nat_pnp_wifi_errored.pcapng: When using Wifi, sometimes it errors.\r\n- geth_pr_abd4b950_nat_pnp_wifi_worked.pcapng: When using Wifi, it usually works.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667244206/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667465352",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-667465352",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 667465352,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NzQ2NTM1Mg==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-01T04:10:51Z",
    "updated_at": "2020-08-01T04:10:51Z",
    "author_association": "NONE",
    "body": "For these screenshots I am using the commit I modified. I noticed that the \"refreshing of UPnP\" also gives me errors, but only when synced. So I will try add a Sleep in all calls? \r\n\r\nIt starts and maps the ports normal at first:\r\n\r\n![image](https://user-images.githubusercontent.com/224810/89093610-7469d400-d392-11ea-96f2-e501634c7f93.png)\r\n\r\n\r\nWhile syncing it refreshed the ports with success:\r\n![image](https://user-images.githubusercontent.com/224810/89093616-7fbcff80-d392-11ea-99a4-73a1261a10df.png)\r\n![image](https://user-images.githubusercontent.com/224810/89093619-864b7700-d392-11ea-9b92-d7e03be25942.png)\r\n\r\n\r\nBut when it tries to do it while synced, the errors begin:\r\n![image](https://user-images.githubusercontent.com/224810/89093631-94999300-d392-11ea-8eed-732385ab7eee.png)\r\n\r\n\r\nSometimes it does not errors:\r\n![image](https://user-images.githubusercontent.com/224810/89093641-a418dc00-d392-11ea-842e-4830b56981f9.png)\r\n![image](https://user-images.githubusercontent.com/224810/89093645-a8dd9000-d392-11ea-98c2-1383a565b922.png)\r\n\r\n\r\nBut then it errors again and forever:\r\n\r\n![image](https://user-images.githubusercontent.com/224810/89093649-b135cb00-d392-11ea-8fb8-aa3cc3e42112.png)\r\n(...) many errors similar to this (...)\r\n![image](https://user-images.githubusercontent.com/224810/89093733-4a64e180-d393-11ea-863d-7c1fc5006c09.png)\r\n\r\nThen once it errored just at one port:\r\n\r\n![image](https://user-images.githubusercontent.com/224810/89093737-5a7cc100-d393-11ea-83d7-aea7cce6c424.png)\r\n\r\nAnd back to normal erroring in both:\r\n\r\n![image](https://user-images.githubusercontent.com/224810/89093741-65cfec80-d393-11ea-9196-b2b581d299a1.png)\r\n![image](https://user-images.githubusercontent.com/224810/89093745-69fc0a00-d393-11ea-8bfe-c2c85b4d2458.png)\r\n\r\n\r\nErroed just in one again:\r\n![image](https://user-images.githubusercontent.com/224810/89093754-7a13e980-d393-11ea-8418-82958ddfac75.png)\r\n![image](https://user-images.githubusercontent.com/224810/89093758-8730d880-d393-11ea-89a1-c986bf0c4c38.png)\r\n\r\nAnd it keeps with this... And currently I am running geth and no mapping in my router...\r\n\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667465352/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667558670",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-667558670",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 667558670,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NzU1ODY3MA==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-01T16:51:09Z",
    "updated_at": "2020-08-01T16:51:09Z",
    "author_association": "NONE",
    "body": "I added a new commit on the PR that was working best for me, https://github.com/fjl/go-ethereum/pull/6, and now it works in all cases...\r\n![image](https://user-images.githubusercontent.com/224810/89106170-022ed900-d3fe-11ea-8932-074074316a00.png)\r\n![image](https://user-images.githubusercontent.com/224810/89106164-f3e0bd00-d3fd-11ea-8f64-efddc51668fb.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667558670/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667580182",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-667580182",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 667580182,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NzU4MDE4Mg==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-01T20:01:31Z",
    "updated_at": "2020-08-01T20:01:31Z",
    "author_association": "NONE",
    "body": "Not working so great... \r\nI don't get any error messages, but this is what is being mapped at the router:\r\n![image](https://user-images.githubusercontent.com/224810/89109562-a45bba80-d418-11ea-9034-7f52fa087e08.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667580182/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667580474",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-667580474",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 667580474,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NzU4MDQ3NA==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-01T20:04:30Z",
    "updated_at": "2020-08-01T20:04:30Z",
    "author_association": "NONE",
    "body": "At beginning it maps correctly, one TCP and one UDP, but the \"remappings\" are problematic, removing UDP, not adding it back, and adding many TCP entries of the same thing. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667580474/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667591993",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-667591993",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 667591993,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NzU5MTk5Mw==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-01T21:57:42Z",
    "updated_at": "2020-08-01T21:57:42Z",
    "author_association": "MEMBER",
    "body": "Hey, thanks for spending so much time on this! \r\n\r\nI don't know how to best proceed with this issue. In the https://github.com/fjl/go-ethereum/pull/6 PR, with the sleep added everywhere, the code basically does everything it possibly could to avoid confusing your router (not sending any concurrent requests and waiting between requests). I checked the libp2p library and it uses the same underlying implementation of UPNP, and generally does things in the exact same way as go-ethereum does now. We can try and increase the sleep duration even more, but I doubt it'll help much.\r\n\r\nWill have another look at this on Monday.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/667591993/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/668087896",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-668087896",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 668087896,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODA4Nzg5Ng==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-03T15:30:41Z",
    "updated_at": "2020-08-03T15:30:41Z",
    "author_association": "NONE",
    "body": "I also have an Ubiquiti EdgeRouter here, and the stable version of geth seems to have troubles with it as well. For the EdgeRouter, the initial UPnP works fine, but the \"remappings\" have problems. Why are these remappings needed?\r\n\r\nFor the fjl#6 PR in ZTE, it seems to work, but the mappings are all messed up after some time. At one test it was just \"flooding\" TCP mappings, and other test it was \"flooding\" UDP mappings. \r\n\r\nAs for libp2p, it generally does the same thing, but for some reason I have problems just with geth. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/668087896/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/668159383",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-668159383",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 668159383,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODE1OTM4Mw==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-03T17:55:20Z",
    "updated_at": "2020-08-03T17:55:20Z",
    "author_association": "MEMBER",
    "body": "> but the \"remappings\" have problems. Why are these remappings needed?\r\n\r\nThe port mapping will time out after a while and needs to be recreated. In theory, the router should just delete those mappings after the specified timeout, which is set to 20 minutes in the request. For some reason, that doesn't seem to happen with your router. \r\n\r\nHowever, the logic in p2p/nat is weird for this. It recreates the mapping every 15 minutes, but requests 20 minutes of mapping time. I'll change it in the PR so both times are the same, then we can check if that helps.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/668159383/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/668169133",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-668169133",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 668169133,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODE2OTEzMw==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-03T18:16:11Z",
    "updated_at": "2020-08-03T18:16:11Z",
    "author_association": "MEMBER",
    "body": "Pushed to #21390 ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/668169133/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/668180649",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-668180649",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 668180649,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODE4MDY0OQ==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-03T18:41:43Z",
    "updated_at": "2020-08-03T18:41:43Z",
    "author_association": "NONE",
    "body": "Thanks, I will test this new PR. \r\n\r\nSeems like this bugs does affect other routers as well, and would be good to have this sorted out to improve the network.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/668180649/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/668223175",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-668223175",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 668223175,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODIyMzE3NQ==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-03T20:22:31Z",
    "updated_at": "2020-08-03T20:22:31Z",
    "author_association": "NONE",
    "body": "Congratz! The latest `instance=Geth/v1.9.19-unstable-a44bd481-20200803/linux-amd64/go1.14.6` it's working without I noticing the bugs I noticed with other implementations.\r\n\r\nThe commit a44bd481 is:\r\n- Initialization mapping working;\r\n- Remapping while syncing working;\r\n- Remapping while synced/lightserv working;\r\n- Had always correct mappings on router (no duplicate and missing mappings).\r\n\r\nI also verified that it:\r\n- Removes mappings on exit\r\n- Works normally after a restart of geth\r\n- Works on WiFi\r\n\r\nLog of the runs I tried so far: [geth.log](https://github.com/ethereum/go-ethereum/files/5018251/geth.log)\r\n\r\nI think is good to go, as it worked perfectly, but I will keep testing as my main node and try it replacing ZTE-F660 by a Ubiquiti EdgeRouter (in a second nat, which should NAT only in the first router) which had problems with UPnP of current stable geth. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/668223175/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/668265383",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21370#issuecomment-668265383",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21370",
    "id": 668265383,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODI2NTM4Mw==",
    "user": {
      "login": "3esmit",
      "id": 224810,
      "node_id": "MDQ6VXNlcjIyNDgxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/224810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/3esmit",
      "html_url": "https://github.com/3esmit",
      "followers_url": "https://api.github.com/users/3esmit/followers",
      "following_url": "https://api.github.com/users/3esmit/following{/other_user}",
      "gists_url": "https://api.github.com/users/3esmit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/3esmit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/3esmit/subscriptions",
      "organizations_url": "https://api.github.com/users/3esmit/orgs",
      "repos_url": "https://api.github.com/users/3esmit/repos",
      "events_url": "https://api.github.com/users/3esmit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/3esmit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-03T22:07:50Z",
    "updated_at": "2020-08-03T22:07:50Z",
    "author_association": "NONE",
    "body": "Commit a44bd481 works fine in EdgeRouter as well.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/668265383/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
