{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16610",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16610/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16610/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16610/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/16610",
  "id": 318819164,
  "node_id": "MDU6SXNzdWUzMTg4MTkxNjQ=",
  "number": 16610,
  "title": "Data race in LES",
  "user": {
    "login": "AlekSi",
    "id": 11512,
    "node_id": "MDQ6VXNlcjExNTEy",
    "avatar_url": "https://avatars.githubusercontent.com/u/11512?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AlekSi",
    "html_url": "https://github.com/AlekSi",
    "followers_url": "https://api.github.com/users/AlekSi/followers",
    "following_url": "https://api.github.com/users/AlekSi/following{/other_user}",
    "gists_url": "https://api.github.com/users/AlekSi/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AlekSi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AlekSi/subscriptions",
    "organizations_url": "https://api.github.com/users/AlekSi/orgs",
    "repos_url": "https://api.github.com/users/AlekSi/repos",
    "events_url": "https://api.github.com/users/AlekSi/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AlekSi/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "zsfelfoldi",
    "id": 9884311,
    "node_id": "MDQ6VXNlcjk4ODQzMTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9884311?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/zsfelfoldi",
    "html_url": "https://github.com/zsfelfoldi",
    "followers_url": "https://api.github.com/users/zsfelfoldi/followers",
    "following_url": "https://api.github.com/users/zsfelfoldi/following{/other_user}",
    "gists_url": "https://api.github.com/users/zsfelfoldi/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/zsfelfoldi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/zsfelfoldi/subscriptions",
    "organizations_url": "https://api.github.com/users/zsfelfoldi/orgs",
    "repos_url": "https://api.github.com/users/zsfelfoldi/repos",
    "events_url": "https://api.github.com/users/zsfelfoldi/events{/privacy}",
    "received_events_url": "https://api.github.com/users/zsfelfoldi/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "zsfelfoldi",
      "id": 9884311,
      "node_id": "MDQ6VXNlcjk4ODQzMTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9884311?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zsfelfoldi",
      "html_url": "https://github.com/zsfelfoldi",
      "followers_url": "https://api.github.com/users/zsfelfoldi/followers",
      "following_url": "https://api.github.com/users/zsfelfoldi/following{/other_user}",
      "gists_url": "https://api.github.com/users/zsfelfoldi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zsfelfoldi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zsfelfoldi/subscriptions",
      "organizations_url": "https://api.github.com/users/zsfelfoldi/orgs",
      "repos_url": "https://api.github.com/users/zsfelfoldi/repos",
      "events_url": "https://api.github.com/users/zsfelfoldi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zsfelfoldi/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2018-04-30T08:37:25Z",
  "updated_at": "2018-06-25T08:52:25Z",
  "closed_at": "2018-06-25T08:52:25Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Tagged Geth v1.8.6, built with Go 1.10.1 on macOS 10.13.4 with race detector enabled.\r\n\r\n```\r\n$ geth --syncmode=light\r\n\r\n[â€¦]\r\n\r\n==================\r\nWARNING: DATA RACE\r\nWrite at 0x00c4200d08a0 by goroutine 75:\r\n  github.com/ethereum/go-ethereum/les.(*wrsNode).insert()\r\n      /XXX/src/github.com/ethereum/go-ethereum/les/randselect.go:116 +0x222\r\n  github.com/ethereum/go-ethereum/les.(*weightedRandomSelect).setWeight()\r\n      /XXX/src/github.com/ethereum/go-ethereum/les/randselect.go:70 +0x1cf\r\n  github.com/ethereum/go-ethereum/les.(*weightedRandomSelect).update()\r\n      /XXX/src/github.com/ethereum/go-ethereum/les/randselect.go:45 +0x6a\r\n  github.com/ethereum/go-ethereum/les.(*serverPool).updateCheckDial()\r\n      /XXX/src/github.com/ethereum/go-ethereum/les/serverpool.go:450 +0x6e\r\n  github.com/ethereum/go-ethereum/les.(*serverPool).eventLoop()\r\n      /XXX/src/github.com/ethereum/go-ethereum/les/serverpool.go:313 +0x6a7\r\n\r\nPrevious read at 0x00c4200d08a0 by main goroutine:\r\n  [failed to restore the stack]\r\n\r\nGoroutine 75 (running) created at:\r\n  github.com/ethereum/go-ethereum/les.(*serverPool).start()\r\n      /XXX/src/github.com/ethereum/go-ethereum/les/serverpool.go:151 +0x2ad\r\n  github.com/ethereum/go-ethereum/les.(*LightEthereum).Start()\r\n      /XXX/src/github.com/ethereum/go-ethereum/les/backend.go:229 +0x28a\r\n  github.com/ethereum/go-ethereum/node.(*Node).Start()\r\n      /XXX/src/github.com/ethereum/go-ethereum/node/node.go:203 +0xf6f\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.fsParseName()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:571 +0x16c\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.(*fileStorage).List()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:386 +0x2b0\r\n  fmt.(*ss).doScanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:1193 +0x345\r\n  fmt.Fscanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:143 +0xf5\r\n  fmt.Sscanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:114 +0xbb\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.fsParseName()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:571 +0x16c\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.(*fileStorage).List()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:386 +0x2b0\r\n  fmt.(*ss).doScanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:1193 +0x345\r\n  fmt.Fscanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:143 +0xf5\r\n  fmt.Sscanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:114 +0xbb\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.fsParseName()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:571 +0x16c\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.(*fileStorage).List()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:386 +0x2b0\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb.(*DB).checkAndCleanFiles()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/db_util.go:52 +0x2e6\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb.openDB()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/db.go:129 +0xa4c\r\n  fmt.Sscanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:114 +0xbb\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.fsParseName()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:571 +0x16c\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.(*fileStorage).List()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:386 +0x2b0\r\n  fmt.(*ss).doScanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:1193 +0x345\r\n  fmt.Fscanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:143 +0xf5\r\n  fmt.Sscanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:114 +0xbb\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.fsParseName()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:571 +0x16c\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.(*fileStorage).List()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:386 +0x2b0\r\n  fmt.(*ss).doScanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:1193 +0x345\r\n  fmt.Fscanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:143 +0xf5\r\n  fmt.Sscanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:114 +0xbb\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.fsParseName()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:571 +0x16c\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.(*fileStorage).List()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:386 +0x2b0\r\n  fmt.Sscanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:114 +0xbb\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.fsParseName()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:585 +0x239\r\n  fmt.(*ss).doScanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:1193 +0x345\r\n  fmt.Fscanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:143 +0xf5\r\n  fmt.Sscanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:114 +0xbb\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.fsParseName()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:571 +0x16c\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.(*fileStorage).List()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:386 +0x2b0\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb.(*DB).recoverJournal()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/db.go:475 +0xd9\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb.openDB()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/db.go:124 +0xa28\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb.Open()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/db.go:196 +0x186\r\n  fmt.Fscanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:143 +0xf5\r\n  fmt.Sscanf()\r\n      /usr/local/Cellar/go/1.10.1/libexec/src/fmt/scan.go:114 +0xbb\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.fsParseName()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:571 +0x16c\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.fsParseNamePtr()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:594 +0x46\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage.(*fileStorage).GetMeta()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/storage/file_storage.go:312 +0xdd3\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb.(*session).recover()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/session.go:119 +0xd6\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb.Open()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/db.go:182 +0xc8\r\n  github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb.OpenFile()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/github.com/syndtr/goleveldb/leveldb/db.go:218 +0x9f\r\n  github.com/ethereum/go-ethereum/ethdb.NewLDBDatabase()\r\n      /XXX/src/github.com/ethereum/go-ethereum/ethdb/database.go:76 +0x4c5\r\n  github.com/ethereum/go-ethereum/node.(*ServiceContext).OpenDatabase()\r\n      /XXX/src/github.com/ethereum/go-ethereum/node/service.go:46 +0x1a7\r\n  github.com/ethereum/go-ethereum/eth.CreateDB()\r\n      /XXX/src/github.com/ethereum/go-ethereum/eth/backend.go:203 +0x9a\r\n  github.com/ethereum/go-ethereum/les.New()\r\n      /XXX/src/github.com/ethereum/go-ethereum/les/backend.go:83 +0x75\r\n  github.com/ethereum/go-ethereum/cmd/utils.RegisterEthService.func1()\r\n      /XXX/src/github.com/ethereum/go-ethereum/cmd/utils/flags.go:1128 +0x4f\r\n  github.com/ethereum/go-ethereum/node.(*Node).Start()\r\n      /XXX/src/github.com/ethereum/go-ethereum/node/node.go:182 +0x706\r\n  github.com/ethereum/go-ethereum/cmd/utils.StartNode()\r\n      /XXX/src/github.com/ethereum/go-ethereum/cmd/utils/cmd.go:66 +0x3c\r\n  main.startNode()\r\n      /XXX/src/github.com/ethereum/go-ethereum/cmd/geth/main.go:227 +0x53\r\n  main.geth()\r\n      /XXX/src/github.com/ethereum/go-ethereum/cmd/geth/main.go:217 +0x50\r\n  github.com/ethereum/go-ethereum/vendor/gopkg.in/urfave/cli%2ev1.HandleAction()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/gopkg.in/urfave/cli.v1/app.go:490 +0xfd\r\n  github.com/ethereum/go-ethereum/vendor/gopkg.in/urfave/cli%2ev1.(*App).Run()\r\n      /XXX/src/github.com/ethereum/go-ethereum/vendor/gopkg.in/urfave/cli.v1/app.go:264 +0x92a\r\n  main.main()\r\n      /XXX/src/github.com/ethereum/go-ethereum/cmd/geth/main.go:206 +0x82\r\n==================\r\n```",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16610/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/16610/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[

]
