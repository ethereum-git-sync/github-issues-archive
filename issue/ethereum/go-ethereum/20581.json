{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20581",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20581/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20581/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20581/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/20581",
  "id": 552422648,
  "node_id": "MDU6SXNzdWU1NTI0MjI2NDg=",
  "number": 20581,
  "title": "Websocket: close 1000 (normal)",
  "user": {
    "login": "MariusVanDerWijden",
    "id": 16664698,
    "node_id": "MDQ6VXNlcjE2NjY0Njk4",
    "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/MariusVanDerWijden",
    "html_url": "https://github.com/MariusVanDerWijden",
    "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
    "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
    "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
    "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
    "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
    "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
    "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2020-01-20T17:12:38Z",
  "updated_at": "2020-01-21T16:07:54Z",
  "closed_at": "2020-01-21T16:07:54Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "maybe related: #19001 \r\nThe websocket connection between our ethclient and the geth node is closed everytime we call eth_sendRawTransaction.\r\n\r\n#### System information\r\n\r\nGeth version: `Geth/v1.9.7-stable-a718daa6/linux-amd64/go1.13.4`\r\nOS & Version: Linux amd 64\r\nCommit hash : (if `develop`)\r\n\r\n#### Expected behaviour\r\nGeth should not close the websocket connection.\r\n\r\n#### Actual behaviour\r\nGeth closes the websocket after every websocket connection.\r\n\r\n```\r\nDEBUG[01-20|17:57:53.700] Served eth_getTransactionReceipt         reqid=8  t=1.414018ms\r\nDEBUG[01-20|17:57:53.708] Served eth_getTransactionCount           reqid=9  t=166.023µs\r\nDEBUG[01-20|17:57:53.708] Served eth_getTransactionCount           reqid=1  t=343.237µs\r\nDEBUG[01-20|17:57:53.709] Served eth_getBlockByNumber              reqid=2  t=895.497µs\r\nDEBUG[01-20|17:57:53.709] Served eth_getBlockByNumber              reqid=10 t=952.642µs\r\nTRACE[01-20|17:57:53.710] Pooled new future transaction            hash=f24e7b…9144b9 from=0x191198Cd6e6699a1CF1d96dBe468288DDC90327B to=0xB1dFc9dB8128F66ea8ce84D67334c7F56c71C360\r\nTRACE[01-20|17:57:53.710] Pooled new future transaction            hash=2d6a78…cd0b03 from=0x4C6Fb6A04d28534382d165AA6A866e45c5a179b8 to=0xB1dFc9dB8128F66ea8ce84D67334c7F56c71C360\r\nTRACE[01-20|17:57:53.710] Promoting queued transaction             hash=f24e7b…9144b9\r\nINFO [01-20|17:57:53.710] Submitted transaction                    fullhash=0xf24e7bf529c7abcf2cc294b028e81b6d8f1784864ee564583db39ee9019144b9 recipient=0xB1dFc9dB8128F66ea8ce84D67334c7F56c71C360\r\nDEBUG[01-20|17:57:53.710] Served eth_sendRawTransaction            reqid=11 t=1.114215ms\r\nDEBUG[01-20|17:57:53.710] RPC connection read error                err=\"websocket: close 1000 (normal)\"\r\nTRACE[01-20|17:57:53.711] Promoting queued transaction             hash=2d6a78…cd0b03\r\nINFO [01-20|17:57:53.711] Submitted transaction                    fullhash=0x2d6a787067be63a3b5e51aabe94d1fb2f83b2a75f60c1b24c26dca6551cd0b03 recipient=0xB1dFc9dB8128F66ea8ce84D67334c7F56c71C360\r\nTRACE[01-20|17:57:53.710] Broadcast transaction                    hash=f24e7b…9144b9 recipients=0\r\nTRACE[01-20|17:57:53.711] Broadcast transaction                    hash=2d6a78…cd0b03 recipients=0\r\nDEBUG[01-20|17:57:53.711] Committing new uncle to block            hash=828c34…89af09\r\nDEBUG[01-20|17:57:53.711] Served eth_sendRawTransaction            reqid=3  t=1.279883ms\r\nDEBUG[01-20|17:57:53.712] RPC connection read error                err=\"websocket: close 1000 (normal)\"\r\n```\r\n\r\n#### Steps to reproduce the behaviour\r\nsee branch `https://github.com/perun-network/go-perun/tree/geth-eof\r\n```\r\ngeth --dev --rpc --ws --verbosity 5 console\r\neth.sendTransaction({from:'0x72981b6d3657593218d59b8113fa4d7c0f13b5f9', to:'0x191198Cd6e6699a1CF1d96dBe468288DDC90327B', value: web3.toWei(1, \"ether\"), gas:21000});\r\neth.sendTransaction({from:'0x72981b6d3657593218d59b8113fa4d7c0f13b5f9', to:'0x191198Cd6e6699a1CF1d96dBe468288DDC90327B', value: web3.toWei(1, \"ether\"), gas:21000});\r\n// replace from account with eth.accounts[0]\r\ngit clone https://github.com/perun-network/go-perun.git\r\ngit checkout geth-eof\r\ncd go-perun/backend/ethereum/channel/test\r\ngo test ./... -v\r\n```\r\n\r\n\r\n",
  "closed_by": {
    "login": "MariusVanDerWijden",
    "id": 16664698,
    "node_id": "MDQ6VXNlcjE2NjY0Njk4",
    "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/MariusVanDerWijden",
    "html_url": "https://github.com/MariusVanDerWijden",
    "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
    "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
    "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
    "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
    "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
    "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
    "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20581/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20581/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/576746773",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20581#issuecomment-576746773",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20581",
    "id": 576746773,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3Njc0Njc3Mw==",
    "user": {
      "login": "ggwpez",
      "id": 10380170,
      "node_id": "MDQ6VXNlcjEwMzgwMTcw",
      "avatar_url": "https://avatars.githubusercontent.com/u/10380170?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ggwpez",
      "html_url": "https://github.com/ggwpez",
      "followers_url": "https://api.github.com/users/ggwpez/followers",
      "following_url": "https://api.github.com/users/ggwpez/following{/other_user}",
      "gists_url": "https://api.github.com/users/ggwpez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ggwpez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ggwpez/subscriptions",
      "organizations_url": "https://api.github.com/users/ggwpez/orgs",
      "repos_url": "https://api.github.com/users/ggwpez/repos",
      "events_url": "https://api.github.com/users/ggwpez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ggwpez/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-21T15:53:44Z",
    "updated_at": "2020-01-21T15:53:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "Updating to go-ethereum v1.9.10 solves the problem xD.  \r\nSee [#19866](https://github.com/ethereum/go-ethereum/pull/19866).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/576746773/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/576753522",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20581#issuecomment-576753522",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20581",
    "id": 576753522,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3Njc1MzUyMg==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-21T16:07:54Z",
    "updated_at": "2020-01-21T16:07:54Z",
    "author_association": "MEMBER",
    "body": "thanks @ggwpez ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/576753522/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
