{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17485",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17485/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17485/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17485/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/17485",
  "id": 353036599,
  "node_id": "MDU6SXNzdWUzNTMwMzY1OTk=",
  "number": 17485,
  "title": "API call to determine if node is synchronised",
  "user": {
    "login": "smartwombat",
    "id": 8438931,
    "node_id": "MDQ6VXNlcjg0Mzg5MzE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8438931?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/smartwombat",
    "html_url": "https://github.com/smartwombat",
    "followers_url": "https://api.github.com/users/smartwombat/followers",
    "following_url": "https://api.github.com/users/smartwombat/following{/other_user}",
    "gists_url": "https://api.github.com/users/smartwombat/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/smartwombat/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/smartwombat/subscriptions",
    "organizations_url": "https://api.github.com/users/smartwombat/orgs",
    "repos_url": "https://api.github.com/users/smartwombat/repos",
    "events_url": "https://api.github.com/users/smartwombat/events{/privacy}",
    "received_events_url": "https://api.github.com/users/smartwombat/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 856638432,
      "node_id": "MDU6TGFiZWw4NTY2Mzg0MzI=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/status:inactive",
      "name": "status:inactive",
      "color": "ffffff",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2018-08-22T16:44:00Z",
  "updated_at": "2019-10-05T14:45:35Z",
  "closed_at": "2019-10-05T14:45:35Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Geth version: 1.8.13\r\nOS & Version: Windows 10\r\n\r\n#### Expected behaviour\r\nAn API call to unambiguously give the state of a node.\r\n\r\n#### Actual behaviour\r\nIt seems impossible to accurately infer the state of a node.\r\nParticularly during startup.\r\n\r\n\r\n#### Steps to reproduce the behaviour\r\nStart geth from the command window, and observe the output:\r\n\r\n`INFO [08-22|17:06:15.962] Starting peer-to-peer node               instance=Geth/v1.8.13-stable-225171a4/windows-amd64/go1.10.3\r\nINFO [08-22|17:06:15.962] Allocated cache and file handles         database=\"C:\\\\Users\\\\<username>\\\\AppData\\\\Roaming\\\\Ethereum\\\\testnet\\\\geth\\\\chaindata\" cache=3072 handles=1024\r\nINFO [08-22|17:06:44.516] Persisted trie from memory database      nodes=355 size=51.89kB time=976.8µs gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B\r\nINFO [08-22|17:06:44.516] Initialised chain configuration          config=\"{ChainID: 3 Homestead: 0 DAO: <nil> DAOSupport: true EIP150: 0 EIP155: 10 EIP158: 10 Byzantium: 1700000 Constantinople: <nil> Engine: ethash}\"\r\nINFO [08-22|17:06:44.516] Disk storage enabled for ethash caches   dir=\"C:\\\\Users\\\\<username>\\\\AppData\\\\Roaming\\\\Ethereum\\\\testnet\\\\geth\\\\ethash\" count=3\r\nINFO [08-22|17:06:44.516] Disk storage enabled for ethash DAGs     dir=\"C:\\\\Users\\\\<username>\\\\AppData\\\\Ethash\"                                   count=2\r\nINFO [08-22|17:06:44.517] Initialising Ethereum protocol           versions=\"[63 62]\" network=3\r\nINFO [08-22|17:06:44.518] Loaded most recent local header          number=3889943 hash=e32173…3e8244 td=9609800456533734\r\nINFO [08-22|17:06:44.518] Loaded most recent local full block      number=0       hash=419410…ca4a2d td=1048576\r\nINFO [08-22|17:06:44.518] Loaded most recent local fast block      number=3889865 hash=f9def2…985cab td=9608646423438931\r\nINFO [08-22|17:06:44.519] Loaded local transaction journal         transactions=0 dropped=0\r\nINFO [08-22|17:06:44.521] Regenerated local transaction journal    transactions=0 accounts=0\r\nINFO [08-22|17:06:44.522] Starting P2P networking \r\nINFO [08-22|17:06:46.677] UDP listener up                          self=enode://eb1d447460ccfda62c7e9fa3a2b77d2b94a6cca9848f955fd3e2e6ad428a36f28147593bae501e8c18026e6520a86d921ee477d15ddf9f81efe5b482ece4f74e@[::]:30303\r\nINFO [08-22|17:06:46.677] RLPx listener up                         self=enode://eb1d447460ccfda62c7e9fa3a2b77d2b94a6cca9848f955fd3e2e6ad428a36f28147593bae501e8c18026e6520a86d921ee477d15ddf9f81efe5b482ece4f74e@[::]:30303\r\nINFO [08-22|17:06:46.679] IPC endpoint opened                      url=\\\\\\\\.\\\\pipe\\\\geth.ipc\r\nINFO [08-22|17:06:46.783] Etherbase automatically configured       address=0xf79e8bA649dAa6B42dD6D0BB33B6584484F21A1a`\r\n\r\nAt this point:\r\nConnect from another command window with geth attach ipc:\\\\.\\pipe\\geth.ipc and try seemingly relevant API calls...\r\n`net.listening returns true\r\nnet.peerCount returns 3\r\neth.syncing returns false`\r\n\r\nThe API seems to only give reasonable results a few minutes later after geth reports:\r\n`INFO [08-22|17:17:16.679] Block synchronisation started `\r\nAt which point eth.syncing statrs returning sensible values.\r\n\r\n**How, from a client application using the API, can I reliably find out what state the node is in ?**\r\nParticularly during the (variable duration) startup phase before block syncing starts ?",
  "closed_by": {
    "login": "stale[bot]",
    "id": 26384082,
    "node_id": "MDM6Qm90MjYzODQwODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/stale%5Bbot%5D",
    "html_url": "https://github.com/apps/stale",
    "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17485/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17485/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/415413001",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17485#issuecomment-415413001",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17485",
    "id": 415413001,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNTQxMzAwMQ==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-23T13:25:46Z",
    "updated_at": "2018-08-23T13:25:46Z",
    "author_association": "MEMBER",
    "body": "A crude way would be to retrieve the latest block and see it's timestamp.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/415413001/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/415421440",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17485#issuecomment-415421440",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17485",
    "id": 415421440,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNTQyMTQ0MA==",
    "user": {
      "login": "smartwombat",
      "id": 8438931,
      "node_id": "MDQ6VXNlcjg0Mzg5MzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8438931?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartwombat",
      "html_url": "https://github.com/smartwombat",
      "followers_url": "https://api.github.com/users/smartwombat/followers",
      "following_url": "https://api.github.com/users/smartwombat/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartwombat/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartwombat/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartwombat/subscriptions",
      "organizations_url": "https://api.github.com/users/smartwombat/orgs",
      "repos_url": "https://api.github.com/users/smartwombat/repos",
      "events_url": "https://api.github.com/users/smartwombat/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartwombat/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-23T13:52:06Z",
    "updated_at": "2018-08-23T13:52:06Z",
    "author_association": "NONE",
    "body": "Yeah, rather crude but it may be the only way.\r\n\r\nI've been comparing geth and Parity nodes.  It seems that Parity nodes will connect to far more peers than geth, but does that matter ?\r\n\r\nI found that running geth on two different computers they each connected to only one peer, each a different peer, and for about 18 minutes one did not update eth.blockNumber wehreas the other node was incrementing.\r\n\r\nThat implies that the _quality_ of peers varies, and while they can be online and responding to the protocol there is no guarantee that any node is up to date.\r\n\r\nI appreciate that consensus takes time to spread through the nodes, but 18 minutes ?\r\n\r\nIf a node is that far away from consensus, and it's the only peer node (geth seems to suck at peer connections) then can my node safely be used to create Ether sending transactions ?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/415421440/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/524552516",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17485#issuecomment-524552516",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17485",
    "id": 524552516,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNDU1MjUxNg==",
    "user": {
      "login": "stale[bot]",
      "id": 26384082,
      "node_id": "MDM6Qm90MjYzODQwODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stale%5Bbot%5D",
      "html_url": "https://github.com/apps/stale",
      "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2019-08-24T14:01:39Z",
    "updated_at": "2019-08-24T14:01:39Z",
    "author_association": "NONE",
    "body": "This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you for your contributions.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/524552516/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
