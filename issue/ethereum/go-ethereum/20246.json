{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20246",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20246/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20246/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20246/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/20246",
  "id": 518247797,
  "node_id": "MDU6SXNzdWU1MTgyNDc3OTc=",
  "number": 20246,
  "title": "Getting \"gas required exceeds allowance or always failing transaction\" when using web3js but transaction works fine when done from console",
  "user": {
    "login": "tanaybhartia",
    "id": 22501563,
    "node_id": "MDQ6VXNlcjIyNTAxNTYz",
    "avatar_url": "https://avatars.githubusercontent.com/u/22501563?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tanaybhartia",
    "html_url": "https://github.com/tanaybhartia",
    "followers_url": "https://api.github.com/users/tanaybhartia/followers",
    "following_url": "https://api.github.com/users/tanaybhartia/following{/other_user}",
    "gists_url": "https://api.github.com/users/tanaybhartia/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tanaybhartia/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tanaybhartia/subscriptions",
    "organizations_url": "https://api.github.com/users/tanaybhartia/orgs",
    "repos_url": "https://api.github.com/users/tanaybhartia/repos",
    "events_url": "https://api.github.com/users/tanaybhartia/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tanaybhartia/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1132754722,
      "node_id": "MDU6TGFiZWwxMTMyNzU0NzIy",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/need:more-information",
      "name": "need:more-information",
      "color": "db6fa3",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2019-11-06T05:30:03Z",
  "updated_at": "2019-12-12T15:21:39Z",
  "closed_at": "2019-12-12T15:21:39Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "\r\n#### System information\r\n\r\nGeth version: `1.9.3-stable-cfbb969d`\r\nOS & Version: Ubuntu 18.04.3 LTS\r\n\r\n#### Expected behaviour\r\nTransaction receipt\r\n\r\n#### Actual behaviour\r\nReturned error: gas required exceeds allowance (91135865401031) or always failing transaction\r\n\r\n#### Steps to reproduce the behaviour\r\nI  have created a private network with the following genesis block (similar response even if I alloc an account with ether):\r\n```\r\n{\r\n\"config\": {\r\n\"chainId\": 16,\r\n\"homesteadBlock\": 0,\r\n\"eip155Block\": 0,\r\n\"eip158Block\": 0\r\n},\r\n\"constantinopleBlock\": 1,\r\n\"petersburgBlock\": 1,\r\n\"alloc\": {\r\n\t\"0xc3ec8cfb877b639094d2bc4bb99651dcb0c36aff\": { \r\n\t\t\"balance\": \"1000000000000000000000000000000000000000\"\r\n\t\t}\r\n\t},\r\n\"difficulty\" : \"200\",\r\n\"gasLimit\" : \"99999999999999\"\r\n}\r\n```\r\nI have the following command to run the network:\r\n\r\n`geth --datadir ./exp4 --networkid 16 --rpc --rpcapi \"eth,net,web3,personal,miner\" --nodiscover --allow-insecure-unlock --port 3000 console`\r\n\r\nThis is my truffle contract:\r\n\r\n```\r\npragma solidity ^0.5.8;\r\ncontract Hello {\r\n   string public message;\r\n   function HelloWorld() public{\r\n       message = \"Hello, World : This is a Solidity Smart Contract on the Private Ethereum Blockchain \";\r\n   }\r\n}\r\n```\r\nTruffle Config: \r\n\r\n```\r\nrpc: {\r\n    host:\"localhost\",\r\n    port:8545\r\n},\r\nnetworks: {\r\n    development: {\r\n        host: \"127.0.0.1\",     // Localhost (default: none)\r\n        port: 8545,            // Standard Ethereum port (default: none)\r\n        network_id: \"16\",      // Any network (default: none)\r\n        from: \"0xc3ec8cfb877b639094d2bc4bb99651dcb0c36aff\",\r\n        gas: 20000000\r\n    }\r\n}\r\n```\r\n\r\nThis is the nodejs script that I am running:\r\n \r\n```\r\nvar Web3 = require('web3')\r\nvar web3_http = new Web3(new Web3.providers.HttpProvider('http://127.0.0.1:8545'));\r\nconst fs = require('fs');\r\nconst con = JSON.parse(fs.readFileSync('./build/contracts/Hello.json', 'utf8'));\r\nvar abi = con.abi;\r\nweb3_http.eth.getBalance(\"0xc3ec8cfb877b639094d2bc4bb99651dcb0c36aff\")\r\n.then(console.log);\r\nvar cont = new web3_http.eth.Contract(abi, \"0xdCf9a6832Fae44B081f62513D04c2E30fB9a6A00\");\r\nconsole.log(cont);\r\n\r\ncont.methods.HelloWorld().estimateGas({from: \"0xc3ec8cfb877b639094d2bc4bb99651dcb0c36aff\"})\r\n.then(function(gasAmount){\r\n    console.log(gasAmount);\r\n})\r\n.catch(function(error){\r\n    console.log(error);\r\n});\r\n```\r\n\r\n`0xc3ec8cfb877b639094d2bc4bb99651dcb0c36aff` is the account address and `0xdCf9a6832Fae44B081f62513D04c2E30fB9a6A00` is the address at which my contract is deployed. It shows correct ether value for my account and fetches the contract correctly but gives a gas limit exceeding error when estimating gas.\r\n\r\nBut when I access the contract through Truffle console, it works fine and the transaction is successful. Truffle code:\r\n\r\n ```\r\nlet instance = await Hello.deployed()  \r\ninstance.HelloWorld()\r\n```\r\nIf there is an actual error for gas exceed, then it should be the same whether I use web3js or console but I don't get this error while submitting transactions through truffle console.\r\n\r\nThank you.\r\n",
  "closed_by": {
    "login": "no-response[bot]",
    "id": 32965360,
    "node_id": "MDM6Qm90MzI5NjUzNjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/26350515?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/no-response%5Bbot%5D",
    "html_url": "https://github.com/apps/no-response",
    "followers_url": "https://api.github.com/users/no-response%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/no-response%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/no-response%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/no-response%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/no-response%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/no-response%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/no-response%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/no-response%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/no-response%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20246/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20246/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/550374615",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20246#issuecomment-550374615",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20246",
    "id": 550374615,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1MDM3NDYxNQ==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-06T15:56:45Z",
    "updated_at": "2019-11-06T15:56:45Z",
    "author_association": "MEMBER",
    "body": "Your chain config seems very wrong (half the fields are outside of it). Please fix according to\r\n\r\n```\r\n  \"config\": {\r\n    \"chainId\": <arbitrary positive integer>,\r\n    \"homesteadBlock\": 0,\r\n    \"eip150Block\": 0,\r\n    \"eip155Block\": 0,\r\n    \"eip158Block\": 0,\r\n    \"byzantiumBlock\": 0,\r\n    \"constantinopleBlock\": 0,\r\n    \"petersburgBlock\": 0\r\n  },\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/550374615/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/565051855",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20246#issuecomment-565051855",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20246",
    "id": 565051855,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NTA1MTg1NQ==",
    "user": {
      "login": "no-response[bot]",
      "id": 32965360,
      "node_id": "MDM6Qm90MzI5NjUzNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/26350515?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/no-response%5Bbot%5D",
      "html_url": "https://github.com/apps/no-response",
      "followers_url": "https://api.github.com/users/no-response%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/no-response%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/no-response%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/no-response%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/no-response%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/no-response%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/no-response%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/no-response%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/no-response%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2019-12-12T15:21:38Z",
    "updated_at": "2019-12-12T15:21:38Z",
    "author_association": "NONE",
    "body": "This issue has been automatically closed because there has been no response to our request for more information from the original author. With only the information that is currently in the issue, we don't have enough information to take action. Please reach out if you have more relevant information or answers to our questions so that we can investigate further.\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/565051855/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
