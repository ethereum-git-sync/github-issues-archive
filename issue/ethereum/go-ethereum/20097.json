{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20097",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20097/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20097/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20097/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/20097",
  "id": 495940037,
  "node_id": "MDU6SXNzdWU0OTU5NDAwMzc=",
  "number": 20097,
  "title": "`geth --testnet --syncmode=light --unlock 0` induces SIGSEGV",
  "user": {
    "login": "meithecatte",
    "id": 23580910,
    "node_id": "MDQ6VXNlcjIzNTgwOTEw",
    "avatar_url": "https://avatars.githubusercontent.com/u/23580910?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/meithecatte",
    "html_url": "https://github.com/meithecatte",
    "followers_url": "https://api.github.com/users/meithecatte/followers",
    "following_url": "https://api.github.com/users/meithecatte/following{/other_user}",
    "gists_url": "https://api.github.com/users/meithecatte/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/meithecatte/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/meithecatte/subscriptions",
    "organizations_url": "https://api.github.com/users/meithecatte/orgs",
    "repos_url": "https://api.github.com/users/meithecatte/repos",
    "events_url": "https://api.github.com/users/meithecatte/events{/privacy}",
    "received_events_url": "https://api.github.com/users/meithecatte/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "rjl493456442",
    "id": 5959481,
    "node_id": "MDQ6VXNlcjU5NTk0ODE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rjl493456442",
    "html_url": "https://github.com/rjl493456442",
    "followers_url": "https://api.github.com/users/rjl493456442/followers",
    "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
    "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
    "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
    "repos_url": "https://api.github.com/users/rjl493456442/repos",
    "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2019-09-19T17:46:35Z",
  "updated_at": "2019-09-25T08:05:16Z",
  "closed_at": "2019-09-25T08:05:16Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I don't know how to go about debugging this. Something's probably wrong, though, and I doubt it's my system.\r\n\r\n#### System information\r\n\r\nGeth version: multiple, including\r\n```\r\nGeth\r\nVersion: 1.9.4-stable\r\nGit Commit: 46891c12ab54c9e179f26378ce618fd48460190c\r\nGit Commit Date: 20190919\r\nArchitecture: amd64\r\nProtocol Versions: [63]\r\nNetwork Id: 1\r\nGo Version: go1.13\r\nOperating System: linux\r\nGOPATH=\r\nGOROOT=/usr/lib/go\r\n```\r\nOS & Version: Arch Linux (not versioned)\r\n\r\n#### Expected behaviour\r\n\r\nNo SIGSEGV.\r\n\r\n#### Actual behaviour\r\n\r\nSIGSEGV.\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\n`$ geth --testnet --syncmode=light --unlock 0` is what does it for me.\r\n\r\n#### Backtrace\r\n\r\n````\r\nINFO [09-19|19:41:20.910] Dropping default light client cache      provided=1024 updated=128\r\nINFO [09-19|19:41:20.912] Maximum peer count                       ETH=0 LES=10 total=50\r\nINFO [09-19|19:41:20.912] Smartcard socket not found, disabling    err=\"stat /run/pcscd/pcscd.comm: no such file or directory\"\r\nINFO [09-19|19:41:20.914] Starting peer-to-peer node               instance=Geth/v1.9.4-stable-46891c12/linux-amd64/go1.13\r\nINFO [09-19|19:41:20.914] Allocated cache and file handles         database=/home/kuba/.ethereum/testnet/geth/lightchaindata cache=64.00MiB handles=262144\r\nINFO [09-19|19:41:21.152] Persisted trie from memory database      nodes=355 size=50.67KiB time=1.741618ms gcnodes=0 gcsize=0.00B gctime=0s livenodes=1 livesize=0.00B\r\nINFO [09-19|19:41:21.152] Initialised chain configuration          config=\"{ChainID: 3 Homestead: 0 DAO: <nil> DAOSupport: true EIP150: 0 EIP155: 10 EIP158: 10 Byzantium: 1700000 Constantinople: 4230000 Petersburg: 4939394 Istanbul: 6485846 Engine: ethash}\"\r\nINFO [09-19|19:41:21.152] Disk storage enabled for ethash caches   dir=/home/kuba/.ethereum/testnet/geth/ethash count=3\r\nINFO [09-19|19:41:21.152] Disk storage enabled for ethash DAGs     dir=/home/kuba/.ethash                       count=2\r\nINFO [09-19|19:41:21.159] Added trusted checkpoint                 block=6389759 hash=34b61d…54cfcc\r\nINFO [09-19|19:41:21.159] Loaded most recent local header          number=6365073 hash=a395bc…5646a0 td=22943014814221353 age=1w2d3h\r\nINFO [09-19|19:41:21.159] Configured checkpoint registrar          address=0xEF79475013f154E6A65b54cB2742867791bf0B84 signers=5 threshold=2\r\nINFO [09-19|19:41:21.339] UDP listener up                          net=enode://cb1b4bcf388b44871bda4010940f6ac513ec26ee3ffeabab30329c07e15a8e64eca2e927bcc018a7511a91bc7f273d5df866747b70de7f59b37b300ac2405dd5@[::]:30303\r\nWARN [09-19|19:41:21.343] Light client mode is an experimental feature\r\nINFO [09-19|19:41:21.345] New local node record                    seq=21 id=3f4ed110dfa16ae9 ip=127.0.0.1 udp=30303 tcp=30303\r\nINFO [09-19|19:41:21.345] Started P2P networking                   self=enode://cb1b4bcf388b44871bda4010940f6ac513ec26ee3ffeabab30329c07e15a8e64eca2e927bcc018a7511a91bc7f273d5df866747b70de7f59b37b300ac2405dd5@127.0.0.1:30303\r\nINFO [09-19|19:41:21.347] IPC endpoint opened                      url=/home/kuba/.ethereum/testnet/geth.ipc\r\nWARN [09-19|19:41:21.347] -------------------------------------------------------------------\r\nWARN [09-19|19:41:21.347] Referring to accounts by order in the keystore folder is dangerous!\r\nWARN [09-19|19:41:21.347] This functionality is deprecated and will be removed in the future!\r\nWARN [09-19|19:41:21.347] Please use explicit addresses! (can search via `geth account list`)\r\nWARN [09-19|19:41:21.347] -------------------------------------------------------------------\r\nUnlocking account 0 | Attempt 1/3\r\nPassword: panic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x56214c7eb26f]\r\n\r\ngoroutine 128 [running]:\r\ngithub.com/ethereum/go-ethereum/les.(*clientHandler).synchronise(0xc000527800, 0xc0002d7b00)\r\n        /build/go-ethereum/src/go-ethereum/build/_workspace/src/github.com/ethereum/go-ethereum/les/sync.go:160 +0x38f\r\ngithub.com/ethereum/go-ethereum/les.(*lightFetcher).newFetcherDistReqForSync.func3.1(0x56214d24da20, 0xc0002d7b00, 0xc0002625a0)\r\n        /build/go-ethereum/src/go-ethereum/build/_workspace/src/github.com/ethereum/go-ethereum/les/fetcher.go:509 +0x93\r\ncreated by github.com/ethereum/go-ethereum/les.(*lightFetcher).newFetcherDistReqForSync.func3\r\n        /build/go-ethereum/src/go-ethereum/build/_workspace/src/github.com/ethereum/go-ethereum/les/fetcher.go:506 +0xb7\r\n````",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20097/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20097/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/534454846",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20097#issuecomment-534454846",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20097",
    "id": 534454846,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNDQ1NDg0Ng==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-24T08:36:02Z",
    "updated_at": "2019-09-24T08:36:02Z",
    "author_association": "MEMBER",
    "body": "This is odd. Works for me on Ubuntu",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/534454846/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/534457543",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20097#issuecomment-534457543",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20097",
    "id": 534457543,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNDQ1NzU0Mw==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-24T08:42:56Z",
    "updated_at": "2019-09-24T08:42:56Z",
    "author_association": "MEMBER",
    "body": "I guess it's unrelated to the flags and some issue depending on the light server you're connected to. Looking into it.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/534457543/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/534499235",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20097#issuecomment-534499235",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20097",
    "id": 534499235,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNDQ5OTIzNQ==",
    "user": {
      "login": "meithecatte",
      "id": 23580910,
      "node_id": "MDQ6VXNlcjIzNTgwOTEw",
      "avatar_url": "https://avatars.githubusercontent.com/u/23580910?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/meithecatte",
      "html_url": "https://github.com/meithecatte",
      "followers_url": "https://api.github.com/users/meithecatte/followers",
      "following_url": "https://api.github.com/users/meithecatte/following{/other_user}",
      "gists_url": "https://api.github.com/users/meithecatte/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/meithecatte/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/meithecatte/subscriptions",
      "organizations_url": "https://api.github.com/users/meithecatte/orgs",
      "repos_url": "https://api.github.com/users/meithecatte/repos",
      "events_url": "https://api.github.com/users/meithecatte/events{/privacy}",
      "received_events_url": "https://api.github.com/users/meithecatte/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-24T10:36:52Z",
    "updated_at": "2019-09-24T10:36:52Z",
    "author_association": "NONE",
    "body": "This seems to work fine when I use my address instead of the key index. Alternatively, it's just intermittent and my luck is weird, since I don't see how this can be related considering the backtrace.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/534499235/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
