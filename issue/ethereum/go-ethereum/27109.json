{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27109",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27109/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27109/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27109/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/27109",
  "id": 1672283174,
  "node_id": "I_kwDOAOvK985jrQQm",
  "number": 27109,
  "title": "OOM Kill during state snapshot generation after upgrading to Geth 1.11.5",
  "user": {
    "login": "dasudiy",
    "id": 478559,
    "node_id": "MDQ6VXNlcjQ3ODU1OQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/478559?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dasudiy",
    "html_url": "https://github.com/dasudiy",
    "followers_url": "https://api.github.com/users/dasudiy/followers",
    "following_url": "https://api.github.com/users/dasudiy/following{/other_user}",
    "gists_url": "https://api.github.com/users/dasudiy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dasudiy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dasudiy/subscriptions",
    "organizations_url": "https://api.github.com/users/dasudiy/orgs",
    "repos_url": "https://api.github.com/users/dasudiy/repos",
    "events_url": "https://api.github.com/users/dasudiy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dasudiy/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 268304226,
      "node_id": "MDU6TGFiZWwyNjgzMDQyMjY=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:docs",
      "name": "type:docs",
      "color": "fef2c0",
      "default": false,
      "description": null
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-04-18T03:20:15Z",
  "updated_at": "2023-04-18T08:48:01Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I have a node that was previously running in a synchronized state. After updating to Geth 1.11.5, I started experiencing issues with the node. I ran removedb and preserved the ancients before attempting to resynchronize. However, during the state snapshot generation process, my node is repeatedly killed due to Out Of Memory (OOM) errors.\r\n\r\nI have tried increasing the swapfile size to 32GB, but Geth still consumes all available memory, leading to OOM kills. I also attempted to set the --cache flag to 1024, but it does not seem to make any noticeable difference.\r\n\r\nI'm seeking guidance on how to resolve this issue and prevent OOM kills during state snapshot generation. Thank you.\r\n\r\n```\r\nApr 18 03:06:38 eth geth[12928]: WARN [04-18|03:06:38.510] Post-merge network, but no beacon client seen. Please launch one to follow the chain!\r\nApr 18 03:06:43 eth geth[12928]: INFO [04-18|03:06:43.544] Generating state snapshot                root=87ef8e..1c588e in=159e48..5eae12 at=21f32f..dbbacf accounts=17,284,328 slots=108,289,769 storage=8.59GiB dangling=0 elapsed=42m17.367s   eta=95h51m52.445s\r\nApr 18 03:06:54 eth geth[12928]: INFO [04-18|03:06:54.398] Generating state snapshot                root=87ef8e..1c588e in=159e48..5eae12 at=21fd76..f68ce4 accounts=17,284,328 slots=108,294,891 storage=8.59GiB dangling=0 elapsed=42m28.221s   eta=96h16m28.719s\r\nApr 18 03:07:03 eth geth[12928]: INFO [04-18|03:07:03.761] Generating state snapshot                root=87ef8e..1c588e in=159e48..5eae12 at=221838..8b1883 accounts=17,284,328 slots=108,308,207 storage=8.59GiB dangling=0 elapsed=42m37.583s   eta=96h37m42.064s\r\nApr 18 03:07:05 eth geth[12928]: WARN [04-18|03:07:05.485] Ignoring already known beacon payload    number=17,070,786 hash=ca5474..70d8fc age=6m30s\r\nApr 18 03:07:11 eth geth[12928]: INFO [04-18|03:07:11.950] Generating state snapshot                root=87ef8e..1c588e in=159e48..5eae12 at=221e53..ad533f accounts=17,284,328 slots=108,311,281 storage=8.59GiB dangling=0 elapsed=42m45.773s   eta=96h56m16.002s\r\nApr 18 03:07:20 eth geth[12928]: INFO [04-18|03:07:20.382] Generating state snapshot                root=87ef8e..1c588e in=159e48..5eae12 at=222813..68dd80 accounts=17,284,328 slots=108,315,948 storage=8.59GiB dangling=0 elapsed=42m54.205s   eta=97h15m22.855s\r\nApr 18 03:07:22 eth geth[12928]: WARN [04-18|03:07:22.378] Snapshot extension registration failed   peer=d33c3f82 err=\"peer connected on snap without compatible eth support\"\r\nApr 18 03:07:30 eth geth[12928]: INFO [04-18|03:07:30.323] Generating state snapshot                root=87ef8e..1c588e in=159e48..5eae12 at=222f4b..b72066 accounts=17,284,328 slots=108,319,476 storage=8.59GiB dangling=0 elapsed=43m4.146s    eta=97h37m54.95s\r\nApr 18 03:07:30 eth geth[12928]: INFO [04-18|03:07:30.977] Chain head was updated                   number=17,070,786 hash=ca5474..70d8fc root=8ff628..02ed48 elapsed=215.484746ms age=6m55s\r\nApr 18 03:07:31 eth geth[12928]: WARN [04-18|03:07:31.368] Peer delivering stale transactions       peer=ab96ffe34be396ee895da452f3ad64c52e5fd763bd54c83cb0484db8c206b569 rejected=34\r\nApr 18 03:07:37 eth systemd[1]: geth.service: A process of this unit has been killed by the OOM killer.\r\nApr 18 03:07:41 eth systemd[1]: geth.service: Main process exited, code=killed, status=9/KILL\r\nApr 18 03:07:41 eth systemd[1]: geth.service: Failed with result 'oom-kill'.\r\nApr 18 03:07:41 eth systemd[1]: geth.service: Consumed 1h 13min 50.046s CPU time.\r\nApr 18 03:07:46 eth systemd[1]: geth.service: Scheduled restart job, restart counter is at 1.\r\nApr 18 03:07:46 eth systemd[1]: Stopped Geth Execution Client (Mainnet).\r\nApr 18 03:07:46 eth systemd[1]: geth.service: Consumed 1h 13min 50.046s CPU time.\r\nApr 18 03:07:46 eth systemd[1]: Started Geth Execution Client (Mainnet).\r\nApr 18 03:07:46 eth geth[13045]: INFO [04-18|03:07:46.439] Starting Geth on Ethereum mainnet...\r\nApr 18 03:07:46 eth geth[13045]: INFO [04-18|03:07:46.442] Maximum peer count                       ETH=50 LES=0 total=50\r\nApr 18 03:07:46 eth geth[13045]: INFO [04-18|03:07:46.444] Smartcard socket not found, disabling    err=\"stat /run/pcscd/pcscd.comm: no such file or directory\"\r\nApr 18 03:07:46 eth geth[13045]: INFO [04-18|03:07:46.447] Snap sync requested, enabling --snapshot\r\nApr 18 03:07:46 eth geth[13045]: INFO [04-18|03:07:46.447] Set global gas cap                       cap=50,000,000\r\nApr 18 03:07:46 eth geth[13045]: INFO [04-18|03:07:46.448] Allocated trie memory caches             clean=153.00MiB dirty=256.00MiB\r\nApr 18 03:07:46 eth geth[13045]: INFO [04-18|03:07:46.845] Using leveldb as the backing database\r\nApr 18 03:07:46 eth geth[13045]: INFO [04-18|03:07:46.845] Allocated cache and file handles         database=/var/lib/geth/geth/chaindata cache=512.00MiB handles=262,144\r\nApr 18 03:07:47 eth geth[13045]: INFO [04-18|03:07:47.894] Using LevelDB as the backing database\r\nApr 18 03:07:47 eth geth[13045]: INFO [04-18|03:07:47.950] Opened ancient database                  database=/var/lib/geth/geth/chaindata/ancient/chain readonly=false\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.639] Disk storage enabled for ethash caches   dir=/var/lib/geth/geth/ethash count=3\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.639] Disk storage enabled for ethash DAGs     dir=/home/geth/.ethash        count=2\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.643] Initialising Ethereum protocol           network=1 dbversion=8\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.645]\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646] ---------------------------------------------------------------------------------------------------------------------------------------------------------\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646] Chain ID:  1 (mainnet)\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646] Consensus: Beacon (proof-of-stake), merged from Ethash (proof-of-work)\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646] Pre-Merge hard forks (block based):\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - Homestead:                   #1150000  (https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/homestead.md)\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - DAO Fork:                    #1920000  (https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/dao-fork.md)\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - Tangerine Whistle (EIP 150): #2463000  (https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/tangerine-whistle.md)\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - Spurious Dragon/1 (EIP 155): #2675000  (https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/spurious-dragon.md)\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - Spurious Dragon/2 (EIP 158): #2675000  (https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/spurious-dragon.md)\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - Byzantium:                   #4370000  (https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/byzantium.md)\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - Constantinople:              #7280000  (https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/constantinople.md)\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - Petersburg:                  #7280000  (https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/petersburg.md)\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - Istanbul:                    #9069000  (https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/istanbul.md)\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - Muir Glacier:                #9200000  (https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/muir-glacier.md)\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - Berlin:                      #12244000 (https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/berlin.md)\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - London:                      #12965000 (https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/london.md)\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - Arrow Glacier:               #13773000 (https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/arrow-glacier.md)\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - Gray Glacier:                #15050000 (https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/gray-glacier.md)\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646] Merge configured:\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - Hard-fork specification:    https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/paris.md\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - Network known to be merged: true\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - Total terminal difficulty:  58750000000000000000000\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646] Post-Merge hard forks (timestamp based):\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]  - Shanghai:                    @1681338455 (https://github.com/ethereum/execution-specs/blob/master/network-upgrades/mainnet-upgrades/shanghai.md)\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646] ---------------------------------------------------------------------------------------------------------------------------------------------------------\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.646]\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.649] Loaded most recent local block           number=17,070,786 hash=ca5474..70d8fc td=58,750,003,716,598,352,816,469 age=7m13s\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.649] Loaded most recent local finalized block number=17,070,702 hash=dd0b7e..537b26 td=58,750,003,716,598,352,816,469 age=24m13s\r\nApr 18 03:07:48 eth geth[13045]: INFO [04-18|03:07:48.650] Loaded last fast-sync pivot marker       number=17,069,758\r\nApr 18 03:07:48 eth geth[13045]: WARN [04-18|03:07:48.651] Head state missing, repairing            number=17,070,786 hash=ca5474..70d8fc snaproot=87ef8e..1c588e\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.088] Loaded most recent local header          number=17,070,786 hash=ca5474..70d8fc td=58,750,003,716,598,352,816,469 age=7m14s\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.088] Loaded most recent local block           number=17,070,606 hash=d6687a..648476 td=58,750,003,716,598,352,816,469 age=43m38s\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.088] Loaded most recent local snap block      number=17,070,786 hash=ca5474..70d8fc td=58,750,003,716,598,352,816,469 age=7m14s\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.089] Loaded most recent local finalized block number=17,070,702 hash=dd0b7e..537b26 td=58,750,003,716,598,352,816,469 age=24m14s\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.089] Loaded last fast-sync pivot marker       number=17,069,758\r\nApr 18 03:07:49 eth geth[13045]: WARN [04-18|03:07:49.092] Enabling snapshot recovery               chainhead=17,070,606 diskbase=17,070,778\r\nApr 18 03:07:49 eth geth[13045]: WARN [04-18|03:07:49.094] Loaded snapshot journal                  diskroot=87ef8e..1c588e diffs=unmatched\r\nApr 18 03:07:49 eth geth[13045]: WARN [04-18|03:07:49.094] Snapshot is not continuous with chain    snaproot=87ef8e..1c588e chainroot=82d8a7..f724dd\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.094] Loaded local transaction journal         transactions=0 dropped=0\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.094] Resuming state snapshot generation       root=87ef8e..1c588e in=159e48..5eae12 at=2173a4..1e1d66 accounts=17,284,328 slots=108,226,266 storage=8.58GiB dangling=0 elapsed=\"249.036Âµs\"\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.095] Regenerated local transaction journal    transactions=0 accounts=0\r\nApr 18 03:07:49 eth geth[13045]: WARN [04-18|03:07:49.095] Switch sync mode from snap sync to full sync\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.095] Chain post-merge, sync via beacon client\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.096] Gasprice oracle is ignoring threshold set threshold=2\r\nApr 18 03:07:49 eth geth[13045]: WARN [04-18|03:07:49.096] Old unclean shutdowns found              count=25\r\nApr 18 03:07:49 eth geth[13045]: WARN [04-18|03:07:49.096] Unclean shutdown detected                booted=2023-04-17T07:05:57+0000 age=20h1m52s\r\nApr 18 03:07:49 eth geth[13045]: WARN [04-18|03:07:49.096] Unclean shutdown detected                booted=2023-04-17T08:55:34+0000 age=18h12m15s\r\nApr 18 03:07:49 eth geth[13045]: WARN [04-18|03:07:49.096] Unclean shutdown detected                booted=2023-04-17T10:48:20+0000 age=16h19m29s\r\nApr 18 03:07:49 eth geth[13045]: WARN [04-18|03:07:49.096] Unclean shutdown detected                booted=2023-04-17T12:41:49+0000 age=14h26m\r\nApr 18 03:07:49 eth geth[13045]: WARN [04-18|03:07:49.096] Unclean shutdown detected                booted=2023-04-17T14:08:34+0000 age=12h59m15s\r\nApr 18 03:07:49 eth geth[13045]: WARN [04-18|03:07:49.096] Unclean shutdown detected                booted=2023-04-17T16:19:52+0000 age=10h47m57s\r\nApr 18 03:07:49 eth geth[13045]: WARN [04-18|03:07:49.096] Unclean shutdown detected                booted=2023-04-17T18:48:31+0000 age=8h19m18s\r\nApr 18 03:07:49 eth geth[13045]: WARN [04-18|03:07:49.096] Unclean shutdown detected                booted=2023-04-17T21:36:16+0000 age=5h31m33s\r\nApr 18 03:07:49 eth geth[13045]: WARN [04-18|03:07:49.096] Unclean shutdown detected                booted=2023-04-17T23:22:54+0000 age=3h44m55s\r\nApr 18 03:07:49 eth geth[13045]: WARN [04-18|03:07:49.096] Unclean shutdown detected                booted=2023-04-18T01:19:41+0000 age=1h48m8s\r\nApr 18 03:07:49 eth geth[13045]: WARN [04-18|03:07:49.096] Unclean shutdown detected                booted=2023-04-18T03:04:26+0000 age=3m23s\r\nApr 18 03:07:49 eth geth[13045]: WARN [04-18|03:07:49.096] Engine API enabled                       protocol=eth\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.097] Starting peer-to-peer node               instance=Geth/v1.11.5-stable-a38f4108/linux-amd64/go1.20.2\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.098] Trie missing, state snapshotting paused  root=87ef8e..1c588e in=159e48..5eae12 at=2173a4..1e1d66 accounts=17,284,328 slots=108,226,266 storage=8.58GiB dangling=0 elapsed=3.739ms\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.144] New local node record                    seq=1,662,041,897,926 id=cfcce68fd0196271 ip=127.0.0.1 udp=30303 tcp=30303\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.145] Started P2P networking                   self=enode://688e713339375261742a59c04465379649124b54113acb7b0c21313f670e95fa79ad1bd8018061f943249772d1094e864043169e502a6715011001eec38c9236@127.0.0.1:30303\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.145] IPC endpoint opened                      url=/var/lib/geth/geth.ipc\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.146] Loaded JWT secret file                   path=/var/lib/jwt.hex crc32=0xca4fe9b5\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.146] HTTP server started                      endpoint=127.0.0.1:8545 auth=false prefix= cors= vhosts=localhost\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.146] WebSocket enabled                        url=ws://127.0.0.1:8551\r\nApr 18 03:07:49 eth geth[13045]: INFO [04-18|03:07:49.146] HTTP server started                      endpoint=127.0.0.1:8551 auth=true  prefix= cors=localhost vhosts=localhost\r\nApr 18 03:07:55 eth geth[13045]: INFO [04-18|03:07:55.010] New local node record                    seq=1,662,041,897,927 id=cfcce68fd0196271 ip=116.52.68.219 udp=30303 tcp=30303\r\nApr 18 03:07:55 eth geth[13045]: WARN [04-18|03:07:55.312] Snapshot extension registration failed   peer=409e2bcc err=\"peer connected on snap without compatible eth support\"\r\nApr 18 03:07:59 eth geth[13045]: INFO [04-18|03:07:59.466] Looking for peers                        peercount=0 tried=14 static=0\r\nApr 18 03:08:09 eth geth[13045]: INFO [04-18|03:08:09.631] Looking for peers                        peercount=0 tried=24 static=0\r\nApr 18 03:08:19 eth geth[13045]: INFO [04-18|03:08:19.654] Looking for peers                        peercount=2 tried=30 static=0\r\nApr 18 03:08:24 eth geth[13045]: WARN [04-18|03:08:24.099] Post-merge network, but no beacon client seen. Please launch one to follow the chain!\r\nApr 18 03:08:29 eth geth[13045]: INFO [04-18|03:08:29.748] Looking for peers                        peercount=2 tried=32 static=0\r\nApr 18 03:08:39 eth geth[13045]: INFO [04-18|03:08:39.841] Looking for peers                        peercount=2 tried=34 static=0\r\nApr 18 03:08:50 eth geth[13045]: INFO [04-18|03:08:50.175] Looking for peers                        peercount=2 tried=35 static=0\r\nApr 18 03:08:53 eth geth[13045]: WARN [04-18|03:08:53.017] Snapshot extension registration failed   peer=dd74b5b2 err=\"peer connected on snap without compatible eth support\"\r\nApr 18 03:09:00 eth geth[13045]: INFO [04-18|03:09:00.275] Looking for peers                        peercount=2 tried=35 static=0\r\nApr 18 03:09:05 eth geth[13045]: WARN [04-18|03:09:05.606] Snapshot extension registration failed   peer=1365675b err=\"peer connected on snap without compatible eth support\"\r\nApr 18 03:09:10 eth geth[13045]: INFO [04-18|03:09:10.466] Looking for peers                        peercount=3 tried=34 static=0\r\nApr 18 03:09:20 eth geth[13045]: INFO [04-18|03:09:20.650] Looking for peers                        peercount=3 tried=28 static=0\r\nApr 18 03:09:30 eth geth[13045]: INFO [04-18|03:09:30.799] Looking for peers                        peercount=3 tried=30 static=0\r\nApr 18 03:09:40 eth geth[13045]: INFO [04-18|03:09:40.799] Looking for peers                        peercount=4 tried=30 static=0\r\nApr 18 03:09:50 eth geth[13045]: INFO [04-18|03:09:50.800] Looking for peers                        peercount=2 tried=34 static=0\r\nApr 18 03:09:54 eth geth[13045]: WARN [04-18|03:09:54.140] State not available, ignoring new payload\r\nApr 18 03:09:54 eth geth[13045]: WARN [04-18|03:09:54.150] Ignoring payload with missing parent     number=17,070,788 hash=ec68d3..80e67a parent=c7cb3f..993147\r\nApr 18 03:09:54 eth geth[13045]: WARN [04-18|03:09:54.158] Ignoring payload with missing parent     number=17,070,789 hash=ae80c4..6c4f6b parent=ec68d3..80e67a\r\nApr 18 03:09:54 eth geth[13045]: WARN [04-18|03:09:54.167] Ignoring payload with missing parent     number=17,070,790 hash=7f9e7f..35139e parent=ae80c4..6c4f6b\r\nApr 18 03:09:54 eth geth[13045]: WARN [04-18|03:09:54.181] Ignoring payload with missing parent     number=17,070,791 hash=cb19be..62c1e5 parent=7f9e7f..35139e\r\nApr 18 03:09:54 eth geth[13045]: WARN [04-18|03:09:54.187] Ignoring payload with missing parent     number=17,070,792 hash=e5ba71..20178d parent=cb19be..62c1e5\r\nApr 18 03:09:54 eth geth[13045]: WARN [04-18|03:09:54.195] Ignoring payload with missing parent     number=17,070,793 hash=a4b964..ed4b24 parent=e5ba71..20178d\r\nApr 18 03:09:54 eth geth[13045]: WARN [04-18|03:09:54.204] Ignoring payload with missing parent     number=17,070,794 hash=07f696..0d09b5 parent=a4b964..ed4b24\r\nApr 18 03:09:54 eth geth[13045]: WARN [04-18|03:09:54.210] Ignoring payload with missing parent     number=17,070,795 hash=cd15e8..12273d parent=07f696..0d09b5\r\nApr 18 03:09:54 eth geth[13045]: WARN [04-18|03:09:54.223] Ignoring payload with missing parent     number=17,070,796 hash=2aa228..9da2bf parent=cd15e8..12273d\r\nApr 18 03:09:54 eth geth[13045]: WARN [04-18|03:09:54.231] Ignoring payload with missing parent     number=17,070,797 hash=e2634f..0bf8cd parent=2aa228..9da2bf\r\nApr 18 03:09:54 eth geth[13045]: WARN [04-18|03:09:54.869] Ignoring payload with missing parent     number=17,070,798 hash=35474d..f80496 parent=e2634f..0bf8cd\r\nApr 18 03:09:54 eth geth[13045]: WARN [04-18|03:09:54.877] Ignoring payload with missing parent     number=17,070,799 hash=1938a2..971f7b parent=35474d..f80496\r\nApr 18 03:09:54 eth geth[13045]: WARN [04-18|03:09:54.894] Ignoring payload with missing parent     number=17,070,800 hash=0aa049..ecc371 parent=1938a2..971f7b\r\nApr 18 03:09:54 eth geth[13045]: WARN [04-18|03:09:54.901] Ignoring payload with missing parent     number=17,070,801 hash=989896..35fde6 parent=0aa049..ecc371\r\nApr 18 03:09:55 eth geth[13045]: WARN [04-18|03:09:55.070] Ignoring payload with missing parent     number=17,070,802 hash=591084..2d3e1c parent=989896..35fde6\r\nApr 18 03:09:55 eth geth[13045]: WARN [04-18|03:09:55.077] Ignoring payload with missing parent     number=17,070,803 hash=4bf046..104cbd parent=591084..2d3e1c\r\nApr 18 03:09:55 eth geth[13045]: WARN [04-18|03:09:55.081] Ignoring payload with missing parent     number=17,070,804 hash=8f9ba9..ab46c0 parent=4bf046..104cbd\r\nApr 18 03:09:55 eth geth[13045]: WARN [04-18|03:09:55.088] Ignoring payload with missing parent     number=17,070,805 hash=0a7b0e..d10945 parent=8f9ba9..ab46c0\r\nApr 18 03:09:55 eth geth[13045]: WARN [04-18|03:09:55.101] Ignoring payload with missing parent     number=17,070,806 hash=6f23a7..4a3962 parent=0a7b0e..d10945\r\nApr 18 03:09:55 eth geth[13045]: WARN [04-18|03:09:55.107] Ignoring payload with missing parent     number=17,070,807 hash=c68185..1a33ee parent=6f23a7..4a3962\r\nApr 18 03:09:55 eth geth[13045]: WARN [04-18|03:09:55.115] Ignoring payload with missing parent     number=17,070,808 hash=5a55df..6e3020 parent=c68185..1a33ee\r\nApr 18 03:09:55 eth geth[13045]: WARN [04-18|03:09:55.129] Ignoring payload with missing parent     number=17,070,809 hash=705570..6a1db0 parent=5a55df..6e3020\r\nApr 18 03:09:55 eth geth[13045]: WARN [04-18|03:09:55.135] Ignoring payload with missing parent     number=17,070,810 hash=a0ee93..a7b374 parent=705570..6a1db0\r\nApr 18 03:09:55 eth geth[13045]: WARN [04-18|03:09:55.142] Ignoring payload with missing parent     number=17,070,811 hash=ed67a0..dfc532 parent=a0ee93..a7b374\r\nApr 18 03:09:55 eth geth[13045]: WARN [04-18|03:09:55.158] Ignoring payload with missing parent     number=17,070,812 hash=5c6f1c..7fc89b parent=ed67a0..dfc532\r\nApr 18 03:09:55 eth geth[13045]: WARN [04-18|03:09:55.165] Ignoring payload with missing parent     number=17,070,813 hash=47970a..09622e parent=5c6f1c..7fc89b\r\nApr 18 03:09:55 eth geth[13045]: WARN [04-18|03:09:55.178] Ignoring payload with missing parent     number=17,070,814 hash=b5f0cf..a83036 parent=47970a..09622e\r\nApr 18 03:09:55 eth geth[13045]: WARN [04-18|03:09:55.186] Ignoring payload with missing parent     number=17,070,815 hash=461005..6c5b72 parent=b5f0cf..a83036\r\nApr 18 03:09:55 eth geth[13045]: WARN [04-18|03:09:55.193] Ignoring payload with missing parent     number=17,070,816 hash=b46b6b..ad03a3 parent=461005..6c5b72\r\nApr 18 03:09:55 eth geth[13045]: INFO [04-18|03:09:55.215] Forkchoice requested sync to new head    number=17,070,816 hash=b46b6b..ad03a3 finalized=unknown\r\nApr 18 03:09:55 eth geth[13045]: INFO [04-18|03:09:55.619] Syncing beacon headers                   downloaded=29 left=0 eta=0s\r\nApr 18 03:09:55 eth geth[13045]: INFO [04-18|03:09:55.619] Block synchronisation started\r\nApr 18 03:09:55 eth geth[13045]: WARN [04-18|03:09:55.622] Retrieved pivot header from local        number=17,070,752 hash=e76167..7d7955 latest=17,070,816 oldest=17,070,787\r\nApr 18 03:09:55 eth geth[13045]: INFO [04-18|03:09:55.796] Importing sidechain segment              start=17,070,607 end=17,070,787\r\nApr 18 03:10:00 eth geth[13045]: INFO [04-18|03:10:00.993] Looking for peers                        peercount=3 tried=44 static=0\r\nApr 18 03:10:01 eth geth[13045]: INFO [04-18|03:10:01.976] Forkchoice requested sync to new head    number=17,070,817 hash=410936..5f3fe5 finalized=unknown\r\nApr 18 03:10:02 eth geth[13045]: INFO [04-18|03:10:02.847] Forkchoice requested sync to new head    number=17,070,818 hash=45256e..213d5b finalized=unknown\r\nApr 18 03:10:03 eth geth[13045]: INFO [04-18|03:10:03.748] Forkchoice requested sync to new head    number=17,070,819 hash=3f85b5..3ed23b finalized=unknown\r\nApr 18 03:10:04 eth geth[13045]: INFO [04-18|03:10:04.154] Forkchoice requested sync to new head    number=17,070,820 hash=b42a89..1952ef finalized=unknown\r\nApr 18 03:10:04 eth geth[13045]: INFO [04-18|03:10:04.527] Forkchoice requested sync to new head    number=17,070,821 hash=f20094..fe5683 finalized=unknown\r\nApr 18 03:10:04 eth geth[13045]: INFO [04-18|03:10:04.868] Imported new chain segment               number=17,070,612 hash=3773d8..119dcf blocks=6 txs=845 mgas=77.497 elapsed=9.072s      mgasps=8.542 age=44m41s    dirty=8.29MiB\r\nApr 18 03:10:04 eth geth[13045]: INFO [04-18|03:10:04.913] Forkchoice requested sync to new head    number=17,070,822 hash=8523b8..1c300a finalized=unknown\r\nApr 18 03:10:05 eth geth[13045]: INFO [04-18|03:10:05.309] Forkchoice requested sync to new head    number=17,070,823 hash=8dddee..72978e finalized=unknown\r\nApr 18 03:10:05 eth geth[13045]: INFO [04-18|03:10:05.653] Forkchoice requested sync to new head    number=17,070,824 hash=de7a7f..cc9c06 finalized=unknown\r\nApr 18 03:10:06 eth geth[13045]: INFO [04-18|03:10:06.014] Forkchoice requested sync to new head    number=17,070,825 hash=80a903..aadd44 finalized=unknown\r\nApr 18 03:10:07 eth geth[13045]: INFO [04-18|03:10:07.895] Forkchoice requested sync to new head    number=17,070,826 hash=6a48f8..b08db3 finalized=unknown\r\nApr 18 03:10:08 eth geth[13045]: INFO [04-18|03:10:08.335] Forkchoice requested sync to new head    number=17,070,827 hash=a66060..73fdf9 finalized=unknown\r\nApr 18 03:10:08 eth geth[13045]: INFO [04-18|03:10:08.625] Forkchoice requested sync to new head    number=17,070,828 hash=f660da..97c053 finalized=unknown\r\nApr 18 03:10:08 eth geth[13045]: INFO [04-18|03:10:08.879] Forkchoice requested sync to new head    number=17,070,829 hash=fd2fed..0b0c1b finalized=unknown\r\nApr 18 03:10:11 eth geth[13045]: INFO [04-18|03:10:11.132] Looking for peers                        peercount=4 tried=40 static=0\r\nApr 18 03:10:13 eth geth[13045]: INFO [04-18|03:10:13.225] Imported new chain segment               number=17,070,621 hash=eb9361..4ee3f4 blocks=9 txs=1305 mgas=135.060 elapsed=8.356s      mgasps=16.162 age=43m2s     dirty=21.29MiB\r\n```\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27109/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27109/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1512386326",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/27109#issuecomment-1512386326",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27109",
    "id": 1512386326,
    "node_id": "IC_kwDOAOvK985aJS8W",
    "user": {
      "login": "Skylerspencer",
      "id": 118951670,
      "node_id": "U_kgDOBxcO9g",
      "avatar_url": "https://avatars.githubusercontent.com/u/118951670?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Skylerspencer",
      "html_url": "https://github.com/Skylerspencer",
      "followers_url": "https://api.github.com/users/Skylerspencer/followers",
      "following_url": "https://api.github.com/users/Skylerspencer/following{/other_user}",
      "gists_url": "https://api.github.com/users/Skylerspencer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Skylerspencer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Skylerspencer/subscriptions",
      "organizations_url": "https://api.github.com/users/Skylerspencer/orgs",
      "repos_url": "https://api.github.com/users/Skylerspencer/repos",
      "events_url": "https://api.github.com/users/Skylerspencer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Skylerspencer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-18T03:33:30Z",
    "updated_at": "2023-04-18T08:48:01Z",
    "author_association": "NONE",
    "body": "Why",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1512386326/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1512387240",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/27109#issuecomment-1512387240",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27109",
    "id": 1512387240,
    "node_id": "IC_kwDOAOvK985aJTKo",
    "user": {
      "login": "dasudiy",
      "id": 478559,
      "node_id": "MDQ6VXNlcjQ3ODU1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/478559?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dasudiy",
      "html_url": "https://github.com/dasudiy",
      "followers_url": "https://api.github.com/users/dasudiy/followers",
      "following_url": "https://api.github.com/users/dasudiy/following{/other_user}",
      "gists_url": "https://api.github.com/users/dasudiy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dasudiy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dasudiy/subscriptions",
      "organizations_url": "https://api.github.com/users/dasudiy/orgs",
      "repos_url": "https://api.github.com/users/dasudiy/repos",
      "events_url": "https://api.github.com/users/dasudiy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dasudiy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-18T03:35:24Z",
    "updated_at": "2023-04-18T03:35:24Z",
    "author_association": "NONE",
    "body": "One thing I forgot to mention, I've seen a bunch of \"Peer delivering stale transactions\" messages in my logs, something I didn't see before. Not sure if it's normal or related to this problem.\r\n\r\n```\r\nApr 18 03:29:45 eth geth[13045]: INFO [04-18|03:29:45.137] Generating state snapshot                root=d34c15..84c4c8 in=159e48..5eae12 at=7cf278..d714e8 accounts=17,284,328 slots=119,872,199 storage=9.35GiB dangling=0 elapsed=21m56.042s\r\nApr 18 03:29:51 eth geth[13045]: WARN [04-18|03:29:51.031] Peer delivering stale transactions       peer=3361a085d5af828a74982e15181b1ea4ae1888185b94a69b0b6d32bd6097c142 rejected=47\r\nApr 18 03:29:53 eth geth[13045]: INFO [04-18|03:29:53.427] Generating state snapshot                root=d34c15..84c4c8 in=159e48..5eae12 at=7d3445..a6aba1 accounts=17,284,328 slots=119,904,977 storage=9.36GiB dangling=0 elapsed=22m4.333s\r\nApr 18 03:29:56 eth geth[13045]: WARN [04-18|03:29:56.037] Peer delivering stale transactions       peer=3361a085d5af828a74982e15181b1ea4ae1888185b94a69b0b6d32bd6097c142 rejected=117\r\nApr 18 03:29:56 eth geth[13045]: WARN [04-18|03:29:56.873] Peer delivering stale transactions       peer=3361a085d5af828a74982e15181b1ea4ae1888185b94a69b0b6d32bd6097c142 rejected=72\r\nApr 18 03:29:59 eth geth[13045]: WARN [04-18|03:29:59.357] Peer delivering stale transactions       peer=3361a085d5af828a74982e15181b1ea4ae1888185b94a69b0b6d32bd6097c142 rejected=107\r\nApr 18 03:30:00 eth geth[13045]: WARN [04-18|03:30:00.444] Peer delivering stale transactions       peer=3361a085d5af828a74982e15181b1ea4ae1888185b94a69b0b6d32bd6097c142 rejected=106\r\nApr 18 03:30:01 eth geth[13045]: INFO [04-18|03:30:01.673] Generating state snapshot                root=d34c15..84c4c8 in=159e48..5eae12 at=7d8ac1..98dcb6 accounts=17,284,328 slots=119,947,987 storage=9.36GiB dangling=0 elapsed=22m12.578s\r\nApr 18 03:30:02 eth geth[13045]: WARN [04-18|03:30:02.477] Peer delivering stale transactions       peer=3361a085d5af828a74982e15181b1ea4ae1888185b94a69b0b6d32bd6097c142 rejected=104\r\nApr 18 03:30:03 eth geth[13045]: WARN [04-18|03:30:03.405] Peer delivering stale transactions       peer=3361a085d5af828a74982e15181b1ea4ae1888185b94a69b0b6d32bd6097c142 rejected=89\r\nApr 18 03:30:05 eth geth[13045]: WARN [04-18|03:30:05.270] Peer delivering stale transactions       peer=3361a085d5af828a74982e15181b1ea4ae1888185b94a69b0b6d32bd6097c142 rejected=111\r\nApr 18 03:30:06 eth geth[13045]: WARN [04-18|03:30:06.047] Peer delivering stale transactions       peer=3361a085d5af828a74982e15181b1ea4ae1888185b94a69b0b6d32bd6097c142 rejected=69\r\nApr 18 03:30:08 eth geth[13045]: WARN [04-18|03:30:08.108] Peer delivering stale transactions       peer=3361a085d5af828a74982e15181b1ea4ae1888185b94a69b0b6d32bd6097c142 rejected=114\r\nApr 18 03:30:09 eth geth[13045]: WARN [04-18|03:30:09.016] Peer delivering stale transactions       peer=3361a085d5af828a74982e15181b1ea4ae1888185b94a69b0b6d32bd6097c142 rejected=84\r\nApr 18 03:30:09 eth geth[13045]: INFO [04-18|03:30:09.881] Generating state snapshot                root=d34c15..84c4c8 in=159e48..5eae12 at=7dd8bb..4ae9e0 accounts=17,284,328 slots=119,986,906 storage=9.36GiB dangling=0 elapsed=22m20.786s\r\nApr 18 03:30:15 eth geth[13045]: INFO [04-18|03:30:15.468] Aborting state snapshot generation       root=d34c15..84c4c8 in=159e48..5eae12 at=7dfdd5..6486fc accounts=17,284,328 slots=120,005,346 storage=9.36GiB dangling=0 elapsed=22m26.374s\r\nApr 18 03:30:15 eth geth[13045]: INFO [04-18|03:30:15.511] Resuming state snapshot generation       root=060676..0c5107 in=159e48..5eae12 at=7dfdd5..6486fc accounts=17,284,328 slots=120,005,346 storage=9.36GiB dangling=0 elapsed=22m26.416s\r\nApr 18 03:30:18 eth geth[13045]: INFO [04-18|03:30:18.089] Imported new potential chain segment     number=17,070,921 hash=391571..6238a6 blocks=1  txs=115  mgas=12.816  elapsed=6.581s       mgasps=1.947  age=1m55s     dirty=254.73MiB\r\nApr 18 03:30:20 eth geth[13045]: INFO [04-18|03:30:20.669] Chain head was updated                   number=17,070,921 hash=391571..6238a6 root=11a5d5..67de27 elapsed=41.374779ms  age=1m57s\r\nApr 18 03:30:23 eth geth[13045]: INFO [04-18|03:30:23.710] Generating state snapshot                root=060676..0c5107 in=159e48..5eae12 at=7e2949..b9817e accounts=17,284,328 slots=120,026,861 storage=9.36GiB dangling=0 elapsed=22m34.615s\r\nApr 18 03:30:31 eth geth[13045]: INFO [04-18|03:30:31.921] Generating state snapshot                root=060676..0c5107 in=159e48..5eae12 at=7e56bc..e0dff4 accounts=17,284,328 slots=120,049,389 storage=9.37GiB dangling=0 elapsed=22m42.826s\r\nApr 18 03:30:38 eth geth[13045]: WARN [04-18|03:30:38.509] Peer delivering stale transactions       peer=3361a085d5af828a74982e15181b1ea4ae1888185b94a69b0b6d32bd6097c142 rejected=112\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1512387240/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
