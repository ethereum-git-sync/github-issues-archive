{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22175",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22175/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22175/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22175/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/22175",
  "id": 786257520,
  "node_id": "MDU6SXNzdWU3ODYyNTc1MjA=",
  "number": 22175,
  "title": "Tx fetching flaw",
  "user": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-01-14T19:31:17Z",
  "updated_at": "2021-01-18T13:21:42Z",
  "closed_at": "2021-01-18T13:21:41Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "There's something funky with tx fetching. I added a commit to print out when we fetch tx hashes. \r\n\r\nA node with lots of peers, `0.2` seconds: \r\n```\r\nDEBUG[01-14|14:48:22.770] Fetching batch of transactions           id=ff946fe09508bb01 conn=dyndial count=1\r\nDEBUG[01-14|14:48:22.804] Fetching batch of transactions           id=2ace140c6dda4c90 conn=dyndial count=1\r\nDEBUG[01-14|14:48:22.827] Fetching batch of transactions           id=e48de6b7395f03da conn=dyndial count=1\r\nDEBUG[01-14|14:48:22.827] Fetching batch of transactions           id=20915585dcf696e8 conn=dyndial count=1\r\nDEBUG[01-14|14:48:22.827] Fetching batch of transactions           id=9a71cb7fef388732 conn=dyndial count=1\r\nDEBUG[01-14|14:48:22.827] Fetching batch of transactions           id=160bb64e5d132330 conn=dyndial count=1\r\nDEBUG[01-14|14:48:22.827] Fetching batch of transactions           id=2be57288a4882b55 conn=dyndial count=1\r\nDEBUG[01-14|14:48:22.829] Fetching batch of transactions           id=c845e51a5e470e44 conn=dyndial count=1\r\nDEBUG[01-14|14:48:22.844] Fetching batch of transactions           id=e17b422a2e9d6d88 conn=dyndial count=1\r\nDEBUG[01-14|14:48:22.873] Fetching batch of transactions           id=ff946fe09508bb01 conn=dyndial count=2\r\nDEBUG[01-14|14:48:22.877] Fetching batch of transactions           id=30c56df0b352864a conn=dyndial count=1\r\nDEBUG[01-14|14:48:22.935] Fetching batch of transactions           id=9a71cb7fef388732 conn=dyndial count=1\r\nDEBUG[01-14|14:48:22.935] Fetching batch of transactions           id=358aeb1d72ab5814 conn=dyndial count=1\r\nDEBUG[01-14|14:48:22.935] Fetching batch of transactions           id=e17b422a2e9d6d88 conn=dyndial count=1\r\nDEBUG[01-14|14:48:22.946] Fetching batch of transactions           id=457a8cb8e0222bee conn=dyndial count=5\r\nDEBUG[01-14|14:48:22.967] Fetching batch of transactions           id=2ace140c6dda4c90 conn=dyndial count=1\r\nDEBUG[01-14|14:48:22.977] Fetching batch of transactions           id=e48de6b7395f03da conn=dyndial count=1\r\n```\r\n \r\n\r\nA node which connected to the network once it hits it's first peer: \r\n```\r\nINFO [01-14|20:28:16.345] Block synchronisation started                                                                                                       \r\nINFO [01-14|20:28:17.554] Downloader queue stats                   receiptTasks=0 blockTasks=0 itemSize=11.70KiB throttle=5600  \r\nINFO [01-14|20:28:18.272] Imported new chain segment               blocks=3 txs=613 mgas=37.505 elapsed=717.340ms mgasps=52.283 number=11655082 hash=\"7c518c…cb724b\" dirty=5.18MiB\r\nINFO [01-14|20:28:18.773] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=4 [0]=\"fe88ee…e06a8a\" \r\nINFO [01-14|20:28:18.908] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=4 [0]=\"4fe9c8…987a9c\" \r\nINFO [01-14|20:28:19.065] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=11 [0]=\"8945b8…75ebee\"\r\nINFO [01-14|20:28:19.207] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=3  [0]=\"9830a0…32c251\"\r\nINFO [01-14|20:28:19.476] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=8  [0]=\"cbcef2…3c359b\"\r\nINFO [01-14|20:28:19.612] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=7  [0]=\"0ee99e…496c24\"\r\nINFO [01-14|20:28:19.774] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=4  [0]=\"e1eb45…79a628\"\r\nINFO [01-14|20:28:19.920] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=2  [0]=\"35cf5c…1cacda\"\r\nINFO [01-14|20:28:20.061] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=2  [0]=\"331a8f…e24b20\"\r\nINFO [01-14|20:28:20.292] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=7  [0]=\"cd0907…fb442d\"                                                                                                                                                                                             \r\nINFO [01-14|20:28:20.466] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=6  [0]=\"40d996…903b6f\"\r\nINFO [01-14|20:28:20.631] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=3  [0]=\"6e5c1e…2121ad\"                                                                                                                                                                                             \r\nINFO [01-14|20:28:20.799] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=6  [0]=\"254a3c…20ba55\"\r\nINFO [01-14|20:28:21.082] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=2  [0]=\"d99335…99de18\"                                                                                                                                                                                             \r\nINFO [01-14|20:28:21.215] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=2  [0]=\"1a55e8…521aaf\"\r\nINFO [01-14|20:28:21.382] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=4  [0]=\"fa5149…b9c7be\"                                                                                                                                                                                             \r\nINFO [01-14|20:28:21.569] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=2  [0]=\"080572…2d674e\"\r\nINFO [01-14|20:28:21.699] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=2  [0]=\"d7693b…42340d\"\r\nINFO [01-14|20:28:21.831] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=4  [0]=\"b64302…991b2a\"\r\nINFO [01-14|20:28:21.960] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=3  [0]=\"3b2bde…4ccc07\"                                                                                                                                                                                             \r\nINFO [01-14|20:28:22.090] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=5  [0]=\"784c45…485968\"\r\nINFO [01-14|20:28:22.227] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=2  [0]=\"f4723e…18ac29\"\r\nINFO [01-14|20:28:22.365] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=1  [0]=\"eeb589…91247a\"\r\nINFO [01-14|20:28:22.582] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=5  [0]=\"cb5ce0…7f34cb\"\r\nINFO [01-14|20:28:22.824] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=2  [0]=\"ce628b…1471e6\"\r\nINFO [01-14|20:28:22.959] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=5  [0]=\"4f27bf…22da0c\"\r\nINFO [01-14|20:28:23.112] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=5  [0]=\"1ce26a…78d867\"\r\nINFO [01-14|20:28:23.244] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=1  [0]=\"4f2046…f17375\"\r\nINFO [01-14|20:28:23.389] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=2  [0]=\"ef6362…ba65be\"\r\nINFO [01-14|20:28:23.567] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=1  [0]=\"ff8771…913756\"\r\nINFO [01-14|20:28:23.701] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=3  [0]=\"50a68a…53d3fe\"\r\nINFO [01-14|20:28:23.841] Fetching batch of transactions           id=6222c234914c12b2 conn=dyndial count=5  [0]=\"0b44dc…bfd2ae\"\r\n\r\n```\r\nIt seems odd that we do so many tiny requests, instead of larger batches. ",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22175/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22175/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/762247312",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/22175#issuecomment-762247312",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/22175",
    "id": 762247312,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MjI0NzMxMg==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-18T13:21:41Z",
    "updated_at": "2021-01-18T13:21:41Z",
    "author_association": "MEMBER",
    "body": "Having looked into it a bit more, this is probably fine. I have opened a PR to lessen the amount of loggging a bit. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/762247312/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
