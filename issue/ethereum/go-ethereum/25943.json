{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25943",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25943/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25943/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25943/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/25943",
  "id": 1399780441,
  "node_id": "I_kwDOAOvK985TbvRZ",
  "number": 25943,
  "title": "prestateTracer meta issue",
  "user": {
    "login": "s1na",
    "id": 1591639,
    "node_id": "MDQ6VXNlcjE1OTE2Mzk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1591639?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/s1na",
    "html_url": "https://github.com/s1na",
    "followers_url": "https://api.github.com/users/s1na/followers",
    "following_url": "https://api.github.com/users/s1na/following{/other_user}",
    "gists_url": "https://api.github.com/users/s1na/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/s1na/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/s1na/subscriptions",
    "organizations_url": "https://api.github.com/users/s1na/orgs",
    "repos_url": "https://api.github.com/users/s1na/repos",
    "events_url": "https://api.github.com/users/s1na/events{/privacy}",
    "received_events_url": "https://api.github.com/users/s1na/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-10-06T14:43:46Z",
  "updated_at": "2022-11-01T13:25:45Z",
  "closed_at": "2022-11-01T13:25:45Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "This is a list of issues/modifications in the prestate tracer:\r\n\r\n1. When an account exists in the state and a contract is created during a tx at the same address, it won't be included in the prestate. You can find an example here https://github.com/ethereum/go-ethereum/pull/25422#discussion_r978789901. -> Fixed in #25996 \r\n2. The diff mode sometimes emits unnecessary storage slots in `pre`. This can be mistaken for those slots being deleted because they don't show up in `post`. E.g. in [](), the `pre` for contract `0x19363890e559d365e943604286e448a19ffead9c` is:\r\n```\r\nstorage: {\r\n    0x0000000000000000000000000000000000000000000000000000000000000000: \"0x000100004c004c0023fdeaa100000000000000000047105de7ebbbb1187f70a0\",\r\n    0x0000000000000000000000000000000000000000000000000000000000000001: \"0x000000000000000000000000000001b8ecc8d1cd98436308e11abd17dd2cdd06\",\r\n    0x0000000000000000000000000000000000000000000000000000000000000002: \"0x00000000000000000000000000000000011ee06ed189bbf02b5d4cea5573e5c1\",\r\n    0x0000000000000000000000000000000000000000000000000000000000000004: \"0x0000000000000000000000000000000000000000000000f6164b80d3cb5f8c7e\",\r\n    0x000000000000000000000000000000000000000000000000000000000000002b: \"0x01000035820000000000006da220b7bb63b76377b7fffd9853b4ad75633d97ff\",\r\n    0x000000000000000000000000000000000000000000000000000000000000002c: \"0x01000035820000000000006cd9f603a693fda6cd0bfffd9bc33786d9633beed7\",\r\n    0x7523e4cdba46ff05a9cda7a6fc38d74c48f4f45c08317f7f9eb3da0a7f54efa8: \"0x0000000000000099c875948725a87ac90000000000000099c875948725a87ac9\",\r\n    0x7523e4cdba46ff05a9cda7a6fc38d74c48f4f45c08317f7f9eb3da0a7f54efa9: \"0x000000000000000000000000000001a6d4272002c7c168dc9464437a196ba924\",\r\n    0x7523e4cdba46ff05a9cda7a6fc38d74c48f4f45c08317f7f9eb3da0a7f54efaa: \"0x00000000000000000000000000000000011d56aee547e55f4ee068a7b2e19a50\",\r\n    0x7523e4cdba46ff05a9cda7a6fc38d74c48f4f45c08317f7f9eb3da0a7f54efab: \"0x016329f12f000035820000000000006820e841b68633c6f1affffdc10a446875\",\r\n    0xc0d1c00078410fd0164580b0bad93d8a579580d06cf45fc2696a823498097b8a: \"0xa4b8218049081ac800220040800106183a000028042020000080000000000000\"\r\n}\r\n```\r\n\r\nWhere as only the following slots have been modified (see etherscan):\r\n\r\n```\r\n0x0000000000000000000000000000000000000000000000000000000000000000\r\n0x0000000000000000000000000000000000000000000000000000000000000001\r\n0x0000000000000000000000000000000000000000000000000000000000000004\r\n0x000000000000000000000000000000000000000000000000000000000000002c\r\n0x7523e4cdba46ff05a9cda7a6fc38d74c48f4f45c08317f7f9eb3da0a7f54efa9\r\n0x7523e4cdba46ff05a9cda7a6fc38d74c48f4f45c08317f7f9eb3da0a7f54efaa\r\n0x7523e4cdba46ff05a9cda7a6fc38d74c48f4f45c08317f7f9eb3da0a7f54efab\r\n```\r\n\r\n3. We should consider renaming the tracer to `stateTracer` since now it's not only for getting the prestate.\r\n4. Update docs to reflect new diff mode.\r\n",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25943/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25943/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1271166135",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25943#issuecomment-1271166135",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25943",
    "id": 1271166135,
    "node_id": "IC_kwDOAOvK985LxHS3",
    "user": {
      "login": "jsvisa",
      "id": 3627395,
      "node_id": "MDQ6VXNlcjM2MjczOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3627395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jsvisa",
      "html_url": "https://github.com/jsvisa",
      "followers_url": "https://api.github.com/users/jsvisa/followers",
      "following_url": "https://api.github.com/users/jsvisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/jsvisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jsvisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jsvisa/subscriptions",
      "organizations_url": "https://api.github.com/users/jsvisa/orgs",
      "repos_url": "https://api.github.com/users/jsvisa/repos",
      "events_url": "https://api.github.com/users/jsvisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jsvisa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-07T06:28:36Z",
    "updated_at": "2022-10-07T06:28:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "`stateTracer` lgtm.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1271166135/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1279931524",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25943#issuecomment-1279931524",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25943",
    "id": 1279931524,
    "node_id": "IC_kwDOAOvK985MSjSE",
    "user": {
      "login": "jsvisa",
      "id": 3627395,
      "node_id": "MDQ6VXNlcjM2MjczOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3627395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jsvisa",
      "html_url": "https://github.com/jsvisa",
      "followers_url": "https://api.github.com/users/jsvisa/followers",
      "following_url": "https://api.github.com/users/jsvisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/jsvisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jsvisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jsvisa/subscriptions",
      "organizations_url": "https://api.github.com/users/jsvisa/orgs",
      "repos_url": "https://api.github.com/users/jsvisa/repos",
      "events_url": "https://api.github.com/users/jsvisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jsvisa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-16T09:30:00Z",
    "updated_at": "2022-10-16T09:30:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "Some other cases.\r\n\r\n\r\n# Diff with etherscan\r\n\r\n##  we didn't record the accounts which were touched with zero value\r\n\r\nIMO, we need to capture those accounts.\r\n\r\n1.  via self-destruct's refund, eg: [0xfafdeabaa787f96bb3b869fadecc8e79b971405b](https://etherscan.io/address/0xfafdeabaa787f96bb3b869fadecc8e79b971405b#internaltx) in [tx 0x26a5b670a33d501aa4802833e8ba4c509bdfed925ffbe9ff31ce8039215dad3b](https://etherscan.io/tx/0x26a5b670a33d501aa4802833e8ba4c509bdfed925ffbe9ff31ce8039215dad3b)\r\n2. via transfer with zero value eg: [0x7459dd2239957c2bd816560750f040c866104da1](https://etherscan.io/address/0x7459dd2239957c2bd816560750f040c866104da1) in [tx 0x232d5ea005c5d197c2f9d18e7127d72936a008b0b3f1c04833c66095fe1f97c9](https://etherscan.io/tx/0x232d5ea005c5d197c2f9d18e7127d72936a008b0b3f1c04833c66095fe1f97c9)\r\n\r\n## deleted account's storage not captured in etherscan\r\n\r\nIMO, current our approach is correct, nothing needs to be fixed.\r\n\r\n- account [0x04237417b9ba4e022a41d2951ad87e7067f4366f] in \r\n [tx 0x5b387032727e1f5a5a59b49dac833043a77f8cc7be8f39bb36c16ee77c99a9e0](https://etherscan.io/tx/0x04237417b9ba4e022a41d2951ad87e7067f4366f) was destoryed, but etherscan not captured the result. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1279931524/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1279972050",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25943#issuecomment-1279972050",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25943",
    "id": 1279972050,
    "node_id": "IC_kwDOAOvK985MStLS",
    "user": {
      "login": "jsvisa",
      "id": 3627395,
      "node_id": "MDQ6VXNlcjM2MjczOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3627395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jsvisa",
      "html_url": "https://github.com/jsvisa",
      "followers_url": "https://api.github.com/users/jsvisa/followers",
      "following_url": "https://api.github.com/users/jsvisa/following{/other_user}",
      "gists_url": "https://api.github.com/users/jsvisa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jsvisa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jsvisa/subscriptions",
      "organizations_url": "https://api.github.com/users/jsvisa/orgs",
      "repos_url": "https://api.github.com/users/jsvisa/repos",
      "events_url": "https://api.github.com/users/jsvisa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jsvisa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-16T13:38:19Z",
    "updated_at": "2022-10-16T13:38:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "one more PR https://github.com/ethereum/go-ethereum/pull/25996",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1279972050/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
