{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23452",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23452/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23452/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23452/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/23452",
  "id": 978147169,
  "node_id": "MDU6SXNzdWU5NzgxNDcxNjk=",
  "number": 23452,
  "title": "gas oracle is broken on 1.10.8",
  "user": {
    "login": "geomad",
    "id": 7707517,
    "node_id": "MDQ6VXNlcjc3MDc1MTc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7707517?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/geomad",
    "html_url": "https://github.com/geomad",
    "followers_url": "https://api.github.com/users/geomad/followers",
    "following_url": "https://api.github.com/users/geomad/following{/other_user}",
    "gists_url": "https://api.github.com/users/geomad/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/geomad/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/geomad/subscriptions",
    "organizations_url": "https://api.github.com/users/geomad/orgs",
    "repos_url": "https://api.github.com/users/geomad/repos",
    "events_url": "https://api.github.com/users/geomad/events{/privacy}",
    "received_events_url": "https://api.github.com/users/geomad/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    },
    {
      "id": 717742232,
      "node_id": "MDU6TGFiZWw3MTc3NDIyMzI=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/help%20wanted",
      "name": "help wanted",
      "color": "0e8a16",
      "default": true,
      "description": null
    },
    {
      "id": 717743019,
      "node_id": "MDU6TGFiZWw3MTc3NDMwMTk=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/good%20first%20issue",
      "name": "good first issue",
      "color": "006b75",
      "default": true,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-08-24T14:13:25Z",
  "updated_at": "2021-11-18T18:20:37Z",
  "closed_at": "2021-11-18T18:20:37Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: 1.10.8-stable\r\nOS & Version: Linux\r\n\r\nThis issue started after updating to 1.10.8-stable. Gas oracle doesn't return the expected results when parameters are different than the defaults (both setting IgnorePrice or/and MaxPrice will break it). Works as expected without the .toml setting below\r\n\r\n.toml settings:\r\n````\r\n[Eth.GPO]\r\nIgnorePrice = 2000000000\r\n````\r\neth_feeHistory arguments provided with the call:\r\n````\r\n(\"0x1\", \"latest\", null)\r\n````\r\n\r\n#### Expected behaviour\r\n\r\neth_feeHistory returns the expected values\r\n\r\n#### Actual behaviour\r\n\r\neth_feeHistory returns\r\n````\r\n{ oldestBlock: '0x0', gasUsedRatio: null }\r\n````\r\n\r\non geth console I read this log:\r\n````\r\nWARN  Sanitizing fee history length            requested=1 truncated=0\r\n````\r\n",
  "closed_by": {
    "login": "fjl",
    "id": 6915,
    "node_id": "MDQ6VXNlcjY5MTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fjl",
    "html_url": "https://github.com/fjl",
    "followers_url": "https://api.github.com/users/fjl/followers",
    "following_url": "https://api.github.com/users/fjl/following{/other_user}",
    "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
    "organizations_url": "https://api.github.com/users/fjl/orgs",
    "repos_url": "https://api.github.com/users/fjl/repos",
    "events_url": "https://api.github.com/users/fjl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fjl/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23452/reactions",
    "total_count": 4,
    "+1": 4,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23452/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/904684101",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23452#issuecomment-904684101",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23452",
    "id": 904684101,
    "node_id": "IC_kwDOAOvK98417GJF",
    "user": {
      "login": "MrLouzao",
      "id": 10439162,
      "node_id": "MDQ6VXNlcjEwNDM5MTYy",
      "avatar_url": "https://avatars.githubusercontent.com/u/10439162?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MrLouzao",
      "html_url": "https://github.com/MrLouzao",
      "followers_url": "https://api.github.com/users/MrLouzao/followers",
      "following_url": "https://api.github.com/users/MrLouzao/following{/other_user}",
      "gists_url": "https://api.github.com/users/MrLouzao/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MrLouzao/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MrLouzao/subscriptions",
      "organizations_url": "https://api.github.com/users/MrLouzao/orgs",
      "repos_url": "https://api.github.com/users/MrLouzao/repos",
      "events_url": "https://api.github.com/users/MrLouzao/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MrLouzao/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-24T14:17:46Z",
    "updated_at": "2021-08-24T14:17:46Z",
    "author_association": "NONE",
    "body": "Same here. We are suffering the same problem with same version and OS. We are building our own images to run the code base. If we revert to 1.10.7 is working again, this only happens on 1.10.8.\r\n\r\nOur image: `Geth/v1.10.8-stable-26675454/linux-amd64/go1.16.5`\r\n\r\nHowever, Infura service is working with that new version, returning data as usual.\r\n\r\n\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/904684101/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/904739885",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23452#issuecomment-904739885",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23452",
    "id": 904739885,
    "node_id": "IC_kwDOAOvK98417Twt",
    "user": {
      "login": "vogelito",
      "id": 1325863,
      "node_id": "MDQ6VXNlcjEzMjU4NjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1325863?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vogelito",
      "html_url": "https://github.com/vogelito",
      "followers_url": "https://api.github.com/users/vogelito/followers",
      "following_url": "https://api.github.com/users/vogelito/following{/other_user}",
      "gists_url": "https://api.github.com/users/vogelito/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vogelito/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vogelito/subscriptions",
      "organizations_url": "https://api.github.com/users/vogelito/orgs",
      "repos_url": "https://api.github.com/users/vogelito/repos",
      "events_url": "https://api.github.com/users/vogelito/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vogelito/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-24T15:23:22Z",
    "updated_at": "2021-08-24T15:23:22Z",
    "author_association": "NONE",
    "body": "Infura runs their own version of go-ethereum called Omnibus according to their [blog](https://blog.infura.io/infura-mainnet-outage-post-mortem-2020-11-11/):\r\n\r\n> We run a custom patched version of Geth we internally call “Omnibus” which includes several performance, stability, and monitoring enhancements tailored to our cloud native architecture",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/904739885/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/904785682",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23452#issuecomment-904785682",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23452",
    "id": 904785682,
    "node_id": "IC_kwDOAOvK98417e8S",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-24T16:19:06Z",
    "updated_at": "2021-08-24T16:19:06Z",
    "author_association": "MEMBER",
    "body": "I tested this like so: \r\n```\r\ngeth --dev --dev.period  5 --gpo.ignoreprice=2000000000\r\n```\r\nAnd in another console: \r\n```\r\n> eth.feeHistory(\"0x1\", \"latest\", null)\r\n{\r\n  baseFeePerGas: [\"0x2da282a8\", \"0x27ee3253\"],\r\n  gasUsedRatio: [0],\r\n  oldestBlock: \"0x2\"\r\n}\r\n> eth.feeHistory(\"0x1\", \"latest\", null)\r\n{\r\n  baseFeePerGas: [\"0x2da282a8\", \"0x27ee3253\"],\r\n  gasUsedRatio: [0],\r\n  oldestBlock: \"0x2\"\r\n}\r\n```\r\n\r\nSo, as far as reproducing it, I've failed so far... ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/904785682/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/904796942",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/23452#issuecomment-904796942",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/23452",
    "id": 904796942,
    "node_id": "IC_kwDOAOvK98417hsO",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-24T16:34:03Z",
    "updated_at": "2021-08-24T16:34:03Z",
    "author_association": "MEMBER",
    "body": "Yeah, I think I know what the cause is. Your toml config is omitting some values, causing them to be left at zero. \r\n```\r\n[Eth.GPO]\r\nBlocks = 20\r\nPercentile = 60\r\nMaxHeaderHistory = 1024\r\nMaxBlockHistory = 1024\r\nMaxPrice = 500000000000\r\nIgnorePrice = 2\r\n```\r\nTry adding these default-values -- modify the ones you want, but leave the others. In this particular case, I think it's the `MaxHeaderHistory` which becomes `0` when omitted. That should work as a work-around, but yeah, it should also be fixed on our end.  ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/904796942/reactions",
      "total_count": 3,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 3,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
