{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21190",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21190/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21190/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21190/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/21190",
  "id": 634411090,
  "node_id": "MDU6SXNzdWU2MzQ0MTEwOTA=",
  "number": 21190,
  "title": "Geth skipping-empty-blocks preload-option of js file doesnt work and also option to set gas target and gas limit  missing in api",
  "user": {
    "login": "cyrilnavessamuel",
    "id": 8938494,
    "node_id": "MDQ6VXNlcjg5Mzg0OTQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8938494?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cyrilnavessamuel",
    "html_url": "https://github.com/cyrilnavessamuel",
    "followers_url": "https://api.github.com/users/cyrilnavessamuel/followers",
    "following_url": "https://api.github.com/users/cyrilnavessamuel/following{/other_user}",
    "gists_url": "https://api.github.com/users/cyrilnavessamuel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cyrilnavessamuel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cyrilnavessamuel/subscriptions",
    "organizations_url": "https://api.github.com/users/cyrilnavessamuel/orgs",
    "repos_url": "https://api.github.com/users/cyrilnavessamuel/repos",
    "events_url": "https://api.github.com/users/cyrilnavessamuel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cyrilnavessamuel/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "fjl",
    "id": 6915,
    "node_id": "MDQ6VXNlcjY5MTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fjl",
    "html_url": "https://github.com/fjl",
    "followers_url": "https://api.github.com/users/fjl/followers",
    "following_url": "https://api.github.com/users/fjl/following{/other_user}",
    "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
    "organizations_url": "https://api.github.com/users/fjl/orgs",
    "repos_url": "https://api.github.com/users/fjl/repos",
    "events_url": "https://api.github.com/users/fjl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fjl/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2020-06-08T09:08:42Z",
  "updated_at": "2022-07-04T13:06:09Z",
  "closed_at": "2022-07-04T13:06:09Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi there,\r\n\r\nI am not posting this as a bug since I need some information which I unable to get help from stack exchange: https://ethereum.stackexchange.com/questions/83931/ethereum-skipping-empty-blocks-preload-option-doesnt-work \r\n\r\n\r\n#### System information\r\n\r\nGeth version: 1.9.12\r\nOS & Version: Linux\r\nClique PoA\r\nProcessor: Intel i7 - 3770\r\nCPU: 8\r\nRAM : 16 GB\r\n\r\n#### Expected behaviour\r\n\r\nIn my clique PoA private network setup I try to mine skipping empty blocks and mine only when there is transaction present. I try to follow : How to make miner to mine only when there are Pending Transactions? but I cannot notice that the mining works when I load the script with -- preload followed by .js file.\r\n\r\nInstead on starting the node, I open the ipc console and then use loadScript which works fine.\r\n\r\n1) Is there a better way to load the js script while starting the node?\r\n\r\n2) Also is there a way to specify inside the js script the **miner gas target** and **miner gas limit** since I need to set up a uniform block gas limit in the network. I noticed that this option is missing in RPC API definitions which could be the reason ?\r\n\r\n#### Actual behaviour\r\n--preload option with js file while starting a client doesnt work but instead loadScript works\r\n\r\nOption to set **miner gas target** and **miner gas limit**  withing the javascript file is not possible since there is no api method to set this\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\n1) Start the geth client without mining option enabled\r\n2) Then get the script https://ethereum.stackexchange.com/questions/3151/how-to-make-miner-to-mine-only-when-there-are-pending-transactions/3152#3152 and save it as .js file\r\n3) The while starting the geth client try to load the script with --preload javascriptfile.js\r\n4) Mining does not start even when there are pending transactions\r\n5) Instead open the ipc console and use loadScript passing javascript file which loads the script successfully\r\n6) Mining starts and stops properly as in script\r\n\r\n",
  "closed_by": {
    "login": "s1na",
    "id": 1591639,
    "node_id": "MDQ6VXNlcjE1OTE2Mzk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1591639?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/s1na",
    "html_url": "https://github.com/s1na",
    "followers_url": "https://api.github.com/users/s1na/followers",
    "following_url": "https://api.github.com/users/s1na/following{/other_user}",
    "gists_url": "https://api.github.com/users/s1na/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/s1na/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/s1na/subscriptions",
    "organizations_url": "https://api.github.com/users/s1na/orgs",
    "repos_url": "https://api.github.com/users/s1na/repos",
    "events_url": "https://api.github.com/users/s1na/events{/privacy}",
    "received_events_url": "https://api.github.com/users/s1na/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21190/reactions",
    "total_count": 3,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 3,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21190/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/652867554",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21190#issuecomment-652867554",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21190",
    "id": 652867554,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1Mjg2NzU1NA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-02T08:30:16Z",
    "updated_at": "2020-07-02T08:30:16Z",
    "author_association": "MEMBER",
    "body": "I agree about these semantics: `--preload` _should_ work the same was as starting with `console` and then loading the script. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/652867554/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1173692508",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21190#issuecomment-1173692508",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21190",
    "id": 1173692508,
    "node_id": "IC_kwDOAOvK985F9SBc",
    "user": {
      "login": "s1na",
      "id": 1591639,
      "node_id": "MDQ6VXNlcjE1OTE2Mzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1591639?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/s1na",
      "html_url": "https://github.com/s1na",
      "followers_url": "https://api.github.com/users/s1na/followers",
      "following_url": "https://api.github.com/users/s1na/following{/other_user}",
      "gists_url": "https://api.github.com/users/s1na/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/s1na/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/s1na/subscriptions",
      "organizations_url": "https://api.github.com/users/s1na/orgs",
      "repos_url": "https://api.github.com/users/s1na/repos",
      "events_url": "https://api.github.com/users/s1na/events{/privacy}",
      "received_events_url": "https://api.github.com/users/s1na/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-04T11:13:27Z",
    "updated_at": "2022-07-04T13:06:06Z",
    "author_association": "MEMBER",
    "body": "I just tried this on v1.10.19 and it's working. I have a node running clique with mining disabled. Then I attach to it and pass `--preload mine.js`. Sending txes results in mining getting activated:\r\n\r\n```console\r\n❯ ./build/bin/geth --datadir clique-data --preload mine.js attach\r\n== No transactions! Mining stopped.\r\nWelcome to the Geth JavaScript console!\r\n\r\ninstance: Geth/v1.10.19-stable-23bee162/darwin-amd64/go1.18\r\ncoinbase: 0xa724065f3e3168fbf96d97c2d008bb91251feb38\r\nat block: 0 (Thu Jan 01 1970 01:00:00 GMT+0100 (CET))\r\n datadir: /go-ethereum/clique-data\r\n modules: admin:1.0 clique:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0\r\n\r\nTo exit, press ctrl-d or type exit\r\n> personal.unlockAccount(eth.accounts[0], '', 0)\r\ntrue\r\n> eth.sendTransaction({ from: eth.accounts[0], to: eth.accounts[0], value: 1 })\r\n\"0xd89c038a7efaee046b7b50abf2c7846cd7d8665e28e612d8aceace1c4a016f23\"\r\n> == Pending transactions! Mining...\r\n== No transactions! Mining stopped.\r\n\r\n> == No transactions! Mining stopped.\r\n```\r\n\r\nClosing this now. Please re-open if the issue persists.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1173692508/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
