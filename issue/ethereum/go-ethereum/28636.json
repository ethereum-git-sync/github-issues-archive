{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28636",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28636/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28636/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28636/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/28636",
  "id": 2022683847,
  "node_id": "I_kwDOAOvK9854j7TH",
  "number": 28636,
  "title": "Crash (`unknown caller pc`) during full-sync",
  "user": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-12-03T19:37:02Z",
  "updated_at": "2023-12-05T11:23:11Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "This was `bench06`, running `master` on `Geth/v1.13.5-unstable-58297e33/linux-amd64/go1.21.4`, i.e. commit 58297e33. \r\n\r\n```\r\nINFO [12-01|14:15:18.864] Imported new chain segment               number=9,346,424  hash=f24505..81ce39 blocks=160  txs=10653   mgas=1209.805 elapsed=8.035s        mgasps=150.549 age=3y10mo3w  snapdiffs=2.43MiB    triedirty=1018.01MiB\r\nruntime: g 293973197: unexpected return pc for bytes.Compare called from 0xc11265bb80\r\nstack: frame={sp:0xc12eb567e0, fp:0xc12eb567e8} stack=[0xc12eb3c000,0xc12eb5c000)\r\n0x000000c12eb566e0:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb566f0:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56700:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56710:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56720:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56730:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56740:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56750:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56760:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56770:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56780:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56790:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb567a0:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb567b0:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb567c0:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb567d0:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb567e0: <0x000000c11265bb80 >0x0000000000000001 \r\n0x000000c12eb567f0:  0x0000000000000041  0x0000000000000011 \r\n0x000000c12eb56800:  0x00007fb0048b7d67  0x000000c11265bba0 \r\n0x000000c12eb56810:  0x0000000000000004  0x0000000000000024 \r\n0x000000c12eb56820:  0x000000c09939a8d0  0x0000000000b2b405 <github.com/cockroachdb/pebble/sstable.(*singleLevelIterator).seekGEHelper+0x0000000000000365> \r\n0x000000c12eb56830:  0x000000c03e797118  0x000000c11265bb80 \r\n0x000000c12eb56840:  0x0000000000000041  0x0000000000000041 \r\n0x000000c12eb56850:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56860:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56870:  0x0000000001c68358  0x0000000000000000 \r\n0x000000c12eb56880:  0x00007fb0048b75e0  0x000000c09939a940 \r\n0x000000c12eb56890:  0x0000000000b2dd8f <github.com/cockroachdb/pebble/sstable.(*twoLevelIterator).loadIndex+0x00000000000002af>  0x000000c03e797118 \r\n0x000000c12eb568a0:  0x000000c0f8fe7500  0x00007fb0048b75e0 \r\n0x000000c12eb568b0:  0x0000000000000000  0x0000000000514c5d <bytes.Compare+0x000000000000001d> \r\n0x000000c12eb568c0:  0x000000000000002c  0x0000000000000000 \r\n0x000000c12eb568d0:  0x000000c09939a940  0x0000000000b2bbdd <github.com/cockroachdb/pebble/sstable.(*singleLevelIterator).seekPrefixGE+0x000000000000033d> \r\n0x000000c12eb568e0:  0x000000c03e797080 \r\nfatal error: unknown caller pc\r\nruntime stack:\r\nruntime.throw({0x18e75c3?, 0x0?})\r\n\truntime/panic.go:1077 +0x5c fp=0x7faff3669520 sp=0x7faff36694f0 pc=0x43c8dc\r\nruntime.(*unwinder).next(0x7faff3669720)\r\n\truntime/traceback.go:475 +0x249 fp=0x7faff3669598 sp=0x7faff3669520 pc=0x463329\r\nruntime.copystack(0xc000a7bba0, 0x800000002?)\r\n\truntime/stack.go:934 +0x2d2 fp=0x7faff3669890 sp=0x7faff3669598 pc=0x456a92\r\nruntime.newstack()\r\n\truntime/stack.go:1116 +0x47f fp=0x7faff3669a40 sp=0x7faff3669890 pc=0x45703f\r\ntraceback: unexpected SPWRITE function runtime.morestack\r\nruntime.morestack()\r\n\truntime/asm_amd64.s:593 +0x8f fp=0x7faff3669a48 sp=0x7faff3669a40 pc=0x47100f\r\ngoroutine 293973197 [copystack]:\r\nbytes.Compare({0x1?, 0x41?, 0x11?}, {0x7fb0048b7d67?, 0xc11265bba0?, 0x4?})\r\n\tbytes/bytes.go:26 +0x46 fp=0xc12eb567e8 sp=0xc12eb567e0 pc=0x514c86\r\nruntime: g 293973197: unexpected return pc for bytes.Compare called from 0xc11265bb80\r\nstack: frame={sp:0xc12eb567e0, fp:0xc12eb567e8} stack=[0xc12eb3c000,0xc12eb5c000)\r\n0x000000c12eb566e0:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb566f0:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56700:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56710:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56720:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56730:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56740:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56750:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56760:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56770:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56780:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56790:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb567a0:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb567b0:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb567c0:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb567d0:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb567e0: <0x000000c11265bb80 >0x0000000000000001 \r\n0x000000c12eb567f0:  0x0000000000000041  0x0000000000000011 \r\n0x000000c12eb56800:  0x00007fb0048b7d67  0x000000c11265bba0 \r\n0x000000c12eb56810:  0x0000000000000004  0x0000000000000024 \r\n0x000000c12eb56820:  0x000000c09939a8d0  0x0000000000b2b405 <github.com/cockroachdb/pebble/sstable.(*singleLevelIterator).seekGEHelper+0x0000000000000365> \r\n0x000000c12eb56830:  0x000000c03e797118  0x000000c11265bb80 \r\n0x000000c12eb56840:  0x0000000000000041  0x0000000000000041 \r\n0x000000c12eb56850:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56860:  0x0000000000000000  0x0000000000000000 \r\n0x000000c12eb56870:  0x0000000001c68358  0x0000000000000000 \r\n0x000000c12eb56880:  0x00007fb0048b75e0  0x000000c09939a940 \r\n0x000000c12eb56890:  0x0000000000b2dd8f <github.com/cockroachdb/pebble/sstable.(*twoLevelIterator).loadIndex+0x00000000000002af>  0x000000c03e797118 \r\n0x000000c12eb568a0:  0x000000c0f8fe7500  0x00007fb0048b75e0 \r\n0x000000c12eb568b0:  0x0000000000000000  0x0000000000514c5d <bytes.Compare+0x000000000000001d> \r\n0x000000c12eb568c0:  0x000000000000002c  0x0000000000000000 \r\n0x000000c12eb568d0:  0x000000c09939a940  0x0000000000b2bbdd <github.com/cockroachdb/pebble/sstable.(*singleLevelIterator).seekPrefixGE+0x000000000000033d> \r\n0x000000c12eb568e0:  0x000000c03e797080 \r\ncreated by github.com/ethereum/go-ethereum/eth/downloader.(*Downloader).spawnSync in goroutine 293973192\r\n\tgithub.com/ethereum/go-ethereum/eth/downloader/downloader.go:654 +0x7b\r\ngoroutine 1 [chan receive, 4626 minutes]:\r\nruntime.gopark(0xc000620f40?, 0x18d675f?, 0x4?, 0x0?, 0x18992a0?)\r\n\truntime/proc.go:398 +0xce fp=0xc000737ac0 sp=0xc000737aa0 pc=0x43f7ce\r\nruntime.chanrecv(0xc000156420, 0x0, 0x1)\r\n\truntime/chan.go:583 +0x3cd fp=0xc000737b38 sp=0xc000737ac0 pc=0x40ad0d\r\nruntime.chanrecv1(0xc000787bc8?, 0xc000228b60?)\r\n\truntime/chan.go:442 +0x12 fp=0xc000737b60 sp=0xc000737b38 pc=0x40a912\r\ngithub.com/ethereum/go-ethereum/node.(*Node).Wait(...)\r\n\tgithub.com/ethereum/go-ethereum/node/node.go:555\r\nmain.geth(0xc00061a000)\r\n\tgithub.com/ethereum/go-ethereum/cmd/geth/main.go:341 +0x13c fp=0xc000737bf8 sp=0xc000737b60 pc=0x14281bc\r\ngithub.com/urfave/cli/v2.(*Command).Run(0xc00022a160, 0xc00061a000, {0xc0001c0000, 0x17, 0x18})\r\n\tgithub.com/urfave/cli/v2@v2.25.7/command.go:274 +0x998 fp=0xc000737e88 sp=0xc000737bf8 pc=0xf086f8\r\ngithub.com/urfave/cli/v2.(*App).RunContext(0xc0006f65a0, {0x1e40e58?, 0x2b70820}, {0xc0001c0000, 0x17, 0x18})\r\n\tgithub.com/urfave/cli/v2@v2.25.7/app.go:332 +0x5b7 fp=0xc000737ef0 sp=0xc000737e88 pc=0xf04ef7\r\ngithub.com/urfave/cli/v2.(*App).Run(...)\r\n\tgithub.com/urfave/cli/v2@v2.25.7/app.go:309\r\nmain.main()\r\n\tgithub.com/ethereum/go-ethereum/cmd/geth/main.go:267 +0x45 fp=0xc000737f40 sp=0xc000737ef0 pc=0x1427c65\r\nruntime.main()\r\n\truntime/proc.go:267 +0x2bb fp=0xc000737fe0 sp=0xc000737f40 pc=0x43f35b\r\nruntime.goexit()\r\n\truntime/asm_amd64.s:1650 +0x1 fp=0xc000737fe8 sp=0xc000737fe0 pc=0x472ea1\r\ngoroutine 2 [force gc (idle), 4626 minutes]:\r\nruntime.gopark(0x0?, 0x0?, 0x0?, 0x0?, 0x0?)\r\n\truntime/proc.go:398 +0xce fp=0xc00007afa8 sp=0xc00007af88 pc=0x43f7ce\r\nruntime.goparkunlock(...)\r\n\truntime/proc.go:404\r\nruntime.forcegchelper()\r\n\truntime/proc.go:322 +0xb3 fp=0xc00007afe0 sp=0xc00007afa8 pc=0x43f633\r\nruntime.goexit()\r\n\truntime/asm_amd64.s:1650 +0x1 fp=0xc00007afe8 sp=0xc00007afe0 pc=0x472ea1\r\ncreated by runtime.init.6 in goroutine 1\r\n\truntime/proc.go:310 +0x1a\r\ngoroutine 18 [GC sweep wait]:\r\nruntime.gopark(0x2b37b01?, 0x0?, 0x0?, 0x0?, 0x0?)\r\n\truntime/proc.go:398 +0xce fp=0xc000076778 sp=0xc000076758 pc=0x43f7ce\r\nruntime.goparkunlock(...)\r\n\truntime/proc.go:404\r\nruntime.bgsweep(0x0?)\r\n\truntime/mgcsweep.go:321 +0xdf fp=0xc0000767c8 sp=0xc000076778 pc=0x4295ff\r\nruntime.gcenable.func1()\r\n\truntime/mgc.go:200 +0x25 fp=0xc0000767e0 sp=0xc0000767c8 pc=0x41e6e5\r\nruntime.goexit()\r\n\truntime/asm_amd64.s:1650 +0x1 fp=0xc0000767e8 sp=0xc0000767e0 pc=0x472ea1\r\ncreated by runtime.gcenable in goroutine 1\r\n\truntime/mgc.go:200 +0x66\r\n\r\n```\r\n\r\nFuller dump:\r\n[stackdump.txt](https://github.com/ethereum/go-ethereum/files/13539993/stackdump.txt)\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28636/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28636/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1837579034",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/28636#issuecomment-1837579034",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28636",
    "id": 1837579034,
    "node_id": "IC_kwDOAOvK985thzsa",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-12-03T19:38:21Z",
    "updated_at": "2023-12-03T19:38:21Z",
    "author_association": "MEMBER",
    "body": "Possibly related: https://github.com/cockroachdb/pebble/issues/2507",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1837579034/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1840555219",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/28636#issuecomment-1840555219",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/28636",
    "id": 1840555219,
    "node_id": "IC_kwDOAOvK985ttKTT",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-12-05T11:23:09Z",
    "updated_at": "2023-12-05T11:23:09Z",
    "author_association": "MEMBER",
    "body": "I tried to dig into it a bit. Looks like something smashed our stack, the only real possibility (other than the runtime) that I see when stepping through the code is the compression. We're using the default compression algorithm snappy which is implemented in ASM, maybe theres an issue there? ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1840555219/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
