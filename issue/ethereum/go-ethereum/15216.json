{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15216",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15216/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15216/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15216/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/15216",
  "id": 261389336,
  "node_id": "MDU6SXNzdWUyNjEzODkzMzY=",
  "number": 15216,
  "title": "swarm: fuse tests break on linux with go1.9",
  "user": {
    "login": "holisticode",
    "id": 88287,
    "node_id": "MDQ6VXNlcjg4Mjg3",
    "avatar_url": "https://avatars.githubusercontent.com/u/88287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holisticode",
    "html_url": "https://github.com/holisticode",
    "followers_url": "https://api.github.com/users/holisticode/followers",
    "following_url": "https://api.github.com/users/holisticode/following{/other_user}",
    "gists_url": "https://api.github.com/users/holisticode/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holisticode/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holisticode/subscriptions",
    "organizations_url": "https://api.github.com/users/holisticode/orgs",
    "repos_url": "https://api.github.com/users/holisticode/repos",
    "events_url": "https://api.github.com/users/holisticode/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holisticode/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2017-09-28T16:52:39Z",
  "updated_at": "2017-10-10T07:29:37Z",
  "closed_at": "2017-10-09T10:45:31Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: `1.6.6-unstable` (unrelated)\r\nOS & Version: Linux\r\nCommit hash : (if `develop`)\r\n\r\n#### Expected behaviour\r\nAll tests complete successfully (confirmed to be the case for go 1.8.3 or other go versions)\r\n\r\n\r\n#### Actual behaviour\r\ntests in `swarm/fuse` package fail.\r\nFor every PR for swarm, tests with go1.9 on linux fail, due to the tests hanging and not completing.\r\nFor example, see https://travis-ci.org/ethereum/go-ethereum/jobs/280621055\r\n\r\n#### Steps to reproduce the behaviour\r\n* Use go1.9 (install if needed first)\r\n* Run `swarm/fuse`package tests: `go test -v github.com/ethereum/go-ethereum/swarm/fuse`\r\n\r\n#### Backtrace\r\n\r\n````\r\n$ go test -v github.com/ethereum/go-ethereum/swarm/fuse\r\n=== RUN   TestFUSE\r\n=== RUN   TestFUSE/mountListAndUmount\r\n=== RUN   TestFUSE/maxMounts\r\n=== RUN   TestFUSE/remount\r\n=== RUN   TestFUSE/unmount\r\n=== RUN   TestFUSE/unmountWhenResourceBusy\r\n=== RUN   TestFUSE/seekInMultiChunkFile\r\n=== RUN   TestFUSE/createNewFile\r\n=== RUN   TestFUSE/createNewFileInsideDirectory\r\n=== RUN   TestFUSE/createNewFileInsideNewDirectory\r\n=== RUN   TestFUSE/removeExistingFile\r\n=== RUN   TestFUSE/removeExistingFileInsideDir\r\n=== RUN   TestFUSE/removeNewlyAddedFile\r\n=== RUN   TestFUSE/addNewFileAndModifyContents\r\npanic: runtime error: slice bounds out of range [recovered]\r\n\tpanic: runtime error: slice bounds out of range\r\n\r\ngoroutine 1548 [running]:\r\ntesting.tRunner.func1(0xc42014c000)\r\n\t/usr/lib/go/src/testing/testing.go:711 +0x2d2\r\npanic(0x90fd80, 0xed4160)\r\n\t/usr/lib/go/src/runtime/panic.go:491 +0x283\r\ninternal/poll.(*FD).Write(0xc42092edc0, 0xc420016a50, 0x6, 0x8, 0x0, 0x0, 0x0)\r\n\t/usr/lib/go/src/internal/poll/fd_unix.go:218 +0x380\r\nos.(*File).write(0xc420750130, 0xc420016a50, 0x6, 0x8, 0xc420750130, 0x6, 0x0)\r\n\t/usr/lib/go/src/os/file_unix.go:233 +0x4e\r\nos.(*File).Write(0xc420750130, 0xc420016a50, 0x6, 0x8, 0x0, 0x0, 0x0)\r\n\t/usr/lib/go/src/os/file.go:140 +0x72\r\ngithub.com/ethereum/go-ethereum/swarm/fuse.(*testAPI).addNewFileAndModifyContents(0xc42000e2f0, 0xc42014c000)\r\n\t/home/fabio/go/src/github.com/ethereum/go-ethereum/swarm/fuse/swarmfs_test.go:660 +0xcfd\r\ngithub.com/ethereum/go-ethereum/swarm/fuse.(*testAPI).(github.com/ethereum/go-ethereum/swarm/fuse.addNewFileAndModifyContents)-fm(0xc42014c000)\r\n\t/home/fabio/go/src/github.com/ethereum/go-ethereum/swarm/fuse/swarmfs_test.go:833 +0x34\r\ntesting.tRunner(0xc42014c000, 0xc420b66220)\r\n\t/usr/lib/go/src/testing/testing.go:746 +0xd0\r\ncreated by testing.(*T).Run\r\n\t/usr/lib/go/src/testing/testing.go:789 +0x2de\r\n\r\n````\r\n",
  "closed_by": {
    "login": "fjl",
    "id": 6915,
    "node_id": "MDQ6VXNlcjY5MTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fjl",
    "html_url": "https://github.com/fjl",
    "followers_url": "https://api.github.com/users/fjl/followers",
    "following_url": "https://api.github.com/users/fjl/following{/other_user}",
    "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
    "organizations_url": "https://api.github.com/users/fjl/orgs",
    "repos_url": "https://api.github.com/users/fjl/repos",
    "events_url": "https://api.github.com/users/fjl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fjl/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15216/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15216/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/333072253",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/15216#issuecomment-333072253",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15216",
    "id": 333072253,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMzA3MjI1Mw==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-29T09:01:02Z",
    "updated_at": "2017-09-29T09:01:02Z",
    "author_association": "MEMBER",
    "body": "Yeah, I've also pinged @zelig a few days ago. Could someone see it it's a bug in our code or if we should report it upstream? I'm away from my laptop for the weekend.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/333072253/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/333502036",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/15216#issuecomment-333502036",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15216",
    "id": 333502036,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMzUwMjAzNg==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-02T10:55:09Z",
    "updated_at": "2017-10-02T10:55:09Z",
    "author_association": "MEMBER",
    "body": "I've reported this issue upstream. Seems to be an issue in Go itself, not Ethereum, though it may be an interplay of multiple factors, including us using some API in a bad way. Nonetheless, a library method should most definitely not panic, irrelevant of the circumstances.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/333502036/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/335012875",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/15216#issuecomment-335012875",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15216",
    "id": 335012875,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNTAxMjg3NQ==",
    "user": {
      "login": "dherbst",
      "id": 136589,
      "node_id": "MDQ6VXNlcjEzNjU4OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/136589?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dherbst",
      "html_url": "https://github.com/dherbst",
      "followers_url": "https://api.github.com/users/dherbst/followers",
      "following_url": "https://api.github.com/users/dherbst/following{/other_user}",
      "gists_url": "https://api.github.com/users/dherbst/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dherbst/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dherbst/subscriptions",
      "organizations_url": "https://api.github.com/users/dherbst/orgs",
      "repos_url": "https://api.github.com/users/dherbst/repos",
      "events_url": "https://api.github.com/users/dherbst/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dherbst/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-08T15:07:25Z",
    "updated_at": "2017-10-08T15:07:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "@karalabe I think the issue is the WriteResponse.Size is being set to the entire file size instead of the size of just the data that was written.  I think my PR #15261 fixes this, but I see the eth/downloader test failed on Travis.  I can't reproduce the travis failure, so maybe run the tests again on travis?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/335012875/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/335385794",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/15216#issuecomment-335385794",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/15216",
    "id": 335385794,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNTM4NTc5NA==",
    "user": {
      "login": "jmozah",
      "id": 940575,
      "node_id": "MDQ6VXNlcjk0MDU3NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/940575?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmozah",
      "html_url": "https://github.com/jmozah",
      "followers_url": "https://api.github.com/users/jmozah/followers",
      "following_url": "https://api.github.com/users/jmozah/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmozah/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmozah/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmozah/subscriptions",
      "organizations_url": "https://api.github.com/users/jmozah/orgs",
      "repos_url": "https://api.github.com/users/jmozah/repos",
      "events_url": "https://api.github.com/users/jmozah/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmozah/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-10T07:29:37Z",
    "updated_at": "2017-10-10T07:29:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "@dherbst Thanks for the catch",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/335385794/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
