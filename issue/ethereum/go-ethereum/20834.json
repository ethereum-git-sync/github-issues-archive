{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20834",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20834/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20834/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20834/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/20834",
  "id": 589857528,
  "node_id": "MDU6SXNzdWU1ODk4NTc1Mjg=",
  "number": 20834,
  "title": "Clique : clique.getSigners(eth.blockNumber) returns different than clique.getSigners()",
  "user": {
    "login": "isaacagudo",
    "id": 7515697,
    "node_id": "MDQ6VXNlcjc1MTU2OTc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7515697?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/isaacagudo",
    "html_url": "https://github.com/isaacagudo",
    "followers_url": "https://api.github.com/users/isaacagudo/followers",
    "following_url": "https://api.github.com/users/isaacagudo/following{/other_user}",
    "gists_url": "https://api.github.com/users/isaacagudo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/isaacagudo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/isaacagudo/subscriptions",
    "organizations_url": "https://api.github.com/users/isaacagudo/orgs",
    "repos_url": "https://api.github.com/users/isaacagudo/repos",
    "events_url": "https://api.github.com/users/isaacagudo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/isaacagudo/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2020-03-29T18:50:49Z",
  "updated_at": "2020-03-31T08:48:40Z",
  "closed_at": "2020-03-31T08:48:40Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "\r\nRelated to #20772  and  #20781\r\n\r\n#### System information\r\n\r\nGeth Version: 1.9.12-stable\r\nGit Commit: b6f1c8dcc058a936955eb8e5766e2962218924bc\r\nArchitecture: amd64\r\nProtocol Versions: [65 64 63]\r\nGo Version: go1.13.8\r\nOperating System: linux\r\nGOPATH=\r\nGOROOT=/build/ethereum-YoJS3q/.go\r\n\r\n#### Expected behaviour\r\n\r\nclique.getSigners() should return signers of current block\r\n\r\n#### Actual behaviour\r\n\r\nclique.getSigners() returns signers of genesis block\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\nCreate genesis with two nodes only, add a third one by proposing it from the two existing sealers. Call clique.getSigners(eth.blockNumber) until the new sealer is accepted, check that clique.getSigners() is not  consistent\r\n\r\n#### Original sealer output \r\n\r\n````\r\n> clique.getSigners()\r\n[\"0x9bc6bb65f1557805d6f274ab1ec07ba4c226af4f\", \"0xb734d85da626e4bf6a43752818f50b31389d619c\"]\r\n> clique.getSigners(eth.blockNumber)\r\n[\"0x9bc6bb65f1557805d6f274ab1ec07ba4c226af4f\", \"0xb734d85da626e4bf6a43752818f50b31389d619c\", \"0xe7ba70b4e1f555b25eee38994bd8896e0fd2d325\"]\r\n````\r\n\r\n#### Genesis block\r\n\r\n````\r\n{\r\n  \"config\": {\r\n    \"chainId\": 56694,\r\n    \"homesteadBlock\": 0,\r\n    \"eip150Block\": 0,\r\n    \"eip150Hash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n    \"eip155Block\": 0,\r\n    \"eip158Block\": 0,\r\n    \"byzantiumBlock\": 0,\r\n    \"constantinopleBlock\": 0,\r\n    \"petersburgBlock\": 0,\r\n    \"istanbulBlock\": 0,\r\n    \"clique\": {\r\n      \"period\": 5,\r\n      \"epoch\": 30000\r\n    }\r\n  },\r\n  \"nonce\": \"0x0\",\r\n  \"timestamp\": \"0x5e80a338\",\r\n  \"extraData\": \"0x00000000000000000000000000000000000000000000000000000000000000009bc6bb65f1557805d6f274ab1ec07ba4c226af4fb734d85da626e4bf6a43752818f50b31389d619c000000000000000000000000000000000000000000\r\n0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\r\n  \"gasLimit\": \"0x47b760\",\r\n  \"difficulty\": \"0x1\",\r\n  \"mixHash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n  \"coinbase\": \"0x0000000000000000000000000000000000000000\",\r\n  \"number\": \"0x0\",\r\n  \"gasUsed\": \"0x0\",\r\n  \"parentHash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\"\r\n}\r\n````\r\n\r\n#### Output third node\r\n\r\n````\r\nINFO [03-29|18:48:45.000] Successfully sealed new block            number=377 sealhash=186102â€¦48ae36 hash=acec80â€¦490bfb elapsed=4.497s\r\nINFO [03-29|18:48:45.000] ðŸ”¨ mined potential block                  number=377 hash=acec80â€¦490bfb\r\nINFO [03-29|18:48:45.001] Commit new mining work                   number=378 sealhash=7163b7â€¦b32017 uncles=0 txs=0 gas=0 fees=0 elapsed=643.295Âµs\r\nINFO [03-29|18:48:45.001] Signed recently, must wait for others \r\nINFO [03-29|18:48:45.158] Imported new chain segment               blocks=1 txs=0 mgas=0.000 elapsed=127.388Âµs mgasps=0.000 number=377 hash=d1b154â€¦c2bbec dirty=0.00B\r\nINFO [03-29|18:48:45.158] Commit new mining work                   number=378 sealhash=7163b7â€¦b32017 uncles=1 txs=0 gas=0 fees=0 elapsed=30.123Âµs\r\nINFO [03-29|18:48:50.005] Imported new chain segment               blocks=1 txs=0 mgas=0.000 elapsed=231.671Âµs mgasps=0.000 number=378 hash=3074dbâ€¦82fb6c dirty=0.00B\r\nINFO [03-29|18:48:50.005] ðŸ”— block reached canonical chain          number=371 hash=764c9fâ€¦226f5f\r\nINFO [03-29|18:48:50.006] Commit new mining work                   number=379 sealhash=490deaâ€¦14542b uncles=1 txs=0 gas=0 fees=0 elapsed=498.196Âµs\r\nINFO [03-29|18:48:55.502] Imported new chain segment               blocks=1 txs=0 mgas=0.000 elapsed=226.46Âµs  mgasps=0.000 number=379 hash=87b126â€¦1d5e60 dirty=0.00B\r\nINFO [03-29|18:48:55.502] Commit new mining work                   number=380 sealhash=219ce4â€¦6536d1 uncles=1 txs=0 gas=0 fees=0 elapsed=145.475Âµs\r\nINFO [03-29|18:49:00.000] Successfully sealed new block            number=380 sealhash=219ce4â€¦6536d1 hash=ee768câ€¦2e6bf2 elapsed=4.497s\r\nINFO [03-29|18:49:00.000] ðŸ”¨ mined potential block                  number=380 hash=ee768câ€¦2e6bf2\r\nINFO [03-29|18:49:00.001] Commit new mining work                   number=381 sealhash=003ee3â€¦eaa25e uncles=1 txs=0 gas=0 fees=0 elapsed=597.995Âµs\r\nINFO [03-29|18:49:00.001] Signed recently, must wait for others \r\nINFO [03-29|18:49:00.249] Imported new chain segment               blocks=1 txs=0 mgas=0.000 elapsed=287.559Âµs mgasps=0.000 number=380 hash=79fce4â€¦27ea66 dirty=0.00B\r\nINFO [03-29|18:49:00.249] Commit new mining work                   number=381 sealhash=003ee3â€¦eaa25e uncles=2 txs=0 gas=0 fees=0 elapsed=97.757Âµs\r\nINFO [03-29|18:49:05.006] Imported new chain segment               blocks=1 txs=0 mgas=0.000 elapsed=242.681Âµs mgasps=0.000 number=381 hash=ca48cfâ€¦1edb59 dirty=0.00B\r\nINFO [03-29|18:49:05.006] ðŸ”— block reached canonical chain          number=374 hash=d32e3dâ€¦cadc5b\r\nINFO [03-29|18:49:05.006] Commit new mining work                   number=382 sealhash=eff71aâ€¦d241ae uncles=2 txs=0 gas=0 fees=0 elapsed=217.842Âµs\r\nINFO [03-29|18:49:10.502] Imported new chain segment               blocks=1 txs=0 mgas=0.000 elapsed=514.128Âµs mgasps=0.000 number=382 hash=b1a8cbâ€¦6b3608 dirty=0.00B\r\nINFO [03-29|18:49:10.503] Commit new mining work                   number=383 sealhash=e71d11â€¦509562 uncles=2 txs=0 gas=0 fees=0 elapsed=164.183Âµs\r\nINFO [03-29|18:49:15.000] Successfully sealed new block            number=383 sealhash=e71d11â€¦509562 hash=bd95eeâ€¦fd5b5f elapsed=4.497s\r\nINFO [03-29|18:49:15.000] ðŸ”¨ mined potential block                  number=383 hash=bd95eeâ€¦fd5b5f\r\nINFO [03-29|18:49:15.001] Commit new mining work                   number=384 sealhash=1007c2â€¦0f23b7 uncles=1 txs=0 gas=0 fees=0 elapsed=845.018Âµs\r\nINFO [03-29|18:49:15.001] Signed recently, must wait for others \r\nINFO [03-29|18:49:20.005] Imported new chain segment               blocks=1 txs=0 mgas=0.000 elapsed=255.172Âµs mgasps=0.000 number=384 hash=6756f1â€¦e634b0 dirty=0.00B\r\nINFO [03-29|18:49:20.006] ðŸ”— block reached canonical chain          number=377 hash=acec80â€¦490bfb\r\nINFO [03-29|18:49:20.006] Commit new mining work                   number=385 sealhash=4db403â€¦11fd2a uncles=1 txs=0 gas=0 fees=0 elapsed=186.088Âµs\r\nINFO [03-29|18:49:25.243] Successfully sealed new block            number=385 sealhash=4db403â€¦11fd2a hash=37bb5dâ€¦e2b369 elapsed=5.237s\r\nINFO [03-29|18:49:25.243] ðŸ”¨ mined potential block                  number=385 hash=37bb5dâ€¦e2b369\r\nINFO [03-29|18:49:25.244] Commit new mining work                   number=386 sealhash=951b8eâ€¦cb8805 uncles=1 txs=0 gas=0 fees=0 elapsed=377.681Âµs\r\nINFO [03-29|18:49:25.244] Signed recently, must wait for others \r\nINFO [03-29|18:49:25.502] Chain reorg detected                     number=384 hash=6756f1â€¦e634b0 drop=1 dropfrom=37bb5dâ€¦e2b369 add=1 addfrom=7b49c1â€¦737c1b\r\nINFO [03-29|18:49:25.502] Imported new chain segment               blocks=1 txs=0 mgas=0.000 elapsed=236.835Âµs mgasps=0.000 number=385 hash=7b49c1â€¦737c1b dirty=0.00B\r\nINFO [03-29|18:49:25.502] Commit new mining work                   number=386 sealhash=cc3f3eâ€¦f52fb1 uncles=2 txs=0 gas=0 fees=0 elapsed=142.207Âµs\r\nINFO [03-29|18:49:30.000] Successfully sealed new block            number=386 sealhash=cc3f3eâ€¦f52fb1 hash=33427dâ€¦7c548d elapsed=4.498s\r\nINFO [03-29|18:49:30.000] ðŸ”¨ mined potential block                  number=386 hash=33427dâ€¦7c548d\r\nINFO [03-29|18:49:30.001] Commit new mining work                   number=387 sealhash=44bc12â€¦d30d30 uncles=1 txs=0 gas=0 fees=0 elapsed=621.315Âµs\r\nINFO [03-29|18:49:30.001] Signed recently, must wait for others \r\nINFO [03-29|18:49:30.257] Imported new chain segment               blocks=1 txs=0 mgas=0.000 elapsed=321.075Âµs mgasps=0.000 number=386 hash=fc4285â€¦bf90b4 dirty=0.00B\r\nINFO [03-29|18:49:30.257] Commit new mining work                   number=387 sealhash=44bc12â€¦d30d30 uncles=2 txs=0 gas=0 fees=0 elapsed=35.529Âµs\r\n````\r\n",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20834/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20834/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/606487802",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/20834#issuecomment-606487802",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/20834",
    "id": 606487802,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNjQ4NzgwMg==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-03-31T08:48:40Z",
    "updated_at": "2020-03-31T08:48:40Z",
    "author_association": "MEMBER",
    "body": "This is a regression already fixed on master https://github.com/ethereum/go-ethereum/pull/20781.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/606487802/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
