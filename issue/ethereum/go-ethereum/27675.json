{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27675",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27675/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27675/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27675/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/27675",
  "id": 1793764425,
  "node_id": "I_kwDOAOvK985q6qxJ",
  "number": 27675,
  "title": "Missing trie node after removedb",
  "user": {
    "login": "suxnju",
    "id": 19996579,
    "node_id": "MDQ6VXNlcjE5OTk2NTc5",
    "avatar_url": "https://avatars.githubusercontent.com/u/19996579?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/suxnju",
    "html_url": "https://github.com/suxnju",
    "followers_url": "https://api.github.com/users/suxnju/followers",
    "following_url": "https://api.github.com/users/suxnju/following{/other_user}",
    "gists_url": "https://api.github.com/users/suxnju/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/suxnju/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/suxnju/subscriptions",
    "organizations_url": "https://api.github.com/users/suxnju/orgs",
    "repos_url": "https://api.github.com/users/suxnju/repos",
    "events_url": "https://api.github.com/users/suxnju/events{/privacy}",
    "received_events_url": "https://api.github.com/users/suxnju/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 268304226,
      "node_id": "MDU6TGFiZWwyNjgzMDQyMjY=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:docs",
      "name": "type:docs",
      "color": "fef2c0",
      "default": false,
      "description": null
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-07-07T15:43:23Z",
  "updated_at": "2023-07-07T22:43:53Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi everyone, after I use `geth -datadir=XXX removedb`, geth syncs normally, but the `Latest Block` is always 0.\r\nAfter ~15 hours, when the `Latest header` and `Latest receipt` are the same height as the `Latest receipt` is the same. \r\n![system](https://github.com/ethereum/go-ethereum/assets/19996579/2998b4aa-c6d7-42b1-b7d8-ecc769cf90d9)\r\n![blockchain](https://github.com/ethereum/go-ethereum/assets/19996579/33e48e87-508b-4154-aa49-384626eb69b7)\r\n\r\n\r\nHowever, in the console `debug.dumpBlock(100)`, it will still show `Missing trie node`\r\n![dump](https://github.com/ethereum/go-ethereum/assets/19996579/e078e6d2-d533-4eeb-903e-282db65e58ac)\r\n\r\nThe geth runs well, here is the latest 20 lines of log\r\n![log](https://github.com/ethereum/go-ethereum/assets/19996579/8f224427-c225-4509-b125-fe1a6dbf9e03)\r\n\r\nMy geth starts with\r\n```cmd\r\ngeth --mainnet \\\r\n     --syncmode full \\\r\n     --gcmode archive \\\r\n     --http \\\r\n     --http.addr ${rpcaddr} \\\r\n     --http.vhosts \"*\" \\\r\n     --http.api \"eth,net,web3,debug,admin\" \\\r\n     --http.port \"8545\" \\\r\n     --http.corsdomain \"*\" \\\r\n     --ws \\\r\n     --ws.addr ${rpcaddr} \\\r\n     --ws.origins '*' \\\r\n     --ws.api \"eth,net,web3,debug,admin\" \\\r\n     --authrpc.jwtsecret \"XXX/jwt.hex\" \\\r\n     --datadir ${datadir} \\\r\n     --metrics --metrics.influxdb \\\r\n     --metrics.influxdb.database \"XXX\" \\\r\n     --metrics.influxdb.endpoint \"http://0.0.0.0:8086\" \\\r\n     --metrics.influxdb.username \"XXX\" \\\r\n     --metrics.influxdb.password \"XXX\"\r\n     --txlookuplimit 0 \\\r\n```\r\n\r\nIt doesn't sync full data as expected (e.g., something can be dumped), what should I do next?\r\n\r\nPs:\r\n- I use the `removedb` because of `bad block`\r\n- My geth version is 1.12.0-stable",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27675/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27675/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1625637039",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/27675#issuecomment-1625637039",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27675",
    "id": 1625637039,
    "node_id": "IC_kwDOAOvK985g5UCv",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-07T16:09:16Z",
    "updated_at": "2023-07-07T16:09:16Z",
    "author_association": "MEMBER",
    "body": "Doing a `geth --removedb` deletes all your data. Yes, it is expected that head block goes back to zero. You wipe everything. \r\n\r\n> It doesn't sync full data as expected\r\n\r\nThat is correct. It does not, which is why you see this: \r\n\r\n> After ~15 hours, when the Latest header and Latest receipt are the same height as the Latest receipt\r\n\r\nThis indicates that snap-sync happened. Which is also the reason why it does not have the state for block `100`. \r\n\r\nSo the only question is why it does not do a full sync. It would be interesting to see the first ~100 lines of output from when you started it the first time after the `geth --removedb` run. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1625637039/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1626334742",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/27675#issuecomment-1626334742",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27675",
    "id": 1626334742,
    "node_id": "IC_kwDOAOvK985g7-YW",
    "user": {
      "login": "Lou2is",
      "id": 127358876,
      "node_id": "U_kgDOB5dXnA",
      "avatar_url": "https://avatars.githubusercontent.com/u/127358876?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Lou2is",
      "html_url": "https://github.com/Lou2is",
      "followers_url": "https://api.github.com/users/Lou2is/followers",
      "following_url": "https://api.github.com/users/Lou2is/following{/other_user}",
      "gists_url": "https://api.github.com/users/Lou2is/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Lou2is/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Lou2is/subscriptions",
      "organizations_url": "https://api.github.com/users/Lou2is/orgs",
      "repos_url": "https://api.github.com/users/Lou2is/repos",
      "events_url": "https://api.github.com/users/Lou2is/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Lou2is/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-07T22:43:53Z",
    "updated_at": "2023-07-07T22:43:53Z",
    "author_association": "NONE",
    "body": "How to get my reward ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1626334742/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
