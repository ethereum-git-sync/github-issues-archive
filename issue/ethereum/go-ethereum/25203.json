{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25203",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25203/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25203/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25203/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/25203",
  "id": 1289257262,
  "node_id": "I_kwDOAOvK985M2IEu",
  "number": 25203,
  "title": "Reconnect to bootnodes if peer connection is lost",
  "user": {
    "login": "wbt",
    "id": 563406,
    "node_id": "MDQ6VXNlcjU2MzQwNg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/563406?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wbt",
    "html_url": "https://github.com/wbt",
    "followers_url": "https://api.github.com/users/wbt/followers",
    "following_url": "https://api.github.com/users/wbt/following{/other_user}",
    "gists_url": "https://api.github.com/users/wbt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wbt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wbt/subscriptions",
    "organizations_url": "https://api.github.com/users/wbt/orgs",
    "repos_url": "https://api.github.com/users/wbt/repos",
    "events_url": "https://api.github.com/users/wbt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wbt/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    },
    {
      "id": 1132754722,
      "node_id": "MDU6TGFiZWwxMTMyNzU0NzIy",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/need:more-information",
      "name": "need:more-information",
      "color": "db6fa3",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-06-29T20:16:30Z",
  "updated_at": "2022-07-13T17:13:20Z",
  "closed_at": "2022-07-12T11:16:13Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: 1.9.24-stable\r\nOS & Version: Windows/Linux/OSX: Win10\r\n\r\n#### Expected behaviour\r\nWhen a node has no peers, it should retry the ones specified in the bootnodes parameter at startup.\r\n\r\n#### Actual behaviour\r\nWhen a node has no peers, it stays that way and ignores the fact that bootnodes specified at startup are online and available for reconnection.\r\n\r\n#### Steps to reproduce the behaviour\r\n1. Start a node to act as a bootnode on a nonstandard local chain and copy the enode address.\r\n2. With that first node running, in a separate terminal (PowerShell) start another with the --bootnodes parameter as the quoted enode address from the prior step.\r\n3. The second node will connect sync, etc. and act normally as expected. Let this run for a while.\r\n4. Hibernate the machine overnight.\r\n5. Bring the computer out of hibernation.\r\n6. The second node will no longer have any peers/connection to the original bootnode, and will not be able to discover it. \r\n7. This will continue indefinitely.\r\n8. Use CTRL+C to stop the second node, only.\r\n9. Restart the second node using the exact same command as before.\r\n10. The second node will again connect to the first and do catch-up resync, then stay connected until the next hibernate.\r\n\r\nOn further reflection, I think this may be a different issue than [#20630](https://github.com/ethereum/go-ethereum/issues/20630#issuecomment-854117596) because it's not about establishing the initial connection to a peer that's just not yet listening.\r\n",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25203/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25203/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1170697933",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25203#issuecomment-1170697933",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25203",
    "id": 1170697933,
    "node_id": "IC_kwDOAOvK985Fx27N",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-30T03:03:58Z",
    "updated_at": "2022-06-30T03:03:58Z",
    "author_association": "MEMBER",
    "body": "Are you still using `1.9.24-stable`? It's pretty old though",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1170697933/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1170949944",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25203#issuecomment-1170949944",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25203",
    "id": 1170949944,
    "node_id": "IC_kwDOAOvK985Fy0c4",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-30T08:54:07Z",
    "updated_at": "2022-06-30T08:54:07Z",
    "author_association": "MEMBER",
    "body": "Defaulting connecting back to the bootnodes is not something we want as it's too heard to detect automatically when things don't worok (e.g. not enough peers) and it's too easy to overload the bootnodes.\r\n\r\nHowever, interestingly a hibernation should not really affect your connectivity if a restart helps. That's a more interesting issue, as the bootnodes themselves should get added back to the local discovery table if nothing else is there. I.e. Seems you're hitting a bug.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1170949944/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1170952466",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25203#issuecomment-1170952466",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25203",
    "id": 1170952466,
    "node_id": "IC_kwDOAOvK985Fy1ES",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-30T08:56:29Z",
    "updated_at": "2022-06-30T08:57:18Z",
    "author_association": "MEMBER",
    "body": "To figure this out, we need the log files of the two nodes.\r\n\r\nSpecifically, we need the log at trace level after the hibernation. To get this, run the node (remember to capture the log output to a file), and after your computer wakes up, connect to it using `geth attach`, then run `debug.verbosity(5)`. After that, the printed log messages will be very detailed and should show p2p connection attempts.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1170952466/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1183478631",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25203#issuecomment-1183478631",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25203",
    "id": 1183478631,
    "node_id": "IC_kwDOAOvK985GinNn",
    "user": {
      "login": "wbt",
      "id": 563406,
      "node_id": "MDQ6VXNlcjU2MzQwNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/563406?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wbt",
      "html_url": "https://github.com/wbt",
      "followers_url": "https://api.github.com/users/wbt/followers",
      "following_url": "https://api.github.com/users/wbt/following{/other_user}",
      "gists_url": "https://api.github.com/users/wbt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wbt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wbt/subscriptions",
      "organizations_url": "https://api.github.com/users/wbt/orgs",
      "repos_url": "https://api.github.com/users/wbt/repos",
      "events_url": "https://api.github.com/users/wbt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wbt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-13T17:13:20Z",
    "updated_at": "2022-07-13T17:13:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "Not sure that \"closed as completed\" was fully appropriate.  I updated to the latest version and debug logs, but it's showing a lot of traffic that both distracts from the real issue and likely reveals more private data than I'd like.  I'm trying to figure out how to fully isolate the node via firewall settings so it's not connecting with as many random other peers, but haven't been able to prioritize completion of that just yet.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1183478631/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
