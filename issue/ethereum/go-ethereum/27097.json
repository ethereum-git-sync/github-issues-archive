{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27097",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27097/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27097/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27097/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/27097",
  "id": 1666311883,
  "node_id": "I_kwDOAOvK985jUebL",
  "number": 27097,
  "title": "Error:forkChoiceUpdateV1 called post-shanghai: BAD BLOCK: Block: 17034870",
  "user": {
    "login": "AlexanderGW",
    "id": 5435037,
    "node_id": "MDQ6VXNlcjU0MzUwMzc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5435037?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AlexanderGW",
    "html_url": "https://github.com/AlexanderGW",
    "followers_url": "https://api.github.com/users/AlexanderGW/followers",
    "following_url": "https://api.github.com/users/AlexanderGW/following{/other_user}",
    "gists_url": "https://api.github.com/users/AlexanderGW/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AlexanderGW/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AlexanderGW/subscriptions",
    "organizations_url": "https://api.github.com/users/AlexanderGW/orgs",
    "repos_url": "https://api.github.com/users/AlexanderGW/repos",
    "events_url": "https://api.github.com/users/AlexanderGW/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AlexanderGW/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-04-13T12:21:24Z",
  "updated_at": "2023-04-13T14:27:51Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\n**Geth version:**\r\nVersion: 1.11.5-stable\r\nArchitecture: amd64\r\nGo Version: go1.19.6\r\n\r\n**CL client & version:**\r\nNimbus 23.3.2\r\n\r\n**OS & Version:**\r\nLinux, Fedora\r\n\r\n**Commit hash :**\r\nN/A\r\n\r\n#### Expected behaviour\r\nThat the node continue syncing past block 17034869\r\n\r\n#### Actual behaviour\r\nStuck at 17034869, calls 17034870 a \"bad block\"\r\n\r\n````\r\nWARN [04-12|23:42:43.721] Beacon client online, but no consensus updates received in a while. Please fix your beacon client to follow the chain!\r\nWARN [04-12|23:39:54.988] Snapshot extension registration failed peer=2b289fb0 err=\"peer connected on snap without compatible eth support\"\r\nWARN [04-12|23:39:50.055] Checkpoint challenge timed out, dropping id=2be92ee3ae610bbe conn=dyndial addr=18.143.177.14:30303 type=Geth/v1.11.5-stable/...\r\nWARN [04-12|23:37:37.774] NewPayloadV1: inserting block failed error=\"missing withdrawalsHash\"\r\n\r\n##############################\r\n\r\nReceipts:\r\n\r\nChain config: &params.ChainConfig{ChainID:1, HomesteadBlock:1150000, DAOForkBlock:1920000, DAOForkSupport:true, EIP150Block:2463000, EIP150Hash:0x2086799aeebeae135c246c65021c82b4e15a2c451340993aacfd2751886514f0, EIP155Block:2675000, EIP158Block:2675000, ByzantiumBlock:4370000, ConstantinopleBlock:7280000, PetersburgBlock:7280000, IstanbulBlock:9069000, MuirGlacierBlock:9200000, BerlinBlock:12244000, LondonBlock:12965000, ArrowGlacierBlock:13773000, GrayGlacierBlock:15050000, MergeNetsplitBlock:<nil>, ShanghaiTime:(*uint64)(0xc0001b21c0), CancunTime:(*uint64)(nil), PragueTime:(*uint64)(nil), TerminalTotalDifficulty:58750000000000000000000, TerminalTotalDifficultyPassed:true, Ethash:(*params.EthashConfig)(0x2990f40), Clique:(*params.CliqueConfig)(nil)}\r\n\r\nPlatform: geth v1.11.5 go1.19.6 amd64 linux\r\n\r\nError: missing withdrawalsHash\r\n\r\nBlock: 17034870 (0x57f77052f67cdbdb14987b46d3a2d6f001dee0e974cb21da7f59c6dea4ad39c7)\r\n\r\n########## BAD BLOCK #########\r\n\r\nERROR[04-12|23:37:37.774]\r\n\r\nWARN [04-12|23:37:36.922] Ignoring already known beacon payload number=17,034,869 hash=c2558f..d85d8f age=10m13s\r\nWARN [04-12|23:34:28.663] Beacon client online, but no consensus updates received in a while. Please fix your beacon client to follow the chain!\r\nWARN [04-12|23:29:28.631] Previously seen beacon client is offline. Please ensure it is operational to follow the chain!\r\nINFO [04-12|23:27:25.679] Stopping work on payload id=0x90a7eb95d8d8b04b reason=timeout\r\nWARN [04-12|23:27:25.247] Served engine_forkchoiceUpdatedV1 reqid=365072 duration=\"115.127Âµs\" err=\"Invalid parameters\" errdata=\"{Error:forkChoiceUpdateV1 called post-shanghai}\"\r\nINFO [04-12|23:27:24.902] Chain head was updated number=17,034,869 hash=c2558f..d85d8f root=8b8da1..fdd295 elapsed=4.140891ms\r\n````\r\n\r\n#### Steps to reproduce the behaviour\r\nUpdated `geth` and `nimbus` 3 weeks ago, both had been running fine until the fork.\r\n\r\n\r\n#### Notes\r\nRelated: https://github.com/ethereum/go-ethereum/issues/27091\r\nWith the exception of using Nimbus, instead of Lighthouse\r\n\r\nIs there a way to pop this bad block off the stack, and have the node resync from `17034869`?\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27097/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27097/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1507066676",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/27097#issuecomment-1507066676",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/27097",
    "id": 1507066676,
    "node_id": "IC_kwDOAOvK985Z1AM0",
    "user": {
      "login": "blibbers",
      "id": 70868429,
      "node_id": "MDQ6VXNlcjcwODY4NDI5",
      "avatar_url": "https://avatars.githubusercontent.com/u/70868429?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/blibbers",
      "html_url": "https://github.com/blibbers",
      "followers_url": "https://api.github.com/users/blibbers/followers",
      "following_url": "https://api.github.com/users/blibbers/following{/other_user}",
      "gists_url": "https://api.github.com/users/blibbers/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/blibbers/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/blibbers/subscriptions",
      "organizations_url": "https://api.github.com/users/blibbers/orgs",
      "repos_url": "https://api.github.com/users/blibbers/repos",
      "events_url": "https://api.github.com/users/blibbers/events{/privacy}",
      "received_events_url": "https://api.github.com/users/blibbers/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-13T14:25:57Z",
    "updated_at": "2023-04-13T14:27:51Z",
    "author_association": "NONE",
    "body": "I have the same issue running the latest version of Prysm and Geth 1.11.5. \r\n\r\nI have multiple nodes that all went offline right when the fork happened. They are all throwing this bad block error and will not sync. \r\n\r\n> Apr 13 14:23:02 eth-node2 geth[4745]: WARN [04-13|14:23:02.367] Too many bad block import attempt, trying number=17,034,870 hash=e22c56..f5216c\r\nApr 13 14:23:02 eth-node2 geth[4745]: INFO [04-13|14:23:02.377] Skip duplicated bad block                number=17,034,870 hash=e22c56..f5216c\r\nApr 13 14:23:02 eth-node2 geth[4745]: ERROR[04-13|14:23:02.377]\r\nApr 13 14:23:02 eth-node2 geth[4745]: ########## BAD BLOCK #########\r\nApr 13 14:23:02 eth-node2 geth[4745]: Block: 17034870 (0xe22c56f211f03baadcc91e4eb9a24344e6848c5df4473988f893b58223f5216c)\r\nApr 13 14:23:02 eth-node2 geth[4745]: Error: invalid withdrawalsHash: have 56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421, expected nil\r\nApr 13 14:23:02 eth-node2 geth[4745]: Platform: geth (devel) go1.19.5 amd64 linux\r\nApr 13 14:23:02 eth-node2 geth[4745]: VCS: 98423013-20230208\r\nApr 13 14:23:02 eth-node2 geth[4745]: Chain config: &params.ChainConfig{ChainID:1, HomesteadBlock:1150000, DAOForkBlock:1920000, DAOForkSupport:true, EIP150Block:2463000, EIP150Hash:0x2086799aeebeae135c246c65021c82b4e15a2c451340993aacfd2751886514f0, EIP155Block:2675000, EIP158Block:2675000, ByzantiumBlock:4370000, ConstantinopleBlock:7280000, PetersburgBlock:7280000, IstanbulBlock:9069000, MuirGlacierBlock:9200000, BerlinBlock:12244000, LondonBlock:12965000, ArrowGlacierBlock:13773000, GrayGlacierBlock:15050000, MergeNetsplitBlock:<nil>, ShanghaiTime:(*uint64)(nil), CancunTime:(*uint64)(nil), PragueTime:(*uint64)(nil), TerminalTotalDifficulty:58750000000000000000000, TerminalTotalDifficultyPassed:true, Ethash:(*params.EthashConfig)(0x25f8050), Clique:(*params.CliqueConfig)(nil)}\r\nApr 13 14:23:02 eth-node2 geth[4745]: Receipts:\r\nApr 13 14:23:02 eth-node2 geth[4745]: ##############################\r\nApr 13 14:23:02 eth-node2 geth[4745]:  \r\nApr 13 14:23:02 eth-node2 geth[4745]: WARN [04-13|14:23:02.377] NewPayloadV1: inserting block failed     error=\"invalid withdrawalsHash: have 56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421, expected nil\"\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1507066676/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
