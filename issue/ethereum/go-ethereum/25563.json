{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25563",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25563/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25563/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25563/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/25563",
  "id": 1345244672,
  "node_id": "I_kwDOAOvK985QLs4A",
  "number": 25563,
  "title": "massive disk usage spike in very short time frame at 2022/08/20 05:00 UTC",
  "user": {
    "login": "c0deright",
    "id": 20477825,
    "node_id": "MDQ6VXNlcjIwNDc3ODI1",
    "avatar_url": "https://avatars.githubusercontent.com/u/20477825?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/c0deright",
    "html_url": "https://github.com/c0deright",
    "followers_url": "https://api.github.com/users/c0deright/followers",
    "following_url": "https://api.github.com/users/c0deright/following{/other_user}",
    "gists_url": "https://api.github.com/users/c0deright/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/c0deright/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/c0deright/subscriptions",
    "organizations_url": "https://api.github.com/users/c0deright/orgs",
    "repos_url": "https://api.github.com/users/c0deright/repos",
    "events_url": "https://api.github.com/users/c0deright/events{/privacy}",
    "received_events_url": "https://api.github.com/users/c0deright/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 268304226,
      "node_id": "MDU6TGFiZWwyNjgzMDQyMjY=",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:docs",
      "name": "type:docs",
      "color": "fef2c0",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-08-20T18:07:43Z",
  "updated_at": "2022-08-22T06:40:31Z",
  "closed_at": "2022-08-22T06:36:08Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: 1.10.20-stable\r\nOS & Version: Linux\r\n\r\n#### Issue\r\n\r\nGeth seems to have been written massive amounts of data to disk in a very small time window which did result in an almost filled disk (geth shutting down gracefully because of low free disk space detected).\r\n\r\nThe log looks like this (time is UTC +0200):\r\n\r\n```\r\nINFO [08-20|07:03:09.336] Chain reorg detected                     number=15,375,653 hash=4b87b2..0b6a36 drop=1 dropfrom=3da552..28c1d2 add=1 addfrom=cfefdb..ca0beb\r\nINFO [08-20|07:03:09.338] Imported new chain segment               blocks=1  txs=62   mgas=5.989   elapsed=409.704ms   mgasps=14.618  number=15,375,654 hash=cfefdb..ca0beb dirty=1023.25MiB\r\nINFO [08-20|07:03:16.944] Chain reorg detected                     number=15,375,653 hash=4b87b2..0b6a36 drop=1 dropfrom=cfefdb..ca0beb add=2 addfrom=1b97a5..d6061a\r\nINFO [08-20|07:03:17.010] Imported new chain segment               blocks=1  txs=106  mgas=14.996  elapsed=1.179s      mgasps=12.711  number=15,375,655 hash=1b97a5..d6061a dirty=1023.90MiB\r\nINFO [08-20|07:03:17.043] Unindexed transactions                   blocks=1  txs=108  tail=13,025,656 elapsed=13.015ms\r\nINFO [08-20|07:03:21.815] Imported new chain segment               blocks=1  txs=147  mgas=14.702  elapsed=1.366s      mgasps=10.763  number=15,375,656 hash=754bb3..811a7e dirty=1022.05MiB\r\nINFO [08-20|07:03:21.845] Unindexed transactions                   blocks=1  txs=238  tail=13,025,657 elapsed=14.088ms\r\nINFO [08-20|07:03:23.027] Imported new chain segment               blocks=1  txs=15   mgas=1.831   elapsed=336.992ms   mgasps=5.435   number=15,375,657 hash=8488a5..24e846 dirty=1021.98MiB\r\nINFO [08-20|07:03:23.036] Unindexed transactions                   blocks=1  txs=74   tail=13,025,658 elapsed=6.568ms\r\nINFO [08-20|07:03:27.827] Imported new chain segment               blocks=1  txs=143  mgas=12.506  elapsed=269.428ms   mgasps=46.416  number=15,375,658 hash=4cf2ae..09b28f dirty=1020.83MiB\r\nINFO [08-20|07:03:27.831] Unindexed transactions                   blocks=1  txs=70   tail=13,025,659 elapsed=3.504ms\r\nINFO [08-20|07:03:30.548] Imported new chain segment               blocks=1  txs=53   mgas=5.663   elapsed=533.729ms   mgasps=10.610  number=15,375,659 hash=104cd0..c35217 dirty=1021.24MiB\r\nINFO [08-20|07:03:30.551] Unindexed transactions                   blocks=1  txs=227  tail=13,025,660 elapsed=3.326ms\r\nINFO [08-20|07:03:36.431] Imported new chain segment               blocks=1  txs=142  mgas=11.384  elapsed=399.746ms   mgasps=28.479  number=15,375,660 hash=fb77e9..2decf2 dirty=1021.24MiB\r\nINFO [08-20|07:03:36.471] Unindexed transactions                   blocks=1  txs=210  tail=13,025,661 elapsed=36.036ms\r\nINFO [08-20|07:03:37.564] Chain reorg detected                     number=15,375,659 hash=104cd0..c35217 drop=1 dropfrom=fb77e9..2decf2 add=1 addfrom=5afa8c..f78680\r\nINFO [08-20|07:03:37.565] Imported new chain segment               blocks=1  txs=62   mgas=4.773   elapsed=109.784ms   mgasps=43.475  number=15,375,660 hash=5afa8c..f78680 dirty=1021.41MiB\r\nINFO [08-20|07:03:41.296] Chain reorg detected                     number=15,375,659 hash=104cd0..c35217 drop=1 dropfrom=5afa8c..f78680 add=2 addfrom=ae6350..2c304b\r\nINFO [08-20|07:03:41.300] Imported new chain segment               blocks=1  txs=18   mgas=2.016   elapsed=94.700ms    mgasps=21.291  number=15,375,661 hash=ae6350..2c304b dirty=1019.85MiB\r\nINFO [08-20|07:03:41.305] Unindexed transactions                   blocks=1  txs=67   tail=13,025,662 elapsed=1.096ms\r\nINFO [08-20|07:03:46.348] Deep froze chain segment                 blocks=11 elapsed=54.968ms    number=15,285,661 hash=183828..98140f\r\nINFO [08-20|07:03:46.969] Imported new chain segment               blocks=1  txs=109  mgas=5.623   elapsed=148.069ms   mgasps=37.972  number=15,375,662 hash=c7a164..193b2b dirty=1020.16MiB\r\nINFO [08-20|07:03:46.976] Unindexed transactions                   blocks=1  txs=308  tail=13,025,663 elapsed=5.106ms\r\nINFO [08-20|07:04:06.815] Imported new chain segment               blocks=1  txs=306  mgas=25.265  elapsed=1.958s      mgasps=12.897  number=15,375,663 hash=5b609b..e45b68 dirty=1021.82MiB\r\nINFO [08-20|07:04:06.859] Unindexed transactions                   blocks=1  txs=87   tail=13,025,664 elapsed=24.231ms\r\nINFO [08-20|07:04:22.269] Imported new chain segment               blocks=1  txs=189  mgas=19.754  elapsed=466.609ms   mgasps=42.336  number=15,375,664 hash=93bf1d..8bb4c5 dirty=1021.28MiB\r\nINFO [08-20|07:04:22.274] Unindexed transactions                   blocks=1  txs=190  tail=13,025,665 elapsed=5.400ms\r\nINFO [08-20|07:04:28.998] Imported new chain segment               blocks=1  txs=67   mgas=5.967   elapsed=122.587ms   mgasps=48.675  number=15,375,665 hash=fd3cf8..a0a3d5 dirty=1020.75MiB\r\nINFO [08-20|07:04:29.037] Unindexed transactions                   blocks=1  txs=117  tail=13,025,666 elapsed=38.124ms\r\nINFO [08-20|07:04:45.049] Imported new chain segment               blocks=1  txs=159  mgas=12.748  elapsed=704.487ms   mgasps=18.095  number=15,375,666 hash=e1d1ad..ae5ad3 dirty=1022.10MiB\r\nINFO [08-20|07:04:45.065] Unindexed transactions                   blocks=1  txs=311  tail=13,025,667 elapsed=4.753ms\r\nINFO [08-20|07:04:46.448] Deep froze chain segment                 blocks=5  elapsed=81.290ms    number=15,285,666 hash=2be9b5..a2357e\r\nINFO [08-20|07:05:08.660] Imported new chain segment               blocks=1  txs=308  mgas=25.253  elapsed=564.737ms   mgasps=44.715  number=15,375,667 hash=529f2b..57cfc8 dirty=1022.34MiB\r\nINFO [08-20|07:05:08.661] Unindexed transactions                   blocks=1  txs=28   tail=13,025,668 elapsed=\"665.222Âµs\"\r\nINFO [08-20|07:05:45.899] Imported new chain segment               blocks=1  txs=270  mgas=28.453  elapsed=1.318s      mgasps=21.577  number=15,375,668 hash=95157c..91d043 dirty=1021.29MiB\r\nINFO [08-20|07:05:45.926] Unindexed transactions                   blocks=1  txs=324  tail=13,025,669 elapsed=14.832ms\r\nINFO [08-20|07:05:46.534] Deep froze chain segment                 blocks=2  elapsed=17.590ms    number=15,285,668 hash=afe6c0..620b0b\r\nINFO [08-20|07:05:51.515] Imported new chain segment               blocks=1  txs=99   mgas=8.302   elapsed=209.691ms   mgasps=39.593  number=15,375,669 hash=5169de..89eed6 dirty=1019.72MiB\r\nINFO [08-20|07:05:51.549] Unindexed transactions                   blocks=1  txs=33   tail=13,025,670 elapsed=34.015ms\r\n\r\nWARN [08-20|07:06:00.278] Disk space is running low. Geth will shutdown if disk space runs below critical level. available=3.40GiB critical_level=2.00GiB\r\n\r\nINFO [08-20|07:06:09.049] Imported new chain segment               blocks=1  txs=147  mgas=14.408  elapsed=285.689ms   mgasps=50.433  number=15,375,670 hash=2a0a10..8d8324 dirty=1018.87MiB\r\nINFO [08-20|07:06:09.111] Unindexed transactions                   blocks=1  txs=135  tail=13,025,671 elapsed=59.367ms\r\nINFO [08-20|07:06:25.999] Imported new chain segment               blocks=1  txs=186  mgas=14.217  elapsed=732.678ms   mgasps=19.404  number=15,375,671 hash=cfc894..96929d dirty=1018.07MiB\r\nINFO [08-20|07:06:26.067] Unindexed transactions                   blocks=1  txs=40   tail=13,025,672 elapsed=66.364ms\r\nINFO [08-20|07:06:29.677] Imported new chain segment               blocks=1  txs=52   mgas=4.702   elapsed=653.798ms   mgasps=7.191   number=15,375,672 hash=f407e7..7a3698 dirty=1016.17MiB\r\nINFO [08-20|07:06:29.746] Unindexed transactions                   blocks=1  txs=0    tail=13,025,673 elapsed=5.647ms\r\n\r\nWARN [08-20|07:06:30.287] Disk space is running low. Geth will shutdown if disk space runs below critical level. available=2.40GiB critical_level=2.00GiB\r\n\r\nINFO [08-20|07:06:42.380] Imported new chain segment               blocks=1  txs=72   mgas=12.642  elapsed=246.319ms   mgasps=51.324  number=15,375,673 hash=fff6cb..4024df dirty=1015.88MiB\r\nINFO [08-20|07:06:42.436] Unindexed transactions                   blocks=1  txs=294  tail=13,025,674 elapsed=37.564ms\r\nINFO [08-20|07:06:43.298] Chain reorg detected                     number=15,375,672 hash=f407e7..7a3698 drop=1 dropfrom=fff6cb..4024df add=1 addfrom=7b9e20..a9bea9\r\nINFO [08-20|07:06:43.301] Imported new chain segment               blocks=1  txs=158  mgas=19.610  elapsed=432.503ms   mgasps=45.342  number=15,375,673 hash=7b9e20..a9bea9 dirty=1016.89MiB\r\nINFO [08-20|07:06:46.578] Imported new chain segment               blocks=1  txs=85   mgas=2.586   elapsed=478.540ms   mgasps=5.403   number=15,375,674 hash=2d75bc..6bb8f5 dirty=1015.74MiB\r\nINFO [08-20|07:06:46.584] Unindexed transactions                   blocks=1  txs=331  tail=13,025,675 elapsed=5.659ms\r\nINFO [08-20|07:06:46.603] Deep froze chain segment                 blocks=5  elapsed=68.534ms    number=15,285,673 hash=2fcbf2..d49f55\r\n\r\nERROR[08-20|07:07:00.288] Low disk space. Gracefully shutting down Geth to prevent database corruption. available=1.37GiB\r\n\r\nINFO [08-20|07:07:00.291] Got interrupt, shutting down...\r\n```\r\n\r\nThe machine is running only geth, nothing else. Especially the volume in question is only used for geth datadir.\r\n\r\n## disk usage\r\n\r\n```\r\n07:06:00 available=3.40GiB\r\n07:06:30 available=2.40GiB\r\n07:07:00 available=1.37GiB\r\n```\r\n\r\nthats 2 GiB in 1 minute and that's quite unusual high for geth (running for more than 30 days now).\r\n\r\nDid someone see unusual disk usage spikes today, too?\r\n\r\nCan this be caused by LevelDB table compaction? Disk usage did only grow, didn't shrink.",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25563/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25563/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1221751522",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25563#issuecomment-1221751522",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25563",
    "id": 1221751522,
    "node_id": "IC_kwDOAOvK985I0nLi",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-22T03:23:35Z",
    "updated_at": "2022-08-22T03:23:35Z",
    "author_association": "MEMBER",
    "body": "1.10.20 contains a buggy change in go-leveldb and we have reverted it in 1.10.21. Please upgrade your node and the additional leveldb files should be automatically cleanup in next restart.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1221751522/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1221916168",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25563#issuecomment-1221916168",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25563",
    "id": 1221916168,
    "node_id": "IC_kwDOAOvK985I1PYI",
    "user": {
      "login": "c0deright",
      "id": 20477825,
      "node_id": "MDQ6VXNlcjIwNDc3ODI1",
      "avatar_url": "https://avatars.githubusercontent.com/u/20477825?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/c0deright",
      "html_url": "https://github.com/c0deright",
      "followers_url": "https://api.github.com/users/c0deright/followers",
      "following_url": "https://api.github.com/users/c0deright/following{/other_user}",
      "gists_url": "https://api.github.com/users/c0deright/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/c0deright/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/c0deright/subscriptions",
      "organizations_url": "https://api.github.com/users/c0deright/orgs",
      "repos_url": "https://api.github.com/users/c0deright/repos",
      "events_url": "https://api.github.com/users/c0deright/events{/privacy}",
      "received_events_url": "https://api.github.com/users/c0deright/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-22T06:40:31Z",
    "updated_at": "2022-08-22T06:40:31Z",
    "author_association": "NONE",
    "body": "Can confirm that restarting with v1.10.21 disk usage shrinks. Thanks.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1221916168/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
