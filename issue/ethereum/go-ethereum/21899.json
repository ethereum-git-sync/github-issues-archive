{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/21899",
  "id": 750043002,
  "node_id": "MDU6SXNzdWU3NTAwNDMwMDI=",
  "number": 21899,
  "title": "geth slow to produce blocks with transactions, mines empty blocks",
  "user": {
    "login": "bogatyy",
    "id": 3701985,
    "node_id": "MDQ6VXNlcjM3MDE5ODU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3701985?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bogatyy",
    "html_url": "https://github.com/bogatyy",
    "followers_url": "https://api.github.com/users/bogatyy/followers",
    "following_url": "https://api.github.com/users/bogatyy/following{/other_user}",
    "gists_url": "https://api.github.com/users/bogatyy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bogatyy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bogatyy/subscriptions",
    "organizations_url": "https://api.github.com/users/bogatyy/orgs",
    "repos_url": "https://api.github.com/users/bogatyy/repos",
    "events_url": "https://api.github.com/users/bogatyy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bogatyy/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 12,
  "created_at": "2020-11-24T20:37:26Z",
  "updated_at": "2021-08-09T18:11:04Z",
  "closed_at": "2021-08-09T18:11:04Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: 1.9.21-stable\r\nOS & Version: Ubuntu 18.04 LTS\r\n\r\nHardware: basically a top-notch cloud provider instance (dedicated, not virtual).\r\n2 TB SSD, 64 GB RAM (geth RAM settings: max allowed, 21 GB).\r\nIntel Xeon CPU E5-2680 v3 @ 2.50GHz\r\n\r\n#### Expected behavior\r\n\r\nGeth node is running in mining mode.\r\nUpon receiving a new block `N`, the node instantly produces new work: block `N+1`, empty (txs=0 fees=0).\r\nAfter that, the node packs block `N+1` with pending transactions, and further produces new work (say txs=123 fees=0.123 ETH).\r\n**Expected:** the delay in producing a transaction-filled block should be reasonable on top hardware, say 100-200 msec.\r\n\r\n\r\n#### Actual behavior\r\nThe delay in producing a transaction-filled block is on the order of 1 second.\r\nSpecifically, on a sample size of 100k blocks (~15 days)\r\n- ~80% of the time it takes approximately 1 second\r\n- ~10% it takes 2 seconds or more\r\n- ~10% of the time it takes < 0.2 seconds. These blocks don't seem to be special, so I don't understand what's blocking geth from producing blocks in under 0.2 seconds all the time.\r\n\r\n\r\n#### geth logger messages sample\r\nScroll to the right, the important part is the `elapsed=...` measurement\r\n````\r\nINFO [11-24|20:28:59.066] Imported new chain segment               blocks=1  txs=191  mgas=12.467  elapsed=150.020ms   mgasps=83.103  number=11323200 hash=\"f22f1f…323eab\" dirty=3.24GiB\r\nINFO [11-24|20:28:59.067] Commit new mining work                   number=11323201 sealhash=\"ae5470…f5a484\" uncles=0 txs=0    gas=0        fees=0             elapsed=\"995.16µs\"\r\nINFO [11-24|20:29:00.188] Commit new mining work                   number=11323201 sealhash=\"7cb550…6fe4a8\" uncles=0 txs=72   gas=12468185 fees=0.4014497929  elapsed=1.121s\r\nINFO [11-24|20:29:02.211] Commit new mining work                   number=11323201 sealhash=\"514281…fa440b\" uncles=0 txs=75   gas=12458990 fees=0.4658125257  elapsed=145.129ms\r\nINFO [11-24|20:29:05.250] Commit new mining work                   number=11323201 sealhash=\"0a10cd…c4c127\" uncles=0 txs=161  gas=12472545 fees=0.4883934447  elapsed=183.175ms\r\nINFO [11-24|20:29:06.163] Imported new chain segment               blocks=1  txs=158  mgas=12.496  elapsed=181.371ms   mgasps=68.898  number=11323201 hash=\"42c9fe…0c77ff\" dirty=3.24GiB\r\nINFO [11-24|20:29:06.165] Commit new mining work                   number=11323202 sealhash=\"9dc1cd…fe0464\" uncles=0 txs=0    gas=0        fees=0             elapsed=1.492ms\r\nINFO [11-24|20:29:07.255] Commit new mining work                   number=11323202 sealhash=\"218e37…4a828e\" uncles=0 txs=66   gas=12472855 fees=0.391307477   elapsed=1.091s\r\nINFO [11-24|20:29:09.049] Imported new chain segment               blocks=1  txs=70   mgas=12.481  elapsed=133.089ms   mgasps=93.781  number=11323202 hash=\"9cca69…1f3c16\" dirty=3.24GiB\r\nINFO [11-24|20:29:09.051] Commit new mining work                   number=11323203 sealhash=\"088da5…3a1b9c\" uncles=0 txs=0    gas=0        fees=0             elapsed=1.216ms\r\nINFO [11-24|20:29:10.215] Commit new mining work                   number=11323203 sealhash=\"bbd829…c16f8e\" uncles=0 txs=72   gas=12461722 fees=0.427861034   elapsed=1.165s\r\n````\r\n#### geth launch command\r\n\r\n````\r\n~/go-ethereum/build/bin/geth --datadir=/my-ssd/gethdatadir --syncmode=fast --cache=32000\r\n--maxpeers 50 --txpool.globalslots=64000 --txpool.pricelimit 20000000000\r\n--http --http.api eth,net --ws --ws.origins='http://127.0.0.1:8546' --ws.api eth,net\r\n--miner.etherbase '0xADDRESS' --mine --miner.threads=0 &>> ~/logs.txt\r\n````",
  "closed_by": {
    "login": "bogatyy",
    "id": 3701985,
    "node_id": "MDQ6VXNlcjM3MDE5ODU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3701985?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bogatyy",
    "html_url": "https://github.com/bogatyy",
    "followers_url": "https://api.github.com/users/bogatyy/followers",
    "following_url": "https://api.github.com/users/bogatyy/following{/other_user}",
    "gists_url": "https://api.github.com/users/bogatyy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bogatyy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bogatyy/subscriptions",
    "organizations_url": "https://api.github.com/users/bogatyy/orgs",
    "repos_url": "https://api.github.com/users/bogatyy/repos",
    "events_url": "https://api.github.com/users/bogatyy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bogatyy/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/736297065",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21899#issuecomment-736297065",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899",
    "id": 736297065,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNjI5NzA2NQ==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-01T08:05:42Z",
    "updated_at": "2020-12-01T08:05:42Z",
    "author_association": "MEMBER",
    "body": "Thanks for reporting @bogatyy. Could you paste the command your using to start geth with, so we can repro easier?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/736297065/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/736595856",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21899#issuecomment-736595856",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899",
    "id": 736595856,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNjU5NTg1Ng==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-01T14:44:12Z",
    "updated_at": "2020-12-01T14:44:12Z",
    "author_association": "MEMBER",
    "body": "IIRC there's some built-in delay there, so we don't just send new work to the nodes again and again, on the basis that there'a non-negigible delay where updating the work package has two drawbacks: \r\n- A small downtime for the miner, \r\n- A window of time where nodes may report results for what the miner suddenly considers 'stale' work package, since he just swapped it to something else, and thus drops it. \r\n\r\n@rjl493456442 may know more? ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/736595856/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/736841009",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21899#issuecomment-736841009",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899",
    "id": 736841009,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNjg0MTAwOQ==",
    "user": {
      "login": "bogatyy",
      "id": 3701985,
      "node_id": "MDQ6VXNlcjM3MDE5ODU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3701985?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bogatyy",
      "html_url": "https://github.com/bogatyy",
      "followers_url": "https://api.github.com/users/bogatyy/followers",
      "following_url": "https://api.github.com/users/bogatyy/following{/other_user}",
      "gists_url": "https://api.github.com/users/bogatyy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bogatyy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bogatyy/subscriptions",
      "organizations_url": "https://api.github.com/users/bogatyy/orgs",
      "repos_url": "https://api.github.com/users/bogatyy/repos",
      "events_url": "https://api.github.com/users/bogatyy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bogatyy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-01T21:47:06Z",
    "updated_at": "2020-12-01T21:47:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thank you for taking a look!\r\n\r\n@MariusVanDerWijden Added the geth launch command into the initial report above.\r\n\r\n@holiman Could you point me to where the delay is implemented?\r\nI'm tentatively skeptical that that's the issue here.\r\n\r\nIIUC there are 3 types of \"new work\" block templates produced by geth nodes, in order:\r\n- Empty block, immediately upon importing someone else's newly mined block – desirable to avoid mining uncles (costly!)\r\n- Filled block, immediately upon forming it – desirable to avoid mining empty blocks (costly and bad for ecosystem)\r\n- Filled blocks with slightly more expensive transactions. These updates are only performed once every 2-3 seconds (lines 4-5 in my logfile), and I think that's where the delay you mentioned comes into play?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/736841009/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/736949746",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21899#issuecomment-736949746",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899",
    "id": 736949746,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNjk0OTc0Ng==",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-02T02:36:26Z",
    "updated_at": "2020-12-02T02:36:26Z",
    "author_association": "MEMBER",
    "body": "@holiman actually it's not. Basically there is no downside for switching the mining block.\r\n\r\n- All the mining tasks created will be cached for 7 blocks. It means even the submission is stale, it will be sent out to become an uncle.\r\n- I think there is no BIG downtime for miner. The switch time in the GPU level is less than 1ms. @chfast had some optimization for the mining software for switching the mining block.\r\n\r\nAnd we don't have the in-buit delay. Whenever we finish packing the mining block, it's sent out immediately.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/736949746/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/736951402",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21899#issuecomment-736951402",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899",
    "id": 736951402,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNjk1MTQwMg==",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-02T02:42:14Z",
    "updated_at": "2020-12-02T02:42:14Z",
    "author_association": "MEMBER",
    "body": "@bogatyy yes, the interval for recreating the mining block can be configured by `--miner.recommit`. But we don't have the deliberate delay for the first full block.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/736951402/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/736953027",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21899#issuecomment-736953027",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899",
    "id": 736953027,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNjk1MzAyNw==",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-02T02:48:08Z",
    "updated_at": "2020-12-02T02:48:08Z",
    "author_association": "MEMBER",
    "body": "@wsnbbxy Do you have any thoughts about it? wsnbbxy is the operator of the SparkPool which uses the Geth as the mining pool node.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/736953027/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/737149026",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21899#issuecomment-737149026",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899",
    "id": 737149026,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNzE0OTAyNg==",
    "user": {
      "login": "wsnbbxy",
      "id": 994103,
      "node_id": "MDQ6VXNlcjk5NDEwMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/994103?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wsnbbxy",
      "html_url": "https://github.com/wsnbbxy",
      "followers_url": "https://api.github.com/users/wsnbbxy/followers",
      "following_url": "https://api.github.com/users/wsnbbxy/following{/other_user}",
      "gists_url": "https://api.github.com/users/wsnbbxy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wsnbbxy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wsnbbxy/subscriptions",
      "organizations_url": "https://api.github.com/users/wsnbbxy/orgs",
      "repos_url": "https://api.github.com/users/wsnbbxy/repos",
      "events_url": "https://api.github.com/users/wsnbbxy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wsnbbxy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-02T10:44:48Z",
    "updated_at": "2020-12-02T10:44:48Z",
    "author_association": "NONE",
    "body": "@bogatyy  80% more than 1s is abnormal. It may be that the value of txpool.globalslots is too large, try reducing it\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/737149026/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/737508109",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21899#issuecomment-737508109",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899",
    "id": 737508109,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNzUwODEwOQ==",
    "user": {
      "login": "bogatyy",
      "id": 3701985,
      "node_id": "MDQ6VXNlcjM3MDE5ODU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3701985?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bogatyy",
      "html_url": "https://github.com/bogatyy",
      "followers_url": "https://api.github.com/users/bogatyy/followers",
      "following_url": "https://api.github.com/users/bogatyy/following{/other_user}",
      "gists_url": "https://api.github.com/users/bogatyy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bogatyy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bogatyy/subscriptions",
      "organizations_url": "https://api.github.com/users/bogatyy/orgs",
      "repos_url": "https://api.github.com/users/bogatyy/repos",
      "events_url": "https://api.github.com/users/bogatyy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bogatyy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-02T21:31:40Z",
    "updated_at": "2020-12-03T22:15:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "@wsnbbxy Thank you! Your suggestion indeed fixed it.\r\n\r\n- At `globalslots=64000`, it took 1 second on average\r\n- At `globalslots=4096` (default value), it takes ~250 msec on average\r\n- At `globalslots=2048`, it takes ~150 msec on average\r\n\r\nThat said, I do not understand why does it take so long. Presumably because `TransactionsByPriceAndNonce` needs to sort all the transactions in the mempool?\r\nBut it creates a heap out of the mempool and extracts transactions one-by-one, so the complexity should be `O(txs_in_block * log_2(globalslots)) = O(100 * log_2(64000))` - that should be very little.\r\nMaybe passing all the mempool transactions by value?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/737508109/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/781230364",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21899#issuecomment-781230364",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899",
    "id": 781230364,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MTIzMDM2NA==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-18T10:04:20Z",
    "updated_at": "2021-02-18T10:04:20Z",
    "author_association": "MEMBER",
    "body": "My hunch is that with 64K slots, there are a lot more accounts in the pool. When you start mining, it retrieves a nonce-sorted list for all accounts, which might be the heavy hitter. If that'd be the case, we have an idea to make it faster by representing transactions a bit differently in the pool, but there's no immediate ETA on when that would land.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/781230364/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/782325371",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21899#issuecomment-782325371",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899",
    "id": 782325371,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MjMyNTM3MQ==",
    "user": {
      "login": "bogatyy",
      "id": 3701985,
      "node_id": "MDQ6VXNlcjM3MDE5ODU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3701985?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bogatyy",
      "html_url": "https://github.com/bogatyy",
      "followers_url": "https://api.github.com/users/bogatyy/followers",
      "following_url": "https://api.github.com/users/bogatyy/following{/other_user}",
      "gists_url": "https://api.github.com/users/bogatyy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bogatyy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bogatyy/subscriptions",
      "organizations_url": "https://api.github.com/users/bogatyy/orgs",
      "repos_url": "https://api.github.com/users/bogatyy/repos",
      "events_url": "https://api.github.com/users/bogatyy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bogatyy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-19T20:30:11Z",
    "updated_at": "2021-02-19T20:30:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thank you @karalabe for looking into it!\r\nI'm not sure if I understand your explanation. Does it mean there will be more than 64K transactions, because we (1) pull up accounts related to those 64K transactions, and then (2) pull up all transactions from those accounts?\r\nI've spent some time digging around the tx sorting code, but could not find the spot where the nonce-sorted list is pulled up to double-check your hunch.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/782325371/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/894725199",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21899#issuecomment-894725199",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899",
    "id": 894725199,
    "node_id": "IC_kwDOAOvK9841VGxP",
    "user": {
      "login": "Sarahli0018",
      "id": 45953715,
      "node_id": "MDQ6VXNlcjQ1OTUzNzE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/45953715?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sarahli0018",
      "html_url": "https://github.com/Sarahli0018",
      "followers_url": "https://api.github.com/users/Sarahli0018/followers",
      "following_url": "https://api.github.com/users/Sarahli0018/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sarahli0018/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sarahli0018/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sarahli0018/subscriptions",
      "organizations_url": "https://api.github.com/users/Sarahli0018/orgs",
      "repos_url": "https://api.github.com/users/Sarahli0018/repos",
      "events_url": "https://api.github.com/users/Sarahli0018/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sarahli0018/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-08T01:00:00Z",
    "updated_at": "2021-08-08T01:22:21Z",
    "author_association": "NONE",
    "body": "hi Bogatyy, \r\nwith 2TB ssd, 64 GB RAM and 50 core cpu cloud server, I got eth.hashrate around 400,000. Is this normal? what is your eth.hashrate? Is eth.hashrate reporting hashrate in Hash/s? (I used the geth configuration as you suggested)\r\n\r\nThank you.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/894725199/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/895431599",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21899#issuecomment-895431599",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21899",
    "id": 895431599,
    "node_id": "IC_kwDOAOvK9841XzOv",
    "user": {
      "login": "bogatyy",
      "id": 3701985,
      "node_id": "MDQ6VXNlcjM3MDE5ODU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3701985?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bogatyy",
      "html_url": "https://github.com/bogatyy",
      "followers_url": "https://api.github.com/users/bogatyy/followers",
      "following_url": "https://api.github.com/users/bogatyy/following{/other_user}",
      "gists_url": "https://api.github.com/users/bogatyy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bogatyy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bogatyy/subscriptions",
      "organizations_url": "https://api.github.com/users/bogatyy/orgs",
      "repos_url": "https://api.github.com/users/bogatyy/repos",
      "events_url": "https://api.github.com/users/bogatyy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bogatyy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-09T18:11:03Z",
    "updated_at": "2021-08-09T18:11:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "@Sarahli0018 \r\nThis thread here is not the ideal forum for discussion – for the future, maybe open a new issue in MiningDAO github?\r\nhttps://github.com/Mining-DAO/docs\r\nWe don't want to be spamming the busy Geth core devs =)\r\n\r\nThat said, I think you're mining on a CPU, and that's why your hashrate is rather low.\r\nEthereum uses GPU mining, so CPU mining would not really be competitive.\r\nWhat are you trying to do? Mine ETH profitably? Or just play around with mining to learn about it?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/895431599/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
