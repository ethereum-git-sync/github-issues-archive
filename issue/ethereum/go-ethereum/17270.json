{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17270",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17270/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17270/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17270/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/17270",
  "id": 345557980,
  "node_id": "MDU6SXNzdWUzNDU1NTc5ODA=",
  "number": 17270,
  "title": "How to force a transaction to be transferred to the signer nodes right after it is sent to the network?",
  "user": {
    "login": "avatar-lavventura",
    "id": 18537398,
    "node_id": "MDQ6VXNlcjE4NTM3Mzk4",
    "avatar_url": "https://avatars.githubusercontent.com/u/18537398?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/avatar-lavventura",
    "html_url": "https://github.com/avatar-lavventura",
    "followers_url": "https://api.github.com/users/avatar-lavventura/followers",
    "following_url": "https://api.github.com/users/avatar-lavventura/following{/other_user}",
    "gists_url": "https://api.github.com/users/avatar-lavventura/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/avatar-lavventura/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/avatar-lavventura/subscriptions",
    "organizations_url": "https://api.github.com/users/avatar-lavventura/orgs",
    "repos_url": "https://api.github.com/users/avatar-lavventura/repos",
    "events_url": "https://api.github.com/users/avatar-lavventura/events{/privacy}",
    "received_events_url": "https://api.github.com/users/avatar-lavventura/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2018-07-29T19:54:25Z",
  "updated_at": "2019-07-17T22:14:03Z",
  "closed_at": "2019-07-17T22:14:03Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Geth version: 1.8.12-stable\r\nOS & Version: Linux/OSX\r\n\r\n(https://ethereum.stackexchange.com/questions/55108/how-to-force-a-transaction-to-be-transferred-to-the-signer-nodes-right-after-it)\r\n\r\n-----------------\r\n\r\n## Expected Behavior\r\nTransactions to distributed to network right at its sent block number and deployed within that.\r\n\r\n-----------\r\n\r\n## Actual Behavior \r\n\r\nTransactions are delayed one block time to be distributed over network and consequently deployed one block time late.\r\n\r\n-----------\r\n\r\n## Explanation\r\n\r\nI have a small cluster that is connected to private Ethereum chain that uses `POA` and block time is fixed 15 seconds. The cluster has four nodes that all nodes are connected to each other. Please note that, there is three signer nodes on my cluster.\r\n\r\nWhen I submit a transaction from a node; the transaction does not reach to all signer nodes on the current block but it is transferred onto the next block. **But, I observe that the sent transaction was received by the non-signer node right after it is sent.**\r\n\r\n***For example;*** when I sent a transaction within the current block, it will not deployed on the current block but on the up coming block. So this forces network to deploy a transaction in 2 block time which is in between 15 seconds to 30 seconds.\r\n\r\n----------\r\n\r\n**Example case:**\r\n`alper@home` is non-signer node and other nodes are signer node.\r\n\r\nI sent a transaction within block number `869,334` from node named `eBloc@netlab` (signer-node) and transaction shows up right after at `alper@home` named node (non-signer node) on block number `869,334` **but it does not show up on the signer nodes even on the node that I sent it from.**\r\n\r\n[![enter image description here][1]][1]\r\n\r\nOn the next block (`869,335`) I observe that all nodes receive the transactions.\r\n\r\n[![enter image description here][2]][2]\r\n\r\nAnd finally on block number (`869,336`) the transaction is deployed.\r\n\r\n[![enter image description here][3]][3]\r\n\r\n=> If the transaction was distributed to all cluster right after it sent it should be deployed on the block number (`869,334`) but it used 1 additional block time for this.\r\n\r\n**[Q1]** Why the sent transaction received by the non-signer nodes right after it is sent but not by the signer nodes?\r\n\r\n**[Q2]** Is this normal that the sent transaction won't transfer to all the network right after it is sent but it takes additional 1 block time even all nodes are connected to each other? Is there any way to force to transfer a transaction to all my signer nodes right after it has been sent?\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/fpnb1.png\r\n  [2]: https://i.stack.imgur.com/drYFr.png\r\n  [3]: https://i.stack.imgur.com/f8QMQ.png\r\n\r\n\r\n",
  "closed_by": {
    "login": "avatar-lavventura",
    "id": 18537398,
    "node_id": "MDQ6VXNlcjE4NTM3Mzk4",
    "avatar_url": "https://avatars.githubusercontent.com/u/18537398?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/avatar-lavventura",
    "html_url": "https://github.com/avatar-lavventura",
    "followers_url": "https://api.github.com/users/avatar-lavventura/followers",
    "following_url": "https://api.github.com/users/avatar-lavventura/following{/other_user}",
    "gists_url": "https://api.github.com/users/avatar-lavventura/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/avatar-lavventura/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/avatar-lavventura/subscriptions",
    "organizations_url": "https://api.github.com/users/avatar-lavventura/orgs",
    "repos_url": "https://api.github.com/users/avatar-lavventura/repos",
    "events_url": "https://api.github.com/users/avatar-lavventura/events{/privacy}",
    "received_events_url": "https://api.github.com/users/avatar-lavventura/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17270/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17270/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/408806427",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17270#issuecomment-408806427",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17270",
    "id": 408806427,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwODgwNjQyNw==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-30T09:39:07Z",
    "updated_at": "2018-07-30T09:39:07Z",
    "author_association": "MEMBER",
    "body": "The transaction should propagate across the network at the same time.\r\n\r\nIt however is not included in the current block, because the block currently being mined is already finalized. It's expensive to recreate a new block every time a new transaction pops up. And in the case of mainnet, the blocks are full either way so it doesn't make much sense. This is why there's always 1 block delay between submitting and mining.\r\n\r\nFor testnets though, we have some code that reworks the miner and among other, we also want to have functionality to immediately include transactions into blocks if there is still space. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/408806427/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/408831414",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17270#issuecomment-408831414",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17270",
    "id": 408831414,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwODgzMTQxNA==",
    "user": {
      "login": "avatar-lavventura",
      "id": 18537398,
      "node_id": "MDQ6VXNlcjE4NTM3Mzk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/18537398?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/avatar-lavventura",
      "html_url": "https://github.com/avatar-lavventura",
      "followers_url": "https://api.github.com/users/avatar-lavventura/followers",
      "following_url": "https://api.github.com/users/avatar-lavventura/following{/other_user}",
      "gists_url": "https://api.github.com/users/avatar-lavventura/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/avatar-lavventura/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/avatar-lavventura/subscriptions",
      "organizations_url": "https://api.github.com/users/avatar-lavventura/orgs",
      "repos_url": "https://api.github.com/users/avatar-lavventura/repos",
      "events_url": "https://api.github.com/users/avatar-lavventura/events{/privacy}",
      "received_events_url": "https://api.github.com/users/avatar-lavventura/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-30T11:24:55Z",
    "updated_at": "2018-07-30T11:40:59Z",
    "author_association": "NONE",
    "body": "@karalabe Thanks for your valuable response.\r\n\r\nAs I understand, my example case is a normal case for the `mainnet`, where signer nodes obtains and signs transactions 1 block delayed, the system forces this. But this implementation also covers `testnets`.\r\n\r\n> The  functionality to immediately include transactions into blocks if there is still space:\r\n\r\nwould be very beneficial for those who have a small network like mine. Since I have a small network, there is not much transactions and usually blocks have space, most time they are empty like on my example. I think even immediately including transactions into blocks if its **empty** would be valuable. \r\n\r\n---------\r\n\r\n**=>** What do you mean by `reworks the miner and among other`?\r\n**=>** Is there any thread that I can follow the discussion or implementation about this functionality? \r\n**=>** Is there anything I can do to help and do you know when it would be available for usage for `testnets`?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/408831414/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/413519510",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17270#issuecomment-413519510",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17270",
    "id": 413519510,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxMzUxOTUxMA==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-16T11:52:04Z",
    "updated_at": "2018-08-16T11:52:04Z",
    "author_association": "MEMBER",
    "body": "We've reworked the miner on the master branch. The current code will regenerate blocks every 3 seconds while mining, so if there are more/better transactions to fir in, the node will chose them.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/413519510/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/416224295",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/17270#issuecomment-416224295",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/17270",
    "id": 416224295,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNjIyNDI5NQ==",
    "user": {
      "login": "avatar-lavventura",
      "id": 18537398,
      "node_id": "MDQ6VXNlcjE4NTM3Mzk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/18537398?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/avatar-lavventura",
      "html_url": "https://github.com/avatar-lavventura",
      "followers_url": "https://api.github.com/users/avatar-lavventura/followers",
      "following_url": "https://api.github.com/users/avatar-lavventura/following{/other_user}",
      "gists_url": "https://api.github.com/users/avatar-lavventura/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/avatar-lavventura/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/avatar-lavventura/subscriptions",
      "organizations_url": "https://api.github.com/users/avatar-lavventura/orgs",
      "repos_url": "https://api.github.com/users/avatar-lavventura/repos",
      "events_url": "https://api.github.com/users/avatar-lavventura/events{/privacy}",
      "received_events_url": "https://api.github.com/users/avatar-lavventura/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-27T13:21:10Z",
    "updated_at": "2018-08-27T14:20:51Z",
    "author_association": "NONE",
    "body": "Thanks!!\r\n\r\nI have re-installed geth from its master branch for all the signer nodes. Current version is as follows and it works.\r\n\r\n```\r\nGeth\r\nVersion: 1.8.15-unstable\r\nArchitecture: amd64\r\nProtocol Versions: [63 62]\r\nNetwork Id: 1\r\nGo Version: go1.11\r\nOperating System: linux\r\nGOPATH=\r\nGOROOT=/usr/local/go\r\n```\r\n\r\n---\r\n\r\nSmall bug maybe, miners' pending transaction count does not incremented/updated after 3 seconds on the network status GUI (ex: https://ethstats.net)  when the transaction sent within the block, but the transaction is deployed. I think network status only updates itself after each block.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/416224295/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
