{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/21459",
  "id": 681253848,
  "node_id": "MDU6SXNzdWU2ODEyNTM4NDg=",
  "number": 21459,
  "title": "getTransactionCount on pending-block: nonce incorrectly returned as 0",
  "user": {
    "login": "leevlad",
    "id": 1399991,
    "node_id": "MDQ6VXNlcjEzOTk5OTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1399991?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/leevlad",
    "html_url": "https://github.com/leevlad",
    "followers_url": "https://api.github.com/users/leevlad/followers",
    "following_url": "https://api.github.com/users/leevlad/following{/other_user}",
    "gists_url": "https://api.github.com/users/leevlad/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/leevlad/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/leevlad/subscriptions",
    "organizations_url": "https://api.github.com/users/leevlad/orgs",
    "repos_url": "https://api.github.com/users/leevlad/repos",
    "events_url": "https://api.github.com/users/leevlad/events{/privacy}",
    "received_events_url": "https://api.github.com/users/leevlad/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "rjl493456442",
    "id": 5959481,
    "node_id": "MDQ6VXNlcjU5NTk0ODE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rjl493456442",
    "html_url": "https://github.com/rjl493456442",
    "followers_url": "https://api.github.com/users/rjl493456442/followers",
    "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
    "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
    "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
    "repos_url": "https://api.github.com/users/rjl493456442/repos",
    "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 13,
  "created_at": "2020-08-18T18:43:17Z",
  "updated_at": "2021-01-31T21:14:40Z",
  "closed_at": "2020-11-26T18:26:40Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## System information\r\n\r\nGeth version:  `1.9.15-stable`\r\nOperating System: `Linux (ubuntu 18.04)`\r\n\r\n#### Expected behaviour\r\n\r\nCalling `eth_getTransactionCount([\"<Address>\", \"pending\"])` returns `0x10`.\r\n\r\n#### Actual behaviour\r\n\r\nCalling `eth_getTransactionCount([\"<Address>\", \"pending\"])` returns `0x0`.\r\n\r\nI restarted `geth` and it looks like it somehow got into a bad state. Saw the following log line after it started:\r\n```\r\nHead state missing, repairing chain\r\n```\r\n\r\nAfter that it rewound the chain to a known state, synced back up, and the issue disappeared.\r\n\r\n#### Additional Context\r\n\r\n- When I call the same endpoint with \"latest\" parameter, it returns a non-zero (and correct) nonce (in this case it was `0x10`).\r\n- Additionally, I'm running a few more instances of geth on other machines, and they were all returning correct non-zero values for the pending nonce (in this case it was `0x10`).\r\n- Checking the account on Etherscan I verified that the nonce of `0x10` was also correct.\r\n- Calling `geth --exec 'eth.blockNumber' attach` returns the correct latest block height\r\n- Calling `geth --exec \"eth.syncing\" attach` returns `false`\r\n- No errors in the syslog\r\n- The machine had ample memory and disk space, system load nominal (~0.8), CPU utilization nominal (~10%), IO wait nominal (<1%)\r\n\r\n#### Question\r\n\r\nIs there a metric that could've been monitored to detect an issue such as this? \r\n\r\nPerhaps it's worth checking if the pending nonce is lower than the latest nonce, which might indicate a problem?\r\n",
  "closed_by": {
    "login": "karalabe",
    "id": 129561,
    "node_id": "MDQ6VXNlcjEyOTU2MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karalabe",
    "html_url": "https://github.com/karalabe",
    "followers_url": "https://api.github.com/users/karalabe/followers",
    "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
    "organizations_url": "https://api.github.com/users/karalabe/orgs",
    "repos_url": "https://api.github.com/users/karalabe/repos",
    "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karalabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/676090223",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21459#issuecomment-676090223",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459",
    "id": 676090223,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3NjA5MDIyMw==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-19T10:17:22Z",
    "updated_at": "2020-08-19T10:17:22Z",
    "author_association": "MEMBER",
    "body": "It's hard to debug these issues without some logs as to what Geth was doing while you were calling it's RPC. Could happen that it was already reimporting some old blocks? Was it recently restarted from a crash? \"Head state missing\" usually means that either Geth crashes, or it was forcefully stopped and you didn't allow it to flush it's buffers to disk gracefully.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/676090223/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/683658582",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21459#issuecomment-683658582",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459",
    "id": 683658582,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4MzY1ODU4Mg==",
    "user": {
      "login": "ang-st",
      "id": 1777820,
      "node_id": "MDQ6VXNlcjE3Nzc4MjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1777820?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ang-st",
      "html_url": "https://github.com/ang-st",
      "followers_url": "https://api.github.com/users/ang-st/followers",
      "following_url": "https://api.github.com/users/ang-st/following{/other_user}",
      "gists_url": "https://api.github.com/users/ang-st/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ang-st/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ang-st/subscriptions",
      "organizations_url": "https://api.github.com/users/ang-st/orgs",
      "repos_url": "https://api.github.com/users/ang-st/repos",
      "events_url": "https://api.github.com/users/ang-st/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ang-st/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-31T09:02:06Z",
    "updated_at": "2020-08-31T09:02:19Z",
    "author_association": "NONE",
    "body": "Hi \r\nI get the same here... It happened overnight\r\n\r\n\r\n```\r\nnode@prod-gw2-gateway-797646cfd8-gcn72:/usr/src/app$ curl -X POST --data '{\"jsonrpc\":\"2.0\",\"method\":\"eth_getTransactionCount\",\"params\":[\"0x67d3839f3e45bd6b68eb2787a5f02b784a0e59bb\",\"latest\"],\"id\":83}' http://prod-ethereum:8545 -H \"Content-Type: application/json\"\r\n{\"jsonrpc\":\"2.0\",\"id\":83,\"result\":\"0xb\"}\r\nnode@prod-gw2-gateway-797646cfd8-gcn72:/usr/src/app$ curl -X POST --data '{\"jsonrpc\":\"2.0\",\"method\":\"eth_getTransactionCount\",\"params\":[\"0x67d3839f3e45bd6b68eb2787a5f02b784a0e59bb\",\"pending\"],\"id\":83}' http://prod-ethereum:8545 -H \"Content-Type: application/json\"\r\n{\"jsonrpc\":\"2.0\",\"id\":83,\"result\":\"0x0\"}\r\n```\r\n\r\nattached log  : [geth.log](https://github.com/ethereum/go-ethereum/files/5149383/geth.log)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/683658582/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/683676994",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21459#issuecomment-683676994",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459",
    "id": 683676994,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4MzY3Njk5NA==",
    "user": {
      "login": "ang-st",
      "id": 1777820,
      "node_id": "MDQ6VXNlcjE3Nzc4MjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1777820?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ang-st",
      "html_url": "https://github.com/ang-st",
      "followers_url": "https://api.github.com/users/ang-st/followers",
      "following_url": "https://api.github.com/users/ang-st/following{/other_user}",
      "gists_url": "https://api.github.com/users/ang-st/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ang-st/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ang-st/subscriptions",
      "organizations_url": "https://api.github.com/users/ang-st/orgs",
      "repos_url": "https://api.github.com/users/ang-st/repos",
      "events_url": "https://api.github.com/users/ang-st/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ang-st/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-31T09:41:23Z",
    "updated_at": "2020-08-31T09:41:23Z",
    "author_association": "NONE",
    "body": "a node restart fixed the issue",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/683676994/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/683816411",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21459#issuecomment-683816411",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459",
    "id": 683816411,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4MzgxNjQxMQ==",
    "user": {
      "login": "leevlad",
      "id": 1399991,
      "node_id": "MDQ6VXNlcjEzOTk5OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1399991?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/leevlad",
      "html_url": "https://github.com/leevlad",
      "followers_url": "https://api.github.com/users/leevlad/followers",
      "following_url": "https://api.github.com/users/leevlad/following{/other_user}",
      "gists_url": "https://api.github.com/users/leevlad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/leevlad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leevlad/subscriptions",
      "organizations_url": "https://api.github.com/users/leevlad/orgs",
      "repos_url": "https://api.github.com/users/leevlad/repos",
      "events_url": "https://api.github.com/users/leevlad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/leevlad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-31T14:32:07Z",
    "updated_at": "2020-08-31T14:32:07Z",
    "author_association": "NONE",
    "body": "Thanks @karalabe, unfortunately I don't have more information to provide, but hopefully the log dump from another user above will help in debugging this.\r\n\r\nI also believe that the \"Head state missing\" error after restart was a red herring. I use `systemd` to run geth, and doing a `systemctl restart geth` just didn't wait long enough for `geth` to shut down cleanly before sending a `SIGKILL`, which probably corrupted some database.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/683816411/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/686970162",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21459#issuecomment-686970162",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459",
    "id": 686970162,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4Njk3MDE2Mg==",
    "user": {
      "login": "ang-st",
      "id": 1777820,
      "node_id": "MDQ6VXNlcjE3Nzc4MjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1777820?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ang-st",
      "html_url": "https://github.com/ang-st",
      "followers_url": "https://api.github.com/users/ang-st/followers",
      "following_url": "https://api.github.com/users/ang-st/following{/other_user}",
      "gists_url": "https://api.github.com/users/ang-st/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ang-st/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ang-st/subscriptions",
      "organizations_url": "https://api.github.com/users/ang-st/orgs",
      "repos_url": "https://api.github.com/users/ang-st/repos",
      "events_url": "https://api.github.com/users/ang-st/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ang-st/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-04T07:32:22Z",
    "updated_at": "2020-09-04T07:32:22Z",
    "author_association": "NONE",
    "body": "Actually,  i can see this behavior at least twice a day.\r\ni'm currently running : `Geth/v1.9.14-stable-6d74d1e5/linux-amd64/go1.14.2` .\r\n\r\nI'll increase log level as at info level there is no error message standing out  ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/686970162/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/687078323",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21459#issuecomment-687078323",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459",
    "id": 687078323,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NzA3ODMyMw==",
    "user": {
      "login": "ang-st",
      "id": 1777820,
      "node_id": "MDQ6VXNlcjE3Nzc4MjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1777820?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ang-st",
      "html_url": "https://github.com/ang-st",
      "followers_url": "https://api.github.com/users/ang-st/followers",
      "following_url": "https://api.github.com/users/ang-st/following{/other_user}",
      "gists_url": "https://api.github.com/users/ang-st/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ang-st/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ang-st/subscriptions",
      "organizations_url": "https://api.github.com/users/ang-st/orgs",
      "repos_url": "https://api.github.com/users/ang-st/repos",
      "events_url": "https://api.github.com/users/ang-st/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ang-st/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-04T11:05:18Z",
    "updated_at": "2020-09-04T11:05:18Z",
    "author_association": "NONE",
    "body": "@karalabe any hint which part i should focus on ?  i intend to use `debug.vmodule` so i can be more specific that just increasing log verbosity...\r\nThanks in advance.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/687078323/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/687085772",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21459#issuecomment-687085772",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459",
    "id": 687085772,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NzA4NTc3Mg==",
    "user": {
      "login": "ang-st",
      "id": 1777820,
      "node_id": "MDQ6VXNlcjE3Nzc4MjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1777820?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ang-st",
      "html_url": "https://github.com/ang-st",
      "followers_url": "https://api.github.com/users/ang-st/followers",
      "following_url": "https://api.github.com/users/ang-st/following{/other_user}",
      "gists_url": "https://api.github.com/users/ang-st/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ang-st/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ang-st/subscriptions",
      "organizations_url": "https://api.github.com/users/ang-st/orgs",
      "repos_url": "https://api.github.com/users/ang-st/repos",
      "events_url": "https://api.github.com/users/ang-st/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ang-st/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-04T11:24:29Z",
    "updated_at": "2020-09-04T11:24:29Z",
    "author_association": "NONE",
    "body": "kind of related :  I sometime have some transactions that get stuck as `sendRawTransaction` timeout. \r\nfrom there the transaction is present in \"mempool\" of the node and is not broadcasted ... it can stay for hours here even upon node restarting.\r\nThe only option i found is to rebroadcast it from a third party node.\r\n\r\nfrom there i have \r\n`eth_getTransactionCount([\"<Address>\", \"pending\"])` returning `eth_getTransactionCount([\"<Address>\") -1 `\r\n\r\n```\r\n> eth.getTransactionCount('0x...')\r\n71\r\n> eth.getTransactionCount('0x..','pending')\r\n70\r\n```\r\n\r\n   ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/687085772/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/688532584",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21459#issuecomment-688532584",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459",
    "id": 688532584,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4ODUzMjU4NA==",
    "user": {
      "login": "amyodov",
      "id": 672311,
      "node_id": "MDQ6VXNlcjY3MjMxMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/672311?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amyodov",
      "html_url": "https://github.com/amyodov",
      "followers_url": "https://api.github.com/users/amyodov/followers",
      "following_url": "https://api.github.com/users/amyodov/following{/other_user}",
      "gists_url": "https://api.github.com/users/amyodov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amyodov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amyodov/subscriptions",
      "organizations_url": "https://api.github.com/users/amyodov/orgs",
      "repos_url": "https://api.github.com/users/amyodov/repos",
      "events_url": "https://api.github.com/users/amyodov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amyodov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-07T22:52:03Z",
    "updated_at": "2020-09-07T22:52:03Z",
    "author_association": "NONE",
    "body": "See the same behaviour on my 1.9.13 and 1.9.15 geths:\r\n\r\n~~~\r\n> eth.getTransactionCount('0xd701edf8f9c5d834bcb9add73ddeff2d6b9c3d24', 'pending')\r\n0\r\n> eth.getTransactionCount('0xd701edf8f9c5d834bcb9add73ddeff2d6b9c3d24')\r\n17559\r\n~~~\r\n\r\nThere is no transactions pending from this address,\r\n\r\n~~~\r\n> txpool.content.pending['0xd701eDF8f9C5d834Bcb9Add73ddefF2D6B9C3D24']\r\nundefined\r\n~~~\r\n, and I suspect this can be related.\r\n\r\nAs far as I understand, previously (around 1.9.11 or earlier) the “get transaction count(..., pending)” has always returned the nonce which is at least higher than the  “latest” nonce. Moreover, some third-party libraries expect that and often use the `eth.getTransactionCount(address, 'pending')` as a de facto way to get the nonce for the next transaction.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/688532584/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/734158624",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21459#issuecomment-734158624",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459",
    "id": 734158624,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDE1ODYyNA==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-26T08:43:45Z",
    "updated_at": "2020-11-26T08:43:45Z",
    "author_association": "MEMBER",
    "body": "This issue is getting pretty stale now @amyodov or @leevlad do you see the same behaviour with one of the current releases too?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/734158624/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/734330889",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21459#issuecomment-734330889",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459",
    "id": 734330889,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDMzMDg4OQ==",
    "user": {
      "login": "leevlad",
      "id": 1399991,
      "node_id": "MDQ6VXNlcjEzOTk5OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1399991?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/leevlad",
      "html_url": "https://github.com/leevlad",
      "followers_url": "https://api.github.com/users/leevlad/followers",
      "following_url": "https://api.github.com/users/leevlad/following{/other_user}",
      "gists_url": "https://api.github.com/users/leevlad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/leevlad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leevlad/subscriptions",
      "organizations_url": "https://api.github.com/users/leevlad/orgs",
      "repos_url": "https://api.github.com/users/leevlad/repos",
      "events_url": "https://api.github.com/users/leevlad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/leevlad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-26T14:33:10Z",
    "updated_at": "2020-11-26T14:33:10Z",
    "author_association": "NONE",
    "body": "Haven't seen this issue in months at this point. I am confident it has been fixed.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/734330889/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/734346215",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21459#issuecomment-734346215",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459",
    "id": 734346215,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDM0NjIxNQ==",
    "user": {
      "login": "amyodov",
      "id": 672311,
      "node_id": "MDQ6VXNlcjY3MjMxMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/672311?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amyodov",
      "html_url": "https://github.com/amyodov",
      "followers_url": "https://api.github.com/users/amyodov/followers",
      "following_url": "https://api.github.com/users/amyodov/following{/other_user}",
      "gists_url": "https://api.github.com/users/amyodov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amyodov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amyodov/subscriptions",
      "organizations_url": "https://api.github.com/users/amyodov/orgs",
      "repos_url": "https://api.github.com/users/amyodov/repos",
      "events_url": "https://api.github.com/users/amyodov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amyodov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-26T15:02:24Z",
    "updated_at": "2020-11-26T15:02:31Z",
    "author_association": "NONE",
    "body": "Haven't seen it since then, either; but I am not sure that was an “issue easily reproducible” – that may have been a random moment/corruption to see that, and it just never occurred for me anymore.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/734346215/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/734435675",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21459#issuecomment-734435675",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459",
    "id": 734435675,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDQzNTY3NQ==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-26T18:26:40Z",
    "updated_at": "2020-11-26T18:26:40Z",
    "author_association": "MEMBER",
    "body": "Thx all, I'll close this, please reopen if it reappears.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/734435675/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/770452068",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/21459#issuecomment-770452068",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/21459",
    "id": 770452068,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MDQ1MjA2OA==",
    "user": {
      "login": "leevlad",
      "id": 1399991,
      "node_id": "MDQ6VXNlcjEzOTk5OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1399991?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/leevlad",
      "html_url": "https://github.com/leevlad",
      "followers_url": "https://api.github.com/users/leevlad/followers",
      "following_url": "https://api.github.com/users/leevlad/following{/other_user}",
      "gists_url": "https://api.github.com/users/leevlad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/leevlad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leevlad/subscriptions",
      "organizations_url": "https://api.github.com/users/leevlad/orgs",
      "repos_url": "https://api.github.com/users/leevlad/repos",
      "events_url": "https://api.github.com/users/leevlad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/leevlad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-31T21:14:40Z",
    "updated_at": "2021-01-31T21:14:40Z",
    "author_association": "NONE",
    "body": "Hey, just wanted to drop a line here as follow-up. I was running `v1.9.20` on Linux and ran into a similar issue where pending nonces for one heavily used account (10k+ outgoing transactions) were being sporadically returned very stale. Sometimes the nonce value was 20-30 lower than it should've been, and other times they were being returned correctly.\r\n\r\nThe issue seems to have gone away after a few hours. I have upgraded to latest version (`v1.9.25`) since then, and the issue  has not recurred yet.\r\n\r\nWhen it was happening I wasn't able to reproduce the issue deterministically, but I do want to provide some additional context in case it might hint at the possible root cause:\r\n- I was sending about 100 transactions per hour out of that wallet when this started happening\r\n- It seemed to have started happening only after I had a transaction with a very low gasPrice (7.5gwei while network average was 120gwei) in the mempool for about 20 minutes. Pending nonces after this one transaction's nonce started intermittently being returned incorrectly.\r\n\r\nI don't believe this merits reopening the issue just yet, but I will keep an eye on how it performs on `v1.9.25` and report back with more details if it recurs.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/770452068/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
