{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19842",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19842/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19842/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19842/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/19842",
  "id": 468534861,
  "node_id": "MDU6SXNzdWU0Njg1MzQ4NjE=",
  "number": 19842,
  "title": "Blockchain rolls back after quit accidentally",
  "user": {
    "login": "Yiran-Chen",
    "id": 16913127,
    "node_id": "MDQ6VXNlcjE2OTEzMTI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/16913127?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Yiran-Chen",
    "html_url": "https://github.com/Yiran-Chen",
    "followers_url": "https://api.github.com/users/Yiran-Chen/followers",
    "following_url": "https://api.github.com/users/Yiran-Chen/following{/other_user}",
    "gists_url": "https://api.github.com/users/Yiran-Chen/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Yiran-Chen/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Yiran-Chen/subscriptions",
    "organizations_url": "https://api.github.com/users/Yiran-Chen/orgs",
    "repos_url": "https://api.github.com/users/Yiran-Chen/repos",
    "events_url": "https://api.github.com/users/Yiran-Chen/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Yiran-Chen/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2019-07-16T09:05:20Z",
  "updated_at": "2019-07-19T02:12:44Z",
  "closed_at": "2019-07-19T02:12:44Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: 1.8.27\r\nOS & Version: Linux\r\n\r\n#### Issue\r\noptions\r\n--gcmode full\r\n--dev\r\nThe latest block 701 was mined, then my computer was out of battery and shutdown . When I restart, the latest block become 645 (eth.blockNumber is 645), I still can get block data of 646 - 701 (eth.getBlock(646) ... eth.getBlock(701) still return old data) but they are no longer a part of the chain, newly mined blocks will replace the old blocks and link to 645.\r\nIs it because the gcmode is enabled and the data of 645 - 701 was not flushed to disk ?\r\nIs there a way to \"reset the head\" to the old 701 , since old data was not lost ?\r\n",
  "closed_by": {
    "login": "Yiran-Chen",
    "id": 16913127,
    "node_id": "MDQ6VXNlcjE2OTEzMTI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/16913127?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Yiran-Chen",
    "html_url": "https://github.com/Yiran-Chen",
    "followers_url": "https://api.github.com/users/Yiran-Chen/followers",
    "following_url": "https://api.github.com/users/Yiran-Chen/following{/other_user}",
    "gists_url": "https://api.github.com/users/Yiran-Chen/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Yiran-Chen/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Yiran-Chen/subscriptions",
    "organizations_url": "https://api.github.com/users/Yiran-Chen/orgs",
    "repos_url": "https://api.github.com/users/Yiran-Chen/repos",
    "events_url": "https://api.github.com/users/Yiran-Chen/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Yiran-Chen/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19842/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19842/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/511789457",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19842#issuecomment-511789457",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19842",
    "id": 511789457,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMTc4OTQ1Nw==",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-07-16T12:11:19Z",
    "updated_at": "2019-07-16T12:11:19Z",
    "author_association": "MEMBER",
    "body": "For the default gcmode `full`, Geth will maintain all state data in the memory and flush them in a time interval.\r\nSince your Geth node exited without flushing data, so it rewinds the head automatically.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/511789457/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/512068791",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19842#issuecomment-512068791",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19842",
    "id": 512068791,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMjA2ODc5MQ==",
    "user": {
      "login": "Yiran-Chen",
      "id": 16913127,
      "node_id": "MDQ6VXNlcjE2OTEzMTI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/16913127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Yiran-Chen",
      "html_url": "https://github.com/Yiran-Chen",
      "followers_url": "https://api.github.com/users/Yiran-Chen/followers",
      "following_url": "https://api.github.com/users/Yiran-Chen/following{/other_user}",
      "gists_url": "https://api.github.com/users/Yiran-Chen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Yiran-Chen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Yiran-Chen/subscriptions",
      "organizations_url": "https://api.github.com/users/Yiran-Chen/orgs",
      "repos_url": "https://api.github.com/users/Yiran-Chen/repos",
      "events_url": "https://api.github.com/users/Yiran-Chen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Yiran-Chen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-07-17T01:52:23Z",
    "updated_at": "2019-07-17T01:52:23Z",
    "author_association": "NONE",
    "body": "> For the default gcmode `full`, Geth will maintain all state data in the memory and flush them in a time interval.\r\n> Since your Geth node exited without flushing data, so it rewinds the head automatically.\r\n\r\nYes, that's also my suspicion.  But block 645 was mined 15 days ago, so it does not flush in a time interval but in a blocks window I guess, and there is no management API to \"reset the head\" even data still exists.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/512068791/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/512069766",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19842#issuecomment-512069766",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19842",
    "id": 512069766,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMjA2OTc2Ng==",
    "user": {
      "login": "rjl493456442",
      "id": 5959481,
      "node_id": "MDQ6VXNlcjU5NTk0ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5959481?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rjl493456442",
      "html_url": "https://github.com/rjl493456442",
      "followers_url": "https://api.github.com/users/rjl493456442/followers",
      "following_url": "https://api.github.com/users/rjl493456442/following{/other_user}",
      "gists_url": "https://api.github.com/users/rjl493456442/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rjl493456442/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rjl493456442/subscriptions",
      "organizations_url": "https://api.github.com/users/rjl493456442/orgs",
      "repos_url": "https://api.github.com/users/rjl493456442/repos",
      "events_url": "https://api.github.com/users/rjl493456442/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rjl493456442/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-07-17T01:57:30Z",
    "updated_at": "2019-07-17T01:57:39Z",
    "author_association": "MEMBER",
    "body": "Geth will import all \"missing\" blocks even there are existent.\r\n\r\nBtw we have a private RPC call `debug_setHead`. You can try this API with exposing the `debug` namespace or via `ipc`",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/512069766/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/512689523",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19842#issuecomment-512689523",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19842",
    "id": 512689523,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMjY4OTUyMw==",
    "user": {
      "login": "Yiran-Chen",
      "id": 16913127,
      "node_id": "MDQ6VXNlcjE2OTEzMTI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/16913127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Yiran-Chen",
      "html_url": "https://github.com/Yiran-Chen",
      "followers_url": "https://api.github.com/users/Yiran-Chen/followers",
      "following_url": "https://api.github.com/users/Yiran-Chen/following{/other_user}",
      "gists_url": "https://api.github.com/users/Yiran-Chen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Yiran-Chen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Yiran-Chen/subscriptions",
      "organizations_url": "https://api.github.com/users/Yiran-Chen/orgs",
      "repos_url": "https://api.github.com/users/Yiran-Chen/repos",
      "events_url": "https://api.github.com/users/Yiran-Chen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Yiran-Chen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-07-18T06:53:41Z",
    "updated_at": "2019-07-18T06:53:41Z",
    "author_association": "NONE",
    "body": "> Geth will import all \"missing\" blocks even there are existent.\r\n> \r\n> Btw we have a private RPC call `debug_setHead`. You can try this API with exposing the `debug` namespace or via `ipc`\r\n\r\nI tried debug_setHead,  nothing happen if set head to a \"future\" block",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/512689523/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/512797841",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19842#issuecomment-512797841",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19842",
    "id": 512797841,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMjc5Nzg0MQ==",
    "user": {
      "login": "karalabe",
      "id": 129561,
      "node_id": "MDQ6VXNlcjEyOTU2MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/129561?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/karalabe",
      "html_url": "https://github.com/karalabe",
      "followers_url": "https://api.github.com/users/karalabe/followers",
      "following_url": "https://api.github.com/users/karalabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/karalabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/karalabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/karalabe/subscriptions",
      "organizations_url": "https://api.github.com/users/karalabe/orgs",
      "repos_url": "https://api.github.com/users/karalabe/repos",
      "events_url": "https://api.github.com/users/karalabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/karalabe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-07-18T12:39:41Z",
    "updated_at": "2019-07-18T12:39:41Z",
    "author_association": "MEMBER",
    "body": "You can't set the head to a future block, only to past ones. If you don't shut Geth down gracefully, there's no way currently to recover the data from a local crashed database, only from a remote node. Generally this is fine, unless you have a single-node network. In that case, you're out of luck for now.\r\n\r\nThere is a possibility to re-execute local blocks without state after a crash, but that requires code in Geth that we don't currently have. Also, if you've mined blocks on top of the crashed and rewound database, it's very very messy to do any recovery, since that would entail extracting dangling data from the database by hash and reconstructing the chain outside of Geth and then reimporting it.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/512797841/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/513062181",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/19842#issuecomment-513062181",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/19842",
    "id": 513062181,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMzA2MjE4MQ==",
    "user": {
      "login": "Yiran-Chen",
      "id": 16913127,
      "node_id": "MDQ6VXNlcjE2OTEzMTI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/16913127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Yiran-Chen",
      "html_url": "https://github.com/Yiran-Chen",
      "followers_url": "https://api.github.com/users/Yiran-Chen/followers",
      "following_url": "https://api.github.com/users/Yiran-Chen/following{/other_user}",
      "gists_url": "https://api.github.com/users/Yiran-Chen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Yiran-Chen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Yiran-Chen/subscriptions",
      "organizations_url": "https://api.github.com/users/Yiran-Chen/orgs",
      "repos_url": "https://api.github.com/users/Yiran-Chen/repos",
      "events_url": "https://api.github.com/users/Yiran-Chen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Yiran-Chen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-07-19T02:12:43Z",
    "updated_at": "2019-07-19T02:12:43Z",
    "author_association": "NONE",
    "body": "> You can't set the head to a future block, only to past ones. If you don't shut Geth down gracefully, there's no way currently to recover the data from a local crashed database, only from a remote node. Generally this is fine, unless you have a single-node network. In that case, you're out of luck for now.\r\n> \r\n> There is a possibility to re-execute local blocks without state after a crash, but that requires code in Geth that we don't currently have. Also, if you've mined blocks on top of the crashed and rewound database, it's very very messy to do any recovery, since that would entail extracting dangling data from the database by hash and reconstructing the chain outside of Geth and then reimporting it.\r\n\r\nThanks",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/513062181/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
