{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2841",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2841/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2841/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2841/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/2841",
  "id": 166755787,
  "node_id": "MDU6SXNzdWUxNjY3NTU3ODc=",
  "number": 2841,
  "title": "Traffic and CPU spikes by useless block fetches",
  "user": {
    "login": "hdiedrich",
    "id": 246863,
    "node_id": "MDQ6VXNlcjI0Njg2Mw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/246863?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hdiedrich",
    "html_url": "https://github.com/hdiedrich",
    "followers_url": "https://api.github.com/users/hdiedrich/followers",
    "following_url": "https://api.github.com/users/hdiedrich/following{/other_user}",
    "gists_url": "https://api.github.com/users/hdiedrich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hdiedrich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hdiedrich/subscriptions",
    "organizations_url": "https://api.github.com/users/hdiedrich/orgs",
    "repos_url": "https://api.github.com/users/hdiedrich/repos",
    "events_url": "https://api.github.com/users/hdiedrich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hdiedrich/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/milestones/37",
    "html_url": "https://github.com/ethereum/go-ethereum/milestone/37",
    "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/milestones/37/labels",
    "id": 1926259,
    "node_id": "MDk6TWlsZXN0b25lMTkyNjI1OQ==",
    "number": 37,
    "title": "1.4.11",
    "description": "",
    "creator": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 28,
    "state": "closed",
    "created_at": "2016-08-05T20:50:42Z",
    "updated_at": "2016-11-15T17:54:09Z",
    "due_on": "2016-08-11T07:00:00Z",
    "closed_at": "2016-08-21T21:58:35Z"
  },
  "comments": 0,
  "created_at": "2016-07-21T07:36:26Z",
  "updated_at": "2016-08-18T19:07:44Z",
  "closed_at": "2016-08-18T19:07:40Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Blocks are very frequently received, evaluated and then 'ignored' leading to measurable waste of bandwidth, CPU and RAM capacity. This is not an error condition but does not seem to be working as intended.\n#### System information\n\nGeth version: `1.4.0+`\nOS & Version: `Linux/OSX`\nCommit hash : n/a\n#### Expected behaviour\n\nDon't fetch bulks of blocks that are already known.\n#### Actual behaviour\n\nBandwidth usage frequently spikes while CPU load is maxed to 100%, with RAM hogged and not released, even for fully synched clients. The blocks received are pow-checked but eventually discarded, giving the 'ignore' log messages as shown below.\n\nThis happens multiple times an hour and for fully synched clients that don't mine might multiply their bandwidth, electricity usage and CPU load during normal operation. If clogging the network and reducing hashing power for less powerful nodes, this could reduce network security.\n\nPeers observed as senders of the blocks were all Parity 1.2.2-beta. More verbose logs show that the blocks are being fetched explicitly.\n#### Steps to reproduce the behaviour\n\nThe behavior is visible in the logs of any geth 1.4.x client running on main net, usually after a few minutes. Likeliness is increased by increasing max allowed peers e.g. starting geth using `--maxpeers=120`.\n#### Log\n\nThis is an example log from 1.4.6\n\n```\nGETH: I0609 16:23:05.689998 core/blockchain.go:964] imported 0 block(s) (0 queued 2 ignored) including 0 txs in 86.576677ms. #657981 [d02b0c4f / 9f79077d]\nGETH: I0609 16:23:06.275904 core/blockchain.go:964] imported 0 block(s) (0 queued 15 ignored) including 0 txs in 441.671828ms. #657996 [211ec474 / 91367e9f]\nGETH: I0609 16:23:06.722845 core/blockchain.go:964] imported 0 block(s) (0 queued 9 ignored) including 0 txs in 279.603043ms. #658005 [da5449d7 / b2edb6d0]\nGETH: I0609 16:23:07.121051 core/blockchain.go:964] imported 0 block(s) (0 queued 10 ignored) including 0 txs in 204.204791ms. #658015 [91b8241e / 8cc66e35]\nGETH: I0609 16:23:08.192393 core/blockchain.go:964] imported 0 block(s) (0 queued 9 ignored) including 0 txs in 259.97379ms. #658024 [85d66046 / 2d053ad9]\nGETH: I0609 16:23:08.978219 core/blockchain.go:964] imported 0 block(s) (0 queued 13 ignored) including 0 txs in 449.585136ms. #658037 [4ede70f8 / 53010fb8]\nGETH: I0609 16:23:09.853744 core/blockchain.go:964] imported 0 block(s) (0 queued 2 ignored) including 0 txs in 63.31047ms. #658039 [15df2f57 / 489bf2ba]\nGETH: I0609 16:23:10.922302 core/blockchain.go:964] imported 0 block(s) (0 queued 45 ignored) including 0 txs in 1.038123637s. #658084 [0edfaaae / c5f266d7]\nGETH: I0609 16:23:14.880169 core/blockchain.go:964] imported 0 block(s) (0 queued 207 ignored) including 0 txs in 3.771540334s. #658291 [51419c57 / 8feaa966]\nGETH: I0609 16:23:31.797717 core/blockchain.go:964] imported 0 block(s) (0 queued 902 ignored) including 0 txs in 16.504417435s. #659193 [cccd4489 / b02f8f8f]\nGETH: I0609 16:23:31.868485 core/blockchain.go:964] imported 1 block(s) (0 queued 0 ignored) including 0 txs in 69.322511ms. #661608 [4550358b / 4550358b]\n```\n\nAnother example:\n\n```\nGETH: I0615 17:25:36.570766 core/blockchain.go:964] imported 0 block(s) (0 queued 2048 ignored) including 0 txs in 38.348947333s. #686346 [c9c70ab9 / ce8c68ff]\nGETH: I0615 17:25:36.727978 core/blockchain.go:964] imported 1 block(s) (0 queued 0 ignored) including 1 txs in 154.422651ms. #690938 [bc695743 / bc695743]\nGETH: I0615 17:25:38.695696 core/blockchain.go:964] imported 0 block(s) (0 queued 109 ignored) including 0 txs in 1.965869307s. #686455 [d928a8a6 / b3b9e5e8]\nGETH: I0615 17:25:38.922285 core/blockchain.go:964] imported 1 block(s) (0 queued 0 ignored) including 1 txs in 163.928007ms. #690939 [156adb20 / 156adb20]\nGETH: I0615 17:26:32.720477 core/blockchain.go:964] imported 0 block(s) (0 queued 2048 ignored) including 0 txs in 51.955291713s. #688503 [b7ec7816 / ee4825a1]\nGETH: I0615 17:26:32.868980 core/blockchain.go:964] imported 1 block(s) (0 queued 0 ignored) including 0 txs in 127.55419ms. #690940 [2942f228 / 2942f228]\nGETH: I0615 17:26:33.024004 core/blockchain.go:964] imported 1 block(s) (0 queued 0 ignored) including 0 txs in 74.949037ms. #690941 [6d9ece0d / 6d9ece0d]\n```\n",
  "closed_by": {
    "login": "fjl",
    "id": 6915,
    "node_id": "MDQ6VXNlcjY5MTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fjl",
    "html_url": "https://github.com/fjl",
    "followers_url": "https://api.github.com/users/fjl/followers",
    "following_url": "https://api.github.com/users/fjl/following{/other_user}",
    "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
    "organizations_url": "https://api.github.com/users/fjl/orgs",
    "repos_url": "https://api.github.com/users/fjl/repos",
    "events_url": "https://api.github.com/users/fjl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fjl/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2841/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/2841/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[

]
