{
  "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25227",
  "repository_url": "https://api.github.com/repos/ethereum/go-ethereum",
  "labels_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25227/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25227/comments",
  "events_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25227/events",
  "html_url": "https://github.com/ethereum/go-ethereum/issues/25227",
  "id": 1292051517,
  "node_id": "I_kwDOAOvK985NAyQ9",
  "number": 25227,
  "title": "Temp files generated during DAG generation won't cleanup properly.",
  "user": {
    "login": "manoj398",
    "id": 11410788,
    "node_id": "MDQ6VXNlcjExNDEwNzg4",
    "avatar_url": "https://avatars.githubusercontent.com/u/11410788?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/manoj398",
    "html_url": "https://github.com/manoj398",
    "followers_url": "https://api.github.com/users/manoj398/followers",
    "following_url": "https://api.github.com/users/manoj398/following{/other_user}",
    "gists_url": "https://api.github.com/users/manoj398/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/manoj398/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/manoj398/subscriptions",
    "organizations_url": "https://api.github.com/users/manoj398/orgs",
    "repos_url": "https://api.github.com/users/manoj398/repos",
    "events_url": "https://api.github.com/users/manoj398/events{/privacy}",
    "received_events_url": "https://api.github.com/users/manoj398/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 72233650,
      "node_id": "MDU6TGFiZWw3MjIzMzY1MA==",
      "url": "https://api.github.com/repos/ethereum/go-ethereum/labels/type:bug",
      "name": "type:bug",
      "color": "FF5E5E",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-07-02T13:01:19Z",
  "updated_at": "2022-08-02T12:33:24Z",
  "closed_at": "2022-08-02T12:33:24Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nGeth version: `geth version`\r\nOS & Version: Windows/Linux/OSX\r\nCommit hash : (if `develop`)\r\n\r\n#### Actual behaviour\r\nWhen old instances are cleaned up, here https://github.com/ethereum/go-ethereum/blob/de1cecb22e2a18ad70d4cb92bee122f4549c5b79/consensus/ethash/ethash.go#L279-L283\r\n\r\nIt won't consider any left out temp files generated during the process because they have a different name.\r\n\r\n#### Expected behaviour\r\nAll files needs to be considered that were generated previously.\r\n\r\n#### Steps to reproduce the behaviour\r\nhttps://github.com/ethereum/go-ethereum/blob/de1cecb22e2a18ad70d4cb92bee122f4549c5b79/consensus/ethash/ethash.go#L133\r\n\r\nShutdown the node when DAG is being generated, The temp file generated with the `name + \".\" + randomInteger` would be left out. During the cleanup in the further runs, it won't be considered for removal. The cachecount flag doesn't count such files which is wrong. These files are generally in GBs and waste resources on disk.\r\n\r\n#### Backtrace\r\n\r\n````\r\n[backtrace]\r\n````\r\n\r\nWhen submitting logs: please submit them as text and not screenshots.",
  "closed_by": {
    "login": "fjl",
    "id": 6915,
    "node_id": "MDQ6VXNlcjY5MTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fjl",
    "html_url": "https://github.com/fjl",
    "followers_url": "https://api.github.com/users/fjl/followers",
    "following_url": "https://api.github.com/users/fjl/following{/other_user}",
    "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
    "organizations_url": "https://api.github.com/users/fjl/orgs",
    "repos_url": "https://api.github.com/users/fjl/repos",
    "events_url": "https://api.github.com/users/fjl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fjl/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25227/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25227/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1191202496",
    "html_url": "https://github.com/ethereum/go-ethereum/issues/25227#issuecomment-1191202496",
    "issue_url": "https://api.github.com/repos/ethereum/go-ethereum/issues/25227",
    "id": 1191202496,
    "node_id": "IC_kwDOAOvK985HAE7A",
    "user": {
      "login": "ligi",
      "id": 111600,
      "node_id": "MDQ6VXNlcjExMTYwMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/111600?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ligi",
      "html_url": "https://github.com/ligi",
      "followers_url": "https://api.github.com/users/ligi/followers",
      "following_url": "https://api.github.com/users/ligi/following{/other_user}",
      "gists_url": "https://api.github.com/users/ligi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ligi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ligi/subscriptions",
      "organizations_url": "https://api.github.com/users/ligi/orgs",
      "repos_url": "https://api.github.com/users/ligi/repos",
      "events_url": "https://api.github.com/users/ligi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ligi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-21T08:33:37Z",
    "updated_at": "2022-07-21T08:33:37Z",
    "author_association": "MEMBER",
    "body": "yes - they should be deleted - would you make a PR to do so?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/go-ethereum/issues/comments/1191202496/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
