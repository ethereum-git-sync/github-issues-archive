{
  "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2553",
  "repository_url": "https://api.github.com/repos/ethereum/consensus-specs",
  "labels_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2553/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2553/comments",
  "events_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2553/events",
  "html_url": "https://github.com/ethereum/consensus-specs/issues/2553",
  "id": 971925520,
  "node_id": "MDU6SXNzdWU5NzE5MjU1MjA=",
  "number": 2553,
  "title": "Redundancy in Altair `TIMELY_TARGET` accounting",
  "user": {
    "login": "ralexstokes",
    "id": 3113781,
    "node_id": "MDQ6VXNlcjMxMTM3ODE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3113781?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ralexstokes",
    "html_url": "https://github.com/ralexstokes",
    "followers_url": "https://api.github.com/users/ralexstokes/followers",
    "following_url": "https://api.github.com/users/ralexstokes/following{/other_user}",
    "gists_url": "https://api.github.com/users/ralexstokes/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ralexstokes/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ralexstokes/subscriptions",
    "organizations_url": "https://api.github.com/users/ralexstokes/orgs",
    "repos_url": "https://api.github.com/users/ralexstokes/repos",
    "events_url": "https://api.github.com/users/ralexstokes/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ralexstokes/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-08-16T16:54:29Z",
  "updated_at": "2021-08-25T22:04:13Z",
  "closed_at": "2021-08-25T22:04:13Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Consider the timely target accounting in `get_attestation_participation_flag_indices`:\r\n\r\n```python\r\nif is_matching_target and inclusion_delay <= SLOTS_PER_EPOCH:\r\n        participation_flag_indices.append(TIMELY_TARGET_FLAG_INDEX)\r\n```\r\n\r\nThe second condition in this predicate is always `True`: `inclusion_delay` must always be less than or equal to `SLOTS_PER_EPOCH` as per the attestation validity condition seen in `process_attestation`:\r\n\r\n```python\r\nassert data.slot + MIN_ATTESTATION_INCLUSION_DELAY <= state.slot <= data.slot + SLOTS_PER_EPOCH\r\n```\r\n\r\nWhich means that any validator with `is_matching_target` will receive the `TIMELY_TARGET_FLAG_INDEX` for that attestation's epoch.\r\n\r\n\r\nI'm raising this issue for discussion:  ultimately I think there should be no change here but it could be helpful for implementers looking to (micro?)optimize or anyone trying to understand the spec better. We could consider removing the extra conditional as it reduces code volume and thus attack surface, if even only a little. The major arguments in favor of keeping it are (1) the fact that the Altair spec is nearish a \"freeze\" so we can reduce code churn and (2) that it keeps a nice symmetry to this function (the benefit of symmetry is to reduce surprises with the hope that bug-free implementation/reasoning is easier).\r\n",
  "closed_by": {
    "login": "ralexstokes",
    "id": 3113781,
    "node_id": "MDQ6VXNlcjMxMTM3ODE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3113781?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ralexstokes",
    "html_url": "https://github.com/ralexstokes",
    "followers_url": "https://api.github.com/users/ralexstokes/followers",
    "following_url": "https://api.github.com/users/ralexstokes/following{/other_user}",
    "gists_url": "https://api.github.com/users/ralexstokes/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ralexstokes/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ralexstokes/subscriptions",
    "organizations_url": "https://api.github.com/users/ralexstokes/orgs",
    "repos_url": "https://api.github.com/users/ralexstokes/repos",
    "events_url": "https://api.github.com/users/ralexstokes/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ralexstokes/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2553/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2553/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/905907192",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/2553#issuecomment-905907192",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2553",
    "id": 905907192,
    "node_id": "IC_kwDOCOoGbc41_wv4",
    "user": {
      "login": "ralexstokes",
      "id": 3113781,
      "node_id": "MDQ6VXNlcjMxMTM3ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3113781?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ralexstokes",
      "html_url": "https://github.com/ralexstokes",
      "followers_url": "https://api.github.com/users/ralexstokes/followers",
      "following_url": "https://api.github.com/users/ralexstokes/following{/other_user}",
      "gists_url": "https://api.github.com/users/ralexstokes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ralexstokes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ralexstokes/subscriptions",
      "organizations_url": "https://api.github.com/users/ralexstokes/orgs",
      "repos_url": "https://api.github.com/users/ralexstokes/repos",
      "events_url": "https://api.github.com/users/ralexstokes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ralexstokes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-25T22:04:13Z",
    "updated_at": "2021-08-25T22:04:13Z",
    "author_association": "MEMBER",
    "body": "Going to close this and hope it serves as useful historical documentation.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/905907192/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
