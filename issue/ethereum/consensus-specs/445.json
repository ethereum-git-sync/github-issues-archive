{
  "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/445",
  "repository_url": "https://api.github.com/repos/ethereum/consensus-specs",
  "labels_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/445/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/445/comments",
  "events_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/445/events",
  "html_url": "https://github.com/ethereum/consensus-specs/issues/445",
  "id": 399329825,
  "node_id": "MDU6SXNzdWUzOTkzMjk4MjU=",
  "number": 445,
  "title": "Beacon chain operations could be verified with wrong fork_data",
  "user": {
    "login": "mkalinin",
    "id": 1892772,
    "node_id": "MDQ6VXNlcjE4OTI3NzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1892772?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mkalinin",
    "html_url": "https://github.com/mkalinin",
    "followers_url": "https://api.github.com/users/mkalinin/followers",
    "following_url": "https://api.github.com/users/mkalinin/following{/other_user}",
    "gists_url": "https://api.github.com/users/mkalinin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mkalinin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mkalinin/subscriptions",
    "organizations_url": "https://api.github.com/users/mkalinin/orgs",
    "repos_url": "https://api.github.com/users/mkalinin/repos",
    "events_url": "https://api.github.com/users/mkalinin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mkalinin/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2019-01-15T12:47:06Z",
  "updated_at": "2019-01-18T10:41:27Z",
  "closed_at": "2019-01-18T10:41:27Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "### What's wrong\r\nThere is a BLS signature verification in chain operations that is based on `fork_data` taken from state of _current_ slot. \r\n\r\nIf a fork had happened since a slot that operation data does refer to then BLS verification wouldn't be passed and operation would be considered as invalid.\r\n\r\nAffected operations:\r\n- ProposerSlashing\r\n- CasperSlashing\r\n- Attestation\r\n- Exit\r\n\r\n### Probable solution\r\nExplicitly add `fork_data` to `data` records of each operation and pass `data.fork_data` to BLS verification.",
  "closed_by": {
    "login": "mkalinin",
    "id": 1892772,
    "node_id": "MDQ6VXNlcjE4OTI3NzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1892772?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mkalinin",
    "html_url": "https://github.com/mkalinin",
    "followers_url": "https://api.github.com/users/mkalinin/followers",
    "following_url": "https://api.github.com/users/mkalinin/following{/other_user}",
    "gists_url": "https://api.github.com/users/mkalinin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mkalinin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mkalinin/subscriptions",
    "organizations_url": "https://api.github.com/users/mkalinin/orgs",
    "repos_url": "https://api.github.com/users/mkalinin/repos",
    "events_url": "https://api.github.com/users/mkalinin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mkalinin/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/445/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/445/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/454706058",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/445#issuecomment-454706058",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/445",
    "id": 454706058,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NDcwNjA1OA==",
    "user": {
      "login": "hwwhww",
      "id": 9263930,
      "node_id": "MDQ6VXNlcjkyNjM5MzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9263930?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hwwhww",
      "html_url": "https://github.com/hwwhww",
      "followers_url": "https://api.github.com/users/hwwhww/followers",
      "following_url": "https://api.github.com/users/hwwhww/following{/other_user}",
      "gists_url": "https://api.github.com/users/hwwhww/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hwwhww/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hwwhww/subscriptions",
      "organizations_url": "https://api.github.com/users/hwwhww/orgs",
      "repos_url": "https://api.github.com/users/hwwhww/repos",
      "events_url": "https://api.github.com/users/hwwhww/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hwwhww/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-16T09:12:58Z",
    "updated_at": "2019-01-16T09:13:25Z",
    "author_association": "MEMBER",
    "body": "In @djrtwo 's WIP document: https://github.com/ethereum/eth2.0-specs/blob/6b72ae3a3b90b663f28f5637891892aa957d3cd4/specs/validator/0_beacon-chain-validator.md#how-to-avoid-slashing\r\n> _Note_: signed data must be within the same `ForkData` context to conflict. Messages cannot be slashed across forks.\r\n\r\nTo confirm with @djrtwo @vbuterin, does that mean the current spec is correct for `ProposerSlashing` and `CasperSlashing` messages since they *should* be considered as invalid if across forks?\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/454706058/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/454715437",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/445#issuecomment-454715437",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/445",
    "id": 454715437,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NDcxNTQzNw==",
    "user": {
      "login": "mkalinin",
      "id": 1892772,
      "node_id": "MDQ6VXNlcjE4OTI3NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1892772?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mkalinin",
      "html_url": "https://github.com/mkalinin",
      "followers_url": "https://api.github.com/users/mkalinin/followers",
      "following_url": "https://api.github.com/users/mkalinin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mkalinin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mkalinin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mkalinin/subscriptions",
      "organizations_url": "https://api.github.com/users/mkalinin/orgs",
      "repos_url": "https://api.github.com/users/mkalinin/repos",
      "events_url": "https://api.github.com/users/mkalinin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mkalinin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-16T09:43:09Z",
    "updated_at": "2019-01-16T09:43:09Z",
    "author_association": "MEMBER",
    "body": "Does it mean that when `ForkData` context is changed it becomes impossible to slash validator for the violation it made prior to this fork?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/454715437/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/455277573",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/445#issuecomment-455277573",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/445",
    "id": 455277573,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NTI3NzU3Mw==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-17T18:27:36Z",
    "updated_at": "2019-01-17T18:27:36Z",
    "author_association": "MEMBER",
    "body": "Ah, I see. Slashings should be held accountable in the fork in which it was signed and the next. We can do this by ensuring the slot in `get_domain` as the following depending on the data structure:\r\n\r\n* Attestation -- `attestation.data.slot`\r\n    * need to fix sig verification in `verify_slashable_vote_data`\r\n* Proposals -- `proposal_data_2.slot`\r\n    * this looks correct throughout (including in the proposer slashings)\r\n* Exits -- `exit.slot`\r\n    * The current verification looks correct. If an exit is not picked up in the fork in which it was signed, then it could be picked up in the next.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/455277573/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/455277903",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/445#issuecomment-455277903",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/445",
    "id": 455277903,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NTI3NzkwMw==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-17T18:28:35Z",
    "updated_at": "2019-01-17T18:28:35Z",
    "author_association": "MEMBER",
    "body": "and my message in the validator guide is slightly off. It should be that messages can be slashed in chains in which the fork version is the current or immediately subsequent fork.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/455277903/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/455278611",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/445#issuecomment-455278611",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/445",
    "id": 455278611,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NTI3ODYxMQ==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-17T18:30:45Z",
    "updated_at": "2019-01-17T18:30:45Z",
    "author_association": "MEMBER",
    "body": "Seems that there is an implicit timing assumption that two forks that change the fork version won't happen within a single weak subjectivity period (say 4 months).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/455278611/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/455291886",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/445#issuecomment-455291886",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/445",
    "id": 455291886,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NTI5MTg4Ng==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-17T19:06:07Z",
    "updated_at": "2019-01-17T19:06:07Z",
    "author_association": "MEMBER",
    "body": "I fixed the issue in `verify_slashable_vote_data`. I think that is the only one.\r\nAm I missing something?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/455291886/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/455503601",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/445#issuecomment-455503601",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/445",
    "id": 455503601,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NTUwMzYwMQ==",
    "user": {
      "login": "mkalinin",
      "id": 1892772,
      "node_id": "MDQ6VXNlcjE4OTI3NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1892772?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mkalinin",
      "html_url": "https://github.com/mkalinin",
      "followers_url": "https://api.github.com/users/mkalinin/followers",
      "following_url": "https://api.github.com/users/mkalinin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mkalinin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mkalinin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mkalinin/subscriptions",
      "organizations_url": "https://api.github.com/users/mkalinin/orgs",
      "repos_url": "https://api.github.com/users/mkalinin/repos",
      "events_url": "https://api.github.com/users/mkalinin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mkalinin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-18T10:41:27Z",
    "updated_at": "2019-01-18T10:41:27Z",
    "author_association": "MEMBER",
    "body": "> It should be that messages can be slashed in chains in which the fork version is the current or immediately subsequent fork.\r\n> Seems that there is an implicit timing assumption that two forks that change the fork version won't happen within a single weak subjectivity period (say 4 months).\r\n\r\nWith this two assumptions and recent update spec looks good to me. I was a bit confused and thought that `Fork` update in the state changes `get_domain` output which is not true. It must be two subsequent updates to affect this logic.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/455503601/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
