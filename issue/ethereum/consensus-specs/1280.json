{
  "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1280",
  "repository_url": "https://api.github.com/repos/ethereum/consensus-specs",
  "labels_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1280/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1280/comments",
  "events_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1280/events",
  "html_url": "https://github.com/ethereum/consensus-specs/issues/1280",
  "id": 465610423,
  "node_id": "MDU6SXNzdWU0NjU2MTA0MjM=",
  "number": 1280,
  "title": "Rewards on shards",
  "user": {
    "login": "vbuterin",
    "id": 2230894,
    "node_id": "MDQ6VXNlcjIyMzA4OTQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2230894?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vbuterin",
    "html_url": "https://github.com/vbuterin",
    "followers_url": "https://api.github.com/users/vbuterin/followers",
    "following_url": "https://api.github.com/users/vbuterin/following{/other_user}",
    "gists_url": "https://api.github.com/users/vbuterin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vbuterin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vbuterin/subscriptions",
    "organizations_url": "https://api.github.com/users/vbuterin/orgs",
    "repos_url": "https://api.github.com/users/vbuterin/repos",
    "events_url": "https://api.github.com/users/vbuterin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vbuterin/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1170173759,
      "node_id": "MDU6TGFiZWwxMTcwMTczNzU5",
      "url": "https://api.github.com/repos/ethereum/consensus-specs/labels/phase1",
      "name": "phase1",
      "color": "F7C242",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2019-07-09T07:12:10Z",
  "updated_at": "2023-10-21T13:51:32Z",
  "closed_at": "2023-10-21T13:51:32Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "I see the following rewards existing for validators that are members of persistent committees:\r\n\r\n1. Reward for proposing a block\r\n2. Reward for attesting to a block\r\n3. EIP 1559 fee per byte in the block data\r\n\r\nNote that in equilibrium, I fully expect (3) to exceed (1) + (2), so in-shard rewards would be net-negative (overcome by transaction fees, which from the perspective of the base protocol are out-of-band).\r\n\r\nWe have two major possible ways to process these rewards:\r\n\r\n1. Add to the (currently nonexistent but it will have to exist for phase 2 anyway) `ShardState` two arrays representing the net penalties or rewards given to the previous and current period committees, respectively. At the end of a period, add the period committee reward list into the crosslink object (alternatively, provide it into the beacon chain through a separate Merkle branch receipt that links into the crosslink data).\r\n2. Process the rewards/penalties probabilistically, eg. based on future randomness making a random 1/N of shard blocks eligible for inclusion into the beacon chain, where rewards and penalties get calculated.\r\n\r\n(1) gives precise accounting but is stateful. (2) is stateless but gives imprecise accounting. If we set N = 1024, then there will be on average 256 (~ 9 days / 3 seconds / 1024) blocks per period processed per shard. In the worst case, where full proposal committees are of size 4096 (and assuming per-block committees have size 32), this means that on average a validator will see 2 attester rewards, and 1/16 proposer rewards/penalties. This is a potentially unacceptable level of volatility, as unlucky proposers could end up paying unexpectedly large EIP 1559 fees eg. if they get picked twice and during a fee spike...",
  "closed_by": {
    "login": "hwwhww",
    "id": 9263930,
    "node_id": "MDQ6VXNlcjkyNjM5MzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9263930?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hwwhww",
    "html_url": "https://github.com/hwwhww",
    "followers_url": "https://api.github.com/users/hwwhww/followers",
    "following_url": "https://api.github.com/users/hwwhww/following{/other_user}",
    "gists_url": "https://api.github.com/users/hwwhww/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hwwhww/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hwwhww/subscriptions",
    "organizations_url": "https://api.github.com/users/hwwhww/orgs",
    "repos_url": "https://api.github.com/users/hwwhww/repos",
    "events_url": "https://api.github.com/users/hwwhww/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hwwhww/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1280/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1280/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/509609805",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1280#issuecomment-509609805",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1280",
    "id": 509609805,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwOTYwOTgwNQ==",
    "user": {
      "login": "JustinDrake",
      "id": 731743,
      "node_id": "MDQ6VXNlcjczMTc0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/731743?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JustinDrake",
      "html_url": "https://github.com/JustinDrake",
      "followers_url": "https://api.github.com/users/JustinDrake/followers",
      "following_url": "https://api.github.com/users/JustinDrake/following{/other_user}",
      "gists_url": "https://api.github.com/users/JustinDrake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JustinDrake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JustinDrake/subscriptions",
      "organizations_url": "https://api.github.com/users/JustinDrake/orgs",
      "repos_url": "https://api.github.com/users/JustinDrake/repos",
      "events_url": "https://api.github.com/users/JustinDrake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JustinDrake/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-07-09T11:47:42Z",
    "updated_at": "2019-07-09T11:47:42Z",
    "author_association": "MEMBER",
    "body": "Am I understanding EIP1559 correctly in the context of shard blocks where transaction fees are out-of-band?\r\n\r\n```python\r\nTARGET_GAS_USE = 2**23  # 8,388,608 gas\r\nMAX_GAS_USE = 2**2 * TARGET_GAS_USE\r\nGAS_FEE_DELTA_QUOTIENT = 2**3\r\n\r\n# Verify gas use is not too large\r\nassert block.gas_use <= MAX_GAS_USE\r\n# Verify gas fee delta and gas use delta are consistent\r\nparent_gas_fee = shard_state.parent_gas_fee\r\ngas_use_delta = block.gas_use - TARGET_GAS_USE\r\ngas_fee_delta = parent_gas_fee * gas_use_delta // MAX_GAS_USE // GAS_FEE_DELTA_QUOTIENT\r\nif gas_fee_delta == 0 and gas_use_delta != 0:\r\n\tgas_fee_delta = gas_use_delta // abs(gas_use_delta)\r\nassert block.gas_fee = parent_gas_fee + gas_fee_delta\r\n# Burn base fees from proposer\r\nproposer_index = get_shard_proposer_index(state, block.shard, block.slot)\r\nassert state.balances[proposer_index] >= block.gas_fee * block.gas_use\r\ndecrease_shard_balance(state, proposer_index, block.gas_fee * block.gas_use)\r\n# Set parent gas fee\r\nshard_state.parent_gas_fee = block.gas_fee\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/509609805/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/509661079",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1280#issuecomment-509661079",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1280",
    "id": 509661079,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwOTY2MTA3OQ==",
    "user": {
      "login": "vbuterin",
      "id": 2230894,
      "node_id": "MDQ6VXNlcjIyMzA4OTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2230894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vbuterin",
      "html_url": "https://github.com/vbuterin",
      "followers_url": "https://api.github.com/users/vbuterin/followers",
      "following_url": "https://api.github.com/users/vbuterin/following{/other_user}",
      "gists_url": "https://api.github.com/users/vbuterin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vbuterin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vbuterin/subscriptions",
      "organizations_url": "https://api.github.com/users/vbuterin/orgs",
      "repos_url": "https://api.github.com/users/vbuterin/repos",
      "events_url": "https://api.github.com/users/vbuterin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vbuterin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-07-09T14:16:50Z",
    "updated_at": "2019-07-09T14:16:50Z",
    "author_association": "MEMBER",
    "body": "Yep! Looks correct to me.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/509661079/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/623434373",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1280#issuecomment-623434373",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1280",
    "id": 623434373,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMzQzNDM3Mw==",
    "user": {
      "login": "mkalinin",
      "id": 1892772,
      "node_id": "MDQ6VXNlcjE4OTI3NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1892772?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mkalinin",
      "html_url": "https://github.com/mkalinin",
      "followers_url": "https://api.github.com/users/mkalinin/followers",
      "following_url": "https://api.github.com/users/mkalinin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mkalinin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mkalinin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mkalinin/subscriptions",
      "organizations_url": "https://api.github.com/users/mkalinin/orgs",
      "repos_url": "https://api.github.com/users/mkalinin/repos",
      "events_url": "https://api.github.com/users/mkalinin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mkalinin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-04T12:28:28Z",
    "updated_at": "2020-05-04T12:28:28Z",
    "author_association": "MEMBER",
    "body": "Could you explain why do we need to burn fees from proposer? Why it's not subtracted from the balance of `tx.origin` as it's specified by EIP-1559?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/623434373/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1773797572",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1280#issuecomment-1773797572",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1280",
    "id": 1773797572,
    "node_id": "IC_kwDOCOoGbc5pugDE",
    "user": {
      "login": "hwwhww",
      "id": 9263930,
      "node_id": "MDQ6VXNlcjkyNjM5MzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9263930?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hwwhww",
      "html_url": "https://github.com/hwwhww",
      "followers_url": "https://api.github.com/users/hwwhww/followers",
      "following_url": "https://api.github.com/users/hwwhww/following{/other_user}",
      "gists_url": "https://api.github.com/users/hwwhww/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hwwhww/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hwwhww/subscriptions",
      "organizations_url": "https://api.github.com/users/hwwhww/orgs",
      "repos_url": "https://api.github.com/users/hwwhww/repos",
      "events_url": "https://api.github.com/users/hwwhww/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hwwhww/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-21T13:51:32Z",
    "updated_at": "2023-10-21T13:51:32Z",
    "author_association": "MEMBER",
    "body": "closing due to outdated",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1773797572/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
