{
  "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/198",
  "repository_url": "https://api.github.com/repos/ethereum/consensus-specs",
  "labels_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/198/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/198/comments",
  "events_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/198/events",
  "html_url": "https://github.com/ethereum/consensus-specs/issues/198",
  "id": 386253451,
  "node_id": "MDU6SXNzdWUzODYyNTM0NTE=",
  "number": 198,
  "title": "Deposit issues",
  "user": {
    "login": "djrtwo",
    "id": 1433595,
    "node_id": "MDQ6VXNlcjE0MzM1OTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/djrtwo",
    "html_url": "https://github.com/djrtwo",
    "followers_url": "https://api.github.com/users/djrtwo/followers",
    "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
    "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
    "organizations_url": "https://api.github.com/users/djrtwo/orgs",
    "repos_url": "https://api.github.com/users/djrtwo/repos",
    "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/djrtwo/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1063043866,
      "node_id": "MDU6TGFiZWwxMDYzMDQzODY2",
      "url": "https://api.github.com/repos/ethereum/consensus-specs/labels/general:bug",
      "name": "general:bug",
      "color": "DD1C1A",
      "default": false,
      "description": "Something isn't working"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2018-11-30T16:15:54Z",
  "updated_at": "2018-12-04T17:57:22Z",
  "closed_at": "2018-12-04T17:57:22Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "# Issue\r\nThere are some known issues in the current deposit contract and deposit processing. This issue will probably be resolved via a couple of PRs\r\n\r\nKnown issues:\r\n\r\n- [x]  by removing `assert deposit_size == DEPOSIT_SIZE` for the creation of a validator, a user can now create a validator with as little as 1 ETH. This validator would be inducted and immediately be kicked out of the validator set.\r\n- [x] Beyond that, this allows validators to enter the validator set (and begin participating) with as little as 16 ETH. The deposit mechanism should enforce 32 ETH as initial deposit to prevent validators entering with low and risky deposits.\r\n- [x] The deposit contract is incorrectly using `full_deposit_count` to create and broadcast the leaves of the merkle tree. If a `< 32 ETH` deposit is made, it does not update `full_deposit_count` but update the merkle tree, overwriting the previously written leaf.  We need to maintain deposit_count separately from full_deposit_count. deposit_count should be incremented upon every successful deposit, should be used to construct the index into the merkle tree, and should be broadcast in the HashChainValue instead of full_deposit_count.",
  "closed_by": {
    "login": "djrtwo",
    "id": 1433595,
    "node_id": "MDQ6VXNlcjE0MzM1OTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/djrtwo",
    "html_url": "https://github.com/djrtwo",
    "followers_url": "https://api.github.com/users/djrtwo/followers",
    "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
    "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
    "organizations_url": "https://api.github.com/users/djrtwo/orgs",
    "repos_url": "https://api.github.com/users/djrtwo/repos",
    "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/djrtwo/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/198/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/198/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/443434494",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/198#issuecomment-443434494",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/198",
    "id": 443434494,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MzQzNDQ5NA==",
    "user": {
      "login": "vbuterin",
      "id": 2230894,
      "node_id": "MDQ6VXNlcjIyMzA4OTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2230894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vbuterin",
      "html_url": "https://github.com/vbuterin",
      "followers_url": "https://api.github.com/users/vbuterin/followers",
      "following_url": "https://api.github.com/users/vbuterin/following{/other_user}",
      "gists_url": "https://api.github.com/users/vbuterin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vbuterin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vbuterin/subscriptions",
      "organizations_url": "https://api.github.com/users/vbuterin/orgs",
      "repos_url": "https://api.github.com/users/vbuterin/repos",
      "events_url": "https://api.github.com/users/vbuterin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vbuterin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-01T15:33:45Z",
    "updated_at": "2018-12-01T15:33:45Z",
    "author_association": "MEMBER",
    "body": "> by removing assert deposit_size == DEPOSIT_SIZE for the creation of a validator, a user can now create a validator with as little as 1 ETH. This validator would be inducted and immediately be kicked out of the validator set.\r\n\r\nIs this *that bad*? Their ETH is just stuck and they'll get it out in phase 2\r\n\r\n>Beyond that, this allows validators to enter the validator set (and begin participating) with as little as 16 ETH. The deposit mechanism should enforce 32 ETH as initial deposit to prevent validators entering with low and risky deposits.\r\n\r\nI'm inclined to agree. I don't think the deposit contract needs to be too paternalistic; it's already (unavoidably) possible to deposit with a bad randao preimage, for example; we could just make deposits fail if they have less than 32 ETH.\r\n\r\n> The deposit contract is incorrectly using full_deposit_count to create and broadcast the leaves of the merkle tree. If a < 32 ETH deposit is made, it does not update full_deposit_count but update the merkle tree, overwriting the previously written leaf. We need to maintain deposit_count separately from full_deposit_count. deposit_count should be incremented upon every successful deposit, should be used to construct the index into the merkle tree, and should be broadcast in the HashChainValue instead of full_deposit_count.\r\n\r\nAgree!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/443434494/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/443829755",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/198#issuecomment-443829755",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/198",
    "id": 443829755,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MzgyOTc1NQ==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-03T19:04:57Z",
    "updated_at": "2018-12-03T19:05:36Z",
    "author_association": "MEMBER",
    "body": "> we could just make deposits fail if they have less than 32 ETH.\r\n\r\nI'm inclined to go this route. If less than 32 eth and no existing validator for the pubkey, then fail.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/443829755/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/444195538",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/198#issuecomment-444195538",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/198",
    "id": 444195538,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NDE5NTUzOA==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-04T17:57:22Z",
    "updated_at": "2018-12-04T17:57:22Z",
    "author_association": "MEMBER",
    "body": "addressed in #228 ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/444195538/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
