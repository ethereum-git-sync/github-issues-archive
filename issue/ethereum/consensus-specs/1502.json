{
  "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1502",
  "repository_url": "https://api.github.com/repos/ethereum/consensus-specs",
  "labels_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1502/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1502/comments",
  "events_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1502/events",
  "html_url": "https://github.com/ethereum/consensus-specs/issues/1502",
  "id": 532806620,
  "node_id": "MDU6SXNzdWU1MzI4MDY2MjA=",
  "number": 1502,
  "title": "genesis_time in relation to GENESIS_EPOCH and GENESIS_SLOT",
  "user": {
    "login": "ericsson49",
    "id": 10426192,
    "node_id": "MDQ6VXNlcjEwNDI2MTky",
    "avatar_url": "https://avatars.githubusercontent.com/u/10426192?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ericsson49",
    "html_url": "https://github.com/ericsson49",
    "followers_url": "https://api.github.com/users/ericsson49/followers",
    "following_url": "https://api.github.com/users/ericsson49/following{/other_user}",
    "gists_url": "https://api.github.com/users/ericsson49/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ericsson49/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ericsson49/subscriptions",
    "organizations_url": "https://api.github.com/users/ericsson49/orgs",
    "repos_url": "https://api.github.com/users/ericsson49/repos",
    "events_url": "https://api.github.com/users/ericsson49/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ericsson49/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1324776822,
      "node_id": "MDU6TGFiZWwxMzI0Nzc2ODIy",
      "url": "https://api.github.com/repos/ethereum/consensus-specs/labels/scope:fork-choice",
      "name": "scope:fork-choice",
      "color": "81C7D4",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2019-12-04T16:46:45Z",
  "updated_at": "2019-12-10T20:47:46Z",
  "closed_at": "2019-12-10T20:47:46Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Beacon chain [specification](https://github.com/ethereum/eth2.0-specs/blob/dev/specs/core/0_beacon-chain.md#initial-values) defines `GENESIS_SLOT` and `GENESIS_EPOCH` constants., but doesn't specify how they are related to `genesis_time`.\r\nIntuitively, `genesis_time` should be equal to the `GENESIS_SLOT` start time (and `GENESIS_EPOCH` should be the epoch of `GENESIS_SLOT`).\r\nHowever, [fork choice](https://github.com/ethereum/eth2.0-specs/blob/dev/specs/core/0_fork-choice.md) calculates time ignoring `GENESIS_SLOT`.\r\nIt could be possible though that [get_current_slot](https://github.com/ethereum/eth2.0-specs/blob/dev/specs/core/0_fork-choice.md#get_current_slot) actually specifies the right way to convert time to a slot value (so that `genesis_time` means start time of `Slot(0)`).\r\n\r\nThere is no problem, if `GENESIS_SLOT` and `GENESIS_EPOCH` are zeros (and always will be), as they currently are. However, if it's admissible that `GENESIS_SLOT`/`GENESIS_EPOCH` change in future, then there can be problems with the beacon chain spec and/or with its implementations.\r\nOverall, it's not clear now what is the right way to convert time to a slot number, i.e. should `GENESIS_SLOT` be added or not. While, it's trivial to implement, if 'GENESIS_SLOT` changes, it can be quite troublesome to verify that all the necessary updates are really performed.\r\n\r\nBecause of the above, we propose to clarify explicitly in the specification:\r\n- whether `GENESIS_SLOT`/`GENESIS_EPOCH` are expected to change in future, or they are just symbolic names for `0` and never going to have a different value\r\n- if it is admissible that `GENESIS_SLOT` can change for any reason, then the specification should clarify whether `genesis_time` corresponds to the start of `Slot(0)` or to the start of `GENESIS_SLOT`\r\n\r\nAdditionally, we propose to modify the [fork choice](https://github.com/ethereum/eth2.0-specs/blob/dev/specs/core/0_fork-choice.md) spec, so that it uses `slot` instead of `time`. I.e. replace `Store.time` with `Store.slot` and `on_tick(store, time)` with `on_tick(store, slot)` (and other related changes). Basically, the `Store.time` is only used to detect whether a block/attestation is too early/too late or in-time, and current slot can be used for the same purpose.\r\nThis will get rid of the problem with `GENESIS_SLOT` entirely, in the context of the fork choice (sub)spec. But the problem remains for the purpose of time-to-slot conversion, of course. Additionally, it will simplify the on_block/on_attestation code and make it a bit more readable.\r\nWe can provide a Pull Request with the proposed fork choice modification, if needed.",
  "closed_by": {
    "login": "protolambda",
    "id": 19571989,
    "node_id": "MDQ6VXNlcjE5NTcxOTg5",
    "avatar_url": "https://avatars.githubusercontent.com/u/19571989?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/protolambda",
    "html_url": "https://github.com/protolambda",
    "followers_url": "https://api.github.com/users/protolambda/followers",
    "following_url": "https://api.github.com/users/protolambda/following{/other_user}",
    "gists_url": "https://api.github.com/users/protolambda/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/protolambda/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/protolambda/subscriptions",
    "organizations_url": "https://api.github.com/users/protolambda/orgs",
    "repos_url": "https://api.github.com/users/protolambda/repos",
    "events_url": "https://api.github.com/users/protolambda/events{/privacy}",
    "received_events_url": "https://api.github.com/users/protolambda/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1502/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1502/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/562541053",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1502#issuecomment-562541053",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1502",
    "id": 562541053,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MjU0MTA1Mw==",
    "user": {
      "login": "ericsson49",
      "id": 10426192,
      "node_id": "MDQ6VXNlcjEwNDI2MTky",
      "avatar_url": "https://avatars.githubusercontent.com/u/10426192?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ericsson49",
      "html_url": "https://github.com/ericsson49",
      "followers_url": "https://api.github.com/users/ericsson49/followers",
      "following_url": "https://api.github.com/users/ericsson49/following{/other_user}",
      "gists_url": "https://api.github.com/users/ericsson49/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ericsson49/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ericsson49/subscriptions",
      "organizations_url": "https://api.github.com/users/ericsson49/orgs",
      "repos_url": "https://api.github.com/users/ericsson49/repos",
      "events_url": "https://api.github.com/users/ericsson49/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ericsson49/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-06T11:42:18Z",
    "updated_at": "2019-12-06T11:42:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "@mkalinin also found a bug related to slot/time conversion, so I add as a comment here instead of opening a new issue.\r\n[on_attestation](https://github.com/ethereum/eth2.0-specs/blob/dev/specs/core/0_fork-choice.md#on_attestation) methods doesn't add `genesis_time` at one point, when calculated slot time:\r\n```\r\n# Attestations can only affect the fork choice of subsequent slots.\r\n# Delay consideration in the fork choice until their slot is in the past.\r\nassert store.time >= (attestation.data.slot + 1) * SECONDS_PER_SLOT\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/562541053/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/563511068",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1502#issuecomment-563511068",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1502",
    "id": 563511068,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2MzUxMTA2OA==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-10T00:59:47Z",
    "updated_at": "2019-12-10T00:59:47Z",
    "author_association": "MEMBER",
    "body": "addressing this. Agree that assuming `GENESIS_SLOT` is zero here is slightly dangerous depending on network configurations in the future",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/563511068/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/564251018",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1502#issuecomment-564251018",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1502",
    "id": 564251018,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NDI1MTAxOA==",
    "user": {
      "login": "protolambda",
      "id": 19571989,
      "node_id": "MDQ6VXNlcjE5NTcxOTg5",
      "avatar_url": "https://avatars.githubusercontent.com/u/19571989?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/protolambda",
      "html_url": "https://github.com/protolambda",
      "followers_url": "https://api.github.com/users/protolambda/followers",
      "following_url": "https://api.github.com/users/protolambda/following{/other_user}",
      "gists_url": "https://api.github.com/users/protolambda/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/protolambda/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/protolambda/subscriptions",
      "organizations_url": "https://api.github.com/users/protolambda/orgs",
      "repos_url": "https://api.github.com/users/protolambda/repos",
      "events_url": "https://api.github.com/users/protolambda/events{/privacy}",
      "received_events_url": "https://api.github.com/users/protolambda/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-10T20:47:46Z",
    "updated_at": "2019-12-10T20:47:46Z",
    "author_association": "MEMBER",
    "body": "Closed by #1510 ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/564251018/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
