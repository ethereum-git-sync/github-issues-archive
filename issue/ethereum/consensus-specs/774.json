{
  "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/774",
  "repository_url": "https://api.github.com/repos/ethereum/consensus-specs",
  "labels_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/774/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/774/comments",
  "events_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/774/events",
  "html_url": "https://github.com/ethereum/consensus-specs/issues/774",
  "id": 420871606,
  "node_id": "MDU6SXNzdWU0MjA4NzE2MDY=",
  "number": 774,
  "title": "Correct swap direction when permuting a list",
  "user": {
    "login": "mkalinin",
    "id": 1892772,
    "node_id": "MDQ6VXNlcjE4OTI3NzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1892772?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mkalinin",
    "html_url": "https://github.com/mkalinin",
    "followers_url": "https://api.github.com/users/mkalinin/followers",
    "following_url": "https://api.github.com/users/mkalinin/following{/other_user}",
    "gists_url": "https://api.github.com/users/mkalinin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mkalinin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mkalinin/subscriptions",
    "organizations_url": "https://api.github.com/users/mkalinin/orgs",
    "repos_url": "https://api.github.com/users/mkalinin/repos",
    "events_url": "https://api.github.com/users/mkalinin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mkalinin/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1063043868,
      "node_id": "MDU6TGFiZWwxMDYzMDQzODY4",
      "url": "https://api.github.com/repos/ethereum/consensus-specs/labels/general:enhancement",
      "name": "general:enhancement",
      "color": "086788",
      "default": false,
      "description": "New feature or request"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2019-03-14T07:39:57Z",
  "updated_at": "2019-03-28T23:00:25Z",
  "closed_at": "2019-03-28T23:00:25Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "### Problem\r\nThere is a difference between @protolambda's optimised list shuffling and `get_shuffling` method in the spec. This difference is in the way permuted index is applied in order to get a shuffled list.\r\n```python\r\n# spec:\r\noutput[i] = input[permuted(i)]\r\n# protolamba:\r\noutput[permuted(i)] = input[i]\r\n```\r\nBoth approaches seem to work well. But we need a consensus here.\r\nAs for me `output[permuted(i)] = input[i]` looks like a right direction cause then `permute(index, value)` can be written as `(permute(index), value)`.\r\n\r\nWhat do you guys think about that?\r\n",
  "closed_by": {
    "login": "JustinDrake",
    "id": 731743,
    "node_id": "MDQ6VXNlcjczMTc0Mw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/731743?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/JustinDrake",
    "html_url": "https://github.com/JustinDrake",
    "followers_url": "https://api.github.com/users/JustinDrake/followers",
    "following_url": "https://api.github.com/users/JustinDrake/following{/other_user}",
    "gists_url": "https://api.github.com/users/JustinDrake/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/JustinDrake/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/JustinDrake/subscriptions",
    "organizations_url": "https://api.github.com/users/JustinDrake/orgs",
    "repos_url": "https://api.github.com/users/JustinDrake/repos",
    "events_url": "https://api.github.com/users/JustinDrake/events{/privacy}",
    "received_events_url": "https://api.github.com/users/JustinDrake/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/774/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/774/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/472750460",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/774#issuecomment-472750460",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/774",
    "id": 472750460,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3Mjc1MDQ2MA==",
    "user": {
      "login": "protolambda",
      "id": 19571989,
      "node_id": "MDQ6VXNlcjE5NTcxOTg5",
      "avatar_url": "https://avatars.githubusercontent.com/u/19571989?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/protolambda",
      "html_url": "https://github.com/protolambda",
      "followers_url": "https://api.github.com/users/protolambda/followers",
      "following_url": "https://api.github.com/users/protolambda/following{/other_user}",
      "gists_url": "https://api.github.com/users/protolambda/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/protolambda/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/protolambda/subscriptions",
      "organizations_url": "https://api.github.com/users/protolambda/orgs",
      "repos_url": "https://api.github.com/users/protolambda/repos",
      "events_url": "https://api.github.com/users/protolambda/events{/privacy}",
      "received_events_url": "https://api.github.com/users/protolambda/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-14T08:27:19Z",
    "updated_at": "2019-03-14T08:27:19Z",
    "author_association": "MEMBER",
    "body": "Note that it's shuffling the input list in-place, see: https://github.com/protolambda/eth2-shuffle/blob/fd840f1036c1f8f6d7625ffe6ff4d9c60f942876/shuffle_test.go#L103\r\n\r\nAdmittedly, it's a big source of confusion in testing, but it the algorithm is still correct. \r\nI.e. the input list is shuffled to become the output list.\r\nSo when you're reading `input[i]` after executing the shuffle, it's actually `original_input[unpermuted(i)]`.\r\n\r\nThe thing is, I am applying and testing it with my semantic interpretation: \"permute-index returns the permuted, i.e. the new position, for any given original list position\", and then it places this validator at this new position.\r\n\r\nThe spec seems to intepret it differently: \"permute index returns the original input position for any index in the output list\", and then it fetches the validator from the original input.\r\n\r\nI think my interpretation makes more sense when you're talking about \"permuting\". It's a change of the list.\r\nBut I like the approach of the spec better,  because it makes it easy to reason about the subset of indices you're interested in, e.g. if you're looking for 1 particular validator or committee, you just query these indices, and get the corresponding validators.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/472750460/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/477801654",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/774#issuecomment-477801654",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/774",
    "id": 477801654,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NzgwMTY1NA==",
    "user": {
      "login": "JustinDrake",
      "id": 731743,
      "node_id": "MDQ6VXNlcjczMTc0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/731743?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JustinDrake",
      "html_url": "https://github.com/JustinDrake",
      "followers_url": "https://api.github.com/users/JustinDrake/followers",
      "following_url": "https://api.github.com/users/JustinDrake/following{/other_user}",
      "gists_url": "https://api.github.com/users/JustinDrake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JustinDrake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JustinDrake/subscriptions",
      "organizations_url": "https://api.github.com/users/JustinDrake/orgs",
      "repos_url": "https://api.github.com/users/JustinDrake/repos",
      "events_url": "https://api.github.com/users/JustinDrake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JustinDrake/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-28T23:00:25Z",
    "updated_at": "2019-03-28T23:00:25Z",
    "author_association": "MEMBER",
    "body": "I think this is addressed in #776. Please reopen if not :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/477801654/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
