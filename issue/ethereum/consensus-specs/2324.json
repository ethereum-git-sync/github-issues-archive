{
  "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2324",
  "repository_url": "https://api.github.com/repos/ethereum/consensus-specs",
  "labels_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2324/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2324/comments",
  "events_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2324/events",
  "html_url": "https://github.com/ethereum/consensus-specs/issues/2324",
  "id": 855528195,
  "node_id": "MDU6SXNzdWU4NTU1MjgxOTU=",
  "number": 2324,
  "title": "SignedContributionAndProof gossip validation does not check validator is in subcommittee",
  "user": {
    "login": "ajsutton",
    "id": 72675,
    "node_id": "MDQ6VXNlcjcyNjc1",
    "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ajsutton",
    "html_url": "https://github.com/ajsutton",
    "followers_url": "https://api.github.com/users/ajsutton/followers",
    "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
    "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
    "organizations_url": "https://api.github.com/users/ajsutton/orgs",
    "repos_url": "https://api.github.com/users/ajsutton/repos",
    "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ajsutton/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-04-12T04:22:57Z",
  "updated_at": "2021-04-22T18:39:40Z",
  "closed_at": "2021-04-22T18:39:40Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "The honest validator spec says that each slot members of each subcommittee are selected to aggregate (https://github.com/ethereum/eth2.0-specs/blob/dev/specs/altair/validator.md#sync-committee-contributions).  My understanding is that validators would only check if they are an aggregator for the subcommittees they are in, not all subcommittees.\r\n\r\nBut the gossip validation only checks that the aggregator's validator index is within the current sync committee, not the specific subcommittee (https://github.com/ethereum/eth2.0-specs/blob/dev/specs/altair/p2p-interface.md#sync_committee_contribution_and_proof):\r\n>[REJECT] The aggregator's validator index is within the current sync committee -- i.e. state.validators[contribution_and_proof.aggregator_index].pubkey in state.current_sync_committee.pubkeys.\r\n\r\nI believe it should be checking that the aggregator's pub key is in the sublist of `state.current_sync_committee.pubkeys` that pertains to `contribution.subcommittee_index`.  So something like `state.current_sync_commitee.pubkeys[subcommitteeIndex * (SYNC_COMMITTEE_SIZE // SYNC_COMMITTEE_SUBNET_COUNT):(subcommitteeIndex + 1) * (SYNC_COMMITTEE_SIZE // SYNC_COMMITTEE_SUBNET_COUNT)` and I really hope there's a nicer way to write that in python.",
  "closed_by": {
    "login": "djrtwo",
    "id": 1433595,
    "node_id": "MDQ6VXNlcjE0MzM1OTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/djrtwo",
    "html_url": "https://github.com/djrtwo",
    "followers_url": "https://api.github.com/users/djrtwo/followers",
    "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
    "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
    "organizations_url": "https://api.github.com/users/djrtwo/orgs",
    "repos_url": "https://api.github.com/users/djrtwo/repos",
    "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/djrtwo/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2324/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2324/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/818081013",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/2324#issuecomment-818081013",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2324",
    "id": 818081013,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxODA4MTAxMw==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-12T19:39:32Z",
    "updated_at": "2021-04-12T19:39:32Z",
    "author_association": "MEMBER",
    "body": "yes you are correct on this. thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/818081013/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/818370688",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/2324#issuecomment-818370688",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2324",
    "id": 818370688,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxODM3MDY4OA==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-13T01:46:43Z",
    "updated_at": "2021-04-13T01:46:43Z",
    "author_association": "MEMBER",
    "body": "A few more notes about the sync contribution gossip conditions: \r\n\r\n> contribution_and_proof.selection_proof selects the validator as an aggregator for the slot -- i.e. is_sync_committee_aggregator(state, contribution.slot, contribution_and_proof.selection_proof)\r\n\r\nThis condition is off. Incorrect function signature\r\n\r\n> [IGNORE] The sync committee contribution is the first valid contribution received for the aggregator with index contribution_and_proof.aggregator_index for the slot contribution.slot.\r\n\r\nThis should also be subcommittee specific because the aggregator can be selected across multiple sub committees and it's an independent job\r\n\r\nalso, the bits set in this message should only be for the sub-committee. Otherwise, if we allow for inclusion outside the subcommittee, it would hurt aggregatability of separate subcommittee contributions. We actually assume this property in the following statement from validator guide block proposal:\r\n\r\n> Proposers should select the best contribution seen across all aggregators for each subnet/subcommittee when preparing a block",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/818370688/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/818372465",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/2324#issuecomment-818372465",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2324",
    "id": 818372465,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxODM3MjQ2NQ==",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-13T01:51:48Z",
    "updated_at": "2021-04-13T01:51:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "> also, the bits set in this message should only be for the sub-committee. Otherwise, if we allow for inclusion outside the subcommittee, it would hurt aggregatability of separate subcommittee contributions.\r\n\r\nIsn't that true by definition? From https://github.com/ethereum/eth2.0-specs/blob/dev/specs/altair/validator.md#aggregation-bits:\r\n```\r\nLet contribution.aggregation_bits be a Bitvector[SYNC_COMMITTEE_SIZE // SYNC_COMMITTEE_SUBNET_COUNT], where the indexth bit is set in the Bitvector for each corresponding validator included in this aggregate from the corresponding subcommittee.\r\n```\r\n\r\nSo bit 0 is the first validator in the subcommittee and the last bit in the vector is the last validator in the subcommittee.  Validators from other subcommittees don't have a bit representing them at all.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/818372465/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/818373865",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/2324#issuecomment-818373865",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2324",
    "id": 818373865,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxODM3Mzg2NQ==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-13T01:55:41Z",
    "updated_at": "2021-04-13T01:55:41Z",
    "author_association": "MEMBER",
    "body": "it is! \r\n\r\nsorry, we had 1024 bit length at some point but reduced",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/818373865/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
