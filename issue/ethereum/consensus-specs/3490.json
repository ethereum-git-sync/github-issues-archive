{
  "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/3490",
  "repository_url": "https://api.github.com/repos/ethereum/consensus-specs",
  "labels_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/3490/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/3490/comments",
  "events_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/3490/events",
  "html_url": "https://github.com/ethereum/consensus-specs/issues/3490",
  "id": 1863996861,
  "node_id": "I_kwDOCOoGbc5vGlW9",
  "number": 3490,
  "title": "[Discussion] Mplex future",
  "user": {
    "login": "jxs",
    "id": 1204690,
    "node_id": "MDQ6VXNlcjEyMDQ2OTA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1204690?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jxs",
    "html_url": "https://github.com/jxs",
    "followers_url": "https://api.github.com/users/jxs/followers",
    "following_url": "https://api.github.com/users/jxs/following{/other_user}",
    "gists_url": "https://api.github.com/users/jxs/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jxs/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jxs/subscriptions",
    "organizations_url": "https://api.github.com/users/jxs/orgs",
    "repos_url": "https://api.github.com/users/jxs/repos",
    "events_url": "https://api.github.com/users/jxs/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jxs/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1295438707,
      "node_id": "MDU6TGFiZWwxMjk1NDM4NzA3",
      "url": "https://api.github.com/repos/ethereum/consensus-specs/labels/scope:networking",
      "name": "scope:networking",
      "color": "F596AA",
      "default": false,
      "description": ""
    },
    {
      "id": 1393665613,
      "node_id": "MDU6TGFiZWwxMzkzNjY1NjEz",
      "url": "https://api.github.com/repos/ethereum/consensus-specs/labels/scope:libp2p",
      "name": "scope:libp2p",
      "color": "CA7A2C",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2023-08-23T20:53:25Z",
  "updated_at": "2023-09-06T15:55:37Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Mplex is currently the main multiplexing protocol supported by all Ethereum consensus clients, while yamux `MAY` be supported:\r\nhttps://github.com/ethereum/consensus-specs/blob/e3a939e439d6c05356c9c29c5cd347384180bc01/specs/phase0/p2p-interface.md?plain=1#L164-L167\r\n\r\nLibp2p is [deprecating Mplex on libp2p](https://github.com/libp2p/specs/issues/553) [ยน](https://github.com/libp2p/blog/issues/106) and making yamux the main and the only multiplexer for TCP. \r\n\r\n- `Lighthouse` [already supports yamux](https://github.com/sigp/lighthouse/blob/stable/beacon_node/lighthouse_network/src/service/utils.rs#L62-L64)\r\n- `Prysm` already supports it and [has recently made it the first choice for multiplexing](https://github.com/prysmaticlabs/prysm/pull/12502/files)\r\n- `Nimbus` [has recently added yamux support](https://github.com/status-im/nimbus-eth2/pull/5080)\r\n- `Lodestar` [has a PR open with yamux support](https://github.com/ChainSafe/lodestar/pull/5886)\r\n- `Teku` [has a PR open with yamux support](https://github.com/Consensys/teku/pull/7437)\r\n\r\nWith that in mind, should we update the spec to swap `Mplex` to `MAY` support and yamux to `MUST` support?\r\n\r\n ",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/3490/reactions",
    "total_count": 4,
    "+1": 4,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/3490/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1690733066",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/3490#issuecomment-1690733066",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/3490",
    "id": 1690733066,
    "node_id": "IC_kwDOCOoGbc5kxooK",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-23T22:36:34Z",
    "updated_at": "2023-08-23T22:36:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yep, I think the plan is to deprecate mplex once all the client teams have full support and prioritize it. Hopefully we can get this done before the next hard fork.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1690733066/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1691017101",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/3490#issuecomment-1691017101",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/3490",
    "id": 1691017101,
    "node_id": "IC_kwDOCOoGbc5kyt-N",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-24T05:17:19Z",
    "updated_at": "2023-08-24T05:17:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "Other clients can chime in, but I think we might only get yamux fully supported and tested after deneb across all clients. So we will have to maintain mplex for a while. For that reason `mplex` will still need to be a `MUST` for now. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1691017101/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1691058751",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/3490#issuecomment-1691058751",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/3490",
    "id": 1691058751,
    "node_id": "IC_kwDOCOoGbc5ky4I_",
    "user": {
      "login": "arnetheduck",
      "id": 1382986,
      "node_id": "MDQ6VXNlcjEzODI5ODY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1382986?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arnetheduck",
      "html_url": "https://github.com/arnetheduck",
      "followers_url": "https://api.github.com/users/arnetheduck/followers",
      "following_url": "https://api.github.com/users/arnetheduck/following{/other_user}",
      "gists_url": "https://api.github.com/users/arnetheduck/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arnetheduck/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arnetheduck/subscriptions",
      "organizations_url": "https://api.github.com/users/arnetheduck/orgs",
      "repos_url": "https://api.github.com/users/arnetheduck/repos",
      "events_url": "https://api.github.com/users/arnetheduck/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arnetheduck/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-24T06:08:36Z",
    "updated_at": "2023-08-24T06:08:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "+1 for the hf after deneb. Practically, I envision clients will first support yamux then prefer it then mplex will finally be removed, resulting in a gradual migration.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1691058751/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1692344668",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/3490#issuecomment-1692344668",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/3490",
    "id": 1692344668,
    "node_id": "IC_kwDOCOoGbc5k3yFc",
    "user": {
      "login": "p-shahi",
      "id": 50885601,
      "node_id": "MDQ6VXNlcjUwODg1NjAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/50885601?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/p-shahi",
      "html_url": "https://github.com/p-shahi",
      "followers_url": "https://api.github.com/users/p-shahi/followers",
      "following_url": "https://api.github.com/users/p-shahi/following{/other_user}",
      "gists_url": "https://api.github.com/users/p-shahi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/p-shahi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/p-shahi/subscriptions",
      "organizations_url": "https://api.github.com/users/p-shahi/orgs",
      "repos_url": "https://api.github.com/users/p-shahi/repos",
      "events_url": "https://api.github.com/users/p-shahi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/p-shahi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-24T20:12:51Z",
    "updated_at": "2023-08-24T20:12:51Z",
    "author_association": "NONE",
    "body": "> Protocol Labs is [deprecating Mplex on libp2p](https://github.com/libp2p/specs/issues/553) [ยน](https://github.com/libp2p/blog/issues/106) and making yamux the main and the only multiplexer for TCP.\r\n\r\n@jxs nit but an important one, any chance you can change s/\"Protocol Labs\"/\"different implementations like go, rust, and js-libp2p are\" as PL =/= the different implementations \r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1692344668/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1692350173",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/3490#issuecomment-1692350173",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/3490",
    "id": 1692350173,
    "node_id": "IC_kwDOCOoGbc5k3zbd",
    "user": {
      "login": "arnetheduck",
      "id": 1382986,
      "node_id": "MDQ6VXNlcjEzODI5ODY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1382986?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arnetheduck",
      "html_url": "https://github.com/arnetheduck",
      "followers_url": "https://api.github.com/users/arnetheduck/followers",
      "following_url": "https://api.github.com/users/arnetheduck/following{/other_user}",
      "gists_url": "https://api.github.com/users/arnetheduck/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arnetheduck/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arnetheduck/subscriptions",
      "organizations_url": "https://api.github.com/users/arnetheduck/orgs",
      "repos_url": "https://api.github.com/users/arnetheduck/repos",
      "events_url": "https://api.github.com/users/arnetheduck/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arnetheduck/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-24T20:17:39Z",
    "updated_at": "2023-08-24T20:17:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "> nit\r\n\r\nthis is a libp2p spec deprecation first and foremost and PL maintains the spec - implementations follow, but they are not driving the deprecation in this case",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1692350173/reactions",
      "total_count": 3,
      "+1": 1,
      "-1": 2,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1692514843",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/3490#issuecomment-1692514843",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/3490",
    "id": 1692514843,
    "node_id": "IC_kwDOCOoGbc5k4bob",
    "user": {
      "login": "jxs",
      "id": 1204690,
      "node_id": "MDQ6VXNlcjEyMDQ2OTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1204690?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jxs",
      "html_url": "https://github.com/jxs",
      "followers_url": "https://api.github.com/users/jxs/followers",
      "following_url": "https://api.github.com/users/jxs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jxs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jxs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jxs/subscriptions",
      "organizations_url": "https://api.github.com/users/jxs/orgs",
      "repos_url": "https://api.github.com/users/jxs/repos",
      "events_url": "https://api.github.com/users/jxs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jxs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-24T22:51:54Z",
    "updated_at": "2023-08-24T22:51:54Z",
    "author_association": "NONE",
    "body": "> > Protocol Labs is [deprecating Mplex on libp2p](https://github.com/libp2p/specs/issues/553) [ยน](https://github.com/libp2p/blog/issues/106) and making yamux the main and the only multiplexer for TCP.\n> \n> @jxs nit but an important one, any chance you can change s/\"Protocol Labs\"/\"different implementations like go, rust, and js-libp2p are\" as PL =/= the different implementations \n> \n> \n\nThanks for the suggestion Prithvi, updated it",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1692514843/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1707851040",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/3490#issuecomment-1707851040",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/3490",
    "id": 1707851040,
    "node_id": "IC_kwDOCOoGbc5ly70g",
    "user": {
      "login": "Menduist",
      "id": 13471753,
      "node_id": "MDQ6VXNlcjEzNDcxNzUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/13471753?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Menduist",
      "html_url": "https://github.com/Menduist",
      "followers_url": "https://api.github.com/users/Menduist/followers",
      "following_url": "https://api.github.com/users/Menduist/following{/other_user}",
      "gists_url": "https://api.github.com/users/Menduist/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Menduist/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Menduist/subscriptions",
      "organizations_url": "https://api.github.com/users/Menduist/orgs",
      "repos_url": "https://api.github.com/users/Menduist/repos",
      "events_url": "https://api.github.com/users/Menduist/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Menduist/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-06T07:55:01Z",
    "updated_at": "2023-09-06T07:55:48Z",
    "author_association": "NONE",
    "body": "Besides requiring stable yamux support in all implementation, the underlying libp2ps require a clever mechanism (which is not part of the specs) to have the same performance as mplex with more than 256kb in flight on a specific stream.\r\nAFAIK, only go supports this mechanism: https://github.com/libp2p/go-yamux/pull/54\r\n\r\nUsing yamux without this mechanism would cause an extra ~500ms delay on block propagation when they are >256kb, which we can expect from deneb\r\n\r\nAs long as this is not resolved, we shouldn't switch, imo\r\nmplex is harder to work with, because of the lack of stream backpressure, but we already dealt with that, so let's not \"move fast and break things\" just to please some urge to clean a github repo",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1707851040/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1708654258",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/3490#issuecomment-1708654258",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/3490",
    "id": 1708654258,
    "node_id": "IC_kwDOCOoGbc5l1_6y",
    "user": {
      "login": "Menduist",
      "id": 13471753,
      "node_id": "MDQ6VXNlcjEzNDcxNzUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/13471753?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Menduist",
      "html_url": "https://github.com/Menduist",
      "followers_url": "https://api.github.com/users/Menduist/followers",
      "following_url": "https://api.github.com/users/Menduist/following{/other_user}",
      "gists_url": "https://api.github.com/users/Menduist/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Menduist/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Menduist/subscriptions",
      "organizations_url": "https://api.github.com/users/Menduist/orgs",
      "repos_url": "https://api.github.com/users/Menduist/repos",
      "events_url": "https://api.github.com/users/Menduist/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Menduist/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-06T15:53:13Z",
    "updated_at": "2023-09-06T15:55:37Z",
    "author_association": "NONE",
    "body": "And FWIW I agree with @arnetheduck, how can you say that the push to switch to yamux is coming from the libp2p implementations, when more than half of them don't have even a stable yamux yet @p-shahi?\r\n(my definition of stable being \"ran in prod for a few months\")\r\n\r\nWhile I appreciate the fact that thanks to the deprecation, things are starting to move towards yamux, this is very done very hastily, without consideration for networks with multiple libp2ps, and a big step back in term of libp2p interoperability.\r\n\r\n(sorry for the off-topic)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/1708654258/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
