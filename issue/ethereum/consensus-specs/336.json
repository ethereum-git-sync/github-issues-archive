{
  "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/336",
  "repository_url": "https://api.github.com/repos/ethereum/consensus-specs",
  "labels_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/336/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/336/comments",
  "events_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/336/events",
  "html_url": "https://github.com/ethereum/consensus-specs/issues/336",
  "id": 392332392,
  "node_id": "MDU6SXNzdWUzOTIzMzIzOTI=",
  "number": 336,
  "title": "`Block.parent_root` redundant?",
  "user": {
    "login": "arnetheduck",
    "id": 1382986,
    "node_id": "MDQ6VXNlcjEzODI5ODY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1382986?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/arnetheduck",
    "html_url": "https://github.com/arnetheduck",
    "followers_url": "https://api.github.com/users/arnetheduck/followers",
    "following_url": "https://api.github.com/users/arnetheduck/following{/other_user}",
    "gists_url": "https://api.github.com/users/arnetheduck/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/arnetheduck/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/arnetheduck/subscriptions",
    "organizations_url": "https://api.github.com/users/arnetheduck/orgs",
    "repos_url": "https://api.github.com/users/arnetheduck/repos",
    "events_url": "https://api.github.com/users/arnetheduck/events{/privacy}",
    "received_events_url": "https://api.github.com/users/arnetheduck/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2018-12-18T20:56:57Z",
  "updated_at": "2018-12-19T21:12:08Z",
  "closed_at": "2018-12-19T21:12:08Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Now that we have `BeaconState.latest_block_roots`, is `Block.parent_root` redundant, given that the block already maintains a `state_root` that can be followed to reach the the parent block?\r\n\r\n 966f2bf\r\n",
  "closed_by": {
    "login": "arnetheduck",
    "id": 1382986,
    "node_id": "MDQ6VXNlcjEzODI5ODY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1382986?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/arnetheduck",
    "html_url": "https://github.com/arnetheduck",
    "followers_url": "https://api.github.com/users/arnetheduck/followers",
    "following_url": "https://api.github.com/users/arnetheduck/following{/other_user}",
    "gists_url": "https://api.github.com/users/arnetheduck/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/arnetheduck/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/arnetheduck/subscriptions",
    "organizations_url": "https://api.github.com/users/arnetheduck/orgs",
    "repos_url": "https://api.github.com/users/arnetheduck/repos",
    "events_url": "https://api.github.com/users/arnetheduck/events{/privacy}",
    "received_events_url": "https://api.github.com/users/arnetheduck/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/336/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/336/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/448380031",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/336#issuecomment-448380031",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/336",
    "id": 448380031,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0ODM4MDAzMQ==",
    "user": {
      "login": "vbuterin",
      "id": 2230894,
      "node_id": "MDQ6VXNlcjIyMzA4OTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2230894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vbuterin",
      "html_url": "https://github.com/vbuterin",
      "followers_url": "https://api.github.com/users/vbuterin/followers",
      "following_url": "https://api.github.com/users/vbuterin/following{/other_user}",
      "gists_url": "https://api.github.com/users/vbuterin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vbuterin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vbuterin/subscriptions",
      "organizations_url": "https://api.github.com/users/vbuterin/orgs",
      "repos_url": "https://api.github.com/users/vbuterin/repos",
      "events_url": "https://api.github.com/users/vbuterin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vbuterin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-18T21:38:36Z",
    "updated_at": "2018-12-18T21:38:36Z",
    "author_association": "MEMBER",
    "body": "The hash of a block at slot N only gets included into the state during the execution of slot N+1 and that information is grabbed _from_ the block's parent root. So no, it's not redundant unfortunately.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/448380031/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/448385449",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/336#issuecomment-448385449",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/336",
    "id": 448385449,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0ODM4NTQ0OQ==",
    "user": {
      "login": "arnetheduck",
      "id": 1382986,
      "node_id": "MDQ6VXNlcjEzODI5ODY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1382986?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arnetheduck",
      "html_url": "https://github.com/arnetheduck",
      "followers_url": "https://api.github.com/users/arnetheduck/followers",
      "following_url": "https://api.github.com/users/arnetheduck/following{/other_user}",
      "gists_url": "https://api.github.com/users/arnetheduck/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arnetheduck/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arnetheduck/subscriptions",
      "organizations_url": "https://api.github.com/users/arnetheduck/orgs",
      "repos_url": "https://api.github.com/users/arnetheduck/repos",
      "events_url": "https://api.github.com/users/arnetheduck/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arnetheduck/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-18T21:56:12Z",
    "updated_at": "2018-12-18T21:56:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "right.\r\n\r\nshould that be verified then, as part of block processing? that `BeaconState.latest_block_roots[-1] == block.parent_root` by the time we enter the \"Block processing\" section - right at the time when `block.slot == state.slot`?\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/448385449/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/448399825",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/336#issuecomment-448399825",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/336",
    "id": 448399825,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0ODM5OTgyNQ==",
    "user": {
      "login": "vbuterin",
      "id": 2230894,
      "node_id": "MDQ6VXNlcjIyMzA4OTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2230894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vbuterin",
      "html_url": "https://github.com/vbuterin",
      "followers_url": "https://api.github.com/users/vbuterin/followers",
      "following_url": "https://api.github.com/users/vbuterin/following{/other_user}",
      "gists_url": "https://api.github.com/users/vbuterin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vbuterin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vbuterin/subscriptions",
      "organizations_url": "https://api.github.com/users/vbuterin/orgs",
      "repos_url": "https://api.github.com/users/vbuterin/repos",
      "events_url": "https://api.github.com/users/vbuterin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vbuterin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-18T22:44:04Z",
    "updated_at": "2018-12-18T22:44:04Z",
    "author_association": "MEMBER",
    "body": "See the line:\r\n\r\n* Set `state.latest_block_roots[(state.slot - 1) % LATEST_BLOCK_ROOTS_LENGTH] = previous_block_root`.\r\n\r\nThat's what it's doing.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/448399825/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/448401363",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/336#issuecomment-448401363",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/336",
    "id": 448401363,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0ODQwMTM2Mw==",
    "user": {
      "login": "arnetheduck",
      "id": 1382986,
      "node_id": "MDQ6VXNlcjEzODI5ODY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1382986?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arnetheduck",
      "html_url": "https://github.com/arnetheduck",
      "followers_url": "https://api.github.com/users/arnetheduck/followers",
      "following_url": "https://api.github.com/users/arnetheduck/following{/other_user}",
      "gists_url": "https://api.github.com/users/arnetheduck/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arnetheduck/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arnetheduck/subscriptions",
      "organizations_url": "https://api.github.com/users/arnetheduck/orgs",
      "repos_url": "https://api.github.com/users/arnetheduck/repos",
      "events_url": "https://api.github.com/users/arnetheduck/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arnetheduck/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-18T22:50:06Z",
    "updated_at": "2018-12-18T22:50:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "Right - though that part is run even when a new block is not available (part of \"Per-slot processing\"), so I'd presume `previous_block_root` has to passed to the state transition function separately rather than being taken from the the new presumptive block.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/448401363/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/448734311",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/336#issuecomment-448734311",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/336",
    "id": 448734311,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0ODczNDMxMQ==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-19T20:32:49Z",
    "updated_at": "2018-12-19T20:36:56Z",
    "author_association": "MEMBER",
    "body": "It depends on how you view the state processing.\r\n\r\nIf you view it as the following, then everything is contained within the new block to process the state transition.\r\n```python\r\ndef state_transition(state, block):\r\n    while state.slot < block.slot\r\n        state = per_slot_transition(state, block.parent_root)\r\n        if block.slot == state.slot:\r\n            state = per_block_transition(state, block)\r\n    return state\r\n```\r\n\r\nIf instead, you are opportunistically processing slots without a new incoming block, you are implicitly assuming what the parent of the next incoming block will be. So you are doing the above state transition function but just halting before you get to the `per_block_transition` part for the future block.\r\n\r\nIf you happen to get an incoming block with a different parent than what you have been opportunistically processing slots for, then you would have to rewind to the different parent and do the full state transition as I showed in the above function.\r\n\r\n\r\nOpportunistically processing slots is an exceptional case of doing the normal full block by block state transition. At the end of the day, this is a blockchain and the high level transition when processing chain is really block-by-block. We just have some granular bookkeeping happening in this block-by-block transition when slots were skipped between the blocks in the chain.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/448734311/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/448745428",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/336#issuecomment-448745428",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/336",
    "id": 448745428,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0ODc0NTQyOA==",
    "user": {
      "login": "arnetheduck",
      "id": 1382986,
      "node_id": "MDQ6VXNlcjEzODI5ODY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1382986?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arnetheduck",
      "html_url": "https://github.com/arnetheduck",
      "followers_url": "https://api.github.com/users/arnetheduck/followers",
      "following_url": "https://api.github.com/users/arnetheduck/following{/other_user}",
      "gists_url": "https://api.github.com/users/arnetheduck/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arnetheduck/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arnetheduck/subscriptions",
      "organizations_url": "https://api.github.com/users/arnetheduck/orgs",
      "repos_url": "https://api.github.com/users/arnetheduck/repos",
      "events_url": "https://api.github.com/users/arnetheduck/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arnetheduck/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-19T21:12:08Z",
    "updated_at": "2018-12-19T21:12:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "alright, I think I found the lines that disambiguate this:\r\n\r\n`* The parent block with root `block.parent_root` has been processed and accepted.` and `* Let `previous_block_root` be the `hash_tree_root` of the previous beacon block processed in the chain.` together dispel this ambiguity regardless of opportunism or not - thanks for the explanations!\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/448745428/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
