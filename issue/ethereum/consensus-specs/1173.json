{
  "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1173",
  "repository_url": "https://api.github.com/repos/ethereum/consensus-specs",
  "labels_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1173/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1173/comments",
  "events_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1173/events",
  "html_url": "https://github.com/ethereum/consensus-specs/issues/1173",
  "id": 455905378,
  "node_id": "MDU6SXNzdWU0NTU5MDUzNzg=",
  "number": 1173,
  "title": "Attestation bitfield length checks ",
  "user": {
    "login": "protolambda",
    "id": 19571989,
    "node_id": "MDQ6VXNlcjE5NTcxOTg5",
    "avatar_url": "https://avatars.githubusercontent.com/u/19571989?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/protolambda",
    "html_url": "https://github.com/protolambda",
    "followers_url": "https://api.github.com/users/protolambda/followers",
    "following_url": "https://api.github.com/users/protolambda/following{/other_user}",
    "gists_url": "https://api.github.com/users/protolambda/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/protolambda/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/protolambda/subscriptions",
    "organizations_url": "https://api.github.com/users/protolambda/orgs",
    "repos_url": "https://api.github.com/users/protolambda/repos",
    "events_url": "https://api.github.com/users/protolambda/events{/privacy}",
    "received_events_url": "https://api.github.com/users/protolambda/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1063043872,
      "node_id": "MDU6TGFiZWwxMDYzMDQzODcy",
      "url": "https://api.github.com/repos/ethereum/consensus-specs/labels/general:question",
      "name": "general:question",
      "color": "FAD689",
      "default": false,
      "description": "Further information is requested"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2019-06-13T19:04:52Z",
  "updated_at": "2019-06-14T09:09:53Z",
  "closed_at": "2019-06-14T00:41:04Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "See #1171:\r\n\r\n> When there are two bitfields (Aggregation, and custody1), and we derive the indices for custody0 (in convert_to_indexed), should we check len(participants) < len(custody1)? E.g. the bitfields could be verified to be committee size, yet the custody bits could be more full than the actual participants, resulting in extra custody-1 indices. Or is this prevented elsewhere?\r\n\r\n@JustinDrake:\r\n\r\n> Oh, I think you're right that something is fishy in convert_to_indexed. Specifically, we want to check that every bit in custody_bitfield is zero whenever the corresponding bit in aggregation_bitfield is zero. It's possible this invariant was lost with the refactor to IndexedAttestation. cc @djrtwo\r\n\r\n\r\nSeparating this from the #1171 PR, as it's unnecessarily blocking, somewhat open, and may need more work (or not).",
  "closed_by": {
    "login": "protolambda",
    "id": 19571989,
    "node_id": "MDQ6VXNlcjE5NTcxOTg5",
    "avatar_url": "https://avatars.githubusercontent.com/u/19571989?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/protolambda",
    "html_url": "https://github.com/protolambda",
    "followers_url": "https://api.github.com/users/protolambda/followers",
    "following_url": "https://api.github.com/users/protolambda/following{/other_user}",
    "gists_url": "https://api.github.com/users/protolambda/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/protolambda/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/protolambda/subscriptions",
    "organizations_url": "https://api.github.com/users/protolambda/orgs",
    "repos_url": "https://api.github.com/users/protolambda/repos",
    "events_url": "https://api.github.com/users/protolambda/events{/privacy}",
    "received_events_url": "https://api.github.com/users/protolambda/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1173/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1173/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/501876367",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1173#issuecomment-501876367",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1173",
    "id": 501876367,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMTg3NjM2Nw==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-13T20:58:22Z",
    "updated_at": "2019-06-13T20:58:22Z",
    "author_association": "MEMBER",
    "body": "> It's possible this invariant was lost with the refactor to IndexedAttestation.\r\n\r\nThis invariant used to be in `verify_attestation` but was removed because during phase 0, the code-path could never be reached. The phase 0 enforcement that all custody bits were zero prevented the second check from ever being triggered",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/501876367/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/501879790",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1173#issuecomment-501879790",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1173",
    "id": 501879790,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMTg3OTc5MA==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-13T21:09:17Z",
    "updated_at": "2019-06-13T21:09:17Z",
    "author_association": "MEMBER",
    "body": "meaning, it was removed before the translation to IndexedAttestation!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/501879790/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/502033463",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1173#issuecomment-502033463",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1173",
    "id": 502033463,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMjAzMzQ2Mw==",
    "user": {
      "login": "JustinDrake",
      "id": 731743,
      "node_id": "MDQ6VXNlcjczMTc0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/731743?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JustinDrake",
      "html_url": "https://github.com/JustinDrake",
      "followers_url": "https://api.github.com/users/JustinDrake/followers",
      "following_url": "https://api.github.com/users/JustinDrake/following{/other_user}",
      "gists_url": "https://api.github.com/users/JustinDrake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JustinDrake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JustinDrake/subscriptions",
      "organizations_url": "https://api.github.com/users/JustinDrake/orgs",
      "repos_url": "https://api.github.com/users/JustinDrake/repos",
      "events_url": "https://api.github.com/users/JustinDrake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JustinDrake/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-14T09:09:53Z",
    "updated_at": "2019-06-14T09:09:53Z",
    "author_association": "MEMBER",
    "body": "> The phase 0 enforcement that all custody bits were zero prevented the second check from ever being triggered\r\n\r\nOh right. The check that all custody bits were zero prevents anyone from exploiting this in phase 0. Still good to add because both `assert`s can now be triggered.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/502033463/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
