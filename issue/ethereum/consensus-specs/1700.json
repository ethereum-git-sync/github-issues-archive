{
  "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1700",
  "repository_url": "https://api.github.com/repos/ethereum/consensus-specs",
  "labels_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1700/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1700/comments",
  "events_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1700/events",
  "html_url": "https://github.com/ethereum/consensus-specs/issues/1700",
  "id": 591252908,
  "node_id": "MDU6SXNzdWU1OTEyNTI5MDg=",
  "number": 1700,
  "title": "Finding peers of correct chain before genesis",
  "user": {
    "login": "djrtwo",
    "id": 1433595,
    "node_id": "MDQ6VXNlcjE0MzM1OTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/djrtwo",
    "html_url": "https://github.com/djrtwo",
    "followers_url": "https://api.github.com/users/djrtwo/followers",
    "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
    "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
    "organizations_url": "https://api.github.com/users/djrtwo/orgs",
    "repos_url": "https://api.github.com/users/djrtwo/repos",
    "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/djrtwo/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2020-03-31T16:37:23Z",
  "updated_at": "2020-04-20T16:38:14Z",
  "closed_at": "2020-04-20T16:38:14Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "We generally rely upon the `eth2` field in the ENR to find peers on a particular chain.  The `ForkDigest` within this field utilizes `genesis_validators_root` and `fork_version` to isolate the chain from others, but because `genesis_validators_root` is not previously know, the `eth2` field cannot properly be used prior to genesis.\r\n\r\nThere is also some strangeness in wrt gossip topics because they use the `fork_digest` in the topic name. This would prevent any subscriptions being valid prior to knowing the genesis state. This isn't a huge deal because genesis is delayed for at least `MIN_GENESIS_DELAY` (1 day) during which gossip subscriptions can be made.\r\n\r\nSome potential solutions:\r\n1. A simple solution is to set `genesis_validators_root` to `0x00` prior to genesis, but then you might find peers of other (not yet to genesis) chains. Probably not too bad because only so many chains will be queued to start at any given time. Still, not optimal.\r\n2. Could also use `DEPOSIT_CONTRACT_ADDRESS` as a temporary stub for `genesis_validators_root` to form a \"pre-genesis\" fork_digest. This would be useful in finding peers, but would not solve the gossip topic problem (which is probably okay). One downside is that this is an eth1-centric view of how to start an eth2 chain. A non-eth1 genesis chain might already know fork_digest in advance, or could use some other agreed upon bytes to fill `genesis_validators_root` before it is knwn.\r\n3. Simply do not find peers until genesis state is known. This is at least 24 hours of lead time on mainnet. Is there actually any downside to this method? Do we gain much by peering 24+ hours in advance? Does it break anything fundamental in client work flows?\r\n\r\nThe above list is probably not exhaustive. Open to input here. I currently favor (3) for simplicity unless it is not in fact simple to implement. Otherwise, I think (2) should be fine.",
  "closed_by": {
    "login": "hwwhww",
    "id": 9263930,
    "node_id": "MDQ6VXNlcjkyNjM5MzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9263930?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hwwhww",
    "html_url": "https://github.com/hwwhww",
    "followers_url": "https://api.github.com/users/hwwhww/followers",
    "following_url": "https://api.github.com/users/hwwhww/following{/other_user}",
    "gists_url": "https://api.github.com/users/hwwhww/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hwwhww/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hwwhww/subscriptions",
    "organizations_url": "https://api.github.com/users/hwwhww/orgs",
    "repos_url": "https://api.github.com/users/hwwhww/repos",
    "events_url": "https://api.github.com/users/hwwhww/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hwwhww/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1700/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1700/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/606739878",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1700#issuecomment-606739878",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1700",
    "id": 606739878,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNjczOTg3OA==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-03-31T16:37:52Z",
    "updated_at": "2020-03-31T16:37:52Z",
    "author_association": "MEMBER",
    "body": "cc: @nisdas @AgeManning @arnetheduck @mkalinin ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/606739878/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/607043360",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1700#issuecomment-607043360",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1700",
    "id": 607043360,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNzA0MzM2MA==",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-01T05:36:00Z",
    "updated_at": "2020-04-01T05:36:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "We already do 3. So this is my vote, because no further work is required from our end :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/607043360/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/607045249",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1700#issuecomment-607045249",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1700",
    "id": 607045249,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNzA0NTI0OQ==",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-01T05:41:34Z",
    "updated_at": "2020-04-01T05:41:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "I like 3) too as it is straightforward to implement, we avoid the situation of 2 potential fork-digests where you have a different fork digest pre-genesis and post-genesis. I think 24 hours should be ok to search and discover the appropriate peers, although I would be interested to know if there are any downsides to having peer discovery restricted to only 24 hours before chainstart.    ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/607045249/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/607122769",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1700#issuecomment-607122769",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1700",
    "id": 607122769,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNzEyMjc2OQ==",
    "user": {
      "login": "q9f",
      "id": 58883403,
      "node_id": "MDQ6VXNlcjU4ODgzNDAz",
      "avatar_url": "https://avatars.githubusercontent.com/u/58883403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/q9f",
      "html_url": "https://github.com/q9f",
      "followers_url": "https://api.github.com/users/q9f/followers",
      "following_url": "https://api.github.com/users/q9f/following{/other_user}",
      "gists_url": "https://api.github.com/users/q9f/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/q9f/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/q9f/subscriptions",
      "organizations_url": "https://api.github.com/users/q9f/orgs",
      "repos_url": "https://api.github.com/users/q9f/repos",
      "events_url": "https://api.github.com/users/q9f/events{/privacy}",
      "received_events_url": "https://api.github.com/users/q9f/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-01T08:53:23Z",
    "updated_at": "2020-04-01T08:53:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "(3) makes most sense because you can only check for valid genesis validators root after that genesis event took place. if you want to be fancy, you could populate a temporary record of potential peers that share the same fork id and then check that list after genesis for the correct root before adding them to the local node records. that way you could start a preliminary peer discovery before the genesis delay period.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/607122769/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/607151000",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1700#issuecomment-607151000",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1700",
    "id": 607151000,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNzE1MTAwMA==",
    "user": {
      "login": "mkalinin",
      "id": 1892772,
      "node_id": "MDQ6VXNlcjE4OTI3NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1892772?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mkalinin",
      "html_url": "https://github.com/mkalinin",
      "followers_url": "https://api.github.com/users/mkalinin/followers",
      "following_url": "https://api.github.com/users/mkalinin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mkalinin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mkalinin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mkalinin/subscriptions",
      "organizations_url": "https://api.github.com/users/mkalinin/orgs",
      "repos_url": "https://api.github.com/users/mkalinin/repos",
      "events_url": "https://api.github.com/users/mkalinin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mkalinin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-01T09:50:23Z",
    "updated_at": "2020-04-01T09:50:23Z",
    "author_association": "MEMBER",
    "body": "> if there are any downsides to having peer discovery restricted to only 24 hours before chainstart\r\n\r\nMy gut says that it should be sufficiently enough for peers to form a stable backbone. @zilm13 is about to figure out whether `27` to `54` hours would be enough to jump from one subnet to the other. I think this particular case around genesis could also be simulated. Thus, I'd suggest to stick with 3) for now and get back to this question once we have a proof of this option doesn't work well.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/607151000/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/607752043",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1700#issuecomment-607752043",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1700",
    "id": 607752043,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNzc1MjA0Mw==",
    "user": {
      "login": "zilm13",
      "id": 6196452,
      "node_id": "MDQ6VXNlcjYxOTY0NTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6196452?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zilm13",
      "html_url": "https://github.com/zilm13",
      "followers_url": "https://api.github.com/users/zilm13/followers",
      "following_url": "https://api.github.com/users/zilm13/following{/other_user}",
      "gists_url": "https://api.github.com/users/zilm13/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zilm13/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zilm13/subscriptions",
      "organizations_url": "https://api.github.com/users/zilm13/orgs",
      "repos_url": "https://api.github.com/users/zilm13/repos",
      "events_url": "https://api.github.com/users/zilm13/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zilm13/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-02T10:11:05Z",
    "updated_at": "2020-04-02T10:11:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "@mkalinin 3) doesn't require jump and has another benefits, I'd bet for 3. It's one-time.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/607752043/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/608190601",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1700#issuecomment-608190601",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1700",
    "id": 608190601,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwODE5MDYwMQ==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-03T02:12:24Z",
    "updated_at": "2020-04-03T02:12:24Z",
    "author_association": "MEMBER",
    "body": "Thanks for the input everyone! (3) it is. PR coming right up",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/608190601/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 2,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/616671162",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/1700#issuecomment-616671162",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/1700",
    "id": 616671162,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNjY3MTE2Mg==",
    "user": {
      "login": "hwwhww",
      "id": 9263930,
      "node_id": "MDQ6VXNlcjkyNjM5MzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9263930?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hwwhww",
      "html_url": "https://github.com/hwwhww",
      "followers_url": "https://api.github.com/users/hwwhww/followers",
      "following_url": "https://api.github.com/users/hwwhww/following{/other_user}",
      "gists_url": "https://api.github.com/users/hwwhww/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hwwhww/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hwwhww/subscriptions",
      "organizations_url": "https://api.github.com/users/hwwhww/orgs",
      "repos_url": "https://api.github.com/users/hwwhww/repos",
      "events_url": "https://api.github.com/users/hwwhww/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hwwhww/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-20T16:38:14Z",
    "updated_at": "2020-04-20T16:38:14Z",
    "author_association": "MEMBER",
    "body": "closing in favor of #1708",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/616671162/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
