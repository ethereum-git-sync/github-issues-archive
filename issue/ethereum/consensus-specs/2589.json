{
  "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2589",
  "repository_url": "https://api.github.com/repos/ethereum/consensus-specs",
  "labels_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2589/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2589/comments",
  "events_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2589/events",
  "html_url": "https://github.com/ethereum/consensus-specs/issues/2589",
  "id": 991707222,
  "node_id": "MDU6SXNzdWU5OTE3MDcyMjI=",
  "number": 2589,
  "title": "Attestation ignore rule might be redundant",
  "user": {
    "login": "rolfyone",
    "id": 2967240,
    "node_id": "MDQ6VXNlcjI5NjcyNDA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2967240?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rolfyone",
    "html_url": "https://github.com/rolfyone",
    "followers_url": "https://api.github.com/users/rolfyone/followers",
    "following_url": "https://api.github.com/users/rolfyone/following{/other_user}",
    "gists_url": "https://api.github.com/users/rolfyone/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rolfyone/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rolfyone/subscriptions",
    "organizations_url": "https://api.github.com/users/rolfyone/orgs",
    "repos_url": "https://api.github.com/users/rolfyone/repos",
    "events_url": "https://api.github.com/users/rolfyone/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rolfyone/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1295438707,
      "node_id": "MDU6TGFiZWwxMjk1NDM4NzA3",
      "url": "https://api.github.com/repos/ethereum/consensus-specs/labels/scope:networking",
      "name": "scope:networking",
      "color": "F596AA",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-09-09T03:04:50Z",
  "updated_at": "2021-10-26T16:12:14Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "> [IGNORE] There has been no other valid attestation seen on an attestation subnet that has an identical attestation.data.target.epoch and participating validator index.\r\n\r\nIt looks like the attestation ignore rule is basically covered by gossip cache now, because attestations are all compressed the same and so give the same signature.\r\n\r\nI've been doing some testing in Teku on this, and some duplicates do seem to come through, but they're outside of the gossip cache timeout, and they'd be missed by any cache we keep unless we're keeping all seen attestations for more than 6 minutes\r\n```\r\n2021-09-09 12:35:40.300+10:00 | SeenAttestationAtSlot{slot=2027576, committeeIndex=45, committeePosition=68}; Attestation{aggregation_bits=SszBitlist{size=129, 000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000}, data=AttestationData{slot=2027576, index=45, beacon_block_root=0x89b76c7a52f05210e7d9bb16db2a3e1fc3d006ca587bab1aba5bc8b4d417b94e, source=Checkpoint{epoch=63360, root=0xd2e31a4d650340bbcebfd92aa3830cb8d596a77e1acab35255df6c3a43a19259}, target=Checkpoint{epoch=63361, root=0x9632cade23ba087a60e165a703587d6da1289f33dd0832ec5c359e92235cd9bd}}, signature=SszByteVector{0xb26fd4ad81451c374b48bfe32fb6a3ce5c2d783a04fcb4031dcb0eb7c549193d0de468372b6946de99998a226248f7cf073f435df139f781d1c678d4de70d81a7dd02f4f6002c740b705c6585e45b0985b00f593b4b88c517ce2bccf9a3a61cc}}\r\n...\r\n2021-09-09 12:42:06.614+10:00 | SeenAttestationAtSlot{slot=2027576, committeeIndex=45, committeePosition=68}; Attestation{aggregation_bits=SszBitlist{size=129, 000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000}, data=AttestationData{slot=2027576, index=45, beacon_block_root=0x89b76c7a52f05210e7d9bb16db2a3e1fc3d006ca587bab1aba5bc8b4d417b94e, source=Checkpoint{epoch=63360, root=0xd2e31a4d650340bbcebfd92aa3830cb8d596a77e1acab35255df6c3a43a19259}, target=Checkpoint{epoch=63361, root=0x9632cade23ba087a60e165a703587d6da1289f33dd0832ec5c359e92235cd9bd}}, signature=SszByteVector{0xb26fd4ad81451c374b48bfe32fb6a3ce5c2d783a04fcb4031dcb0eb7c549193d0de468372b6946de99998a226248f7cf073f435df139f781d1c678d4de70d81a7dd02f4f6002c740b705c6585e45b0985b00f593b4b88c517ce2bccf9a3a61cc}}\r\n```\r\n\r\nI'm not sure why these super late attestations seem to be getting gossiped, but the ignore rule misses them due to how late they are (cache has well and truly moved on by then) and gossip seems to be de-dup'ing the rest...\r\n\r\nWhen I was discussing our Teku attestation seen cache sizings with @protolambda we decided to raise a ticket so that there could be a discussion on anything that we might not have considered.\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2589/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2589/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/952094562",
    "html_url": "https://github.com/ethereum/consensus-specs/issues/2589#issuecomment-952094562",
    "issue_url": "https://api.github.com/repos/ethereum/consensus-specs/issues/2589",
    "id": 952094562,
    "node_id": "IC_kwDOCOoGbc44v89i",
    "user": {
      "login": "arnetheduck",
      "id": 1382986,
      "node_id": "MDQ6VXNlcjEzODI5ODY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1382986?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arnetheduck",
      "html_url": "https://github.com/arnetheduck",
      "followers_url": "https://api.github.com/users/arnetheduck/followers",
      "following_url": "https://api.github.com/users/arnetheduck/following{/other_user}",
      "gists_url": "https://api.github.com/users/arnetheduck/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arnetheduck/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arnetheduck/subscriptions",
      "organizations_url": "https://api.github.com/users/arnetheduck/orgs",
      "repos_url": "https://api.github.com/users/arnetheduck/repos",
      "events_url": "https://api.github.com/users/arnetheduck/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arnetheduck/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-26T16:12:14Z",
    "updated_at": "2021-10-26T16:12:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "> covered by gossip cache now\r\n\r\nI think the rule is still valuable in that it separates concerns - the gossip cache lives in a different layer which may change - this validation rule instead covers an explicit way in which attestations become useless.\r\n\r\nAn extended variation of this rule is presented in https://github.com/ethereum/consensus-specs/issues/2183 where we would simply ignore _any_ attestation that we've already seen / have coverage for in our attestation table.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/consensus-specs/issues/comments/952094562/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
