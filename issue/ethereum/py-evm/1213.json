{
  "url": "https://api.github.com/repos/ethereum/py-evm/issues/1213",
  "repository_url": "https://api.github.com/repos/ethereum/py-evm",
  "labels_url": "https://api.github.com/repos/ethereum/py-evm/issues/1213/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/py-evm/issues/1213/comments",
  "events_url": "https://api.github.com/repos/ethereum/py-evm/issues/1213/events",
  "html_url": "https://github.com/ethereum/py-evm/issues/1213",
  "id": 353396669,
  "node_id": "MDU6SXNzdWUzNTMzOTY2Njk=",
  "number": 1213,
  "title": "Significant performance degradation during testing compared to pyethereum",
  "user": {
    "login": "paymog",
    "id": 1986950,
    "node_id": "MDQ6VXNlcjE5ODY5NTA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1986950?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/paymog",
    "html_url": "https://github.com/paymog",
    "followers_url": "https://api.github.com/users/paymog/followers",
    "following_url": "https://api.github.com/users/paymog/following{/other_user}",
    "gists_url": "https://api.github.com/users/paymog/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/paymog/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/paymog/subscriptions",
    "organizations_url": "https://api.github.com/users/paymog/orgs",
    "repos_url": "https://api.github.com/users/paymog/repos",
    "events_url": "https://api.github.com/users/paymog/events{/privacy}",
    "received_events_url": "https://api.github.com/users/paymog/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2018-08-23T14:05:25Z",
  "updated_at": "2018-08-23T15:59:58Z",
  "closed_at": "2018-08-23T15:03:14Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "* py-evm Version: 0.2.0a26\r\n* OS: osx\r\n* Python Version (python --version): 3.6.5\r\n* Environment (output of `pip freeze`):\r\n```\r\naiohttp==2.3.10\r\namqp==2.3.2\r\naniso8601==3.0.2\r\nappnope==0.1.0\r\nasn1crypto==0.24.0\r\nasync-lru==0.1.0\r\nasync-timeout==3.0.0\r\nattrdict==2.0.0\r\nbackcall==0.1.0\r\nbilliard==3.5.0.4\r\nbitcoin==1.1.42\r\ncelery==4.2.0\r\ncertifi==2018.4.16\r\ncffi==1.11.5\r\nchardet==3.0.4\r\nclick==6.7\r\ncoincurve==7.1.0\r\ncoverage==4.5.1\r\ncryptography==2.3.1\r\ncytoolz==0.9.0.1\r\ndecorator==4.3.0\r\ndj-database-url==0.5.0\r\nDjango==2.0.6\r\ndjango-celery-beat==1.1.1\r\ndjango-celery-results==1.0.1\r\ndjango-cors-headers==2.3.0\r\neth-abi==1.1.1\r\neth-account==0.2.3\r\neth-bloom==1.0.0\r\neth-hash==0.1.4\r\neth-keyfile==0.5.1\r\neth-keys==0.2.0b3\r\neth-rlp==0.1.2\r\neth-tester==0.1.0b27\r\neth-utils==1.0.3\r\nFlask==1.0.2\r\nFlask-GraphQL==1.4.1\r\ngraphene==2.1\r\ngraphene-django==2.0.0\r\ngraphql-core==2.0\r\ngraphql-relay==0.4.5\r\nhexbytes==0.1.0\r\nidna==2.7\r\nidna-ssl==1.1.0\r\nipython==6.5.0\r\nipython-genutils==0.2.0\r\niso8601==0.1.12\r\nitsdangerous==0.24\r\njedi==0.12.1\r\nJinja2==2.10\r\nkombu==4.2.1\r\nlru-dict==1.1.6\r\nlxml==4.2.4\r\nMarkupSafe==1.0\r\nmultidict==4.3.1\r\nnetdisco==2.0.0\r\nnetifaces==0.10.7\r\nparsimonious==0.8.0\r\nparso==0.3.1\r\npbkdf2==1.3\r\npexpect==4.6.0\r\npickleshare==0.7.4\r\nplyvel==1.0.4\r\npromise==2.1\r\nprompt-toolkit==1.0.15\r\npsycopg2==2.7.5\r\npsycopg2-binary==2.7.5\r\nptyprocess==0.6.0\r\npy-ecc==1.4.3\r\npy-evm==0.2.0a26\r\npy-solc==3.1.0\r\npycparser==2.18\r\npycryptodome==3.6.1\r\npyethash==0.1.27\r\nPyGithub==1.40\r\nPygments==2.2.0\r\nPyJWT==1.6.4\r\npysha3==1.0.2\r\npython-dateutil==2.7.3\r\npytz==2018.5\r\nPyYAML==3.12\r\nredis==2.10.6\r\nrepoze.lru==0.7\r\nrequests==2.19.1\r\nrlp==1.0.2\r\nRx==1.6.1\r\nscrypt==0.8.6\r\nsecp256k1==0.13.2\r\nsemantic-version==2.6.0\r\nsimplegeneric==0.8.1\r\nsingledispatch==3.4.0.3\r\nsix==1.11.0\r\nSQLAlchemy==1.2.9\r\ntoolz==0.9.0\r\ntraitlets==4.3.2\r\ntrie==1.3.8\r\ntyping==3.6.4\r\nuPnPClient==0.0.8\r\nurllib3==1.23\r\nvine==1.1.4\r\nwcwidth==0.1.7\r\nweb3==4.3.0\r\nwebsockets==4.0.1\r\nWerkzeug==0.14.1\r\nyarl==1.2.6\r\nzeroconf==0.20.0\r\n```\r\n\r\n### What is wrong?\r\n\r\nI'm moving my tests over from `pyethereum` to `py-evm` and I'm seeing a significant performance degradation. On `pyethreum` my test suite would take ~23 seconds. With `py-evm` it takes ~75 seconds. I've profiled my tests and the profile can be found at https://www.filehosting.org/file/details/753367/mycro.pstat.\r\n",
  "closed_by": {
    "login": "pipermerriam",
    "id": 824194,
    "node_id": "MDQ6VXNlcjgyNDE5NA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/824194?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pipermerriam",
    "html_url": "https://github.com/pipermerriam",
    "followers_url": "https://api.github.com/users/pipermerriam/followers",
    "following_url": "https://api.github.com/users/pipermerriam/following{/other_user}",
    "gists_url": "https://api.github.com/users/pipermerriam/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pipermerriam/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pipermerriam/subscriptions",
    "organizations_url": "https://api.github.com/users/pipermerriam/orgs",
    "repos_url": "https://api.github.com/users/pipermerriam/repos",
    "events_url": "https://api.github.com/users/pipermerriam/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pipermerriam/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/1213/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/py-evm/issues/1213/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/415451085",
    "html_url": "https://github.com/ethereum/py-evm/issues/1213#issuecomment-415451085",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/1213",
    "id": 415451085,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNTQ1MTA4NQ==",
    "user": {
      "login": "pipermerriam",
      "id": 824194,
      "node_id": "MDQ6VXNlcjgyNDE5NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/824194?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pipermerriam",
      "html_url": "https://github.com/pipermerriam",
      "followers_url": "https://api.github.com/users/pipermerriam/followers",
      "following_url": "https://api.github.com/users/pipermerriam/following{/other_user}",
      "gists_url": "https://api.github.com/users/pipermerriam/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pipermerriam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pipermerriam/subscriptions",
      "organizations_url": "https://api.github.com/users/pipermerriam/orgs",
      "repos_url": "https://api.github.com/users/pipermerriam/repos",
      "events_url": "https://api.github.com/users/pipermerriam/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pipermerriam/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-23T15:03:14Z",
    "updated_at": "2018-08-23T15:03:14Z",
    "author_association": "MEMBER",
    "body": "This is about inline with the speed I'd expect.  Py-EVM was written first for readability and easy to understand code/architecture.  We're only now getting to the phase where we're starting to focus on performance.  \r\n\r\nCan you potentially share your test suite?  FYI, gists are really good places to dump files like your pstats file.  Depending on your test setup, you should be able to get some performance by using something like `pytest-xdist` to spread the test runs across multiple cores.\r\n\r\nI'm closing as this isn't a bug, but please feel free to continue the coversation here.  We can re-open if a specific bottleneck is identified.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/415451085/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/415465614",
    "html_url": "https://github.com/ethereum/py-evm/issues/1213#issuecomment-415465614",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/1213",
    "id": 415465614,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNTQ2NTYxNA==",
    "user": {
      "login": "paymog",
      "id": 1986950,
      "node_id": "MDQ6VXNlcjE5ODY5NTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1986950?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paymog",
      "html_url": "https://github.com/paymog",
      "followers_url": "https://api.github.com/users/paymog/followers",
      "following_url": "https://api.github.com/users/paymog/following{/other_user}",
      "gists_url": "https://api.github.com/users/paymog/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paymog/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paymog/subscriptions",
      "organizations_url": "https://api.github.com/users/paymog/orgs",
      "repos_url": "https://api.github.com/users/paymog/repos",
      "events_url": "https://api.github.com/users/paymog/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paymog/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-23T15:45:48Z",
    "updated_at": "2018-08-23T15:45:48Z",
    "author_association": "NONE",
    "body": "Ah, understood. Hopefully Py-EVM is eventually faster than pyethereum. \r\n\r\nUnfortunately I don't think I can share the test suite just yet but once I open-source the code I'm happy to provide a link.\r\n\r\nI would definitely see a performance improvement if I ran my tests across multiple cores but that's not a priority just yet. Looks like I'd have to move from `unittest` to `pytest` first.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/415465614/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/415470862",
    "html_url": "https://github.com/ethereum/py-evm/issues/1213#issuecomment-415470862",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/1213",
    "id": 415470862,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNTQ3MDg2Mg==",
    "user": {
      "login": "pipermerriam",
      "id": 824194,
      "node_id": "MDQ6VXNlcjgyNDE5NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/824194?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pipermerriam",
      "html_url": "https://github.com/pipermerriam",
      "followers_url": "https://api.github.com/users/pipermerriam/followers",
      "following_url": "https://api.github.com/users/pipermerriam/following{/other_user}",
      "gists_url": "https://api.github.com/users/pipermerriam/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pipermerriam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pipermerriam/subscriptions",
      "organizations_url": "https://api.github.com/users/pipermerriam/orgs",
      "repos_url": "https://api.github.com/users/pipermerriam/repos",
      "events_url": "https://api.github.com/users/pipermerriam/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pipermerriam/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-23T15:59:58Z",
    "updated_at": "2018-08-23T15:59:58Z",
    "author_association": "MEMBER",
    "body": "@paymog it's up to you.  I'd be happy to look over your test suite if you want to give me access.  Contact me out-of-band (gitter/email) if you want to try that.\r\n\r\nFYI, `pytest` can run `unittest` based tests so you might just try switching test harnesses (btw, pytest is awesome and you should absolutely switch because it is soooooooo much better)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/415470862/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
