{
  "url": "https://api.github.com/repos/ethereum/py-evm/issues/1944",
  "repository_url": "https://api.github.com/repos/ethereum/py-evm",
  "labels_url": "https://api.github.com/repos/ethereum/py-evm/issues/1944/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/py-evm/issues/1944/comments",
  "events_url": "https://api.github.com/repos/ethereum/py-evm/issues/1944/events",
  "html_url": "https://github.com/ethereum/py-evm/issues/1944",
  "id": 627914741,
  "node_id": "MDU6SXNzdWU2Mjc5MTQ3NDE=",
  "number": 1944,
  "title": "Setup Monitoring with InfluxDB & Grafana doesn't work ",
  "user": {
    "login": "VMLVaske",
    "id": 32402989,
    "node_id": "MDQ6VXNlcjMyNDAyOTg5",
    "avatar_url": "https://avatars.githubusercontent.com/u/32402989?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/VMLVaske",
    "html_url": "https://github.com/VMLVaske",
    "followers_url": "https://api.github.com/users/VMLVaske/followers",
    "following_url": "https://api.github.com/users/VMLVaske/following{/other_user}",
    "gists_url": "https://api.github.com/users/VMLVaske/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/VMLVaske/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/VMLVaske/subscriptions",
    "organizations_url": "https://api.github.com/users/VMLVaske/orgs",
    "repos_url": "https://api.github.com/users/VMLVaske/repos",
    "events_url": "https://api.github.com/users/VMLVaske/events{/privacy}",
    "received_events_url": "https://api.github.com/users/VMLVaske/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-05-31T08:02:18Z",
  "updated_at": "2020-06-02T09:59:56Z",
  "closed_at": "2020-06-02T09:59:55Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "* py-evm Version: all of them\r\n* OS: Ubuntu 18.04\r\n* Python Version (python --version): 3.7\r\n* Environment (output of `pip freeze`):\r\naiohttp==3.6.0\r\nanyio==1.3.0\r\nargcomplete==1.11.1\r\nasks==2.3.7\r\nasn1crypto==1.3.0\r\nasync-exit-stack==1.0.1\r\nasync-generator==1.10\r\nasync-lru==0.1.0\r\nasync-service==0.1.0a7\r\nasync-timeout==3.0.1\r\nasyncio-cancel-token==0.2.0\r\nasyncio-run-in-process==0.1.0a4\r\nattrdict==2.0.1\r\nattrs==19.3.0\r\nbackcall==0.1.0\r\nbase58==1.0.3\r\nblake2b-py==0.1.3\r\nbloom-filter==1.3\r\ncached-property==1.5.1\r\ncachetools==3.1.1\r\ncertifi==2020.4.5.1\r\ncffi==1.14.0\r\nchardet==3.0.4\r\ncloudpickle==1.4.1\r\ncoincurve==10.0.0\r\ncontextvars==2.4\r\ncryptography==2.6.1\r\ncytoolz==0.10.1\r\ndataclasses==0.7\r\ndecorator==4.4.2\r\neth-abi==2.1.1\r\neth-account==0.4.0\r\neth-bloom==1.0.3\r\neth-hash==0.2.0\r\neth-keyfile==0.5.1\r\neth-keys==0.2.4\r\neth-rlp==0.1.2\r\neth-typing==2.2.1\r\neth-utils==1.9.0\r\nfastecdsa==1.7.4\r\nh11==0.9.0\r\nhexbytes==0.2.0\r\nidna==2.7\r\nidna-ssl==1.1.0\r\nifaddr==0.1.6\r\nimmutables==0.14\r\nimportlib-metadata==1.6.0\r\nipfshttpclient==0.4.13.2\r\nipython==7.9.0\r\nipython-genutils==0.2.0\r\njedi==0.17.0\r\njsonschema==3.0.1\r\nlahja==0.15.2\r\nlibp2p==0.1.4\r\nlru-dict==1.1.6\r\nlxml==4.5.1\r\nmultiaddr==0.0.9\r\nmultidict==4.7.6\r\nmypy==0.770\r\nmypy-extensions==0.4.3\r\nnetaddr==0.7.19\r\nnetdisco==2.6.0\r\nnetifaces==0.10.9\r\noutcome==1.0.1\r\nparsimonious==0.8.1\r\nparso==0.7.0\r\npexpect==4.8.0\r\npickleshare==0.7.5\r\nplyvel==1.1.0\r\nprometheus-client==0.7.1\r\nprompt-toolkit==2.0.10\r\nprotobuf==3.12.2\r\nptyprocess==0.6.0\r\npy-ecc==1.7.1\r\npy-evm==0.3.0a14\r\npycparser==2.20\r\npycryptodome==3.9.7\r\npyethash==0.1.27\r\nPygments==2.6.1\r\npymultihash==0.8.2\r\nPyNaCl==1.3.0\r\npyrsistent==0.15.7\r\npysha3==1.0.2\r\npython-dateutil==2.8.1\r\npython-snappy==0.5.4\r\nrequests==2.23.0\r\nrlp==1.2.0\r\nrpcudp==3.0.0\r\nruamel.yaml==0.15.98\r\nsix==1.15.0\r\nsniffio==1.1.0\r\nsortedcontainers==2.1.0\r\nSQLAlchemy==1.3.17\r\nssz==0.2.3\r\ntermcolor==1.1.0\r\ntoolz==0.10.0\r\ntraitlets==4.3.3\r\ntrie==1.4.0\r\ntrinity==0.1.0a35\r\ntrio==0.13.0\r\ntrio-typing==0.3.0\r\ntyped-ast==1.4.1\r\ntyping-extensions==3.7.4.2\r\nu-msgpack-python==2.6.0\r\nuPnPClient==0.0.8\r\nurllib3==1.25.9\r\nuvloop==0.14.0\r\nvarint==1.0.2\r\nwcwidth==0.1.9\r\nweb3==5.4.0\r\nwebsockets==8.1\r\nyarl==1.4.2\r\nzeroconf==0.27.0\r\nzipp==3.1.0\r\n\r\n### What is wrong?\r\nI had followed the 'Contributing' Guide on how to setup Trinity so that I can work on the GitHub Repo on my local machine. Then I initially setup the monitoring environment of InfluxDB and Grafana locally and wrote the corresponding guide to that for the docs. \r\nNow I ran into issues with my Trinity Setup while checking out other commits from the repo and form one day to the other I couldn't start trinity anymore and I have no idea what I did to cause that. Ultimately, after retracing all my steps to get back to my initial (working) setup and fiddeling around with it, I decided to delete the whole folder with the repo and clone again, following the guide but now I am struggling to make it work again. \r\n\r\nI used the command \r\n`trinity --enable-metrics --metrics-host \"test\" --metrics-influx-server \"localhost\" --metrics-influx-password \"trinity\" --metrics-influx-protocol http --metrics-influx-port 8086` \r\nbut the error message is: argument subcommand: invalid choice: 'test' (choose from 'attach', 'db-shell', 'fix-unclean-shutdown', 'remove-network-db', 'export', 'import')\r\n\r\nAlso under `trinity --help` there is the no mention of the flags `--metrics-host`, `--metrics-influx-server`, `--metrics-influx-password`, `metrics-influx-protocol http` or `--metrics-influx-port 8086` that I used before and wrote down in the guide. \r\n\r\n### How can it be fixed\r\nI don't know :( I've tried to fix it for several days now. Can anyone help me please? \r\n",
  "closed_by": {
    "login": "cburgdorf",
    "id": 521109,
    "node_id": "MDQ6VXNlcjUyMTEwOQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/521109?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cburgdorf",
    "html_url": "https://github.com/cburgdorf",
    "followers_url": "https://api.github.com/users/cburgdorf/followers",
    "following_url": "https://api.github.com/users/cburgdorf/following{/other_user}",
    "gists_url": "https://api.github.com/users/cburgdorf/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cburgdorf/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cburgdorf/subscriptions",
    "organizations_url": "https://api.github.com/users/cburgdorf/orgs",
    "repos_url": "https://api.github.com/users/cburgdorf/repos",
    "events_url": "https://api.github.com/users/cburgdorf/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cburgdorf/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/1944/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/py-evm/issues/1944/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/636445561",
    "html_url": "https://github.com/ethereum/py-evm/issues/1944#issuecomment-636445561",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/1944",
    "id": 636445561,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNjQ0NTU2MQ==",
    "user": {
      "login": "cburgdorf",
      "id": 521109,
      "node_id": "MDQ6VXNlcjUyMTEwOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/521109?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cburgdorf",
      "html_url": "https://github.com/cburgdorf",
      "followers_url": "https://api.github.com/users/cburgdorf/followers",
      "following_url": "https://api.github.com/users/cburgdorf/following{/other_user}",
      "gists_url": "https://api.github.com/users/cburgdorf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cburgdorf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cburgdorf/subscriptions",
      "organizations_url": "https://api.github.com/users/cburgdorf/orgs",
      "repos_url": "https://api.github.com/users/cburgdorf/repos",
      "events_url": "https://api.github.com/users/cburgdorf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cburgdorf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-31T09:28:59Z",
    "updated_at": "2020-05-31T09:28:59Z",
    "author_association": "MEMBER",
    "body": "\r\n>but the error message is: argument subcommand: invalid choice: 'test' (choose from 'attach', 'db-shell', 'fix-unclean-shutdown', 'remove-network-db', 'export', 'import')\r\n\r\nThe error message seems weird. It would suggest \"test\" is used as a subcommand as in `trinity test`\r\n\r\n>Also under trinity --help there is the no mention of the flags `--metrics-host, --metrics-influx-server`\r\n\r\nThis seems to be further evidence that something is off because I do see them listed.\r\n\r\n```\r\n$ trinity --help\r\n(...omitting irrelevant parts)\r\nmetrics:\r\n  --enable-metrics      Enable metrics component\r\n  --metrics-host METRICS_HOST\r\n                        Host name to tag the metrics data (e.g. trinity-\r\n                        bootnode-europe-pt)\r\n  --metrics-influx-user METRICS_INFLUX_USER\r\n                        Influx DB user. Defaults to `trinity`\r\n  --metrics-influx-database METRICS_INFLUX_DATABASE\r\n                        Influx DB name. Defaults to `trinity`\r\n  --metrics-influx-password METRICS_INFLUX_PASSWORD\r\n                        Influx DB password. Defaults to ENV var\r\n                        TRINITY_METRICS_INFLUX_DB_PW\r\n  --metrics-influx-server METRICS_INFLUX_SERVER\r\n                        Influx DB server. Defaults to ENV var\r\n                        TRINITY_METRICS_INFLUX_DB_SERVER\r\n  --metrics-influx-port METRICS_INFLUX_PORT\r\n                        Influx DB port. Defaults to ENV var\r\n                        TRINITY_METRICS_INFLUX_DB_PORT or 8086\r\n  --metrics-influx-protocol METRICS_INFLUX_PROTOCOL\r\n                        Influx DB protocol. Defaults to ENV var\r\n                        TRINITY_METRICS_INFLUX_DB_PROTOCOL or http\r\n  --metrics-reporting-frequency METRICS_REPORTING_FREQUENCY\r\n                        The frequency in seconds at which metrics are reported\r\n  --metrics-system-collector-frequency METRICS_SYSTEM_COLLECTOR_FREQUENCY\r\n                        The frequency in seconds at which system metrics are\r\n                        collected\r\n  --metrics-blockchain-collector-frequency METRICS_BLOCKCHAIN_COLLECTOR_FREQUENCY\r\n                        The frequency in seconds at which blockchain metrics\r\n                        are collected\r\n\r\n...\r\n```\r\n\r\nThat said, I also run in an error albeit a different one.\r\n\r\n>trinity.exceptions.MetricsReportingError: No 'trinity' process found.\r\n\r\nI have an idea where this is coming from. @njgheorghita recently added a metric to track the number of processes but the error seems to suggest that this doesn't work on my Ubuntu system. I believe Nick has tested this on a Mac and it probably behaves differently there.\r\n\r\nCan you do me a favor and post the following two things to help us debug your case:\r\n\r\n1. `git rev-parse HEAD` (to figure out the exact commit you are on)\r\n\r\n2. The shell output including your exact command and the following swall of errors you are getting.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/636445561/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/637102087",
    "html_url": "https://github.com/ethereum/py-evm/issues/1944#issuecomment-637102087",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/1944",
    "id": 637102087,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzEwMjA4Nw==",
    "user": {
      "login": "njgheorghita",
      "id": 9753150,
      "node_id": "MDQ6VXNlcjk3NTMxNTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9753150?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/njgheorghita",
      "html_url": "https://github.com/njgheorghita",
      "followers_url": "https://api.github.com/users/njgheorghita/followers",
      "following_url": "https://api.github.com/users/njgheorghita/following{/other_user}",
      "gists_url": "https://api.github.com/users/njgheorghita/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/njgheorghita/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/njgheorghita/subscriptions",
      "organizations_url": "https://api.github.com/users/njgheorghita/orgs",
      "repos_url": "https://api.github.com/users/njgheorghita/repos",
      "events_url": "https://api.github.com/users/njgheorghita/events{/privacy}",
      "received_events_url": "https://api.github.com/users/njgheorghita/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-01T21:06:55Z",
    "updated_at": "2020-06-01T21:06:55Z",
    "author_association": "MEMBER",
    "body": "@cburgdorf Yup - you nailed it. I have what I believe is a fix for the `No 'trinity' process found` in https://github.com/ethereum/trinity/pull/1765 - I've tested it on ubuntu instances on aws - but, it would be maybe helpful if you could verify that it works on your machine?\r\n\r\n@Lilith1410 Once when I forgot to activate my virtual environment, I got that exact same bug. But, after entering the virtual environment, everything started working normally. I'm not sure if that's the issue with your machine, but I'd guess it points towards some outdated dependencies/ misconfigured environment.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/637102087/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/637352317",
    "html_url": "https://github.com/ethereum/py-evm/issues/1944#issuecomment-637352317",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/1944",
    "id": 637352317,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzM1MjMxNw==",
    "user": {
      "login": "VMLVaske",
      "id": 32402989,
      "node_id": "MDQ6VXNlcjMyNDAyOTg5",
      "avatar_url": "https://avatars.githubusercontent.com/u/32402989?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/VMLVaske",
      "html_url": "https://github.com/VMLVaske",
      "followers_url": "https://api.github.com/users/VMLVaske/followers",
      "following_url": "https://api.github.com/users/VMLVaske/following{/other_user}",
      "gists_url": "https://api.github.com/users/VMLVaske/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/VMLVaske/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/VMLVaske/subscriptions",
      "organizations_url": "https://api.github.com/users/VMLVaske/orgs",
      "repos_url": "https://api.github.com/users/VMLVaske/repos",
      "events_url": "https://api.github.com/users/VMLVaske/events{/privacy}",
      "received_events_url": "https://api.github.com/users/VMLVaske/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-02T07:38:37Z",
    "updated_at": "2020-06-02T07:39:26Z",
    "author_association": "NONE",
    "body": "@cburgdorf sure! \r\n`git rev-parse HEAD` gives me: e40aac0ab2a9a2e7a703af0b94fafd1047ce6e55\r\nThe command i am using is `trinity --enable-metrics --trinity-tmp-root-dir --metrics-host \"test\" --metrics-influx-server \"localhost\" --metrics-influx-password \"trinity\"`. \r\nThe error message is `trinity: error: argument subcommand: invalid choice: 'test' (choose from 'attach', 'db-shell', 'fix-unclean-shutdown', 'remove-network-db', 'export', 'import')` \r\n\r\nI have checked Gitkraken again. Currently, I am on the lastest git commit (==master branch). But I have tried out several in between the last alpha-release and today (two days ago) but so far none I have tried, worked. \r\n\r\n@njgheorghita I tried again this morning :) started influxd and grafana-server services as usual, then `. venv/bin/activate` to activate the virtual environment. then the command listed above to start trinity with the metrics enabled. Does not work :( ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/637352317/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/637432717",
    "html_url": "https://github.com/ethereum/py-evm/issues/1944#issuecomment-637432717",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/1944",
    "id": 637432717,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNzQzMjcxNw==",
    "user": {
      "login": "cburgdorf",
      "id": 521109,
      "node_id": "MDQ6VXNlcjUyMTEwOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/521109?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cburgdorf",
      "html_url": "https://github.com/cburgdorf",
      "followers_url": "https://api.github.com/users/cburgdorf/followers",
      "following_url": "https://api.github.com/users/cburgdorf/following{/other_user}",
      "gists_url": "https://api.github.com/users/cburgdorf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cburgdorf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cburgdorf/subscriptions",
      "organizations_url": "https://api.github.com/users/cburgdorf/orgs",
      "repos_url": "https://api.github.com/users/cburgdorf/repos",
      "events_url": "https://api.github.com/users/cburgdorf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cburgdorf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-02T09:59:55Z",
    "updated_at": "2020-06-02T09:59:55Z",
    "author_association": "MEMBER",
    "body": "We sorted this out offline. There was an old Trinity installation lingering around on the system that somehow interfered. Btw, I noticed this was opened in the wrong repository. Should have been in https://github.com/ethereum/trinity.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/637432717/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
