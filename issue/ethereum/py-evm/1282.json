{
  "url": "https://api.github.com/repos/ethereum/py-evm/issues/1282",
  "repository_url": "https://api.github.com/repos/ethereum/py-evm",
  "labels_url": "https://api.github.com/repos/ethereum/py-evm/issues/1282/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/py-evm/issues/1282/comments",
  "events_url": "https://api.github.com/repos/ethereum/py-evm/issues/1282/events",
  "html_url": "https://github.com/ethereum/py-evm/issues/1282",
  "id": 359541976,
  "node_id": "MDU6SXNzdWUzNTk1NDE5NzY=",
  "number": 1282,
  "title": "Remote peers disconnecting with a bad_protocol reason immediately after handshake",
  "user": {
    "login": "gsalgado",
    "id": 412274,
    "node_id": "MDQ6VXNlcjQxMjI3NA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/412274?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gsalgado",
    "html_url": "https://github.com/gsalgado",
    "followers_url": "https://api.github.com/users/gsalgado/followers",
    "following_url": "https://api.github.com/users/gsalgado/following{/other_user}",
    "gists_url": "https://api.github.com/users/gsalgado/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gsalgado/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gsalgado/subscriptions",
    "organizations_url": "https://api.github.com/users/gsalgado/orgs",
    "repos_url": "https://api.github.com/users/gsalgado/repos",
    "events_url": "https://api.github.com/users/gsalgado/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gsalgado/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2018-09-12T15:43:58Z",
  "updated_at": "2018-09-13T09:31:44Z",
  "closed_at": "2018-09-13T09:31:44Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "I'm testing discv5 in light mode and am seeing lots of peers disconnecting from us with a bad_protocol reason immediately after the handshake is successfully completed. Need to investigate but I guess we're doing something wrong\r\n\r\n```\r\n   DEBUG  09-04 22:28:38      server  Receiving handshake from Address(80.111.20.180:udp:54907|tcp:54907)\r\n   DEBUG  09-04 22:28:39        peer  Finished P2P handshake with <Node(0xc79e@80.111.20.180)>, using sub-protocol (les, 2)\r\n   DEBUG  09-04 22:28:39       proto  Sending LES/Status msg: {'announceType': 1, 'protocolVersion': 2, 'networkId': 1, 'headTd': 169726491918314, 'headHash': b'R\\xf4FQg\\xa5vw\\xd1\\xca!                           \\x0f=s\\xbay\\xca8\\xe3\\xbe\\xd7#/\\x02l\\x05\\x8a\\xf2\\x81\\xac\\xc8+', 'headNum': 3629, 'genesisHash': b'\\xd4\\xe5g@\\xf8v\\xae\\xf8\\xc0\\x10\\xb8j@\\xd5\\xf5gE\\xa1\\x18\\xd0\\x90j4\\xe6\\x9a\\xec\\x8c\\r\\xb1\\xcb\\x8f\\xa3',             'serveHeaders': None, 'serveChainSince': 0, 'txRelay': None}\r\n   DEBUG  09-04 22:28:39        peer  Finished (les, 2) handshake with <Node(0xc79e@80.111.20.180)>\r\n   DEBUG  09-04 22:28:39    managers  Launching ResponseCandidateStream for peer LESPeer <Node(0xc79e@80.111.20.180)>\r\n   DEBUG  09-04 22:28:39        peer  LESPeer <Node(0xc79e@80.111.20.180)> disconnected: subprotocol_error\r\n   DEBUG  09-04 22:28:39     service  <ResponseCandidateStream(LESPeer <Node(0xc79e@80.111.20.180)>, <class 'trinity.protocol.les.commands.BlockHeaders'>)> finished: Cancellation requested by LESPeer token\r\n   DEBUG  09-04 22:28:39     service  <ResponseCandidateStream(LESPeer <Node(0xc79e@80.111.20.180)>, <class 'trinity.protocol.les.commands.BlockHeaders'>)> halted cleanly\r\n   DEBUG  09-04 22:28:39     service  LESPeer <Node(0xc79e@80.111.20.180)> halted cleanly\r\n```\r\n",
  "closed_by": {
    "login": "gsalgado",
    "id": 412274,
    "node_id": "MDQ6VXNlcjQxMjI3NA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/412274?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gsalgado",
    "html_url": "https://github.com/gsalgado",
    "followers_url": "https://api.github.com/users/gsalgado/followers",
    "following_url": "https://api.github.com/users/gsalgado/following{/other_user}",
    "gists_url": "https://api.github.com/users/gsalgado/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gsalgado/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gsalgado/subscriptions",
    "organizations_url": "https://api.github.com/users/gsalgado/orgs",
    "repos_url": "https://api.github.com/users/gsalgado/repos",
    "events_url": "https://api.github.com/users/gsalgado/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gsalgado/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/1282/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/py-evm/issues/1282/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[

]
