{
  "url": "https://api.github.com/repos/ethereum/py-evm/issues/605",
  "repository_url": "https://api.github.com/repos/ethereum/py-evm",
  "labels_url": "https://api.github.com/repos/ethereum/py-evm/issues/605/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/py-evm/issues/605/comments",
  "events_url": "https://api.github.com/repos/ethereum/py-evm/issues/605/events",
  "html_url": "https://github.com/ethereum/py-evm/issues/605",
  "id": 318286189,
  "node_id": "MDU6SXNzdWUzMTgyODYxODk=",
  "number": 605,
  "title": "Use Circle-CI parallelism",
  "user": {
    "login": "pipermerriam",
    "id": 824194,
    "node_id": "MDQ6VXNlcjgyNDE5NA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/824194?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pipermerriam",
    "html_url": "https://github.com/pipermerriam",
    "followers_url": "https://api.github.com/users/pipermerriam/followers",
    "following_url": "https://api.github.com/users/pipermerriam/following{/other_user}",
    "gists_url": "https://api.github.com/users/pipermerriam/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pipermerriam/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pipermerriam/subscriptions",
    "organizations_url": "https://api.github.com/users/pipermerriam/orgs",
    "repos_url": "https://api.github.com/users/pipermerriam/repos",
    "events_url": "https://api.github.com/users/pipermerriam/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pipermerriam/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2018-04-27T05:55:01Z",
  "updated_at": "2018-07-11T22:02:29Z",
  "closed_at": "2018-07-11T22:02:29Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Circle CI will allow us to condense our tests down into a much smaller number of runs using parallelism.  We can setup a much smaller number of jobs, and instead setup the steps in a single job to be all of the different CI runs we need.  Circle lets us define that those steps can be run in parallel and will parallelize them.  With this approach we should be able to cut off a significant amount of overhead to our test runs.",
  "closed_by": {
    "login": "pipermerriam",
    "id": 824194,
    "node_id": "MDQ6VXNlcjgyNDE5NA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/824194?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pipermerriam",
    "html_url": "https://github.com/pipermerriam",
    "followers_url": "https://api.github.com/users/pipermerriam/followers",
    "following_url": "https://api.github.com/users/pipermerriam/following{/other_user}",
    "gists_url": "https://api.github.com/users/pipermerriam/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pipermerriam/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pipermerriam/subscriptions",
    "organizations_url": "https://api.github.com/users/pipermerriam/orgs",
    "repos_url": "https://api.github.com/users/pipermerriam/repos",
    "events_url": "https://api.github.com/users/pipermerriam/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pipermerriam/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/605/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/py-evm/issues/605/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/384871924",
    "html_url": "https://github.com/ethereum/py-evm/issues/605#issuecomment-384871924",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/605",
    "id": 384871924,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDg3MTkyNA==",
    "user": {
      "login": "pipermerriam",
      "id": 824194,
      "node_id": "MDQ6VXNlcjgyNDE5NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/824194?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pipermerriam",
      "html_url": "https://github.com/pipermerriam",
      "followers_url": "https://api.github.com/users/pipermerriam/followers",
      "following_url": "https://api.github.com/users/pipermerriam/following{/other_user}",
      "gists_url": "https://api.github.com/users/pipermerriam/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pipermerriam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pipermerriam/subscriptions",
      "organizations_url": "https://api.github.com/users/pipermerriam/orgs",
      "repos_url": "https://api.github.com/users/pipermerriam/repos",
      "events_url": "https://api.github.com/users/pipermerriam/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pipermerriam/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-27T05:55:09Z",
    "updated_at": "2018-04-27T05:55:09Z",
    "author_association": "MEMBER",
    "body": "https://github.com/CircleCI-Public/circleci-demo-workflows/blob/fan-in-fan-out/.circleci/config.yml",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/384871924/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/385052098",
    "html_url": "https://github.com/ethereum/py-evm/issues/605#issuecomment-385052098",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/605",
    "id": 385052098,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTA1MjA5OA==",
    "user": {
      "login": "davesque",
      "id": 791437,
      "node_id": "MDQ6VXNlcjc5MTQzNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/791437?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/davesque",
      "html_url": "https://github.com/davesque",
      "followers_url": "https://api.github.com/users/davesque/followers",
      "following_url": "https://api.github.com/users/davesque/following{/other_user}",
      "gists_url": "https://api.github.com/users/davesque/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/davesque/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/davesque/subscriptions",
      "organizations_url": "https://api.github.com/users/davesque/orgs",
      "repos_url": "https://api.github.com/users/davesque/repos",
      "events_url": "https://api.github.com/users/davesque/events{/privacy}",
      "received_events_url": "https://api.github.com/users/davesque/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-27T18:15:35Z",
    "updated_at": "2018-04-27T18:15:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "I see now what you were talking about in our earlier conversation.\r\n\r\nNot sure if we can really leverage this any more than we're doing already.  We already fire off different jobs for each python version.\r\n\r\nOne thing which could possibly be done is to break up different portions of the test suite into different jobs (like maybe separate jobs for unit and property tests?).\r\n\r\nWe could also create our own custom docker image for testing which could include some of the common dependencies such as tox pre-installed.  That could mean some extra maintenance when those dependencies need to be upgraded but it might still be worth doing.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/385052098/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/385053449",
    "html_url": "https://github.com/ethereum/py-evm/issues/605#issuecomment-385053449",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/605",
    "id": 385053449,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTA1MzQ0OQ==",
    "user": {
      "login": "pipermerriam",
      "id": 824194,
      "node_id": "MDQ6VXNlcjgyNDE5NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/824194?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pipermerriam",
      "html_url": "https://github.com/pipermerriam",
      "followers_url": "https://api.github.com/users/pipermerriam/followers",
      "following_url": "https://api.github.com/users/pipermerriam/following{/other_user}",
      "gists_url": "https://api.github.com/users/pipermerriam/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pipermerriam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pipermerriam/subscriptions",
      "organizations_url": "https://api.github.com/users/pipermerriam/orgs",
      "repos_url": "https://api.github.com/users/pipermerriam/repos",
      "events_url": "https://api.github.com/users/pipermerriam/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pipermerriam/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-27T18:20:28Z",
    "updated_at": "2018-04-27T18:20:28Z",
    "author_association": "MEMBER",
    "body": "We could gain some speed increase by not initializing the fixtures submodule in tests that don't need it which probably adds up to at least 1-2 minutes of CI time across the 31 builds.  Now that I've read up more on parallelism in circle I think you're right that speed gains available through this method are minimal.  We could however, get our *number* of CI runs down to a smaller number with all the *sub* runs using parallelism.  Categories of runs that I see:\r\n\r\n- lint {py35,py36}\r\n- native fixture tests (py35,py36)\r\n- rpc fixture tests (py36)\r\n- non-fixture tests (core, database, p2p, trinity) (py35,py36)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/385053449/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/385056969",
    "html_url": "https://github.com/ethereum/py-evm/issues/605#issuecomment-385056969",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/605",
    "id": 385056969,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTA1Njk2OQ==",
    "user": {
      "login": "davesque",
      "id": 791437,
      "node_id": "MDQ6VXNlcjc5MTQzNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/791437?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/davesque",
      "html_url": "https://github.com/davesque",
      "followers_url": "https://api.github.com/users/davesque/followers",
      "following_url": "https://api.github.com/users/davesque/following{/other_user}",
      "gists_url": "https://api.github.com/users/davesque/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/davesque/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/davesque/subscriptions",
      "organizations_url": "https://api.github.com/users/davesque/orgs",
      "repos_url": "https://api.github.com/users/davesque/repos",
      "events_url": "https://api.github.com/users/davesque/events{/privacy}",
      "received_events_url": "https://api.github.com/users/davesque/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-27T18:33:37Z",
    "updated_at": "2018-04-27T18:35:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "Actually, sorry.  I guess it looks like we already split up different parts of the test suite into different tox envs and run a different job for each tox env and python version or something to that effect.  Also, I think we're saving and loading build caches properly so we might not really see any gains in that regard from a custom docker image.\r\n\r\nOtherwise, everything you said sounds right.  Shouldn't do any unnecessary work (like cloning unneeded fixtures).  And were you implying that it might also be good to *reduce* the number of build jobs to avoid clogging up the pipeline for other projects by lumping tests across multiple parts of the test suite and multiple python version into single build jobs?  If you want to run multiple python versions in the same job, it probably *will* be necessary to make a custom docker image unless one already exists that we can use.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/385056969/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/385062101",
    "html_url": "https://github.com/ethereum/py-evm/issues/605#issuecomment-385062101",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/605",
    "id": 385062101,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTA2MjEwMQ==",
    "user": {
      "login": "pipermerriam",
      "id": 824194,
      "node_id": "MDQ6VXNlcjgyNDE5NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/824194?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pipermerriam",
      "html_url": "https://github.com/pipermerriam",
      "followers_url": "https://api.github.com/users/pipermerriam/followers",
      "following_url": "https://api.github.com/users/pipermerriam/following{/other_user}",
      "gists_url": "https://api.github.com/users/pipermerriam/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pipermerriam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pipermerriam/subscriptions",
      "organizations_url": "https://api.github.com/users/pipermerriam/orgs",
      "repos_url": "https://api.github.com/users/pipermerriam/repos",
      "events_url": "https://api.github.com/users/pipermerriam/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pipermerriam/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-27T18:52:58Z",
    "updated_at": "2018-04-27T18:52:58Z",
    "author_association": "MEMBER",
    "body": "No, I was actually thinking about reducing the number of builds that circle reports into the pull request as right now we get 31 different builds.  I was thinking we could reduce to 6 \"builds\" according to the list above.  I don't know how that would effect visibility into what failed though.\r\n\r\nFor now I think I'll accept status-quo and let us get migrated before we start trying further optimizations since there is lower hanging fruit.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/385062101/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/404229755",
    "html_url": "https://github.com/ethereum/py-evm/issues/605#issuecomment-404229755",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/605",
    "id": 404229755,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNDIyOTc1NQ==",
    "user": {
      "login": "carver",
      "id": 205327,
      "node_id": "MDQ6VXNlcjIwNTMyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/205327?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/carver",
      "html_url": "https://github.com/carver",
      "followers_url": "https://api.github.com/users/carver/followers",
      "following_url": "https://api.github.com/users/carver/following{/other_user}",
      "gists_url": "https://api.github.com/users/carver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/carver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/carver/subscriptions",
      "organizations_url": "https://api.github.com/users/carver/orgs",
      "repos_url": "https://api.github.com/users/carver/repos",
      "events_url": "https://api.github.com/users/carver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/carver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-11T16:22:27Z",
    "updated_at": "2018-07-11T16:22:27Z",
    "author_association": "MEMBER",
    "body": "> For now I think I'll accept status-quo and let us get migrated before we start trying further optimizations since there is lower hanging fruit.\r\n\r\nUp for closing this issue until it becomes a higher priority?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/404229755/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
