{
  "url": "https://api.github.com/repos/ethereum/py-evm/issues/597",
  "repository_url": "https://api.github.com/repos/ethereum/py-evm",
  "labels_url": "https://api.github.com/repos/ethereum/py-evm/issues/597/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/py-evm/issues/597/comments",
  "events_url": "https://api.github.com/repos/ethereum/py-evm/issues/597/events",
  "html_url": "https://github.com/ethereum/py-evm/issues/597",
  "id": 317808281,
  "node_id": "MDU6SXNzdWUzMTc4MDgyODE=",
  "number": 597,
  "title": "Expand Chain object tests to use all mainnet VM rules",
  "user": {
    "login": "pipermerriam",
    "id": 824194,
    "node_id": "MDQ6VXNlcjgyNDE5NA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/824194?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pipermerriam",
    "html_url": "https://github.com/pipermerriam",
    "followers_url": "https://api.github.com/users/pipermerriam/followers",
    "following_url": "https://api.github.com/users/pipermerriam/following{/other_user}",
    "gists_url": "https://api.github.com/users/pipermerriam/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pipermerriam/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pipermerriam/subscriptions",
    "organizations_url": "https://api.github.com/users/pipermerriam/orgs",
    "repos_url": "https://api.github.com/users/pipermerriam/repos",
    "events_url": "https://api.github.com/users/pipermerriam/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pipermerriam/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2018-04-25T21:56:28Z",
  "updated_at": "2019-01-09T17:24:59Z",
  "closed_at": "2019-01-09T17:24:59Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "### What is wrong?\r\n\r\nThe tests in `tests/core/chain-object` are all using only the `SpuriousDragonVM`\r\n\r\nhttps://github.com/ethereum/py-evm/blob/48e94db187ed0b6166a6572f499ef624d5f987ce/tests/core/fixtures.py#L13\r\n\r\nWe really should be running these tests across all of the mainnet VMs.\r\n\r\n### How can it be fixed\r\n\r\nChange the tests so that they run against each set of VM rules.  This is probably best done by parametrizing the chain fixtures that are used.\r\n",
  "closed_by": {
    "login": "pipermerriam",
    "id": 824194,
    "node_id": "MDQ6VXNlcjgyNDE5NA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/824194?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pipermerriam",
    "html_url": "https://github.com/pipermerriam",
    "followers_url": "https://api.github.com/users/pipermerriam/followers",
    "following_url": "https://api.github.com/users/pipermerriam/following{/other_user}",
    "gists_url": "https://api.github.com/users/pipermerriam/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pipermerriam/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pipermerriam/subscriptions",
    "organizations_url": "https://api.github.com/users/pipermerriam/orgs",
    "repos_url": "https://api.github.com/users/pipermerriam/repos",
    "events_url": "https://api.github.com/users/pipermerriam/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pipermerriam/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/597/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/py-evm/issues/597/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/384589906",
    "html_url": "https://github.com/ethereum/py-evm/issues/597#issuecomment-384589906",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/597",
    "id": 384589906,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDU4OTkwNg==",
    "user": {
      "login": "cburgdorf",
      "id": 521109,
      "node_id": "MDQ6VXNlcjUyMTEwOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/521109?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cburgdorf",
      "html_url": "https://github.com/cburgdorf",
      "followers_url": "https://api.github.com/users/cburgdorf/followers",
      "following_url": "https://api.github.com/users/cburgdorf/following{/other_user}",
      "gists_url": "https://api.github.com/users/cburgdorf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cburgdorf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cburgdorf/subscriptions",
      "organizations_url": "https://api.github.com/users/cburgdorf/orgs",
      "repos_url": "https://api.github.com/users/cburgdorf/repos",
      "events_url": "https://api.github.com/users/cburgdorf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cburgdorf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-26T10:22:46Z",
    "updated_at": "2018-04-26T10:23:12Z",
    "author_association": "MEMBER",
    "body": "I've spend some time on this trying to figure out if this would be something I could possibly get done. I couldn't so far but wanted to at least drop a question:\r\n\r\nIs it supposed that all tests would work just fine if the chain fixture was exactly as it stands just with a different VM? In other words, given the following change, are the tests supposed to just workâ„¢?\r\n\r\n```diff\r\ndiff --git a/tests/core/fixtures.py b/tests/core/fixtures.py\r\nindex e2aecf1..5eb00fc 100644\r\n--- a/tests/core/fixtures.py\r\n+++ b/tests/core/fixtures.py\r\n@@ -10,8 +10,7 @@ from evm import Chain\r\n from evm import constants\r\n from evm.db import get_db_backend\r\n from evm.db.chain import ChainDB\r\n-from evm.vm.forks.spurious_dragon import SpuriousDragonVM\r\n-\r\n+from evm.vm.forks.byzantium import ByzantiumVM\r\n \r\n # This block is a child of the genesis defined in the chain fixture above and contains a single tx\r\n # that transfers 10 wei from 0xa94f5374fce5edbc8e2a8697c15331677e6ebf0b to\r\n@@ -85,7 +84,7 @@ def chain(chaindb, funded_address, funded_address_initial_balance):  # noqa: F81\r\n     klass = Chain.configure(\r\n         __name__='TestChain',\r\n         vm_configuration=(\r\n-            (constants.GENESIS_BLOCK_NUMBER, SpuriousDragonVM),\r\n+            (constants.GENESIS_BLOCK_NUMBER, ByzantiumVM),\r\n         ))\r\n     chain = klass.from_genesis(chaindb, genesis_params, genesis_state)\r\n     return chain\r\n@@ -112,7 +111,7 @@ def chain_without_block_validation(\r\n     klass = Chain.configure(\r\n         __name__='TestChainWithoutBlockValidation',\r\n         vm_configuration=(\r\n-            (constants.GENESIS_BLOCK_NUMBER, SpuriousDragonVM),\r\n+            (constants.GENESIS_BLOCK_NUMBER, ByzantiumVM),\r\n         ),\r\n         **overrides,\r\n     )\r\n\r\n```\r\n\r\nBecause that would already fail the tests. Running ` pytest tests/core/chain-object/ -k 'test_import_block_validation'` leaves me with\r\n\r\n```\r\nE       evm.exceptions.ValidationError: Mismatch between block and imported block on 2 fields:\r\nE        - header.state_root  :\r\nE           (actual)  : b'\\xec\\xc6\\x0e\\x00\\xb3\\xfe\\\\\\xe9\\xf6\\xe1\\xa1\\x0eTivM\\xafQ\\xf1\\xfe\\x93\\xc2.\\xc3\\xf9\\xa7X:\\x805r\\x17'\r\nE           (expected): b'\\x96Nl\\x99\\x95\\xe7\\xe3u~\\x93C\\x91\\xb4\\xf1kP\\xc2\\x04\\t\\xeeN\\xb9\\xab\\xd4\\xc4a|\\xb8\\x05D\\x9b\\x9a'\r\nE        - header.receipt_root:\r\nE           (actual)  : b'\\x05k#\\xfb\\xbaH\\x06\\x96\\xb6_\\xe5\\xa5\\x9b\\x8f!H\\xa1)\\x91\\x03\\xc4\\xf5}\\xf89#:\\xf2\\xcfL\\xa2\\xd2'\r\nE           (expected): b'\\xbc7\\xd7\\x97S\\xads\\x8am\\xacI!\\xe5s\\x92\\xf1E\\xd8\\x88tv\\xde?x=\\xfa~\\xda\\xe9(>R'\r\n\r\n```\r\n\r\nSo my first question really is: Does parametrization of the VMs need to go together with some other changes that need to be done or did this poking around revealed a bug because I can't tell these things apart yet.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/384589906/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/384760280",
    "html_url": "https://github.com/ethereum/py-evm/issues/597#issuecomment-384760280",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/597",
    "id": 384760280,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDc2MDI4MA==",
    "user": {
      "login": "pipermerriam",
      "id": 824194,
      "node_id": "MDQ6VXNlcjgyNDE5NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/824194?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pipermerriam",
      "html_url": "https://github.com/pipermerriam",
      "followers_url": "https://api.github.com/users/pipermerriam/followers",
      "following_url": "https://api.github.com/users/pipermerriam/following{/other_user}",
      "gists_url": "https://api.github.com/users/pipermerriam/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pipermerriam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pipermerriam/subscriptions",
      "organizations_url": "https://api.github.com/users/pipermerriam/orgs",
      "repos_url": "https://api.github.com/users/pipermerriam/repos",
      "events_url": "https://api.github.com/users/pipermerriam/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pipermerriam/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-26T19:20:43Z",
    "updated_at": "2018-04-26T19:20:43Z",
    "author_association": "MEMBER",
    "body": "No, not expected to *just* work across the board.  I don't think there's a single strategy to deal with this so I'd optimize for readability at the expense of verbosity if necessary. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/384760280/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/384760899",
    "html_url": "https://github.com/ethereum/py-evm/issues/597#issuecomment-384760899",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/597",
    "id": 384760899,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDc2MDg5OQ==",
    "user": {
      "login": "pipermerriam",
      "id": 824194,
      "node_id": "MDQ6VXNlcjgyNDE5NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/824194?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pipermerriam",
      "html_url": "https://github.com/pipermerriam",
      "followers_url": "https://api.github.com/users/pipermerriam/followers",
      "following_url": "https://api.github.com/users/pipermerriam/following{/other_user}",
      "gists_url": "https://api.github.com/users/pipermerriam/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pipermerriam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pipermerriam/subscriptions",
      "organizations_url": "https://api.github.com/users/pipermerriam/orgs",
      "repos_url": "https://api.github.com/users/pipermerriam/repos",
      "events_url": "https://api.github.com/users/pipermerriam/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pipermerriam/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-26T19:23:05Z",
    "updated_at": "2018-04-26T19:23:05Z",
    "author_association": "MEMBER",
    "body": "One thing you might look into is whether you can leverage https://github.com/ethereum/py-evm/tree/master/evm/tools/test_builder which supports different post-states for different networks.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/384760899/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/450498728",
    "html_url": "https://github.com/ethereum/py-evm/issues/597#issuecomment-450498728",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/597",
    "id": 450498728,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MDQ5ODcyOA==",
    "user": {
      "login": "Bhargavasomu",
      "id": 15922456,
      "node_id": "MDQ6VXNlcjE1OTIyNDU2",
      "avatar_url": "https://avatars.githubusercontent.com/u/15922456?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Bhargavasomu",
      "html_url": "https://github.com/Bhargavasomu",
      "followers_url": "https://api.github.com/users/Bhargavasomu/followers",
      "following_url": "https://api.github.com/users/Bhargavasomu/following{/other_user}",
      "gists_url": "https://api.github.com/users/Bhargavasomu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Bhargavasomu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Bhargavasomu/subscriptions",
      "organizations_url": "https://api.github.com/users/Bhargavasomu/orgs",
      "repos_url": "https://api.github.com/users/Bhargavasomu/repos",
      "events_url": "https://api.github.com/users/Bhargavasomu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Bhargavasomu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-29T15:02:36Z",
    "updated_at": "2018-12-29T15:02:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm on this.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/450498728/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/452647292",
    "html_url": "https://github.com/ethereum/py-evm/issues/597#issuecomment-452647292",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/597",
    "id": 452647292,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MjY0NzI5Mg==",
    "user": {
      "login": "Bhargavasomu",
      "id": 15922456,
      "node_id": "MDQ6VXNlcjE1OTIyNDU2",
      "avatar_url": "https://avatars.githubusercontent.com/u/15922456?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Bhargavasomu",
      "html_url": "https://github.com/Bhargavasomu",
      "followers_url": "https://api.github.com/users/Bhargavasomu/followers",
      "following_url": "https://api.github.com/users/Bhargavasomu/following{/other_user}",
      "gists_url": "https://api.github.com/users/Bhargavasomu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Bhargavasomu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Bhargavasomu/subscriptions",
      "organizations_url": "https://api.github.com/users/Bhargavasomu/orgs",
      "repos_url": "https://api.github.com/users/Bhargavasomu/repos",
      "events_url": "https://api.github.com/users/Bhargavasomu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Bhargavasomu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-09T10:26:35Z",
    "updated_at": "2019-01-09T10:26:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue should be closed with https://github.com/ethereum/py-evm/pull/1687",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/452647292/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
