{
  "url": "https://api.github.com/repos/ethereum/py-evm/issues/1959",
  "repository_url": "https://api.github.com/repos/ethereum/py-evm",
  "labels_url": "https://api.github.com/repos/ethereum/py-evm/issues/1959/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/py-evm/issues/1959/comments",
  "events_url": "https://api.github.com/repos/ethereum/py-evm/issues/1959/events",
  "html_url": "https://github.com/ethereum/py-evm/issues/1959",
  "id": 724561485,
  "node_id": "MDU6SXNzdWU3MjQ1NjE0ODU=",
  "number": 1959,
  "title": "Replace or improve blake2b-py dependency",
  "user": {
    "login": "MatthiasLohr",
    "id": 781926,
    "node_id": "MDQ6VXNlcjc4MTkyNg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/781926?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/MatthiasLohr",
    "html_url": "https://github.com/MatthiasLohr",
    "followers_url": "https://api.github.com/users/MatthiasLohr/followers",
    "following_url": "https://api.github.com/users/MatthiasLohr/following{/other_user}",
    "gists_url": "https://api.github.com/users/MatthiasLohr/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/MatthiasLohr/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/MatthiasLohr/subscriptions",
    "organizations_url": "https://api.github.com/users/MatthiasLohr/orgs",
    "repos_url": "https://api.github.com/users/MatthiasLohr/repos",
    "events_url": "https://api.github.com/users/MatthiasLohr/events{/privacy}",
    "received_events_url": "https://api.github.com/users/MatthiasLohr/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2020-10-19T12:23:45Z",
  "updated_at": "2021-09-02T07:47:35Z",
  "closed_at": "2021-09-02T07:47:35Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "* py-evm Version: 0.3.0a19\r\n* OS: linux\r\n* Python Version: Python 3.9.0rc1\r\n\r\n### What is wrong?\r\n\r\npy-evm depends on [blake2b-py](https://github.com/davesque/blake2b-py), which looks quite unmaintained. The PyPI package for blake2b-py comes with some prebuilt binaries, however for e.g. Python 3.9 or support on ARM architectures (Raspberry Pi) the only chance is to have it compiled. This requires to install the whole Rust toolchain to get it compiled (including: CI/CD stuff, there we would theoretically have to compile it for each commit!).\r\n\r\n### How it could be fixed?\r\n\r\nFor this reason I want to open the discussion, if there might be the chance to rely on another library for the required functionalities. Currently, some people including me are trying to reach the maintainer to get access to update the project, but for now there is no reaction from the maintainer.\r\n\r\nI'm looking forward to your opinions.",
  "closed_by": {
    "login": "cburgdorf",
    "id": 521109,
    "node_id": "MDQ6VXNlcjUyMTEwOQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/521109?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cburgdorf",
    "html_url": "https://github.com/cburgdorf",
    "followers_url": "https://api.github.com/users/cburgdorf/followers",
    "following_url": "https://api.github.com/users/cburgdorf/following{/other_user}",
    "gists_url": "https://api.github.com/users/cburgdorf/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cburgdorf/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cburgdorf/subscriptions",
    "organizations_url": "https://api.github.com/users/cburgdorf/orgs",
    "repos_url": "https://api.github.com/users/cburgdorf/repos",
    "events_url": "https://api.github.com/users/cburgdorf/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cburgdorf/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/1959/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/py-evm/issues/1959/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/874915892",
    "html_url": "https://github.com/ethereum/py-evm/issues/1959#issuecomment-874915892",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/1959",
    "id": 874915892,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NDkxNTg5Mg==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-06T16:41:14Z",
    "updated_at": "2021-07-06T23:55:53Z",
    "author_association": "MEMBER",
    "body": "Blake2 was [added 4 years ago](https://docs.python.org/3/library/hashlib.html#blake2) to `hashlib` (3.6+), and should be considered for updating this library moving forwards. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/874915892/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/875174365",
    "html_url": "https://github.com/ethereum/py-evm/issues/1959#issuecomment-875174365",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/1959",
    "id": 875174365,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NTE3NDM2NQ==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-07T00:30:55Z",
    "updated_at": "2021-07-07T00:33:51Z",
    "author_association": "MEMBER",
    "body": "After doing some digging, I noticed that this was indeed the way this was attempted before (see https://github.com/ethereum/py-evm/issues/1818), but it proved too slow (see https://github.com/ethereum/py-evm/issues/1836) to use in practice for the Trinity client. In either case, my suggestion to use the `hashlib` implementation was indeed not viable given the reasoning in those two issues.\r\n\r\nHowever, since the [Trinity client](https://github.com/ethereum/trinity) became obsolesced rather recently (reducing the necessity for sync-viable speed of this algorithm), and the numerous reported issues users have had setting up the Rust library on different platforms (see https://github.com/ethereum/blake2b-py/issues), as well as the problem that this issue notes about lack of support for blake2b-py... perhaps it would be time to reconsider this decision and move `py-evm` back to the slower native python implementation in order to reduce dependency and maintenance issues.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/875174365/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/875307877",
    "html_url": "https://github.com/ethereum/py-evm/issues/1959#issuecomment-875307877",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/1959",
    "id": 875307877,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NTMwNzg3Nw==",
    "user": {
      "login": "MatthiasLohr",
      "id": 781926,
      "node_id": "MDQ6VXNlcjc4MTkyNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/781926?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MatthiasLohr",
      "html_url": "https://github.com/MatthiasLohr",
      "followers_url": "https://api.github.com/users/MatthiasLohr/followers",
      "following_url": "https://api.github.com/users/MatthiasLohr/following{/other_user}",
      "gists_url": "https://api.github.com/users/MatthiasLohr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MatthiasLohr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MatthiasLohr/subscriptions",
      "organizations_url": "https://api.github.com/users/MatthiasLohr/orgs",
      "repos_url": "https://api.github.com/users/MatthiasLohr/repos",
      "events_url": "https://api.github.com/users/MatthiasLohr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MatthiasLohr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-07T05:59:43Z",
    "updated_at": "2021-07-07T05:59:43Z",
    "author_association": "NONE",
    "body": "What about making blake2b-py an optional dependency? So, if you install py-evm via `pip install py-evm` it will use the (slow, but struggle-free) hashlib implementation, if you use `pip install py-evm[blake2b-py]` it will additionally install the (faster, but maybe annoying setup required) rust-based variant. And the code has then to detect if blake2b-py is installed, if yes it will use it, if no it will fall back to hashlib.\r\n\r\nAny thoughts on that?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/875307877/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/875344930",
    "html_url": "https://github.com/ethereum/py-evm/issues/1959#issuecomment-875344930",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/1959",
    "id": 875344930,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NTM0NDkzMA==",
    "user": {
      "login": "cburgdorf",
      "id": 521109,
      "node_id": "MDQ6VXNlcjUyMTEwOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/521109?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cburgdorf",
      "html_url": "https://github.com/cburgdorf",
      "followers_url": "https://api.github.com/users/cburgdorf/followers",
      "following_url": "https://api.github.com/users/cburgdorf/following{/other_user}",
      "gists_url": "https://api.github.com/users/cburgdorf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cburgdorf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cburgdorf/subscriptions",
      "organizations_url": "https://api.github.com/users/cburgdorf/orgs",
      "repos_url": "https://api.github.com/users/cburgdorf/repos",
      "events_url": "https://api.github.com/users/cburgdorf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cburgdorf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-07T07:05:59Z",
    "updated_at": "2021-07-07T07:05:59Z",
    "author_association": "MEMBER",
    "body": ">What about making blake2b-py an optional dependency\r\n\r\nYes, I think that's the way to go. We've used that pattern before and it works well.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/875344930/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/875624953",
    "html_url": "https://github.com/ethereum/py-evm/issues/1959#issuecomment-875624953",
    "issue_url": "https://api.github.com/repos/ethereum/py-evm/issues/1959",
    "id": 875624953,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NTYyNDk1Mw==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-07T13:54:55Z",
    "updated_at": "2021-07-07T13:54:55Z",
    "author_association": "MEMBER",
    "body": "> > What about making blake2b-py an optional dependency\r\n> \r\n> Yes, I think that's the way to go. We've used that pattern before and it works well.\r\n\r\nOne thing to note is that the problem arises from `eth-tester` using `py-evm` when installed via `web3[tester]`, so the optional has to bubble up 2 levels to `web3` for it to work. e.g. `py-evm[blake2b-py]`, `eth-tester[py-evm,blake2-py]` and `web3[tester,blake2b-py]`",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/py-evm/issues/comments/875624953/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
