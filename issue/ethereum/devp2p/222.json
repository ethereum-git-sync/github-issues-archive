{
  "url": "https://api.github.com/repos/ethereum/devp2p/issues/222",
  "repository_url": "https://api.github.com/repos/ethereum/devp2p",
  "labels_url": "https://api.github.com/repos/ethereum/devp2p/issues/222/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/devp2p/issues/222/comments",
  "events_url": "https://api.github.com/repos/ethereum/devp2p/issues/222/events",
  "html_url": "https://github.com/ethereum/devp2p/issues/222",
  "id": 1609452672,
  "node_id": "I_kwDOAcJRYs5f7kyA",
  "number": 222,
  "title": "[Question] [RLPX] auth / auth-ack padding ",
  "user": {
    "login": "ana-prdekalo",
    "id": 126925611,
    "node_id": "U_kgDOB5C7Kw",
    "avatar_url": "https://avatars.githubusercontent.com/u/126925611?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ana-prdekalo",
    "html_url": "https://github.com/ana-prdekalo",
    "followers_url": "https://api.github.com/users/ana-prdekalo/followers",
    "following_url": "https://api.github.com/users/ana-prdekalo/following{/other_user}",
    "gists_url": "https://api.github.com/users/ana-prdekalo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ana-prdekalo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ana-prdekalo/subscriptions",
    "organizations_url": "https://api.github.com/users/ana-prdekalo/orgs",
    "repos_url": "https://api.github.com/users/ana-prdekalo/repos",
    "events_url": "https://api.github.com/users/ana-prdekalo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ana-prdekalo/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-03-04T00:13:24Z",
  "updated_at": "2023-03-05T10:51:40Z",
  "closed_at": "2023-03-05T10:41:57Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hello everyone, hopefully, this is the right place to ask the auth/ack padding questions.\r\n\r\n#### Q1\r\nCan someone please explain why we are applying arbitrary data to the end of the message? \r\nIs this just protection similar to the nonce? Or does this serve some other purpose?\r\n\r\nI've read that usually data is padded to make the total size of the message a multiple of the encryption block size, so that the original message size is unknown, but since this padding is of a random length, this doesn't seem to be the case.\r\n\r\n#### Q2\r\n\r\nThere is no _spec_ about the padded data size, but both rust implementations linked in _Readme_ append a random number of bytes, [100, 300].\r\n\r\nC/P from OpenEthereum implementation: \r\n```RS\r\n        encoded.resize(encoded.len() + rand::thread_rng().gen_range(100, 301), 0);\r\n```\r\n\r\nWhy these numbers? Was this randomly chosen or there is some reasoning?\r\n\r\nThanks in advance!",
  "closed_by": {
    "login": "ana-prdekalo",
    "id": 126925611,
    "node_id": "U_kgDOB5C7Kw",
    "avatar_url": "https://avatars.githubusercontent.com/u/126925611?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ana-prdekalo",
    "html_url": "https://github.com/ana-prdekalo",
    "followers_url": "https://api.github.com/users/ana-prdekalo/followers",
    "following_url": "https://api.github.com/users/ana-prdekalo/following{/other_user}",
    "gists_url": "https://api.github.com/users/ana-prdekalo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ana-prdekalo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ana-prdekalo/subscriptions",
    "organizations_url": "https://api.github.com/users/ana-prdekalo/orgs",
    "repos_url": "https://api.github.com/users/ana-prdekalo/repos",
    "events_url": "https://api.github.com/users/ana-prdekalo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ana-prdekalo/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/222/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/devp2p/issues/222/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1454730296",
    "html_url": "https://github.com/ethereum/devp2p/issues/222#issuecomment-1454730296",
    "issue_url": "https://api.github.com/repos/ethereum/devp2p/issues/222",
    "id": 1454730296,
    "node_id": "IC_kwDOAcJRYs5WtWw4",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-04T12:53:18Z",
    "updated_at": "2023-03-04T12:53:18Z",
    "author_association": "MEMBER",
    "body": "The random padding was added in [EIP-8](https://eips.ethereum.org/EIPS/eip-8#specification):\r\n\r\n> During the transitioning period (i.e. until the old format has been retired), implementations should pad auth-body with at least 100 bytes of junk data. Adding a random amount in range [100, 300] is recommended to vary the size of the packet.\r\n\r\nIt could be argued that the 'transitioning period' is now over. All Ethereum implementations support EIP-8, and most do not support pre-EIP-8 RLPx anymore.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1454730296/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1454731567",
    "html_url": "https://github.com/ethereum/devp2p/issues/222#issuecomment-1454731567",
    "issue_url": "https://api.github.com/repos/ethereum/devp2p/issues/222",
    "id": 1454731567,
    "node_id": "IC_kwDOAcJRYs5WtXEv",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-04T12:57:56Z",
    "updated_at": "2023-03-04T12:57:56Z",
    "author_association": "MEMBER",
    "body": "The technical reason why the padding was added is making the two handshake formats distinguishable by size. In order to understand why this solution was chosen, you must know that RLPx before EIP-8 did not have any kind of version number, and all implementations used a fixed-size initial read from the connection to process the handshake. We had to grow the initial packet a bit.\r\n\r\nWhile the EIP was being discussed, people voiced concerns that a plain-text size prefix would be 'too recognizable', i.e. the very first byte sent on RLPx connections would always be exactly the same. That's why a *random* padding amount was specified.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1454731567/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1455053045",
    "html_url": "https://github.com/ethereum/devp2p/issues/222#issuecomment-1455053045",
    "issue_url": "https://api.github.com/repos/ethereum/devp2p/issues/222",
    "id": 1455053045,
    "node_id": "IC_kwDOAcJRYs5Wulj1",
    "user": {
      "login": "ana-prdekalo",
      "id": 126925611,
      "node_id": "U_kgDOB5C7Kw",
      "avatar_url": "https://avatars.githubusercontent.com/u/126925611?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ana-prdekalo",
      "html_url": "https://github.com/ana-prdekalo",
      "followers_url": "https://api.github.com/users/ana-prdekalo/followers",
      "following_url": "https://api.github.com/users/ana-prdekalo/following{/other_user}",
      "gists_url": "https://api.github.com/users/ana-prdekalo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ana-prdekalo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ana-prdekalo/subscriptions",
      "organizations_url": "https://api.github.com/users/ana-prdekalo/orgs",
      "repos_url": "https://api.github.com/users/ana-prdekalo/repos",
      "events_url": "https://api.github.com/users/ana-prdekalo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ana-prdekalo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-05T10:41:57Z",
    "updated_at": "2023-03-05T10:41:57Z",
    "author_association": "NONE",
    "body": "I completely missed the EIP-8 link at the bottom of the specs 🤦‍♂️ Sorry for wasting your time, and thank you very much for the detailed explanations :)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1455053045/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1455055112",
    "html_url": "https://github.com/ethereum/devp2p/issues/222#issuecomment-1455055112",
    "issue_url": "https://api.github.com/repos/ethereum/devp2p/issues/222",
    "id": 1455055112,
    "node_id": "IC_kwDOAcJRYs5WumEI",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-05T10:51:40Z",
    "updated_at": "2023-03-05T10:51:40Z",
    "author_association": "MEMBER",
    "body": "Don't worry, it is my job to answer questions like that!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1455055112/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
