{
  "url": "https://api.github.com/repos/ethereum/devp2p/issues/245",
  "repository_url": "https://api.github.com/repos/ethereum/devp2p",
  "labels_url": "https://api.github.com/repos/ethereum/devp2p/issues/245/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/devp2p/issues/245/comments",
  "events_url": "https://api.github.com/repos/ethereum/devp2p/issues/245/events",
  "html_url": "https://github.com/ethereum/devp2p/issues/245",
  "id": 1837173965,
  "node_id": "I_kwDOAcJRYs5tgQzN",
  "number": 245,
  "title": "Eth68 encoding of `txType` doesn't match client implementations for `NewPooledTransactionHashes`",
  "user": {
    "login": "acolytec3",
    "id": 17355484,
    "node_id": "MDQ6VXNlcjE3MzU1NDg0",
    "avatar_url": "https://avatars.githubusercontent.com/u/17355484?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/acolytec3",
    "html_url": "https://github.com/acolytec3",
    "followers_url": "https://api.github.com/users/acolytec3/followers",
    "following_url": "https://api.github.com/users/acolytec3/following{/other_user}",
    "gists_url": "https://api.github.com/users/acolytec3/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/acolytec3/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/acolytec3/subscriptions",
    "organizations_url": "https://api.github.com/users/acolytec3/orgs",
    "repos_url": "https://api.github.com/users/acolytec3/repos",
    "events_url": "https://api.github.com/users/acolytec3/events{/privacy}",
    "received_events_url": "https://api.github.com/users/acolytec3/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-08-04T18:27:36Z",
  "updated_at": "2023-08-07T16:29:33Z",
  "closed_at": "2023-08-07T16:29:33Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "The current spec for the Eth68 message format for `NewPooledTransactionHashes` is this:\r\n`[[txtype₁: P, txtype₂: P, ...], [txsize₁: P, txsize₂: P, ...], [txhash₁: B_32, txhash₂: B_32, ...]]` \r\n\r\nGeth (followed by Nethermind, [Reth](https://github.com/paradigmxyz/reth/blob/689b9d635823022470b30e4112b722a48fce144d/crates/net/eth-wire/src/types/broadcast.rs#L244C7-L244C7), and EthereumJS) have implemented \r\n`[ txType1: P || txType2: P || txType3: P, [size1: P, size2: P, size3: P], [th1: B_32, th2: B_32, th3: B_32]]`, the key difference being that the transaction types array is flattened into one concatenated RLP string  where each individual byte represents a transaction type rather than an RLP list with elements of type `P` (assumed to be unpadded bytes though this is not documented anywhere that I could find).\r\n\r\nThis does make sense since `TransactionType` is borrowed from [EIP2718](https://eips.ethereum.org/EIPS/eip-2718) where `TransactionType` is not anticipated to be greater than 0x7f so will always fit in a single byte/uint8.\r\n\r\nAs such, we should either update the spec for Eth68 to match what has been implemented by the various clients or else have the client teams update code to match the current spec.  \r\n\r\nCurrent behavior can be tested using [this hive test \"Request Blob Pooled Transactions\" in the suite linked in this fork of Hive](https://github.com/marioevz/hive/tree/cancun-dn8-4844-4788/simulators/ethereum/engine/suites/blobs) ",
  "closed_by": {
    "login": "fjl",
    "id": 6915,
    "node_id": "MDQ6VXNlcjY5MTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fjl",
    "html_url": "https://github.com/fjl",
    "followers_url": "https://api.github.com/users/fjl/followers",
    "following_url": "https://api.github.com/users/fjl/following{/other_user}",
    "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
    "organizations_url": "https://api.github.com/users/fjl/orgs",
    "repos_url": "https://api.github.com/users/fjl/repos",
    "events_url": "https://api.github.com/users/fjl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fjl/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/245/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/devp2p/issues/245/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1667834283",
    "html_url": "https://github.com/ethereum/devp2p/issues/245#issuecomment-1667834283",
    "issue_url": "https://api.github.com/repos/ethereum/devp2p/issues/245",
    "id": 1667834283,
    "node_id": "IC_kwDOAcJRYs5jaSGr",
    "user": {
      "login": "acolytec3",
      "id": 17355484,
      "node_id": "MDQ6VXNlcjE3MzU1NDg0",
      "avatar_url": "https://avatars.githubusercontent.com/u/17355484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/acolytec3",
      "html_url": "https://github.com/acolytec3",
      "followers_url": "https://api.github.com/users/acolytec3/followers",
      "following_url": "https://api.github.com/users/acolytec3/following{/other_user}",
      "gists_url": "https://api.github.com/users/acolytec3/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/acolytec3/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/acolytec3/subscriptions",
      "organizations_url": "https://api.github.com/users/acolytec3/orgs",
      "repos_url": "https://api.github.com/users/acolytec3/repos",
      "events_url": "https://api.github.com/users/acolytec3/events{/privacy}",
      "received_events_url": "https://api.github.com/users/acolytec3/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-07T13:12:12Z",
    "updated_at": "2023-08-07T15:57:18Z",
    "author_association": "MEMBER",
    "body": "Just to follow up here with notes from conversation on the R&D Discord.  Erigon confirmed they also implemented the \"wrong\" version, following geth. \r\n\r\nThere is general agreement to consider either modifying the eth/68 spec to match current implementations or else deprecate and replace with a new eth/69 spec that all teams agree on.\r\n\r\nWill discuss this on the dencun testing call today ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1667834283/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1668118158",
    "html_url": "https://github.com/ethereum/devp2p/issues/245#issuecomment-1668118158",
    "issue_url": "https://api.github.com/repos/ethereum/devp2p/issues/245",
    "id": 1668118158,
    "node_id": "IC_kwDOAcJRYs5jbXaO",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-07T15:43:53Z",
    "updated_at": "2023-08-07T15:43:53Z",
    "author_association": "MEMBER",
    "body": "On the Dencun testing call, it was decided we will change the eth/68 spec to match the thing implementations are doing.\r\n\r\nWe can change the tx announcement message again in eth/69, whenever that happens.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1668118158/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1668153549",
    "html_url": "https://github.com/ethereum/devp2p/issues/245#issuecomment-1668153549",
    "issue_url": "https://api.github.com/repos/ethereum/devp2p/issues/245",
    "id": 1668153549,
    "node_id": "IC_kwDOAcJRYs5jbgDN",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-07T16:03:37Z",
    "updated_at": "2023-08-07T16:03:37Z",
    "author_association": "MEMBER",
    "body": "Spec change: https://github.com/ethereum/devp2p/pull/246",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1668153549/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 1,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
