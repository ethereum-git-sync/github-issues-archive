{
  "url": "https://api.github.com/repos/ethereum/devp2p/issues/83",
  "repository_url": "https://api.github.com/repos/ethereum/devp2p",
  "labels_url": "https://api.github.com/repos/ethereum/devp2p/issues/83/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/devp2p/issues/83/comments",
  "events_url": "https://api.github.com/repos/ethereum/devp2p/issues/83/events",
  "html_url": "https://github.com/ethereum/devp2p/issues/83",
  "id": 432521742,
  "node_id": "MDU6SXNzdWU0MzI1MjE3NDI=",
  "number": 83,
  "title": "discv5: transport pre-negotiation packet (LETSTALK)",
  "user": {
    "login": "FrankSzendzielarz",
    "id": 33515470,
    "node_id": "MDQ6VXNlcjMzNTE1NDcw",
    "avatar_url": "https://avatars.githubusercontent.com/u/33515470?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/FrankSzendzielarz",
    "html_url": "https://github.com/FrankSzendzielarz",
    "followers_url": "https://api.github.com/users/FrankSzendzielarz/followers",
    "following_url": "https://api.github.com/users/FrankSzendzielarz/following{/other_user}",
    "gists_url": "https://api.github.com/users/FrankSzendzielarz/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/FrankSzendzielarz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/FrankSzendzielarz/subscriptions",
    "organizations_url": "https://api.github.com/users/FrankSzendzielarz/orgs",
    "repos_url": "https://api.github.com/users/FrankSzendzielarz/repos",
    "events_url": "https://api.github.com/users/FrankSzendzielarz/events{/privacy}",
    "received_events_url": "https://api.github.com/users/FrankSzendzielarz/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1272598186,
      "node_id": "MDU6TGFiZWwxMjcyNTk4MTg2",
      "url": "https://api.github.com/repos/ethereum/devp2p/labels/proposal",
      "name": "proposal",
      "color": "bffc9f",
      "default": false,
      "description": "Ideas and proposals related to devp2p"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": {
    "url": "https://api.github.com/repos/ethereum/devp2p/milestones/2",
    "html_url": "https://github.com/ethereum/devp2p/milestone/2",
    "labels_url": "https://api.github.com/repos/ethereum/devp2p/milestones/2/labels",
    "id": 4220807,
    "node_id": "MDk6TWlsZXN0b25lNDIyMDgwNw==",
    "number": 2,
    "title": "Discovery v5.1",
    "description": "",
    "creator": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 22,
    "state": "closed",
    "created_at": "2019-04-11T11:36:18Z",
    "updated_at": "2020-10-07T19:09:49Z",
    "due_on": null,
    "closed_at": "2020-10-07T19:09:49Z"
  },
  "comments": 3,
  "created_at": "2019-04-12T11:33:46Z",
  "updated_at": "2020-10-07T14:30:19Z",
  "closed_at": "2020-10-07T14:30:19Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "This is more of a discussion starter / idea than a concrete proposal:\r\n\r\nAlthough it's not yet documented, the discv5 spec seems to be evolving towards encrypted aes-gcm based communication, rather than obfuscation and recoverable signatures....\r\n\r\nAssuming we get there, the following idea:\r\n\r\n0) The discv5 protocol now involves a quick handshake of secrets and keys from ENRs, before any kind of Kademlia communication can happen\r\n1) Aes-gcm allows parallel communication\r\n2) Can the same shared secrets and cypher ('channel') be re-used for TCP?\r\n3) Because it is aes-gcm, large messages can be streamed.\r\n4) This would allow ETH (etc) protocol to work without handshake.\r\n\r\nRegarding libp2p - other implementations that want to use libp2p for flexibility and interoperability could do so (eg: polkadot) - and they could be able to communicate with nodes that use such a mechanism as proposed above (???). Eth 2.0 will use discovery v5 anyway in all likelihood.\r\n\r\nHowever, for implementations that want to deliver a single performance optimized method of networking that employs a common udp+tcp handshake, the discovery 'channel' (pardon the pun) and this aes-gcm encrypted communication would be all that was needed, as long as the transport was reliable. Which particular transport outside of TCP could in future be determined by ENR (eg: ETH = tcp 30303, http 80 etc)\r\n\r\nThoughts?\r\n",
  "closed_by": {
    "login": "fjl",
    "id": 6915,
    "node_id": "MDQ6VXNlcjY5MTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fjl",
    "html_url": "https://github.com/fjl",
    "followers_url": "https://api.github.com/users/fjl/followers",
    "following_url": "https://api.github.com/users/fjl/following{/other_user}",
    "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
    "organizations_url": "https://api.github.com/users/fjl/orgs",
    "repos_url": "https://api.github.com/users/fjl/repos",
    "events_url": "https://api.github.com/users/fjl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fjl/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/83/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/devp2p/issues/83/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/521667424",
    "html_url": "https://github.com/ethereum/devp2p/issues/83#issuecomment-521667424",
    "issue_url": "https://api.github.com/repos/ethereum/devp2p/issues/83",
    "id": 521667424,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMTY2NzQyNA==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-15T14:45:47Z",
    "updated_at": "2019-08-15T14:45:47Z",
    "author_association": "MEMBER",
    "body": "If needed, we can add a protocol message like `LETSTALK` to help with establishing communication through another transport protocol. This kind of message can relay key material or initialization data for a new connection. \r\n\r\nRegarding the secrets, I think the outputs of the handshake should NOT be reused in any way. It's fragile enough as-is.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/521667424/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/557606800",
    "html_url": "https://github.com/ethereum/devp2p/issues/83#issuecomment-557606800",
    "issue_url": "https://api.github.com/repos/ethereum/devp2p/issues/83",
    "id": 557606800,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzYwNjgwMA==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-22T16:47:51Z",
    "updated_at": "2019-11-22T16:48:06Z",
    "author_association": "MEMBER",
    "body": "The need for this is now becoming more urgent since @zsfelfoldi wants to add pre-negotiation to les. \r\n\r\nHere's the use case: when a client finds a server, it needs to establish a TCP connnection and run the handshake only to find out that the provided service is too expensive or not enough capacity is available. Discovery should be able help with this issue by providing enough information to make an informed connectivity decision.\r\n\r\nWith the LETSTALK packet from the previous comment, pre-negotiation would look as follows:\r\n\r\n```\r\nA -> B   LETSTALK [<req-id>, \"les\"]\r\nA <- B   LETSTALKRESPONSE [<req-id>, <server-info>]\r\n```\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/557606800/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/557607073",
    "html_url": "https://github.com/ethereum/devp2p/issues/83#issuecomment-557607073",
    "issue_url": "https://api.github.com/repos/ethereum/devp2p/issues/83",
    "id": 557607073,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzYwNzA3Mw==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-22T16:48:36Z",
    "updated_at": "2019-11-22T16:48:36Z",
    "author_association": "MEMBER",
    "body": "We might need a better name for this new packet pair, and a clearer definition of its semantics.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/557607073/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
