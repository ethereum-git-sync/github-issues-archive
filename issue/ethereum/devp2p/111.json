{
  "url": "https://api.github.com/repos/ethereum/devp2p/issues/111",
  "repository_url": "https://api.github.com/repos/ethereum/devp2p",
  "labels_url": "https://api.github.com/repos/ethereum/devp2p/issues/111/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/devp2p/issues/111/comments",
  "events_url": "https://api.github.com/repos/ethereum/devp2p/issues/111/events",
  "html_url": "https://github.com/ethereum/devp2p/issues/111",
  "id": 482239638,
  "node_id": "MDU6SXNzdWU0ODIyMzk2Mzg=",
  "number": 111,
  "title": "discv5: ticket hoarding attack",
  "user": {
    "login": "fjl",
    "id": 6915,
    "node_id": "MDQ6VXNlcjY5MTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fjl",
    "html_url": "https://github.com/fjl",
    "followers_url": "https://api.github.com/users/fjl/followers",
    "following_url": "https://api.github.com/users/fjl/following{/other_user}",
    "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
    "organizations_url": "https://api.github.com/users/fjl/orgs",
    "repos_url": "https://api.github.com/users/fjl/repos",
    "events_url": "https://api.github.com/users/fjl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fjl/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2019-08-19T10:48:40Z",
  "updated_at": "2019-10-22T14:47:43Z",
  "closed_at": "2019-10-22T14:47:43Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "There is a really simple attack on the topic queue logic the way it is defined right now:\r\nThe wait period formula is supposed to keep ads in the queue for certain amount of time. \r\nSince the new wait period depends only on the time of the last successful registration,\r\nan attacker controlling many nodes may request lots of tickets (up to the queue limit) on the same queue concurrently. Those tickets will expire around the same time and can be used to replace all queue content. When this happens, the wait period will jump up to a very high value,\r\ni.e. not only will the queue be full with attacker-controlled nodes, the nodes will also stay in the queue for a long time.\r\n",
  "closed_by": {
    "login": "fjl",
    "id": 6915,
    "node_id": "MDQ6VXNlcjY5MTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fjl",
    "html_url": "https://github.com/fjl",
    "followers_url": "https://api.github.com/users/fjl/followers",
    "following_url": "https://api.github.com/users/fjl/following{/other_user}",
    "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
    "organizations_url": "https://api.github.com/users/fjl/orgs",
    "repos_url": "https://api.github.com/users/fjl/repos",
    "events_url": "https://api.github.com/users/fjl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fjl/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/111/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/devp2p/issues/111/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/522519650",
    "html_url": "https://github.com/ethereum/devp2p/issues/111#issuecomment-522519650",
    "issue_url": "https://api.github.com/repos/ethereum/devp2p/issues/111",
    "id": 522519650,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMjUxOTY1MA==",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-19T10:58:24Z",
    "updated_at": "2019-08-26T16:24:40Z",
    "author_association": "MEMBER",
    "body": "Here's an idea for fixing this problem:\r\n\r\nDrop the notion that getting a ticket means you're guaranteed to get registered, i.e. unify the semantics of REGTOPIC and REQTICKET. So you'd try to register, and get denied with a ticket for later. When you come back with the ticket, you can be registered or get another ticket depending only on how old the last entry in the queue is. Ticket hoarding still works with this countermeasure in place, but attackers wouldn't be able to take over the queue because the target lifetime is enforced when registering.\r\n\r\nThis approach is nice because it allows us to incorporate arbitrary other factors into the waiting time. Example: we may want to require registrants to re-validate tickets often (like every 10s) to ensure registrant nodes are live throughout the entire waiting time.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/522519650/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
