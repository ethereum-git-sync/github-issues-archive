{
  "url": "https://api.github.com/repos/ethereum/devp2p/issues/223",
  "repository_url": "https://api.github.com/repos/ethereum/devp2p",
  "labels_url": "https://api.github.com/repos/ethereum/devp2p/issues/223/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/devp2p/issues/223/comments",
  "events_url": "https://api.github.com/repos/ethereum/devp2p/issues/223/events",
  "html_url": "https://github.com/ethereum/devp2p/issues/223",
  "id": 1620319595,
  "node_id": "I_kwDOAcJRYs5glB1r",
  "number": 223,
  "title": "Receiving weird RLP message from GETH client",
  "user": {
    "login": "ana-prdekalo",
    "id": 126925611,
    "node_id": "U_kgDOB5C7Kw",
    "avatar_url": "https://avatars.githubusercontent.com/u/126925611?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ana-prdekalo",
    "html_url": "https://github.com/ana-prdekalo",
    "followers_url": "https://api.github.com/users/ana-prdekalo/followers",
    "following_url": "https://api.github.com/users/ana-prdekalo/following{/other_user}",
    "gists_url": "https://api.github.com/users/ana-prdekalo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ana-prdekalo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ana-prdekalo/subscriptions",
    "organizations_url": "https://api.github.com/users/ana-prdekalo/orgs",
    "repos_url": "https://api.github.com/users/ana-prdekalo/repos",
    "events_url": "https://api.github.com/users/ana-prdekalo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ana-prdekalo/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-03-12T10:57:09Z",
  "updated_at": "2023-10-13T08:48:35Z",
  "closed_at": "2023-03-12T18:05:27Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi,\r\n\r\nI'm writing my own RLPX, implementation in Rust, I am able to send/receive P2P messages between my \"code\" and other peers.\r\nBut I've noticed, that I'm receiving \"weird\" RLP-encoded packets from some peers. \r\n\r\nHere is an example of a packet that is bothering me: `b\"\\x01\\x01\\0\\x04\"`. I have little to no experience with RLP encoding/decoding, and I'm using the [fastrlp](https://github.com/vorot93/fastrlp) package, but I'm unable to parse this message. \r\nI've also tried decoding this via [JS RLP CLI](https://www.npmjs.com/package/rlp), but to no avail.\r\n\r\nAnd just looking at the packet, this looks malformed, as if the packet consists of 2 disconnect messages `x01x0` and `x01x04`, so the first one would be `Disconnect(DisconnectRequested`) and the other one would be `Disconnect(TooManyPeers)`, but as if, for some reason, they are \"mixed up\".\r\n\r\nThe strange thing is that this doesn't happen consistently, nor for all messages. \r\nI'm receiving and parsing \"normal\" `Disconnect` messages, as well as `Hello`, and ETH Status messages (this is what I've coded so far).\r\n\r\nMy question is: is it normal to receive a packet like `b\"\\x01\\x01\\0\\x04\"` (or eg. ` b\"\\x01\\x01\\0\\x10\"`), or do I have an error somewhere in TCP/Framing level?",
  "closed_by": {
    "login": "ana-prdekalo",
    "id": 126925611,
    "node_id": "U_kgDOB5C7Kw",
    "avatar_url": "https://avatars.githubusercontent.com/u/126925611?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ana-prdekalo",
    "html_url": "https://github.com/ana-prdekalo",
    "followers_url": "https://api.github.com/users/ana-prdekalo/followers",
    "following_url": "https://api.github.com/users/ana-prdekalo/following{/other_user}",
    "gists_url": "https://api.github.com/users/ana-prdekalo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ana-prdekalo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ana-prdekalo/subscriptions",
    "organizations_url": "https://api.github.com/users/ana-prdekalo/orgs",
    "repos_url": "https://api.github.com/users/ana-prdekalo/repos",
    "events_url": "https://api.github.com/users/ana-prdekalo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ana-prdekalo/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/223/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/devp2p/issues/223/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1465252710",
    "html_url": "https://github.com/ethereum/devp2p/issues/223#issuecomment-1465252710",
    "issue_url": "https://api.github.com/repos/ethereum/devp2p/issues/223",
    "id": 1465252710,
    "node_id": "IC_kwDOAcJRYs5XVftm",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-12T17:21:36Z",
    "updated_at": "2023-03-12T17:21:54Z",
    "author_association": "MEMBER",
    "body": "If you encounter an invalid RLP message, it is pretty likely that this indicates an error in the lower level of your implementation. I'm very sure geth does not send invalid messages, we would've noticed that in testing with other implementation and with our regression tests.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1465252710/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1465262034",
    "html_url": "https://github.com/ethereum/devp2p/issues/223#issuecomment-1465262034",
    "issue_url": "https://api.github.com/repos/ethereum/devp2p/issues/223",
    "id": 1465262034,
    "node_id": "IC_kwDOAcJRYs5XVh_S",
    "user": {
      "login": "ana-prdekalo",
      "id": 126925611,
      "node_id": "U_kgDOB5C7Kw",
      "avatar_url": "https://avatars.githubusercontent.com/u/126925611?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ana-prdekalo",
      "html_url": "https://github.com/ana-prdekalo",
      "followers_url": "https://api.github.com/users/ana-prdekalo/followers",
      "following_url": "https://api.github.com/users/ana-prdekalo/following{/other_user}",
      "gists_url": "https://api.github.com/users/ana-prdekalo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ana-prdekalo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ana-prdekalo/subscriptions",
      "organizations_url": "https://api.github.com/users/ana-prdekalo/orgs",
      "repos_url": "https://api.github.com/users/ana-prdekalo/repos",
      "events_url": "https://api.github.com/users/ana-prdekalo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ana-prdekalo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-12T18:05:27Z",
    "updated_at": "2023-03-12T18:05:27Z",
    "author_association": "NONE",
    "body": "Yeah, that does make sense, I just wanted to double-check before going down the rabbit hole of chasing a bug that sometimes appears. These are always fun 🥲 It smells to me like I scr**ed up TCP Framing. \r\n\r\nThanks four your help!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1465262034/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1465804942",
    "html_url": "https://github.com/ethereum/devp2p/issues/223#issuecomment-1465804942",
    "issue_url": "https://api.github.com/repos/ethereum/devp2p/issues/223",
    "id": 1465804942,
    "node_id": "IC_kwDOAcJRYs5XXmiO",
    "user": {
      "login": "fjl",
      "id": 6915,
      "node_id": "MDQ6VXNlcjY5MTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjl",
      "html_url": "https://github.com/fjl",
      "followers_url": "https://api.github.com/users/fjl/followers",
      "following_url": "https://api.github.com/users/fjl/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjl/subscriptions",
      "organizations_url": "https://api.github.com/users/fjl/orgs",
      "repos_url": "https://api.github.com/users/fjl/repos",
      "events_url": "https://api.github.com/users/fjl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-13T09:38:37Z",
    "updated_at": "2023-03-13T09:38:37Z",
    "author_association": "MEMBER",
    "body": "Let me know what you find!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1465804942/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1472455626",
    "html_url": "https://github.com/ethereum/devp2p/issues/223#issuecomment-1472455626",
    "issue_url": "https://api.github.com/repos/ethereum/devp2p/issues/223",
    "id": 1472455626,
    "node_id": "IC_kwDOAcJRYs5Xw-PK",
    "user": {
      "login": "ana-prdekalo",
      "id": 126925611,
      "node_id": "U_kgDOB5C7Kw",
      "avatar_url": "https://avatars.githubusercontent.com/u/126925611?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ana-prdekalo",
      "html_url": "https://github.com/ana-prdekalo",
      "followers_url": "https://api.github.com/users/ana-prdekalo/followers",
      "following_url": "https://api.github.com/users/ana-prdekalo/following{/other_user}",
      "gists_url": "https://api.github.com/users/ana-prdekalo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ana-prdekalo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ana-prdekalo/subscriptions",
      "organizations_url": "https://api.github.com/users/ana-prdekalo/orgs",
      "repos_url": "https://api.github.com/users/ana-prdekalo/repos",
      "events_url": "https://api.github.com/users/ana-prdekalo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ana-prdekalo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-16T17:58:08Z",
    "updated_at": "2023-03-16T17:58:08Z",
    "author_association": "NONE",
    "body": "Sorry for the slow response, I'm working on this when I find time -  so rarely 🥲\r\nThe issue was, for some reason, I thought that disconnect messages were not Snappy compressed 🤦‍♂️\r\nNow everything works as expected :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/devp2p/issues/comments/1472455626/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
