{
  "url": "https://api.github.com/repos/ethereum/tests/issues/935",
  "repository_url": "https://api.github.com/repos/ethereum/tests",
  "labels_url": "https://api.github.com/repos/ethereum/tests/issues/935/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/tests/issues/935/comments",
  "events_url": "https://api.github.com/repos/ethereum/tests/issues/935/events",
  "html_url": "https://github.com/ethereum/tests/issues/935",
  "id": 984857342,
  "node_id": "MDU6SXNzdWU5ODQ4NTczNDI=",
  "number": 935,
  "title": "Geth v.1.10.8 consensus issue test - filler wanted",
  "user": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "qbzzt",
    "id": 12722969,
    "node_id": "MDQ6VXNlcjEyNzIyOTY5",
    "avatar_url": "https://avatars.githubusercontent.com/u/12722969?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/qbzzt",
    "html_url": "https://github.com/qbzzt",
    "followers_url": "https://api.github.com/users/qbzzt/followers",
    "following_url": "https://api.github.com/users/qbzzt/following{/other_user}",
    "gists_url": "https://api.github.com/users/qbzzt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/qbzzt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/qbzzt/subscriptions",
    "organizations_url": "https://api.github.com/users/qbzzt/orgs",
    "repos_url": "https://api.github.com/users/qbzzt/repos",
    "events_url": "https://api.github.com/users/qbzzt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/qbzzt/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "qbzzt",
      "id": 12722969,
      "node_id": "MDQ6VXNlcjEyNzIyOTY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/12722969?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/qbzzt",
      "html_url": "https://github.com/qbzzt",
      "followers_url": "https://api.github.com/users/qbzzt/followers",
      "following_url": "https://api.github.com/users/qbzzt/following{/other_user}",
      "gists_url": "https://api.github.com/users/qbzzt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/qbzzt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/qbzzt/subscriptions",
      "organizations_url": "https://api.github.com/users/qbzzt/orgs",
      "repos_url": "https://api.github.com/users/qbzzt/repos",
      "events_url": "https://api.github.com/users/qbzzt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/qbzzt/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2021-09-01T08:20:35Z",
  "updated_at": "2021-09-11T13:36:43Z",
  "closed_at": "2021-09-11T13:36:43Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "The consensus-issue which caused geth versions < 1.10.8 can be hit by this state-test\r\n```\r\n{\r\n  \"trigger-issue\": {\r\n    \"env\": {\r\n      \"currentCoinbase\": \"b94f5374fce5edbc8e2a8697c15331677e6ebf0b\",\r\n      \"currentDifficulty\": \"0x20000\",\r\n      \"currentGasLimit\": \"0x26e1f476fe1e22\",\r\n      \"currentNumber\": \"0x1\",\r\n      \"currentTimestamp\": \"0x3e8\",\r\n      \"previousHash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\"\r\n    },\r\n    \"pre\": {\r\n      \"0x00000000000000000000000000000000000000bb\": {\r\n        \"code\": \"0x6001600053600260015360036002536004600353600560045360066005536006600260066000600060047f7ef0367e633852132a0ebbf70eb714015dd44bc82e1e55a96ef1389c999c1bcaf13d600060003e596000208055\",\r\n        \"storage\": {},\r\n        \"balance\": \"0x5\",\r\n        \"nonce\": \"0x0\"\r\n      },\r\n      \"0xa94f5374fce5edbc8e2a8697c15331677e6ebf0b\": {\r\n        \"code\": \"0x\",\r\n        \"storage\": {},\r\n        \"balance\": \"0xffffffff\",\r\n        \"nonce\": \"0x0\"\r\n      }\r\n    },\r\n    \"transaction\": {\r\n      \"gasPrice\": \"0x1\",\r\n      \"nonce\": \"0x0\",\r\n      \"to\": \"0x00000000000000000000000000000000000000bb\",\r\n      \"data\": [\r\n        \"0x\"\r\n      ],\r\n      \"gasLimit\": [\r\n        \"0x7a1200\"\r\n      ],\r\n      \"value\": [\r\n        \"0x01\"\r\n      ],\r\n      \"secretKey\": \"0x45a915e4d060149eb4365960e6a7a45f334393093061116b197e3240065ff2d8\"\r\n    },\r\n    \"out\": \"0x\",\r\n    \"post\": {\r\n      \"Berlin\": [\r\n        {\r\n          \"hash\": \"2a38a040bab1e1fa499253d98b2fd363e5756ecc52db47dd59af7116c068368c\",\r\n          \"logs\": \"1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347\",\r\n          \"indexes\": {\r\n            \"data\": 0,\r\n            \"gas\": 0,\r\n            \"value\": 0\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  }\r\n}\r\n```\r\nWould be great if we can get this into the reference tests, also with more forks than 'Berlin'. @MariusVanDerWijden can provide more info about how this was generated, so we can make a filler for it. \r\n",
  "closed_by": {
    "login": "winsvega",
    "id": 4492341,
    "node_id": "MDQ6VXNlcjQ0OTIzNDE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4492341?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/winsvega",
    "html_url": "https://github.com/winsvega",
    "followers_url": "https://api.github.com/users/winsvega/followers",
    "following_url": "https://api.github.com/users/winsvega/following{/other_user}",
    "gists_url": "https://api.github.com/users/winsvega/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/winsvega/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/winsvega/subscriptions",
    "organizations_url": "https://api.github.com/users/winsvega/orgs",
    "repos_url": "https://api.github.com/users/winsvega/repos",
    "events_url": "https://api.github.com/users/winsvega/events{/privacy}",
    "received_events_url": "https://api.github.com/users/winsvega/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/tests/issues/935/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/tests/issues/935/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/tests/issues/comments/910145716",
    "html_url": "https://github.com/ethereum/tests/issues/935#issuecomment-910145716",
    "issue_url": "https://api.github.com/repos/ethereum/tests/issues/935",
    "id": 910145716,
    "node_id": "IC_kwDOAO0i5842P7i0",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-01T10:20:17Z",
    "updated_at": "2021-09-01T10:20:17Z",
    "author_association": "MEMBER",
    "body": "That's the code I used to generate the state test in goevmlab\r\n```\r\n\tbb.Mstore([]byte{1, 2, 3, 4, 5, 6, 7, 8}, 0)\r\n\tbb.Call(gas, precompileAddress, value, 0x0, 0x8, 0x2 0x8)\r\n\tbb.Push(6)\r\n\tbb.Push(0)\r\n\tbb.Push(0)\r\n\tbb.Op(ops.RETURNDATACOPY)\r\n\tbb.Op(ops.MSIZE)\r\n\tbb.Push(0)\r\n\tbb.Op(ops.SHA3)\r\n\tbb.Op(ops.DUP1)\r\n\tbb.Op(ops.SSTORE)\r\n\t```\r\n\tBasically you call the identity precompile with inOffset 0, inSIze 8, outOffset 2, outSize 8,\r\n\tThen Copy the returndata, hash it and store it to the trie (in order to create an invalid state root)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/tests/issues/comments/910145716/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/tests/issues/comments/911617127",
    "html_url": "https://github.com/ethereum/tests/issues/935#issuecomment-911617127",
    "issue_url": "https://api.github.com/repos/ethereum/tests/issues/935",
    "id": 911617127,
    "node_id": "IC_kwDOAO0i5842Vixn",
    "user": {
      "login": "winsvega",
      "id": 4492341,
      "node_id": "MDQ6VXNlcjQ0OTIzNDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4492341?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/winsvega",
      "html_url": "https://github.com/winsvega",
      "followers_url": "https://api.github.com/users/winsvega/followers",
      "following_url": "https://api.github.com/users/winsvega/following{/other_user}",
      "gists_url": "https://api.github.com/users/winsvega/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/winsvega/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/winsvega/subscriptions",
      "organizations_url": "https://api.github.com/users/winsvega/orgs",
      "repos_url": "https://api.github.com/users/winsvega/repos",
      "events_url": "https://api.github.com/users/winsvega/events{/privacy}",
      "received_events_url": "https://api.github.com/users/winsvega/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-02T12:22:46Z",
    "updated_at": "2021-09-02T12:22:46Z",
    "author_association": "MEMBER",
    "body": "interesting. thanks for the source code\r\n@qbzzt  ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/tests/issues/comments/911617127/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/tests/issues/comments/912208420",
    "html_url": "https://github.com/ethereum/tests/issues/935#issuecomment-912208420",
    "issue_url": "https://api.github.com/repos/ethereum/tests/issues/935",
    "id": 912208420,
    "node_id": "IC_kwDOAO0i5842XzIk",
    "user": {
      "login": "qbzzt",
      "id": 12722969,
      "node_id": "MDQ6VXNlcjEyNzIyOTY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/12722969?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/qbzzt",
      "html_url": "https://github.com/qbzzt",
      "followers_url": "https://api.github.com/users/qbzzt/followers",
      "following_url": "https://api.github.com/users/qbzzt/following{/other_user}",
      "gists_url": "https://api.github.com/users/qbzzt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/qbzzt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/qbzzt/subscriptions",
      "organizations_url": "https://api.github.com/users/qbzzt/orgs",
      "repos_url": "https://api.github.com/users/qbzzt/repos",
      "events_url": "https://api.github.com/users/qbzzt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/qbzzt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-03T02:37:43Z",
    "updated_at": "2021-09-03T02:37:43Z",
    "author_association": "MEMBER",
    "body": "There are three overlapping buffers here:\r\n\r\n1. The input buffer (0-8)\r\n2. The output buffer (2-10)\r\n3. The RETURNDATACOPY buffer (0-6)\r\n\r\nThat's not necessary. It's enough for the first two to overlap, and then we can use RETURNDATACOPY to an unrelated buffer to show it is corrupt. \r\n\r\nI created this filler, which I think is simpler. I need to rebuild by Docker with geth 1.10.8 to be able to create the filled versions, but you can already play with it.\r\n[memCopySelfFiller.yml.txt](https://github.com/ethereum/tests/files/7102946/memCopySelfFiller.yml.txt)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/tests/issues/comments/912208420/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
