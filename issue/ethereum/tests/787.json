{
  "url": "https://api.github.com/repos/ethereum/tests/issues/787",
  "repository_url": "https://api.github.com/repos/ethereum/tests",
  "labels_url": "https://api.github.com/repos/ethereum/tests/issues/787/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/tests/issues/787/comments",
  "events_url": "https://api.github.com/repos/ethereum/tests/issues/787/events",
  "html_url": "https://github.com/ethereum/tests/issues/787",
  "id": 813773313,
  "node_id": "MDU6SXNzdWU4MTM3NzMzMTM=",
  "number": 787,
  "title": "\"Invalid\" uncle seems to be valid",
  "user": {
    "login": "carver",
    "id": 205327,
    "node_id": "MDQ6VXNlcjIwNTMyNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/205327?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/carver",
    "html_url": "https://github.com/carver",
    "followers_url": "https://api.github.com/users/carver/followers",
    "following_url": "https://api.github.com/users/carver/following{/other_user}",
    "gists_url": "https://api.github.com/users/carver/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/carver/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/carver/subscriptions",
    "organizations_url": "https://api.github.com/users/carver/orgs",
    "repos_url": "https://api.github.com/users/carver/repos",
    "events_url": "https://api.github.com/users/carver/events{/privacy}",
    "received_events_url": "https://api.github.com/users/carver/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2021-02-22T18:57:44Z",
  "updated_at": "2021-02-25T17:02:29Z",
  "closed_at": "2021-02-25T16:25:54Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "This issue looks similar to: https://github.com/ethereum/tests/issues/694\r\n\r\nI am testing py-evm using v7.0.1\r\n\r\nThe following test is asserting that if a block with timestamp 3001 and parent timestamp 2001 includes an uncle with timestamp of 1001, that it is invalid:\r\nhttps://github.com/ethereum/tests/blob/v7.0.1/BlockchainTests/InvalidBlocks/bcUncleHeaderValidity/incorrectUncleTimestamp.json\r\n\r\nWhy would that be invalid? I also don't understand why a test like this would be limited to Istanbul+. I don't see any uncle-timestamp EIPs that were merged into Istanbul.\r\n\r\nLooking at this diff:\r\n`git diff v7.0.0-beta.1 v7.0.1 src/BlockchainTestsFiller/InvalidBlocks/bcUncleHeaderValidity/incorrectUncleTimestampFiller.json`, this seems to be the culprit:\r\n```diff\r\n                 \"uncleHeaders\" : [\r\n                     {\r\n-                       \"populateFromBlock\" : \"1\",\r\n-                       \"RelTimestamp\" : \"0\"\r\n+                        \"populateFromBlock\" : \"1\",\r\n+                        \"RelTimestampFromPopulateBlock\" : \"0\"\r\n                     }\r\n                 ]\r\n             }\r\n```\r\n\r\nI don't know how to read the [DSL for the tests](https://github.com/ethereum/tests/blob/v7.0.1/src/BlockchainTestsFiller/InvalidBlocks/bcUncleHeaderValidity/incorrectUncleTimestampFiller.json), but it looks to me like it was supposed to test what happens if the uncle header had the same timestamp as the including block. If that's true, then it seems like the block is not being generated as intended.",
  "closed_by": {
    "login": "carver",
    "id": 205327,
    "node_id": "MDQ6VXNlcjIwNTMyNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/205327?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/carver",
    "html_url": "https://github.com/carver",
    "followers_url": "https://api.github.com/users/carver/followers",
    "following_url": "https://api.github.com/users/carver/following{/other_user}",
    "gists_url": "https://api.github.com/users/carver/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/carver/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/carver/subscriptions",
    "organizations_url": "https://api.github.com/users/carver/orgs",
    "repos_url": "https://api.github.com/users/carver/repos",
    "events_url": "https://api.github.com/users/carver/events{/privacy}",
    "received_events_url": "https://api.github.com/users/carver/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/tests/issues/787/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/tests/issues/787/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/tests/issues/comments/785303788",
    "html_url": "https://github.com/ethereum/tests/issues/787#issuecomment-785303788",
    "issue_url": "https://api.github.com/repos/ethereum/tests/issues/787",
    "id": 785303788,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4NTMwMzc4OA==",
    "user": {
      "login": "winsvega",
      "id": 4492341,
      "node_id": "MDQ6VXNlcjQ0OTIzNDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4492341?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/winsvega",
      "html_url": "https://github.com/winsvega",
      "followers_url": "https://api.github.com/users/winsvega/followers",
      "following_url": "https://api.github.com/users/winsvega/following{/other_user}",
      "gists_url": "https://api.github.com/users/winsvega/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/winsvega/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/winsvega/subscriptions",
      "organizations_url": "https://api.github.com/users/winsvega/orgs",
      "repos_url": "https://api.github.com/users/winsvega/repos",
      "events_url": "https://api.github.com/users/winsvega/events{/privacy}",
      "received_events_url": "https://api.github.com/users/winsvega/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-24T19:03:20Z",
    "updated_at": "2021-02-24T19:12:06Z",
    "author_association": "MEMBER",
    "body": "there was this rule before transition tool: \r\n```Error importing raw rlp block: BlockHeader timestamp is less then it's parent block```\r\n\r\nthe question is is uncleHeader with timestamp less or equal then it's parent block is allowed. \r\n\r\n```\r\nblock1.timestamp = 1001\r\nblock2.timestamp = 2001\r\nblock3.timestamp = 3001\r\n  with uncle.number = 2\r\n         uncle.timestamp = 1001\r\n```\r\n\r\nso the uncle is rejected because it has number 2 and timestamp 1001 but there was already block number 1 and timestamp 1001. and the distance between blocks is violated. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/tests/issues/comments/785303788/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/tests/issues/comments/785674700",
    "html_url": "https://github.com/ethereum/tests/issues/787#issuecomment-785674700",
    "issue_url": "https://api.github.com/repos/ethereum/tests/issues/787",
    "id": 785674700,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4NTY3NDcwMA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-25T07:17:18Z",
    "updated_at": "2021-02-25T07:19:27Z",
    "author_association": "MEMBER",
    "body": "The uncle is verified much like a regular header, meaning, \r\n- The parent (header@1) of the header (uncle@2), needs to be _before_ the header (uncle@2). \r\n\r\nFrom what @winsvega writes, it looks like that rule is violated, if indeed `block1` is parent of `uncle`, and `block1` and `uncle2` both have timestamp `1001`. \r\n\r\n\r\n> there was this rule before transition tool\r\n\r\nThe `evm t8n` has nothing to work with here. It's for state transitions, but this test concerns block validity, and there is no state transition. (A state transition: have pre-state, apply transactions, obtain post-state). \r\n\r\nAlso, these tests cannot really be executed on hive, hive can test that a block imports correctly, but it's harder to test that a block correctly is rejected. \r\n\r\nI know I [previously](https://github.com/ethereum/tests/issues/694#issuecomment-636016240) said otherwise, but I do think (now) that the test is correct. \r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/tests/issues/comments/785674700/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/tests/issues/comments/785738697",
    "html_url": "https://github.com/ethereum/tests/issues/787#issuecomment-785738697",
    "issue_url": "https://api.github.com/repos/ethereum/tests/issues/787",
    "id": 785738697,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4NTczODY5Nw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-25T09:07:21Z",
    "updated_at": "2021-02-25T09:07:21Z",
    "author_association": "MEMBER",
    "body": "Yeah, geth rejects this on hive: https://hivetests.ethdevops.io/viewer.html?file=results/go-ethereum/client-1352abdf.log#L76 ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/tests/issues/comments/785738697/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/tests/issues/comments/786027817",
    "html_url": "https://github.com/ethereum/tests/issues/787#issuecomment-786027817",
    "issue_url": "https://api.github.com/repos/ethereum/tests/issues/787",
    "id": 786027817,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4NjAyNzgxNw==",
    "user": {
      "login": "carver",
      "id": 205327,
      "node_id": "MDQ6VXNlcjIwNTMyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/205327?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/carver",
      "html_url": "https://github.com/carver",
      "followers_url": "https://api.github.com/users/carver/followers",
      "following_url": "https://api.github.com/users/carver/following{/other_user}",
      "gists_url": "https://api.github.com/users/carver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/carver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/carver/subscriptions",
      "organizations_url": "https://api.github.com/users/carver/orgs",
      "repos_url": "https://api.github.com/users/carver/repos",
      "events_url": "https://api.github.com/users/carver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/carver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-25T16:25:54Z",
    "updated_at": "2021-02-25T16:25:54Z",
    "author_association": "MEMBER",
    "body": ":+1: Thanks for reviewing",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/tests/issues/comments/786027817/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/tests/issues/comments/786028847",
    "html_url": "https://github.com/ethereum/tests/issues/787#issuecomment-786028847",
    "issue_url": "https://api.github.com/repos/ethereum/tests/issues/787",
    "id": 786028847,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4NjAyODg0Nw==",
    "user": {
      "login": "carver",
      "id": 205327,
      "node_id": "MDQ6VXNlcjIwNTMyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/205327?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/carver",
      "html_url": "https://github.com/carver",
      "followers_url": "https://api.github.com/users/carver/followers",
      "following_url": "https://api.github.com/users/carver/following{/other_user}",
      "gists_url": "https://api.github.com/users/carver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/carver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/carver/subscriptions",
      "organizations_url": "https://api.github.com/users/carver/orgs",
      "repos_url": "https://api.github.com/users/carver/repos",
      "events_url": "https://api.github.com/users/carver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/carver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-25T16:27:14Z",
    "updated_at": "2021-02-25T16:27:14Z",
    "author_association": "MEMBER",
    "body": "Ah, but this test should be valid against all old forks right, not just Istanbul-forward?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/tests/issues/comments/786028847/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/tests/issues/comments/786053720",
    "html_url": "https://github.com/ethereum/tests/issues/787#issuecomment-786053720",
    "issue_url": "https://api.github.com/repos/ethereum/tests/issues/787",
    "id": 786053720,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4NjA1MzcyMA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-25T17:02:29Z",
    "updated_at": "2021-02-25T17:02:29Z",
    "author_association": "MEMBER",
    "body": "Yes, all",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/tests/issues/comments/786053720/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
