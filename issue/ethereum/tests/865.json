{
  "url": "https://api.github.com/repos/ethereum/tests/issues/865",
  "repository_url": "https://api.github.com/repos/ethereum/tests",
  "labels_url": "https://api.github.com/repos/ethereum/tests/issues/865/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum/tests/issues/865/comments",
  "events_url": "https://api.github.com/repos/ethereum/tests/issues/865/events",
  "html_url": "https://github.com/ethereum/tests/issues/865",
  "id": 908598318,
  "node_id": "MDU6SXNzdWU5MDg1OTgzMTg=",
  "number": 865,
  "title": "Gaslimit errors on blockchain tests",
  "user": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2021-06-01T19:00:18Z",
  "updated_at": "2021-06-10T10:03:42Z",
  "closed_at": "2021-06-10T10:03:42Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "I'm gettting these failures, which all seem to stem from the gaslimit calculations. Are there any known errors around these, or should I investigate the geth side more? \r\n\r\n```\r\n--- FAIL: TestBlockchain (0.03s)\r\n    --- FAIL: TestBlockchain/TransitionTests/bcBerlinToLondon/BerlinToLondonTransition.json (0.01s)\r\n        block_test.go:53: test without snapshotter failed: block insertion should have failed\r\n        block_test.go:56: test with snapshotter failed: block insertion should have failed\r\n    --- FAIL: TestBlockchain/InvalidBlocks/bcUncleHeaderValidity/gasLimitTooLowExactBound.json (0.03s)\r\n        --- FAIL: TestBlockchain/InvalidBlocks/bcUncleHeaderValidity/gasLimitTooLowExactBound.json/gasLimitTooLowExactBound_London (0.00s)\r\n            block_test.go:53: test without snapshotter failed: block #3 insertion into chain failed: invalid gas limit: have 3141588, want 3144658 +-= 3069\r\n            block_test.go:56: test with snapshotter failed: block #3 insertion into chain failed: invalid gas limit: have 3141588, want 3144658 +-= 3069\r\n    --- FAIL: TestBlockchain/InvalidBlocks/bcEIP1559/gasLimit40m.json (0.01s)\r\n        block_test.go:53: test without snapshotter failed: block #2 insertion into chain failed: invalid gas limit: have 39960938, want 40000000 +-= 39061\r\n        block_test.go:56: test with snapshotter failed: block #2 insertion into chain failed: invalid gas limit: have 39960938, want 40000000 +-= 39061\r\n    --- FAIL: TestBlockchain/InvalidBlocks/bcEIP1559/gasLimit20m.json (0.00s)\r\n        block_test.go:53: test without snapshotter failed: block #2 insertion into chain failed: invalid gas limit: have 19980469, want 20000000 +-= 19530\r\n        block_test.go:56: test with snapshotter failed: block #2 insertion into chain failed: invalid gas limit: have 19980469, want 20000000 +-= 19530\r\n    --- FAIL: TestBlockchain/InvalidBlocks/bcEIP1559/badBlocks.json (0.01s)\r\n        block_test.go:53: test without snapshotter failed: block #2 insertion into chain failed: invalid gas limit: have 1072693248, want 1073741824 +-= 1048575\r\n        block_test.go:56: test with snapshotter failed: block #2 insertion into chain failed: invalid gas limit: have 1072693248, want 1073741824 +-= 1048575\r\n```",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum/tests/issues/865/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum/tests/issues/865/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum/tests/issues/comments/852380070",
    "html_url": "https://github.com/ethereum/tests/issues/865#issuecomment-852380070",
    "issue_url": "https://api.github.com/repos/ethereum/tests/issues/865",
    "id": 852380070,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MjM4MDA3MA==",
    "user": {
      "login": "winsvega",
      "id": 4492341,
      "node_id": "MDQ6VXNlcjQ0OTIzNDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4492341?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/winsvega",
      "html_url": "https://github.com/winsvega",
      "followers_url": "https://api.github.com/users/winsvega/followers",
      "following_url": "https://api.github.com/users/winsvega/following{/other_user}",
      "gists_url": "https://api.github.com/users/winsvega/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/winsvega/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/winsvega/subscriptions",
      "organizations_url": "https://api.github.com/users/winsvega/orgs",
      "repos_url": "https://api.github.com/users/winsvega/repos",
      "events_url": "https://api.github.com/users/winsvega/events{/privacy}",
      "received_events_url": "https://api.github.com/users/winsvega/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-01T19:13:42Z",
    "updated_at": "2021-06-01T19:13:42Z",
    "author_association": "MEMBER",
    "body": "the InvalidBlocks are being worked on. the TransitionTest should have been fine whch block is it? ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/tests/issues/comments/852380070/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/tests/issues/comments/852385893",
    "html_url": "https://github.com/ethereum/tests/issues/865#issuecomment-852385893",
    "issue_url": "https://api.github.com/repos/ethereum/tests/issues/865",
    "id": 852385893,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MjM4NTg5Mw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-01T19:23:15Z",
    "updated_at": "2021-06-01T19:23:15Z",
    "author_association": "MEMBER",
    "body": "```\r\nblock (index 7) insertion should have failed due to: 1559BlockImportImpossible_InitialGasLimitInvalid\r\n{\r\n  \"parentHash\": \"0xc275d52ba8e350091a9f7276ed912995c65b837f9663bdf3d1d6b39475b4b50f\",\r\n  \"sha3Uncles\": \"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347\",\r\n  \"miner\": \"0x8888f1f195afa192cfee860698584c030f4c9db1\",\r\n  \"stateRoot\": \"0x2b35fdf43065e9974011bee41736da17c88328a43535cd2d9e54e330cddaf631\",\r\n  \"transactionsRoot\": \"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421\",\r\n  \"receiptsRoot\": \"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421\",\r\n  \"logsBloom\": \"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\r\n  \"difficulty\": \"0x20000\",\r\n  \"number\": \"0x5\",\r\n  \"gasLimit\": \"0x5fdfb1\",\r\n  \"gasUsed\": \"0x0\",\r\n  \"timestamp\": \"0x54c9a009\",\r\n  \"extraData\": \"0x42\",\r\n  \"mixHash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n  \"nonce\": \"0x0000000000000000\",\r\n  \"baseFeePerGas\": \"0x3b9aca00\",\r\n  \"hash\": \"0x396c06c0b2647cafad3ea15bfc1c58fd73446fe43b7ef0c78a92e1ff1b515e10\"\r\n}\r\n```\r\nThe gasLimit is \r\n```\r\n>>> 0x5fdfb1\r\n6283185\r\n```\r\nAnd the parent gas limit is \r\n```\r\n>>> 0x2fefd8\r\n3141592\r\n```\r\nAt the fork block, the doubling becomes: \r\n```\r\n>>> 2* 0x2fefd8\r\n6283184\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/tests/issues/comments/852385893/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/tests/issues/comments/852394531",
    "html_url": "https://github.com/ethereum/tests/issues/865#issuecomment-852394531",
    "issue_url": "https://api.github.com/repos/ethereum/tests/issues/865",
    "id": 852394531,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MjM5NDUzMQ==",
    "user": {
      "login": "winsvega",
      "id": 4492341,
      "node_id": "MDQ6VXNlcjQ0OTIzNDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4492341?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/winsvega",
      "html_url": "https://github.com/winsvega",
      "followers_url": "https://api.github.com/users/winsvega/followers",
      "following_url": "https://api.github.com/users/winsvega/following{/other_user}",
      "gists_url": "https://api.github.com/users/winsvega/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/winsvega/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/winsvega/subscriptions",
      "organizations_url": "https://api.github.com/users/winsvega/orgs",
      "repos_url": "https://api.github.com/users/winsvega/repos",
      "events_url": "https://api.github.com/users/winsvega/events{/privacy}",
      "received_events_url": "https://api.github.com/users/winsvega/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-01T19:37:18Z",
    "updated_at": "2021-06-01T19:37:18Z",
    "author_association": "MEMBER",
    "body": "ah. I see. I didn't commit the changes. I rember fixing it but probably didnt commit. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/tests/issues/comments/852394531/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/tests/issues/comments/852810791",
    "html_url": "https://github.com/ethereum/tests/issues/865#issuecomment-852810791",
    "issue_url": "https://api.github.com/repos/ethereum/tests/issues/865",
    "id": 852810791,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MjgxMDc5MQ==",
    "user": {
      "login": "yperbasis",
      "id": 34320705,
      "node_id": "MDQ6VXNlcjM0MzIwNzA1",
      "avatar_url": "https://avatars.githubusercontent.com/u/34320705?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yperbasis",
      "html_url": "https://github.com/yperbasis",
      "followers_url": "https://api.github.com/users/yperbasis/followers",
      "following_url": "https://api.github.com/users/yperbasis/following{/other_user}",
      "gists_url": "https://api.github.com/users/yperbasis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yperbasis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yperbasis/subscriptions",
      "organizations_url": "https://api.github.com/users/yperbasis/orgs",
      "repos_url": "https://api.github.com/users/yperbasis/repos",
      "events_url": "https://api.github.com/users/yperbasis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yperbasis/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-02T07:31:45Z",
    "updated_at": "2021-06-02T07:31:45Z",
    "author_association": "MEMBER",
    "body": "@winsvega I'm still experiencing the same issues in [Silkworm](https://github.com/torquem-ch/silkworm/pull/251) even with the latests commit https://github.com/ethereum/tests/commit/c34cab0b8279671a337c9cd2938f41269b1adc89. The issue is not resolved yet, is it?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/tests/issues/comments/852810791/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/tests/issues/comments/852831744",
    "html_url": "https://github.com/ethereum/tests/issues/865#issuecomment-852831744",
    "issue_url": "https://api.github.com/repos/ethereum/tests/issues/865",
    "id": 852831744,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MjgzMTc0NA==",
    "user": {
      "login": "winsvega",
      "id": 4492341,
      "node_id": "MDQ6VXNlcjQ0OTIzNDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4492341?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/winsvega",
      "html_url": "https://github.com/winsvega",
      "followers_url": "https://api.github.com/users/winsvega/followers",
      "following_url": "https://api.github.com/users/winsvega/following{/other_user}",
      "gists_url": "https://api.github.com/users/winsvega/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/winsvega/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/winsvega/subscriptions",
      "organizations_url": "https://api.github.com/users/winsvega/orgs",
      "repos_url": "https://api.github.com/users/winsvega/repos",
      "events_url": "https://api.github.com/users/winsvega/events{/privacy}",
      "received_events_url": "https://api.github.com/users/winsvega/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-02T08:05:10Z",
    "updated_at": "2021-06-02T08:05:10Z",
    "author_association": "MEMBER",
    "body": "No, now should be fine \r\n\r\n```\r\nPassed 2021-06-02 t8ntool -t BlockchainTests -- --all -j2 (Test: #c34cab0b, GethTool: #2dee3193, Retesteth: #27b32aba) Log: (2021-06-02-1622602023-t8ntool.txt)\r\n\r\nPassed 2021-06-02 t8ntool -t GeneralStateTests -- --all -j2 (Test: #c34cab0b, GethTool: #2dee3193, Retesteth: #27b32aba) Log:\r\n\r\n```\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/tests/issues/comments/852831744/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/tests/issues/comments/852838549",
    "html_url": "https://github.com/ethereum/tests/issues/865#issuecomment-852838549",
    "issue_url": "https://api.github.com/repos/ethereum/tests/issues/865",
    "id": 852838549,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MjgzODU0OQ==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-02T08:14:46Z",
    "updated_at": "2021-06-02T08:14:46Z",
    "author_association": "MEMBER",
    "body": "I think it works for me too (waiting for CI to let me know if everything is good) ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/tests/issues/comments/852838549/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum/tests/issues/comments/852849898",
    "html_url": "https://github.com/ethereum/tests/issues/865#issuecomment-852849898",
    "issue_url": "https://api.github.com/repos/ethereum/tests/issues/865",
    "id": 852849898,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1Mjg0OTg5OA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-02T09:01:40Z",
    "updated_at": "2021-06-02T09:01:40Z",
    "author_association": "MEMBER",
    "body": "\r\nI think the lower bound is miscalculated by retesteth, it has an off-by-one\r\nThe block #2 insertion into chain failed: \r\n```\r\ninvalid gas limit: have 19980469, want 20000000 +-= 19530 \r\n```\r\n so retesteth thinks `19980469` is ok, geth thinks `19980470` is the lowest allowed\r\n\r\n```\r\n>>> 20000000-20000000//1024\r\n19980469\r\n```\r\nFrom EIP\r\n```\r\nassert block.gas_limit > parent_gas_limit - parent_gas_limit // 1024, 'invalid block: gas limit decreased too much'\r\n```\r\nSo block.gas_limit must be greater than `19980469`.This logic was changed, as part of https://github.com/ethereum/EIPs/pull/3566",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum/tests/issues/comments/852849898/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
