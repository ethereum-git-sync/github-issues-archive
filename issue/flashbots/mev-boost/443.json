{
  "url": "https://api.github.com/repos/flashbots/mev-boost/issues/443",
  "repository_url": "https://api.github.com/repos/flashbots/mev-boost",
  "labels_url": "https://api.github.com/repos/flashbots/mev-boost/issues/443/labels{/name}",
  "comments_url": "https://api.github.com/repos/flashbots/mev-boost/issues/443/comments",
  "events_url": "https://api.github.com/repos/flashbots/mev-boost/issues/443/events",
  "html_url": "https://github.com/flashbots/mev-boost/issues/443",
  "id": 1570016287,
  "node_id": "I_kwDOGZSKs85dlIwf",
  "number": 443,
  "title": "MEV-Boost logs 500x responses at info level",
  "user": {
    "login": "screwyprof",
    "id": 1536274,
    "node_id": "MDQ6VXNlcjE1MzYyNzQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1536274?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/screwyprof",
    "html_url": "https://github.com/screwyprof",
    "followers_url": "https://api.github.com/users/screwyprof/followers",
    "following_url": "https://api.github.com/users/screwyprof/following{/other_user}",
    "gists_url": "https://api.github.com/users/screwyprof/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/screwyprof/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/screwyprof/subscriptions",
    "organizations_url": "https://api.github.com/users/screwyprof/orgs",
    "repos_url": "https://api.github.com/users/screwyprof/repos",
    "events_url": "https://api.github.com/users/screwyprof/events{/privacy}",
    "received_events_url": "https://api.github.com/users/screwyprof/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-02-03T15:25:37Z",
  "updated_at": "2023-02-21T10:52:41Z",
  "closed_at": "2023-02-21T10:52:41Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "In the logs, when a relay returns a non 200 http code we can see two lines related to the same query. The first line logged  by the endpoint itself and correctly marked as an error:\r\n\r\n```json\r\n{\r\n   \"error\":\"Get \\\"https://builder-relay-goerli.flashbots.net/eth/v1/builder/status\\\": context deadline exceeded (Client.Timeout exceeded while awaiting headers)\",\r\n   \"level\":\"error\",\r\n   \"msg\":\"relay status error - request failed\",\r\n   \"time\":\"2023-02-03T03:32:36Z\",\r\n   \"url\":\"https://builder-relay-goerli.flashbots.net/eth/v1/builder/status\",\r\n}\r\n```\r\n\r\nThe second is logged by the middleware which always uses `Info` level, no matter the status.\r\n```json\r\n{\r\n   \"duration\":\"0.950913\",\r\n   \"level\":\"info\",\r\n   \"method\":\"GET\",\r\n   \"msg\":\"http: GET /eth/v1/builder/status 503\",\r\n   \"path\":\"/eth/v1/builder/status\",\r\n   \"status\":503,\r\n   \"time\":\"2023-02-03T03:32:36Z\",\r\n}\r\n```\r\n\r\nThis behaviour is confusing. It would be great if the middleware could check the returned status codes and log the result with the corresponding level.\r\n\r\nAlso it would make more sense if the first message was logged at `Debug` or `Warning` level as it doesn't lead to a `mev-boost` status endpoint error if there is at least one working relay.\r\n\r\n![Screenshot 2023-02-03 at 15 27 54](https://user-images.githubusercontent.com/1536274/216642086-609105ac-2ca3-43a7-9432-dacd3353fb33.png)\r\n",
  "closed_by": {
    "login": "metachris",
    "id": 116939,
    "node_id": "MDQ6VXNlcjExNjkzOQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/116939?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/metachris",
    "html_url": "https://github.com/metachris",
    "followers_url": "https://api.github.com/users/metachris/followers",
    "following_url": "https://api.github.com/users/metachris/following{/other_user}",
    "gists_url": "https://api.github.com/users/metachris/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/metachris/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/metachris/subscriptions",
    "organizations_url": "https://api.github.com/users/metachris/orgs",
    "repos_url": "https://api.github.com/users/metachris/repos",
    "events_url": "https://api.github.com/users/metachris/events{/privacy}",
    "received_events_url": "https://api.github.com/users/metachris/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/flashbots/mev-boost/issues/443/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/flashbots/mev-boost/issues/443/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/flashbots/mev-boost/issues/comments/1438267316",
    "html_url": "https://github.com/flashbots/mev-boost/issues/443#issuecomment-1438267316",
    "issue_url": "https://api.github.com/repos/flashbots/mev-boost/issues/443",
    "id": 1438267316,
    "node_id": "IC_kwDOGZSKs85Vuje0",
    "user": {
      "login": "metachris",
      "id": 116939,
      "node_id": "MDQ6VXNlcjExNjkzOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/116939?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/metachris",
      "html_url": "https://github.com/metachris",
      "followers_url": "https://api.github.com/users/metachris/followers",
      "following_url": "https://api.github.com/users/metachris/following{/other_user}",
      "gists_url": "https://api.github.com/users/metachris/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/metachris/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/metachris/subscriptions",
      "organizations_url": "https://api.github.com/users/metachris/orgs",
      "repos_url": "https://api.github.com/users/metachris/repos",
      "events_url": "https://api.github.com/users/metachris/events{/privacy}",
      "received_events_url": "https://api.github.com/users/metachris/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-21T10:52:41Z",
    "updated_at": "2023-02-21T10:52:41Z",
    "author_association": "COLLABORATOR",
    "body": "To have the HTTP request information logged as INFO is expected behaviour, and I don't think a HTTP logging middleware should change the loglevel based on the status code. In particular since any message logged with error level should be immediately investigated by the engineering/devops team, and the HTTP logging middleware just doesn't have enough context to decide which is actually an error to investigate versus not.",
    "reactions": {
      "url": "https://api.github.com/repos/flashbots/mev-boost/issues/comments/1438267316/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
