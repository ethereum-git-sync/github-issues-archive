{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/7002",
  "id": 1606805177,
  "node_id": "I_kwDOC0FsAM5fxea5",
  "number": 7002,
  "title": "Limit capacities of maps in sendersBatch",
  "user": {
    "login": "Qjawko",
    "id": 28804621,
    "node_id": "MDQ6VXNlcjI4ODA0NjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/28804621?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Qjawko",
    "html_url": "https://github.com/Qjawko",
    "followers_url": "https://api.github.com/users/Qjawko/followers",
    "following_url": "https://api.github.com/users/Qjawko/following{/other_user}",
    "gists_url": "https://api.github.com/users/Qjawko/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Qjawko/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Qjawko/subscriptions",
    "organizations_url": "https://api.github.com/users/Qjawko/orgs",
    "repos_url": "https://api.github.com/users/Qjawko/repos",
    "events_url": "https://api.github.com/users/Qjawko/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Qjawko/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4566396003,
      "node_id": "LA_kwDOC0FsAM8AAAABEC2sYw",
      "url": "https://api.github.com/repos/ledgerwatch/erigon/labels/Stale",
      "name": "Stale",
      "color": "ededed",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 13,
  "created_at": "2023-03-02T13:24:57Z",
  "updated_at": "2023-04-21T02:21:00Z",
  "closed_at": "2023-04-21T02:21:00Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "# Rationale\r\n\r\nThe `sendersBatch` structure is currently using too much CPU and memory, as well as allocating a large amount of resources. As a result, when the flush function starts iterating over a map, it takes a significant amount of CPU time due to [Go's standard map's evacuation mechanism](https://go.dev/src/runtime/map.go#L926). In order to improve the efficiency of Erigon's staged sync and other components, it would be helpful to optimize or limit the use of maps.\r\n\r\n[CPU profile ](https://user-images.githubusercontent.com/28804621/222441686-a6acdfa1-6432-490a-be63-32bd337fd526.png)\r\n[Memory profile](https://user-images.githubusercontent.com/28804621/222441852-6c0ff2ff-ce7b-47f3-a13f-33c6ecf77fa5.png)\r\n\r\n\r\n# Implementation\r\n\r\nAdd flags `txpool.senders.cache_capacity` and `txpool.flush_every` or even another data structure instead of std map. \r\nLet's discuss our ideas how to do it and I am willing to implement this feature.",
  "closed_by": {
    "login": "github-actions[bot]",
    "id": 41898282,
    "node_id": "MDM6Qm90NDE4OTgyODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/github-actions%5Bbot%5D",
    "html_url": "https://github.com/apps/github-actions",
    "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002/reactions",
    "total_count": 10,
    "+1": 10,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1452982733",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7002#issuecomment-1452982733",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002",
    "id": 1452982733,
    "node_id": "IC_kwDOC0FsAM5WmsHN",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-03T05:09:05Z",
    "updated_at": "2023-03-03T05:09:05Z",
    "author_association": "COLLABORATOR",
    "body": "As I remember `p.senders` was added to enumerate all senders - give them uint64 ID instead of using their addr (in all other data structures).\r\n\r\nIn flush I see:\r\n```\r\nfor addr, id := range p.senders.senderIDs { // no inverted index - tradeoff flush speed for memory usage\r\n\tif id == metaTx.Tx.SenderID {\r\n\t\tcopy(v[:20], addr)\r\n\t\tbreak\r\n\t}\r\n}\t\t\r\n```\r\nBut seems it's not true and we have inverted index already: p.senders.senderID2Addr \r\nJust need use it instead of brude-force\r\n\r\nI don't really remember now: `p.senders` is the cache (which can be limited) or enumeration (primary index) which can't. In my head it can't be limited, but it must not keep any trash: id's of senders which not used in any other in-mem data structures. (maybe I'm wrong). \r\n\r\nIn-theory can persist `p.senders` in TxPool's DB: but I don't have intuition - is it good idea or not. \r\n\r\n`p.senders` has 2 fields: senderIDs and senderID2Addr which now seems store add twice. They must share memory: `senderIDs` string must keep the addr and `senderID2Addr` must refer to that memory (In Golang when cast string to []bytes - it doesn't copy).\r\n\r\nAbout `txpool.flush_every` - yes need add such CLI option\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1452982733/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453098834",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7002#issuecomment-1453098834",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002",
    "id": 1453098834,
    "node_id": "IC_kwDOC0FsAM5WnIdS",
    "user": {
      "login": "Qjawko",
      "id": 28804621,
      "node_id": "MDQ6VXNlcjI4ODA0NjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/28804621?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Qjawko",
      "html_url": "https://github.com/Qjawko",
      "followers_url": "https://api.github.com/users/Qjawko/followers",
      "following_url": "https://api.github.com/users/Qjawko/following{/other_user}",
      "gists_url": "https://api.github.com/users/Qjawko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Qjawko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Qjawko/subscriptions",
      "organizations_url": "https://api.github.com/users/Qjawko/orgs",
      "repos_url": "https://api.github.com/users/Qjawko/repos",
      "events_url": "https://api.github.com/users/Qjawko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Qjawko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-03T07:32:58Z",
    "updated_at": "2023-03-03T07:44:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "> In Golang when cast string to []bytes - it doesn't copy\r\n\r\nThanks for the reply.\r\n\r\nI thought in strings without a copy it would be possible to modify the contents of the string (by changing the elements of the byte slice), WDYT? \r\nMaybe we should try to use non-copy **unsafe** operation in getOrCreateID method ([]byte -> string) to reduce memory allocations, at the moment I don't see mutable operations on the address byte slice.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453098834/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453165057",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7002#issuecomment-1453165057",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002",
    "id": 1453165057,
    "node_id": "IC_kwDOC0FsAM5WnYoB",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-03T08:37:42Z",
    "updated_at": "2023-03-03T08:38:09Z",
    "author_association": "COLLABORATOR",
    "body": "@Qjawko you are right (or unsafe or pointer to original data). anyway that zero-copy thing is just 2x saving. likely we need 10x or hard-limit. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453165057/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453181879",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7002#issuecomment-1453181879",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002",
    "id": 1453181879,
    "node_id": "IC_kwDOC0FsAM5Wncu3",
    "user": {
      "login": "Qjawko",
      "id": 28804621,
      "node_id": "MDQ6VXNlcjI4ODA0NjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/28804621?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Qjawko",
      "html_url": "https://github.com/Qjawko",
      "followers_url": "https://api.github.com/users/Qjawko/followers",
      "following_url": "https://api.github.com/users/Qjawko/following{/other_user}",
      "gists_url": "https://api.github.com/users/Qjawko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Qjawko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Qjawko/subscriptions",
      "organizations_url": "https://api.github.com/users/Qjawko/orgs",
      "repos_url": "https://api.github.com/users/Qjawko/repos",
      "events_url": "https://api.github.com/users/Qjawko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Qjawko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-03T08:52:27Z",
    "updated_at": "2023-03-03T08:52:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'll try to fix and add features we discussed above and profile again. Will post it here or in PR ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453181879/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453328881",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7002#issuecomment-1453328881",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002",
    "id": 1453328881,
    "node_id": "IC_kwDOC0FsAM5WoAnx",
    "user": {
      "login": "Qjawko",
      "id": 28804621,
      "node_id": "MDQ6VXNlcjI4ODA0NjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/28804621?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Qjawko",
      "html_url": "https://github.com/Qjawko",
      "followers_url": "https://api.github.com/users/Qjawko/followers",
      "following_url": "https://api.github.com/users/Qjawko/following{/other_user}",
      "gists_url": "https://api.github.com/users/Qjawko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Qjawko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Qjawko/subscriptions",
      "organizations_url": "https://api.github.com/users/Qjawko/orgs",
      "repos_url": "https://api.github.com/users/Qjawko/repos",
      "events_url": "https://api.github.com/users/Qjawko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Qjawko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-03T10:45:14Z",
    "updated_at": "2023-03-03T10:46:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "I had an idea. Since we're converting an H160 address type to a 20-byte array, why not use the _[20]byte_ type instead of the _[]byte_ type? This would reduce memory allocations and simplify the code.\r\n\r\n```\r\nfunc (sc *sendersBatch) onNewBlock(stateChanges *remote.StateChangeBatch, unwindTxs, minedTxs types.TxSlots) error {\r\n\tfor _, diff := range stateChanges.ChangeBatch {\r\n\t\tfor _, change := range diff.Changes { // merge state changes\r\n\t\t\taddrB := gointerfaces.ConvertH160toAddress(change.Address) <--- here\r\n\t\t\tsc.getOrCreateID(addrB[:]) \r\n\t\t}\r\n\r\n\t\tfor i, txn := range unwindTxs.Txs {\r\n\t\t\ttxn.SenderID, txn.Traced = sc.getOrCreateID(unwindTxs.Senders.At(i))\r\n\t\t}\r\n\r\n\t\tfor i, txn := range minedTxs.Txs {\r\n\t\t\ttxn.SenderID, txn.Traced = sc.getOrCreateID(minedTxs.Senders.At(i))\r\n\t\t}\r\n\t}\r\n\treturn nil\r\n}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453328881/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453333595",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7002#issuecomment-1453333595",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002",
    "id": 1453333595,
    "node_id": "IC_kwDOC0FsAM5WoBxb",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-03T10:47:30Z",
    "updated_at": "2023-03-03T10:47:30Z",
    "author_association": "COLLABORATOR",
    "body": "`addrB` is already `[20]byte` - just need add method `getOrCreateID(` for this type\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453333595/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453339751",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7002#issuecomment-1453339751",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002",
    "id": 1453339751,
    "node_id": "IC_kwDOC0FsAM5WoDRn",
    "user": {
      "login": "Qjawko",
      "id": 28804621,
      "node_id": "MDQ6VXNlcjI4ODA0NjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/28804621?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Qjawko",
      "html_url": "https://github.com/Qjawko",
      "followers_url": "https://api.github.com/users/Qjawko/followers",
      "following_url": "https://api.github.com/users/Qjawko/following{/other_user}",
      "gists_url": "https://api.github.com/users/Qjawko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Qjawko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Qjawko/subscriptions",
      "organizations_url": "https://api.github.com/users/Qjawko/orgs",
      "repos_url": "https://api.github.com/users/Qjawko/repos",
      "events_url": "https://api.github.com/users/Qjawko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Qjawko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-03T10:50:30Z",
    "updated_at": "2023-03-03T10:50:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "Sorry, I mean change it in senderBatch structure and methods, here is an example\r\n\r\n```\r\ntype sendersBatch struct {\r\n\tsenderIDs     map[[20]byte]uint64\r\n\tsenderID2Addr map[uint64][20]byte\r\n\ttracedSenders map[[20]byte]struct{}\r\n\tsenderID      uint64\r\n}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453339751/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453343775",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7002#issuecomment-1453343775",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002",
    "id": 1453343775,
    "node_id": "IC_kwDOC0FsAM5WoEQf",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-03T10:52:51Z",
    "updated_at": "2023-03-03T10:53:18Z",
    "author_association": "COLLABORATOR",
    "body": "yes, `senderID2Addr` to `map[uint64]common.Address`\r\nI don't have intuition about `map[string] vs map[[20]byte]` perf. Maybe it also will reduce RAM pressure. you will not do allocation, but will do copy of non-pointer type.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453343775/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453350031",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7002#issuecomment-1453350031",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002",
    "id": 1453350031,
    "node_id": "IC_kwDOC0FsAM5WoFyP",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-03T10:57:22Z",
    "updated_at": "2023-03-03T10:57:22Z",
    "author_association": "COLLABORATOR",
    "body": "I think: it's not common.Address only because minedTxs.Senders.At(i) return this type. \r\nAs I remember - now in Go can cast []byte to *[20]byte without allocation. \r\n\r\nFYI: We keep compatibility with go 1.18 now. But can move to 1.19 if some super-useful feature is needed here. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453350031/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453373882",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7002#issuecomment-1453373882",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002",
    "id": 1453373882,
    "node_id": "IC_kwDOC0FsAM5WoLm6",
    "user": {
      "login": "Qjawko",
      "id": 28804621,
      "node_id": "MDQ6VXNlcjI4ODA0NjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/28804621?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Qjawko",
      "html_url": "https://github.com/Qjawko",
      "followers_url": "https://api.github.com/users/Qjawko/followers",
      "following_url": "https://api.github.com/users/Qjawko/following{/other_user}",
      "gists_url": "https://api.github.com/users/Qjawko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Qjawko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Qjawko/subscriptions",
      "organizations_url": "https://api.github.com/users/Qjawko/orgs",
      "repos_url": "https://api.github.com/users/Qjawko/repos",
      "events_url": "https://api.github.com/users/Qjawko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Qjawko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-03T11:16:39Z",
    "updated_at": "2023-03-03T12:03:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm thinking that we should also change it to common.Address. If we do, there's no need move to version 1.19.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1453373882/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1454668837",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7002#issuecomment-1454668837",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002",
    "id": 1454668837,
    "node_id": "IC_kwDOC0FsAM5WtHwl",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-04T08:56:55Z",
    "updated_at": "2023-03-04T08:56:55Z",
    "author_association": "COLLABORATOR",
    "body": "@Qjawko see https://go.dev/doc/go1.17#\r\n\r\n\"change it to common.Address\" i don't know will it make things better or worse. now `minedTxs.Senders` it's single []byte",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1454668837/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1507835919",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7002#issuecomment-1507835919",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002",
    "id": 1507835919,
    "node_id": "IC_kwDOC0FsAM5Z38AP",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-04-14T02:18:06Z",
    "updated_at": "2023-04-14T02:18:06Z",
    "author_association": "NONE",
    "body": "This issue is stale because it has been open for 40 days with no activity. Remove stale label or comment, or this will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1507835919/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1517164289",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7002#issuecomment-1517164289",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7002",
    "id": 1517164289,
    "node_id": "IC_kwDOC0FsAM5abhcB",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-04-21T02:20:59Z",
    "updated_at": "2023-04-21T02:20:59Z",
    "author_association": "NONE",
    "body": "This issue was closed because it has been stalled for 7 days with no activity.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1517164289/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
