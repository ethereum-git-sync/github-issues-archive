{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3121",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3121/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3121/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3121/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/3121",
  "id": 1079174698,
  "node_id": "I_kwDOC0FsAM5AUuYq",
  "number": 3121,
  "title": "My experience as a new Erigon node hoster",
  "user": {
    "login": "qkum",
    "id": 40965179,
    "node_id": "MDQ6VXNlcjQwOTY1MTc5",
    "avatar_url": "https://avatars.githubusercontent.com/u/40965179?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/qkum",
    "html_url": "https://github.com/qkum",
    "followers_url": "https://api.github.com/users/qkum/followers",
    "following_url": "https://api.github.com/users/qkum/following{/other_user}",
    "gists_url": "https://api.github.com/users/qkum/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/qkum/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/qkum/subscriptions",
    "organizations_url": "https://api.github.com/users/qkum/orgs",
    "repos_url": "https://api.github.com/users/qkum/repos",
    "events_url": "https://api.github.com/users/qkum/events{/privacy}",
    "received_events_url": "https://api.github.com/users/qkum/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2021-12-14T00:33:49Z",
  "updated_at": "2022-07-16T09:09:58Z",
  "closed_at": "2022-07-16T09:09:58Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hello lovely people.\r\n\r\nI recently started my own Erigon node and want to share some things I learned until now that can help others.\r\n\r\n1) It seems the minimum RAM is 16 GB - if I use less on my virtual Ubuntu machine crashes.\r\n\r\n2) Minimum CPU's is likely 4 cores. I have not tested with lower. \r\n\r\n3) I started testing with 8 cores instead of 4, I suspect it actually slowed down the initial sync by a lot. But I need my CPU cores for daily use so it will have to live with 4 for now.\r\n\r\n4) If you reboot your Router, Disconnect VPN, or make a \"snapshot\" on your Virtual Machine while it is running. You will lose all the \"peers\" your node is connected to and you have to waste like 30-60 min to gain max peer count again. \r\n\r\n5) For me max \"peer count\" is (eth65=33, eth66=33) Some places they talk about 50 or 100 if I remember correctly, but for me, max is 33/33.\r\n\r\n6) At times my VM will fall out of sync (the clock falls behind the real UNIX universal time) my VM loses its connected trusted \"peers\". but it updates its clock and fixes the problem automatically after some time but it will take 1-2 hours for it to be back at max trusted peers.\r\n\r\n7) If you make a live \"snapshot\" while your VM is running you not just lose your trusted peers but the clock also goes out of sync btw.(the VM seems to freeze while savings the VM state - logically enough)\r\n\r\n8) I have not found out how I can force the Ubuntu VM to update its clock so it will begin to build up trusted peers as fast as possible without having to wait maybe 30 min to update the clock itself. \r\n- Optimally the client would contain a script that detects the sudden loss of all trusted peers and automatically update the UNIX clock for the Linux machine. That would not be much-added code or computational load to the client and would help the whole network of archive nodes have less down-time as a whole. Meaning more up-time, meaning a more secure Ethereum blockchain.\r\n\r\n9: I even experienced losing all trusted peers because I started downloading a big file on the pc hosting the Virtual Ubuntu Machine. My internet connection is Far Above the minimum 25 Mbps Download/25 Mbps upload. (35/43 as I write this).\r\n\r\n10: I use an external USB 3, 4 TB HDD for running my Virtual Machine on. \r\n\r\n11: My setup worked decently the first 2-3 days and now it slowed down to like 25-50 GB a day of size increase of \"du -hs /home/UserName/.local/share/erigon/chaindata\" - the folder where the formated chain data is stored from what I understand. (I use this command to check progress)\r\n\r\n12: I run Erigon Stable.\r\n\r\nI hope my experience can help others.\r\n\r\n---------------------------------------------------------------------------------------------------------------------------------------\r\n\r\n*** Update: It was random bad luck that I lost all peers when I downloaded a file/files. It happens randomly several times a day.\r\n\r\n*** After nearly 14 days the chaindata file is about 50% downloaded. So, it will take like 14 days more before my setup is done downloading the whole Ethereum Blockchain.\r\n\r\n*** But It have not been running 24/7 I admit. Maybe on average 16 hours a day.\r\n\r\n--- Slow and steady wins the race  ðŸ¥‡ \r\n",
  "closed_by": {
    "login": "mandrigin",
    "id": 466427,
    "node_id": "MDQ6VXNlcjQ2NjQyNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/466427?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mandrigin",
    "html_url": "https://github.com/mandrigin",
    "followers_url": "https://api.github.com/users/mandrigin/followers",
    "following_url": "https://api.github.com/users/mandrigin/following{/other_user}",
    "gists_url": "https://api.github.com/users/mandrigin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mandrigin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mandrigin/subscriptions",
    "organizations_url": "https://api.github.com/users/mandrigin/orgs",
    "repos_url": "https://api.github.com/users/mandrigin/repos",
    "events_url": "https://api.github.com/users/mandrigin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mandrigin/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3121/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3121/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/993249545",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3121#issuecomment-993249545",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3121",
    "id": 993249545,
    "node_id": "IC_kwDOC0FsAM47M8kJ",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-14T07:51:23Z",
    "updated_at": "2021-12-14T07:51:23Z",
    "author_association": "COLLABORATOR",
    "body": "Hi. Thank you. \r\n4. You can try external Sentry. It will hold connections during Erigon's reboot. About slowness of peers discovery - yes, we had couple complains about it, but didn't investigate yet.\r\n5. As I know - it's expected Geth's behavior - to leave room for other peers to connect while limit good+new peers by MaxPeers parameter. You can search `defaultDialRatio` for more info. \r\n6. How we can reproduce \"the clock falls behind the real UNIX universal time\" problem? ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/993249545/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/997665391",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3121#issuecomment-997665391",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3121",
    "id": 997665391,
    "node_id": "IC_kwDOC0FsAM47dypv",
    "user": {
      "login": "qkum",
      "id": 40965179,
      "node_id": "MDQ6VXNlcjQwOTY1MTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/40965179?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/qkum",
      "html_url": "https://github.com/qkum",
      "followers_url": "https://api.github.com/users/qkum/followers",
      "following_url": "https://api.github.com/users/qkum/following{/other_user}",
      "gists_url": "https://api.github.com/users/qkum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/qkum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/qkum/subscriptions",
      "organizations_url": "https://api.github.com/users/qkum/orgs",
      "repos_url": "https://api.github.com/users/qkum/repos",
      "events_url": "https://api.github.com/users/qkum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/qkum/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-20T07:28:06Z",
    "updated_at": "2021-12-20T07:28:06Z",
    "author_association": "NONE",
    "body": "> Hi. Thank you. 4. You can try external Sentry. It will hold connections during Erigon's reboot. About slowness of peers discovery - yes, we had couple complains about it, but didn't investigate yet. 5. As I know - it's expected Geth's behavior - to leave room for other peers to connect while limit good+new peers by MaxPeers parameter. You can search `defaultDialRatio` for more info. 6. How we can reproduce \"the clock falls behind the real UNIX universal time\" problem?\r\n\r\n6: It was likely because I created a snapshot of the Virtual Machine. It then freezes the VM screen, starts at 0 peers and begins to whine about the clock being 1.3 minutes behind - the same time it takes it to make a snapshot I realized later on. (I had so many problems the first week that made me super confused. So I did not have the mental clarity /focus to spot the cause at the time)\r\n\r\nThere is basically no manual on how to run this software.\r\n\r\nOnly pro jargon from what I can find in the wiki. (the technical details, not the everyday useful stuff for just running the node)\r\n\r\nSo, when you hit those errors, as you often do with open source, you are alone to figure it all out ðŸŒµ \r\n\r\nNot blaming, pointing fingers, or anything. Just reminding people if they have forgotten/overseen it.\r\n\r\nI know all of you are working HARD every day - respect ðŸ’¯ ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/997665391/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/997667543",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3121#issuecomment-997667543",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3121",
    "id": 997667543,
    "node_id": "IC_kwDOC0FsAM47dzLX",
    "user": {
      "login": "qkum",
      "id": 40965179,
      "node_id": "MDQ6VXNlcjQwOTY1MTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/40965179?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/qkum",
      "html_url": "https://github.com/qkum",
      "followers_url": "https://api.github.com/users/qkum/followers",
      "following_url": "https://api.github.com/users/qkum/following{/other_user}",
      "gists_url": "https://api.github.com/users/qkum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/qkum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/qkum/subscriptions",
      "organizations_url": "https://api.github.com/users/qkum/orgs",
      "repos_url": "https://api.github.com/users/qkum/repos",
      "events_url": "https://api.github.com/users/qkum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/qkum/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-20T07:32:11Z",
    "updated_at": "2021-12-20T07:38:27Z",
    "author_association": "NONE",
    "body": "Tip: Somehow you can turn the terminal in \"read-only-mode\" on ubuntu 18.04.\r\n\r\nWhen that happens by bad luck. It seems a reboot fixed it, or maybe it was 2 ðŸ˜† \r\n\r\nIt even gave warnings that made me think the Virtual Machine had corrupted or the HDD corrupted. Based on the answers on google of the error message when I shut the Virtual Machine down trying to fix the \"read-only\" problem.\r\n\r\nBut that was not the reality ðŸš€ ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/997667543/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1002987980",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3121#issuecomment-1002987980",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3121",
    "id": 1002987980,
    "node_id": "IC_kwDOC0FsAM47yGHM",
    "user": {
      "login": "mb-gvidon",
      "id": 96392404,
      "node_id": "U_kgDOBb7U1A",
      "avatar_url": "https://avatars.githubusercontent.com/u/96392404?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mb-gvidon",
      "html_url": "https://github.com/mb-gvidon",
      "followers_url": "https://api.github.com/users/mb-gvidon/followers",
      "following_url": "https://api.github.com/users/mb-gvidon/following{/other_user}",
      "gists_url": "https://api.github.com/users/mb-gvidon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mb-gvidon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mb-gvidon/subscriptions",
      "organizations_url": "https://api.github.com/users/mb-gvidon/orgs",
      "repos_url": "https://api.github.com/users/mb-gvidon/repos",
      "events_url": "https://api.github.com/users/mb-gvidon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mb-gvidon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-30T11:26:49Z",
    "updated_at": "2021-12-30T11:26:49Z",
    "author_association": "NONE",
    "body": "BTW, @AskAlexSharov, \r\n\r\nIt seems that I have issue with losing peers too.\r\n\r\nI don't know whether it happens because of the mentioned clock thing, but the number of peers significantly decreased after the full sync. Moreover, I was even forced to restart the docker container, because I suddenly found out that my local erigon node was 19 hours behind the mainnet. It restored the number of peers back to 33 in 10 minutes, but then it fell down to 0-6, which actually bothers me a little bit. \r\n\r\nAt the moment (couple of hours later after the issue above) my node seems to work +- stable (1 minute behind the mainnet), but actually I expected it working without any issues. \r\n\r\nDo you have any suggestions how can I increase the number of peers and my local node performance? Do I actually need it?  \r\n\r\nI will be grateful for any comment.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1002987980/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1003020700",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3121#issuecomment-1003020700",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3121",
    "id": 1003020700,
    "node_id": "IC_kwDOC0FsAM47yOGc",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-30T13:05:04Z",
    "updated_at": "2021-12-30T13:05:04Z",
    "author_association": "COLLABORATOR",
    "body": "I need re-check it. Now don't see peers drop on monitoring of my node. \r\n- \"how can I increase the number of peers?\" - there is --staticpeers flag. maybe you have some firewall/load-balancer/rate-limiter who block connection. hard to say, maybe in higher --verbosity can see some network-related errors.\r\n- \"and my local node performance?\" - for blocks processing bottleneck is disk latency. \r\n- \"Do I actually need it?\" - depends on your use-case, usually default settings work well. \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1003020700/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1186127672",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3121#issuecomment-1186127672",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3121",
    "id": 1186127672,
    "node_id": "IC_kwDOC0FsAM5Gst84",
    "user": {
      "login": "mandrigin",
      "id": 466427,
      "node_id": "MDQ6VXNlcjQ2NjQyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/466427?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mandrigin",
      "html_url": "https://github.com/mandrigin",
      "followers_url": "https://api.github.com/users/mandrigin/followers",
      "following_url": "https://api.github.com/users/mandrigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mandrigin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mandrigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mandrigin/subscriptions",
      "organizations_url": "https://api.github.com/users/mandrigin/orgs",
      "repos_url": "https://api.github.com/users/mandrigin/repos",
      "events_url": "https://api.github.com/users/mandrigin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mandrigin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-16T09:09:58Z",
    "updated_at": "2022-07-16T09:09:58Z",
    "author_association": "COLLABORATOR",
    "body": "closing this one, @mb-gvidon feel free to reopen if you still have questions/feedback",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1186127672/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
