{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/119",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/119/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/119/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/119/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/119",
  "id": 508331649,
  "node_id": "MDU6SXNzdWU1MDgzMzE2NDk=",
  "number": 119,
  "title": "letter-coded sync modes instead of full, archive etc.",
  "user": {
    "login": "AlexeyAkhunov",
    "id": 13686139,
    "node_id": "MDQ6VXNlcjEzNjg2MTM5",
    "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AlexeyAkhunov",
    "html_url": "https://github.com/AlexeyAkhunov",
    "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
    "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
    "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
    "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
    "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2019-10-17T08:54:56Z",
  "updated_at": "2022-03-19T08:20:25Z",
  "closed_at": "2019-12-06T11:19:01Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Some database buckets are mandatory for successful sync and block processing. For example, `AT` (current state of accounts), `ST` (current state of contract storage), `SUFFIX` (changesets used for rewinding). Other buckets are optional and only add value for certain users. We would like users to have flexibility to pick and choose those buckets in any combination. Users may specify the mode of operation as a combination of one-letter flags (similar to unix tar command). Here are suggested flags:\r\n\r\n1. `r` Transaction receipts. Currently turned off by default. If turned on, receipts are written to a special bucket, which is then used to server `getTransactionReceipt` and `getLogs` RPC commands. In `blockchain.go` this is set by `EnableReceipts(true)`\r\n2. `h` History of state. These are buckets `hAT` (history of state of accounts) and `hST` (history of state of contract storage). Although these buckets contain the same information as the `SUFFIX` (change-set) bucket, it is organised for quick access using `addressHash | blockNr` composite key for accounts, and `addressHash | incarnation | blockNr` composite key for contract storage. Bucket `SUFFIX` is organised for quick access for composite keys `\"hAT\" | blockNr` and `\"hST\" | blockNr`. History of state is used for answering various RPC queries related to account balances, contract storage contents at some point in the past.\r\n3. `t` Index allowing to look up block number and transaction index given a transaction hash. It is used by RPC requests such as `getTransaction`, because it allows retrieving the body of the transaction from the bucket with blocks\r\n4. `p` preimages for address hashes and storage key hashes. This information is needed by RPC queries such as `getModifiedAccounts` and `getStorageRangeAt`.\r\n6. Block headers and bodies? In order to perform reorgs, some short history of alternative blocks and headers is required.\r\n\r\nSome examples of which modes might be useful for different use-cases:\r\n\r\n- Miners would prefer to turn all the flags off, they only care about the current state and occasional reorgs. Their priority - low latency of block processing, and lowering I/O would definitely help\r\n- Exchanges would need preimages (`p`) and history (`h`) to be able to watch for deposits. If they use logs (events) to figure out token transfers, they might also want to turn on receipts (`r`) for better performance\r\n- Block explorers might want to turn everything on\r\n- Dapp Web sites would want to turn on receipts (`r`) for better scanning of the logs (lots of dapp use logs as a substitute for storage). \r\n",
  "closed_by": {
    "login": "mandrigin",
    "id": 466427,
    "node_id": "MDQ6VXNlcjQ2NjQyNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/466427?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mandrigin",
    "html_url": "https://github.com/mandrigin",
    "followers_url": "https://api.github.com/users/mandrigin/followers",
    "following_url": "https://api.github.com/users/mandrigin/following{/other_user}",
    "gists_url": "https://api.github.com/users/mandrigin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mandrigin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mandrigin/subscriptions",
    "organizations_url": "https://api.github.com/users/mandrigin/orgs",
    "repos_url": "https://api.github.com/users/mandrigin/repos",
    "events_url": "https://api.github.com/users/mandrigin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mandrigin/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/119/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/119/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/543188994",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/119#issuecomment-543188994",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/119",
    "id": 543188994,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0MzE4ODk5NA==",
    "user": {
      "login": "mandrigin",
      "id": 466427,
      "node_id": "MDQ6VXNlcjQ2NjQyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/466427?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mandrigin",
      "html_url": "https://github.com/mandrigin",
      "followers_url": "https://api.github.com/users/mandrigin/followers",
      "following_url": "https://api.github.com/users/mandrigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mandrigin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mandrigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mandrigin/subscriptions",
      "organizations_url": "https://api.github.com/users/mandrigin/orgs",
      "repos_url": "https://api.github.com/users/mandrigin/repos",
      "events_url": "https://api.github.com/users/mandrigin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mandrigin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-17T14:01:13Z",
    "updated_at": "2019-10-17T14:01:13Z",
    "author_association": "COLLABORATOR",
    "body": "@AlexeyAkhunov I'm not sure about using `h`, because it is a well known shortcut for `help` (`vi -h`, etc). maybe we can either use them as `--mode=rhtp` (I would prefer that) or use a capital `H`.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/543188994/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/544107358",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/119#issuecomment-544107358",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/119",
    "id": 544107358,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NDEwNzM1OA==",
    "user": {
      "login": "AlexeyAkhunov",
      "id": 13686139,
      "node_id": "MDQ6VXNlcjEzNjg2MTM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AlexeyAkhunov",
      "html_url": "https://github.com/AlexeyAkhunov",
      "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
      "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
      "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
      "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
      "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-19T06:32:40Z",
    "updated_at": "2019-10-19T06:32:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "@mandrigin Yes, I think the idea is to use `--mode=rhtp`",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/544107358/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
