{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6495",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6495/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6495/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6495/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/6495",
  "id": 1517276429,
  "node_id": "I_kwDOC0FsAM5ab80N",
  "number": 6495,
  "title": "integration print_stages Execution at 36789495, Blocks execution from=13999800 to=37614911",
  "user": {
    "login": "michaelscheung",
    "id": 3878375,
    "node_id": "MDQ6VXNlcjM4NzgzNzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3878375?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/michaelscheung",
    "html_url": "https://github.com/michaelscheung",
    "followers_url": "https://api.github.com/users/michaelscheung/followers",
    "following_url": "https://api.github.com/users/michaelscheung/following{/other_user}",
    "gists_url": "https://api.github.com/users/michaelscheung/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/michaelscheung/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michaelscheung/subscriptions",
    "organizations_url": "https://api.github.com/users/michaelscheung/orgs",
    "repos_url": "https://api.github.com/users/michaelscheung/repos",
    "events_url": "https://api.github.com/users/michaelscheung/events{/privacy}",
    "received_events_url": "https://api.github.com/users/michaelscheung/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-01-03T11:42:48Z",
  "updated_at": "2023-01-03T11:56:50Z",
  "closed_at": "2023-01-03T11:56:50Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### System information\r\nErigon version: `erigon version 2.32.0-stable-021891a3`\r\nUsing polygon chain, not sure if this is specific to polygon\r\nOS & Version: Ubuntu 22.04.1 LTS\r\nkernel version: 5.15.0-56-generic\r\n\r\nCommit hash : \r\n`021891a311430ffefde77fcceda567ba324e9abe`\r\n\r\n#### Expected behaviour\r\nBlocks execution stage should start from 36789495, since that is what is indicated by `integration print_stages`\r\n\r\n#### Actual behaviour\r\nBlocks execution stage starts from 13999800\r\n\r\n#### Steps to reproduce the behaviour\r\n1. Download polygon snapshot [from here](https://matic-blockchain-snapshots.s3-accelerate.amazonaws.com/matic-mainnet/erigon-archive-snapshot-2022-12-13.tar.gz)\r\n\r\n2. Run with the following command\r\n`erigon --db.pagesize=64kb --chain=bor-mainnet --datadir=erigon --snapshots=true --bor.heimdall=http://localhost:1317 --port 38100 --http --http.addr=192.168.1.91 --http.port=38101 --http.vhosts=* --http.corsdomain=* --http.api=eth,debug,net,trace,web3,erigon,bor --ws --torrent.port 38102 --torrent.download.rate 100mb --private.api.addr=127.0.0.1:38103 --authrpc.port 38105 --pprof --pprof.addr 192.168.1.91 --pprof.port 38109 --p2p.allowed-ports=38100,38110,38111`\r\n\r\n3. See that execution stage starts around block 14 million\r\n```\r\n[INFO] [01-03|00:07:08.319] [5/16 Bodies] Processed                  highest=37614911\r\n[INFO] [01-03|00:07:08.319] [5/16 Bodies] DONE                       in=1m39.059251529s\r\n[INFO] [01-03|00:07:08.319] [6/16 Senders] Started                   from=37591265 to=37614911\r\n[INFO] [01-03|00:07:11.957] [7/16 Execution] Blocks execution        from=13999800 to=37614911\r\n[INFO] [01-03|00:07:31.963] [7/16 Execution] Executed blocks         number=14000823 blk/s=51.1 tx/s=2708.2 Mgas/s=365.6 gasState=0.01 batch=9.5MB alloc=2.2GB sys=7.6GB\r\n```\r\n\r\n4. Print stages with integration, see that execution stage is at 36789495\r\n```\r\nuser@UbuntuAmdServer:/mnt/2-970/polygon-erigon$ integration print_stages --datadir=. --chain=bor-mainnet\r\nWARN[01-03|03:22:29.241] no log dir set, console logging only \r\nINFO[01-03|03:22:33.685] [Snapshots] Blocks Stat                  blocks=36699k indices=36699k alloc=2.8GB sys=3.0GB\r\nNote: prune_at doesn't mean 'all data before were deleted' - it just mean stage.Prune function were run to this block. Because 1 stage may prune multiple data types to different prune distance.\r\n\r\n \t\t\t\t stage_at \t prune_at\r\nSnapshots \t\t\t 36789494 \t 0\r\nHeaders \t\t\t 36789495 \t 0\r\nBlockHashes \t\t\t 36789495 \t 0\r\nBodies \t\t\t\t 36789495 \t 0\r\nSenders \t\t\t 36789495 \t 0\r\nExecution \t\t\t 36789495 \t 36789495\r\nTranslation \t\t\t 0 \t\t 0\r\nHashState \t\t\t 36789495 \t 0\r\nIntermediateHashes \t\t 36789495 \t 36789495\r\nAccountHistoryIndex \t\t 36789495 \t 0\r\nStorageHistoryIndex \t\t 36789495 \t 0\r\nLogIndex \t\t\t 36789495 \t 0\r\nCallTraces \t\t\t 36789495 \t 36789495\r\nTxLookup \t\t\t 36789495 \t 36699000\r\nFinish \t\t\t\t 36789495 \t 0\r\n--\r\nprune distance: \r\n\r\nhistory v3 idx steps: 0.00\r\n\r\nsequence: EthTx=2349759279, NonCanonicalTx=1668493\r\n\r\nfirst header in db: 36699000\r\nfirst body in db: 36699000\r\n\r\n--\r\nsnapsthos: blocks=36698999, segments=36698999, indices=36698999\r\n```\r\n",
  "closed_by": {
    "login": "michaelscheung",
    "id": 3878375,
    "node_id": "MDQ6VXNlcjM4NzgzNzU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3878375?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/michaelscheung",
    "html_url": "https://github.com/michaelscheung",
    "followers_url": "https://api.github.com/users/michaelscheung/followers",
    "following_url": "https://api.github.com/users/michaelscheung/following{/other_user}",
    "gists_url": "https://api.github.com/users/michaelscheung/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/michaelscheung/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michaelscheung/subscriptions",
    "organizations_url": "https://api.github.com/users/michaelscheung/orgs",
    "repos_url": "https://api.github.com/users/michaelscheung/repos",
    "events_url": "https://api.github.com/users/michaelscheung/events{/privacy}",
    "received_events_url": "https://api.github.com/users/michaelscheung/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6495/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6495/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1369685275",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/6495#issuecomment-1369685275",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6495",
    "id": 1369685275,
    "node_id": "IC_kwDOC0FsAM5Ro70b",
    "user": {
      "login": "michaelscheung",
      "id": 3878375,
      "node_id": "MDQ6VXNlcjM4NzgzNzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3878375?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelscheung",
      "html_url": "https://github.com/michaelscheung",
      "followers_url": "https://api.github.com/users/michaelscheung/followers",
      "following_url": "https://api.github.com/users/michaelscheung/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelscheung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelscheung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelscheung/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelscheung/orgs",
      "repos_url": "https://api.github.com/users/michaelscheung/repos",
      "events_url": "https://api.github.com/users/michaelscheung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelscheung/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-03T11:56:49Z",
    "updated_at": "2023-01-03T11:56:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "Closing this issue, because I believe it is the result of misconfiguration",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1369685275/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
