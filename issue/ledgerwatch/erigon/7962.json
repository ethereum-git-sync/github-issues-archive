{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7962",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7962/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7962/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7962/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/7962",
  "id": 1834316455,
  "node_id": "I_kwDOC0FsAM5tVXKn",
  "number": 7962,
  "title": "Erigon Sync very slow",
  "user": {
    "login": "zayg",
    "id": 3822934,
    "node_id": "MDQ6VXNlcjM4MjI5MzQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3822934?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/zayg",
    "html_url": "https://github.com/zayg",
    "followers_url": "https://api.github.com/users/zayg/followers",
    "following_url": "https://api.github.com/users/zayg/following{/other_user}",
    "gists_url": "https://api.github.com/users/zayg/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/zayg/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/zayg/subscriptions",
    "organizations_url": "https://api.github.com/users/zayg/orgs",
    "repos_url": "https://api.github.com/users/zayg/repos",
    "events_url": "https://api.github.com/users/zayg/events{/privacy}",
    "received_events_url": "https://api.github.com/users/zayg/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-08-03T05:45:38Z",
  "updated_at": "2023-08-03T21:59:14Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "# Erigon Version\r\n*erigon version 2.48.1-stable-674b77f0*\r\n\r\nCommand\r\n```\r\n~/code/erigonlog/erigon --log.dir.path ~/code/erigonlog/ --log.dir.verbosity 3 \\\r\n       --datadir /Volumes/blockchain/erigon/ \\\r\n       --chain mainnet \\\r\n       --http --ws --http.trace --http.api eth,debug,net,trace,web3,erigon,txpool --http.addr \"192.168.0.16\" --http.vhosts \"192.168.0.13\" --http.port 8545 --graphql \\\r\n       --authrpc.addr localhost --authrpc.port 8551 --authrpc.vhosts localhost --authrpc.jwtsecret /Volumes/blockchain/erigon/jwtsecret \\\r\n       --private.api.addr localhost:9090 \\\r\n       --metrics --metrics.addr \"192.168.0.16\" --metrics.port 6060 \\\r\n       --pprof --pprof.addr \"192.168.0.16\" --pprof.port 6060\r\n\r\n```\r\n\r\n# Chain data Sync\r\n\r\nOnly 10+blk/s.\r\n\r\n```\r\nINFO[08-02|22:41:46.573] [snapshots] Blocks Stat                  blocks=17000k indices=17000k alloc=4.1GB sys=4.3GB\r\nINFO[08-02|22:41:48.585] [7/15 Execution] Blocks execution        from=10751279 to=16999999\r\nINFO[08-02|22:42:08.608] [7/15 Execution] Executed blocks         number=10751483 blk/s=10.2 tx/s=1475.4 Mgas/s=123.8 gasState=0.00 batch=5.6MB alloc=3.2GB sys=4.3GB\r\nINFO[08-02|22:42:29.208] [7/15 Execution] Executed blocks         number=10751810 blk/s=16.4 tx/s=2309.2 Mgas/s=197.4 gasState=0.01 batch=15.5MB alloc=2.5GB sys=4.3GB\r\nINFO[08-02|22:42:43.883] [txpool] stat                            pending=0 baseFee=0 queued=42 alloc=2.9GB sys=4.3GB\r\nINFO[08-02|22:42:49.223] [7/15 Execution] Executed blocks         number=10752018 blk/s=10.4 tx/s=1503.4 Mgas/s=125.8 gasState=0.02 batch=21.9MB alloc=3.2GB sys=4.3GB\r\n```\r\n\r\n# Hardware\r\n\r\n<img width=\"256\" alt=\"image\" src=\"https://github.com/ledgerwatch/erigon/assets/3822934/d9af295a-5fd0-4aca-a1f8-3a018c46b609\">\r\n\r\n<img width=\"397\" alt=\"image\" src=\"https://github.com/ledgerwatch/erigon/assets/3822934/c2119a8f-d8f2-4296-aa3f-29951008c347\">\r\n\r\n<img width=\"422\" alt=\"image\" src=\"https://github.com/ledgerwatch/erigon/assets/3822934/7eba6484-f67b-464e-85b4-9eb69540cc8e\">\r\n\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7962/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7962/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1663328145",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7962#issuecomment-1663328145",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7962",
    "id": 1663328145,
    "node_id": "IC_kwDOC0FsAM5jJF-R",
    "user": {
      "login": "zayg",
      "id": 3822934,
      "node_id": "MDQ6VXNlcjM4MjI5MzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3822934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zayg",
      "html_url": "https://github.com/zayg",
      "followers_url": "https://api.github.com/users/zayg/followers",
      "following_url": "https://api.github.com/users/zayg/following{/other_user}",
      "gists_url": "https://api.github.com/users/zayg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zayg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zayg/subscriptions",
      "organizations_url": "https://api.github.com/users/zayg/orgs",
      "repos_url": "https://api.github.com/users/zayg/repos",
      "events_url": "https://api.github.com/users/zayg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zayg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-03T05:48:19Z",
    "updated_at": "2023-08-03T05:48:19Z",
    "author_association": "NONE",
    "body": "The very first day, the speed of sync is hundreds of blk/s, now it becomes 10blk/s. Not sure what's going on.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1663328145/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1663901632",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7962#issuecomment-1663901632",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7962",
    "id": 1663901632,
    "node_id": "IC_kwDOC0FsAM5jLR_A",
    "user": {
      "login": "tjayrush",
      "id": 5417918,
      "node_id": "MDQ6VXNlcjU0MTc5MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5417918?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tjayrush",
      "html_url": "https://github.com/tjayrush",
      "followers_url": "https://api.github.com/users/tjayrush/followers",
      "following_url": "https://api.github.com/users/tjayrush/following{/other_user}",
      "gists_url": "https://api.github.com/users/tjayrush/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tjayrush/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tjayrush/subscriptions",
      "organizations_url": "https://api.github.com/users/tjayrush/orgs",
      "repos_url": "https://api.github.com/users/tjayrush/repos",
      "events_url": "https://api.github.com/users/tjayrush/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tjayrush/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-03T12:32:15Z",
    "updated_at": "2023-08-03T12:32:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm not an expert nor am I part of the Erigon team, but I suspect two things are happening.\r\n\r\nRemember, the sync happens from block zero forward in time.\r\n\r\n1. The number of transactions per block increases massively over time and\r\n2. The complexity of the transactions increases massively over time. \r\n\r\nThese two combine to slow things down the later in the chain's history the sync gets.\r\n\r\nI would close this issue as you're describing expected behavior, but perhaps someone else can chime in.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1663901632/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1664243721",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7962#issuecomment-1664243721",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7962",
    "id": 1664243721,
    "node_id": "IC_kwDOC0FsAM5jMlgJ",
    "user": {
      "login": "zayg",
      "id": 3822934,
      "node_id": "MDQ6VXNlcjM4MjI5MzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3822934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zayg",
      "html_url": "https://github.com/zayg",
      "followers_url": "https://api.github.com/users/zayg/followers",
      "following_url": "https://api.github.com/users/zayg/following{/other_user}",
      "gists_url": "https://api.github.com/users/zayg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zayg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zayg/subscriptions",
      "organizations_url": "https://api.github.com/users/zayg/orgs",
      "repos_url": "https://api.github.com/users/zayg/repos",
      "events_url": "https://api.github.com/users/zayg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zayg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-03T15:58:40Z",
    "updated_at": "2023-08-03T15:58:40Z",
    "author_association": "NONE",
    "body": "> I'm not an expert nor am I part of the Erigon team, but I suspect two things are happening.\r\n> \r\n> Remember, the sync happens from block zero forward in time.\r\n> \r\n> 1. The number of transactions per block increases massively over time and\r\n> 2. The complexity of the transactions increases massively over time.\r\n> \r\n> These two combine to slow things down the later in the chain's history the sync gets.\r\n> \r\n> I would close this issue as you're describing expected behavior, but perhaps someone else can chime in.\r\n\r\nThank you @tjayrush. It makes sense, though the doc says it takes ~4 days to do a sync in archive mode, but for me it is already a week and I guess it will need another week to finish the sync.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1664243721/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1664696276",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7962#issuecomment-1664696276",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7962",
    "id": 1664696276,
    "node_id": "IC_kwDOC0FsAM5jOT_U",
    "user": {
      "login": "wmitsuda",
      "id": 28685,
      "node_id": "MDQ6VXNlcjI4Njg1",
      "avatar_url": "https://avatars.githubusercontent.com/u/28685?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wmitsuda",
      "html_url": "https://github.com/wmitsuda",
      "followers_url": "https://api.github.com/users/wmitsuda/followers",
      "following_url": "https://api.github.com/users/wmitsuda/following{/other_user}",
      "gists_url": "https://api.github.com/users/wmitsuda/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wmitsuda/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wmitsuda/subscriptions",
      "organizations_url": "https://api.github.com/users/wmitsuda/orgs",
      "repos_url": "https://api.github.com/users/wmitsuda/repos",
      "events_url": "https://api.github.com/users/wmitsuda/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wmitsuda/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-03T21:59:14Z",
    "updated_at": "2023-08-03T21:59:14Z",
    "author_association": "COLLABORATOR",
    "body": "I think the 4 days estimate is outdated, also blocks/s is not a good measure for the reasons TJ has explained above, I think mgas/s is more accurate over time, and also it may say something about how performant is your disk.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1664696276/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
