{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8181",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8181/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8181/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8181/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/8181",
  "id": 1892100977,
  "node_id": "I_kwDOC0FsAM5wxytx",
  "number": 8181,
  "title": "Metrics producing duplicate #TYPE definitions",
  "user": {
    "login": "angusscott",
    "id": 4872839,
    "node_id": "MDQ6VXNlcjQ4NzI4Mzk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4872839?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/angusscott",
    "html_url": "https://github.com/angusscott",
    "followers_url": "https://api.github.com/users/angusscott/followers",
    "following_url": "https://api.github.com/users/angusscott/following{/other_user}",
    "gists_url": "https://api.github.com/users/angusscott/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/angusscott/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/angusscott/subscriptions",
    "organizations_url": "https://api.github.com/users/angusscott/orgs",
    "repos_url": "https://api.github.com/users/angusscott/repos",
    "events_url": "https://api.github.com/users/angusscott/events{/privacy}",
    "received_events_url": "https://api.github.com/users/angusscott/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4566396003,
      "node_id": "LA_kwDOC0FsAM8AAAABEC2sYw",
      "url": "https://api.github.com/repos/ledgerwatch/erigon/labels/Stale",
      "name": "Stale",
      "color": "ededed",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "mh0lt",
    "id": 135143369,
    "node_id": "U_kgDOCA4fyQ",
    "avatar_url": "https://avatars.githubusercontent.com/u/135143369?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mh0lt",
    "html_url": "https://github.com/mh0lt",
    "followers_url": "https://api.github.com/users/mh0lt/followers",
    "following_url": "https://api.github.com/users/mh0lt/following{/other_user}",
    "gists_url": "https://api.github.com/users/mh0lt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mh0lt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mh0lt/subscriptions",
    "organizations_url": "https://api.github.com/users/mh0lt/orgs",
    "repos_url": "https://api.github.com/users/mh0lt/repos",
    "events_url": "https://api.github.com/users/mh0lt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mh0lt/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "mh0lt",
      "id": 135143369,
      "node_id": "U_kgDOCA4fyQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/135143369?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mh0lt",
      "html_url": "https://github.com/mh0lt",
      "followers_url": "https://api.github.com/users/mh0lt/followers",
      "following_url": "https://api.github.com/users/mh0lt/following{/other_user}",
      "gists_url": "https://api.github.com/users/mh0lt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mh0lt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mh0lt/subscriptions",
      "organizations_url": "https://api.github.com/users/mh0lt/orgs",
      "repos_url": "https://api.github.com/users/mh0lt/repos",
      "events_url": "https://api.github.com/users/mh0lt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mh0lt/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2023-09-12T09:40:03Z",
  "updated_at": "2023-11-06T02:08:50Z",
  "closed_at": "2023-11-06T02:08:50Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: erigon version erigon version 2.49.1-stable-205eeda0\r\n\r\nOS & Version: Linux\r\n\r\nErigon Command (with flags/config):\r\n\r\n\r\nChain/Network: Ethereum\r\n\r\n#### Expected behaviour\r\n\r\nExpect metrics to not be defined more than once\r\n\r\n#### Actual behaviour\r\n\r\nMetric TYPES are still being duplicated, and are breaking against this linter https://o11y.tools/metricslint/\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\nStart an instance of Erigon, with --metrics enabled, and make a request.\r\n\r\nFollowing from this issue https://github.com/ledgerwatch/erigon/issues/8053\r\n\r\nthe metrics endpoint (/debug/metrics/prometheus) still produces invalid metrics. Metrics were tested against this linter https://o11y.tools/metricslint/ and comes back with the following issue. \r\n\r\n\"text format parsing error in line 150: second TYPE line for metric name \"cache_total\", or TYPE reported after samples\"\r\n\r\nI'm verifying the same with Telegraf currently, and will include the output of that once done.\r\n\r\nResult\r\n\r\n(Metrics can be passed to linter to produce same result)\r\n\r\n```\r\ndb_gc_leaf 0\r\ndb_gc_overflow 0\r\ndb_gc_pages 0\r\ndb_pgops{phase=\"clone\"} 0\r\ndb_pgops{phase=\"cow\"} 0\r\ndb_pgops{phase=\"merge\"} 0\r\ndb_pgops{phase=\"newly\"} 0\r\ndb_pgops{phase=\"spill\"} 0\r\ndb_pgops{phase=\"split\"} 0\r\ndb_pgops{phase=\"unspill\"} 0\r\ndb_pgops{phase=\"wops\"} 0\r\ndb_size 0\r\ndomain_block_current 0\r\ndomain_collation_hist_size 0\r\ndomain_collation_size 0\r\ndomain_commitment_keys 0\r\ndomain_commitment_updates 0\r\ndomain_commitment_updates_applied 0\r\ndomain_prune_size 0\r\ndomain_pruning_progress 0\r\ndomain_running_collations 0\r\ndomain_running_commitment 0\r\ndomain_running_merges 0\r\ndomain_step_current 0\r\ndomain_tx_processed 0\r\nexec_repeats 0\r\nexec_steps_in_db 0\r\nexec_triggers 0\r\nexec_txs_done 0\r\npool_write_to_db_bytes 0\r\ntx_dirty 0\r\ntx_limit 0\r\ntx_spill 0\r\ntx_unspill 0\r\ntxpool_basefee 0\r\ntxpool_pending 0\r\ntxpool_queued 0\r\n# HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.\r\n# TYPE go_gc_duration_seconds summary\r\ngo_gc_duration_seconds{quantile=\"0\"} 2.7912e-05\r\ngo_gc_duration_seconds{quantile=\"0.25\"} 4.6706e-05\r\ngo_gc_duration_seconds{quantile=\"0.5\"} 6.3137e-05\r\ngo_gc_duration_seconds{quantile=\"0.75\"} 0.000173571\r\ngo_gc_duration_seconds{quantile=\"1\"} 0.000451838\r\ngo_gc_duration_seconds_sum 0.002029061\r\ngo_gc_duration_seconds_count 17\r\n# HELP go_goroutines Number of goroutines that currently exist.\r\n# TYPE go_goroutines gauge\r\ngo_goroutines 32\r\n# HELP go_info Information about the Go environment.\r\n# TYPE go_info gauge\r\ngo_info{version=\"go1.19.13\"} 1\r\n# HELP go_memstats_alloc_bytes Number of bytes allocated and still in use.\r\n# TYPE go_memstats_alloc_bytes gauge\r\ngo_memstats_alloc_bytes 1.9882856e+07\r\n# HELP go_memstats_alloc_bytes_total Total number of bytes allocated, even if freed.\r\n# TYPE go_memstats_alloc_bytes_total counter\r\ngo_memstats_alloc_bytes_total 1.05080232e+08\r\n# HELP go_memstats_buck_hash_sys_bytes Number of bytes used by the profiling bucket hash table.\r\n# TYPE go_memstats_buck_hash_sys_bytes gauge\r\ngo_memstats_buck_hash_sys_bytes 1.478183e+06\r\n# HELP go_memstats_frees_total Total number of frees.\r\n# TYPE go_memstats_frees_total counter\r\ngo_memstats_frees_total 623571\r\n# HELP go_memstats_gc_sys_bytes Number of bytes used for garbage collection system metadata.\r\n# TYPE go_memstats_gc_sys_bytes gauge\r\ngo_memstats_gc_sys_bytes 9.923464e+06\r\n# HELP go_memstats_heap_alloc_bytes Number of heap bytes allocated and still in use.\r\n# TYPE go_memstats_heap_alloc_bytes gauge\r\ngo_memstats_heap_alloc_bytes 1.9882856e+07\r\n# HELP go_memstats_heap_idle_bytes Number of heap bytes waiting to be used.\r\n# TYPE go_memstats_heap_idle_bytes gauge\r\ngo_memstats_heap_idle_bytes 1.155072e+07\r\n# HELP go_memstats_heap_inuse_bytes Number of heap bytes that are in use.\r\n# TYPE go_memstats_heap_inuse_bytes gauge\r\ngo_memstats_heap_inuse_bytes 2.4559616e+07\r\n# HELP go_memstats_heap_objects Number of allocated objects.\r\n# TYPE go_memstats_heap_objects gauge\r\ngo_memstats_heap_objects 127530\r\n# HELP go_memstats_heap_released_bytes Number of heap bytes released to OS.\r\n# TYPE go_memstats_heap_released_bytes gauge\r\ngo_memstats_heap_released_bytes 9.289728e+06\r\n# HELP go_memstats_heap_sys_bytes Number of heap bytes obtained from system.\r\n# TYPE go_memstats_heap_sys_bytes gauge\r\ngo_memstats_heap_sys_bytes 3.6110336e+07\r\n# HELP go_memstats_last_gc_time_seconds Number of seconds since 1970 of last garbage collection.\r\n# TYPE go_memstats_last_gc_time_seconds gauge\r\ngo_memstats_last_gc_time_seconds 1.6945115264529555e+09\r\n# HELP go_memstats_lookups_total Total number of pointer lookups.\r\n# TYPE go_memstats_lookups_total counter\r\ngo_memstats_lookups_total 0\r\n# HELP go_memstats_mallocs_total Total number of mallocs.\r\n# TYPE go_memstats_mallocs_total counter\r\ngo_memstats_mallocs_total 751101\r\n# HELP go_memstats_mcache_inuse_bytes Number of bytes in use by mcache structures.\r\n# TYPE go_memstats_mcache_inuse_bytes gauge\r\ngo_memstats_mcache_inuse_bytes 28800\r\n# HELP go_memstats_mcache_sys_bytes Number of bytes used for mcache structures obtained from system.\r\n# TYPE go_memstats_mcache_sys_bytes gauge\r\ngo_memstats_mcache_sys_bytes 31200\r\n# HELP go_memstats_mspan_inuse_bytes Number of bytes in use by mspan structures.\r\n# TYPE go_memstats_mspan_inuse_bytes gauge\r\ngo_memstats_mspan_inuse_bytes 336096\r\n# HELP go_memstats_mspan_sys_bytes Number of bytes used for mspan structures obtained from system.\r\n# TYPE go_memstats_mspan_sys_bytes gauge\r\ngo_memstats_mspan_sys_bytes 423072\r\n# HELP go_memstats_next_gc_bytes Number of heap bytes when next garbage collection will take place.\r\n# TYPE go_memstats_next_gc_bytes gauge\r\ngo_memstats_next_gc_bytes 3.216496e+07\r\n# HELP go_memstats_other_sys_bytes Number of bytes used for other system allocations.\r\n# TYPE go_memstats_other_sys_bytes gauge\r\ngo_memstats_other_sys_bytes 4.050137e+06\r\n# HELP go_memstats_stack_inuse_bytes Number of bytes in use by the stack allocator.\r\n# TYPE go_memstats_stack_inuse_bytes gauge\r\ngo_memstats_stack_inuse_bytes 1.6384e+06\r\n# HELP go_memstats_stack_sys_bytes Number of bytes obtained from system for stack allocator.\r\n# TYPE go_memstats_stack_sys_bytes gauge\r\ngo_memstats_stack_sys_bytes 1.6384e+06\r\n# HELP go_memstats_sys_bytes Number of bytes obtained from system.\r\n# TYPE go_memstats_sys_bytes gauge\r\ngo_memstats_sys_bytes 5.3654792e+07\r\n# HELP go_threads Number of OS threads created.\r\n# TYPE go_threads gauge\r\ngo_threads 30\r\n# HELP process_cpu_seconds_total Total user and system CPU time spent in seconds.\r\n# TYPE process_cpu_seconds_total counter\r\nprocess_cpu_seconds_total 0.79\r\n# HELP process_max_fds Maximum number of open file descriptors.\r\n# TYPE process_max_fds gauge\r\nprocess_max_fds 524288\r\n# HELP process_open_fds Number of open file descriptors.\r\n# TYPE process_open_fds gauge\r\nprocess_open_fds 18\r\n# HELP process_resident_memory_bytes Resident memory size in bytes.\r\n# TYPE process_resident_memory_bytes gauge\r\nprocess_resident_memory_bytes 9.8226176e+07\r\n# HELP process_start_time_seconds Start time of the process since unix epoch in seconds.\r\n# TYPE process_start_time_seconds gauge\r\nprocess_start_time_seconds 1.69451041236e+09\r\n# HELP process_virtual_memory_bytes Virtual memory size in bytes.\r\n# TYPE process_virtual_memory_bytes gauge\r\nprocess_virtual_memory_bytes 5.500484993024e+12\r\n# HELP process_virtual_memory_max_bytes Maximum amount of virtual memory available in bytes.\r\n# TYPE process_virtual_memory_max_bytes gauge\r\nprocess_virtual_memory_max_bytes 1.8446744073709552e+19\r\n\r\n# TYPE cache_total counter\r\ncache_total{target=\"acc_read\"} 0\r\n\r\n# TYPE cache_total counter\r\ncache_total{target=\"st_read\"} 0\r\n\r\n# TYPE cache_total counter\r\ncache_total{target=\"write\"} 0\r\n\r\n# TYPE chain_execution_seconds summary\r\nchain_execution_seconds {quantile=\"0.5\"} 0\r\nchain_execution_seconds {quantile=\"0.9\"} 0\r\nchain_execution_seconds {quantile=\"0.97\"} 0\r\nchain_execution_seconds {quantile=\"0.99\"} 0\r\nchain_execution_seconds {quantile=\"1\"} 0\r\nchain_execution_seconds_time 300.000000\r\nchain_execution_seconds_sum 0.000000\r\nchain_execution_seconds_count 5\r\n\r\n# TYPE p2p_dials counter\r\np2p_dials 0\r\n\r\n# TYPE p2p_egress counter\r\np2p_egress 0\r\n\r\n# TYPE p2p_ingress counter\r\np2p_ingress 0\r\n\r\n# TYPE p2p_peers gauge\r\np2p_peers 0\r\n\r\n# TYPE p2p_serves counter\r\np2p_serves 0\r\n\r\n# TYPE rpc_duration_seconds{method=\"eth_call\",success=\"success\"} summary\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\"} {quantile=\"0.5\"} 0\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\"} {quantile=\"0.9\"} 0\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\"} {quantile=\"0.97\"} 0\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\"} {quantile=\"0.99\"} 0\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\"} {quantile=\"1\"} 0\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\"}_time 300.000000\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\"}_sum 0.000000\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\"}_count 5\r\n\r\n# TYPE rpc_duration_seconds{method=\"eth_gasPrice\",success=\"success\"} summary\r\nrpc_duration_seconds{method=\"eth_gasPrice\",success=\"success\"} {quantile=\"0.5\"} 0\r\nrpc_duration_seconds{method=\"eth_gasPrice\",success=\"success\"} {quantile=\"0.9\"} 0\r\nrpc_duration_seconds{method=\"eth_gasPrice\",success=\"success\"} {quantile=\"0.97\"} 0\r\nrpc_duration_seconds{method=\"eth_gasPrice\",success=\"success\"} {quantile=\"0.99\"} 0\r\nrpc_duration_seconds{method=\"eth_gasPrice\",success=\"success\"} {quantile=\"1\"} 0\r\nrpc_duration_seconds{method=\"eth_gasPrice\",success=\"success\"}_time 300.000000\r\nrpc_duration_seconds{method=\"eth_gasPrice\",success=\"success\"}_sum 0.000000\r\nrpc_duration_seconds{method=\"eth_gasPrice\",success=\"success\"}_count 5\r\n\r\n# TYPE rpc_duration_seconds{method=\"eth_getBlockByNumber\",success=\"success\"} summary\r\nrpc_duration_seconds{method=\"eth_getBlockByNumber\",success=\"success\"} {quantile=\"0.5\"} 0\r\nrpc_duration_seconds{method=\"eth_getBlockByNumber\",success=\"success\"} {quantile=\"0.9\"} 0\r\nrpc_duration_seconds{method=\"eth_getBlockByNumber\",success=\"success\"} {quantile=\"0.97\"} 0\r\nrpc_duration_seconds{method=\"eth_getBlockByNumber\",success=\"success\"} {quantile=\"0.99\"} 0\r\nrpc_duration_seconds{method=\"eth_getBlockByNumber\",success=\"success\"} {quantile=\"1\"} 0\r\nrpc_duration_seconds{method=\"eth_getBlockByNumber\",success=\"success\"}_time 300.000000\r\nrpc_duration_seconds{method=\"eth_getBlockByNumber\",success=\"success\"}_sum 0.000000\r\nrpc_duration_seconds{method=\"eth_getBlockByNumber\",success=\"success\"}_count 5\r\n\r\n# TYPE rpc_duration_seconds{method=\"eth_getCode\",success=\"success\"} summary\r\nrpc_duration_seconds{method=\"eth_getCode\",success=\"success\"} {quantile=\"0.5\"} 0\r\nrpc_duration_seconds{method=\"eth_getCode\",success=\"success\"} {quantile=\"0.9\"} 0\r\nrpc_duration_seconds{method=\"eth_getCode\",success=\"success\"} {quantile=\"0.97\"} 0\r\nrpc_duration_seconds{method=\"eth_getCode\",success=\"success\"} {quantile=\"0.99\"} 0\r\nrpc_duration_seconds{method=\"eth_getCode\",success=\"success\"} {quantile=\"1\"} 0\r\nrpc_duration_seconds{method=\"eth_getCode\",success=\"success\"}_time 300.000000\r\nrpc_duration_seconds{method=\"eth_getCode\",success=\"success\"}_sum 0.000000\r\nrpc_duration_seconds{method=\"eth_getCode\",success=\"success\"}_count 5\r\n\r\n# TYPE rpc_failure counter\r\nrpc_failure 0\r\n\r\n# TYPE rpc_total counter\r\nrpc_total 345\r\n\r\n# TYPE sync counter\r\nsync{stage=\"account_history_index\"} 0\r\n\r\n# TYPE sync counter\r\nsync{stage=\"block_hashes\"} 0\r\n\r\n# TYPE sync counter\r\nsync{stage=\"bodies\"} 0\r\n\r\n# TYPE sync counter\r\nsync{stage=\"bor_heimdall\"} 0\r\n\r\n# TYPE sync counter\r\nsync{stage=\"call_traces\"} 0\r\n\r\n# TYPE sync counter\r\nsync{stage=\"execution\"} 0\r\n\r\n# TYPE sync counter\r\nsync{stage=\"finish\"} 0\r\n\r\n# TYPE sync counter\r\nsync{stage=\"hash_state\"} 0\r\n\r\n# TYPE sync counter\r\nsync{stage=\"headers\"} 0\r\n\r\n# TYPE sync counter\r\nsync{stage=\"intermediate_hashes\"} 0\r\n\r\n# TYPE sync counter\r\nsync{stage=\"log_index\"} 0\r\n\r\n# TYPE sync counter\r\nsync{stage=\"senders\"} 0\r\n\r\n# TYPE sync counter\r\nsync{stage=\"snapshots\"} 0\r\n\r\n# TYPE sync counter\r\nsync{stage=\"storage_history_index\"} 0\r\n\r\n# TYPE sync counter\r\nsync{stage=\"translation\"} 0\r\n\r\n# TYPE sync counter\r\nsync{stage=\"tx_lookup\"} 0\r\n```\r\n\r\n",
  "closed_by": {
    "login": "github-actions[bot]",
    "id": 41898282,
    "node_id": "MDM6Qm90NDE4OTgyODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/github-actions%5Bbot%5D",
    "html_url": "https://github.com/apps/github-actions",
    "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8181/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8181/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1715402504",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8181#issuecomment-1715402504",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8181",
    "id": 1715402504,
    "node_id": "IC_kwDOC0FsAM5mPvcI",
    "user": {
      "login": "angusscott",
      "id": 4872839,
      "node_id": "MDQ6VXNlcjQ4NzI4Mzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4872839?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/angusscott",
      "html_url": "https://github.com/angusscott",
      "followers_url": "https://api.github.com/users/angusscott/followers",
      "following_url": "https://api.github.com/users/angusscott/following{/other_user}",
      "gists_url": "https://api.github.com/users/angusscott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/angusscott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/angusscott/subscriptions",
      "organizations_url": "https://api.github.com/users/angusscott/orgs",
      "repos_url": "https://api.github.com/users/angusscott/repos",
      "events_url": "https://api.github.com/users/angusscott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/angusscott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-12T10:00:50Z",
    "updated_at": "2023-09-12T10:08:12Z",
    "author_association": "NONE",
    "body": "Just to add the range of issues in these metrics\r\n\r\n1. Metrics #TYPE is being duplicated (see this for cache_total and sync metrics)\r\n\r\nexample:\r\n```\r\n# TYPE cache_total counter\r\ncache_total{target=\"acc_read\"} 0\r\n\r\n# TYPE cache_total counter\r\ncache_total{target=\"st_read\"} 0\r\n\r\n# TYPE cache_total counter\r\ncache_total{target=\"write\"} 0\r\n```\r\n\r\nshould be \r\n\r\n```\r\n# TYPE cache_total counter\r\ncache_total{target=\"acc_read\"} 0\r\ncache_total{target=\"st_read\"} 0\r\ncache_total{target=\"write\"} 0\r\n```\r\n2. Metrics #TYPE are malformed, and shouldn't include the label in the definition\r\n example:\r\n```\r\n# TYPE rpc_duration_seconds{method=\"eth_call\",success=\"success\"} summary\r\n```\r\n\r\nshould be \r\n```\r\n# TYPE rpc_duration_seconds summary\r\n```\r\n\r\n3. Labels aren't correctly grouped (similar to issue above)\r\nexample:\r\n```\r\n# TYPE rpc_duration_seconds{method=\"eth_call\",success=\"success\"} summary\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\"} {quantile=\"0.5\"} 0\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\"} {quantile=\"0.9\"} 0\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\"} {quantile=\"0.97\"} 0\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\"} {quantile=\"0.99\"} 0\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\"} {quantile=\"1\"} 0\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\"}_time 300.000000\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\"}_sum 0.000000\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\"}_count 5\r\n```\r\n\r\nshould be \r\n```\r\n# TYPE rpc_duration_seconds summary\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\", quantile=\"0.5\"} 0\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\", quantile=\"0.9\"} 0\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\", quantile=\"0.97\"} 0\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\", quantile=\"0.99\"} 0\r\nrpc_duration_seconds{method=\"eth_call\",success=\"success\", quantile=\"1\"} 0\r\nrpc_duration_seconds_time{method=\"eth_call\",success=\"success\"} 300.000000\r\nrpc_duration_seconds_sum{method=\"eth_call\",success=\"success\"} 0.000000\r\nrpc_duration_seconds_count{method=\"eth_call\",success=\"success\"} 5\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1715402504/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1715403992",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8181#issuecomment-1715403992",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8181",
    "id": 1715403992,
    "node_id": "IC_kwDOC0FsAM5mPvzY",
    "user": {
      "login": "angusscott",
      "id": 4872839,
      "node_id": "MDQ6VXNlcjQ4NzI4Mzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4872839?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/angusscott",
      "html_url": "https://github.com/angusscott",
      "followers_url": "https://api.github.com/users/angusscott/followers",
      "following_url": "https://api.github.com/users/angusscott/following{/other_user}",
      "gists_url": "https://api.github.com/users/angusscott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/angusscott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/angusscott/subscriptions",
      "organizations_url": "https://api.github.com/users/angusscott/orgs",
      "repos_url": "https://api.github.com/users/angusscott/repos",
      "events_url": "https://api.github.com/users/angusscott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/angusscott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-12T10:01:46Z",
    "updated_at": "2023-09-12T10:01:46Z",
    "author_association": "NONE",
    "body": "@mh0lt tagging you since you worked on this the other day",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1715403992/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1715466340",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8181#issuecomment-1715466340",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8181",
    "id": 1715466340,
    "node_id": "IC_kwDOC0FsAM5mP_Bk",
    "user": {
      "login": "angusscott",
      "id": 4872839,
      "node_id": "MDQ6VXNlcjQ4NzI4Mzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4872839?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/angusscott",
      "html_url": "https://github.com/angusscott",
      "followers_url": "https://api.github.com/users/angusscott/followers",
      "following_url": "https://api.github.com/users/angusscott/following{/other_user}",
      "gists_url": "https://api.github.com/users/angusscott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/angusscott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/angusscott/subscriptions",
      "organizations_url": "https://api.github.com/users/angusscott/orgs",
      "repos_url": "https://api.github.com/users/angusscott/repos",
      "events_url": "https://api.github.com/users/angusscott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/angusscott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-12T10:31:09Z",
    "updated_at": "2023-09-12T10:31:09Z",
    "author_association": "NONE",
    "body": "Also looks like some of these are captured by https://github.com/ledgerwatch/erigon/issues/8155\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1715466340/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1718061583",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8181#issuecomment-1718061583",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8181",
    "id": 1718061583,
    "node_id": "IC_kwDOC0FsAM5mZ4oP",
    "user": {
      "login": "mh0lt",
      "id": 135143369,
      "node_id": "U_kgDOCA4fyQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/135143369?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mh0lt",
      "html_url": "https://github.com/mh0lt",
      "followers_url": "https://api.github.com/users/mh0lt/followers",
      "following_url": "https://api.github.com/users/mh0lt/following{/other_user}",
      "gists_url": "https://api.github.com/users/mh0lt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mh0lt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mh0lt/subscriptions",
      "organizations_url": "https://api.github.com/users/mh0lt/orgs",
      "repos_url": "https://api.github.com/users/mh0lt/repos",
      "events_url": "https://api.github.com/users/mh0lt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mh0lt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-13T17:48:34Z",
    "updated_at": "2023-09-13T17:48:34Z",
    "author_association": "COLLABORATOR",
    "body": "I'm currently looking at pushing a fix into devel tomorrow am.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1718061583/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1720880898",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8181#issuecomment-1720880898",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8181",
    "id": 1720880898,
    "node_id": "IC_kwDOC0FsAM5mko8C",
    "user": {
      "login": "f0rmatting",
      "id": 507436,
      "node_id": "MDQ6VXNlcjUwNzQzNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/507436?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/f0rmatting",
      "html_url": "https://github.com/f0rmatting",
      "followers_url": "https://api.github.com/users/f0rmatting/followers",
      "following_url": "https://api.github.com/users/f0rmatting/following{/other_user}",
      "gists_url": "https://api.github.com/users/f0rmatting/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/f0rmatting/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/f0rmatting/subscriptions",
      "organizations_url": "https://api.github.com/users/f0rmatting/orgs",
      "repos_url": "https://api.github.com/users/f0rmatting/repos",
      "events_url": "https://api.github.com/users/f0rmatting/events{/privacy}",
      "received_events_url": "https://api.github.com/users/f0rmatting/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-15T08:26:18Z",
    "updated_at": "2023-09-15T08:45:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi everyone, I've discovered another bug.\r\n\r\nUse https://github.com/ledgerwatch/erigon/pull/8186\r\n```\r\n...\r\n# TYPE rpc_duration_seconds summary\r\nrpc_duration_seconds{method=\"engine_exchangeTransitionConfigurationV1\",success=\"success\"} {quantile=\"0.5\"} 0\r\nrpc_duration_seconds{method=\"engine_exchangeTransitionConfigurationV1\",success=\"success\"} {quantile=\"0.9\"} 0\r\nrpc_duration_seconds{method=\"engine_exchangeTransitionConfigurationV1\",success=\"success\"} {quantile=\"0.97\"} 0\r\nrpc_duration_seconds{method=\"engine_exchangeTransitionConfigurationV1\",success=\"success\"} {quantile=\"0.99\"} 0\r\nrpc_duration_seconds{method=\"engine_exchangeTransitionConfigurationV1\",success=\"success\"} {quantile=\"1\"} 0\r\nrpc_duration_seconds{method=\"engine_exchangeTransitionConfigurationV1\",success=\"success\"}_time 300.000000\r\nrpc_duration_seconds{method=\"engine_exchangeTransitionConfigurationV1\",success=\"success\"}_sum 0.000000\r\nrpc_duration_seconds{method=\"engine_exchangeTransitionConfigurationV1\",success=\"success\"}_count 5\r\n...\r\n```\r\n\r\nShould\r\n```\r\n...\r\n# TYPE rpc_duration_seconds summary\r\nrpc_duration_seconds{method=\"engine_exchangeTransitionConfigurationV1\",success=\"success\", quantile=\"0.5\"} 0\r\nrpc_duration_seconds{method=\"engine_exchangeTransitionConfigurationV1\",success=\"success\", quantile=\"0.9\"} 0\r\nrpc_duration_seconds{method=\"engine_exchangeTransitionConfigurationV1\",success=\"success\", quantile=\"0.97\"} 0\r\nrpc_duration_seconds{method=\"engine_exchangeTransitionConfigurationV1\",success=\"success\", quantile=\"0.99\"} 0\r\nrpc_duration_seconds{method=\"engine_exchangeTransitionConfigurationV1\",success=\"success\", quantile=\"1\"} 0\r\n# TYPE rpc_duration_seconds gauge\r\nrpc_duration_seconds_time{method=\"engine_exchangeTransitionConfigurationV1\",success=\"success\"}300.000000\r\n# TYPE rpc_duration_seconds_sum counter\r\nrpc_duration_seconds_sum{method=\"engine_exchangeTransitionConfigurationV1\",success=\"success\"}0.000000\r\n# TYPE rpc_duration_seconds_count counter\r\nrpc_duration_seconds_count{method=\"engine_exchangeTransitionConfigurationV1\",success=\"success\"}5\r\n...\r\n```\r\n\r\nI have some confusion here. Why not use github.com/prometheus/client_golang directly instead of manually concatenating strings? Unless there's a specific reason, I'm planning to rewrite this part of the code using github.com/prometheus/client_golang.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1720880898/reactions",
      "total_count": 4,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1724835147",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8181#issuecomment-1724835147",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8181",
    "id": 1724835147,
    "node_id": "IC_kwDOC0FsAM5mzuVL",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-19T05:02:51Z",
    "updated_at": "2023-09-19T05:02:51Z",
    "author_association": "COLLABORATOR",
    "body": "@f0rmatting no reason, just unfinished migration. see https://github.com/ledgerwatch/erigon/issues/8206",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1724835147/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1784364376",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8181#issuecomment-1784364376",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8181",
    "id": 1784364376,
    "node_id": "IC_kwDOC0FsAM5qWz1Y",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-10-30T02:05:45Z",
    "updated_at": "2023-10-30T02:05:45Z",
    "author_association": "NONE",
    "body": "This issue is stale because it has been open for 40 days with no activity. Remove stale label or comment, or this will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1784364376/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1793970896",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8181#issuecomment-1793970896",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8181",
    "id": 1793970896,
    "node_id": "IC_kwDOC0FsAM5q7dLQ",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-11-06T02:08:49Z",
    "updated_at": "2023-11-06T02:08:49Z",
    "author_association": "NONE",
    "body": "This issue was closed because it has been stalled for 7 days with no activity.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1793970896/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": {
      "id": 15368,
      "slug": "github-actions",
      "node_id": "MDM6QXBwMTUzNjg=",
      "owner": {
        "login": "github",
        "id": 9919,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjk5MTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9919?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/github",
        "html_url": "https://github.com/github",
        "followers_url": "https://api.github.com/users/github/followers",
        "following_url": "https://api.github.com/users/github/following{/other_user}",
        "gists_url": "https://api.github.com/users/github/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/github/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/github/subscriptions",
        "organizations_url": "https://api.github.com/users/github/orgs",
        "repos_url": "https://api.github.com/users/github/repos",
        "events_url": "https://api.github.com/users/github/events{/privacy}",
        "received_events_url": "https://api.github.com/users/github/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "name": "GitHub Actions",
      "description": "Automate your workflow from idea to production",
      "external_url": "https://help.github.com/en/actions",
      "html_url": "https://github.com/apps/github-actions",
      "created_at": "2018-07-30T09:30:17Z",
      "updated_at": "2019-12-10T19:04:12Z",
      "permissions": {
        "actions": "write",
        "administration": "read",
        "checks": "write",
        "contents": "write",
        "deployments": "write",
        "discussions": "write",
        "issues": "write",
        "merge_queues": "write",
        "metadata": "read",
        "packages": "write",
        "pages": "write",
        "pull_requests": "write",
        "repository_hooks": "write",
        "repository_projects": "write",
        "security_events": "write",
        "statuses": "write",
        "vulnerability_alerts": "read"
      },
      "events": [
        "branch_protection_rule",
        "check_run",
        "check_suite",
        "create",
        "delete",
        "deployment",
        "deployment_status",
        "discussion",
        "discussion_comment",
        "fork",
        "gollum",
        "issues",
        "issue_comment",
        "label",
        "merge_group",
        "milestone",
        "page_build",
        "project",
        "project_card",
        "project_column",
        "public",
        "pull_request",
        "pull_request_review",
        "pull_request_review_comment",
        "push",
        "registry_package",
        "release",
        "repository",
        "repository_dispatch",
        "status",
        "watch",
        "workflow_dispatch",
        "workflow_run"
      ]
    }
  }
]
