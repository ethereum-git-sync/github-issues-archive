{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1312",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1312/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1312/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1312/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/1312",
  "id": 731206625,
  "node_id": "MDU6SXNzdWU3MzEyMDY2MjU=",
  "number": 1312,
  "title": "MDBX sync does not quit when I send term signal to TG",
  "user": {
    "login": "AlexeyAkhunov",
    "id": 13686139,
    "node_id": "MDQ6VXNlcjEzNjg2MTM5",
    "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AlexeyAkhunov",
    "html_url": "https://github.com/AlexeyAkhunov",
    "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
    "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
    "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
    "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
    "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2020-10-28T08:07:28Z",
  "updated_at": "2021-03-24T13:33:20Z",
  "closed_at": "2021-03-24T13:33:20Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "This is what I am left with:\r\n````\r\nINFO [10-28|00:14:49.723] Blockchain stopped\r\nWARN [10-28|00:14:49.773] Synchronisation failed, retrying         err=stopped\r\nINFO [10-28|00:14:49.776] Ethereum protocol stopped\r\nWARN [10-28|00:14:49.776] error while stopping transaction pool    err=\"transaction pool is already stopped\"\r\nINFO [10-28|00:14:49.779] database closed (LMDB)                   lmdb=nodes\r\nSIGABRT: abort\r\nPC=0x4a6781 m=0 sigcode=0\r\n\r\ngoroutine 0 [idle]:\r\nruntime.futex(0x2172528, 0x80, 0x0, 0x0, 0x2123f9c400000000, 0x427a59e501ebfd73, 0xec56493b494c30f, 0x719ad37cac39c136, 0x7ffeefd61ab0, 0x44027f, ...)\r\n        runtime/sys_linux_amd64.s:587 +0x21\r\nruntime.futexsleep(0x2172528, 0x0, 0xffffffffffffffff)\r\n        runtime/os_linux.go:45 +0x46\r\nruntime.notesleep(0x2172528)\r\n        runtime/lock_futex.go:159 +0x9f\r\nruntime.stopm()\r\n        runtime/proc.go:1910 +0xc5\r\nruntime.exitsyscall0(0xc000602600)\r\n        runtime/proc.go:3401 +0x11d\r\nruntime.mcall(0x11cf3c0)\r\n        runtime/asm_amd64.s:318 +0x5b\r\n\r\ngoroutine 1 [chan receive, 2155 minutes]:\r\ngithub.com/ledgerwatch/turbo-geth/node.(*Node).Wait(...)\r\n        github.com/ledgerwatch/turbo-geth/node/node.go:414\r\ngithub.com/ledgerwatch/turbo-geth/turbo/node.(*TurboGethNode).Serve(0xc000240670, 0x0, 0x0)\r\n        github.com/ledgerwatch/turbo-geth/turbo/node/node.go:42 +0x85\r\nmain.runTurboGeth(0xc000146000)\r\n        github.com/ledgerwatch/turbo-geth/cmd/tg/main.go:47 +0x236\r\ngithub.com/urfave/cli.HandleAction(0x1297e60, 0x157cc20, 0xc000146000, 0xc000146000, 0x0)\r\n        github.com/urfave/cli@v1.22.4/app.go:528 +0x58\r\ngithub.com/urfave/cli.(*App).Run(0xc000196000, 0xc0000c8000, 0x9, 0x9, 0x0, 0x0)\r\n        github.com/urfave/cli@v1.22.4/app.go:288 +0x655\r\nmain.main()\r\n        github.com/ledgerwatch/turbo-geth/cmd/tg/main.go:24 +0x87\r\n\r\n\r\ngoroutine 36 [sync.Cond.Wait, 2155 minutes]:\r\nruntime.goparkunlock(...)\r\n        runtime/proc.go:312\r\nsync.runtime_notifyListWait(0xc000244f20, 0xc000000000)\r\n        runtime/sema.go:513 +0xf8\r\nsync.(*Cond).Wait(0xc000244f10)\r\n        sync/cond.go:56 +0x9d\r\ngithub.com/anacrolix/stm.(*Tx).wait(0xc000244ee0)\r\n        github.com/anacrolix/stm@v0.2.0/tx.go:45 +0x131\r\ngithub.com/anacrolix/stm.Atomically(0xc000070e70, 0xc000070e70, 0x21707c0)\r\n        github.com/anacrolix/stm@v0.2.0/funcs.go:51 +0x138\r\ngithub.com/anacrolix/stm/rate.(*Limiter).tokenGenerator(0xc0003e6680, 0x2625a00)\r\n        github.com/anacrolix/stm@v0.2.0/rate/ratelimit.go:59 +0x1d7\r\ncreated by github.com/anacrolix/stm/rate.NewLimiter\r\n        github.com/anacrolix/stm@v0.2.0/rate/ratelimit.go:45 +0x315\r\n\r\ngoroutine 8 [chan receive]:\r\ngithub.com/ledgerwatch/turbo-geth/metrics.(*meterArbiter).tick(0x216ed60)\r\n        github.com/ledgerwatch/turbo-geth/metrics/meter.go:292 +0x7d\r\ncreated by github.com/ledgerwatch/turbo-geth/metrics.NewMeterForced\r\n        github.com/ledgerwatch/turbo-geth/metrics/meter.go:71 +0x105\r\n\r\ngoroutine 9 [select]:\r\ngithub.com/ledgerwatch/turbo-geth/consensus/ethash.(*remoteSealer).loop(0xc0000f2000)\r\n        github.com/ledgerwatch/turbo-geth/consensus/ethash/sealer.go:279 +0x25c\r\ncreated by github.com/ledgerwatch/turbo-geth/consensus/ethash.startRemoteSealer\r\n        github.com/ledgerwatch/turbo-geth/consensus/ethash/sealer.go:263 +0x2b2\r\n\r\ngoroutine 53 [syscall]:\r\nos/signal.signal_recv(0x16cb320)\r\n        runtime/sigqueue.go:147 +0x9d\r\nos/signal.loop()\r\n        os/signal/signal_unix.go:23 +0x25\r\ncreated by os/signal.Notify.func1.1\r\n        os/signal/signal.go:150 +0x45\r\n\r\ngoroutine 40 [chan receive, 2155 minutes]:\r\ngithub.com/JekaMas/notify.(*nonrecursiveTree).dispatch(0xc00007c480, 0xc00007c2a0)\r\n        github.com/JekaMas/notify@v0.9.4/tree_nonrecursive.go:36 +0xb6\r\ncreated by github.com/JekaMas/notify.newNonrecursiveTree\r\n        github.com/JekaMas/notify@v0.9.4/tree_nonrecursive.go:29 +0xe5\r\n\r\ngoroutine 29 [select, 2155 minutes]:\r\ngithub.com/ledgerwatch/turbo-geth/accounts/keystore.(*watcher).loop(0xc00000fca0)\r\n        github.com/ledgerwatch/turbo-geth/accounts/keystore/watch.go:107 +0x485\r\ncreated by github.com/ledgerwatch/turbo-geth/accounts/keystore.(*watcher).start\r\n        github.com/ledgerwatch/turbo-geth/accounts/keystore/watch.go:56 +0x59\r\n\r\ngoroutine 30 [select]:\r\ngithub.com/ledgerwatch/turbo-geth/accounts/keystore.(*KeyStore).updater(0xc0001ea780)\r\n        github.com/ledgerwatch/turbo-geth/accounts/keystore/keystore.go:203 +0xda\r\ncreated by github.com/ledgerwatch/turbo-geth/accounts/keystore.(*KeyStore).Subscribe\r\n        github.com/ledgerwatch/turbo-geth/accounts/keystore/keystore.go:190 +0x12f\r\n\r\ngoroutine 31 [select, 2155 minutes]:\r\ngithub.com/ledgerwatch/turbo-geth/accounts.(*Manager).update(0xc0001ec410)\r\n        github.com/ledgerwatch/turbo-geth/accounts/manager.go:118 +0x1a6\r\ncreated by github.com/ledgerwatch/turbo-geth/accounts.NewManager\r\n        github.com/ledgerwatch/turbo-geth/accounts/manager.go:79 +0x4e5\r\n\r\ngoroutine 41 [chan receive, 2155 minutes]:\r\ngithub.com/JekaMas/notify.(*nonrecursiveTree).internal(0xc00007c480, 0xc00007c3c0)\r\n        github.com/JekaMas/notify@v0.9.4/tree_nonrecursive.go:81 +0x58\r\ncreated by github.com/JekaMas/notify.newNonrecursiveTree\r\n        github.com/JekaMas/notify@v0.9.4/tree_nonrecursive.go:30 +0x111\r\n\r\ngoroutine 42 [syscall, 2155 minutes]:\r\nsyscall.Syscall6(0xe8, 0x8, 0xc0002b5f9c, 0x1, 0xffffffffffffffff, 0x0, 0x0, 0x0, 0x0, 0x0)\r\n        syscall/asm_linux_amd64.s:41 +0x5\r\ngolang.org/x/sys/unix.EpollWait(0x8, 0xc0002b5f9c, 0x1, 0x1, 0xffffffffffffffff, 0x0, 0x0, 0x0)\r\n        golang.org/x/sys@v0.0.0-20200909081042-eff7692f9009/unix/zsyscall_linux_amd64.go:76 +0x72\r\ngithub.com/JekaMas/notify.(*inotify).loop(0xc00069c000, 0xc0002ae000)\r\n        github.com/JekaMas/notify@v0.9.4/watcher_inotify.go:194 +0x79\r\ncreated by github.com/JekaMas/notify.(*inotify).lazyinit\r\n        github.com/JekaMas/notify@v0.9.4/watcher_inotify.go:134 +0x145\r\n\r\ngoroutine 43 [chan receive, 2155 minutes]:\r\ngithub.com/JekaMas/notify.(*inotify).send(0xc00069c000, 0xc0002ae000)\r\n        github.com/JekaMas/notify@v0.9.4/watcher_inotify.go:254 +0xab\r\ncreated by github.com/JekaMas/notify.(*inotify).lazyinit\r\n        github.com/JekaMas/notify@v0.9.4/watcher_inotify.go:137 +0x19a\r\n\r\ngoroutine 44 [chan receive, 2155 minutes]:\r\ngithub.com/JekaMas/notify.(*inotify).send(0xc00069c000, 0xc0002ae000)\r\n        github.com/JekaMas/notify@v0.9.4/watcher_inotify.go:254 +0xab\r\ncreated by github.com/JekaMas/notify.(*inotify).lazyinit\r\n        github.com/JekaMas/notify@v0.9.4/watcher_inotify.go:137 +0x19a\r\n\r\ngoroutine 77 [select]:\r\ngithub.com/ledgerwatch/turbo-geth/eth/filters.(*PublicFilterAPI).timeoutLoop(0xc0002df270)\r\n        github.com/ledgerwatch/turbo-geth/eth/filters/api.go:84 +0x1db\r\ncreated by github.com/ledgerwatch/turbo-geth/eth/filters.NewPublicFilterAPI\r\n        github.com/ledgerwatch/turbo-geth/eth/filters/api.go:73 +0x131\r\n\r\ngoroutine 90 [chan receive]:\r\ngithub.com/ledgerwatch/turbo-geth/cmd/utils.StartNode.func1(0xc00038ed20)\r\n        github.com/ledgerwatch/turbo-geth/cmd/utils/cmd.go:84 +0x199\r\ncreated by github.com/ledgerwatch/turbo-geth/cmd/utils.StartNode\r\n        github.com/ledgerwatch/turbo-geth/cmd/utils/cmd.go:76 +0xad\r\n\r\ngoroutine 1513027 [syscall]:\r\ngithub.com/ledgerwatch/turbo-geth/ethdb/mdbx._Cfunc_mdbx_env_close(0x281b590, 0x0)\r\n        _cgo_gotypes.go:555 +0x49\r\ngithub.com/ledgerwatch/turbo-geth/ethdb/mdbx.(*Env).close.func1(0xc0001b33e0, 0xc000723e10)\r\n        github.com/ledgerwatch/turbo-geth/ethdb/mdbx/env.go:205 +0x55\r\ngithub.com/ledgerwatch/turbo-geth/ethdb/mdbx.(*Env).close(0xc0001b33e0, 0x4)\r\n        github.com/ledgerwatch/turbo-geth/ethdb/mdbx/env.go:205 +0x53\r\ngithub.com/ledgerwatch/turbo-geth/ethdb/mdbx.(*Env).Close(0xc0001b33e0, 0x217d160, 0x217d170)\r\n        github.com/ledgerwatch/turbo-geth/ethdb/mdbx/env.go:221 +0x2f\r\ngithub.com/ledgerwatch/turbo-geth/ethdb.(*MdbxKV).Close(0xc0004a4ae0)\r\n        github.com/ledgerwatch/turbo-geth/ethdb/kv_mdbx.go:239 +0x5c\r\ngithub.com/ledgerwatch/turbo-geth/ethdb.(*ObjectDatabase).Close(0xc0001b34a0)\r\n        github.com/ledgerwatch/turbo-geth/ethdb/object_db.go:288 +0x33\r\ngithub.com/ledgerwatch/turbo-geth/node.(*Node).doClose(0xc00038ed20, 0x0, 0x0, 0x0, 0x0, 0x0)\r\n        github.com/ledgerwatch/turbo-geth/node/node.go:227 +0xa8\r\ngithub.com/ledgerwatch/turbo-geth/node.(*Node).Close(0xc00038ed20, 0x0, 0x0)\r\n        github.com/ledgerwatch/turbo-geth/node/node.go:212 +0x17a\r\ncreated by github.com/ledgerwatch/turbo-geth/cmd/utils.StartNode.func1\r\n        github.com/ledgerwatch/turbo-geth/cmd/utils/cmd.go:82 +0x16a\r\n\r\nrax    0xca\r\nrbx    0x21723e0\r\nrcx    0x4a6783\r\nrdx    0x0\r\nrdi    0x2172528\r\nrsi    0x80\r\nrbp    0x7ffeefd61a78\r\nrsp    0x7ffeefd61a30\r\nr8     0x0\r\nr9     0x0\r\nr10    0x0\r\nr11    0x286\r\nr12    0xffffffffffffffff\r\nr13    0x21\r\nr14    0x20\r\nr15    0x66\r\nrip    0x4a6781\r\nrflags 0x286\r\ncs     0x33\r\nfs     0x0\r\ngs     0x0\r\n````\r\n",
  "closed_by": {
    "login": "AlexeyAkhunov",
    "id": 13686139,
    "node_id": "MDQ6VXNlcjEzNjg2MTM5",
    "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AlexeyAkhunov",
    "html_url": "https://github.com/AlexeyAkhunov",
    "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
    "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
    "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
    "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
    "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1312/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1312/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/720234935",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1312#issuecomment-720234935",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1312",
    "id": 720234935,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyMDIzNDkzNQ==",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-02T04:54:36Z",
    "updated_at": "2020-11-02T04:54:36Z",
    "author_association": "COLLABORATOR",
    "body": "Can reproduce on mac:\r\n1. After cancelation I see \"Looking for peers\" - means `srv.setupDialScheduler` doesn't stop also: fixing it by https://github.com/ledgerwatch/turbo-geth/pull/1334\r\n2. trying more...",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/720234935/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
