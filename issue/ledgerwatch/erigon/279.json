{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/279",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/279/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/279/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/279/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/279",
  "id": 539806050,
  "node_id": "MDU6SXNzdWU1Mzk4MDYwNTA=",
  "number": 279,
  "title": "Mine only on canonical chain",
  "user": {
    "login": "JekaMas",
    "id": 3192700,
    "node_id": "MDQ6VXNlcjMxOTI3MDA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3192700?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/JekaMas",
    "html_url": "https://github.com/JekaMas",
    "followers_url": "https://api.github.com/users/JekaMas/followers",
    "following_url": "https://api.github.com/users/JekaMas/following{/other_user}",
    "gists_url": "https://api.github.com/users/JekaMas/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/JekaMas/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/JekaMas/subscriptions",
    "organizations_url": "https://api.github.com/users/JekaMas/orgs",
    "repos_url": "https://api.github.com/users/JekaMas/repos",
    "events_url": "https://api.github.com/users/JekaMas/events{/privacy}",
    "received_events_url": "https://api.github.com/users/JekaMas/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "JekaMas",
    "id": 3192700,
    "node_id": "MDQ6VXNlcjMxOTI3MDA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3192700?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/JekaMas",
    "html_url": "https://github.com/JekaMas",
    "followers_url": "https://api.github.com/users/JekaMas/followers",
    "following_url": "https://api.github.com/users/JekaMas/following{/other_user}",
    "gists_url": "https://api.github.com/users/JekaMas/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/JekaMas/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/JekaMas/subscriptions",
    "organizations_url": "https://api.github.com/users/JekaMas/orgs",
    "repos_url": "https://api.github.com/users/JekaMas/repos",
    "events_url": "https://api.github.com/users/JekaMas/events{/privacy}",
    "received_events_url": "https://api.github.com/users/JekaMas/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "JekaMas",
      "id": 3192700,
      "node_id": "MDQ6VXNlcjMxOTI3MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3192700?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JekaMas",
      "html_url": "https://github.com/JekaMas",
      "followers_url": "https://api.github.com/users/JekaMas/followers",
      "following_url": "https://api.github.com/users/JekaMas/following{/other_user}",
      "gists_url": "https://api.github.com/users/JekaMas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JekaMas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JekaMas/subscriptions",
      "organizations_url": "https://api.github.com/users/JekaMas/orgs",
      "repos_url": "https://api.github.com/users/JekaMas/repos",
      "events_url": "https://api.github.com/users/JekaMas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JekaMas/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2019-12-18T17:02:15Z",
  "updated_at": "2020-02-03T12:02:27Z",
  "closed_at": "2020-02-03T12:02:27Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "0. mine only on canonical chain.\r\n1. cancel jobs if we got new canonical block\r\n2. check and fix `ERROR[12-18|19:15:14.312] Failed to close database                 database=in-memory err=\"unmap error: invalid argument\"`\r\n\r\n3.\r\n```\r\nINFO [12-18|19:11:31.101] Loaded most recent local full block      number=0            hash=e7fdd2…f118d2 td=131072 age=50y8mo1w\r\nINFO [12-18|19:11:31.101] Loaded most recent local fast block      number=0            hash=e7fdd2…f118d2 td=131072 age=50y8mo1w\r\nunexpected fault address 0xc000b00000\r\nfatal error: fault\r\n[signal SIGSEGV: segmentation violation code=0x2 addr=0xc000b00000 pc=0xc000b00000]\r\n\r\ngoroutine 5059 [running]:\r\nruntime.throw(0x11d7802, 0x5)\r\n        /snap/go/current/src/runtime/panic.go:774 +0x72 fp=0xc000244168 sp=0xc000244138 pc=0x4452e2\r\nruntime.sigpanic()\r\n        /snap/go/current/src/runtime/signal_unix.go:401 +0x3de fp=0xc000244198 sp=0xc000244168 pc=0x45abde\r\ngithub.com/ledgerwatch/turbo-geth/trie.(*Trie).hashRoot(0xc000982240, 0x0, 0x0, 0x0, 0x0)\r\n        /mnt/sdb/go/src/github.com/ledgerwatch/turbo-geth/trie/trie.go:1284 +0x5d fp=0xc000244248 sp=0xc000244198 pc=0x9c27ad\r\ngithub.com/ledgerwatch/turbo-geth/trie.(*Trie).Hash(0xc000982240, 0x0, 0x0, 0x0, 0x0)\r\n        /mnt/sdb/go/src/github.com/ledgerwatch/turbo-geth/trie/trie.go:1107 +0x3c fp=0xc0002442a0 sp=0xc000244248 pc=0x9c0f1c\r\ngithub.com/ledgerwatch/turbo-geth/core/state.(*TrieDbState).LastRoot(0xc00044c180, 0x0, 0x0, 0x0, 0x0)\r\n        /mnt/sdb/go/src/github.com/ledgerwatch/turbo-geth/core/state/database.go:348 +0x8c fp=0xc000244310 sp=0xc0002442a0 pc=0xa1bc0c\r\ngithub.com/ledgerwatch/turbo-geth/core/state.GetTrieDbState(0x2c3d3eca3748cee2, 0x47cd9e0d5801f681, 0xfea4f39b2c9d0428, 0xfd1b00eaa1f14b53, 0x14b2260, 0xc000969140, 0x0, 0x1, 0xc000244428, 0xc2f6d3)\r\n        /mnt/sdb/go/src/github.com/ledgerwatch/turbo-geth/core/state/database.go:250 +0x11e fp=0xc0002443b8 sp=0xc000244310 pc=0xa1ae2e\r\ngithub.com/ledgerwatch/turbo-geth/miner.GetState(0xc0009dc000, 0xc0005286c0, 0xc0009dc000, 0xc0002d8d80, 0x0, 0x0)\r\n        /mnt/sdb/go/src/github.com/ledgerwatch/turbo-geth/miner/worker.go:1055 +0x2e8 fp=0xc0002444a0 sp=0xc0002443b8 pc=0xcfb488\r\nmain.(*RetestethAPI).mineBlock(0xc0001fc280, 0xc00007a868, 0x4b265c)\r\n        /mnt/sdb/go/src/github.com/ledgerwatch/turbo-geth/cmd/geth/retesteth.go:488 +0x2fb fp=0xc00024b7b0 sp=0xc0002444a0 pc=0xeb2f4b\r\nmain.(*RetestethAPI).MineBlocks(0xc0001fc280, 0x149c180, 0xc000a44a80, 0x1, 0x0, 0x0, 0x0)\r\n        /mnt/sdb/go/src/github.com/ledgerwatch/turbo-geth/cmd/geth/retesteth.go:445 +0x4e fp=0xc00024b828 sp=0xc00024b7b0 pc=0xeb2b7e\r\nruntime.call64(0xc0002687b0, 0xc0000d4650, 0xc000a44ac0, 0x2000000038)\r\n        /snap/go/current/src/runtime/asm_amd64.s:540 +0x3b fp=0xc00024b878 sp=0xc00024b828 pc=0x47360b\r\nreflect.Value.call(0xc0001e0480, 0xc0000d4650, 0x13, 0x11d656a, 0x4, 0xc000ab4460, 0x3, 0x3, 0xc00007ab08, 0x45bcbc, ...)\r\n        /snap/go/current/src/reflect/value.go:460 +0x5f6 fp=0xc00024ba98 sp=0xc00024b878 pc=0x4a8de6\r\nreflect.Value.Call(0xc0001e0480, 0xc0000d4650, 0x13, 0xc000ab4460, 0x3, 0x3, 0x1, 0x1, 0x1)\r\n        /snap/go/current/src/reflect/value.go:321 +0xb4 fp=0xc00024bb18 sp=0xc00024ba98 pc=0x4a85a4\r\ngithub.com/ledgerwatch/turbo-geth/rpc.(*callback).call(0xc000094ea0, 0x149c180, 0xc000a44a80, 0xc000a20610, 0xf, 0xc000a00f20, 0x1, 0x1, 0x0, 0x0, ...)\r\n        /mnt/sdb/go/src/github.com/ledgerwatch/turbo-geth/rpc/service.go:206 +0x2b9 fp=0xc00024bc40 sp=0xc00024bb18 pc=0xa5cb19\r\ngithub.com/ledgerwatch/turbo-geth/rpc.(*handler).runMethod(0xc0005285a0, 0x149c180, 0xc000a44a80, 0xc0001f83f0, 0xc000094ea0, 0xc000a00f20, 0x1, 0x1, 0x1)\r\n        /mnt/sdb/go/src/github.com/ledgerwatch/turbo-geth/rpc/handler.go:380 +0x8a fp=0xc00024bcb0 sp=0xc00024bc40 pc=0xa55d4a\r\ngithub.com/ledgerwatch/turbo-geth/rpc.(*handler).handleCall(0xc0005285a0, 0xc000982ba0, 0xc0001f83f0, 0xc000a26630)\r\n        /mnt/sdb/go/src/github.com/ledgerwatch/turbo-geth/rpc/handler.go:331 +0x264 fp=0xc00024bdf0 sp=0xc00024bcb0 pc=0xa54ff4\r\ngithub.com/ledgerwatch/turbo-geth/rpc.(*handler).handleCallMsg(0xc0005285a0, 0xc000982ba0, 0xc0001f83f0, 0x1487a01)\r\n        /mnt/sdb/go/src/github.com/ledgerwatch/turbo-geth/rpc/handler.go:298 +0x1f3 fp=0xc00024bea0 sp=0xc00024bdf0 pc=0xa54793\r\ngithub.com/ledgerwatch/turbo-geth/rpc.(*handler).handleMsg.func1(0xc000982ba0)\r\n        /mnt/sdb/go/src/github.com/ledgerwatch/turbo-geth/rpc/handler.go:139 +0x46 fp=0xc00024bf10 sp=0xc00024bea0 pc=0xa61546\r\ngithub.com/ledgerwatch/turbo-geth/rpc.(*handler).startCallProc.func1(0xc0005285a0, 0xc000a00ee0)\r\n        /mnt/sdb/go/src/github.com/ledgerwatch/turbo-geth/rpc/handler.go:226 +0x119 fp=0xc00024bfd0 sp=0xc00024bf10 pc=0xa61749\r\nruntime.goexit()\r\n        /snap/go/current/src/runtime/asm_amd64.s:1357 +0x1 fp=0xc00024bfd8 sp=0xc00024bfd0 pc=0x4752a1\r\ncreated by github.com/ledgerwatch/turbo-geth/rpc.(*handler).startCallProc\r\n        /mnt/sdb/go/src/github.com/ledgerwatch/turbo-geth/rpc/handler.go:222 +0x66\r\n\r\ngoroutine 1 [chan receive]:\r\nmain.retesteth(0xc00030a580, 0x0, 0x0)\r\n        /mnt/sdb/go/src/github.com/ledgerwatch/turbo-geth/cmd/geth/retesteth.go:956 +0x711\r\ngithub.com/ledgerwatch/turbo-geth/cmd/utils.MigrateFlags.func1(0xc00030a580, 0x0, 0xc00067bab0)\r\n        /mnt/sdb/go/src/github.com/ledgerwatch/turbo-geth/cmd/utils/flags.go:1764 +0xbe\r\ngithub.com/urfave/cli.HandleAction(0x100d840, 0xc000404ed0, 0xc00030a580, 0xc00030a580, 0x0)\r\n        /mnt/sdb/go/pkg/mod/github.com/urfave/cli@v1.22.1/app.go:523 +0xbe\r\ngithub.com/urfave/cli.Command.Run(0x11dced0, 0x9, 0x0, 0x0, 0x0, 0x0, 0x0, 0x11f6613, 0x1f, 0x0, ...)\r\n        /mnt/sdb/go/pkg/mod/github.com/urfave/cli@v1.22.1/command.go:174 +0x51c\r\ngithub.com/urfave/cli.(*App).Run(0xc0002e0a80, 0xc0000d8000, 0x4, 0x4, 0x0, 0x0)\r\n        /mnt/sdb/go/pkg/mod/github.com/urfave/cli@v1.22.1/app.go:276 +0x718\r\nmain.main()\r\n        /mnt/sdb/go/src/github.com/ledgerwatch/turbo-geth/cmd/geth/main.go:242 +0x55\r\n\r\ngoroutine 34 [syscall]:\r\nos/signal.signal_recv(0x0)\r\n        /snap/go/current/src/runtime/sigqueue.go:147 +0x9c\r\nos/signal.loop()\r\n        /snap/go/current/src/os/signal/signal_unix.go:23 +0x22\r\ncreated by os/signal.init.0\r\n        /snap/go/current/src/os/signal/signal_unix.go:29 +0x41\r\n```\r\n\r\n4.\r\n```\r\nINFO [12-18|19:15:14.312] Writing custom genesis block \r\nChain config: {ChainID: 1 Homestead: 0 DAO: <nil> DAOSupport: false EIP150: 0 EIP155: 0 EIP158: 0 EIP2027: <nil> Byzantium: 0 Constantinople: 0 Petersburg: 0 Istanbul: 0, Muir Glacier: <nil>, Engine: unknown}\r\nINFO [12-18|19:15:14.313] Loaded most recent local header          number=0            hash=b3b489…59f05e td=131072 age=50y8mo1w\r\nINFO [12-18|19:15:14.313] Loaded most recent local full block      number=0            hash=b3b489…59f05e td=131072 age=50y8mo1w\r\nINFO [12-18|19:15:14.313] Loaded most recent local fast block      number=0            hash=b3b489…59f05e td=131072 age=50y8mo1w\r\nINFO [12-18|19:15:14.316] Inserting chain                          start=1 end=1\r\nINFO [12-18|19:15:14.316] Creating IntraBlockState from latest state block=0\r\nINFO [12-18|19:15:14.316] Rebuilt top of account trie and verified root hash=\"<99391e8659d32504f21978db10106effc07f45fc3d34b3b4a27428db30f87670> \"\r\nINFO [12-18|19:15:14.316] Memory after rebuild                     nodes=7 alloc=6958  sys=70848 numGC=15\r\nINFO [12-18|19:15:14.316] Creation complete. \r\nINFO [12-18|19:15:14.316] Creation complete. \r\nWARN [12-18|19:15:14.317] Generating deep snapshot of the wront tries... file=root_1.txt\r\nERROR[12-18|19:15:14.317] \r\n########## BAD BLOCK #########\r\nChain config: {ChainID: 1 Homestead: 0 DAO: <nil> DAOSupport: false EIP150: 0 EIP155: 0 EIP158: 0 EIP2027: <nil> Byzantium: 0 Constantinople: 0 Petersburg: 0 Istanbul: 0, Muir Glacier: <nil>, Engine: unknown}\r\n\r\nNumber: 1\r\nHash: 0x444e5d1a4ff335fb4e7068689ab6d457d6759ea4b7f15b4684c515befc494bb1\r\n         0: cumulative: 150000 gas: 150000 contract: 0x0000000000000000000000000000000000000000 status: 0 tx: 0x3b495969d7885f97a078cb393abdf374a441dd6e530acd5199a8b285080e02b9 logs: [] bloom: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 state: \r\n\r\n\r\nError: invalid merkle root (remote: c7209b8316b033b201d499cfb736520d6bcc282f4d56a4c05a71fe62e71e33dd local: 289cecf32549f961550865c579cc5314a0b65d2e2a2f9f8b3b9a0744a7b33643)\r\nCallers: [github.com/ledgerwatch/turbo-geth/core.(*BlockChain).reportBlock github.com/ledgerwatch/turbo-geth/core.(*BlockChain).insertChain github.com/ledgerwatch/turbo-geth/core.(*BlockChain).InsertChain main.(*RetestethAPI).importBlock main.(*RetestethAPI).mineBlock main.(*RetestethAPI).MineBlocks reflect.Value.call reflect.Value.Call github.com/ledgerwatch/turbo-geth/rpc.(*callback).call github.com/ledgerwatch/turbo-geth/rpc.(*handler).runMethod github.com/ledgerwatch/turbo-geth/rpc.(*handler).handleCall github.com/ledgerwatch/turbo-geth/rpc.(*handler).handleCallMsg github.com/ledgerwatch/turbo-geth/rpc.(*handler).handleMsg.func1 github.com/ledgerwatch/turbo-geth/rpc.(*handler).startCallProc.func1 runtime.goexit]\r\n##############################\r\n```",
  "closed_by": {
    "login": "JekaMas",
    "id": 3192700,
    "node_id": "MDQ6VXNlcjMxOTI3MDA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3192700?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/JekaMas",
    "html_url": "https://github.com/JekaMas",
    "followers_url": "https://api.github.com/users/JekaMas/followers",
    "following_url": "https://api.github.com/users/JekaMas/following{/other_user}",
    "gists_url": "https://api.github.com/users/JekaMas/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/JekaMas/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/JekaMas/subscriptions",
    "organizations_url": "https://api.github.com/users/JekaMas/orgs",
    "repos_url": "https://api.github.com/users/JekaMas/repos",
    "events_url": "https://api.github.com/users/JekaMas/events{/privacy}",
    "received_events_url": "https://api.github.com/users/JekaMas/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/279/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/279/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[

]
