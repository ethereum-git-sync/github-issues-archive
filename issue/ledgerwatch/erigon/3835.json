{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3835",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3835/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3835/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3835/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/3835",
  "id": 1194304673,
  "node_id": "I_kwDOC0FsAM5HL6Sh",
  "number": 3835,
  "title": "Sync speed is very slow on Mainnet archive node",
  "user": {
    "login": "air3ijai",
    "id": 88528265,
    "node_id": "MDQ6VXNlcjg4NTI4MjY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/88528265?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/air3ijai",
    "html_url": "https://github.com/air3ijai",
    "followers_url": "https://api.github.com/users/air3ijai/followers",
    "following_url": "https://api.github.com/users/air3ijai/following{/other_user}",
    "gists_url": "https://api.github.com/users/air3ijai/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/air3ijai/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/air3ijai/subscriptions",
    "organizations_url": "https://api.github.com/users/air3ijai/orgs",
    "repos_url": "https://api.github.com/users/air3ijai/repos",
    "events_url": "https://api.github.com/users/air3ijai/events{/privacy}",
    "received_events_url": "https://api.github.com/users/air3ijai/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 9,
  "created_at": "2022-04-06T09:06:02Z",
  "updated_at": "2022-12-26T14:39:41Z",
  "closed_at": "2022-04-06T10:43:26Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "As Discord invite is invalid, let's continue here\r\n\r\n1. [Issue](#issue)\r\n2. [Hardware on AWS](#hardware-on-aws)\r\n3. [Docker compose](#docker-compose)\r\n4. [Questions](#questions)\r\n5. [Node metrics from AWS](#node-metrics-from-aws)\r\n\r\n\r\n### Issue\r\nWe started two new Erigon nodes ~ 11 days ago and they are still sync and sync slowed down in time:\r\n```\r\n# 1/16\r\n[INFO] [03-25|10:52:17.519] [1/16 Headers] Wrote block headers       number=1536 blk/second=51.200 alloc=\"271.71 MiB\" sys=\"326.47 MiB\"\r\n...\r\n[INFO] [03-25|11:11:37.435] [1/16 Headers] DONE                      in=19m49.917398973s\r\n\r\n# 2/16\r\n[INFO] [03-25|11:12:07.438] [2/16 BlockHashes] ETL [1/2] Extracting  from=Header current key=0000000000ae88b1912c0676286d159a9938fc232f557e810a7b6c3e5652644309fc66cc5023e55e alloc=\"1.7 GiB\" sys=\"6.0 GiB\"\r\n...\r\n[INFO] [03-25|11:14:47.511] [2/16 BlockHashes] DONE                  in=3m10.075559756s\r\n\r\n# 3/16\r\n[INFO] [03-25|11:14:47.514] [3/16 Bodies] Processing bodies...       from=0 to=14455041\r\n[INFO] [03-25|11:15:19.600] [3/16 Bodies] Wrote block bodies         block_num=2907 delivery/sec=\"53.28 KiB\" wasted/sec=\"0.00 B\" alloc=\"943.50 MiB\" sys=\"6.00 GiB\"\r\n...\r\n[INFO] [03-25|19:49:43.440] [3/16 Bodies] DONE                       in=8h34m55.929198533s\r\n\r\n# 4/16\r\n[INFO] [03-25|19:49:43.442] [4/16 Senders] Started                   from=0 to=14455041\r\n[INFO] [03-25|19:49:47.432] [p2p] GoodPeers                          eth66=100\r\n[INFO] [03-25|19:50:13.446] [4/16 Senders] Preload headers           block_number=2397516\r\n...\r\n[INFO] [03-26|22:45:43.378] [4/16 Senders] DONE                      in=26h55m59.936783585s\r\n\r\n# 5/16\r\n[INFO] [03-26|22:45:43.380] [5/16 Execution] Blocks execution        from=0 to=14455041\r\n[INFO] [03-26|22:45:47.432] [p2p] GoodPeers                          eth66=100\r\n[INFO] [03-26|22:46:13.385] [5/16 Execution] Executed blocks         number=176189 blk/s=5872.645 tx/s=3111.296 Mgas/s=91.955 batch=\"1.43 MiB\" alloc=\"1.94 GiB\" sys=\"9.79 GiB\"\r\n...\r\n# 27.03 -  2,253,700 (since yesterday)\r\n[INFO] [03-26|23:59:47.432] [p2p] GoodPeers                          eth66=100\r\n[INFO] [03-27|00:00:13.483] [5/16 Execution] Executed blocks         number=2429889 blk/s=33.348 tx/s=156.522 Mgas/s=7.996 batch=\"492.86 MiB\" alloc=\"4.80 GiB\" sys=\"9.79 GiB\"\r\n...\r\n# 28.03 - 4,094,643 (since yesterday)\r\n[INFO] [03-27|23:59:47.432] [p2p] GoodPeers                          eth66=100\r\n[INFO] [03-28|00:00:13.427] [5/16 Execution] Executed blocks         number=6524532 blk/s=32.773 tx/s=3328.258 Mgas/s=184.268 batch=\"170.48 MiB\" alloc=\"2.50 GiB\" sys=\"9.80 GiB\"\r\n...\r\n# 29.03 - 1,624,496 (since yesterday)\r\n[INFO] [03-28|23:59:47.433] [p2p] GoodPeers                          eth66=100\r\n[INFO] [03-29|00:00:13.425] [5/16 Execution] Executed blocks         number=8149028 blk/s=20.227 tx/s=2247.513 Mgas/s=139.898 batch=\"166.64 MiB\" alloc=\"2.19 GiB\" sys=\"9.81 GiB\"\r\n...\r\n# 30.03 - 1,371,614 (since yesterday)\r\n[INFO] [03-29|23:59:47.432] [p2p] GoodPeers                          eth66=100\r\n[INFO] [03-30|00:00:13.473] [5/16 Execution] Executed blocks         number=9520642 blk/s=9.254 tx/s=1099.040 Mgas/s=76.640 batch=\"6.87 MiB\" alloc=\"1.23 GiB\" sys=\"9.81 GiB\"\r\n...\r\n# 31.03 - 913,223 (since yesterday)\r\n[INFO] [03-31|00:01:47.432] [p2p] GoodPeers                          eth66=100\r\n[INFO] [03-31|00:02:12.461] Write to db                              progress=7.6M/7.8M current table=PlainState\r\n[INFO] [03-31|00:02:42.461] Write to db                              progress=7.7M/7.8M current table=PlainState\r\n[INFO] [03-31|00:03:04.099] [5/16 Execution] Executed blocks         number=10433865 blk/s=0.212 tx/s=25.495 Mgas/s=2.320 batch=\"0.00 B\" alloc=\"2.32 GiB\" sys=\"9.82 GiB\"\r\n[INFO] [03-31|00:03:13.650] [5/16 Execution] Executed blocks         number=10433883 blk/s=1.885 tx/s=257.064 Mgas/s=21.732 batch=\"541.70 KiB\" alloc=\"2.42 GiB\" sys=\"9.82 GiB\"\r\n[INFO] [03-31|00:03:43.410] [5/16 Execution] Executed blocks         number=10433995 blk/s=3.763 tx/s=434.037 Mgas/s=41.501 batch=\"3.09 MiB\" alloc=\"2.90 GiB\" sys=\"9.82 GiB\"\r\n[INFO] [03-31|00:03:47.432] [p2p] GoodPeers                          eth66=100\r\n[INFO] [03-31|00:04:13.404] [5/16 Execution] Executed blocks         number=10434159 blk/s=5.468 tx/s=679.506 Mgas/s=59.701 batch=\"6.28 MiB\" alloc=\"3.53 GiB\" sys=\"9.82 GiB\"\r\n[INFO] [03-31|00:04:43.536] [5/16 Execution] Executed blocks         number=10434331 blk/s=5.708 tx/s=643.520 Mgas/s=64.718 batch=\"9.68 MiB\" alloc=\"1.05 GiB\" sys=\"9.82 GiB\"\r\n[INFO] [03-31|00:05:13.505] [5/16 Execution] Executed blocks         number=10434504 blk/s=5.773 tx/s=678.050 Mgas/s=65.948 batch=\"12.98 MiB\" alloc=\"1.69 GiB\" sys=\"9.82 GiB\"\r\n[INFO] [03-31|00:05:43.496] [5/16 Execution] Executed blocks         number=10434673 blk/s=5.635 tx/s=607.501 Mgas/s=64.543 batch=\"16.67 MiB\" alloc=\"1.37 GiB\" sys=\"9.82 GiB\"...\r\n...\r\n# 01.04 - 672,242 (since yesterday)\r\n[INFO] [03-31|23:59:47.432] [p2p] GoodPeers                          eth66=100\r\n[INFO] [04-01|00:00:13.508] [5/16 Execution] Executed blocks         number=11106107 blk/s=6.349 tx/s=1295.338 Mgas/s=78.294 batch=\"12.70 MiB\" alloc=\"1.98 GiB\" sys=\"9.82 GiB\"\r\n...\r\n# 02.04 - 604,874 (since yesterday)\r\n[INFO] [04-01|23:59:47.432] [p2p] GoodPeers                          eth66=100\r\n[INFO] [04-02|00:00:13.401] [5/16 Execution] Executed blocks         number=11710981 blk/s=8.289 tx/s=1656.788 Mgas/s=102.216 batch=\"223.47 MiB\" alloc=\"2.18 GiB\" sys=\"9.83 GiB\"\r\n...\r\n# 03.04 - 564,016 (since yesterday)\r\n[INFO] [04-02|23:59:47.433] [p2p] GoodPeers                          eth66=100\r\n[INFO] [04-03|00:00:13.489] [5/16 Execution] Executed blocks         number=12274997 blk/s=8.114 tx/s=1844.124 Mgas/s=100.615 batch=\"196.96 MiB\" alloc=\"2.75 GiB\" sys=\"9.83 GiB\"\r\n...\r\n# 04.04 - 409,485 (since yesterday)\r\n[INFO] [04-03|23:59:47.432] [p2p] GoodPeers                          eth66=99\r\n[INFO] [04-04|00:00:13.458] [5/16 Execution] Executed blocks         number=12684482 blk/s=5.185 tx/s=1031.404 Mgas/s=76.507 batch=\"36.25 MiB\" alloc=\"2.02 GiB\" sys=\"9.84 GiB\"\r\n...\r\n# 05.04 - 427,402 (since yesterday)\r\n[INFO] [04-05|00:13:47.432] [p2p] GoodPeers                          eth66=100\r\n[INFO] [04-05|00:14:14.482] Write to db                              progress=7.6M/7.6M current table=PlainState\r\n[INFO] [04-05|00:14:25.599] [5/16 Execution] Executed blocks         number=13111884 blk/s=0.004 tx/s=0.802 Mgas/s=0.095 batch=\"0.00 B\" alloc=\"1.05 GiB\" sys=\"9.84 GiB\"\r\n[INFO] [04-05|00:14:43.588] [5/16 Execution] Executed blocks         number=13111913 blk/s=1.612 tx/s=296.346 Mgas/s=26.941 batch=\"1.12 MiB\" alloc=\"1.33 GiB\" sys=\"9.84 GiB\"\r\n[INFO] [04-05|00:15:13.676] [5/16 Execution] Executed blocks         number=13111999 blk/s=2.858 tx/s=467.026 Mgas/s=43.344 batch=\"3.75 MiB\" alloc=\"1.08 GiB\" sys=\"9.84 GiB\"\r\n[INFO] [04-05|00:15:43.536] [5/16 Execution] Executed blocks         number=13112105 blk/s=3.550 tx/s=597.050 Mgas/s=54.389 batch=\"6.65 MiB\" alloc=\"1.89 GiB\" sys=\"9.84 GiB\"\r\n...\r\n# 06.04 - 397,289 (since yesterday)\r\n[INFO] [04-06|00:01:47.432] [p2p] GoodPeers                          eth66=100\r\n[INFO] [04-06|00:01:49.591] Write to db                              progress=7.8M/7.8M current table=PlainState\r\n[INFO] [04-06|00:01:55.854] [5/16 Execution] Executed blocks         number=13509173 blk/s=0.017 tx/s=4.190 Mgas/s=0.277 batch=\"0.00 B\" alloc=\"2.87 GiB\" sys=\"9.84 GiB\"\r\n[INFO] [04-06|00:02:13.558] [5/16 Execution] Executed blocks         number=13509200 blk/s=1.525 tx/s=304.290 Mgas/s=21.230 batch=\"1008.08 KiB\" alloc=\"1.27 GiB\" sys=\"9.84 GiB\"\r\n[INFO] [04-06|00:02:43.551] [5/16 Execution] Executed blocks         number=13509279 blk/s=2.634 tx/s=601.742 Mgas/s=40.480 batch=\"3.06 MiB\" alloc=\"1.85 GiB\" sys=\"9.84 GiB\"\r\n[INFO] [04-06|00:03:13.389] [5/16 Execution] Executed blocks         number=13509375 blk/s=3.217 tx/s=726.244 Mgas/s=50.032 batch=\"5.36 MiB\" alloc=\"1.54 GiB\" sys=\"9.84 GiB\"\r\n[INFO] [04-06|00:03:43.648] [5/16 Execution] Executed blocks         number=13509486 blk/s=3.668 tx/s=814.901 Mgas/s=56.013 batch=\"7.90 MiB\" alloc=\"1.29 GiB\" sys=\"9.84 GiB\"\r\n...\r\n# 07.04 - 373,372 (since yesterday)\r\n[INFO] [04-07|00:03:47.432] [p2p] GoodPeers                          eth66=100\r\n[INFO] [04-07|00:03:56.705] Write to db                              progress=7.7M/7.7M current table=PlainState\r\n[INFO] [04-07|00:04:15.042] [5/16 Execution] Executed blocks         number=13882545 blk/s=0.042 tx/s=8.019 Mgas/s=0.639 batch=\"0.00 B\" alloc=\"2.30 GiB\" sys=\"9.84 GiB\"\r\n[INFO] [04-07|00:04:43.601] [5/16 Execution] Executed blocks         number=13882585 blk/s=1.401 tx/s=287.343 Mgas/s=23.354 batch=\"1.53 MiB\" alloc=\"2.68 GiB\" sys=\"9.84 GiB\"\r\n[INFO] [04-07|00:05:13.550] [5/16 Execution] Executed blocks         number=13882662 blk/s=2.571 tx/s=443.643 Mgas/s=37.949 batch=\"3.66 MiB\" alloc=\"3.23 GiB\" sys=\"9.84 GiB\"\r\n[INFO] [04-07|00:05:43.416] [5/16 Execution] Executed blocks         number=13882746 blk/s=2.813 tx/s=494.580 Mgas/s=44.117 batch=\"6.00 MiB\" alloc=\"3.82 GiB\" sys=\"9.84 GiB\"\r\n...\r\n# 08.04 - 344,974 (since yesterday)\r\n[INFO] [04-08|00:09:47.433] [p2p] GoodPeers                          eth66=100\r\n[INFO] [04-08|00:10:00.679] [5/16 Execution] Executed blocks         number=14227720 blk/s=0.008 tx/s=1.021 Mgas/s=0.083 batch=\"0.00 B\" alloc=\"2.34 GiB\" sys=\"9.84 GiB\"\r\n[INFO] [04-08|00:10:14.231] [5/16 Execution] Executed blocks         number=14227734 blk/s=1.033 tx/s=167.342 Mgas/s=15.534 batch=\"594.33 KiB\" alloc=\"2.50 GiB\" sys=\"9.84 GiB\"\r\n[INFO] [04-08|00:10:43.860] [5/16 Execution] Executed blocks         number=14227789 blk/s=1.856 tx/s=353.773 Mgas/s=29.264 batch=\"2.37 MiB\" alloc=\"3.02 GiB\" sys=\"9.84 GiB\"\r\n[INFO] [04-08|00:11:13.442] [5/16 Execution] Executed blocks         number=14227864 blk/s=2.535 tx/s=473.838 Mgas/s=39.255 batch=\"4.52 MiB\" alloc=\"3.66 GiB\" sys=\"9.84 GiB\"\r\n[INFO] [04-08|00:11:43.789] [5/16 Execution] Executed blocks         number=14227949 blk/s=2.801 tx/s=535.736 Mgas/s=45.176 batch=\"6.99 MiB\" alloc=\"4.42 GiB\" sys=\"9.84 GiB\"\r\n...\r\n[INFO] [04-08|16:15:36.054] [5/16 Execution] Completed on            block=14455041\r\n[INFO] [04-08|16:15:36.055] [5/16 Execution] DONE                    in=305h29m52.676335416s\r\n\r\n# 7/16\r\n[INFO] [04-08|16:15:36.062] [7/16 HashState] Promoting plain state   from=0 to=14455041\r\n[INFO] [04-08|16:15:47.433] [p2p] GoodPeers                          eth66=100\r\n...\r\n[INFO] [04-08|23:29:16.121] [7/16 HashState] DONE                    in=7h13m40.063115608s\r\n\r\n# 8/16\r\n[INFO] [04-08|23:29:16.130] [8/16 IntermediateHashes] Generating intermediate hashes from=0 to=14455041\r\n...\r\n[INFO] [04-09|01:54:08.379] [8/16 IntermediateHashes] DONE           in=2h24m52.255673747s\r\n\r\n# 9/16\r\n[INFO] [04-09|01:54:38.464] [9/16 CallTraces] Progress               number=1167923 blk/second=38930.733 alloc=\"1.98 GiB\" sys=\"9.84 GiB\"\r\n...\r\n[INFO] [04-09|14:13:57.373] [9/16 CallTraces] DONE                   in=12h19m48.991347865s\r\n\r\n# 10/16\r\n[INFO] [04-09|14:14:27.376] [10/16 AccountHistoryIndex] Progress     number=1081498 alloc=\"1.1 GiB\" sys=\"10.1 GiB\"\r\n...\r\n[INFO] [04-10|00:30:20.542] [10/16 AccountHistoryIndex] DONE         in=10h16m23.167784058s\r\n\r\n# 11/16\r\n[INFO] [04-10|00:30:51.135] [11/16 StorageHistoryIndex] Progress     number=1796444 alloc=\"1.8 GiB\" sys=\"10.2 GiB\"\r\n...\r\n[INFO] [04-10|16:07:19.809] [11/16 StorageHistoryIndex] DONE         in=15h36m59.266096849s\r\n\r\n# 12/16\r\n[INFO] [04-10|16:07:49.815] [12/16 LogIndex] Progress                number=1187416 alloc=\"2.1 GiB\" sys=\"10.2 GiB\"\r\n...\r\n[INFO] [04-11|11:37:23.938] [12/16 LogIndex] DONE                    in=19h30m4.126256209s\r\n\r\n# 13/16\r\n[INFO] [04-11|11:37:53.941] [13/16 TxLookup] ETL [1/2] Extracting    from=CanonicalHeader block=483120 alloc=\"1.2 GiB\" sys=\"10.2 GiB\"\r\n...\r\n[INFO] [04-12|08:51:34.735] [13/16 TxLookup] DONE                    in=21h14m10.795976568s\r\n\r\n[INFO] [04-12|08:51:34.759] Timings (slower than 10ms)               Headers=19m49.917s BlockHashes=3m10.075s Bodies=8h34m55.929s Senders=26h55m59.936s Execution=305h29m52.676s HashState=7h13m40.063s IntermediateHashes=2h24m52.255s CallTraces=12h19m48.991s AccountHistoryIndex=10h16m23.167s StorageHistoryIndex=15h36m59.266s LogIndex=19h30m4.126s TxLookup=21h14m10.795s Finish=10ms\r\n[INFO] [04-12|08:51:34.853] RPC Daemon notified of new headers       from=14454017 to=14455041\r\n\r\n# 1/16\r\n[INFO] [04-12|08:51:34.854] [1/16 Headers] Waiting for headers...    from=14455041\r\n...\r\n[INFO] [04-12|09:09:47.589] [1/16 Headers] DONE                      in=18m12.735575849s\r\n\r\n# 2/16\r\n[INFO] [04-12|09:10:17.873] [2/16 BlockHashes] ETL [2/2] Loading     into=HeaderNumber current key=8db0a6ee... alloc=\"1.8 GiB\" sys=\"10.2 GiB\"\r\n\r\n# 3/16\r\n[INFO] [04-12|09:10:41.403] [3/16 Bodies] Processing bodies...       from=14455041 to=14569770\r\n...\r\n[INFO] [04-12|09:15:49.313] [3/16 Bodies] DONE                       in=5m7.910295865s\r\n\r\n# 4/16\r\n[INFO] [04-12|09:15:49.314] [4/16 Senders] Started                   from=14455041 to=14569770\r\n...\r\n[INFO] [04-12|09:45:47.638] [4/16 Senders] DONE                      in=29m58.32467635s\r\n\r\n# 5/16\r\n[INFO] [04-12|09:45:47.640] [5/16 Execution] Blocks execution        from=14455041 to=14569770\r\n...\r\n[INFO] [04-12|11:02:18.208] [5/16 Execution] Executed blocks         number=14470763 blk/s=2.493 tx/s=509.264 Mgas/s=40.122 batch=\"306.16 MiB\" alloc=\"8.80 GiB\" sys=\"10.20 GiB\"\r\n\r\n# Finish\r\n[INFO] [04-12|11:13:30.290] Starting metrics server                  addr=http://0.0.0.0:6060/debug/metrics/prometheus\r\n[INFO] [04-12|11:13:30.290] Starting pprof server                    cpu=\"go tool pprof -lines -http=: http://0.0.0.0:6061/debug/pprof/profile?seconds=20\" heap=\"go tool pprof -lines -http=: h\r\nttp://0.0.0.0:6061/debug/pprof/heap\"\r\n[INFO] [04-12|11:13:30.290] Build info                               git_branch=heads/v2022.03.01 git_tag=v2022.03.01 git_commit=25a68e08a5287892022291f0c6ef98684be12838\r\n[INFO] [04-12|11:13:30.291] Starting Erigon on Ethereum mainnet...\r\n[INFO] [04-12|11:13:30.307] Maximum peer count                       ETH=100 total=100\r\n[INFO] [04-12|11:13:30.307] Set global gas cap                       cap=50000000\r\n[INFO] [04-12|11:13:30.405] Opening Database                         label=chaindata path=/home/erigon/.local/share/erigon/chaindata\r\nmdbx_setup_dxb:15225 filesize mismatch (expect 1861868322816b/454557696p, have 1864015806464b/455081984p)\r\n[INFO] [04-12|11:13:30.460] Initialised chain configuration          config=\"{ChainID: 1 Homestead: 1150000 DAO: 1920000 DAOSupport: true EIP150: 2463000 EIP155: 2675000 EIP158: 2675000 Byzan\r\ntium: 4370000 Constantinople: 7280000 Petersburg: 7280000 Istanbul: 9069000, Muir Glacier: 9200000, Berlin: 12244000, London: 12965000, Arrow Glacier: 13773000, Engine: ethash}\"\r\n[INFO] [04-12|11:13:30.461] Disk storage enabled for ethash DAGs     dir=/home/erigon/.local/share/erigon/ethash-dags count=2\r\n[INFO] [04-12|11:13:30.462] Initialising Ethereum protocol           network=1\r\n[INFO] [04-12|11:13:30.463] Effective                                prune=\"--prune=\"\r\n[INFO] [04-12|11:13:37.084] Starting private RPC server              on=0.0.0.0:9090\r\n```\r\n\r\n| Step                      | Duration             | Finished date         |\r\n| ------------------------- | -------------------- | --------------------- |\r\n| 1/16 Headers              |     19m49.917398973s | [03-25\\|11:11:37.435] |\r\n| 2/16 BlockHashes          |      3m10.075559756s | [03-25\\|11:14:47.511] |\r\n| 3/16 Bodies               |   8h34m55.929198533s | [03-25\\|19:49:43.440] |\r\n| 4/16 Senders              |  26h55m59.936783585s | [03-26\\|22:45:43.378] |\r\n| 5/16 Execution            | 305h29m52.676335416s | [04-08\\|16:15:36.055] |\r\n| 7/16 HashState            |   7h13m40.063115608s | [04-08\\|23:29:16.121] |\r\n| 8/16 IntermediateHashes   |   2h24m52.255673747s | [04-09\\|01:54:08.379] |\r\n| 9/16 CallTraces           |  12h19m48.991347865s | [04-09\\|14:13:57.373] |\r\n| 10/16 AccountHistoryIndex |  10h16m23.167784058s | [04-10\\|00:30:20.542] |\r\n| 11/16 StorageHistoryIndex |  15h36m59.266096849s | [04-10\\|16:07:19.809] |\r\n| 12/16 LogIndex            |  19h30m4.126256209s  | [04-11\\|11:37:23.938] |\r\n| 13/16 TxLookup            |  21h14m10.795976568s | [04-12\\|08:51:34.735] |\r\n| 1/16 Headers              |     18m12.735575849s | [04-12\\|09:09:47.589] |\r\n| 2/16 BlockHashes          |                    - | [04-12\\|09:10:17.873] |\r\n| 3/16 Bodies               |       5m7.910295865s | [04-12\\|09:15:49.313] |\r\n| 4/16 Senders              |      29m58.32467635s | [04-12\\|09:45:47.638] |\r\n| 5/16 Execution            |                    - | [04-12\\|11:02:18.208] |\r\n\r\n~ 18 days\r\n\r\n```\r\n1.9T\t/data/erigon\r\n```\r\n\r\n\r\n### Hardware on AWS\r\n[m5a.xlarge](https://aws.amazon.com/ec2/instance-types/m5/): 4vCPU / 16 GB\r\n[gp3](https://aws.amazon.com/ebs/general-purpose/)/3000 GB: 16000IOPS / 1000Mbit/s\r\n\r\n\r\n### Docker compose\r\nWe used [docker-compose.yml](https://github.com/ledgerwatch/erigon/blob/devel/docker-compose.yml) from repository as a source\r\n```\r\nversion: '3.9'\r\n\r\nservices:\r\n  erigon:\r\n    container_name: erigon\r\n    image: thorax/erigon:v2022.03.02\r\n    command: erigon --chain mainnet --datadir=/home/erigon/.local/share/erigon --private.api.addr=0.0.0.0:9090 --metrics --metrics.addr=0.0.0.0 --metrics.port=6060 --pprof --pprof.addr=0.0.0.0 --pprof.port=6061\r\n    user: 2000:2000\r\n    volumes:\r\n      - /data/erigon:/home/erigon/.local/share/erigon\r\n    ports:\r\n      - \"30303:30303/tcp\" # P2P TCP\r\n      - \"30303:30303/udp\" # P2P UDP\r\n      - \"30304:30304/tcp\" # P2P TCP\r\n      - \"30304:30304/udp\" # P2P UDP\r\n      - \"6060:6060\"       # Metrics\r\n      - \"6061:6061\"       # pprof\r\n    restart: unless-stopped\r\n\r\n  rpcdaemon:\r\n    container_name: rpcdaemon\r\n    image: thorax/erigon:v2022.03.02\r\n    command: rpcdaemon --datadir=/home/erigon/.local/share/erigon --private.api.addr=erigon:9090 --txpool.api.addr=erigon:9090 --http.addr=0.0.0.0 --http.vhosts=* --http.corsdomain=* --http.api=eth,erigon,web3,net,debug,trace,txpool --ws\r\n    user: 2000:2000\r\n    pid: service:erigon\r\n    volumes_from:\r\n      - erigon\r\n    ports:\r\n      - \"8545:8545\" # RPC/WS\r\n      - \"9090:9090\" # gRPC\r\n    restart: unless-stopped\r\n```\r\n\r\nToday we tried again to run a downloader to speed up sync but is still fail\r\n```\r\nError response from daemon: failed to create shim: OCI runtime create failed: container_linux.go:380: starting container process caused: exec: \"downloader\": executable file not found in $PATH: unknown\r\n```\r\n\r\n### Questions\r\n1. Is downloader executable present in the current docker image and can be used to speedup the sync?\r\n2. Can we use snap-sync if initially we started Erigon without this option?\r\n3. Why sync is so slow? It slowed down some days ago and we still see `blk/s=5.517` instead of initial bigger ones.\r\n\r\n\r\n### Node metrics from AWS\r\n\r\n#### CPU\r\n<img width=\"1211\" alt=\"Screenshot 2022-04-06 at 11 55 21\" src=\"https://user-images.githubusercontent.com/88528265/161937230-71cb12eb-b357-4820-a4ca-d2ca7709e0c0.png\">\r\n\r\n#### Network\r\n<img width=\"1210\" alt=\"Screenshot 2022-04-06 at 11 55 53\" src=\"https://user-images.githubusercontent.com/88528265/161937233-84409db7-612f-4bec-90e2-d4ab631e6e56.png\">\r\n\r\n#### Disk\r\n<img width=\"1215\" alt=\"Screenshot 2022-04-06 at 11 54 20\" src=\"https://user-images.githubusercontent.com/88528265/161937217-d7d73519-5061-4b06-ae35-faeba750ba91.png\">\r\n<img width=\"1216\" alt=\"Screenshot 2022-04-06 at 11 53 47\" src=\"https://user-images.githubusercontent.com/88528265/161937193-e440fddc-2765-4891-a515-af5c447b76d3.png\">\r\n<img width=\"1213\" alt=\"Screenshot 2022-04-06 at 11 54 41\" src=\"https://user-images.githubusercontent.com/88528265/161937223-2c2a4dcf-b342-4019-a5dd-589fe1b11539.png\">",
  "closed_by": {
    "login": "mandrigin",
    "id": 466427,
    "node_id": "MDQ6VXNlcjQ2NjQyNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/466427?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mandrigin",
    "html_url": "https://github.com/mandrigin",
    "followers_url": "https://api.github.com/users/mandrigin/followers",
    "following_url": "https://api.github.com/users/mandrigin/following{/other_user}",
    "gists_url": "https://api.github.com/users/mandrigin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mandrigin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mandrigin/subscriptions",
    "organizations_url": "https://api.github.com/users/mandrigin/orgs",
    "repos_url": "https://api.github.com/users/mandrigin/repos",
    "events_url": "https://api.github.com/users/mandrigin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mandrigin/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3835/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3835/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1090118622",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3835#issuecomment-1090118622",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3835",
    "id": 1090118622,
    "node_id": "IC_kwDOC0FsAM5A-ePe",
    "user": {
      "login": "mandrigin",
      "id": 466427,
      "node_id": "MDQ6VXNlcjQ2NjQyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/466427?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mandrigin",
      "html_url": "https://github.com/mandrigin",
      "followers_url": "https://api.github.com/users/mandrigin/followers",
      "following_url": "https://api.github.com/users/mandrigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mandrigin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mandrigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mandrigin/subscriptions",
      "organizations_url": "https://api.github.com/users/mandrigin/orgs",
      "repos_url": "https://api.github.com/users/mandrigin/repos",
      "events_url": "https://api.github.com/users/mandrigin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mandrigin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-06T10:39:22Z",
    "updated_at": "2022-04-06T10:39:22Z",
    "author_association": "COLLABORATOR",
    "body": "I think it is expected on EBS, especially `gp` type. We had better experience either with `io`-type EBS or with internal SSDs.\r\nErigon is sensitive to the i/o latency, not throughput.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1090118622/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1090123696",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3835#issuecomment-1090123696",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3835",
    "id": 1090123696,
    "node_id": "IC_kwDOC0FsAM5A-few",
    "user": {
      "login": "mandrigin",
      "id": 466427,
      "node_id": "MDQ6VXNlcjQ2NjQyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/466427?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mandrigin",
      "html_url": "https://github.com/mandrigin",
      "followers_url": "https://api.github.com/users/mandrigin/followers",
      "following_url": "https://api.github.com/users/mandrigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mandrigin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mandrigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mandrigin/subscriptions",
      "organizations_url": "https://api.github.com/users/mandrigin/orgs",
      "repos_url": "https://api.github.com/users/mandrigin/repos",
      "events_url": "https://api.github.com/users/mandrigin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mandrigin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-06T10:43:26Z",
    "updated_at": "2022-04-06T10:43:58Z",
    "author_association": "COLLABORATOR",
    "body": "answers to your questions\r\n\r\n> Is downloader executable present in the current docker image and can be used to speedup the sync?\r\n\r\nI don't think the downloader will do anything for stable erigon release. @AlexeyAkhunov @AskAlexSharov please reopen/comment if that is not true :)\r\n\r\n> Can we use snap-sync if initially we started Erigon without this option?\r\n\r\nErigon doesn't support snap-sync.\r\n\r\n> Why sync is so slow? It slowed down some days ago and we still see blk/s=5.517 instead of initial bigger ones.\r\n\r\n`blk/s` is a bad metric to judge the perfomance, early blocks have less transactions. use `mgas/s` instead. The speed is expected on AWS `gp` EBS, I wouldn't recommend using that setup.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1090123696/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1090193232",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3835#issuecomment-1090193232",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3835",
    "id": 1090193232,
    "node_id": "IC_kwDOC0FsAM5A-wdQ",
    "user": {
      "login": "air3ijai",
      "id": 88528265,
      "node_id": "MDQ6VXNlcjg4NTI4MjY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/88528265?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/air3ijai",
      "html_url": "https://github.com/air3ijai",
      "followers_url": "https://api.github.com/users/air3ijai/followers",
      "following_url": "https://api.github.com/users/air3ijai/following{/other_user}",
      "gists_url": "https://api.github.com/users/air3ijai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/air3ijai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/air3ijai/subscriptions",
      "organizations_url": "https://api.github.com/users/air3ijai/orgs",
      "repos_url": "https://api.github.com/users/air3ijai/repos",
      "events_url": "https://api.github.com/users/air3ijai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/air3ijai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-06T12:07:51Z",
    "updated_at": "2022-04-06T12:07:51Z",
    "author_association": "NONE",
    "body": "@mandrigin,\r\n\r\n> I don't think the downloader will do anything for stable erigon release. @AlexeyAkhunov @AskAlexSharov please reopen/comment if that is not true :)\r\n\r\n`image: thorax/erigon:v2022.03.02` - [2022.03.02-beta](https://github.com/ledgerwatch/erigon/releases/tag/v2022.03.02). So it is beta - can it work with this release?\r\n\r\n\r\n> Erigon doesn't support snap-sync.\r\n\r\n[What then this line mean](https://github.com/ledgerwatch/erigon/blob/devel/docker-compose.yml#L59)?\r\n`downloader: # Service to download/seed historical data (need only if you use --syncmode=snap)`\r\n\r\n> `blk/s` is a bad metric to judge the perfomance, early blocks have less transactions. use `mgas/s` instead. The speed is expected on AWS gp EBS, I wouldn't recommend using that setup.\r\n\r\nWe already have a node on AWS with similar hardware and doesn't have any issue with it, but we didn't note how long it take for initial sync.\r\n\r\nAnyway, thank you for the info about disk requirements. We just changed from gp3/16000 to io-2/1000. Let's see if something will be changed.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1090193232/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1090620712",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3835#issuecomment-1090620712",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3835",
    "id": 1090620712,
    "node_id": "IC_kwDOC0FsAM5BAY0o",
    "user": {
      "login": "mandrigin",
      "id": 466427,
      "node_id": "MDQ6VXNlcjQ2NjQyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/466427?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mandrigin",
      "html_url": "https://github.com/mandrigin",
      "followers_url": "https://api.github.com/users/mandrigin/followers",
      "following_url": "https://api.github.com/users/mandrigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mandrigin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mandrigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mandrigin/subscriptions",
      "organizations_url": "https://api.github.com/users/mandrigin/orgs",
      "repos_url": "https://api.github.com/users/mandrigin/repos",
      "events_url": "https://api.github.com/users/mandrigin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mandrigin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-06T18:49:28Z",
    "updated_at": "2022-04-06T18:49:28Z",
    "author_association": "COLLABORATOR",
    "body": "Erigon is functional on `gp3` disks, just the initial sync is quite long and some RPC operations (especially on archival data) could be slower. So it really depends on the load profile. Even with your case it was 3 blocks per second, whether the tip of the chain grows with 1 block per ~13 seconds, so you have enough room to keep in sync with the tip of the chain.\r\n\r\nSnapshot sync -- I think it is a bit more manual at the moment, and it is not compatible with `geth`'s snap sync protocol.\r\nHere is more info: https://github.com/ledgerwatch/erigon/tree/devel/cmd/downloader\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1090620712/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1091045009",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3835#issuecomment-1091045009",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3835",
    "id": 1091045009,
    "node_id": "IC_kwDOC0FsAM5BCAaR",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-07T03:38:21Z",
    "updated_at": "2022-04-07T03:38:21Z",
    "author_association": "COLLABORATOR",
    "body": "we will releasee snapsync soon. but v1 of our snapsync will not speedup blocks execution. v2 will.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1091045009/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1092529261",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3835#issuecomment-1092529261",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3835",
    "id": 1092529261,
    "node_id": "IC_kwDOC0FsAM5BHqxt",
    "user": {
      "login": "air3ijai",
      "id": 88528265,
      "node_id": "MDQ6VXNlcjg4NTI4MjY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/88528265?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/air3ijai",
      "html_url": "https://github.com/air3ijai",
      "followers_url": "https://api.github.com/users/air3ijai/followers",
      "following_url": "https://api.github.com/users/air3ijai/following{/other_user}",
      "gists_url": "https://api.github.com/users/air3ijai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/air3ijai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/air3ijai/subscriptions",
      "organizations_url": "https://api.github.com/users/air3ijai/orgs",
      "repos_url": "https://api.github.com/users/air3ijai/repos",
      "events_url": "https://api.github.com/users/air3ijai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/air3ijai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-08T07:17:26Z",
    "updated_at": "2022-04-08T07:17:26Z",
    "author_association": "NONE",
    "body": "We did update of the EBS from gp3 to the io2-1000/2000/3000, but looks like nothing changed drastically\r\n\r\n| Type | Size | IOPS  | Throughput | Cost       |\r\n| ---- | ---- | ----- | ---------- | ---------- |\r\n| gp3  | 3000 | 16000 | 1000       | 340.00 USD |\r\n| io2  | 3000 | 1000  | -          | 440.00 USD |\r\n| io2  | 3000 | 2000  | -          | 505.00 USD |\r\n| io2  | 3000 | 3000  | -          | 570.00 USD |\r\n\r\n<img width=\"1210\" alt=\"Screenshot 2022-04-08 at 08 54 56\" src=\"https://user-images.githubusercontent.com/88528265/162382543-292b1efe-9f15-4c40-bcde-317e4bc9d1d1.png\">\r\n<img width=\"1216\" alt=\"Screenshot 2022-04-08 at 08 55 57\" src=\"https://user-images.githubusercontent.com/88528265/162382566-33c3285a-7372-4a91-af1c-76d6412380bc.png\">\r\n<img width=\"1215\" alt=\"Screenshot 2022-04-08 at 08 56 53\" src=\"https://user-images.githubusercontent.com/88528265/162382613-cf0d9be6-7b33-464f-963d-5c0a552673a6.png\">\r\n<img width=\"1212\" alt=\"Screenshot 2022-04-08 at 10 02 18\" src=\"https://user-images.githubusercontent.com/88528265/162382635-306e76a7-7122-477d-8193-5874204ba8c0.png\">",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1092529261/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1120443955",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3835#issuecomment-1120443955",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3835",
    "id": 1120443955,
    "node_id": "IC_kwDOC0FsAM5CyJ4z",
    "user": {
      "login": "nisaacson",
      "id": 41758,
      "node_id": "MDQ6VXNlcjQxNzU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/41758?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisaacson",
      "html_url": "https://github.com/nisaacson",
      "followers_url": "https://api.github.com/users/nisaacson/followers",
      "following_url": "https://api.github.com/users/nisaacson/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisaacson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisaacson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisaacson/subscriptions",
      "organizations_url": "https://api.github.com/users/nisaacson/orgs",
      "repos_url": "https://api.github.com/users/nisaacson/repos",
      "events_url": "https://api.github.com/users/nisaacson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisaacson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-08T16:01:35Z",
    "updated_at": "2022-05-08T18:28:00Z",
    "author_association": "NONE",
    "body": "I suggest you switch to an instance store volume type. For example use the `i3en.3xlarge` instance type and put the erigon database on the nvme drive.\r\n\r\n```\r\nsudo useradd -m -s /bin/bash erigon\r\ndf -h\r\nlsblk # note the nvme drive in the list\r\nsudo mkdir /data\r\nsudo mkfs -t ext4 /dev/nvme1n1\r\nsudo mount /dev/nvme1n1 /data\r\nmkdir -p /data/erigon/datadir\r\nchown -R erigon:erigon /data/erigon\r\n```\r\n\r\n In this example make sure to set the erigon process to run as `erigon` user\r\n\r\n\r\n`/etc/supervisor/conf.d/erigon.conf`\r\n\r\n```\r\n[program:erigon]\r\ncommand=bash -c '/opt/erigon/bin/erigon --syncmode=snap --torrent.download.rate=1gb  --datadir=\"/data/erigon/datadir\" --private.api.addr=\"localhost:9090\"'\r\nuser=erigon\r\nautostart=true\r\nautorestart=true\r\nstderr_logfile=/var/log/supervisor/erigon.err.log\r\nstderr_logfile_maxbytes=1000000\r\nstderr_logfile_backups=10\r\nstdout_logfile=/var/log/supervisor/erigon.out.log\r\nstdout_logfile_maxbytes=1000000\r\nstdout_logfile_backups=10\r\nstopwaitsecs=300\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1120443955/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1120538212",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3835#issuecomment-1120538212",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3835",
    "id": 1120538212,
    "node_id": "IC_kwDOC0FsAM5Cyg5k",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-09T01:26:52Z",
    "updated_at": "2022-05-09T01:26:52Z",
    "author_association": "COLLABORATOR",
    "body": "In cloud: \r\n1. During initial sync - give for erigon nvme and much RAM. \r\n2. When initial sync is done - move db to any other disk type and reduce RAM.\r\n3. You can mount <datadir>/snapshots and <datadir>/etl-temp to cheaper disk type",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1120538212/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1365226530",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3835#issuecomment-1365226530",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3835",
    "id": 1365226530,
    "node_id": "IC_kwDOC0FsAM5RX7Qi",
    "user": {
      "login": "air3ijai",
      "id": 88528265,
      "node_id": "MDQ6VXNlcjg4NTI4MjY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/88528265?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/air3ijai",
      "html_url": "https://github.com/air3ijai",
      "followers_url": "https://api.github.com/users/air3ijai/followers",
      "following_url": "https://api.github.com/users/air3ijai/following{/other_user}",
      "gists_url": "https://api.github.com/users/air3ijai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/air3ijai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/air3ijai/subscriptions",
      "organizations_url": "https://api.github.com/users/air3ijai/orgs",
      "repos_url": "https://api.github.com/users/air3ijai/repos",
      "events_url": "https://api.github.com/users/air3ijai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/air3ijai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-26T14:39:41Z",
    "updated_at": "2022-12-26T14:39:41Z",
    "author_association": "NONE",
    "body": "An article about `i3` vs `m5` - [Optimizing Performance and Cost: Infura Benchmark Analysis](https://blog.infura.io/post/optimizing-performance-and-cost-infura-benchmark-analysis-f083ccf8f6ac)",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1365226530/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
