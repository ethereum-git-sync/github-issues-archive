{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6329",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6329/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6329/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6329/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/6329",
  "id": 1499119598,
  "node_id": "I_kwDOC0FsAM5ZWr_u",
  "number": 6329,
  "title": "Erigon Start up Error due not being able to connect to checkpoint syncs",
  "user": {
    "login": "enriquemanuel",
    "id": 1172970,
    "node_id": "MDQ6VXNlcjExNzI5NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1172970?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/enriquemanuel",
    "html_url": "https://github.com/enriquemanuel",
    "followers_url": "https://api.github.com/users/enriquemanuel/followers",
    "following_url": "https://api.github.com/users/enriquemanuel/following{/other_user}",
    "gists_url": "https://api.github.com/users/enriquemanuel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/enriquemanuel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/enriquemanuel/subscriptions",
    "organizations_url": "https://api.github.com/users/enriquemanuel/orgs",
    "repos_url": "https://api.github.com/users/enriquemanuel/repos",
    "events_url": "https://api.github.com/users/enriquemanuel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/enriquemanuel/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4566396003,
      "node_id": "LA_kwDOC0FsAM8AAAABEC2sYw",
      "url": "https://api.github.com/repos/ledgerwatch/erigon/labels/Stale",
      "name": "Stale",
      "color": "ededed",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2022-12-15T21:32:09Z",
  "updated_at": "2023-04-03T03:12:21Z",
  "closed_at": "2023-02-01T02:46:58Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\nUpgraded from: 2.28.1\r\nUpgraded to: 2.30.0\r\n\r\nOS: Debian \r\nErigon is in Docker\r\n\r\n\r\n#### Expected behaviour\r\n- Erigon starts syncing\r\n\r\n#### Actual behaviour\r\n- Erigon fails to start trying to reach \r\n\r\n#### Steps to reproduce the behaviour\r\nhave a network gateway that blocks connectivity to non approved sites and block the list there and Erigon wont start.\r\n\r\nBefore in `2.28.1` Erigon would start with \r\n```\r\n\" [INFO] [12-15|21:11:57.539] [1/16 Snapshots] Fetching torrent files metadata \"\r\n\" [INFO] [12-15|21:11:59.072] [txpool] Started \"\r\n\" [INFO] [12-15|21:11:59.703] [Snapshots] Blocks Stat                  blocks=15000k indices=15000k alloc=2.5GB sys=2.7GB\"\r\n\" [INFO] [12-15|21:11:59.703] [2/16 Headers] Waiting for Consensus Layer... \"\r\n```\r\n\r\nand after the upgrade with the same set of CLI args it fails with\r\n```\r\n\" [INFO] [12-15|18:50:55.447] new subscription to logs established \"\r\n\" [INFO] [12-15|18:50:55.461] Sentinel started                         enr=enr:-Ly4QFl6bRBBm06Vt3Arr024NBG5GzKUkBxjF8Yf7Dp1-t5XOhzhPVRgWgmShj1LVnUfLtJ8zHdDdqIrLpm6xTgKm_kBh2F0dG5ldHOIAAAAAAAAAACEZXRoMpBKJsWLAgAAAP__________gmlkgnY0gmlwhH8AAAGJc2VjcDI1NmsxoQJ_cM7XDTHvkn82gT9ktr7t4umohXHWDwiQXBGR-vm1OIhzeW5jbmV0cwCDdGNwgg-hg3VkcIIPoA\"\r\n\" [INFO] [12-15|18:50:55.461] [Checkpoint Sync] Requesting beacon state uri=https://mainnet.checkpoint.sigp.io/eth/v2/debug/beacon/states/finalized\"\r\n\" [EROR] [12-15|18:50:55.466] Erigon startup                           err=\\\"Get \\\\\\\"https://mainnet.checkpoint.sigp.io/eth/v2/debug/beacon/states/finalized\\\\\\\": EOF\\\"\"\r\n```\r\n\r\n#### Backtrace\r\nThe issue was introduced when this change was added https://github.com/ledgerwatch/erigon/blob/5c3245d4e034606732573044a59ce793be1ceeea/cl/clparams/config.go#L189-L209 in PR https://github.com/ledgerwatch/erigon/pull/5761\r\n\r\n#### Command Line Arguments:\r\n```\r\n--http --snapshots=false --http.addr=0.0.0.0 --http.port=8546 --authrpc.port=8551 --http.vhosts=* --http.corsdomain=* --datadir=/var/lib/erigon/.ethereum --metrics --healthcheck --authrpc.jwtsecret=/secret/path/to/jwt/token --http.api=eth,net,web3,debug,admin,engine,erigon,trace --log.console.verbosity=info --ws --chain=mainnet --maxpeers 100\r\n```\r\n\r\n### More info\r\nIn the releases https://github.com/ledgerwatch/erigon/releases it doesn't state that it now needs to connect to those external sites by default nor it mentions the PR 5761 to be a requirement. Can that be bypassed?\r\nFor sanity, any domain in that list isn't reachable from my production hosts unless I add a firewall rule, which is problematic since that list is not exhaustive and can change without any announcement; this alters the default behavior we had before but wasn't announced.\r\n\r\nreverting to 2.28.1 allows us to start and run",
  "closed_by": {
    "login": "github-actions[bot]",
    "id": 41898282,
    "node_id": "MDM6Qm90NDE4OTgyODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/github-actions%5Bbot%5D",
    "html_url": "https://github.com/apps/github-actions",
    "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6329/reactions",
    "total_count": 3,
    "+1": 3,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6329/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1403013532",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/6329#issuecomment-1403013532",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6329",
    "id": 1403013532,
    "node_id": "IC_kwDOC0FsAM5ToEmc",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-01-25T02:31:07Z",
    "updated_at": "2023-01-25T02:31:07Z",
    "author_association": "NONE",
    "body": "This issue is stale because it has been open for 40 days with no activity. Remove stale label or comment, or this will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1403013532/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1411376918",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/6329#issuecomment-1411376918",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6329",
    "id": 1411376918,
    "node_id": "IC_kwDOC0FsAM5UH-cW",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-02-01T02:46:58Z",
    "updated_at": "2023-02-01T02:46:58Z",
    "author_association": "NONE",
    "body": "This issue was closed because it has been stalled for 7 days with no activity.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1411376918/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1416325483",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/6329#issuecomment-1416325483",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6329",
    "id": 1416325483,
    "node_id": "IC_kwDOC0FsAM5Ua2lr",
    "user": {
      "login": "bioharz",
      "id": 19763861,
      "node_id": "MDQ6VXNlcjE5NzYzODYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/19763861?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bioharz",
      "html_url": "https://github.com/bioharz",
      "followers_url": "https://api.github.com/users/bioharz/followers",
      "following_url": "https://api.github.com/users/bioharz/following{/other_user}",
      "gists_url": "https://api.github.com/users/bioharz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bioharz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bioharz/subscriptions",
      "organizations_url": "https://api.github.com/users/bioharz/orgs",
      "repos_url": "https://api.github.com/users/bioharz/repos",
      "events_url": "https://api.github.com/users/bioharz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bioharz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-03T19:44:22Z",
    "updated_at": "2023-02-03T19:44:22Z",
    "author_association": "NONE",
    "body": "please open this ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1416325483/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1472506785",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/6329#issuecomment-1472506785",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6329",
    "id": 1472506785,
    "node_id": "IC_kwDOC0FsAM5XxKuh",
    "user": {
      "login": "sbrass",
      "id": 19287232,
      "node_id": "MDQ6VXNlcjE5Mjg3MjMy",
      "avatar_url": "https://avatars.githubusercontent.com/u/19287232?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sbrass",
      "html_url": "https://github.com/sbrass",
      "followers_url": "https://api.github.com/users/sbrass/followers",
      "following_url": "https://api.github.com/users/sbrass/following{/other_user}",
      "gists_url": "https://api.github.com/users/sbrass/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sbrass/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sbrass/subscriptions",
      "organizations_url": "https://api.github.com/users/sbrass/orgs",
      "repos_url": "https://api.github.com/users/sbrass/repos",
      "events_url": "https://api.github.com/users/sbrass/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sbrass/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-16T18:22:02Z",
    "updated_at": "2023-03-16T18:22:02Z",
    "author_association": "NONE",
    "body": "I would like to add my observations on this kind of error message, in my case lead by:\r\n```\r\n\"https://sync.invis.tools/eth/v2/debug/beacon/states/finalized\": dial tcp: lookup sync.invis.tools: device or resource busy\r\n```\r\n\r\nOS: Ubuntu 22.04.2 LTS (Jammy Jellyfish)\r\nArchitecture: aarch64\r\nOfficial images:\r\n- thorax/erigon:v2.40.1-arm64, NOT WORKING\r\n- thorax/erigon:v2.32.1-arm64, WORKING\r\n\r\nAs the error message already states, the underlying issue isn't directly related to Erigon itself.\r\nI can just guess that it may be an issue with the underlying Go libraries?\r\n\r\nFrom my side, I could solve the issue by buildinng the container for all versions myself since v2.32.1 using:\r\n```\r\ndocker build -f Dockerfile -t thorax/erigon:v<current version> .\r\n```\r\nand trying out the image, all with Go version 1.19.7.\r\nThe error message disappers in all cases.\r\nUsing the image from Docker Hub produces the above error message.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1472506785/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1493580543",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/6329#issuecomment-1493580543",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6329",
    "id": 1493580543,
    "node_id": "IC_kwDOC0FsAM5ZBjr_",
    "user": {
      "login": "zhiming137",
      "id": 3394876,
      "node_id": "MDQ6VXNlcjMzOTQ4NzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3394876?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zhiming137",
      "html_url": "https://github.com/zhiming137",
      "followers_url": "https://api.github.com/users/zhiming137/followers",
      "following_url": "https://api.github.com/users/zhiming137/following{/other_user}",
      "gists_url": "https://api.github.com/users/zhiming137/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zhiming137/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zhiming137/subscriptions",
      "organizations_url": "https://api.github.com/users/zhiming137/orgs",
      "repos_url": "https://api.github.com/users/zhiming137/repos",
      "events_url": "https://api.github.com/users/zhiming137/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zhiming137/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-03T03:12:20Z",
    "updated_at": "2023-04-03T03:12:20Z",
    "author_association": "NONE",
    "body": "It seems like you're facing a similar issue related to Go DNS resolution. The problem can be solved by setting an environment variable.\r\n\r\nHere's the command you can use to set the GODEBUG environment variable:\r\n\r\n```\r\nGODEBUG=\"netdns=go\" ./bin/erigon --config ./config.toml\r\n```\r\n\r\nThis will set the netdns value to go, which will use Go's implementation of DNS resolution instead of the system's implementation. This should help resolve the issue you're facing.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1493580543/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
