{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8245",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8245/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8245/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8245/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/8245",
  "id": 1903943264,
  "node_id": "I_kwDOC0FsAM5xe95g",
  "number": 8245,
  "title": "Corrupted transactions in `engine_getPayloadBodiesByRangeV1`",
  "user": {
    "login": "michaelsproul",
    "id": 4452260,
    "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/michaelsproul",
    "html_url": "https://github.com/michaelsproul",
    "followers_url": "https://api.github.com/users/michaelsproul/followers",
    "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
    "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
    "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
    "repos_url": "https://api.github.com/users/michaelsproul/repos",
    "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
    "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-09-20T01:45:58Z",
  "updated_at": "2023-10-04T11:10:57Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: v2.49.2 and v2.49.1\r\nChain/Network: Mainnet, and Gnosis chain\r\n\r\n#### Expected behaviour\r\n\r\nErigon's `getPayloadBodiesByRangeV1` should return the correct transaction bytes to the caller.\r\n\r\n#### Actual behaviour\r\n\r\nOn the Lighthouse issue tracker we've had several reports of Erigon producing incorrect data on the payload bodies endpoint. Lighthouse checks that payload bodies match their payload header (i.e. the transactions_root & withdrawals_root), and that check is sometimes failing.\r\n\r\nLH bug report with context is here: https://github.com/sigp/lighthouse/issues/4739\r\n\r\nRecently @xrchz ran the `getPayloadBodiesByRangeV1` query for a couple of blocks, showing exactly how Erigon's responses deviate from what is expected (I checked against Reth and Besu for comparison):\r\n\r\n- Data for block 0x1144c42: https://gist.github.com/michaelsproul/dd2a94f75e5f62fde761b70e4ad0293e\r\n- Data for block 0x115478a: https://gist.github.com/michaelsproul/f6f347bd6ce357e128580e5eedbaab7e\r\n\r\nI've seen this reported by 3 Lighthouse-Erigon users, on mainnet (x2) and Gnosis chain. I guess it could be caused by database corruption. Hopefully the bytes of the response are meaningful to an Erigon dev and it's just a simple encoding issue.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8245/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8245/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1727020389",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8245#issuecomment-1727020389",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8245",
    "id": 1727020389,
    "node_id": "IC_kwDOC0FsAM5m8D1l",
    "user": {
      "login": "xrchz",
      "id": 181254,
      "node_id": "MDQ6VXNlcjE4MTI1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/181254?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xrchz",
      "html_url": "https://github.com/xrchz",
      "followers_url": "https://api.github.com/users/xrchz/followers",
      "following_url": "https://api.github.com/users/xrchz/following{/other_user}",
      "gists_url": "https://api.github.com/users/xrchz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xrchz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xrchz/subscriptions",
      "organizations_url": "https://api.github.com/users/xrchz/orgs",
      "repos_url": "https://api.github.com/users/xrchz/repos",
      "events_url": "https://api.github.com/users/xrchz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xrchz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-20T06:00:11Z",
    "updated_at": "2023-09-20T06:00:11Z",
    "author_association": "NONE",
    "body": "> Recently @xrchz ran the `getPayloadBodiesByRangeV1` query for a couple of blocks, showing exactly how Erigon's responses deviate from what is expected\r\n\r\nIt was erigon 2.49.2 producing these\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1727020389/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1727024275",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8245#issuecomment-1727024275",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8245",
    "id": 1727024275,
    "node_id": "IC_kwDOC0FsAM5m8EyT",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-20T06:04:43Z",
    "updated_at": "2023-09-20T06:04:43Z",
    "author_association": "NONE",
    "body": "Thanks! Updated the description",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1727024275/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1746656057",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8245#issuecomment-1746656057",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8245",
    "id": 1746656057,
    "node_id": "IC_kwDOC0FsAM5oG9s5",
    "user": {
      "login": "xrchz",
      "id": 181254,
      "node_id": "MDQ6VXNlcjE4MTI1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/181254?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xrchz",
      "html_url": "https://github.com/xrchz",
      "followers_url": "https://api.github.com/users/xrchz/followers",
      "following_url": "https://api.github.com/users/xrchz/following{/other_user}",
      "gists_url": "https://api.github.com/users/xrchz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xrchz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xrchz/subscriptions",
      "organizations_url": "https://api.github.com/users/xrchz/orgs",
      "repos_url": "https://api.github.com/users/xrchz/repos",
      "events_url": "https://api.github.com/users/xrchz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xrchz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-04T11:10:56Z",
    "updated_at": "2023-10-04T11:10:56Z",
    "author_association": "NONE",
    "body": "Same error continues in erigon version 2.50.2\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1746656057/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
