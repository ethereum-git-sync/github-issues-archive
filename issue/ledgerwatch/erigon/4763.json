{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4763",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4763/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4763/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4763/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/4763",
  "id": 1310733544,
  "node_id": "I_kwDOC0FsAM5OIDTo",
  "number": 4763,
  "title": "Weird trace results",
  "user": {
    "login": "iFA88",
    "id": 18205395,
    "node_id": "MDQ6VXNlcjE4MjA1Mzk1",
    "avatar_url": "https://avatars.githubusercontent.com/u/18205395?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iFA88",
    "html_url": "https://github.com/iFA88",
    "followers_url": "https://api.github.com/users/iFA88/followers",
    "following_url": "https://api.github.com/users/iFA88/following{/other_user}",
    "gists_url": "https://api.github.com/users/iFA88/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iFA88/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iFA88/subscriptions",
    "organizations_url": "https://api.github.com/users/iFA88/orgs",
    "repos_url": "https://api.github.com/users/iFA88/repos",
    "events_url": "https://api.github.com/users/iFA88/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iFA88/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-07-20T09:24:00Z",
  "updated_at": "2022-10-08T09:10:41Z",
  "closed_at": "2022-10-08T09:10:41Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Hey, there is a very weird bug for `0x6ff499d3f1bb4ae0bb5e7e42c1664df4d906dde2797bd56d61f8521b930463ac` transaction on ROPSTEN.\r\nThe trace_block/trace_transaction gives back other call data as the debug_traceTransaction and both are others as what the etherscan gives back for trace.\r\nThere is a call during the main transaction, trace_block/trace_transactions says that `0x48628bcccb5cf118cbf3f29d04e02799c8d23ced` is called, debug_traceTransaction says `0x153dfef4355e823dcb0fcc76efe942befca86477` Etherscan says `0x6b7044de4b5100f235bf8d573b77a19d41c732a81`\r\nAnd when it was not enough, the transaction sender `0x153dfef4355e823dcb0fcc76efe942befca86477` balance has increased suddenly with `22640731969999249516` wei without any trace or CALL opcode for that address.\r\n\r\nErigon trace_block of the TX:\r\n```\r\n{\r\n\t\"action\": {\r\n\t\t\"from\": \"0x153dfef4355e823dcb0fcc76efe942befca86477\",\r\n\t\t\"callType\": \"call\",\r\n\t\t\"gas\": \"0x28e77\",\r\n\t\t\"input\": \"0x5d495aea\",\r\n\t\t\"to\": \"0x332815388934ca87c57ea33a3a0c16385bb18681\",\r\n\t\t\"value\": \"0x0\"\r\n\t},\r\n\t\"blockHash\": \"0xaa60e5d900373e757bfceb3aece99e93fb557d5c10689a1187cfb080c835d663\",\r\n\t\"blockNumber\": 12356606,\r\n\t\"result\": {\r\n\t\t\"gasUsed\": \"0x1c2fb\",\r\n\t\t\"output\": \"0x\"\r\n\t},\r\n\t\"subtraces\": 1,\r\n\t\"traceAddress\": [],\r\n\t\"transactionHash\": \"0x6ff499d3f1bb4ae0bb5e7e42c1664df4d906dde2797bd56d61f8521b930463ac\",\r\n\t\"transactionPosition\": 7,\r\n\t\"type\": \"call\"\r\n},\r\n{\r\n\t\"action\": {\r\n\t\t\"from\": \"0x332815388934ca87c57ea33a3a0c16385bb18681\",\r\n\t\t\"callType\": \"call\",\r\n\t\t\"gas\": \"0x8fc\",\r\n\t\t\"input\": \"0x\",\r\n\t\t\"to\": \"0x48628bcccb5cf118cbf3f29d04e02799c8d23ced\",\r\n\t\t\"value\": \"0x13a34fd8af79e8000\"\r\n\t},\r\n\t\"blockHash\": \"0xaa60e5d900373e757bfceb3aece99e93fb557d5c10689a1187cfb080c835d663\",\r\n\t\"blockNumber\": 12356606,\r\n\t\"result\": {\r\n\t\t\"gasUsed\": \"0x0\",\r\n\t\t\"output\": \"0x\"\r\n\t},\r\n\t\"subtraces\": 0,\r\n\t\"traceAddress\": [\r\n\t\t0\r\n\t],\r\n\t\"transactionHash\": \"0x6ff499d3f1bb4ae0bb5e7e42c1664df4d906dde2797bd56d61f8521b930463ac\",\r\n\t\"transactionPosition\": 7,\r\n\t\"type\": \"call\"\r\n},\r\n```\r\n\r\nErigon debug_traceTransaction of the TX which has only one CALL op code:\r\n```\r\n{\r\n\t\"pc\": 735,\r\n\t\"op\": \"CALL\",\r\n\t\"gas\": 120380,\r\n\t\"gasCost\": 9100,\r\n\t\"depth\": 1,\r\n\t\"stack\": [\r\n\t\t\"0x5d495aea\",\r\n\t\t\"0xde\",\r\n\t\t\"0xf\",\r\n\t\t\"0x153dfef4355e823dcb0fcc76efe942befca86477\",\r\n\t\t\"0x0\",\r\n\t\t\"0x13a34fd8af79e8000\",\r\n\t\t\"0x320\",\r\n\t\t\"0x0\",\r\n\t\t\"0x320\",\r\n\t\t\"0x0\",\r\n\t\t\"0x320\",\r\n\t\t\"0x13a34fd8af79e8000\",\r\n\t\t\"0x153dfef4355e823dcb0fcc76efe942befca86477\",\r\n\t\t\"0x0\"\r\n\t],\r\n\t\"memory\": [\r\n\t\t\"0000000000000000000000000000000000000000000000000000000000000001\",\r\n\t\t\"0000000000000000000000000000000000000000000000000000000000000000\",\r\n\t\t\"0000000000000000000000000000000000000000000000000000000000000320\",\r\n\t\t\"0000000000000000000000000000000000000000000000000000000000000000\",\r\n\t\t\"0000000000000000000000000000000000000000000000000000000000000280\",\r\n\t\t\"14c72f98d10d3b79e0eb8a1084218655cafaf7fa8dc0d2de7d9a92df7c844093\",\r\n\t\t\"0000000000000000000000000000000000000000000000000000000062a1e510\",\r\n\t\t\"000000000000000000000000153dfef4355e823dcb0fcc76efe942befca86477\",\r\n\t\t\"000000000000000000000000405fe24cd0985b4b24b11a53179881a22d03d3d8\",\r\n\t\t\"00000000000000000000000064e8b5db8918dcd7ef73dd5d7ecd3eef2d742506\",\r\n\t\t\"0000000000000000000000002dfba8cb6834bb9c99fca4572c963d699e7c00a0\",\r\n\t\t\"0000000000000000000000007ea3a94803ef554847d80ac57ef9dd57e6748755\",\r\n\t\t\"000000000000000000000000405fe24cd0985b4b24b11a53179881a22d03d3d8\",\r\n\t\t\"0000000000000000000000002dfba8cb6834bb9c99fca4572c963d699e7c00a0\",\r\n\t\t\"0000000000000000000000005aad8d60a89a5ecc7814e5f3bb4732a609446188\",\r\n\t\t\"0000000000000000000000006b7044de4b5100f235bf8d573b77a19d41c732a8\",\r\n\t\t\"00000000000000000000000034cd2d20d056abdaae4e9947e93a8a69ba138b7c\",\r\n\t\t\"000000000000000000000000405fe24cd0985b4b24b11a53179881a22d03d3d8\",\r\n\t\t\"00000000000000000000000024c62abb5afc34f6ed4a6f62cb9ab04bf722de99\",\r\n\t\t\"00000000000000000000000048628bcccb5cf118cbf3f29d04e02799c8d23ced\",\r\n\t\t\"0000000000000000000000004654ca21215b3dc0337e3bd8a808ad02b2694faf\",\r\n\t\t\"0000000000000000000000000b835691094a3e18b5749431863348d41c4e10d8\",\r\n\t\t\"000000000000000000000000153dfef4355e823dcb0fcc76efe942befca86477\",\r\n\t\t\"0000000000000000000000006b7044de4b5100f235bf8d573b77a19d41c732a8\",\r\n\t\t\"000000000000000000000000d4f9cf205a9d05bcae2f1a3fc6b395e9799efb5f\",\r\n\t\t\"14c72f98d10d3b79e0eb8a1084218655cafaf7fa8dc0d2de7d9a92df7c844093\",\r\n\t\t\"0000000000000000000000000000000000000000000000000000000062a1e510\",\r\n\t\t\"000000000000000000000000153dfef4355e823dcb0fcc76efe942befca86477\",\r\n\t\t\"000000000000000000000000405fe24cd0985b4b24b11a53179881a22d03d3d8\",\r\n\t\t\"00000000000000000000000064e8b5db8918dcd7ef73dd5d7ecd3eef2d742506\",\r\n\t\t\"0000000000000000000000002dfba8cb6834bb9c99fca4572c963d699e7c00a0\",\r\n\t\t\"0000000000000000000000007ea3a94803ef554847d80ac57ef9dd57e6748755\",\r\n\t\t\"000000000000000000000000405fe24cd0985b4b24b11a53179881a22d03d3d8\",\r\n\t\t\"0000000000000000000000002dfba8cb6834bb9c99fca4572c963d699e7c00a0\",\r\n\t\t\"0000000000000000000000005aad8d60a89a5ecc7814e5f3bb4732a609446188\",\r\n\t\t\"0000000000000000000000006b7044de4b5100f235bf8d573b77a19d41c732a8\",\r\n\t\t\"00000000000000000000000034cd2d20d056abdaae4e9947e93a8a69ba138b7c\",\r\n\t\t\"000000000000000000000000405fe24cd0985b4b24b11a53179881a22d03d3d8\",\r\n\t\t\"00000000000000000000000024c62abb5afc34f6ed4a6f62cb9ab04bf722de99\",\r\n\t\t\"00000000000000000000000048628bcccb5cf118cbf3f29d04e02799c8d23ced\",\r\n\t\t\"0000000000000000000000004654ca21215b3dc0337e3bd8a808ad02b2694faf\",\r\n\t\t\"0000000000000000000000000b835691094a3e18b5749431863348d41c4e10d8\",\r\n\t\t\"000000000000000000000000153dfef4355e823dcb0fcc76efe942befca86477\",\r\n\t\t\"0000000000000000000000006b7044de4b5100f235bf8d573b77a19d41c732a8\",\r\n\t\t\"000000000000000000000000d4f9cf205a9d05bcae2f1a3fc6b395e9799efb5f\",\r\n\t\t\"0000000000000000000000000000000000000000000000000000000000000000\"\r\n\t]\r\n},\r\n```\r\nEtherscan parity trace:\r\n```\r\n  {\r\n    \"action\": {\r\n      \"from\": \"0x153dfef4355e823dcb0fcc76efe942befca86477\",\r\n      \"callType\": \"call\",\r\n      \"gas\": \"0x28e77\",\r\n      \"input\": \"0x5d495aea\",\r\n      \"to\": \"0x332815388934ca87c57ea33a3a0c16385bb18681\",\r\n      \"value\": \"0x0\"\r\n    },\r\n    \"blockHash\": \"0x7b255fb66fdb4b9de1d2355d8a45918105036f80a9a788d43622277166f917b3\",\r\n    \"blockNumber\": 12352593,\r\n    \"result\": {\r\n      \"gasUsed\": \"0x1c2fb\",\r\n      \"output\": \"0x\"\r\n    },\r\n    \"subtraces\": 1,\r\n    \"traceAddress\": [],\r\n    \"transactionHash\": \"0x6ff499d3f1bb4ae0bb5e7e42c1664df4d906dde2797bd56d61f8521b930463ac\",\r\n    \"transactionPosition\": 39,\r\n    \"type\": \"call\"\r\n  },\r\n  {\r\n    \"action\": {\r\n      \"from\": \"0x332815388934ca87c57ea33a3a0c16385bb18681\",\r\n      \"callType\": \"call\",\r\n      \"gas\": \"0x8fc\",\r\n      \"input\": \"0x\",\r\n      \"to\": \"0x6b7044de4b5100f235bf8d573b77a19d41c732a8\",\r\n      \"value\": \"0xc7057784a3e08000\"\r\n    },\r\n    \"blockHash\": \"0x7b255fb66fdb4b9de1d2355d8a45918105036f80a9a788d43622277166f917b3\",\r\n    \"blockNumber\": 12352593,\r\n    \"result\": {\r\n      \"gasUsed\": \"0x0\",\r\n      \"output\": \"0x\"\r\n    },\r\n    \"subtraces\": 0,\r\n    \"traceAddress\": [\r\n      0\r\n    ],\r\n    \"transactionHash\": \"0x6ff499d3f1bb4ae0bb5e7e42c1664df4d906dde2797bd56d61f8521b930463ac\",\r\n    \"transactionPosition\": 39,\r\n    \"type\": \"call\"\r\n  }\r\n```",
  "closed_by": {
    "login": "iFA88",
    "id": 18205395,
    "node_id": "MDQ6VXNlcjE4MjA1Mzk1",
    "avatar_url": "https://avatars.githubusercontent.com/u/18205395?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iFA88",
    "html_url": "https://github.com/iFA88",
    "followers_url": "https://api.github.com/users/iFA88/followers",
    "following_url": "https://api.github.com/users/iFA88/following{/other_user}",
    "gists_url": "https://api.github.com/users/iFA88/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iFA88/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iFA88/subscriptions",
    "organizations_url": "https://api.github.com/users/iFA88/orgs",
    "repos_url": "https://api.github.com/users/iFA88/repos",
    "events_url": "https://api.github.com/users/iFA88/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iFA88/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4763/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4763/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1208272501",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4763#issuecomment-1208272501",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4763",
    "id": 1208272501,
    "node_id": "IC_kwDOC0FsAM5IBMZ1",
    "user": {
      "login": "iFA88",
      "id": 18205395,
      "node_id": "MDQ6VXNlcjE4MjA1Mzk1",
      "avatar_url": "https://avatars.githubusercontent.com/u/18205395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iFA88",
      "html_url": "https://github.com/iFA88",
      "followers_url": "https://api.github.com/users/iFA88/followers",
      "following_url": "https://api.github.com/users/iFA88/following{/other_user}",
      "gists_url": "https://api.github.com/users/iFA88/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iFA88/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iFA88/subscriptions",
      "organizations_url": "https://api.github.com/users/iFA88/orgs",
      "repos_url": "https://api.github.com/users/iFA88/repos",
      "events_url": "https://api.github.com/users/iFA88/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iFA88/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-08T15:23:59Z",
    "updated_at": "2022-08-08T15:23:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "A new one for Ropsten block ``12350770` for `0xb990afe2760da94daa58152bd51f52db00972ae646708e1bb9ff20ef01b6b9f2` tx.\r\n`debug_traceTransaction` result: https://gist.github.com/iFA88/26cc25fadbe77dcde283e95bd8df8bb7\r\n`trace_transaction` result: https://gist.github.com/iFA88/4f85fa574bb66db319222bc4f5c0917a\r\nI THINK during replaying the TX with the `trace_transaction` the DIFFICULTY op code gives 0 back and not like during `debug_traceTransaction`",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1208272501/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1272273570",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4763#issuecomment-1272273570",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4763",
    "id": 1272273570,
    "node_id": "IC_kwDOC0FsAM5L1Vqi",
    "user": {
      "login": "iFA88",
      "id": 18205395,
      "node_id": "MDQ6VXNlcjE4MjA1Mzk1",
      "avatar_url": "https://avatars.githubusercontent.com/u/18205395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iFA88",
      "html_url": "https://github.com/iFA88",
      "followers_url": "https://api.github.com/users/iFA88/followers",
      "following_url": "https://api.github.com/users/iFA88/following{/other_user}",
      "gists_url": "https://api.github.com/users/iFA88/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iFA88/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iFA88/subscriptions",
      "organizations_url": "https://api.github.com/users/iFA88/orgs",
      "repos_url": "https://api.github.com/users/iFA88/repos",
      "events_url": "https://api.github.com/users/iFA88/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iFA88/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-08T09:10:41Z",
    "updated_at": "2022-10-08T09:10:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "I close this issue, because it has been fixed.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1272273570/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
