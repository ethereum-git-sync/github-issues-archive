{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/339",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/339/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/339/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/339/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/339",
  "id": 556727081,
  "node_id": "MDU6SXNzdWU1NTY3MjcwODE=",
  "number": 339,
  "title": "Can we enforce static jumps and subroutines by simple heuristics?",
  "user": {
    "login": "AlexeyAkhunov",
    "id": 13686139,
    "node_id": "MDQ6VXNlcjEzNjg2MTM5",
    "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AlexeyAkhunov",
    "html_url": "https://github.com/AlexeyAkhunov",
    "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
    "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
    "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
    "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
    "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "suhabe",
    "id": 613706,
    "node_id": "MDQ6VXNlcjYxMzcwNg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/613706?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/suhabe",
    "html_url": "https://github.com/suhabe",
    "followers_url": "https://api.github.com/users/suhabe/followers",
    "following_url": "https://api.github.com/users/suhabe/following{/other_user}",
    "gists_url": "https://api.github.com/users/suhabe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/suhabe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/suhabe/subscriptions",
    "organizations_url": "https://api.github.com/users/suhabe/orgs",
    "repos_url": "https://api.github.com/users/suhabe/repos",
    "events_url": "https://api.github.com/users/suhabe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/suhabe/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "suhabe",
      "id": 613706,
      "node_id": "MDQ6VXNlcjYxMzcwNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/613706?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/suhabe",
      "html_url": "https://github.com/suhabe",
      "followers_url": "https://api.github.com/users/suhabe/followers",
      "following_url": "https://api.github.com/users/suhabe/following{/other_user}",
      "gists_url": "https://api.github.com/users/suhabe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/suhabe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/suhabe/subscriptions",
      "organizations_url": "https://api.github.com/users/suhabe/orgs",
      "repos_url": "https://api.github.com/users/suhabe/repos",
      "events_url": "https://api.github.com/users/suhabe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/suhabe/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2020-01-29T09:06:45Z",
  "updated_at": "2021-03-05T19:57:59Z",
  "closed_at": "2021-03-05T19:57:59Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "We would like to check the hypothesis that most (or perhaps all) smart contracts deployed on the mainnet can be \"statically\" analysed to compute, for each jump instruction, very small number of static destinations. It is my belief that developers do not really use the \"computation of the jump destination\" a lot, if at all. At the moment i can think of 3 heuristics which could cover most of the cases:\r\n1. Obvious static jump. It is a sequence of `PUSHn <destination>` and `JUMP/JUMPI`\r\n2. Subroutine pattern. Since EVM does not support subroutines, the generated code emulates them, by doing `PUSHn <return_destinantion>`, then executing the subroutine inline (or jumping to it), making sure that at the end, the `return destination` is at the top of the stack. Then, as a return from the subroutine, `JUMP/JUMPI` is used. We can analyse this by tracking the jump destination \"backwards\" from `JUMP/JUMPI` and proving that it can always take one of the limited set of values that are known up-front (these values correspond to each place where the subroutine is called).\r\n3. Invalid jumps. I believe that before the special `INVALID` opcode was introduced, jumps to some obviously wrong destinations were used to abort transactions. For example, if a program is compiled with Solidity, it is known that destination `02` is an invalid destination, because all compiled solidity programs started with `PUSH x PUSH y MSTORE`, so no `JUMPDEST`\r\n\r\nThe result of this research should be the answer to the question on how many contracts cannot be covered by these heuristics, or new heuristic(s) that would cover those. If we can cover all existing contracts, and the heuristics can be implemented efficiently, we can announce a hard-fork after which all contracts will be validated on deployment, and if they are not valid according to those heuristics, they will not deploy.",
  "closed_by": {
    "login": "AlexeyAkhunov",
    "id": 13686139,
    "node_id": "MDQ6VXNlcjEzNjg2MTM5",
    "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AlexeyAkhunov",
    "html_url": "https://github.com/AlexeyAkhunov",
    "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
    "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
    "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
    "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
    "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/339/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/339/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/581621567",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/339#issuecomment-581621567",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/339",
    "id": 581621567,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MTYyMTU2Nw==",
    "user": {
      "login": "gacolvin",
      "id": 52142134,
      "node_id": "MDQ6VXNlcjUyMTQyMTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/52142134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gacolvin",
      "html_url": "https://github.com/gacolvin",
      "followers_url": "https://api.github.com/users/gacolvin/followers",
      "following_url": "https://api.github.com/users/gacolvin/following{/other_user}",
      "gists_url": "https://api.github.com/users/gacolvin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gacolvin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gacolvin/subscriptions",
      "organizations_url": "https://api.github.com/users/gacolvin/orgs",
      "repos_url": "https://api.github.com/users/gacolvin/repos",
      "events_url": "https://api.github.com/users/gacolvin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gacolvin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-03T21:15:24Z",
    "updated_at": "2020-02-03T21:15:24Z",
    "author_association": "NONE",
    "body": "I doubt the answer is yes, but the data will still be interesting.  Don't forget that code can beget new code, so you have to be sure that no such code will be misbegotten.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/581621567/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
