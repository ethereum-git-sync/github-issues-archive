{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/2705",
  "id": 1000595678,
  "node_id": "I_kwDOC0FsAM47o-De",
  "number": 2705,
  "title": "MDBX_UNABLE_EXTEND_MAPSIZE: Database engine was unable to extend mapping (On windows)",
  "user": {
    "login": "mtbitcoin",
    "id": 8327464,
    "node_id": "MDQ6VXNlcjgzMjc0NjQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8327464?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mtbitcoin",
    "html_url": "https://github.com/mtbitcoin",
    "followers_url": "https://api.github.com/users/mtbitcoin/followers",
    "following_url": "https://api.github.com/users/mtbitcoin/following{/other_user}",
    "gists_url": "https://api.github.com/users/mtbitcoin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mtbitcoin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mtbitcoin/subscriptions",
    "organizations_url": "https://api.github.com/users/mtbitcoin/orgs",
    "repos_url": "https://api.github.com/users/mtbitcoin/repos",
    "events_url": "https://api.github.com/users/mtbitcoin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mtbitcoin/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 17,
  "created_at": "2021-09-20T05:52:32Z",
  "updated_at": "2021-10-05T05:15:25Z",
  "closed_at": "2021-10-05T05:15:25Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Erigon version: v2021.09.03-alpha_5c377a4.\r\nOS & Version: Windows Server 2019\r\n\r\nRPCDaemon command line : \r\nrpcdaemon --datadir mainnet --http.api=eth,debug,net,web3,trace --http.port 8546 --http.addr 0.0.0.0 --http.corsdomain \"*\" --http.vhosts \"*\"\r\n\r\n\r\nThis issue appears to affect the windows builds when running rpcdaemon with shared memory access (--datadir mainnet ). Both erigon and rpcdaemon is on the same machine. After running it for a couple hours, will eventually run into the below errors. Restarting the rpcdaemon fixes the issue until it happens again after a couple of hours.\r\n\r\nThe erigon client appears unaffected. The issue affect the rpcdaemon \r\n\r\n\r\n\r\n-Error log snippet-\r\n\r\nWARN[09-20|03:12:21.497] Served                                   conn=x.x.x.x:35224 method=debug_traceTransaction reqid=0 t=0s err=\"mdbx_txn_begin: MDBX_UNABLE_EXTEND_MAPSIZE: Database engine was unable to extend mapping, e.g. since address space is unavailable or busy, or Operation system not supported such operations, label: chaindata, trace: [github.com/ledgerwatch/erigon-lib/kv/mdbx.(*MdbxKV).BeginRo github.com/ledgerwatch/erigon/cmd/rpcdaemon/commands.(*PrivateDebugAPIImpl).TraceTransaction reflect.Value.call reflect.Value.Call github.com/ledgerwatch/erigon/rpc.(*callback).call github.com/ledgerwatch/erigon/rpc.(*handler).runMethod github.com/ledgerwatch/erigon/rpc.(*handler).handleCall github.com/ledgerwatch/erigon/rpc.(*handler).handleCallMsg github.com/ledgerwatch/erigon/rpc.(*handler).handleMsg.func1 github.com/ledgerwatch/erigon/rpc.(*handler).startCallProc.func1]\"\r\nWARN[09-20|03:12:30.619] Served                                   conn=127.0.0.1:1299 method=eth_blockNumber reqid=83 t=0s err=\"mdbx_txn_begin: MDBX_UNABLE_EXTEND_MAPSIZE: Database engine was unable to extend mapping, e.g. since address space is unavailable or busy, or Operation system not supported such operations, label: chaindata, trace: [github.com/ledgerwatch/erigon-lib/kv/mdbx.(*MdbxKV).BeginRo github.com/ledgerwatch/erigon/cmd/rpcdaemon/commands.(*APIImpl).BlockNumber reflect.Value.call reflect.Value.Call github.com/ledgerwatch/erigon/rpc.(*callback).call github.com/ledgerwatch/erigon/rpc.(*handler).runMethod github.com/ledgerwatch/erigon/rpc.(*handler).handleCall github.com/ledgerwatch/erigon/rpc.(*handler).handleCallMsg github.com/ledgerwatch/erigon/rpc.(*handler).handleMsg.func1 github.com/ledgerwatch/erigon/rpc.(*handler).startCallProc.func1]\"\r\nWARN[09-20|03:12:37.130] Served                                   conn=x.x.x.x:35224 method=debug_traceTransaction reqid=0 t=0s err=\"mdbx_txn_begin: MDBX_UNABLE_EXTEND_MAPSIZE: Database engine was unable to extend mapping, e.g. since address space is unavailable or busy, or Operation system not supported such operations, label: chaindata, trace: [github.com/ledgerwatch/erigon-lib/kv/mdbx.(*MdbxKV).BeginRo github.com/ledgerwatch/erigon/cmd/rpcdaemon/commands.(*PrivateDebugAPIImpl).TraceTransaction reflect.Value.call reflect.Value.Call github.com/ledgerwatch/erigon/rpc.(*callback).call github.com/ledgerwatch/erigon/rpc.(*handler).runMethod github.com/ledgerwatch/erigon/rpc.(*handler).handleCall github.com/ledgerwatch/erigon/rpc.(*handler).handleCallMsg github.com/ledgerwatch/erigon/rpc.(*handler).handleMsg.func1 github.com/ledgerwatch/erigon/rpc.(*handler).startCallProc.func1]\"\r\n",
  "closed_by": {
    "login": "AskAlexSharov",
    "id": 46885206,
    "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AskAlexSharov",
    "html_url": "https://github.com/AskAlexSharov",
    "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
    "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
    "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
    "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
    "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705/reactions",
    "total_count": 1,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 1
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/922674420",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2705#issuecomment-922674420",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
    "id": 922674420,
    "node_id": "IC_kwDOC0FsAM42_uT0",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-20T06:52:52Z",
    "updated_at": "2021-09-20T06:52:52Z",
    "author_association": "COLLABORATOR",
    "body": "Hi. Show “du -ha <datadir>“",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/922674420/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/922924568",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2705#issuecomment-922924568",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
    "id": 922924568,
    "node_id": "IC_kwDOC0FsAM43ArYY",
    "user": {
      "login": "mtbitcoin",
      "id": 8327464,
      "node_id": "MDQ6VXNlcjgzMjc0NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8327464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mtbitcoin",
      "html_url": "https://github.com/mtbitcoin",
      "followers_url": "https://api.github.com/users/mtbitcoin/followers",
      "following_url": "https://api.github.com/users/mtbitcoin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mtbitcoin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mtbitcoin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mtbitcoin/subscriptions",
      "organizations_url": "https://api.github.com/users/mtbitcoin/orgs",
      "repos_url": "https://api.github.com/users/mtbitcoin/repos",
      "events_url": "https://api.github.com/users/mtbitcoin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mtbitcoin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-20T13:23:33Z",
    "updated_at": "2021-09-20T13:23:33Z",
    "author_association": "NONE",
    "body": "This is a window machine. So du does not work. I've attached a screen cap of the disk utilization\r\n\r\n![image](https://user-images.githubusercontent.com/8327464/134009775-9dacd1bf-8f62-4f05-b818-eaded0d27d40.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/922924568/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923002225",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2705#issuecomment-923002225",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
    "id": 923002225,
    "node_id": "IC_kwDOC0FsAM43A-Vx",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-20T14:54:02Z",
    "updated_at": "2021-09-20T14:54:02Z",
    "author_association": "COLLABORATOR",
    "body": "@mtbitcoin no space left on disk? ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923002225/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923051432",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2705#issuecomment-923051432",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
    "id": 923051432,
    "node_id": "IC_kwDOC0FsAM43BKWo",
    "user": {
      "login": "mtbitcoin",
      "id": 8327464,
      "node_id": "MDQ6VXNlcjgzMjc0NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8327464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mtbitcoin",
      "html_url": "https://github.com/mtbitcoin",
      "followers_url": "https://api.github.com/users/mtbitcoin/followers",
      "following_url": "https://api.github.com/users/mtbitcoin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mtbitcoin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mtbitcoin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mtbitcoin/subscriptions",
      "organizations_url": "https://api.github.com/users/mtbitcoin/orgs",
      "repos_url": "https://api.github.com/users/mtbitcoin/repos",
      "events_url": "https://api.github.com/users/mtbitcoin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mtbitcoin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-20T15:48:42Z",
    "updated_at": "2021-09-21T04:49:25Z",
    "author_association": "NONE",
    "body": "Around 2tb of disk space left. Googling for similar issues on MDBX_UNABLE_EXTEND_MAPSIZE and windows\r\n\r\ndid a search, looks like its similar to https://github.com/erthink/libmdbx/issues/98 ?\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923051432/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923776665",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2705#issuecomment-923776665",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
    "id": 923776665,
    "node_id": "IC_kwDOC0FsAM43D7aZ",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-21T08:57:13Z",
    "updated_at": "2021-09-21T08:57:13Z",
    "author_association": "COLLABORATOR",
    "body": "I don’t know. You have free space, your db is 1.5Tb (with 2Tb limit and 2Gb growth step). No reason to get MDBX_UNABLE_EXTEND_MAPSIZE. \r\n\r\nWhat is “nodes” folder size?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923776665/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923789680",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2705#issuecomment-923789680",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
    "id": 923789680,
    "node_id": "IC_kwDOC0FsAM43D-lw",
    "user": {
      "login": "mtbitcoin",
      "id": 8327464,
      "node_id": "MDQ6VXNlcjgzMjc0NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8327464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mtbitcoin",
      "html_url": "https://github.com/mtbitcoin",
      "followers_url": "https://api.github.com/users/mtbitcoin/followers",
      "following_url": "https://api.github.com/users/mtbitcoin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mtbitcoin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mtbitcoin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mtbitcoin/subscriptions",
      "organizations_url": "https://api.github.com/users/mtbitcoin/orgs",
      "repos_url": "https://api.github.com/users/mtbitcoin/repos",
      "events_url": "https://api.github.com/users/mtbitcoin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mtbitcoin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-21T09:13:24Z",
    "updated_at": "2021-09-21T09:13:24Z",
    "author_association": "NONE",
    "body": "> I don’t know. You have free space, your db is 1.5Tb (with 2Tb limit and 2Gb growth step). No reason to get MDBX_UNABLE_EXTEND_MAPSIZE.\r\n> \r\n> What is “nodes” folder size?\r\n\r\n513 MB\r\n![image](https://user-images.githubusercontent.com/8327464/134144708-1a62ba17-2162-495d-af9e-2d4abfe2229d.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923789680/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923800400",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2705#issuecomment-923800400",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
    "id": 923800400,
    "node_id": "IC_kwDOC0FsAM43EBNQ",
    "user": {
      "login": "AndreaLanfranchi",
      "id": 15280851,
      "node_id": "MDQ6VXNlcjE1MjgwODUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/15280851?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AndreaLanfranchi",
      "html_url": "https://github.com/AndreaLanfranchi",
      "followers_url": "https://api.github.com/users/AndreaLanfranchi/followers",
      "following_url": "https://api.github.com/users/AndreaLanfranchi/following{/other_user}",
      "gists_url": "https://api.github.com/users/AndreaLanfranchi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AndreaLanfranchi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AndreaLanfranchi/subscriptions",
      "organizations_url": "https://api.github.com/users/AndreaLanfranchi/orgs",
      "repos_url": "https://api.github.com/users/AndreaLanfranchi/repos",
      "events_url": "https://api.github.com/users/AndreaLanfranchi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AndreaLanfranchi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-21T09:27:12Z",
    "updated_at": "2021-09-21T09:27:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "@AskAlexSharov I believe **on Windows** this should be expected. As we know from LMDB experience there's a 1:1 relation amongst map_size and file_size on windows. And actually MDBX makes no difference: it simply \"hides\" the problem using its geometry increase logic. On Windows the only way possible to extend the data file is to unmap it, resize it, and eventually remap it but as the db is opened by two distinct processes (erigon and rpcdaemon) there might be issues releasing the locks on file.\r\n\r\nI suspect that actually is erigon asking for more space but don't understand why the logs about the error are printed by rpcdaemon.\r\n\r\nMaybe we could start digging from [here](https://github.com/erthink/libmdbx/blob/99b75b5004047d8792973501d8eb7ef49df9a5da/src/osal.c#L1594-L1613)\r\n\r\n@mtbitcoin can you please try run rpcdaemon for a long batch **without** `--datadir` command line option ?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923800400/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923803985",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2705#issuecomment-923803985",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
    "id": 923803985,
    "node_id": "IC_kwDOC0FsAM43ECFR",
    "user": {
      "login": "mtbitcoin",
      "id": 8327464,
      "node_id": "MDQ6VXNlcjgzMjc0NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8327464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mtbitcoin",
      "html_url": "https://github.com/mtbitcoin",
      "followers_url": "https://api.github.com/users/mtbitcoin/followers",
      "following_url": "https://api.github.com/users/mtbitcoin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mtbitcoin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mtbitcoin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mtbitcoin/subscriptions",
      "organizations_url": "https://api.github.com/users/mtbitcoin/orgs",
      "repos_url": "https://api.github.com/users/mtbitcoin/repos",
      "events_url": "https://api.github.com/users/mtbitcoin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mtbitcoin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-21T09:31:49Z",
    "updated_at": "2021-09-21T09:31:49Z",
    "author_association": "NONE",
    "body": "> @AskAlexSharov I believe **on Windows** this should be expected. As we know from LMDB experience there's a 1:1 relation amongst map_size and file_size on windows. And actually MDBX makes no difference: it simply \"hides\" the problem using its geometry increase logic. On Windows the only way possible to extend the data file is to unmap it, resize it, and eventually remap it but as the db is opened by two distinct processes (erigon and rpcdaemon) there might be issues releasing the locks on file.\r\n> \r\n> I suspect that actually is erigon asking for more space but don't understand why the logs about the error are printed by rpcdaemon.\r\n> \r\n> Maybe we could start digging from [here](https://github.com/erthink/libmdbx/blob/99b75b5004047d8792973501d8eb7ef49df9a5da/src/osal.c#L1594-L1613)\r\n> \r\n> @mtbitcoin can you please try run rpcdaemon for a long batch **without** `--datadir` command line option ?\r\n\r\n**Without**  \"--datadir\" it works fine, albeit at a lower RPC performance (not as fast). Also, no issue on ubuntu. So this only appears when\r\n1. using --datadir with rpcdaemon\r\n2. running on windows",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923803985/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923810876",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2705#issuecomment-923810876",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
    "id": 923810876,
    "node_id": "IC_kwDOC0FsAM43EDw8",
    "user": {
      "login": "AndreaLanfranchi",
      "id": 15280851,
      "node_id": "MDQ6VXNlcjE1MjgwODUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/15280851?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AndreaLanfranchi",
      "html_url": "https://github.com/AndreaLanfranchi",
      "followers_url": "https://api.github.com/users/AndreaLanfranchi/followers",
      "following_url": "https://api.github.com/users/AndreaLanfranchi/following{/other_user}",
      "gists_url": "https://api.github.com/users/AndreaLanfranchi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AndreaLanfranchi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AndreaLanfranchi/subscriptions",
      "organizations_url": "https://api.github.com/users/AndreaLanfranchi/orgs",
      "repos_url": "https://api.github.com/users/AndreaLanfranchi/repos",
      "events_url": "https://api.github.com/users/AndreaLanfranchi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AndreaLanfranchi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-21T09:41:15Z",
    "updated_at": "2021-09-21T09:41:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "> **Without** \"--datadir\" it works fine, albeit at a lower RPC performance (not as fast). Also, no issue on ubuntu. So this only appears when\r\n> \r\n> 1. using --datadir with rpcdaemon\r\n> 2. running on windows\r\n\r\nYes ... as I mentioned before this specific issue **only** affects windows due to differences about how the NT kernel memory maps files. Unfortunately this creates strong limitations on achieving best performances on Windows (besides we [have also other kind of issues on Windows in the related project Silkworm](https://github.com/torquem-ch/silkworm#windows) which is erigon's implementation in C++). Also you might enjoy [this comment](https://github.com/erthink/libmdbx/blob/a5e10b4ea1e3ae80b521c9100c0f58616cfd9034/src/lck-windows.c#L17-L21) from MDBX authors.\r\n\r\nIf max rpcdaemon performance is what is you're aiming to I definitely suggest to stick to Linux.\r\n(we might find solutions in the future though)",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923810876/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923815420",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2705#issuecomment-923815420",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
    "id": 923815420,
    "node_id": "IC_kwDOC0FsAM43EE38",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-21T09:47:42Z",
    "updated_at": "2021-09-21T09:47:42Z",
    "author_association": "COLLABORATOR",
    "body": "> 513 MB\r\n\r\nthis is too much, maybe problem coming from there. show what is inside and what sizes of folders there. \r\nthen try to remove this (nodes) folder and see if it helped you.  ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923815420/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923968545",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2705#issuecomment-923968545",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
    "id": 923968545,
    "node_id": "IC_kwDOC0FsAM43EqQh",
    "user": {
      "login": "mtbitcoin",
      "id": 8327464,
      "node_id": "MDQ6VXNlcjgzMjc0NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8327464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mtbitcoin",
      "html_url": "https://github.com/mtbitcoin",
      "followers_url": "https://api.github.com/users/mtbitcoin/followers",
      "following_url": "https://api.github.com/users/mtbitcoin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mtbitcoin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mtbitcoin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mtbitcoin/subscriptions",
      "organizations_url": "https://api.github.com/users/mtbitcoin/orgs",
      "repos_url": "https://api.github.com/users/mtbitcoin/repos",
      "events_url": "https://api.github.com/users/mtbitcoin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mtbitcoin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-21T13:05:23Z",
    "updated_at": "2021-09-21T13:05:23Z",
    "author_association": "NONE",
    "body": "> > 513 MB\r\n> \r\n> this is too much, maybe problem coming from there. show what is inside and what sizes of folders there.\r\n> then try to remove this (nodes) folder and see if it helped you.\r\n\r\nUnder (nodes) folder\r\n--------------------\r\neth65 (2 files) ~256mb\r\neth66 (2 files) ~256mb\r\n\r\nI don't think they are related to to how large these folders are, because just restarting the RPC daemon (without needing to restart erigon) works for a couple of hours again before running into the same errors again later.  \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/923968545/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/924525181",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2705#issuecomment-924525181",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
    "id": 924525181,
    "node_id": "IC_kwDOC0FsAM43GyJ9",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-22T02:12:36Z",
    "updated_at": "2021-09-22T02:12:36Z",
    "author_association": "COLLABORATOR",
    "body": "“ I don't think they are related ” - they have low maximum limit, and maybe you touched it. Try remove them and see if it helps. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/924525181/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/924756589",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2705#issuecomment-924756589",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
    "id": 924756589,
    "node_id": "IC_kwDOC0FsAM43Hqpt",
    "user": {
      "login": "mtbitcoin",
      "id": 8327464,
      "node_id": "MDQ6VXNlcjgzMjc0NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8327464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mtbitcoin",
      "html_url": "https://github.com/mtbitcoin",
      "followers_url": "https://api.github.com/users/mtbitcoin/followers",
      "following_url": "https://api.github.com/users/mtbitcoin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mtbitcoin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mtbitcoin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mtbitcoin/subscriptions",
      "organizations_url": "https://api.github.com/users/mtbitcoin/orgs",
      "repos_url": "https://api.github.com/users/mtbitcoin/repos",
      "events_url": "https://api.github.com/users/mtbitcoin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mtbitcoin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-22T09:38:08Z",
    "updated_at": "2021-09-22T09:39:08Z",
    "author_association": "NONE",
    "body": "1. Stopped both erigon and rpcdaemon\r\n2. Removed the Nodes folder\r\n3. Restarted both erigon and rpcdaemon\r\n4. Nodes folder eventually builds back up the same size (513Mb)  previous and files\r\n5. Does not help, issue is still there",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/924756589/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/925468773",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2705#issuecomment-925468773",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
    "id": 925468773,
    "node_id": "IC_kwDOC0FsAM43KYhl",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-23T02:49:12Z",
    "updated_at": "2021-09-23T02:49:12Z",
    "author_association": "COLLABORATOR",
    "body": "Does \"remove --datadir from rpcdaemon on windows\" ok for you?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/925468773/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/925478417",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2705#issuecomment-925478417",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
    "id": 925478417,
    "node_id": "IC_kwDOC0FsAM43Ka4R",
    "user": {
      "login": "mtbitcoin",
      "id": 8327464,
      "node_id": "MDQ6VXNlcjgzMjc0NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8327464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mtbitcoin",
      "html_url": "https://github.com/mtbitcoin",
      "followers_url": "https://api.github.com/users/mtbitcoin/followers",
      "following_url": "https://api.github.com/users/mtbitcoin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mtbitcoin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mtbitcoin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mtbitcoin/subscriptions",
      "organizations_url": "https://api.github.com/users/mtbitcoin/orgs",
      "repos_url": "https://api.github.com/users/mtbitcoin/repos",
      "events_url": "https://api.github.com/users/mtbitcoin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mtbitcoin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-23T03:17:52Z",
    "updated_at": "2021-09-23T03:17:52Z",
    "author_association": "NONE",
    "body": "> Does \"remove --datadir from rpcdaemon on windows\" ok for you?\r\n\r\nYes, as shared above running it with out the “—datadir” works but that sacrifices  rpc performance ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/925478417/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/926289314",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2705#issuecomment-926289314",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
    "id": 926289314,
    "node_id": "IC_kwDOC0FsAM43Ng2i",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-24T02:08:26Z",
    "updated_at": "2021-09-24T02:08:26Z",
    "author_association": "COLLABORATOR",
    "body": "Then probably we just must recommend this way on Win. (Performance of remote rpc-daemon will get better - we will have caching - we working on some pre-requirements for it).",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/926289314/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/934071928",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2705#issuecomment-934071928",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2705",
    "id": 934071928,
    "node_id": "IC_kwDOC0FsAM43rM54",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-05T05:15:25Z",
    "updated_at": "2021-10-05T05:15:25Z",
    "author_association": "COLLABORATOR",
    "body": "closing for now - as no better solution yet",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/934071928/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
