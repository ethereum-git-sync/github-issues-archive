{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2499",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2499/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2499/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2499/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/2499",
  "id": 963284344,
  "node_id": "MDU6SXNzdWU5NjMyODQzNDQ=",
  "number": 2499,
  "title": "\"unexpected RLP kind: Byte\" when broadcasting EIP-1559 txs",
  "user": {
    "login": "banteg",
    "id": 4562643,
    "node_id": "MDQ6VXNlcjQ1NjI2NDM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4562643?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/banteg",
    "html_url": "https://github.com/banteg",
    "followers_url": "https://api.github.com/users/banteg/followers",
    "following_url": "https://api.github.com/users/banteg/following{/other_user}",
    "gists_url": "https://api.github.com/users/banteg/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/banteg/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/banteg/subscriptions",
    "organizations_url": "https://api.github.com/users/banteg/orgs",
    "repos_url": "https://api.github.com/users/banteg/repos",
    "events_url": "https://api.github.com/users/banteg/events{/privacy}",
    "received_events_url": "https://api.github.com/users/banteg/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-08-07T18:50:16Z",
  "updated_at": "2021-08-08T17:12:32Z",
  "closed_at": "2021-08-08T17:12:32Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: 2021.08.1-alpha\r\n\r\nOS & Version: Linux\r\n\r\nCommit hash : \r\n\r\n#### Expected behaviour\r\n\r\nCalling `eth_sendRawTransaction` with a valid payload of type 2 transaction should broadcast a transaction.\r\n\r\nI successfully sent the same payload via Geth.\r\n\r\n#### Actual behaviour\r\n\r\n```python\r\nMethod: eth_sendRawTransaction Params: ('0x[redacted]',)\r\nMethod: eth_sendRawTransaction, Response: {'jsonrpc': '2.0', 'id': 10, 'error': {'code': -32000, 'message': 'unexpected RLP kind: Byte'}}\r\n```\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\n1. Create a raw EIP-1559 transaction, e.g. with eth-account.\r\n2. Try sending it via Erigon\r\n3. Observe the RLP error\r\n\r\nIf it helps, it seems the new tx type does not conform to the standard RLP encoding, e.g. this can be seen in Python:\r\n```python\r\n>>> from eth_account import Account\r\n>>> import rlp\r\n>>> from eth_account._utils.typed_transactions import DynamicFeeTransaction\r\n>>> user = Account.create()\r\n>>> tx = user.sign_transaction({'from': acc.address, 'gas': 21000, 'nonce': 0, 'maxFeePerGas': 1, 'maxPriorityFeePerGas':\r\n 1, 'type': 2}).rawTransaction\r\n>>> rlp.decode(tx)\r\nDecodingError: RLP string ends with 80 superfluous bytes\r\n>>>  DynamicFeeTransaction.from_bytes(tx).as_dict()\r\nthis works\r\n```",
  "closed_by": {
    "login": "banteg",
    "id": 4562643,
    "node_id": "MDQ6VXNlcjQ1NjI2NDM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4562643?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/banteg",
    "html_url": "https://github.com/banteg",
    "followers_url": "https://api.github.com/users/banteg/followers",
    "following_url": "https://api.github.com/users/banteg/following{/other_user}",
    "gists_url": "https://api.github.com/users/banteg/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/banteg/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/banteg/subscriptions",
    "organizations_url": "https://api.github.com/users/banteg/orgs",
    "repos_url": "https://api.github.com/users/banteg/repos",
    "events_url": "https://api.github.com/users/banteg/events{/privacy}",
    "received_events_url": "https://api.github.com/users/banteg/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2499/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2499/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/894734857",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2499#issuecomment-894734857",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2499",
    "id": 894734857,
    "node_id": "IC_kwDOC0FsAM41VJIJ",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-08T02:56:34Z",
    "updated_at": "2021-08-08T02:56:34Z",
    "author_association": "COLLABORATOR",
    "body": "yes, it doesn't conform (it's well-known thing): \r\n- old: txRlp\r\n- new: rlpString(txType) | txRlp\r\nHere is the fix: https://github.com/ledgerwatch/erigon/pull/2500\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/894734857/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
