{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5151",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5151/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5151/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5151/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/5151",
  "id": 1347670645,
  "node_id": "I_kwDOC0FsAM5QU9J1",
  "number": 5151,
  "title": "Mining stage always get none of txn and cause the block mined by erigon always empty block",
  "user": {
    "login": "Fynes",
    "id": 11804958,
    "node_id": "MDQ6VXNlcjExODA0OTU4",
    "avatar_url": "https://avatars.githubusercontent.com/u/11804958?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Fynes",
    "html_url": "https://github.com/Fynes",
    "followers_url": "https://api.github.com/users/Fynes/followers",
    "following_url": "https://api.github.com/users/Fynes/following{/other_user}",
    "gists_url": "https://api.github.com/users/Fynes/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Fynes/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Fynes/subscriptions",
    "organizations_url": "https://api.github.com/users/Fynes/orgs",
    "repos_url": "https://api.github.com/users/Fynes/repos",
    "events_url": "https://api.github.com/users/Fynes/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Fynes/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 11,
  "created_at": "2022-08-23T10:00:59Z",
  "updated_at": "2022-08-24T02:37:07Z",
  "closed_at": "2022-08-24T02:37:07Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: `./erigon --version`\r\n```\r\n./build/bin/erigon  --version\r\nerigon version 2022.99.99-dev-385bedef\r\n```\r\nOS & Version: Windows/Linux/OSX\r\n```\r\nLinux\r\n```\r\nCommit hash : \r\n```\r\n385bedef96b267795adb2c1fb763cf5b86ebb021\r\n```\r\n\r\n#### Expected behaviour\r\n\r\n\r\n#### Actual behaviour\r\n\r\nit always get none of txn in mining stage\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\n\r\n#### Backtrace\r\n\r\n````\r\n[INFO] [08-23|05:43:51.005] Commit cycle                             in=2.715321ms\r\n[INFO] [08-23|05:43:51.005] RPC Daemon notified of new headers       from=25668 to=25669 header sending=5.534Âµs log sending=151ns\r\n[INFO] [08-23|05:43:51.005] [1/16 Headers] Waiting for headers...    from=25669\r\n[INFO] [08-23|05:43:51.465] [1/5 MiningCreateBlock] Start mine       block=25670 baseFee=<nil> gasLimit=30000000\r\n[INFO] [08-23|05:43:51.465] Sealing block with                       number=25670 delay=2.534485144s headerDifficulty=2 val=0xeE06551B99525B8C3ef93f6472caC2F79Aa584AF transaction num=0\r\n[INFO] [08-23|05:43:52.465] [1/5 MiningCreateBlock] Start mine       block=25670 baseFee=<nil> gasLimit=30000000\r\n[INFO] [08-23|05:43:52.465] Sealing block with                       number=25670 delay=1.534326292s headerDifficulty=2 val=0xeE06551B99525B8C3ef93f6472caC2F79Aa584AF transaction num=0\r\n[INFO] [08-23|05:43:53.466] [1/5 MiningCreateBlock] Start mine       block=25670 baseFee=<nil> gasLimit=30000000\r\n[INFO] [08-23|05:43:53.466] Sealing block with                       number=25670 delay=533.214892ms headerDifficulty=2 val=0xeE06551B99525B8C3ef93f6472caC2F79Aa584AF transaction num=0\r\n````\r\n\r\n",
  "closed_by": {
    "login": "Fynes",
    "id": 11804958,
    "node_id": "MDQ6VXNlcjExODA0OTU4",
    "avatar_url": "https://avatars.githubusercontent.com/u/11804958?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Fynes",
    "html_url": "https://github.com/Fynes",
    "followers_url": "https://api.github.com/users/Fynes/followers",
    "following_url": "https://api.github.com/users/Fynes/following{/other_user}",
    "gists_url": "https://api.github.com/users/Fynes/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Fynes/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Fynes/subscriptions",
    "organizations_url": "https://api.github.com/users/Fynes/orgs",
    "repos_url": "https://api.github.com/users/Fynes/repos",
    "events_url": "https://api.github.com/users/Fynes/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Fynes/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5151/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5151/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223845256",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5151#issuecomment-1223845256",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5151",
    "id": 1223845256,
    "node_id": "IC_kwDOC0FsAM5I8mWI",
    "user": {
      "login": "Fynes",
      "id": 11804958,
      "node_id": "MDQ6VXNlcjExODA0OTU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11804958?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Fynes",
      "html_url": "https://github.com/Fynes",
      "followers_url": "https://api.github.com/users/Fynes/followers",
      "following_url": "https://api.github.com/users/Fynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Fynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fynes/subscriptions",
      "organizations_url": "https://api.github.com/users/Fynes/orgs",
      "repos_url": "https://api.github.com/users/Fynes/repos",
      "events_url": "https://api.github.com/users/Fynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Fynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-23T10:01:52Z",
    "updated_at": "2022-08-23T10:01:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "Update.\r\n\r\nIn addition, the interval between mine stage execution is less than 1s, not 3s in bsc. So I think txpool does receive the transaction, and s.notifyMiningAboutNewTxs triggered the mining stage. \r\n```\r\nfor {\r\n            mineEvery.Reset(3 * time.Second)\r\n            select {\r\n            case <-s.notifyMiningAboutNewTxs:\r\n                hasWork = true\r\n            case <-mineEvery.C:\r\n                hasWork = true\r\n            case err := <-errc:\r\n                works = false\r\n                hasWork = false\r\n                if errors.Is(err, libcommon.ErrStopped) {\r\n                    return\r\n                }\r\n                if err != nil {\r\n                    log.Warn(\"mining\", \"err\", err)\r\n                }\r\n            case <-quitCh:\r\n                return\r\n            }\r\n\r\n            if !works && hasWork {\r\n                works = true\r\n                go func() { errc <- stages2.MiningStep(ctx, db, mining) }()\r\n            }\r\n        }\r\n```\r\n![image](https://user-images.githubusercontent.com/11804958/186130749-d59c7eab-489a-4cf1-b71c-0cafe8201360.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223845256/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223845725",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5151#issuecomment-1223845725",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5151",
    "id": 1223845725,
    "node_id": "IC_kwDOC0FsAM5I8mdd",
    "user": {
      "login": "Fynes",
      "id": 11804958,
      "node_id": "MDQ6VXNlcjExODA0OTU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11804958?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Fynes",
      "html_url": "https://github.com/Fynes",
      "followers_url": "https://api.github.com/users/Fynes/followers",
      "following_url": "https://api.github.com/users/Fynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Fynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fynes/subscriptions",
      "organizations_url": "https://api.github.com/users/Fynes/orgs",
      "repos_url": "https://api.github.com/users/Fynes/repos",
      "events_url": "https://api.github.com/users/Fynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Fynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-23T10:02:16Z",
    "updated_at": "2022-08-23T10:02:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "I've add log to print this information.\r\n\r\n```\r\npending, baseFee, queued := cfg.txPool2.CountContent()\r\nlog.Info(fmt.Sprintf(\"create mined block txn: %v, content count: %v, %v, %v\", len(txSlots.Txs), pending, baseFee, queued))\r\n```\r\n\r\n```\r\n[INFO] [08-23|06:47:11.845] [1/5 MiningCreateBlock] Start mine       block=26934 baseFee=<nil> gasLimit=30000000\r\n[INFO] [08-23|06:47:11.845] [parlia] Signed recently, must wait for others\r\n[INFO] [08-23|06:47:11.944] create mined block txn: 162, content count: 183, 0, 27\r\n[INFO] [08-23|06:47:11.944] [1/5 MiningCreateBlock] Start mine       block=26934 baseFee=<nil> gasLimit=30000000\r\n[INFO] [08-23|06:47:11.945] [parlia] Signed recently, must wait for others\r\n[INFO] [08-23|06:47:12.044] create mined block txn: 162, content count: 174, 0, 35\r\n[INFO] [08-23|06:47:12.044] [1/5 MiningCreateBlock] Start mine       block=26934 baseFee=<nil> gasLimit=30000000\r\n[INFO] [08-23|06:47:12.045] [parlia] Signed recently, must wait for others\r\n[INFO] [08-23|06:47:12.144] create mined block txn: 149, content count: 162, 0, 46\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223845725/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223846309",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5151#issuecomment-1223846309",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5151",
    "id": 1223846309,
    "node_id": "IC_kwDOC0FsAM5I8mml",
    "user": {
      "login": "Fynes",
      "id": 11804958,
      "node_id": "MDQ6VXNlcjExODA0OTU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11804958?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Fynes",
      "html_url": "https://github.com/Fynes",
      "followers_url": "https://api.github.com/users/Fynes/followers",
      "following_url": "https://api.github.com/users/Fynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Fynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fynes/subscriptions",
      "organizations_url": "https://api.github.com/users/Fynes/orgs",
      "repos_url": "https://api.github.com/users/Fynes/repos",
      "events_url": "https://api.github.com/users/Fynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Fynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-23T10:02:45Z",
    "updated_at": "2022-08-23T10:02:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "```\r\n\tblockNum := executionAt + 1\r\n\tvar txs []types.Transaction\r\n\tif err = cfg.txPool2DB.View(context.Background(), func(tx kv.Tx) error {\r\n\t\ttxSlots := types2.TxsRlp{}\r\n\t\tif err := cfg.txPool2.Best(200, &txSlots, tx); err != nil {\r\n\t\t\treturn err\r\n\t\t}\r\n\t\tpending, baseFee, queued := cfg.txPool2.CountContent()\r\n\t\tlog.Info(fmt.Sprintf(\"create mined block txn: %v, content count: %v, %v, %v\", len(txSlots.Txs), pending, baseFee, queued))\r\n\r\n\t\tfor i := range txSlots.Txs {\r\n\t\t\ts := rlp.NewStream(bytes.NewReader(txSlots.Txs[i]), uint64(len(txSlots.Txs[i])))\r\n\r\n\t\t\ttransaction, err := types.DecodeTransaction(s)\r\n\t\t\tif err == io.EOF {\r\n\t\t\t\tlog.Info(\"txn is EOF error\")\r\n\t\t\t\tcontinue\r\n\t\t\t}\r\n\t\t\tif err != nil {\r\n\t\t\t\treturn err\r\n\t\t\t}\r\n\t\t\tif transaction.GetChainID().ToBig().Cmp(cfg.chainConfig.ChainID) != 0 {\r\n\t\t\t\tlog.Info(fmt.Sprintf(\"chain id is mismatch, txn chainid=%v, cfg chainid=%v\", transaction.GetChainID().ToBig(), cfg.chainConfig.ChainID))\r\n\t\t\t\tcontinue\r\n\t\t\t}\r\n\t\t\ttxs = append(txs, transaction)\r\n\t\t}\r\n\t\tlog.Info(fmt.Sprintf(\"final txs number: %v\", len(txs)))\r\n\t\tvar sender common.Address\r\n\t\tfor i := range txs {\r\n\t\t\tcopy(sender[:], txSlots.Senders.At(i))\r\n\t\t\ttxs[i].SetSender(sender)\r\n\t\t}\r\n```\r\n\r\n```\r\n[INFO] [08-23|06:56:24.552] chain id is mismatch, txn chainid=0, cfg chainid=714\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223846309/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223847149",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5151#issuecomment-1223847149",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5151",
    "id": 1223847149,
    "node_id": "IC_kwDOC0FsAM5I8mzt",
    "user": {
      "login": "Fynes",
      "id": 11804958,
      "node_id": "MDQ6VXNlcjExODA0OTU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11804958?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Fynes",
      "html_url": "https://github.com/Fynes",
      "followers_url": "https://api.github.com/users/Fynes/followers",
      "following_url": "https://api.github.com/users/Fynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Fynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fynes/subscriptions",
      "organizations_url": "https://api.github.com/users/Fynes/orgs",
      "repos_url": "https://api.github.com/users/Fynes/repos",
      "events_url": "https://api.github.com/users/Fynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Fynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-23T10:03:26Z",
    "updated_at": "2022-08-23T10:03:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "I add some logs in erigon-lib/types/txn.go, and it shows that the chainid of origin remote txn  is correct(714).\r\n\r\n```\r\ndiff --git a/types/txn.go b/types/txn.go\r\nindex 342ce81..bc44df9 100644\r\n--- a/types/txn.go\r\n+++ b/types/txn.go\r\n@@ -351,6 +351,7 @@ func (ctx *TxParseContext) ParseTransaction(payload []byte, pos int, slot *TxSlo\r\n                        ctx.DeriveChainID.Sub(&ctx.V, &ctx.ChainIDMul)\r\n                        vByte = byte(ctx.DeriveChainID.Sub(&ctx.DeriveChainID, u256.N8).Uint64() - 27)\r\n                }\r\n+               fmt.Printf(\"[txn.go] ctx isProtected: %v, %v\", ctx.IsProtected, ctx.ChainID.Uint64())\r\n        } else {\r\n                var v uint64\r\n                p, v, err = rlp.U64(payload, p)\r\n```\r\n\r\nit print\r\n```\r\n[txn.go] ctx isProtected: false, 714\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223847149/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223847537",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5151#issuecomment-1223847537",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5151",
    "id": 1223847537,
    "node_id": "IC_kwDOC0FsAM5I8m5x",
    "user": {
      "login": "Fynes",
      "id": 11804958,
      "node_id": "MDQ6VXNlcjExODA0OTU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11804958?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Fynes",
      "html_url": "https://github.com/Fynes",
      "followers_url": "https://api.github.com/users/Fynes/followers",
      "following_url": "https://api.github.com/users/Fynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Fynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fynes/subscriptions",
      "organizations_url": "https://api.github.com/users/Fynes/orgs",
      "repos_url": "https://api.github.com/users/Fynes/repos",
      "events_url": "https://api.github.com/users/Fynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Fynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-23T10:03:46Z",
    "updated_at": "2022-08-23T10:03:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "Then i walk through the code of mining stage, i found the DecodeTransaction function in transaction.go wasn't decode the chainID.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223847537/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223847974",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5151#issuecomment-1223847974",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5151",
    "id": 1223847974,
    "node_id": "IC_kwDOC0FsAM5I8nAm",
    "user": {
      "login": "Fynes",
      "id": 11804958,
      "node_id": "MDQ6VXNlcjExODA0OTU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11804958?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Fynes",
      "html_url": "https://github.com/Fynes",
      "followers_url": "https://api.github.com/users/Fynes/followers",
      "following_url": "https://api.github.com/users/Fynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Fynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fynes/subscriptions",
      "organizations_url": "https://api.github.com/users/Fynes/orgs",
      "repos_url": "https://api.github.com/users/Fynes/repos",
      "events_url": "https://api.github.com/users/Fynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Fynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-23T10:04:08Z",
    "updated_at": "2022-08-23T11:58:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "\r\nIt should call GetChainID to get the chainid of legacyTx.\r\n\r\n![image](https://user-images.githubusercontent.com/11804958/186131264-00d7dae5-774d-447a-9fd1-0f359af865b4.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223847974/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223891780",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5151#issuecomment-1223891780",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5151",
    "id": 1223891780,
    "node_id": "IC_kwDOC0FsAM5I8xtE",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-23T10:46:59Z",
    "updated_at": "2022-08-23T10:46:59Z",
    "author_association": "COLLABORATOR",
    "body": "probably not, because I see in mining: `transaction.GetChainID()`, not `transaction.ChainID`",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223891780/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223964072",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5151#issuecomment-1223964072",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5151",
    "id": 1223964072,
    "node_id": "IC_kwDOC0FsAM5I9DWo",
    "user": {
      "login": "Fynes",
      "id": 11804958,
      "node_id": "MDQ6VXNlcjExODA0OTU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11804958?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Fynes",
      "html_url": "https://github.com/Fynes",
      "followers_url": "https://api.github.com/users/Fynes/followers",
      "following_url": "https://api.github.com/users/Fynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Fynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fynes/subscriptions",
      "organizations_url": "https://api.github.com/users/Fynes/orgs",
      "repos_url": "https://api.github.com/users/Fynes/repos",
      "events_url": "https://api.github.com/users/Fynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Fynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-23T11:56:41Z",
    "updated_at": "2022-08-23T12:13:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "> probably not, because I see in mining: `transaction.GetChainID()`, not `transaction.ChainID`\r\n\r\nyes. I have no idea about this issue. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223964072/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1224030498",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5151#issuecomment-1224030498",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5151",
    "id": 1224030498,
    "node_id": "IC_kwDOC0FsAM5I9Tki",
    "user": {
      "login": "Fynes",
      "id": 11804958,
      "node_id": "MDQ6VXNlcjExODA0OTU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11804958?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Fynes",
      "html_url": "https://github.com/Fynes",
      "followers_url": "https://api.github.com/users/Fynes/followers",
      "following_url": "https://api.github.com/users/Fynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Fynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fynes/subscriptions",
      "organizations_url": "https://api.github.com/users/Fynes/orgs",
      "repos_url": "https://api.github.com/users/Fynes/repos",
      "events_url": "https://api.github.com/users/Fynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Fynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-23T12:51:30Z",
    "updated_at": "2022-08-23T12:51:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "BTW, Geth does not have this limit that the transaction of zero chainId can not execute in mined block.\r\n\r\nWhy this kind of txn in erigon should be excluded??",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1224030498/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1224032266",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5151#issuecomment-1224032266",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5151",
    "id": 1224032266,
    "node_id": "IC_kwDOC0FsAM5I9UAK",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-23T12:52:51Z",
    "updated_at": "2022-08-23T12:52:51Z",
    "author_association": "COLLABORATOR",
    "body": "> BTW, Geth does not have this limit that the transaction of zero chainId can not execute in mined block.\r\n> \r\n> Why this kind of txn in erigon should be excluded??\r\n\r\nno reason. feel free to copy logic from geth",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1224032266/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1224038963",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5151#issuecomment-1224038963",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5151",
    "id": 1224038963,
    "node_id": "IC_kwDOC0FsAM5I9Voz",
    "user": {
      "login": "Fynes",
      "id": 11804958,
      "node_id": "MDQ6VXNlcjExODA0OTU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11804958?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Fynes",
      "html_url": "https://github.com/Fynes",
      "followers_url": "https://api.github.com/users/Fynes/followers",
      "following_url": "https://api.github.com/users/Fynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Fynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fynes/subscriptions",
      "organizations_url": "https://api.github.com/users/Fynes/orgs",
      "repos_url": "https://api.github.com/users/Fynes/repos",
      "events_url": "https://api.github.com/users/Fynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Fynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-23T12:58:23Z",
    "updated_at": "2022-08-23T12:59:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "yes, I just added some logs to check the chainID of applied transaction, and didn't walk through the code carefully.\r\n\r\n```\r\nfunc (w *worker) commitTransaction(env *environment, tx *types.Transaction, receiptProcessors ...core.ReceiptProcessor) ([]*types.Log, error) {\r\n\tsnap := env.state.Snapshot()\r\n\r\n\treceipt, err := core.ApplyTransaction(w.chainConfig, w.chain, &env.coinbase, env.gasPool, env.state, env.header, tx, &env.header.GasUsed, *w.chain.GetVMConfig(), receiptProcessors...)\r\n\tif err != nil {\r\n\t\tenv.state.RevertToSnapshot(snap)\r\n\t\treturn nil, err\r\n\t}\r\n\tlog.Info(fmt.Sprintf(\"commitTransaction, tx chainId: %v\", tx.ChainId()))\r\n\tenv.txs = append(env.txs, tx)\r\n\tenv.receipts = append(env.receipts, receipt)\r\n\r\n\treturn receipt.Logs, nil\r\n}\r\n\r\n```\r\n\r\nand then i got the log following:\r\n\r\n```\r\nt=2022-08-23T12:46:58+0000 lvl=info msg=\"commitTransaction, tx chainId: 0\"\r\nt=2022-08-23T12:46:58+0000 lvl=info msg=\"commitTransaction, tx chainId: 0\"\r\nt=2022-08-23T12:46:58+0000 lvl=info msg=\"commitTransaction, tx chainId: 714\"\r\nt=2022-08-23T12:46:58+0000 lvl=info msg=\"commitTransaction, tx chainId: 0\"\r\nt=2022-08-23T12:46:58+0000 lvl=info msg=\"commitTransaction, tx chainId: 0\"\r\nt=2022-08-23T12:46:58+0000 lvl=info msg=\"commitTransaction, tx chainId: 0\"\r\nt=2022-08-23T12:46:58+0000 lvl=info msg=\"commitTransaction, tx chainId: 0\"\r\nt=2022-08-23T12:46:58+0000 lvl=info msg=\"commitTransaction, tx chainId: 0\"\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1224038963/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
