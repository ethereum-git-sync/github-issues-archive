{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3256",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3256/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3256/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3256/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/3256",
  "id": 1101796873,
  "node_id": "I_kwDOC0FsAM5BrBYJ",
  "number": 3256,
  "title": "Goerli node stuck: cannot find any good peers",
  "user": {
    "login": "hbarcelos",
    "id": 16565602,
    "node_id": "MDQ6VXNlcjE2NTY1NjAy",
    "avatar_url": "https://avatars.githubusercontent.com/u/16565602?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hbarcelos",
    "html_url": "https://github.com/hbarcelos",
    "followers_url": "https://api.github.com/users/hbarcelos/followers",
    "following_url": "https://api.github.com/users/hbarcelos/following{/other_user}",
    "gists_url": "https://api.github.com/users/hbarcelos/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hbarcelos/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hbarcelos/subscriptions",
    "organizations_url": "https://api.github.com/users/hbarcelos/orgs",
    "repos_url": "https://api.github.com/users/hbarcelos/repos",
    "events_url": "https://api.github.com/users/hbarcelos/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hbarcelos/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-01-13T14:04:18Z",
  "updated_at": "2022-02-04T02:57:28Z",
  "closed_at": "2022-02-04T02:57:28Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: `erigon version 2022.01.1-beta`\r\n\r\nOS & Version: `Linux 5.15.12-1-MANJARO #1 SMP PREEMPT Wed Dec 29 18:08:07 UTC 2021 x86_64 GNU/Linux`\r\n\r\nCommit hash: [53645329](https://github.com/ledgerwatch/erigon/commit/5364532947eebc3896e1acc52678451eade206b5)\r\n\r\n#### Expected behaviour\r\n\r\nNode should sync normally.\r\n\r\n#### Actual behaviour\r\n\r\nNode is stuck after initialization because it cannot find any good peers:\r\n\r\n```\r\nINFO[01-13|10:50:50.675] Build info                               git_branch=makepkg git_tag=v2022.01.01 git_commit=5364532947eebc3896e1acc52678451eade206b5\r\nINFO[01-13|10:50:50.675] Starting Erigon on GÃ¶rli testnet...\r\nINFO[01-13|10:50:50.676] Maximum peer count                       ETH=100 total=100\r\nINFO[01-13|10:50:50.676] Set global gas cap                       cap=50000000\r\nINFO[01-13|10:50:50.677] Opening Database                         label=chaindata path=/data/erigon-goerli/chaindata\r\nINFO[01-13|10:50:50.678] Initialised chain configuration          config=\"{ChainID: 5 Homestead: 0 DAO: <nil> DAOSupport: true EIP150: 0 EIP155: 0 EIP158: 0 Byzantium: 0 Constantinople: 0 Petersburg: 0 Istanbul: 1561651, Muir Glacier: <nil>, Berlin: 4460644, London: 5062605, Arrow Glacier: <nil>, Engine: clique}\"\r\nINFO[01-13|10:50:50.682] Initialising Ethereum protocol           network=5\r\nINFO[01-13|10:50:50.682] Effective                                prune=\"--prune=htc\"\r\nWARN[01-13|10:50:51.021] Preverified hashes not found for         chain=goerli\r\nINFO[01-13|10:50:51.026] Starting private RPC server              on=localhost:9090\r\nINFO[01-13|10:50:51.027] [1/15 Headers] Waiting for headers...    from=6188874\r\nINFO[01-13|10:50:51.053] Started P2P networking                   version=66 self=enode://6b0d5d2c40ba997c9cd30c673d8344e1f268f34abddea0353e62f8d667d98e30e330409a253b63338ec69637128952f933f5f444e76f95f157dc6522729ef904@127.0.0.1:30303 name=erigon/v2022.01.1-beta-53645329/linux-amd64/go1.17.5\r\nINFO[01-13|10:51:21.027] [1/15 Headers] Wrote block headers       number=6188874 blk/second=0.000 alloc=\"77.84 MiB\" sys=\"147.98 MiB\"\r\nINFO[01-13|10:51:51.027] [1/15 Headers] Wrote block headers       number=6188874 blk/second=0.000 alloc=\"80.15 MiB\" sys=\"147.98 MiB\"\r\nINFO[01-13|10:52:21.027] [1/15 Headers] Wrote block headers       number=6188874 blk/second=0.000 alloc=\"80.84 MiB\" sys=\"147.98 MiB\"\r\nINFO[01-13|10:52:50.682] [p2p] GoodPeers                          eth66=0\r\nINFO[01-13|10:52:51.027] [1/15 Headers] Wrote block headers       number=6188874 blk/second=0.000 alloc=\"81.64 MiB\" sys=\"147.98 MiB\"\r\nINFO[01-13|10:53:21.028] [1/15 Headers] Wrote block headers       number=6188874 blk/second=0.000 alloc=\"75.27 MiB\" sys=\"147.98 MiB\"\r\nINFO[01-13|10:53:51.028] [1/15 Headers] Wrote block headers       number=6188874 blk/second=0.000 alloc=\"75.93 MiB\" sys=\"147.98 MiB\"\r\nINFO[01-13|10:54:21.028] [1/15 Headers] Wrote block headers       number=6188874 blk/second=0.000 alloc=\"76.54 MiB\" sys=\"147.98 MiB\"\r\nINFO[01-13|10:54:50.682] [p2p] GoodPeers                          eth66=0\r\n```\r\n\r\n~The same happens for Mainnet.~ Mainnet node stays like this for a while, but eventually manages to connect to a peer after several minutes.\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\nI have a partially synced not (stopped for about 3 days). I usually start it like:\r\n```\r\nerigon --datadir=<path-to-data-dir> --chain goerli --private.api.addr=localhost:9090 --prune htc\r\n```\r\n\r\nI do use `ufw`, but apparently all relevant ports are open as per `sudo ufw status verbose`:\r\n\r\n```\r\nStatus: active\r\nLogging: on (low)\r\nDefault: deny (incoming), allow (outgoing), disabled (routed)\r\nNew profiles: skip\r\n\r\nTo                         Action      From\r\n--                         ------      ----\r\n30303                      ALLOW IN    Anywhere\r\n9090                       ALLOW IN    Anywhere\r\n8545                       ALLOW IN    Anywhere\r\n9091                       ALLOW IN    Anywhere\r\n6060                       ALLOW IN    Anywhere\r\n30303 (v6)                 ALLOW IN    Anywhere (v6)\r\n9090 (v6)                  ALLOW IN    Anywhere (v6)\r\n8545 (v6)                  ALLOW IN    Anywhere (v6)\r\n9091 (v6)                  ALLOW IN    Anywhere (v6)\r\n6060 (v6)                  ALLOW IN    Anywhere (v6)\r\n```\r\n\r\n\r\n#### Backtrace\r\n\r\n````\r\n[backtrace]\r\n````\r\n",
  "closed_by": {
    "login": "hbarcelos",
    "id": 16565602,
    "node_id": "MDQ6VXNlcjE2NTY1NjAy",
    "avatar_url": "https://avatars.githubusercontent.com/u/16565602?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hbarcelos",
    "html_url": "https://github.com/hbarcelos",
    "followers_url": "https://api.github.com/users/hbarcelos/followers",
    "following_url": "https://api.github.com/users/hbarcelos/following{/other_user}",
    "gists_url": "https://api.github.com/users/hbarcelos/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hbarcelos/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hbarcelos/subscriptions",
    "organizations_url": "https://api.github.com/users/hbarcelos/orgs",
    "repos_url": "https://api.github.com/users/hbarcelos/repos",
    "events_url": "https://api.github.com/users/hbarcelos/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hbarcelos/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3256/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3256/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1013370079",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3256#issuecomment-1013370079",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3256",
    "id": 1013370079,
    "node_id": "IC_kwDOC0FsAM48Zszf",
    "user": {
      "login": "wmitsuda",
      "id": 28685,
      "node_id": "MDQ6VXNlcjI4Njg1",
      "avatar_url": "https://avatars.githubusercontent.com/u/28685?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wmitsuda",
      "html_url": "https://github.com/wmitsuda",
      "followers_url": "https://api.github.com/users/wmitsuda/followers",
      "following_url": "https://api.github.com/users/wmitsuda/following{/other_user}",
      "gists_url": "https://api.github.com/users/wmitsuda/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wmitsuda/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wmitsuda/subscriptions",
      "organizations_url": "https://api.github.com/users/wmitsuda/orgs",
      "repos_url": "https://api.github.com/users/wmitsuda/repos",
      "events_url": "https://api.github.com/users/wmitsuda/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wmitsuda/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-14T18:46:03Z",
    "updated_at": "2022-01-14T18:46:03Z",
    "author_association": "COLLABORATOR",
    "body": "I just synced my goerli node which was stopped for some time and I was able to sync it successfully (I'm still on 2021.12.03 though).\r\n\r\n```\r\nINFO[01-14|15:22:41.485] Initialised chain configuration          config=\"{ChainID: 5 Homestead: 0 DAO: <nil> DAOSupport: true EIP150: 0 EIP155: 0 EIP158: 0 Byzantium: 0 Constantinople: 0 Petersburg: 0 Istanbul: 1561651, Muir Glacier: <nil>, Berlin: 4460644, London: 5062605, Arrow Glacier: <nil>, Engine: clique}\"\r\nINFO[01-14|15:22:52.108] Initialising Ethereum protocol           network=5\r\nINFO[01-14|15:22:52.111] Effective                                prune=\"--prune=\"\r\nWARN[01-14|15:23:07.457] Preverified hashes not found for         chain=goerli\r\nINFO[01-14|15:23:07.487] Starting private RPC server              on=127.0.0.1:9090\r\nINFO[01-14|15:23:07.487] [1/15 Headers] Waiting for headers...    from=5925584\r\nINFO[01-14|15:23:09.711] Started P2P networking                   version=66 self=enode://869ee2e60f50076ed4247ccf8792dba1d8a0d857918424e3ef3ffc14e25715bfac0cefe7a1bc121327d0ebc696e4c4ba7c36729be3095c45eabd5bd8308243ae@127.0.0.1:30303 name=erigon/v2021.12.3-beta-00f2b79d/darwin-amd64/go1.17.5\r\nINFO[01-14|15:23:37.487] [1/15 Headers] Wrote block headers       number=5925584 blk/second=0.000 alloc=\"136.55 MiB\" sys=\"183.19 MiB\"\r\nINFO[01-14|15:24:07.487] [1/15 Headers] Inserting headers         progress=5947277\r\nINFO[01-14|15:24:37.491] [1/15 Headers] Inserting headers         progress=5997301\r\nINFO[01-14|15:24:52.111] [p2p] GoodPeers                          eth66=11\r\nINFO[01-14|15:25:07.491] [1/15 Headers] Inserting headers         progress=6032941\r\nINFO[01-14|15:25:37.487] [1/15 Headers] Inserting headers         progress=6084334\r\nINFO[01-14|15:26:07.486] [1/15 Headers] Inserting headers         progress=6195516\r\nINFO[01-14|15:26:08.926] UnwindTo                                 block=5925583 bad_block_hash=0x0000000000000000000000000000000000000000000000000000000000000000\r\nINFO[01-14|15:26:25.276] [1/15 Headers] Processed                 highest inserted=6200532 age=41s\r\nINFO[01-14|15:26:25.276] [1/15 Headers] DONE                      in=3m17.789449437s\r\n```\r\n\r\nand it is keeping a good set of good peers:\r\n\r\n```\r\nINFO[01-14|15:42:52.108] [p2p] GoodPeers                          eth66=15\r\n```\r\n\r\nCould it be some connectivity from your side?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1013370079/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1015517886",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3256#issuecomment-1015517886",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3256",
    "id": 1015517886,
    "node_id": "IC_kwDOC0FsAM48h5K-",
    "user": {
      "login": "hbarcelos",
      "id": 16565602,
      "node_id": "MDQ6VXNlcjE2NTY1NjAy",
      "avatar_url": "https://avatars.githubusercontent.com/u/16565602?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hbarcelos",
      "html_url": "https://github.com/hbarcelos",
      "followers_url": "https://api.github.com/users/hbarcelos/followers",
      "following_url": "https://api.github.com/users/hbarcelos/following{/other_user}",
      "gists_url": "https://api.github.com/users/hbarcelos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hbarcelos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hbarcelos/subscriptions",
      "organizations_url": "https://api.github.com/users/hbarcelos/orgs",
      "repos_url": "https://api.github.com/users/hbarcelos/repos",
      "events_url": "https://api.github.com/users/hbarcelos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hbarcelos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-18T15:21:40Z",
    "updated_at": "2022-01-18T15:21:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "I completely disabled `ufw`, but I'm still having a hard time to find good peers.\r\nEventually I'm able to connect, but it usually takes a long time. Currently I'm stuck on block `6218322` (`Jan-17-2022 08:33:19 PM +UTC`).",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1015517886/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1015659678",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3256#issuecomment-1015659678",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3256",
    "id": 1015659678,
    "node_id": "IC_kwDOC0FsAM48ibye",
    "user": {
      "login": "hbarcelos",
      "id": 16565602,
      "node_id": "MDQ6VXNlcjE2NTY1NjAy",
      "avatar_url": "https://avatars.githubusercontent.com/u/16565602?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hbarcelos",
      "html_url": "https://github.com/hbarcelos",
      "followers_url": "https://api.github.com/users/hbarcelos/followers",
      "following_url": "https://api.github.com/users/hbarcelos/following{/other_user}",
      "gists_url": "https://api.github.com/users/hbarcelos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hbarcelos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hbarcelos/subscriptions",
      "organizations_url": "https://api.github.com/users/hbarcelos/orgs",
      "repos_url": "https://api.github.com/users/hbarcelos/repos",
      "events_url": "https://api.github.com/users/hbarcelos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hbarcelos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-18T17:44:58Z",
    "updated_at": "2022-01-18T17:44:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "Well, after a while it did manage to find 2 peers. The count seems low, but at least I'm able to sync.\r\nIs there a way to manually add more peers so I don run into this issue again?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1015659678/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1015693367",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3256#issuecomment-1015693367",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3256",
    "id": 1015693367,
    "node_id": "IC_kwDOC0FsAM48ikA3",
    "user": {
      "login": "wmitsuda",
      "id": 28685,
      "node_id": "MDQ6VXNlcjI4Njg1",
      "avatar_url": "https://avatars.githubusercontent.com/u/28685?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wmitsuda",
      "html_url": "https://github.com/wmitsuda",
      "followers_url": "https://api.github.com/users/wmitsuda/followers",
      "following_url": "https://api.github.com/users/wmitsuda/following{/other_user}",
      "gists_url": "https://api.github.com/users/wmitsuda/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wmitsuda/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wmitsuda/subscriptions",
      "organizations_url": "https://api.github.com/users/wmitsuda/orgs",
      "repos_url": "https://api.github.com/users/wmitsuda/repos",
      "events_url": "https://api.github.com/users/wmitsuda/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wmitsuda/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-18T18:27:15Z",
    "updated_at": "2022-01-18T18:27:15Z",
    "author_association": "COLLABORATOR",
    "body": "I'm almost sure there is a --static-peers cli arg, but I never tried it.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1015693367/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
