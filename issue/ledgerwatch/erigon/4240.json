{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/4240",
  "id": 1245467172,
  "node_id": "I_kwDOC0FsAM5KPFIk",
  "number": 4240,
  "title": "runtime error: index out of range (mainnet devel stuck after update)",
  "user": {
    "login": "geomad",
    "id": 7707517,
    "node_id": "MDQ6VXNlcjc3MDc1MTc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7707517?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/geomad",
    "html_url": "https://github.com/geomad",
    "followers_url": "https://api.github.com/users/geomad/followers",
    "following_url": "https://api.github.com/users/geomad/following{/other_user}",
    "gists_url": "https://api.github.com/users/geomad/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/geomad/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/geomad/subscriptions",
    "organizations_url": "https://api.github.com/users/geomad/orgs",
    "repos_url": "https://api.github.com/users/geomad/repos",
    "events_url": "https://api.github.com/users/geomad/events{/privacy}",
    "received_events_url": "https://api.github.com/users/geomad/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 24,
  "created_at": "2022-05-23T17:04:20Z",
  "updated_at": "2022-05-31T01:04:26Z",
  "closed_at": "2022-05-31T01:04:26Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: v2021.10.03-1137-g2da927b74-dirty\r\nCommit hash : 2da927b74aafabcc28da18e7382b2866e69f90be\r\nMachine specs: 64 GB ram, AMD 3900x, 4TB Nvme gen4 ssd\r\nOS & Version: Linux Debian\r\n\r\nI was running erigon devel v2021.10.03-1131-g6974a98ac-dirty (6974a98aca4e258086990ea9f1849727699fe7e0) and everything was fine. Updating it to v2021.10.03-1135-g8ea2bb55d-dirty (8ea2bb55d0966e5019f25659c86f57ef79934661) caused it to rebuild snapshot indices (?). Log looked like this (not sure if there was an issue here):\r\n\r\n```\r\n[1/16 Headers] Wrote block headers       number=14827683 blk/second=0.000 alloc=2.8Gb sys=8.8Gb\r\nReq/resp stats                           req=0 reqMin=0 reqMax=0 skel=0 skelMin=0 skelMax=0 resp=11 respMin=14830661 respMax=14830662\r\n{14831117-14832308 links=1192 (14831117-14832308)} => ce71e41c1b93a66695bcb3678572ca847572c1ae86bb4330c87fbf4cffb35c83\r\n[1/16 Headers] Wrote block headers       number=14827683 blk/second=0.000 alloc=2.9Gb sys=8.8Gb\r\nReq/resp stats                           req=0 reqMin=0 reqMax=0 skel=0 skelMin=0 skelMax=0 resp=14 respMin=14830662 respMax=14830663\r\n{14831117-14832308 links=1192 (14831117-14832308)} => ce71e41c1b93a66695bcb3678572ca847572c1ae86bb4330c87fbf4cffb35c83\r\n[1/16 Headers] Wrote block headers       number=14827683 blk/second=0.000 alloc=2.9Gb sys=8.8Gb\r\nReq/resp stats                           req=0 reqMin=0 reqMax=0 skel=0 skelMin=0 skelMax=0 resp=3 respMin=14830662 respMax=14830663\r\n{14831117-14832308 links=1192 (14831117-14832308)} => ce71e41c1b93a66695bcb3678572ca847572c1ae86bb4330c87fbf4cffb35c83\r\n[1/16 Headers] Wrote block headers       number=14827683 blk/second=0.000 alloc=3.0Gb sys=8.8Gb\r\nReq/resp stats                           req=0 reqMin=0 reqMax=0 skel=0 skelMin=0 skelMax=0 resp=20 respMin=14830664 respMax=14830665\r\n{14831117-14832308 links=1192 (14831117-14832308)} => ce71e41c1b93a66695bcb3678572ca847572c1ae86bb4330c87fbf4cffb35c83\r\n[1/16 Headers] Wrote block headers       number=14827683 blk/second=0.000 alloc=3.1Gb sys=8.8Gb\r\nReq/resp stats                           req=0 reqMin=0 reqMax=0 skel=0 skelMin=0 skelMax=0 resp=0 respMin=0 respMax=0\r\n{14831117-14832308 links=1192 (14831117-14832308)} => ce71e41c1b93a66695bcb3678572ca847572c1ae86bb4330c87fbf4cffb35c83\r\n[p2p] GoodPeers                          eth66=28\r\n[1/16 Headers] Wrote block headers       number=14827683 blk/second=0.000 alloc=2.6Gb sys=8.8Gb\r\nReq/resp stats                           req=0 reqMin=0 reqMax=0 skel=0 skelMin=0 skelMax=0 resp=0 respMin=0 respMax=0\r\n{14831117-14832308 links=1192 (14831117-14832308)} => ce71e41c1b93a66695bcb3678572ca847572c1ae86bb4330c87fbf4cffb35c83\r\n[1/16 Headers] Wrote block headers       number=14827683 blk/second=0.000 alloc=2.7Gb sys=8.8Gb\r\nReq/resp stats                           req=0 reqMin=0 reqMax=0 skel=0 skelMin=0 skelMax=0 resp=26 respMin=14830666 respMax=14830668\r\n{14831117-14832308 links=1192 (14831117-14832308)} => ce71e41c1b93a66695bcb3678572ca847572c1ae86bb4330c87fbf4cffb35c83\r\n[1/16 Headers] Wrote block headers       number=14827683 blk/second=0.000 alloc=2.9Gb sys=8.8Gb\r\nReq/resp stats                           req=0 reqMin=0 reqMax=0 skel=0 skelMin=0 skelMax=0 resp=3 respMin=14830667 respMax=14830668\r\n{14831117-14832308 links=1192 (14831117-14832308)} => ce71e41c1b93a66695bcb3678572ca847572c1ae86bb4330c87fbf4cffb35c83\r\n[1/16 Headers] Wrote block headers       number=14827683 blk/second=0.000 alloc=3.0Gb sys=8.8Gb\r\nReq/resp stats                           req=0 reqMin=0 reqMax=0 skel=0 skelMin=0 skelMax=0 resp=13 respMin=3406786 respMax=14830669\r\n{14831117-14832308 links=1192 (14831117-14832308)} => ce71e41c1b93a66695bcb3678572ca847572c1ae86bb4330c87fbf4cffb35c83\r\n[1/16 Headers] Wrote block headers       number=14827683 blk/second=0.000 alloc=3.1Gb sys=8.8Gb\r\nReq/resp stats                           req=0 reqMin=0 reqMax=0 skel=0 skelMin=0 skelMax=0 resp=44 respMin=14830670 respMax=14830674\r\n{14831117-14832308 links=1192 (14831117-14832308)} => ce71e41c1b93a66695bcb3678572ca847572c1ae86bb4330c87fbf4cffb35c83\r\n```\r\n\r\nAfter further updating to v2021.10.03-1137-g2da927b74-dirty (2da927b74aafabcc28da18e7382b2866e69f90be) while the operation was still running logs now looks like this:\r\n\r\n```\r\n[Snapshots] Fetching torrent files metadata\r\nnew subscription to newHeaders established\r\n[Snapshots] Stat                         blocks=14499999 alloc=2.3Gb sys=3.2Gb\r\n[snapshots] Build indices                from=14499999\r\nStaged Sync                              err=\"[1/16 Headers] TransactionsIdx: at=14500000-14600000, runtime error: index out of range [3404] with length 3404\"\r\n[Snapshots] Fetching torrent files metadata\r\n[Snapshots] Stat                         blocks=14499999 alloc=2.3Gb sys=4.2Gb\r\n[snapshots] Build indices                from=14499999\r\nStaged Sync                              err=\"[1/16 Headers] TransactionsIdx: at=14500000-14600000, runtime error: index out of range [3404] with length 3404\"\r\n[Snapshots] Fetching torrent files metadata\r\n[Snapshots] Stat                         blocks=14499999 alloc=2.3Gb sys=4.3Gb\r\n[snapshots] Build indices                from=14499999\r\nStaged Sync                              err=\"[1/16 Headers] TransactionsIdx: at=14500000-14600000, runtime error: index out of range [3404] with length 3404\"\r\n[Snapshots] Fetching torrent files metadata\r\n[Snapshots] Stat                         blocks=14499999 alloc=2.3Gb sys=4.4Gb\r\n[snapshots] Build indices                from=14499999\r\nStaged Sync                              err=\"[1/16 Headers] TransactionsIdx: at=14500000-14600000, runtime error: index out of range [3404] with length 3404\"\r\n[Snapshots] Fetching torrent files metadata\r\n[Snapshots] Stat                         blocks=14499999 alloc=2.3Gb sys=4.4Gb\r\n[snapshots] Build indices                from=14499999\r\nStaged Sync                              err=\"[1/16 Headers] TransactionsIdx: at=14500000-14600000, runtime error: index out of range [3404] with length 3404\"\r\n[Snapshots] Fetching torrent files metadata\r\n[Snapshots] Stat                         blocks=14499999 alloc=2.2Gb sys=4.4Gb\r\n[snapshots] Build indices                from=14499999\r\nStaged Sync                              err=\"[1/16 Headers] TransactionsIdx: at=14500000-14600000, runtime error: index out of range [3404] with length 3404\"\r\n[Snapshots] Fetching torrent files metadata\r\n[Snapshots] Stat                         blocks=14499999 alloc=2.1Gb sys=4.4Gb\r\n[snapshots] Build indices                from=14499999\r\nStaged Sync                              err=\"[1/16 Headers] TransactionsIdx: at=14500000-14600000, runtime error: index out of range [3404] with length 3404\"\r\n[Snapshots] Fetching torrent files metadata\r\n[Snapshots] Stat                         blocks=14499999 alloc=2.3Gb sys=4.4Gb\r\n[snapshots] Build indices                from=14499999\r\n```\r\n\r\nReverting to 8ea2bb55d0966e5019f25659c86f57ef79934661 doesn't fix the runtime error.",
  "closed_by": {
    "login": "AskAlexSharov",
    "id": 46885206,
    "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AskAlexSharov",
    "html_url": "https://github.com/AskAlexSharov",
    "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
    "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
    "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
    "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
    "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1135377616",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1135377616",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1135377616,
    "node_id": "IC_kwDOC0FsAM5DrHzQ",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-24T04:02:23Z",
    "updated_at": "2022-05-24T04:02:23Z",
    "author_association": "COLLABORATOR",
    "body": "Added more context info to such errors by: https://github.com/ledgerwatch/erigon/pull/4245",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1135377616/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1135416470",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1135416470",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1135416470,
    "node_id": "IC_kwDOC0FsAM5DrRSW",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-24T05:11:44Z",
    "updated_at": "2022-05-24T05:11:44Z",
    "author_association": "COLLABORATOR",
    "body": "can you please switch to latest `devel` and show new error message",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1135416470/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1135458860",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1135458860",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1135458860,
    "node_id": "IC_kwDOC0FsAM5Drbos",
    "user": {
      "login": "geomad",
      "id": 7707517,
      "node_id": "MDQ6VXNlcjc3MDc1MTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7707517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/geomad",
      "html_url": "https://github.com/geomad",
      "followers_url": "https://api.github.com/users/geomad/followers",
      "following_url": "https://api.github.com/users/geomad/following{/other_user}",
      "gists_url": "https://api.github.com/users/geomad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/geomad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/geomad/subscriptions",
      "organizations_url": "https://api.github.com/users/geomad/orgs",
      "repos_url": "https://api.github.com/users/geomad/repos",
      "events_url": "https://api.github.com/users/geomad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/geomad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-24T06:22:40Z",
    "updated_at": "2022-05-24T16:10:47Z",
    "author_association": "NONE",
    "body": "Sure!\r\n```\r\n[Snapshots] Stat                         blocks=14499999 alloc=2.2Gb sys=2.7Gb\r\n[snapshots] Build indices                from=14499999\r\nnew subscription to newHeaders established\r\nStaged Sync                              err=\"[1/16 Headers] TransactionsIdx: at=14500000-14600000, runtime error: index out of range [3404] with length 3404, [block_snapshots.go:1296 panic.go:844 panic.go:93 elias_fano.go:172 elias_fano.go:183 index.go:246 block_snapshots.go:1325 block_snapshots.go:714 asm_amd64.s:1571]\"\r\n[Snapshots] Fetching torrent files metadata\r\n[Snapshots] Stat                         blocks=14499999 alloc=2.0Gb sys=3.3Gb\r\n[snapshots] Build indices                from=14499999\r\nStaged Sync                              err=\"[1/16 Headers] TransactionsIdx: at=14500000-14600000, runtime error: index out of range [3404] with length 3404, [block_snapshots.go:1296 panic.go:844 panic.go:93 elias_fano.go:172 elias_fano.go:183 index.go:246 block_snapshots.go:1325 block_snapshots.go:714 asm_amd64.s:1571]\"\r\n[Snapshots] Fetching torrent files metadata\r\n[Snapshots] Stat                         blocks=14499999 alloc=2.2Gb sys=4.0Gb\r\n[snapshots] Build indices                from=14499999\r\nStaged Sync                              err=\"[1/16 Headers] TransactionsIdx: at=14500000-14600000, runtime error: index out of range [3404] with length 3404, [block_snapshots.go:1296 panic.go:844 panic.go:93 elias_fano.go:172 elias_fano.go:183 index.go:246 block_snapshots.go:1325 block_snapshots.go:714 asm_amd64.s:1571]\"\r\n\r\n```\r\n\r\nbtw startup args:\r\n```\r\n--syncmode=snap --datadir /erigon --txpool.disable --torrent.download.rate=60mb --torrent.upload.rate=2mb --maxpeers 30 --ethash.dagdir /erigon/erigon-ethash --port 30305 --trustedpeers=<mypeers>\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1135458860/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1136960865",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1136960865",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1136960865,
    "node_id": "IC_kwDOC0FsAM5DxKVh",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-25T08:38:35Z",
    "updated_at": "2022-05-25T08:38:35Z",
    "author_association": "COLLABORATOR",
    "body": "\r\n```\r\nrm <your_datadir>/snapshots/v1-014500-014600-bodies.seg\r\nrm <your_datadir>/snapshots/v1-014500-014600-bodies.idx\r\n./build/bin/integration stage_headers --reset --datadir=<your_datadir>\r\n```\r\nthen start erigon as usually\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1136960865/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1137105228",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1137105228",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1137105228,
    "node_id": "IC_kwDOC0FsAM5DxtlM",
    "user": {
      "login": "geomad",
      "id": 7707517,
      "node_id": "MDQ6VXNlcjc3MDc1MTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7707517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/geomad",
      "html_url": "https://github.com/geomad",
      "followers_url": "https://api.github.com/users/geomad/followers",
      "following_url": "https://api.github.com/users/geomad/following{/other_user}",
      "gists_url": "https://api.github.com/users/geomad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/geomad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/geomad/subscriptions",
      "organizations_url": "https://api.github.com/users/geomad/orgs",
      "repos_url": "https://api.github.com/users/geomad/repos",
      "events_url": "https://api.github.com/users/geomad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/geomad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-25T11:05:36Z",
    "updated_at": "2022-05-25T11:05:36Z",
    "author_association": "NONE",
    "body": "> ```\r\n> rm <your_datadir>/snapshots/v1-014500-014600-bodies.seg\r\n> rm <your_datadir>/snapshots/v1-014500-014600-bodies.idx\r\n> ./build/bin/integration stage_headers --reset --datadir=<your_datadir>\r\n> ```\r\n> \r\n> then start erigon as usually\r\n\r\nThanks! That partially worked. After resetting, erigon started syncing normally, but after this finished it started to panic.\r\n\r\n```\r\nnew subscription to newHeaders established\r\n[Snapshots] Stat                         blocks=14599999 alloc=2.3Gb sys=3.6Gb\r\n[1/16 Headers] Waiting for headers...    from=14841361\r\n[1/16 Headers] Processed                 highest inserted=14841364 age=10s\r\n[6/16 Execution] Completed on            block=14841364\r\nTimings (slower than 50ms)               Headers=9.913s Bodies=324ms Execution=205ms HashState=116ms IntermediateHashes=2.236s CallTraces=67ms StorageHistoryIndex=75ms\r\n[snapshots] Retire Blocks                range=14600k-14700k\r\nRPC Daemon notified of new headers       from=14841361 to=14841364 header sending=7.003µs log sending=161ns\r\n[1/16 Headers] Waiting for headers...    from=14841364\r\npanic: no gaps in tx ids are allowed: block 14600000 does jump from 1570724349 to 1570724736\r\ngoroutine 12692 [running]:\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.DumpTxs.func3.1({0x77f0382752d6?, 0xc06f60d570?, 0x8?}, {0x77f0382752de?, 0x7f9de0022fe0?, 0x68?})\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:1115 +0x328\r\ngithub.com/ledgerwatch/erigon-lib/kv/mdbx.(*MdbxTx).ForAmount(0x1e9db80?, {0x1889a5d?, 0xfdff339ef077776c?}, {0xc06f60d570, 0x8, 0xa}, 0x26, 0xc06e768380)\r\n        github.com/ledgerwatch/erigon-lib@v0.0.0-20220524050710-eff88cf2616c/kv/mdbx/kv_mdbx.go:522 +0x1a8\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.DumpTxs.func3({0x1e9db80, 0xc06f61a630}, {0x77bd229a50d8?, 0x8?, 0x8?}, {0x77bd229a50e0?, 0x20?, 0x20?})\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:1112 +0x85c\r\ngithub.com/ledgerwatch/erigon-lib/kv.BigChunks.func1({0x1e9db80, 0xc06f61a630})\r\n        github.com/ledgerwatch/erigon-lib@v0.0.0-20220524050710-eff88cf2616c/kv/helpers.go:40 +0x1eb\r\ngithub.com/ledgerwatch/erigon-lib/kv/mdbx.(*MdbxKV).View(0xdf8475800?, {0x1e93320?, 0xc00013e000?}, 0xc06f609600)\r\n        github.com/ledgerwatch/erigon-lib@v0.0.0-20220524050710-eff88cf2616c/kv/mdbx/kv_mdbx.go:637 +0xbe\r\ngithub.com/ledgerwatch/erigon-lib/kv.BigChunks({0x7f9e04163d38, 0xc0002500a0}, {0x1888054, 0xf}, {0xc06f60d590, 0x8, 0x8}, 0xc06e722b60)\r\n        github.com/ledgerwatch/erigon-lib@v0.0.0-20220524050710-eff88cf2616c/kv/helpers.go:18 +0x192\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.DumpTxs({0x1e932e8?, 0xc000b8b300}, {0x7f9e04163d38?, 0xc0002500a0}, {0xc06f55bd40, 0x39}, {0xc000dfaea0, 0x16}, 0xdec740, 0xe04de0, ...)\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:1066 +0x97c\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.dumpBlocksRange({0x1e932e8, 0xc000b8b300}, 0x658e05?, 0xc000150200?, {0xc000dfaea0, 0x16}, {0xc0001345e8, 0x17}, {0x7f9e04163d38, 0xc0002500a0}, ...)\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:982 +0x12f\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.DumpBlocks({0x1e932e8, 0xc000b8b300}, 0x505010000000000?, 0xe04de0, 0x7a120, {0xc000dfaea0, 0x16}, {0xc0001345e8, 0x17}, {0x7f9e04163d38, ...}, ...)\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:974 +0x165\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.retireBlocks({0x1e932e8, 0xc000b8b300}, 0xdec740, 0xe04de0, {0x1, 0x0, 0x0, 0x0}, {0xc000dfaea0, 0x16}, ...)\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:927 +0x205\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.(*BlockRetire).RetireBlocksInBackground.func1()\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:911 +0x187\r\ncreated by github.com/ledgerwatch/erigon/turbo/snapshotsync.(*BlockRetire).RetireBlocksInBackground\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:906 +0x125\r\nerigon.service: Main process exited, code=exited, status=2/INVALIDARGUMENT\r\nerigon.service: Failed with result 'exit-code'.\r\n\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1137105228/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1137107631",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1137107631",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1137107631,
    "node_id": "IC_kwDOC0FsAM5DxuKv",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-25T11:08:21Z",
    "updated_at": "2022-05-25T11:08:21Z",
    "author_association": "COLLABORATOR",
    "body": "It’s something new… don’t have solution yet",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1137107631/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1137118791",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1137118791",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1137118791,
    "node_id": "IC_kwDOC0FsAM5Dxw5H",
    "user": {
      "login": "geomad",
      "id": 7707517,
      "node_id": "MDQ6VXNlcjc3MDc1MTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7707517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/geomad",
      "html_url": "https://github.com/geomad",
      "followers_url": "https://api.github.com/users/geomad/followers",
      "following_url": "https://api.github.com/users/geomad/following{/other_user}",
      "gists_url": "https://api.github.com/users/geomad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/geomad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/geomad/subscriptions",
      "organizations_url": "https://api.github.com/users/geomad/orgs",
      "repos_url": "https://api.github.com/users/geomad/repos",
      "events_url": "https://api.github.com/users/geomad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/geomad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-25T11:21:31Z",
    "updated_at": "2022-05-25T11:21:31Z",
    "author_association": "NONE",
    "body": "> It’s something new… don’t have solution yet\r\n\r\nThanks! Anything I could try resetting/deleting to get me back up? Or just patience?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1137118791/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1137197180",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1137197180",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1137197180,
    "node_id": "IC_kwDOC0FsAM5DyEB8",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-25T12:48:27Z",
    "updated_at": "2022-05-25T12:48:27Z",
    "author_association": "COLLABORATOR",
    "body": "I will try to debug it tomorrow. have no recommendations now. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1137197180/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1138139375",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1138139375",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1138139375,
    "node_id": "IC_kwDOC0FsAM5D1qDv",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-26T04:24:21Z",
    "updated_at": "2022-05-26T04:36:45Z",
    "author_association": "COLLABORATOR",
    "body": "seem just need to delete more... \r\n```\r\nrm <your_datadir>/snapshots/v1-0145*\r\nrm <your_datadir>/snapshots/v1-0146*\r\nrm <your_datadir>/snapshots/v1-0147*\r\nrm <your_datadir>/snapshots/v1-0148*\r\nrm <your_datadir>/snapshots/v1-0149*\r\n./build/bin/downloader torrent_hashes --verify --datadir=<your_datadir>\r\n./build/bin/integration stage_headers --reset --datadir=<your_datadir>\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1138139375/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1138179739",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1138179739",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1138179739,
    "node_id": "IC_kwDOC0FsAM5D1z6b",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-26T05:52:04Z",
    "updated_at": "2022-05-26T05:52:04Z",
    "author_association": "COLLABORATOR",
    "body": "Oh, I finally can reproduce it. Will see...",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1138179739/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1138413475",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1138413475",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1138413475,
    "node_id": "IC_kwDOC0FsAM5D2s-j",
    "user": {
      "login": "geomad",
      "id": 7707517,
      "node_id": "MDQ6VXNlcjc3MDc1MTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7707517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/geomad",
      "html_url": "https://github.com/geomad",
      "followers_url": "https://api.github.com/users/geomad/followers",
      "following_url": "https://api.github.com/users/geomad/following{/other_user}",
      "gists_url": "https://api.github.com/users/geomad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/geomad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/geomad/subscriptions",
      "organizations_url": "https://api.github.com/users/geomad/orgs",
      "repos_url": "https://api.github.com/users/geomad/repos",
      "events_url": "https://api.github.com/users/geomad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/geomad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-26T11:03:12Z",
    "updated_at": "2022-05-26T12:05:11Z",
    "author_association": "NONE",
    "body": "> seem just need to delete more...\r\n> \r\n> ```\r\n> rm <your_datadir>/snapshots/v1-0145*\r\n> rm <your_datadir>/snapshots/v1-0146*\r\n> rm <your_datadir>/snapshots/v1-0147*\r\n> rm <your_datadir>/snapshots/v1-0148*\r\n> rm <your_datadir>/snapshots/v1-0149*\r\n> ./build/bin/downloader torrent_hashes --verify --datadir=<your_datadir>\r\n> ./build/bin/integration stage_headers --reset --datadir=<your_datadir>\r\n> ```\r\n\r\nThanks! tried that but I'm getting the same error, just with different numbers\r\n ```\r\n[1/16 Headers] Waiting for headers...    from=14847578\r\npanic: no gaps in tx ids are allowed: block 14500001 does jump from 1553325656 to 1553326002\r\ngoroutine 20374 [running]:\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.DumpTxs.func3.1({0x78927dd88dc0?, 0xc07be8eb50?, 0x8?}, {0x78927dd88dc8?, 0x7fd4bc0cc6b8?, 0x68?})\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:1115 +0x328\r\ngithub.com/ledgerwatch/erigon-lib/kv/mdbx.(*MdbxTx).ForAmount(0x1ea2580?, {0x188e1d1?, 0x70e510b366468fde?}, {0xc07be8eb50, 0x8, 0xa}, 0x63, 0xc07a416a10)\r\n        github.com/ledgerwatch/erigon-lib@v0.0.0-20220525112105-b544bfe85dee/kv/mdbx/kv_mdbx.go:522 +0x1a8\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.DumpTxs.func3({0x1ea2580, 0xc07beac4b0}, {0x78cbec4f5168?, 0x8?, 0x8?}, {0x78cbec4f5170?, 0x20?, 0x20?})\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:1112 +0x85c\r\ngithub.com/ledgerwatch/erigon-lib/kv.BigChunks.func1({0x1ea2580, 0xc07beac4b0})\r\n        github.com/ledgerwatch/erigon-lib@v0.0.0-20220525112105-b544bfe85dee/kv/helpers.go:40 +0x1eb\r\ngithub.com/ledgerwatch/erigon-lib/kv/mdbx.(*MdbxKV).View(0xdf8475800?, {0x1e97d20?, 0xc000040060?}, 0xc07baede00)\r\n        github.com/ledgerwatch/erigon-lib@v0.0.0-20220525112105-b544bfe85dee/kv/mdbx/kv_mdbx.go:637 +0xbe\r\ngithub.com/ledgerwatch/erigon-lib/kv.BigChunks({0x7fd4bc6df070, 0xc000286000}, {0x188c7c8, 0xf}, {0xc07be8eb70, 0x8, 0x8}, 0xc07be9edd0)\r\n        github.com/ledgerwatch/erigon-lib@v0.0.0-20220525112105-b544bfe85dee/kv/helpers.go:18 +0x192\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.DumpTxs({0x1e97ce8?, 0xc000eaf300}, {0x7fd4bc6df070?, 0xc000286000}, {0xc07baf71c0, 0x39}, {0xc001d5ad08, 0x16}, 0xdd40a0, 0xdec740, ...)\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:1066 +0x97c\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.dumpBlocksRange({0x1e97ce8, 0xc000eaf300}, 0x658ea5?, 0xc0000aa220?, {0xc001d5ad08, 0x16}, {0xc000137f38, 0x17}, {0x7fd4bc6df070, 0xc000286000}, ...)\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:982 +0x12f\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.DumpBlocks({0x1e97ce8, 0xc000eaf300}, 0xc074528dc0?, 0xdec740, 0x7a120, {0xc001d5ad08, 0x16}, {0xc000137f38, 0x17}, {0x7fd4bc6df070, ...}, ...)\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:974 +0x165\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.retireBlocks({0x1e97ce8, 0xc000eaf300}, 0xdd40a0, 0xdec740, {0x1, 0x0, 0x0, 0x0}, {0xc001d5ad08, 0x16}, ...)\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:927 +0x205\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.(*BlockRetire).RetireBlocksInBackground.func1()\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:911 +0x187\r\ncreated by github.com/ledgerwatch/erigon/turbo/snapshotsync.(*BlockRetire).RetireBlocksInBackground\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:906 +0x125\r\n\r\n ```\r\n \r\n I also tried to copy the whole snapshots folder from a fresh install but getting the same error.\r\n  ```\r\n panic: no gaps in tx ids are allowed: block 14500005 does jump from 1553326444 to 1553326447\r\n  ```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1138413475/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1139247294",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1139247294",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1139247294,
    "node_id": "IC_kwDOC0FsAM5D54i-",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-27T03:36:37Z",
    "updated_at": "2022-05-27T03:36:37Z",
    "author_association": "COLLABORATOR",
    "body": "Ok. It was bug inside \"stage_headers --reset\". Then:\r\n- Switch to latest \"devel\"\r\n- `./build/bin/integration stage_headers --reset --datadir=<your_datadir>`\r\n- if you will get 'hash root miss-match' error, do: `./build/bin/integration state_stages --unwind=1000 --datadir=<your_datadir>`",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1139247294/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1139431647",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1139431647",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1139431647,
    "node_id": "IC_kwDOC0FsAM5D6ljf",
    "user": {
      "login": "geomad",
      "id": 7707517,
      "node_id": "MDQ6VXNlcjc3MDc1MTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7707517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/geomad",
      "html_url": "https://github.com/geomad",
      "followers_url": "https://api.github.com/users/geomad/followers",
      "following_url": "https://api.github.com/users/geomad/following{/other_user}",
      "gists_url": "https://api.github.com/users/geomad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/geomad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/geomad/subscriptions",
      "organizations_url": "https://api.github.com/users/geomad/orgs",
      "repos_url": "https://api.github.com/users/geomad/repos",
      "events_url": "https://api.github.com/users/geomad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/geomad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-27T09:10:42Z",
    "updated_at": "2022-05-27T09:10:42Z",
    "author_association": "NONE",
    "body": "> Ok. It was bug inside \"stage_headers --reset\". Then:\r\n> \r\n> * Switch to latest \"devel\"\r\n> * `./build/bin/integration stage_headers --reset --datadir=<your_datadir>`\r\n> * if you will get 'hash root miss-match' error, do: `./build/bin/integration state_stages --unwind=1000 --datadir=<your_datadir>`\r\n\r\nUnfortunately that didn't fix the issue once again.\r\n```\r\n[10/16 CallTraces] Pruned call trace intermediate table from=14762885 to=14763153\r\nTimings (slower than 50ms)               Headers=21m28.969s Bodies=11m39.034s Senders=320ms Execution=24.382s HashState=13.176s IntermediateHashes=20.046s CallTraces=6.905s AccountHistoryIndex=4.638s StorageHistoryIndex=6.714s LogIndex=6.076s TxLookup=4.321s\r\n[snapshots] Retire Blocks                range=14500k-14600k\r\nRPC Daemon notified of new headers       from=14852885 to=14853154 header sending=172.315µs log sending=310ns\r\n[1/16 Headers] Waiting for headers...    from=14853154\r\n[1/16 Headers] Processed                 highest inserted=14853155 age=14m32s\r\npanic: no gaps in tx ids are allowed: block 14500005 does jump from 1553326444 to 1553326447\r\ngoroutine 953612 [running]:\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.DumpTxs.func3.1({0x77f3b8e1d78a?, 0xc0ea5ff810?, 0x8?}, {0x77f3b8e1d792?, 0x7765b877e868?, 0x68?})\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:1115 +0x328\r\ngithub.com/ledgerwatch/erigon-lib/kv/mdbx.(*MdbxTx).ForAmount(0x1ea30a0?, {0x188ed02?, 0xb7c7915a90ab2e6b?}, {0xc0ea5ff810, 0x8, 0xa}, 0xd3, 0xc0e0296230)\r\n        github.com/ledgerwatch/erigon-lib@v0.0.0-20220526112101-6b62bf17b5ba/kv/mdbx/kv_mdbx.go:522 +0x1a8\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.DumpTxs.func3({0x1ea30a0, 0xc0cd2785d0}, {0x77c4c4c65798?, 0x8?, 0x8?}, {0x77c4c4c657a0?, 0x20?, 0x20?})\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:1112 +0x85c\r\ngithub.com/ledgerwatch/erigon-lib/kv.BigChunks.func1({0x1ea30a0, 0xc0cd2785d0})\r\n        github.com/ledgerwatch/erigon-lib@v0.0.0-20220526112101-6b62bf17b5ba/kv/helpers.go:40 +0x1eb\r\ngithub.com/ledgerwatch/erigon-lib/kv/mdbx.(*MdbxKV).View(0xdf8475800?, {0x1e98840?, 0xc000138000?}, 0xc0683b5e80)\r\n        github.com/ledgerwatch/erigon-lib@v0.0.0-20220526112101-6b62bf17b5ba/kv/mdbx/kv_mdbx.go:637 +0xbe\r\ngithub.com/ledgerwatch/erigon-lib/kv.BigChunks({0x7f73186a93f8, 0xc000278000}, {0x188d2f9, 0xf}, {0xc0ea5ff830, 0x8, 0x8}, 0xc093051520)\r\n        github.com/ledgerwatch/erigon-lib@v0.0.0-20220526112101-6b62bf17b5ba/kv/helpers.go:18 +0x192\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.DumpTxs({0x1e98808?, 0xc001047240}, {0x7f73186a93f8?, 0xc000278000}, {0xc0b2bb8ac0, 0x39}, {0xc0011d9170, 0x16}, 0xdd40a0, 0xdec740, ...)\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:1066 +0x97c\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.dumpBlocksRange({0x1e98808, 0xc001047240}, 0x658ea5?, 0xc00014a200?, {0xc0011d9170, 0x16}, {0xc00012c948, 0x17}, {0x7f73186a93f8, 0xc000278000}, ...)\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:982 +0x12f\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.DumpBlocks({0x1e98808, 0xc001047240}, 0x1e98878?, 0xdec740, 0x7a120, {0xc0011d9170, 0x16}, {0xc00012c948, 0x17}, {0x7f73186a93f8, ...}, ...)\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:974 +0x165\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.retireBlocks({0x1e98808, 0xc001047240}, 0xdd40a0, 0xdec740, {0x1, 0x0, 0x0, 0x0}, {0xc0011d9170, 0x16}, ...)\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:927 +0x205\r\ngithub.com/ledgerwatch/erigon/turbo/snapshotsync.(*BlockRetire).RetireBlocksInBackground.func1()\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:911 +0x187\r\ncreated by github.com/ledgerwatch/erigon/turbo/snapshotsync.(*BlockRetire).RetireBlocksInBackground\r\n        github.com/ledgerwatch/erigon/turbo/snapshotsync/block_snapshots.go:906 +0x125\r\n```\r\n\r\nDuring the sync after the reset I noticed something irregular, maybe it's related:\r\n```\r\n[1/16 Headers] Inserting headers         progress=14849783 queue=1\r\n[1/16 Headers] Processed                 highest inserted=14853154 age=1m32s\r\n[1/16 Headers] DONE                      in=21m28.96927499s\r\n[4/16 Bodies] Processing bodies...       from=14499999 to=14853154\r\nHandling incoming message                stream=RecvMessage err=\"decode BlockBodiesPacket66: rlp: input list has too many elements for eth.BlockRawBodiesPacket66\"\r\nHandling incoming message                stream=RecvMessage err=\"decode BlockBodiesPacket66: rlp: input list has too many elements for eth.BlockRawBodiesPacket66\"\r\n[p2p] GoodPeers                          eth66=20\r\n[4/16 Bodies] Wrote block bodies         block_num=14502727 delivery/sec=41.6Mb wasted/sec=0b alloc=4.9Gb sys=6.0Gb\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1139431647/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1140133914",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1140133914",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1140133914,
    "node_id": "IC_kwDOC0FsAM5D9RAa",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-28T01:49:17Z",
    "updated_at": "2022-05-28T01:49:17Z",
    "author_association": "COLLABORATOR",
    "body": "what is your version now?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1140133914/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1140180945",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1140180945",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1140180945,
    "node_id": "IC_kwDOC0FsAM5D9cfR",
    "user": {
      "login": "johnnydev543",
      "id": 47145436,
      "node_id": "MDQ6VXNlcjQ3MTQ1NDM2",
      "avatar_url": "https://avatars.githubusercontent.com/u/47145436?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/johnnydev543",
      "html_url": "https://github.com/johnnydev543",
      "followers_url": "https://api.github.com/users/johnnydev543/followers",
      "following_url": "https://api.github.com/users/johnnydev543/following{/other_user}",
      "gists_url": "https://api.github.com/users/johnnydev543/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/johnnydev543/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/johnnydev543/subscriptions",
      "organizations_url": "https://api.github.com/users/johnnydev543/orgs",
      "repos_url": "https://api.github.com/users/johnnydev543/repos",
      "events_url": "https://api.github.com/users/johnnydev543/events{/privacy}",
      "received_events_url": "https://api.github.com/users/johnnydev543/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-28T05:53:26Z",
    "updated_at": "2022-05-28T06:07:59Z",
    "author_association": "NONE",
    "body": "I'm having the same issue when running the latest `thorax/erigon:devel` on kiln network.\r\n```\r\nerr=\"[1/16 Headers] BuildIndices: TransactionsIdx: at=0-500000, runtime error: index out of range [31249] with length 3447, [block_snapshots.go:1296 panic.go:844 panic.go:93 elias_fano.go:154 elias_fano.go:183 index.go:246 block_snapshots.go:1325 block_snapshots.go:714 asm_amd64.s:1571]\"\r\n```\r\nIt happened when I stopped the erigon/rpcdaemon/downloader and then restarted them again.\r\n\r\nMy version:\r\n`erigon version 2022.99.99-dev-13a1b3c1`",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1140180945/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1140181106",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1140181106",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1140181106,
    "node_id": "IC_kwDOC0FsAM5D9chy",
    "user": {
      "login": "geomad",
      "id": 7707517,
      "node_id": "MDQ6VXNlcjc3MDc1MTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7707517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/geomad",
      "html_url": "https://github.com/geomad",
      "followers_url": "https://api.github.com/users/geomad/followers",
      "following_url": "https://api.github.com/users/geomad/following{/other_user}",
      "gists_url": "https://api.github.com/users/geomad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/geomad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/geomad/subscriptions",
      "organizations_url": "https://api.github.com/users/geomad/orgs",
      "repos_url": "https://api.github.com/users/geomad/repos",
      "events_url": "https://api.github.com/users/geomad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/geomad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-28T05:55:10Z",
    "updated_at": "2022-05-28T05:55:40Z",
    "author_association": "NONE",
    "body": "> what is your version now?\r\n\r\n2022.99.99-dev-8e13ef40\r\nAlso running a new fresh sync in in case we can't solve the issue until that one is done!\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1140181106/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1140319949",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1140319949",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1140319949,
    "node_id": "IC_kwDOC0FsAM5D9-bN",
    "user": {
      "login": "geomad",
      "id": 7707517,
      "node_id": "MDQ6VXNlcjc3MDc1MTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7707517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/geomad",
      "html_url": "https://github.com/geomad",
      "followers_url": "https://api.github.com/users/geomad/followers",
      "following_url": "https://api.github.com/users/geomad/following{/other_user}",
      "gists_url": "https://api.github.com/users/geomad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/geomad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/geomad/subscriptions",
      "organizations_url": "https://api.github.com/users/geomad/orgs",
      "repos_url": "https://api.github.com/users/geomad/repos",
      "events_url": "https://api.github.com/users/geomad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/geomad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-28T19:40:39Z",
    "updated_at": "2022-05-28T19:40:39Z",
    "author_association": "NONE",
    "body": "Looks like my fresh erigon instance is close to fully syncing, so you can close this if you think its not important!\r\nThanks anyways for all the efforts and everything you do!",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1140319949/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1140354655",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1140354655",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1140354655,
    "node_id": "IC_kwDOC0FsAM5D-G5f",
    "user": {
      "login": "johnnydev543",
      "id": 47145436,
      "node_id": "MDQ6VXNlcjQ3MTQ1NDM2",
      "avatar_url": "https://avatars.githubusercontent.com/u/47145436?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/johnnydev543",
      "html_url": "https://github.com/johnnydev543",
      "followers_url": "https://api.github.com/users/johnnydev543/followers",
      "following_url": "https://api.github.com/users/johnnydev543/following{/other_user}",
      "gists_url": "https://api.github.com/users/johnnydev543/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/johnnydev543/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/johnnydev543/subscriptions",
      "organizations_url": "https://api.github.com/users/johnnydev543/orgs",
      "repos_url": "https://api.github.com/users/johnnydev543/repos",
      "events_url": "https://api.github.com/users/johnnydev543/events{/privacy}",
      "received_events_url": "https://api.github.com/users/johnnydev543/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-29T01:30:16Z",
    "updated_at": "2022-05-29T01:30:16Z",
    "author_association": "NONE",
    "body": "> \r\n\r\nCould you stop the client and restart it again to see what will happen?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1140354655/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1140354936",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1140354936",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1140354936,
    "node_id": "IC_kwDOC0FsAM5D-G94",
    "user": {
      "login": "geomad",
      "id": 7707517,
      "node_id": "MDQ6VXNlcjc3MDc1MTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7707517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/geomad",
      "html_url": "https://github.com/geomad",
      "followers_url": "https://api.github.com/users/geomad/followers",
      "following_url": "https://api.github.com/users/geomad/following{/other_user}",
      "gists_url": "https://api.github.com/users/geomad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/geomad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/geomad/subscriptions",
      "organizations_url": "https://api.github.com/users/geomad/orgs",
      "repos_url": "https://api.github.com/users/geomad/repos",
      "events_url": "https://api.github.com/users/geomad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/geomad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-29T01:33:08Z",
    "updated_at": "2022-05-29T01:33:08Z",
    "author_association": "NONE",
    "body": "> > \r\n> \r\n> Could you stop the client and restart it again to see what will happen?\r\n\r\nIn the bugged client it just syncs to the top of the chain then the error appears. In the fresh node I restarted it once while on the call traces stage and it kept syncing normally after the restart.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1140354936/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1140371408",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1140371408",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1140371408,
    "node_id": "IC_kwDOC0FsAM5D-K_Q",
    "user": {
      "login": "johnnydev543",
      "id": 47145436,
      "node_id": "MDQ6VXNlcjQ3MTQ1NDM2",
      "avatar_url": "https://avatars.githubusercontent.com/u/47145436?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/johnnydev543",
      "html_url": "https://github.com/johnnydev543",
      "followers_url": "https://api.github.com/users/johnnydev543/followers",
      "following_url": "https://api.github.com/users/johnnydev543/following{/other_user}",
      "gists_url": "https://api.github.com/users/johnnydev543/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/johnnydev543/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/johnnydev543/subscriptions",
      "organizations_url": "https://api.github.com/users/johnnydev543/orgs",
      "repos_url": "https://api.github.com/users/johnnydev543/repos",
      "events_url": "https://api.github.com/users/johnnydev543/events{/privacy}",
      "received_events_url": "https://api.github.com/users/johnnydev543/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-29T03:48:12Z",
    "updated_at": "2022-05-29T03:48:12Z",
    "author_association": "NONE",
    "body": "My latest devel client: `erigon version 2022.99.99-dev-438c3933`\r\nI resynced it on kiln network, and it keeps emitting:\r\n`erigon_kiln   | [INFO] [05-29|11:37:24.589] RPC Daemon notified of new headers       from=55127 to=0 header sending=6.292µs log sending=196ns`\r\nIs this normal?\r\n```\r\nerigon_kiln   | [INFO] [05-29|11:37:06.262] [p2p] GoodPeers                          eth66=6\r\nerigon_kiln   | [INFO] [05-29|11:37:06.286] Downloaded PoS Headers                   now=548581 blk/sec=6.400\r\nerigon_kiln   | [INFO] [05-29|11:37:07.000] Requested                                anchor=0xd941cc74ed64aa60b3b3c9fe5b0e899ebe4dc32a44fd59ae13f7671a88e4d824\r\nerigon_kiln   | [INFO] [05-29|11:37:07.343] Requested                                anchor=0x3dff4d05d5ddf8bb43605264c076b47d4102d669a13a210be20b1fb77303f395\r\nerigon_kiln   | [INFO] [05-29|11:37:12.001] Requested                                anchor=0x3dff4d05d5ddf8bb43605264c076b47d4102d669a13a210be20b1fb77303f395\r\nerigon_kiln   | [INFO] [05-29|11:37:12.210] Requested                                anchor=0x8366d38fb298162e2f07dee7e8c71b2c7912ae1e7a7e9c28dd05b5c3431a5d11\r\nerigon_kiln   | [INFO] [05-29|11:37:13.107] [1/16 Headers] New payload missing parent\r\nerigon_kiln   | [INFO] [05-29|11:37:13.107] Timings (slower than 50ms)               Headers=11.966s\r\nerigon_kiln   | [INFO] [05-29|11:37:13.107] RPC Daemon notified of new headers       from=55127 to=0 header sending=6.707µs log sending=210ns\r\nerigon_kiln   | [INFO] [05-29|11:37:13.108] [1/16 Headers] Waiting for Beacon Chain...\r\nerigon_kiln   | [INFO] [05-29|11:37:13.126] [1/16 Headers] Handling fork choice      headerHash=0x5dccd4e29662fc8312049093a11267664317606f6d7619263d615e2bf0190b7e\r\nerigon_kiln   | [INFO] [05-29|11:37:13.126] [1/16 Headers] Fork choice missing header\r\nerigon_kiln   | [INFO] [05-29|11:37:13.127] RPC Daemon notified of new headers       from=55127 to=0 header sending=3.191µs log sending=194ns\r\nerigon_kiln   | [INFO] [05-29|11:37:13.127] [1/16 Headers] Waiting for Beacon Chain...\r\nerigon_kiln   | [INFO] [05-29|11:37:17.000] Requested                                anchor=0x8366d38fb298162e2f07dee7e8c71b2c7912ae1e7a7e9c28dd05b5c3431a5d11\r\nerigon_kiln   | [INFO] [05-29|11:37:18.702] [snapshots] Dumping txs                  block num=22974 alloc=1.2Gb sys=3.3Gb\r\nerigon_kiln   | [INFO] [05-29|11:37:22.000] Requested                                anchor=0x8366d38fb298162e2f07dee7e8c71b2c7912ae1e7a7e9c28dd05b5c3431a5d11\r\nerigon_kiln   | [INFO] [05-29|11:37:24.588] [1/16 Headers] New payload missing parent\r\nerigon_kiln   | [INFO] [05-29|11:37:24.589] Timings (slower than 50ms)               Headers=11.461s\r\nerigon_kiln   | [INFO] [05-29|11:37:24.589] RPC Daemon notified of new headers       from=55127 to=0 header sending=6.292µs log sending=196ns\r\nerigon_kiln   | [INFO] [05-29|11:37:24.589] [1/16 Headers] Waiting for Beacon Chain...\r\nerigon_kiln   | [INFO] [05-29|11:37:24.608] [1/16 Headers] Handling fork choice      headerHash=0x246b519a537ec01be639ed69ca5a141b7679070635d9baa7d5bbe52173ed4688\r\nerigon_kiln   | [INFO] [05-29|11:37:24.608] [1/16 Headers] Fork choice missing header\r\nerigon_kiln   | [INFO] [05-29|11:37:24.608] RPC Daemon notified of new headers       from=55127 to=0 header sending=6.048µs log sending=213ns\r\nerigon_kiln   | [INFO] [05-29|11:37:24.608] [1/16 Headers] Waiting for Beacon Chain...\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1140371408/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1141001609",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1141001609",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1141001609,
    "node_id": "IC_kwDOC0FsAM5EAk2J",
    "user": {
      "login": "geomad",
      "id": 7707517,
      "node_id": "MDQ6VXNlcjc3MDc1MTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7707517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/geomad",
      "html_url": "https://github.com/geomad",
      "followers_url": "https://api.github.com/users/geomad/followers",
      "following_url": "https://api.github.com/users/geomad/following{/other_user}",
      "gists_url": "https://api.github.com/users/geomad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/geomad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/geomad/subscriptions",
      "organizations_url": "https://api.github.com/users/geomad/orgs",
      "repos_url": "https://api.github.com/users/geomad/repos",
      "events_url": "https://api.github.com/users/geomad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/geomad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-30T10:45:29Z",
    "updated_at": "2022-05-30T10:48:58Z",
    "author_association": "NONE",
    "body": "Ugh ok... looks like the freshly synced node is broken as well. Error message looks different though.\r\n\r\nIt synced normally and started to receive new blocks normally. In the background for another day, it was doing work with snapshots, although it looked like it was repeating jobs in the same blocks a few times. (Dumping txs, building indices and Replacement preprocessing). I can provide logs if needed.\r\n\r\nI let it finish everything without touching it, and after it was done, although syncing new blocks looked it was working normally, RPC calls were returning irregular results (I think state was empty?)\r\nSince I saw it was not doing any more jobs with snapshots in the background, I went ahead, updated to the latest devel (e5c8a9a1bfe87e700c3d099284938443f7a5b272) and restarted.\r\nFor a few blocks the node started working properly and RPC calls were also working.\r\nAfter that it started to panic, with restarts not solving the issue.\r\n\r\nIt looks like this is a serious bug, and not an edge case.\r\n\r\n```\r\nRPC Daemon notified of new headers       from=14872078 to=14872079 header sending=8.135µs log sending=160ns\r\n[1/16 Headers] Waiting for headers...    from=14872079\r\n[1/16 Headers] Wrote block headers       number=14872079 blk/second=0.000 alloc=2.7Gb sys=3.6Gb\r\nReq/resp stats                           req=0 reqMin=0 reqMax=0 skel=0 skelMin=0 skelMax=0 resp=9 respMin=14872077 respMax=14872079\r\n[1/16 Headers] Processed                 highest inserted=14872080 age=21s\r\n[6/16 Execution] Completed on            block=14872080\r\nTimings (slower than 50ms)               Headers=20.163s Execution=136ms HashState=77ms IntermediateHashes=149ms CallTraces=57ms\r\nTables                                   freelist=49.5Mb PlainState=66.5Gb AccountChangeSet=151.7Gb StorageChangeSet=221.0Gb BlockTransaction=13.6Gb TransactionLog=398.2Gb\r\nCommit cycle                             in=55.571355ms\r\nRPC Daemon notified of new headers       from=14872079 to=14872080 header sending=5.371µs log sending=140ns\r\n[1/16 Headers] Waiting for headers...    from=14872080\r\n[1/16 Headers] Processed                 highest inserted=14872081 age=4s\r\n[6/16 Execution] Completed on            block=14872081\r\nTimings (slower than 50ms)               Headers=3.533s\r\nTables                                   freelist=49.5Mb PlainState=66.5Gb AccountChangeSet=151.7Gb StorageChangeSet=221.0Gb BlockTransaction=13.6Gb TransactionLog=398.2Gb\r\nCommit cycle                             in=12.465935ms\r\nRPC Daemon notified of new headers       from=14872080 to=14872081 header sending=5.711µs log sending=160ns\r\n[1/16 Headers] Waiting for headers...    from=14872081\r\n[1/16 Headers] Wrote block headers       number=14872081 blk/second=0.000 alloc=2.8Gb sys=3.6Gb\r\nReq/resp stats                           req=0 reqMin=0 reqMax=0 skel=0 skelMin=0 skelMax=0 resp=9 respMin=5749808 respMax=14872081\r\npanic: runtime error: index out of range [0] with length 0\r\ngoroutine 3576 [running]:\r\ngithub.com/ledgerwatch/erigon/core/types.(*Block).SendersToTxs(...)\r\n        github.com/ledgerwatch/erigon/core/types/block.go:1233\r\ngithub.com/ledgerwatch/erigon/core/rawdb.ReadReceipts({0x1ea3200?, 0xc08f867bf0?}, 0xc08f86a2d0, {0x2b96920?, 0x0, 0x0})\r\n        github.com/ledgerwatch/erigon/core/rawdb/accessors_chain.go:888 +0x4de\r\ngithub.com/ledgerwatch/erigon/core/rawdb.ReadReceiptsByHash({0x1ea3200?, 0xc08f867bf0}, {0x8b, 0x7d, 0xff, 0x52, 0xca, 0x77, 0xc3, 0x4a, ...})\r\n        github.com/ledgerwatch/erigon/core/rawdb/accessors_chain.go:912 +0x166\r\ngithub.com/ledgerwatch/erigon/eth/protocols/eth.AnswerGetReceiptsQuery({0x1ea3200?, 0xc08f867bf0}, {0xc08f6d6d80?, 0x3, 0xc08f837400?})\r\n        github.com/ledgerwatch/erigon/eth/protocols/eth/handlers.go:180 +0x14f\r\ngithub.com/ledgerwatch/erigon/cmd/sentry/sentry.(*MultiClient).getReceipts66(0xc09d494500, {0x1e98948, 0xc000736600}, 0xc08f7acbe0, {0x1ea5a98, 0xc00170c288})\r\n        github.com/ledgerwatch/erigon/cmd/sentry/sentry/sentry_multi_client.go:588 +0x21a\r\ngithub.com/ledgerwatch/erigon/cmd/sentry/sentry.(*MultiClient).handleInboundMessage(0xc0a66cc638?, {0x1e98948?, 0xc000736600?}, 0x467b16?, {0x1ea5a98?, 0xc00170c288?})\r\n        github.com/ledgerwatch/erigon/cmd/sentry/sentry/sentry_multi_client.go:658 +0xb4\r\ngithub.com/ledgerwatch/erigon/cmd/sentry/sentry.(*MultiClient).HandleInboundMessage(0x432711?, {0x1e98948, 0xc000736600}, 0xc08f7acbe0, {0x1ea5a98?, 0xc00170c288?})\r\n        github.com/ledgerwatch/erigon/cmd/sentry/sentry/sentry_multi_client.go:623 +0x5d\r\ngithub.com/ledgerwatch/erigon/cmd/sentry/sentry.pumpStreamLoop[...].func2()\r\n        github.com/ledgerwatch/erigon/cmd/sentry/sentry/sentry_multi_client.go:210 +0xde\r\ncreated by github.com/ledgerwatch/erigon/cmd/sentry/sentry.pumpStreamLoop[...]\r\n        github.com/ledgerwatch/erigon/cmd/sentry/sentry/sentry_multi_client.go:208 +0x2ce\r\n\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1141001609/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1141185402",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1141185402",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1141185402,
    "node_id": "IC_kwDOC0FsAM5EBRt6",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-30T13:51:47Z",
    "updated_at": "2022-05-30T13:51:47Z",
    "author_association": "COLLABORATOR",
    "body": "@geomad fixed by https://github.com/ledgerwatch/erigon/pull/4308 (just update)",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1141185402/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1141214598",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1141214598",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1141214598,
    "node_id": "IC_kwDOC0FsAM5EBY2G",
    "user": {
      "login": "geomad",
      "id": 7707517,
      "node_id": "MDQ6VXNlcjc3MDc1MTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7707517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/geomad",
      "html_url": "https://github.com/geomad",
      "followers_url": "https://api.github.com/users/geomad/followers",
      "following_url": "https://api.github.com/users/geomad/following{/other_user}",
      "gists_url": "https://api.github.com/users/geomad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/geomad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/geomad/subscriptions",
      "organizations_url": "https://api.github.com/users/geomad/orgs",
      "repos_url": "https://api.github.com/users/geomad/repos",
      "events_url": "https://api.github.com/users/geomad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/geomad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-30T14:19:34Z",
    "updated_at": "2022-05-30T14:19:34Z",
    "author_association": "NONE",
    "body": "> @geomad fixed by #4308 (just update)\r\n\r\nIt's working now thanks! Btw I have also kept a copy of the old node, so if you need me to test anything about the original issue just let me know!",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1141214598/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1141570250",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4240#issuecomment-1141570250",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4240",
    "id": 1141570250,
    "node_id": "IC_kwDOC0FsAM5ECvrK",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-31T01:04:26Z",
    "updated_at": "2022-05-31T01:04:26Z",
    "author_association": "COLLABORATOR",
    "body": "Probably don’t need. We already did much hack and used many versions there. Thank you. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1141570250/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
