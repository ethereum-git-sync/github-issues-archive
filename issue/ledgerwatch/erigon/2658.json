{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2658",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2658/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2658/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2658/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/2658",
  "id": 993198364,
  "node_id": "MDU6SXNzdWU5OTMxOTgzNjQ=",
  "number": 2658,
  "title": "[AuRa] Eliminate `HeadersSeal` function and associated environment variable",
  "user": {
    "login": "AlexeyAkhunov",
    "id": 13686139,
    "node_id": "MDQ6VXNlcjEzNjg2MTM5",
    "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AlexeyAkhunov",
    "html_url": "https://github.com/AlexeyAkhunov",
    "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
    "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
    "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
    "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
    "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-09-10T12:41:03Z",
  "updated_at": "2022-06-30T17:00:21Z",
  "closed_at": "2022-06-30T17:00:21Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "We are working on the support of AuRa consensus in Erigon, and some initial work has been done by @AskAlexSharov to support Sokol POA network. This work needs to continue.\r\n\r\nIn AuRa, block headers have an extra field, called \"Seal\", which does not appear in any non-AuRa network. This makes is tricker to parse block headers RLP and serialise headers into RLP. Currently as a \"quick-fix\", there is a function that uses environment variable that switches the parsing and serialisation behaviour:\r\n\r\nhttps://github.com/ledgerwatch/erigon/blob/71ec0938b5691d34a2d5940c67db62c7d11aa086/common/debug/experiments.go#L112\r\n\r\nFind the usages of this function throughout the code. Then replace this with \"proper\" configuration, starting from this structure: https://github.com/ledgerwatch/erigon/blob/71ec0938b5691d34a2d5940c67db62c7d11aa086/params/config.go#L165\r\n\r\nIn that structure, `ChainConfig`, we can introduce a enum field that tells us which type of consensus it is (EtHash, Clique, AuRa). And then, this needs to be passed around to the code where parsing of block header RLPs and serialisation of block headers happens, instead of relying of `HeadersSeal` function and the environment variable.\r\n",
  "closed_by": {
    "login": "mandrigin",
    "id": 466427,
    "node_id": "MDQ6VXNlcjQ2NjQyNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/466427?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mandrigin",
    "html_url": "https://github.com/mandrigin",
    "followers_url": "https://api.github.com/users/mandrigin/followers",
    "following_url": "https://api.github.com/users/mandrigin/following{/other_user}",
    "gists_url": "https://api.github.com/users/mandrigin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mandrigin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mandrigin/subscriptions",
    "organizations_url": "https://api.github.com/users/mandrigin/orgs",
    "repos_url": "https://api.github.com/users/mandrigin/repos",
    "events_url": "https://api.github.com/users/mandrigin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mandrigin/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2658/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2658/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/916875833",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2658#issuecomment-916875833",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2658",
    "id": 916875833,
    "node_id": "IC_kwDOC0FsAM42pmo5",
    "user": {
      "login": "AlexeyAkhunov",
      "id": 13686139,
      "node_id": "MDQ6VXNlcjEzNjg2MTM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AlexeyAkhunov",
      "html_url": "https://github.com/AlexeyAkhunov",
      "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
      "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
      "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
      "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
      "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-10T12:43:23Z",
    "updated_at": "2021-09-10T12:43:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "In order to activate one of these `ChainConfig` choices, Erigon needs to be launched with the option `--chain <chain_name>`, for example, `--chain sokol`. Though with Sokol currently, it is very hard to find good peers",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/916875833/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/917946407",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2658#issuecomment-917946407",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2658",
    "id": 917946407,
    "node_id": "IC_kwDOC0FsAM42tsAn",
    "user": {
      "login": "e-danko",
      "id": 89912851,
      "node_id": "MDQ6VXNlcjg5OTEyODUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/89912851?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/e-danko",
      "html_url": "https://github.com/e-danko",
      "followers_url": "https://api.github.com/users/e-danko/followers",
      "following_url": "https://api.github.com/users/e-danko/following{/other_user}",
      "gists_url": "https://api.github.com/users/e-danko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/e-danko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/e-danko/subscriptions",
      "organizations_url": "https://api.github.com/users/e-danko/orgs",
      "repos_url": "https://api.github.com/users/e-danko/repos",
      "events_url": "https://api.github.com/users/e-danko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/e-danko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-13T08:09:52Z",
    "updated_at": "2021-09-13T08:09:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hello ! I'll take this issue, please do not assign it.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/917946407/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
