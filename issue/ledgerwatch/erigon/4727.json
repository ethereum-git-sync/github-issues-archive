{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4727",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4727/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4727/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4727/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/4727",
  "id": 1306697364,
  "node_id": "I_kwDOC0FsAM5N4p6U",
  "number": 4727,
  "title": "2022.99.99-dev-b6440eea - devel failing to sync: err=\"[1/16 Headers] ancestor is nil. height 1, hash d4e56740f876aef8c010b86a40d5f56745a118d0906a34e69aec8c0db1cb8fa3\"",
  "user": {
    "login": "breezytm",
    "id": 3412923,
    "node_id": "MDQ6VXNlcjM0MTI5MjM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3412923?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/breezytm",
    "html_url": "https://github.com/breezytm",
    "followers_url": "https://api.github.com/users/breezytm/followers",
    "following_url": "https://api.github.com/users/breezytm/following{/other_user}",
    "gists_url": "https://api.github.com/users/breezytm/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/breezytm/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/breezytm/subscriptions",
    "organizations_url": "https://api.github.com/users/breezytm/orgs",
    "repos_url": "https://api.github.com/users/breezytm/repos",
    "events_url": "https://api.github.com/users/breezytm/events{/privacy}",
    "received_events_url": "https://api.github.com/users/breezytm/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-07-16T03:55:51Z",
  "updated_at": "2022-07-28T02:26:49Z",
  "closed_at": "2022-07-28T02:26:49Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: `./erigon version 2022.99.99-dev-b6440eea`\r\n\r\nOS & Version: ``Ubuntu 20.04 LTS``\r\n\r\n#### Expected behaviour\r\n\r\nErigon sync normally after downloading the snapshot\r\n\r\n#### Actual behaviour\r\n\r\nErigon throws the following error endlessly ``err=\"[1/16 Headers] ancestor is nil. height 1, hash d4e56740f876aef8c010b86a40d5f56745a118d0906a34e69aec8c0db1cb8fa3\"``\r\n\r\n#### Steps to reproduce the behavior\r\n\r\ndocker-compose.yml\r\n\r\n```\r\nversion: '2.2'\r\n\r\n# Basic erigon's service\r\nservices:\r\n  erigon:\r\n    image: thorax/erigon:${TAG:-devel}\r\n    user: root\r\n    command: erigon ${ERIGON_FLAGS-} --datadir=/home/erigon/.local/share/erigon --private.api.addr=0.0.0.0:9090 --downloader.api.addr=downloader:9093\r\n    volumes:\r\n      # This is \"datadir\". It's ok to mount sub-dirs of \"datadir\" to different drives\r\n      - ./data/erigon:/home/erigon/.local/share/erigon\r\n    ports:\r\n      - \"30306:30303/tcp\"\r\n      - \"30306:30303/udp\"\r\n    restart: unless-stopped\r\n\r\n  downloader:\r\n    image: thorax/erigon:${TAG:-devel}\r\n    user: root\r\n    command: downloader ${DOWNLOADER_FLAGS-} --downloader.api.addr=0.0.0.0:9093 --torrent.download.rate=100mb  --torrent.download.slots=6\r\n    pid: service:erigon # Use erigon's PID namespace. It's required to open Erigon's DB from another process (RPCDaemon local-mode)\r\n    volumes_from:\r\n      - erigon\r\n    ports: [ \"42069:42069/tcp\", \"42069:42069/udp\" ]\r\n\r\n  rpcdaemon: # Service to server JSON-RCP API\r\n    image: thorax/erigon:${TAG:-devel}\r\n    user: root\r\n    command: rpcdaemon --datadir=/home/erigon/.local/share/erigon --private.api.addr=erigon:9090 --txpool.api.addr=erigon:9090 --http.addr=0.0.0.0 --http.vhosts=* --http.corsdomain=* --http.api=eth,debug,net,trace,web3 --ws\r\n    pid: service:erigon # Use erigon's PID namespace. It's required to open Erigon's DB from another process (RPCDaemon local-mode)\r\n    volumes_from:\r\n      - erigon\r\n    ports:\r\n      - \"8585:8545\"\r\n    restart: unless-stopped\r\n```\r\n#### Backtrace\r\n\r\n````\r\nerigon_1      | [INFO] [07-16|00:46:29.376] [txpool] stat                            block=0 pending=1 baseFee=0 queued=180 alloc=467.2MB sys=840.2MB\r\ndownloader_1  | [INFO] [07-16|00:46:30.268] [Snapshots] Downloading                  progress=\"98.96% 205.3GB/207.5GB\" download=28.8MB/s upload=0B/s peers=15 connections=16 files=87\r\nerigon_1      | [INFO] [07-16|00:46:39.401] [Snapshots] download                     progress=\"99.30% 206.1GB/207.5GB\" download=37.0MB/s upload=0B/s peers=16 connections=16 files=87 alloc=493.2MB sys=840.2MB\r\ndownloader_1  | [INFO] [07-16|00:46:50.280] [Snapshots] Downloading                  progress=\"99.30% 206.1GB/207.5GB\" download=37.0MB/s upload=0B/s peers=16 connections=16 files=87\r\nerigon_1      | [INFO] [07-16|00:46:59.403] [Snapshots] download                     progress=\"99.63% 206.8GB/207.5GB\" download=35.1MB/s upload=0B/s peers=14 connections=14 files=87 alloc=530.5MB sys=840.2MB\r\ndownloader_1  | [INFO] [07-16|00:47:10.268] [Snapshots] Downloading                  progress=\"99.63% 206.8GB/207.5GB\" download=35.1MB/s upload=0B/s peers=14 connections=14 files=87\r\nerigon_1      | [INFO] [07-16|00:47:19.402] [Snapshots] download                     progress=\"99.97% 207.4GB/207.5GB\" download=35.5MB/s upload=0B/s peers=11 connections=11 files=87 alloc=567.2MB sys=840.2MB\r\nerigon_1      | [INFO] [07-16|00:47:29.339] [p2p] GoodPeers                          eth66=33\r\nerigon_1      | [INFO] [07-16|00:47:29.377] [txpool] stat                            block=0 pending=1 baseFee=0 queued=180 alloc=404.6MB sys=840.2MB\r\ndownloader_1  | [INFO] [07-16|00:47:30.268] [Snapshots] Downloading                  progress=\"99.97% 207.4GB/207.5GB\" download=35.5MB/s upload=0B/s peers=11 connections=11 files=87\r\ndownloader_1  | [INFO] [07-16|00:47:50.267] [Snapshots] Seeding                      up=0B/s peers=3 connections=3 files=87\r\ndownloader_1  | [INFO] [07-16|00:47:59.407] [snapshots] Verifying                    progress=17.79%\r\ndownloader_1  | [INFO] [07-16|00:48:10.268] [Snapshots] Seeding                      up=819.2PB/s peers=1 connections=1 files=87\r\ndownloader_1  | [INFO] [07-16|00:48:19.429] [snapshots] Verifying                    progress=34.79%\r\nerigon_1      | [INFO] [07-16|00:48:29.377] [txpool] stat                            block=0 pending=1 baseFee=0 queued=180 alloc=487.7MB sys=840.2MB\r\ndownloader_1  | [INFO] [07-16|00:48:30.268] [Snapshots] Seeding                      up=0B/s peers=2 connections=2 files=87\r\ndownloader_1  | [INFO] [07-16|00:48:39.407] [snapshots] Verifying                    progress=51.65%\r\ndownloader_1  | [INFO] [07-16|00:48:50.268] [Snapshots] Seeding                      up=0B/s peers=4 connections=4 files=87\r\ndownloader_1  | [INFO] [07-16|00:48:59.403] [snapshots] Verifying                    progress=67.77%\r\ndownloader_1  | [INFO] [07-16|00:49:10.268] [Snapshots] Seeding                      up=0B/s peers=3 connections=3 files=87\r\ndownloader_1  | [INFO] [07-16|00:49:19.403] [snapshots] Verifying                    progress=81.12%\r\nerigon_1      | [INFO] [07-16|00:49:29.339] [p2p] GoodPeers                          eth66=33\r\nerigon_1      | [INFO] [07-16|00:49:29.415] [txpool] stat                            block=0 pending=1 baseFee=0 queued=180 alloc=379.9MB sys=840.2MB\r\ndownloader_1  | [INFO] [07-16|00:49:30.267] [Snapshots] Seeding                      up=0B/s peers=4 connections=4 files=87\r\ndownloader_1  | [INFO] [07-16|00:49:39.402] [snapshots] Verifying                    progress=92.34%\r\ndownloader_1  | [INFO] [07-16|00:49:50.268] [Snapshots] Seeding                      up=0B/s peers=3 connections=3 files=87\r\ndownloader_1  | [INFO] [07-16|00:49:59.404] [snapshots] Verifying                    progress=99.90%\r\nerigon_1      | [INFO] [07-16|00:50:00.135] [Snapshots] Stat                         blocks=0 segments=0 indices=0 alloc=433.4MB sys=840.2MB\r\nerigon_1      | [EROR] [07-16|00:50:00.135] Staged Sync                              err=\"[1/16 Headers] ancestor is nil. height 1, hash d4e56740f876aef8c010b86a40d5f56745a118d0906a34e69aec8c0db1cb8fa3\"\r\nrpcdaemon_1   | [INFO] [07-16|00:50:00.136] [Snapshots] see new                      blocks=0\r\nerigon_1      | [INFO] [07-16|00:50:00.636] [Snapshots] Fetching torrent files metadata \r\nerigon_1      | [INFO] [07-16|00:50:00.638] [Snapshots] Stat                         blocks=0 segments=0 indices=0 alloc=434.1MB sys=840.2MB\r\nerigon_1      | [EROR] [07-16|00:50:00.638] Staged Sync                              err=\"[1/16 Headers] ancestor is nil. height 1, hash d4e56740f876aef8c010b86a40d5f56745a118d0906a34e69aec8c0db1cb8fa3\"\r\nrpcdaemon_1   | [INFO] [07-16|00:50:00.639] [Snapshots] see new                      blocks=0\r\nerigon_1      | [INFO] [07-16|00:50:01.139] [Snapshots] Fetching torrent files metadata \r\nerigon_1      | [INFO] [07-16|00:50:01.141] [Snapshots] Stat                         blocks=0 segments=0 indices=0 alloc=435.4MB sys=840.2MB\r\nrpcdaemon_1   | [INFO] [07-16|00:50:01.141] [Snapshots] see new                      blocks=0\r\nerigon_1      | [EROR] [07-16|00:50:01.141] Staged Sync                              err=\"[1/16 Headers] ancestor is nil. height 1, hash d4e56740f876aef8c010b86a40d5f56745a118d0906a34e69aec8c0db1cb8fa3\"\r\nerigon_1      | [INFO] [07-16|00:50:01.642] [Snapshots] Fetching torrent files metadata \r\nerigon_1      | [INFO] [07-16|00:50:01.644] [Snapshots] Stat                         blocks=0 segments=0 indices=0 alloc=436.8MB sys=840.2MB\r\nrpcdaemon_1   | [INFO] [07-16|00:50:01.644] [Snapshots] see new                      blocks=0\r\nerigon_1      | [EROR] [07-16|00:50:01.644] Staged Sync                              err=\"[1/16 Headers] ancestor is nil. height 1, hash d4e56740f876aef8c010b86a40d5f56745a118d0906a34e69aec8c0db1cb8fa3\"\r\nerigon_1      | [INFO] [07-16|00:50:02.145] [Snapshots] Fetching torrent files metadata \r\nerigon_1      | [INFO] [07-16|00:50:02.147] [Snapshots] Stat                         blocks=0 segments=0 indices=0 alloc=438.5MB sys=840.2MB\r\nerigon_1      | [EROR] [07-16|00:50:02.147] Staged Sync                              err=\"[1/16 Headers] ancestor is nil. height 1, hash d4e56740f876aef8c010b86a40d5f56745a118d0906a34e69aec8c0db1cb8fa3\"\r\nrpcdaemon_1   | [INFO] [07-16|00:50:02.147] [Snapshots] see new                      blocks=0\r\nerigon_1      | [INFO] [07-16|00:50:02.648] [Snapshots] Fetching torrent files metadata \r\nerigon_1      | [INFO] [07-16|00:50:02.650] [Snapshots] Stat                         blocks=0 segments=0 indices=0 alloc=439.9MB sys=840.2MB\r\nerigon_1      | [EROR] [07-16|00:50:02.650] Staged Sync                              err=\"[1/16 Headers] ancestor is nil. height 1, hash d4e56740f876aef8c010b86a40d5f56745a118d0906a34e69aec8c0db1cb8fa3\"\r\nrpcdaemon_1   | [INFO] [07-16|00:50:02.650] [Snapshots] see new                      blocks=0\r\n````\r\n",
  "closed_by": {
    "login": "AskAlexSharov",
    "id": 46885206,
    "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AskAlexSharov",
    "html_url": "https://github.com/AskAlexSharov",
    "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
    "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
    "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
    "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
    "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4727/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4727/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1190188094",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4727#issuecomment-1190188094",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4727",
    "id": 1190188094,
    "node_id": "IC_kwDOC0FsAM5G8NQ-",
    "user": {
      "login": "awskii",
      "id": 9694143,
      "node_id": "MDQ6VXNlcjk2OTQxNDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9694143?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/awskii",
      "html_url": "https://github.com/awskii",
      "followers_url": "https://api.github.com/users/awskii/followers",
      "following_url": "https://api.github.com/users/awskii/following{/other_user}",
      "gists_url": "https://api.github.com/users/awskii/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/awskii/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/awskii/subscriptions",
      "organizations_url": "https://api.github.com/users/awskii/orgs",
      "repos_url": "https://api.github.com/users/awskii/repos",
      "events_url": "https://api.github.com/users/awskii/events{/privacy}",
      "received_events_url": "https://api.github.com/users/awskii/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-20T12:01:49Z",
    "updated_at": "2022-07-20T12:01:49Z",
    "author_association": "COLLABORATOR",
    "body": "@breezytm please update erigon to current devel version, it could be fixed already. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1190188094/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
