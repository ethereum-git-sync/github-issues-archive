{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/2506",
  "id": 963652637,
  "node_id": "MDU6SXNzdWU5NjM2NTI2Mzc=",
  "number": 2506,
  "title": "`lighthouse` cannot get deposit data from `erigon`",
  "user": {
    "login": "andrejpodzimek",
    "id": 947737,
    "node_id": "MDQ6VXNlcjk0NzczNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/947737?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/andrejpodzimek",
    "html_url": "https://github.com/andrejpodzimek",
    "followers_url": "https://api.github.com/users/andrejpodzimek/followers",
    "following_url": "https://api.github.com/users/andrejpodzimek/following{/other_user}",
    "gists_url": "https://api.github.com/users/andrejpodzimek/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/andrejpodzimek/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/andrejpodzimek/subscriptions",
    "organizations_url": "https://api.github.com/users/andrejpodzimek/orgs",
    "repos_url": "https://api.github.com/users/andrejpodzimek/repos",
    "events_url": "https://api.github.com/users/andrejpodzimek/events{/privacy}",
    "received_events_url": "https://api.github.com/users/andrejpodzimek/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 16,
  "created_at": "2021-08-09T05:11:13Z",
  "updated_at": "2021-11-20T02:03:11Z",
  "closed_at": "2021-08-19T07:05:26Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: `2021.08.2-alpha`\r\n\r\nOS & Version: ArchLinux (up-to-date)\r\n\r\nCommit hash: dfa2800a6ddf63ef9c7f6284fb6535b0f214736f\r\n\r\n#### Expected behaviour\r\n\r\nThe `lighthouse` beacon node worked fine with `openethereum`, so I hoped it would work fine with `erigon` as well.\r\n\r\n#### Actual behaviour\r\n\r\nThe `lighthouse` beacon node can‚Äôt get deposits from Eth1. I tried to wipe out `lighthouse`‚Äôs data and let it re-sync, but that didn‚Äôt help.\r\n\r\nBefore the wipeout:\r\n```\r\nlighthouse[1012595]: Aug 09 06:10:40.712 ERRO Failed to update eth1 cache             error: Failed to update eth1 deposit cache: \"FailedToInsertDeposit(NonConsecutive { log_index: 205886, expected: 204947 })\", retry_millis: 60000, service: eth1_rpc\r\n```\r\n\r\nAfter the wipeout:\r\n```\r\nlighthouse[1513063]: Aug 09 06:56:19.940 ERRO Failed to update eth1 cache             error: Failed to update eth1 deposit cache: \"FailedToInsertDeposit(NonConsecutive { log_index: 200598, expected: 0 })\", retry_millis: 60000, service: eth1_rpc\r\n```\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\nNot really sure. This is how I run the processes involved:\r\n\r\n```\r\nerigon \\\r\n    --datadir=/var/lib/erigon/erigon \\\r\n    --ethash.dagdir=/var/lib/erigon/erigon-ethash \\\r\n    --prune=hrtc \\\r\n    --metrics \\\r\n    --metrics.addr=[::1] \\\r\n    --metrics.port=12797 \\\r\n    --private.api.addr=[::1]:10090\r\n```\r\n\r\n```\r\nrpcdaemon \\\r\n    --datadir=/var/lib/erigon/erigon \\\r\n    --http.addr=[::1] \\\r\n    --http.api=eth,erigon,web3,net,debug,trace,txpool,shh \\\r\n    --http.vhosts=my.domain.name \\\r\n    --metrics \\\r\n    --metrics.addr=[::1] \\\r\n    --metrics.port=12794 \\\r\n    --private.api.addr=[::1]:10090\r\n```\r\n\r\n```\r\nlighthouse bn \\\r\n    --datadir /var/lib/lighthouse/beacon \\\r\n    --http \\\r\n    --eth1 \\\r\n    --eth1-endpoints http://my.domain.name:8545 \\\r\n    --block-cache-size 256 \\\r\n    --target-peers 128 \\\r\n    --metrics \\\r\n    --metrics-port 12795\r\n```\r\n\r\n#### Backtrace\r\n\r\nN/A, there is no crash.",
  "closed_by": {
    "login": "andrejpodzimek",
    "id": 947737,
    "node_id": "MDQ6VXNlcjk0NzczNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/947737?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/andrejpodzimek",
    "html_url": "https://github.com/andrejpodzimek",
    "followers_url": "https://api.github.com/users/andrejpodzimek/followers",
    "following_url": "https://api.github.com/users/andrejpodzimek/following{/other_user}",
    "gists_url": "https://api.github.com/users/andrejpodzimek/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/andrejpodzimek/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/andrejpodzimek/subscriptions",
    "organizations_url": "https://api.github.com/users/andrejpodzimek/orgs",
    "repos_url": "https://api.github.com/users/andrejpodzimek/repos",
    "events_url": "https://api.github.com/users/andrejpodzimek/events{/privacy}",
    "received_events_url": "https://api.github.com/users/andrejpodzimek/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/894976767",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2506#issuecomment-894976767",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506",
    "id": 894976767,
    "node_id": "IC_kwDOC0FsAM41WEL_",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-09T06:19:28Z",
    "updated_at": "2021-08-09T06:19:28Z",
    "author_association": "COLLABORATOR",
    "body": "@andrejpodzimek , you can add `--verbosity=4` to RPCDaemon - to see all incoming requests from lighthouse.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/894976767/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/895178574",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2506#issuecomment-895178574",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506",
    "id": 895178574,
    "node_id": "IC_kwDOC0FsAM41W1dO",
    "user": {
      "login": "andrejpodzimek",
      "id": 947737,
      "node_id": "MDQ6VXNlcjk0NzczNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/947737?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/andrejpodzimek",
      "html_url": "https://github.com/andrejpodzimek",
      "followers_url": "https://api.github.com/users/andrejpodzimek/followers",
      "following_url": "https://api.github.com/users/andrejpodzimek/following{/other_user}",
      "gists_url": "https://api.github.com/users/andrejpodzimek/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/andrejpodzimek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andrejpodzimek/subscriptions",
      "organizations_url": "https://api.github.com/users/andrejpodzimek/orgs",
      "repos_url": "https://api.github.com/users/andrejpodzimek/repos",
      "events_url": "https://api.github.com/users/andrejpodzimek/events{/privacy}",
      "received_events_url": "https://api.github.com/users/andrejpodzimek/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-09T12:22:27Z",
    "updated_at": "2021-08-09T12:22:27Z",
    "author_association": "NONE",
    "body": "So I‚Äôve set `--verbosity 4`. For example, for this on the `lighthouse` side‚Ä¶\r\n\r\n```\r\nAug 09 13:55:11 lighthouse[2176284]: Aug 09 13:55:11.739 ERRO Failed to update eth1 cache             error: Failed to update eth1 deposit cache: \"FailedToInsertDeposit(NonConsecutive { log_index: 200607, expected: 0 })\", retry_millis: 60000, service: eth1_rpc\r\n```\r\n\r\n‚Ä¶this appears around the same time on the `rpcdaemon` side:\r\n\r\n```\r\nAug 09 13:55:11 rpcdaemon[2173745]: [DBUG] [08-09|13:55:11] Served                                   conn=[::1]:45948 t=1.761915ms method=eth_getBlockByNumber reqid=1 params=\"[\\\"latest\\\",false]\"\r\nAug 09 13:55:11 rpcdaemon[2173745]: [DBUG] [08-09|13:55:11] Served                                   conn=[::1]:45950 t=2.446303ms method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc4d8ac\\\",\\\"toBlock\\\":\\\"0xc4dc94\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\n```\r\n\r\nIt‚Äôs retried every minute, but to no avail. The `fromBlock` and `toBlock` numbers don‚Äôt change.\r\n\r\nEarlier there‚Äôs a thick cloud of requests where `fromBlock` and `toBlock` _do_ change, but these are only `eth_getLogs` calls (and no `eth_getBlockByNumber`). Unlike the errors above [1 retry per minute], these queries are frequent; here‚Äôs one second worth of those:\r\n\r\n```\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45394 t=80.852¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc27364\\\",\\\"toBlock\\\":\\\"0xc2774c\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45396 t=101.962¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2774c\\\",\\\"toBlock\\\":\\\"0xc27b34\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45398 t=135.716¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc27b34\\\",\\\"toBlock\\\":\\\"0xc27f1c\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45400 t=120.868¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc27f1c\\\",\\\"toBlock\\\":\\\"0xc28304\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45402 t=91.912¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc28304\\\",\\\"toBlock\\\":\\\"0xc286ec\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45404 t=131.096¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc286ec\\\",\\\"toBlock\\\":\\\"0xc28ad4\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45406 t=124.734¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc28ad4\\\",\\\"toBlock\\\":\\\"0xc28ebc\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45408 t=105.869¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc28ebc\\\",\\\"toBlock\\\":\\\"0xc292a4\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45410 t=72.878¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc292a4\\\",\\\"toBlock\\\":\\\"0xc2968c\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45412 t=88.466¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2968c\\\",\\\"toBlock\\\":\\\"0xc29a74\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45414 t=87.505¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc29a74\\\",\\\"toBlock\\\":\\\"0xc29e5c\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45416 t=130.335¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc29e5c\\\",\\\"toBlock\\\":\\\"0xc2a244\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45418 t=154.06¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2a244\\\",\\\"toBlock\\\":\\\"0xc2a62c\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45420 t=94.919¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2a62c\\\",\\\"toBlock\\\":\\\"0xc2aa14\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45422 t=152.748¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2aa14\\\",\\\"toBlock\\\":\\\"0xc2adfc\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45424 t=188.735¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2adfc\\\",\\\"toBlock\\\":\\\"0xc2b1e4\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45426 t=141.336¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2b1e4\\\",\\\"toBlock\\\":\\\"0xc2b5cc\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45428 t=146.636¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2b5cc\\\",\\\"toBlock\\\":\\\"0xc2b9b4\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45430 t=105.629¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2b9b4\\\",\\\"toBlock\\\":\\\"0xc2bd9c\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45434 t=112.863¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2bd9c\\\",\\\"toBlock\\\":\\\"0xc2c184\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45436 t=123.933¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2c184\\\",\\\"toBlock\\\":\\\"0xc2c56c\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45438 t=78.117¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2c56c\\\",\\\"toBlock\\\":\\\"0xc2c954\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45440 t=131.768¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2c954\\\",\\\"toBlock\\\":\\\"0xc2cd3c\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45442 t=100.038¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2cd3c\\\",\\\"toBlock\\\":\\\"0xc2d124\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45444 t=112.502¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2d124\\\",\\\"toBlock\\\":\\\"0xc2d50c\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45446 t=107.412¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2d50c\\\",\\\"toBlock\\\":\\\"0xc2d8f4\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45448 t=133.521¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2d8f4\\\",\\\"toBlock\\\":\\\"0xc2dcdc\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45452 t=121.99¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2dcdc\\\",\\\"toBlock\\\":\\\"0xc2e0c4\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45454 t=79.73¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2e0c4\\\",\\\"toBlock\\\":\\\"0xc2e4ac\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45456 t=50.324¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2e4ac\\\",\\\"toBlock\\\":\\\"0xc2e894\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45458 t=607.332¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2e894\\\",\\\"toBlock\\\":\\\"0xc2ec7c\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45460 t=121.419¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2ec7c\\\",\\\"toBlock\\\":\\\"0xc2f064\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45462 t=89.889¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2f064\\\",\\\"toBlock\\\":\\\"0xc2f44c\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\nAug 09 13:09:04 rpcdaemon[2173745]: [DBUG] [08-09|13:09:04] Served                                   conn=[::1]:45464 t=173.195¬µs method=eth_getLogs reqid=1 params=\"[{\\\"address\\\":\\\"0x00000000219ab540356cbb839cbe05303d7705fa\\\",\\\"fromBlock\\\":\\\"0xc2f44c\\\",\\\"toBlock\\\":\\\"0xc2f834\\\",\\\"topics\\\":[\\\"0x649bbc62d0e31342afea4e5cd82d4049e7e1ee912fc0889aa790803be39038c5\\\"]}]\"\r\n```\r\n\r\nBut eventually this^^^ stops and only the errors with 1 retry per minute stay around.\r\n\r\n(The outgoing [`lighthouse`] / incoming [`rpcdaemon`] ports differ, because `lighthouse` never reuses a TCP connection and keeps reconnecting, even during its initialization with lots of queries. Not a huge deal on `::1`, but it‚Äôs somewhat ugly still.)",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/895178574/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/895356725",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2506#issuecomment-895356725",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506",
    "id": 895356725,
    "node_id": "IC_kwDOC0FsAM41Xg81",
    "user": {
      "login": "andrejpodzimek",
      "id": 947737,
      "node_id": "MDQ6VXNlcjk0NzczNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/947737?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/andrejpodzimek",
      "html_url": "https://github.com/andrejpodzimek",
      "followers_url": "https://api.github.com/users/andrejpodzimek/followers",
      "following_url": "https://api.github.com/users/andrejpodzimek/following{/other_user}",
      "gists_url": "https://api.github.com/users/andrejpodzimek/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/andrejpodzimek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andrejpodzimek/subscriptions",
      "organizations_url": "https://api.github.com/users/andrejpodzimek/orgs",
      "repos_url": "https://api.github.com/users/andrejpodzimek/repos",
      "events_url": "https://api.github.com/users/andrejpodzimek/events{/privacy}",
      "received_events_url": "https://api.github.com/users/andrejpodzimek/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-09T16:17:27Z",
    "updated_at": "2021-08-09T16:18:33Z",
    "author_association": "NONE",
    "body": "A wild guess: Could this be the problem? `--prune=hrtc`\r\n\r\nIf so, what should I stop pruning to (1) make the deposit queries from Eth2 work but (2) avoid a huge data size increase?\r\n\r\nWhat would happen if I disabled some of the pruning options? Would a ‚Äúpartial re-sync‚Äù of some sort occur or would I have to delete the data directory and sync again? (This is somewhat hypothetical; I still don‚Äôt know if pruning is to blame and which pruning options to disable.)",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/895356725/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/895682962",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2506#issuecomment-895682962",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506",
    "id": 895682962,
    "node_id": "IC_kwDOC0FsAM41YwmS",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-10T02:37:33Z",
    "updated_at": "2021-08-10T02:37:33Z",
    "author_association": "COLLABORATOR",
    "body": "@andrejpodzimek , i don't know how much data lighthouse will request. In your requests:\r\n```\r\nfromBlock\":\"0xc27364\r\n```\r\nmaybe it start from this block, maybe earlier. \r\n\r\nIn my understanding ProofOfStake works based on Receipts/Logs - this is reason why lighthouse calling eth_getLogs\r\nAnd likely there is no \"fixed\" point, but it need logs from last validator set election (or similar event).\r\n\r\nWe have feature-request to not prune data by distance, but keep up to some block number:  https://github.com/ledgerwatch/erigon/issues/2421 - but I didn't work on it. \r\n\r\nI advise to keep last 500K receipts: `--prune=hrtc --prune.r.older=500_000` (or even 1_000_000)\r\nby default it keeps last 90K\r\nOr keep all receipts, by removing `r` from pruning.\r\n\r\nErigon doesn't allow change --prune settings to avoid human mistakes. \r\nCan change it by `./build/bin/integration set_prune --datadir=<datadir> --prune=htc`\r\n\r\nOf course changing pruning option will not re-generate for you old data, and it will just stop deleting - and to get through  300K blocks will take 4 weeks, unless litehouse will not need old data anymore. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/895682962/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/895684027",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2506#issuecomment-895684027",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506",
    "id": 895684027,
    "node_id": "IC_kwDOC0FsAM41Yw27",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-10T02:40:59Z",
    "updated_at": "2021-08-10T02:40:59Z",
    "author_association": "COLLABORATOR",
    "body": "`h` character in --prune means no far history indices, means can't re-execute historical blocks after this threshold to re-generate receipts. \r\nSo, after change your --prune mode, you can update lighthouse and wait, maybe new validator set election will happen. If not, then likely you need re-sync.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/895684027/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/895920544",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2506#issuecomment-895920544",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506",
    "id": 895920544,
    "node_id": "IC_kwDOC0FsAM41Zqmg",
    "user": {
      "login": "andrejpodzimek",
      "id": 947737,
      "node_id": "MDQ6VXNlcjk0NzczNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/947737?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/andrejpodzimek",
      "html_url": "https://github.com/andrejpodzimek",
      "followers_url": "https://api.github.com/users/andrejpodzimek/followers",
      "following_url": "https://api.github.com/users/andrejpodzimek/following{/other_user}",
      "gists_url": "https://api.github.com/users/andrejpodzimek/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/andrejpodzimek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andrejpodzimek/subscriptions",
      "organizations_url": "https://api.github.com/users/andrejpodzimek/orgs",
      "repos_url": "https://api.github.com/users/andrejpodzimek/repos",
      "events_url": "https://api.github.com/users/andrejpodzimek/events{/privacy}",
      "received_events_url": "https://api.github.com/users/andrejpodzimek/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-10T10:36:39Z",
    "updated_at": "2021-08-10T10:36:39Z",
    "author_association": "NONE",
    "body": "Actually, IIUC from #2421, I would need to keep ~2_000_000 receipts to get to the needed ‚ÄúEth2 genesis‚Äù block and, once that block eventually gets pruned, I would then be unable to re-sync `lighthouse` again. So most likely a removal of `r`  is the way to go. I‚Äôll just try that and re-sync; no big deal. Hopefully this won‚Äôt cause a data size explosion. That may be some extra data, but if it enables me to re-sync `lighthouse` (if anything goes wrong with it), then that‚Äôs a plus.\r\n\r\nIn any case, +1 for the `--prune.*.before` feature, which I didn‚Äôt known I needed up until now.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/895920544/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/895923423",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2506#issuecomment-895923423",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506",
    "id": 895923423,
    "node_id": "IC_kwDOC0FsAM41ZrTf",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-10T10:41:48Z",
    "updated_at": "2021-08-10T10:41:48Z",
    "author_association": "COLLABORATOR",
    "body": "All receipts are ~300gb. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/895923423/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/895926094",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2506#issuecomment-895926094",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506",
    "id": 895926094,
    "node_id": "IC_kwDOC0FsAM41Zr9O",
    "user": {
      "login": "andrejpodzimek",
      "id": 947737,
      "node_id": "MDQ6VXNlcjk0NzczNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/947737?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/andrejpodzimek",
      "html_url": "https://github.com/andrejpodzimek",
      "followers_url": "https://api.github.com/users/andrejpodzimek/followers",
      "following_url": "https://api.github.com/users/andrejpodzimek/following{/other_user}",
      "gists_url": "https://api.github.com/users/andrejpodzimek/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/andrejpodzimek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andrejpodzimek/subscriptions",
      "organizations_url": "https://api.github.com/users/andrejpodzimek/orgs",
      "repos_url": "https://api.github.com/users/andrejpodzimek/repos",
      "events_url": "https://api.github.com/users/andrejpodzimek/events{/privacy}",
      "received_events_url": "https://api.github.com/users/andrejpodzimek/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-10T10:46:36Z",
    "updated_at": "2021-08-10T10:46:36Z",
    "author_association": "NONE",
    "body": "+300 GB is feasible with my current storage.\r\n\r\n```\r\nerigon[532516]: [INFO] [08-10|12:40:29] Effective                                prune=\"--prune=htc\"\r\n```\r\n\r\nAlright, this^^^ looks promising. Now I hope I needed to remove _either_ `h` _or_ `r`, not both. :grimacing: Or else I‚Äôll have one more full re-sync to do.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/895926094/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/899098803",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2506#issuecomment-899098803",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506",
    "id": 899098803,
    "node_id": "IC_kwDOC0FsAM41lyiz",
    "user": {
      "login": "andrejpodzimek",
      "id": 947737,
      "node_id": "MDQ6VXNlcjk0NzczNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/947737?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/andrejpodzimek",
      "html_url": "https://github.com/andrejpodzimek",
      "followers_url": "https://api.github.com/users/andrejpodzimek/followers",
      "following_url": "https://api.github.com/users/andrejpodzimek/following{/other_user}",
      "gists_url": "https://api.github.com/users/andrejpodzimek/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/andrejpodzimek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andrejpodzimek/subscriptions",
      "organizations_url": "https://api.github.com/users/andrejpodzimek/orgs",
      "repos_url": "https://api.github.com/users/andrejpodzimek/repos",
      "events_url": "https://api.github.com/users/andrejpodzimek/events{/privacy}",
      "received_events_url": "https://api.github.com/users/andrejpodzimek/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-15T19:27:05Z",
    "updated_at": "2021-08-16T00:47:21Z",
    "author_association": "NONE",
    "body": "So it seems to be working with `--prune=htc` instead of `--prune=hrtc`. `lighthouse` is syncing and doesn‚Äôt complain about anything now.\r\n\r\nBut the size increase ‚Ä¶ oh, the size increase. It would be awesome to have some sort of safe pruning, as #2421 suggests.\r\n\r\nAnother idea: Maybe I could switch `r` pruning in `erigon` **on** again once `lighthouse` gets in sync. (?) What I don‚Äôt entirely understand is whether `lighthouse` stops asking about old blocks after its syncing gets past them or whether it can, in theory, keep asking about them **forever**.\r\n\r\nIn the former case, I would quite happily sacrifice the ability to re-sync `lighthouse` from scratch and enable `r` in `erigon`‚Äôs pruning. (I guess this must be done ‚Äúoffline‚Äù, using `integration set_prune --prune=hrtc ...`, right?) But then if `lighthouse` starts complaining again, I‚Äôll be re-syncing everything again. üò≠",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/899098803/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/899204765",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2506#issuecomment-899204765",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506",
    "id": 899204765,
    "node_id": "IC_kwDOC0FsAM41mMad",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-16T04:26:35Z",
    "updated_at": "2021-08-16T04:26:35Z",
    "author_association": "COLLABORATOR",
    "body": "About `integration set_prune --prune=hrtc ...` - I advise do not use much integration tool unless you really know what you are doing. For example even if you enable prune now - it will delete receipts just fine - but db will not get smaller, it only will stop growth for long time. And maybe - but very unlikely - will shrink a bit in far future. It's nature of LMDB/MDBX databases.   \r\n\r\nAnother option - find correct value of --prune.r.older=... to make lighthouse happy. \r\n\r\nAnother option - zfs with enabled compression - shows 2x compression ratio on Erigon's db (and increasing RAM consumption and Disk IO).\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/899204765/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/900757354",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2506#issuecomment-900757354",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506",
    "id": 900757354,
    "node_id": "IC_kwDOC0FsAM41sHdq",
    "user": {
      "login": "MysticRyuujin",
      "id": 8877131,
      "node_id": "MDQ6VXNlcjg4NzcxMzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8877131?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MysticRyuujin",
      "html_url": "https://github.com/MysticRyuujin",
      "followers_url": "https://api.github.com/users/MysticRyuujin/followers",
      "following_url": "https://api.github.com/users/MysticRyuujin/following{/other_user}",
      "gists_url": "https://api.github.com/users/MysticRyuujin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MysticRyuujin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MysticRyuujin/subscriptions",
      "organizations_url": "https://api.github.com/users/MysticRyuujin/orgs",
      "repos_url": "https://api.github.com/users/MysticRyuujin/repos",
      "events_url": "https://api.github.com/users/MysticRyuujin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MysticRyuujin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-18T02:09:39Z",
    "updated_at": "2021-08-18T02:09:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm fairly certain that the calls are for eth_getLogs so that it can see deposits from the eth1 chain. And since you already got the logs, it should be fine to prune them so long as you're never offline longer than the prune threshold for those logs.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/900757354/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/901663734",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2506#issuecomment-901663734",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506",
    "id": 901663734,
    "node_id": "IC_kwDOC0FsAM41vkv2",
    "user": {
      "login": "andrejpodzimek",
      "id": 947737,
      "node_id": "MDQ6VXNlcjk0NzczNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/947737?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/andrejpodzimek",
      "html_url": "https://github.com/andrejpodzimek",
      "followers_url": "https://api.github.com/users/andrejpodzimek/followers",
      "following_url": "https://api.github.com/users/andrejpodzimek/following{/other_user}",
      "gists_url": "https://api.github.com/users/andrejpodzimek/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/andrejpodzimek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andrejpodzimek/subscriptions",
      "organizations_url": "https://api.github.com/users/andrejpodzimek/orgs",
      "repos_url": "https://api.github.com/users/andrejpodzimek/repos",
      "events_url": "https://api.github.com/users/andrejpodzimek/events{/privacy}",
      "received_events_url": "https://api.github.com/users/andrejpodzimek/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-19T07:05:26Z",
    "updated_at": "2021-08-19T07:05:26Z",
    "author_association": "NONE",
    "body": "Yes, it works. I had a Btrfs snapshot with `--prune=hrtc`, so I snapshotted the `htc` version, restored the `hrtc` one, waited for it to re-sync again, started `lighthouse` again and ‚Ä¶ it works. The data size is _way_ smaller and `lighthouse` is in sync. I wouldn‚Äôt be able to sync `lighthouse` from scratch in this configuration, but at least now I know how to get there if need be.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/901663734/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/912515415",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2506#issuecomment-912515415",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506",
    "id": 912515415,
    "node_id": "IC_kwDOC0FsAM42Y-FX",
    "user": {
      "login": "yorickdowne",
      "id": 71337066,
      "node_id": "MDQ6VXNlcjcxMzM3MDY2",
      "avatar_url": "https://avatars.githubusercontent.com/u/71337066?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yorickdowne",
      "html_url": "https://github.com/yorickdowne",
      "followers_url": "https://api.github.com/users/yorickdowne/followers",
      "following_url": "https://api.github.com/users/yorickdowne/following{/other_user}",
      "gists_url": "https://api.github.com/users/yorickdowne/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yorickdowne/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yorickdowne/subscriptions",
      "organizations_url": "https://api.github.com/users/yorickdowne/orgs",
      "repos_url": "https://api.github.com/users/yorickdowne/repos",
      "events_url": "https://api.github.com/users/yorickdowne/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yorickdowne/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-03T12:52:19Z",
    "updated_at": "2021-09-03T12:52:52Z",
    "author_association": "NONE",
    "body": "> I wouldn‚Äôt be able to sync lighthouse from scratch in this configuration, but at least now I know how to get there if need be.\r\n\r\nThere are two easy ideas for `--prune hrtc` and syncing LH from scratch.\r\n\r\n1) If Erigon is not yet synced, give LH a failover Infura node. `--eth1-endpoints http://erigon-IP:8545,https://InfuraURL`. It will grab what it needs from Infura, and by the time Erigon is done syncing, LH just needs to get new deposit data from it.\r\n2) If Erigon is already synced, switch LH between Infura and Erigon. Start with `--eth1-endpoints https://InfuraURL`, then once deposit data is in, start LH again with `--eth1-endpoints http://erigon-IP:8545,https://InfuraURL`. Exact same procedure if you ever have to remove LH's \"eth1 cache\".\r\n\r\nThat said, yes: I'd love a `--prune.*.before` in Erigon.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/912515415/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/974478119",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2506#issuecomment-974478119",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506",
    "id": 974478119,
    "node_id": "IC_kwDOC0FsAM46FVsn",
    "user": {
      "login": "andrejpodzimek",
      "id": 947737,
      "node_id": "MDQ6VXNlcjk0NzczNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/947737?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/andrejpodzimek",
      "html_url": "https://github.com/andrejpodzimek",
      "followers_url": "https://api.github.com/users/andrejpodzimek/followers",
      "following_url": "https://api.github.com/users/andrejpodzimek/following{/other_user}",
      "gists_url": "https://api.github.com/users/andrejpodzimek/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/andrejpodzimek/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andrejpodzimek/subscriptions",
      "organizations_url": "https://api.github.com/users/andrejpodzimek/orgs",
      "repos_url": "https://api.github.com/users/andrejpodzimek/repos",
      "events_url": "https://api.github.com/users/andrejpodzimek/events{/privacy}",
      "received_events_url": "https://api.github.com/users/andrejpodzimek/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-19T21:16:36Z",
    "updated_at": "2021-11-19T21:16:52Z",
    "author_association": "NONE",
    "body": "Unfortunately, the `--eth1-endpoints` trick has no effect, i.e., one cannot switch to Infura and back. The eth1 endpoint is most likely stored somewhere in the LH database. Attempts to switch to Infura do exactly nothing.\r\n\r\nThis means that while one _can_ bootstrap LH from scratch using Infura, there is _no way_ to switch (back) to a local Erigon. This all-or-nothing setup LH insists on is very annoying.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/974478119/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/974479109",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2506#issuecomment-974479109",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506",
    "id": 974479109,
    "node_id": "IC_kwDOC0FsAM46FV8F",
    "user": {
      "login": "yorickdowne",
      "id": 71337066,
      "node_id": "MDQ6VXNlcjcxMzM3MDY2",
      "avatar_url": "https://avatars.githubusercontent.com/u/71337066?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yorickdowne",
      "html_url": "https://github.com/yorickdowne",
      "followers_url": "https://api.github.com/users/yorickdowne/followers",
      "following_url": "https://api.github.com/users/yorickdowne/following{/other_user}",
      "gists_url": "https://api.github.com/users/yorickdowne/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yorickdowne/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yorickdowne/subscriptions",
      "organizations_url": "https://api.github.com/users/yorickdowne/orgs",
      "repos_url": "https://api.github.com/users/yorickdowne/repos",
      "events_url": "https://api.github.com/users/yorickdowne/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yorickdowne/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-19T21:18:23Z",
    "updated_at": "2021-11-19T21:19:18Z",
    "author_association": "NONE",
    "body": "It is however entirely possible to sync an Erigon that has the requisite logs, by using prune.r.before. Eth-docker has an entrypoint script with the values for Prater and mainnet if you want to take a peek. \r\n\r\nI recommend closing this issue. Prune.*.before is now a thing and solves it.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/974479109/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/974574341",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2506#issuecomment-974574341",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2506",
    "id": 974574341,
    "node_id": "IC_kwDOC0FsAM46FtMF",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-20T02:03:11Z",
    "updated_at": "2021-11-20T02:03:11Z",
    "author_association": "COLLABORATOR",
    "body": "Now we have section in readme https://github.com/ledgerwatch/erigon#beacon-chain\r\nFeel free to update it ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/974574341/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
