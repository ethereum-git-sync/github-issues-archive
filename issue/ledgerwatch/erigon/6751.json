{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6751",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6751/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6751/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6751/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/6751",
  "id": 1563820682,
  "node_id": "I_kwDOC0FsAM5dNgKK",
  "number": 6751,
  "title": "Execution client got stuck",
  "user": {
    "login": "dzmitrykliapkou",
    "id": 51699361,
    "node_id": "MDQ6VXNlcjUxNjk5MzYx",
    "avatar_url": "https://avatars.githubusercontent.com/u/51699361?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dzmitrykliapkou",
    "html_url": "https://github.com/dzmitrykliapkou",
    "followers_url": "https://api.github.com/users/dzmitrykliapkou/followers",
    "following_url": "https://api.github.com/users/dzmitrykliapkou/following{/other_user}",
    "gists_url": "https://api.github.com/users/dzmitrykliapkou/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dzmitrykliapkou/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dzmitrykliapkou/subscriptions",
    "organizations_url": "https://api.github.com/users/dzmitrykliapkou/orgs",
    "repos_url": "https://api.github.com/users/dzmitrykliapkou/repos",
    "events_url": "https://api.github.com/users/dzmitrykliapkou/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dzmitrykliapkou/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4566396003,
      "node_id": "LA_kwDOC0FsAM8AAAABEC2sYw",
      "url": "https://api.github.com/repos/ledgerwatch/erigon/labels/Stale",
      "name": "Stale",
      "color": "ededed",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-01-31T07:48:15Z",
  "updated_at": "2023-03-20T02:33:21Z",
  "closed_at": "2023-03-20T02:33:21Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: thorax/erigon:v2.36.1 and thorax/erigon:v2.37.0\r\n\r\nOS & Version: Amazon Linux 2\r\n\r\nDocker-compose:\r\n```yaml\r\nversion: '2.2'\r\n\r\nservices:\r\n  erigon:\r\n    image: thorax/erigon:v2.37.0\r\n    container_name: erigon\r\n    command:\r\n      - erigon\r\n      - --datadir=/home/erigon/.local/share/erigon\r\n      - --authrpc.jwtsecret=/home/erigon/.local/share/erigon/jwt.hex\r\n      - --externalcl\r\n      - --private.api.addr=0.0.0.0:9090\r\n      - --http\r\n      - --snapshots=false\r\n      - --http.api=eth,erigon,engine,net\r\n      - --http.addr=0.0.0.0\r\n      - --http.vhosts=*\r\n      - --ws\r\n      - --metrics\r\n      - --metrics.addr=0.0.0.0\r\n      - --metrics.port=6060\r\n      - --authrpc.addr=0.0.0.0\r\n      - --authrpc.port=8551\r\n      - --authrpc.vhosts=*\r\n      - --maxpeers=10\r\n      - --log.json\r\n    ports:\r\n      - 30303:30303\r\n      - 30303:30303/udp\r\n      - 8545:8545\r\n      - 6060:6060\r\n    volumes:\r\n      - \"/execution_data:/home/erigon/.local/share/erigon\"\r\n    restart: unless-stopped\r\n    mem_swappiness: 0\r\n    stop_signal: SIGINT\r\n    stop_grace_period: 2m\r\n    logging:\r\n      driver: \"json-file\"\r\n      options:\r\n        max-size: \"2m\"\r\n        max-file: \"10\"\r\n\r\n  lighthouse:\r\n    image: sigp/lighthouse:v3.4.0\r\n    container_name: lighthouse\r\n    depends_on:\r\n      - erigon\r\n    restart: unless-stopped\r\n    ports:\r\n      - \"9000:9000/tcp\"\r\n      - \"9000:9000/udp\"\r\n      - \"3500:5052\"\r\n      - \"5054:5054\"\r\n    volumes:\r\n      - \"/consensus_data/beacon-node:/root/.lighthouse/mainnet\"\r\n      - \"/execution_data:/tmp/execution_data:ro\"\r\n    stop_signal: SIGINT\r\n    stop_grace_period: 2m\r\n    command:\r\n      - lighthouse\r\n      - --network=mainnet\r\n      - beacon\r\n      - --reconstruct-historic-states\r\n      - --http\r\n      - --http-port=5052\r\n      - --http-address=0.0.0.0\r\n      - --execution-endpoint=http://erigon:8551\r\n      - --execution-jwt=/tmp/execution_data/jwt.hex\r\n      - --metrics\r\n      - --metrics-address=0.0.0.0\r\n      - --metrics-port=5054\r\n    logging:\r\n      driver: \"json-file\"\r\n      options:\r\n        max-size: \"2m\"\r\n        max-file: \"10\"\r\n```\r\n\r\nChain/Network: Ethereum mainnet\r\n\r\n#### Expected behaviour\r\nExecution client latest block number grows smoothly\r\n\r\n#### Actual behaviour\r\nErigon got stuck ~12hrs ago at `\"block\":16521673`. Consensus client continue importing new blocks. I tried to update Erigon to v2.37.0. After that it managed to import ~4k blocks in batch but then got stuck again. Also I still see the repeating line in logs:\r\n\r\n```\r\n{\"alloc\":\"3.3GB\",\"baseFee\":24038,\"block\":16521673,\"lvl\":\"info\",\"msg\":\"[txpool] stat\",\"pending\":521,\"queued\":29295,\"sys\":\"5.8GB\",\"t\":\"2023-01-31T07:36:48.502639022Z\"}\r\n```\r\n\r\n#### Steps to reproduce the behaviour\r\nSee docker-compose.yaml\r\n\r\n#### Logs after update to v2.37.0\r\n\r\n[erigon.log](https://github.com/ledgerwatch/erigon/files/10543948/erigon.log)\r\n\r\n\r\nIt is very similar to the issue here: https://github.com/ledgerwatch/erigon/issues/6629\r\nWhat is the reason of such behavior and how we can avoid this? Because now it prevents us from using Erigon as production-ready client \r\n",
  "closed_by": {
    "login": "github-actions[bot]",
    "id": 41898282,
    "node_id": "MDM6Qm90NDE4OTgyODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/github-actions%5Bbot%5D",
    "html_url": "https://github.com/apps/github-actions",
    "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6751/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6751/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1409933428",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/6751#issuecomment-1409933428",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6751",
    "id": 1409933428,
    "node_id": "IC_kwDOC0FsAM5UCeB0",
    "user": {
      "login": "dzmitrykliapkou",
      "id": 51699361,
      "node_id": "MDQ6VXNlcjUxNjk5MzYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/51699361?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dzmitrykliapkou",
      "html_url": "https://github.com/dzmitrykliapkou",
      "followers_url": "https://api.github.com/users/dzmitrykliapkou/followers",
      "following_url": "https://api.github.com/users/dzmitrykliapkou/following{/other_user}",
      "gists_url": "https://api.github.com/users/dzmitrykliapkou/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dzmitrykliapkou/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dzmitrykliapkou/subscriptions",
      "organizations_url": "https://api.github.com/users/dzmitrykliapkou/orgs",
      "repos_url": "https://api.github.com/users/dzmitrykliapkou/repos",
      "events_url": "https://api.github.com/users/dzmitrykliapkou/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dzmitrykliapkou/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-31T08:09:15Z",
    "updated_at": "2023-01-31T08:09:15Z",
    "author_association": "NONE",
    "body": "Looks like after v2.37.0 update and restart the node started importing blocks in batches. \r\n![image](https://user-images.githubusercontent.com/51699361/215702433-844b691c-0fec-4141-b1af-4d87c5f24b7b.png)\r\n\r\nHope it can catch up with the network. But the main question is the same: what is the reason and how to prevent this",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1409933428/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1465419024",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/6751#issuecomment-1465419024",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6751",
    "id": 1465419024,
    "node_id": "IC_kwDOC0FsAM5XWIUQ",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-03-13T02:30:03Z",
    "updated_at": "2023-03-13T02:30:03Z",
    "author_association": "NONE",
    "body": "This issue is stale because it has been open for 40 days with no activity. Remove stale label or comment, or this will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1465419024/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1475523822",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/6751#issuecomment-1475523822",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6751",
    "id": 1475523822,
    "node_id": "IC_kwDOC0FsAM5X8rTu",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-03-20T02:33:20Z",
    "updated_at": "2023-03-20T02:33:20Z",
    "author_association": "NONE",
    "body": "This issue was closed because it has been stalled for 7 days with no activity.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1475523822/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
