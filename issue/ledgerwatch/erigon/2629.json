{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2629",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2629/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2629/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2629/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/2629",
  "id": 988142771,
  "node_id": "MDU6SXNzdWU5ODgxNDI3NzE=",
  "number": 2629,
  "title": "Allow getting data for pending transactions",
  "user": {
    "login": "KaiRo-at",
    "id": 824140,
    "node_id": "MDQ6VXNlcjgyNDE0MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/824140?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/KaiRo-at",
    "html_url": "https://github.com/KaiRo-at",
    "followers_url": "https://api.github.com/users/KaiRo-at/followers",
    "following_url": "https://api.github.com/users/KaiRo-at/following{/other_user}",
    "gists_url": "https://api.github.com/users/KaiRo-at/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/KaiRo-at/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/KaiRo-at/subscriptions",
    "organizations_url": "https://api.github.com/users/KaiRo-at/orgs",
    "repos_url": "https://api.github.com/users/KaiRo-at/repos",
    "events_url": "https://api.github.com/users/KaiRo-at/events{/privacy}",
    "received_events_url": "https://api.github.com/users/KaiRo-at/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2021-09-03T22:57:58Z",
  "updated_at": "2022-05-27T05:02:23Z",
  "closed_at": "2022-05-27T05:02:23Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "# Rationale\r\n\r\nI'm running a (company-internal) monitoring service on our blockchain nodes, which in addition to watching node health, also keeps statistics about recent blocks and pending transactions so we get more insight into the current environment of chain congestion and gas prices. For quick info, the count of pending transactions as seen by the node is interesting, for detailed stats, the actual pending transactions can be dug into and analyzed.\r\n\r\nTo get the count of pending transactions, [eth_getBlockTransactionCountByNumber](https://eth.wiki/json-rpc/API#eth_getblocktransactioncountbynumber) (like some other commands) can - per the JSON-RPC documentation in the wiki - be called with, the block be specified as `\"pending\"` which is documented in [the default block parameter](https://eth.wiki/json-rpc/API#the-default-block-parameter). Unfortunately, that seems to not be supported by Erigon right now, as I found out when experimenting with some new Erigon nodes to replace our existing OpenEthereum nodes, which support that.\r\n\r\nFor actually analyzing pending transactions, I have been using [parity_pendingTransactions](https://openethereum.github.io/JSONRPC-parity-module#parity_pendingtransactions) on OpenEthereum, but I would be happy about any way that I can get a list of transactions in the mempool that this nodes is aware of, so I can e.g. see what priority fees those have set and make statistics about that.\r\n\r\n# Implementation\r\n\r\nFor all of that, Erigon needs to keep a list of pending transactions in memory, but i guess for mining, that is required as well anyhow. If that exists, it sounds to me as an outside as the JSON-RPC end points may be relatively easy to implement - at least if the RPC daemon can get access to that list.\r\n\r\nI'm personally not able to dig into development myself but as soon as a docker image with that functionality is available, I'm happy to test and give feedback.",
  "closed_by": {
    "login": "AskAlexSharov",
    "id": 46885206,
    "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AskAlexSharov",
    "html_url": "https://github.com/AskAlexSharov",
    "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
    "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
    "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
    "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
    "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2629/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2629/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/912916735",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2629#issuecomment-912916735",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2629",
    "id": 912916735,
    "node_id": "IC_kwDOC0FsAM42agD_",
    "user": {
      "login": "gelfand",
      "id": 45895290,
      "node_id": "MDQ6VXNlcjQ1ODk1Mjkw",
      "avatar_url": "https://avatars.githubusercontent.com/u/45895290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gelfand",
      "html_url": "https://github.com/gelfand",
      "followers_url": "https://api.github.com/users/gelfand/followers",
      "following_url": "https://api.github.com/users/gelfand/following{/other_user}",
      "gists_url": "https://api.github.com/users/gelfand/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gelfand/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gelfand/subscriptions",
      "organizations_url": "https://api.github.com/users/gelfand/orgs",
      "repos_url": "https://api.github.com/users/gelfand/repos",
      "events_url": "https://api.github.com/users/gelfand/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gelfand/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-04T06:09:12Z",
    "updated_at": "2021-09-04T06:09:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "> For actually analyzing pending transactions, I have been using [parity_pendingTransactions](https://openethereum.github.io/JSONRPC-parity-module#parity_pendingtransactions) on OpenEthereum, but I would be happy about any way that I can get a list of transactions in the mempool that this nodes is aware of, so I can e.g. see what priority fees those have set and make statistics about that.\r\n\r\nFor that purpose you can use `txpool_content`, it returns both `pending` and `queued` transactions, so you would have to just get rid off `queued`(aka `non-executable`) transactions.\r\n```\r\n ~ ❯❯❯ curl -X POST -H \"Content-Type: application/json\" --data '{\"method\": \"txpool_content\", \"params\": [], \"id\":1}' localhost:8545\r\n ```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/912916735/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/912955007",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2629#issuecomment-912955007",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2629",
    "id": 912955007,
    "node_id": "IC_kwDOC0FsAM42apZ_",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-04T11:05:34Z",
    "updated_at": "2021-09-04T11:05:34Z",
    "author_association": "COLLABORATOR",
    "body": "If need only counters - can use txpool_status",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/912955007/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1056003928",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2629#issuecomment-1056003928",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2629",
    "id": 1056003928,
    "node_id": "IC_kwDOC0FsAM4-8VdY",
    "user": {
      "login": "KaiRo-at",
      "id": 824140,
      "node_id": "MDQ6VXNlcjgyNDE0MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/824140?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/KaiRo-at",
      "html_url": "https://github.com/KaiRo-at",
      "followers_url": "https://api.github.com/users/KaiRo-at/followers",
      "following_url": "https://api.github.com/users/KaiRo-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/KaiRo-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/KaiRo-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KaiRo-at/subscriptions",
      "organizations_url": "https://api.github.com/users/KaiRo-at/orgs",
      "repos_url": "https://api.github.com/users/KaiRo-at/repos",
      "events_url": "https://api.github.com/users/KaiRo-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/KaiRo-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-02T00:24:34Z",
    "updated_at": "2022-03-02T00:24:34Z",
    "author_association": "NONE",
    "body": "OK, now that I'm looking into implementing our monitoring with this, I see that for `eth_getBlockTransactionCountByNumber` for the `pending` block I can very well be use the `pending` count from `txpool_status` - actually, you probably could implement it on your side with this. :)\r\n\r\nThat said, when trying to analyze the list of transactions in `txpool_content`, I found that e.g. on Goerli, I get only about 10% of the expected transactions in the `pending` list compared to what the `txpool_status` says that I should expect (and also compared to what OpenEthereum gives me in `parity_pendingTransactions`. What could be the reason for that?\r\nFWIW, I see the same difference in the numbers between `txpool_content` and `txpool_status` when I look at `queued`.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1056003928/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
