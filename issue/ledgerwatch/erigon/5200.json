{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5200",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5200/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5200/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5200/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/5200",
  "id": 1352723159,
  "node_id": "I_kwDOC0FsAM5QoOrX",
  "number": 5200,
  "title": "dev chain eth_getTransactionCount issues",
  "user": {
    "login": "mohoff",
    "id": 6060612,
    "node_id": "MDQ6VXNlcjYwNjA2MTI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6060612?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mohoff",
    "html_url": "https://github.com/mohoff",
    "followers_url": "https://api.github.com/users/mohoff/followers",
    "following_url": "https://api.github.com/users/mohoff/following{/other_user}",
    "gists_url": "https://api.github.com/users/mohoff/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mohoff/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mohoff/subscriptions",
    "organizations_url": "https://api.github.com/users/mohoff/orgs",
    "repos_url": "https://api.github.com/users/mohoff/repos",
    "events_url": "https://api.github.com/users/mohoff/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mohoff/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4566396003,
      "node_id": "LA_kwDOC0FsAM8AAAABEC2sYw",
      "url": "https://api.github.com/repos/ledgerwatch/erigon/labels/Stale",
      "name": "Stale",
      "color": "ededed",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-08-26T20:53:20Z",
  "updated_at": "2022-10-16T04:03:35Z",
  "closed_at": "2022-10-16T04:03:35Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: `erigon version 2022.08.2-alpha-35c4faa1`\r\n\r\n#### Expected behaviour\r\n\r\n`eth_getTransactionCount` gives consistent results with `latest` and `pending` option. The result of `pending` is expected to be greater or equal to the one of `latest`.\r\n\r\n#### Actual behaviour\r\n\r\n```\r\ncurl -f -X POST -H 'Content-Type: application/json' --data '{\"jsonrpc\":\"2.0\",\"method\":\"eth_getTransactionCount\",\"params\":[\"0x95c2d93dc7e29883e03c5e8c79856f9af99109fe\",\"pending\"],\"id\":1}' http://localhost:8545\r\n{\"jsonrpc\":\"2.0\",\"id\":1,\"result\":\"0x0\"}\r\n\r\ncurl -f -X POST -H 'Content-Type: application/json' --data '{\"jsonrpc\":\"2.0\",\"method\":\"eth_getTransactionCount\",\"params\":[\"0x95c2d93dc7e29883e03c5e8c79856f9af99109fe\",\"latest\"],\"id\":1}' http://localhost:8545\r\n{\"jsonrpc\":\"2.0\",\"id\":1,\"result\":\"0x1\"}\r\n```\r\n\r\nThe surfaced error in the dev chain was \"nonce too low\" while determining a tx's nonce via `eth_getTransactionCount, \"pending\"`, which seems broken for any tx with nonce > 0.\r\n",
  "closed_by": {
    "login": "github-actions[bot]",
    "id": 41898282,
    "node_id": "MDM6Qm90NDE4OTgyODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/github-actions%5Bbot%5D",
    "html_url": "https://github.com/apps/github-actions",
    "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5200/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5200/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1230004841",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5200#issuecomment-1230004841",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5200",
    "id": 1230004841,
    "node_id": "IC_kwDOC0FsAM5JUGJp",
    "user": {
      "login": "leonardchinonso",
      "id": 36096513,
      "node_id": "MDQ6VXNlcjM2MDk2NTEz",
      "avatar_url": "https://avatars.githubusercontent.com/u/36096513?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/leonardchinonso",
      "html_url": "https://github.com/leonardchinonso",
      "followers_url": "https://api.github.com/users/leonardchinonso/followers",
      "following_url": "https://api.github.com/users/leonardchinonso/following{/other_user}",
      "gists_url": "https://api.github.com/users/leonardchinonso/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/leonardchinonso/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/leonardchinonso/subscriptions",
      "organizations_url": "https://api.github.com/users/leonardchinonso/orgs",
      "repos_url": "https://api.github.com/users/leonardchinonso/repos",
      "events_url": "https://api.github.com/users/leonardchinonso/events{/privacy}",
      "received_events_url": "https://api.github.com/users/leonardchinonso/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-29T09:19:52Z",
    "updated_at": "2022-08-29T09:19:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi\r\n1. Do you still have this issue?\r\n2. Can you show your logs with the error?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1230004841/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1230393056",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5200#issuecomment-1230393056",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5200",
    "id": 1230393056,
    "node_id": "IC_kwDOC0FsAM5JVk7g",
    "user": {
      "login": "mohoff",
      "id": 6060612,
      "node_id": "MDQ6VXNlcjYwNjA2MTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6060612?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mohoff",
      "html_url": "https://github.com/mohoff",
      "followers_url": "https://api.github.com/users/mohoff/followers",
      "following_url": "https://api.github.com/users/mohoff/following{/other_user}",
      "gists_url": "https://api.github.com/users/mohoff/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mohoff/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mohoff/subscriptions",
      "organizations_url": "https://api.github.com/users/mohoff/orgs",
      "repos_url": "https://api.github.com/users/mohoff/repos",
      "events_url": "https://api.github.com/users/mohoff/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mohoff/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-29T14:30:33Z",
    "updated_at": "2022-08-29T14:30:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "@leonardchinonso Yes. The log context of the `nonce too low` error is this:\r\n\r\n```\r\n[INFO] [08-29|13:30:16.991] Served                                   conn=127.0.0.1:54948 t=1.445366ms method=eth_blockNumber reqid=1 params=[]\r\n[WARN] [08-29|13:30:17.039] Served                                   conn=172.18.0.12:55990 method=eth_sendRawTransaction reqid=5 t=722.094µs err=\"INTERNAL_ERROR: nonce too low\"\r\n[INFO] [08-29|13:30:17.039] Served                                   conn=172.18.0.12:55990 t=767.026µs method=eth_sendRawTransaction reqid=5 params=\"[\\\"0x02f901f382053980847735940084816d71a5835b8d80945c388ae9cea402f74ac3f7c776eeb7cdce3cc1b680b901848e55efb30000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000a6711a862db8429815d6470ece6e4b2677e8259a44fbe7294ed1efae2c2e21832711a862db8429815d6470ece6e4b2677e8259a44fbe7294ed1efae2c2e21832611a862db8429815d6470ece6e4b2677e8259a44fbe7294ed1efae2c2e21832671a862db8429815d6470ece6e4b2677e8259a44fbe7294ed1efae2c2e21832671a862db8429815d6470ece6e4b2677e8259a44fbe7294ed1efae2c2e218326711862db8429815d6470ece6e4b2677e8259a44fbe7294ed1efae2c2e218326711a62db8429815d6470ece6e4b2677e8259a44fbe7294ed1efae2c2e218326711a82db8429815d6470ece6e4b2677e8259a44fbe7294ed1efae2c2e218326711a86db8429815d6470ece6e4b2677e8259a44fbe7294ed1efae2c2e218326711a862b8429815d6470ece6e4b2677e8259a44fbe7294ed1efae2c2e218326711a862dc080a016d0734862d78b7cccd73e8dd14dde996b63b3e83d49b0aea1524d37df42bd6ca0143b7815037c0e599b9347aef3b4035527629ddf40df2716a978e3a87702afb3\\\"]\"\r\n[INFO] [08-29|13:30:18.015] Received GetPayload                      payloadId=97\r\n[INFO] [08-29|13:30:18.015] Block request successful                 hash=0x621c9a061ab8ce7c8c5b6fa54e724c896da91763abf0ac3369c0e90ff878c665 transactions count=0 number=109\r\n[INFO] [08-29|13:30:18.038] [5/7 Execution] Completed on             block=109\r\n[INFO] [08-29|13:30:18.039] Timings (slower than 50ms)               Headers=1.991s\r\n[INFO] [08-29|13:30:18.039] Tables                                   PlainState=20.0KB AccountChangeSet=12.0KB StorageChangeSet=12.0KB BlockTransaction=132.0KB TransactionLog=4.0KB FreeList=4.0KB ReclaimableSpace=4.0MB\r\n[INFO] [08-29|13:30:18.040] Commit cycle                             in=1.248653ms\r\n``` ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1230393056/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1272448255",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5200#issuecomment-1272448255",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5200",
    "id": 1272448255,
    "node_id": "IC_kwDOC0FsAM5L2AT_",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-10-09T03:52:55Z",
    "updated_at": "2022-10-09T03:52:55Z",
    "author_association": "NONE",
    "body": "This issue is stale because it has been open for 40 days with no activity. Remove stale label or comment, or this will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1272448255/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1279886171",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5200#issuecomment-1279886171",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5200",
    "id": 1279886171,
    "node_id": "IC_kwDOC0FsAM5MSYNb",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-10-16T04:03:35Z",
    "updated_at": "2022-10-16T04:03:35Z",
    "author_association": "NONE",
    "body": "This issue was closed because it has been stalled for 7 days with no activity.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1279886171/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
