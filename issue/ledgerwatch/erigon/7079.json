{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7079",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7079/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7079/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7079/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/7079",
  "id": 1619832117,
  "node_id": "I_kwDOC0FsAM5gjK01",
  "number": 7079,
  "title": "Runtime Error : index out of range [7] with length 0",
  "user": {
    "login": "mr-stegosaurus",
    "id": 48191597,
    "node_id": "MDQ6VXNlcjQ4MTkxNTk3",
    "avatar_url": "https://avatars.githubusercontent.com/u/48191597?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mr-stegosaurus",
    "html_url": "https://github.com/mr-stegosaurus",
    "followers_url": "https://api.github.com/users/mr-stegosaurus/followers",
    "following_url": "https://api.github.com/users/mr-stegosaurus/following{/other_user}",
    "gists_url": "https://api.github.com/users/mr-stegosaurus/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mr-stegosaurus/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mr-stegosaurus/subscriptions",
    "organizations_url": "https://api.github.com/users/mr-stegosaurus/orgs",
    "repos_url": "https://api.github.com/users/mr-stegosaurus/repos",
    "events_url": "https://api.github.com/users/mr-stegosaurus/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mr-stegosaurus/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4566396003,
      "node_id": "LA_kwDOC0FsAM8AAAABEC2sYw",
      "url": "https://api.github.com/repos/ledgerwatch/erigon/labels/Stale",
      "name": "Stale",
      "color": "ededed",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-03-11T01:45:44Z",
  "updated_at": "2023-04-28T02:22:27Z",
  "closed_at": "2023-04-28T02:22:27Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: v2.31.0-rc.4-661-gd5fbc5011 \r\n\r\nOS & Version: Linux\r\n\r\nErigon Command (with flags/config): ./build/bin/erigon --datadir=../goerli/ --chain=goerli --prune.t.older 90000 --torrent.download.rate=20mb --externalcl -http\r\n\r\nConcensus Layer: Prysm\r\n\r\nConcensus Layer Command (with flags/config):\r\n./prysm.sh beacon-chain --datadir=../goerli --p2p-max-peers=150 --execution-endpoint=http://localhost:8551 --prater --jwt-secret=/home/mrstego123/Ethereum/execution/goerli/jwt.hex --genesis-state=genesis.ssz\r\n\r\nChain/Network: Goerli\r\n\r\n#### Expected behavior\r\nI believe it should be processing snapshots without runtime errors. Seems to sync extremely slowly under these conditions. Often 2blck/s\r\n\r\n#### Actual behavior\r\nAfter running up to the execution stage, it seems to randomly start outputting the errors show below. Not sure what is causing these runtime errors. When hitting this stage it will print runtime errors for each block, Prysm will switch to optimistic mode and the sync process goes from 15hr left to 125hr left. Seems like something is running incorrectly.\r\n\r\nI've tried wiping chaindata clean and starting from scratch. Ran \"make integration\" workflow and it didn't seem to fix anything.\r\n\r\n#### Steps to reproduce the behaviour\r\nRun the above commands, will exist with and without Prysm running\r\n\r\n#### Backtrace\r\n\r\nWARN[03-10|20:34:46.691] no log dir set, console logging only \r\nWARN[03-10|20:34:46.696] no log dir set, console logging only \r\nINFO[03-10|20:34:46.696] Build info                               git_branch=devel git_tag=v2.31.0-rc.4-661-gd5fbc5011 git_commit=d5fbc5011e44bf47bcd7e2be128b812dc2d5ed5f\r\nINFO[03-10|20:34:46.696] Starting Erigon on GÃ¶rli testnet... \r\nINFO[03-10|20:34:46.699] Maximum peer count                       ETH=100 total=100\r\nINFO[03-10|20:34:46.699] starting HTTP APIs                       APIs=eth,erigon,engine\r\nINFO[03-10|20:34:46.699] torrent verbosity                        level=WRN\r\nINFO[03-10|20:34:48.800] Set global gas cap                       cap=50000000\r\nINFO[03-10|20:34:48.801] [Downloader] Runnning with               ipv6-enabled=true ipv4-enabled=true download.rate=20mb upload.rate=4mb\r\nINFO[03-10|20:34:48.801] Opening Database                         label=chaindata path=/home/mrstego123/Ethereum/execution/goerli/chaindata\r\nINFO[03-10|20:34:48.803] Initialised chain configuration          config=\"{ChainID: 5, Homestead: 0, DAO: <nil>, DAO Support: true, Tangerine Whistle: 0, Spurious Dragon: 0, Byzantium: 0, Constantinople: 0, Petersburg: 0, Istanbul: 1561651, Muir Glacier: <nil>, Berlin: 4460644, London: 5062605, Arrow Glacier: <nil>, Gray Glacier: <nil>, Terminal Total Difficulty: 10790000, Merge Netsplit: <nil>, Shanghai: 1678832736, Cancun: <nil>, Sharding: <nil>, Prague: <nil>, Engine: clique}\" genesis=0xbf7e331f7f7c1dd2e05159666b3bf8bc7a8a3a9eb1d518969eab529dd9b88c1a\r\nINFO[03-10|20:34:48.803] Effective                                prune_flags=\"--prune.t.older=90000\" snapshot_flags=\"--snapshots=true\" history.v3=false\r\nINFO[03-10|20:34:49.710] Initialising Ethereum protocol           network=5\r\nINFO[03-10|20:34:49.721] Starting private RPC server              on=127.0.0.1:9090\r\nINFO[03-10|20:34:49.721] new subscription to logs established \r\nINFO[03-10|20:34:49.721] rpc filters: subscribing to Erigon events \r\nINFO[03-10|20:34:49.721] New txs subscriber joined \r\nINFO[03-10|20:34:49.721] new subscription to newHeaders established \r\nINFO[03-10|20:34:49.721] Reading JWT secret                       path=/home/mrstego123/Ethereum/execution/goerli/jwt.hex\r\nINFO[03-10|20:34:49.721] HTTP endpoint opened for Engine API      url=127.0.0.1:8551 ws=true ws.compression=true\r\nINFO[03-10|20:34:49.721] HTTP endpoint opened                     url=127.0.0.1:8545 ws=false ws.compression=true grpc=false\r\nINFO[03-10|20:34:49.732] [txpool] Started \r\nINFO[03-10|20:34:49.732] [1/15 Snapshots] Fetching torrent files metadata \r\nINFO[03-10|20:34:49.733] [snapshots] Blocks Stat                  blocks=8500k indices=8500k alloc=685.8MB sys=854.1MB\r\nINFO[03-10|20:34:49.734] Started P2P networking                   version=68 self=enode://4c9644c5814d4976396a84cdf1f8a6289e89f6bb552d668c8e2c847bc15ef81aafb0de7858150c10551a90f8f8fc8962c5fae875fe56658ad565dc540c6e2f4a@127.0.0.1:30304 name=erigon/v2.40.0-dev-d5fbc501/linux-amd64/go1.18.1\r\nINFO[03-10|20:34:49.739] Started P2P networking                   version=67 self=enode://4c9644c5814d4976396a84cdf1f8a6289e89f6bb552d668c8e2c847bc15ef81aafb0de7858150c10551a90f8f8fc8962c5fae875fe56658ad565dc540c6e2f4a@127.0.0.1:30303 name=erigon/v2.40.0-dev-d5fbc501/linux-amd64/go1.18.1\r\nEROR[03-10|20:34:50.152] Staged Sync                              err=\"runtime error: index out of range [7] with length 0, trace: [stageloop.go:132 panic.go:844 panic.go:89 binary.go:125 accessors_chain.go:1315 block_snapshots.go:1127 stage_snapshots.go:525 default_stages.go:25 sync.go:425 sync.go:285 stageloop.go:251 kv_mdbx.go:676 stageloop.go:251 stageloop.go:94 asm_amd64.s:1571]\"\r\nINFO[03-10|20:34:50.670] [1/15 Snapshots] Fetching torrent files metadata \r\nINFO[03-10|20:34:50.671] [snapshots] Blocks Stat                  blocks=8500k indices=8500k alloc=944.5MB sys=1.0GB\r\nEROR[03-10|20:34:51.184] Staged Sync                              err=\"runtime error: index out of range [7] with length 0, trace: [stageloop.go:132 panic.go:844 panic.go:89 binary.go:125 accessors_chain.go:1315 block_snapshots.go:1127 stage_snapshots.go:525 default_stages.go:25 sync.go:425 sync.go:285 stageloop.go:251 kv_mdbx.go:676 stageloop.go:251 stageloop.go:94 asm_amd64.s:1571]\"\r\nINFO[03-10|20:34:51.702] [1/15 Snapshots] Fetching torrent files metadata \r\nINFO[03-10|20:34:51.703] [snapshots] Blocks Stat                  blocks=8500k indices=8500k alloc=726.4MB sys=1.2GB\r\nEROR[03-10|20:34:52.061] Staged Sync                              err=\"runtime error: index out of range [7] with length 0, trace: [stageloop.go:132 panic.go:844 panic.go:89 binary.go:125 accessors_chain.go:1315 block_snapshots.go:1127 stage_snapshots.go:525 default_stages.go:25 sync.go:425 sync.go:285 stageloop.go:251 kv_mdbx.go:676 stageloop.go:251 stageloop.go:94 asm_amd64.s:1571]\"\r\n^CINFO[03-10|20:34:52.080] Got interrupt, shutting down... \r\nINFO[03-10|20:34:52.080] Exiting Engine... \r\nINFO[03-10|20:34:52.080] RPC server shutting down \r\nINFO[03-10|20:34:52.080] RPC server shutting down \r\nINFO[03-10|20:34:52.080] Exiting... \r\nINFO[03-10|20:34:52.080] RPC server shutting down \r\nWARN[03-10|20:34:52.080] Failed to serve http endpoint            err=\"http: Server closed\"\r\nWARN[03-10|20:34:52.080] Failed to serve http endpoint            err=\"http: Server closed\"\r\nINFO[03-10|20:34:52.082] Engine HTTP endpoint close               url=127.0.0.1:8551\r\nINFO[03-10|20:34:52.082] HTTP endpoint closed                     url=127.0.0.1:8545\r\nmrstego123@Stakosaurus:~/Ethereum/execution/erigon$ ^C\r\n",
  "closed_by": {
    "login": "github-actions[bot]",
    "id": 41898282,
    "node_id": "MDM6Qm90NDE4OTgyODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/github-actions%5Bbot%5D",
    "html_url": "https://github.com/apps/github-actions",
    "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7079/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7079/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1464828758",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7079#issuecomment-1464828758",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7079",
    "id": 1464828758,
    "node_id": "IC_kwDOC0FsAM5XT4NW",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-11T05:10:48Z",
    "updated_at": "2023-03-11T05:10:48Z",
    "author_association": "COLLABORATOR",
    "body": "fixed by https://github.com/ledgerwatch/erigon/pull/7081",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1464828758/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1517164192",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7079#issuecomment-1517164192",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7079",
    "id": 1517164192,
    "node_id": "IC_kwDOC0FsAM5abhag",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-04-21T02:20:53Z",
    "updated_at": "2023-04-21T02:20:53Z",
    "author_association": "NONE",
    "body": "This issue is stale because it has been open for 40 days with no activity. Remove stale label or comment, or this will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1517164192/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1526887197",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7079#issuecomment-1526887197",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7079",
    "id": 1526887197,
    "node_id": "IC_kwDOC0FsAM5bAnMd",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-04-28T02:22:26Z",
    "updated_at": "2023-04-28T02:22:26Z",
    "author_association": "NONE",
    "body": "This issue was closed because it has been stalled for 7 days with no activity.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1526887197/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
