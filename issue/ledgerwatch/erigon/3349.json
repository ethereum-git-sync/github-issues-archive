{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3349",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3349/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3349/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3349/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/3349",
  "id": 1114849844,
  "node_id": "I_kwDOC0FsAM5Cc0I0",
  "number": 3349,
  "title": "use erigon prune to help devide archive node into several nodes",
  "user": {
    "login": "flywukong",
    "id": 19421226,
    "node_id": "MDQ6VXNlcjE5NDIxMjI2",
    "avatar_url": "https://avatars.githubusercontent.com/u/19421226?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/flywukong",
    "html_url": "https://github.com/flywukong",
    "followers_url": "https://api.github.com/users/flywukong/followers",
    "following_url": "https://api.github.com/users/flywukong/following{/other_user}",
    "gists_url": "https://api.github.com/users/flywukong/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/flywukong/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/flywukong/subscriptions",
    "organizations_url": "https://api.github.com/users/flywukong/orgs",
    "repos_url": "https://api.github.com/users/flywukong/repos",
    "events_url": "https://api.github.com/users/flywukong/events{/privacy}",
    "received_events_url": "https://api.github.com/users/flywukong/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-01-26T10:16:51Z",
  "updated_at": "2022-02-14T04:17:59Z",
  "closed_at": "2022-02-14T04:17:59Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "the data of erigon on  archive node on bsc mainnet  has reach more than 6T ,  I want to split archive  node into 3-4 segment .  for example,  segment-1 \r\nis responsible for 1-500w height data( \r\nstop sync manually after reach this height), segment-2 is responsible for 501-1000w height data ( with 1-500w height state data pruned).   Of course, such an approach requires a  strategy which can forward the rpc request to the correct segment .\r\n\r\nMy question is in the data processing part ï¼Œcan such a requirement be achieved through erigon prune? My tests has failed  because prune parameters cannot be dynamically modified. \r\n\r\n \r\n",
  "closed_by": {
    "login": "AskAlexSharov",
    "id": 46885206,
    "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AskAlexSharov",
    "html_url": "https://github.com/AskAlexSharov",
    "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
    "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
    "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
    "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
    "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3349/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3349/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1022100193",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3349#issuecomment-1022100193",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3349",
    "id": 1022100193,
    "node_id": "IC_kwDOC0FsAM487ALh",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-26T11:13:31Z",
    "updated_at": "2022-01-26T11:13:31Z",
    "author_association": "COLLABORATOR",
    "body": "Probably yes. \r\n- To make it work - you need somehow stop stage_bodies (I advise you create PR with cli flag for this) at given block. stage_bodies.go has next code: `headerProgress, err = stages.GetStageProgress(tx, stages.Headers)` - you need set variable `headerProgress` to any value - stage_bodies will stop there.\r\n- Then if you start such node with parameter --nodiscover - it will not download more blocks, but will process all blocks (produce indices, etc).\r\n- Also you can use Env variable: `STOP_BEFORE_STAGE=Execution`, to stop Erigon before some stage (to later start node with --nodiscover flag).\r\n- Also you will need set correct --prune parameters (i think it must just work).\r\n\r\nYou can easily test it: build node for early 1M-1.1M blocks range.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1022100193/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1023423885",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3349#issuecomment-1023423885",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3349",
    "id": 1023423885,
    "node_id": "IC_kwDOC0FsAM49ADWN",
    "user": {
      "login": "allada",
      "id": 1831202,
      "node_id": "MDQ6VXNlcjE4MzEyMDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1831202?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/allada",
      "html_url": "https://github.com/allada",
      "followers_url": "https://api.github.com/users/allada/followers",
      "following_url": "https://api.github.com/users/allada/following{/other_user}",
      "gists_url": "https://api.github.com/users/allada/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/allada/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/allada/subscriptions",
      "organizations_url": "https://api.github.com/users/allada/orgs",
      "repos_url": "https://api.github.com/users/allada/repos",
      "events_url": "https://api.github.com/users/allada/events{/privacy}",
      "received_events_url": "https://api.github.com/users/allada/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-27T16:42:35Z",
    "updated_at": "2022-01-27T16:42:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "> the data of erigon on archive node on bsc mainnet has reach more than 6T\r\nI have a full sync of BSC on erigon in archive mode, but the data is 4.5TB.\r\n\r\nThe data is also very compressible, in my case between 2x and 2.5x, so size on disk is around 2.2TB (I use zfs + lz4). This does have some overhead, but not enough to cause issues in my case.\r\n\r\nIf you would like more info on how I set this up, see: https://github.com/allada/bsc-archive-snapshot",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1023423885/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
