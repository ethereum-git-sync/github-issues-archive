{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8101",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8101/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8101/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8101/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/8101",
  "id": 1873191912,
  "node_id": "I_kwDOC0FsAM5vpqPo",
  "number": 8101,
  "title": "Snapshot download stops at 99.98% every time",
  "user": {
    "login": "nivshitrit",
    "id": 80672827,
    "node_id": "MDQ6VXNlcjgwNjcyODI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/80672827?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nivshitrit",
    "html_url": "https://github.com/nivshitrit",
    "followers_url": "https://api.github.com/users/nivshitrit/followers",
    "following_url": "https://api.github.com/users/nivshitrit/following{/other_user}",
    "gists_url": "https://api.github.com/users/nivshitrit/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nivshitrit/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nivshitrit/subscriptions",
    "organizations_url": "https://api.github.com/users/nivshitrit/orgs",
    "repos_url": "https://api.github.com/users/nivshitrit/repos",
    "events_url": "https://api.github.com/users/nivshitrit/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nivshitrit/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4566396003,
      "node_id": "LA_kwDOC0FsAM8AAAABEC2sYw",
      "url": "https://api.github.com/repos/ledgerwatch/erigon/labels/Stale",
      "name": "Stale",
      "color": "ededed",
      "default": false,
      "description": null
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2023-08-30T08:29:16Z",
  "updated_at": "2023-10-23T02:05:14Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: 2.48.1\r\n\r\nOS & Version:/Linux/\r\n\r\n\r\nErigon Command (with flags/config): \r\n--chain=mumbai --bor.heimdall=heimdal-rest:1317\r\n\r\nConcensus Layer: heimdall\r\n\r\nConcensus Layer Command (with flags/config):\r\n heimdall start --chain=mumbai --home=/heimdall-home\r\n\r\nChain/Network: mumbai\r\n\r\n#### Expected behaviour\r\ndownlaod snapshot to 100%\r\n\r\n#### Actual behaviour\r\ndownload gets stuck at 99.98% everytime, suddenly 0 peers and it wont continue even if i let it sit for hours and hours\r\n\r\n#### Steps to reproduce the behaviour\r\ndownload erigon mumbai snapshot with this command:\r\n`curl -L https://snapshot-download.polygon.technology/snapdown.sh | bash -s -- --network mumbai --client erigon --extract-dir data --validate-checksum true`\r\n\r\nlogs:\r\n```\r\n[INFO] [08-30|08:11:16.133] [p2p] GoodPeers \r\n[INFO] [08-30|08:11:16.182] [txpool] stat                            pending=0 baseFee=0 queued=0 alloc=68.0MB sys=219.5MB\r\n[INFO] [08-30|08:11:16.210] [1/15 Snapshots] download                progress=\"99.98% 20.8GB/20.8GB\" download-time-left=999hrs:99m total-download-time=1h6m0s download=0B/s upload=0B/s\r\n[INFO] [08-30|08:11:16.210] [1/15 Snapshots] download                peers=1 connections=1 files=156 alloc=68.0MB sys=219.5MB\r\n[INFO] [08-30|08:11:36.210] [1/15 Snapshots] download                progress=\"99.98% 20.8GB/20.8GB\" download-time-left=999hrs:99m total-download-time=1h6m20s download=0B/s upload=0B/s\r\n[INFO] [08-30|08:11:36.210] [1/15 Snapshots] download                peers=0 connections=0 files=156 alloc=55.1MB sys=219.5MB\r\n\r\n```\r\n````\r\n[backtrace]\r\n````\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8101/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8101/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1698734962",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8101#issuecomment-1698734962",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8101",
    "id": 1698734962,
    "node_id": "IC_kwDOC0FsAM5lQKNy",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-30T08:35:58Z",
    "updated_at": "2023-08-30T08:35:58Z",
    "author_association": "COLLABORATOR",
    "body": "- stop erigon\r\n- ./build/bin/downloader --log.console.verbosity=4\r\n- it will show 1-2 problematic files\r\n- remove them from folder `datadir/snapshots`. For example if file `v1-038500-039000-transactions.seg` has problem, do `rm <datadir>/snapshots/v1-038500-039000-*`\r\n- remove folder `datadir/snapshots/db`\r\n- start erigon\r\n- write here with which files you had problems",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1698734962/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1699110385",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8101#issuecomment-1699110385",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8101",
    "id": 1699110385,
    "node_id": "IC_kwDOC0FsAM5lRl3x",
    "user": {
      "login": "nivshitrit",
      "id": 80672827,
      "node_id": "MDQ6VXNlcjgwNjcyODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/80672827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nivshitrit",
      "html_url": "https://github.com/nivshitrit",
      "followers_url": "https://api.github.com/users/nivshitrit/followers",
      "following_url": "https://api.github.com/users/nivshitrit/following{/other_user}",
      "gists_url": "https://api.github.com/users/nivshitrit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nivshitrit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nivshitrit/subscriptions",
      "organizations_url": "https://api.github.com/users/nivshitrit/orgs",
      "repos_url": "https://api.github.com/users/nivshitrit/repos",
      "events_url": "https://api.github.com/users/nivshitrit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nivshitrit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-30T12:51:03Z",
    "updated_at": "2023-08-30T12:51:03Z",
    "author_association": "NONE",
    "body": "> * stop erigon\r\n> * ./build/bin/downloader --log.console.verbosity=4\r\n> * it will show 1-2 problematic files\r\n> * remove them from folder `datadir/snapshots`. For example if file `v1-038500-039000-transactions.seg` has problem, do `rm <datadir>/snapshots/v1-038500-039000-*`\r\n> * remove folder `datadir/snapshots/db`\r\n> * start erigon\r\n> * write here with which files you had problems\r\n\r\ni left running for more hours and suddenly it has finished downloading. it now attempts to download part 2/15 and i get this 2 logs over and over again in a loop, should i create a new issue for this ?\r\n\r\n`[INFO] [08-30|12:49:44.810] [2/15 Headers] No block headers to write in this log period block number=25999999\r\n[INFO] [08-30|12:49:44.810] Req/resp stats                           req=0 reqMin=0 reqMax=0 skel=0 skelMin=0 skelMax=0 resp=0 respMin=0 respMax=0 dups=0`\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1699110385/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1700282636",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8101#issuecomment-1700282636",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8101",
    "id": 1700282636,
    "node_id": "IC_kwDOC0FsAM5lWEEM",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-31T02:29:46Z",
    "updated_at": "2023-08-31T02:29:46Z",
    "author_association": "COLLABORATOR",
    "body": "Do you have external ConsensusLayer? Or using —internalcl?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1700282636/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1715280798",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8101#issuecomment-1715280798",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8101",
    "id": 1715280798,
    "node_id": "IC_kwDOC0FsAM5mPRue",
    "user": {
      "login": "SuperEdison",
      "id": 84554944,
      "node_id": "MDQ6VXNlcjg0NTU0OTQ0",
      "avatar_url": "https://avatars.githubusercontent.com/u/84554944?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SuperEdison",
      "html_url": "https://github.com/SuperEdison",
      "followers_url": "https://api.github.com/users/SuperEdison/followers",
      "following_url": "https://api.github.com/users/SuperEdison/following{/other_user}",
      "gists_url": "https://api.github.com/users/SuperEdison/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SuperEdison/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SuperEdison/subscriptions",
      "organizations_url": "https://api.github.com/users/SuperEdison/orgs",
      "repos_url": "https://api.github.com/users/SuperEdison/repos",
      "events_url": "https://api.github.com/users/SuperEdison/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SuperEdison/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-12T08:48:03Z",
    "updated_at": "2023-09-12T08:48:03Z",
    "author_association": "NONE",
    "body": "INFO[09-12|16:46:03.413] [torrent] Start                          my peerID=2d4754303030332d6d27cc4c5cad167fa00406a3\r\nINFO[09-12|16:46:03.413] Started gRPC server                      on=127.0.0.1:9093\r\nINFO[09-12|16:46:23.414] [snapshots] Downloading                  progress=\"0.00% 0B/0B\" download=0B/s upload=0B/s peers=0 conns=0 files=0\r\nINFO[09-12|16:46:43.414] [snapshots] Seeding                      up=0B/s peers=0 conns=0 files=0\r\nINFO[09-12|16:47:03.413] [snapshots] Seeding                      up=0B/s peers=0 conns=0 files=0\r\nINFO[09-12|16:47:23.414] [snapshots] Seeding                      up=0B/s peers=0 conns=0 files=0\r\nINFO[09-12|16:47:43.413] [snapshots] Seeding                      up=0B/s peers=0 conns=0 files=0",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1715280798/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1774318887",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8101#issuecomment-1774318887",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8101",
    "id": 1774318887,
    "node_id": "IC_kwDOC0FsAM5pwfUn",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-10-23T02:05:13Z",
    "updated_at": "2023-10-23T02:05:13Z",
    "author_association": "NONE",
    "body": "This issue is stale because it has been open for 40 days with no activity. Remove stale label or comment, or this will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1774318887/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
