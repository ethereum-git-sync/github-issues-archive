{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1275",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1275/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1275/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1275/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/1275",
  "id": 726850618,
  "node_id": "MDU6SXNzdWU3MjY4NTA2MTg=",
  "number": 1275,
  "title": "rpcdaemon debug_accountRange - method handler crashed -  slice bounds out of range [:20] with capacity 8",
  "user": {
    "login": "qdotme",
    "id": 273517,
    "node_id": "MDQ6VXNlcjI3MzUxNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/273517?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/qdotme",
    "html_url": "https://github.com/qdotme",
    "followers_url": "https://api.github.com/users/qdotme/followers",
    "following_url": "https://api.github.com/users/qdotme/following{/other_user}",
    "gists_url": "https://api.github.com/users/qdotme/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/qdotme/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/qdotme/subscriptions",
    "organizations_url": "https://api.github.com/users/qdotme/orgs",
    "repos_url": "https://api.github.com/users/qdotme/repos",
    "events_url": "https://api.github.com/users/qdotme/events{/privacy}",
    "received_events_url": "https://api.github.com/users/qdotme/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 10,
  "created_at": "2020-10-21T20:44:45Z",
  "updated_at": "2020-11-18T22:59:49Z",
  "closed_at": "2020-11-18T14:58:53Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nOS & Version: Linux \r\nCommit hash : 716a0f2dbaa5e355c7967b024377922463cdb75f\r\n\r\n#### Expected behaviour\r\n\r\ndebug_accountRange should not crash. \r\n\r\n#### Actual behaviour\r\n\r\n````\r\n{\"jsonrpc\":\"2.0\",\"id\":1,\"error\":{\"code\":-32000,\"message\":\"method handler crashed\"}}\r\n````\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\nrpcdaemon connected to tg, tg keeping up with the public ethereum tree. \r\n\r\n````\r\n./build/bin/rpcdaemon --private.api.addr=localhost:9090 --http.api=eth,debug,net,web3 --http.addr=0.0.0.0\r\n````\r\n\r\n````\r\ncurl -X POST -H \"Content-Type: application/json\" --data '{\"jsonrpc\": \"2.0\", \"method\": \"debug_accountRange\", \"params\": [10000000, \"\", 0, false, false, false], \"id\":1}' localhost:8545\r\n````\r\n#### Backtrace\r\n\r\n````\r\nERROR[10-21|15:39:57.726] RPC method debug_accountRange crashed: runtime error: slice bounds out of range [:20] with capacity 8\r\ngoroutine 378813 [running]:\r\ngithub.com/ledgerwatch/turbo-geth/rpc.(*callback).call.func1(0xc001100a80, 0x12, 0xc000509d50)\r\n        github.com/ledgerwatch/turbo-geth/rpc/service.go:200 +0xba\r\npanic(0x1117d00, 0xc00118bb80)\r\n        runtime/panic.go:969 +0x1b9\r\ngithub.com/ledgerwatch/turbo-geth/ethdb.(*splitCursor).Next(0xc000126230, 0x24f3bc, 0x6, 0xc0010b1208, 0xc0003217b4, 0x0, 0xc, 0xc0003217b4, 0x844aa0, 0x989681, ...)\r\n        github.com/ledgerwatch/turbo-geth/ethdb/walk.go:92 +0x387\r\ngithub.com/ledgerwatch/turbo-geth/core/state.NextForChunkedData(0xc0003217e0, 0x14, 0x14, 0x1aabc28, 0x0, 0x0, 0x131bf00, 0xc000126230, 0x989681, 0x0, ...)\r\n        github.com/ledgerwatch/turbo-geth/core/state/history.go:495 +0x4c\r\ngithub.com/ledgerwatch/turbo-geth/core/state.(*changesetSearchDecorator).Next(0xc0001e0000, 0xc0001143f0, 0x1310760, 0xc0001143f0, 0x1, 0x20, 0x1, 0xc000321700, 0x8, 0xc, ...)\r\n        github.com/ledgerwatch/turbo-geth/core/state/history.go:707 +0x46b\r\ngithub.com/ledgerwatch/turbo-geth/core/state.walkAsOfThinAccounts(0x1336720, 0xc00119b7c0, 0x11a8259, 0xa, 0x11a11c9, 0x3, 0x1aabc28, 0x0, 0x0, 0x0, ...)\r\n        github.com/ledgerwatch/turbo-geth/core/state/history.go:373 +0xb74\r\ngithub.com/ledgerwatch/turbo-geth/core/state.WalkAsOf(0x1336720, 0xc00119b7c0, 0x11a8259, 0xa, 0x11a11c9, 0x3, 0x1aabc28, 0x0, 0x0, 0x0, ...)\r\n        github.com/ledgerwatch/turbo-geth/core/state/history.go:134 +0x285\r\ngithub.com/ledgerwatch/turbo-geth/core/state.(*Dumper).DumpToCollector(0xc0005097e0, 0x131b8c0, 0xc0007f0660, 0x0, 0x1aabc28, 0x0, 0x0, 0x100, 0x0, 0x0, ...)\r\n        github.com/ledgerwatch/turbo-geth/core/state/dump.go:154 +0x2f3\r\ngithub.com/ledgerwatch/turbo-geth/core/state.(*Dumper).IteratorDump(0xc000ed57e0, 0x1000000, 0x1aabc28, 0x0, 0x0, 0x100, 0x0, 0x0, 0x0, 0x0, ...)\r\n        github.com/ledgerwatch/turbo-geth/core/state/dump.go:272 +0xf8\r\ngithub.com/ledgerwatch/turbo-geth/cmd/rpcdaemon/commands.(*PrivateDebugAPIImpl).AccountRange(0xc000113710, 0x1329ec0, 0xc000f7d8c0, 0xc001017080, 0x0, 0x0, 0x1aabc28, 0x0, 0x0, 0x0, ...)\r\n        github.com/ledgerwatch/turbo-geth/cmd/rpcdaemon/commands/debug_api.go:101 +0x1de\r\nreflect.Value.call(0xc0001420c0, 0xc000010b78, 0x13, 0x11a15e0, 0x4, 0xc0002b8180, 0x8, 0x8, 0xc0002b81b0, 0xc00108f5f0, ...)\r\n        reflect/value.go:475 +0x8c7\r\nreflect.Value.Call(0xc0001420c0, 0xc000010b78, 0x13, 0xc0002b8180, 0x8, 0x8, 0x16, 0x50, 0x0)\r\n        reflect/value.go:336 +0xb9\r\ngithub.com/ledgerwatch/turbo-geth/rpc.(*callback).call(0xc0001c37a0, 0x1329ec0, 0xc000f7d8c0, 0xc001100a80, 0x12, 0xc00108f5f0, 0x6, 0x6, 0x0, 0x0, ...)\r\n        github.com/ledgerwatch/turbo-geth/rpc/service.go:206 +0x2c5\r\ngithub.com/ledgerwatch/turbo-geth/rpc.(*handler).runMethod(0xc00108f4d0, 0x1329ec0, 0xc000f7d8c0, 0xc000370700, 0xc0001c37a0, 0xc00108f5f0, 0x6, 0x6, 0x6)\r\n        github.com/ledgerwatch/turbo-geth/rpc/handler.go:388 +0x8a\r\ngithub.com/ledgerwatch/turbo-geth/rpc.(*handler).handleCall(0xc00108f4d0, 0xc0007f0450, 0xc000370700, 0xc00041d6c0)\r\n        github.com/ledgerwatch/turbo-geth/rpc/handler.go:336 +0x294\r\ngithub.com/ledgerwatch/turbo-geth/rpc.(*handler).handleCallMsg(0xc00108f4d0, 0xc0007f0450, 0xc000370700, 0x131ac01)\r\n        github.com/ledgerwatch/turbo-geth/rpc/handler.go:298 +0x1be\r\ngithub.com/ledgerwatch/turbo-geth/rpc.(*handler).handleMsg.func1(0xc0007f0450)\r\n        github.com/ledgerwatch/turbo-geth/rpc/handler.go:139 +0x46\r\ngithub.com/ledgerwatch/turbo-geth/rpc.(*handler).startCallProc.func1(0xc00108f4d0, 0xc00084d180)\r\n        github.com/ledgerwatch/turbo-geth/rpc/handler.go:226 +0xd2\r\ncreated by github.com/ledgerwatch/turbo-geth/rpc.(*handler).startCallProc\r\n        github.com/ledgerwatch/turbo-geth/rpc/handler.go:222 +0x66\r\n````\r\n",
  "closed_by": {
    "login": "AlexeyAkhunov",
    "id": 13686139,
    "node_id": "MDQ6VXNlcjEzNjg2MTM5",
    "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AlexeyAkhunov",
    "html_url": "https://github.com/AlexeyAkhunov",
    "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
    "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
    "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
    "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
    "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1275/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1275/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/713878845",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1275#issuecomment-713878845",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1275",
    "id": 713878845,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxMzg3ODg0NQ==",
    "user": {
      "login": "AlexeyAkhunov",
      "id": 13686139,
      "node_id": "MDQ6VXNlcjEzNjg2MTM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AlexeyAkhunov",
      "html_url": "https://github.com/AlexeyAkhunov",
      "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
      "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
      "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
      "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
      "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-21T21:09:12Z",
    "updated_at": "2020-10-21T21:09:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for the report. I suspect that we need to simplify the implementation a bit, and it should work. The code that is crashing was supposed to protect against inconsistency between changeSet tables and history index tables. This inconsistency now does not happen as long as sync cycle is less than 1024 blocks at a time.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/713878845/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/714024448",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1275#issuecomment-714024448",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1275",
    "id": 714024448,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNDAyNDQ0OA==",
    "user": {
      "login": "qdotme",
      "id": 273517,
      "node_id": "MDQ6VXNlcjI3MzUxNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/273517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/qdotme",
      "html_url": "https://github.com/qdotme",
      "followers_url": "https://api.github.com/users/qdotme/followers",
      "following_url": "https://api.github.com/users/qdotme/following{/other_user}",
      "gists_url": "https://api.github.com/users/qdotme/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/qdotme/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/qdotme/subscriptions",
      "organizations_url": "https://api.github.com/users/qdotme/orgs",
      "repos_url": "https://api.github.com/users/qdotme/repos",
      "events_url": "https://api.github.com/users/qdotme/events{/privacy}",
      "received_events_url": "https://api.github.com/users/qdotme/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-22T00:04:46Z",
    "updated_at": "2020-10-22T00:04:46Z",
    "author_association": "NONE",
    "body": "Thanks for quick triage! Let me know if you can't reproduce it / want me to test a branch quickly.. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/714024448/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/714651315",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1275#issuecomment-714651315",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1275",
    "id": 714651315,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNDY1MTMxNQ==",
    "user": {
      "login": "tjayrush",
      "id": 5417918,
      "node_id": "MDQ6VXNlcjU0MTc5MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5417918?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tjayrush",
      "html_url": "https://github.com/tjayrush",
      "followers_url": "https://api.github.com/users/tjayrush/followers",
      "following_url": "https://api.github.com/users/tjayrush/following{/other_user}",
      "gists_url": "https://api.github.com/users/tjayrush/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tjayrush/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tjayrush/subscriptions",
      "organizations_url": "https://api.github.com/users/tjayrush/orgs",
      "repos_url": "https://api.github.com/users/tjayrush/repos",
      "events_url": "https://api.github.com/users/tjayrush/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tjayrush/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-22T17:39:57Z",
    "updated_at": "2020-10-22T17:39:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "@qdotme Can you do me a favor? Can you try to run the same `curl` command with the maxResults set to `1` instead of zero? When I do that, it no longer crashes, and I get what appear to be good results.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/714651315/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/714675747",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1275#issuecomment-714675747",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1275",
    "id": 714675747,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNDY3NTc0Nw==",
    "user": {
      "login": "tjayrush",
      "id": 5417918,
      "node_id": "MDQ6VXNlcjU0MTc5MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5417918?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tjayrush",
      "html_url": "https://github.com/tjayrush",
      "followers_url": "https://api.github.com/users/tjayrush/followers",
      "following_url": "https://api.github.com/users/tjayrush/following{/other_user}",
      "gists_url": "https://api.github.com/users/tjayrush/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tjayrush/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tjayrush/subscriptions",
      "organizations_url": "https://api.github.com/users/tjayrush/orgs",
      "repos_url": "https://api.github.com/users/tjayrush/repos",
      "events_url": "https://api.github.com/users/tjayrush/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tjayrush/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-22T18:23:59Z",
    "updated_at": "2020-10-22T18:23:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "The above commit (on this branch https://github.com/ledgerwatch/turbo-geth/tree/1275-debug-accountrange-crash) fixes (more accurately hides) the issue.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/714675747/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/714801820",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1275#issuecomment-714801820",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1275",
    "id": 714801820,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNDgwMTgyMA==",
    "user": {
      "login": "qdotme",
      "id": 273517,
      "node_id": "MDQ6VXNlcjI3MzUxNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/273517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/qdotme",
      "html_url": "https://github.com/qdotme",
      "followers_url": "https://api.github.com/users/qdotme/followers",
      "following_url": "https://api.github.com/users/qdotme/following{/other_user}",
      "gists_url": "https://api.github.com/users/qdotme/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/qdotme/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/qdotme/subscriptions",
      "organizations_url": "https://api.github.com/users/qdotme/orgs",
      "repos_url": "https://api.github.com/users/qdotme/repos",
      "events_url": "https://api.github.com/users/qdotme/events{/privacy}",
      "received_events_url": "https://api.github.com/users/qdotme/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-22T22:40:30Z",
    "updated_at": "2020-10-22T22:40:30Z",
    "author_association": "NONE",
    "body": "Unfortunately, it seems that the 113th' account  (0x0000000000000000000000000000000000021514) or thereabouts are the issue - not the size of the single request - red herring. \r\n\r\n````\r\ncurl -X POST -H \"Content-Type: application/json\" --data '{\"jsonrpc\": \"2.0\", \"method\": \"debug_accountRange\", \"params\": [10000000, \"AAAAAAAAAAAAAAAAAAAAAAACFRQ=\", 1, true, true, true], \"id\":1}' localhost:8545\r\n````\r\n\r\nstill crashes. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/714801820/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/714802332",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1275#issuecomment-714802332",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1275",
    "id": 714802332,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNDgwMjMzMg==",
    "user": {
      "login": "qdotme",
      "id": 273517,
      "node_id": "MDQ6VXNlcjI3MzUxNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/273517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/qdotme",
      "html_url": "https://github.com/qdotme",
      "followers_url": "https://api.github.com/users/qdotme/followers",
      "following_url": "https://api.github.com/users/qdotme/following{/other_user}",
      "gists_url": "https://api.github.com/users/qdotme/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/qdotme/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/qdotme/subscriptions",
      "organizations_url": "https://api.github.com/users/qdotme/orgs",
      "repos_url": "https://api.github.com/users/qdotme/repos",
      "events_url": "https://api.github.com/users/qdotme/events{/privacy}",
      "received_events_url": "https://api.github.com/users/qdotme/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-22T22:42:04Z",
    "updated_at": "2020-10-22T22:42:04Z",
    "author_association": "NONE",
    "body": "And it's also independent on storage-, code-, and preimage- boolean flags. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/714802332/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/714829081",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1275#issuecomment-714829081",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1275",
    "id": 714829081,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNDgyOTA4MQ==",
    "user": {
      "login": "tjayrush",
      "id": 5417918,
      "node_id": "MDQ6VXNlcjU0MTc5MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5417918?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tjayrush",
      "html_url": "https://github.com/tjayrush",
      "followers_url": "https://api.github.com/users/tjayrush/followers",
      "following_url": "https://api.github.com/users/tjayrush/following{/other_user}",
      "gists_url": "https://api.github.com/users/tjayrush/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tjayrush/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tjayrush/subscriptions",
      "organizations_url": "https://api.github.com/users/tjayrush/orgs",
      "repos_url": "https://api.github.com/users/tjayrush/repos",
      "events_url": "https://api.github.com/users/tjayrush/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tjayrush/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-23T00:08:46Z",
    "updated_at": "2020-10-23T00:08:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "Right. So the change I made just hides the issue.\r\n\r\nNoting this comment from the Geth issues: https://github.com/ethereum/go-ethereum/pull/17438#issuecomment-414105798\r\n\r\nI'm curious, does your command work against Geth? I don't have a Geth node with that API handy.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/714829081/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/729682952",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1275#issuecomment-729682952",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1275",
    "id": 729682952,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyOTY4Mjk1Mg==",
    "user": {
      "login": "tjayrush",
      "id": 5417918,
      "node_id": "MDQ6VXNlcjU0MTc5MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5417918?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tjayrush",
      "html_url": "https://github.com/tjayrush",
      "followers_url": "https://api.github.com/users/tjayrush/followers",
      "following_url": "https://api.github.com/users/tjayrush/following{/other_user}",
      "gists_url": "https://api.github.com/users/tjayrush/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tjayrush/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tjayrush/subscriptions",
      "organizations_url": "https://api.github.com/users/tjayrush/orgs",
      "repos_url": "https://api.github.com/users/tjayrush/repos",
      "events_url": "https://api.github.com/users/tjayrush/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tjayrush/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-18T13:39:41Z",
    "updated_at": "2020-11-18T22:59:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "This line (https://github.com/ledgerwatch/turbo-geth/blob/account-range/core/state/history.go#L327) assigns `hK0` to be equal to `hK`.\r\n\r\nThe next line tests for equality of those two keys which always returns `true`.\r\n\r\nTherefore, the second part of the test on line 328 never gets tested, and as a result every loop advances the cursor.\r\n\r\n(You'd get the same result if you only tested `hK != nil`.)\r\n\r\n~I'm not sure what the correct behavior should be, but line 328 does not do what it appears to do.~",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/729682952/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/729688511",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1275#issuecomment-729688511",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1275",
    "id": 729688511,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyOTY4ODUxMQ==",
    "user": {
      "login": "AlexeyAkhunov",
      "id": 13686139,
      "node_id": "MDQ6VXNlcjEzNjg2MTM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AlexeyAkhunov",
      "html_url": "https://github.com/AlexeyAkhunov",
      "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
      "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
      "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
      "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
      "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-18T13:49:57Z",
    "updated_at": "2020-11-18T13:49:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "> The trouble is `bytes.Equal(hK0, hK)` always returns `true`, which means the second test on that line never gets tested, and as a result every loop advances the cursor.\r\n\r\nThe intended behaviour is to skip away from the `hk0` and find the next `hK` for which the timestamp is >= `timestamp`, so in effect, the next \"interesting\" record. I had a plan to replace this loop with a `Seek` for better performance, but it will probably be done after we change history index to bitmaps",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/729688511/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/729692220",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1275#issuecomment-729692220",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1275",
    "id": 729692220,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyOTY5MjIyMA==",
    "user": {
      "login": "tjayrush",
      "id": 5417918,
      "node_id": "MDQ6VXNlcjU0MTc5MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5417918?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tjayrush",
      "html_url": "https://github.com/tjayrush",
      "followers_url": "https://api.github.com/users/tjayrush/followers",
      "following_url": "https://api.github.com/users/tjayrush/following{/other_user}",
      "gists_url": "https://api.github.com/users/tjayrush/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tjayrush/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tjayrush/subscriptions",
      "organizations_url": "https://api.github.com/users/tjayrush/orgs",
      "repos_url": "https://api.github.com/users/tjayrush/repos",
      "events_url": "https://api.github.com/users/tjayrush/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tjayrush/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-18T13:55:34Z",
    "updated_at": "2020-11-18T19:25:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "I was reading it wrong...",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/729692220/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
