{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3505",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3505/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3505/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3505/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/3505",
  "id": 1135048287,
  "node_id": "I_kwDOC0FsAM5Dp3Zf",
  "number": 3505,
  "title": "Readonly nodes",
  "user": {
    "login": "BirdyUK",
    "id": 25714822,
    "node_id": "MDQ6VXNlcjI1NzE0ODIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/25714822?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/BirdyUK",
    "html_url": "https://github.com/BirdyUK",
    "followers_url": "https://api.github.com/users/BirdyUK/followers",
    "following_url": "https://api.github.com/users/BirdyUK/following{/other_user}",
    "gists_url": "https://api.github.com/users/BirdyUK/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/BirdyUK/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/BirdyUK/subscriptions",
    "organizations_url": "https://api.github.com/users/BirdyUK/orgs",
    "repos_url": "https://api.github.com/users/BirdyUK/repos",
    "events_url": "https://api.github.com/users/BirdyUK/events{/privacy}",
    "received_events_url": "https://api.github.com/users/BirdyUK/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-02-13T02:53:03Z",
  "updated_at": "2022-02-13T15:01:50Z",
  "closed_at": "2022-02-13T15:01:50Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi,\r\n\r\nIs it possible and reliable to create a ready only node from the datadir? My theory behind this would be to create a Kubernetes Persistent Volume that one or many pods can read from but not write to for redundancy.\r\n\r\nI believe trying to create multiple erigon instances would attempt to write new blocks to the dataset thus throws an error stating the datadir is already in use.\r\n\r\nWhat would be a the best solution to create read only nodes from the main dataset?\r\n\r\nThanks",
  "closed_by": {
    "login": "BirdyUK",
    "id": 25714822,
    "node_id": "MDQ6VXNlcjI1NzE0ODIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/25714822?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/BirdyUK",
    "html_url": "https://github.com/BirdyUK",
    "followers_url": "https://api.github.com/users/BirdyUK/followers",
    "following_url": "https://api.github.com/users/BirdyUK/following{/other_user}",
    "gists_url": "https://api.github.com/users/BirdyUK/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/BirdyUK/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/BirdyUK/subscriptions",
    "organizations_url": "https://api.github.com/users/BirdyUK/orgs",
    "repos_url": "https://api.github.com/users/BirdyUK/repos",
    "events_url": "https://api.github.com/users/BirdyUK/events{/privacy}",
    "received_events_url": "https://api.github.com/users/BirdyUK/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3505/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3505/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1037807755",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3505#issuecomment-1037807755",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3505",
    "id": 1037807755,
    "node_id": "IC_kwDOC0FsAM4927CL",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-13T05:49:20Z",
    "updated_at": "2022-02-13T05:49:20Z",
    "author_association": "COLLABORATOR",
    "body": "1. Erigon's flags: --nodiscover --txpool.disable\r\n2. On 1 datadir can start 1 Erigon and multiple RPCDaemon's if need (it opens db in ReadOnly mode).\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1037807755/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1038044210",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3505#issuecomment-1038044210",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3505",
    "id": 1038044210,
    "node_id": "IC_kwDOC0FsAM4930wy",
    "user": {
      "login": "BirdyUK",
      "id": 25714822,
      "node_id": "MDQ6VXNlcjI1NzE0ODIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/25714822?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BirdyUK",
      "html_url": "https://github.com/BirdyUK",
      "followers_url": "https://api.github.com/users/BirdyUK/followers",
      "following_url": "https://api.github.com/users/BirdyUK/following{/other_user}",
      "gists_url": "https://api.github.com/users/BirdyUK/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BirdyUK/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BirdyUK/subscriptions",
      "organizations_url": "https://api.github.com/users/BirdyUK/orgs",
      "repos_url": "https://api.github.com/users/BirdyUK/repos",
      "events_url": "https://api.github.com/users/BirdyUK/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BirdyUK/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-13T11:41:44Z",
    "updated_at": "2022-02-13T11:43:29Z",
    "author_association": "NONE",
    "body": "So to have multiple read-only instances, all one needs is multiple RPCDaemon's?\r\n\r\nMy theory is something like this... (Just a basic diagram.. in reality it will be a k8 cluster)\r\n\r\n1) Erigon ingests data to the Datadir\r\n2) Multiple RPCDaemon's read from the datadir and traffic is distributed over a Load balancer / proxy to the available RPC pods\r\n\r\n<img height=\"500px\" src=\"https://i.ibb.co/cw6WF6C/erigon-flow.png\" />\r\n\r\nDoes that sound reasonable to you?\r\n\r\nPS: Thanks for doing an amazing job with erigon, i am currently using it for both eth and bsc full archive nodes, you should consider allowing funding to support the project :-)",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1038044210/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1038075557",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3505#issuecomment-1038075557",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3505",
    "id": 1038075557,
    "node_id": "IC_kwDOC0FsAM4938al",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-13T12:28:31Z",
    "updated_at": "2022-02-13T12:28:31Z",
    "author_association": "COLLABORATOR",
    "body": "Yes. It must cover 99% of cases. \r\n\r\nAnd if RPCDaemons will have access to same datadir - they will share same OS’s PageCache.\r\n\r\nBut they mush have different PID: https://github.com/ledgerwatch/erigon/blob/3655f9e629c4e7c4613425582cadb2812298c292/docker-compose.yml#L50",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1038075557/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
