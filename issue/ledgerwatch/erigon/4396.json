{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4396",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4396/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4396/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4396/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/4396",
  "id": 1263080364,
  "node_id": "I_kwDOC0FsAM5LSROs",
  "number": 4396,
  "title": "panic: interface is nil, not simplelru.entry",
  "user": {
    "login": "battlmonstr",
    "id": 11477595,
    "node_id": "MDQ6VXNlcjExNDc3NTk1",
    "avatar_url": "https://avatars.githubusercontent.com/u/11477595?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/battlmonstr",
    "html_url": "https://github.com/battlmonstr",
    "followers_url": "https://api.github.com/users/battlmonstr/followers",
    "following_url": "https://api.github.com/users/battlmonstr/following{/other_user}",
    "gists_url": "https://api.github.com/users/battlmonstr/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/battlmonstr/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/battlmonstr/subscriptions",
    "organizations_url": "https://api.github.com/users/battlmonstr/orgs",
    "repos_url": "https://api.github.com/users/battlmonstr/repos",
    "events_url": "https://api.github.com/users/battlmonstr/events{/privacy}",
    "received_events_url": "https://api.github.com/users/battlmonstr/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-06-07T10:33:10Z",
  "updated_at": "2022-11-14T11:24:16Z",
  "closed_at": "2022-11-14T11:24:16Z",
  "author_association": "COLLABORATOR",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon devel commit\r\n\r\nOS & Version: Linux\r\n\r\nCommit hash : e13e21228893d5ccda5e24d578ab8618d63ff559\r\n\r\n#### Actual behaviour\r\n\r\npanic\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\nThe node was running for a several days on mainnet, then crashed. Portion of the log above this doesn't seem related:\r\n\r\n```\r\n{\"anchors\":0,\"highestInDb\":14894000,\"lvl\":\"dbug\",\"msg\":\"Request skeleton\",\"t\":\"2022-06-06T05:45:51.843547821Z\",\"top seen height\":14913295}\r\n{\"err\":\"rlp parse transaction: transaction must be either 1 list or 1 string\",\"lvl\":\"dbug\",\"msg\":\"TRANSACTIONS_66\",\"t\":\"2022-06-06T05:45:52.176437141Z\"}\r\n{\"anchors\":0,\"highestInDb\":14894000,\"lvl\":\"dbug\",\"msg\":\"Request skeleton\",\"t\":\"2022-06-06T05:45:53.562843466Z\",\"top seen height\":14913295}\r\n{\"anchors\":0,\"highestInDb\":14894000,\"lvl\":\"dbug\",\"msg\":\"Request skeleton\",\"t\":\"2022-06-06T05:45:54.645497085Z\",\"top seen height\":14913295}\r\n{\"anchors\":0,\"highestInDb\":14894000,\"lvl\":\"dbug\",\"msg\":\"Request skeleton\",\"t\":\"2022-06-06T05:45:55.718942174Z\",\"top seen height\":14913295}\r\n{\"anchors\":0,\"highestInDb\":14894000,\"lvl\":\"dbug\",\"msg\":\"Request skeleton\",\"t\":\"2022-06-06T05:45:56.791970688Z\",\"top seen height\":14913295}\r\n{\"anchors\":0,\"highestInDb\":14894000,\"lvl\":\"dbug\",\"msg\":\"Request skeleton\",\"t\":\"2022-06-06T05:45:58.309839252Z\",\"top seen height\":14913295}\r\n{\"anchors\":0,\"highestInDb\":14894000,\"lvl\":\"dbug\",\"msg\":\"Request skeleton\",\"t\":\"2022-06-06T05:46:00.266938821Z\",\"top seen height\":14913295}\r\n{\"alloc\":\"3.7Gb\",\"blk/second\":0,\"lvl\":\"info\",\"msg\":\"[1/16 Headers] Wrote block headers\",\"number\":14894000,\"sys\":\"10.4Gb\",\"t\":\"2022-06-06T05:46:01.316511832Z\"}\r\n{\"lvl\":\"info\",\"msg\":\"Req/resp stats\",\"req\":0,\"reqMax\":0,\"reqMin\":0,\"resp\":49,\"respMax\":14913295,\"respMin\":14895536,\"skel\":16,\"skelMax\":15190256,\"skelMin\":14895536,\"t\":\"2022-06-06T05:46:01.316580177Z\"}\r\n{\"anchors\":0,\"highestInDb\":14894000,\"lvl\":\"dbug\",\"msg\":\"Request skeleton\",\"t\":\"2022-06-06T05:46:02.316690936Z\",\"top seen height\":14913295}\r\n{\"anchors\":0,\"highestInDb\":14894000,\"lvl\":\"dbug\",\"msg\":\"Request skeleton\",\"t\":\"2022-06-06T05:46:03.608503111Z\",\"top seen height\":14913295}\r\n{\"anchors\":0,\"highestInDb\":14894000,\"lvl\":\"dbug\",\"msg\":\"Request skeleton\",\"t\":\"2022-06-06T05:46:05.120243196Z\",\"top seen height\":14913295}\r\n{\"anchors\":0,\"highestInDb\":14894000,\"lvl\":\"dbug\",\"msg\":\"Request skeleton\",\"t\":\"2022-06-06T05:46:06.613334117Z\",\"top seen height\":14913295}\r\n{\"anchors\":0,\"highestInDb\":14894000,\"lvl\":\"dbug\",\"msg\":\"Request skeleton\",\"t\":\"2022-06-06T05:46:07.686272304Z\",\"top seen height\":14913295}\r\n{\"anchors\":0,\"highestInDb\":14894000,\"lvl\":\"dbug\",\"msg\":\"Request skeleton\",\"t\":\"2022-06-06T05:46:08.88416941Z\",\"top seen height\":14913295}\r\n{\"anchors\":0,\"highestInDb\":14894000,\"lvl\":\"dbug\",\"msg\":\"Request skeleton\",\"t\":\"2022-06-06T05:46:09.936544237Z\",\"top seen height\":14913295}\r\n{\"anchors\":0,\"highestInDb\":14894000,\"lvl\":\"dbug\",\"msg\":\"Request skeleton\",\"t\":\"2022-06-06T05:46:11.399734627Z\",\"top seen height\":14913295}\r\n```\r\n\r\n#### Backtrace\r\n\r\n```\r\npanic: interface conversion: interface {} is nil, not *simplelru.entry\r\n\r\ngoroutine 6667 [running]:\r\ngithub.com/hashicorp/golang-lru/simplelru.(*LRU).removeElement(0x17777a0?, 0xc07ca6f660?)\r\n\tgithub.com/hashicorp/golang-lru@v0.5.5-0.20210104140557-80c98217689d/simplelru/lru.go:172 +0x107\r\ngithub.com/hashicorp/golang-lru/simplelru.(*LRU).removeOldest(0x1656260?)\r\n\tgithub.com/hashicorp/golang-lru@v0.5.5-0.20210104140557-80c98217689d/simplelru/lru.go:165 +0x34\r\ngithub.com/hashicorp/golang-lru/simplelru.(*LRU).Add(0xc0a1f36a00, {0x15dd700?, 0xc0f42c81f0}, {0x1627a60?, 0x29d4668})\r\n\tgithub.com/hashicorp/golang-lru@v0.5.5-0.20210104140557-80c98217689d/simplelru/lru.go:67 +0x394\r\ngithub.com/ledgerwatch/erigon-lib/txpool.(*TxPool).discardLocked(0xc09eb5e600, 0xc09c93a1e0, 0xd)\r\n\tgithub.com/ledgerwatch/erigon-lib@v0.0.0-20220530021709-f5c973d4c534/txpool/pool.go:1068 +0x15a\r\ngithub.com/ledgerwatch/erigon-lib/txpool.promote(0xc09eb6e8c0, 0xc09eb6e900, 0xc09eb6e940, 0x15867687d9, 0xc07ca6fbe8)\r\n\tgithub.com/ledgerwatch/erigon-lib@v0.0.0-20220530021709-f5c973d4c534/txpool/pool.go:1296 +0x354\r\ngithub.com/ledgerwatch/erigon-lib/txpool.addTxs(0xe343b0, {0x1e98340, 0xc077c331d0}, 0x218038?, {{0xc0911d6298, 0x1, 0x1}, {0xc040229c98, 0x14, 0x18}, ...}, ...)\r\n\tgithub.com/ledgerwatch/erigon-lib@v0.0.0-20220530021709-f5c973d4c534/txpool/pool.go:928 +0x787\r\ngithub.com/ledgerwatch/erigon-lib/txpool.(*TxPool).processRemoteTxs(0xc09eb5e600, {0x1ea1208, 0xc0004ea9c0?})\r\n\tgithub.com/ledgerwatch/erigon-lib@v0.0.0-20220530021709-f5c973d4c534/txpool/pool.go:510 +0x48d\r\ngithub.com/ledgerwatch/erigon-lib/txpool.MainLoop({0x1ea1208?, 0xc0004ea9c0}, {0x1ea5440, 0xc09c8bd2c0}, {0x2b61e40?, 0xc09dee5fa0?}, 0xc09eb5e600, 0xc09eb4daa0, 0xc09eb6e980, 0xc09eb76a68, ...)\r\n\tgithub.com/ledgerwatch/erigon-lib@v0.0.0-20220530021709-f5c973d4c534/txpool/pool.go:1334 +0x54e\r\ncreated by github.com/ledgerwatch/erigon/eth.New\r\n\tgithub.com/ledgerwatch/erigon/eth/backend.go:461 +0x3031\r\n```\r\n",
  "closed_by": {
    "login": "yperbasis",
    "id": 34320705,
    "node_id": "MDQ6VXNlcjM0MzIwNzA1",
    "avatar_url": "https://avatars.githubusercontent.com/u/34320705?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/yperbasis",
    "html_url": "https://github.com/yperbasis",
    "followers_url": "https://api.github.com/users/yperbasis/followers",
    "following_url": "https://api.github.com/users/yperbasis/following{/other_user}",
    "gists_url": "https://api.github.com/users/yperbasis/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/yperbasis/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/yperbasis/subscriptions",
    "organizations_url": "https://api.github.com/users/yperbasis/orgs",
    "repos_url": "https://api.github.com/users/yperbasis/repos",
    "events_url": "https://api.github.com/users/yperbasis/events{/privacy}",
    "received_events_url": "https://api.github.com/users/yperbasis/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4396/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4396/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1153458540",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4396#issuecomment-1153458540",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4396",
    "id": 1153458540,
    "node_id": "IC_kwDOC0FsAM5EwGFs",
    "user": {
      "login": "JekaMas",
      "id": 3192700,
      "node_id": "MDQ6VXNlcjMxOTI3MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3192700?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JekaMas",
      "html_url": "https://github.com/JekaMas",
      "followers_url": "https://api.github.com/users/JekaMas/followers",
      "following_url": "https://api.github.com/users/JekaMas/following{/other_user}",
      "gists_url": "https://api.github.com/users/JekaMas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JekaMas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JekaMas/subscriptions",
      "organizations_url": "https://api.github.com/users/JekaMas/orgs",
      "repos_url": "https://api.github.com/users/JekaMas/repos",
      "events_url": "https://api.github.com/users/JekaMas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JekaMas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-13T04:32:09Z",
    "updated_at": "2022-06-13T04:32:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "It might worth it to use the same package with generics and forget about golang interfaces - https://github.com/hashicorp/golang-lru/pull/101",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1153458540/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
