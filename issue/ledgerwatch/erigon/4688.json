{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/4688",
  "id": 1299803694,
  "node_id": "I_kwDOC0FsAM5NeW4u",
  "number": 4688,
  "title": "Goerli initial sync: db error, streaming issue, silent crashes",
  "user": {
    "login": "mohoff",
    "id": 6060612,
    "node_id": "MDQ6VXNlcjYwNjA2MTI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6060612?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mohoff",
    "html_url": "https://github.com/mohoff",
    "followers_url": "https://api.github.com/users/mohoff/followers",
    "following_url": "https://api.github.com/users/mohoff/following{/other_user}",
    "gists_url": "https://api.github.com/users/mohoff/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mohoff/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mohoff/subscriptions",
    "organizations_url": "https://api.github.com/users/mohoff/orgs",
    "repos_url": "https://api.github.com/users/mohoff/repos",
    "events_url": "https://api.github.com/users/mohoff/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mohoff/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 12,
  "created_at": "2022-07-10T01:40:15Z",
  "updated_at": "2022-09-16T02:27:10Z",
  "closed_at": "2022-09-16T02:27:10Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: latest `2022.07.02`\r\n\r\n\r\n#### Expected behaviour\r\n\r\nclean sync\r\n\r\n#### Actual behaviour\r\n\r\nErigon seems to silently crash during sync. Erigon is managed by `runit` which should explain the restarts.\r\n\r\n```\r\n[INFO] [07-10|01:26:53.647] [4/16 Bodies] Wrote block bodies         block_num=7037637 delivery/sec=35.2MB wasted/sec=19.5MB alloc=3.6GB sys=6.9GB\r\n[INFO] [07-10|01:27:13.664] [4/16 Bodies] Wrote block bodies         block_num=7037685 delivery/sec=102.1MB wasted/sec=27.9MB alloc=7.5GB sys=7.9GB\r\n[WARN] [07-10|01:27:15.208] Handling incoming message                stream=RecvMessage err=\"decode BlockBodiesPacket66: rlp: input list has too many elements for eth.BlockRawBodiesPacket66\"\r\n[WARN] [07-10|01:27:15.364] Handling incoming message                stream=RecvMessage err=\"decode BlockBodiesPacket66: rlp: input list has too many elements for eth.BlockRawBodiesPacket66\"\r\n[INFO] [07-10|01:27:33.348] [p2p] GoodPeers                          eth66=3\r\n[INFO] [07-10|01:27:33.645] [4/16 Bodies] Wrote block bodies         block_num=7037745 delivery/sec=117.2MB wasted/sec=0B alloc=10.3GB sys=11.8GB\r\n[INFO] [07-10|01:27:49.867] [txpool] stat                            block=7199665 pending=0 baseFee=0 queued=0 alloc=11.3GB sys=11.8GB\r\n>>>> Starting Erigon goerli public chain <<<< : /usr/local/bin/erigon : data directory : /home/erigon/erigon-goerli-data\r\n[INFO] [07-10|01:27:51.107] Build info                               git_branch=HEAD git_tag=v2022.07.02-dirty git_commit=c7a94eeea05d7c0d569c811399642a7d108d8c82\r\n[INFO] [07-10|01:27:51.107] Starting Erigon on GÃ¶rli testnet... \r\n[INFO] [07-10|01:27:51.107] Maximum peer count                       ETH=100 total=100\r\n[INFO] [07-10|01:27:51.107] torrent verbosity                        level=2\r\n[INFO] [07-10|01:27:53.210] Set global gas cap                       cap=50000000\r\n[INFO] [07-10|01:27:53.211] Opening Database                         label=chaindata path=/home/erigon/erigon-goerli-data/chaindata\r\nmdbx_setup_dxb:15446 filesize mismatch (expect 2147483648b/524288p, have 10737418240b/2621440p)\r\n[INFO] [07-10|01:27:53.233] Initialised chain configuration          config=\"{ChainID: 5, Homestead: 0, DAO: <nil>, DAO Support: true, Tangerine Whistle: 0, Spurious Dragon: 0, Byzantium: 0, Constantinople: 0, Petersburg: 0, Istanbul: 1561651, Muir Glacier: <nil>, Berlin: 4460644, London: 5062605, Arrow Glacier: <nil>, Gray Glacier: <nil>, Terminal Total Difficulty: <nil>, Engine: clique}\" genesis=0xbf7e331f7f7c1dd2e05159666b3bf8bc7a8a3a9eb1d518969eab529dd9b88c1a\r\n[INFO] [07-10|01:27:53.233] Initialising Ethereum protocol           network=5\r\n[INFO] [07-10|01:27:53.233] Using snapshots                          on=true\r\n[INFO] [07-10|01:27:53.234] Effective                                prune_flags= snapshot_flags=\"--snapshots=true\"\r\n[INFO] [07-10|01:28:09.536] Starting private RPC server              on=localhost:9090\r\n[INFO] [07-10|01:28:09.536] new subscription to logs established \r\n[INFO] [07-10|01:28:09.547] [txpool] Started \r\n[INFO] [07-10|01:28:09.547] [Snapshots] Fetching torrent files metadata \r\n[INFO] [07-10|01:28:09.592] Started P2P networking                   version=66 self=enode://29cd13bbed59ee3a9bc264c7277c0b8a376482b943d938ef02e01a787f7b90d4b385ca57be6929e6a4c844665cf4ca2b767849c7c5415e59b41651c384184759@127.0.0.1:30303 name=erigon/v2022.07.2-alpha-c7a94eee/linux-amd64/go1.18.1\r\n[INFO] [07-10|01:28:10.295] [Snapshots] Stat                         blocks=6999999 segments=6999999 indices=6999999 alloc=656.9MB sys=876.1MB\r\n[INFO] [07-10|01:28:10.296] [1/16 Headers] Waiting for headers...    from=7199700\r\n[INFO] [07-10|01:28:30.296] [1/16 Headers] Wrote block headers       number=7199700 blk/second=0.000 alloc=670.8MB sys=876.1MB\r\n[INFO] [07-10|01:28:50.297] [1/16 Headers] Wrote block headers       number=7199700 blk/second=0.000 alloc=683.9MB sys=876.3MB\r\n[INFO] [07-10|01:28:53.409] [1/16 Headers] Processed                 highest inserted=7199714 age=0\r\n[INFO] [07-10|01:28:53.441] [4/16 Bodies] Processing bodies...       from=7000036 to=7199714\r\n```\r\n\r\nI can't tell if it's related to\r\n\r\n```\r\nHandling incoming message                stream=RecvMessage err=\"decode BlockBodiesPacket66: rlp: input list has too many elements for eth.BlockRawBodiesPacket66\"\r\n```\r\n\r\nor\r\n\r\n```\r\n[INFO] [07-10|01:27:53.211] Opening Database                         label=chaindata path=/home/erigon/erigon-goerli-data/chaindata\r\nmdbx_setup_dxb:15446 filesize mismatch (expect 2147483648b/524288p, have 10737418240b/2621440p)\r\n```\r\n\r\nI have to observe further, it seems it's still making sync progress.\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\nNoteable erigon args:\r\n\r\n```\r\n--chain goerli \\\r\n--private.api.addr \"localhost:9090\" \\\r\n--http=false \\\r\n--snapshots=true \\\r\n--torrent.download.rate 64mb \\\r\n```\r\n",
  "closed_by": {
    "login": "AskAlexSharov",
    "id": 46885206,
    "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AskAlexSharov",
    "html_url": "https://github.com/AskAlexSharov",
    "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
    "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
    "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
    "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
    "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1179638180",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4688#issuecomment-1179638180",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688",
    "id": 1179638180,
    "node_id": "IC_kwDOC0FsAM5GT9mk",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-10T02:10:10Z",
    "updated_at": "2022-07-10T02:10:10Z",
    "author_association": "COLLABORATOR",
    "body": "OOM killer?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1179638180/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1179653942",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4688#issuecomment-1179653942",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688",
    "id": 1179653942,
    "node_id": "IC_kwDOC0FsAM5GUBc2",
    "user": {
      "login": "mohoff",
      "id": 6060612,
      "node_id": "MDQ6VXNlcjYwNjA2MTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6060612?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mohoff",
      "html_url": "https://github.com/mohoff",
      "followers_url": "https://api.github.com/users/mohoff/followers",
      "following_url": "https://api.github.com/users/mohoff/following{/other_user}",
      "gists_url": "https://api.github.com/users/mohoff/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mohoff/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mohoff/subscriptions",
      "organizations_url": "https://api.github.com/users/mohoff/orgs",
      "repos_url": "https://api.github.com/users/mohoff/repos",
      "events_url": "https://api.github.com/users/mohoff/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mohoff/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-10T04:27:43Z",
    "updated_at": "2022-07-10T04:27:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "@AskAlexSharov Digged out some graphs, there are definitely spikes but it's not capping out\r\n\r\n\r\n<img width=\"1619\" alt=\"Screen Shot 2022-07-09 at 23 24 22\" src=\"https://user-images.githubusercontent.com/6060612/178131261-30ba1f69-c5fa-4a7f-9813-e1bfe109b876.png\">\r\n\r\nRegarding \"it's still making progress\": Looks stuck, it's jumping around in block numbers and on each restart, the db issue shows up:\r\n\r\n```\r\nINFO] [07-10|04:25:26.844] [4/16 Bodies] Wrote block bodies         block_num=7037922 delivery/sec=70.6MB wasted/sec=3.3MB alloc=9.4GB sys=12.8GB\r\n[INFO] [07-10|04:25:31.219] [txpool] stat                            block=7200375 pending=0 baseFee=0 queued=0 alloc=10.4GB sys=12.8GB\r\n>>>> Starting Erigon goerli public chain <<<< : /usr/local/bin/erigon : data directory : /home/erigon/erigon-goerli-data\r\n[INFO] [07-10|04:25:39.383] Build info                               git_branch=HEAD git_tag=v2022.07.02-dirty git_commit=c7a94eeea05d7c0d569c811399642a7d108d8c82\r\n[INFO] [07-10|04:25:39.383] Starting Erigon on GÃ¶rli testnet...\r\n[INFO] [07-10|04:25:39.384] Maximum peer count                       ETH=100 total=100\r\n[INFO] [07-10|04:25:39.384] torrent verbosity                        level=2\r\n[INFO] [07-10|04:25:41.486] Set global gas cap                       cap=50000000\r\n[INFO] [07-10|04:25:41.486] Opening Database                         label=chaindata path=/home/erigon/erigon-goerli-data/chaindata\r\nmdbx_setup_dxb:15446 filesize mismatch (expect 2147483648b/524288p, have 8589934592b/2097152p)\r\n[INFO] [07-10|04:25:41.509] Initialised chain configuration          config=\"{ChainID: 5, Homestead: 0, DAO: <nil>, DAO Support: true, Tangerine Whistle: 0, Spurious Dragon: 0, Byzantium: 0, Constantinople: 0, Petersburg: 0, Istanbul: 1561651, Muir Glacier: <nil>, Berlin: 4460644, London: 5062605, Arrow Glacier: <nil>, Gray Glacier: <nil>, Terminal Total Difficulty: <nil>, Engine: clique}\" genesis=0xbf7e331f7f7c1dd2e05159666b3bf8bc7a8a3a9eb1d518969eab529dd9b88c1a\r\n[INFO] [07-10|04:25:41.509] Initialising Ethereum protocol           network=5\r\n[INFO] [07-10|04:25:41.509] Using snapshots                          on=true\r\n[INFO] [07-10|04:25:41.510] Effective                                prune_flags= snapshot_flags=\"--snapshots=true\"\r\n[INFO] [07-10|04:25:57.851] Starting private RPC server              on=localhost:9090\r\n[INFO] [07-10|04:25:57.851] new subscription to logs established\r\n[INFO] [07-10|04:25:57.861] [txpool] Started\r\n[INFO] [07-10|04:25:57.861] [Snapshots] Fetching torrent files metadata\r\n[INFO] [07-10|04:25:57.903] Started P2P networking                   version=66 self=enode://29cd13bbed59ee3a9bc264c7277c0b8a376482b943d938ef02e01a787f7b90d4b385ca57be6929e6a4c844665cf4ca2b767849c7c5415e59b41651c384184759@127.0.0.1:30303 name=erigon/v2022.07.2-alpha-c7a94eee/linux-amd64/go1.18.1\r\n[INFO] [07-10|04:25:58.676] [Snapshots] Stat                         blocks=6999999 segments=6999999 indices=6999999 alloc=586.3MB sys=1.2GB\r\n[INFO] [07-10|04:25:58.677] [1/16 Headers] Waiting for headers...    from=7200401\r\n[INFO] [07-10|04:26:18.677] [1/16 Headers] Wrote block headers       number=7200401 blk/second=0.000 alloc=601.6MB sys=1.2GB\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1179653942/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1179727509",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4688#issuecomment-1179727509",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688",
    "id": 1179727509,
    "node_id": "IC_kwDOC0FsAM5GUTaV",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-10T13:17:42Z",
    "updated_at": "2022-07-10T13:17:42Z",
    "author_association": "COLLABORATOR",
    "body": "Itâs OOM killer. Maybe we have mem leak. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1179727509/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1180098809",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4688#issuecomment-1180098809",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688",
    "id": 1180098809,
    "node_id": "IC_kwDOC0FsAM5GVuD5",
    "user": {
      "login": "mandrigin",
      "id": 466427,
      "node_id": "MDQ6VXNlcjQ2NjQyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/466427?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mandrigin",
      "html_url": "https://github.com/mandrigin",
      "followers_url": "https://api.github.com/users/mandrigin/followers",
      "following_url": "https://api.github.com/users/mandrigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mandrigin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mandrigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mandrigin/subscriptions",
      "organizations_url": "https://api.github.com/users/mandrigin/orgs",
      "repos_url": "https://api.github.com/users/mandrigin/repos",
      "events_url": "https://api.github.com/users/mandrigin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mandrigin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-11T08:14:51Z",
    "updated_at": "2022-07-11T08:14:51Z",
    "author_association": "COLLABORATOR",
    "body": "We had the same issue when syncing Goerli specifically, after 2-4 OOMs it went fine.\r\nI even shared the trace in Discord. Let me try to find it.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1180098809/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1180099181",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4688#issuecomment-1180099181",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688",
    "id": 1180099181,
    "node_id": "IC_kwDOC0FsAM5GVuJt",
    "user": {
      "login": "mandrigin",
      "id": 466427,
      "node_id": "MDQ6VXNlcjQ2NjQyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/466427?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mandrigin",
      "html_url": "https://github.com/mandrigin",
      "followers_url": "https://api.github.com/users/mandrigin/followers",
      "following_url": "https://api.github.com/users/mandrigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mandrigin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mandrigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mandrigin/subscriptions",
      "organizations_url": "https://api.github.com/users/mandrigin/orgs",
      "repos_url": "https://api.github.com/users/mandrigin/repos",
      "events_url": "https://api.github.com/users/mandrigin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mandrigin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-11T08:15:14Z",
    "updated_at": "2022-07-11T08:15:14Z",
    "author_association": "COLLABORATOR",
    "body": "\r\n![](https://media.discordapp.net/attachments/687972960811745326/994895618868789278/profile001.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1180099181/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1180099648",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4688#issuecomment-1180099648",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688",
    "id": 1180099648,
    "node_id": "IC_kwDOC0FsAM5GVuRA",
    "user": {
      "login": "mandrigin",
      "id": 466427,
      "node_id": "MDQ6VXNlcjQ2NjQyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/466427?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mandrigin",
      "html_url": "https://github.com/mandrigin",
      "followers_url": "https://api.github.com/users/mandrigin/followers",
      "following_url": "https://api.github.com/users/mandrigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mandrigin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mandrigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mandrigin/subscriptions",
      "organizations_url": "https://api.github.com/users/mandrigin/orgs",
      "repos_url": "https://api.github.com/users/mandrigin/repos",
      "events_url": "https://api.github.com/users/mandrigin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mandrigin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-11T08:15:42Z",
    "updated_at": "2022-07-11T08:15:42Z",
    "author_association": "COLLABORATOR",
    "body": "When syncing Goerli, it took about 26 GB of RAM to get through it successfully.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1180099648/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1180100212",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4688#issuecomment-1180100212",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688",
    "id": 1180100212,
    "node_id": "IC_kwDOC0FsAM5GVuZ0",
    "user": {
      "login": "mandrigin",
      "id": 466427,
      "node_id": "MDQ6VXNlcjQ2NjQyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/466427?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mandrigin",
      "html_url": "https://github.com/mandrigin",
      "followers_url": "https://api.github.com/users/mandrigin/followers",
      "following_url": "https://api.github.com/users/mandrigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mandrigin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mandrigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mandrigin/subscriptions",
      "organizations_url": "https://api.github.com/users/mandrigin/orgs",
      "repos_url": "https://api.github.com/users/mandrigin/repos",
      "events_url": "https://api.github.com/users/mandrigin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mandrigin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-11T08:16:14Z",
    "updated_at": "2022-07-11T08:16:14Z",
    "author_association": "COLLABORATOR",
    "body": "That is at stage 4/16 â block bodies. BitTorrent sync is on.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1180100212/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1180687275",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4688#issuecomment-1180687275",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688",
    "id": 1180687275,
    "node_id": "IC_kwDOC0FsAM5GX9ur",
    "user": {
      "login": "mohoff",
      "id": 6060612,
      "node_id": "MDQ6VXNlcjYwNjA2MTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6060612?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mohoff",
      "html_url": "https://github.com/mohoff",
      "followers_url": "https://api.github.com/users/mohoff/followers",
      "following_url": "https://api.github.com/users/mohoff/following{/other_user}",
      "gists_url": "https://api.github.com/users/mohoff/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mohoff/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mohoff/subscriptions",
      "organizations_url": "https://api.github.com/users/mohoff/orgs",
      "repos_url": "https://api.github.com/users/mohoff/repos",
      "events_url": "https://api.github.com/users/mohoff/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mohoff/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-11T17:40:33Z",
    "updated_at": "2022-07-11T17:40:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "Now seeing after restart:\r\n\r\n```\r\n[INFO] [07-11|17:20:22.571] Opening Database                         label=chaindata path=/home/erigon/erigon-goerli-data/chaindata\r\nmdbx_ipclock_failed:30764 wlock owner died, recovering\r\n```\r\n\r\nAny ideas to repair this? Otherwise I purge and start from the beginning",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1180687275/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1181731536",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4688#issuecomment-1181731536",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688",
    "id": 1181731536,
    "node_id": "IC_kwDOC0FsAM5Gb8rQ",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-12T13:00:16Z",
    "updated_at": "2022-07-12T13:00:16Z",
    "author_association": "COLLABORATOR",
    "body": "Check that your processes have different pid: https://github.com/ledgerwatch/erigon/blob/b161c27ac318e5689656929ee032aea5b1c0350d/docker-compose.yml#L19",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1181731536/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1182624099",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4688#issuecomment-1182624099",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688",
    "id": 1182624099,
    "node_id": "IC_kwDOC0FsAM5GfWlj",
    "user": {
      "login": "mohoff",
      "id": 6060612,
      "node_id": "MDQ6VXNlcjYwNjA2MTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6060612?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mohoff",
      "html_url": "https://github.com/mohoff",
      "followers_url": "https://api.github.com/users/mohoff/followers",
      "following_url": "https://api.github.com/users/mohoff/following{/other_user}",
      "gists_url": "https://api.github.com/users/mohoff/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mohoff/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mohoff/subscriptions",
      "organizations_url": "https://api.github.com/users/mohoff/orgs",
      "repos_url": "https://api.github.com/users/mohoff/repos",
      "events_url": "https://api.github.com/users/mohoff/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mohoff/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-13T00:23:59Z",
    "updated_at": "2022-07-13T00:23:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "@AskAlexSharov Your example points at a multi-container setup but I have Erigon and RPC daemon running as separate processes in the same container. Does the PID tweak still apply?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1182624099/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1182654008",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4688#issuecomment-1182654008",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688",
    "id": 1182654008,
    "node_id": "IC_kwDOC0FsAM5Gfd44",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-13T01:15:45Z",
    "updated_at": "2022-07-13T01:15:45Z",
    "author_association": "COLLABORATOR",
    "body": "@mohoff you processes have different PID you are good",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1182654008/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1191735562",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4688#issuecomment-1191735562",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4688",
    "id": 1191735562,
    "node_id": "IC_kwDOC0FsAM5HCHEK",
    "user": {
      "login": "awskii",
      "id": 9694143,
      "node_id": "MDQ6VXNlcjk2OTQxNDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9694143?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/awskii",
      "html_url": "https://github.com/awskii",
      "followers_url": "https://api.github.com/users/awskii/followers",
      "following_url": "https://api.github.com/users/awskii/following{/other_user}",
      "gists_url": "https://api.github.com/users/awskii/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/awskii/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/awskii/subscriptions",
      "organizations_url": "https://api.github.com/users/awskii/orgs",
      "repos_url": "https://api.github.com/users/awskii/repos",
      "events_url": "https://api.github.com/users/awskii/events{/privacy}",
      "received_events_url": "https://api.github.com/users/awskii/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-21T17:08:52Z",
    "updated_at": "2022-07-21T17:08:52Z",
    "author_association": "COLLABORATOR",
    "body": "Well, `Raw` allocates buffers for encoded transactions, which escaped then through Delivery channel where those buffers are used, which causes Raw to not release allocated buffers.\r\nI changed `Delivery.tx` type from `[][][]byte` to `*[][][]byte` which helps GC to reduce memory usage but could potentially lead to NPE on processing tx after read from that channel. \r\n\r\n![Screenshot 2022-07-21 at 18 03 40](https://user-images.githubusercontent.com/9694143/180272281-b04e77ea-5537-4939-803a-83fc7a43ca05.png)\r\n\r\nCurrently double checking before push.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1191735562/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
