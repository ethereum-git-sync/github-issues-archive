{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/2977",
  "id": 1056221137,
  "node_id": "I_kwDOC0FsAM4-9KfR",
  "number": 2977,
  "title": "Sync Error HashState loading into HashedStorage",
  "user": {
    "login": "sglyon",
    "id": 1001948,
    "node_id": "MDQ6VXNlcjEwMDE5NDg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1001948?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sglyon",
    "html_url": "https://github.com/sglyon",
    "followers_url": "https://api.github.com/users/sglyon/followers",
    "following_url": "https://api.github.com/users/sglyon/following{/other_user}",
    "gists_url": "https://api.github.com/users/sglyon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sglyon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sglyon/subscriptions",
    "organizations_url": "https://api.github.com/users/sglyon/orgs",
    "repos_url": "https://api.github.com/users/sglyon/repos",
    "events_url": "https://api.github.com/users/sglyon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sglyon/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 14,
  "created_at": "2021-11-17T14:49:39Z",
  "updated_at": "2022-05-27T04:51:27Z",
  "closed_at": "2022-05-27T04:51:27Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: `./erigon --version`\r\n\r\nerigon version 2021.11.3-beta\r\n\r\nOS & Version: Linux Docker\r\n\r\n#### Expected behaviour\r\n\r\nTrying to sync. Should work\r\n\r\n\r\n#### Actual behaviour\r\n\r\nSync always gets error on HashState step when loading HashedStorage\r\n\r\nLogs here:  [erigon_logs.log](https://github.com/ledgerwatch/erigon/files/7555531/erigon_logs.log)\r\n\r\n\r\n",
  "closed_by": {
    "login": "AskAlexSharov",
    "id": 46885206,
    "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AskAlexSharov",
    "html_url": "https://github.com/AskAlexSharov",
    "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
    "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
    "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
    "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
    "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/971709927",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2977#issuecomment-971709927",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977",
    "id": 971709927,
    "node_id": "IC_kwDOC0FsAM456x3n",
    "user": {
      "login": "AlexeyAkhunov",
      "id": 13686139,
      "node_id": "MDQ6VXNlcjEzNjg2MTM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AlexeyAkhunov",
      "html_url": "https://github.com/AlexeyAkhunov",
      "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
      "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
      "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
      "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
      "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-17T15:49:20Z",
    "updated_at": "2021-11-17T15:49:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for reporting. This is one of the errors we dread the most (DB corruption).\r\nI would advise to reset the hashState stage to make it work. First, shut down Erigon. Then:\r\n```\r\n./build/bin/integration stage_hash_state --reset --datadir <your_datadir>\r\n./build/bin/integration stage_trie --reset --datadir <your_datadir>\r\n```\r\n\r\nand then start Erigon.\r\n\r\nI am just testing it on a copy of my node to see it if works, so if you want to be sure, please wait for me to report back",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/971709927/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/971738691",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2977#issuecomment-971738691",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977",
    "id": 971738691,
    "node_id": "IC_kwDOC0FsAM45645D",
    "user": {
      "login": "AlexeyAkhunov",
      "id": 13686139,
      "node_id": "MDQ6VXNlcjEzNjg2MTM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AlexeyAkhunov",
      "html_url": "https://github.com/AlexeyAkhunov",
      "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
      "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
      "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
      "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
      "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-17T16:20:42Z",
    "updated_at": "2021-11-17T16:20:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "I got through the `integration` invocations and now my Erigon node is recreating hash state. I think you can try this now",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/971738691/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/971802590",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2977#issuecomment-971802590",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977",
    "id": 971802590,
    "node_id": "IC_kwDOC0FsAM457Ife",
    "user": {
      "login": "sglyon",
      "id": 1001948,
      "node_id": "MDQ6VXNlcjEwMDE5NDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1001948?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sglyon",
      "html_url": "https://github.com/sglyon",
      "followers_url": "https://api.github.com/users/sglyon/followers",
      "following_url": "https://api.github.com/users/sglyon/following{/other_user}",
      "gists_url": "https://api.github.com/users/sglyon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sglyon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sglyon/subscriptions",
      "organizations_url": "https://api.github.com/users/sglyon/orgs",
      "repos_url": "https://api.github.com/users/sglyon/repos",
      "events_url": "https://api.github.com/users/sglyon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sglyon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-17T17:33:34Z",
    "updated_at": "2021-11-17T17:39:40Z",
    "author_association": "NONE",
    "body": "ok thank you! I am trying now and will report back when I am done",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/971802590/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/972432510",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2977#issuecomment-972432510",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977",
    "id": 972432510,
    "node_id": "IC_kwDOC0FsAM459iR-",
    "user": {
      "login": "sglyon",
      "id": 1001948,
      "node_id": "MDQ6VXNlcjEwMDE5NDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1001948?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sglyon",
      "html_url": "https://github.com/sglyon",
      "followers_url": "https://api.github.com/users/sglyon/followers",
      "following_url": "https://api.github.com/users/sglyon/following{/other_user}",
      "gists_url": "https://api.github.com/users/sglyon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sglyon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sglyon/subscriptions",
      "organizations_url": "https://api.github.com/users/sglyon/orgs",
      "repos_url": "https://api.github.com/users/sglyon/repos",
      "events_url": "https://api.github.com/users/sglyon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sglyon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-18T02:02:58Z",
    "updated_at": "2021-11-18T02:02:58Z",
    "author_association": "NONE",
    "body": "That fixed it! \r\n\r\nThank you!",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/972432510/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/995233439",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2977#issuecomment-995233439",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977",
    "id": 995233439,
    "node_id": "IC_kwDOC0FsAM47Ug6f",
    "user": {
      "login": "sglyon",
      "id": 1001948,
      "node_id": "MDQ6VXNlcjEwMDE5NDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1001948?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sglyon",
      "html_url": "https://github.com/sglyon",
      "followers_url": "https://api.github.com/users/sglyon/followers",
      "following_url": "https://api.github.com/users/sglyon/following{/other_user}",
      "gists_url": "https://api.github.com/users/sglyon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sglyon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sglyon/subscriptions",
      "organizations_url": "https://api.github.com/users/sglyon/orgs",
      "repos_url": "https://api.github.com/users/sglyon/repos",
      "events_url": "https://api.github.com/users/sglyon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sglyon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-15T21:38:06Z",
    "updated_at": "2021-12-15T21:38:06Z",
    "author_association": "NONE",
    "body": "Unfortunately this has happened again :(\r\n\r\nI just tried the `integration` steps above, but they also fail.\r\n\r\nBelow is the log for the sync failure:\r\n[erigon_logs.log](https://github.com/ledgerwatch/erigon/files/7722843/erigon_logs.log)\r\n ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/995233439/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/996909970",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2977#issuecomment-996909970",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977",
    "id": 996909970,
    "node_id": "IC_kwDOC0FsAM47a6OS",
    "user": {
      "login": "sglyon",
      "id": 1001948,
      "node_id": "MDQ6VXNlcjEwMDE5NDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1001948?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sglyon",
      "html_url": "https://github.com/sglyon",
      "followers_url": "https://api.github.com/users/sglyon/followers",
      "following_url": "https://api.github.com/users/sglyon/following{/other_user}",
      "gists_url": "https://api.github.com/users/sglyon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sglyon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sglyon/subscriptions",
      "organizations_url": "https://api.github.com/users/sglyon/orgs",
      "repos_url": "https://api.github.com/users/sglyon/repos",
      "events_url": "https://api.github.com/users/sglyon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sglyon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-17T17:52:45Z",
    "updated_at": "2021-12-17T17:52:45Z",
    "author_association": "NONE",
    "body": "the error I get when tryin gto reset the hash_state\r\n\r\n```\r\n./build/bin/integration stage_hash_state --reset --datadir XXX\r\n\r\nINFO[12-17|12:52:04.960] Initialised chain configuration          config=\"{ChainID: 1 Homestead: 1150000 DAO: 1920000 DAOSupport: true EIP150: 2463000 EIP155: 2675000 EIP158: 2675000 Byzantium: 4370000 Constantinople: 7280000 Petersburg: 7280000 Istanbul: 9069000, Muir Glacier: 9200000, Berlin: 12244000, London: 12965000, Arrow Glacier: 13773000, Engine: ethash}\"\r\nintegration: mdbx:23366: mdbx_drop_tree: Assertion `(node_flags(node) & (0x01 | 0x02 | 0x04)) == 0' failed.\r\nSIGABRT: abort\r\nPC=0x7fd9774dbd22 m=21 sigcode=18446744073709551610\r\nsignal arrived during cgo execution\r\n\r\ngoroutine 1 [syscall, locked to thread]:\r\nruntime.cgocall(0xe0eb30, 0xc0007959e0)\r\n        runtime/cgocall.go:156 +0x5c fp=0xc0007959b8 sp=0xc000795980 pc=0x43937c\r\ngithub.com/torquem-ch/mdbx-go/mdbx._Cfunc_mdbx_drop(0x2e2c010, 0x14, 0x0)\r\n        _cgo_gotypes.go:585 +0x4c fp=0xc0007959e0 sp=0xc0007959b8 pc=0x8eae6c\r\ngithub.com/torquem-ch/mdbx-go/mdbx.(*Txn).Drop.func1(0xc0016c04c0, 0x1bd6b00, 0x0)\r\n        github.com/torquem-ch/mdbx-go@v0.22.1/mdbx/txn.go:472 +0x5c fp=0xc000795a20 sp=0xc0007959e0 pc=0x8f4d5c\r\ngithub.com/torquem-ch/mdbx-go/mdbx.(*Txn).Drop(0x1013d20, 0x70c000, 0xc0)\r\n        github.com/torquem-ch/mdbx-go@v0.22.1/mdbx/txn.go:472 +0x1d fp=0xc000795a50 sp=0xc000795a20 pc=0x8f4bdd\r\ngithub.com/ledgerwatch/erigon-lib/kv/mdbx.(*MdbxTx).ClearBucket(0xc00704c3c0, {0x11454c0, 0xc0000f0200})\r\n        github.com/ledgerwatch/erigon-lib@v0.0.0-20211104110507-597d0fbb01ab/kv/mdbx/kv_mdbx.go:700 +0x66 fp=0xc000795a80 sp=0xc000795a50 pc=0x8fb026\r\ngithub.com/ledgerwatch/erigon/eth/stagedsync.ResetHashState({0x1bd6b00, 0xc00704c3c0})\r\n        github.com/ledgerwatch/erigon/eth/stagedsync/stage_interhashes.go:465 +0x37 fp=0xc000795ab8 sp=0xc000795a80 pc=0xdbf617\r\ngithub.com/ledgerwatch/erigon/cmd/integration/commands.stageHashState({0x1bbb060, 0xc000708000}, {0x1bb3df8, 0xc00051e200})\r\n        github.com/ledgerwatch/erigon/cmd/integration/commands/stages.go:682 +0x219 fp=0xc000795cd0 sp=0xc000795ab8 pc=0xdfc879\r\ngithub.com/ledgerwatch/erigon/cmd/integration/commands.glob..func13(0x22d1cc0, {0x113c5db, 0x3, 0x3})\r\n        github.com/ledgerwatch/erigon/cmd/integration/commands/stages.go:136 +0xf1 fp=0xc000795da0 sp=0xc000795cd0 pc=0xe09ef1\r\ngithub.com/spf13/cobra.(*Command).execute(0x22d1cc0, {0xc0005094a0, 0x3, 0x3})\r\n        github.com/spf13/cobra@v1.2.1/command.go:856 +0x60e fp=0xc000795e60 sp=0xc000795da0 pc=0x5d8c0e\r\ngithub.com/spf13/cobra.(*Command).ExecuteC(0x22d4c40)\r\n        github.com/spf13/cobra@v1.2.1/command.go:974 +0x3bc fp=0xc000795f18 sp=0xc000795e60 pc=0x5d92fc\r\ngithub.com/spf13/cobra.(*Command).Execute(...)\r\n        github.com/spf13/cobra@v1.2.1/command.go:902\r\ngithub.com/spf13/cobra.(*Command).ExecuteContext(...)\r\n        github.com/spf13/cobra@v1.2.1/command.go:895\r\nmain.main()\r\n        github.com/ledgerwatch/erigon/cmd/integration/main.go:15 +0x112 fp=0xc000795f80 sp=0xc000795f18 pc=0xe0e1b2\r\nruntime.main()\r\n        runtime/proc.go:255 +0x227 fp=0xc000795fe0 sp=0xc000795f80 pc=0x46df07\r\nruntime.goexit()\r\n        runtime/asm_amd64.s:1581 +0x1 fp=0xc000795fe8 sp=0xc000795fe0 pc=0x49f041\r\n\r\ngoroutine 6 [sleep]:\r\ntime.Sleep(0x22ecb25c00)\r\n        runtime/time.go:193 +0x12e\r\ngithub.com/VictoriaMetrics/metrics.summariesSwapCron(0x45d964b800)\r\n        github.com/VictoriaMetrics/metrics@v1.18.1/summary.go:237 +0x36\r\ncreated by github.com/VictoriaMetrics/metrics.registerSummaryLocked\r\n        github.com/VictoriaMetrics/metrics@v1.18.1/summary.go:211 +0x127\r\n\r\ngoroutine 8 [sync.Cond.Wait]:\r\nsync.runtime_notifyListWait(0xc0002e6048, 0x0)\r\n        runtime/sema.go:513 +0x13d\r\nsync.(*Cond).Wait(0xc000351620)\r\n        sync/cond.go:56 +0x8c\r\ngithub.com/anacrolix/stm.(*Tx).wait(0xc0002e6000)\r\n        github.com/anacrolix/stm@v0.2.1-0.20201002073511-c35a2c748c6a/tx.go:71 +0xb8\r\ngithub.com/anacrolix/stm.Atomically(0xc0675171321b4900)\r\n        github.com/anacrolix/stm@v0.2.1-0.20201002073511-c35a2c748c6a/funcs.go:80 +0x14f\r\ngithub.com/anacrolix/stm/rate.(*Limiter).tokenGenerator(0xc00032a960, 0x2625a00)\r\n        github.com/anacrolix/stm@v0.2.1-0.20201002073511-c35a2c748c6a/rate/ratelimit.go:59 +0x170\r\ncreated by github.com/anacrolix/stm/rate.NewLimiter\r\n        github.com/anacrolix/stm@v0.2.1-0.20201002073511-c35a2c748c6a/rate/ratelimit.go:45 +0x229\r\n\r\ngoroutine 9 [chan receive]:\r\ngithub.com/anacrolix/dht/v2.dnsResolverRefresher()\r\n        github.com/anacrolix/dht/v2@v2.8.0/dht.go:103 +0x70\r\ncreated by github.com/anacrolix/dht/v2.init.0\r\n        github.com/anacrolix/dht/v2@v2.8.0/dht.go:109 +0x25\r\n\r\ngoroutine 10 [select]:\r\ngithub.com/ledgerwatch/erigon/cmd/utils.RootContext.func1()\r\n        github.com/ledgerwatch/erigon/cmd/utils/cmd.go:88 +0x1ae\r\ncreated by github.com/ledgerwatch/erigon/cmd/utils.RootContext\r\n        github.com/ledgerwatch/erigon/cmd/utils/cmd.go:79 +0xa7\r\n\r\ngoroutine 11 [select]:\r\ngithub.com/ledgerwatch/erigon/internal/debug.ListenSignals({0x0, 0x0})\r\n        github.com/ledgerwatch/erigon/internal/debug/signal.go:26 +0x1e5\r\ncreated by github.com/ledgerwatch/erigon/internal/debug.SetupCobra\r\n        github.com/ledgerwatch/erigon/internal/debug/flags.go:173 +0x1ee\r\n\r\ngoroutine 12 [select]:\r\ngithub.com/ledgerwatch/erigon/cmd/utils.RootContext.func1()\r\n        github.com/ledgerwatch/erigon/cmd/utils/cmd.go:88 +0x1ae\r\ncreated by github.com/ledgerwatch/erigon/cmd/utils.RootContext\r\n        github.com/ledgerwatch/erigon/cmd/utils/cmd.go:79 +0xa7\r\n\r\ngoroutine 53 [syscall]:\r\nos/signal.signal_recv()\r\n        runtime/sigqueue.go:169 +0x98\r\nos/signal.loop()\r\n        os/signal/signal_unix.go:24 +0x19\r\ncreated by os/signal.Notify.func1.1\r\n        os/signal/signal.go:151 +0x2c\r\n\r\nrax    0x0\r\nrbx    0x7dd8f3fff640\r\nrcx    0x7fd9774dbd22\r\nrdx    0x0\r\nrdi    0x2\r\nrsi    0x7dd8f3ffe820\r\nrbp    0x7fd9776618f0\r\nrsp    0x7dd8f3ffe820\r\nr8     0x0\r\nr9     0x7dd8f3ffe820\r\nr10    0x8\r\nr11    0x246\r\nr12    0x1bfd32f\r\nr13    0x5b46\r\nr14    0x1c041e8\r\nr15    0x7dd8ec000f00\r\nrip    0x7fd9774dbd22\r\nrflags 0x246\r\ncs     0x33\r\nfs     0x0\r\ngs     0x0\r\n\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/996909970/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/997147964",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2977#issuecomment-997147964",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977",
    "id": 997147964,
    "node_id": "IC_kwDOC0FsAM47b0U8",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-18T05:28:29Z",
    "updated_at": "2021-12-18T05:28:29Z",
    "author_association": "COLLABORATOR",
    "body": "Likely you have hardware problem - disk or ram. Try https://www.memtest86.com/",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/997147964/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/997152847",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2977#issuecomment-997152847",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977",
    "id": 997152847,
    "node_id": "IC_kwDOC0FsAM47b1hP",
    "user": {
      "login": "sglyon",
      "id": 1001948,
      "node_id": "MDQ6VXNlcjEwMDE5NDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1001948?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sglyon",
      "html_url": "https://github.com/sglyon",
      "followers_url": "https://api.github.com/users/sglyon/followers",
      "following_url": "https://api.github.com/users/sglyon/following{/other_user}",
      "gists_url": "https://api.github.com/users/sglyon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sglyon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sglyon/subscriptions",
      "organizations_url": "https://api.github.com/users/sglyon/orgs",
      "repos_url": "https://api.github.com/users/sglyon/repos",
      "events_url": "https://api.github.com/users/sglyon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sglyon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-18T06:15:33Z",
    "updated_at": "2021-12-18T06:15:33Z",
    "author_association": "NONE",
    "body": "Are you thinking faulty hardware, or insufficient hardware? I think I should have \"enough\" hardware -- 8 TB SSD and 32 GB RAM. \r\n\r\nI haven't used memtest86 before. Would it be testing bad ram?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/997152847/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/997155901",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2977#issuecomment-997155901",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977",
    "id": 997155901,
    "node_id": "IC_kwDOC0FsAM47b2Q9",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-18T06:43:31Z",
    "updated_at": "2021-12-18T06:43:31Z",
    "author_association": "COLLABORATOR",
    "body": "Yes, i mean broken hardware",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/997155901/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/997931980",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2977#issuecomment-997931980",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977",
    "id": 997931980,
    "node_id": "IC_kwDOC0FsAM47ezvM",
    "user": {
      "login": "sglyon",
      "id": 1001948,
      "node_id": "MDQ6VXNlcjEwMDE5NDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1001948?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sglyon",
      "html_url": "https://github.com/sglyon",
      "followers_url": "https://api.github.com/users/sglyon/followers",
      "following_url": "https://api.github.com/users/sglyon/following{/other_user}",
      "gists_url": "https://api.github.com/users/sglyon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sglyon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sglyon/subscriptions",
      "organizations_url": "https://api.github.com/users/sglyon/orgs",
      "repos_url": "https://api.github.com/users/sglyon/repos",
      "events_url": "https://api.github.com/users/sglyon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sglyon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-20T13:37:30Z",
    "updated_at": "2021-12-20T13:37:30Z",
    "author_association": "NONE",
    "body": "Unfortunately (haha kinda) I didn't find any hardware issues...\r\n\r\nAny other ideas for how to recover the db?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/997931980/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/998407963",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2977#issuecomment-998407963",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977",
    "id": 998407963,
    "node_id": "IC_kwDOC0FsAM47gn8b",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-21T02:04:10Z",
    "updated_at": "2021-12-21T02:04:42Z",
    "author_association": "COLLABORATOR",
    "body": "```\r\nmake db-tools\r\n\r\nbuild/bin/mdbx_stat -ef <your_datadir>/chaindata\r\n\r\nbuild/bin/mdbx_chk -vvvv <your_datadir>/chaindata\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/998407963/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/998418845",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2977#issuecomment-998418845",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977",
    "id": 998418845,
    "node_id": "IC_kwDOC0FsAM47gqmd",
    "user": {
      "login": "sglyon",
      "id": 1001948,
      "node_id": "MDQ6VXNlcjEwMDE5NDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1001948?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sglyon",
      "html_url": "https://github.com/sglyon",
      "followers_url": "https://api.github.com/users/sglyon/followers",
      "following_url": "https://api.github.com/users/sglyon/following{/other_user}",
      "gists_url": "https://api.github.com/users/sglyon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sglyon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sglyon/subscriptions",
      "organizations_url": "https://api.github.com/users/sglyon/orgs",
      "repos_url": "https://api.github.com/users/sglyon/repos",
      "events_url": "https://api.github.com/users/sglyon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sglyon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-21T02:30:55Z",
    "updated_at": "2021-12-21T02:30:55Z",
    "author_association": "NONE",
    "body": "Thanks for continued support. \r\n\r\n\r\nI ran both of these commands. \r\n\r\nThe first one (stat) gave the following output:\r\n\r\n```\r\nmdbx_stat v0.11.1-26-ge93d53e (2021-11-21T02:38:14+03:00, T-c00e8455b6b4cd30522cf1a7a08d87625d7f8561)\r\nRunning for /mnt/samsung8tb/ethereum/erigon/chaindata...\r\nEnvironment Info\r\n  Pagesize: 4096\r\n  Dynamic datafile: 12288..2199023255552 bytes (+2147483648/-4294967296), 3..536870912 pages (+524288/-1048576)\r\n  Current mapsize: 2199023255552 bytes, 536870912 pages \r\n  Current datafile: 1812476198912 bytes, 442499072 pages\r\n  Last transaction ID: 613801\r\n  Latter reader transaction ID: 613801 (0)\r\n  Max readers: 118\r\n  Number of reader slots uses: 1\r\nGarbage Collection\r\n  Pagesize: 4096\r\n  Tree depth: 2\r\n  Branch pages: 1\r\n  Leaf pages: 18\r\n  Overflow pages: 9088\r\n  Entries: 711\r\nPage Usage\r\n  Total: 536870912 100%\r\n  Backed: 442499072 82.4%\r\n  Allocated: 442484536 82.4%\r\n  Remained: 94386376 17.6%\r\n  Used: 433227365 80.7%\r\n  GC: 9257171 1.7%\r\n  Retained: 228209 0.0%\r\n  Reclaimable: 9028962 1.7%\r\n  Available: 103415338 19.3%\r\nStatus of Main DB\r\n  Pagesize: 4096\r\n  Tree depth: 1\r\n  Branch pages: 0\r\n  Leaf pages: 1\r\n  Overflow pages: 0\r\n  Entries: 51\r\n```\r\n\r\nI let the other command run for 10 minutes, the output ended up being over 400 MB before I stopped it",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/998418845/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/998424792",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2977#issuecomment-998424792",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977",
    "id": 998424792,
    "node_id": "IC_kwDOC0FsAM47gsDY",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-21T02:48:06Z",
    "updated_at": "2021-12-21T02:49:02Z",
    "author_association": "COLLABORATOR",
    "body": "Stat looks ok. \r\nreduce amount of -vvvv to reduce output size. Let’s start from single -v",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/998424792/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1001539725",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2977#issuecomment-1001539725",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2977",
    "id": 1001539725,
    "node_id": "IC_kwDOC0FsAM47skiN",
    "user": {
      "login": "sglyon",
      "id": 1001948,
      "node_id": "MDQ6VXNlcjEwMDE5NDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1001948?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sglyon",
      "html_url": "https://github.com/sglyon",
      "followers_url": "https://api.github.com/users/sglyon/followers",
      "following_url": "https://api.github.com/users/sglyon/following{/other_user}",
      "gists_url": "https://api.github.com/users/sglyon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sglyon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sglyon/subscriptions",
      "organizations_url": "https://api.github.com/users/sglyon/orgs",
      "repos_url": "https://api.github.com/users/sglyon/repos",
      "events_url": "https://api.github.com/users/sglyon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sglyon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-27T12:11:30Z",
    "updated_at": "2021-12-27T12:11:30Z",
    "author_association": "NONE",
    "body": "Took a little while to run, but appears to have found some issues:\r\n\r\n```\r\nmdbx_chk v0.11.1-26-ge93d53e (2021-11-21T02:38:14+03:00, T-c00e8455b6b4cd30522cf1a7a08d87625d7f8561)\r\nRunning for /mnt/samsung8tb/ethereum/erigon/chaindata in 'read-only' mode...\r\n - monopolistic mode\r\n - current boot-id 9ebf8d5de3353b7a-11d41b3a087344ae\r\n - pagesize 4096 (4096 system), max keysize 1980..2022, max readers 118\r\n - mapsize 2199023255552 (2.00 Tb)\r\n - dynamic datafile: 12288 (12.00 Kb) .. 2199023255552 (2.00 Tb), +2147483648 (2.00 Gb), -4294967296 (4.00 Gb)\r\n - current datafile: 1812476198912 (1.65 Tb), 442499072 pages\r\n - meta-0: steady txn#613801, head\r\n - meta-1: steady txn#613799, tail\r\n - meta-2: steady txn#613800, stay\r\n - transactions: recent 613801, latter reader 613801, lag 0\r\nTraversal b-tree by txn#613801...\r\n - found 'AccountChangeSet' area\r\n - found 'AccountHistory' area\r\n - found 'BlockBody' area\r\n - found 'BlockTransaction' area\r\n - found 'BlockTransactionLookup' area\r\n - found 'CallFromIndex' area\r\n - found 'CallToIndex' area\r\n - found 'CallTraceSet' area\r\n - found 'CanonicalHeader' area\r\n - found 'Code' area\r\n - found 'Config' area\r\n - found 'DbInfo' area\r\n - found 'HashedAccount' area\r\n ! corrupted branch-page #325501653, mod-txnid 595722\r\n ! node[75] key (10491) beyond page-end\r\n - found 'HashedCodeHash' area\r\n - found 'HashedStorage' area\r\n - found 'Header' area\r\n - found 'HeaderNumber' area\r\n - found 'HeadersTotalDifficulty' area\r\n - found 'IncarnationMap' area\r\n - found 'LastBlock' area\r\n - found 'LastHeader' area\r\n - found 'LogAddressIndex' area\r\n - found 'LogTopicIndex' area\r\n - found 'Migration' area\r\n - found 'PlainCodeHash' area\r\n - found 'PlainState' area\r\n - found 'Receipt' area\r\n - found 'Sequence' area\r\n - found 'StorageChangeSet' area\r\n - found 'StorageHistory' area\r\n - found 'SyncStage' area\r\n - found 'TransactionLog' area\r\n - found 'TxSender' area\r\n - problems: invalid/corrupted (1)\r\n - pages: walked 433227281, left/unused 9257255\r\n - summary: average fill 77.4%, 1 problems\r\nSkip processing @MAIN since tree is corrupted (1 problems)\r\nProcessing '@GC'...\r\n - key-value kind: ordinal-key => single-value\r\n - last modification txn#613801\r\n - fixed key-size 8\r\n - summary: 711 records, 0 dups, 5688 key's bytes, 37031528 data's bytes, 0 problems\r\n - space: 536870912 total pages, backed 442499072 (82.4%), allocated 442484536 (82.4%), available 103415338 (19.3%)\r\nTotal 3 errors are detected, elapsed 60060.701 seconds.\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1001539725/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
