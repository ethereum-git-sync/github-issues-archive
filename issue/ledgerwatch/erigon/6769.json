{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6769",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6769/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6769/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6769/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/6769",
  "id": 1568371783,
  "node_id": "I_kwDOC0FsAM5de3RH",
  "number": 6769,
  "title": "skip to another stage loop without downloading all the bodies",
  "user": {
    "login": "justforfunya",
    "id": 7145447,
    "node_id": "MDQ6VXNlcjcxNDU0NDc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7145447?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/justforfunya",
    "html_url": "https://github.com/justforfunya",
    "followers_url": "https://api.github.com/users/justforfunya/followers",
    "following_url": "https://api.github.com/users/justforfunya/following{/other_user}",
    "gists_url": "https://api.github.com/users/justforfunya/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/justforfunya/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/justforfunya/subscriptions",
    "organizations_url": "https://api.github.com/users/justforfunya/orgs",
    "repos_url": "https://api.github.com/users/justforfunya/repos",
    "events_url": "https://api.github.com/users/justforfunya/events{/privacy}",
    "received_events_url": "https://api.github.com/users/justforfunya/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4566396003,
      "node_id": "LA_kwDOC0FsAM8AAAABEC2sYw",
      "url": "https://api.github.com/repos/ledgerwatch/erigon/labels/Stale",
      "name": "Stale",
      "color": "ededed",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-02-02T16:35:15Z",
  "updated_at": "2023-03-23T02:21:49Z",
  "closed_at": "2023-03-23T02:21:49Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: `./erigon --version`\r\nerigon version 2.37.0-stable\r\nOS & Version: Windows/Linux/OSX\r\nubuntu 20.04\r\nCommit hash: \r\n\r\nErigon Command (with flags/config):\r\nhttps://github.com/ledgerwatch/erigon/commit/12419c759162fdba03e645d0cb8d21e582e067a5\r\nConcensus Layer:\r\n\r\nConcensus Layer Command (with flags/config):\r\n\r\nChain/Network: \r\neth\r\n#### Expected behaviour\r\nIn most cases I can't get the latest block txs，but can get the latest block number.\r\nThe block number increases but the block content does not exist。The headers and bodies are not synced thus will trigger error when  calling a  contract 。\r\nI think all block information should be ready for the lastest block (get from rpc )\r\n\r\n#### Actual behaviour\r\nget the latest block number :16542249 ,then get the block txs by \"cast block 16542249 \" trigger the error \"block Number(Number(16542249)) not found\"\r\n\r\nbash:\r\nadm@ubuntu:~/tools/x# cast block-number  --rpc-url http://192.168.0.108:8545\r\n16542249\r\nadm@ubuntu:~/tools/x# cast block 16542249  --rpc-url http://192.168.0.108:8545\r\nError: \r\nblock Number(Number(16542249)) not found\r\n\r\nBelow is the erigon console output\r\n\r\n[INFO] [02-03|00:15:56.097] PoS headers verified and saved           requestId=177 fork head=0xf0b515e4c6563897a5cc6c401630b550a7605ade368ac61af47bbbe6949e1c49\r\n[INFO] [02-03|00:15:57.745] [2/15 Headers] Waiting for Consensus Layer...\r\n[INFO] [02-03|00:15:57.745] [2/15 Headers] Handling new payload      height=16542168 hash=0xcb1c20c07944e6912363a959368883985f753039add801023be5b401b70b41e2\r\n[INFO] [02-03|00:15:59.104] [2/15 Headers] Waiting for Consensus Layer...\r\n[INFO] [02-03|00:16:02.382] [2/15 Headers] Handling new payload      height=16542245 hash=0xfce3a52e97d337f7dc406bb388db2f0b4ca68113ddc412aa127597f0a776df17\r\n[INFO] [02-03|00:16:02.478] [2/15 Headers] Downloading PoS headers... height=16542244 hash=0x0cd052fae47110376b653ff4ad62d58c2c90494c9b881b2b4af56f419ec75062 requestId=178\r\n[INFO] [02-03|00:16:07.329] PoS headers verified and saved           requestId=178 fork head=0x0f534bac9cf39149c3959dc8952d3d6feddb4f9757517d9e0269bc4482c782f5\r\n[INFO] [02-03|00:16:08.025] Commit cycle                             in=696.044576ms\r\n[INFO] [02-03|00:16:10.577] [2/15 Headers] Waiting for Consensus Layer...\r\n[INFO] [02-03|00:16:10.577] [2/15 Headers] Handling new payload      height=16542245 hash=0xfce3a52e97d337f7dc406bb388db2f0b4ca68113ddc412aa127597f0a776df17\r\n[INFO] [02-03|00:16:12.579] [2/15 Headers] Waiting for Consensus Layer...\r\n[INFO] [02-03|00:16:12.864] [2/15 Headers] Handling new payload      height=16542246 hash=0x8cf312bd108cd6f6ac91b31108551666de4dd7ce6ee1f70a6a133670da8f6ffc\r\n[INFO] [02-03|00:16:15.656] [2/15 Headers] Waiting for Consensus Layer...\r\n[INFO] [02-03|00:16:20.269] [LightClient] P2P                        peers=33\r\n[INFO] [02-03|00:16:20.682] [txpool] stat                            block=16542123 pending=9512 baseFee=30000 queued=27929 alloc=4.0GB sys=8.7GB\r\n[INFO] [02-03|00:16:27.322] [2/15 Headers] Handling new payload      height=16542247 hash=0xac39f8623a0a402b6507ec0d06a125d9b97dad648082b86e80bac96302451af6\r\n[INFO] [02-03|00:16:29.821] [2/15 Headers] Waiting for Consensus Layer...\r\n[INFO] [02-03|00:16:37.811] [2/15 Headers] Handling new payload      height=16542248 hash=0x9bdb464e73c029212135918cbca5f2ac51a63eea0450bbec8fd84468e9286519\r\n[INFO] [02-03|00:16:38.915] [2/15 Headers] Waiting for Consensus Layer...\r\n[INFO] [02-03|00:16:50.105] [2/15 Headers] Handling new payload      height=16542249 hash=0x0fec07740c3dcc90113fad5368fb5034bce677751e38dc4853c3f00c3d67809d\r\n[INFO] [02-03|00:16:50.122] [2/15 Headers] Waiting for Consensus Layer...\r\n[INFO] [02-03|00:16:50.607] [2/15 Headers] Fork choice: chain extension from=16542123 to=16542249\r\n[INFO] [02-03|00:16:50.629] [5/15 Bodies] Processing bodies...       from=16542123 to=16542249\r\n[INFO] [02-03|00:17:10.630] [5/15 Bodies] Downloading block bodies   block_num=16542124 delivery/sec=5.2KB wasted/sec=0B remaining=124 delivered=1 cache=50.9MB alloc=2.8GB sys=8.7GB\r\n[INFO] [02-03|00:17:25.336] [txpool] stat                            block=16542123 pending=10000 baseFee=30000 queued=28211 alloc=3.0GB sys=8.7GB\r\n[INFO] [02-03|00:17:30.629] [5/15 Bodies] No block bodies to write in this log period block number=16542124\r\n[INFO] [02-03|00:17:34.706] [p2p] GoodPeers                          eth66=93 eth67=103\r\n[INFO] [02-03|00:17:50.630] [5/15 Bodies] No block bodies to write in this log period block number=16542124\r\n[INFO] [02-03|00:18:10.629] [5/15 Bodies] No block bodies to write in this log period block number=16542124\r\n[INFO] [02-03|00:18:20.288] [txpool] stat                            block=16542123 pending=10000 baseFee=30000 queued=28654 alloc=3.9GB sys=8.7GB\r\n[INFO] [02-03|00:18:30.629] [5/15 Bodies] No block bodies to write in this log period block number=16542124\r\n[INFO] [02-03|00:18:50.630] [5/15 Bodies] No block bodies to write in this log period block number=16542124\r\n[INFO] [02-03|00:18:50.630] [5/15 Bodies] DONE                       in=2m0.001045224s\r\n[INFO] [02-03|00:18:53.593] [7/15 Execution] Completed on            block=16542124\r\n[INFO] [02-03|00:19:14.481] Commit cycle                             in=11.013917199s\r\n[INFO] [02-03|00:19:14.481] Timings (slower than 50ms)               Headers=485ms Bodies=2m0.001s Execution=2.948s HashState=3.411s IntermediateHashes=2.748s CallTraces=934ms AccountHistoryIndex=417ms St\r\norageHistoryIndex=944ms LogIndex=866ms TxLookup=550ms\r\n[INFO] [02-03|00:19:14.481] Tables                                   PlainState=85.0GB AccountChangeSet=170.6GB StorageChangeSet=267.3GB BlockTransaction=8.0GB TransactionLog=512.2GB FreeList=164.2MB Recl\r\naimableSpace=164.2GB\r\n[INFO] [02-03|00:19:14.482] RPC Daemon notified of new headers       from=16542123 to=16542249 hash=0x0fec07740c3dcc90113fad5368fb5034bce677751e38dc4853c3f00c3d67809d header sending=201.825µs log sending=\r\n250ns\r\n[INFO] [02-03|00:19:14.739] [2/15 Headers] Waiting for Consensus Layer...\r\n[INFO] [02-03|00:19:14.773] [LightClient] P2P                        peers=26\r\n[INFO] [02-03|00:19:20.268] [LightClient] P2P                        peers=26\r\n[INFO] [02-03|00:19:20.273] [txpool] stat                            block=16542124 pending=9982 baseFee=30000 queued=28937 alloc=3.0GB sys=8.7GB\r\n[INFO] [02-03|00:19:25.079] [2/15 Headers] Handling new payload      height=16542262 hash=0x499bffddd15c8aaf24cab4b0acc94ded833a19da59c3a2608a4b9fbe1e25531f\r\n[INFO] [02-03|00:19:25.112] [2/15 Headers] Downloading PoS headers... height=16542261 hash=0xd97a082281e61dc02354dbada1d15d1f97b572809b8211acc5d7d94e8f31435d requestId=184\r\n[INFO] [02-03|00:19:25.218] [5/15 Bodies] Processing bodies...       from=16542124 to=16542249\r\n[INFO] [02-03|00:19:34.706] [p2p] GoodPeers                          eth66=90 eth67=103\r\n[INFO] [02-03|00:19:45.218] [5/15 Bodies] No block bodies to write in this log period block number=16542124\r\n[INFO] [02-03|00:20:05.218] [5/15 Bodies] Downloading block bodies   block_num=16542125 delivery/sec=4.2KB wasted/sec=0B remaining=123 delivered=1 cache=51.3MB alloc=3.8GB sys=8.7GB\r\n\r\n\r\n#### Steps to reproduce the behaviour\r\nJust run erigon\r\n\r\n#### Backtrace\r\n\r\n````\r\n[backtrace]\r\n````\r\n",
  "closed_by": {
    "login": "github-actions[bot]",
    "id": 41898282,
    "node_id": "MDM6Qm90NDE4OTgyODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/github-actions%5Bbot%5D",
    "html_url": "https://github.com/apps/github-actions",
    "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6769/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6769/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1469203536",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/6769#issuecomment-1469203536",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6769",
    "id": 1469203536,
    "node_id": "IC_kwDOC0FsAM5XkkRQ",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-03-15T02:28:50Z",
    "updated_at": "2023-03-15T02:28:50Z",
    "author_association": "NONE",
    "body": "This issue is stale because it has been open for 40 days with no activity. Remove stale label or comment, or this will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1469203536/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1480490032",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/6769#issuecomment-1480490032",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6769",
    "id": 1480490032,
    "node_id": "IC_kwDOC0FsAM5YPnww",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-03-23T02:21:48Z",
    "updated_at": "2023-03-23T02:21:48Z",
    "author_association": "NONE",
    "body": "This issue was closed because it has been stalled for 7 days with no activity.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1480490032/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
