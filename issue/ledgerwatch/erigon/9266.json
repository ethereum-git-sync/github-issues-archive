{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/9266",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/9266/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/9266/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/9266/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/9266",
  "id": 2088470288,
  "node_id": "I_kwDOC0FsAM58e4cQ",
  "number": 9266,
  "title": "trace data errors on ETH Holesky when upgrading from erigon version \"2.55.1-12889fd0\" to erigon version \"2.56.2-c9216ce1\"",
  "user": {
    "login": "quick-pawiromitchel",
    "id": 103942361,
    "node_id": "U_kgDOBjII2Q",
    "avatar_url": "https://avatars.githubusercontent.com/u/103942361?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/quick-pawiromitchel",
    "html_url": "https://github.com/quick-pawiromitchel",
    "followers_url": "https://api.github.com/users/quick-pawiromitchel/followers",
    "following_url": "https://api.github.com/users/quick-pawiromitchel/following{/other_user}",
    "gists_url": "https://api.github.com/users/quick-pawiromitchel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/quick-pawiromitchel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/quick-pawiromitchel/subscriptions",
    "organizations_url": "https://api.github.com/users/quick-pawiromitchel/orgs",
    "repos_url": "https://api.github.com/users/quick-pawiromitchel/repos",
    "events_url": "https://api.github.com/users/quick-pawiromitchel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/quick-pawiromitchel/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2024-01-18T14:58:58Z",
  "updated_at": "2024-01-19T17:30:49Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: `2.56.2-c9216ce1`\r\n\r\nOS & Version: Linux\r\n\r\nChain/Network: ETH Holesky\r\n\r\n#### Expected behaviour\r\nTrace data getting returned succesfully\r\n\r\n#### Actual behaviour\r\n`invalid arguments; block with number 60000 not found`\r\n\r\n#### Steps to reproduce the behaviour\r\n```\r\n{\r\n  \"method\": \"debug_traceBlockByNumber\",\r\n  \"params\": [\r\n    \"0xea60\",\r\n    {\r\n      \"tracer\": \"callTracer\"\r\n    }\r\n  ],\r\n  \"id\": 1,\r\n  \"jsonrpc\": \"2.0\"\r\n}\r\n```\r\nOlder blocks returned that error, blocks at the tip were fine.\r\n\r\nDowngrading the node to `2.55.1-12889fd0` fixed the issue\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/9266/reactions",
    "total_count": 1,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 1,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/9266/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1900441548",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/9266#issuecomment-1900441548",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/9266",
    "id": 1900441548,
    "node_id": "IC_kwDOC0FsAM5xRm_M",
    "user": {
      "login": "yperbasis",
      "id": 34320705,
      "node_id": "MDQ6VXNlcjM0MzIwNzA1",
      "avatar_url": "https://avatars.githubusercontent.com/u/34320705?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yperbasis",
      "html_url": "https://github.com/yperbasis",
      "followers_url": "https://api.github.com/users/yperbasis/followers",
      "following_url": "https://api.github.com/users/yperbasis/following{/other_user}",
      "gists_url": "https://api.github.com/users/yperbasis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yperbasis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yperbasis/subscriptions",
      "organizations_url": "https://api.github.com/users/yperbasis/orgs",
      "repos_url": "https://api.github.com/users/yperbasis/repos",
      "events_url": "https://api.github.com/users/yperbasis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yperbasis/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2024-01-19T13:36:55Z",
    "updated_at": "2024-01-19T13:36:55Z",
    "author_association": "COLLABORATOR",
    "body": "Could you check [v2.57.0](https://github.com/ledgerwatch/erigon/releases/tag/v2.57.0) please?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1900441548/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1900763741",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/9266#issuecomment-1900763741",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/9266",
    "id": 1900763741,
    "node_id": "IC_kwDOC0FsAM5xS1pd",
    "user": {
      "login": "quickchase",
      "id": 87909910,
      "node_id": "MDQ6VXNlcjg3OTA5OTEw",
      "avatar_url": "https://avatars.githubusercontent.com/u/87909910?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/quickchase",
      "html_url": "https://github.com/quickchase",
      "followers_url": "https://api.github.com/users/quickchase/followers",
      "following_url": "https://api.github.com/users/quickchase/following{/other_user}",
      "gists_url": "https://api.github.com/users/quickchase/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/quickchase/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/quickchase/subscriptions",
      "organizations_url": "https://api.github.com/users/quickchase/orgs",
      "repos_url": "https://api.github.com/users/quickchase/repos",
      "events_url": "https://api.github.com/users/quickchase/events{/privacy}",
      "received_events_url": "https://api.github.com/users/quickchase/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2024-01-19T16:56:30Z",
    "updated_at": "2024-01-19T16:58:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "I upgraded a node, I don't know if these logs are related to this issue but they don't look great.\r\n\r\n```text\r\nerigon[18443]: [WARN] [01-19|16:50:41.434] [1/12 Snapshots] Some blocks are not in snapshots and not in db max_in_snapshots=499999 min_in_db=679000\r\nerigon[18443]: [INFO] [01-19|16:50:41.435] [snapshots:download] Blocks Stat         blocks=0k indices=0k alloc=69.3MB sys=100.4MB\r\nerigon[18443]: [INFO] [01-19|16:50:41.435] [snapshots:missed-idx] Blocks Stat       blocks=0k indices=0k alloc=69.3MB sys=100.4MB\r\nerigon[18443]: [INFO] [01-19|16:50:41.437] [snapshots:missed-idx:reopen] Blocks Stat blocks=0k indices=0k alloc=69.8MB sys=100.4MB\r\nerigon[18443]: [INFO] [01-19|16:50:41.440] [snapshots] Prune Blocks                 to=1 limit=100\r\nerigon[18443]: [WARN] [01-19|16:50:41.440] [snapshots] retire blocks                err=\"DumpBlocks: DumpHeaders: header missed in db: block_num=1,  hash=e9011e6d15a0d0c16f65a38f84375bf1a6b88201b0ad75a2660df0bb8d1ac381\"\r\nerigon[18443]: [EROR] [01-19|16:50:48.863] RPC method engine_getPayloadBodiesByRangeV1 crashed: runtime error: invalid memory address or nil pointer dereference\r\nerigon[18443]: [service.go:219 panic.go:914 panic.go:261 signal_unix.go:861 getters.go:180 execution_client.go:45 chain_reader.go:204 engine_server.go:545 engine_server.go:668 value.go:596 value.go:380 service.go:224 handler.go:532 handler.go:482 handler.go:421 handler.go:241 handler.go:334 asm_amd64.s:1650]\r\nerigon[18443]: [WARN] [01-19|16:50:48.863] [rpc] served                             conn=127.0.0.1:47932 method=engine_getPayloadBodiesByRangeV1 reqid=1 t=429.743µs err=\"method handler crashed\"\r\nerigon[18443]: [EROR] [01-19|16:50:48.887] RPC method engine_getPayloadBodiesByRangeV1 crashed: runtime error: invalid memory address or nil pointer dereference\r\nerigon[18443]: [service.go:219 panic.go:914 panic.go:261 signal_unix.go:861 getters.go:180 execution_client.go:45 chain_reader.go:204 engine_server.go:545 engine_server.go:668 value.go:596 value.go:380 service.go:224 handler.go:532 handler.go:482 handler.go:421 handler.go:241 handler.go:334 asm_amd64.s:1650]\r\nerigon[18443]: [WARN] [01-19|16:50:48.887] [rpc] served                             conn=127.0.0.1:47932 method=engine_getPayloadBodiesByRangeV1 reqid=1 t=243.009µs err=\"method handler crashed\"\r\nerigon[18443]: [EROR] [01-19|16:50:51.079] RPC method engine_getPayloadBodiesByRangeV1 crashed: runtime error: invalid memory address or nil pointer dereference\r\nerigon[18443]: [service.go:219 panic.go:914 panic.go:261 signal_unix.go:861 getters.go:180 execution_client.go:45 chain_reader.go:204 engine_server.go:545 engine_server.go:668 value.go:596 value.go:380 service.go:224 handler.go:532 handler.go:482 handler.go:421 handler.go:241 handler.go:334 asm_amd64.s:1650]\r\nerigon[18443]: [WARN] [01-19|16:50:51.079] [rpc] served                             conn=127.0.0.1:47932 method=engine_getPayloadBodiesByRangeV1 reqid=1 t=289.348µs err=\"method handler crashed\"\r\nerigon[18443]: [EROR] [01-19|16:50:51.101] RPC method engine_getPayloadBodiesByRangeV1 crashed: runtime error: invalid memory address or nil pointer dereference\r\nerigon[18443]: [service.go:219 panic.go:914 panic.go:261 signal_unix.go:861 getters.go:180 execution_client.go:45 chain_reader.go:204 engine_server.go:545 engine_server.go:668 value.go:596 value.go:380 service.go:224 handler.go:532 handler.go:482 handler.go:421 handler.go:241 handler.go:334 asm_amd64.s:1650]\r\nerigon[18443]: [WARN] [01-19|16:50:51.102] [rpc] served                             conn=127.0.0.1:47932 method=engine_getPayloadBodiesByRangeV1 reqid=1 t=254.09µs err=\"method handler crashed\"\r\nerigon[18443]: [INFO] [01-19|16:50:53.665] [NewPayload] Handling new payload        height=769455 hash=0x94c51faca97aea650f603a07eaf9b9ec32653bcd4737ad9f361a02fb53f8a65e\r\nerigon[18443]: [INFO] [01-19|16:50:54.223] [NewPayload] Handling new payload        height=769456 hash=0xf87ab1222eaf366312c40928185c1aa4b4c6d22a985eed0a3b28d04ebde03793\r\nerigon[18443]: [INFO] [01-19|16:50:54.408] [NewPayload] Handling new payload        height=769457 hash=0x7a61bb81d22ceb754cf4056b00591a8a92a3723cf69baf505c42714d778d2135\r\nerigon[18443]: [INFO] [01-19|16:50:55.638] [NewPayload] Handling new payload        height=769458 hash=0x20a9a54346469a472071f5559eaf0722d7af70076cd76feeff9cc62e7765f423\r\nerigon[18443]: [INFO] [01-19|16:50:57.494] [NewPayload] Handling new payload        height=769459 hash=0x501e536fc519de004050c4d20a9f6b049699e8ef6226b028f1f657f2be01e1a4\r\nerigon[18443]: [INFO] [01-19|16:50:58.277] [NewPayload] Handling new payload        height=769459 hash=0x2566d3bc18c986cea2d00b2ff44be08cbaeb61c84c7b162226b8137ee31d3dae\r\nerigon[18443]: [INFO] [01-19|16:50:59.019] [NewPayload] Handling new payload        height=769462 hash=0x72c6ef3ca1204916f5693c98d03fa5b66a7b739fecd0afdee7f9766017afd2de\r\nerigon[18443]: [INFO] [01-19|16:50:59.019] [EngineBlockDownloader] Downloading PoS headers... hash=0x6680aef21e4d1077d200301871214b4e1701869f2a26614fe6606358a10eaa89 requestId=0\r\nerigon[18443]: [INFO] [01-19|16:50:59.318] [EngineBlockDownloader] Processed        highest=769461\r\nerigon[18443]: [INFO] [01-19|16:50:59.318] Beginning downloaded blocks insertion\r\nerigon[18443]: [INFO] [01-19|16:50:59.326] [EngineBlockDownloader] Finished downloading blocks from=769459 to=769461\r\nerigon[18443]: [INFO] [01-19|16:51:00.031] [EngineBlockDownloader] blocks verification successful\r\nerigon[18443]: [INFO] [01-19|16:51:00.925] [4/12 Execution] Completed on            block=769462\r\nerigon[18443]: [INFO] [01-19|16:51:01.048] RPC Daemon notified of new headers       from=769454 to=769462 hash=0x72c6ef3ca1204916f5693c98d03fa5b66a7b739fecd0afdee7f9766017afd2de header sending=37.591µs log sending=270ns\r\nerigon[18443]: [INFO] [01-19|16:51:01.048] head updated                             hash=0x72c6ef3ca1204916f5693c98d03fa5b66a7b739fecd0afdee7f9766017afd2de number=769462\r\nerigon[18443]: [INFO] [01-19|16:51:01.048] [snapshots] Prune Blocks                 to=1 limit=100\r\nerigon[18443]: [WARN] [01-19|16:51:01.049] [snapshots] retire blocks                err=\"DumpBlocks: DumpHeaders: header missed in db: block_num=1,  hash=e9011e6d15a0d0c16f65a38f84375bf1a6b88201b0ad75a2660df0bb8d1ac381\"\r\nerigon[18443]: [INFO] [01-19|16:51:01.596] [NewPayload] Handling new payload        height=769463 hash=0xc7cce22292254445c7e9bf1ddc22d2a14df2a52b7d03e5c050e78adb346c5e7d\r\nerigon[18443]: [INFO] [01-19|16:51:02.066] [updateForkchoice] Fork choice update: flushing in-memory state (built by previous newPayload)\r\nerigon[18443]: [INFO] [01-19|16:51:02.078] RPC Daemon notified of new headers       from=769462 to=769463 hash=0xc7cce22292254445c7e9bf1ddc22d2a14df2a52b7d03e5c050e78adb346c5e7d header sending=24.467µs log sending=269ns\r\nerigon[18443]: [INFO] [01-19|16:51:02.079] head updated                             hash=0xc7cce22292254445c7e9bf1ddc22d2a14df2a52b7d03e5c050e78adb346c5e7d number=769463\r\nerigon[18443]: [INFO] [01-19|16:51:02.079] [snapshots] Prune Blocks                 to=1 limit=100\r\nerigon[18443]: [WARN] [01-19|16:51:02.079] [snapshots] retire blocks                err=\"DumpBlocks: DumpHeaders: header missed in db: block_num=1,  hash=e9011e6d15a0d0c16f65a38f84375bf1a6b88201b0ad75a2660df0bb8d1ac381\"\r\n```\r\n\r\nHowever, as soon as I upgraded, the cURL failed:\r\n\r\n```bash\r\ncurl -s -H 'Content-Type: application/json' localhost:8545 -d \"$DATA\"\r\n{\"jsonrpc\":\"2.0\",\"id\":1,\"result\":null,\"error\":{\"code\":-32000,\"message\":\"invalid arguments; block with number 60000 not found\"}}\r\n```\r\n\r\nI downgraded back to 2.55.1 and everything looks fine again, no errors, cURL works fine..\r\n\r\nThis is a huge problem as upgrades are mandatory.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1900763741/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1900812685",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/9266#issuecomment-1900812685",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/9266",
    "id": 1900812685,
    "node_id": "IC_kwDOC0FsAM5xTBmN",
    "user": {
      "login": "quickchase",
      "id": 87909910,
      "node_id": "MDQ6VXNlcjg3OTA5OTEw",
      "avatar_url": "https://avatars.githubusercontent.com/u/87909910?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/quickchase",
      "html_url": "https://github.com/quickchase",
      "followers_url": "https://api.github.com/users/quickchase/followers",
      "following_url": "https://api.github.com/users/quickchase/following{/other_user}",
      "gists_url": "https://api.github.com/users/quickchase/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/quickchase/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/quickchase/subscriptions",
      "organizations_url": "https://api.github.com/users/quickchase/orgs",
      "repos_url": "https://api.github.com/users/quickchase/repos",
      "events_url": "https://api.github.com/users/quickchase/events{/privacy}",
      "received_events_url": "https://api.github.com/users/quickchase/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2024-01-19T17:30:48Z",
    "updated_at": "2024-01-19T17:30:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "Since I can't find any indication that this is affecting either Goerli or Sepolia, I'm going to try to resync Holesky from Genesis on the latest version. Maybe my nodes are just screwed up...",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1900812685/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
