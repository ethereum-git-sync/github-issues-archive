{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/1134",
  "id": 707469566,
  "node_id": "MDU6SXNzdWU3MDc0Njk1NjY=",
  "number": 1134,
  "title": "Lmdb size on Windows",
  "user": {
    "login": "AndreaLanfranchi",
    "id": 15280851,
    "node_id": "MDQ6VXNlcjE1MjgwODUx",
    "avatar_url": "https://avatars.githubusercontent.com/u/15280851?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AndreaLanfranchi",
    "html_url": "https://github.com/AndreaLanfranchi",
    "followers_url": "https://api.github.com/users/AndreaLanfranchi/followers",
    "following_url": "https://api.github.com/users/AndreaLanfranchi/following{/other_user}",
    "gists_url": "https://api.github.com/users/AndreaLanfranchi/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AndreaLanfranchi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AndreaLanfranchi/subscriptions",
    "organizations_url": "https://api.github.com/users/AndreaLanfranchi/orgs",
    "repos_url": "https://api.github.com/users/AndreaLanfranchi/repos",
    "events_url": "https://api.github.com/users/AndreaLanfranchi/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AndreaLanfranchi/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 14,
  "created_at": "2020-09-23T15:31:40Z",
  "updated_at": "2021-05-22T08:23:00Z",
  "closed_at": "2021-05-22T08:23:00Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nTurbo-Geth version: `2020.09.02-alpha`\r\nOS & Version: Windows\r\nCommit hash : [master@47f59e8fcd](https://github.com/ledgerwatch/turbo-geth/tree/47f59e8fcd805ad2a4f677f7dffb2ae9b0673bbc)\r\n\r\n#### Expected behaviour\r\n\r\nLmdb file should grow as data gets in.\r\n\r\n#### Actual behaviour\r\n\r\nOn Windows lmdb file is immediately allocated the size given by `--lmdb.mapSize` cli argument (which defaults to 2TB).\r\nBy consequence, with default settings, you need at least 4TB free storage space as the databases being allocated are one for chain data and the other for nodes. Needless to say the latter only requires few megabytes.\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\nRun a windows instance.\r\n",
  "closed_by": {
    "login": "AskAlexSharov",
    "id": 46885206,
    "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AskAlexSharov",
    "html_url": "https://github.com/AskAlexSharov",
    "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
    "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
    "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
    "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
    "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/697551960",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1134#issuecomment-697551960",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134",
    "id": 697551960,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NzU1MTk2MA==",
    "user": {
      "login": "AndreaLanfranchi",
      "id": 15280851,
      "node_id": "MDQ6VXNlcjE1MjgwODUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/15280851?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AndreaLanfranchi",
      "html_url": "https://github.com/AndreaLanfranchi",
      "followers_url": "https://api.github.com/users/AndreaLanfranchi/followers",
      "following_url": "https://api.github.com/users/AndreaLanfranchi/following{/other_user}",
      "gists_url": "https://api.github.com/users/AndreaLanfranchi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AndreaLanfranchi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AndreaLanfranchi/subscriptions",
      "organizations_url": "https://api.github.com/users/AndreaLanfranchi/orgs",
      "repos_url": "https://api.github.com/users/AndreaLanfranchi/repos",
      "events_url": "https://api.github.com/users/AndreaLanfranchi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AndreaLanfranchi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-23T15:33:40Z",
    "updated_at": "2020-09-23T15:33:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "Related issue #1115 ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/697551960/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/697628273",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1134#issuecomment-697628273",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134",
    "id": 697628273,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NzYyODI3Mw==",
    "user": {
      "login": "AndreaLanfranchi",
      "id": 15280851,
      "node_id": "MDQ6VXNlcjE1MjgwODUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/15280851?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AndreaLanfranchi",
      "html_url": "https://github.com/AndreaLanfranchi",
      "followers_url": "https://api.github.com/users/AndreaLanfranchi/followers",
      "following_url": "https://api.github.com/users/AndreaLanfranchi/following{/other_user}",
      "gists_url": "https://api.github.com/users/AndreaLanfranchi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AndreaLanfranchi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AndreaLanfranchi/subscriptions",
      "organizations_url": "https://api.github.com/users/AndreaLanfranchi/orgs",
      "repos_url": "https://api.github.com/users/AndreaLanfranchi/repos",
      "events_url": "https://api.github.com/users/AndreaLanfranchi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AndreaLanfranchi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-23T16:18:25Z",
    "updated_at": "2020-09-23T16:18:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "Additional documentation\r\nhttps://docs.microsoft.com/it-it/windows/win32/memory/creating-a-file-mapping-object?redirectedfrom=MSDN\r\n\r\nSeems like the only workaround is to trap MDB_MAP_FULL",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/697628273/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698056919",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1134#issuecomment-698056919",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134",
    "id": 698056919,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5ODA1NjkxOQ==",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-24T01:25:04Z",
    "updated_at": "2020-09-24T01:25:17Z",
    "author_association": "COLLABORATOR",
    "body": "Here is example how can it be handled in go: https://github.com/ledgerwatch/lmdb-go/blob/1f23ded7b4bbf8b8ec2c7168271a5153b89c2379/lmdb/example_test.go#L188\r\n\r\nAlso, we already have waitgroup inside kv_lmdb.go - means we can wait for read transactions finish (but canâ€™t hold new read transactions from start). \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698056919/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698058055",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1134#issuecomment-698058055",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134",
    "id": 698058055,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5ODA1ODA1NQ==",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-24T01:28:38Z",
    "updated_at": "2020-09-24T01:28:38Z",
    "author_association": "COLLABORATOR",
    "body": "Here is how monero handles it in cpp: https://github.com/monero-project/monero/blob/c61b3f0eadd4ad17398356d941684bc7de58ebcf/src/lmdb/database.cpp#L129",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698058055/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698173931",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1134#issuecomment-698173931",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134",
    "id": 698173931,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5ODE3MzkzMQ==",
    "user": {
      "login": "AndreaLanfranchi",
      "id": 15280851,
      "node_id": "MDQ6VXNlcjE1MjgwODUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/15280851?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AndreaLanfranchi",
      "html_url": "https://github.com/AndreaLanfranchi",
      "followers_url": "https://api.github.com/users/AndreaLanfranchi/followers",
      "following_url": "https://api.github.com/users/AndreaLanfranchi/following{/other_user}",
      "gists_url": "https://api.github.com/users/AndreaLanfranchi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AndreaLanfranchi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AndreaLanfranchi/subscriptions",
      "organizations_url": "https://api.github.com/users/AndreaLanfranchi/orgs",
      "repos_url": "https://api.github.com/users/AndreaLanfranchi/repos",
      "events_url": "https://api.github.com/users/AndreaLanfranchi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AndreaLanfranchi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-24T07:39:50Z",
    "updated_at": "2020-09-24T07:40:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "Came up with smth similar\r\nhttps://github.com/torquem-ch/silkworm/blob/stage-senders/silkworm/db/chaindb.cpp#L147-L167\r\nBut is limited to open transaction.\r\nNeed to implement on any put operation",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698173931/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698255862",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1134#issuecomment-698255862",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134",
    "id": 698255862,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5ODI1NTg2Mg==",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-24T10:21:28Z",
    "updated_at": "2020-09-24T10:21:28Z",
    "author_association": "COLLABORATOR",
    "body": "@AndreaLanfranchi , with which value of setMapSize must start process? ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698255862/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698257534",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1134#issuecomment-698257534",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134",
    "id": 698257534,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5ODI1NzUzNA==",
    "user": {
      "login": "AndreaLanfranchi",
      "id": 15280851,
      "node_id": "MDQ6VXNlcjE1MjgwODUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/15280851?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AndreaLanfranchi",
      "html_url": "https://github.com/AndreaLanfranchi",
      "followers_url": "https://api.github.com/users/AndreaLanfranchi/followers",
      "following_url": "https://api.github.com/users/AndreaLanfranchi/following{/other_user}",
      "gists_url": "https://api.github.com/users/AndreaLanfranchi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AndreaLanfranchi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AndreaLanfranchi/subscriptions",
      "organizations_url": "https://api.github.com/users/AndreaLanfranchi/orgs",
      "repos_url": "https://api.github.com/users/AndreaLanfranchi/repos",
      "events_url": "https://api.github.com/users/AndreaLanfranchi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AndreaLanfranchi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-24T10:25:07Z",
    "updated_at": "2020-09-24T10:25:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "I actually use --lmdb.mapSize=\"50 GB\" ... but is subjective.\r\nI only need to test. The value of mapsize is directly related to how much space you have on disk for Windows.\r\nDefault value in TG is 2TB ... which means 4TB files (2TB for chain data and 2TB for nodes).\r\nShould differentiate map size for nodes and for chaindata",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698257534/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698260133",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1134#issuecomment-698260133",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134",
    "id": 698260133,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5ODI2MDEzMw==",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-24T10:30:35Z",
    "updated_at": "2020-09-24T10:30:35Z",
    "author_association": "COLLABORATOR",
    "body": "I mean - what if we start from 1Gb, then increase to 2Gb, then to 3Gb, then restart node, with which value need to start now?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698260133/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698261743",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1134#issuecomment-698261743",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134",
    "id": 698261743,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5ODI2MTc0Mw==",
    "user": {
      "login": "AndreaLanfranchi",
      "id": 15280851,
      "node_id": "MDQ6VXNlcjE1MjgwODUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/15280851?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AndreaLanfranchi",
      "html_url": "https://github.com/AndreaLanfranchi",
      "followers_url": "https://api.github.com/users/AndreaLanfranchi/followers",
      "following_url": "https://api.github.com/users/AndreaLanfranchi/following{/other_user}",
      "gists_url": "https://api.github.com/users/AndreaLanfranchi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AndreaLanfranchi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AndreaLanfranchi/subscriptions",
      "organizations_url": "https://api.github.com/users/AndreaLanfranchi/orgs",
      "repos_url": "https://api.github.com/users/AndreaLanfranchi/repos",
      "events_url": "https://api.github.com/users/AndreaLanfranchi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AndreaLanfranchi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-24T10:33:57Z",
    "updated_at": "2020-09-24T10:33:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "Not sure I understand.\r\nYou can actually start with any value ... even 1MB if you wish. \r\nI think starting with 10GB and an increase lot of 2GB every time map is full would be fine.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698261743/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698268242",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1134#issuecomment-698268242",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134",
    "id": 698268242,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5ODI2ODI0Mg==",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-24T10:49:14Z",
    "updated_at": "2020-09-24T10:49:14Z",
    "author_association": "COLLABORATOR",
    "body": "and after server restart - start from 10GB again? ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698268242/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698275016",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1134#issuecomment-698275016",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134",
    "id": 698275016,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5ODI3NTAxNg==",
    "user": {
      "login": "AndreaLanfranchi",
      "id": 15280851,
      "node_id": "MDQ6VXNlcjE1MjgwODUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/15280851?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AndreaLanfranchi",
      "html_url": "https://github.com/AndreaLanfranchi",
      "followers_url": "https://api.github.com/users/AndreaLanfranchi/followers",
      "following_url": "https://api.github.com/users/AndreaLanfranchi/following{/other_user}",
      "gists_url": "https://api.github.com/users/AndreaLanfranchi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AndreaLanfranchi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AndreaLanfranchi/subscriptions",
      "organizations_url": "https://api.github.com/users/AndreaLanfranchi/orgs",
      "repos_url": "https://api.github.com/users/AndreaLanfranchi/repos",
      "events_url": "https://api.github.com/users/AndreaLanfranchi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AndreaLanfranchi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-24T11:05:11Z",
    "updated_at": "2020-09-24T11:05:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "I don't follow or maybe I am missing something.\r\nI'll try to clarify. The problem with mapsize on windows happens when value of map_size is greater than the actual size of file on disk. So on very first start of TG it will try to create a file on disk which has a size equal to map_size.\r\nOn **restart** you _may_ even specify a value of map_size to 1KB but, as the file on disk is already present env opens the file with a map size equal to the size of the file. So you basically never \"restart\" from 10GB.\r\nIn summary ... the bahavior on Windows is this :\r\n* if map_size > file_size then enlarge the file\r\n* if map_size <= file_size then override map_size with file_size\r\n\r\nThis is what I am observing",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698275016/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698325903",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1134#issuecomment-698325903",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134",
    "id": 698325903,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5ODMyNTkwMw==",
    "user": {
      "login": "AndreaLanfranchi",
      "id": 15280851,
      "node_id": "MDQ6VXNlcjE1MjgwODUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/15280851?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AndreaLanfranchi",
      "html_url": "https://github.com/AndreaLanfranchi",
      "followers_url": "https://api.github.com/users/AndreaLanfranchi/followers",
      "following_url": "https://api.github.com/users/AndreaLanfranchi/following{/other_user}",
      "gists_url": "https://api.github.com/users/AndreaLanfranchi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AndreaLanfranchi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AndreaLanfranchi/subscriptions",
      "organizations_url": "https://api.github.com/users/AndreaLanfranchi/orgs",
      "repos_url": "https://api.github.com/users/AndreaLanfranchi/repos",
      "events_url": "https://api.github.com/users/AndreaLanfranchi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AndreaLanfranchi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-24T12:55:40Z",
    "updated_at": "2020-09-24T12:55:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "I must add an interesting experiment I just completed.\r\nI started up new instance (sync from scratch) using `tg.exe --lmdb.mapSize=\"50 GB\"` and let runf for some time.\r\nAs expected two database files both of 50GB size are created in datadir.  After a couple fo hours I succesfully imported headers up to block 9.6M. At that moment I aborted with ^C. Database closed properly.\r\nI eventually restarted the instance but this time using `tg.exe --lmdb.mapSize=\"5 GB\"` (note the different map size). tg started properly and detected \"Most recent local header\" correctly but from that moment on it only emitted \"Looking for peers\" log lines even though the number of connected peers was well above 20. No header download whatsoever for over 2 hours. Eventually I aborted with ^C. \r\nFinally I restarted tg with the very first mapSize (50GB) and in a matter of minutes new imported headers began to flow in.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/698325903/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/763589140",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1134#issuecomment-763589140",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134",
    "id": 763589140,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MzU4OTE0MA==",
    "user": {
      "login": "tjayrush",
      "id": 5417918,
      "node_id": "MDQ6VXNlcjU0MTc5MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5417918?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tjayrush",
      "html_url": "https://github.com/tjayrush",
      "followers_url": "https://api.github.com/users/tjayrush/followers",
      "following_url": "https://api.github.com/users/tjayrush/following{/other_user}",
      "gists_url": "https://api.github.com/users/tjayrush/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tjayrush/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tjayrush/subscriptions",
      "organizations_url": "https://api.github.com/users/tjayrush/orgs",
      "repos_url": "https://api.github.com/users/tjayrush/repos",
      "events_url": "https://api.github.com/users/tjayrush/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tjayrush/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-20T12:57:47Z",
    "updated_at": "2021-01-20T12:57:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "I saw this same problem recently (`tg version 2021.01.2-alpha`).\r\n\r\nTG was generating this warning:\r\n\r\n```\r\nWARN [01-19|23:07:59.636] Synchronisation failed, dropping peer    peer=9ac8df96e49bce26 err=\"retrieved hash chain is invalid: commit inserting bodies: mdb_cursor_put: MDB_MAP_FULL: Environment mapsize limit reached\r\n```\r\n\r\nOn Linux with this command line:\r\n\r\n```\r\n./build/bin/tg --datadir /mnt/md0/turbo-geth --private.api.addr=127.0.0.1:9090 --verbosity 3 --port 30304\r\n```\r\n\r\nI added `--lmdb.mapSize=\"4 TB\" to the command line, and the warning seems to have disappeared.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/763589140/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/846374245",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/1134#issuecomment-846374245",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/1134",
    "id": 846374245,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NjM3NDI0NQ==",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-22T08:23:00Z",
    "updated_at": "2021-05-22T08:23:00Z",
    "author_association": "COLLABORATOR",
    "body": "implemented by migration to mdbx",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/846374245/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
