{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/177",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/177/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/177/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/177/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/177",
  "id": 524637143,
  "node_id": "MDU6SXNzdWU1MjQ2MzcxNDM=",
  "number": 177,
  "title": "Investigate corrupted database after failed unwinding",
  "user": {
    "login": "AlexeyAkhunov",
    "id": 13686139,
    "node_id": "MDQ6VXNlcjEzNjg2MTM5",
    "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AlexeyAkhunov",
    "html_url": "https://github.com/AlexeyAkhunov",
    "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
    "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
    "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
    "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
    "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "AlexeyAkhunov",
    "id": 13686139,
    "node_id": "MDQ6VXNlcjEzNjg2MTM5",
    "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AlexeyAkhunov",
    "html_url": "https://github.com/AlexeyAkhunov",
    "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
    "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
    "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
    "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
    "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "AlexeyAkhunov",
      "id": 13686139,
      "node_id": "MDQ6VXNlcjEzNjg2MTM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AlexeyAkhunov",
      "html_url": "https://github.com/AlexeyAkhunov",
      "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
      "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
      "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
      "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
      "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2019-11-18T21:43:39Z",
  "updated_at": "2019-11-24T14:19:55Z",
  "closed_at": "2019-11-24T14:19:55Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Failed unwinding should not cause corrupted database, but it did\r\n````\r\nINFO [11-18|10:43:28.994] Imported new chain segment               blocks=1  txs=140  mgas=6.847   elapsed=175.541ms  mgasps=39.004  number=8956070 hash=71ae60…9980c5 batch=605\r\nINFO [11-18|10:43:30.059] Memory                                   nodes=1999922 alloc=3525086 sys=8324510 numGC=1001\r\nINFO [11-18|10:43:30.059] Database                                 size=544874000384 written=8474625\r\nINFO [11-18|10:43:32.681] Inserting chain                          start=8956071 end=8956071\r\nINFO [11-18|10:43:32.886] Imported new chain segment               blocks=1  txs=93   mgas=9.921   elapsed=204.699ms  mgasps=48.468  number=8956071 hash=3b0b67…538676 batch=532\r\nINFO [11-18|10:43:33.253] Memory                                   nodes=1999817 alloc=3739215 sys=8324510 numGC=1001\r\nINFO [11-18|10:43:33.253] Database                                 size=544874000384 written=7548929\r\nINFO [11-18|10:44:02.663] Inserting chain                          start=8956072 end=8956072\r\nINFO [11-18|10:44:03.056] Imported new chain segment               blocks=1  txs=243  mgas=9.935   elapsed=393.439ms  mgasps=25.253  number=8956072 hash=bb3481…7799b0 batch=954\r\nINFO [11-18|10:44:03.751] Memory                                   nodes=1999997 alloc=3924254 sys=8324510 numGC=1002\r\nINFO [11-18|10:44:03.752] Database                                 size=544874000384 written=12410881\r\nINFO [11-18|10:44:03.752] Inserting chain                          start=8956072 end=8956072\r\nWARN [11-18|10:44:03.763] Ignoring the chain segment because of insufficient difficulty external=12906697092151760599911 local=12906697092151760599911\r\nWARN [11-18|10:44:03.763] Saving                                   block=8956072 hash=2370dc…a273a1\r\nINFO [11-18|10:44:04.129] Inserting chain                          start=8956073 end=8956073\r\nWARN [11-18|10:44:04.137] Chain segment's parent not on canonical hash, adding to pre-blocks block=8956072 hash=2370dc…a273a1\r\nINFO [11-18|10:44:04.138] Rewinding from                           block=8956072 to block=8956071\r\nERROR[11-18|10:44:04.170] Could not rewind                         error=\"mismatched storage root for 91a49d560f28f08435e26b4bf5284b4164327d6878c6e2f5b63479b802e2a883: expected 56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421, got fc74854769620a02203778a37a69fcd2b36de88c6ed652f61658409d0bb4334c\"\r\nINFO [11-18|10:44:04.192] Inserting chain                          start=8956073 end=8956073\r\nWARN [11-18|10:44:04.197] Chain segment's parent not on canonical hash, adding to pre-blocks block=8956072 hash=2370dc…a273a1\r\nINFO [11-18|10:44:04.199] Creating IntraBlockState from latest state block=8956072\r\nERROR[11-18|10:56:23.250] Rebuiling aborted                        error=\"mismatching hash: <0d21efbc2a9e62e0b856b3954c9b4b0c12181ce98ac4c366c15b77b7553cf158>  4425d513c7e2d64aa04843a4ed611b439d00bc4a899466204b0dea78a0d866ec for prefix , resolveHex , resolvePos 0\"\r\nINFO [11-18|10:56:23.251] Inserting chain                          start=8956073 end=8956074\r\nWARN [11-18|10:56:23.261] Chain segment's parent not on canonical hash, adding to pre-blocks block=8956072 hash=2370dc…a273a1\r\nINFO [11-18|10:56:23.263] Creating IntraBlockState from latest state block=8956072\r\nINFO [11-18|11:00:53.870] Regenerated local transaction journal    transactions=0 accounts=0\r\nERROR[11-18|11:01:02.597] Rebuiling aborted                        error=\"mismatching hash: <0d21efbc2a9e62e0b856b3954c9b4b0c12181ce98ac4c366c15b77b7553cf158>  4425d513c7e2d64aa04843a4ed611b439d00bc4a899466204b0dea78a0d866ec for prefix , resolveHex , resolvePos 0\"\r\n\r\n\r\n````",
  "closed_by": {
    "login": "AlexeyAkhunov",
    "id": 13686139,
    "node_id": "MDQ6VXNlcjEzNjg2MTM5",
    "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AlexeyAkhunov",
    "html_url": "https://github.com/AlexeyAkhunov",
    "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
    "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
    "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
    "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
    "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/177/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/177/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/555744439",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/177#issuecomment-555744439",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/177",
    "id": 555744439,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NTc0NDQzOQ==",
    "user": {
      "login": "AlexeyAkhunov",
      "id": 13686139,
      "node_id": "MDQ6VXNlcjEzNjg2MTM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AlexeyAkhunov",
      "html_url": "https://github.com/AlexeyAkhunov",
      "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
      "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
      "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
      "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
      "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-19T22:23:46Z",
    "updated_at": "2019-11-19T22:23:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "Ran verifySnapshot on the state, and it appears to be consistent (storage roots correspond to the actual roots computed from the storage).",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/555744439/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/557893076",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/177#issuecomment-557893076",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/177",
    "id": 557893076,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1Nzg5MzA3Ng==",
    "user": {
      "login": "AlexeyAkhunov",
      "id": 13686139,
      "node_id": "MDQ6VXNlcjEzNjg2MTM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AlexeyAkhunov",
      "html_url": "https://github.com/AlexeyAkhunov",
      "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
      "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
      "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
      "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
      "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-24T14:19:55Z",
    "updated_at": "2019-11-24T14:19:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "The database is now restored, and I confirmed that the corruption was only due to the incorrect code that I was running at the moment, and not due to any flaw in the unwinding logic",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/557893076/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
