{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3636",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3636/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3636/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3636/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/3636",
  "id": 1157823175,
  "node_id": "I_kwDOC0FsAM5FAvrH",
  "number": 3636,
  "title": "Cannot start downloading new blocks when `--bad.block` is used and goes beyond `persistedLinkLimit`",
  "user": {
    "login": "allada",
    "id": 1831202,
    "node_id": "MDQ6VXNlcjE4MzEyMDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1831202?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/allada",
    "html_url": "https://github.com/allada",
    "followers_url": "https://api.github.com/users/allada/followers",
    "following_url": "https://api.github.com/users/allada/following{/other_user}",
    "gists_url": "https://api.github.com/users/allada/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/allada/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/allada/subscriptions",
    "organizations_url": "https://api.github.com/users/allada/orgs",
    "repos_url": "https://api.github.com/users/allada/repos",
    "events_url": "https://api.github.com/users/allada/events{/privacy}",
    "received_events_url": "https://api.github.com/users/allada/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 11,
  "created_at": "2022-03-03T00:11:06Z",
  "updated_at": "2022-05-27T04:41:50Z",
  "closed_at": "2022-05-27T04:41:50Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "I maintain an erigon BSC archive node and we were hit by a bug outlined here:\r\nhttps://github.com/allada/bsc-archive-snapshot/issues/14\r\n\r\nIn looking for answers that did not require a full resync we found that `--bad.block` should solve our problem by allowing erigon to unwind the changes back to before the bug was found on the chain and then replay from that point onward saving a month+ of resync time.\r\n\r\nIn doing this, I found that if `Unwind` is called on a block too far back (beyond the `persistedLinkLimit`) erigon gets stuck. I made a hack to get around this issue by adding something like:\r\n```go\r\nif header.Number.Uint64() > 14509999 {\r\n  continue\r\n}\r\n```\r\n\r\nto this line https://github.com/ledgerwatch/erigon/blob/f58e80bd56ee449cc31b8dc2eead431890d5b500/turbo/stages/headerdownload/header_algos.go#L546\r\n\r\nHowever, the real problem appears to be that the associated `kv.Headers`'s are not being purged from the database during an unwind.\r\n\r\nI will look at making a patch for this, but before I do, I wanted to make sure that deleting the associated `kv.Headers` is the appropriate and safe thing to do.",
  "closed_by": {
    "login": "AskAlexSharov",
    "id": 46885206,
    "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AskAlexSharov",
    "html_url": "https://github.com/AskAlexSharov",
    "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
    "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
    "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
    "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
    "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3636/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3636/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1085495788",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3636#issuecomment-1085495788",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3636",
    "id": 1085495788,
    "node_id": "IC_kwDOC0FsAM5As1ns",
    "user": {
      "login": "coelho",
      "id": 635360,
      "node_id": "MDQ6VXNlcjYzNTM2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/635360?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coelho",
      "html_url": "https://github.com/coelho",
      "followers_url": "https://api.github.com/users/coelho/followers",
      "following_url": "https://api.github.com/users/coelho/following{/other_user}",
      "gists_url": "https://api.github.com/users/coelho/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coelho/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coelho/subscriptions",
      "organizations_url": "https://api.github.com/users/coelho/orgs",
      "repos_url": "https://api.github.com/users/coelho/repos",
      "events_url": "https://api.github.com/users/coelho/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coelho/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-01T06:45:41Z",
    "updated_at": "2022-04-01T06:45:41Z",
    "author_association": "NONE",
    "body": "> However, the real problem appears to be that the associated kv.Headers's are not being purged from the database during an unwind.\r\n\r\nThis is also the case for kv.Bodies & kv.Receipts from Body Downloader. DB corruption will cause Erigon to endlessly retrieve bad blocks, and unwinding does nothing to recover.\r\n\r\nThis is the issue causing https://github.com/ledgerwatch/erigon/issues/3708 to be unrecoverable.\r\n\r\nProblematic line of code: https://github.com/ledgerwatch/erigon/blob/devel/turbo/stages/bodydownload/body_algos.go#L151\r\nIf you apply this, Erigon recovers:\r\n\r\n```\r\n                                        block = rawdb.ReadBlock(tx, hash, blockNum)\r\n+                                       if block != nil {\r\n+                                               rawdb.DeleteReceipts(tx, blockNum)\r\n+                                               rawdb.DeleteBody(tx, hash, blockNum)\r\n+                                               block = nil\r\n+                                       }\r\n```\r\n\r\nIf the node _ever_ stops uncleanly this corruption can occur. Sounds high priority?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1085495788/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1085549818",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3636#issuecomment-1085549818",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3636",
    "id": 1085549818,
    "node_id": "IC_kwDOC0FsAM5AtCz6",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-01T07:54:09Z",
    "updated_at": "2022-04-01T07:54:09Z",
    "author_association": "COLLABORATOR",
    "body": "\"retrieve bad blocks\" - what is \"bad\" block - in your case? ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1085549818/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1085553035",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3636#issuecomment-1085553035",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3636",
    "id": 1085553035,
    "node_id": "IC_kwDOC0FsAM5AtDmL",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-01T07:56:56Z",
    "updated_at": "2022-04-01T07:56:56Z",
    "author_association": "COLLABORATOR",
    "body": "\"appears to be that the associated kv.Headers's are not being purged from the database during an unwind.\" - why do you need delete them? Are data written to db is incorrect? if yes - do you know why?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1085553035/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1085557531",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3636#issuecomment-1085557531",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3636",
    "id": 1085557531,
    "node_id": "IC_kwDOC0FsAM5AtEsb",
    "user": {
      "login": "coelho",
      "id": 635360,
      "node_id": "MDQ6VXNlcjYzNTM2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/635360?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coelho",
      "html_url": "https://github.com/coelho",
      "followers_url": "https://api.github.com/users/coelho/followers",
      "following_url": "https://api.github.com/users/coelho/following{/other_user}",
      "gists_url": "https://api.github.com/users/coelho/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coelho/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coelho/subscriptions",
      "organizations_url": "https://api.github.com/users/coelho/orgs",
      "repos_url": "https://api.github.com/users/coelho/repos",
      "events_url": "https://api.github.com/users/coelho/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coelho/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-01T08:00:26Z",
    "updated_at": "2022-04-01T08:01:02Z",
    "author_association": "NONE",
    "body": "@AskAlexSharov Correct block number + hash, but incorrect body/receipts. I have not debugged to see what the actual corruption looks like.\r\n\r\nThere's really two issues here:\r\n\r\n1. There is an edge case where if Erigon is stopped uncleanly, it can somehow corrupt bodies/receipts of new blocks*.\r\n\r\n2. When you unwind bodies/headers, you expect to redownload & reprocess them. This isn't the case (you do not redownload) and if there's any DB corruption it doesn't get fixed currently. Currently, it is absolutely impossible (no command exists) to recover from this edge case.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1085557531/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1086570120",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3636#issuecomment-1086570120",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3636",
    "id": 1086570120,
    "node_id": "IC_kwDOC0FsAM5Aw76I",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-02T07:06:25Z",
    "updated_at": "2022-04-02T07:06:25Z",
    "author_association": "COLLABORATOR",
    "body": "ah, now I see what you mean.\r\n\r\n2. no, because \"unwind\" it's our mechanism for `reorg` and reorgs must be fast - it's part of consensus stability. No reason to re-download block - because nothing can change inside block, if something changed - it will change hash of block.\r\n1. I have some idea how it can happen... not related to shutdown... let me think...\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1086570120/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1086570626",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3636#issuecomment-1086570626",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3636",
    "id": 1086570626,
    "node_id": "IC_kwDOC0FsAM5Aw8CC",
    "user": {
      "login": "coelho",
      "id": 635360,
      "node_id": "MDQ6VXNlcjYzNTM2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/635360?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/coelho",
      "html_url": "https://github.com/coelho",
      "followers_url": "https://api.github.com/users/coelho/followers",
      "following_url": "https://api.github.com/users/coelho/following{/other_user}",
      "gists_url": "https://api.github.com/users/coelho/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/coelho/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/coelho/subscriptions",
      "organizations_url": "https://api.github.com/users/coelho/orgs",
      "repos_url": "https://api.github.com/users/coelho/repos",
      "events_url": "https://api.github.com/users/coelho/events{/privacy}",
      "received_events_url": "https://api.github.com/users/coelho/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-02T07:09:29Z",
    "updated_at": "2022-04-02T07:09:35Z",
    "author_association": "NONE",
    "body": "@AskAlexSharov Possibly interim, could I suggest a new command in `integration` that allows users to clear headers/bodies/receipts that are not yet canonical (or are unwound)?\r\n\r\nThis would allow people at least a path to recover while the main issue is debugged.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1086570626/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1086578795",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3636#issuecomment-1086578795",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3636",
    "id": 1086578795,
    "node_id": "IC_kwDOC0FsAM5Aw-Br",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-02T07:44:17Z",
    "updated_at": "2022-04-02T07:44:17Z",
    "author_association": "COLLABORATOR",
    "body": "Unwind already does remove receipts: eth/stagedsync/stage_execute.go -> unwindExecutionStage -> DeleteNewerReceipts\r\n\r\nBlock: 14794507 error `tx count = 276, receipts count = 275`\r\nBlock: 14794507 has 276 txs https://bscscan.com/block/14794507 - which is correct - means no reason to delete blocks\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1086578795/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1086578968",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3636#issuecomment-1086578968",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3636",
    "id": 1086578968,
    "node_id": "IC_kwDOC0FsAM5Aw-EY",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-02T07:45:25Z",
    "updated_at": "2022-04-02T07:45:25Z",
    "author_association": "COLLABORATOR",
    "body": "FYI: Receipts are not coming from p2p network - they are generated when block executed.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1086578968/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1086579685",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3636#issuecomment-1086579685",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3636",
    "id": 1086579685,
    "node_id": "IC_kwDOC0FsAM5Aw-Pl",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-02T07:50:21Z",
    "updated_at": "2022-04-02T07:51:51Z",
    "author_association": "COLLABORATOR",
    "body": "So, probably need find why block execution does write 275 receipts(instead of 276): `eth/stagedsync/stage_execute.go -> SpawnExecuteBlocksStage -> executeBlock ->Â AppendReceipts`\r\n\r\nCan re-exec blocks next way:\r\n```\r\n#first unwind to block < 14794507\r\ngo run --trimpath  ./cmd/integration state_stages --unwind=1 --datadir=<your_datadir> --chain=bsc --integrity.fast=false\r\n\r\n#then run forward to block 14794507\r\ngo run --trimpath  ./cmd/integration state_stages --block=14794507  --datadir=<your_datadir> --chain=bsc --integrity.fast=false\r\n```\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1086579685/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1086585257",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3636#issuecomment-1086585257",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3636",
    "id": 1086585257,
    "node_id": "IC_kwDOC0FsAM5Aw_mp",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-02T08:17:35Z",
    "updated_at": "2022-04-02T08:17:35Z",
    "author_association": "COLLABORATOR",
    "body": "\"could I suggest a new command in integration that allows users to clear headers/bodies/receipts that are not yet canonical (or are unwound)?\" - Added into `stage_header --unwind` https://github.com/ledgerwatch/erigon/pull/3813/ - but if you can help check https://github.com/ledgerwatch/erigon/issues/3636#issuecomment-1086579685 before delete - would be helpful",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1086585257/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1139270868",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3636#issuecomment-1139270868",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3636",
    "id": 1139270868,
    "node_id": "IC_kwDOC0FsAM5D5-TU",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-27T04:41:50Z",
    "updated_at": "2022-05-27T04:41:50Z",
    "author_association": "COLLABORATOR",
    "body": "done `stage_header --unwind` and `stage_header --reset` (but reset working only in latest devel - found bug there recently).",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1139270868/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
