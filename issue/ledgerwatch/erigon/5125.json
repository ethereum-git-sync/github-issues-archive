{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/5125",
  "id": 1345213367,
  "node_id": "I_kwDOC0FsAM5QLlO3",
  "number": 5125,
  "title": "Deadlock in BeginRo",
  "user": {
    "login": "kaikash",
    "id": 8350069,
    "node_id": "MDQ6VXNlcjgzNTAwNjk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8350069?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kaikash",
    "html_url": "https://github.com/kaikash",
    "followers_url": "https://api.github.com/users/kaikash/followers",
    "following_url": "https://api.github.com/users/kaikash/following{/other_user}",
    "gists_url": "https://api.github.com/users/kaikash/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kaikash/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kaikash/subscriptions",
    "organizations_url": "https://api.github.com/users/kaikash/orgs",
    "repos_url": "https://api.github.com/users/kaikash/repos",
    "events_url": "https://api.github.com/users/kaikash/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kaikash/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4406003490,
      "node_id": "LA_kwDOC0FsAM8AAAABBp5HIg",
      "url": "https://api.github.com/repos/ledgerwatch/erigon/labels/gateway",
      "name": "gateway",
      "color": "62DB33",
      "default": false,
      "description": "Issue assigned to gateway team"
    },
    {
      "id": 4479226498,
      "node_id": "LA_kwDOC0FsAM8AAAABCvuSgg",
      "url": "https://api.github.com/repos/ledgerwatch/erigon/labels/status:in-progress",
      "name": "status:in-progress",
      "color": "1DDFDF",
      "default": false,
      "description": "Actively being worked on (picked up by developer)"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "revitteth",
    "id": 693995,
    "node_id": "MDQ6VXNlcjY5Mzk5NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/693995?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/revitteth",
    "html_url": "https://github.com/revitteth",
    "followers_url": "https://api.github.com/users/revitteth/followers",
    "following_url": "https://api.github.com/users/revitteth/following{/other_user}",
    "gists_url": "https://api.github.com/users/revitteth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/revitteth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/revitteth/subscriptions",
    "organizations_url": "https://api.github.com/users/revitteth/orgs",
    "repos_url": "https://api.github.com/users/revitteth/repos",
    "events_url": "https://api.github.com/users/revitteth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/revitteth/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "revitteth",
      "id": 693995,
      "node_id": "MDQ6VXNlcjY5Mzk5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/693995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/revitteth",
      "html_url": "https://github.com/revitteth",
      "followers_url": "https://api.github.com/users/revitteth/followers",
      "following_url": "https://api.github.com/users/revitteth/following{/other_user}",
      "gists_url": "https://api.github.com/users/revitteth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/revitteth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/revitteth/subscriptions",
      "organizations_url": "https://api.github.com/users/revitteth/orgs",
      "repos_url": "https://api.github.com/users/revitteth/repos",
      "events_url": "https://api.github.com/users/revitteth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/revitteth/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 27,
  "created_at": "2022-08-20T16:16:13Z",
  "updated_at": "2022-09-19T04:59:26Z",
  "closed_at": "2022-09-19T04:59:26Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: `./erigon --version`\r\n2022.99.99-dev-1303023c\r\n\r\nOS & Version: Windows/Linux/OSX\r\nubuntu 20.04\r\n\r\nCommit hash:\r\n1303023cb8949050250384a2713c6f65896dd27e\r\n\r\n#### Expected behaviour\r\nNo deadlock\r\n\r\n#### Actual behaviour\r\nDeadlock :( It stucks in `semaphore.Acquire` call.\r\n\r\n#### Steps to reproduce the behaviour\r\nSend about 5k `eth_call` requests simultaneously via 2 websocket connections.\r\n\r\n\r\n#### Logs\r\npkill -SIGUSR1 erigon\r\n\r\n```\r\ngoroutine 56608 [select, 10 minutes]:\r\ngolang.org/x/sync/semaphore.(*Weighted).Acquire(0xc0001500f0, {0x200d3b0, 0xc0cb6bbe90}, 0x1)\r\n\tgolang.org/x/sync@v0.0.0-20220722155255-886fb9371eb4/semaphore/semaphore.go:60 +0x345\r\ngithub.com/ledgerwatch/erigon-lib/kv/mdbx.(*MdbxKV).BeginRo(0xc0002791e0, {0x200d3b0?, 0xc0cb6bbe90?})\r\n\tgithub.com/ledgerwatch/erigon-lib@v0.0.0-20220819042719-4c744ae88a33/kv/mdbx/kv_mdbx.go:425 +0x85\r\ngithub.com/ledgerwatch/erigon-lib/kv/remotedbserver.(*KvServer).Tx(0xc0a8768800, {0x2017408, 0xc0cb6a1390})\r\n\tgithub.com/ledgerwatch/erigon-lib@v0.0.0-20220819042719-4c744ae88a33/kv/remotedbserver/server.go:84 +0x77\r\ngithub.com/ledgerwatch/erigon-lib/gointerfaces/remote._KV_Tx_Handler({0x181dda0?, 0xc0a8768800}, {0x20128b8?, 0xc0cb6c24e0})\r\n\tgithub.com/ledgerwatch/erigon-lib@v0.0.0-20220819042719-4c744ae88a33/gointerfaces/remote/kv_grpc.pb.go:195 +0x9f\r\ngithub.com/grpc-ecosystem/go-grpc-middleware/recovery.StreamServerInterceptor.func1({0x181dda0?, 0xc0a8768800?}, {0x20128b8?, 0xc0cb6c24e0?}, 0x77ce0c149e98?, 0xc0cb69d4e8?)\r\n\tgithub.com/grpc-ecosystem/go-grpc-middleware@v1.3.0/recovery/interceptors.go:51 +0xb0\r\ngithub.com/grpc-ecosystem/go-grpc-middleware.ChainStreamServer.func1.1.1({0x181dda0?, 0xc0a8768800?}, {0x20128b8?, 0xc0cb6c24e0?})\r\n\tgithub.com/grpc-ecosystem/go-grpc-middleware@v1.3.0/chain.go:49 +0x3a\r\ngithub.com/grpc-ecosystem/go-grpc-middleware.ChainStreamServer.func1({0x181dda0, 0xc0a8768800}, {0x20128b8, 0xc0cb6c24e0}, 0x1689740?, 0xc0cb6a1380?)\r\n\tgithub.com/grpc-ecosystem/go-grpc-middleware@v1.3.0/chain.go:58 +0xbf\r\ngoogle.golang.org/grpc.(*Server).processStreamingRPC(0xc000000780, {0x2018460, 0xc0a89a1040}, 0xc0cb6beb40, 0xc0b2165f20, 0x2b4e0e0, 0x0)\r\n\tgoogle.golang.org/grpc@v1.48.0/server.go:1565 +0xf26\r\ngoogle.golang.org/grpc.(*Server).handleStream(0xc000000780, {0x2018460, 0xc0a89a1040}, 0xc0cb6beb40, 0x0)\r\n\tgoogle.golang.org/grpc@v1.48.0/server.go:1640 +0x9d6\r\ngoogle.golang.org/grpc.(*Server).serveStreams.func1.2()\r\n\tgoogle.golang.org/grpc@v1.48.0/server.go:932 +0x98\r\ncreated by google.golang.org/grpc.(*Server).serveStreams.func1\r\n\tgoogle.golang.org/grpc@v1.48.0/server.go:930 +0x28a\r\n```\r\n[pkill.log](https://github.com/ledgerwatch/erigon/files/9387657/pkill.log)\r\n",
  "closed_by": {
    "login": "revitteth",
    "id": 693995,
    "node_id": "MDQ6VXNlcjY5Mzk5NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/693995?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/revitteth",
    "html_url": "https://github.com/revitteth",
    "followers_url": "https://api.github.com/users/revitteth/followers",
    "following_url": "https://api.github.com/users/revitteth/following{/other_user}",
    "gists_url": "https://api.github.com/users/revitteth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/revitteth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/revitteth/subscriptions",
    "organizations_url": "https://api.github.com/users/revitteth/orgs",
    "repos_url": "https://api.github.com/users/revitteth/repos",
    "events_url": "https://api.github.com/users/revitteth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/revitteth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1221459309",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1221459309",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1221459309,
    "node_id": "IC_kwDOC0FsAM5Izf1t",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-21T03:23:23Z",
    "updated_at": "2022-08-21T03:23:23Z",
    "author_association": "COLLABORATOR",
    "body": "Same if increase —db.read.concurrency ? ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1221459309/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1221512778",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1221512778",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1221512778,
    "node_id": "IC_kwDOC0FsAM5Izs5K",
    "user": {
      "login": "kaikash",
      "id": 8350069,
      "node_id": "MDQ6VXNlcjgzNTAwNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8350069?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaikash",
      "html_url": "https://github.com/kaikash",
      "followers_url": "https://api.github.com/users/kaikash/followers",
      "following_url": "https://api.github.com/users/kaikash/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaikash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaikash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaikash/subscriptions",
      "organizations_url": "https://api.github.com/users/kaikash/orgs",
      "repos_url": "https://api.github.com/users/kaikash/repos",
      "events_url": "https://api.github.com/users/kaikash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaikash/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-21T09:58:55Z",
    "updated_at": "2022-08-21T09:58:55Z",
    "author_association": "NONE",
    "body": "Tried to increase from 32 to 200, didn't help. Can you reproduce it on your side?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1221512778/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1221514286",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1221514286",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1221514286,
    "node_id": "IC_kwDOC0FsAM5IztQu",
    "user": {
      "login": "kaikash",
      "id": 8350069,
      "node_id": "MDQ6VXNlcjgzNTAwNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8350069?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaikash",
      "html_url": "https://github.com/kaikash",
      "followers_url": "https://api.github.com/users/kaikash/followers",
      "following_url": "https://api.github.com/users/kaikash/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaikash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaikash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaikash/subscriptions",
      "organizations_url": "https://api.github.com/users/kaikash/orgs",
      "repos_url": "https://api.github.com/users/kaikash/repos",
      "events_url": "https://api.github.com/users/kaikash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaikash/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-21T10:07:16Z",
    "updated_at": "2022-08-21T10:07:16Z",
    "author_association": "NONE",
    "body": "Tried to run with  `—db.read.concurrency=5000`, seems to be working. Is it ok to run node with this setting?\r\n\r\nBut still this is not quite the correct behavior of the program if it deadlocks during a burst of load..",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1221514286/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1221516123",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1221516123",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1221516123,
    "node_id": "IC_kwDOC0FsAM5Izttb",
    "user": {
      "login": "kaikash",
      "id": 8350069,
      "node_id": "MDQ6VXNlcjgzNTAwNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8350069?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaikash",
      "html_url": "https://github.com/kaikash",
      "followers_url": "https://api.github.com/users/kaikash/followers",
      "following_url": "https://api.github.com/users/kaikash/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaikash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaikash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaikash/subscriptions",
      "organizations_url": "https://api.github.com/users/kaikash/orgs",
      "repos_url": "https://api.github.com/users/kaikash/repos",
      "events_url": "https://api.github.com/users/kaikash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaikash/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-21T10:17:35Z",
    "updated_at": "2022-08-21T11:18:36Z",
    "author_association": "NONE",
    "body": "Eventually it stucked :( Even with this setting. First time I send ~5k requests and it responds successfully, then it stucks a second time I send them. So, I think it doesn't release semaphore the same number of times it acquires it, do it?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1221516123/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1221555332",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1221555332",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1221555332,
    "node_id": "IC_kwDOC0FsAM5Iz3SE",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-21T14:19:56Z",
    "updated_at": "2022-08-21T14:19:56Z",
    "author_association": "COLLABORATOR",
    "body": "do you run separated RPCDaemon? if yes: with --datadir? if no try add --datadir",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1221555332/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1221555418",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1221555418",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1221555418,
    "node_id": "IC_kwDOC0FsAM5Iz3Ta",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-21T14:20:34Z",
    "updated_at": "2022-08-21T14:20:34Z",
    "author_association": "COLLABORATOR",
    "body": "\"Can you reproduce it on your side?\" - I didn't try yet",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1221555418/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1221581031",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1221581031",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1221581031,
    "node_id": "IC_kwDOC0FsAM5Iz9jn",
    "user": {
      "login": "kaikash",
      "id": 8350069,
      "node_id": "MDQ6VXNlcjgzNTAwNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8350069?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaikash",
      "html_url": "https://github.com/kaikash",
      "followers_url": "https://api.github.com/users/kaikash/followers",
      "following_url": "https://api.github.com/users/kaikash/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaikash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaikash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaikash/subscriptions",
      "organizations_url": "https://api.github.com/users/kaikash/orgs",
      "repos_url": "https://api.github.com/users/kaikash/repos",
      "events_url": "https://api.github.com/users/kaikash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaikash/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-21T16:46:17Z",
    "updated_at": "2022-08-21T16:50:00Z",
    "author_association": "NONE",
    "body": "Yes, I'm running a separated RPCDaemon, they are on the same machine, but in different containers. \r\n\r\nTried to run with `--datadir` and it seems to be working, even with `db.read.concurrency=32`.\r\n\r\nSo, it has to be a deadlock when transaction creates with remotedb?\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1221581031/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1221883278",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1221883278",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1221883278,
    "node_id": "IC_kwDOC0FsAM5I1HWO",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-22T06:08:09Z",
    "updated_at": "2022-08-22T06:08:09Z",
    "author_association": "COLLABORATOR",
    "body": "ok, then it's a bit known issue with remotedb grpc server architecture. \r\nI advise you work with --datadir now.\r\ndon't know when we will able to fix it.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1221883278/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222112410",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1222112410",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1222112410,
    "node_id": "IC_kwDOC0FsAM5I1_Sa",
    "user": {
      "login": "kaikash",
      "id": 8350069,
      "node_id": "MDQ6VXNlcjgzNTAwNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8350069?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaikash",
      "html_url": "https://github.com/kaikash",
      "followers_url": "https://api.github.com/users/kaikash/followers",
      "following_url": "https://api.github.com/users/kaikash/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaikash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaikash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaikash/subscriptions",
      "organizations_url": "https://api.github.com/users/kaikash/orgs",
      "repos_url": "https://api.github.com/users/kaikash/repos",
      "events_url": "https://api.github.com/users/kaikash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaikash/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-22T09:44:30Z",
    "updated_at": "2022-08-22T09:44:30Z",
    "author_association": "NONE",
    "body": "I see, thanks. What is known about this bug at the moment? Maybe a little more context, so I can try to check this out myself?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222112410/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222217462",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1222217462",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1222217462,
    "node_id": "IC_kwDOC0FsAM5I2Y72",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-22T11:23:24Z",
    "updated_at": "2022-08-22T11:23:24Z",
    "author_association": "COLLABORATOR",
    "body": "what we know:\r\n1. unclear - is it really deadlock or just --db.read.concurrency limit touched and all next readers just waiting previous one\r\n2. seems Golang is not very friendly to embedded C databases: when you get IO inside C code - golang see that whole thread is locked (golang's runtime can't schedule any goroutine to this thread) - and golang exclude current thread from it's thread pool. As a result - with much parallel read transactions (which doing some IO) you will have tons of threads (which is in-general bad for performance) and then also will touch golang's limit of 10K threads and app crush. this is reason why we have --db.read.concurrency semaphore.\r\n3. network-based transactions (remotedb) are slower and you faster getting to the limit. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222217462/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222375926",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1222375926",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1222375926,
    "node_id": "IC_kwDOC0FsAM5I2_n2",
    "user": {
      "login": "PeaStew",
      "id": 34198053,
      "node_id": "MDQ6VXNlcjM0MTk4MDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/34198053?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PeaStew",
      "html_url": "https://github.com/PeaStew",
      "followers_url": "https://api.github.com/users/PeaStew/followers",
      "following_url": "https://api.github.com/users/PeaStew/following{/other_user}",
      "gists_url": "https://api.github.com/users/PeaStew/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PeaStew/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PeaStew/subscriptions",
      "organizations_url": "https://api.github.com/users/PeaStew/orgs",
      "repos_url": "https://api.github.com/users/PeaStew/repos",
      "events_url": "https://api.github.com/users/PeaStew/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PeaStew/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-22T13:37:34Z",
    "updated_at": "2022-08-22T13:37:34Z",
    "author_association": "NONE",
    "body": "--datadir does not solve this for local erigon + local rpcdaemon under high load we can what appears to be a lockup on the rpcd every <20mins",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222375926/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222389937",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1222389937",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1222389937,
    "node_id": "IC_kwDOC0FsAM5I3DCx",
    "user": {
      "login": "revitteth",
      "id": 693995,
      "node_id": "MDQ6VXNlcjY5Mzk5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/693995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/revitteth",
      "html_url": "https://github.com/revitteth",
      "followers_url": "https://api.github.com/users/revitteth/followers",
      "following_url": "https://api.github.com/users/revitteth/following{/other_user}",
      "gists_url": "https://api.github.com/users/revitteth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/revitteth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/revitteth/subscriptions",
      "organizations_url": "https://api.github.com/users/revitteth/orgs",
      "repos_url": "https://api.github.com/users/revitteth/repos",
      "events_url": "https://api.github.com/users/revitteth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/revitteth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-22T13:48:42Z",
    "updated_at": "2022-08-22T13:48:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think I now have something here - will push some code this afternoon so we can try to prove it:\r\n\r\n- roTxsLimiter is a semaphore which defaults to the runtime.GOMAXPROCS(-1) - which for most machines will be c. 8 (correct me if wrong!)\r\n- db.read.concurrency flag sets this roTxsLimiter - and the repros where issues are seen are passing this value as c. 200-10k (as seen on GH)\r\n\r\nGiven point 2 in @AskAlexSharov comment above it seems plausible this value is just set too high?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222389937/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222423035",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1222423035",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1222423035,
    "node_id": "IC_kwDOC0FsAM5I3LH7",
    "user": {
      "login": "revitteth",
      "id": 693995,
      "node_id": "MDQ6VXNlcjY5Mzk5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/693995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/revitteth",
      "html_url": "https://github.com/revitteth",
      "followers_url": "https://api.github.com/users/revitteth/followers",
      "following_url": "https://api.github.com/users/revitteth/following{/other_user}",
      "gists_url": "https://api.github.com/users/revitteth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/revitteth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/revitteth/subscriptions",
      "organizations_url": "https://api.github.com/users/revitteth/orgs",
      "repos_url": "https://api.github.com/users/revitteth/repos",
      "events_url": "https://api.github.com/users/revitteth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/revitteth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-22T14:14:46Z",
    "updated_at": "2022-08-22T14:14:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "I guess in the meantime if there's chance to try again - remove the db.read.concurrency flag altogether, let it default to GOMAXPROCS(-1), and see if the repro produces the same exhaustion/locking?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222423035/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222426508",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1222426508",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1222426508,
    "node_id": "IC_kwDOC0FsAM5I3L-M",
    "user": {
      "login": "kaikash",
      "id": 8350069,
      "node_id": "MDQ6VXNlcjgzNTAwNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8350069?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaikash",
      "html_url": "https://github.com/kaikash",
      "followers_url": "https://api.github.com/users/kaikash/followers",
      "following_url": "https://api.github.com/users/kaikash/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaikash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaikash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaikash/subscriptions",
      "organizations_url": "https://api.github.com/users/kaikash/orgs",
      "repos_url": "https://api.github.com/users/kaikash/repos",
      "events_url": "https://api.github.com/users/kaikash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaikash/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-22T14:17:25Z",
    "updated_at": "2022-08-22T14:18:46Z",
    "author_association": "NONE",
    "body": "Could this be due to the fact that all go runtime threads are excluded? So there are no free threads for goroutines to process result form database. I can try to test it with lower `db.read.concurrency`.\r\n\r\nBut this hypothesis is refuted by the fact that there are still some working goroutines which print `GoodPeers`?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222426508/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222429401",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1222429401",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1222429401,
    "node_id": "IC_kwDOC0FsAM5I3MrZ",
    "user": {
      "login": "revitteth",
      "id": 693995,
      "node_id": "MDQ6VXNlcjY5Mzk5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/693995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/revitteth",
      "html_url": "https://github.com/revitteth",
      "followers_url": "https://api.github.com/users/revitteth/followers",
      "following_url": "https://api.github.com/users/revitteth/following{/other_user}",
      "gists_url": "https://api.github.com/users/revitteth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/revitteth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/revitteth/subscriptions",
      "organizations_url": "https://api.github.com/users/revitteth/orgs",
      "repos_url": "https://api.github.com/users/revitteth/repos",
      "events_url": "https://api.github.com/users/revitteth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/revitteth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-22T14:19:32Z",
    "updated_at": "2022-08-22T14:19:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yeah good point on the goodPeers - think I need to instrument some code so we can see more clearly what's going on here - I do think the first part of what you said looks like it 'could' be correct - for me to go prove!",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222429401/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222446550",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1222446550",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1222446550,
    "node_id": "IC_kwDOC0FsAM5I3Q3W",
    "user": {
      "login": "kaikash",
      "id": 8350069,
      "node_id": "MDQ6VXNlcjgzNTAwNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8350069?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaikash",
      "html_url": "https://github.com/kaikash",
      "followers_url": "https://api.github.com/users/kaikash/followers",
      "following_url": "https://api.github.com/users/kaikash/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaikash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaikash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaikash/subscriptions",
      "organizations_url": "https://api.github.com/users/kaikash/orgs",
      "repos_url": "https://api.github.com/users/kaikash/repos",
      "events_url": "https://api.github.com/users/kaikash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaikash/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-22T14:32:19Z",
    "updated_at": "2022-08-22T14:32:53Z",
    "author_association": "NONE",
    "body": "Tried to run with default value (`max(10, GOMAXPROCS*2)`), `db.read.concurrency=2` and `db.read.concurrency=1` -- it still stucks.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222446550/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222649872",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1222649872",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1222649872,
    "node_id": "IC_kwDOC0FsAM5I4CgQ",
    "user": {
      "login": "revitteth",
      "id": 693995,
      "node_id": "MDQ6VXNlcjY5Mzk5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/693995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/revitteth",
      "html_url": "https://github.com/revitteth",
      "followers_url": "https://api.github.com/users/revitteth/followers",
      "following_url": "https://api.github.com/users/revitteth/following{/other_user}",
      "gists_url": "https://api.github.com/users/revitteth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/revitteth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/revitteth/subscriptions",
      "organizations_url": "https://api.github.com/users/revitteth/orgs",
      "repos_url": "https://api.github.com/users/revitteth/repos",
      "events_url": "https://api.github.com/users/revitteth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/revitteth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-22T17:06:59Z",
    "updated_at": "2022-08-22T17:06:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "@kaikash you seem to be able to replicate quickly - do you have an example of the calls you are making?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1222649872/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223275611",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1223275611",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1223275611,
    "node_id": "IC_kwDOC0FsAM5I6bRb",
    "user": {
      "login": "kaikash",
      "id": 8350069,
      "node_id": "MDQ6VXNlcjgzNTAwNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8350069?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaikash",
      "html_url": "https://github.com/kaikash",
      "followers_url": "https://api.github.com/users/kaikash/followers",
      "following_url": "https://api.github.com/users/kaikash/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaikash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaikash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaikash/subscriptions",
      "organizations_url": "https://api.github.com/users/kaikash/orgs",
      "repos_url": "https://api.github.com/users/kaikash/repos",
      "events_url": "https://api.github.com/users/kaikash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaikash/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-22T22:42:36Z",
    "updated_at": "2022-08-22T22:42:36Z",
    "author_association": "NONE",
    "body": "@revitteth here is a test script https://github.com/kaikash/eth-call-test\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223275611/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223285988",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1223285988",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1223285988,
    "node_id": "IC_kwDOC0FsAM5I6dzk",
    "user": {
      "login": "kaikash",
      "id": 8350069,
      "node_id": "MDQ6VXNlcjgzNTAwNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8350069?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaikash",
      "html_url": "https://github.com/kaikash",
      "followers_url": "https://api.github.com/users/kaikash/followers",
      "following_url": "https://api.github.com/users/kaikash/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaikash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaikash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaikash/subscriptions",
      "organizations_url": "https://api.github.com/users/kaikash/orgs",
      "repos_url": "https://api.github.com/users/kaikash/repos",
      "events_url": "https://api.github.com/users/kaikash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaikash/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-22T22:50:53Z",
    "updated_at": "2022-08-22T23:03:01Z",
    "author_association": "NONE",
    "body": "It works very unpredictable, sometimes it stucks, sometimes it is not. Try increasing connection pool size (for me it stucks with 10 cons and 10k requests). Maybe this script is not the best because it makes same requests and erigon caching it?..  ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1223285988/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1227469449",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1227469449",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1227469449,
    "node_id": "IC_kwDOC0FsAM5JKbKJ",
    "user": {
      "login": "revitteth",
      "id": 693995,
      "node_id": "MDQ6VXNlcjY5Mzk5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/693995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/revitteth",
      "html_url": "https://github.com/revitteth",
      "followers_url": "https://api.github.com/users/revitteth/followers",
      "following_url": "https://api.github.com/users/revitteth/following{/other_user}",
      "gists_url": "https://api.github.com/users/revitteth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/revitteth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/revitteth/subscriptions",
      "organizations_url": "https://api.github.com/users/revitteth/orgs",
      "repos_url": "https://api.github.com/users/revitteth/repos",
      "events_url": "https://api.github.com/users/revitteth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/revitteth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-25T16:01:25Z",
    "updated_at": "2022-08-25T16:01:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "@kaikash sorry for delay, still working on this one!\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1227469449/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1229019198",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1229019198",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1229019198,
    "node_id": "IC_kwDOC0FsAM5JQVg-",
    "user": {
      "login": "PeaStew",
      "id": 34198053,
      "node_id": "MDQ6VXNlcjM0MTk4MDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/34198053?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PeaStew",
      "html_url": "https://github.com/PeaStew",
      "followers_url": "https://api.github.com/users/PeaStew/followers",
      "following_url": "https://api.github.com/users/PeaStew/following{/other_user}",
      "gists_url": "https://api.github.com/users/PeaStew/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PeaStew/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PeaStew/subscriptions",
      "organizations_url": "https://api.github.com/users/PeaStew/orgs",
      "repos_url": "https://api.github.com/users/PeaStew/repos",
      "events_url": "https://api.github.com/users/PeaStew/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PeaStew/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-26T22:41:46Z",
    "updated_at": "2022-08-26T22:41:46Z",
    "author_association": "NONE",
    "body": "So... we had a thought about this having just run into a similar issue in some code we are building related to the same concept. We discovered that if the application is receiving a huge amount of requests async, it actually never has time for GC (as GC is generally a blocking activity and blocking activities are deferred while a thread is in use) so what may be happening to Erigon too is simply that the thread lifetime is essentially 'forever' while it is in constant use and no GC can occur. I can't say for sure in the code, but perhaps setting a max lifetime on the threads may help release memory and not run into this deadlock.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1229019198/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1229024693",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1229024693",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1229024693,
    "node_id": "IC_kwDOC0FsAM5JQW21",
    "user": {
      "login": "revitteth",
      "id": 693995,
      "node_id": "MDQ6VXNlcjY5Mzk5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/693995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/revitteth",
      "html_url": "https://github.com/revitteth",
      "followers_url": "https://api.github.com/users/revitteth/followers",
      "following_url": "https://api.github.com/users/revitteth/following{/other_user}",
      "gists_url": "https://api.github.com/users/revitteth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/revitteth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/revitteth/subscriptions",
      "organizations_url": "https://api.github.com/users/revitteth/orgs",
      "repos_url": "https://api.github.com/users/revitteth/repos",
      "events_url": "https://api.github.com/users/revitteth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/revitteth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-26T22:54:01Z",
    "updated_at": "2022-08-26T22:54:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for the input! I'm balancing this one with a few other issues so the insight is super appreciated. Will be picking this up next week for sure. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1229024693/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1242776839",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1242776839",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1242776839,
    "node_id": "IC_kwDOC0FsAM5KE0UH",
    "user": {
      "login": "zimbabao",
      "id": 171239,
      "node_id": "MDQ6VXNlcjE3MTIzOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/171239?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zimbabao",
      "html_url": "https://github.com/zimbabao",
      "followers_url": "https://api.github.com/users/zimbabao/followers",
      "following_url": "https://api.github.com/users/zimbabao/following{/other_user}",
      "gists_url": "https://api.github.com/users/zimbabao/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zimbabao/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zimbabao/subscriptions",
      "organizations_url": "https://api.github.com/users/zimbabao/orgs",
      "repos_url": "https://api.github.com/users/zimbabao/repos",
      "events_url": "https://api.github.com/users/zimbabao/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zimbabao/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-10T17:55:01Z",
    "updated_at": "2022-09-10T17:55:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "I removed rpcDaemon and running in single process mode. Still it gets stuck. FWIW, I am running bsc node on erigon:alpha.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1242776839/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1242778725",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1242778725",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1242778725,
    "node_id": "IC_kwDOC0FsAM5KE0xl",
    "user": {
      "login": "revitteth",
      "id": 693995,
      "node_id": "MDQ6VXNlcjY5Mzk5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/693995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/revitteth",
      "html_url": "https://github.com/revitteth",
      "followers_url": "https://api.github.com/users/revitteth/followers",
      "following_url": "https://api.github.com/users/revitteth/following{/other_user}",
      "gists_url": "https://api.github.com/users/revitteth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/revitteth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/revitteth/subscriptions",
      "organizations_url": "https://api.github.com/users/revitteth/orgs",
      "repos_url": "https://api.github.com/users/revitteth/repos",
      "events_url": "https://api.github.com/users/revitteth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/revitteth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-10T18:06:27Z",
    "updated_at": "2022-09-10T18:06:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks, useful info, currently trying to finish up on another bug and should get to this soon. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1242778725/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1242814840",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1242814840",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1242814840,
    "node_id": "IC_kwDOC0FsAM5KE9l4",
    "user": {
      "login": "zimbabao",
      "id": 171239,
      "node_id": "MDQ6VXNlcjE3MTIzOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/171239?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zimbabao",
      "html_url": "https://github.com/zimbabao",
      "followers_url": "https://api.github.com/users/zimbabao/followers",
      "following_url": "https://api.github.com/users/zimbabao/following{/other_user}",
      "gists_url": "https://api.github.com/users/zimbabao/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zimbabao/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zimbabao/subscriptions",
      "organizations_url": "https://api.github.com/users/zimbabao/orgs",
      "repos_url": "https://api.github.com/users/zimbabao/repos",
      "events_url": "https://api.github.com/users/zimbabao/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zimbabao/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-10T22:38:48Z",
    "updated_at": "2022-09-10T23:13:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "Now it's not stuck but hitting IOPS issue 50K, I am getting throughput of 1000/RPS.\r\nI now suspect issue is with rpcDaemon as separate process and once I moved to single process my main issue is IOPS.    \r\n\r\nI can reliably fix the problem by running in single process mode on ethereum node too (before this I was running rpcDaemon too).",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1242814840/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1246714347",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1246714347",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1246714347,
    "node_id": "IC_kwDOC0FsAM5KT1nr",
    "user": {
      "login": "hexoscott",
      "id": 70711990,
      "node_id": "MDQ6VXNlcjcwNzExOTkw",
      "avatar_url": "https://avatars.githubusercontent.com/u/70711990?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hexoscott",
      "html_url": "https://github.com/hexoscott",
      "followers_url": "https://api.github.com/users/hexoscott/followers",
      "following_url": "https://api.github.com/users/hexoscott/following{/other_user}",
      "gists_url": "https://api.github.com/users/hexoscott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hexoscott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hexoscott/subscriptions",
      "organizations_url": "https://api.github.com/users/hexoscott/orgs",
      "repos_url": "https://api.github.com/users/hexoscott/repos",
      "events_url": "https://api.github.com/users/hexoscott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hexoscott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-14T12:46:57Z",
    "updated_at": "2022-09-14T12:46:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "@AskAlexSharov I've opened a PR over in erigon-lib which looks promising for helping here https://github.com/ledgerwatch/erigon-lib/pull/639",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1246714347/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1250570719",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5125#issuecomment-1250570719",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5125",
    "id": 1250570719,
    "node_id": "IC_kwDOC0FsAM5KijHf",
    "user": {
      "login": "revitteth",
      "id": 693995,
      "node_id": "MDQ6VXNlcjY5Mzk5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/693995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/revitteth",
      "html_url": "https://github.com/revitteth",
      "followers_url": "https://api.github.com/users/revitteth/followers",
      "following_url": "https://api.github.com/users/revitteth/following{/other_user}",
      "gists_url": "https://api.github.com/users/revitteth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/revitteth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/revitteth/subscriptions",
      "organizations_url": "https://api.github.com/users/revitteth/orgs",
      "repos_url": "https://api.github.com/users/revitteth/repos",
      "events_url": "https://api.github.com/users/revitteth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/revitteth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-19T04:59:22Z",
    "updated_at": "2022-09-19T04:59:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "No longer able to repro after the above fix! Will close and we can reopen if any further problem. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1250570719/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
