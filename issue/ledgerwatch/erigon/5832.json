{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5832",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5832/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5832/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5832/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/5832",
  "id": 1419064031,
  "node_id": "I_kwDOC0FsAM5UlTLf",
  "number": 5832,
  "title": "Polygon - Constant restart when transactions.seg=50%",
  "user": {
    "login": "breezytm",
    "id": 3412923,
    "node_id": "MDQ6VXNlcjM0MTI5MjM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3412923?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/breezytm",
    "html_url": "https://github.com/breezytm",
    "followers_url": "https://api.github.com/users/breezytm/followers",
    "following_url": "https://api.github.com/users/breezytm/following{/other_user}",
    "gists_url": "https://api.github.com/users/breezytm/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/breezytm/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/breezytm/subscriptions",
    "organizations_url": "https://api.github.com/users/breezytm/orgs",
    "repos_url": "https://api.github.com/users/breezytm/repos",
    "events_url": "https://api.github.com/users/breezytm/events{/privacy}",
    "received_events_url": "https://api.github.com/users/breezytm/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2022-10-22T04:05:22Z",
  "updated_at": "2022-10-24T01:33:10Z",
  "closed_at": "2022-10-24T01:33:10Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: `erigon version 2.28.1-stable-9711af6d`\r\n\r\nOS & Version: Linux\r\n\r\nCommit hash : `9711af6d`\r\n\r\n#### Expected behaviour\r\n\r\nSync to the latest block\r\n\r\n#### Actual behaviour\r\n\r\nNode constantly restarting everytime it reaches `transactions.seg=50%`\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\n```\r\n  command:\r\n      - erigon\r\n      - --datadir=/root/.local/share/erigon\r\n      - --chain=bor-mainnet\r\n      - --bor.heimdall=https://heimdall.api.matic.network\r\n      - --port=29539\r\n      - --private.api.addr=0.0.0.0:9090\r\n      - --db.pagesize=16kb\r\n      - --prune=hrtc\r\n      - --torrent.port=29540\r\n      - --torrent.download.rate=1000mb\r\n      - --torrent.download.slots=6\r\n#      - --downloader.verify\r\n      - --batchSize=512M\r\n      - --etl.bufferSize=512M\r\n      - --healthcheck\r\n      - --verbosity=3\r\n      - --http.port=8560\r\n      - --ws\r\n      - --http.api=eth,debug,net,trace,web3,erigon,bor\r\n      - --http.addr=0.0.0.0\r\n      - --http.vhosts=*\r\n      - --http.corsdomain=*\r\n      - --db.read.concurrency=512 \r\n      - --rpc.batch.concurrency=32\r\n```\r\n\r\n#### Backtrace\r\n\r\n````\r\nmatic-node-000  | [INFO] [10-22|03:40:22.618] [index] write                            file=v1-025500-026000-transactions.idx\r\nmatic-node-000  | [INFO] [10-22|03:40:25.102] [index] calculating                      file=v1-016000-016500-transactions.idx\r\nmatic-node-000  | [INFO] [10-22|03:40:40.623] [1/16 Snapshots] Indexing                progress=\"v1-014000-014500-transactions.seg=50%, v1-014500-015000-transactions.seg=50%, v1-015000-015500-transactions.seg=50%, v1-015500-016000-transactions.seg=46%, v1-016500-017000-transactions.seg=50%, v1-016000-016500-transactions.seg=50%, v1-017500-018000-transactions.seg=50%, v1-017000-017500-transactions.seg=49%, v1-018000-018500-transactions.seg=50%, v1-018500-019000-transactions.seg=46%, v1-019000-019500-transactions.seg=46%, v1-019500-020000-transactions.seg=50%, v1-020000-020500-transactions.seg=50%, v1-020500-021000-transactions.seg=50%, v1-021000-021500-transactions.seg=50%, v1-021500-022000-transactions.seg=50%, v1-022000-022500-transactions.seg=50%, v1-022500-023000-transactions.seg=50%, v1-023000-023500-transactions.seg=48%, v1-023500-024000-transactions.seg=50%, v1-024500-025000-transactions.seg=50%, v1-024000-024500-transactions.seg=50%, v1-025000-025500-transactions.seg=50%, v1-025500-026000-transactions.seg=50%, v1-027000-027500-transactions.seg=50%, v1-027500-028000-transactions.seg=50%, v1-026000-026500-transactions.seg=50%, v1-028000-028500-transactions.seg=50%, v1-026500-027000-transactions.seg=50%, v1-028500-029000-transactions.seg=50%\" total-indexing-time=30m40s alloc=52.2GB sys=54.9GB\r\nmatic-node-000  | [INFO] [10-22|03:40:47.665] Build info                               git_branch=stable git_tag=v2021.10.03-2096-g9711af6dd-dirty git_commit=9711af6ddf01f1eb96c9dfb7bf33c5d69e6f648a\r\nmatic-node-000  | [INFO] [10-22|03:40:47.665] Starting Erigon on Bor Mainnet... \r\nmatic-node-000  | [INFO] [10-22|03:40:47.666] Maximum peer count                       ETH=100 total=100\r\nmatic-node-000  | [INFO] [10-22|03:40:47.667] starting HTTP APIs                       APIs=eth,debug,net,trace,web3,erigon,bor\r\nmatic-node-000  | [INFO] [10-22|03:40:47.667] torrent verbosity                        level=WRN\r\nmatic-node-000  | [INFO] [10-22|03:40:49.768] Set global gas cap                       cap=50000000\r\nmatic-node-000  | [INFO] [10-22|03:40:52.137] Opening Database                         label=chaindata path=/root/.local/share/erigon/chaindata\r\nmatic-node-000  | [INFO] [10-22|03:40:52.147] Initialised chain configuration          config=\"{ChainID: 137, Homestead: 0, DAO: <nil>, DAO Support: true, Tangerine Whistle: 0, Spurious Dragon: 0, Byzantium: 0, Constantinople: 0, Petersburg: 0, Istanbul: 3395000, Muir Glacier: 3395000, Berlin: 14750000, London: 23850000, Arrow Glacier: <nil>, Gray Glacier: <nil>, Terminal Total Difficulty: <nil>, Merge Netsplit: <nil>, Shanghai: <nil>, Cancun: <nil>, Engine: bor}\" genesis=0xa9c28ce2141b56c474f1dc504bee9b01eb1bd7d1a507580d5519d4437a97de1b\r\nmatic-node-000  | [INFO] [10-22|03:40:52.147] Effective                                prune_flags=\"--prune.h.older=90000 --prune.r.older=90000 --prune.t.older=90000 --prune.c.older=90000\" snapshot_flags=\"--snapshots=true\" history.v3=false\r\nmatic-node-000  | [INFO] [10-22|03:40:58.253] Initialising Ethereum protocol           network=137\r\nmatic-node-000  | [INFO] [10-22|03:40:58.285] Starting private RPC server              on=0.0.0.0:9090\r\nmatic-node-000  | [INFO] [10-22|03:40:58.285] new subscription to logs established \r\nmatic-node-000  | [INFO] [10-22|03:40:58.285] rpc filters: subscribing to Erigon events \r\nmatic-node-000  | [INFO] [10-22|03:40:58.286] new subscription to newHeaders established \r\nmatic-node-000  | [INFO] [10-22|03:40:58.286] New txs subscriber joined \r\nmatic-node-000  | [INFO] [10-22|03:40:58.286] Reading JWT secret                       path=/root/.local/share/erigon/jwt.hex\r\nmatic-node-000  | [INFO] [10-22|03:40:58.287] HTTP endpoint opened for Engine API      url=localhost:8551 ws=true ws.compression=true\r\nmatic-node-000  | [INFO] [10-22|03:40:58.287] HTTP endpoint opened                     url=0.0.0.0:8560 ws=true ws.compression=true grpc=false\r\nmatic-node-000  | [INFO] [10-22|03:40:58.296] [txpool] Started \r\nmatic-node-000  | [INFO] [10-22|03:40:58.296] [1/16 Snapshots] Fetching torrent files metadata \r\nmatic-node-000  | [INFO] [10-22|03:40:58.304] Started P2P networking                   version=66 self=enode://7b4e715f3a6379e5435a32f86794113f5b1ae5c1fdfc22214e20e9246aadae2e3f4e9c88a1a7b996a6ceac970e8044ca836ef9cf138a80c364d497bd937bd2b9@127.0.0.1:29539 name=erigon/v2.28.1-stable-9711af6d/linux-amd64/go1.19.2\r\n\r\n````\r\n",
  "closed_by": {
    "login": "AskAlexSharov",
    "id": 46885206,
    "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AskAlexSharov",
    "html_url": "https://github.com/AskAlexSharov",
    "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
    "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
    "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
    "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
    "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5832/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5832/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1287607704",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5832#issuecomment-1287607704",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5832",
    "id": 1287607704,
    "node_id": "IC_kwDOC0FsAM5Mv1WY",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-22T04:20:31Z",
    "updated_at": "2022-10-22T04:20:51Z",
    "author_association": "COLLABORATOR",
    "body": "it's oom killer.\r\n fixed by https://github.com/ledgerwatch/erigon/pull/4299\r\nor manually reduce `GOMAXPROCS` env variable",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1287607704/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1287635586",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5832#issuecomment-1287635586",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5832",
    "id": 1287635586,
    "node_id": "IC_kwDOC0FsAM5Mv8KC",
    "user": {
      "login": "breezytm",
      "id": 3412923,
      "node_id": "MDQ6VXNlcjM0MTI5MjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3412923?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/breezytm",
      "html_url": "https://github.com/breezytm",
      "followers_url": "https://api.github.com/users/breezytm/followers",
      "following_url": "https://api.github.com/users/breezytm/following{/other_user}",
      "gists_url": "https://api.github.com/users/breezytm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/breezytm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/breezytm/subscriptions",
      "organizations_url": "https://api.github.com/users/breezytm/orgs",
      "repos_url": "https://api.github.com/users/breezytm/repos",
      "events_url": "https://api.github.com/users/breezytm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/breezytm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-22T05:25:42Z",
    "updated_at": "2022-10-22T05:25:42Z",
    "author_association": "NONE",
    "body": "Thanks for the prompt reply. I will give it a try and report back. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1287635586/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1287897543",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5832#issuecomment-1287897543",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5832",
    "id": 1287897543,
    "node_id": "IC_kwDOC0FsAM5Mw8HH",
    "user": {
      "login": "breezytm",
      "id": 3412923,
      "node_id": "MDQ6VXNlcjM0MTI5MjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3412923?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/breezytm",
      "html_url": "https://github.com/breezytm",
      "followers_url": "https://api.github.com/users/breezytm/followers",
      "following_url": "https://api.github.com/users/breezytm/following{/other_user}",
      "gists_url": "https://api.github.com/users/breezytm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/breezytm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/breezytm/subscriptions",
      "organizations_url": "https://api.github.com/users/breezytm/orgs",
      "repos_url": "https://api.github.com/users/breezytm/repos",
      "events_url": "https://api.github.com/users/breezytm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/breezytm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-22T19:51:06Z",
    "updated_at": "2022-10-22T19:51:06Z",
    "author_association": "NONE",
    "body": "> it's oom killer. fixed by #4299 or manually reduce `GOMAXPROCS` env variable\r\n\r\nIt worked. I set both ``GOMAXPROCS`` and ``GOMELIMIT`` as env variables. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1287897543/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1287937949",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5832#issuecomment-1287937949",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5832",
    "id": 1287937949,
    "node_id": "IC_kwDOC0FsAM5MxF-d",
    "user": {
      "login": "breezytm",
      "id": 3412923,
      "node_id": "MDQ6VXNlcjM0MTI5MjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3412923?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/breezytm",
      "html_url": "https://github.com/breezytm",
      "followers_url": "https://api.github.com/users/breezytm/followers",
      "following_url": "https://api.github.com/users/breezytm/following{/other_user}",
      "gists_url": "https://api.github.com/users/breezytm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/breezytm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/breezytm/subscriptions",
      "organizations_url": "https://api.github.com/users/breezytm/orgs",
      "repos_url": "https://api.github.com/users/breezytm/repos",
      "events_url": "https://api.github.com/users/breezytm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/breezytm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-22T22:41:12Z",
    "updated_at": "2022-10-22T22:41:12Z",
    "author_association": "NONE",
    "body": "Now it's stuck on `No block bodies to write in this log period block `\r\n```\r\n[INFO] [10-22|22:38:41.353] [5/16 Bodies] No block bodies to write in this log period block number=32553015 blk/second=0.000\r\n[INFO] [10-22|22:39:01.353] [5/16 Bodies] Downloading block bodies   block_num=32553015 delivery/sec=329.2KB wasted/sec=0B remaining=2102478 delivered=3530088 alloc=6.4GB sys=54.9GB\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1287937949/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1288287842",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5832#issuecomment-1288287842",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5832",
    "id": 1288287842,
    "node_id": "IC_kwDOC0FsAM5MybZi",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-24T01:33:10Z",
    "updated_at": "2022-10-24T01:33:10Z",
    "author_association": "COLLABORATOR",
    "body": "it's already another thing. and I see you are progressing ` delivery/sec=329.2KB`",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1288287842/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
