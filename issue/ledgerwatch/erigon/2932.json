{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2932",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2932/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2932/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2932/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/2932",
  "id": 1047897474,
  "node_id": "I_kwDOC0FsAM4-daWC",
  "number": 2932,
  "title": "Erigon docker container is restarting when almost synced",
  "user": {
    "login": "halimaster",
    "id": 93947852,
    "node_id": "U_kgDOBZmHzA",
    "avatar_url": "https://avatars.githubusercontent.com/u/93947852?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/halimaster",
    "html_url": "https://github.com/halimaster",
    "followers_url": "https://api.github.com/users/halimaster/followers",
    "following_url": "https://api.github.com/users/halimaster/following{/other_user}",
    "gists_url": "https://api.github.com/users/halimaster/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/halimaster/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/halimaster/subscriptions",
    "organizations_url": "https://api.github.com/users/halimaster/orgs",
    "repos_url": "https://api.github.com/users/halimaster/repos",
    "events_url": "https://api.github.com/users/halimaster/events{/privacy}",
    "received_events_url": "https://api.github.com/users/halimaster/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2021-11-08T20:39:30Z",
  "updated_at": "2022-05-27T04:52:25Z",
  "closed_at": "2022-05-27T04:52:25Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I am having an issue where erigon is restarting everytime it gets up around block 12000000. I am using a docker compose file to deploy erigon and have only changed the data directory. here is what my docker-compose file looks like:\r\n\r\nversion: '2.1'\r\n\r\nservices:\r\n\r\n  erigon:\r\n    container_name: eri1\r\n    image: pocketfoundation/erigon:2021.07.05-alpha\r\n    user: 1000:1000\r\n    restart: unless-stopped\r\n    cpus: '14'\r\n    mem_limit: '30G'\r\n    command: erigon --metrics --metrics.addr=\"0.0.0.0\" --metrics.port=\"6060\" --private.api.addr=\"0.0.0.0:9090\" --pprof --pprof.addr=\"0.0.0.0\" --pprof.port=\"6061\"\r\n    volumes:\r\n      - /home/erigon/.local/share/erigon:/home/erigon/.local/share/erigon\r\n    ports:\r\n      - 30303:30303/tcp\r\n      - 30303:30303/udp\r\n    networks:\r\n      - default\r\n\r\n  rpcdaemon:\r\n    container_name: eri-rpc1\r\n    image: pocketfoundation/erigon:2021.07.05-alpha\r\n    restart: unless-stopped\r\n    cpus: '2'\r\n    mem_limit: '2G'\r\n    command: rpcdaemon --private.api.addr=\"erigon:9090\" --http.addr=\"0.0.0.0\" --http.vhosts=\"*\" --http.corsdomain=\"*\" --http.api=\"eth,debug,net,trace\"\r\n    ports:\r\n      - 8545:8545\r\n    networks:\r\n      - default\r\n\r\nnetworks:\r\n  default:\r\n    external:\r\n      name: nodes\r\n\r\n\r\n\r\nThis is what my docker logs look like when it restarts itself:\r\n\r\n\r\nINFO [11-08|03:26:43.389] Peer 67e0712e786ef7734d63191699a1de9274cf7247ee9c9242ac786c546c5e0388 [Geth/v1.10.8-stable-26675454/linux-amd64/go1.16.4] stable proto=66\r\nINFO [11-08|03:26:49.021] Starting metrics server                  addr=http://0.0.0.0:6060/debug/metrics\r\nINFO [11-08|03:26:49.021] Starting pprof server                    cpu=\"go tool pprof -lines -http=: http://0.0.0.0:6061/debug/pprof/profile?seconds=20\" heap=\"go tool pprof -lines -http=: http://0.0.0.0:6061/debug/pprof/heap\"\r\nINFO [11-08|03:26:49.021] Build info                               git_branch=HEAD git_tag=v2021.07.05 git_commit=3452413fe11b5325b4122652534bc51e7f64e108\r\nINFO [11-08|03:26:49.021] Starting Erigon on Ethereum mainnet... \r\nINFO [11-08|03:26:49.024] Maximum peer count                       ETH=100 total=100\r\nINFO [11-08|03:26:49.024] Set global gas cap                       cap=50000000\r\nINFO [11-08|03:26:49.090] Opening Database                         label=chaindata\r\nmdbx_setup_dxb:14929 filesize mismatch (expect 12884901888b/3145728p, have 309237645312b/75497472p)\r\nINFO [11-08|03:26:49.224] Re-Opening DB in exclusive mode to apply migrations \r\nINFO [11-08|03:26:49.225] database closed (MDBX) \r\nINFO [11-08|03:26:49.231] Apply migration                          name=rebuild_call_trace_index\r\nWARN [11-08|03:26:49.231] Nothing to rebuild, CallTraceSet table is empty \r\nINFO [11-08|03:26:49.231] Applied migration                        name=rebuild_call_trace_index\r\nINFO [11-08|03:26:49.232] Updated DB schema to                     version=3.0.0\r\nINFO [11-08|03:26:49.232] database closed (MDBX) \r\nINFO [11-08|03:26:49.461] Initialised chain configuration          config=\"{ChainID: 1 Homestead: 1150000 DAO: 1920000 DAOSupport: true EIP150: 2463000 EIP155: 2675000 EIP158: 2675000 Byzantium: 4370000 Constantinople: 7280000 Petersburg: 7280000 Istanbul: 9069000, Muir Glacier: 9200000, Berlin: 12244000, London: 12965000, Engine: ethash}\"\r\nINFO [11-08|03:26:49.462] Disk storage enabled for ethash DAGs     dir=/home/erigon/.local/share/erigon/erigon/ethash-dags count=2\r\nINFO [11-08|03:26:49.462] Initialising Ethereum protocol           network=1\r\nINFO [11-08|03:26:49.462] Effective                                prune=\"history=no,receipt=no,txindex=no,calltrace=no,experiments.tevm=disabled\"\r\nINFO [11-08|03:26:49.462] Starting private RPC server              on=0.0.0.0:9090\r\nINFO [11-08|03:26:49.696] event subscription channel established with the RPC daemon \r\nINFO [11-08|03:26:51.001] [1/18 Headers] Waiting for headers...    from=13571983\r\nINFO [11-08|03:26:51.033] Started P2P networking                   version=66    self=enode://6814b75dac486341a06b2581efa1e6929a94f7253f3fa07f584515ce7012f4e9a6d06f81156f73c1ef47ce0255b18adfcbac02b8d46635c83f253a57672cee9d@127.0.0.1:30303 name=erigon/v2021.08.1-alpha-3452413f/linux-amd64/go1.16.5\r\nINFO [11-08|03:26:51.047] Started P2P networking                   version=65    self=enode://6814b75dac486341a06b2581efa1e6929a94f7253f3fa07f584515ce7012f4e9a6d06f81156f73c1ef47ce0255b18adfcbac02b8d46635c83f253a57672cee9d@127.0.0.1:30304 name=erigon/v2021.08.1-alpha-3452413f/linux-amd64/go1.16.5\r\nINFO [11-08|03:27:21.001] [1/18 Headers] Wrote block headers       number=13571983 blk/second=0.000 alloc=85.14MiB sys=217.98MiB\r\n\r\n\r\n\r\nWhat can I do to fix this?\r\n\r\n",
  "closed_by": {
    "login": "AskAlexSharov",
    "id": 46885206,
    "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AskAlexSharov",
    "html_url": "https://github.com/AskAlexSharov",
    "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
    "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
    "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
    "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
    "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2932/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2932/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/963720805",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2932#issuecomment-963720805",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2932",
    "id": 963720805,
    "node_id": "IC_kwDOC0FsAM45cTZl",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-09T01:11:00Z",
    "updated_at": "2021-11-09T01:11:00Z",
    "author_association": "COLLABORATOR",
    "body": "Hi. This logs are “after restart”, we need logs “before restart”. \r\nOr maybe Docker can provide last restart reason. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/963720805/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/963813131",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2932#issuecomment-963813131",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2932",
    "id": 963813131,
    "node_id": "IC_kwDOC0FsAM45cp8L",
    "user": {
      "login": "halimaster",
      "id": 93947852,
      "node_id": "U_kgDOBZmHzA",
      "avatar_url": "https://avatars.githubusercontent.com/u/93947852?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/halimaster",
      "html_url": "https://github.com/halimaster",
      "followers_url": "https://api.github.com/users/halimaster/followers",
      "following_url": "https://api.github.com/users/halimaster/following{/other_user}",
      "gists_url": "https://api.github.com/users/halimaster/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/halimaster/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/halimaster/subscriptions",
      "organizations_url": "https://api.github.com/users/halimaster/orgs",
      "repos_url": "https://api.github.com/users/halimaster/repos",
      "events_url": "https://api.github.com/users/halimaster/events{/privacy}",
      "received_events_url": "https://api.github.com/users/halimaster/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-09T04:44:41Z",
    "updated_at": "2021-11-09T04:46:41Z",
    "author_association": "NONE",
    "body": "Hi Alex, I searched those logs and cant find any sort of error. It seems to\r\nbe just stopping itself and restarting for no apparent reason. Did you see\r\nmy data directory in the docker-compose file? Does that look right to you? Here are more logs before the restart:\r\n\r\n\r\nINFO [11-07|08:39:42.577] [4/18 Bodies] Wrote block bodies         number committed=11334915 delivery /second=42.71KiB   wasted /second=0.00B     alloc=5.20GiB    sys=7.46GiB\r\nINFO [11-07|08:40:25.829] [4/18 Bodies] Wrote block bodies         number committed=11400473 delivery /second=511.41KiB  wasted /second=0.00B     alloc=3.98GiB    sys=7.46GiB\r\nINFO [11-07|08:40:42.577] [4/18 Bodies] Wrote block bodies         number committed=11403602 delivery /second=50.83MiB   wasted /second=0.00B     alloc=2.49GiB    sys=7.46GiB\r\nINFO [11-07|08:41:05.919] [p2p] GoodPeers                          eth66=33 eth65=32\r\nINFO [11-07|08:41:12.584] [4/18 Bodies] Wrote block bodies         number committed=11409683 delivery /second=40.85MiB   wasted /second=138.59KiB alloc=5.72GiB    sys=7.46GiB\r\nINFO [11-07|08:43:05.919] [p2p] GoodPeers                          eth66=33 eth65=32\r\nINFO [11-07|08:44:15.724] [4/18 Bodies] Wrote block bodies         number committed=11441066 delivery /second=10.42MiB   wasted /second=0.00B     alloc=3.84GiB    sys=7.46GiB\r\nINFO [11-07|08:45:05.920] [p2p] GoodPeers                          eth66=33 eth65=32\r\nINFO [11-07|08:45:09.522] Peer dcd07e67bb901886ff52ede771d4bbdfc678d7ae212fc2f64a49e7e8551ab444 [Geth/v1.10.8-stable-26675454/windows-amd64/go1.16.4] disconnected proto=65\r\nINFO [11-07|08:45:15.579] Starting metrics server                  addr=http://0.0.0.0:6060/debug/metrics\r\nINFO [11-07|08:45:15.579] Starting pprof server                    cpu=\"go tool pprof -lines -http=: http://0.0.0.0:6061/debug/pprof/profile?seconds=20\" heap=\"go tool pprof -lines -http=: http://0.0.0.0:6061/debug/pprof/heap\"\r\nINFO [11-07|08:45:15.579] Build info                               git_branch=HEAD git_tag=v2021.07.05 git_commit=3452413fe11b5325b4122652534bc51e7f64e108\r\nINFO [11-07|08:45:15.585] Starting Erigon on Ethereum mainnet... \r\nINFO [11-07|08:45:15.586] Maximum peer count                       ETH=100 total=100\r\nINFO [11-07|08:45:15.586] Set global gas cap                       cap=50000000\r\nINFO [11-07|08:45:15.650] Opening Database                         label=chaindata\r\nmdbx_setup_dxb:14929 filesize mismatch (expect 12884901888b/3145728p, have 227633266688b/55574528p)\r\nINFO [11-07|08:45:18.276] Re-Opening DB in exclusive mode to apply migrations \r\nINFO [11-07|08:45:18.276] database closed (MDBX) \r\nINFO [11-07|08:45:18.287] Apply migration                          name=rebuild_call_trace_index\r\nWARN [11-07|08:45:18.287] Nothing to rebuild, CallTraceSet table is empty \r\nINFO [11-07|08:45:18.288] Applied migration                        name=rebuild_call_trace_index\r\nINFO [11-07|08:45:18.288] Updated DB schema to                     version=3.0.0\r\nINFO [11-07|08:45:18.288] database closed (MDBX) \r\nINFO [11-07|08:45:18.499] Initialised chain configuration          config=\"{ChainID: 1 Homestead: 1150000 DAO: 1920000 DAOSupport: true EIP150: 2463000 EIP155: 2675000 EIP158: 2675000 Byzantium: 4370000 Constantinople: 7280000 Petersburg: 7280000 Istanbul: 9069000, Muir Glacier: 9200000, Berlin: 12244000, London: 12965000, Engine: ethash}\"\r\nINFO [11-07|08:45:18.499] Disk storage enabled for ethash DAGs     dir=/home/erigon/.local/share/erigon/erigon/ethash-dags count=2\r\nINFO [11-07|08:45:18.500] Initialising Ethereum protocol           network=1\r\nINFO [11-07|08:45:18.500] Effective                                prune=\"history=no,receipt=no,txindex=no,calltrace=no,experiments.tevm=disabled\"\r\nINFO [11-07|08:45:18.500] Starting private RPC server              on=0.0.0.0:9090\r\nINFO [11-07|08:45:19.597] event subscription channel established with the RPC daemon \r\nINFO [11-07|08:45:19.990] [1/18 Headers] Waiting for headers...    from=13567505\r\nINFO [11-07|08:45:20.049] Started P2P networking                   version=65    self=enode://6814b75dac486341a06b2581efa1e6929a94f7253f3fa07f584515ce7012f4e9a6d06f81156f73c1ef47ce0255b18adfcbac02b8d46635c83f253a57672cee9d@127.0.0.1:30304 name=erigon/v2021.08.1-alpha-3452413f/linux-amd64/go1.16.5\r\nINFO [11-07|08:45:20.049] Started P2P networking                   version=66    self=enode://6814b75dac486341a06b2581efa1e6929a94f7253f3fa07f584515ce7012f4e9a6d06f81156f73c1ef47ce0255b18adfcbac02b8d46635c83f253a57672cee9d@127.0.0.1:30303 name=erigon/v2021.08.1-alpha-3452413f/linux-amd64/go1.16.5\r\nINFO [11-07|08:45:30.788] [1/18 Headers] Processed                 highest inserted=13568382 age=18s\r\nINFO [11-07|08:45:30.932] [4/18 Bodies] Processing bodies...       from=0        to=13568382\r\nINFO [11-07|08:46:01.188] [4/18 Bodies] Wrote block bodies         number committed=95158 delivery /second=269.27KiB wasted /second=0.00B alloc=207.69MiB sys=622.83MiB\r\nINFO [11-07|08:46:24.044] Peer eeaa2063dcba8b10de88db3ad79f01bf459dcc87104021f2d1be3ea4b911802a [Geth/v1.10.11-stable-7231b3ef/linux-amd64/go1.17.2] stable proto=66\r\n\r\n\r\n\r\n\r\n\r\nThanks\r\n\r\nOn Mon, Nov 8, 2021 at 5:11 PM Alex Sharov ***@***.***> wrote:\r\n\r\n> Hi. This logs are “after restart”, we need logs “before restart”.\r\n> Or maybe Docker can provide last restart reason.\r\n>\r\n> —\r\n> You are receiving this because you authored the thread.\r\n> Reply to this email directly, view it on GitHub\r\n> <https://github.com/ledgerwatch/erigon/issues/2932#issuecomment-963720805>,\r\n> or unsubscribe\r\n> <https://github.com/notifications/unsubscribe-auth/AWMYPTEJWQPS2DFVFR4ORWLULBYK7ANCNFSM5HTTRIVQ>\r\n> .\r\n> Triage notifications on the go with GitHub Mobile for iOS\r\n> <https://apps.apple.com/app/apple-store/id1477376905?ct=notification-email&mt=8&pt=524675>\r\n> or Android\r\n> <https://play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub>.\r\n>\r\n>\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/963813131/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/963929971",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2932#issuecomment-963929971",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2932",
    "id": 963929971,
    "node_id": "IC_kwDOC0FsAM45dGdz",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-09T08:42:36Z",
    "updated_at": "2021-11-09T08:42:36Z",
    "author_association": "COLLABORATOR",
    "body": "1. You can take a look OOM killer log on your host machine\r\n2. Your docker-compose file looks fine",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/963929971/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/963966982",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2932#issuecomment-963966982",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2932",
    "id": 963966982,
    "node_id": "IC_kwDOC0FsAM45dPgG",
    "user": {
      "login": "halimaster",
      "id": 93947852,
      "node_id": "U_kgDOBZmHzA",
      "avatar_url": "https://avatars.githubusercontent.com/u/93947852?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/halimaster",
      "html_url": "https://github.com/halimaster",
      "followers_url": "https://api.github.com/users/halimaster/followers",
      "following_url": "https://api.github.com/users/halimaster/following{/other_user}",
      "gists_url": "https://api.github.com/users/halimaster/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/halimaster/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/halimaster/subscriptions",
      "organizations_url": "https://api.github.com/users/halimaster/orgs",
      "repos_url": "https://api.github.com/users/halimaster/repos",
      "events_url": "https://api.github.com/users/halimaster/events{/privacy}",
      "received_events_url": "https://api.github.com/users/halimaster/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-09T09:27:16Z",
    "updated_at": "2021-11-09T09:28:15Z",
    "author_association": "NONE",
    "body": ">     1. You can take a look OOM killer log on your host machine\r\n> \r\n>     2. Your docker-compose file looks fine\r\n\r\nI see that I am running out of memory. I have plenty of memory (256gb) and nvmes so I dont understand why that would happen. Is there something you might recommend to prevent that from happening? My memory usage besides erigon is very low.\r\n\r\n/var/log/kern.log:Nov  7 01:45:10 poktnodes-M12SWA-TF kernel: [16588.971228] Memory cgroup out of memory: Killed process 13466 (erigon) total-vm:2180818704kB, anon-rss:30189304kB, file-rss:0kB, shmem-rss:0kB, UID:100000 pgtables:83428kB oom_score_adj:0\r\n/var/log/kern.log:Nov  7 04:53:07 poktnodes-M12SWA-TF kernel: [31465.333130] Memory cgroup out of memory: Killed process 17283 (erigon) total-vm:2181313092kB, anon-rss:30701544kB, file-rss:1008kB, shmem-rss:0kB, UID:100000 pgtables:86148kB oom_score_adj:0\r\n/var/log/kern.log:Nov  7 09:11:30 poktnodes-M12SWA-TF kernel: [46968.308256] Memory cgroup out of memory: Killed process 19679 (erigon) total-vm:2181367320kB, anon-rss:30654820kB, file-rss:0kB, shmem-rss:0kB, UID:100000 pgtables:86024kB oom_score_adj:0\r\n/var/log/kern.log:Nov  7 19:26:44 poktnodes-M12SWA-TF kernel: [83881.961055] Memory cgroup out of memory: Killed process 30605 (erigon) total-vm:2181436384kB, anon-rss:30641036kB, file-rss:44984kB, shmem-rss:0kB, UID:100000 pgtables:87440kB oom_score_adj:0\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/963966982/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/964011976",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2932#issuecomment-964011976",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2932",
    "id": 964011976,
    "node_id": "IC_kwDOC0FsAM45dafI",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-09T10:23:07Z",
    "updated_at": "2021-11-09T10:23:07Z",
    "author_association": "COLLABORATOR",
    "body": "- \" I have plenty of memory (256gb) \"  - you also has docker-compose limit: `mem_limit: '30G'`\r\n- usually erigon using not much RAM - maybe we have some bug...\r\n- We print memory usage to logs: `alloc=3.84GiB    sys=7.46GiB` - `sys` it's historical maximum. 8Gb it's quite a lot, but far from 30Gb. So, don't know. \r\n- but your OOM killer says we used 30Gb `anon-rss:30654820kB`\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/964011976/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/969071754",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2932#issuecomment-969071754",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2932",
    "id": 969071754,
    "node_id": "IC_kwDOC0FsAM45wtyK",
    "user": {
      "login": "nextfullstorm",
      "id": 14928699,
      "node_id": "MDQ6VXNlcjE0OTI4Njk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14928699?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nextfullstorm",
      "html_url": "https://github.com/nextfullstorm",
      "followers_url": "https://api.github.com/users/nextfullstorm/followers",
      "following_url": "https://api.github.com/users/nextfullstorm/following{/other_user}",
      "gists_url": "https://api.github.com/users/nextfullstorm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nextfullstorm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nextfullstorm/subscriptions",
      "organizations_url": "https://api.github.com/users/nextfullstorm/orgs",
      "repos_url": "https://api.github.com/users/nextfullstorm/repos",
      "events_url": "https://api.github.com/users/nextfullstorm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nextfullstorm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-15T16:15:39Z",
    "updated_at": "2021-11-15T16:16:34Z",
    "author_association": "NONE",
    "body": "Piggybacking. I have similar issue, but without using docker. I'm running erigon native, no vm, no cloud storage, just 20 core xeon, 32gb ram, 2tb sata ssd, Ubuntu server 18.04. I've tried several last versions. I'm trying to sync ethereum mainnet for about a month already, several attempts and all of them ends with OOM killer. And after each OOM I need to start from wiping datadir, cause db always corrupts (\"MDBX_PAGE_NOTFOUND: Requested page not found\"). And each one attempt takes from several days to week to complete.\r\n\r\nerigon log:\r\n`\r\nINFO[11-15|18:29:13.609] [5/15 Execution] Executed blocks         number=8694287 blk/s=0.013 tx/s=0.318 Mgas/s=0.011 batch=\"394.66 MiB\" alloc=\"10.97 GiB\" sys=\"16.35 GiB\"\r\nINFO[11-15|18:29:21.714] [p2p] GoodPeers                          eth66=1\r\nINFO[11-15|18:29:22.134] [txpool] stat                            block=8650029 pending=10000 baseFee=6583 queued=10000 alloc_mb=11228 sys_mb=16744\r\nINFO[11-15|18:30:27.628] [txpool] stat                            block=8650029 pending=10000 baseFee=6583 queued=10000 alloc_mb=11229 sys_mb=16744\r\nINFO[11-15|18:31:22.196] [p2p] GoodPeers                          eth66=1\r\nINFO[11-15|18:31:23.120] [txpool] stat                            block=8650029 pending=10000 baseFee=6583 queued=10000 alloc_mb=11228 sys_mb=16744\r\nINFO[11-15|18:32:21.794] [txpool] stat                            block=8650029 pending=10000 baseFee=6583 queued=10000 alloc_mb=11228 sys_mb=16744\r\nINFO[11-15|18:32:24.473] [5/15 Execution] Executed blocks         number=8694288 blk/s=0.005 tx/s=0.079 Mgas/s=0.003 batch=\"394.66 MiB\" alloc=\"10.97 GiB\" sys=\"16.35 GiB\"\r\n`\r\n\r\n/var/log/kern.log\r\n`\r\nNov 15 18:50:41 mm-root kernel: [277829.797148] Out of memory: Kill process 17112 (erigon) score 951 or sacrifice child\r\nNov 15 18:50:41 mm-root kernel: [277829.797259] Killed process 17112 (erigon) total-vm:4335538220kB, anon-rss:29830352kB, file-rss:0kB, shmem-rss:0kB\r\nNov 15 18:50:41 mm-root kernel: [277831.589138] oom_reaper: reaped process 17112 (erigon), now anon-rss:0kB, file-rss:0kB, shmem-rss:0kB\r\n`\r\n\r\nI'm running erigon without additional options: `build/bin/erigon --datadir /mnt/2tb/erigon`",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/969071754/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/970048619",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/2932#issuecomment-970048619",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/2932",
    "id": 970048619,
    "node_id": "IC_kwDOC0FsAM450cRr",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-16T08:45:15Z",
    "updated_at": "2021-11-16T08:45:15Z",
    "author_association": "COLLABORATOR",
    "body": "@nextfullstorm if you have error - create github issue. With information enough for us to debug. Erigon has 4 databases - when you just show us part of error `MDBX_PAGE_NOTFOUND` - we can't identify to which db it's related. \r\n\r\nAlso OOM Kill or -9 kill or power outage - doesn't lead to db corruption of Erigon. If it does - then likely you have some specific settings (for example disabled fsync) or broken hardware (we several times saw people had broken RAM - you can try http://memtest86.com to diagnose). \r\n\r\nAbout OOM - yes it's bug of Erigon, but it can't corrupt db. Please issue with more info, logs, etc...\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/970048619/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
