{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5652",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5652/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5652/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5652/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/5652",
  "id": 1400579531,
  "node_id": "I_kwDOC0FsAM5TeyXL",
  "number": 5652,
  "title": "Sync stuck during BSC blockchain pause",
  "user": {
    "login": "immibis",
    "id": 507686,
    "node_id": "MDQ6VXNlcjUwNzY4Ng==",
    "avatar_url": "https://avatars.githubusercontent.com/u/507686?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/immibis",
    "html_url": "https://github.com/immibis",
    "followers_url": "https://api.github.com/users/immibis/followers",
    "following_url": "https://api.github.com/users/immibis/following{/other_user}",
    "gists_url": "https://api.github.com/users/immibis/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/immibis/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/immibis/subscriptions",
    "organizations_url": "https://api.github.com/users/immibis/orgs",
    "repos_url": "https://api.github.com/users/immibis/repos",
    "events_url": "https://api.github.com/users/immibis/events{/privacy}",
    "received_events_url": "https://api.github.com/users/immibis/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2022-10-07T03:46:57Z",
  "updated_at": "2022-10-20T14:42:51Z",
  "closed_at": "2022-10-20T14:42:51Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: erigon version 2022.09.3-stable-32bd69e5  \r\nOS & Version: Linux 5.15.41-gentoo  \r\nCommit hash : 32bd69e5316050005e34448ec6b0165f97173d50\r\n\r\n#### Expected behaviour\r\n\r\nEven though the network is currently not producing blocks, Erigon is still able to sync up to the last block or some point before.\r\n\r\n#### Actual behaviour\r\n\r\nAfter restart during syncing, Erigon does not continue syncing and appears to be waiting for the next block. The last sync-related log message is:\r\n```\r\n[2/16 Headers] Waiting for headers... from=21962149\r\n```\r\n\r\nHowever, the blockchain is stuck at block 2196214**7** until further notice according to [BSCScan](https://bscscan.com/)\r\n\r\nLog sample when starting up in the stuck state:\r\n```\r\nINFO[10-07|05:37:33.429] Reading JWT secret                       path=/mnt/blockchain/bsc/erigon-data/jwt.hex\r\nINFO[10-07|05:37:33.429] HTTP endpoint opened for Engine API      url=localhost:8552 ws=true ws.compression=true\r\nINFO[10-07|05:37:33.429] HTTP endpoint opened                     url=localhost:8546 ws=false ws.compression=true grpc=false\r\nINFO[10-07|05:37:33.434] Started P2P networking                   version=66 self=enode://<censored> name=erigon/v2022.09.3-stable-32bd69e5/linux-amd64/go1.18.2\r\nINFO[10-07|05:37:33.441] [1/16 Snapshots] Fetching torrent files metadata \r\nINFO[10-07|05:37:33.443] [txpool] Started \r\nINFO[10-07|05:37:35.805] [Snapshots] Stat                         blocks=20000k indices=20000k alloc=2.5GB sys=2.7GB\r\nINFO[10-07|05:37:35.805] [2/16 Headers] Waiting for headers...    from=21962149\r\nINFO[10-07|05:38:33.430] [txpool] stat                            block=21962149 pending=1 baseFee=0 queued=209 alloc=2.7GB sys=2.9GB\r\nINFO[10-07|05:39:15.806] Req/resp stats                           req=0 reqMin=0 reqMax=0 skel=17 skelMin=21963685 skelMax=22258405 resp=28 respMin=21962149 respMax=21962149 dups=1\r\nINFO[10-07|05:39:15.806] [Downloader] Queue sizes                 anchors=0 links=0 persisted=65536\r\nINFO[10-07|05:39:33.147] [p2p] GoodPeers                          eth66=23\r\nINFO[10-07|05:39:33.429] [txpool] stat                            block=21962149 pending=1 baseFee=0 queued=209 alloc=2.9GB sys=3.1GB\r\nINFO[10-07|05:39:35.808] Req/resp stats                           req=0 reqMin=0 reqMax=0 skel=16 skelMin=21963685 skelMax=22258405 resp=29 respMin=21962149 respMax=21962149 dups=1\r\nINFO[10-07|05:39:35.808] [Downloader] Queue sizes                 anchors=0 links=0 persisted=65536\r\nINFO[10-07|05:39:55.806] Req/resp stats                           req=0 reqMin=0 reqMax=0 skel=18 skelMin=21963685 skelMax=22258405 resp=36 respMin=0 respMax=21962149 dups=3\r\nINFO[10-07|05:39:55.806] [Downloader] Queue sizes                 anchors=0 links=0 persisted=65536\r\n```\r\n\r\nLog sample after block creation resumed:\r\n\r\n```\r\nINFO[10-07|07:30:15.806] [Downloader] Queue sizes                 anchors=0 links=0 persisted=65536\r\nINFO[10-07|07:30:33.429] [txpool] stat                            block=21962149 pending=1 baseFee=0 queued=209 alloc=2.6GB sys=3.1GB\r\nINFO[10-07|07:30:35.806] Req/resp stats                           req=0 reqMin=0 reqMax=0 skel=17 skelMin=21963685 skelMax=22258405 resp=35 respMin=0 respMax=0 dups=0\r\nINFO[10-07|07:30:35.806] [Downloader] Queue sizes                 anchors=0 links=0 persisted=65536\r\nINFO[10-07|07:30:55.805] Req/resp stats                           req=0 reqMin=0 reqMax=0 skel=16 skelMin=21963685 skelMax=22258405 resp=31 respMin=0 respMax=0 dups=0\r\nINFO[10-07|07:30:55.806] [Downloader] Queue sizes                 anchors=0 links=0 persisted=65536\r\nINFO[10-07|07:31:15.460] [2/16 Headers] Processed                 highest inserted=21962150 age=5s\r\nINFO[10-07|07:31:15.460] [2/16 Headers] DONE                      in=1h53m39.654848836s\r\nINFO[10-07|07:31:15.462] [5/16 Bodies] Processing bodies...       from=20118268 to=21962150\r\nINFO[10-07|07:31:33.147] [p2p] GoodPeers                          eth66=26\r\nINFO[10-07|07:31:33.429] [txpool] stat                            block=21962149 pending=1 baseFee=0 queued=209 alloc=3.2GB sys=3.5GB\r\nINFO[10-07|07:31:35.475] [5/16 Bodies] Wrote block bodies         block_num=20118268 delivery/sec=5.8MB wasted/sec=207.9KB alloc=3.2GB sys=3.6GB\r\nINFO[10-07|07:31:55.462] [5/16 Bodies] Wrote block bodies         block_num=20118268 delivery/sec=8.1MB wasted/sec=1.2MB alloc=3.0GB sys=4.2GB\r\nINFO[10-07|07:32:15.463] [5/16 Bodies] Wrote block bodies         block_num=20118268 delivery/sec=7.8MB wasted/sec=3.5MB alloc=4.2GB sys=4.5GB\r\nINFO[10-07|07:32:33.430] [txpool] stat                            block=21962149 pending=1 baseFee=0 queued=209 alloc=4.7GB sys=5.0GB\r\nINFO[10-07|07:32:35.463] [5/16 Bodies] Wrote block bodies         block_num=20118316 delivery/sec=3.1MB wasted/sec=1.5MB alloc=4.7GB sys=5.0GB\r\nINFO[10-07|07:32:55.463] [5/16 Bodies] Wrote block bodies         block_num=20118362 delivery/sec=2.1MB wasted/sec=739.7KB alloc=5.1GB sys=5.4GB\r\nINFO[10-07|07:33:15.464] [5/16 Bodies] Wrote block bodies         block_num=20118362 delivery/sec=3.0MB wasted/sec=2.0MB alloc=3.3GB sys=5.7GB\r\n```\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\n* Start syncing BSC. Run to stage 5/16 \"Writing block headers\"\r\n* Hack BSC so that all validators stop creating blocks: https://twitter.com/BNBCHAIN/status/1578148078636650496\r\n* Observe that Erigon continues writing block headers.\r\n* Restart Erigon.\r\n* Observe that Erigon does not sync.\r\n\r\nProbably difficult to reproduce after block creation resumes, though it may be possible on a local testnet.\r\n\r\nCommand line:\r\n```\r\nerigon --chain=bsc --datadir=erigon-data --torrent.port=43070 --authrpc.port=8552 --http.port=8546 --port=30304 --private.api.addr=127.0.0.1:9091\r\n```\r\n\r\n\r\n#### Backtrace\r\n\r\nn/a\r\n",
  "closed_by": {
    "login": "revitteth",
    "id": 693995,
    "node_id": "MDQ6VXNlcjY5Mzk5NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/693995?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/revitteth",
    "html_url": "https://github.com/revitteth",
    "followers_url": "https://api.github.com/users/revitteth/followers",
    "following_url": "https://api.github.com/users/revitteth/following{/other_user}",
    "gists_url": "https://api.github.com/users/revitteth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/revitteth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/revitteth/subscriptions",
    "organizations_url": "https://api.github.com/users/revitteth/orgs",
    "repos_url": "https://api.github.com/users/revitteth/repos",
    "events_url": "https://api.github.com/users/revitteth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/revitteth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5652/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5652/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1271156437",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5652#issuecomment-1271156437",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5652",
    "id": 1271156437,
    "node_id": "IC_kwDOC0FsAM5LxE7V",
    "user": {
      "login": "billyadelphia",
      "id": 20699349,
      "node_id": "MDQ6VXNlcjIwNjk5MzQ5",
      "avatar_url": "https://avatars.githubusercontent.com/u/20699349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/billyadelphia",
      "html_url": "https://github.com/billyadelphia",
      "followers_url": "https://api.github.com/users/billyadelphia/followers",
      "following_url": "https://api.github.com/users/billyadelphia/following{/other_user}",
      "gists_url": "https://api.github.com/users/billyadelphia/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/billyadelphia/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/billyadelphia/subscriptions",
      "organizations_url": "https://api.github.com/users/billyadelphia/orgs",
      "repos_url": "https://api.github.com/users/billyadelphia/repos",
      "events_url": "https://api.github.com/users/billyadelphia/events{/privacy}",
      "received_events_url": "https://api.github.com/users/billyadelphia/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-07T06:14:51Z",
    "updated_at": "2022-10-07T06:14:51Z",
    "author_association": "NONE",
    "body": "Erigon need to implement this hardfork https://github.com/bnb-chain/bsc/releases/tag/v1.1.15",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1271156437/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1271185006",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5652#issuecomment-1271185006",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5652",
    "id": 1271185006,
    "node_id": "IC_kwDOC0FsAM5LxL5u",
    "user": {
      "login": "billyadelphia",
      "id": 20699349,
      "node_id": "MDQ6VXNlcjIwNjk5MzQ5",
      "avatar_url": "https://avatars.githubusercontent.com/u/20699349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/billyadelphia",
      "html_url": "https://github.com/billyadelphia",
      "followers_url": "https://api.github.com/users/billyadelphia/followers",
      "following_url": "https://api.github.com/users/billyadelphia/following{/other_user}",
      "gists_url": "https://api.github.com/users/billyadelphia/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/billyadelphia/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/billyadelphia/subscriptions",
      "organizations_url": "https://api.github.com/users/billyadelphia/orgs",
      "repos_url": "https://api.github.com/users/billyadelphia/repos",
      "events_url": "https://api.github.com/users/billyadelphia/events{/privacy}",
      "received_events_url": "https://api.github.com/users/billyadelphia/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-07T06:55:25Z",
    "updated_at": "2022-10-07T06:55:25Z",
    "author_association": "NONE",
    "body": "Using devel branch might solve the issue, trying it now https://github.com/ledgerwatch/erigon/commit/7144b2664ceba77bb0720f49c704f781d67c4942",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1271185006/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1271411182",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5652#issuecomment-1271411182",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5652",
    "id": 1271411182,
    "node_id": "IC_kwDOC0FsAM5LyDHu",
    "user": {
      "login": "binhgo",
      "id": 10021934,
      "node_id": "MDQ6VXNlcjEwMDIxOTM0",
      "avatar_url": "https://avatars.githubusercontent.com/u/10021934?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/binhgo",
      "html_url": "https://github.com/binhgo",
      "followers_url": "https://api.github.com/users/binhgo/followers",
      "following_url": "https://api.github.com/users/binhgo/following{/other_user}",
      "gists_url": "https://api.github.com/users/binhgo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/binhgo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/binhgo/subscriptions",
      "organizations_url": "https://api.github.com/users/binhgo/orgs",
      "repos_url": "https://api.github.com/users/binhgo/repos",
      "events_url": "https://api.github.com/users/binhgo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/binhgo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-07T10:24:31Z",
    "updated_at": "2022-10-07T10:24:31Z",
    "author_association": "NONE",
    "body": "is there any update on this? thanks\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1271411182/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1271462610",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5652#issuecomment-1271462610",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5652",
    "id": 1271462610,
    "node_id": "IC_kwDOC0FsAM5LyPrS",
    "user": {
      "login": "immibis",
      "id": 507686,
      "node_id": "MDQ6VXNlcjUwNzY4Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/507686?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/immibis",
      "html_url": "https://github.com/immibis",
      "followers_url": "https://api.github.com/users/immibis/followers",
      "following_url": "https://api.github.com/users/immibis/following{/other_user}",
      "gists_url": "https://api.github.com/users/immibis/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/immibis/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/immibis/subscriptions",
      "organizations_url": "https://api.github.com/users/immibis/orgs",
      "repos_url": "https://api.github.com/users/immibis/repos",
      "events_url": "https://api.github.com/users/immibis/events{/privacy}",
      "received_events_url": "https://api.github.com/users/immibis/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-07T11:20:22Z",
    "updated_at": "2022-10-07T11:20:22Z",
    "author_association": "NONE",
    "body": "> Erigon need to implement this hardfork https://github.com/bnb-chain/bsc/releases/tag/v1.1.15\r\n\r\nI'm not sure the hardfork is relevant since the sync didn't get up to the hardfork block yet. The bug seems to be that sync doesn't start until a block is produced.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1271462610/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1279827261",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5652#issuecomment-1279827261",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5652",
    "id": 1279827261,
    "node_id": "IC_kwDOC0FsAM5MSJ09",
    "user": {
      "login": "PolarSyncZ",
      "id": 112412239,
      "node_id": "U_kgDOBrNGTw",
      "avatar_url": "https://avatars.githubusercontent.com/u/112412239?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PolarSyncZ",
      "html_url": "https://github.com/PolarSyncZ",
      "followers_url": "https://api.github.com/users/PolarSyncZ/followers",
      "following_url": "https://api.github.com/users/PolarSyncZ/following{/other_user}",
      "gists_url": "https://api.github.com/users/PolarSyncZ/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PolarSyncZ/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PolarSyncZ/subscriptions",
      "organizations_url": "https://api.github.com/users/PolarSyncZ/orgs",
      "repos_url": "https://api.github.com/users/PolarSyncZ/repos",
      "events_url": "https://api.github.com/users/PolarSyncZ/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PolarSyncZ/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-15T20:30:38Z",
    "updated_at": "2022-10-15T20:39:12Z",
    "author_association": "NONE",
    "body": "@immibis  You need to upgrade to 2.28.0 and it will resolve the issue. See https://github.com/ledgerwatch/erigon/issues/5703. The issue is slightly different but the resolution is the same if the upgrade does not work the first time.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1279827261/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1285669672",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5652#issuecomment-1285669672",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5652",
    "id": 1285669672,
    "node_id": "IC_kwDOC0FsAM5MocMo",
    "user": {
      "login": "revitteth",
      "id": 693995,
      "node_id": "MDQ6VXNlcjY5Mzk5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/693995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/revitteth",
      "html_url": "https://github.com/revitteth",
      "followers_url": "https://api.github.com/users/revitteth/followers",
      "following_url": "https://api.github.com/users/revitteth/following{/other_user}",
      "gists_url": "https://api.github.com/users/revitteth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/revitteth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/revitteth/subscriptions",
      "organizations_url": "https://api.github.com/users/revitteth/orgs",
      "repos_url": "https://api.github.com/users/revitteth/repos",
      "events_url": "https://api.github.com/users/revitteth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/revitteth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-20T14:42:50Z",
    "updated_at": "2022-10-20T14:42:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "Should be fixed - let's reopen if not. :) ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1285669672/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
