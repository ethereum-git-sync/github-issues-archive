{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8753",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8753/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8753/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8753/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/8753",
  "id": 1998191142,
  "node_id": "I_kwDOC0FsAM53Gfom",
  "number": 8753,
  "title": "After a transaction is included in a block, the transaction receipt's result is abnormal for a while",
  "user": {
    "login": "sjlee1125",
    "id": 47561537,
    "node_id": "MDQ6VXNlcjQ3NTYxNTM3",
    "avatar_url": "https://avatars.githubusercontent.com/u/47561537?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sjlee1125",
    "html_url": "https://github.com/sjlee1125",
    "followers_url": "https://api.github.com/users/sjlee1125/followers",
    "following_url": "https://api.github.com/users/sjlee1125/following{/other_user}",
    "gists_url": "https://api.github.com/users/sjlee1125/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sjlee1125/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sjlee1125/subscriptions",
    "organizations_url": "https://api.github.com/users/sjlee1125/orgs",
    "repos_url": "https://api.github.com/users/sjlee1125/repos",
    "events_url": "https://api.github.com/users/sjlee1125/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sjlee1125/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-11-17T03:14:03Z",
  "updated_at": "2023-11-21T01:29:45Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: 2.54.0\r\n\r\nOS & Version: Linux\r\n\r\nChain/Network: Goerli\r\n\r\n\r\n#### request body\r\n```\r\n{\r\n    \"jsonrpc\":\"2.0\",\r\n    \"method\":\"eth_getTransactionReceipt\",\r\n    \"params\":[\"0x35ac9cc414d79bbb8ef54d7b1b19802272ce7be63c1f669c2ca4860fe3cc81cb\"],\r\n    \"id\":67\r\n}\r\n```\r\n\r\n#### after transaction is included in a block\r\n```\r\n{\r\n    \"jsonrpc\": \"2.0\",\r\n    \"id\": 1,\r\n    \"result\": {\r\n        \"blockHash\": \"0xe8883bc69a2f8a7d20a1e6f397ef7b734de04809e5385b3bc61af1346a5ac42a\",\r\n        \"blockNumber\": \"0x8357dc\",\r\n        \"contractAddress\": null,\r\n        \"cumulativeGasUsed\": \"0x39192\",\r\n        \"effectiveGasPrice\": \"0x12309ce54000\",\r\n        \"from\": \"0x476fe08696ce89136e48b393652d05cec9f7033f\",\r\n        \"gasUsed\": \"0x39192\",\r\n        \"logs\": [\r\n            {\r\n                \"address\": \"0x4f7a67464b5976d7547c860109e4432d50afb38e\",\r\n                \"topics\": [\r\n                    \"0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\",\r\n                    \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n                    \"0x0000000000000000000000000a9f824c05a74f577a536a8a0c673183a872dff4\"\r\n                ],\r\n                \"data\": \"0x0000000000000000000000000000000000000000000012e84adbddddc93f4480\",\r\n                \"blockNumber\": \"0x8357dc\",\r\n                \"transactionHash\": \"0xd69c94096eafd84c3d19e9423e62691ac130511c4cf7e3296779c5c57477ca50\",\r\n                \"transactionIndex\": \"0x0\",\r\n                \"blockHash\": \"0xe8883bc69a2f8a7d20a1e6f397ef7b734de04809e5385b3bc61af1346a5ac42a\",\r\n                \"logIndex\": \"0x0\",\r\n                \"removed\": false\r\n            },\r\n            {\r\n                \"address\": \"0x4f7a67464b5976d7547c860109e4432d50afb38e\",\r\n                \"topics\": [\r\n                    \"0xe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c\",\r\n                    \"0x0000000000000000000000000a9f824c05a74f577a536a8a0c673183a872dff4\"\r\n                ],\r\n                \"data\": \"0x0000000000000000000000000000000000000000000012e84adbddddc93f4480\",\r\n                \"blockNumber\": \"0x8357dc\",\r\n                \"transactionHash\": \"0xd69c94096eafd84c3d19e9423e62691ac130511c4cf7e3296779c5c57477ca50\",\r\n                \"transactionIndex\": \"0x0\",\r\n                \"blockHash\": \"0xe8883bc69a2f8a7d20a1e6f397ef7b734de04809e5385b3bc61af1346a5ac42a\",\r\n                \"logIndex\": \"0x1\",\r\n                \"removed\": false\r\n            },\r\n            {\r\n                \"address\": \"0x4f7a67464b5976d7547c860109e4432d50afb38e\",\r\n                \"topics\": [\r\n                    \"0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef\",\r\n                    \"0x0000000000000000000000000a9f824c05a74f577a536a8a0c673183a872dff4\",\r\n                    \"0x0000000000000000000000004f7a67464b5976d7547c860109e4432d50afb38e\"\r\n                ],\r\n                \"data\": \"0x0000000000000000000000000000000000000000000012e84adbddddc93f4480\",\r\n                \"blockNumber\": \"0x8357dc\",\r\n                \"transactionHash\": \"0xd69c94096eafd84c3d19e9423e62691ac130511c4cf7e3296779c5c57477ca50\",\r\n                \"transactionIndex\": \"0x0\",\r\n                \"blockHash\": \"0xe8883bc69a2f8a7d20a1e6f397ef7b734de04809e5385b3bc61af1346a5ac42a\",\r\n                \"logIndex\": \"0x2\",\r\n                \"removed\": false\r\n            },\r\n            {\r\n                \"address\": \"0xa658742d33ebd2ce2f0bdff73515aa797fd161d9\",\r\n                \"topics\": [\r\n                    \"0xdf21c415b78ed2552cc9971249e32a053abce6087a0ae0fbf3f78db5174a3493\"\r\n                ],\r\n                \"data\": \"0x000000000000000000000000000000000000000000000005db1ae1e9335307eb\",\r\n                \"blockNumber\": \"0x8357dc\",\r\n                \"transactionHash\": \"0xd69c94096eafd84c3d19e9423e62691ac130511c4cf7e3296779c5c57477ca50\",\r\n                \"transactionIndex\": \"0x0\",\r\n                \"blockHash\": \"0xe8883bc69a2f8a7d20a1e6f397ef7b734de04809e5385b3bc61af1346a5ac42a\",\r\n                \"logIndex\": \"0x3\",\r\n                \"removed\": false\r\n            },\r\n            {\r\n                \"address\": \"0x980205d352f198748b626f6f7c38a8a5663ec981\",\r\n                \"topics\": [\r\n                    \"0xb0c632f55f1e1b3b2c3d82f41ee4716bb4c00f0f5d84cdafc141581bb8757a4f\"\r\n                ],\r\n                \"data\": \"0x00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000002200010000000000000000000000000000000000000000000000000000000000030d40000000000000000000000000000000000000000000000000000000000000\",\r\n                \"blockNumber\": \"0x8357dc\",\r\n                \"transactionHash\": \"0xd69c94096eafd84c3d19e9423e62691ac130511c4cf7e3296779c5c57477ca50\",\r\n                \"transactionIndex\": \"0x0\",\r\n                \"blockHash\": \"0xe8883bc69a2f8a7d20a1e6f397ef7b734de04809e5385b3bc61af1346a5ac42a\",\r\n                \"logIndex\": \"0x4\",\r\n                \"removed\": false\r\n            },\r\n            {\r\n                \"address\": \"0xa6bf2be6c60175601bf88217c75dd4b14abb5fbb\",\r\n                \"topics\": [\r\n                    \"0x4e41ee13e03cd5e0446487b524fdc48af6acf26c074dacdbdfb6b574b42c8146\"\r\n                ],\r\n                \"data\": \"0x00000000000000000000000000000000000000000000000000000000000000650000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000a0000000000000000000000004f7a67464b5976d7547c860109e4432d50afb38e00000000000000000000000000000000000000000000000302c095b7aa47a36c\",\r\n                \"blockNumber\": \"0x8357dc\",\r\n                \"transactionHash\": \"0xd69c94096eafd84c3d19e9423e62691ac130511c4cf7e3296779c5c57477ca50\",\r\n                \"transactionIndex\": \"0x0\",\r\n                \"blockHash\": \"0xe8883bc69a2f8a7d20a1e6f397ef7b734de04809e5385b3bc61af1346a5ac42a\",\r\n                \"logIndex\": \"0x5\",\r\n                \"removed\": false\r\n            },\r\n            {\r\n                \"address\": \"0x980205d352f198748b626f6f7c38a8a5663ec981\",\r\n                \"topics\": [\r\n                    \"0xe9bded5f24a4168e4f3bf44e00298c993b22376aad8c58c7dda9718a54cbea82\"\r\n                ],\r\n                \"data\": \"0x000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000d4000000000000056c009a4f7a67464b5976d7547c860109e4432d50afb38e0065dd69db25f6d620a7bad3023c5d32761d353d3de9000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000012e84adbddddc93f44800000000000000000000000000000000000000000000000000000000000000014476fe08696ce89136e48b393652d05cec9f7033f000000000000000000000000000000000000000000000000\",\r\n                \"blockNumber\": \"0x8357dc\",\r\n                \"transactionHash\": \"0xd69c94096eafd84c3d19e9423e62691ac130511c4cf7e3296779c5c57477ca50\",\r\n                \"transactionIndex\": \"0x0\",\r\n                \"blockHash\": \"0xe8883bc69a2f8a7d20a1e6f397ef7b734de04809e5385b3bc61af1346a5ac42a\",\r\n                \"logIndex\": \"0x6\",\r\n                \"removed\": false\r\n            }\r\n        ],\r\n        \"logsBloom\": \"0x00000000002000080000000000000000000040000040000000000000000000100000000000000000000000000000000000000000000000000000000000000000004000000000000000001008000000000001000000000002000000008000000000040000020000000000000000000800000000000020000000000010000000000000000400000000000000000000000000000001280002000000000000000000000000004000020000000000200000000006000000800100000000040000000000101022000008000000000000000000000000000000000000000000000020001000000000200000000000000000000000000000000000400000000000000000\",\r\n        \"status\": \"0x1\",\r\n        \"to\": \"0x0a9f824c05a74f577a536a8a0c673183a872dff4\",\r\n        \"transactionHash\": \"0x35ac9cc414d79bbb8ef54d7b1b19802272ce7be63c1f669c2ca4860fe3cc81cb\",\r\n        \"transactionIndex\": \"0x0\",\r\n        \"type\": \"0x0\"\r\n    }\r\n}\r\n```\r\n\r\nAs you can see, block's information is from an earlier time, and logs's transactionHash is different from origin transactionHash.\r\nafter a few minute, transaction receipt's result is normal.\r\nThis situation occurs intermittently",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8753/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8753/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1815814020",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8753#issuecomment-1815814020",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8753",
    "id": 1815814020,
    "node_id": "IC_kwDOC0FsAM5sOx-E",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-11-17T06:29:35Z",
    "updated_at": "2023-11-17T06:29:35Z",
    "author_association": "COLLABORATOR",
    "body": "do you have --prune flags? ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1815814020/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1815820388",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8753#issuecomment-1815820388",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8753",
    "id": 1815820388,
    "node_id": "IC_kwDOC0FsAM5sOzhk",
    "user": {
      "login": "sjlee1125",
      "id": 47561537,
      "node_id": "MDQ6VXNlcjQ3NTYxNTM3",
      "avatar_url": "https://avatars.githubusercontent.com/u/47561537?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sjlee1125",
      "html_url": "https://github.com/sjlee1125",
      "followers_url": "https://api.github.com/users/sjlee1125/followers",
      "following_url": "https://api.github.com/users/sjlee1125/following{/other_user}",
      "gists_url": "https://api.github.com/users/sjlee1125/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sjlee1125/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sjlee1125/subscriptions",
      "organizations_url": "https://api.github.com/users/sjlee1125/orgs",
      "repos_url": "https://api.github.com/users/sjlee1125/repos",
      "events_url": "https://api.github.com/users/sjlee1125/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sjlee1125/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-11-17T06:37:56Z",
    "updated_at": "2023-11-17T06:37:56Z",
    "author_association": "NONE",
    "body": "> do you have --prune flags?\r\n\r\nno i don't have.\r\nhere is my command\r\n```\r\n.erigon \\\r\n    --datadir=./data \\\r\n    --chain=goerli \\\r\n    --http.addr=0.0.0.0 \\\r\n    --http.port=8545 \\\r\n    --http.corsdomain=* \\\r\n    --ws \\\r\n    --http.vhosts=* \\\r\n    --http.api=eth,net,trace,web3,erigon,debug \\\r\n    --authrpc.jwtsecret=/home/ubuntu/ethereum/execution/data/jwt.hex \\\r\n    --torrent.download.rate=200mb\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1815820388/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1815825610",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8753#issuecomment-1815825610",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8753",
    "id": 1815825610,
    "node_id": "IC_kwDOC0FsAM5sO0zK",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-11-17T06:44:31Z",
    "updated_at": "2023-11-17T06:44:31Z",
    "author_association": "COLLABORATOR",
    "body": "let's closer look at 1-st txn: \r\n```\r\n\"blockNumber\": \"0x8357dc\",\r\n                \"transactionHash\": \"0xd69c94096eafd84c3d19e9423e62691ac130511c4cf7e3296779c5c57477ca50\",\r\n                \"transactionIndex\": \"0x0\",\r\n                \"blockHash\": \"0xe8883bc69a2f8a7d20a1e6f397ef7b734de04809e5385b3bc61af1346a5ac42a\",\r\n                \"logIndex\": \"0x0\",\r\n```\r\nand it belongs to block https://goerli.etherscan.io/block/8607708\r\nwhich is ok - we also show block: 8607708 0xe8883bc69a2f8a7d20a1e6f397ef7b734de04809e5385b3bc61af1346a5ac42a\r\n\r\ntransaction with this hash - has index(nonce) 164 at etherscan: https://goerli.etherscan.io/tx/0xd69c94096eafd84c3d19e9423e62691ac130511c4cf7e3296779c5c57477ca50 \r\nbut we show index 0\r\n\r\nbut requested transaction is https://goerli.etherscan.io/tx/0x35ac9cc414d79bbb8ef54d7b1b19802272ce7be63c1f669c2ca4860fe3cc81cb\r\nand it's in block 10056729 \r\n\r\nok, somehow we showing data related to very old block\r\n\r\n\r\n@sjlee1125 let's try to fix it next way:\r\n```\r\n#stop erigon\r\nmake integration\r\n./build/bin/integration stage_tx_lookup --reset\r\n./build/bin/integration stage_tx_lookup\r\n#start erigon\r\n```\r\n\r\n\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1815825610/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1820069578",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8753#issuecomment-1820069578",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8753",
    "id": 1820069578,
    "node_id": "IC_kwDOC0FsAM5sfA7K",
    "user": {
      "login": "sjlee1125",
      "id": 47561537,
      "node_id": "MDQ6VXNlcjQ3NTYxNTM3",
      "avatar_url": "https://avatars.githubusercontent.com/u/47561537?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sjlee1125",
      "html_url": "https://github.com/sjlee1125",
      "followers_url": "https://api.github.com/users/sjlee1125/followers",
      "following_url": "https://api.github.com/users/sjlee1125/following{/other_user}",
      "gists_url": "https://api.github.com/users/sjlee1125/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sjlee1125/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sjlee1125/subscriptions",
      "organizations_url": "https://api.github.com/users/sjlee1125/orgs",
      "repos_url": "https://api.github.com/users/sjlee1125/repos",
      "events_url": "https://api.github.com/users/sjlee1125/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sjlee1125/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-11-21T01:29:43Z",
    "updated_at": "2023-11-21T01:29:43Z",
    "author_association": "NONE",
    "body": "> ./build/bin/integration stage_tx_lookup --reset\r\n> ./build/bin/integration stage_tx_lookup\r\n\r\nthanks. I'll try it to my node.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1820069578/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
