{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7440",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7440/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7440/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7440/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/7440",
  "id": 1696205574,
  "node_id": "I_kwDOC0FsAM5lGgsG",
  "number": 7440,
  "title": "Questions about transaction gossiping",
  "user": {
    "login": "pcw109550",
    "id": 29061389,
    "node_id": "MDQ6VXNlcjI5MDYxMzg5",
    "avatar_url": "https://avatars.githubusercontent.com/u/29061389?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pcw109550",
    "html_url": "https://github.com/pcw109550",
    "followers_url": "https://api.github.com/users/pcw109550/followers",
    "following_url": "https://api.github.com/users/pcw109550/following{/other_user}",
    "gists_url": "https://api.github.com/users/pcw109550/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pcw109550/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pcw109550/subscriptions",
    "organizations_url": "https://api.github.com/users/pcw109550/orgs",
    "repos_url": "https://api.github.com/users/pcw109550/repos",
    "events_url": "https://api.github.com/users/pcw109550/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pcw109550/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-05-04T15:03:53Z",
  "updated_at": "2023-05-05T04:30:15Z",
  "closed_at": "2023-05-05T04:30:15Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi. According to the docs: [Transaction Pool Design:Relaying transactions to other network peers](https://github.com/ledgerwatch/erigon/wiki/Transaction-Pool-Design#relaying-transactions-to-other-network-peers),\r\n\r\nIt is noted that tx gossiping between peer is broken:\r\n> Note that this functionality appears to be broken in the current implementation, i.e. pending transactions are not getting relayed.\r\n\r\nI tried to skim through the source, but could not find related code. All I could find was newBlock gossiping(which is disabled after the merge):\r\n\r\nhttps://github.com/ledgerwatch/erigon/blob/30430d585af1b8a98e74ffe890da4426a2585744/turbo/stages/bodydownload/body_algos.go#L207-L208\r\n\r\nMay I ask that is tx gossiping in erigon working? If yes, can I ask a entrypoint of the related code? \r\n\r\nThanks!\r\n\r\nHere are some researches that I did: \r\n\r\nAccording to this [doc: Erigon “The Merge” Architecture](https://hackmd.io/@4_PBxu6jQtO7qASCOn0H6w/SJUyNkuA9),\r\n> Gossip on the EL will be disabled and instead we are going to use the P2P network only for Syncing up to the chain tip. Once on chain tip, the Consensus Layer will be the one telling us what new blocks to validate and what fork to follow so no gossip is required on Erigon.\r\n\r\nSo this means there IS NO gossip at all at erigon execution layer.\r\n\r\nAccording to this [doc: Erigon Blog: Architecture of Erigon - separable and embeddable components](https://erigon.substack.com/p/architecture-of-erigon-separable),\r\n> ETH TxPool uses ETH sentry to download initial set of transactions currently unconfirmed, as well as to receive gossip about new transactions, re-broadcast them, and inject transactions created by users and submitted via ETH RPC api.\r\n\r\nSo this means there IS gossip for transactions. \r\n\r\n",
  "closed_by": {
    "login": "AskAlexSharov",
    "id": 46885206,
    "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AskAlexSharov",
    "html_url": "https://github.com/AskAlexSharov",
    "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
    "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
    "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
    "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
    "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7440/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7440/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1535683126",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/7440#issuecomment-1535683126",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/7440",
    "id": 1535683126,
    "node_id": "IC_kwDOC0FsAM5biKo2",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-05T04:30:15Z",
    "updated_at": "2023-05-05T04:30:15Z",
    "author_association": "COLLABORATOR",
    "body": "I think it's implemented.\r\nYou can find production of such event by `p.newPendingTxs <-`\r\nAnd handling of this event by `announcements := <-newTxs` here https://github.com/ledgerwatch/erigon-lib/blob/main/txpool/pool.go#L1429\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1535683126/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
