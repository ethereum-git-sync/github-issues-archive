{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6987",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6987/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6987/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6987/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/6987",
  "id": 1603397833,
  "node_id": "I_kwDOC0FsAM5fkejJ",
  "number": 6987,
  "title": "Erigon does not start if datadir is specified as a shared folder in vmware",
  "user": {
    "login": "yerazy",
    "id": 126590871,
    "node_id": "U_kgDOB4uflw",
    "avatar_url": "https://avatars.githubusercontent.com/u/126590871?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/yerazy",
    "html_url": "https://github.com/yerazy",
    "followers_url": "https://api.github.com/users/yerazy/followers",
    "following_url": "https://api.github.com/users/yerazy/following{/other_user}",
    "gists_url": "https://api.github.com/users/yerazy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/yerazy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/yerazy/subscriptions",
    "organizations_url": "https://api.github.com/users/yerazy/orgs",
    "repos_url": "https://api.github.com/users/yerazy/repos",
    "events_url": "https://api.github.com/users/yerazy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/yerazy/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4566396003,
      "node_id": "LA_kwDOC0FsAM8AAAABEC2sYw",
      "url": "https://api.github.com/repos/ledgerwatch/erigon/labels/Stale",
      "name": "Stale",
      "color": "ededed",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-02-28T16:29:36Z",
  "updated_at": "2023-04-19T02:23:19Z",
  "closed_at": "2023-04-19T02:23:18Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: erigon version 2.39.0-dev-570ff33e\r\n\r\nOS & Version: Debian 11 5.10.0-21-amd64 on vmware\r\n\r\nCommit hash: \r\n\r\nErigon Command (with flags/config):\r\nerigon --datadir=\"/mnt/hgfs/erigon-linux/\" --chain=mainnet --torrent.download.rate=256mb --log.dir.path=\"/mnt/hgfs/erigon-linux/\" --nat=any --port=30303 --http.port=8545 --authrpc.port=8551 --torrent.port=42069 --private.api.addr=127.0.0.1:9090 --http --ws --http.api=eth,debug,net,trace,web3,erigon\r\n\r\nConcensus Layer:\r\n\r\nConcensus Layer Command (with flags/config):\r\n\r\nChain/Network: \r\n\r\n#### Expected behaviour\r\n\r\n\r\n#### Actual behaviour\r\nThe program does not start.\r\n\r\n#### Steps to reproduce the behaviour\r\nDebian 11 is on vmware with shared folders enabled. The error appears if --datadir is specified as a shared folder in the vmware. A similar error exists in geth, but you could specify --ipcpath there and the error disappeared. (https://github.com/ethereum/go-ethereum/issues/14803) \r\n\r\n#### Backtrace\r\n\r\n\r\n````\r\nt=2023-02-28T10:54:51-0500 lvl=info msg=\"logging to file system\" log dir=/mnt/hgfs/erigon-linux/ file prefix=erigon log level=dbug json=false\r\nt=2023-02-28T10:54:51-0500 lvl=info msg=\"Build info\" git_branch=devel git_tag=v2.31.0-rc.4-596-g570ff33e8 git_commit=570ff33e885c1ada38b4d9a157867acdf560b5fd\r\nt=2023-02-28T10:54:51-0500 lvl=info msg=\"Starting Erigon on Ethereum mainnet...\"\r\nt=2023-02-28T10:54:51-0500 lvl=info msg=\"Maximum peer count\" ETH=100 total=100\r\nt=2023-02-28T10:54:51-0500 lvl=info msg=\"starting HTTP APIs\" APIs=eth,debug,net,trace,web3,erigon\r\nt=2023-02-28T10:54:51-0500 lvl=info msg=\"torrent verbosity\" level=WRN\r\nt=2023-02-28T10:54:53-0500 lvl=info msg=\"Set global gas cap\" cap=50000000\r\nt=2023-02-28T10:54:53-0500 lvl=info msg=\"[Downloader] Runnning with\" ipv6-enabled=true ipv4-enabled=true download.rate=256mb upload.rate=4mb\r\nt=2023-02-28T10:54:53-0500 lvl=info msg=\"Opening Database\" label=chaindata path=/mnt/hgfs/erigon-linux/chaindata\r\nt=2023-02-28T10:54:53-0500 lvl=eror msg=\"Erigon startup\" err=\"mdbx_env_open: input/output error, label: chaindata, trace: [kv_mdbx.go:268 node.go:339 node.go:342 backend.go:206 node.go:113 main.go:62 command.go:273 app.go:332 app.go:309 main.go:37 proc.go:250 asm_amd64.s:1598]\"\r\n[backtrace]\r\n````\r\n",
  "closed_by": {
    "login": "github-actions[bot]",
    "id": 41898282,
    "node_id": "MDM6Qm90NDE4OTgyODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/github-actions%5Bbot%5D",
    "html_url": "https://github.com/apps/github-actions",
    "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6987/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6987/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1448978309",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/6987#issuecomment-1448978309",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6987",
    "id": 1448978309,
    "node_id": "IC_kwDOC0FsAM5WXaeF",
    "user": {
      "login": "keithchew",
      "id": 5557929,
      "node_id": "MDQ6VXNlcjU1NTc5Mjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5557929?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/keithchew",
      "html_url": "https://github.com/keithchew",
      "followers_url": "https://api.github.com/users/keithchew/followers",
      "following_url": "https://api.github.com/users/keithchew/following{/other_user}",
      "gists_url": "https://api.github.com/users/keithchew/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/keithchew/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/keithchew/subscriptions",
      "organizations_url": "https://api.github.com/users/keithchew/orgs",
      "repos_url": "https://api.github.com/users/keithchew/repos",
      "events_url": "https://api.github.com/users/keithchew/events{/privacy}",
      "received_events_url": "https://api.github.com/users/keithchew/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-28T21:57:35Z",
    "updated_at": "2023-02-28T21:58:01Z",
    "author_association": "NONE",
    "body": "Not sure if this helps, but in a windows setup that I have done, we used hyper-v running Ubuntu 20.01 VM. A a separate vhdx was created for the data folder, and mounted in ubuntu as a separate drive, which is used by erigon. Very likely your hgfs shared folder uses the fuse driver which is not playing nice with erigon's mdbx. \r\n\r\nOn a separate note about windows/linux file systems, in previous setups, we did try using windows folders (eg mapped to \r\na docker container folder running Ubuntu) but also faced issues with other apps (eg redis). At the end, we decided to put an additional later between windows and docker via a Ubuntu VM. Not ideal, but it provided the most compatible setup (eg for development and testing) and no surprises when deployed to a bare metal linux server or to the cloud.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1448978309/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1450562371",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/6987#issuecomment-1450562371",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6987",
    "id": 1450562371,
    "node_id": "IC_kwDOC0FsAM5WddND",
    "user": {
      "login": "yerazy",
      "id": 126590871,
      "node_id": "U_kgDOB4uflw",
      "avatar_url": "https://avatars.githubusercontent.com/u/126590871?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yerazy",
      "html_url": "https://github.com/yerazy",
      "followers_url": "https://api.github.com/users/yerazy/followers",
      "following_url": "https://api.github.com/users/yerazy/following{/other_user}",
      "gists_url": "https://api.github.com/users/yerazy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yerazy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yerazy/subscriptions",
      "organizations_url": "https://api.github.com/users/yerazy/orgs",
      "repos_url": "https://api.github.com/users/yerazy/repos",
      "events_url": "https://api.github.com/users/yerazy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yerazy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-01T17:35:59Z",
    "updated_at": "2023-03-01T17:35:59Z",
    "author_association": "NONE",
    "body": "> Not sure if this helps, but in a windows setup that I have done, we used hyper-v running Ubuntu 20.01 VM. A a separate vhdx was created for the data folder, and mounted in ubuntu as a separate drive, which is used by erigon. Very likely your hgfs shared folder uses the fuse driver which is not playing nice with erigon's mdbx.\r\n> \r\n> On a separate note about windows/linux file systems, in previous setups, we did try using windows folders (eg mapped to a docker container folder running Ubuntu) but also faced issues with other apps (eg redis). At the end, we decided to put an additional later between windows and docker via a Ubuntu VM. Not ideal, but it provided the most compatible setup (eg for development and testing) and no surprises when deployed to a bare metal linux server or to the cloud.\r\n\r\nIn the description for erigon, it was indicated that it works with shared folders in WSL 2, so I thought that this could be somehow fixed in vmware. Yes, I used a fuse driver in my vmware. Thanks for the answer, if there are no fixes, then maybe I'll connect the vhdx disk.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1450562371/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1502596020",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/6987#issuecomment-1502596020",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6987",
    "id": 1502596020,
    "node_id": "IC_kwDOC0FsAM5Zj8u0",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-04-11T02:19:05Z",
    "updated_at": "2023-04-11T02:19:05Z",
    "author_association": "NONE",
    "body": "This issue is stale because it has been open for 40 days with no activity. Remove stale label or comment, or this will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1502596020/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1514041970",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/6987#issuecomment-1514041970",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/6987",
    "id": 1514041970,
    "node_id": "IC_kwDOC0FsAM5aPnJy",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-04-19T02:23:17Z",
    "updated_at": "2023-04-19T02:23:17Z",
    "author_association": "NONE",
    "body": "This issue was closed because it has been stalled for 7 days with no activity.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1514041970/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
