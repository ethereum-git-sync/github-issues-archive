{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3200",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3200/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3200/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3200/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/3200",
  "id": 1092670551,
  "node_id": "I_kwDOC0FsAM5BINRX",
  "number": 3200,
  "title": "add application identifier to monitoring metrics option",
  "user": {
    "login": "gMonty030",
    "id": 95750765,
    "node_id": "U_kgDOBbUKbQ",
    "avatar_url": "https://avatars.githubusercontent.com/u/95750765?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gMonty030",
    "html_url": "https://github.com/gMonty030",
    "followers_url": "https://api.github.com/users/gMonty030/followers",
    "following_url": "https://api.github.com/users/gMonty030/following{/other_user}",
    "gists_url": "https://api.github.com/users/gMonty030/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gMonty030/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gMonty030/subscriptions",
    "organizations_url": "https://api.github.com/users/gMonty030/orgs",
    "repos_url": "https://api.github.com/users/gMonty030/repos",
    "events_url": "https://api.github.com/users/gMonty030/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gMonty030/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-01-03T17:03:16Z",
  "updated_at": "2022-01-12T10:04:37Z",
  "closed_at": "2022-01-12T10:04:36Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "# System information\r\nErigon version: erigon version v2021.12.03-beta\r\n\r\n# OS & Version: \r\nlinux/amd64 Linux 5.11.0-1019-aws #20~20.04.1-Ubuntu SMP x86_64 Linux\r\n\r\n# Rationale\r\nWe use a Prometheus instance connected with other applications, which have their own identifier on their metrics functions. This allows to differ them between other functions more generically. \r\n\r\nCould be possible to add a prefix to the metricsÂ¿? (i.e: erigon_get_logs)",
  "closed_by": {
    "login": "gMonty030",
    "id": 95750765,
    "node_id": "U_kgDOBbUKbQ",
    "avatar_url": "https://avatars.githubusercontent.com/u/95750765?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gMonty030",
    "html_url": "https://github.com/gMonty030",
    "followers_url": "https://api.github.com/users/gMonty030/followers",
    "following_url": "https://api.github.com/users/gMonty030/following{/other_user}",
    "gists_url": "https://api.github.com/users/gMonty030/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gMonty030/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gMonty030/subscriptions",
    "organizations_url": "https://api.github.com/users/gMonty030/orgs",
    "repos_url": "https://api.github.com/users/gMonty030/repos",
    "events_url": "https://api.github.com/users/gMonty030/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gMonty030/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3200/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3200/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1005362225",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3200#issuecomment-1005362225",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3200",
    "id": 1005362225,
    "node_id": "IC_kwDOC0FsAM477Jwx",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-05T03:58:36Z",
    "updated_at": "2022-01-05T03:59:37Z",
    "author_association": "COLLABORATOR",
    "body": "This looks as \"hack\" - because prometheus adding `instance` label to all metrics. \r\nFilter by label is more \"generic\" that filter by prefix (with regular expressions?). Example: How you will show metrics of 2 Erigon instances on 1 dashboard if both will have hardcoded prefix \"erigon_\"? \r\n\r\nIn dashboard configuration - can dynamically extract this labels list (from any metric): \r\n<img width=\"969\" alt=\"Screen Shot 2022-01-05 at 10 51 30\" src=\"https://user-images.githubusercontent.com/46885206/148158035-8f9c65ca-d2bf-4482-802e-ed317f3dd855.png\"\r\n\r\nIt will create multi-select filter on board: \r\n<img width=\"1336\" alt=\"Screen Shot 2022-01-05 at 10 52 56\" src=\"https://user-images.githubusercontent.com/46885206/148158200-d71e1323-6fdc-4a59-a6b6-986d319e01c9.png\">\r\n\r\nAnd metrics usage will look as `get_logs{quantile=\"$quantile\",instance=~\"$instance\"}`:\r\n<img width=\"908\" alt=\"Screen Shot 2022-01-05 at 10 56 39\" src=\"https://user-images.githubusercontent.com/46885206/148158401-8ad78ea9-b08e-45ea-8fdf-c4307b3d0386.png\">\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1005362225/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1008720695",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3200#issuecomment-1008720695",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3200",
    "id": 1008720695,
    "node_id": "IC_kwDOC0FsAM48H9s3",
    "user": {
      "login": "gMonty030",
      "id": 95750765,
      "node_id": "U_kgDOBbUKbQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/95750765?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gMonty030",
      "html_url": "https://github.com/gMonty030",
      "followers_url": "https://api.github.com/users/gMonty030/followers",
      "following_url": "https://api.github.com/users/gMonty030/following{/other_user}",
      "gists_url": "https://api.github.com/users/gMonty030/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gMonty030/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gMonty030/subscriptions",
      "organizations_url": "https://api.github.com/users/gMonty030/orgs",
      "repos_url": "https://api.github.com/users/gMonty030/repos",
      "events_url": "https://api.github.com/users/gMonty030/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gMonty030/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-10T10:14:28Z",
    "updated_at": "2022-01-10T12:05:04Z",
    "author_association": "NONE",
    "body": "The main problem is choosing the metrics for an application, and you have to guess which metric own to which application. Because the Prometheus could be used by tones of different applications that their metrics are very similar between them and you have to test if there is no prefix to select them.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1008720695/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1009604425",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3200#issuecomment-1009604425",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3200",
    "id": 1009604425,
    "node_id": "IC_kwDOC0FsAM48LVdJ",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-11T05:09:23Z",
    "updated_at": "2022-01-11T05:09:23Z",
    "author_association": "COLLABORATOR",
    "body": "@gMonty030 still it's a bit not good way to fix Prometheus UX problem. Because for us better have some compatibility with `geth` - if we add prefix - we break all compatibility. There is one more way to handle this - label `job` - which you set when configuring Prometheus's scrape targets:\r\n```\r\n// ./cmd/prometheus/prometheus.yml\r\nscrape_configs:\r\n    - job_name: erigon \r\n```\r\nthen in prometheus you can see all metrics from all instances of erigon \r\n<img width=\"1344\" alt=\"Screen Shot 2022-01-11 at 12 07 24\" src=\"https://user-images.githubusercontent.com/46885206/148884672-a1de6bb1-84e8-46ad-b89d-c8f125da7f63.png\">\r\n ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1009604425/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1010869813",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3200#issuecomment-1010869813",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3200",
    "id": 1010869813,
    "node_id": "IC_kwDOC0FsAM48QKY1",
    "user": {
      "login": "gMonty030",
      "id": 95750765,
      "node_id": "U_kgDOBbUKbQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/95750765?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gMonty030",
      "html_url": "https://github.com/gMonty030",
      "followers_url": "https://api.github.com/users/gMonty030/followers",
      "following_url": "https://api.github.com/users/gMonty030/following{/other_user}",
      "gists_url": "https://api.github.com/users/gMonty030/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gMonty030/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gMonty030/subscriptions",
      "organizations_url": "https://api.github.com/users/gMonty030/orgs",
      "repos_url": "https://api.github.com/users/gMonty030/repos",
      "events_url": "https://api.github.com/users/gMonty030/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gMonty030/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-12T10:04:36Z",
    "updated_at": "2022-01-12T10:04:36Z",
    "author_association": "NONE",
    "body": "This approach could be more than enough. Makes sense after knowing the compatibility concerns. \r\nThanks, I close the issue",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1010869813/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
