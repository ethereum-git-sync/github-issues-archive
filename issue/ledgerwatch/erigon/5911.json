{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/5911",
  "id": 1429310761,
  "node_id": "I_kwDOC0FsAM5VMY0p",
  "number": 5911,
  "title": "2 rpc-like methods have very low performance issues",
  "user": {
    "login": "sundafa",
    "id": 24621599,
    "node_id": "MDQ6VXNlcjI0NjIxNTk5",
    "avatar_url": "https://avatars.githubusercontent.com/u/24621599?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sundafa",
    "html_url": "https://github.com/sundafa",
    "followers_url": "https://api.github.com/users/sundafa/followers",
    "following_url": "https://api.github.com/users/sundafa/following{/other_user}",
    "gists_url": "https://api.github.com/users/sundafa/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sundafa/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sundafa/subscriptions",
    "organizations_url": "https://api.github.com/users/sundafa/orgs",
    "repos_url": "https://api.github.com/users/sundafa/repos",
    "events_url": "https://api.github.com/users/sundafa/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sundafa/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4406003490,
      "node_id": "LA_kwDOC0FsAM8AAAABBp5HIg",
      "url": "https://api.github.com/repos/ledgerwatch/erigon/labels/gateway",
      "name": "gateway",
      "color": "62DB33",
      "default": false,
      "description": "Issue assigned to gateway team"
    },
    {
      "id": 4479226498,
      "node_id": "LA_kwDOC0FsAM8AAAABCvuSgg",
      "url": "https://api.github.com/repos/ledgerwatch/erigon/labels/status:in-progress",
      "name": "status:in-progress",
      "color": "1DDFDF",
      "default": false,
      "description": "Actively being worked on (picked up by developer)"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "hexoscott",
    "id": 70711990,
    "node_id": "MDQ6VXNlcjcwNzExOTkw",
    "avatar_url": "https://avatars.githubusercontent.com/u/70711990?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hexoscott",
    "html_url": "https://github.com/hexoscott",
    "followers_url": "https://api.github.com/users/hexoscott/followers",
    "following_url": "https://api.github.com/users/hexoscott/following{/other_user}",
    "gists_url": "https://api.github.com/users/hexoscott/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hexoscott/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hexoscott/subscriptions",
    "organizations_url": "https://api.github.com/users/hexoscott/orgs",
    "repos_url": "https://api.github.com/users/hexoscott/repos",
    "events_url": "https://api.github.com/users/hexoscott/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hexoscott/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "hexoscott",
      "id": 70711990,
      "node_id": "MDQ6VXNlcjcwNzExOTkw",
      "avatar_url": "https://avatars.githubusercontent.com/u/70711990?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hexoscott",
      "html_url": "https://github.com/hexoscott",
      "followers_url": "https://api.github.com/users/hexoscott/followers",
      "following_url": "https://api.github.com/users/hexoscott/following{/other_user}",
      "gists_url": "https://api.github.com/users/hexoscott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hexoscott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hexoscott/subscriptions",
      "organizations_url": "https://api.github.com/users/hexoscott/orgs",
      "repos_url": "https://api.github.com/users/hexoscott/repos",
      "events_url": "https://api.github.com/users/hexoscott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hexoscott/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 16,
  "created_at": "2022-10-31T06:10:10Z",
  "updated_at": "2023-01-30T14:08:40Z",
  "closed_at": "2023-01-30T14:08:40Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: `./erigon --version`\r\nerigon version 2.28.1-stable-9711af6d\r\n\r\nOS & Version: Windows/Linux/OSX\r\nubuntu 20.04\r\nchain: eth\r\nHetzenr: [AX101](https://www.hetzner.com/dedicated-rootserver/ax101)\r\nCPU: AMD Ryzenâ„¢ 9 5950X \r\n\r\nCommit hash : \r\n\r\n#### Expected behaviour\r\neth_gasPrice\r\neth_estimateGas\r\nThe performance of these two methods is similar to the geth client when using the request\r\n\r\n#### Actual behaviour\r\nTest out qps performance comparison:\r\nerigon\r\neth_gasPrice  4k/s\r\neth_estimateGas  19k/s\r\n\r\ngeth\r\neth_gasPrice  92k/s\r\neth_estimateGas  57k/s\r\n\r\nerigon eth_gasPrice : k6 tool results\r\n![image](https://user-images.githubusercontent.com/24621599/198942352-8ed167f6-4d17-4421-9362-a6c831850ba1.png)\r\n\r\ngeth eth_gasPrice : k6 tool results\r\n![image](https://user-images.githubusercontent.com/24621599/198942364-9705f35d-a4ff-42a0-a452-4b862c4df6f6.png)\r\n\r\n\r\n#### Steps to reproduce the behaviour\r\nUse the stress test tool to perform the same rpc method stress test\r\n\r\n#### Backtrace\r\n\r\n````\r\n[backtrace]\r\n````",
  "closed_by": {
    "login": "revitteth",
    "id": 693995,
    "node_id": "MDQ6VXNlcjY5Mzk5NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/693995?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/revitteth",
    "html_url": "https://github.com/revitteth",
    "followers_url": "https://api.github.com/users/revitteth/followers",
    "following_url": "https://api.github.com/users/revitteth/following{/other_user}",
    "gists_url": "https://api.github.com/users/revitteth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/revitteth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/revitteth/subscriptions",
    "organizations_url": "https://api.github.com/users/revitteth/orgs",
    "repos_url": "https://api.github.com/users/revitteth/repos",
    "events_url": "https://api.github.com/users/revitteth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/revitteth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1296794214",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5911#issuecomment-1296794214",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911",
    "id": 1296794214,
    "node_id": "IC_kwDOC0FsAM5NS4Jm",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-31T09:04:45Z",
    "updated_at": "2022-10-31T09:04:45Z",
    "author_association": "COLLABORATOR",
    "body": "@sundafa , hi. \r\nwhat if you increase Erigon's --db.read.concurrency to 1K or 5K?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1296794214/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1296846074",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5911#issuecomment-1296846074",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911",
    "id": 1296846074,
    "node_id": "IC_kwDOC0FsAM5NTEz6",
    "user": {
      "login": "sundafa",
      "id": 24621599,
      "node_id": "MDQ6VXNlcjI0NjIxNTk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/24621599?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sundafa",
      "html_url": "https://github.com/sundafa",
      "followers_url": "https://api.github.com/users/sundafa/followers",
      "following_url": "https://api.github.com/users/sundafa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sundafa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sundafa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sundafa/subscriptions",
      "organizations_url": "https://api.github.com/users/sundafa/orgs",
      "repos_url": "https://api.github.com/users/sundafa/repos",
      "events_url": "https://api.github.com/users/sundafa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sundafa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-31T09:49:27Z",
    "updated_at": "2022-10-31T09:49:27Z",
    "author_association": "NONE",
    "body": "@AskAlexSharov \r\nHere is my startup command, have changed this value\r\n```\r\n/usr/local/bin/erigon --datadir=/node/full/eth/erigon --chain=mainnet --prune=hrtc --authrpc.jwtsecret=/node/full/eth/erigon/jwt.hex --torrent.upload.rate=500mb -torrent.download.rate=500mb --db.read.concurrency 2000 --rpc.batch.concurrency 10000 --http=true --ws --http.api 'eth,erigon,web3,net,debug,trace,txpool,db,admin,parity' --http.addr 0.0.0.0 --http.vhosts '*' --http.corsdomain '*' --metrics --metrics.addr 0.0.0.0 --port=31300 --torrent.port=31304 --http.port 31301 --private.api.addr='' --authrpc.port=31303 --metrics.port 31305 --authrpc.addr localhost\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1296846074/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1296847437",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5911#issuecomment-1296847437",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911",
    "id": 1296847437,
    "node_id": "IC_kwDOC0FsAM5NTFJN",
    "user": {
      "login": "sundafa",
      "id": 24621599,
      "node_id": "MDQ6VXNlcjI0NjIxNTk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/24621599?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sundafa",
      "html_url": "https://github.com/sundafa",
      "followers_url": "https://api.github.com/users/sundafa/followers",
      "following_url": "https://api.github.com/users/sundafa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sundafa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sundafa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sundafa/subscriptions",
      "organizations_url": "https://api.github.com/users/sundafa/orgs",
      "repos_url": "https://api.github.com/users/sundafa/repos",
      "events_url": "https://api.github.com/users/sundafa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sundafa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-31T09:50:49Z",
    "updated_at": "2022-10-31T09:50:49Z",
    "author_association": "NONE",
    "body": "The qps of other interfaces are all at 80k~90k, only these two interfaces are abnormal",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1296847437/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1299886080",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5911#issuecomment-1299886080",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911",
    "id": 1299886080,
    "node_id": "IC_kwDOC0FsAM5NerAA",
    "user": {
      "login": "hexoscott",
      "id": 70711990,
      "node_id": "MDQ6VXNlcjcwNzExOTkw",
      "avatar_url": "https://avatars.githubusercontent.com/u/70711990?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hexoscott",
      "html_url": "https://github.com/hexoscott",
      "followers_url": "https://api.github.com/users/hexoscott/followers",
      "following_url": "https://api.github.com/users/hexoscott/following{/other_user}",
      "gists_url": "https://api.github.com/users/hexoscott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hexoscott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hexoscott/subscriptions",
      "organizations_url": "https://api.github.com/users/hexoscott/orgs",
      "repos_url": "https://api.github.com/users/hexoscott/repos",
      "events_url": "https://api.github.com/users/hexoscott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hexoscott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-02T09:00:30Z",
    "updated_at": "2022-11-02T09:00:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @sundafa, I'm going to take a look into this.  Could you send me some example calls that you're using in your tests please?  Thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1299886080/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1299897725",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5911#issuecomment-1299897725",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911",
    "id": 1299897725,
    "node_id": "IC_kwDOC0FsAM5Net19",
    "user": {
      "login": "sundafa",
      "id": 24621599,
      "node_id": "MDQ6VXNlcjI0NjIxNTk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/24621599?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sundafa",
      "html_url": "https://github.com/sundafa",
      "followers_url": "https://api.github.com/users/sundafa/followers",
      "following_url": "https://api.github.com/users/sundafa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sundafa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sundafa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sundafa/subscriptions",
      "organizations_url": "https://api.github.com/users/sundafa/orgs",
      "repos_url": "https://api.github.com/users/sundafa/repos",
      "events_url": "https://api.github.com/users/sundafa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sundafa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-02T09:05:19Z",
    "updated_at": "2022-11-02T09:05:44Z",
    "author_association": "NONE",
    "body": "@hexoscott \r\nThis is the k6 script, simplified\r\nAfter modifying the ip and port, run the k6 command `k6 run -u3000 -d30s ./name.js`\r\nname.js\r\n```\r\nimport http from 'k6/http';\r\nimport { check } from 'k6';\r\n\r\nlet url = 'http://IP:PORT';\r\n\r\nexport default function () {\r\n    eth_gasPrice()\r\n    eth_estimateGas()\r\n}\r\n\r\nfunction checkErr(res) {\r\n    check(res, {\r\n        \"status_code_200\": (r) => r.status === 200,\r\n        \"status_code_404\": (r) => r.status === 404,\r\n    })\r\n}\r\n\r\nlet params = {\r\n    headers: {\r\n        'Content-Type': 'application/json',\r\n    },\r\n};\r\n\r\nfunction eth_gasPrice() {\r\n    const payload = JSON.stringify({ 'jsonrpc': '2.0', 'method': 'eth_gasPrice', 'params': [], 'id': 21 });\r\n    const res = http.post(url, payload, params);\r\n    checkErr(res)\r\n}\r\nfunction eth_estimateGas() {\r\n    const payload = JSON.stringify({ 'jsonrpc': '2.0', 'method': 'eth_estimateGas', 'params': [], 'id': 21 });\r\n    const res = http.post(url, payload, params);\r\n    checkErr(res)\r\n}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1299897725/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1299900575",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5911#issuecomment-1299900575",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911",
    "id": 1299900575,
    "node_id": "IC_kwDOC0FsAM5Neuif",
    "user": {
      "login": "hexoscott",
      "id": 70711990,
      "node_id": "MDQ6VXNlcjcwNzExOTkw",
      "avatar_url": "https://avatars.githubusercontent.com/u/70711990?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hexoscott",
      "html_url": "https://github.com/hexoscott",
      "followers_url": "https://api.github.com/users/hexoscott/followers",
      "following_url": "https://api.github.com/users/hexoscott/following{/other_user}",
      "gists_url": "https://api.github.com/users/hexoscott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hexoscott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hexoscott/subscriptions",
      "organizations_url": "https://api.github.com/users/hexoscott/orgs",
      "repos_url": "https://api.github.com/users/hexoscott/repos",
      "events_url": "https://api.github.com/users/hexoscott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hexoscott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-02T09:06:34Z",
    "updated_at": "2022-11-02T09:06:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "Great thanks, will take a look",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1299900575/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1299900613",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5911#issuecomment-1299900613",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911",
    "id": 1299900613,
    "node_id": "IC_kwDOC0FsAM5NeujF",
    "user": {
      "login": "sundafa",
      "id": 24621599,
      "node_id": "MDQ6VXNlcjI0NjIxNTk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/24621599?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sundafa",
      "html_url": "https://github.com/sundafa",
      "followers_url": "https://api.github.com/users/sundafa/followers",
      "following_url": "https://api.github.com/users/sundafa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sundafa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sundafa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sundafa/subscriptions",
      "organizations_url": "https://api.github.com/users/sundafa/orgs",
      "repos_url": "https://api.github.com/users/sundafa/repos",
      "events_url": "https://api.github.com/users/sundafa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sundafa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-02T09:06:34Z",
    "updated_at": "2022-11-02T09:06:34Z",
    "author_association": "NONE",
    "body": "You can use these 2 methods individually, just test one at a time\r\n```\r\n    eth_gasPrice()\r\n   #  eth_estimateGas()\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1299900613/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1299947609",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5911#issuecomment-1299947609",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911",
    "id": 1299947609,
    "node_id": "IC_kwDOC0FsAM5Ne6BZ",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-02T09:41:12Z",
    "updated_at": "2022-11-02T09:41:12Z",
    "author_association": "COLLABORATOR",
    "body": "@hexoscott FYI probably there can use BlocksLRU instead of reading header from db. Because this methods need only recent blocks",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1299947609/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1299951797",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5911#issuecomment-1299951797",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911",
    "id": 1299951797,
    "node_id": "IC_kwDOC0FsAM5Ne7C1",
    "user": {
      "login": "hexoscott",
      "id": 70711990,
      "node_id": "MDQ6VXNlcjcwNzExOTkw",
      "avatar_url": "https://avatars.githubusercontent.com/u/70711990?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hexoscott",
      "html_url": "https://github.com/hexoscott",
      "followers_url": "https://api.github.com/users/hexoscott/followers",
      "following_url": "https://api.github.com/users/hexoscott/following{/other_user}",
      "gists_url": "https://api.github.com/users/hexoscott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hexoscott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hexoscott/subscriptions",
      "organizations_url": "https://api.github.com/users/hexoscott/orgs",
      "repos_url": "https://api.github.com/users/hexoscott/repos",
      "events_url": "https://api.github.com/users/hexoscott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hexoscott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-02T09:44:54Z",
    "updated_at": "2022-11-02T09:44:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "Great advice, thanks!\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1299951797/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1310340817",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5911#issuecomment-1310340817",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911",
    "id": 1310340817,
    "node_id": "IC_kwDOC0FsAM5OGjbR",
    "user": {
      "login": "hexoscott",
      "id": 70711990,
      "node_id": "MDQ6VXNlcjcwNzExOTkw",
      "avatar_url": "https://avatars.githubusercontent.com/u/70711990?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hexoscott",
      "html_url": "https://github.com/hexoscott",
      "followers_url": "https://api.github.com/users/hexoscott/followers",
      "following_url": "https://api.github.com/users/hexoscott/following{/other_user}",
      "gists_url": "https://api.github.com/users/hexoscott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hexoscott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hexoscott/subscriptions",
      "organizations_url": "https://api.github.com/users/hexoscott/orgs",
      "repos_url": "https://api.github.com/users/hexoscott/repos",
      "events_url": "https://api.github.com/users/hexoscott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hexoscott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-10T14:14:41Z",
    "updated_at": "2022-11-10T14:14:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "Two PRs to handle the performance of these calls.  They make some lightweight changes and re-introduce caching for eth_gasPrice to help with performance.  We can take a deeper dive if performance is still an issue here.  \n\nThe eth_estimateGas changes are merged, once #6016 is merged these two calls should be more performant.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1310340817/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1311172900",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5911#issuecomment-1311172900",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911",
    "id": 1311172900,
    "node_id": "IC_kwDOC0FsAM5OJukk",
    "user": {
      "login": "sundafa",
      "id": 24621599,
      "node_id": "MDQ6VXNlcjI0NjIxNTk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/24621599?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sundafa",
      "html_url": "https://github.com/sundafa",
      "followers_url": "https://api.github.com/users/sundafa/followers",
      "following_url": "https://api.github.com/users/sundafa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sundafa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sundafa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sundafa/subscriptions",
      "organizations_url": "https://api.github.com/users/sundafa/orgs",
      "repos_url": "https://api.github.com/users/sundafa/repos",
      "events_url": "https://api.github.com/users/sundafa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sundafa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-11T03:05:08Z",
    "updated_at": "2022-11-11T03:05:08Z",
    "author_association": "NONE",
    "body": "I tested it just now, and now the rqs has not improved much under the v2.29.0 version. I will continue to pay attention to the next version.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1311172900/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1312381728",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5911#issuecomment-1312381728",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911",
    "id": 1312381728,
    "node_id": "IC_kwDOC0FsAM5OOVsg",
    "user": {
      "login": "sundafa",
      "id": 24621599,
      "node_id": "MDQ6VXNlcjI0NjIxNTk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/24621599?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sundafa",
      "html_url": "https://github.com/sundafa",
      "followers_url": "https://api.github.com/users/sundafa/followers",
      "following_url": "https://api.github.com/users/sundafa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sundafa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sundafa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sundafa/subscriptions",
      "organizations_url": "https://api.github.com/users/sundafa/orgs",
      "repos_url": "https://api.github.com/users/sundafa/repos",
      "events_url": "https://api.github.com/users/sundafa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sundafa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-12T06:11:24Z",
    "updated_at": "2022-11-14T01:45:38Z",
    "author_association": "NONE",
    "body": "erigon version: v2.30.0\r\nAfter testing after updating the node just now\r\nThe performance of the RPC method `eth_gasPrice` is greatly improved, the CPU only uses 50% performance, from 4k/s -> 86k/s\r\nThe performance of the RPC method `eth_estimateGas` is not much improved, the cpu uses 100% performance, from 19k/s -> 24k/s\r\n\r\nThanks a lot for your help",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1312381728/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1321896614",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5911#issuecomment-1321896614",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911",
    "id": 1321896614,
    "node_id": "IC_kwDOC0FsAM5Oyoqm",
    "user": {
      "login": "hexoscott",
      "id": 70711990,
      "node_id": "MDQ6VXNlcjcwNzExOTkw",
      "avatar_url": "https://avatars.githubusercontent.com/u/70711990?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hexoscott",
      "html_url": "https://github.com/hexoscott",
      "followers_url": "https://api.github.com/users/hexoscott/followers",
      "following_url": "https://api.github.com/users/hexoscott/following{/other_user}",
      "gists_url": "https://api.github.com/users/hexoscott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hexoscott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hexoscott/subscriptions",
      "organizations_url": "https://api.github.com/users/hexoscott/orgs",
      "repos_url": "https://api.github.com/users/hexoscott/repos",
      "events_url": "https://api.github.com/users/hexoscott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hexoscott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-21T11:18:22Z",
    "updated_at": "2022-11-21T11:18:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @sundafa, thanks for the feedback, how do those stats look with `--db.read.concurrency=5000`?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1321896614/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1328677417",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5911#issuecomment-1328677417",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911",
    "id": 1328677417,
    "node_id": "IC_kwDOC0FsAM5PMgIp",
    "user": {
      "login": "hexoscott",
      "id": 70711990,
      "node_id": "MDQ6VXNlcjcwNzExOTkw",
      "avatar_url": "https://avatars.githubusercontent.com/u/70711990?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hexoscott",
      "html_url": "https://github.com/hexoscott",
      "followers_url": "https://api.github.com/users/hexoscott/followers",
      "following_url": "https://api.github.com/users/hexoscott/following{/other_user}",
      "gists_url": "https://api.github.com/users/hexoscott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hexoscott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hexoscott/subscriptions",
      "organizations_url": "https://api.github.com/users/hexoscott/orgs",
      "repos_url": "https://api.github.com/users/hexoscott/repos",
      "events_url": "https://api.github.com/users/hexoscott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hexoscott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-28T08:00:03Z",
    "updated_at": "2022-11-28T08:00:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @sundafa, some more recent changes have been merged into devel branch if you wanted to check them out.  They should improve gas estimation performance",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1328677417/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1328890839",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5911#issuecomment-1328890839",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911",
    "id": 1328890839,
    "node_id": "IC_kwDOC0FsAM5PNUPX",
    "user": {
      "login": "sundafa",
      "id": 24621599,
      "node_id": "MDQ6VXNlcjI0NjIxNTk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/24621599?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sundafa",
      "html_url": "https://github.com/sundafa",
      "followers_url": "https://api.github.com/users/sundafa/followers",
      "following_url": "https://api.github.com/users/sundafa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sundafa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sundafa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sundafa/subscriptions",
      "organizations_url": "https://api.github.com/users/sundafa/orgs",
      "repos_url": "https://api.github.com/users/sundafa/repos",
      "events_url": "https://api.github.com/users/sundafa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sundafa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-28T11:04:15Z",
    "updated_at": "2022-11-28T11:04:15Z",
    "author_association": "NONE",
    "body": "ok, i'll try that in my free time",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1328890839/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1408689494",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/5911#issuecomment-1408689494",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/5911",
    "id": 1408689494,
    "node_id": "IC_kwDOC0FsAM5T9uVW",
    "user": {
      "login": "revitteth",
      "id": 693995,
      "node_id": "MDQ6VXNlcjY5Mzk5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/693995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/revitteth",
      "html_url": "https://github.com/revitteth",
      "followers_url": "https://api.github.com/users/revitteth/followers",
      "following_url": "https://api.github.com/users/revitteth/following{/other_user}",
      "gists_url": "https://api.github.com/users/revitteth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/revitteth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/revitteth/subscriptions",
      "organizations_url": "https://api.github.com/users/revitteth/orgs",
      "repos_url": "https://api.github.com/users/revitteth/repos",
      "events_url": "https://api.github.com/users/revitteth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/revitteth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-30T14:08:40Z",
    "updated_at": "2023-01-30T14:08:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "Let's reopen this if the issue persists, seems like it is fixed.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1408689494/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
