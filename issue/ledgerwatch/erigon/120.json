{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/120",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/120/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/120/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/120/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/120",
  "id": 508338749,
  "node_id": "MDU6SXNzdWU1MDgzMzg3NDk=",
  "number": 120,
  "title": "Reorganise the way contract codes are stored in the database, and then remove codeHash from hAT bucket",
  "user": {
    "login": "AlexeyAkhunov",
    "id": 13686139,
    "node_id": "MDQ6VXNlcjEzNjg2MTM5",
    "avatar_url": "https://avatars.githubusercontent.com/u/13686139?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AlexeyAkhunov",
    "html_url": "https://github.com/AlexeyAkhunov",
    "followers_url": "https://api.github.com/users/AlexeyAkhunov/followers",
    "following_url": "https://api.github.com/users/AlexeyAkhunov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AlexeyAkhunov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AlexeyAkhunov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AlexeyAkhunov/subscriptions",
    "organizations_url": "https://api.github.com/users/AlexeyAkhunov/orgs",
    "repos_url": "https://api.github.com/users/AlexeyAkhunov/repos",
    "events_url": "https://api.github.com/users/AlexeyAkhunov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AlexeyAkhunov/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "b00ris",
    "id": 4943570,
    "node_id": "MDQ6VXNlcjQ5NDM1NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4943570?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/b00ris",
    "html_url": "https://github.com/b00ris",
    "followers_url": "https://api.github.com/users/b00ris/followers",
    "following_url": "https://api.github.com/users/b00ris/following{/other_user}",
    "gists_url": "https://api.github.com/users/b00ris/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/b00ris/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/b00ris/subscriptions",
    "organizations_url": "https://api.github.com/users/b00ris/orgs",
    "repos_url": "https://api.github.com/users/b00ris/repos",
    "events_url": "https://api.github.com/users/b00ris/events{/privacy}",
    "received_events_url": "https://api.github.com/users/b00ris/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "b00ris",
      "id": 4943570,
      "node_id": "MDQ6VXNlcjQ5NDM1NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4943570?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/b00ris",
      "html_url": "https://github.com/b00ris",
      "followers_url": "https://api.github.com/users/b00ris/followers",
      "following_url": "https://api.github.com/users/b00ris/following{/other_user}",
      "gists_url": "https://api.github.com/users/b00ris/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/b00ris/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/b00ris/subscriptions",
      "organizations_url": "https://api.github.com/users/b00ris/orgs",
      "repos_url": "https://api.github.com/users/b00ris/repos",
      "events_url": "https://api.github.com/users/b00ris/events{/privacy}",
      "received_events_url": "https://api.github.com/users/b00ris/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2019-10-17T09:07:23Z",
  "updated_at": "2022-03-19T08:20:25Z",
  "closed_at": "2019-12-20T12:25:41Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Presently, the contract codes are stored in the bucket `CODE`, and it is a simple mapping of code hashes to bytecodes. We would like to change that to a mapping of a composite key `contractAddrHash | incarnation` to the bytecode. That would allow us to remove codeHash component from the `hAT` bucket (which is the history of state of accounts), therefore reducing the size of the bucket and write I/O to maintain it. It will also allow extension of pruning to contract codes.\r\n\r\nThe downside might be potential code duplication. If such downside to be avoided, we can use the indirect mapping `contractAddrHash | incarcation` to the code hash, and then add some kind of reference counter to the existing mapping of codeHash to bytecode (to be able to remove it when all the contracts using such bytecode have been pruned).\r\n",
  "closed_by": {
    "login": "b00ris",
    "id": 4943570,
    "node_id": "MDQ6VXNlcjQ5NDM1NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4943570?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/b00ris",
    "html_url": "https://github.com/b00ris",
    "followers_url": "https://api.github.com/users/b00ris/followers",
    "following_url": "https://api.github.com/users/b00ris/following{/other_user}",
    "gists_url": "https://api.github.com/users/b00ris/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/b00ris/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/b00ris/subscriptions",
    "organizations_url": "https://api.github.com/users/b00ris/orgs",
    "repos_url": "https://api.github.com/users/b00ris/repos",
    "events_url": "https://api.github.com/users/b00ris/events{/privacy}",
    "received_events_url": "https://api.github.com/users/b00ris/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/120/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/120/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[

]
