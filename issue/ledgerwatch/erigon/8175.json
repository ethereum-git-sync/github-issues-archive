{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8175",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8175/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8175/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8175/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/8175",
  "id": 1891046927,
  "node_id": "I_kwDOC0FsAM5wtxYP",
  "number": 8175,
  "title": "Stuck at block 17794000 err=\"[14/15 TxLookup] txnLookupTransform: transform: empty block body 17794000, hash 4317aab509039cadb9acdd5d68e28372a7c2866d50299bc809c69b16d3b36a38\"",
  "user": {
    "login": "chenzongxiong",
    "id": 8354165,
    "node_id": "MDQ6VXNlcjgzNTQxNjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8354165?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chenzongxiong",
    "html_url": "https://github.com/chenzongxiong",
    "followers_url": "https://api.github.com/users/chenzongxiong/followers",
    "following_url": "https://api.github.com/users/chenzongxiong/following{/other_user}",
    "gists_url": "https://api.github.com/users/chenzongxiong/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chenzongxiong/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chenzongxiong/subscriptions",
    "organizations_url": "https://api.github.com/users/chenzongxiong/orgs",
    "repos_url": "https://api.github.com/users/chenzongxiong/repos",
    "events_url": "https://api.github.com/users/chenzongxiong/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chenzongxiong/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-09-11T18:35:06Z",
  "updated_at": "2023-09-12T13:14:28Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version:  `erigon version 2.48.0-stable`\r\n\r\nOS & Version: Ubuntu 22.04\r\n\r\nCommit hash: \r\n\r\nErigon Command (with flags/config):\r\n\r\n```\r\nARG=\" --chain mainnet --datadir /var/lib/erigon --torrent.download.rate 1024mb --metrics --metrics.addr 0.0.0.0 --ws --http.corsdomain * --http.addr 127.0.0.1 --http.port 8545 --http.api eth,erigon,ots,debug,net,trace --db.pagesize 16kb --batchSize 2048MB --rpc.returndata.limit 1000000 --maxpeers 20 --verbosity debug --log.console.verbosity debug --internalcl --graphql\"\r\n```\r\nConcensus Layer: Embedded concensus layer\r\n\r\nConcensus Layer Command (with flags/config): ergion --internalcl\r\n\r\nChain/Network: mainnet\r\n\r\n#### Expected behaviour \r\nSync to latest block correctly. \r\n\r\n#### Actual behaviour\r\nStucking at block 17794000\r\n\r\n#### Steps to reproduce the behaviour\r\n\r\n\r\n#### Backtrace\r\n```\r\nSep 11 20:35:58 Ubuntu-2204-jammy-amd64-base erigon[36218]: [DBUG] [09-11|20:35:58.723] [txpool.fetch] Handling incoming message msg=NEW_POOLED_TRANSACTION_HASHES_68 err=\"parsing NewPooledTransactionHashes88: rlp parse: integer encoding for RLP must not have leading zeros: 000000b6\"\r\nSep 11 20:35:58 Ubuntu-2204-jammy-amd64-base erigon[36218]: [DBUG] [09-11|20:35:58.880] Error while executing stage              err=\"[14/15 TxLookup] txnLookupTransform: transform: empty block body 17794000, hash 4317aab509039cadb9acdd5d68e28372a7c2866d50299bc809c69b16d3b36a38\"\r\nSep 11 20:35:58 Ubuntu-2204-jammy-amd64-base erigon[36218]: [EROR] [09-11|20:35:58.880] Staged Sync                              err=\"[14/15 TxLookup] txnLookupTransform: transform: empty block body 17794000, hash 4317aab509039cadb9acdd5d68e28372a7c2866d50299bc809c69b16d3b36a38\"\r\nSep 11 20:35:59 Ubuntu-2204-jammy-amd64-base erigon[36218]: [DBUG] [09-11|20:35:59.381] Error while executing stage              err=\"[14/15 TxLookup] txnLookupTransform: transform: empty block body 17794000, hash 4317aab509039cadb9acdd5d68e28372a7c2866d50299bc809c69b16d3b36a38\"\r\nSep 11 20:35:59 Ubuntu-2204-jammy-amd64-base erigon[36218]: [EROR] [09-11|20:35:59.381] Staged Sync                              err=\"[14/15 TxLookup] txnLookupTransform: transform: empty block body 17794000, hash 4317aab509039cadb9acdd5d68e28372a7c2866d50299bc809c69b16d3b36a38\"\r\nSep 11 20:35:59 Ubuntu-2204-jammy-amd64-base erigon[36218]: [DBUG] [09-11|20:35:59.421] [txpool.fetch] Handling incoming message msg=NEW_POOLED_TRANSACTION_HASHES_68 err=\"parsing NewPooledTransactionHashes88: rlp parse: integer encoding for RLP must not have leading zeros: 000000b8\"\r\nSep 11 20:35:59 Ubuntu-2204-jammy-amd64-base erigon[36218]: [DBUG] [09-11|20:35:59.882] Error while executing stage              err=\"[14/15 TxLookup] txnLookupTransform: transform: empty block body 17794000, hash 4317aab509039cadb9acdd5d68e28372a7c2866d50299bc809c69b16d3b36a38\"\r\nSep 11 20:35:59 Ubuntu-2204-jammy-amd64-base erigon[36218]: [EROR] [09-11|20:35:59.882] Staged Sync                              err=\"[14/15 TxLookup] txnLookupTransform: transform: empty block body 17794000, hash 4317aab509039cadb9acdd5d68e28372a7c2866d50299bc809c69b16d3b36a38\"\r\nSep 11 20:36:00 Ubuntu-2204-jammy-amd64-base erigon[36218]: [DBUG] [09-11|20:36:00.179] Received block via gossip                peers=30 slot=7302778 alloc/sys=6.6GB/10.0GB numGC=74\r\nSep 11 20:36:00 Ubuntu-2204-jammy-amd64-base erigon[36218]: [DBUG] [09-11|20:36:00.215] [NewPayload] Downloading some other PoS blocks hash=0x5b0df973a804bd9d8d10a7cecdd825663ddc3826fa11942f36a27fc6e68943c2\r\nSep 11 20:36:00 Ubuntu-2204-jammy-amd64-base erigon[36218]: [DBUG] [09-11|20:36:00.249] [ForkChoiceUpdated] Downloading some other PoS stuff hash=0x5b0df973a804bd9d8d10a7cecdd825663ddc3826fa11942f36a27fc6e68943c2\r\nSep 11 20:36:00 Ubuntu-2204-jammy-amd64-base erigon[36218]: [DBUG] [09-11|20:36:00.249] New gossip block imported                slot=7302778 head=7302778 headRoot=0xf7a4d34d1e93a21bfd8b4eda31f86f98d21fa9b5df1ca65227098229e3bcb6f1\r\nSep 11 20:36:00 Ubuntu-2204-jammy-amd64-base erigon[36218]: [DBUG] [09-11|20:36:00.383] Error while executing stage              err=\"[14/15 TxLookup] txnLookupTransform: transform: empty block body 17794000, hash 4317aab509039cadb9acdd5d68e28372a7c2866d50299bc809c69b16d3b36a38\"\r\nSep 11 20:36:00 Ubuntu-2204-jammy-amd64-base erigon[36218]: [EROR] [09-11|20:36:00.383] Staged Sync                              err=\"[14/15 TxLookup] txnLookupTransform: transform: empty block body 17794000, hash 4317aab509039cadb9acdd5d68e28372a7c2866d50299bc809c69b16d3b36a38\"\r\n```\r\n\r\n\r\n#### print_stages\r\n```\r\nroot@Ubuntu-2204-jammy-amd64-base ~ # ./erigon-src/build/bin/integration print_stages --chain mainnet --datadir /var/lib/erigon\r\nINFO[09-11|20:37:28.381] logging to file system                   log dir=/var/lib/erigon/logs file prefix=integration log level=info json=false\r\nINFO[09-11|20:37:29.602] [snapshots] Blocks Stat                  blocks=17794k indices=17794k alloc=2.2GB sys=2.4GB\r\nINFO[09-11|20:37:29.602] [bor snapshots] Blocks Stat              blocks=0k indices=0k alloc=2.2GB sys=2.4GB\r\nNote: prune_at doesn't mean 'all data before were deleted' - it just mean stage.Prune function were run to this block. Because 1 stage may prune multiple data types to different prune distance.\r\n\r\n \t\t\t\t stage_at \t prune_at\r\nSnapshots \t\t\t 17793999 \t 0\r\nHeaders \t\t\t 17793999 \t 0\r\nBorHeimdall \t\t\t 0 \t\t 0\r\nBlockHashes \t\t\t 17793999 \t 0\r\nBodies \t\t\t\t 17793999 \t 0\r\nSenders \t\t\t 17793999 \t 0\r\nExecution \t\t\t 18114026 \t 18114026\r\nTranslation \t\t\t 0 \t\t 0\r\nHashState \t\t\t 18114026 \t 0\r\nIntermediateHashes \t\t 18114026 \t 18114026\r\nAccountHistoryIndex \t\t 18114026 \t 0\r\nStorageHistoryIndex \t\t 18114026 \t 0\r\nLogIndex \t\t\t 18114026 \t 0\r\nCallTraces \t\t\t 18114026 \t 18114026\r\nTxLookup \t\t\t 0 \t\t 0\r\nFinish \t\t\t\t 18114026 \t 0\r\n--\r\nprune distance:\r\n\r\nblocks.v2: blocks=17793999, segments=17793999, indices=17793999\r\n\r\nhistory.v3: false,  idx steps: 0.00, lastMaxTxNum=0->0, lastBlockInSnap=0\r\n\r\nsequence: EthTx=2080746054, NonCanonicalTx=0\r\n\r\nin db: first header 0, last header 0, first body 0, last body 0\r\n--\r\n```\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8175/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8175/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1714925994",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8175#issuecomment-1714925994",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8175",
    "id": 1714925994,
    "node_id": "IC_kwDOC0FsAM5mN7Gq",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-12T04:00:40Z",
    "updated_at": "2023-09-12T04:00:40Z",
    "author_association": "COLLABORATOR",
    "body": "can you try branch `v_2.48.0_empty_body`? ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1714925994/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1715703980",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8175#issuecomment-1715703980",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8175",
    "id": 1715703980,
    "node_id": "IC_kwDOC0FsAM5mQ5Cs",
    "user": {
      "login": "chenzongxiong",
      "id": 8354165,
      "node_id": "MDQ6VXNlcjgzNTQxNjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8354165?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chenzongxiong",
      "html_url": "https://github.com/chenzongxiong",
      "followers_url": "https://api.github.com/users/chenzongxiong/followers",
      "following_url": "https://api.github.com/users/chenzongxiong/following{/other_user}",
      "gists_url": "https://api.github.com/users/chenzongxiong/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chenzongxiong/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chenzongxiong/subscriptions",
      "organizations_url": "https://api.github.com/users/chenzongxiong/orgs",
      "repos_url": "https://api.github.com/users/chenzongxiong/repos",
      "events_url": "https://api.github.com/users/chenzongxiong/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chenzongxiong/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-12T13:14:27Z",
    "updated_at": "2023-09-12T13:14:27Z",
    "author_association": "NONE",
    "body": "After applying version `v_2.48.0_empty_body`,  the error is gone. \r\n\r\nAnd the stages info are \r\n```\r\nroot@Ubuntu-2204-jammy-amd64-base ~ # ./erigon-src/build/bin/integration print_stages --chain mainnet --datadir /var/lib/erigon\r\nINFO[09-12|15:09:34.522] logging to file system                   log dir=/var/lib/erigon/logs file prefix=integration log level=info json=false\r\nINFO[09-12|15:09:37.234] [snapshots] Blocks Stat                  blocks=9500k indices=9500k alloc=2.2GB sys=2.4GB\r\nNote: prune_at doesn't mean 'all data before were deleted' - it just mean stage.Prune function were run to this block. Because 1 stage may prune multiple data types to different prune distance.\r\n\r\n \t\t\t\t stage_at \t prune_at\r\nSnapshots \t\t\t 18120431 \t 0\r\nHeaders \t\t\t 18120432 \t 0\r\nBlockHashes \t\t\t 18120432 \t 0\r\nBodies \t\t\t\t 18120432 \t 0\r\nSenders \t\t\t 18120432 \t 0\r\nExecution \t\t\t 18120432 \t 18120432\r\nTranslation \t\t\t 0 \t\t 0\r\nHashState \t\t\t 18120432 \t 0\r\nIntermediateHashes \t\t 18120432 \t 18120432\r\nAccountHistoryIndex \t\t 18120432 \t 0\r\nStorageHistoryIndex \t\t 18120432 \t 0\r\nLogIndex \t\t\t 18120432 \t 0\r\nCallTraces \t\t\t 18120432 \t 18120432\r\nTxLookup \t\t\t 18120432 \t 17794000\r\nFinish \t\t\t\t 18120432 \t 0\r\n--\r\nprune distance:\r\n\r\nblocks.v2: blocks=9499999, segments=17793999, indices=9499999\r\n\r\nhistory.v3: false,  idx steps: 0.00, lastMaxTxNum=0->0, lastBlockInSnap=0\r\n\r\nsequence: EthTx=2128027564, NonCanonicalTx=0\r\n\r\nin db: first header 17795000, last header 18120432, first body 17794000, last body 18120432\r\n--\r\n```\r\n\r\nThe logs from erigon process is listed as follows\r\n\r\n```\r\nSep 12 15:05:09 Ubuntu-2204-jammy-amd64-base erigon[55691]: [DBUG] [09-12|15:05:09.889] [txpool.fetch] Handling incoming message msg=POOLED_TRANSACTIONS_66 err=\"rlp parse transaction: unknown transaction type: 23\"\r\nSep 12 15:05:09 Ubuntu-2204-jammy-amd64-base erigon[55691]: [DBUG] [09-12|15:05:09.915] [txpool.fetch] Handling incoming message msg=NEW_POOLED_TRANSACTION_HASHES_68 err=\"parsing NewPooledTransactionHashes88: rlp parse: integer encoding for RLP must not have leading zeros: 00000301\"\r\nSep 12 15:05:10 Ubuntu-2204-jammy-amd64-base erigon[55691]: [DBUG] [09-12|15:05:10.152] [txpool.fetch] Handling incoming message msg=NEW_POOLED_TRANSACTION_HASHES_68 err=\"parsing NewPooledTransactionHashes88: rlp parse: integer encoding for RLP must not have leading zeros: 000000ac\"\r\nSep 12 15:05:10 Ubuntu-2204-jammy-amd64-base erigon[55691]: [DBUG] [09-12|15:05:10.193] [txpool.fetch] Handling incoming message msg=POOLED_TRANSACTIONS_66 err=\"rlp parse transaction: unknown transaction type: 23\"\r\nSep 12 15:05:10 Ubuntu-2204-jammy-amd64-base erigon[55691]: [DBUG] [09-12|15:05:10.256] [txpool.fetch] Handling incoming message msg=NEW_POOLED_TRANSACTION_HASHES_68 err=\"parsing NewPooledTransactionHashes88: rlp parse: integer encoding for RLP must not have leading zeros: 000003fb\"\r\nSep 12 15:05:10 Ubuntu-2204-jammy-amd64-base erigon[55691]: [DBUG] [09-12|15:05:10.334] [txpool.fetch] Handling incoming message msg=TRANSACTIONS_66 err=\"rlp parse transaction: unknown transaction type: 23\"\r\nSep 12 15:05:10 Ubuntu-2204-jammy-amd64-base erigon[55691]: [DBUG] [09-12|15:05:10.424] [txpool.fetch] Handling incoming message msg=POOLED_TRANSACTIONS_66 err=\"rlp parse transaction: unknown transaction type: 23\"\r\nSep 12 15:05:10 Ubuntu-2204-jammy-amd64-base erigon[55691]: [DBUG] [09-12|15:05:10.460] [txpool.fetch] Handling incoming message msg=NEW_POOLED_TRANSACTION_HASHES_68 err=\"parsing NewPooledTransactionHashes88: rlp parse: integer encoding for RLP must not have leading zeros: 000002f9\"\r\nSep 12 15:05:10 Ubuntu-2204-jammy-amd64-base erigon[55691]: [DBUG] [09-12|15:05:10.481] [txpool.fetch] Handling incoming message msg=NEW_POOLED_TRANSACTION_HASHES_68 err=\"parsing NewPooledTransactionHashes88: rlp parse: integer encoding for RLP must not have leading zeros: 000000b9\"\r\nSep 12 15:05:10 Ubuntu-2204-jammy-amd64-base erigon[55691]: [DBUG] [09-12|15:05:10.493] [txpool.fetch] Handling incoming message msg=POOLED_TRANSACTIONS_66 err=\"rlp parse transaction: unknown transaction type: 23\"\r\nSep 12 15:05:10 Ubuntu-2204-jammy-amd64-base erigon[55691]: [DBUG] [09-12|15:05:10.550] [txpool.fetch] Handling incoming message msg=NEW_POOLED_TRANSACTION_HASHES_68 err=\"parsing NewPooledTransactionHashes88: rlp parse: integer encoding for RLP must not have leading zeros: 00000078\"\r\nSep 12 15:05:10 Ubuntu-2204-jammy-amd64-base erigon[55691]: [DBUG] [09-12|15:05:10.593] [txpool.fetch] Handling incoming message msg=POOLED_TRANSACTIONS_66 err=\"rlp parse transaction: unknown transaction type: 23\"\r\nSep 12 15:05:10 Ubuntu-2204-jammy-amd64-base erigon[55691]: [DBUG] [09-12|15:05:10.650] [txpool.fetch] Handling incoming message msg=NEW_POOLED_TRANSACTION_HASHES_68 err=\"parsing NewPooledTransactionHashes88: rlp parse: integer encoding for RLP must not have leading zeros: 00000339\"\r\n^BSep 12 15:05:10 Ubuntu-2204-jammy-amd64-base erigon[55691]: [DBUG] [09-12|15:05:10.793] [txpool.fetch] Handling incoming message msg=POOLED_TRANSACTIONS_66 err=\"rlp parse transaction: unknown transaction type: 23\"\r\nSep 12 15:05:10 Ubuntu-2204-jammy-amd64-base erigon[55691]: [DBUG] [09-12|15:05:10.956] [txpool.fetch] Handling incoming message msg=NEW_POOLED_TRANSACTION_HASHES_68 err=\"parsing NewPooledTransactionHashes88: rlp parse: integer encoding for RLP must not have leading zeros: 00000078\"\r\nSep 12 15:05:11 Ubuntu-2204-jammy-amd64-base erigon[55691]: [DBUG] [09-12|15:05:11.026] [txpool.fetch] Handling incoming message msg=POOLED_TRANSACTIONS_66 err=\"rlp parse transaction: unknown transaction type: 23\"\r\nSep 12 15:05:11 Ubuntu-2204-jammy-amd64-base erigon[55691]: [DBUG] [09-12|15:05:11.026] [txpool.fetch] Handling incoming message msg=NEW_POOLED_TRANSACTION_HASHES_68 err=\"parsing NewPooledTransactionHashes88: rlp parse: integer encoding for RLP must not have leading zeros: 00000070\"\r\n```\r\n\r\nThe blocks between 17794000  - 17795000 are missing. Blocks before 17794000 and after 17795000 are existed. \r\n\r\nPlease check portal https://otterscan.hetzner.graph.tdf-labs.io/",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1715703980/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
