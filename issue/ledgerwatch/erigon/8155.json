{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8155",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8155/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8155/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8155/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/8155",
  "id": 1886770618,
  "node_id": "I_kwDOC0FsAM5wddW6",
  "number": 8155,
  "title": "Prometheus metrics are broken 2.49.0",
  "user": {
    "login": "zekchan",
    "id": 3997978,
    "node_id": "MDQ6VXNlcjM5OTc5Nzg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3997978?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/zekchan",
    "html_url": "https://github.com/zekchan",
    "followers_url": "https://api.github.com/users/zekchan/followers",
    "following_url": "https://api.github.com/users/zekchan/following{/other_user}",
    "gists_url": "https://api.github.com/users/zekchan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/zekchan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/zekchan/subscriptions",
    "organizations_url": "https://api.github.com/users/zekchan/orgs",
    "repos_url": "https://api.github.com/users/zekchan/repos",
    "events_url": "https://api.github.com/users/zekchan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/zekchan/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "mh0lt",
    "id": 135143369,
    "node_id": "U_kgDOCA4fyQ",
    "avatar_url": "https://avatars.githubusercontent.com/u/135143369?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mh0lt",
    "html_url": "https://github.com/mh0lt",
    "followers_url": "https://api.github.com/users/mh0lt/followers",
    "following_url": "https://api.github.com/users/mh0lt/following{/other_user}",
    "gists_url": "https://api.github.com/users/mh0lt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mh0lt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mh0lt/subscriptions",
    "organizations_url": "https://api.github.com/users/mh0lt/orgs",
    "repos_url": "https://api.github.com/users/mh0lt/repos",
    "events_url": "https://api.github.com/users/mh0lt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mh0lt/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "mh0lt",
      "id": 135143369,
      "node_id": "U_kgDOCA4fyQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/135143369?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mh0lt",
      "html_url": "https://github.com/mh0lt",
      "followers_url": "https://api.github.com/users/mh0lt/followers",
      "following_url": "https://api.github.com/users/mh0lt/following{/other_user}",
      "gists_url": "https://api.github.com/users/mh0lt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mh0lt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mh0lt/subscriptions",
      "organizations_url": "https://api.github.com/users/mh0lt/orgs",
      "repos_url": "https://api.github.com/users/mh0lt/repos",
      "events_url": "https://api.github.com/users/mh0lt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mh0lt/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2023-09-08T00:41:02Z",
  "updated_at": "2024-01-17T03:42:19Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: `./erigon --version`\r\ndocker thorax/erigon:v2.49.0 \r\n\r\nOS & Version: Windows/Linux/OSX\r\nthorax/erigon:v2.49.0\r\n\r\n\r\nErigon Command (with flags/config):\r\n```\r\n--metrics\r\n--metrics.addr {{ http_address }}\r\n--metrics.port 6060\r\n```\r\n\r\nChain/Network: \r\nmainnet, goerly, bor\r\n#### Expected behaviour\r\n\r\n\r\n#### Actual behaviour\r\n\r\nPrometheus metrics are totally destroyed and unparseble.\r\nGET /debug/metrics/prometheus\r\n```\r\n# TYPE rpc_duration_seconds{method=\"eth_getBlockByHash\",success=\"success\"} summary\r\nrpc_duration_seconds{method=\"eth_getBlockByHash\",success=\"success\"} {quantile=\"0.5\"} 0\r\nrpc_duration_seconds{method=\"eth_getBlockByHash\",success=\"success\"} {quantile=\"0.9\"} 0\r\nrpc_duration_seconds{method=\"eth_getBlockByHash\",success=\"success\"} {quantile=\"0.97\"} 0\r\nrpc_duration_seconds{method=\"eth_getBlockByHash\",success=\"success\"} {quantile=\"0.99\"} 0\r\nrpc_duration_seconds{method=\"eth_getBlockByHash\",success=\"success\"} {quantile=\"1\"} 0\r\nrpc_duration_seconds{method=\"eth_getBlockByHash\",success=\"success\"}_time 300.000000\r\nrpc_duration_seconds{method=\"eth_getBlockByHash\",success=\"success\"}_sum 0.000000\r\nrpc_duration_seconds{method=\"eth_getBlockByHash\",success=\"success\"}_count 5\r\n```\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8155/reactions",
    "total_count": 7,
    "+1": 6,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 1
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8155/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1711021024",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8155#issuecomment-1711021024",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8155",
    "id": 1711021024,
    "node_id": "IC_kwDOC0FsAM5l_Bvg",
    "user": {
      "login": "mcseemk",
      "id": 35912473,
      "node_id": "MDQ6VXNlcjM1OTEyNDcz",
      "avatar_url": "https://avatars.githubusercontent.com/u/35912473?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mcseemk",
      "html_url": "https://github.com/mcseemk",
      "followers_url": "https://api.github.com/users/mcseemk/followers",
      "following_url": "https://api.github.com/users/mcseemk/following{/other_user}",
      "gists_url": "https://api.github.com/users/mcseemk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mcseemk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mcseemk/subscriptions",
      "organizations_url": "https://api.github.com/users/mcseemk/orgs",
      "repos_url": "https://api.github.com/users/mcseemk/repos",
      "events_url": "https://api.github.com/users/mcseemk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mcseemk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-08T03:21:41Z",
    "updated_at": "2023-09-08T03:22:18Z",
    "author_association": "NONE",
    "body": "Same issue for me.\r\nPrometheus says:\r\n```\r\ninvalid metric type \"method=\\\"engine_forkchoiceUpdatedV2\\\",success=\\\"success\\\"} summary\"\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1711021024/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1715140092",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8155#issuecomment-1715140092",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8155",
    "id": 1715140092,
    "node_id": "IC_kwDOC0FsAM5mOvX8",
    "user": {
      "login": "Zorato",
      "id": 2941327,
      "node_id": "MDQ6VXNlcjI5NDEzMjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2941327?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Zorato",
      "html_url": "https://github.com/Zorato",
      "followers_url": "https://api.github.com/users/Zorato/followers",
      "following_url": "https://api.github.com/users/Zorato/following{/other_user}",
      "gists_url": "https://api.github.com/users/Zorato/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Zorato/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Zorato/subscriptions",
      "organizations_url": "https://api.github.com/users/Zorato/orgs",
      "repos_url": "https://api.github.com/users/Zorato/repos",
      "events_url": "https://api.github.com/users/Zorato/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Zorato/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-12T07:19:00Z",
    "updated_at": "2023-09-12T07:19:00Z",
    "author_association": "NONE",
    "body": "Noticed that some `sync` labels are now GAUGE istead of COUNTER, i.e.:\r\n```# TYPE sync gauge\r\nsync{stage=\"block_hashes\"} 18118649\r\n\r\n# TYPE sync gauge\r\nsync{stage=\"bodies\"} 18118649\r\n```\r\nwhile  stage=finish is still counter\r\n\r\n```# TYPE sync counter\r\nsync{stage=\"finish\"} 18118648\r\n```\r\n\r\nProbably should be fixed to make all syncs as COUNTERs",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1715140092/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1717842456",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8155#issuecomment-1717842456",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8155",
    "id": 1717842456,
    "node_id": "IC_kwDOC0FsAM5mZDIY",
    "user": {
      "login": "mxssl",
      "id": 14476356,
      "node_id": "MDQ6VXNlcjE0NDc2MzU2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14476356?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mxssl",
      "html_url": "https://github.com/mxssl",
      "followers_url": "https://api.github.com/users/mxssl/followers",
      "following_url": "https://api.github.com/users/mxssl/following{/other_user}",
      "gists_url": "https://api.github.com/users/mxssl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mxssl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mxssl/subscriptions",
      "organizations_url": "https://api.github.com/users/mxssl/orgs",
      "repos_url": "https://api.github.com/users/mxssl/repos",
      "events_url": "https://api.github.com/users/mxssl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mxssl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-13T15:18:31Z",
    "updated_at": "2023-09-13T15:18:31Z",
    "author_association": "NONE",
    "body": "The same problem\r\nPrometheus version: 2.47.0\r\nErigon version: 2.49.1\r\n\r\n```\r\ninvalid metric type \"method=\\\"engine_forkchoiceUpdatedV2\\\",success=\\\"success\\\"} summary\"\r\n```\r\n\r\n<img width=\"1546\" alt=\"Screenshot 2023-09-13 at 18 17 37\" src=\"https://github.com/ledgerwatch/erigon/assets/14476356/64738d94-944c-4aed-af45-55ae507d8c12\">\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1717842456/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1738880900",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8155#issuecomment-1738880900",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8155",
    "id": 1738880900,
    "node_id": "IC_kwDOC0FsAM5npTeE",
    "user": {
      "login": "zekchan",
      "id": 3997978,
      "node_id": "MDQ6VXNlcjM5OTc5Nzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3997978?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zekchan",
      "html_url": "https://github.com/zekchan",
      "followers_url": "https://api.github.com/users/zekchan/followers",
      "following_url": "https://api.github.com/users/zekchan/following{/other_user}",
      "gists_url": "https://api.github.com/users/zekchan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zekchan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zekchan/subscriptions",
      "organizations_url": "https://api.github.com/users/zekchan/orgs",
      "repos_url": "https://api.github.com/users/zekchan/repos",
      "events_url": "https://api.github.com/users/zekchan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zekchan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-28T10:25:01Z",
    "updated_at": "2023-09-28T10:25:01Z",
    "author_association": "NONE",
    "body": "@mh0lt 2.50.0\r\nAfter receiving an RPC request, metrics are destroyed again. (Same behaviour as in 2.49.0+)\r\n```\r\nrpc_duration_seconds{method=\"eth_getBlockByHash\",success=\"success\"} {quantile=\"1\"} 0\r\nrpc_duration_seconds{method=\"eth_getBlockByHash\",success=\"success\"}_time 300.000000\r\nrpc_duration_seconds{method=\"eth_getBlockByHash\",success=\"success\"}_sum 0.000000\r\nrpc_duration_seconds{method=\"eth_getBlockByHash\",success=\"success\"}_count 5\r\nrpc_duration_seconds{method=\"eth_getBlockByNumber\",success=\"success\"} {quantile=\"0.5\"} 0\r\nrpc_duration_seconds{method=\"eth_getBlockByNumber\",success=\"success\"} {quantile=\"0.9\"} 0\r\nrpc_duration_seconds{method=\"eth_getBlockByNumber\",success=\"success\"} {quantile=\"0.97\"} 0\r\nrpc_duration_seconds{method=\"eth_getBlockByNumber\",success=\"success\"} {quantile=\"0.99\"} 0\r\nrpc_duration_seconds{method=\"eth_getBlockByNumber\",success=\"success\"} {quantile=\"1\"} 0\r\nrpc_duration_seconds{method=\"eth_getBlockByNumber\",success=\"success\"}_time 300.000000\r\nrpc_duration_seconds{method=\"eth_getBlockByNumber\",success=\"success\"}_sum 0.000000\r\nrpc_duration_seconds{method=\"eth_getBlockByNumber\",success=\"success\"}_count 5\r\nrpc_duration_seconds{method=\"eth_getLogs\",success=\"success\"} {quantile=\"0.5\"} 0\r\nrpc_duration_seconds{method=\"eth_getLogs\",success=\"success\"} {quantile=\"0.9\"} 0\r\nrpc_duration_seconds{method=\"eth_getLogs\",success=\"success\"} {quantile=\"0.97\"} 0\r\nrpc_duration_seconds{method=\"eth_getLogs\",success=\"success\"} {quantile=\"0.99\"} 0\r\nrpc_duration_seconds{method=\"eth_getLogs\",success=\"success\"} {quantile=\"1\"} 0\r\nrpc_duration_seconds{method=\"eth_getLogs\",success=\"success\"}_time 300.000000\r\nrpc_duration_seconds{method=\"eth_getLogs\",success=\"success\"}_sum 0.000000\r\nrpc_duration_seconds{method=\"eth_getLogs\",success=\"success\"}_count 5\r\nrpc_duration_seconds{method=\"eth_getTransactionReceipt\",success=\"success\"} {quantile=\"0.5\"} 0\r\nrpc_duration_seconds{method=\"eth_getTransactionReceipt\",success=\"success\"} {quantile=\"0.9\"} 0\r\nrpc_duration_seconds{method=\"eth_getTransactionReceipt\",success=\"success\"} {quantile=\"0.97\"} 0\r\nrpc_duration_seconds{method=\"eth_getTransactionReceipt\",success=\"success\"} {quantile=\"0.99\"} 0\r\nrpc_duration_seconds{method=\"eth_getTransactionReceipt\",success=\"success\"} {quantile=\"1\"} 0\r\nrpc_duration_seconds{method=\"eth_getTransactionReceipt\",success=\"success\"}_time 300.000000\r\nrpc_duration_seconds{method=\"eth_getTransactionReceipt\",success=\"success\"}_sum 0.000000\r\nrpc_duration_seconds{method=\"eth_getTransactionReceipt\",success=\"success\"}_count 5\r\nrpc_duration_seconds{method=\"eth_syncing\",success=\"success\"} {quantile=\"0.5\"} 0\r\nrpc_duration_seconds{method=\"eth_syncing\",success=\"success\"} {quantile=\"0.9\"} 0\r\nrpc_duration_seconds{method=\"eth_syncing\",success=\"success\"} {quantile=\"0.97\"} 0\r\nrpc_duration_seconds{method=\"eth_syncing\",success=\"success\"} {quantile=\"0.99\"} 0\r\nrpc_duration_seconds{method=\"eth_syncing\",success=\"success\"} {quantile=\"1\"} 0\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1738880900/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1800890350",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8155#issuecomment-1800890350",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8155",
    "id": 1800890350,
    "node_id": "IC_kwDOC0FsAM5rV2fu",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-11-08T02:06:19Z",
    "updated_at": "2023-11-08T02:06:19Z",
    "author_association": "NONE",
    "body": "This issue is stale because it has been open for 40 days with no activity. Remove stale label or comment, or this will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1800890350/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": {
      "id": 15368,
      "slug": "github-actions",
      "node_id": "MDM6QXBwMTUzNjg=",
      "owner": {
        "login": "github",
        "id": 9919,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjk5MTk=",
        "avatar_url": "https://avatars.githubusercontent.com/u/9919?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/github",
        "html_url": "https://github.com/github",
        "followers_url": "https://api.github.com/users/github/followers",
        "following_url": "https://api.github.com/users/github/following{/other_user}",
        "gists_url": "https://api.github.com/users/github/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/github/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/github/subscriptions",
        "organizations_url": "https://api.github.com/users/github/orgs",
        "repos_url": "https://api.github.com/users/github/repos",
        "events_url": "https://api.github.com/users/github/events{/privacy}",
        "received_events_url": "https://api.github.com/users/github/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "name": "GitHub Actions",
      "description": "Automate your workflow from idea to production",
      "external_url": "https://help.github.com/en/actions",
      "html_url": "https://github.com/apps/github-actions",
      "created_at": "2018-07-30T09:30:17Z",
      "updated_at": "2019-12-10T19:04:12Z",
      "permissions": {
        "actions": "write",
        "administration": "read",
        "checks": "write",
        "contents": "write",
        "deployments": "write",
        "discussions": "write",
        "issues": "write",
        "merge_queues": "write",
        "metadata": "read",
        "packages": "write",
        "pages": "write",
        "pull_requests": "write",
        "repository_hooks": "write",
        "repository_projects": "write",
        "security_events": "write",
        "statuses": "write",
        "vulnerability_alerts": "read"
      },
      "events": [
        "branch_protection_rule",
        "check_run",
        "check_suite",
        "create",
        "delete",
        "deployment",
        "deployment_status",
        "discussion",
        "discussion_comment",
        "fork",
        "gollum",
        "issues",
        "issue_comment",
        "label",
        "merge_group",
        "milestone",
        "page_build",
        "project",
        "project_card",
        "project_column",
        "public",
        "pull_request",
        "pull_request_review",
        "pull_request_review_comment",
        "push",
        "registry_package",
        "release",
        "repository",
        "repository_dispatch",
        "status",
        "watch",
        "workflow_dispatch",
        "workflow_run"
      ]
    }
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1800891139",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8155#issuecomment-1800891139",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8155",
    "id": 1800891139,
    "node_id": "IC_kwDOC0FsAM5rV2sD",
    "user": {
      "login": "mcdee",
      "id": 511384,
      "node_id": "MDQ6VXNlcjUxMTM4NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/511384?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mcdee",
      "html_url": "https://github.com/mcdee",
      "followers_url": "https://api.github.com/users/mcdee/followers",
      "following_url": "https://api.github.com/users/mcdee/following{/other_user}",
      "gists_url": "https://api.github.com/users/mcdee/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mcdee/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mcdee/subscriptions",
      "organizations_url": "https://api.github.com/users/mcdee/orgs",
      "repos_url": "https://api.github.com/users/mcdee/repos",
      "events_url": "https://api.github.com/users/mcdee/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mcdee/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-11-08T02:07:20Z",
    "updated_at": "2023-11-08T02:07:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "Has this been fixed?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1800891139/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1894742958",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/8155#issuecomment-1894742958",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/8155",
    "id": 1894742958,
    "node_id": "IC_kwDOC0FsAM5w73uu",
    "user": {
      "login": "activescott",
      "id": 213716,
      "node_id": "MDQ6VXNlcjIxMzcxNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/213716?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/activescott",
      "html_url": "https://github.com/activescott",
      "followers_url": "https://api.github.com/users/activescott/followers",
      "following_url": "https://api.github.com/users/activescott/following{/other_user}",
      "gists_url": "https://api.github.com/users/activescott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/activescott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/activescott/subscriptions",
      "organizations_url": "https://api.github.com/users/activescott/orgs",
      "repos_url": "https://api.github.com/users/activescott/repos",
      "events_url": "https://api.github.com/users/activescott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/activescott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2024-01-17T00:37:15Z",
    "updated_at": "2024-01-17T03:42:19Z",
    "author_association": "NONE",
    "body": "EDIT: This was my mistake. In case anyone else has trouble, I had to set the following args to the erigon CLI:\r\n\r\n```\r\n'--metrics.addr=0.0.0.0'\r\n'--metrics.port=6060'\r\n```\r\nThen I saw in the logs `[INFO] [01-16|19:37:40.763] Enabling metrics export to prometheus    path=http://0.0.0.0:6060/debug/metrics/` (instead the notable bit being 0.0.0.0 instead of 127.0.0.1. And Prometheus worked.\r\n\r\nMy original issue below:\r\n---\r\nUsing v2.56.2 from the dockerhub image **thorax/erigon:v2.56.2**.\r\nBuild info from logs:\r\n\r\n```\r\nerigon-0 [INFO] [01-16|16:15:18.755] Build info                               git_branch=heads/v2.56.2 git_tag=v2.56.2-dirty git_commit=c9216ce10451a235af1cdde572642eac3640fadf\r\n```\r\n\r\nI'm seeing a connection refused on the metrics port+path from the logs even from within the host itself or from external hosts:\r\n\r\nIn the logs I see it attempted to enable metrics:\r\n```\r\nerigon-0 [INFO] [01-16|16:15:18.755] Enabling metrics export to prometheus    path=http://127.0.0.1:6060/debug/metrics/prometheus\r\n```\r\n\r\nYet, when I query that endpoint from within the container/pod I get this:\r\n\r\n```\r\n$ wget http://127.0.0.1:6060/debug/metrics/prometheus\r\nConnecting to 127.0.0.1:6060 (127.0.0.1:6060)\r\nwget: can't open 'prometheus': Permission denied\r\n\r\n# the port seems alive though:\r\n$ wget http://127.0.0.1:6060/foo\r\nConnecting to 127.0.0.1:6060 (127.0.0.1:6060)\r\nwget: server returned error: HTTP/1.1 404 Not Found\r\n```\r\n\r\n\r\nAny ideas?  \r\nHow can I help?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1894742958/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
