{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3697",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3697/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3697/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3697/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/3697",
  "id": 1169460832,
  "node_id": "I_kwDOC0FsAM5FtI5g",
  "number": 3697,
  "title": "mdbx_env_open error when starting Erigon (devel branch)",
  "user": {
    "login": "GBBx",
    "id": 76771769,
    "node_id": "MDQ6VXNlcjc2NzcxNzY5",
    "avatar_url": "https://avatars.githubusercontent.com/u/76771769?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/GBBx",
    "html_url": "https://github.com/GBBx",
    "followers_url": "https://api.github.com/users/GBBx/followers",
    "following_url": "https://api.github.com/users/GBBx/following{/other_user}",
    "gists_url": "https://api.github.com/users/GBBx/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/GBBx/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/GBBx/subscriptions",
    "organizations_url": "https://api.github.com/users/GBBx/orgs",
    "repos_url": "https://api.github.com/users/GBBx/repos",
    "events_url": "https://api.github.com/users/GBBx/events{/privacy}",
    "received_events_url": "https://api.github.com/users/GBBx/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2022-03-15T10:15:09Z",
  "updated_at": "2022-10-07T15:46:27Z",
  "closed_at": "2022-03-18T03:23:20Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: `erigon version 2022.99.99-dev`\r\nOS & Version: Linux (kernel: 4.18.0)\r\n\r\nTried to build it twice:\r\n1. Commit hash : `4ee0ae161067a6cc68d85e4032d80fcf91f77fdb` with go 1.17.1.\r\n2. Commit hash: `a0765a8bc4df72931edbeda92a89ee01f4900005` with go 1.17.8.\r\nBoth have the same error.\r\n\r\n#### Expected behaviour\r\nErigon can be started.\r\n\r\n#### Actual behaviour\r\nErigon fails to start.\r\n\r\n#### Steps to reproduce the behaviour\r\n```\r\ngit clone --recurse-submodules -j8 --branch devel https://github.com/ledgerwatch/erigon.git\r\ncd erigon\r\nmake erigon\r\nerigon --datadir /data/erigon --chain ropsten --private.api.addr=localhost:9090\r\n```\r\n\r\nChanging the chain to e.g. mainnet does not make any difference.\r\n\r\n#### Backtrace\r\n\r\n````\r\nINFO[03-15|09:53:09.159] Build info                               git_branch=devel git_tag=v2022.02.04 git_commit=4ee0ae161067a6cc68d85e4032d80fcf91f77fdb\r\nINFO[03-15|09:53:09.160] Starting Erigon on Ethereum mainnet...\r\nINFO[03-15|09:53:09.163] Maximum peer count                       ETH=100 total=100\r\nINFO[03-15|09:53:09.163] Set global gas cap                       cap=50000000\r\nINFO[03-15|09:53:09.307] Opening Database                         label=chaindata path=/data/erigon/chaindata\r\nmdbx_env_open:16183 Linux prior to 5.4 requires MDBX_WRITEMAP because of a flaw of unified page/buffer cache. See https://github.com/erthink/libmdbx/issues/269\r\nEROR[03-15|09:53:09.307] Erigon startup                           err=\"mdbx_env_open: protocol not available, label: chaindata, trace: [kv_mdbx.go:234 node.go:532 node.go:535 backend.go:162 node.go:121 node.go:109 main.go:32 app.go:526 app.go:286 main.go:19 proc.go:255 asm_amd64.s:1581]\"\r\n````\r\n",
  "closed_by": {
    "login": "AskAlexSharov",
    "id": 46885206,
    "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AskAlexSharov",
    "html_url": "https://github.com/AskAlexSharov",
    "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
    "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
    "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
    "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
    "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
    "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3697/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3697/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1068220439",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3697#issuecomment-1068220439",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3697",
    "id": 1068220439,
    "node_id": "IC_kwDOC0FsAM4_q8AX",
    "user": {
      "login": "erthink",
      "id": 6241554,
      "node_id": "MDQ6VXNlcjYyNDE1NTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6241554?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/erthink",
      "html_url": "https://github.com/erthink",
      "followers_url": "https://api.github.com/users/erthink/followers",
      "following_url": "https://api.github.com/users/erthink/following{/other_user}",
      "gists_url": "https://api.github.com/users/erthink/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/erthink/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/erthink/subscriptions",
      "organizations_url": "https://api.github.com/users/erthink/orgs",
      "repos_url": "https://api.github.com/users/erthink/repos",
      "events_url": "https://api.github.com/users/erthink/events{/privacy}",
      "received_events_url": "https://api.github.com/users/erthink/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-15T16:53:44Z",
    "updated_at": "2022-03-15T16:53:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "This is response of a \"fuse\" to protect against potentially more serious problems.\r\nPlease read my [comment](https://github.com/erthink/libmdbx/issues/269#issuecomment-1068214834) for corresponding issue.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1068220439/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1068623365",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3697#issuecomment-1068623365",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3697",
    "id": 1068623365,
    "node_id": "IC_kwDOC0FsAM4_seYF",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-16T01:09:25Z",
    "updated_at": "2022-03-16T01:10:00Z",
    "author_association": "COLLABORATOR",
    "body": "@GBBx there are some technical problems in compatibility with linux 4. my advise: use linux >5.4",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1068623365/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1068624173",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3697#issuecomment-1068624173",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3697",
    "id": 1068624173,
    "node_id": "IC_kwDOC0FsAM4_sekt",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-16T01:11:17Z",
    "updated_at": "2022-03-16T01:11:17Z",
    "author_association": "COLLABORATOR",
    "body": "Btw, maybe we can add automatic enabling MDBX_WRITEMAP if see error above. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1068624173/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1071016997",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3697#issuecomment-1071016997",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3697",
    "id": 1071016997,
    "node_id": "IC_kwDOC0FsAM4_1mwl",
    "user": {
      "login": "GBBx",
      "id": 76771769,
      "node_id": "MDQ6VXNlcjc2NzcxNzY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/76771769?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/GBBx",
      "html_url": "https://github.com/GBBx",
      "followers_url": "https://api.github.com/users/GBBx/followers",
      "following_url": "https://api.github.com/users/GBBx/following{/other_user}",
      "gists_url": "https://api.github.com/users/GBBx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/GBBx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GBBx/subscriptions",
      "organizations_url": "https://api.github.com/users/GBBx/orgs",
      "repos_url": "https://api.github.com/users/GBBx/repos",
      "events_url": "https://api.github.com/users/GBBx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/GBBx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-17T16:01:35Z",
    "updated_at": "2022-03-17T16:01:35Z",
    "author_association": "NONE",
    "body": "Thank you. Yes, it works with the new kernel.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1071016997/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1071990643",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3697#issuecomment-1071990643",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3697",
    "id": 1071990643,
    "node_id": "IC_kwDOC0FsAM4_5Udz",
    "user": {
      "login": "AskAlexSharov",
      "id": 46885206,
      "node_id": "MDQ6VXNlcjQ2ODg1MjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/46885206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AskAlexSharov",
      "html_url": "https://github.com/AskAlexSharov",
      "followers_url": "https://api.github.com/users/AskAlexSharov/followers",
      "following_url": "https://api.github.com/users/AskAlexSharov/following{/other_user}",
      "gists_url": "https://api.github.com/users/AskAlexSharov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AskAlexSharov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AskAlexSharov/subscriptions",
      "organizations_url": "https://api.github.com/users/AskAlexSharov/orgs",
      "repos_url": "https://api.github.com/users/AskAlexSharov/repos",
      "events_url": "https://api.github.com/users/AskAlexSharov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AskAlexSharov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-18T03:23:20Z",
    "updated_at": "2022-03-18T03:23:20Z",
    "author_association": "COLLABORATOR",
    "body": "And we are also released fallback to WriteMap on old kernels. ",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1071990643/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1271761548",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/3697#issuecomment-1271761548",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/3697",
    "id": 1271761548,
    "node_id": "IC_kwDOC0FsAM5LzYqM",
    "user": {
      "login": "p1nox",
      "id": 779581,
      "node_id": "MDQ6VXNlcjc3OTU4MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/779581?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/p1nox",
      "html_url": "https://github.com/p1nox",
      "followers_url": "https://api.github.com/users/p1nox/followers",
      "following_url": "https://api.github.com/users/p1nox/following{/other_user}",
      "gists_url": "https://api.github.com/users/p1nox/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/p1nox/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/p1nox/subscriptions",
      "organizations_url": "https://api.github.com/users/p1nox/orgs",
      "repos_url": "https://api.github.com/users/p1nox/repos",
      "events_url": "https://api.github.com/users/p1nox/events{/privacy}",
      "received_events_url": "https://api.github.com/users/p1nox/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-07T15:46:27Z",
    "updated_at": "2022-10-07T15:46:27Z",
    "author_association": "NONE",
    "body": "I'm receiving this error when using an nfs4 EFS partition in an AWS instance (https://aws.amazon.com/efs/), on Linux version 5.15.0-1020-aws (gcc (Ubuntu 9.4.0-1ubuntu1~20.04.1). Is this also an issue related to the filesystem?\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1271761548/reactions",
      "total_count": 3,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 3
    },
    "performed_via_github_app": null
  }
]
