{
  "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4533",
  "repository_url": "https://api.github.com/repos/ledgerwatch/erigon",
  "labels_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4533/labels{/name}",
  "comments_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4533/comments",
  "events_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4533/events",
  "html_url": "https://github.com/ledgerwatch/erigon/issues/4533",
  "id": 1284400970,
  "node_id": "I_kwDOC0FsAM5MjmdK",
  "number": 4533,
  "title": "dev chain: trace_replayBlockTransactions shows tx with nonce too high for 0-address",
  "user": {
    "login": "mohoff",
    "id": 6060612,
    "node_id": "MDQ6VXNlcjYwNjA2MTI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6060612?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mohoff",
    "html_url": "https://github.com/mohoff",
    "followers_url": "https://api.github.com/users/mohoff/followers",
    "following_url": "https://api.github.com/users/mohoff/following{/other_user}",
    "gists_url": "https://api.github.com/users/mohoff/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mohoff/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mohoff/subscriptions",
    "organizations_url": "https://api.github.com/users/mohoff/orgs",
    "repos_url": "https://api.github.com/users/mohoff/repos",
    "events_url": "https://api.github.com/users/mohoff/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mohoff/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4566396003,
      "node_id": "LA_kwDOC0FsAM8AAAABEC2sYw",
      "url": "https://api.github.com/repos/ledgerwatch/erigon/labels/Stale",
      "name": "Stale",
      "color": "ededed",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2022-06-25T01:31:53Z",
  "updated_at": "2023-03-03T04:06:45Z",
  "closed_at": "2023-03-03T04:06:45Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### System information\r\n\r\nErigon version: `2022.04.1-beta`\r\n\r\n#### Expected behaviour\r\n\r\nTracing txs works as expected\r\n\r\n#### Actual behaviour\r\n\r\nMostly works, but there's a block it does fail in our test setup:\r\n\r\n```\r\ncurl -X POST --data '{\"jsonrpc\":\"2.0\",\"method\":\"trace_replayBlockTransactions\",\"params\":[53,[\"stateDiff\"]],\"id\":1}' http://node1:8545 -H 'Content-Type: application/json'\r\n{\"jsonrpc\":\"2.0\",\"id\":1,\"error\":{\"code\":-32000,\"message\":\"first run for txIndex 0 error: nonce too high: address 0x0000000000000000000000000000000000000000, tx: 3 state: 0\"}}\r\n```\r\n\r\nLooking at the block, it has a single tx that deploys a contract:\r\n\r\n```\r\ncurl -X POST --data '{\"jsonrpc\":\"2.0\",\"method\":\"eth_getBlockByNumber\",\"params\":[53,true],\"id\":1}' http://node1:8545 -H 'Content-Type: application/json'\r\n\r\n{\r\n    \"jsonrpc\": \"2.0\",\r\n    \"id\": 1,\r\n    \"result\": {\r\n        \"baseFeePerGas\": \"0x143975\",\r\n        \"difficulty\": \"0x2\",\r\n        \"extraData\": \"0x0000000000000000000000000000000000000000000000000000000000000000f841385d5e0443412c48a78ac186b7221faaec062dc5196f0ba702f314a820fe7e12801ddbdf1a4808325109755aa0316efc1d0f7844b4bcccdf85268bf96a4601\",\r\n        \"gasLimit\": \"0xb8caa6\",\r\n        \"gasUsed\": \"0x8001\",\r\n        \"hash\": \"0xe99d2c97368171b5d2d605872f420719d657e3c208eae19ce3ed90cc41e7d8c0\",\r\n        \"logsBloom\": \"0x00000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000004000000000000000000000000000002000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000020000000000000000100000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000\",\r\n        \"miner\": \"0x0000000000000000000000000000000000000000\",\r\n        \"mixHash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n        \"nonce\": \"0x0000000000000000\",\r\n        \"number\": \"0x35\",\r\n        \"parentHash\": \"0xadb9b429e64b4d387fb49f14bd7a20869151196c0e19ab5b34aa2d1e602d96e3\",\r\n        \"receiptsRoot\": \"0x8bca6c19fd36108e105a1ef0d6c86906f6df324025c4a04bdcc00a4018b1a299\",\r\n        \"sha3Uncles\": \"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347\",\r\n        \"size\": \"0x2ef\",\r\n        \"stateRoot\": \"0xe223082ae79fb5603633aeede7653f8696eb79c0afcccecff99e41a42a35688b\",\r\n        \"timestamp\": \"0x62b65fa3\",\r\n        \"totalDifficulty\": \"0x6b\",\r\n        \"transactions\": [\r\n            {\r\n                \"blockHash\": \"0xe99d2c97368171b5d2d605872f420719d657e3c208eae19ce3ed90cc41e7d8c0\",\r\n                \"blockNumber\": \"0x35\",\r\n                \"from\": \"0x0000000000000000000000000000000000000000\",\r\n                \"gas\": \"0xa001\",\r\n                \"gasPrice\": \"0x3e3331\",\r\n                \"hash\": \"0x4cd4b2ef9920813d143faf1306e5297f628dbc024b326848519b2249b1080413\",\r\n                \"input\": \"0x3659cfe60000000000000000000000001be672818daaf63ca8782a7fe5f1ce314ebff012\",\r\n                \"nonce\": \"0x3\",\r\n                \"to\": \"0x61b59cb37f557e2f18ba8b9fbd19aae53fb29f9d\",\r\n                \"transactionIndex\": \"0x0\",\r\n                \"value\": \"0x0\",\r\n                \"type\": \"0x0\",\r\n                \"chainId\": \"0x539\",\r\n                \"v\": \"0xa95\",\r\n                \"r\": \"0x8f4c0abe1f31a208f0b3a141181d6be91fdb1c6d9957cb30488a2e6b076a00b3\",\r\n                \"s\": \"0x19c8c0bf59bb4ca3bc19a4878ba33b63405e5e7e72659ab02346591b4ae6831\"\r\n            }\r\n        ],\r\n        \"transactionsRoot\": \"0x007570645d38a61e4af7445c3fcfc5011b405078f73ed90b4e65380bb10e9a3e\",\r\n        \"uncles\": []\r\n    }\r\n}\r\n```\r\n\r\nWe do deploy contracts prior to this tx, nonce=3 can make sense in the sense it's the 4th contract deployment. But:\r\n\r\n1. Why was the tx successfully mined the first place if its nonce is too high?\r\n2. Why is the nonce=3? `eth_getTransactionCount` shows nonce=0 for any block.\r\n\r\nMight be a particularity of the dev chain.\r\n\r\nThanks\r\n",
  "closed_by": {
    "login": "github-actions[bot]",
    "id": 41898282,
    "node_id": "MDM6Qm90NDE4OTgyODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/github-actions%5Bbot%5D",
    "html_url": "https://github.com/apps/github-actions",
    "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4533/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4533/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1166165854",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4533#issuecomment-1166165854",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4533",
    "id": 1166165854,
    "node_id": "IC_kwDOC0FsAM5Fgkde",
    "user": {
      "login": "mohoff",
      "id": 6060612,
      "node_id": "MDQ6VXNlcjYwNjA2MTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6060612?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mohoff",
      "html_url": "https://github.com/mohoff",
      "followers_url": "https://api.github.com/users/mohoff/followers",
      "following_url": "https://api.github.com/users/mohoff/following{/other_user}",
      "gists_url": "https://api.github.com/users/mohoff/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mohoff/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mohoff/subscriptions",
      "organizations_url": "https://api.github.com/users/mohoff/orgs",
      "repos_url": "https://api.github.com/users/mohoff/repos",
      "events_url": "https://api.github.com/users/mohoff/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mohoff/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-25T01:33:54Z",
    "updated_at": "2022-06-25T01:33:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "Now that I think about it, contract deployments should set the to-address to 0, not the from-address. However, `0x61b59cb37f557e2f18ba8b9fbd19aae53fb29f9d` is one of the contracts we deploy. Not sure what's going on there or what this tx is about",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1166165854/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1166167619",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4533#issuecomment-1166167619",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4533",
    "id": 1166167619,
    "node_id": "IC_kwDOC0FsAM5Fgk5D",
    "user": {
      "login": "mohoff",
      "id": 6060612,
      "node_id": "MDQ6VXNlcjYwNjA2MTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6060612?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mohoff",
      "html_url": "https://github.com/mohoff",
      "followers_url": "https://api.github.com/users/mohoff/followers",
      "following_url": "https://api.github.com/users/mohoff/following{/other_user}",
      "gists_url": "https://api.github.com/users/mohoff/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mohoff/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mohoff/subscriptions",
      "organizations_url": "https://api.github.com/users/mohoff/orgs",
      "repos_url": "https://api.github.com/users/mohoff/repos",
      "events_url": "https://api.github.com/users/mohoff/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mohoff/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-25T01:45:29Z",
    "updated_at": "2022-06-25T01:45:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "Looking at `tx.input` I recognize this as one of our regular txs we send. Just `tx.from` should be one of our addresses, not the 0-address. We use the same deployment script for ages and it never caused issues so I'm left to think this is a bug in the dev chain.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1166167619/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1180104163",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4533#issuecomment-1180104163",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4533",
    "id": 1180104163,
    "node_id": "IC_kwDOC0FsAM5GVvXj",
    "user": {
      "login": "mandrigin",
      "id": 466427,
      "node_id": "MDQ6VXNlcjQ2NjQyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/466427?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mandrigin",
      "html_url": "https://github.com/mandrigin",
      "followers_url": "https://api.github.com/users/mandrigin/followers",
      "following_url": "https://api.github.com/users/mandrigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mandrigin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mandrigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mandrigin/subscriptions",
      "organizations_url": "https://api.github.com/users/mandrigin/orgs",
      "repos_url": "https://api.github.com/users/mandrigin/repos",
      "events_url": "https://api.github.com/users/mandrigin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mandrigin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-11T08:20:07Z",
    "updated_at": "2022-07-11T08:20:07Z",
    "author_association": "COLLABORATOR",
    "body": "@mohoff there were some improvements to the dev chain lately, can you re-check with the latest release?",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1180104163/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1442714985",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4533#issuecomment-1442714985",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4533",
    "id": 1442714985,
    "node_id": "IC_kwDOC0FsAM5V_hVp",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-02-24T02:37:38Z",
    "updated_at": "2023-02-24T02:37:38Z",
    "author_association": "NONE",
    "body": "This issue is stale because it has been open for 40 days with no activity. Remove stale label or comment, or this will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1442714985/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1452933788",
    "html_url": "https://github.com/ledgerwatch/erigon/issues/4533#issuecomment-1452933788",
    "issue_url": "https://api.github.com/repos/ledgerwatch/erigon/issues/4533",
    "id": 1452933788,
    "node_id": "IC_kwDOC0FsAM5WmgKc",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2023-03-03T04:06:45Z",
    "updated_at": "2023-03-03T04:06:45Z",
    "author_association": "NONE",
    "body": "This issue was closed because it has been stalled for 7 days with no activity.",
    "reactions": {
      "url": "https://api.github.com/repos/ledgerwatch/erigon/issues/comments/1452933788/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
