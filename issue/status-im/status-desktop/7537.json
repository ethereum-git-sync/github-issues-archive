{
  "url": "https://api.github.com/repos/status-im/status-desktop/issues/7537",
  "repository_url": "https://api.github.com/repos/status-im/status-desktop",
  "labels_url": "https://api.github.com/repos/status-im/status-desktop/issues/7537/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-desktop/issues/7537/comments",
  "events_url": "https://api.github.com/repos/status-im/status-desktop/issues/7537/events",
  "html_url": "https://github.com/status-im/status-desktop/issues/7537",
  "id": 1384013880,
  "node_id": "I_kwDOD5KrTM5SfmA4",
  "number": 7537,
  "title": "Avoid logic duplication in presentation layer",
  "user": {
    "login": "osmaczko",
    "id": 33099791,
    "node_id": "MDQ6VXNlcjMzMDk5Nzkx",
    "avatar_url": "https://avatars.githubusercontent.com/u/33099791?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/osmaczko",
    "html_url": "https://github.com/osmaczko",
    "followers_url": "https://api.github.com/users/osmaczko/followers",
    "following_url": "https://api.github.com/users/osmaczko/following{/other_user}",
    "gists_url": "https://api.github.com/users/osmaczko/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/osmaczko/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/osmaczko/subscriptions",
    "organizations_url": "https://api.github.com/users/osmaczko/orgs",
    "repos_url": "https://api.github.com/users/osmaczko/repos",
    "events_url": "https://api.github.com/users/osmaczko/events{/privacy}",
    "received_events_url": "https://api.github.com/users/osmaczko/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2087353959,
      "node_id": "MDU6TGFiZWwyMDg3MzUzOTU5",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/ui-team",
      "name": "ui-team",
      "color": "1111ff",
      "default": false,
      "description": ""
    },
    {
      "id": 2351074091,
      "node_id": "MDU6TGFiZWwyMzUxMDc0MDkx",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/refactor",
      "name": "refactor",
      "color": "ef9870",
      "default": false,
      "description": ""
    },
    {
      "id": 3166424543,
      "node_id": "MDU6TGFiZWwzMTY2NDI0NTQz",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/general",
      "name": "general",
      "color": "427672",
      "default": false,
      "description": ""
    },
    {
      "id": 3507612097,
      "node_id": "LA_kwDOD5KrTM7REenB",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/qml",
      "name": "qml",
      "color": "3A734D",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-09-23T16:04:06Z",
  "updated_at": "2023-04-25T07:37:32Z",
  "closed_at": "2023-04-25T07:37:32Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Description\r\n\r\nCurrently, we have a lot of logic duplication in qml components, this results in issues like:\r\n- user icon is not consistent across the app\r\n- user key is not consistent across the app\r\n- user connection badge is not consistent across the app\r\n- user verification state is not consistent across the app\r\n- etc.\r\n\r\nExample of duplication (if to display identicon ring or not):\r\nhttps://github.com/status-im/status-desktop/blob/fac0679c41894d4524428f7488d28f41be540740/ui/StatusQ/src/StatusQ/Components/StatusChatList.qml#L127\r\n\r\nhttps://github.com/status-im/status-desktop/blob/fac0679c41894d4524428f7488d28f41be540740/ui/app/AppLayouts/Chat/panels/UserListPanel.qml#L96\r\n\r\nhttps://github.com/status-im/status-desktop/blob/fac0679c41894d4524428f7488d28f41be540740/ui/app/AppLayouts/Chat/panels/communities/CommunityMembersTabPanel.qml#L139\r\n\r\nhttps://github.com/status-im/status-desktop/blob/fac0679c41894d4524428f7488d28f41be540740/ui/app/mainui/AppMain.qml#L362\r\n\r\nhttps://github.com/status-im/status-desktop/blob/fac0679c41894d4524428f7488d28f41be540740/ui/imports/shared/controls/delegates/ContactListItemDelegate.qml#L31\r\n\r\nhttps://github.com/status-im/status-desktop/blob/fac0679c41894d4524428f7488d28f41be540740/ui/imports/shared/views/ExistingContacts.qml#L63\r\n\r\nand that's not all of it.\r\n\r\n### Considerations\r\n\r\nOur current qml architecture supplies data through stores. Eeach view should have its own store, meaning the logic duplication is inevitable :question: \r\n\r\nIt may be very hard to find an ultimate solution to this problem with the current qml state.\r\n\r\n### Goal\r\n\r\nIdeally, we should have only one place where this logic is implemented, meaning we should have only one component that interprets the data from the backend.\r\n\r\nWe should figure out how to remove the duplication in the current architecture.",
  "closed_by": {
    "login": "osmaczko",
    "id": 33099791,
    "node_id": "MDQ6VXNlcjMzMDk5Nzkx",
    "avatar_url": "https://avatars.githubusercontent.com/u/33099791?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/osmaczko",
    "html_url": "https://github.com/osmaczko",
    "followers_url": "https://api.github.com/users/osmaczko/followers",
    "following_url": "https://api.github.com/users/osmaczko/following{/other_user}",
    "gists_url": "https://api.github.com/users/osmaczko/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/osmaczko/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/osmaczko/subscriptions",
    "organizations_url": "https://api.github.com/users/osmaczko/orgs",
    "repos_url": "https://api.github.com/users/osmaczko/repos",
    "events_url": "https://api.github.com/users/osmaczko/events{/privacy}",
    "received_events_url": "https://api.github.com/users/osmaczko/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/7537/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-desktop/issues/7537/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1300427960",
    "html_url": "https://github.com/status-im/status-desktop/issues/7537#issuecomment-1300427960",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/7537",
    "id": 1300427960,
    "node_id": "IC_kwDOD5KrTM5NgvS4",
    "user": {
      "login": "igor-sirotin",
      "id": 25482501,
      "node_id": "MDQ6VXNlcjI1NDgyNTAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25482501?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/igor-sirotin",
      "html_url": "https://github.com/igor-sirotin",
      "followers_url": "https://api.github.com/users/igor-sirotin/followers",
      "following_url": "https://api.github.com/users/igor-sirotin/following{/other_user}",
      "gists_url": "https://api.github.com/users/igor-sirotin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/igor-sirotin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/igor-sirotin/subscriptions",
      "organizations_url": "https://api.github.com/users/igor-sirotin/orgs",
      "repos_url": "https://api.github.com/users/igor-sirotin/repos",
      "events_url": "https://api.github.com/users/igor-sirotin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/igor-sirotin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-02T13:45:01Z",
    "updated_at": "2022-11-02T13:56:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "Offisite proposed solutions:\r\n\r\n1. A separate function\r\n2. Expose property ring\r\n3. Backend (Nim) provided property\r\n4. Proxy model (either in QML or Nim)\r\n```qml\r\nSortFilterProxyModel {\r\n  model: userModel\r\n  roles: ProxyRolre {\r\n    name: \"colorHash\"\r\n    value: model.ensName ? null : model.colorHashJson\r\n  }\r\n}\r\n```\r\n5. Proxy object\r\n```qml\r\n// ProfileLogic.qml\r\nQtObject {\r\n    id: profile\r\n    property string ensName\r\n    property var colorHashJson\r\n    readonly property bool showRing: !ensName\r\n    readonly property var colorHash: showRing ? colorHashJson : null\r\n}\r\n\r\n// ProfileHeader.qml\r\nUserProfile {\r\n    showRing: profile.showRing\r\n}\r\n```\r\n\r\n6. Singleton logic-containing stateless objects\r\n```qml\r\n// ProfileLogic.qml\r\nQtObject {\r\n  function showRing(ensName) {\r\n    return !ensName\r\n  }\r\n}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1300427960/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1521299439",
    "html_url": "https://github.com/status-im/status-desktop/issues/7537#issuecomment-1521299439",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/7537",
    "id": 1521299439,
    "node_id": "IC_kwDOD5KrTM5arS_v",
    "user": {
      "login": "osmaczko",
      "id": 33099791,
      "node_id": "MDQ6VXNlcjMzMDk5Nzkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/33099791?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/osmaczko",
      "html_url": "https://github.com/osmaczko",
      "followers_url": "https://api.github.com/users/osmaczko/followers",
      "following_url": "https://api.github.com/users/osmaczko/following{/other_user}",
      "gists_url": "https://api.github.com/users/osmaczko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/osmaczko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/osmaczko/subscriptions",
      "organizations_url": "https://api.github.com/users/osmaczko/orgs",
      "repos_url": "https://api.github.com/users/osmaczko/repos",
      "events_url": "https://api.github.com/users/osmaczko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/osmaczko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-25T07:37:32Z",
    "updated_at": "2023-04-25T07:37:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "We still have logic duplication in presentation layer, but we have made significant improvements in the meantime. Closing, due to prolonged inactivity.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1521299439/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
