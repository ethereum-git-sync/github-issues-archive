{
  "url": "https://api.github.com/repos/status-im/status-desktop/issues/2768",
  "repository_url": "https://api.github.com/repos/status-im/status-desktop",
  "labels_url": "https://api.github.com/repos/status-im/status-desktop/issues/2768/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-desktop/issues/2768/comments",
  "events_url": "https://api.github.com/repos/status-im/status-desktop/issues/2768/events",
  "html_url": "https://github.com/status-im/status-desktop/issues/2768",
  "id": 930452416,
  "node_id": "MDU6SXNzdWU5MzA0NTI0MTY=",
  "number": 2768,
  "title": "[Windows] Clicking notification for 1x1 chat from notification center does not open the app",
  "user": {
    "login": "anastasiyaig",
    "id": 82375995,
    "node_id": "MDQ6VXNlcjgyMzc1OTk1",
    "avatar_url": "https://avatars.githubusercontent.com/u/82375995?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/anastasiyaig",
    "html_url": "https://github.com/anastasiyaig",
    "followers_url": "https://api.github.com/users/anastasiyaig/followers",
    "following_url": "https://api.github.com/users/anastasiyaig/following{/other_user}",
    "gists_url": "https://api.github.com/users/anastasiyaig/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/anastasiyaig/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/anastasiyaig/subscriptions",
    "organizations_url": "https://api.github.com/users/anastasiyaig/orgs",
    "repos_url": "https://api.github.com/users/anastasiyaig/repos",
    "events_url": "https://api.github.com/users/anastasiyaig/events{/privacy}",
    "received_events_url": "https://api.github.com/users/anastasiyaig/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2211665815,
      "node_id": "MDU6TGFiZWwyMjExNjY1ODE1",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/windows",
      "name": "windows",
      "color": "167a78",
      "default": false,
      "description": ""
    },
    {
      "id": 2940749877,
      "node_id": "MDU6TGFiZWwyOTQwNzQ5ODc3",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/push_notifications",
      "name": "push_notifications",
      "color": "963962",
      "default": false,
      "description": ""
    },
    {
      "id": 3047427135,
      "node_id": "MDU6TGFiZWwzMDQ3NDI3MTM1",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/feature",
      "name": "feature",
      "color": "0E8A16",
      "default": false,
      "description": ""
    },
    {
      "id": 3166424543,
      "node_id": "MDU6TGFiZWwzMTY2NDI0NTQz",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/general",
      "name": "general",
      "color": "427672",
      "default": false,
      "description": ""
    },
    {
      "id": 3205515124,
      "node_id": "MDU6TGFiZWwzMjA1NTE1MTI0",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/priority%20F2:%20important",
      "name": "priority F2: important",
      "color": "FBCA04",
      "default": false,
      "description": "a feature the app should have if possible, has high business value but the app can work without it"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2021-06-25T19:37:40Z",
  "updated_at": "2021-08-16T15:20:04Z",
  "closed_at": "2021-08-16T15:20:04Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "1. install any build to windows and create account there\r\n2. install a build to mobile and create account there\r\n3. add both to contacts\r\n4. collapse the windows app \r\n5. from mobile -> send a message to 1x1 chat\r\n6. on windows do not click push notification (close it)\r\n7. open notification center and click the notification from there\r\n\r\n\r\n\r\nhttps://user-images.githubusercontent.com/82375995/123476835-e465f600-d605-11eb-9d8e-683223481997.mov\r\n\r\n",
  "closed_by": {
    "login": "iurimatias",
    "id": 176720,
    "node_id": "MDQ6VXNlcjE3NjcyMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176720?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iurimatias",
    "html_url": "https://github.com/iurimatias",
    "followers_url": "https://api.github.com/users/iurimatias/followers",
    "following_url": "https://api.github.com/users/iurimatias/following{/other_user}",
    "gists_url": "https://api.github.com/users/iurimatias/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iurimatias/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iurimatias/subscriptions",
    "organizations_url": "https://api.github.com/users/iurimatias/orgs",
    "repos_url": "https://api.github.com/users/iurimatias/repos",
    "events_url": "https://api.github.com/users/iurimatias/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iurimatias/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/2768/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-desktop/issues/2768/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/880467168",
    "html_url": "https://github.com/status-im/status-desktop/issues/2768#issuecomment-880467168",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/2768",
    "id": 880467168,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg4MDQ2NzE2OA==",
    "user": {
      "login": "pinebit",
      "id": 6468078,
      "node_id": "MDQ6VXNlcjY0NjgwNzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6468078?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pinebit",
      "html_url": "https://github.com/pinebit",
      "followers_url": "https://api.github.com/users/pinebit/followers",
      "following_url": "https://api.github.com/users/pinebit/following{/other_user}",
      "gists_url": "https://api.github.com/users/pinebit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pinebit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pinebit/subscriptions",
      "organizations_url": "https://api.github.com/users/pinebit/orgs",
      "repos_url": "https://api.github.com/users/pinebit/repos",
      "events_url": "https://api.github.com/users/pinebit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pinebit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-15T07:34:02Z",
    "updated_at": "2021-07-15T07:46:41Z",
    "author_association": "NONE",
    "body": "@iurimatias @anastasiyaig \r\nHere is my research on this topic.\r\n\r\n1. Currently we are making toasts via SystemTrayIcon component, which in turn uses `Shell_NotifyIcon` WINAPI. This method is designed to show intermediate toast on the system tray icon and it is not meant to interact with Windows \"Action Center\".\r\nhttps://code.woboq.org/qt5/qtbase/src/plugins/platforms/windows/qwindowssystemtrayicon.cpp.html#291\r\n\r\n2. In previous projects we used 3rdparty library called SnoreNotify with SnoreToast backend (plugin) that essentially did the same as 1. and has the same effect described in this ticket.\r\nhttps://github.com/TheOneRing/Snoretoast\r\n\r\n3. The proper way of integration with Windows \"Action Center\" is to follow thes guidelines:\r\nhttps://docs.microsoft.com/en-us/windows/apps/design/shell/tiles-and-notifications/send-local-toast-desktop-cpp-wrl\r\nhttps://docs.microsoft.com/en-us/windows/apps/design/shell/tiles-and-notifications/toast-desktop-apps\r\nwhich is not trivial, requires the installer to register COM, add app shortcut, the app must accept command line arguments, etc. \r\nObviously we cannot do that from QML and probably not from NIM. Therefore a bit of C++ or C# would be required.\r\n\r\n4. If you check, for instance, how Telegram does it:\r\nhttps://github.com/telegramdesktop/tdesktop/blob/dev/Telegram/SourceFiles/platform/win/notifications_manager_win.cpp\r\nhttps://github.com/telegramdesktop/tdesktop/blob/dev/Telegram/SourceFiles/platform/win/windows_app_user_model_id.cpp\r\nit follows the approach described in 3, and it manages all COM and app shortcut stuff in runtime by patching Windows Registry.\r\nAlso, notice how they implemented this for different platforms: Linux, Mac and Windows. One this thing deserves a dedicated project...\r\n\r\nTo me the only proper way to show toasts is to clone Telegram's implementation, express it in NIM(?) or introduce a C++ library that will be linked to NIM client. I do not see an easy-to-do workaround that can be done quickly in one day and make this thing magically working. Cloning Telegram's behavior would be an epic IMO, unless we find a 3rdparty library for C++/NIM that implemented that already in a cross-platform way.\r\n\r\nWhat's your take on this? Let's take it to Discord to discuss.\r\n\r\nUPD: there is one GoLang implementation: https://github.com/go-toast/toast\r\nwhich looks very promising and may work for the scenario from this ticket.\r\nThere is a derived project https://github.com/martinlindhe/notify that make it cross-platform.\r\nSo, technically we can add this as a dynamic library (similar to status-go), or use it as executable.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/880467168/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/880631147",
    "html_url": "https://github.com/status-im/status-desktop/issues/2768#issuecomment-880631147",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/2768",
    "id": 880631147,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg4MDYzMTE0Nw==",
    "user": {
      "login": "iurimatias",
      "id": 176720,
      "node_id": "MDQ6VXNlcjE3NjcyMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176720?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iurimatias",
      "html_url": "https://github.com/iurimatias",
      "followers_url": "https://api.github.com/users/iurimatias/followers",
      "following_url": "https://api.github.com/users/iurimatias/following{/other_user}",
      "gists_url": "https://api.github.com/users/iurimatias/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iurimatias/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iurimatias/subscriptions",
      "organizations_url": "https://api.github.com/users/iurimatias/orgs",
      "repos_url": "https://api.github.com/users/iurimatias/repos",
      "events_url": "https://api.github.com/users/iurimatias/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iurimatias/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-15T11:51:14Z",
    "updated_at": "2021-07-15T11:51:14Z",
    "author_association": "MEMBER",
    "body": "thanks for the detailed finding sin the ticket. Given the reward/effort for seems low, specially compared to other things we can do instead, I think we should push this issue back, mark is as a feature, and do it at some point later, it does seem this feature needs other things done first in the meanwhile anyway such as the installer etc..",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/880631147/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/899596578",
    "html_url": "https://github.com/status-im/status-desktop/issues/2768#issuecomment-899596578",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/2768",
    "id": 899596578,
    "node_id": "IC_kwDOD5KrTM41nsEi",
    "user": {
      "login": "iurimatias",
      "id": 176720,
      "node_id": "MDQ6VXNlcjE3NjcyMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176720?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iurimatias",
      "html_url": "https://github.com/iurimatias",
      "followers_url": "https://api.github.com/users/iurimatias/followers",
      "following_url": "https://api.github.com/users/iurimatias/following{/other_user}",
      "gists_url": "https://api.github.com/users/iurimatias/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iurimatias/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iurimatias/subscriptions",
      "organizations_url": "https://api.github.com/users/iurimatias/orgs",
      "repos_url": "https://api.github.com/users/iurimatias/repos",
      "events_url": "https://api.github.com/users/iurimatias/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iurimatias/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-16T15:20:04Z",
    "updated_at": "2021-08-16T15:20:04Z",
    "author_association": "MEMBER",
    "body": "closed in favour of #2996",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/899596578/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
