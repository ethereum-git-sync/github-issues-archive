{
  "url": "https://api.github.com/repos/status-im/status-desktop/issues/9218",
  "repository_url": "https://api.github.com/repos/status-im/status-desktop",
  "labels_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218/comments",
  "events_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218/events",
  "html_url": "https://github.com/status-im/status-desktop/issues/9218",
  "id": 1551075196,
  "node_id": "I_kwDOD5KrTM5cc4d8",
  "number": 9218,
  "title": "Badge and new message line doesn't appear when messages are fetched that are a little older than most recent",
  "user": {
    "login": "jrainville",
    "id": 11926403,
    "node_id": "MDQ6VXNlcjExOTI2NDAz",
    "avatar_url": "https://avatars.githubusercontent.com/u/11926403?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jrainville",
    "html_url": "https://github.com/jrainville",
    "followers_url": "https://api.github.com/users/jrainville/followers",
    "following_url": "https://api.github.com/users/jrainville/following{/other_user}",
    "gists_url": "https://api.github.com/users/jrainville/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jrainville/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jrainville/subscriptions",
    "organizations_url": "https://api.github.com/users/jrainville/orgs",
    "repos_url": "https://api.github.com/users/jrainville/repos",
    "events_url": "https://api.github.com/users/jrainville/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jrainville/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2036563458,
      "node_id": "MDU6TGFiZWwyMDM2NTYzNDU4",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    },
    {
      "id": 3205510054,
      "node_id": "MDU6TGFiZWwzMjA1NTEwMDU0",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/priority%201:%20high",
      "name": "priority 1: high",
      "color": "D93F0B",
      "default": false,
      "description": "an issue that is extremely important to fix, that interferes with the majority of users, occurs ofte"
    },
    {
      "id": 3904302702,
      "node_id": "LA_kwDOD5KrTM7otu5u",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/E:Bugfixes",
      "name": "E:Bugfixes",
      "color": "11DEC5",
      "default": false,
      "description": ""
    },
    {
      "id": 4220089404,
      "node_id": "LA_kwDOD5KrTM77iXQ8",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/S:3",
      "name": "S:3",
      "color": "03A6A2",
      "default": false,
      "description": "We know what needs to be done, some extra steps, but thatâ€™s it, little to no unknowns"
    },
    {
      "id": 4548141040,
      "node_id": "LA_kwDOD5KrTM8AAAABDxcf8A",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/messenger-team",
      "name": "messenger-team",
      "color": "232858",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 15,
  "created_at": "2023-01-20T15:47:04Z",
  "updated_at": "2023-04-25T13:03:58Z",
  "closed_at": "2023-04-25T13:03:58Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "# Bug Report\r\n\r\n## Description\r\n\r\nThis might be hard to reproduce without tinkering with the code.\r\n\r\nIf you have a chat where the message fetching from store nodes is unreliable, the messages might come in the wrong order.\r\n\r\nWhat happened was that a recent message came in, I got the badge for it and read the message. I went to another chat. Later, I receive an OS notification for a \"new message\", but no badge appeared. I checked the channel where the message was. It was an older message (but not super old, just like the second in the list). \r\n\r\nEven though it's not the most recent message, it should still produce the unread badge and the new message line, since I didn't read that message.\r\n\r\nI assume the issue is desktop side, but it could be status-go since it's what tells us we have unread message. It might be that we mark as read wrongly though\r\n\r\n## Steps to reproduce\r\n\r\nThere is no way to get this reliably using the app normally,\r\n\r\nI'd recommend modifying the code to manually force the behavior. Maybe use a timer to send a first fake message, then another a bit later and force the second message to have a clock lower than the first.\r\n\r\n### Additional Information\r\n\r\n- Status desktop version: 0.9RC3\r\n\r\n",
  "closed_by": {
    "login": "iurimatias",
    "id": 176720,
    "node_id": "MDQ6VXNlcjE3NjcyMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176720?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iurimatias",
    "html_url": "https://github.com/iurimatias",
    "followers_url": "https://api.github.com/users/iurimatias/followers",
    "following_url": "https://api.github.com/users/iurimatias/following{/other_user}",
    "gists_url": "https://api.github.com/users/iurimatias/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iurimatias/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iurimatias/subscriptions",
    "organizations_url": "https://api.github.com/users/iurimatias/orgs",
    "repos_url": "https://api.github.com/users/iurimatias/repos",
    "events_url": "https://api.github.com/users/iurimatias/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iurimatias/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/9218/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1398592569",
    "html_url": "https://github.com/status-im/status-desktop/issues/9218#issuecomment-1398592569",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218",
    "id": 1398592569,
    "node_id": "IC_kwDOD5KrTM5TXNQ5",
    "user": {
      "login": "caybro",
      "id": 5377645,
      "node_id": "MDQ6VXNlcjUzNzc2NDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5377645?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/caybro",
      "html_url": "https://github.com/caybro",
      "followers_url": "https://api.github.com/users/caybro/followers",
      "following_url": "https://api.github.com/users/caybro/following{/other_user}",
      "gists_url": "https://api.github.com/users/caybro/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/caybro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/caybro/subscriptions",
      "organizations_url": "https://api.github.com/users/caybro/orgs",
      "repos_url": "https://api.github.com/users/caybro/repos",
      "events_url": "https://api.github.com/users/caybro/events{/privacy}",
      "received_events_url": "https://api.github.com/users/caybro/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-20T15:56:11Z",
    "updated_at": "2023-01-20T15:56:11Z",
    "author_association": "MEMBER",
    "body": "![image_20-01-2023_16-54-23](https://user-images.githubusercontent.com/5377645/213744484-01d45485-41eb-4c91-b8d6-fba7276d0f03.png)\r\n\r\nSimilar case here, the marker says \"5 messages\" while there's really only one. The problem is that this 1 new message arrived later, only after I'd sent the 4 below. Should my own messages also count as unread?",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1398592569/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1410209129",
    "html_url": "https://github.com/status-im/status-desktop/issues/9218#issuecomment-1410209129",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218",
    "id": 1410209129,
    "node_id": "IC_kwDOD5KrTM5UDhVp",
    "user": {
      "login": "osmaczko",
      "id": 33099791,
      "node_id": "MDQ6VXNlcjMzMDk5Nzkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/33099791?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/osmaczko",
      "html_url": "https://github.com/osmaczko",
      "followers_url": "https://api.github.com/users/osmaczko/followers",
      "following_url": "https://api.github.com/users/osmaczko/following{/other_user}",
      "gists_url": "https://api.github.com/users/osmaczko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/osmaczko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/osmaczko/subscriptions",
      "organizations_url": "https://api.github.com/users/osmaczko/orgs",
      "repos_url": "https://api.github.com/users/osmaczko/repos",
      "events_url": "https://api.github.com/users/osmaczko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/osmaczko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-31T11:44:22Z",
    "updated_at": "2023-01-31T11:44:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "> ![image_20-01-2023_16-54-23](https://user-images.githubusercontent.com/5377645/213744484-01d45485-41eb-4c91-b8d6-fba7276d0f03.png)\r\n> \r\n> Similar case here, the marker says \"5 messages\" while there's really only one. The problem is that this 1 new message arrived later, only after I'd sent the 4 below. Should my own messages also count as unread?\r\n\r\nI would say yes. IMO displaying \"1 new message\" and seeing multiple messages below the marker would be more surprising to the ordinary user who doesn't probably understand the technicalities of why messages may come out of order.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1410209129/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1410215580",
    "html_url": "https://github.com/status-im/status-desktop/issues/9218#issuecomment-1410215580",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218",
    "id": 1410215580,
    "node_id": "IC_kwDOD5KrTM5UDi6c",
    "user": {
      "login": "osmaczko",
      "id": 33099791,
      "node_id": "MDQ6VXNlcjMzMDk5Nzkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/33099791?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/osmaczko",
      "html_url": "https://github.com/osmaczko",
      "followers_url": "https://api.github.com/users/osmaczko/followers",
      "following_url": "https://api.github.com/users/osmaczko/following{/other_user}",
      "gists_url": "https://api.github.com/users/osmaczko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/osmaczko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/osmaczko/subscriptions",
      "organizations_url": "https://api.github.com/users/osmaczko/orgs",
      "repos_url": "https://api.github.com/users/osmaczko/repos",
      "events_url": "https://api.github.com/users/osmaczko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/osmaczko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-31T11:50:29Z",
    "updated_at": "2023-01-31T11:50:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I assume the issue is desktop side, but it could be status-go since it's what tells us we have unread message.\r\n\r\nI would say it is rather a status-go issue because we get the info about unread messages count from there.\r\n\r\n>  It might be that we mark as read wrongly though\r\n\r\nIt's unlikely. If the chat is not active it can't mark messages as read even if scrolled to the most recent message. Unless something has changed in the meantime..",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1410215580/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1410227968",
    "html_url": "https://github.com/status-im/status-desktop/issues/9218#issuecomment-1410227968",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218",
    "id": 1410227968,
    "node_id": "IC_kwDOD5KrTM5UDl8A",
    "user": {
      "login": "MishkaRogachev",
      "id": 2522130,
      "node_id": "MDQ6VXNlcjI1MjIxMzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2522130?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MishkaRogachev",
      "html_url": "https://github.com/MishkaRogachev",
      "followers_url": "https://api.github.com/users/MishkaRogachev/followers",
      "following_url": "https://api.github.com/users/MishkaRogachev/following{/other_user}",
      "gists_url": "https://api.github.com/users/MishkaRogachev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MishkaRogachev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MishkaRogachev/subscriptions",
      "organizations_url": "https://api.github.com/users/MishkaRogachev/orgs",
      "repos_url": "https://api.github.com/users/MishkaRogachev/repos",
      "events_url": "https://api.github.com/users/MishkaRogachev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MishkaRogachev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-31T12:01:37Z",
    "updated_at": "2023-01-31T12:01:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "From the user's perspective, if we got a new message with timestamp earlier, what exactly we should show to user?\r\n1) No new message marker because we already gone forward in the chat\r\n2) New message marker before the new arrived message with right number (one in @caybro 's case) and maybe some extra-highting for the new messages(s)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1410227968/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1410239921",
    "html_url": "https://github.com/status-im/status-desktop/issues/9218#issuecomment-1410239921",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218",
    "id": 1410239921,
    "node_id": "IC_kwDOD5KrTM5UDo2x",
    "user": {
      "login": "osmaczko",
      "id": 33099791,
      "node_id": "MDQ6VXNlcjMzMDk5Nzkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/33099791?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/osmaczko",
      "html_url": "https://github.com/osmaczko",
      "followers_url": "https://api.github.com/users/osmaczko/followers",
      "following_url": "https://api.github.com/users/osmaczko/following{/other_user}",
      "gists_url": "https://api.github.com/users/osmaczko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/osmaczko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/osmaczko/subscriptions",
      "organizations_url": "https://api.github.com/users/osmaczko/orgs",
      "repos_url": "https://api.github.com/users/osmaczko/repos",
      "events_url": "https://api.github.com/users/osmaczko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/osmaczko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-31T12:10:47Z",
    "updated_at": "2023-01-31T12:14:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "> From the user's perspective, if we got a new message with timestamp earlier, what exactly we should show to user?\r\n> \r\n> 1. No new message marker because we already gone forward in the chat\r\n> 2. New message marker before the new arrived message with right number (one in @caybro 's case) and maybe some extra-highting for the new messages(s)\r\n\r\nThe question is, should the new message with the older clock be marked as read if we have already marked more recent messages as read? The source of truth is status-go, new messages marker will always point to the first unread message, also the chat will be highlighted when unreadMessagesCount > 0.\r\n\r\nIMO we should NOT ignore new messages with the older clock, otherwise, the user can miss some important messages. It is better to go twice through the same messages than miss the ones that would have been automatically marked as read.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1410239921/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1411594866",
    "html_url": "https://github.com/status-im/status-desktop/issues/9218#issuecomment-1411594866",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218",
    "id": 1411594866,
    "node_id": "IC_kwDOD5KrTM5UIzpy",
    "user": {
      "login": "MishkaRogachev",
      "id": 2522130,
      "node_id": "MDQ6VXNlcjI1MjIxMzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2522130?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MishkaRogachev",
      "html_url": "https://github.com/MishkaRogachev",
      "followers_url": "https://api.github.com/users/MishkaRogachev/followers",
      "following_url": "https://api.github.com/users/MishkaRogachev/following{/other_user}",
      "gists_url": "https://api.github.com/users/MishkaRogachev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MishkaRogachev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MishkaRogachev/subscriptions",
      "organizations_url": "https://api.github.com/users/MishkaRogachev/orgs",
      "repos_url": "https://api.github.com/users/MishkaRogachev/repos",
      "events_url": "https://api.github.com/users/MishkaRogachev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MishkaRogachev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-01T07:42:04Z",
    "updated_at": "2023-02-01T08:50:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "Here `10` and `12` messages were delivered later, so wrong is only number on the NewMessageMarker's badge? IMO it would be more confusing, if we'll display `2 missed messages since ...` on the marker what is above 6 messages\r\n\r\n<img width=\"1010\" alt=\"Screenshot 2023-02-01 at 11 38 55\" src=\"https://user-images.githubusercontent.com/2522130/215980501-f52e7a29-89cb-4f08-a679-4509007c26cd.png\">\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1411594866/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1411674083",
    "html_url": "https://github.com/status-im/status-desktop/issues/9218#issuecomment-1411674083",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218",
    "id": 1411674083,
    "node_id": "IC_kwDOD5KrTM5UJG_j",
    "user": {
      "login": "MishkaRogachev",
      "id": 2522130,
      "node_id": "MDQ6VXNlcjI1MjIxMzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2522130?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MishkaRogachev",
      "html_url": "https://github.com/MishkaRogachev",
      "followers_url": "https://api.github.com/users/MishkaRogachev/followers",
      "following_url": "https://api.github.com/users/MishkaRogachev/following{/other_user}",
      "gists_url": "https://api.github.com/users/MishkaRogachev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MishkaRogachev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MishkaRogachev/subscriptions",
      "organizations_url": "https://api.github.com/users/MishkaRogachev/orgs",
      "repos_url": "https://api.github.com/users/MishkaRogachev/repos",
      "events_url": "https://api.github.com/users/MishkaRogachev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MishkaRogachev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-01T08:46:33Z",
    "updated_at": "2023-02-01T08:46:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "@osmaczko is this behaviour expected? When we open chat with new message marker every new message updates unread count?\r\n\r\nhttps://user-images.githubusercontent.com/2522130/215994039-e11b3a0f-ce5a-4cd6-a5cf-d9f2699c3919.mov\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1411674083/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1411691762",
    "html_url": "https://github.com/status-im/status-desktop/issues/9218#issuecomment-1411691762",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218",
    "id": 1411691762,
    "node_id": "IC_kwDOD5KrTM5UJLTy",
    "user": {
      "login": "osmaczko",
      "id": 33099791,
      "node_id": "MDQ6VXNlcjMzMDk5Nzkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/33099791?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/osmaczko",
      "html_url": "https://github.com/osmaczko",
      "followers_url": "https://api.github.com/users/osmaczko/followers",
      "following_url": "https://api.github.com/users/osmaczko/following{/other_user}",
      "gists_url": "https://api.github.com/users/osmaczko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/osmaczko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/osmaczko/subscriptions",
      "organizations_url": "https://api.github.com/users/osmaczko/orgs",
      "repos_url": "https://api.github.com/users/osmaczko/repos",
      "events_url": "https://api.github.com/users/osmaczko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/osmaczko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-01T08:59:58Z",
    "updated_at": "2023-02-01T08:59:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "> IMO it would be more confusing, if we'll display `2 missed messages since ...` on the marker what is above 6 messages\r\n\r\nExactly\r\n\r\n> Here 10 and 12 messages were delivered later, so wrong is only number on the NewMessageMarker's badge?\r\n\r\nThe number is ok, see above",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1411691762/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1411695783",
    "html_url": "https://github.com/status-im/status-desktop/issues/9218#issuecomment-1411695783",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218",
    "id": 1411695783,
    "node_id": "IC_kwDOD5KrTM5UJMSn",
    "user": {
      "login": "osmaczko",
      "id": 33099791,
      "node_id": "MDQ6VXNlcjMzMDk5Nzkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/33099791?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/osmaczko",
      "html_url": "https://github.com/osmaczko",
      "followers_url": "https://api.github.com/users/osmaczko/followers",
      "following_url": "https://api.github.com/users/osmaczko/following{/other_user}",
      "gists_url": "https://api.github.com/users/osmaczko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/osmaczko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/osmaczko/subscriptions",
      "organizations_url": "https://api.github.com/users/osmaczko/orgs",
      "repos_url": "https://api.github.com/users/osmaczko/repos",
      "events_url": "https://api.github.com/users/osmaczko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/osmaczko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-01T09:02:42Z",
    "updated_at": "2023-02-01T09:02:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "> @osmaczko is this behaviour expected? When we open chat with new message marker every new message updates unread count?\r\n> \r\n>  Screen.Recording.2023-02-01.at.12.43.42.mov\r\n\r\nYes, the number is simply the count of messages under the marker.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1411695783/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1412146036",
    "html_url": "https://github.com/status-im/status-desktop/issues/9218#issuecomment-1412146036",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218",
    "id": 1412146036,
    "node_id": "IC_kwDOD5KrTM5UK6N0",
    "user": {
      "login": "jrainville",
      "id": 11926403,
      "node_id": "MDQ6VXNlcjExOTI2NDAz",
      "avatar_url": "https://avatars.githubusercontent.com/u/11926403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jrainville",
      "html_url": "https://github.com/jrainville",
      "followers_url": "https://api.github.com/users/jrainville/followers",
      "following_url": "https://api.github.com/users/jrainville/following{/other_user}",
      "gists_url": "https://api.github.com/users/jrainville/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jrainville/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jrainville/subscriptions",
      "organizations_url": "https://api.github.com/users/jrainville/orgs",
      "repos_url": "https://api.github.com/users/jrainville/repos",
      "events_url": "https://api.github.com/users/jrainville/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jrainville/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-01T14:24:38Z",
    "updated_at": "2023-02-01T14:24:38Z",
    "author_association": "MEMBER",
    "body": "So in the end, the behaviour we have right now seems ok? Maybe the original issue of the marker and badge not appearing has been fixed? Or maybe it's just too hard to reproduce?",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1412146036/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1412236444",
    "html_url": "https://github.com/status-im/status-desktop/issues/9218#issuecomment-1412236444",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218",
    "id": 1412236444,
    "node_id": "IC_kwDOD5KrTM5ULQSc",
    "user": {
      "login": "MishkaRogachev",
      "id": 2522130,
      "node_id": "MDQ6VXNlcjI1MjIxMzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2522130?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MishkaRogachev",
      "html_url": "https://github.com/MishkaRogachev",
      "followers_url": "https://api.github.com/users/MishkaRogachev/followers",
      "following_url": "https://api.github.com/users/MishkaRogachev/following{/other_user}",
      "gists_url": "https://api.github.com/users/MishkaRogachev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MishkaRogachev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MishkaRogachev/subscriptions",
      "organizations_url": "https://api.github.com/users/MishkaRogachev/orgs",
      "repos_url": "https://api.github.com/users/MishkaRogachev/repos",
      "events_url": "https://api.github.com/users/MishkaRogachev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MishkaRogachev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-01T15:19:24Z",
    "updated_at": "2023-02-01T15:27:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "> > @osmaczko is this behaviour expected? When we open chat with new message marker every new message updates unread count?\r\n> > Screen.Recording.2023-02-01.at.12.43.42.mov\r\n> \r\n> Yes, the number is simply the count of messages under the marker.\r\n\r\nThanks! So only one problem left - missing marker in case when we receive rotten message",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1412236444/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1412264481",
    "html_url": "https://github.com/status-im/status-desktop/issues/9218#issuecomment-1412264481",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218",
    "id": 1412264481,
    "node_id": "IC_kwDOD5KrTM5ULXIh",
    "user": {
      "login": "MishkaRogachev",
      "id": 2522130,
      "node_id": "MDQ6VXNlcjI1MjIxMzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2522130?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MishkaRogachev",
      "html_url": "https://github.com/MishkaRogachev",
      "followers_url": "https://api.github.com/users/MishkaRogachev/followers",
      "following_url": "https://api.github.com/users/MishkaRogachev/following{/other_user}",
      "gists_url": "https://api.github.com/users/MishkaRogachev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MishkaRogachev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MishkaRogachev/subscriptions",
      "organizations_url": "https://api.github.com/users/MishkaRogachev/orgs",
      "repos_url": "https://api.github.com/users/MishkaRogachev/repos",
      "events_url": "https://api.github.com/users/MishkaRogachev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MishkaRogachev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-01T15:36:53Z",
    "updated_at": "2023-02-01T15:36:53Z",
    "author_association": "CONTRIBUTOR",
    "body": "> So in the end, the behaviour we have right now seems ok? Maybe the original issue of the marker and badge not appearing has been fixed? Or maybe it's just too hard to reproduce?\r\n\r\nI'm not sure that origin issue is gone. I've made a test there 1/2 of messages sent with clock downshifted and it behave in same way",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1412264481/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1413637955",
    "html_url": "https://github.com/status-im/status-desktop/issues/9218#issuecomment-1413637955",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218",
    "id": 1413637955,
    "node_id": "IC_kwDOD5KrTM5UQmdD",
    "user": {
      "login": "MishkaRogachev",
      "id": 2522130,
      "node_id": "MDQ6VXNlcjI1MjIxMzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2522130?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MishkaRogachev",
      "html_url": "https://github.com/MishkaRogachev",
      "followers_url": "https://api.github.com/users/MishkaRogachev/followers",
      "following_url": "https://api.github.com/users/MishkaRogachev/following{/other_user}",
      "gists_url": "https://api.github.com/users/MishkaRogachev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MishkaRogachev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MishkaRogachev/subscriptions",
      "organizations_url": "https://api.github.com/users/MishkaRogachev/orgs",
      "repos_url": "https://api.github.com/users/MishkaRogachev/repos",
      "events_url": "https://api.github.com/users/MishkaRogachev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MishkaRogachev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-02T12:09:51Z",
    "updated_at": "2023-02-02T12:41:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "\r\nFinally got it!\r\n\r\n<img width=\"1008\" alt=\"Screenshot 2023-02-02 at 16 08 00\" src=\"https://user-images.githubusercontent.com/2522130/216320609-d5f4ea8f-655e-4205-a078-b8ac2d4353d0.png\">\r\n\r\nHere `3` was sent after `2` with artificially downshifted clock. New message marker should be above `3`\r\n\r\n<img width=\"516\" alt=\"Screenshot 2023-02-02 at 16 38 41\" src=\"https://user-images.githubusercontent.com/2522130/216327385-7eefe9b9-ec33-4299-b295-2113feae88ff.png\">\r\n\r\nAnd here `5` is last received message which is also unseen. No new message marker - it should be above `5`",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1413637955/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1414031142",
    "html_url": "https://github.com/status-im/status-desktop/issues/9218#issuecomment-1414031142",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218",
    "id": 1414031142,
    "node_id": "IC_kwDOD5KrTM5USGcm",
    "user": {
      "login": "MishkaRogachev",
      "id": 2522130,
      "node_id": "MDQ6VXNlcjI1MjIxMzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2522130?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MishkaRogachev",
      "html_url": "https://github.com/MishkaRogachev",
      "followers_url": "https://api.github.com/users/MishkaRogachev/followers",
      "following_url": "https://api.github.com/users/MishkaRogachev/following{/other_user}",
      "gists_url": "https://api.github.com/users/MishkaRogachev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MishkaRogachev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MishkaRogachev/subscriptions",
      "organizations_url": "https://api.github.com/users/MishkaRogachev/orgs",
      "repos_url": "https://api.github.com/users/MishkaRogachev/repos",
      "events_url": "https://api.github.com/users/MishkaRogachev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MishkaRogachev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-02T16:35:28Z",
    "updated_at": "2023-02-02T16:36:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "@osmaczko i've fixed logic when chat is not visible... And it's still have problem with new message marker position. \r\n\r\nhttps://user-images.githubusercontent.com/2522130/216385259-d577d208-de33-4f06-a64e-fef671963896.mov\r\n\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1414031142/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1415736416",
    "html_url": "https://github.com/status-im/status-desktop/issues/9218#issuecomment-1415736416",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9218",
    "id": 1415736416,
    "node_id": "IC_kwDOD5KrTM5UYmxg",
    "user": {
      "login": "MishkaRogachev",
      "id": 2522130,
      "node_id": "MDQ6VXNlcjI1MjIxMzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2522130?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MishkaRogachev",
      "html_url": "https://github.com/MishkaRogachev",
      "followers_url": "https://api.github.com/users/MishkaRogachev/followers",
      "following_url": "https://api.github.com/users/MishkaRogachev/following{/other_user}",
      "gists_url": "https://api.github.com/users/MishkaRogachev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MishkaRogachev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MishkaRogachev/subscriptions",
      "organizations_url": "https://api.github.com/users/MishkaRogachev/orgs",
      "repos_url": "https://api.github.com/users/MishkaRogachev/repos",
      "events_url": "https://api.github.com/users/MishkaRogachev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MishkaRogachev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-03T11:23:31Z",
    "updated_at": "2023-02-03T11:38:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "UPD: This situation may happen when you open a chat while client is still receiving messages. And if receives a message out of order while chat is already activated, this message is already marked as seen.\r\n\r\n<img width=\"514\" alt=\"Screenshot 2023-02-03 at 15 12 08\" src=\"https://user-images.githubusercontent.com/2522130/216589630-0a2bedf0-56e7-42b6-87d8-3f1c95396bbe.png\">\r\n\r\n```\r\n==================================================================messagesAdded\r\n====================================== msg 7 seen: true\r\n\r\n==================================================================messagesAdded\r\n====================================== msg34 seen: false\r\n====================================== msg5 seen: false\r\n====================================== msg 6 seen: false\r\n====================================== emitNewMessagesAdded\r\n\r\nFirstUnseenMessageID ------------------> 0xcf0dabb6d1dd098fab14327caed20d69839b6a5829685f54e8b7cbbfcc79e8c1 6\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1415736416/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
