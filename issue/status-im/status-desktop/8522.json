{
  "url": "https://api.github.com/repos/status-im/status-desktop/issues/8522",
  "repository_url": "https://api.github.com/repos/status-im/status-desktop",
  "labels_url": "https://api.github.com/repos/status-im/status-desktop/issues/8522/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-desktop/issues/8522/comments",
  "events_url": "https://api.github.com/repos/status-im/status-desktop/issues/8522/events",
  "html_url": "https://github.com/status-im/status-desktop/issues/8522",
  "id": 1469844289,
  "node_id": "I_kwDOD5KrTM5XnAtB",
  "number": 8522,
  "title": "Import tool: figure out a way to handle bot message authors",
  "user": {
    "login": "0x-r4bbit",
    "id": 445106,
    "node_id": "MDQ6VXNlcjQ0NTEwNg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/445106?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/0x-r4bbit",
    "html_url": "https://github.com/0x-r4bbit",
    "followers_url": "https://api.github.com/users/0x-r4bbit/followers",
    "following_url": "https://api.github.com/users/0x-r4bbit/following{/other_user}",
    "gists_url": "https://api.github.com/users/0x-r4bbit/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/0x-r4bbit/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/0x-r4bbit/subscriptions",
    "organizations_url": "https://api.github.com/users/0x-r4bbit/orgs",
    "repos_url": "https://api.github.com/users/0x-r4bbit/repos",
    "events_url": "https://api.github.com/users/0x-r4bbit/events{/privacy}",
    "received_events_url": "https://api.github.com/users/0x-r4bbit/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2036563458,
      "node_id": "MDU6TGFiZWwyMDM2NTYzNDU4",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    },
    {
      "id": 4548141040,
      "node_id": "LA_kwDOD5KrTM8AAAABDxcf8A",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/messenger-team",
      "name": "messenger-team",
      "color": "232858",
      "default": false,
      "description": ""
    },
    {
      "id": 5843949784,
      "node_id": "LA_kwDOD5KrTM8AAAABXFOY2A",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/E:Desktop%20Features%200.16",
      "name": "E:Desktop Features 0.16",
      "color": "B6A98D",
      "default": false,
      "description": "Various features needed in Desktop app overall for 0.16 release"
    },
    {
      "id": 5895745283,
      "node_id": "LA_kwDOD5KrTM8AAAABX2nvAw",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/E:Desktop%20Discord%20Import%20And%20Archive%20Protocol",
      "name": "E:Desktop Discord Import And Archive Protocol",
      "color": "52BC21",
      "default": false,
      "description": "Discord import and Archive protocol related issues"
    },
    {
      "id": 6014763800,
      "node_id": "LA_kwDOD5KrTM8AAAABZoIDGA",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/E:Desktop%20Misc%20Bugfixes",
      "name": "E:Desktop Misc Bugfixes",
      "color": "61D0D9",
      "default": false,
      "description": ""
    },
    {
      "id": 6343085517,
      "node_id": "LA_kwDOD5KrTM8AAAABehPNzQ",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/sprint-12-19",
      "name": "sprint-12-19",
      "color": "FFFFFF",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "borismelnik",
    "id": 82511785,
    "node_id": "MDQ6VXNlcjgyNTExNzg1",
    "avatar_url": "https://avatars.githubusercontent.com/u/82511785?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/borismelnik",
    "html_url": "https://github.com/borismelnik",
    "followers_url": "https://api.github.com/users/borismelnik/followers",
    "following_url": "https://api.github.com/users/borismelnik/following{/other_user}",
    "gists_url": "https://api.github.com/users/borismelnik/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/borismelnik/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/borismelnik/subscriptions",
    "organizations_url": "https://api.github.com/users/borismelnik/orgs",
    "repos_url": "https://api.github.com/users/borismelnik/repos",
    "events_url": "https://api.github.com/users/borismelnik/events{/privacy}",
    "received_events_url": "https://api.github.com/users/borismelnik/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "borismelnik",
      "id": 82511785,
      "node_id": "MDQ6VXNlcjgyNTExNzg1",
      "avatar_url": "https://avatars.githubusercontent.com/u/82511785?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/borismelnik",
      "html_url": "https://github.com/borismelnik",
      "followers_url": "https://api.github.com/users/borismelnik/followers",
      "following_url": "https://api.github.com/users/borismelnik/following{/other_user}",
      "gists_url": "https://api.github.com/users/borismelnik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/borismelnik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/borismelnik/subscriptions",
      "organizations_url": "https://api.github.com/users/borismelnik/orgs",
      "repos_url": "https://api.github.com/users/borismelnik/repos",
      "events_url": "https://api.github.com/users/borismelnik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/borismelnik/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": {
    "url": "https://api.github.com/repos/status-im/status-desktop/milestones/61",
    "html_url": "https://github.com/status-im/status-desktop/milestone/61",
    "labels_url": "https://api.github.com/repos/status-im/status-desktop/milestones/61/labels",
    "id": 8739485,
    "node_id": "MI_kwDOD5KrTM4AhVqd",
    "number": 61,
    "title": "0.16",
    "description": "**1.  Fix bug and stabilise Communities and Messaging functionality**\r\n\r\n**2.  Reduce size of community description metadata**\r\n- better compressions, less duplication\r\n\r\n**3. Use data sync layer (or other mechanism) to improve community description reliability**\r\n- Every time a new user joins the community, the Control Node updates and signs the description.\r\n- Random back off to stop it being too chatty \r\n\r\n**4. Continue work on profile showcase **\r\n\r\n\r\n\r\n**--- Wallet Team ---**\r\n\r\n1. Complete support for Community minted assets\r\n\r\n2. Complete token visibility management screens\r\n\r\n3. Continue working on WalletConnect support\r\n\r\n4. Minor updates to Asset screens\r\n\r\n5. Continue fixing bugs, making optimisations and keeping tech debt low\r\n\r\n\r\n\r\n\r\n",
    "creator": {
      "login": "iurimatias",
      "id": 176720,
      "node_id": "MDQ6VXNlcjE3NjcyMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176720?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iurimatias",
      "html_url": "https://github.com/iurimatias",
      "followers_url": "https://api.github.com/users/iurimatias/followers",
      "following_url": "https://api.github.com/users/iurimatias/following{/other_user}",
      "gists_url": "https://api.github.com/users/iurimatias/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iurimatias/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iurimatias/subscriptions",
      "organizations_url": "https://api.github.com/users/iurimatias/orgs",
      "repos_url": "https://api.github.com/users/iurimatias/repos",
      "events_url": "https://api.github.com/users/iurimatias/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iurimatias/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 164,
    "closed_issues": 119,
    "state": "open",
    "created_at": "2022-12-09T15:06:43Z",
    "updated_at": "2023-12-19T18:25:51Z",
    "due_on": "2024-01-31T08:00:00Z",
    "closed_at": null
  },
  "comments": 0,
  "created_at": "2022-11-30T15:42:47Z",
  "updated_at": "2023-12-19T16:57:38Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Part of https://github.com/status-im/status-desktop/issues/12018\r\n\r\nSomething that has come up while testing the import tool for the final switch.\r\n@iurimatias has imported a channel which in discord looks like this:\r\n\r\n![Screenshot from 2022-11-30 16-32-18](https://user-images.githubusercontent.com/445106/204840204-14ca4c87-7441-4426-8c7b-bc3cb57de003.png)\r\n\r\nAfter importing the messages into Status, the message looks like this:\r\n\r\n![Screenshot from 2022-11-30 16-33-03](https://user-images.githubusercontent.com/445106/204840395-456aca1d-fe98-4922-b905-0b1b20ecaf68.png)\r\n\r\nHere's what the data looks like:\r\n\r\n```json\r\n      {\r\n        \"id\": \"SOME_ID\"\r\n        \"name\": \"Loud Mountainous Macropod@bridge\",\r\n        \"discriminator\": \"0000\",\r\n        \"nickname\": \"jakubgs@gitter\",\r\n        \"color\": null,\r\n        \"isBot\": true,\r\n        \"avatarUrl\": \"https://cdn.discordapp.com/embed/avatars/0.png\"\r\n      },\r\n```\r\nWe're using the author's `name` property so this should not be causing this. \r\nHowever it turns out that there's more message author data with the same `id` that looks like this (in fact, it's the first message of the channel that has this data):\r\n\r\n```json\r\n    {\r\n        \"id\": \"SOME_ID\",\r\n        \"name\": \"jakubgs@gitter\",\r\n        \"discriminator\": \"0000\",\r\n        \"nickname\": \"jakubgs@gitter\",\r\n        \"color\": null,\r\n        \"isBot\": true,\r\n        \"avatarUrl\": \"https://cdn.discordapp.com/avatars/633669913697058816/c367bdc0b5f5593254719b07526e3d93.png?size=512\"\r\n      },\r\n```\r\n\r\nSo what happens here is that, when the import tool runs into the first message, it'll save the author data (where `name` and `nickname` happen to be the same), then later when it runs into the message where the author data has the same ID but different `name`, it will just associate the already stored author data with that message (which is correct cause it's the same author ID).\r\n\r\nThis is a special case for messages that originate from bots (see `isBot: true`).\r\n\r\nWe need to handle cases where discord messages can have author data where the ID is the same, but the `name` is different (in which case `isBot: true`).\r\n\r\n### Possible solution\r\n\r\nDuring the import, when processing author data, check if `isBot: true` and create a custom author `id` and update the message author id accordingly, such that for every bot message there's a distinct author entry in the database as well.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/8522/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-desktop/issues/8522/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[

]
