{
  "url": "https://api.github.com/repos/status-im/status-desktop/issues/8838",
  "repository_url": "https://api.github.com/repos/status-im/status-desktop",
  "labels_url": "https://api.github.com/repos/status-im/status-desktop/issues/8838/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-desktop/issues/8838/comments",
  "events_url": "https://api.github.com/repos/status-im/status-desktop/issues/8838/events",
  "html_url": "https://github.com/status-im/status-desktop/issues/8838",
  "id": 1500770863,
  "node_id": "I_kwDOD5KrTM5Zc_Iv",
  "number": 8838,
  "title": "Old messages fetched from the store node or import should not go to the front-end",
  "user": {
    "login": "jrainville",
    "id": 11926403,
    "node_id": "MDQ6VXNlcjExOTI2NDAz",
    "avatar_url": "https://avatars.githubusercontent.com/u/11926403?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jrainville",
    "html_url": "https://github.com/jrainville",
    "followers_url": "https://api.github.com/users/jrainville/followers",
    "following_url": "https://api.github.com/users/jrainville/following{/other_user}",
    "gists_url": "https://api.github.com/users/jrainville/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jrainville/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jrainville/subscriptions",
    "organizations_url": "https://api.github.com/users/jrainville/orgs",
    "repos_url": "https://api.github.com/users/jrainville/repos",
    "events_url": "https://api.github.com/users/jrainville/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jrainville/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2987757762,
      "node_id": "MDU6TGFiZWwyOTg3NzU3NzYy",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/to%20analyze",
      "name": "to analyze",
      "color": "5CC421",
      "default": false,
      "description": ""
    },
    {
      "id": 3166254951,
      "node_id": "MDU6TGFiZWwzMTY2MjU0OTUx",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/performance",
      "name": "performance",
      "color": "7F1B66",
      "default": false,
      "description": ""
    },
    {
      "id": 3904301025,
      "node_id": "LA_kwDOD5KrTM7otufh",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/E:PerformanceImprovements",
      "name": "E:PerformanceImprovements",
      "color": "7D613C",
      "default": false,
      "description": ""
    },
    {
      "id": 4548141040,
      "node_id": "LA_kwDOD5KrTM8AAAABDxcf8A",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/messenger-team",
      "name": "messenger-team",
      "color": "232858",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-12-16T19:43:37Z",
  "updated_at": "2022-12-28T08:19:16Z",
  "closed_at": "2022-12-28T08:19:16Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "One of the big reasons why the app feels slow and unresponsive on re-sync or opening, especially after having it closed for a while, is that the messages fetched from the store node all make it to the front-end (Nim).\r\n\r\nIMO, they should be added to the DB, but if they are old, they should stay on the status-go side and not emit a signal.\r\n\r\nWhat happens is we get hundreds of messages that come in to the front end that call the emojiReactions, contact details, getLatestVerificationRequestFrom and other backend functions for each message. Some of those calls should be fixed on the Nim side, because there is probably no reason to call getLatestVerificationRequestFrom for each messages, but still.\r\nAlso, those messages go up to the QML. In theory, if they are not in the current view, they shouldn't render, but we never know.\r\n\r\nThe way to determine what is an old message is up to debate.\r\nI think it should come down to \"is the fetched message newer or older than the oldest message we got from the cursor\", ie would that message show in the chat view, considering the scroll ups the user did.\r\nThere is gonna be edge cases though, since the user might scroll a lot trying to load messages, then the oldest message is very old and we now load all messages fetched from the store, but that would be one channel, instead of all of them.\r\n\r\nThis might also fix this issue https://github.com/status-im/status-desktop/issues/8824\r\n\r\nLet me know what are your ideas, questions or rebuttals for this suggestion.\r\n\r\n",
  "closed_by": {
    "login": "osmaczko",
    "id": 33099791,
    "node_id": "MDQ6VXNlcjMzMDk5Nzkx",
    "avatar_url": "https://avatars.githubusercontent.com/u/33099791?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/osmaczko",
    "html_url": "https://github.com/osmaczko",
    "followers_url": "https://api.github.com/users/osmaczko/followers",
    "following_url": "https://api.github.com/users/osmaczko/following{/other_user}",
    "gists_url": "https://api.github.com/users/osmaczko/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/osmaczko/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/osmaczko/subscriptions",
    "organizations_url": "https://api.github.com/users/osmaczko/orgs",
    "repos_url": "https://api.github.com/users/osmaczko/repos",
    "events_url": "https://api.github.com/users/osmaczko/events{/privacy}",
    "received_events_url": "https://api.github.com/users/osmaczko/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/8838/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-desktop/issues/8838/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1359012659",
    "html_url": "https://github.com/status-im/status-desktop/issues/8838#issuecomment-1359012659",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/8838",
    "id": 1359012659,
    "node_id": "IC_kwDOD5KrTM5RAOMz",
    "user": {
      "login": "osmaczko",
      "id": 33099791,
      "node_id": "MDQ6VXNlcjMzMDk5Nzkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/33099791?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/osmaczko",
      "html_url": "https://github.com/osmaczko",
      "followers_url": "https://api.github.com/users/osmaczko/followers",
      "following_url": "https://api.github.com/users/osmaczko/following{/other_user}",
      "gists_url": "https://api.github.com/users/osmaczko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/osmaczko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/osmaczko/subscriptions",
      "organizations_url": "https://api.github.com/users/osmaczko/orgs",
      "repos_url": "https://api.github.com/users/osmaczko/repos",
      "events_url": "https://api.github.com/users/osmaczko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/osmaczko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-20T08:42:12Z",
    "updated_at": "2022-12-20T08:42:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think this is a good idea. We should load messages only newer than the chat cursor. At first sight, it seems straightforward to implement, and it can be done client-side only.\r\n\r\n> This might also fix this issue https://github.com/status-im/status-desktop/issues/8824\r\n\r\nI don't think it will fix this particular issue. The \"unread\" info comes from status-go and it takes into account all messages, even those not loaded client-side, which makes a lot of sense by the way.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1359012659/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1359184111",
    "html_url": "https://github.com/status-im/status-desktop/issues/8838#issuecomment-1359184111",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/8838",
    "id": 1359184111,
    "node_id": "IC_kwDOD5KrTM5RA4Dv",
    "user": {
      "login": "osmaczko",
      "id": 33099791,
      "node_id": "MDQ6VXNlcjMzMDk5Nzkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/33099791?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/osmaczko",
      "html_url": "https://github.com/osmaczko",
      "followers_url": "https://api.github.com/users/osmaczko/followers",
      "following_url": "https://api.github.com/users/osmaczko/following{/other_user}",
      "gists_url": "https://api.github.com/users/osmaczko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/osmaczko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/osmaczko/subscriptions",
      "organizations_url": "https://api.github.com/users/osmaczko/orgs",
      "repos_url": "https://api.github.com/users/osmaczko/repos",
      "events_url": "https://api.github.com/users/osmaczko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/osmaczko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-20T11:00:46Z",
    "updated_at": "2022-12-20T11:00:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jrainville see: https://github.com/status-im/status-desktop/pull/8854/",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1359184111/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1366458208",
    "html_url": "https://github.com/status-im/status-desktop/issues/8838#issuecomment-1366458208",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/8838",
    "id": 1366458208,
    "node_id": "IC_kwDOD5KrTM5Rcn9g",
    "user": {
      "login": "osmaczko",
      "id": 33099791,
      "node_id": "MDQ6VXNlcjMzMDk5Nzkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/33099791?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/osmaczko",
      "html_url": "https://github.com/osmaczko",
      "followers_url": "https://api.github.com/users/osmaczko/followers",
      "following_url": "https://api.github.com/users/osmaczko/following{/other_user}",
      "gists_url": "https://api.github.com/users/osmaczko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/osmaczko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/osmaczko/subscriptions",
      "organizations_url": "https://api.github.com/users/osmaczko/orgs",
      "repos_url": "https://api.github.com/users/osmaczko/repos",
      "events_url": "https://api.github.com/users/osmaczko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/osmaczko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-28T08:19:16Z",
    "updated_at": "2022-12-28T08:19:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "Implementation task: https://github.com/status-im/status-desktop/issues/8907",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1366458208/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
