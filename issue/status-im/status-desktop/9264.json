{
  "url": "https://api.github.com/repos/status-im/status-desktop/issues/9264",
  "repository_url": "https://api.github.com/repos/status-im/status-desktop",
  "labels_url": "https://api.github.com/repos/status-im/status-desktop/issues/9264/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-desktop/issues/9264/comments",
  "events_url": "https://api.github.com/repos/status-im/status-desktop/issues/9264/events",
  "html_url": "https://github.com/status-im/status-desktop/issues/9264",
  "id": 1555048744,
  "node_id": "I_kwDOD5KrTM5csCko",
  "number": 9264,
  "title": "App crashes on attempt to buy ENS",
  "user": {
    "login": "igor-sirotin",
    "id": 25482501,
    "node_id": "MDQ6VXNlcjI1NDgyNTAx",
    "avatar_url": "https://avatars.githubusercontent.com/u/25482501?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/igor-sirotin",
    "html_url": "https://github.com/igor-sirotin",
    "followers_url": "https://api.github.com/users/igor-sirotin/followers",
    "following_url": "https://api.github.com/users/igor-sirotin/following{/other_user}",
    "gists_url": "https://api.github.com/users/igor-sirotin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/igor-sirotin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/igor-sirotin/subscriptions",
    "organizations_url": "https://api.github.com/users/igor-sirotin/orgs",
    "repos_url": "https://api.github.com/users/igor-sirotin/repos",
    "events_url": "https://api.github.com/users/igor-sirotin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/igor-sirotin/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2036563458,
      "node_id": "MDU6TGFiZWwyMDM2NTYzNDU4",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    },
    {
      "id": 4626946344,
      "node_id": "LA_kwDOD5KrTM8AAAABE8mZKA",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/ens",
      "name": "ens",
      "color": "F37A36",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "igor-sirotin",
    "id": 25482501,
    "node_id": "MDQ6VXNlcjI1NDgyNTAx",
    "avatar_url": "https://avatars.githubusercontent.com/u/25482501?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/igor-sirotin",
    "html_url": "https://github.com/igor-sirotin",
    "followers_url": "https://api.github.com/users/igor-sirotin/followers",
    "following_url": "https://api.github.com/users/igor-sirotin/following{/other_user}",
    "gists_url": "https://api.github.com/users/igor-sirotin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/igor-sirotin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/igor-sirotin/subscriptions",
    "organizations_url": "https://api.github.com/users/igor-sirotin/orgs",
    "repos_url": "https://api.github.com/users/igor-sirotin/repos",
    "events_url": "https://api.github.com/users/igor-sirotin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/igor-sirotin/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "igor-sirotin",
      "id": 25482501,
      "node_id": "MDQ6VXNlcjI1NDgyNTAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25482501?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/igor-sirotin",
      "html_url": "https://github.com/igor-sirotin",
      "followers_url": "https://api.github.com/users/igor-sirotin/followers",
      "following_url": "https://api.github.com/users/igor-sirotin/following{/other_user}",
      "gists_url": "https://api.github.com/users/igor-sirotin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/igor-sirotin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/igor-sirotin/subscriptions",
      "organizations_url": "https://api.github.com/users/igor-sirotin/orgs",
      "repos_url": "https://api.github.com/users/igor-sirotin/repos",
      "events_url": "https://api.github.com/users/igor-sirotin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/igor-sirotin/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-01-24T14:04:52Z",
  "updated_at": "2023-02-06T11:14:12Z",
  "closed_at": "2023-01-30T10:52:56Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "# Bug Report\r\n\r\nThis bug was found while testing #9036.\r\nCheck this comment for details: https://github.com/status-im/status-desktop/pull/9036#issuecomment-1401047536\r\n\r\nThough I tested it on d980c177a4467cbb2fa9277dd6651c369cf783cc, which is behind my changes. \r\nstatus-go is also behind my changes, it points to status-im/status-go@ea46779e98708616201728e422253564809043dc.\r\n\r\n## Steps to reproduce\r\n\r\n1. Create a new account\r\n2. Enable wallet\r\n3. Switch to testnet\r\n4. Go to \"ENS usernames\" settings\r\n5. Input a desired username, note \"Username available\" label\r\n6. Click the arrow button, the app crashes. \r\n\r\n## Details\r\n\r\nThe app crashes when trying to find token by symbol `STT`.\r\nThat happens because token-service `self.tokens` empty.\r\nIt's empty because during initialization `backend.getCachedPrices()` fails with error message \r\n`key not found: AKROUSD`.\r\n\r\nIt seems to be broken after https://github.com/status-im/status-desktop/pull/9093.\r\n\r\n```shell\r\nERR 2023-01-24 16:50:34.666+03:00 Error finding token by symbol              topics=\"token-service\" tid=6432963 file=service.nim:110 msg=\"key not found: 5\"\r\nTraceback (most recent call last)\r\n/Users/igorsirotin/Repositories/Status/status-desktop-cpp/src/nim_status_client.nim(180) nim_status_client\r\n/Users/igorsirotin/Repositories/Status/status-desktop-cpp/src/nim_status_client.nim(177) mainProc\r\n/Users/igorsirotin/Repositories/Status/status-desktop-cpp/vendor/nimqml/src/nimqml/private/qguiapplication.nim(29) exec\r\n/Users/igorsirotin/Repositories/Status/status-desktop-cpp/vendor/nimqml/src/nimqml/private/qobject.nim(49) qobjectCallback\r\n/Users/igorsirotin/Repositories/Status/status-desktop-cpp/vendor/nimqml/src/nimqml/private/qobject.nim(34) onSlotCalled\r\n/Users/igorsirotin/Repositories/Status/status-desktop-cpp/vendor/nimbus-build-system/vendor/Nim/lib/core/macros.nim(582) onSlotCalled\r\n/Users/igorsirotin/Repositories/Status/status-desktop-cpp/src/app/modules/main/profile_section/ens_usernames/view.nim(118) getSNTBalance\r\n/Users/igorsirotin/Repositories/Status/status-desktop-cpp/src/app/modules/main/profile_section/ens_usernames/io_interface.nim(75) getSNTBalance\r\n/Users/igorsirotin/Repositories/Status/status-desktop-cpp/src/app/modules/main/profile_section/ens_usernames/module.nim(322) getSNTBalance\r\n/Users/igorsirotin/Repositories/Status/status-desktop-cpp/src/app/modules/main/profile_section/ens_usernames/controller.nim(132) getSNTBalance\r\n/Users/igorsirotin/Repositories/Status/status-desktop-cpp/src/app_service/service/ens/service.nim(388) getSNTBalance\r\n/Users/igorsirotin/Repositories/Status/status-desktop-cpp/src/app_service/service/token/dto.nim(64) addressAsString\r\n/Users/igorsirotin/Repositories/Status/status-desktop-cpp/vendor/nim-web3/web3/conversions.nim(91) $\r\n/Users/igorsirotin/Repositories/Status/status-desktop-cpp/vendor/nim-task-runner/vendor/nim-stew/stew/byteutils.nim(135) toHex\r\n/Users/igorsirotin/Repositories/Status/status-desktop-cpp/vendor/nim-task-runner/vendor/nim-stew/stew/byteutils.nim(122) toHexAux\r\n```\r\n\r\n",
  "closed_by": {
    "login": "igor-sirotin",
    "id": 25482501,
    "node_id": "MDQ6VXNlcjI1NDgyNTAx",
    "avatar_url": "https://avatars.githubusercontent.com/u/25482501?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/igor-sirotin",
    "html_url": "https://github.com/igor-sirotin",
    "followers_url": "https://api.github.com/users/igor-sirotin/followers",
    "following_url": "https://api.github.com/users/igor-sirotin/following{/other_user}",
    "gists_url": "https://api.github.com/users/igor-sirotin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/igor-sirotin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/igor-sirotin/subscriptions",
    "organizations_url": "https://api.github.com/users/igor-sirotin/orgs",
    "repos_url": "https://api.github.com/users/igor-sirotin/repos",
    "events_url": "https://api.github.com/users/igor-sirotin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/igor-sirotin/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/9264/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-desktop/issues/9264/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1402051326",
    "html_url": "https://github.com/status-im/status-desktop/issues/9264#issuecomment-1402051326",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9264",
    "id": 1402051326,
    "node_id": "IC_kwDOD5KrTM5TkZr-",
    "user": {
      "login": "igor-sirotin",
      "id": 25482501,
      "node_id": "MDQ6VXNlcjI1NDgyNTAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25482501?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/igor-sirotin",
      "html_url": "https://github.com/igor-sirotin",
      "followers_url": "https://api.github.com/users/igor-sirotin/followers",
      "following_url": "https://api.github.com/users/igor-sirotin/following{/other_user}",
      "gists_url": "https://api.github.com/users/igor-sirotin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/igor-sirotin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/igor-sirotin/subscriptions",
      "organizations_url": "https://api.github.com/users/igor-sirotin/orgs",
      "repos_url": "https://api.github.com/users/igor-sirotin/repos",
      "events_url": "https://api.github.com/users/igor-sirotin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/igor-sirotin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-24T14:35:54Z",
    "updated_at": "2023-01-24T14:36:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "@dlipicar, could you please check this one?\r\nIt's blocking my https://github.com/status-im/status-desktop/pull/9036 🙁 ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1402051326/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1411491118",
    "html_url": "https://github.com/status-im/status-desktop/issues/9264#issuecomment-1411491118",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9264",
    "id": 1411491118,
    "node_id": "IC_kwDOD5KrTM5UIaUu",
    "user": {
      "login": "igor-sirotin",
      "id": 25482501,
      "node_id": "MDQ6VXNlcjI1NDgyNTAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25482501?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/igor-sirotin",
      "html_url": "https://github.com/igor-sirotin",
      "followers_url": "https://api.github.com/users/igor-sirotin/followers",
      "following_url": "https://api.github.com/users/igor-sirotin/following{/other_user}",
      "gists_url": "https://api.github.com/users/igor-sirotin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/igor-sirotin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/igor-sirotin/subscriptions",
      "organizations_url": "https://api.github.com/users/igor-sirotin/orgs",
      "repos_url": "https://api.github.com/users/igor-sirotin/repos",
      "events_url": "https://api.github.com/users/igor-sirotin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/igor-sirotin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-01T05:31:20Z",
    "updated_at": "2023-02-01T05:31:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "@dlipicar, I've fixed everything for my needs in #9330 \r\nBut please, check out my changes, you will see that there're more things to fix, it's easily seen by code.\r\nPlease, contact me when you're around 🙂 ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1411491118/reactions",
      "total_count": 2,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 1
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1418914483",
    "html_url": "https://github.com/status-im/status-desktop/issues/9264#issuecomment-1418914483",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/9264",
    "id": 1418914483,
    "node_id": "IC_kwDOD5KrTM5Ukuqz",
    "user": {
      "login": "dlipicar",
      "id": 11161531,
      "node_id": "MDQ6VXNlcjExMTYxNTMx",
      "avatar_url": "https://avatars.githubusercontent.com/u/11161531?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dlipicar",
      "html_url": "https://github.com/dlipicar",
      "followers_url": "https://api.github.com/users/dlipicar/followers",
      "following_url": "https://api.github.com/users/dlipicar/following{/other_user}",
      "gists_url": "https://api.github.com/users/dlipicar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dlipicar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dlipicar/subscriptions",
      "organizations_url": "https://api.github.com/users/dlipicar/orgs",
      "repos_url": "https://api.github.com/users/dlipicar/repos",
      "events_url": "https://api.github.com/users/dlipicar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dlipicar/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-06T11:14:12Z",
    "updated_at": "2023-02-06T11:14:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "@igor-sirotin added a small comment.\r\nThanks for taking care of this while I was away!",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1418914483/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 1,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
