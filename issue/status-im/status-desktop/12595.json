{
  "url": "https://api.github.com/repos/status-im/status-desktop/issues/12595",
  "repository_url": "https://api.github.com/repos/status-im/status-desktop",
  "labels_url": "https://api.github.com/repos/status-im/status-desktop/issues/12595/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-desktop/issues/12595/comments",
  "events_url": "https://api.github.com/repos/status-im/status-desktop/issues/12595/events",
  "html_url": "https://github.com/status-im/status-desktop/issues/12595",
  "id": 1971246325,
  "node_id": "I_kwDOD5KrTM51ftT1",
  "number": 12595,
  "title": "Remove `toChannelGroupDto` conversion from status-desktop",
  "user": {
    "login": "osmaczko",
    "id": 33099791,
    "node_id": "MDQ6VXNlcjMzMDk5Nzkx",
    "avatar_url": "https://avatars.githubusercontent.com/u/33099791?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/osmaczko",
    "html_url": "https://github.com/osmaczko",
    "followers_url": "https://api.github.com/users/osmaczko/followers",
    "following_url": "https://api.github.com/users/osmaczko/following{/other_user}",
    "gists_url": "https://api.github.com/users/osmaczko/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/osmaczko/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/osmaczko/subscriptions",
    "organizations_url": "https://api.github.com/users/osmaczko/orgs",
    "repos_url": "https://api.github.com/users/osmaczko/repos",
    "events_url": "https://api.github.com/users/osmaczko/events{/privacy}",
    "received_events_url": "https://api.github.com/users/osmaczko/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2351074091,
      "node_id": "MDU6TGFiZWwyMzUxMDc0MDkx",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/refactor",
      "name": "refactor",
      "color": "ef9870",
      "default": false,
      "description": ""
    },
    {
      "id": 4548141040,
      "node_id": "LA_kwDOD5KrTM8AAAABDxcf8A",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/messenger-team",
      "name": "messenger-team",
      "color": "232858",
      "default": false,
      "description": ""
    },
    {
      "id": 6014779451,
      "node_id": "LA_kwDOD5KrTM8AAAABZoJAOw",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/E:Desktop%20misc%20refactors",
      "name": "E:Desktop misc refactors",
      "color": "A6C799",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-10-31T20:26:45Z",
  "updated_at": "2023-11-01T14:23:45Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Description\r\n\r\nThe [toChannelGroupDto](https://github.com/status-im/status-desktop/blob/b414d616a672238fee9ffc2afd3a15346bf3656a/src/app_service/service/community/dto/community.nim#L525-L553) function in the desktop is essentially a redundant replication of [getChannelGroups](https://github.com/status-im/status-go/blob/eb437e9d8dd5bd1ca3b18fa05c4853d6ae8f4956/services/chat/api.go#L214-L237) from status-go. This isn't just a mere duplication of logic; it leads to numerous data inconsistency issues. Sometimes, we propagate `ChannelGroupDto` directly from status-go, and at other times, we run our conversion. This inconsistency opens up potential mismatches between the two. Ideally, we should maintain synchronization with the status-go version. However, given that status-go is platform-agnostic and can be altered by any team (such as mobile), ensuring consistent synchronization is impractical. Any deviation can be incredibly challenging to debug. When issues arise, tracing them back to the root cause, particularly if one lacks experience, is like searching for a needle in a haystack, with `toChannelGroupDto` being the last suspected culprit.\r\n\r\nThe \"ChannelGroups\" concept in status-go was intended to unify the sections. But, `ChannelGroup` isn't really used much by clients. It's used at first when getting sections, but after that, specific types like `Community` are used, which means the desktop has to change how it handles things.\r\n\r\nThere are a few ways to solve this:\r\n\r\nA) Remove `toChannelGroupDto` from the desktop and rely on status-go's conversion (this would require creating a new API, such as `communityToChannelGroup(communityID)`).\r\nB) Do away with the \"ChannelGroups\" idea in status-go and retain it solely within status-desktop.\r\nC) Modify all status-go signals to be of type `ChannelGroup`, either as a replacement for or in addition to `Community`.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/12595/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-desktop/issues/12595/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1787982260",
    "html_url": "https://github.com/status-im/status-desktop/issues/12595#issuecomment-1787982260",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/12595",
    "id": 1787982260,
    "node_id": "IC_kwDOD5KrTM5qknG0",
    "user": {
      "login": "osmaczko",
      "id": 33099791,
      "node_id": "MDQ6VXNlcjMzMDk5Nzkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/33099791?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/osmaczko",
      "html_url": "https://github.com/osmaczko",
      "followers_url": "https://api.github.com/users/osmaczko/followers",
      "following_url": "https://api.github.com/users/osmaczko/following{/other_user}",
      "gists_url": "https://api.github.com/users/osmaczko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/osmaczko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/osmaczko/subscriptions",
      "organizations_url": "https://api.github.com/users/osmaczko/orgs",
      "repos_url": "https://api.github.com/users/osmaczko/repos",
      "events_url": "https://api.github.com/users/osmaczko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/osmaczko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-31T20:26:58Z",
    "updated_at": "2023-10-31T20:26:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "CC: @jrainville ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1787982260/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1789047981",
    "html_url": "https://github.com/status-im/status-desktop/issues/12595#issuecomment-1789047981",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/12595",
    "id": 1789047981,
    "node_id": "IC_kwDOD5KrTM5qorSt",
    "user": {
      "login": "jrainville",
      "id": 11926403,
      "node_id": "MDQ6VXNlcjExOTI2NDAz",
      "avatar_url": "https://avatars.githubusercontent.com/u/11926403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jrainville",
      "html_url": "https://github.com/jrainville",
      "followers_url": "https://api.github.com/users/jrainville/followers",
      "following_url": "https://api.github.com/users/jrainville/following{/other_user}",
      "gists_url": "https://api.github.com/users/jrainville/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jrainville/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jrainville/subscriptions",
      "organizations_url": "https://api.github.com/users/jrainville/orgs",
      "repos_url": "https://api.github.com/users/jrainville/repos",
      "events_url": "https://api.github.com/users/jrainville/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jrainville/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-11-01T14:23:22Z",
    "updated_at": "2023-11-01T14:23:22Z",
    "author_association": "MEMBER",
    "body": "Yeah, you hit it on the head. The concept of channel groups was to unify the personal chats and communities under a common type, but we end up only using it on app start when we load the sections, because the personal section is basically only loaded once and then no longer needed.\r\n\r\nIn theory,  the third (C) option is the best in the long run, since we'd only deal with Channel Groups. However, there are multiple possible problems with that.\r\nFirst, it's a lot of work, since we return the Community type a lot.\r\nSecond, mobile also uses all those Community returning APIs, so we'd have to deprecate a lot of APIs and force them to update to ChannelGroup.\r\nThirdly, ChannelGroup returns a lot more data than Community, so all the APIs that used to return Community would need to pass through a conversion function that would slow down the app  a little bit.\r\n\r\nSo I think the third option is not worth it, even though it could help get everything standardized.\r\n\r\nI think we should probably do away with the concept of ChannelGroups all together. It was a nice idea in theory to unify the sections, but in the end, it just creates more confusion and complexity.\r\n\r\nWe can go back to what we had before and/or see what mobile does to fetch the sections at the start and do the same.\r\n\r\nIt might just be about getting all communities, and getting the personal chat section in parallel separately",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1789047981/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
