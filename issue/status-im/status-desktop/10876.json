{
  "url": "https://api.github.com/repos/status-im/status-desktop/issues/10876",
  "repository_url": "https://api.github.com/repos/status-im/status-desktop",
  "labels_url": "https://api.github.com/repos/status-im/status-desktop/issues/10876/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-desktop/issues/10876/comments",
  "events_url": "https://api.github.com/repos/status-im/status-desktop/issues/10876/events",
  "html_url": "https://github.com/status-im/status-desktop/issues/10876",
  "id": 1733979279,
  "node_id": "I_kwDOD5KrTM5nWmyP",
  "number": 10876,
  "title": "MacOS builds failing for both architectures",
  "user": {
    "login": "jakubgs",
    "id": 2212681,
    "node_id": "MDQ6VXNlcjIyMTI2ODE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jakubgs",
    "html_url": "https://github.com/jakubgs",
    "followers_url": "https://api.github.com/users/jakubgs/followers",
    "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
    "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
    "organizations_url": "https://api.github.com/users/jakubgs/orgs",
    "repos_url": "https://api.github.com/users/jakubgs/repos",
    "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jakubgs/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2036563458,
      "node_id": "MDU6TGFiZWwyMDM2NTYzNDU4",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "jakubgs",
    "id": 2212681,
    "node_id": "MDQ6VXNlcjIyMTI2ODE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jakubgs",
    "html_url": "https://github.com/jakubgs",
    "followers_url": "https://api.github.com/users/jakubgs/followers",
    "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
    "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
    "organizations_url": "https://api.github.com/users/jakubgs/orgs",
    "repos_url": "https://api.github.com/users/jakubgs/repos",
    "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jakubgs/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 11,
  "created_at": "2023-05-31T11:17:46Z",
  "updated_at": "2023-05-31T12:00:24Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Currently MacOS builds are failing for both `aarch64` with:\r\n```\r\nld: can't map file, errno=22 file '/Users/jenkins/workspace/status-desktop/systems/macos/aarch64/package/vendor/status-go/build/bin' for architecture arm64\r\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\r\nError: execution of an external program failed: 'clang  @nim_status_client_linkerArgs.txt'\r\n/Users/jenkins/workspace/status-desktop/systems/macos/aarch64/package/vendor/nimbus-build-system/vendor/Nim/compiler/extccomp.nim(404, 15) compiler msg initiated here [MsgOrigin]\r\nmake: *** [bin/nim_status_client] Error 1\r\n```\r\nAnd on `x86_64`:\r\n```\r\nld: can't map file, errno=22 file '/Users/jenkins/workspace/status-desktop/systems/macos/x86_64/package/vendor/status-go/build/bin'\r\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\r\nError: execution of an external program failed: 'clang  @nim_status_client_linkerArgs.txt'\r\nmake: *** [bin/nim_status_client] Error 1\r\n```\r\nThis appears to have started yesterday, or they day before. Although there were some PR builds still working yesterday:\r\n\r\n![image](https://github.com/status-im/status-desktop/assets/2212681/783a4188-46ea-4f00-9c52-99cc32a2c267)\r\n\r\nhttps://ci.status.im/job/status-desktop/job/branches/job/macos/job/aarch64/job/package/view/change-requests/job/PR-10799/",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/10876/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-desktop/issues/10876/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570002942",
    "html_url": "https://github.com/status-im/status-desktop/issues/10876#issuecomment-1570002942",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/10876",
    "id": 1570002942,
    "node_id": "IC_kwDOD5KrTM5dlFf-",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-31T11:19:55Z",
    "updated_at": "2023-05-31T11:19:55Z",
    "author_association": "MEMBER",
    "body": "The issue doesn't seem to be related to `clang` or `cmake` versions because those are the same for devs:\r\n```\r\n > a ci-slave-macos -o -a 'clang --version | head -n1'\r\nmaci7-01.ms-eu-dublin.ci.devel | CHANGED | rc=0 | (stdout) Apple clang version 14.0.3 (clang-1403.0.22.14.1)\r\nmaci7-02.ms-eu-dublin.ci.devel | CHANGED | rc=0 | (stdout) Apple clang version 14.0.3 (clang-1403.0.22.14.1)\r\nmaci7-03.ms-eu-dublin.ci.devel | CHANGED | rc=0 | (stdout) Apple clang version 14.0.3 (clang-1403.0.22.14.1)\r\nmacm1-01.he-eu-fsn1.ci.release | CHANGED | rc=0 | (stdout) Apple clang version 14.0.3 (clang-1403.0.22.14.1)\r\nmacm1-01.ih-eu-mda1.ci.devel | CHANGED | rc=0 | (stdout) Apple clang version 14.0.3 (clang-1403.0.22.14.1)\r\nmacm2-02.ih-eu-mda1.ci.devel | CHANGED | rc=0 | (stdout) Apple clang version 14.0.3 (clang-1403.0.22.14.1)\r\nmacm2-01.ms-eu-dublin.ci.devel | CHANGED | rc=0 | (stdout) Apple clang version 14.0.3 (clang-1403.0.22.14.1)\r\nmacm2-01.ih-eu-mda1.ci.devel | CHANGED | rc=0 | (stdout) Apple clang version 14.0.3 (clang-1403.0.22.14.1)\r\n```\r\n```\r\n > a ci-slave-macos -o -a '/opt/homebrew/bin/cmake --version | head -n1' | sort\r\nmaci7-01.ms-eu-dublin.ci.devel | CHANGED | rc=0 | (stdout) cmake version 3.25.2\r\nmaci7-02.ms-eu-dublin.ci.devel | CHANGED | rc=0 | (stdout) cmake version 3.22.0\r\nmaci7-03.ms-eu-dublin.ci.devel | CHANGED | rc=0 | (stdout) cmake version 3.25.2\r\nmacm1-01.he-eu-fsn1.ci.release | CHANGED | rc=0 | (stdout) cmake version 3.26.0\r\nmacm1-01.ih-eu-mda1.ci.devel | CHANGED | rc=0 | (stdout) cmake version 3.26.3\r\nmacm2-01.ih-eu-mda1.ci.devel | CHANGED | rc=0 | (stdout) cmake version 3.26.4\r\nmacm2-01.ms-eu-dublin.ci.devel | CHANGED | rc=0 | (stdout) cmake version 3.26.3\r\nmacm2-02.ih-eu-mda1.ci.devel | CHANGED | rc=0 | (stdout) cmake version 3.26.4\r\n```\r\nHere's versions from @igor-sirotin:\r\n```\r\nigorsirotin@MacBook-Pro-Igor status-desktop % clang --version\r\nApple clang version 14.0.3 (clang-1403.0.22.14.1)\r\nTarget: arm64-apple-darwin22.4.0\r\nThread model: posix\r\nInstalledDir: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin\r\n\r\nigorsirotin@MacBook-Pro-Igor status-desktop % cmake --version\r\ncmake version 3.26.3\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570002942/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570004908",
    "html_url": "https://github.com/status-im/status-desktop/issues/10876#issuecomment-1570004908",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/10876",
    "id": 1570004908,
    "node_id": "IC_kwDOD5KrTM5dlF-s",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-31T11:21:24Z",
    "updated_at": "2023-05-31T11:21:24Z",
    "author_association": "MEMBER",
    "body": "I have checked the `status-go` library and the architecture is correct:\r\n```\r\n > file vendor/status-go/build/bin/libstatus.dylib     \r\nvendor/status-go/build/bin/libstatus.dylib: Mach-O 64-bit dynamically linked shared library x86_64\r\n```\r\n```\r\n > file vendor/status-go/build/bin/libstatus.dylib\r\nvendor/status-go/build/bin/libstatus.dylib: Mach-O 64-bit dynamically linked shared library arm64\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570004908/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570006720",
    "html_url": "https://github.com/status-im/status-desktop/issues/10876#issuecomment-1570006720",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/10876",
    "id": 1570006720,
    "node_id": "IC_kwDOD5KrTM5dlGbA",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-31T11:22:46Z",
    "updated_at": "2023-05-31T11:22:46Z",
    "author_association": "MEMBER",
    "body": "The way we configure binding of `status-go` library is via `STATUSGO_LIBDIR`:\r\nhttps://github.com/status-im/status-desktop/blob/4c29343a4a45fb31e0935a5325837d6525666588/Makefile#L333-L335\r\nhttps://github.com/status-im/status-desktop/blob/4c29343a4a45fb31e0935a5325837d6525666588/Makefile#L475\r\nWhich is correct in CI:\r\n```\r\n--passL:\"-L/Users/jenkins/workspace/status-desktop/systems/macos/aarch64/package/vendor/status-go/build/bin\"\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570006720/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570015710",
    "html_url": "https://github.com/status-im/status-desktop/issues/10876#issuecomment-1570015710",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/10876",
    "id": 1570015710,
    "node_id": "IC_kwDOD5KrTM5dlIne",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-31T11:29:29Z",
    "updated_at": "2023-05-31T11:29:29Z",
    "author_association": "MEMBER",
    "body": "Tried setting `NIMFLAGS = '--colors:off -d:debug'` to get more info but that didn't produce much:\r\nhttps://ci.infra.status.im/job/status-desktop/job/systems/job/macos/job/x86_64/job/package/332/console",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570015710/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570018649",
    "html_url": "https://github.com/status-im/status-desktop/issues/10876#issuecomment-1570018649",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/10876",
    "id": 1570018649,
    "node_id": "IC_kwDOD5KrTM5dlJVZ",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-31T11:31:21Z",
    "updated_at": "2023-05-31T11:31:21Z",
    "author_association": "MEMBER",
    "body": "One possibly relevant change made yesterday is related to linking packages from Homebrew:\r\n\r\n- https://github.com/status-im/infra-ci/commit/3e2fd8d7 - macos-brew: link packages after installing\r\n- https://github.com/status-im/infra-ci/commit/a3fe4e7e - ci-slave-macos: drop unnecessary dependencies\r\n\r\nWhich adds this:\r\nhttps://github.com/status-im/infra-ci/blob/a3fe4e7e0111bb838c003e83690fe4abf0c33408/ansible/roles/macos-brew/tasks/main.yml#L23-L28\r\nI tried unlinking `cmake` but it just resulted in:\r\n```\r\n+ make pkg-macos\r\n\u001B[92mBuilding:\u001B[39m resources.rcc\r\n\u001B[92mCompiling:\u001B[39m translations\r\n1848 resources added\r\n\u001B[92mInstalling:\u001B[39m create-dmg\r\n\u001B[92mConfiguring:\u001B[39m StatusQ\r\n\u001B[92mBuilding:\u001B[39m DOtherSide\r\n\u001B[92mBuilding:\u001B[39m status-keycard-go\r\nbash: line 1: cmake: command not found\r\nmake: *** [ui/StatusQ/build/CMakeCache.txt] Error 127\r\nmake: *** Waiting for unfinished jobs....\r\nbash: line 1: cmake: command not found\r\nmake: *** [vendor/DOtherSide/build/lib/libDOtherSideStatic.a] Error 127\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570018649/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570024342",
    "html_url": "https://github.com/status-im/status-desktop/issues/10876#issuecomment-1570024342",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/10876",
    "id": 1570024342,
    "node_id": "IC_kwDOD5KrTM5dlKuW",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-31T11:35:21Z",
    "updated_at": "2023-05-31T11:35:46Z",
    "author_association": "MEMBER",
    "body": "The exact failure comes from Nim compiler calling the linker in `execExternalProgram()`:\r\n```nim\r\nproc execExternalProgram*(conf: ConfigRef; cmd: string, msg = hintExecuting) =\r\n  if execWithEcho(conf, cmd, msg) != 0:\r\n    rawMessage(conf, errGenerated, \"execution of an external program failed: '$1'\" %\r\n      cmd)\r\n```\r\nhttps://github.com/status-im/Nim/blob/1aa9273640c0c51486cf3a7b67282fe58f360e91/compiler/extccomp.nim#L402-L405\r\n\r\nWhich in turn is used by `execLinkCmd()`:\r\n```nim\r\nproc execLinkCmd(conf: ConfigRef; linkCmd: string) =\r\n  tryExceptOSErrorMessage(conf, \"invocation of external linker program failed.\"):\r\n    execExternalProgram(conf, linkCmd, hintLinking)\r\n```\r\nhttps://github.com/status-im/Nim/blob/1aa9273640c0c51486cf3a7b67282fe58f360e91/compiler/extccomp.nim#L771-L773\r\n\r\nI don't see any debug logging done there, so this is going to be tricky to examine.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570024342/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570026496",
    "html_url": "https://github.com/status-im/status-desktop/issues/10876#issuecomment-1570026496",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/10876",
    "id": 1570026496,
    "node_id": "IC_kwDOD5KrTM5dlLQA",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-31T11:37:05Z",
    "updated_at": "2023-05-31T11:37:05Z",
    "author_association": "MEMBER",
    "body": "The `execWithEcho()` function calls `rawMessage()` which depends on `hintLinking` and `conf.verbosity > 1` check:\r\n```nim\r\nproc execWithEcho(conf: ConfigRef; cmd: string, msg = hintExecuting): int =\r\n  rawMessage(conf, msg, if msg == hintLinking and not(optListCmd in conf.globalOptions or conf.verbosity > 1): \"\" else: cmd)\r\n  result = execCmd(cmd)\r\n```\r\nhttps://github.com/status-im/Nim/blob/1aa9273640c0c51486cf3a7b67282fe58f360e91/compiler/extccomp.nim#L398-L400\r\nSo there may be hope.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570026496/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570029502",
    "html_url": "https://github.com/status-im/status-desktop/issues/10876#issuecomment-1570029502",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/10876",
    "id": 1570029502,
    "node_id": "IC_kwDOD5KrTM5dlL--",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-31T11:39:36Z",
    "updated_at": "2023-05-31T11:39:36Z",
    "author_association": "MEMBER",
    "body": "The `hintLinking` appears to have a value of `Link`:\r\n```nim\r\n    hintPattern = \"Pattern\", hintExecuting = \"Exec\", hintLinking = \"Link\", hintDependency = \"Dependency\",\r\n```\r\nhttps://github.com/status-im/Nim/blob/1aa9273640c0c51486cf3a7b67282fe58f360e91/compiler/lineinfos.nim#L93\r\n\r\nAnd that appears to be controlled by `--hint:NAME:on|off` flag:\r\nhttps://nim-lang.org/docs/nimc.html#compiler-usage-list-of-hints",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570029502/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570043200",
    "html_url": "https://github.com/status-im/status-desktop/issues/10876#issuecomment-1570043200",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/10876",
    "id": 1570043200,
    "node_id": "IC_kwDOD5KrTM5dlPVA",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-31T11:49:02Z",
    "updated_at": "2023-05-31T11:49:02Z",
    "author_association": "MEMBER",
    "body": "By setting `NIMFLAGS = '--colors:off --verbosity:2 --hint:Link:on'` in the `Jenkinsfile.macos` but I got nothing useful in the logs:\r\n```\r\n\"/Users/jenkins/workspace/status-desktop/systems/macos/aarch64/package/vendor/nimbus-build-system/scripts/env.sh\" nim c --colors:off --verbosity:2 --hint:Link --verbosity:2 --passL:\"vendor/DOtherSide/build/lib/libDOtherSideStatic.a\" --passL:\"-F/opt/homebrew/Cellar/qt@5/5.15.8_2/lib -framework QtQuickControls2 -F/opt/homebrew/Cellar/qt@5/5.15.8_2/lib -framework QtQuick -F/opt/homebrew/Cellar/qt@5/5.15.8_2/lib -framework QtQmlModels -F/opt/homebrew/Cellar/qt@5/5.15.8_2/lib -framework QtQml -F/opt/homebrew/Cellar/qt@5/5.15.8_2/lib -framework QtSvg -F/opt/homebrew/Cellar/qt@5/5.15.8_2/lib -framework QtWidgets -F/opt/homebrew/Cellar/qt@5/5.15.8_2/lib -framework QtMultimedia -F/opt/homebrew/Cellar/qt@5/5.15.8_2/lib -framework QtNetwork -F/opt/homebrew/Cellar/qt@5/5.15.8_2/lib -framework QtGui -F/opt/homebrew/Cellar/qt@5/5.15.8_2/lib -framework QtCore\" -d:debug --outdir:./bin -d:DESKTOP_VERSION=\"`cat VERSION`\" -d:GIT_COMMIT=\"`git log --pretty=format:'%h' -n 1`\" -d:POKT_TOKEN:\"849214fd2f85acead08f5184\" -d:INFURA_TOKEN:\"220a1abb4b6943a093c35d0ce4fb0732\" -d:OPENSEA_API_KEY:\"\"\"\" -d:TENOR_API_KEY:\"DU7DWZ27STB2\" -d:chronicles_sinks=textlines[stdout],textlines[nocolors,dynamic],textlines[file,nocolors] -d:chronicles_runtime_filtering=on -d:chronicles_default_output_device=dynamic -d:development --passL:\"-L/Users/jenkins/workspace/status-desktop/systems/macos/aarch64/package/vendor/status-go/build/bin\" --passL:\"-lstatus\" --passL:\"-L/Users/jenkins/workspace/status-desktop/systems/macos/aarch64/package/vendor/status-keycard-go/build/libkeycard\" --passL:\"-lkeycard\"  --passL:\"vendor/QR-Code-generator/c/libqrcodegen.a\" --passL:\"-lm\" src/nim_status_client.nim && \\\r\n```\r\nMaybe I'm not passing it correctly: `--verbosity:2 --hint:Link:on`",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570043200/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570044132",
    "html_url": "https://github.com/status-im/status-desktop/issues/10876#issuecomment-1570044132",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/10876",
    "id": 1570044132,
    "node_id": "IC_kwDOD5KrTM5dlPjk",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-31T11:49:33Z",
    "updated_at": "2023-05-31T11:52:31Z",
    "author_association": "MEMBER",
    "body": "I found this:\r\n\r\n>`--listCmd` - list the compilation commands; can be combined with `--hint:exec:on` and `--hint:link:on`\r\n\r\nhttps://nim-lang.org/docs/nimc.html#compiler-usage",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570044132/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570070512",
    "html_url": "https://github.com/status-im/status-desktop/issues/10876#issuecomment-1570070512",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/10876",
    "id": 1570070512,
    "node_id": "IC_kwDOD5KrTM5dlV_w",
    "user": {
      "login": "igor-sirotin",
      "id": 25482501,
      "node_id": "MDQ6VXNlcjI1NDgyNTAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25482501?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/igor-sirotin",
      "html_url": "https://github.com/igor-sirotin",
      "followers_url": "https://api.github.com/users/igor-sirotin/followers",
      "following_url": "https://api.github.com/users/igor-sirotin/following{/other_user}",
      "gists_url": "https://api.github.com/users/igor-sirotin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/igor-sirotin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/igor-sirotin/subscriptions",
      "organizations_url": "https://api.github.com/users/igor-sirotin/orgs",
      "repos_url": "https://api.github.com/users/igor-sirotin/repos",
      "events_url": "https://api.github.com/users/igor-sirotin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/igor-sirotin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-31T12:00:24Z",
    "updated_at": "2023-05-31T12:00:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "I also tried `--passL:\"-v\" --passC:\"-v\"` to getter linker verbose output, as the original error suggests. \r\nDidn't get anything around the error, but maybe I did smth wrong.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1570070512/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
