{
  "url": "https://api.github.com/repos/status-im/status-desktop/issues/10772",
  "repository_url": "https://api.github.com/repos/status-im/status-desktop",
  "labels_url": "https://api.github.com/repos/status-im/status-desktop/issues/10772/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-desktop/issues/10772/comments",
  "events_url": "https://api.github.com/repos/status-im/status-desktop/issues/10772/events",
  "html_url": "https://github.com/status-im/status-desktop/issues/10772",
  "id": 1722183886,
  "node_id": "I_kwDOD5KrTM5mpnDO",
  "number": 10772,
  "title": "Keypair syncing - profile keypair - edge cases",
  "user": {
    "login": "saledjenic",
    "id": 86303051,
    "node_id": "MDQ6VXNlcjg2MzAzMDUx",
    "avatar_url": "https://avatars.githubusercontent.com/u/86303051?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/saledjenic",
    "html_url": "https://github.com/saledjenic",
    "followers_url": "https://api.github.com/users/saledjenic/followers",
    "following_url": "https://api.github.com/users/saledjenic/following{/other_user}",
    "gists_url": "https://api.github.com/users/saledjenic/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/saledjenic/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/saledjenic/subscriptions",
    "organizations_url": "https://api.github.com/users/saledjenic/orgs",
    "repos_url": "https://api.github.com/users/saledjenic/repos",
    "events_url": "https://api.github.com/users/saledjenic/events{/privacy}",
    "received_events_url": "https://api.github.com/users/saledjenic/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2331339531,
      "node_id": "MDU6TGFiZWwyMzMxMzM5NTMx",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/wallet-team",
      "name": "wallet-team",
      "color": "b60205",
      "default": false,
      "description": ""
    },
    {
      "id": 3047427135,
      "node_id": "MDU6TGFiZWwzMDQ3NDI3MTM1",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/feature",
      "name": "feature",
      "color": "0E8A16",
      "default": false,
      "description": ""
    },
    {
      "id": 5639332268,
      "node_id": "LA_kwDOD5KrTM8AAAABUCFhrA",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/C2",
      "name": "C2",
      "color": "E15258",
      "default": false,
      "description": ""
    },
    {
      "id": 5745583027,
      "node_id": "LA_kwDOD5KrTM8AAAABVnajsw",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/E:Desktop%20Wallet%20Sync",
      "name": "E:Desktop Wallet Sync",
      "color": "6983CC",
      "default": false,
      "description": "Wallet account syncing"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "saledjenic",
    "id": 86303051,
    "node_id": "MDQ6VXNlcjg2MzAzMDUx",
    "avatar_url": "https://avatars.githubusercontent.com/u/86303051?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/saledjenic",
    "html_url": "https://github.com/saledjenic",
    "followers_url": "https://api.github.com/users/saledjenic/followers",
    "following_url": "https://api.github.com/users/saledjenic/following{/other_user}",
    "gists_url": "https://api.github.com/users/saledjenic/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/saledjenic/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/saledjenic/subscriptions",
    "organizations_url": "https://api.github.com/users/saledjenic/orgs",
    "repos_url": "https://api.github.com/users/saledjenic/repos",
    "events_url": "https://api.github.com/users/saledjenic/events{/privacy}",
    "received_events_url": "https://api.github.com/users/saledjenic/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "saledjenic",
      "id": 86303051,
      "node_id": "MDQ6VXNlcjg2MzAzMDUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/86303051?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/saledjenic",
      "html_url": "https://github.com/saledjenic",
      "followers_url": "https://api.github.com/users/saledjenic/followers",
      "following_url": "https://api.github.com/users/saledjenic/following{/other_user}",
      "gists_url": "https://api.github.com/users/saledjenic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/saledjenic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/saledjenic/subscriptions",
      "organizations_url": "https://api.github.com/users/saledjenic/orgs",
      "repos_url": "https://api.github.com/users/saledjenic/repos",
      "events_url": "https://api.github.com/users/saledjenic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/saledjenic/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": {
    "url": "https://api.github.com/repos/status-im/status-desktop/milestones/65",
    "html_url": "https://github.com/status-im/status-desktop/milestone/65",
    "labels_url": "https://api.github.com/repos/status-im/status-desktop/milestones/65/labels",
    "id": 9039509,
    "node_id": "MI_kwDOD5KrTM4Aie6V",
    "number": 65,
    "title": "0.15",
    "description": "**1. Finish anything that wasn't completed in the previous 0.14 cycle**\r\n- And fix bugs as usual. We need to keep tech. debt at a roughly fixed level as we grow out functionality, can't let it accumulate! ;-)\r\n\r\n**2. Tokenisation of community ownership**\r\n- Work needed already evaluated in spike.  Community and 'Channel in a Community' URLs don't need to be signed if this will present problems. Patryk to work on this as a continuation of the spike already done.\r\n- See priority 4 below, as this also has some implications for the tokenisation of community work.\r\n\r\n**3. Profile showcase backend**\r\n- The long-delayed profile showcase backend!  We have the UI on the desktop ready to go for this feature, and Mobile is going to need the backend for this feature as well, so let's try to get it done in 0.14 [#11081](https://github.com/status-im/status-desktop/issues/11081)\r\n\r\n**4. Community tokens visible in wallet when received by user who is not a member of that community**\r\n- Solution obvs. needs to be fully decenteralised and permissionless\r\n- Perhaps whenever a community token is A) sent from a Status Wallet to another user or B) airdropped by a community or C) retailed by a community, a M2M (invisible to the user) Waku message should be sent to the recipient's *ethereum address*?\r\n- This message could either: A) contain the metadata for the token B) tell the user that they have received token, and to check the metadata in either another Waku channel where Control Nodes periodically post Metadata OR check the metadata embedded in the token contract (embedding metadata in the token contract might be a better idea?).  \r\n- The token metadata stored in the token contract is signed by the Community's private key to ensure authenticity.  When the community's private key changes due to ownership of a community being transferred or due to the control node being moved, a transaction must be made to update this metadata so it is signed by the community's new private key.\r\n- See here for how a Waku message can be sent to and Ethereum address https://rfc.vac.dev/spec/20/\r\n\r\n**5. Discord history import into a single channel in an existing community**\r\n- Pay off any Discord history import service tech. debt first\r\n- Then build the import into a single channel functionality, designs for this are already complete\r\n\r\n**6. UI for community owner to enable manual Waku static shading for their community**\r\n- This will be off by default in 0.15\r\n- This UI is only for the Owner of a community (not TokenMasters or Admins)\r\n- Figma designs are here https://www.figma.com/file/qHfFm7C9LwtXpfdbxssCK3/Kuba%E2%8E%9CDesktop---Communities?type=design&node-id=37242%3A222352&mode=design&t=rw6q6NQYmiz3rSn2-1\r\n\r\n**7. Community chat functionality enhancements**\r\n- Ability to mark a token gated channel as 'hidden', only visible to community members with the requisite tokens\r\n\r\n**8. Refactor synchronisation of contacts**\r\n- To fix various contact request issues, is a large work item\r\n- Mishka and Igor to work on this?\r\n- https://github.com/status-im/status-go/issues/3720\r\n- https://github.com/status-im/status-go/issues/3803#issuecomment-1654588500\r\n\r\n\r\n\r\n**--- Wallet Team ---**\r\n\r\n1. Finish anything that wasn't completed in the previous 0.14 cycle\r\n- And fix bugs as usual. We need to keep tech. debt at a roughly fixed level as we grow out functionality, can't let it accumulate! ;-)\r\n\r\n2. Sending Community created tokens to Status users who are not members of that community\r\n- See priority 4) in the messaging priorities list above.\r\n\r\n3. Send NFT functionality\r\n\r\n4. Updated wallet settings with keypair syncing\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "creator": {
      "login": "iurimatias",
      "id": 176720,
      "node_id": "MDQ6VXNlcjE3NjcyMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176720?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iurimatias",
      "html_url": "https://github.com/iurimatias",
      "followers_url": "https://api.github.com/users/iurimatias/followers",
      "following_url": "https://api.github.com/users/iurimatias/following{/other_user}",
      "gists_url": "https://api.github.com/users/iurimatias/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iurimatias/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iurimatias/subscriptions",
      "organizations_url": "https://api.github.com/users/iurimatias/orgs",
      "repos_url": "https://api.github.com/users/iurimatias/repos",
      "events_url": "https://api.github.com/users/iurimatias/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iurimatias/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 162,
    "closed_issues": 58,
    "state": "open",
    "created_at": "2023-02-13T19:08:52Z",
    "updated_at": "2023-09-11T12:47:15Z",
    "due_on": "2023-09-29T07:00:00Z",
    "closed_at": null
  },
  "comments": 1,
  "created_at": "2023-05-23T14:18:33Z",
  "updated_at": "2023-09-11T09:45:34Z",
  "closed_at": "2023-09-11T09:45:34Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "More less keypairs+keycards and watch-only accounts syncing is introduced in this PR https://github.com/status-im/status-go/pull/3475, but that is good if on both sides data refers to regular account.\n\nThe whole point here is about ecryption and keystore files.\n\nIn the table below `regular profile` refers to a profile keypair which is not migrated to a Keycard, `keycard profile` refers to a profile keypair which is migrated to a Keycard. \n\n### Case 1: recovering from another device\n| device A | recover from another device B (local pairing) | Expected state | Done |\n| -- | -- | -- | -- |\n| regular profile | regular profile | on device A must be: <br>-the same keypairs/accounts as on device B;<br>- the same set of keystore files as on device B;<br>- keystore files and db encrypted using password; | &#x2705; |\n| regular profile | keycard profile | on device A must be: <br>-the same keypairs/accounts as on device B;<br>- the same set of non profile keypair related keystore files as on device B;<br>- keystore files and db encrypted using encryption public key; | https://github.com/status-im/status-desktop/issues/10983 &#x2705; |\n| keycard profile | regular profile | N/A | N/A |\n| keycard profile | keycard profile | N/A | N/A |\n\n### Case 2: recovering from Waku\n| device A | recover from Waku | Expected state | Done |\n| -- | -- | -- | -- |\n| regular profile | regular profile | on device A must be: <br>- the same keypairs/accounts as it was at the moment when last backup was performed;<br>- no other keystore files then those referring to Status account + one for the default wallet account (path m/44'/60'/0'/0/0);<br>- no keystore files created for any of received seed/privatekey keypairs;<br>- keystore files and db encrypted using password; | &#x2705; |\n| regular profile | keycard profile | on device A must be: <br>- the same keypairs/accounts as it was at the moment when last backup was performed;<br>- no keystore files;<br>- db encrypted using encryption public key; | https://github.com/status-im/status-desktop/issues/11661 &#x2705; |\n| keycard profile | regular profile | on device A must be: <br>- the same keypairs/accounts as it was at the moment when last backup was performed;<br>- no other keystore files then those referring to Status account and all its derived accounts, that will be possible, cause in this case user has to provide seed phrase + password after successfully fetched backed up data;<br>- keystore files and db encrypted using password; | https://github.com/status-im/status-desktop/issues/11661 &#x2705; |\n| keycard profile | keycard profile | on device A must be: <br>- the same keypairs/accounts as it was at the moment when last backup was performed;<br>- no keystore files;<br>- db encrypted using encryption public key; | https://github.com/status-im/status-desktop/issues/11661 &#x2705; |\n\n### Case 3: when two devices decide to pair\n| device A | local pairing with device B (not recovering) | Expected state | Done |\n| -- | -- | -- | -- |\n| regular profile | regular profile | on device A must be: <br>-the same keypairs/accounts as on device B (means accounts stored on device A which are different then those stored on device B will be removed);<br>- the same set of keystore files as on device B;<br>- keystore files and db encrypted using password; | check the [comment](https://github.com/status-im/status-desktop/issues/10772#issuecomment-1655248967) &#x274C; |\n| regular profile | keycard profile | first we need to warn user that he is syncing with the device where profile keypair is migrated to a keycard;<br>if he confirms syncing then on device A must be: <br>- the same keypairs/accounts as on device B (means accounts stored on device A which are different then those stored on device B will be removed);<br>- the same set of keystore files as on device B;<br>- keystore files and db encrypted using encryption public key; | check the [comment](https://github.com/status-im/status-desktop/issues/10772#issuecomment-1655248967) &#x274C; |\n| keycard profile | regular profile | first we need to warn user that he is syncing with the device where profile keypair is not migrated to a keycard;<br>if he confirms syncing then on device A must be: <br>- the same keypairs/accounts as on device B (means accounts stored on device A which are different then those stored on device B will be removed);<br>- the same set of keystore files as on device B;<br>- keystore files and db encrypted using password; | check the [comment](https://github.com/status-im/status-desktop/issues/10772#issuecomment-1655248967) &#x274C; |\n| keycard profile | keycard profile | on device A must be: <br>-the same keypairs/accounts as on device B (means accounts stored on device A which are different then those stored on device B will be removed);<br>- the same set of keystore files as on device B;<br>- keystore files and db encrypted using encryption public key; | check the [comment](https://github.com/status-im/status-desktop/issues/10772#issuecomment-1655248967) &#x274C; |\n\n### Case 4: if devices are already paired\n| device A | migrating account on device B if A and B are already paired | Expected state | Done |\n| -- | -- | -- | -- |\n| regular profile | migrating to regular profile | N/A | N/A |\n| regular profile | migrating to keycard profile | on device A must be: <br>- the same set of keystore files as on device B (means profile keypair related keystore files are removed);<br>- keystore files and db encrypted using encryption public key; | https://github.com/status-im/status-desktop/issues/11706 &#x2705;<br>https://github.com/status-im/status-desktop/issues/11737 &#x2705; |\n| keycard profile | migrating to regular profile | on device A must be: <br>- no keystore files created for any account related to a profile keypair;<br>- keystore files and db encrypted using password;| https://github.com/status-im/status-desktop/issues/11706 &#x2705;<br>https://github.com/status-im/status-desktop/issues/11737 &#x2705; |\n| keycard profile | migrating to keycard profile | N/A | N/A |\n",
  "closed_by": {
    "login": "alaibe",
    "id": 491074,
    "node_id": "MDQ6VXNlcjQ5MTA3NA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/491074?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alaibe",
    "html_url": "https://github.com/alaibe",
    "followers_url": "https://api.github.com/users/alaibe/followers",
    "following_url": "https://api.github.com/users/alaibe/following{/other_user}",
    "gists_url": "https://api.github.com/users/alaibe/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alaibe/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alaibe/subscriptions",
    "organizations_url": "https://api.github.com/users/alaibe/orgs",
    "repos_url": "https://api.github.com/users/alaibe/repos",
    "events_url": "https://api.github.com/users/alaibe/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alaibe/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/10772/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-desktop/issues/10772/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1655248967",
    "html_url": "https://github.com/status-im/status-desktop/issues/10772#issuecomment-1655248967",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/10772",
    "id": 1655248967,
    "node_id": "IC_kwDOD5KrTM5iqRhH",
    "user": {
      "login": "saledjenic",
      "id": 86303051,
      "node_id": "MDQ6VXNlcjg2MzAzMDUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/86303051?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/saledjenic",
      "html_url": "https://github.com/saledjenic",
      "followers_url": "https://api.github.com/users/saledjenic/followers",
      "following_url": "https://api.github.com/users/saledjenic/following{/other_user}",
      "gists_url": "https://api.github.com/users/saledjenic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/saledjenic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/saledjenic/subscriptions",
      "organizations_url": "https://api.github.com/users/saledjenic/orgs",
      "repos_url": "https://api.github.com/users/saledjenic/repos",
      "events_url": "https://api.github.com/users/saledjenic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/saledjenic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-28T08:15:39Z",
    "updated_at": "2023-07-28T08:23:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "Here are the onboarding options for running a new installed Status app for the first time:\r\n**1. I am new to Status**\r\n**2. I already use Status**\r\n\r\nIf user selects **1.**, options are:\r\n**1.1. generate new keys** [END] (generated a new seed phrase - regular user)\r\n**1.2. generate keys for a new keycard** [END] (generated a new seed phrase - keycard user)\r\n**1.3. import a seed phrase**\r\n\r\nif user selects **1.3.**, options are:\r\n**1.3.1. import a seed phrase** [END] (imported a seed phrase which is generated out of the Status app - regular user)\r\n**1.3.2. import a seed phrase into a new Keycard** [END] (imported a seed phrase which is generated out of the Status app - keycard user)\r\n\r\nif user selects **2.**, options are:\r\n**2.1. scan or enter a sync code** [END] (the app is synced from the app on other device - user will be either regular or keycard related, depends on the configuration on the other device)\r\n**2.2. I don't have other device**\r\n\r\nif user selects **2.2.**, options are:\r\n**2.2.1. login with keycard** [END] (means that user doesn't have another device with the same seed phrase and is trying to recover his account from the backup (waku) - keycard user)\r\n**2.2.2. enter a seed phrase** [END] (means that user doesn't have another device with the same seed phrase and is trying to recover his account from the backup (waku) - regular user)\r\n\r\n**Note:**\r\n- In cases **1.3.1.** and **1.3.2.** imported seed phrase should not be one which was previously created by the Status app. That flow is here to let user import their seed phrases which are created out of the Status app.\r\n\r\n- In case **2.** user is firstly forced to pair devices selecting option **2.1.** if he is an old Status user AND has other device. \r\n\r\n- Case **2.2.** should be used only if user is an old Status user and doesn't have other device with the same seed phrase or he lost it. In that case he has 2 options to recover, using a keycard, option **2.2.1.** or seed phrase option **2.2.2.**.\r\n\r\nBased on what's said here, I am not sure if we need to cover \"**Case 3: when two devices decide to pair**\" from the description of this issue? \r\n\r\nReason: \r\nIt's not possible/expected to have the same seed phrase on two devices if they are not paired or user didn't act honestly on the branching points during the onboarding follow (though we don't have a way to check that, it's more on user's responsibility). I mean when user creates a new seed phrase on a single device and wants to use the same seed on other device, he is not any more a new user on the other device and he should follow the correct onboarding flow there.\r\n\r\n@John-44 @benjthayer @alaibe ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1655248967/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
