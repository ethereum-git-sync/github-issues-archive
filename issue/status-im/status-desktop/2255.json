{
  "url": "https://api.github.com/repos/status-im/status-desktop/issues/2255",
  "repository_url": "https://api.github.com/repos/status-im/status-desktop",
  "labels_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255/comments",
  "events_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255/events",
  "html_url": "https://github.com/status-im/status-desktop/issues/2255",
  "id": 858733725,
  "node_id": "MDU6SXNzdWU4NTg3MzM3MjU=",
  "number": 2255,
  "title": "make deps broken for MacOS builds",
  "user": {
    "login": "jakubgs",
    "id": 2212681,
    "node_id": "MDQ6VXNlcjIyMTI2ODE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jakubgs",
    "html_url": "https://github.com/jakubgs",
    "followers_url": "https://api.github.com/users/jakubgs/followers",
    "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
    "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
    "organizations_url": "https://api.github.com/users/jakubgs/orgs",
    "repos_url": "https://api.github.com/users/jakubgs/repos",
    "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jakubgs/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "jakubgs",
    "id": 2212681,
    "node_id": "MDQ6VXNlcjIyMTI2ODE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jakubgs",
    "html_url": "https://github.com/jakubgs",
    "followers_url": "https://api.github.com/users/jakubgs/followers",
    "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
    "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
    "organizations_url": "https://api.github.com/users/jakubgs/orgs",
    "repos_url": "https://api.github.com/users/jakubgs/repos",
    "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jakubgs/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 14,
  "created_at": "2021-04-15T10:21:08Z",
  "updated_at": "2021-04-16T16:23:16Z",
  "closed_at": "2021-04-16T16:23:16Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "It appears that the #2244 has introduced this error in CI for MacOS builds:\r\n```\r\n05:23:27  + make deps\r\n05:23:27  \\e[92mFetching:\\e[39m bottles for macOS\r\n05:23:27  \\e[92mBuilding:\\e[39m Nim compiler\r\n05:23:30    % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n05:23:30                                   Dload  Upload   Total   Spent    Left  Speed\r\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n05:23:30  \r\n05:23:30  tar: Error opening archive: Unrecognized archive format\r\n05:23:30  make: *** [bottles/pcre/INSTALL_RECEIPT.json] Error 1\r\n05:23:30  make: *** Waiting for unfinished jobs....\r\n```",
  "closed_by": {
    "login": "michaelsbradleyjr",
    "id": 194260,
    "node_id": "MDQ6VXNlcjE5NDI2MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/194260?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/michaelsbradleyjr",
    "html_url": "https://github.com/michaelsbradleyjr",
    "followers_url": "https://api.github.com/users/michaelsbradleyjr/followers",
    "following_url": "https://api.github.com/users/michaelsbradleyjr/following{/other_user}",
    "gists_url": "https://api.github.com/users/michaelsbradleyjr/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/michaelsbradleyjr/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michaelsbradleyjr/subscriptions",
    "organizations_url": "https://api.github.com/users/michaelsbradleyjr/orgs",
    "repos_url": "https://api.github.com/users/michaelsbradleyjr/repos",
    "events_url": "https://api.github.com/users/michaelsbradleyjr/events{/privacy}",
    "received_events_url": "https://api.github.com/users/michaelsbradleyjr/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/2255/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820312738",
    "html_url": "https://github.com/status-im/status-desktop/issues/2255#issuecomment-820312738",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255",
    "id": 820312738,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDMxMjczOA==",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T10:21:45Z",
    "updated_at": "2021-04-15T10:21:45Z",
    "author_association": "MEMBER",
    "body": "This appears to be culprit:\r\nhttps://github.com/status-im/status-desktop/blob/63bc6f0e536ab2d6310e9f45f9be8ae510eb62bd/Makefile#L114-L123",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820312738/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820313779",
    "html_url": "https://github.com/status-im/status-desktop/issues/2255#issuecomment-820313779",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255",
    "id": 820313779,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDMxMzc3OQ==",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T10:23:23Z",
    "updated_at": "2021-04-15T10:23:23Z",
    "author_association": "MEMBER",
    "body": "It appears the file we get is not a GZip archive:\r\n```\r\njenkins@macos-01.ms-eu-dublin.ci.misc:~ % URL=$(brew info --json=v1 pcre | jq -r '.[0].bottle.stable.files.mojave.url')\r\n\r\njenkins@macos-01.ms-eu-dublin.ci.misc:~ % echo $URL\r\nhttps://ghcr.io/v2/homebrew/core/pcre/blobs/sha256:ed9b483538da7bc6559d2e63dd36659736fab9510681661d970d707a18731de4\r\n\r\njenkins@macos-01.ms-eu-dublin.ci.misc:~ % curl -L -o openssl.tar.gz -u _:_ $URL\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current                     \r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100    83  100    83    0     0    351      0 --:--:-- --:--:-- --:--:--   351\r\njenkins@macos-01.ms-eu-dublin.ci.misc:~ % file openssl.tar.gz \r\nopenssl.tar.gz: JSON data\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820313779/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820314530",
    "html_url": "https://github.com/status-im/status-desktop/issues/2255#issuecomment-820314530",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255",
    "id": 820314530,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDMxNDUzMA==",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T10:24:37Z",
    "updated_at": "2021-04-15T10:24:37Z",
    "author_association": "MEMBER",
    "body": "Ah, there we have it:\r\n```\r\njenkins@macos-01.ms-eu-dublin.ci.misc:~ % cat openssl.tar.gz\r\n{\"errors\":[{\"code\":\"UNAUTHORIZED\",\"message\":\"authentication token not provided\"}]}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820314530/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820315078",
    "html_url": "https://github.com/status-im/status-desktop/issues/2255#issuecomment-820315078",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255",
    "id": 820315078,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDMxNTA3OA==",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T10:25:36Z",
    "updated_at": "2021-04-15T10:25:36Z",
    "author_association": "MEMBER",
    "body": "And indeed, we do get a `401`:\r\n```\r\njenkins@macos-01.ms-eu-dublin.ci.misc:~ % curl -isL -u _:_ $URL\r\nHTTP/2 401 \r\ncontent-type: application/json\r\ndocker-distribution-api-version: registry/2.0\r\nwww-authenticate: Bearer realm=\"https://ghcr.io/token\",service=\"ghcr.io\",scope=\"repository:homebrew/core/pcre:pull\"\r\ndate: Thu, 15 Apr 2021 10:25:21 GMT\r\ncontent-length: 83\r\nx-github-request-id: D441:72ED:2C1E05:3568C6:60781491\r\n\r\n{\"errors\":[{\"code\":\"UNAUTHORIZED\",\"message\":\"authentication token not provided\"}]}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820315078/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820320054",
    "html_url": "https://github.com/status-im/status-desktop/issues/2255#issuecomment-820320054",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255",
    "id": 820320054,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDMyMDA1NA==",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T10:34:09Z",
    "updated_at": "2021-04-15T10:34:09Z",
    "author_association": "MEMBER",
    "body": "According to their docs there is an env variable that is supposed to provide the token:\r\n\r\n>`HOMEBREW_GITHUB_PACKAGES_TOKEN`\r\n>Use this GitHub personal access token when accessing the GitHub Packages Registry (where bottles may be stored).\r\n\r\nhttps://docs.brew.sh/Manpage\r\n\r\nBut where that is supposed to come from? No idea. Not even sure why we are downloading it like this.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820320054/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820325055",
    "html_url": "https://github.com/status-im/status-desktop/issues/2255#issuecomment-820325055",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255",
    "id": 820325055,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDMyNTA1NQ==",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T10:42:53Z",
    "updated_at": "2021-04-15T10:42:53Z",
    "author_association": "MEMBER",
    "body": "Also, it seems to me like this is not exactly the safest way of getting something like OpenSSL.\r\n\r\nYou're not even checking a checksum for what you download, nor is the version pinned.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820325055/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820337199",
    "html_url": "https://github.com/status-im/status-desktop/issues/2255#issuecomment-820337199",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255",
    "id": 820337199,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDMzNzE5OQ==",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T11:04:44Z",
    "updated_at": "2021-04-15T11:05:02Z",
    "author_association": "MEMBER",
    "body": "Seems like `ghcr.io` is the default in Homebrew:\r\n```rb\r\n      HOMEBREW_BOTTLE_DOMAIN:                 {\r\n        description:  \"Use this URL as the download mirror for bottles. \" \\\r\n                      \"If bottles at that URL are temporarily unavailable, \" \\\r\n                      \"the default bottle domain will be used as a fallback mirror. \" \\\r\n                      \"For example, `HOMEBREW_BOTTLE_DOMAIN=http://localhost:8080` will cause all bottles to \" \\\r\n                      \"download from the prefix `http://localhost:8080/`. \" \\\r\n                      \"If bottles are not available at `HOMEBREW_BOTTLE_DOMAIN` \" \\\r\n                      \"they will be downloaded from the default bottle domain.\",\r\n        default_text: \"macOS: `https://ghcr.io/v2/homebrew/core`, \" \\\r\n                      \"Linux: `https://ghcr.io/v2/linuxbrew/core`.\",\r\n        default:      HOMEBREW_BOTTLE_DEFAULT_DOMAIN,\r\n      },\r\n```\r\nhttps://github.com/Homebrew/brew/blob/3.1.2/Library/Homebrew/env_config.rb#L47-L58",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820337199/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820453982",
    "html_url": "https://github.com/status-im/status-desktop/issues/2255#issuecomment-820453982",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255",
    "id": 820453982,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDQ1Mzk4Mg==",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T14:12:59Z",
    "updated_at": "2021-04-15T14:12:59Z",
    "author_association": "MEMBER",
    "body": "According to @michaelsbradleyjr the requests fail because they are throttled when no authentication is provided, so that explains why it initially worked, and then started failing. Will definitely can't rely on that to work every time.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820453982/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820456829",
    "html_url": "https://github.com/status-im/status-desktop/issues/2255#issuecomment-820456829",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255",
    "id": 820456829,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDQ1NjgyOQ==",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T14:16:51Z",
    "updated_at": "2021-04-15T14:16:51Z",
    "author_association": "MEMBER",
    "body": "I'd propose downloading the bottles and then uploading them to our own DigitalOcean bucket, and then pin it in the repo and verify SHA256 on download. Apparently OpenSSL doesn't update that often, so we could manage that by hand.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820456829/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820537905",
    "html_url": "https://github.com/status-im/status-desktop/issues/2255#issuecomment-820537905",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255",
    "id": 820537905,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDUzNzkwNQ==",
    "user": {
      "login": "michaelsbradleyjr",
      "id": 194260,
      "node_id": "MDQ6VXNlcjE5NDI2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/194260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsbradleyjr",
      "html_url": "https://github.com/michaelsbradleyjr",
      "followers_url": "https://api.github.com/users/michaelsbradleyjr/followers",
      "following_url": "https://api.github.com/users/michaelsbradleyjr/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsbradleyjr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsbradleyjr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsbradleyjr/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsbradleyjr/orgs",
      "repos_url": "https://api.github.com/users/michaelsbradleyjr/repos",
      "events_url": "https://api.github.com/users/michaelsbradleyjr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsbradleyjr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T15:51:27Z",
    "updated_at": "2021-04-16T01:25:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Ah, there we have it:\r\n> \r\n> ```\r\n> jenkins@macos-01.ms-eu-dublin.ci.misc:~ % cat openssl.tar.gz\r\n> {\"errors\":[{\"code\":\"UNAUTHORIZED\",\"message\":\"authentication token not provided\"}]}\r\n> ```\r\n\r\nIn the description for the [PR](https://github.com/status-im/status-desktop/pull/2244) that changed where the bottles are downloaded from I wrote:\r\n\r\n> At this time downloading from GitHub Packages requires specifying a username and personal acccess token, but it seems they don't have to be valid. For example, in the changes to the Makefile I specified `_:_` as the username and token.\r\n\r\nSo I guess GitHub must be rate limiting how many times you can hit that endpoint without a valid username:token pair.\r\n\r\n> According to their docs there is an env variable that is supposed to provide the token:\r\n> \r\n> > `HOMEBREW_GITHUB_PACKAGES_TOKEN`\r\n> > Use this GitHub personal access token when accessing the GitHub Packages Registry (where bottles may be stored).\r\n> \r\n> https://docs.brew.sh/Manpage\r\n> \r\n> But where that is supposed to come from? No idea. Not even sure why we are downloading it like this.\r\n\r\nThat's a token they're embedding somewhere in the builds of Homebrew. For local development builds, I'll change the Makefile so that curl uses `-u $(GH_USER):$(GH_TOKEN)`. Each developer building for macOS will need to get a token from their account on github.com and setup the environment variables. We'll handle CI as you suggest (see below).\r\n\r\n> Also, it seems to me like this is not exactly the safest way of getting something like OpenSSL.\r\n> \r\n> You're not even checking a checksum for what you download, nor is the version pinned.\r\n\r\nWe weren't checking the hash any time since the start of the desktop project; the only thing that changed in my recent PR was that we were downloading from bintray, and now we're downloading from GitHub Packages.\r\n\r\nHowever, it's good practice to check it so I'll make a change to the Makefile to check it after download. The sha256 to check against is available in the output of e.g. `brew info --json=v1 openssl`.\r\n\r\nAs for pinning, OpenSSL releases security fixes a few times per year, and by downloading whatever is the latest Homebrew build for the oldest macOS for which Homebrew builds bottles, then we automatically pick up those fixes.\r\n\r\nHowever, if we want to pin it in CI, we can. I'll jiggle the Makefile variables for `BOTTLE_OPENSSL` and `BOTTLE_PCRE` so that they can be overriden in the environment. Then in Jenkins CI we can invoke `make` with those set to paths where they've been downloaded from \"our own DigitalOcean bucket\". Does that sound like a decent plan?",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820537905/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820581253",
    "html_url": "https://github.com/status-im/status-desktop/issues/2255#issuecomment-820581253",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255",
    "id": 820581253,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDU4MTI1Mw==",
    "user": {
      "login": "jakubgs",
      "id": 2212681,
      "node_id": "MDQ6VXNlcjIyMTI2ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212681?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jakubgs",
      "html_url": "https://github.com/jakubgs",
      "followers_url": "https://api.github.com/users/jakubgs/followers",
      "following_url": "https://api.github.com/users/jakubgs/following{/other_user}",
      "gists_url": "https://api.github.com/users/jakubgs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jakubgs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jakubgs/subscriptions",
      "organizations_url": "https://api.github.com/users/jakubgs/orgs",
      "repos_url": "https://api.github.com/users/jakubgs/repos",
      "events_url": "https://api.github.com/users/jakubgs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jakubgs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T16:53:25Z",
    "updated_at": "2021-04-15T16:53:25Z",
    "author_association": "MEMBER",
    "body": "Yeah, I guess normal devs won't hit the throttling because they would download it just once, while our CI hosts download them multiple times a day.\r\n\r\nI'm not happy to add edge cases to CI, but it's better than having it fail randomly. But then again, what's the benefit if you build releases in CI? Then you have to make sure you keep the OpenSSL/PCRE version updated in CI before releases, how is that different from keeping it updated in the repo?",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820581253/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820604011",
    "html_url": "https://github.com/status-im/status-desktop/issues/2255#issuecomment-820604011",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255",
    "id": 820604011,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDYwNDAxMQ==",
    "user": {
      "login": "michaelsbradleyjr",
      "id": 194260,
      "node_id": "MDQ6VXNlcjE5NDI2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/194260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsbradleyjr",
      "html_url": "https://github.com/michaelsbradleyjr",
      "followers_url": "https://api.github.com/users/michaelsbradleyjr/followers",
      "following_url": "https://api.github.com/users/michaelsbradleyjr/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsbradleyjr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsbradleyjr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsbradleyjr/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsbradleyjr/orgs",
      "repos_url": "https://api.github.com/users/michaelsbradleyjr/repos",
      "events_url": "https://api.github.com/users/michaelsbradleyjr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsbradleyjr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T17:27:46Z",
    "updated_at": "2021-04-15T17:34:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I'm not happy to add edge cases to CI, but it's better than having it fail randomly. But then again, what's the benefit if you build releases in CI? Then you have to make sure you keep the OpenSSL/PCRE version updated in CI before releases, how is that different from keeping it updated in the repo?\r\n\r\nBefore the changes in #2244 the exact bottles we were downloading were more hardwired than they should have been, I just hadn't thought about it in a long time:\r\n\r\n```\r\nhttps://bintray.com/homebrew/bottles/download_file?file_path=openssl%401.1-1.1.1g.high_sierra.bottle.tar.gz\r\nhttps://bintray.com/homebrew/bottles/download_file?file_path=pcre-8.44.high_sierra.bottle.tar.gz\r\n```\r\n\r\nWe were using those the whole time even though there have been newer versions of the openssl bottle published.\r\n\r\nWith the changes in #2244 it's no longer hardwired, i.e. the latest version of the openssl and pcre bottles built for Mojave (10.14) will be downloaded. \r\n\r\nSo an option would be in CI to setup `GH_USER` and `GH_TOKEN` in the environment and then CI will download whatever is the latest and we don't have to keep the versions updated in the repo nor in CI. I think that approach would be the simplest, but not sure how you feel about it.\r\n\r\nI still need to create the PR that uses `GH_USER` and `GH_TOKEN`, but I'll have that done later today.\r\n\r\nSide note: some day in the future Homebrew will stop building bottles for Mojave and I'll need to change it to Catalina (10.15). It's hard to predict when that will happen, but we'd know when it does because the CI builds would break.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820604011/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820743960",
    "html_url": "https://github.com/status-im/status-desktop/issues/2255#issuecomment-820743960",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255",
    "id": 820743960,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDc0Mzk2MA==",
    "user": {
      "login": "michaelsbradleyjr",
      "id": 194260,
      "node_id": "MDQ6VXNlcjE5NDI2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/194260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsbradleyjr",
      "html_url": "https://github.com/michaelsbradleyjr",
      "followers_url": "https://api.github.com/users/michaelsbradleyjr/followers",
      "following_url": "https://api.github.com/users/michaelsbradleyjr/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsbradleyjr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsbradleyjr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsbradleyjr/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsbradleyjr/orgs",
      "repos_url": "https://api.github.com/users/michaelsbradleyjr/repos",
      "events_url": "https://api.github.com/users/michaelsbradleyjr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsbradleyjr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-15T21:30:58Z",
    "updated_at": "2021-04-15T21:30:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "See #2258.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/820743960/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/821291063",
    "html_url": "https://github.com/status-im/status-desktop/issues/2255#issuecomment-821291063",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/2255",
    "id": 821291063,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMTI5MTA2Mw==",
    "user": {
      "login": "michaelsbradleyjr",
      "id": 194260,
      "node_id": "MDQ6VXNlcjE5NDI2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/194260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsbradleyjr",
      "html_url": "https://github.com/michaelsbradleyjr",
      "followers_url": "https://api.github.com/users/michaelsbradleyjr/followers",
      "following_url": "https://api.github.com/users/michaelsbradleyjr/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsbradleyjr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsbradleyjr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsbradleyjr/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsbradleyjr/orgs",
      "repos_url": "https://api.github.com/users/michaelsbradleyjr/repos",
      "events_url": "https://api.github.com/users/michaelsbradleyjr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsbradleyjr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-16T16:23:16Z",
    "updated_at": "2021-04-16T16:23:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "Closed by #2258.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/821291063/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
