{
  "url": "https://api.github.com/repos/status-im/status-desktop/issues/11686",
  "repository_url": "https://api.github.com/repos/status-im/status-desktop",
  "labels_url": "https://api.github.com/repos/status-im/status-desktop/issues/11686/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-desktop/issues/11686/comments",
  "events_url": "https://api.github.com/repos/status-im/status-desktop/issues/11686/events",
  "html_url": "https://github.com/status-im/status-desktop/issues/11686",
  "id": 1823759454,
  "node_id": "I_kwDOD5KrTM5stFxe",
  "number": 11686,
  "title": "Missing community messages when re-joining",
  "user": {
    "login": "osmaczko",
    "id": 33099791,
    "node_id": "MDQ6VXNlcjMzMDk5Nzkx",
    "avatar_url": "https://avatars.githubusercontent.com/u/33099791?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/osmaczko",
    "html_url": "https://github.com/osmaczko",
    "followers_url": "https://api.github.com/users/osmaczko/followers",
    "following_url": "https://api.github.com/users/osmaczko/following{/other_user}",
    "gists_url": "https://api.github.com/users/osmaczko/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/osmaczko/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/osmaczko/subscriptions",
    "organizations_url": "https://api.github.com/users/osmaczko/orgs",
    "repos_url": "https://api.github.com/users/osmaczko/repos",
    "events_url": "https://api.github.com/users/osmaczko/events{/privacy}",
    "received_events_url": "https://api.github.com/users/osmaczko/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2036563458,
      "node_id": "MDU6TGFiZWwyMDM2NTYzNDU4",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    },
    {
      "id": 4548141040,
      "node_id": "LA_kwDOD5KrTM8AAAABDxcf8A",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/messenger-team",
      "name": "messenger-team",
      "color": "232858",
      "default": false,
      "description": ""
    },
    {
      "id": 5745637395,
      "node_id": "LA_kwDOD5KrTM8AAAABVnd4Ew",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/E:Desktop%20Community%20Bugfixes%20MVP",
      "name": "E:Desktop Community Bugfixes MVP",
      "color": "01CE46",
      "default": false,
      "description": "Misc bug fixes about communities that are due for the MVP"
    },
    {
      "id": 6176323312,
      "node_id": "LA_kwDOD5KrTM8AAAABcCM28A",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/E:Desktop%20Bugfixes%200.15.5",
      "name": "E:Desktop Bugfixes 0.15.5",
      "color": "BFE9C3",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [
    {
      "login": "igor-sirotin",
      "id": 25482501,
      "node_id": "MDQ6VXNlcjI1NDgyNTAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25482501?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/igor-sirotin",
      "html_url": "https://github.com/igor-sirotin",
      "followers_url": "https://api.github.com/users/igor-sirotin/followers",
      "following_url": "https://api.github.com/users/igor-sirotin/following{/other_user}",
      "gists_url": "https://api.github.com/users/igor-sirotin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/igor-sirotin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/igor-sirotin/subscriptions",
      "organizations_url": "https://api.github.com/users/igor-sirotin/orgs",
      "repos_url": "https://api.github.com/users/igor-sirotin/repos",
      "events_url": "https://api.github.com/users/igor-sirotin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/igor-sirotin/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": {
    "url": "https://api.github.com/repos/status-im/status-desktop/milestones/61",
    "html_url": "https://github.com/status-im/status-desktop/milestone/61",
    "labels_url": "https://api.github.com/repos/status-im/status-desktop/milestones/61/labels",
    "id": 8739485,
    "node_id": "MI_kwDOD5KrTM4AhVqd",
    "number": 61,
    "title": "0.16",
    "description": "**1.  Fix bug and stabilise Communities and Messaging functionality**\r\n\r\n**2.  Reduce size of community description metadata**\r\n- better compressions, less duplication\r\n\r\n**3. Use data sync layer (or other mechanism) to improve community description reliability**\r\n- Every time a new user joins the community, the Control Node updates and signs the description.\r\n- Random back off to stop it being too chatty \r\n\r\n**4. Continue work on profile showcase **\r\n\r\n\r\n\r\n**--- Wallet Team ---**\r\n\r\n1. Complete support for Community minted assets\r\n\r\n2. Complete token visibility management screens\r\n\r\n3. Continue working on WalletConnect support\r\n\r\n4. Minor updates to Asset screens\r\n\r\n5. Continue fixing bugs, making optimisations and keeping tech debt low\r\n\r\n\r\n\r\n\r\n",
    "creator": {
      "login": "iurimatias",
      "id": 176720,
      "node_id": "MDQ6VXNlcjE3NjcyMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176720?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iurimatias",
      "html_url": "https://github.com/iurimatias",
      "followers_url": "https://api.github.com/users/iurimatias/followers",
      "following_url": "https://api.github.com/users/iurimatias/following{/other_user}",
      "gists_url": "https://api.github.com/users/iurimatias/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iurimatias/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iurimatias/subscriptions",
      "organizations_url": "https://api.github.com/users/iurimatias/orgs",
      "repos_url": "https://api.github.com/users/iurimatias/repos",
      "events_url": "https://api.github.com/users/iurimatias/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iurimatias/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 178,
    "closed_issues": 50,
    "state": "open",
    "created_at": "2022-12-09T15:06:43Z",
    "updated_at": "2023-12-04T18:45:21Z",
    "due_on": "2024-01-31T08:00:00Z",
    "closed_at": null
  },
  "comments": 2,
  "created_at": "2023-07-27T07:12:04Z",
  "updated_at": "2023-12-04T17:13:30Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Community-level encryption:\r\n1. Create token-gated community - ✓\r\n2. Join with MemberA who satisfies the criteria - ✓\r\n3. Send message \"X\" to general channel - ✓\r\n4. MemberA should see the \"X\" message - ✓\r\n5. Change token permissions so that MemberA no longer satisfies the criteria - ✓\r\n6. MemberA should be kicked from the community - ✓ \r\n7. Send message \"Y\" to general channel - ✓\r\n8. Change token permissions so that MemberA once again meets the criteria - ✓\r\n9. MemberA should be ~~re-added to the community - X (user has to manually re-join)~~ able to manually re-join\r\n**10. MemberA should see both \"X\" and \"Y\" messages - X (only sees \"X\")**\r\n11. Send message \"Z\" to general channel - ✓\r\n12. MemberA should see \"X\", \"Y\" and \"Z\" messages - X (only sees \"X\" and \"Z\")\r\n\r\n_Originally posted by @lukaszso in https://github.com/status-im/status-desktop/issues/11657#issuecomment-1650700759_\r\n            \r\n I believe it happens also on non token-gated communities.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/11686/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-desktop/issues/11686/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1671923930",
    "html_url": "https://github.com/status-im/status-desktop/issues/11686#issuecomment-1671923930",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/11686",
    "id": 1671923930,
    "node_id": "IC_kwDOD5KrTM5jp4ja",
    "user": {
      "login": "igor-sirotin",
      "id": 25482501,
      "node_id": "MDQ6VXNlcjI1NDgyNTAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25482501?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/igor-sirotin",
      "html_url": "https://github.com/igor-sirotin",
      "followers_url": "https://api.github.com/users/igor-sirotin/followers",
      "following_url": "https://api.github.com/users/igor-sirotin/following{/other_user}",
      "gists_url": "https://api.github.com/users/igor-sirotin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/igor-sirotin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/igor-sirotin/subscriptions",
      "organizations_url": "https://api.github.com/users/igor-sirotin/orgs",
      "repos_url": "https://api.github.com/users/igor-sirotin/repos",
      "events_url": "https://api.github.com/users/igor-sirotin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/igor-sirotin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-09T18:23:12Z",
    "updated_at": "2023-08-09T18:23:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "Might be related: https://github.com/status-im/status-go/issues/3869",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1671923930/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1673586166",
    "html_url": "https://github.com/status-im/status-desktop/issues/11686#issuecomment-1673586166",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/11686",
    "id": 1673586166,
    "node_id": "IC_kwDOD5KrTM5jwOX2",
    "user": {
      "login": "igor-sirotin",
      "id": 25482501,
      "node_id": "MDQ6VXNlcjI1NDgyNTAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25482501?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/igor-sirotin",
      "html_url": "https://github.com/igor-sirotin",
      "followers_url": "https://api.github.com/users/igor-sirotin/followers",
      "following_url": "https://api.github.com/users/igor-sirotin/following{/other_user}",
      "gists_url": "https://api.github.com/users/igor-sirotin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/igor-sirotin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/igor-sirotin/subscriptions",
      "organizations_url": "https://api.github.com/users/igor-sirotin/orgs",
      "repos_url": "https://api.github.com/users/igor-sirotin/repos",
      "events_url": "https://api.github.com/users/igor-sirotin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/igor-sirotin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-10T17:00:58Z",
    "updated_at": "2023-08-10T18:19:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "The issue is reproduced in many different ways (at least I think it's the same issue).\r\n\r\nIn all cases application restart helps.\r\nThough if there was a long pause (e.g. 1hr) messages are not shown even after app restart.\r\n\r\nNot reproducible on mobile.\r\n\r\n### Prerequisites:\r\n\r\n1. Admin: Create a community\r\n    - community history service: `doesn't matter`\r\n    - request to join: `doesn't matter`\r\n2. Admin: Share community with User\r\n\r\n### 1️⃣ Last messages of spectated communities\r\n\r\n1. Admin: Send a message `X`\r\n2. User: Spectate the community\r\n3. User: No message `X` visible ❌ \r\n4. User: restart the app\r\n5. User: Message `X` visible ✅ \r\n\r\n### 2️⃣ Restart the app before spectate\r\n\r\n1. Admin: Send a message `X`\r\n2. User: Restart the app\r\n3. User: Spectate the community\r\n6. User: Message `X` visible ✅ \r\n\r\n### 3️⃣  Message in closed spectated community\r\n\r\n1. User: Spectate the community\r\n3. Admin: send message `X`\r\n4. User: message `X` visible\r\n5. User: Close the community\r\n7. Admin: send message `Y`\r\n8. User: Spectate community again\r\n9. User: no message `Y` visible ❌\r\n10. User: restart the app \r\n5. User: Message `Y` visible ✅ \r\n\r\n### 4️⃣ Leave and spectate community\r\n\r\n1. User: Send request to join\r\n2. Admin: Accept request to join\r\n3. Admin: send message `X`\r\n4. User: message `X` visible\r\n5. User: Leave the community\r\n7. Admin: send message `Y`\r\n8. User: Spectate community (or event join the community)\r\n9. User: no message `Y` visible ❌\r\n10. User: restart the app \r\n5. User: Message `Y` visible ✅ \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1673586166/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
