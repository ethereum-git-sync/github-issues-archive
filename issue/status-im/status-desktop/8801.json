{
  "url": "https://api.github.com/repos/status-im/status-desktop/issues/8801",
  "repository_url": "https://api.github.com/repos/status-im/status-desktop",
  "labels_url": "https://api.github.com/repos/status-im/status-desktop/issues/8801/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-desktop/issues/8801/comments",
  "events_url": "https://api.github.com/repos/status-im/status-desktop/issues/8801/events",
  "html_url": "https://github.com/status-im/status-desktop/issues/8801",
  "id": 1497229876,
  "node_id": "I_kwDOD5KrTM5ZPeo0",
  "number": 8801,
  "title": "Clicking \"Go to Community\" on a big community calls `chat_getMembers` a ton",
  "user": {
    "login": "jrainville",
    "id": 11926403,
    "node_id": "MDQ6VXNlcjExOTI2NDAz",
    "avatar_url": "https://avatars.githubusercontent.com/u/11926403?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jrainville",
    "html_url": "https://github.com/jrainville",
    "followers_url": "https://api.github.com/users/jrainville/followers",
    "following_url": "https://api.github.com/users/jrainville/following{/other_user}",
    "gists_url": "https://api.github.com/users/jrainville/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jrainville/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jrainville/subscriptions",
    "organizations_url": "https://api.github.com/users/jrainville/orgs",
    "repos_url": "https://api.github.com/users/jrainville/repos",
    "events_url": "https://api.github.com/users/jrainville/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jrainville/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2036563458,
      "node_id": "MDU6TGFiZWwyMDM2NTYzNDU4",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    },
    {
      "id": 2588688093,
      "node_id": "MDU6TGFiZWwyNTg4Njg4MDkz",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/Communities",
      "name": "Communities",
      "color": "3923e0",
      "default": false,
      "description": ""
    },
    {
      "id": 3955125927,
      "node_id": "LA_kwDOD5KrTM7rvm6n",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/E:Communities",
      "name": "E:Communities",
      "color": "E56631",
      "default": false,
      "description": ""
    },
    {
      "id": 4220089404,
      "node_id": "LA_kwDOD5KrTM77iXQ8",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/S:3",
      "name": "S:3",
      "color": "03A6A2",
      "default": false,
      "description": "We know what needs to be done, some extra steps, but thatâ€™s it, little to no unknowns"
    },
    {
      "id": 4548141040,
      "node_id": "LA_kwDOD5KrTM8AAAABDxcf8A",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/messenger-team",
      "name": "messenger-team",
      "color": "232858",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "mprakhov",
    "id": 117639195,
    "node_id": "U_kgDOBwMIGw",
    "avatar_url": "https://avatars.githubusercontent.com/u/117639195?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mprakhov",
    "html_url": "https://github.com/mprakhov",
    "followers_url": "https://api.github.com/users/mprakhov/followers",
    "following_url": "https://api.github.com/users/mprakhov/following{/other_user}",
    "gists_url": "https://api.github.com/users/mprakhov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mprakhov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mprakhov/subscriptions",
    "organizations_url": "https://api.github.com/users/mprakhov/orgs",
    "repos_url": "https://api.github.com/users/mprakhov/repos",
    "events_url": "https://api.github.com/users/mprakhov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mprakhov/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "mprakhov",
      "id": 117639195,
      "node_id": "U_kgDOBwMIGw",
      "avatar_url": "https://avatars.githubusercontent.com/u/117639195?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mprakhov",
      "html_url": "https://github.com/mprakhov",
      "followers_url": "https://api.github.com/users/mprakhov/followers",
      "following_url": "https://api.github.com/users/mprakhov/following{/other_user}",
      "gists_url": "https://api.github.com/users/mprakhov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mprakhov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mprakhov/subscriptions",
      "organizations_url": "https://api.github.com/users/mprakhov/orgs",
      "repos_url": "https://api.github.com/users/mprakhov/repos",
      "events_url": "https://api.github.com/users/mprakhov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mprakhov/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-12-14T19:07:24Z",
  "updated_at": "2022-12-27T17:29:57Z",
  "closed_at": "2022-12-27T17:29:57Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "# Bug Report\r\n\r\n## Description\r\n\r\nFor example, posting the link to the Status community, then clicking the button to see the community, calls `chat_getMembers` a ton. It makes the app completely unresponsive.\r\n\r\n## Steps to reproduce\r\n\r\n1. Post this link in a channel https://join.status.im/c/zQ3shf8EvhRKHSc3skgtupULuLdWh59S5czZkvS69P6rJ7aed\r\n2. Wait for the link to unfurl\r\n3. Click the button\r\n\r\nSee the console all the logs.\r\nIf it doesn't work, leave the community and try again after a reopening\r\n\r\nThe stack trace seems to be the following:\r\n\r\n```\r\n/home/richard/status/status-desktop/src/app/core/signals/signals_manager.nim(53) processSignal \r\n/home/richard/status/status-desktop/src/app/core/eventemitter.nim(57) emit \r\n/home/richard/status/status-desktop/src/app_service/service/community/service.nim(199) :anonymous \r\n/home/richard/status/status-desktop/src/app_service/service/community/service.nim(435) handleCommunityUpdates \r\n/home/richard/status/status-desktop/src/app/core/eventemitter.nim(57) emit \r\n/home/richard/status/status-desktop/src/app/modules/main/chat_section/chat_content/users/controller.nim(61) :anonymous \r\n/home/richard/status/status-desktop/src/app/modules/main/chat_section/chat_content/users/io_interface.nim(40) onChatMembersAddedOrRemoved \r\n/home/richard/status/status-desktop/src/app/modules/main/chat_section/chat_content/users/module.nim(188) onChatMembersAddedOrRemoved \r\n/home/richard/status/status-desktop/src/app/modules/main/chat_section/chat_content/users/io_interface.nim(43) onChatMembersAdded \r\n/home/richard/status/status-desktop/src/app/modules/main/chat_section/chat_content/users/module.nim(163) onChatMembersAdded \r\n/home/richard/status/status-desktop/src/app/modules/main/chat_section/chat_content/users/controller.nim(162) getChatMember \r\n/home/richard/status/status-desktop/src/app/modules/main/chat_section/chat_content/users/controller.nim(159) getChatMembers \r\n/home/richard/status/status-desktop/src/app_service/service/chat/service.nim(600) getMembers \r\n/home/richard/status/status-desktop/src/backend/chat.nim(136) getMembers \r\n/home/richard/status/status-desktop/src/backend/core.nim(55) callPrivateRPC \r\n/home/richard/status/status-desktop/src/backend/core.nim(21) makePrivateRpcCall \r\n```\r\n\r\n### Additional Information\r\n\r\n- Status desktop version: master (`3f01af4446661f77cf523588ae8ab22ec136723e`)\r\n- Operating System: Ubuntu 20\r\n\r\n",
  "closed_by": {
    "login": "mprakhov",
    "id": 117639195,
    "node_id": "U_kgDOBwMIGw",
    "avatar_url": "https://avatars.githubusercontent.com/u/117639195?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mprakhov",
    "html_url": "https://github.com/mprakhov",
    "followers_url": "https://api.github.com/users/mprakhov/followers",
    "following_url": "https://api.github.com/users/mprakhov/following{/other_user}",
    "gists_url": "https://api.github.com/users/mprakhov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mprakhov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mprakhov/subscriptions",
    "organizations_url": "https://api.github.com/users/mprakhov/orgs",
    "repos_url": "https://api.github.com/users/mprakhov/repos",
    "events_url": "https://api.github.com/users/mprakhov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mprakhov/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/8801/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-desktop/issues/8801/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1363935012",
    "html_url": "https://github.com/status-im/status-desktop/issues/8801#issuecomment-1363935012",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/8801",
    "id": 1363935012,
    "node_id": "IC_kwDOD5KrTM5RS_8k",
    "user": {
      "login": "mprakhov",
      "id": 117639195,
      "node_id": "U_kgDOBwMIGw",
      "avatar_url": "https://avatars.githubusercontent.com/u/117639195?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mprakhov",
      "html_url": "https://github.com/mprakhov",
      "followers_url": "https://api.github.com/users/mprakhov/followers",
      "following_url": "https://api.github.com/users/mprakhov/following{/other_user}",
      "gists_url": "https://api.github.com/users/mprakhov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mprakhov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mprakhov/subscriptions",
      "organizations_url": "https://api.github.com/users/mprakhov/orgs",
      "repos_url": "https://api.github.com/users/mprakhov/repos",
      "events_url": "https://api.github.com/users/mprakhov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mprakhov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-23T13:02:10Z",
    "updated_at": "2022-12-23T13:02:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "There are 2 problems:\r\n1. Minor: code issue, unnecessary loop, and increased algorithm complexity from n2 to n3 (where we additionally request `chat_getMembers`)\r\n2. Priority: If we view the community, but do not join it - we don't see the members of the community. This is because on status go all members have our `join` community status during the `get_chatMembers` request (which is false). \r\n\r\nThe question is: Should we see the members list when we view the community (we are not joined)? @pedro-et \r\nDepending on the answer, there will be appropriate fix:\r\n1. If yes - status go must return the correct members' join status\r\n2. If no - we shouldn't try to add users, because due to member states `join=false` they won't be added anyway.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1363935012/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1364085032",
    "html_url": "https://github.com/status-im/status-desktop/issues/8801#issuecomment-1364085032",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/8801",
    "id": 1364085032,
    "node_id": "IC_kwDOD5KrTM5RTkko",
    "user": {
      "login": "jrainville",
      "id": 11926403,
      "node_id": "MDQ6VXNlcjExOTI2NDAz",
      "avatar_url": "https://avatars.githubusercontent.com/u/11926403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jrainville",
      "html_url": "https://github.com/jrainville",
      "followers_url": "https://api.github.com/users/jrainville/followers",
      "following_url": "https://api.github.com/users/jrainville/following{/other_user}",
      "gists_url": "https://api.github.com/users/jrainville/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jrainville/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jrainville/subscriptions",
      "organizations_url": "https://api.github.com/users/jrainville/orgs",
      "repos_url": "https://api.github.com/users/jrainville/repos",
      "events_url": "https://api.github.com/users/jrainville/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jrainville/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-23T16:13:17Z",
    "updated_at": "2022-12-23T16:13:17Z",
    "author_association": "MEMBER",
    "body": "@mprakhov If it is possible to do it easily, I would say go ahead and remove the members list during the spectate mode. The UX gain of knowing who is in a community is not greater than the decrease in performance we get right now.\r\n\r\nIf we later want to see it during spectate, we can do it correctly in another issue, because it seems to be broken as you've pointed out.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1364085032/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
