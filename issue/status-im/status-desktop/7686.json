{
  "url": "https://api.github.com/repos/status-im/status-desktop/issues/7686",
  "repository_url": "https://api.github.com/repos/status-im/status-desktop",
  "labels_url": "https://api.github.com/repos/status-im/status-desktop/issues/7686/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-desktop/issues/7686/comments",
  "events_url": "https://api.github.com/repos/status-im/status-desktop/issues/7686/events",
  "html_url": "https://github.com/status-im/status-desktop/issues/7686",
  "id": 1392074155,
  "node_id": "I_kwDOD5KrTM5S-V2r",
  "number": 7686,
  "title": "Chat input: adding character directly after mention causes changing mention to a pubkey",
  "user": {
    "login": "micieslak",
    "id": 20650004,
    "node_id": "MDQ6VXNlcjIwNjUwMDA0",
    "avatar_url": "https://avatars.githubusercontent.com/u/20650004?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/micieslak",
    "html_url": "https://github.com/micieslak",
    "followers_url": "https://api.github.com/users/micieslak/followers",
    "following_url": "https://api.github.com/users/micieslak/following{/other_user}",
    "gists_url": "https://api.github.com/users/micieslak/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/micieslak/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/micieslak/subscriptions",
    "organizations_url": "https://api.github.com/users/micieslak/orgs",
    "repos_url": "https://api.github.com/users/micieslak/repos",
    "events_url": "https://api.github.com/users/micieslak/events{/privacy}",
    "received_events_url": "https://api.github.com/users/micieslak/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2036563458,
      "node_id": "MDU6TGFiZWwyMDM2NTYzNDU4",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    },
    {
      "id": 2087353959,
      "node_id": "MDU6TGFiZWwyMDg3MzUzOTU5",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/ui-team",
      "name": "ui-team",
      "color": "1111ff",
      "default": false,
      "description": ""
    },
    {
      "id": 3205511249,
      "node_id": "MDU6TGFiZWwzMjA1NTExMjQ5",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/priority%202:%20medium",
      "name": "priority 2: medium",
      "color": "FBCA04",
      "default": false,
      "description": "an issue that is not severely affecting the overall app, it may interfere with some users users expe"
    },
    {
      "id": 4887814632,
      "node_id": "LA_kwDOD5KrTM8AAAABI1Yh6A",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/StatusChatInput",
      "name": "StatusChatInput",
      "color": "331025",
      "default": false,
      "description": "Issues related to chat input component"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "alexjba",
    "id": 47811206,
    "node_id": "MDQ6VXNlcjQ3ODExMjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/47811206?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alexjba",
    "html_url": "https://github.com/alexjba",
    "followers_url": "https://api.github.com/users/alexjba/followers",
    "following_url": "https://api.github.com/users/alexjba/following{/other_user}",
    "gists_url": "https://api.github.com/users/alexjba/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alexjba/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alexjba/subscriptions",
    "organizations_url": "https://api.github.com/users/alexjba/orgs",
    "repos_url": "https://api.github.com/users/alexjba/repos",
    "events_url": "https://api.github.com/users/alexjba/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alexjba/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "alexjba",
      "id": 47811206,
      "node_id": "MDQ6VXNlcjQ3ODExMjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/47811206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexjba",
      "html_url": "https://github.com/alexjba",
      "followers_url": "https://api.github.com/users/alexjba/followers",
      "following_url": "https://api.github.com/users/alexjba/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexjba/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexjba/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexjba/subscriptions",
      "organizations_url": "https://api.github.com/users/alexjba/orgs",
      "repos_url": "https://api.github.com/users/alexjba/repos",
      "events_url": "https://api.github.com/users/alexjba/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexjba/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": {
    "url": "https://api.github.com/repos/status-im/status-desktop/milestones/53",
    "html_url": "https://github.com/status-im/status-desktop/milestone/53",
    "labels_url": "https://api.github.com/repos/status-im/status-desktop/milestones/53/labels",
    "id": 8475612,
    "node_id": "MI_kwDOD5KrTM4AgVPc",
    "number": 53,
    "title": "0.9.0",
    "description": "General:\r\n- Memory Usage Improvements (part 2)\r\n\r\nChat:\r\n- Fixes & Improvements to ENS support\r\n- Fixes & Improvements to chat input\r\n\r\nCommunities:\r\n- Communities MVP admin functionality \r\n\r\nWallet:\r\n- Second bridge integragrated\r\n- Bridge UI\r\n- Multi Transaction view + notification\r\n- Latency improvement for fetching data in the wallet\r\n- keycard\r\n  Import or restore a Keycard via a seed phrase\r\n  Migrate an exsiting account from Keycard to Status Desktop\r\n  UI for the keycard settings in case user has set up a keycard",
    "creator": {
      "login": "iurimatias",
      "id": 176720,
      "node_id": "MDQ6VXNlcjE3NjcyMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176720?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iurimatias",
      "html_url": "https://github.com/iurimatias",
      "followers_url": "https://api.github.com/users/iurimatias/followers",
      "following_url": "https://api.github.com/users/iurimatias/following{/other_user}",
      "gists_url": "https://api.github.com/users/iurimatias/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iurimatias/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iurimatias/subscriptions",
      "organizations_url": "https://api.github.com/users/iurimatias/orgs",
      "repos_url": "https://api.github.com/users/iurimatias/repos",
      "events_url": "https://api.github.com/users/iurimatias/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iurimatias/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 175,
    "state": "closed",
    "created_at": "2022-09-28T20:06:10Z",
    "updated_at": "2023-01-16T16:57:31Z",
    "due_on": "2022-12-19T08:00:00Z",
    "closed_at": "2023-01-16T16:57:31Z"
  },
  "comments": 7,
  "created_at": "2022-09-30T08:37:20Z",
  "updated_at": "2022-12-21T10:23:42Z",
  "closed_at": "2022-12-21T10:23:41Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "# Bug Report\r\n\r\n## Description\r\n\r\nAdditionally, in some cases HTML snippet is displayed as well.\r\n\r\n[Kazam_screencast_00024.webm](https://user-images.githubusercontent.com/20650004/193228349-484af806-f1e0-4c77-b085-2e1594ecda38.webm)\r\n\r\n## Steps to reproduce\r\n\r\nInsert mention, position cursor directly after mention using arrows, add some text, send\r\n\r\n#### Expected behavior\r\n\r\nMessage should be displayed in the same way as in the input field.\r\n\r\n#### Actual behavior\r\n\r\nMention is expanded to pubkey, in some cases html snippet is added\r\n\r\n### Additional Information\r\n\r\n- Status desktop version:\r\n- Operating System:\r\n\r\n",
  "closed_by": {
    "login": "alexjba",
    "id": 47811206,
    "node_id": "MDQ6VXNlcjQ3ODExMjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/47811206?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alexjba",
    "html_url": "https://github.com/alexjba",
    "followers_url": "https://api.github.com/users/alexjba/followers",
    "following_url": "https://api.github.com/users/alexjba/following{/other_user}",
    "gists_url": "https://api.github.com/users/alexjba/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alexjba/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alexjba/subscriptions",
    "organizations_url": "https://api.github.com/users/alexjba/orgs",
    "repos_url": "https://api.github.com/users/alexjba/repos",
    "events_url": "https://api.github.com/users/alexjba/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alexjba/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/7686/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-desktop/issues/7686/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1326768818",
    "html_url": "https://github.com/status-im/status-desktop/issues/7686#issuecomment-1326768818",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/7686",
    "id": 1326768818,
    "node_id": "IC_kwDOD5KrTM5PFOKy",
    "user": {
      "login": "alexjba",
      "id": 47811206,
      "node_id": "MDQ6VXNlcjQ3ODExMjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/47811206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexjba",
      "html_url": "https://github.com/alexjba",
      "followers_url": "https://api.github.com/users/alexjba/followers",
      "following_url": "https://api.github.com/users/alexjba/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexjba/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexjba/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexjba/subscriptions",
      "organizations_url": "https://api.github.com/users/alexjba/orgs",
      "repos_url": "https://api.github.com/users/alexjba/repos",
      "events_url": "https://api.github.com/users/alexjba/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexjba/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-24T18:43:24Z",
    "updated_at": "2022-11-24T18:43:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "Status chat input has several issues that needs to be fixed and considered for the final solution that will fix this bug:\r\n\r\n#### Functional issue\r\n1. Mentions must end with one of the chars: isSpace(c) || c == '.' || c == ',' || c == ':' || c == ';'. In the UI it is possible to send mentions that won’t end with these chars. \r\n\r\n    Ex: Add mention, hit backspace, type text.<br>Result: As seen in this bug description - the message is malformed.\r\n    \r\n    Root cause: Wrong key/mouse event processing in StatusChatInput.qml. It should not let the user invalidate the mention without knowing. (UI shows the mention as being ok until the message is sent)<br>\r\n\r\n2. Insert mention, insert mention, delete space, hit left, hit enter -> message is malformed<br>Root cause: duplicated mention in mentions array (StatusChatInput.qml)\r\n\r\n3. Add mention, add text, hit backspace, place cursor at the end of a mention -> Mention is deleted.<br> Root cause: StatusChatInput onCursorPositionChanged processes text based on last known key used. In this case backspace, even if the cursor was moved by mouse.\r\n\r\n4. MentionSuggestionPopup doesn’t work well with key navigation when StatusChatInput is used in edit message mode. To reproduce this send a message in community, try to edit, add @ to trigger the suggestions and navigate using up/down <br>Root cause: Key.up/down is processed on out of focus items\r\n\r\n5. Add mention, click in the middle of the mention (cursor placed in the middle. Should not be possible since you cannot place the cursor in the middle by keyboard navigation), add character, the character is added immediately after mention (although the mention needs to end with space), the mention+new char is selected, hit enter -> message is malformed. <br> Root cause: moving cursor with mouse is not processed in the same way as moving cursor with keyboard nav\r\n\r\n6. Create chat -> No public key conversion in CreateChatView.qml; no mentions possible also. <br>\r\nRoot cause: missing implementation\r\n\r\n7. EmojiSuggestionPopup doesn’t work well with key navigation when StatusChatInput is used in edit message mode <br>Root cause: Key.up/down is processed on out of focus items (same as mentions)\r\n\r\n8. Edit message -> No custom emoji support (needs to be parsed before showing the message input). <br>\r\nRoot cause: missing implementation\r\n\r\n#### Design issues:\r\n1. StatusChatInput: <br>\r\n    a. Emoji and mentions are tightly coupled with the TextArea<br> As a result the implementation became sticky. It has high regression risk on every change<br>\r\n    b. Redundant and also unused code. I guess this is a result of a).<br>\r\n    c. Polluted public API. StatusChatInput API is used in different ways to obtain the same result (ex: Edit message feature and chat input feature). As a result we have different behaviours/bugs.\r\n    \r\n2. Duplicated code for message parsing: <br>Chat Root store, message store use duplicated code to parse the message (interpretMessage)<br>\r\nMessageView.qml editCompletedHandler() similar parsing logic as sendMessage - just that it works better with mentions\r\n\r\nMy suggestion is to refactor StatusChatInput, to decouple emoji and mentions features and use them as decorators on top of TextArea. After this we can clean StatusChatInput, remove redundancy, unused code and we can clean the public API.\r\nAfter refactoring, fixing all issues or adding other custom features would become much easier.\r\n\r\nThe result would look something like this:\r\n```\r\n//StatusChatInput.qml\r\n\r\nRectangle {\r\n   [...]\r\n   MentionsFeature {\r\n    id: mentionsFeature\r\n    wrapee: textArea\r\n   }\r\n   \r\n   EmojiFeature {\r\n    id: emojiFeature\r\n    wrapee: textArea\r\n   }\r\n   \r\n   TextArea {\r\n    id: textArea\r\n    [...]\r\n    Key.forwardTo: [mentionsFeature, emojiFeature]\r\n   }\r\n}\r\n\r\n//MentionsFeature.qml\r\nItem {\r\n    property TextArea wrapee\r\n    Connections {\r\n        target: wrapee\r\n        onTextChanged: ...\r\n        onCursorPositionChanged: ...\r\n        [...]\r\n    }\r\n}\r\n```\r\n\r\n@noeliaSD, @micieslak, @caybro, @alexandraB99, @iurimatias.\r\nI would appreciate some thoughts on this before I invest more time on it. <br>I'm barely scratching the surface of the chat input and I think we need to invest some time in refactoring this component, but I don't know if we have the time to do it, if it's planned already or if I would ovelap with someone else's work.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1326768818/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1326800129",
    "html_url": "https://github.com/status-im/status-desktop/issues/7686#issuecomment-1326800129",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/7686",
    "id": 1326800129,
    "node_id": "IC_kwDOD5KrTM5PFV0B",
    "user": {
      "login": "caybro",
      "id": 5377645,
      "node_id": "MDQ6VXNlcjUzNzc2NDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5377645?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/caybro",
      "html_url": "https://github.com/caybro",
      "followers_url": "https://api.github.com/users/caybro/followers",
      "following_url": "https://api.github.com/users/caybro/following{/other_user}",
      "gists_url": "https://api.github.com/users/caybro/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/caybro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/caybro/subscriptions",
      "organizations_url": "https://api.github.com/users/caybro/orgs",
      "repos_url": "https://api.github.com/users/caybro/repos",
      "events_url": "https://api.github.com/users/caybro/events{/privacy}",
      "received_events_url": "https://api.github.com/users/caybro/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-24T19:47:33Z",
    "updated_at": "2022-11-24T19:47:33Z",
    "author_association": "MEMBER",
    "body": "cc @PascalPrecht too since he's working on adding support for pasting images there",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1326800129/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1327146133",
    "html_url": "https://github.com/status-im/status-desktop/issues/7686#issuecomment-1327146133",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/7686",
    "id": 1327146133,
    "node_id": "IC_kwDOD5KrTM5PGqSV",
    "user": {
      "login": "alexjba",
      "id": 47811206,
      "node_id": "MDQ6VXNlcjQ3ODExMjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/47811206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexjba",
      "html_url": "https://github.com/alexjba",
      "followers_url": "https://api.github.com/users/alexjba/followers",
      "following_url": "https://api.github.com/users/alexjba/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexjba/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexjba/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexjba/subscriptions",
      "organizations_url": "https://api.github.com/users/alexjba/orgs",
      "repos_url": "https://api.github.com/users/alexjba/repos",
      "events_url": "https://api.github.com/users/alexjba/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexjba/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-25T08:20:43Z",
    "updated_at": "2022-11-25T08:20:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'll just add here the issues I find along the way so that we can have an overview of what needs to be fixed\r\n\r\n#### Functional issue\r\n9. Type a text like this: Just give me the http :D -> :D is not converted to emoji\r\nRoot cause: TextArea onTextChanged looks for http at [cursorPosition -7, cursorPosition] . If it contains http the emoji conversion will not happen. The assumption is that the word before cursor is http:/ or https:/",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1327146133/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1327205548",
    "html_url": "https://github.com/status-im/status-desktop/issues/7686#issuecomment-1327205548",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/7686",
    "id": 1327205548,
    "node_id": "IC_kwDOD5KrTM5PG4ys",
    "user": {
      "login": "noeliaSD",
      "id": 97019400,
      "node_id": "U_kgDOBchmCA",
      "avatar_url": "https://avatars.githubusercontent.com/u/97019400?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/noeliaSD",
      "html_url": "https://github.com/noeliaSD",
      "followers_url": "https://api.github.com/users/noeliaSD/followers",
      "following_url": "https://api.github.com/users/noeliaSD/following{/other_user}",
      "gists_url": "https://api.github.com/users/noeliaSD/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/noeliaSD/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/noeliaSD/subscriptions",
      "organizations_url": "https://api.github.com/users/noeliaSD/orgs",
      "repos_url": "https://api.github.com/users/noeliaSD/repos",
      "events_url": "https://api.github.com/users/noeliaSD/events{/privacy}",
      "received_events_url": "https://api.github.com/users/noeliaSD/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-25T09:27:08Z",
    "updated_at": "2022-11-25T09:27:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "We've already discussed in some point the idea of refactoring this component since it is complex and we are having bugs with it, I'd say, bc of this complexity. So, for me, it is a good idea to go for the refactor and try to split it in basic an easier components. \r\n\r\nI appreciate your detailed analysis and idea. :)\r\n\r\nSo, if we have the time to do it, better now than in some months. For me it is a yes, but @iurimatias knows the priorities! ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1327205548/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1327206580",
    "html_url": "https://github.com/status-im/status-desktop/issues/7686#issuecomment-1327206580",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/7686",
    "id": 1327206580,
    "node_id": "IC_kwDOD5KrTM5PG5C0",
    "user": {
      "login": "0x-r4bbit",
      "id": 445106,
      "node_id": "MDQ6VXNlcjQ0NTEwNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/445106?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/0x-r4bbit",
      "html_url": "https://github.com/0x-r4bbit",
      "followers_url": "https://api.github.com/users/0x-r4bbit/followers",
      "following_url": "https://api.github.com/users/0x-r4bbit/following{/other_user}",
      "gists_url": "https://api.github.com/users/0x-r4bbit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/0x-r4bbit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0x-r4bbit/subscriptions",
      "organizations_url": "https://api.github.com/users/0x-r4bbit/orgs",
      "repos_url": "https://api.github.com/users/0x-r4bbit/repos",
      "events_url": "https://api.github.com/users/0x-r4bbit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/0x-r4bbit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-25T09:28:16Z",
    "updated_at": "2022-11-25T09:28:16Z",
    "author_association": "MEMBER",
    "body": "I'd also like to see a workforce tackling StatusChatInput properly once and for all",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1327206580/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1327717162",
    "html_url": "https://github.com/status-im/status-desktop/issues/7686#issuecomment-1327717162",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/7686",
    "id": 1327717162,
    "node_id": "IC_kwDOD5KrTM5PI1sq",
    "user": {
      "login": "micieslak",
      "id": 20650004,
      "node_id": "MDQ6VXNlcjIwNjUwMDA0",
      "avatar_url": "https://avatars.githubusercontent.com/u/20650004?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/micieslak",
      "html_url": "https://github.com/micieslak",
      "followers_url": "https://api.github.com/users/micieslak/followers",
      "following_url": "https://api.github.com/users/micieslak/following{/other_user}",
      "gists_url": "https://api.github.com/users/micieslak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/micieslak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/micieslak/subscriptions",
      "organizations_url": "https://api.github.com/users/micieslak/orgs",
      "repos_url": "https://api.github.com/users/micieslak/repos",
      "events_url": "https://api.github.com/users/micieslak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/micieslak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-25T17:00:25Z",
    "updated_at": "2022-11-25T17:00:25Z",
    "author_association": "MEMBER",
    "body": "Thanks @alexjba for that analysis. It's definitely helpful. But before doing refactor here imo we should think about changing the approach. Because consecutive refactors in current form proved to be ineffective bc of many regressions. Therefore I would suggest setting up qml unit tests for that (for the whole project in general, storybook config is a good starting point for that probably) and try to do more test-driven development here. Of course decomposing into smaller parts is needed as all, defining interfaces of those components etc. But there are so many corner cases that without decent covering with automatic tests we are ineffective with development and bugfixing of that part of our app. Also using storybook for development could be useful.\r\nWhile having tests we could start fixing bug from adding test covering that bug. And later fix that bug without risk of breaking functionality which is already covered. I know, it's obvious but at this stage of the project we definitely should start testing stuff.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1327717162/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1328038407",
    "html_url": "https://github.com/status-im/status-desktop/issues/7686#issuecomment-1328038407",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/7686",
    "id": 1328038407,
    "node_id": "IC_kwDOD5KrTM5PKEIH",
    "user": {
      "login": "alexjba",
      "id": 47811206,
      "node_id": "MDQ6VXNlcjQ3ODExMjA2",
      "avatar_url": "https://avatars.githubusercontent.com/u/47811206?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexjba",
      "html_url": "https://github.com/alexjba",
      "followers_url": "https://api.github.com/users/alexjba/followers",
      "following_url": "https://api.github.com/users/alexjba/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexjba/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexjba/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexjba/subscriptions",
      "organizations_url": "https://api.github.com/users/alexjba/orgs",
      "repos_url": "https://api.github.com/users/alexjba/repos",
      "events_url": "https://api.github.com/users/alexjba/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexjba/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-26T12:32:37Z",
    "updated_at": "2022-11-26T12:32:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "Good point @micieslak. Having decent test coverage would help a lot with the refactoring. My proposal here is to break it into several steps:\r\n1. Add tests for currently working functionality\r\n2. Fix all the issues and add tests for each fix\r\n3. Once we have a decent test coverage we can start refactoring\r\n\r\nStep 1 and 2 are interchangeable or can even be developed in parallel. But since all the issues here don't look critical (imo) for dogfooding I guess we can start by adding tests for the working functionality to lower the regression risk on the next step.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1328038407/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
