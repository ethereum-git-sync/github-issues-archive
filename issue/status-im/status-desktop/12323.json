{
  "url": "https://api.github.com/repos/status-im/status-desktop/issues/12323",
  "repository_url": "https://api.github.com/repos/status-im/status-desktop",
  "labels_url": "https://api.github.com/repos/status-im/status-desktop/issues/12323/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-desktop/issues/12323/comments",
  "events_url": "https://api.github.com/repos/status-im/status-desktop/issues/12323/events",
  "html_url": "https://github.com/status-im/status-desktop/issues/12323",
  "id": 1923476881,
  "node_id": "I_kwDOD5KrTM5ype2R",
  "number": 12323,
  "title": "[Edit message] Crash when sending an edited message where the link preview was removed",
  "user": {
    "login": "alexjba",
    "id": 47811206,
    "node_id": "MDQ6VXNlcjQ3ODExMjA2",
    "avatar_url": "https://avatars.githubusercontent.com/u/47811206?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alexjba",
    "html_url": "https://github.com/alexjba",
    "followers_url": "https://api.github.com/users/alexjba/followers",
    "following_url": "https://api.github.com/users/alexjba/following{/other_user}",
    "gists_url": "https://api.github.com/users/alexjba/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alexjba/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alexjba/subscriptions",
    "organizations_url": "https://api.github.com/users/alexjba/orgs",
    "repos_url": "https://api.github.com/users/alexjba/repos",
    "events_url": "https://api.github.com/users/alexjba/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alexjba/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2036563458,
      "node_id": "MDU6TGFiZWwyMDM2NTYzNDU4",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    },
    {
      "id": 3047396259,
      "node_id": "MDU6TGFiZWwzMDQ3Mzk2MjU5",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/crash",
      "name": "crash",
      "color": "B60205",
      "default": false,
      "description": ""
    },
    {
      "id": 4548141040,
      "node_id": "LA_kwDOD5KrTM8AAAABDxcf8A",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/messenger-team",
      "name": "messenger-team",
      "color": "232858",
      "default": false,
      "description": ""
    },
    {
      "id": 5732778973,
      "node_id": "LA_kwDOD5KrTM8AAAABVbND3Q",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/E:Desktop%20New%20Unfurling%20API",
      "name": "E:Desktop New Unfurling API",
      "color": "BDF0DE",
      "default": false,
      "description": "Implementation of the new unfurling API for all links"
    },
    {
      "id": 6014763800,
      "node_id": "LA_kwDOD5KrTM8AAAABZoIDGA",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/E:Desktop%20Misc%20Bugfixes",
      "name": "E:Desktop Misc Bugfixes",
      "color": "61D0D9",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "kounkou",
    "id": 2589171,
    "node_id": "MDQ6VXNlcjI1ODkxNzE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2589171?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kounkou",
    "html_url": "https://github.com/kounkou",
    "followers_url": "https://api.github.com/users/kounkou/followers",
    "following_url": "https://api.github.com/users/kounkou/following{/other_user}",
    "gists_url": "https://api.github.com/users/kounkou/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kounkou/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kounkou/subscriptions",
    "organizations_url": "https://api.github.com/users/kounkou/orgs",
    "repos_url": "https://api.github.com/users/kounkou/repos",
    "events_url": "https://api.github.com/users/kounkou/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kounkou/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "kounkou",
      "id": 2589171,
      "node_id": "MDQ6VXNlcjI1ODkxNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2589171?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kounkou",
      "html_url": "https://github.com/kounkou",
      "followers_url": "https://api.github.com/users/kounkou/followers",
      "following_url": "https://api.github.com/users/kounkou/following{/other_user}",
      "gists_url": "https://api.github.com/users/kounkou/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kounkou/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kounkou/subscriptions",
      "organizations_url": "https://api.github.com/users/kounkou/orgs",
      "repos_url": "https://api.github.com/users/kounkou/repos",
      "events_url": "https://api.github.com/users/kounkou/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kounkou/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": {
    "url": "https://api.github.com/repos/status-im/status-desktop/milestones/61",
    "html_url": "https://github.com/status-im/status-desktop/milestone/61",
    "labels_url": "https://api.github.com/repos/status-im/status-desktop/milestones/61/labels",
    "id": 8739485,
    "node_id": "MI_kwDOD5KrTM4AhVqd",
    "number": 61,
    "title": "0.16",
    "description": "**1.  Fix bug and stabilise Communities and Messaging functionality**\r\n\r\n**2.  Reduce size of community description metadata**\r\n- better compressions, less duplication\r\n\r\n**3. Use data sync layer (or other mechanism) to improve community description reliability**\r\n- Every time a new user joins the community, the Control Node updates and signs the description.\r\n- Random back off to stop it being too chatty \r\n\r\n**4. Continue work on profile showcase **\r\n\r\n\r\n\r\n**--- Wallet Team ---**\r\n\r\n1. Complete support for Community minted assets\r\n\r\n2. Complete token visibility management screens\r\n\r\n3. Continue working on WalletConnect support\r\n\r\n4. Minor updates to Asset screens\r\n\r\n5. Continue fixing bugs, making optimisations and keeping tech debt low\r\n\r\n\r\n\r\n\r\n",
    "creator": {
      "login": "iurimatias",
      "id": 176720,
      "node_id": "MDQ6VXNlcjE3NjcyMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176720?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iurimatias",
      "html_url": "https://github.com/iurimatias",
      "followers_url": "https://api.github.com/users/iurimatias/followers",
      "following_url": "https://api.github.com/users/iurimatias/following{/other_user}",
      "gists_url": "https://api.github.com/users/iurimatias/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iurimatias/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iurimatias/subscriptions",
      "organizations_url": "https://api.github.com/users/iurimatias/orgs",
      "repos_url": "https://api.github.com/users/iurimatias/repos",
      "events_url": "https://api.github.com/users/iurimatias/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iurimatias/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 168,
    "closed_issues": 123,
    "state": "open",
    "created_at": "2022-12-09T15:06:43Z",
    "updated_at": "2023-12-21T00:31:41Z",
    "due_on": "2024-01-31T08:00:00Z",
    "closed_at": null
  },
  "comments": 2,
  "created_at": "2023-10-03T07:17:29Z",
  "updated_at": "2023-12-21T00:31:41Z",
  "closed_at": "2023-12-21T00:31:40Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "# Bug Report\r\n\r\n## Description\r\n\r\nThe app is crashing after sending an edited message where a link preview was removed.\r\nIt seems the crash happens in `status-go`\r\nNOTE: The receiver will also crash when receiving the edited message\r\n<!-- Provide a short description describing the problem you are experiencing. -->\r\n\r\n## Steps to reproduce\r\n1. Send a message containing one link preview\r\n2. Go to message history and click edit on the previously sent message\r\n3. Replace the url with any text\r\n4. Hit Enter to send the message\r\n<!-- example: step 1. do X step 2. do Y etc.. -->\r\n\r\n#### Expected behavior\r\nMessage is edited and sent, no crash\r\n#### Actual behavior\r\nMessage is edited and sent, app crashes\r\n### Additional Information\r\n\r\n- Status desktop version: Tested on 0.14RC12 and master https://github.com/status-im/status-desktop/commit/2d4e20585\r\n- Operating System: MacOS\r\n\r\n",
  "closed_by": {
    "login": "kounkou",
    "id": 2589171,
    "node_id": "MDQ6VXNlcjI1ODkxNzE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2589171?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kounkou",
    "html_url": "https://github.com/kounkou",
    "followers_url": "https://api.github.com/users/kounkou/followers",
    "following_url": "https://api.github.com/users/kounkou/following{/other_user}",
    "gists_url": "https://api.github.com/users/kounkou/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kounkou/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kounkou/subscriptions",
    "organizations_url": "https://api.github.com/users/kounkou/orgs",
    "repos_url": "https://api.github.com/users/kounkou/repos",
    "events_url": "https://api.github.com/users/kounkou/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kounkou/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/12323/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-desktop/issues/12323/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1834281983",
    "html_url": "https://github.com/status-im/status-desktop/issues/12323#issuecomment-1834281983",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/12323",
    "id": 1834281983,
    "node_id": "IC_kwDOD5KrTM5tVOv_",
    "user": {
      "login": "kounkou",
      "id": 2589171,
      "node_id": "MDQ6VXNlcjI1ODkxNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2589171?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kounkou",
      "html_url": "https://github.com/kounkou",
      "followers_url": "https://api.github.com/users/kounkou/followers",
      "following_url": "https://api.github.com/users/kounkou/following{/other_user}",
      "gists_url": "https://api.github.com/users/kounkou/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kounkou/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kounkou/subscriptions",
      "organizations_url": "https://api.github.com/users/kounkou/orgs",
      "repos_url": "https://api.github.com/users/kounkou/repos",
      "events_url": "https://api.github.com/users/kounkou/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kounkou/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-11-30T17:57:01Z",
    "updated_at": "2023-11-30T21:44:31Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi there,\r\nCurrently I am just trying to reproduce, as I didn't get any chance on Linux with Ubuntu 22.04.3 LTS yet \r\n\r\nEdit 1 :\r\nI do have a MacBook pro 2017, I'll try to reproduce the problem there to see if the platform plays a role as the submitter of the problem tested on MacOs\r\n\r\nEdit 2 :\r\nAfter testing with MacOs, I also couldn't reproduce the issue. To assess that I am seeing the problem I'll try to reproduce the problem on 0.14RC12. Then I'll come back to reproducing the same steps on the recent versions of the app\r\n\r\nEdit 3 : \r\nAfter confirming that the platform doesn't play a specific role in reproducing the issue, I am back on Linux to continue testing.\r\nI managed to reproduce the issue with the following setup : \r\n\r\n```\r\n$ git branch\r\n\r\n* (HEAD detached at b5723db3c)\r\n  master\r\n```\r\n\r\nThen I compiled the application as usual\r\n\r\n```\r\n$ make run\r\n```\r\n\r\nOnce the application launched, I followed the same steps provided in the issue submitter description. by sending a message that contains a link preview, then I edited the message changing the text to `test`. As a result, the application **crashed** as stated in the ticket. I could reproduce the issue consistently \r\n\r\nTerminal logs\r\n\r\n```\r\nDBG 2023-11-30 13:34:45.745-08:00 NewBE_callPrivateRPC                       topics=\"rpc\" tid=439703 file=core.nim:27 rpc_method=wakuext_markAllRead\r\nDBG 2023-11-30 13:34:45.745-08:00 NewBE_callPrivateRPC                       topics=\"rpc\" tid=439700 file=core.nim:27 rpc_method=wakuext_markAllRead\r\nDBG 2023-11-30 13:34:45.980-08:00 NewBE_callPrivateRPC                       topics=\"rpc\" tid=439673 file=core.nim:27 rpc_method=wakuext_getTextURLs\r\nDBG 2023-11-30 13:34:54.019-08:00 NewBE_callPrivateRPC                       topics=\"rpc\" tid=439673 file=core.nim:27 rpc_method=wakuext_speedupArchivesImport\r\nDBG 2023-11-30 13:35:00.575-08:00 NewBE_callPrivateRPC                       topics=\"rpc\" tid=439673 file=core.nim:27 rpc_method=wakuext_slowdownArchivesImport\r\nDBG 2023-11-30 13:35:01.213-08:00 NewBE_callPrivateRPC                       topics=\"rpc\" tid=439673 file=core.nim:27 rpc_method=wakuext_getTextURLs\r\nDBG 2023-11-30 13:35:01.213-08:00 [threadpool task thread] initiating task   topics=\"task-threadpool\" tid=439702 file=threadpool.nim:54 messageType=AsyncUnfurlUrlsTaskArg:ObjectType threadid=439702 task=\"{\\\"$type\\\":\\\"AsyncUnfurlUrlsTaskArg:ObjectType\\\",\\\"urls\\\":[\\\"https://downdetector.ca/status/github\\\"],\\\"vptr\\\":94254812251360,\\\"slot\\\":\\\"onAsyncUnfurlUrlsFinished\\\",\\\"tptr\\\":94254772863488}\"\r\nDBG 2023-11-30 13:35:01.214-08:00 NewBE_callPrivateRPC                       topics=\"rpc\" tid=439702 file=core.nim:27 rpc_method=wakuext_unfurlURLs\r\nDBG 2023-11-30 13:35:07.529-08:00 NewBE_callPrivateRPC                       topics=\"rpc\" tid=439673 file=core.nim:27 rpc_method=wakuext_getTextURLs\r\nDBG 2023-11-30 13:35:07.530-08:00 NewBE_callPrivateRPC                       topics=\"rpc\" tid=439673 file=core.nim:27 rpc_method=wakuext_sendChatMessage\r\nERR 2023-11-30 13:35:07.539-08:00 requested community doesn't exist          topics=\"community-service\" tid=439673 file=service.nim:742 communityId=0x04eeb4914b7eb91000de56f00fcb78845d461d0cacd84ba6cb2ba1c149665326fafcfb4c00cb7fa88c3c95b245eaaf8ae1a98bb89c67d98ef46a1c70c7bb4c131e\r\nDebug: <<<https://downdetector.ca/status/github/-> (qrc:/imports/shared/views/chat/MessageView.qml:76, expression for localUnfurlLinks)\r\nINF 2023-11-30 13:35:07.554-08:00 history request started                    topics=\"mailservers-service\" tid=439673 file=service.nim:178 numBatches=1\r\nDBG 2023-11-30 13:35:07.767-08:00 NewBE_callPrivateRPC                       topics=\"rpc\" tid=439673 file=core.nim:27 rpc_method=wakuext_getTextURLs\r\nINF 2023-11-30 13:35:08.335-08:00 history request completed                  topics=\"mailservers-service\" tid=439673 file=service.nim:183\r\nWarning: qrc:/imports/shared/status/StatusChatInput.qml:1042:9: QML Rectangle: Binding loop detected for property \"implicitHeight\" (qrc:/imports/shared/status/StatusChatInput.qml:1042, )\r\nDBG 2023-11-30 13:35:17.784-08:00 NewBE_callPrivateRPC                       topics=\"rpc\" tid=439673 file=core.nim:27 rpc_method=wakuext_editMessage\r\nERR 2023-11-30 13:35:17.790-08:00 requested community doesn't exist          topics=\"community-service\" tid=439673 file=service.nim:742 communityId=0x04eeb4914b7eb91000de56f00fcb78845d461d0cacd84ba6cb2ba1c149665326fafcfb4c00cb7fa88c3c95b245eaaf8ae1a98bb89c67d98ef46a1c70c7bb4c131e\r\nDBG 2023-11-30 13:35:17.791-08:00 [threadpool task thread] initiating task   topics=\"task-threadpool\" tid=439698 file=threadpool.nim:54 messageType=AsyncGetLinkPreviewDataTaskArg:ObjectType threadid=439698 task=\"{\\\"$type\\\":\\\"AsyncGetLinkPreviewDataTaskArg:ObjectType\\\",\\\"links\\\":\\\"\\\",\\\"uuid\\\":\\\"lplpskr7mj612\\\",\\\"whiteListedUrls\\\":\\\"{\\\\\\\"status-app://\\\\\\\":true,\\\\\\\"status.app\\\\\\\":true,\\\\\\\"our.status.im\\\\\\\":false,\\\\\\\"youtube.com\\\\\\\":false,\\\\\\\"www.youtube.com\\\\\\\":false,\\\\\\\"youtu.be\\\\\\\":false,\\\\\\\"m.youtube.com\\\\\\\":false,\\\\\\\"twitter.com\\\\\\\":false,\\\\\\\"mobile.twitter.com\\\\\\\":false,\\\\\\\"gph.is\\\\\\\":false,\\\\\\\"giphy.com\\\\\\\":false,\\\\\\\"media.giphy.com\\\\\\\":false,\\\\\\\"github.com\\\\\\\":false,\\\\\\\"media.tenor.com\\\\\\\":false}\\\",\\\"whiteListedImgExtensions\\\":\\\".png,.jpg,.jpeg,.svg,.gif\\\",\\\"unfurlImages\\\":false,\\\"vptr\\\":94254812251360,\\\"slot\\\":\\\"onAsyncGetLinkPreviewData\\\",\\\"tptr\\\":94254772914624}\"\r\nINF 2023-11-30 13:35:17.799-08:00 shutting down...                           topics=\"status-app\" tid=439673 file=nim_status_client.nim:165\r\nINF 2023-11-30 13:35:17.799-08:00 logging out...                             topics=\"app-controller\" tid=439673 file=app_controller.nim:287\r\nTraceback (most recent call last)\r\n/tmp/status-desktop/src/nim_status_client.nim(200) nim_status_client\r\n/tmp/status-desktop/src/nim_status_client.nim(173) mainProc\r\n/tmp/status-desktop/src/app/boot/app_controller.nim(328) delete\r\n/tmp/status-desktop/src/app_service/service/message/service.nim(159) delete\r\n/tmp/status-desktop/vendor/nimqml/src/nimqml/private/qobject.nim(67) delete\r\nSIGSEGV: Illegal storage access. (Attempt to read from nil?)\r\nmake: *** [Makefile:822: run-linux] Segmentation fault (core dumped)\r\n``` \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1834281983/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1834613634",
    "html_url": "https://github.com/status-im/status-desktop/issues/12323#issuecomment-1834613634",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/12323",
    "id": 1834613634,
    "node_id": "IC_kwDOD5KrTM5tWfuC",
    "user": {
      "login": "kounkou",
      "id": 2589171,
      "node_id": "MDQ6VXNlcjI1ODkxNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2589171?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kounkou",
      "html_url": "https://github.com/kounkou",
      "followers_url": "https://api.github.com/users/kounkou/followers",
      "following_url": "https://api.github.com/users/kounkou/following{/other_user}",
      "gists_url": "https://api.github.com/users/kounkou/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kounkou/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kounkou/subscriptions",
      "organizations_url": "https://api.github.com/users/kounkou/orgs",
      "repos_url": "https://api.github.com/users/kounkou/repos",
      "events_url": "https://api.github.com/users/kounkou/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kounkou/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-11-30T21:46:13Z",
    "updated_at": "2023-11-30T21:46:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "As a conclusion to above analysis, we can conclude that the bug cannot not be reproduced on later version. And will therefore move the ticket accordingly if no more comments.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1834613634/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
