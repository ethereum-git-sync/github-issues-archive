{
  "url": "https://api.github.com/repos/status-im/status-desktop/issues/8622",
  "repository_url": "https://api.github.com/repos/status-im/status-desktop",
  "labels_url": "https://api.github.com/repos/status-im/status-desktop/issues/8622/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-desktop/issues/8622/comments",
  "events_url": "https://api.github.com/repos/status-im/status-desktop/issues/8622/events",
  "html_url": "https://github.com/status-im/status-desktop/issues/8622",
  "id": 1476395651,
  "node_id": "I_kwDOD5KrTM5YAAKD",
  "number": 8622,
  "title": "Keycard not recognized on Linux",
  "user": {
    "login": "fryorcraken",
    "id": 110212804,
    "node_id": "U_kgDOBpG2xA",
    "avatar_url": "https://avatars.githubusercontent.com/u/110212804?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fryorcraken",
    "html_url": "https://github.com/fryorcraken",
    "followers_url": "https://api.github.com/users/fryorcraken/followers",
    "following_url": "https://api.github.com/users/fryorcraken/following{/other_user}",
    "gists_url": "https://api.github.com/users/fryorcraken/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fryorcraken/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fryorcraken/subscriptions",
    "organizations_url": "https://api.github.com/users/fryorcraken/orgs",
    "repos_url": "https://api.github.com/users/fryorcraken/repos",
    "events_url": "https://api.github.com/users/fryorcraken/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fryorcraken/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2036563458,
      "node_id": "MDU6TGFiZWwyMDM2NTYzNDU4",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    },
    {
      "id": 3419670072,
      "node_id": "LA_kwDOD5KrTM7L1AY4",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/Keycard",
      "name": "Keycard",
      "color": "5319e7",
      "default": false,
      "description": ""
    },
    {
      "id": 4248529892,
      "node_id": "LA_kwDOD5KrTM79O2vk",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/E:Keycard",
      "name": "E:Keycard",
      "color": "02A88E",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [
    {
      "login": "bitgamma",
      "id": 12899729,
      "node_id": "MDQ6VXNlcjEyODk5NzI5",
      "avatar_url": "https://avatars.githubusercontent.com/u/12899729?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bitgamma",
      "html_url": "https://github.com/bitgamma",
      "followers_url": "https://api.github.com/users/bitgamma/followers",
      "following_url": "https://api.github.com/users/bitgamma/following{/other_user}",
      "gists_url": "https://api.github.com/users/bitgamma/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bitgamma/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bitgamma/subscriptions",
      "organizations_url": "https://api.github.com/users/bitgamma/orgs",
      "repos_url": "https://api.github.com/users/bitgamma/repos",
      "events_url": "https://api.github.com/users/bitgamma/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bitgamma/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-12-05T12:01:52Z",
  "updated_at": "2023-02-13T09:29:46Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "# Bug Report\r\n\r\n## Description\r\n\r\nWhen using keycard flow to login, the app remains on \"plugin keycard player\" screen.\r\n\r\n## Steps to reproduce\r\n\r\n- Start App fresh\r\n- Select \"I have a Status account\"\r\n- Select \"keycard\"\r\n- Screen display \"plug keycard reader\"\r\n- Plug in ACS keycard reader -> nothing happens\r\n- Insert keycard in reader -> nothing happens\r\n\r\n#### Expected behavior\r\n\r\nKeycard reader is recognized and keys imported from reader\r\n\r\n#### Actual behavior\r\n\r\nStuck to \"plug keycard reader\" screen\r\n\r\n### Additional Information\r\n\r\n- Status desktop version: 0.8.0\r\n- Operating System:Fedora Linux\r\n\r\nLog\r\n```\r\nDBG 2022-12-05 16:13:45.410+11:00 on_keycard_response                        topics=\"app-controller\" tid=2079020 file=module.nim:307 currFlow=FirstRunOldUserKeycardImport currState=KeycardPluginReader\r\n```\r\n\r\nI created an udev file (Fedora)\r\n\r\n```\r\n/etc/udev/rules.d                                                                                                                    \r\n▶ cat 21-keycard.rules \r\n# ACS Key card reader\r\nSUBSYSTEMS==\"usb\", ATTRS{idVendor}==\"072f\", ATTRS{idProduct}==\"b100\", TAG+=\"uaccess\", TAG+=\"udev-acl\"\r\n```\r\n```\r\nsudo udevadm control --reload-rules\r\nsudo udevadm trigger     \r\n```\r\n\r\nDidn't help\r\n\r\ndmesg:\r\n```\r\n[1307221.217794] usb 1-5: new full-speed USB device number 7 using xhci_hcd\r\n[1307221.347347] usb 1-5: New USB device found, idVendor=072f, idProduct=b100, bcdDevice=30.09\r\n[1307221.347351] usb 1-5: New USB device strings: Mfr=1, Product=2, SerialNumber=0\r\n[1307221.347352] usb 1-5: Product: ACR39U ICC Reader\r\n[1307221.347353] usb 1-5: Manufacturer: ACS\r\n[1307237.493258] usb 1-5: USB disconnect, device number 7\r\n[1307243.992789] usb 1-5: new full-speed USB device number 8 using xhci_hcd\r\n[1307244.122960] usb 1-5: New USB device found, idVendor=072f, idProduct=b100, bcdDevice=30.09\r\n[1307244.122964] usb 1-5: New USB device strings: Mfr=1, Product=2, SerialNumber=0\r\n[1307244.122965] usb 1-5: Product: ACR39U ICC Reader\r\n[1307244.122966] usb 1-5: Manufacturer: ACS\r\n[1307409.391242] usb 1-5: USB disconnect, device number 8\r\n[1307415.873702] usb 1-5: new full-speed USB device number 9 using xhci_hcd\r\n[1307416.002753] usb 1-5: New USB device found, idVendor=072f, idProduct=b100, bcdDevice=30.09\r\n[1307416.002758] usb 1-5: New USB device strings: Mfr=1, Product=2, SerialNumber=0\r\n[1307416.002759] usb 1-5: Product: ACR39U ICC Reader\r\n[1307416.002761] usb 1-5: Manufacturer: ACS\r\n[1307565.796149] usb 1-5: USB disconnect, device number 9\r\n[1307571.365684] usb 1-5: new full-speed USB device number 10 using xhci_hcd\r\n[1307571.494963] usb 1-5: New USB device found, idVendor=072f, idProduct=b100, bcdDevice=30.09\r\n[1307571.494967] usb 1-5: New USB device strings: Mfr=1, Product=2, SerialNumber=0\r\n[1307571.494968] usb 1-5: Product: ACR39U ICC Reader\r\n[1307571.494969] usb 1-5: Manufacturer: ACS\r\n```\r\n\r\nAlso, I have a pcscd running (was already running afaik)\r\n\r\n```\r\n▶ pgrep -a pcscd   \r\n2086258 /usr/sbin/pcscd --foreground --auto-exit\r\n```",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/8622/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-desktop/issues/8622/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1338376045",
    "html_url": "https://github.com/status-im/status-desktop/issues/8622#issuecomment-1338376045",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/8622",
    "id": 1338376045,
    "node_id": "IC_kwDOD5KrTM5Pxf9t",
    "user": {
      "login": "fryorcraken",
      "id": 110212804,
      "node_id": "U_kgDOBpG2xA",
      "avatar_url": "https://avatars.githubusercontent.com/u/110212804?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fryorcraken",
      "html_url": "https://github.com/fryorcraken",
      "followers_url": "https://api.github.com/users/fryorcraken/followers",
      "following_url": "https://api.github.com/users/fryorcraken/following{/other_user}",
      "gists_url": "https://api.github.com/users/fryorcraken/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fryorcraken/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fryorcraken/subscriptions",
      "organizations_url": "https://api.github.com/users/fryorcraken/orgs",
      "repos_url": "https://api.github.com/users/fryorcraken/repos",
      "events_url": "https://api.github.com/users/fryorcraken/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fryorcraken/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-05T23:49:34Z",
    "updated_at": "2022-12-05T23:49:34Z",
    "author_association": "NONE",
    "body": "I installed `pcsc-tools` and can confirm the reader is recognized:\r\n\r\n```\r\n▶ /usr/bin/pcsc_scan\r\nUsing reader plug'n play mechanism\r\nScanning present readers...\r\n0: ACS ACR39U ICC Reader 00 00\r\n \r\nTue Dec  6 10:46:25 2022\r\n Reader 0: ACS ACR39U ICC Reader 00 00\r\n  Event number: 4\r\n  **Card state: Card inserted,** \r\n  ATR: 3B D5 18 FF 81 91 FE 1F C3 80 73 C8 21 10 0A\r\n\r\nATR: 3B D5 18 FF 81 91 FE 1F C3 80 73 C8 21 10 0A\r\n+ TS = 3B --> Direct Convention\r\n+ T0 = D5, Y(1): 1101, K: 5 (historical bytes)\r\n  TA(1) = 18 --> Fi=372, Di=12, 31 cycles/ETU\r\n    129032 bits/s at 4 MHz, fMax for Fi = 5 MHz => 161290 bits/s\r\n  TC(1) = FF --> Extra guard time: 255 (special value)\r\n  TD(1) = 81 --> Y(i+1) = 1000, Protocol T = 1 \r\n-----\r\n  TD(2) = 91 --> Y(i+1) = 1001, Protocol T = 1 \r\n-----\r\n  TA(3) = FE --> IFSC: 254\r\n  TD(3) = 1F --> Y(i+1) = 0001, Protocol T = 15 - Global interface bytes following \r\n-----\r\n  TA(4) = C3 --> Clock stop: no preference - Class accepted by the card: (3G) A 5V B 3V \r\n+ Historical bytes: 80 73 C8 21 10\r\n  Category indicator byte: 80 (compact TLV data object)\r\n    Tag: 7, len: 3 (card capabilities)\r\n      Selection methods: C8\r\n        - DF selection by full DF name\r\n        - DF selection by partial DF name\r\n        - Implicit DF selection\r\n      Data coding byte: 21\r\n        - Behaviour of write functions: proprietary\r\n        - Value 'FF' for the first byte of BER-TLV tag fields: invalid\r\n        - Data unit in quartets: 2\r\n      Command chaining, length fields and logical channels: 10\r\n        - Logical channel number assignment: by the card\r\n        - Maximum number of logical channels: 1\r\n+ TCK = 0A (correct checksum)\r\n\r\nPossibly identified card (using /usr/share/pcsc/smartcard_list.txt):\r\n3B D5 18 FF 81 91 FE 1F C3 80 73 C8 21 10 0A\r\n\tComSign digital signature card (eID)\r\n\thttps://www.comsign.co.uk/\r\n\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1338376045/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1338379158",
    "html_url": "https://github.com/status-im/status-desktop/issues/8622#issuecomment-1338379158",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/8622",
    "id": 1338379158,
    "node_id": "IC_kwDOD5KrTM5PxguW",
    "user": {
      "login": "fryorcraken",
      "id": 110212804,
      "node_id": "U_kgDOBpG2xA",
      "avatar_url": "https://avatars.githubusercontent.com/u/110212804?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fryorcraken",
      "html_url": "https://github.com/fryorcraken",
      "followers_url": "https://api.github.com/users/fryorcraken/followers",
      "following_url": "https://api.github.com/users/fryorcraken/following{/other_user}",
      "gists_url": "https://api.github.com/users/fryorcraken/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fryorcraken/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fryorcraken/subscriptions",
      "organizations_url": "https://api.github.com/users/fryorcraken/orgs",
      "repos_url": "https://api.github.com/users/fryorcraken/repos",
      "events_url": "https://api.github.com/users/fryorcraken/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fryorcraken/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-05T23:53:40Z",
    "updated_at": "2022-12-05T23:53:40Z",
    "author_association": "NONE",
    "body": "Some logs from the `pcscd` service:\r\n\r\n```\r\nDec 06 10:52:18 xps-franck pcscd[2303558]: 11313948 winscard_svc.c:382:ContextThread() Communication protocol mismatch!\r\nDec 06 10:52:18 xps-franck pcscd[2303558]: 00000058 winscard_svc.c:384:ContextThread() Client protocol is 4:3\r\nDec 06 10:52:18 xps-franck pcscd[2303558]: 00000002 winscard_svc.c:386:ContextThread() Server protocol is 4:4\r\nDec 06 10:52:21 xps-franck pcscd[2303558]: 03007324 winscard_svc.c:382:ContextThread() Communication protocol mismatch!\r\nDec 06 10:52:21 xps-franck pcscd[2303558]: 00000007 winscard_svc.c:384:ContextThread() Client protocol is 4:3\r\nDec 06 10:52:21 xps-franck pcscd[2303558]: 00000002 winscard_svc.c:386:ContextThread() Server protocol is 4:4\r\nDec 06 10:52:24 xps-franck pcscd[2303558]: 03010607 winscard_svc.c:382:ContextThread() Communication protocol mismatch!\r\nDec 06 10:52:24 xps-franck pcscd[2303558]: 00000005 winscard_svc.c:384:ContextThread() Client protocol is 4:3\r\nDec 06 10:52:24 xps-franck pcscd[2303558]: 00000001 winscard_svc.c:386:ContextThread() Server protocol is 4:4\r\nDec 06 10:52:27 xps-franck pcscd[2303558]: 03011302 winscard_svc.c:382:ContextThread() Communication protocol mismatch!\r\nDec 06 10:52:27 xps-franck pcscd[2303558]: 00000008 winscard_svc.c:384:ContextThread() Client protocol is 4:3\r\nDec 06 10:52:27 xps-franck pcscd[2303558]: 00000002 winscard_svc.c:386:ContextThread() Server protocol is 4:4\r\nDec 06 10:52:30 xps-franck pcscd[2303558]: 03012763 winscard_svc.c:382:ContextThread() Communication protocol mismatch!\r\nDec 06 10:52:30 xps-franck pcscd[2303558]: 00000007 winscard_svc.c:384:ContextThread() Client protocol is 4:3\r\nDec 06 10:52:30 xps-franck pcscd[2303558]: 00000001 winscard_svc.c:386:ContextThread() Server protocol is 4:4\r\nDec 06 10:52:31 xps-franck systemd[1]: fprintd.service: Deactivated successfully.\r\n░░ Subject: Unit succeeded\r\n░░ Defined-By: systemd\r\n░░ Support: https://lists.freedesktop.org/mailman/listinfo/systemd-devel\r\n░░ \r\n░░ The unit fprintd.service has successfully entered the 'dead' state.\r\nDec 06 10:52:31 xps-franck audit[1]: SERVICE_STOP pid=1 uid=0 auid=4294967295 ses=4294967295 subj=system_u:system_r:init_t:>\r\nDec 06 10:52:31 xps-franck audit: BPF prog-id=0 op=UNLOAD\r\nDec 06 10:52:33 xps-franck pcscd[2303558]: 03007499 winscard_svc.c:382:ContextThread() Communication protocol mismatch!\r\nDec 06 10:52:33 xps-franck pcscd[2303558]: 00000007 winscard_svc.c:384:ContextThread() Client protocol is 4:3\r\nDec 06 10:52:33 xps-franck pcscd[2303558]: 00000002 winscard_svc.c:386:ContextThread() Server protocol is 4:4\r\nDec 06 10:52:36 xps-franck pcscd[2303558]: 03012514 winscard_svc.c:382:ContextThread() Communication protocol mismatch!\r\nDec 06 10:52:36 xps-franck pcscd[2303558]: 00000007 winscard_svc.c:384:ContextThread() Client protocol is 4:3\r\nDec 06 10:52:36 xps-franck pcscd[2303558]: 00000001 winscard_svc.c:386:ContextThread() Server protocol is 4:4\r\nDec 06 10:52:39 xps-franck pcscd[2303558]: 03008331 winscard_svc.c:382:ContextThread() Communication protocol mismatch!\r\nDec 06 10:52:39 xps-franck pcscd[2303558]: 00000006 winscard_svc.c:384:ContextThread() Client protocol is 4:3\r\nDec 06 10:52:39 xps-franck pcscd[2303558]: 00000002 winscard_svc.c:386:ContextThread() Server protocol is 4:4\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1338379158/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1338387742",
    "html_url": "https://github.com/status-im/status-desktop/issues/8622#issuecomment-1338387742",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/8622",
    "id": 1338387742,
    "node_id": "IC_kwDOD5KrTM5Pxi0e",
    "user": {
      "login": "fryorcraken",
      "id": 110212804,
      "node_id": "U_kgDOBpG2xA",
      "avatar_url": "https://avatars.githubusercontent.com/u/110212804?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fryorcraken",
      "html_url": "https://github.com/fryorcraken",
      "followers_url": "https://api.github.com/users/fryorcraken/followers",
      "following_url": "https://api.github.com/users/fryorcraken/following{/other_user}",
      "gists_url": "https://api.github.com/users/fryorcraken/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fryorcraken/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fryorcraken/subscriptions",
      "organizations_url": "https://api.github.com/users/fryorcraken/orgs",
      "repos_url": "https://api.github.com/users/fryorcraken/repos",
      "events_url": "https://api.github.com/users/fryorcraken/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fryorcraken/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-06T00:02:04Z",
    "updated_at": "2022-12-06T00:02:04Z",
    "author_association": "NONE",
    "body": "Also installed https://src.fedoraproject.org/rpms/pcsc-lite-acsccid but did not help",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1338387742/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
