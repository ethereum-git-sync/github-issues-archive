{
  "url": "https://api.github.com/repos/status-im/status-desktop/issues/10279",
  "repository_url": "https://api.github.com/repos/status-im/status-desktop",
  "labels_url": "https://api.github.com/repos/status-im/status-desktop/issues/10279/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-desktop/issues/10279/comments",
  "events_url": "https://api.github.com/repos/status-im/status-desktop/issues/10279/events",
  "html_url": "https://github.com/status-im/status-desktop/issues/10279",
  "id": 1665986784,
  "node_id": "I_kwDOD5KrTM5jTPDg",
  "number": 10279,
  "title": "Fetching messages from store nodes that are more than 24 to 48 hours old is broken ",
  "user": {
    "login": "John-44",
    "id": 22846356,
    "node_id": "MDQ6VXNlcjIyODQ2MzU2",
    "avatar_url": "https://avatars.githubusercontent.com/u/22846356?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/John-44",
    "html_url": "https://github.com/John-44",
    "followers_url": "https://api.github.com/users/John-44/followers",
    "following_url": "https://api.github.com/users/John-44/following{/other_user}",
    "gists_url": "https://api.github.com/users/John-44/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/John-44/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/John-44/subscriptions",
    "organizations_url": "https://api.github.com/users/John-44/orgs",
    "repos_url": "https://api.github.com/users/John-44/repos",
    "events_url": "https://api.github.com/users/John-44/events{/privacy}",
    "received_events_url": "https://api.github.com/users/John-44/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2036563458,
      "node_id": "MDU6TGFiZWwyMDM2NTYzNDU4",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    },
    {
      "id": 3205510054,
      "node_id": "MDU6TGFiZWwzMjA1NTEwMDU0",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/priority%201:%20high",
      "name": "priority 1: high",
      "color": "D93F0B",
      "default": false,
      "description": "an issue that is extremely important to fix, that interferes with the majority of users, occurs ofte"
    },
    {
      "id": 4548141040,
      "node_id": "LA_kwDOD5KrTM8AAAABDxcf8A",
      "url": "https://api.github.com/repos/status-im/status-desktop/labels/messenger-team",
      "name": "messenger-team",
      "color": "232858",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "richard-ramos",
    "id": 1106587,
    "node_id": "MDQ6VXNlcjExMDY1ODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1106587?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/richard-ramos",
    "html_url": "https://github.com/richard-ramos",
    "followers_url": "https://api.github.com/users/richard-ramos/followers",
    "following_url": "https://api.github.com/users/richard-ramos/following{/other_user}",
    "gists_url": "https://api.github.com/users/richard-ramos/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/richard-ramos/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/richard-ramos/subscriptions",
    "organizations_url": "https://api.github.com/users/richard-ramos/orgs",
    "repos_url": "https://api.github.com/users/richard-ramos/repos",
    "events_url": "https://api.github.com/users/richard-ramos/events{/privacy}",
    "received_events_url": "https://api.github.com/users/richard-ramos/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "richard-ramos",
      "id": 1106587,
      "node_id": "MDQ6VXNlcjExMDY1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1106587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/richard-ramos",
      "html_url": "https://github.com/richard-ramos",
      "followers_url": "https://api.github.com/users/richard-ramos/followers",
      "following_url": "https://api.github.com/users/richard-ramos/following{/other_user}",
      "gists_url": "https://api.github.com/users/richard-ramos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/richard-ramos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/richard-ramos/subscriptions",
      "organizations_url": "https://api.github.com/users/richard-ramos/orgs",
      "repos_url": "https://api.github.com/users/richard-ramos/repos",
      "events_url": "https://api.github.com/users/richard-ramos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/richard-ramos/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": {
    "url": "https://api.github.com/repos/status-im/status-desktop/milestones/56",
    "html_url": "https://github.com/status-im/status-desktop/milestone/56",
    "labels_url": "https://api.github.com/repos/status-im/status-desktop/milestones/56/labels",
    "id": 8475714,
    "node_id": "MI_kwDOD5KrTM4AgVRC",
    "number": 56,
    "title": "0.12",
    "description": "Priorities **in priority order** for the 0.12 milestone:  \r\n\r\n**1. Improve performance**\r\n- Focus on eliminating any UI freezes when the user clicks on something and the app does not display an immediate response.  Target: the app should ideally respond to all user input within 50ms, but let's start with identifying the longest UI freezes and trying to fix the worst UI freezes first.\r\n- Speed and responsiveness of switching between community channels, and 1on1 and ad-hoc group chats is particularly important, especially for channels and chats that contains a lot of history.  We should aim for about 250ms delay in the *worst* case if possible.  Having a lot of history in a channel should not slow channel switching down.\r\n- DB perf optimisations.  \r\n- Move things to async and off main thread\r\n- See Alex's great profiling work for possible tasks (Alex to continue focusing on perf. for this release cycle)\r\n- \"user facing performance in everyday app usage\" is the top priority, but any task that improves performance is worthwhile\r\n\r\n**2. Finish development of token based functionality from 0.11**\r\n- Optimise No. queries made by owner node when checking member tokens (Pascal)\r\n- Community encryption should automatically switch on/off depending on community permissions (issue #9942)\r\n- Implement the 'Admin' role (issue #10114)\r\n- Airdrop to community members (in addition to addresses)\r\n- Optimise gas required by collectable minting smart contracts (issue #9943, GravityBlast)\r\n--- After collectable minting gas optimisation is complete, start work on Asset minting contracts (GravityBlast)\r\n- Complete token remote destruct UI\r\n- Remove 'Community Permissions Settings', 'Community Tokens' and 'Discord Import Tool' feature flags (issue #10115)\r\n- Thoroughly test, and fix all bugs found. \r\n- Anything else related to Community level token permissions, collectable minting, airdropping, and remote destructing that didn't make it into 0.11\r\n\r\n**3. Finish implementing the ability for Community Owners and Admins to drag and drop channels and categories into different orders**\r\n\r\n**4. Finish anything related to the initial pairing process for syncing that wasn't completed in 0.11** (Igor)\r\n\r\n**5. Improve Mutual Contacts functionality to improve reliability and pay off tech debt** (Mishka)\r\n\r\n**6. Complete Community Directory Curation dApp integration inc. Featured functionality** (Patryk)\r\n \r\n**7. Backend for the Profile Showcase**\r\n\r\n**8. Identity Verification** (required for 'Profile Showcase')\r\n\r\n**9. Fix bugs, bugs and more bugs!**\r\n- Esp. find the cause of and fix the longstanding bug of some 'requests to join' not arriving for hours/days after they were sent!\r\n- Many 'fit and finish' bugs for the UI team\r\n\r\n**--- For the Wallet team ---**\r\n\r\n1. Continue feature development inc. kicking off development of the activity screens\r\n2. 'All accounts' section.  The ability to return all tokens owned by the user in all accounts (excluding watch only accounts) is also required for the Showcase functionality\r\n3. Widen scope of 'backup to waku' and 'syncing' so that all relevant Wallet user state is backed up and synced between devices\r\n4. Continue to ensure Wallet functionality is performant.\r\n5. Fix wallet bugs",
    "creator": {
      "login": "iurimatias",
      "id": 176720,
      "node_id": "MDQ6VXNlcjE3NjcyMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176720?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iurimatias",
      "html_url": "https://github.com/iurimatias",
      "followers_url": "https://api.github.com/users/iurimatias/followers",
      "following_url": "https://api.github.com/users/iurimatias/following{/other_user}",
      "gists_url": "https://api.github.com/users/iurimatias/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iurimatias/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iurimatias/subscriptions",
      "organizations_url": "https://api.github.com/users/iurimatias/orgs",
      "repos_url": "https://api.github.com/users/iurimatias/repos",
      "events_url": "https://api.github.com/users/iurimatias/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iurimatias/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 176,
    "state": "closed",
    "created_at": "2022-09-28T20:32:37Z",
    "updated_at": "2023-05-08T13:17:45Z",
    "due_on": "2023-05-05T07:00:00Z",
    "closed_at": "2023-05-08T13:17:45Z"
  },
  "comments": 4,
  "created_at": "2023-04-13T08:44:46Z",
  "updated_at": "2023-04-26T14:19:40Z",
  "closed_at": "2023-04-18T15:24:20Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Yesterday afternoon when I tried to update my install from 0.9 to 0.11, the update process borked my installation, forcing me to do a fresh install.\r\n\r\nAfter doing a fresh install and restoring using my seed phrase, when I went to the Status Internal community, in most channels only messages from the last 24 hours had been downloaded, and in a few channels messages from the last 48 hours had been downloaded.  No messages older than 48 hours were downloaded, this includes 1on1 messages, ad-hoc group chat messages, as well as messages in the Status Internal community.\r\n\r\nIt is now 15 hours after I did the fresh install, and still no messages older then 24 to 48 hours have been downloaded.  I've had between 20 and 30 peers all this time, and I haven't see the \"can't connect to store node\" banner.\r\n\r\nThe 0.12 install is supposed to be configured to automatically fetch from store nodes all messages from the last 7 days, so something is definitely broken here.  We we ideally want to raise this limit for 1on1 and ad-hoc group chat messages to 30 days (and it's especially important that the 'automated profile data backup to waku' messages can be retrieved from store nodes for the last 30 days) but of course we need to get message fetching from the last 7 days working first.\r\n\r\nTo reproduce, either create a fresh account and join the Status Internal community, or do a fresh install in a VM and restore from seedphrase (the backup to waku correctly restores the communities that account was a member of - this might be a quicker way of testing).\r\n\r\n@richard-ramos could you take a look at this?    As part of fixing this issue, once fetching the last 7 days worth of messages is working, could we also then raise the limit so that by default Status Desktop fetches the full last 30 days of messages from store nodes automatically (and then test that this works)?\r\n\r\nAlso cc'ing @cammellos and @jm-clius and @LNSD because the failure could perhaps be happening on the nwaku store node side?",
  "closed_by": {
    "login": "jrainville",
    "id": 11926403,
    "node_id": "MDQ6VXNlcjExOTI2NDAz",
    "avatar_url": "https://avatars.githubusercontent.com/u/11926403?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jrainville",
    "html_url": "https://github.com/jrainville",
    "followers_url": "https://api.github.com/users/jrainville/followers",
    "following_url": "https://api.github.com/users/jrainville/following{/other_user}",
    "gists_url": "https://api.github.com/users/jrainville/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jrainville/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jrainville/subscriptions",
    "organizations_url": "https://api.github.com/users/jrainville/orgs",
    "repos_url": "https://api.github.com/users/jrainville/repos",
    "events_url": "https://api.github.com/users/jrainville/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jrainville/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/10279/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-desktop/issues/10279/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1506709835",
    "html_url": "https://github.com/status-im/status-desktop/issues/10279#issuecomment-1506709835",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/10279",
    "id": 1506709835,
    "node_id": "IC_kwDOD5KrTM5ZzpFL",
    "user": {
      "login": "jm-clius",
      "id": 68783915,
      "node_id": "MDQ6VXNlcjY4NzgzOTE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/68783915?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jm-clius",
      "html_url": "https://github.com/jm-clius",
      "followers_url": "https://api.github.com/users/jm-clius/followers",
      "following_url": "https://api.github.com/users/jm-clius/following{/other_user}",
      "gists_url": "https://api.github.com/users/jm-clius/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jm-clius/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jm-clius/subscriptions",
      "organizations_url": "https://api.github.com/users/jm-clius/orgs",
      "repos_url": "https://api.github.com/users/jm-clius/repos",
      "events_url": "https://api.github.com/users/jm-clius/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jm-clius/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-13T10:13:49Z",
    "updated_at": "2023-04-13T10:13:49Z",
    "author_association": "NONE",
    "body": "Can confirm that we can retrieve (with direct query) messages from 30 days ago on all 6 store nodes in `status.prod`. This did not test any specific queries from Status Communities, just that the nwaku store nodes are reachable, have stored 30 days of data and can be queried for that data.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1506709835/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1506718984",
    "html_url": "https://github.com/status-im/status-desktop/issues/10279#issuecomment-1506718984",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/10279",
    "id": 1506718984,
    "node_id": "IC_kwDOD5KrTM5ZzrUI",
    "user": {
      "login": "John-44",
      "id": 22846356,
      "node_id": "MDQ6VXNlcjIyODQ2MzU2",
      "avatar_url": "https://avatars.githubusercontent.com/u/22846356?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/John-44",
      "html_url": "https://github.com/John-44",
      "followers_url": "https://api.github.com/users/John-44/followers",
      "following_url": "https://api.github.com/users/John-44/following{/other_user}",
      "gists_url": "https://api.github.com/users/John-44/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/John-44/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/John-44/subscriptions",
      "organizations_url": "https://api.github.com/users/John-44/orgs",
      "repos_url": "https://api.github.com/users/John-44/repos",
      "events_url": "https://api.github.com/users/John-44/events{/privacy}",
      "received_events_url": "https://api.github.com/users/John-44/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-13T10:21:11Z",
    "updated_at": "2023-04-13T10:21:11Z",
    "author_association": "NONE",
    "body": "![2023-04-13 11_20_22-#nwaku _ Vac - Discord](https://user-images.githubusercontent.com/22846356/231730072-0d486b6f-8bca-4756-bb1c-7512950ccc31.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1506718984/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1506725251",
    "html_url": "https://github.com/status-im/status-desktop/issues/10279#issuecomment-1506725251",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/10279",
    "id": 1506725251,
    "node_id": "IC_kwDOD5KrTM5Zzs2D",
    "user": {
      "login": "churik",
      "id": 4557972,
      "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/churik",
      "html_url": "https://github.com/churik",
      "followers_url": "https://api.github.com/users/churik/followers",
      "following_url": "https://api.github.com/users/churik/following{/other_user}",
      "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
      "organizations_url": "https://api.github.com/users/churik/orgs",
      "repos_url": "https://api.github.com/users/churik/repos",
      "events_url": "https://api.github.com/users/churik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/churik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-13T10:26:27Z",
    "updated_at": "2023-04-13T10:31:48Z",
    "author_association": "MEMBER",
    "body": "FYI: there are a bunch of community fetching history issues, that are mentioned here: https://github.com/status-im/status-mobile/issues/14797\r\n\r\nSometimes history is not fetched even for last 24h, we have a test that covers it and it is failing constantly for the last several months.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1506725251/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1506907000",
    "html_url": "https://github.com/status-im/status-desktop/issues/10279#issuecomment-1506907000",
    "issue_url": "https://api.github.com/repos/status-im/status-desktop/issues/10279",
    "id": 1506907000,
    "node_id": "IC_kwDOD5KrTM5Z0ZN4",
    "user": {
      "login": "John-44",
      "id": 22846356,
      "node_id": "MDQ6VXNlcjIyODQ2MzU2",
      "avatar_url": "https://avatars.githubusercontent.com/u/22846356?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/John-44",
      "html_url": "https://github.com/John-44",
      "followers_url": "https://api.github.com/users/John-44/followers",
      "following_url": "https://api.github.com/users/John-44/following{/other_user}",
      "gists_url": "https://api.github.com/users/John-44/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/John-44/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/John-44/subscriptions",
      "organizations_url": "https://api.github.com/users/John-44/orgs",
      "repos_url": "https://api.github.com/users/John-44/repos",
      "events_url": "https://api.github.com/users/John-44/events{/privacy}",
      "received_events_url": "https://api.github.com/users/John-44/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-13T12:47:32Z",
    "updated_at": "2023-04-13T12:47:32Z",
    "author_association": "NONE",
    "body": "Thanks @churik, useful to know!\r\n\r\n@richard-ramos note that in my case, the issue I'm seeing with messages older then 20 to 48 hours not being fetched from store nodes affects 1on1, ad-hoc group chat and community messages equally.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-desktop/issues/comments/1506907000/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
