{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/12898",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/12898/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/12898/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/12898/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/12898",
  "id": 1075797222,
  "node_id": "I_kwDOAx4p2c5AH1zm",
  "number": 12898,
  "title": "Public chats can stuck in loading state forever ",
  "user": {
    "login": "churik",
    "id": 4557972,
    "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/churik",
    "html_url": "https://github.com/churik",
    "followers_url": "https://api.github.com/users/churik/followers",
    "following_url": "https://api.github.com/users/churik/following{/other_user}",
    "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
    "organizations_url": "https://api.github.com/users/churik/orgs",
    "repos_url": "https://api.github.com/users/churik/repos",
    "events_url": "https://api.github.com/users/churik/events{/privacy}",
    "received_events_url": "https://api.github.com/users/churik/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 330296931,
      "node_id": "MDU6TGFiZWwzMzAyOTY5MzE=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    },
    {
      "id": 517247009,
      "node_id": "MDU6TGFiZWw1MTcyNDcwMDk=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/high-priority",
      "name": "high-priority",
      "color": "000000",
      "default": false,
      "description": null
    },
    {
      "id": 916015974,
      "node_id": "MDU6TGFiZWw5MTYwMTU5NzQ=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/e2e%20test%20blocker",
      "name": "e2e test blocker",
      "color": "bc0753",
      "default": false,
      "description": ""
    },
    {
      "id": 3990911030,
      "node_id": "LA_kwDOAx4p2c7t4Hg2",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/E:Bugfixes",
      "name": "E:Bugfixes",
      "color": "32BD0C",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2021-12-09T16:59:58Z",
  "updated_at": "2022-06-14T12:47:27Z",
  "closed_at": "2022-06-14T12:47:27Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "# Bug Report\r\n\r\n\r\n## Problem \r\n**IOS:** several chats are stuck with an endless loading spinner (fetching history for another public chats is working) - could reproduce on IOS only.\r\n**Android:** if start fetching history in offline mode and then switch to inline, \"Fetch more messages\" is available only after re-login\r\n\r\n\r\n#### Expected behavior\r\nno loading; fetch more messages is available after come back online\r\n\r\n#### Actual behavior\r\n\r\n**IOS:** \r\nhttps://user-images.githubusercontent.com/4557972/145432479-2518d99c-f0aa-4b33-ab40-7694c99b3b0c.mp4\r\nchats are stuck with a loading spinner, re-login doesn't help \r\n\r\n**Android:**\r\n![IMAGE 2021-12-09 17:57:12](https://user-images.githubusercontent.com/4557972/145441234-eb814a27-09b7-49c9-9a47-adfd1790e8d1.jpg)\r\n\"Fetch more history\" is not available until another relogin\r\n\r\n### Reproduction\r\n(Easiest way I found to reproduce behaviour) \r\n\r\n1) Open Status\r\n2) Turn off wi-fi\r\n3) Join the chat with history (i.e. #status)  and chat with no history (any random)\r\n4) Re-login\r\n5) Turn on Wi-Fi\r\n6) Pay attention to both chats \r\n\r\nNOTE: sometimes additional re-login can fix the issue, but in some cases chat with no history stuck in loading forever\r\n\r\n### Additional Information\r\n\r\n- Status version: nightly 09/12/21\r\n- Operating System: Android, iOS\r\n\r\n\r\n[comment]: # (Please, add logs/notes if necessary)\r\n\r\n**IOS:** [logs (1).zip](https://github.com/status-im/status-react/files/7687040/logs.1.zip)\r\n",
  "closed_by": {
    "login": "churik",
    "id": 4557972,
    "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/churik",
    "html_url": "https://github.com/churik",
    "followers_url": "https://api.github.com/users/churik/followers",
    "following_url": "https://api.github.com/users/churik/following{/other_user}",
    "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
    "organizations_url": "https://api.github.com/users/churik/orgs",
    "repos_url": "https://api.github.com/users/churik/repos",
    "events_url": "https://api.github.com/users/churik/events{/privacy}",
    "received_events_url": "https://api.github.com/users/churik/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/12898/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/12898/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/993652122",
    "html_url": "https://github.com/status-im/status-mobile/issues/12898#issuecomment-993652122",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/12898",
    "id": 993652122,
    "node_id": "IC_kwDOAx4p2c47Oe2a",
    "user": {
      "login": "churik",
      "id": 4557972,
      "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/churik",
      "html_url": "https://github.com/churik",
      "followers_url": "https://api.github.com/users/churik/followers",
      "following_url": "https://api.github.com/users/churik/following{/other_user}",
      "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
      "organizations_url": "https://api.github.com/users/churik/orgs",
      "repos_url": "https://api.github.com/users/churik/repos",
      "events_url": "https://api.github.com/users/churik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/churik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-14T15:21:55Z",
    "updated_at": "2021-12-20T08:28:11Z",
    "author_association": "MEMBER",
    "body": "Found one more reproducible behavior - endless loading is shown when restoring a particular multi-account at the start of the history of every public chat. For seed phrase DM me.\r\nLogs:\r\n[Status-debug-logs.zip](https://github.com/status-im/status-react/files/7712722/Status-debug-logs.zip)\r\nIssue is not reproducible on  1.17\r\n![IMAGE 2021-12-14 16:29:20](https://user-images.githubusercontent.com/4557972/146028175-2364596e-5076-464c-afbe-375883761e62.jpg)\r\n\r\n\r\n\r\nUPD: on 15/12/21 15 CET is not reproducible on this multiaccount",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/993652122/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/995951655",
    "html_url": "https://github.com/status-im/status-mobile/issues/12898#issuecomment-995951655",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/12898",
    "id": 995951655,
    "node_id": "IC_kwDOAx4p2c47XQQn",
    "user": {
      "login": "churik",
      "id": 4557972,
      "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/churik",
      "html_url": "https://github.com/churik",
      "followers_url": "https://api.github.com/users/churik/followers",
      "following_url": "https://api.github.com/users/churik/following{/other_user}",
      "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
      "organizations_url": "https://api.github.com/users/churik/orgs",
      "repos_url": "https://api.github.com/users/churik/repos",
      "events_url": "https://api.github.com/users/churik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/churik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-16T15:59:30Z",
    "updated_at": "2021-12-16T16:00:06Z",
    "author_association": "MEMBER",
    "body": "A bunch of e2e is failed due to this issue.\r\nSeems it happens when a peer trying to connect to a node automatically, have seen this also manually.\r\nExample of e2e: https://ethstatus.testrail.net/index.php?/tests/view/2392872 \r\n\r\nSession: https://saucelabs.com/jobs/66853845b6834ff38dab2b350a0b2eab?auth=95f24870a29a29d18aefd343e408a8e8\r\nGeth log: \r\n[test_pair_devices_sync_one_to_one_contacts_nicknames_public_chat_geth2.log](https://github.com/status-im/status-react/files/7728718/test_pair_devices_sync_one_to_one_contacts_nicknames_public_chat_geth2.log)\r\n\r\nHistory node: 01-gc-us.eth.staging\r\nTherefore:\r\n- just after creating (restoring) multi-account (`Automatic selection` = ON),  got `Loading` when join any public channel\r\n- if relogin or change mailserver manually, issue is gone",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/995951655/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1000803174",
    "html_url": "https://github.com/status-im/status-mobile/issues/12898#issuecomment-1000803174",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/12898",
    "id": 1000803174,
    "node_id": "IC_kwDOAx4p2c47pwtm",
    "user": {
      "login": "churik",
      "id": 4557972,
      "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/churik",
      "html_url": "https://github.com/churik",
      "followers_url": "https://api.github.com/users/churik/followers",
      "following_url": "https://api.github.com/users/churik/following{/other_user}",
      "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
      "organizations_url": "https://api.github.com/users/churik/orgs",
      "repos_url": "https://api.github.com/users/churik/repos",
      "events_url": "https://api.github.com/users/churik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/churik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-24T11:32:37Z",
    "updated_at": "2021-12-24T11:32:37Z",
    "author_association": "MEMBER",
    "body": "About 10-15% of e2e failed in each PR.\r\nMore logs just in case:\r\nTest case:  test_redirect_to_public_chat_tapping_tag_message_fetch_more_history https://ethstatus.testrail.net/index.php?/tests/view/2397441\r\n[test_redirect_to_public_chat_tapping_tag_message_fetch_more_history_geth.log](https://github.com/status-im/status-react/files/7774159/test_redirect_to_public_chat_tapping_tag_message_fetch_more_history_geth.log)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1000803174/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1002964583",
    "html_url": "https://github.com/status-im/status-mobile/issues/12898#issuecomment-1002964583",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/12898",
    "id": 1002964583,
    "node_id": "IC_kwDOAx4p2c47yAZn",
    "user": {
      "login": "churik",
      "id": 4557972,
      "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/churik",
      "html_url": "https://github.com/churik",
      "followers_url": "https://api.github.com/users/churik/followers",
      "following_url": "https://api.github.com/users/churik/following{/other_user}",
      "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
      "organizations_url": "https://api.github.com/users/churik/orgs",
      "repos_url": "https://api.github.com/users/churik/repos",
      "events_url": "https://api.github.com/users/churik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/churik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-30T10:24:06Z",
    "updated_at": "2021-12-30T10:26:03Z",
    "author_association": "MEMBER",
    "body": "UPD: re-launched the same e2e on release 1.17 and it is the same there, so the most likely issue is on the history node side.\r\nOne more geth.log (from 1.18, as it was enabled on e2e side later):[test_redirect_to_public_chat_tapping_tag_message_fetch_more_history_geth (1).log](https://github.com/status-im/status-react/files/7792490/test_redirect_to_public_chat_tapping_tag_message_fetch_more_history_geth.1.log)\r\nTest run is here: https://github.com/status-im/status-react/pull/12957#issuecomment-1002786723\r\n\r\ne2e builds are working on `eth.staging` fleet and located in US.\r\nThe issue appeared 14/12/21 and after 18/12/21 this particular test didn't pass.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1002964583/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1008932787",
    "html_url": "https://github.com/status-im/status-mobile/issues/12898#issuecomment-1008932787",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/12898",
    "id": 1008932787,
    "node_id": "IC_kwDOAx4p2c48Ixez",
    "user": {
      "login": "churik",
      "id": 4557972,
      "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/churik",
      "html_url": "https://github.com/churik",
      "followers_url": "https://api.github.com/users/churik/followers",
      "following_url": "https://api.github.com/users/churik/following{/other_user}",
      "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
      "organizations_url": "https://api.github.com/users/churik/orgs",
      "repos_url": "https://api.github.com/users/churik/repos",
      "events_url": "https://api.github.com/users/churik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/churik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-10T14:35:42Z",
    "updated_at": "2022-01-10T14:35:42Z",
    "author_association": "MEMBER",
    "body": "UPD: launched the same test 5 times on nightly 09/01/22 - no issue. ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1008932787/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1014706727",
    "html_url": "https://github.com/status-im/status-mobile/issues/12898#issuecomment-1014706727",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/12898",
    "id": 1014706727,
    "node_id": "IC_kwDOAx4p2c48ezIn",
    "user": {
      "login": "churik",
      "id": 4557972,
      "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/churik",
      "html_url": "https://github.com/churik",
      "followers_url": "https://api.github.com/users/churik/followers",
      "following_url": "https://api.github.com/users/churik/following{/other_user}",
      "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
      "organizations_url": "https://api.github.com/users/churik/orgs",
      "repos_url": "https://api.github.com/users/churik/repos",
      "events_url": "https://api.github.com/users/churik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/churik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-17T16:19:39Z",
    "updated_at": "2022-01-17T16:29:06Z",
    "author_association": "MEMBER",
    "body": "Still happens on e2e tests.\r\nAnd we really can't rely on e2e tests due to these issues.\r\n\r\nCurrently, I see 2 issues that are related likely to mailserver (which is `gc-us central1` on `eth.staging` fleet)\r\n\r\n**1. Endless loading still happens a lot in public/community chats**\r\n\r\nJust an example of failed e2e, can get more if needed.\r\nRecent logs: [test_can_use_purchased_stickers_on_recovered_account_geth.log](https://github.com/status-im/status-react/files/7883325/test_can_use_purchased_stickers_on_recovered_account_geth.log)\r\n\r\nSession: https://app.saucelabs.com/tests/8d2b05b711a24dc4a2d10e68feb7c88e?auth=1d8e23e61b45f1fef8d2a95c49bdb767#91\r\n\r\n**2. Community invite links are never resolved in e2e** \r\n\r\nSo it blocks all community tests also.\r\nLogs: [test_creating_community_accept_membership_geth2.log](https://github.com/status-im/status-react/files/7883339/test_creating_community_accept_membership_geth2.log)\r\n\r\nSession: https://app.saucelabs.com/tests/4b9d652ffeb44960870f79b817b64a4d?auth=198c7cd6667c3005708bf13790840001#83\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1014706727/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1155140135",
    "html_url": "https://github.com/status-im/status-mobile/issues/12898#issuecomment-1155140135",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/12898",
    "id": 1155140135,
    "node_id": "IC_kwDOAx4p2c5E2gon",
    "user": {
      "login": "churik",
      "id": 4557972,
      "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/churik",
      "html_url": "https://github.com/churik",
      "followers_url": "https://api.github.com/users/churik/followers",
      "following_url": "https://api.github.com/users/churik/following{/other_user}",
      "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
      "organizations_url": "https://api.github.com/users/churik/orgs",
      "repos_url": "https://api.github.com/users/churik/repos",
      "events_url": "https://api.github.com/users/churik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/churik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-14T12:47:27Z",
    "updated_at": "2022-06-14T12:47:27Z",
    "author_association": "MEMBER",
    "body": "Didn't see it for quite long time, closing",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1155140135/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
