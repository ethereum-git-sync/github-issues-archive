{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/9135",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/9135/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/9135/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/9135/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/9135",
  "id": 503482407,
  "node_id": "MDU6SXNzdWU1MDM0ODI0MDc=",
  "number": 9135,
  "title": "User is not asked to re-login after changing Fleet settings (and no mailserver selected)",
  "user": {
    "login": "Serhy",
    "id": 8749671,
    "node_id": "MDQ6VXNlcjg3NDk2NzE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8749671?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Serhy",
    "html_url": "https://github.com/Serhy",
    "followers_url": "https://api.github.com/users/Serhy/followers",
    "following_url": "https://api.github.com/users/Serhy/following{/other_user}",
    "gists_url": "https://api.github.com/users/Serhy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Serhy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Serhy/subscriptions",
    "organizations_url": "https://api.github.com/users/Serhy/orgs",
    "repos_url": "https://api.github.com/users/Serhy/repos",
    "events_url": "https://api.github.com/users/Serhy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Serhy/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 330296931,
      "node_id": "MDU6TGFiZWwzMzAyOTY5MzE=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    },
    {
      "id": 916015974,
      "node_id": "MDU6TGFiZWw5MTYwMTU5NzQ=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/e2e%20test%20blocker",
      "name": "e2e test blocker",
      "color": "bc0753",
      "default": false,
      "description": ""
    },
    {
      "id": 957413450,
      "node_id": "MDU6TGFiZWw5NTc0MTM0NTA=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/low-severity",
      "name": "low-severity",
      "color": "3fdbce",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2019-10-07T14:17:51Z",
  "updated_at": "2020-09-17T10:38:51Z",
  "closed_at": "2020-09-17T10:38:51Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "# Bug Report\r\n\r\n## Problem\r\n\r\nWhen changing fleet from Profile there is no mailserver from the mailservers pool of particular fleet is set, thus - no messages are received from offline. \r\n\r\nAnd in general with all the rest of consequences of when mailserver set to null: e.g. Fetch more message in public chat results in 'An error occured while fetching history' or if I send message to 1-1/group chat - no one from those who offline at this moment will ever receive it.\r\n\r\nAfter re-login everything is fine. In the past we used to force user to re-login to account after fleet has changed. Not sure when that changed (that we do not log user out with respective pop-up saying \"You need to re-login for changes to take effect\" message) but we need either to return back previous behavior (force re-login) or select mailserver right after fleet option has changed.\r\n\r\n#### Expected behavior\r\nUser force logout happens after fleet option is changed from Profile\r\n\r\n#### Actual behavior\r\nUser is not asked to re-login after fleet option is changed from Profile. No mailserver is set after fleet option is changes. Making 'Fetch more message' call results in 'An error occured while fetching history...' with the following error when user tap this status: `Mailserver request error: The following error was returned by the mailserver: failed to decrypt p2p request`\r\n\r\n<img width=\"306\" alt=\"Screenshot 2019-10-07 at 16 51 01\" src=\"https://user-images.githubusercontent.com/8749671/66317692-ad781a00-e922-11e9-83f6-825b8828f680.png\">\r\n\r\n\r\n#### Acceptance Criteria\r\n\r\n- When confirming Fleet changing via tap of `Confirm` button - user forced to log out of account and appears on login screen\r\n- Logging to account connects user to selected fleet. `Mailserver settings` is set to 'Automatic selection' and so automatic selection of mailserver is made after login.\r\n\r\n### Reproduction\r\n\r\n- Open Status and create new account\r\n- Navigate to `Profile` -> `Advanced` -> `Fleet`\r\n- Tap upon `eth.staging` option\r\n\r\n### Additional Information\r\n- Status version: Develop `0.14.0 (2019100703)`\r\n- Operating System: Android and iOS\r\n\r\n#### Logs\r\n\r\nLogcat for what happens when tap fleet -> `Confirm`\r\n```\r\n10-07 17:13:45.911 10708 10708 D ViewRootImpl@65c2fd7[MainActivity]: ViewPostIme pointer 0\r\n10-07 17:13:45.972 10708 10708 D ViewRootImpl@65c2fd7[MainActivity]: ViewPostIme pointer 1\r\n10-07 17:13:45.985 10708 10760 D ReactNativeJS: DEBUG [status-im.utils.handlers:32] - Handling re-frame event:  :fleet.ui/fleet-selected\r\n10-07 17:13:45.994 10708 10708 D Dialog  : mIsSamsungBasicInteraction = false\r\n10-07 17:13:45.994 10708 10708 D Dialog  : mIsSamsungBasicInteraction = false, isMetaDataInActivity = false\r\n10-07 17:13:45.997 10708 10708 I DecorView: createDecorCaptionView >> DecorView@e9eed61[], isFloating: true, isApplication: true, hasWindowDecorCaption: false, hasWindowControllerCallback: false\r\n10-07 17:13:46.006 10708 10708 D ScrollView: initGoToTop\r\n10-07 17:13:46.009 10708 10708 D ScrollView: initGoToTop\r\n10-07 17:13:46.024 10708 10708 D InputTransport: Input channel constructed: fd=91\r\n10-07 17:13:46.024 10708 10708 D ViewRootImpl@ee86736[MainActivity]: setView = DecorView@e9eed61[MainActivity] TM=true MM=false\r\n10-07 17:13:46.026 10708 10708 D ViewRootImpl@ee86736[MainActivity]: dispatchAttachedToWindow\r\n10-07 17:13:46.048 10708 10708 D ViewRootImpl@ee86736[MainActivity]: Relayout returned: old=[0,72][1080,2076] new=[27,790][1053,1357] result=0x7 surface={valid=true 491750215680} changed=true\r\n10-07 17:13:46.053 10708 10732 D mali_winsys: EGLint new_window_surface(egl_winsys_display *, void *, EGLSurface, EGLConfig, egl_winsys_surface **, EGLBoolean) returns 0x3000\r\n10-07 17:13:46.053 10708 10732 D OpenGLRenderer: eglCreateWindowSurface = 0x727e89e300, 0x727e98d010\r\n10-07 17:13:46.054 10708 10708 D ScrollView:  onsize change changed \r\n10-07 17:13:46.054 10708 10708 D ScrollView:  onsize change changed \r\n10-07 17:13:46.061 10708 10708 D ViewRootImpl@ee86736[MainActivity]: MSG_WINDOW_FOCUS_CHANGED 1 1\r\n10-07 17:13:46.080 10708 10708 D ViewRootImpl@ee86736[MainActivity]: MSG_RESIZED: frame=Rect(27, 790 - 1053, 1357) ci=Rect(0, 0 - 0, 0) vi=Rect(0, 0 - 0, 0) or=1\r\n10-07 17:13:46.101 10708 10708 D ViewRootImpl@65c2fd7[MainActivity]: MSG_WINDOW_FOCUS_CHANGED 0 1\r\n10-07 17:13:46.102 10708 10708 D InputMethodManager: prepareNavigationBarInfo() DecorView@7bec532[MainActivity]\r\n10-07 17:13:46.102 10708 10708 D InputMethodManager: getNavigationBarColor() -855310\r\n10-07 17:13:46.940 10708 10708 D ViewRootImpl@ee86736[MainActivity]: ViewPostIme pointer 0\r\n10-07 17:13:47.039 10708 10708 D ViewRootImpl@ee86736[MainActivity]: ViewPostIme pointer 1\r\n10-07 17:13:47.050 10708 10760 D ReactNativeJS: DEBUG [status-im.utils.handlers:32] - Handling re-frame event:  :fleet.ui/save-fleet-confirmed\r\n10-07 17:13:47.063 10708 10732 W libEGL  : EGLNativeWindowType 0x727e98d010 disconnect failed\r\n10-07 17:13:47.063 10708 10732 D OpenGLRenderer: eglDestroySurface = 0x727e89e300, 0x727e98d000\r\n10-07 17:13:47.063 10708 10732 D OpenGLRenderer: endAllActiveAnimators on 0x7237368600 (RippleDrawable) with handle 0x72358232a0\r\n10-07 17:13:47.063 10708 10708 D ViewRootImpl@ee86736[MainActivity]: dispatchDetachedFromWindow\r\n10-07 17:13:47.063 10708 10708 D ViewRootImpl@ee86736[MainActivity]: Surface release. android.view.ViewRootImpl.doDie:7979 android.view.ViewRootImpl.die:7947 android.view.WindowManagerGlobal.removeViewLocked:497 android.view.WindowManagerGlobal.removeView:435 android.view.WindowManagerImpl.removeViewImmediate:124 android.app.Dialog.dismissDialog:518 android.app.Dialog.dismiss:501 com.android.internal.app.AlertController$ButtonHandler.handleMessage:188 \r\n10-07 17:13:47.087 10708 10708 D InputTransport: Input channel destroyed: fd=91\r\n10-07 17:13:47.095 10708 10708 D ViewRootImpl@65c2fd7[MainActivity]: MSG_WINDOW_FOCUS_CHANGED 1 1\r\n10-07 17:13:47.097 10708 10708 D InputMethodManager: prepareNavigationBarInfo() DecorView@7bec532[MainActivity]\r\n10-07 17:13:47.098 10708 10708 D InputMethodManager: getNavigationBarColor() -855310\r\n10-07 17:13:47.104 10708 10708 E ViewRootImpl: sendUserActionEvent() returned.\r\n10-07 17:13:47.499 10708 10926 D StatusModule: Signal event: {\"type\":\"wallet\",\"event\":{\"type\":\"newblock\",\"blockNumber\":8695371,\"accounts\":[]}}\r\n10-07 17:13:47.506 10708 10760 D ReactNativeJS: DEBUG [status-im.utils.handlers:32] - Handling re-frame event:  :signals/signal-received\r\n10-07 17:13:47.510 10708 10760 D ReactNativeJS: DEBUG [status-im.events:667] - :event-str {\"type\":\"wallet\",\"event\":{\"type\":\"newblock\",\"blockNumber\":8695371,\"accounts\":[]}}\r\n\r\n\r\n```\r\n",
  "closed_by": {
    "login": "cammellos",
    "id": 1017008,
    "node_id": "MDQ6VXNlcjEwMTcwMDg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1017008?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cammellos",
    "html_url": "https://github.com/cammellos",
    "followers_url": "https://api.github.com/users/cammellos/followers",
    "following_url": "https://api.github.com/users/cammellos/following{/other_user}",
    "gists_url": "https://api.github.com/users/cammellos/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cammellos/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cammellos/subscriptions",
    "organizations_url": "https://api.github.com/users/cammellos/orgs",
    "repos_url": "https://api.github.com/users/cammellos/repos",
    "events_url": "https://api.github.com/users/cammellos/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cammellos/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/9135/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/9135/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/539035518",
    "html_url": "https://github.com/status-im/status-mobile/issues/9135#issuecomment-539035518",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/9135",
    "id": 539035518,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzOTAzNTUxOA==",
    "user": {
      "login": "Serhy",
      "id": 8749671,
      "node_id": "MDQ6VXNlcjg3NDk2NzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8749671?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Serhy",
      "html_url": "https://github.com/Serhy",
      "followers_url": "https://api.github.com/users/Serhy/followers",
      "following_url": "https://api.github.com/users/Serhy/following{/other_user}",
      "gists_url": "https://api.github.com/users/Serhy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Serhy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Serhy/subscriptions",
      "organizations_url": "https://api.github.com/users/Serhy/orgs",
      "repos_url": "https://api.github.com/users/Serhy/repos",
      "events_url": "https://api.github.com/users/Serhy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Serhy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-07T14:21:04Z",
    "updated_at": "2019-10-07T14:21:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "@rachelhamlin I see it as low-prio issue, taking that 'Fleet settings' is \"Advanced mode\" of using Status and that there is no issue after re-login.\r\nGood candidate for bounty\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/539035518/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/570533319",
    "html_url": "https://github.com/status-im/status-mobile/issues/9135#issuecomment-570533319",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/9135",
    "id": 570533319,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MDUzMzMxOQ==",
    "user": {
      "login": "churik",
      "id": 4557972,
      "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/churik",
      "html_url": "https://github.com/churik",
      "followers_url": "https://api.github.com/users/churik/followers",
      "following_url": "https://api.github.com/users/churik/following{/other_user}",
      "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
      "organizations_url": "https://api.github.com/users/churik/orgs",
      "repos_url": "https://api.github.com/users/churik/repos",
      "events_url": "https://api.github.com/users/churik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/churik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-03T10:32:01Z",
    "updated_at": "2020-01-03T10:32:01Z",
    "author_association": "MEMBER",
    "body": "The same issue with bootnodes enabling/saving - on release 0.13.3 there is force logout on these actions.\r\nOn current nightly user is not asked to relogin so I suppose that new settings are not applied (but I don't have a way to check it though)",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/570533319/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/694148243",
    "html_url": "https://github.com/status-im/status-mobile/issues/9135#issuecomment-694148243",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/9135",
    "id": 694148243,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NDE0ODI0Mw==",
    "user": {
      "login": "cammellos",
      "id": 1017008,
      "node_id": "MDQ6VXNlcjEwMTcwMDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1017008?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cammellos",
      "html_url": "https://github.com/cammellos",
      "followers_url": "https://api.github.com/users/cammellos/followers",
      "following_url": "https://api.github.com/users/cammellos/following{/other_user}",
      "gists_url": "https://api.github.com/users/cammellos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cammellos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cammellos/subscriptions",
      "organizations_url": "https://api.github.com/users/cammellos/orgs",
      "repos_url": "https://api.github.com/users/cammellos/repos",
      "events_url": "https://api.github.com/users/cammellos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cammellos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-17T10:38:51Z",
    "updated_at": "2020-09-17T10:38:51Z",
    "author_association": "MEMBER",
    "body": "I believe this has been fixed, feel free to reopen.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/694148243/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
