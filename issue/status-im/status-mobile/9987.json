{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/9987",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/9987/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/9987/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/9987/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/9987",
  "id": 560482773,
  "node_id": "MDU6SXNzdWU1NjA0ODI3NzM=",
  "number": 9987,
  "title": "Improve watching to new blocks (recent transfers state)",
  "user": {
    "login": "rasom",
    "id": 2364994,
    "node_id": "MDQ6VXNlcjIzNjQ5OTQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2364994?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rasom",
    "html_url": "https://github.com/rasom",
    "followers_url": "https://api.github.com/users/rasom/followers",
    "following_url": "https://api.github.com/users/rasom/following{/other_user}",
    "gists_url": "https://api.github.com/users/rasom/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rasom/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rasom/subscriptions",
    "organizations_url": "https://api.github.com/users/rasom/orgs",
    "repos_url": "https://api.github.com/users/rasom/repos",
    "events_url": "https://api.github.com/users/rasom/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rasom/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 933023569,
      "node_id": "MDU6TGFiZWw5MzMwMjM1Njk=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/feature",
      "name": "feature",
      "color": "172b9e",
      "default": false,
      "description": "feature requests"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "rasom",
    "id": 2364994,
    "node_id": "MDQ6VXNlcjIzNjQ5OTQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2364994?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rasom",
    "html_url": "https://github.com/rasom",
    "followers_url": "https://api.github.com/users/rasom/followers",
    "following_url": "https://api.github.com/users/rasom/following{/other_user}",
    "gists_url": "https://api.github.com/users/rasom/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rasom/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rasom/subscriptions",
    "organizations_url": "https://api.github.com/users/rasom/orgs",
    "repos_url": "https://api.github.com/users/rasom/repos",
    "events_url": "https://api.github.com/users/rasom/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rasom/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "rasom",
      "id": 2364994,
      "node_id": "MDQ6VXNlcjIzNjQ5OTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2364994?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rasom",
      "html_url": "https://github.com/rasom",
      "followers_url": "https://api.github.com/users/rasom/followers",
      "following_url": "https://api.github.com/users/rasom/following{/other_user}",
      "gists_url": "https://api.github.com/users/rasom/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rasom/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rasom/subscriptions",
      "organizations_url": "https://api.github.com/users/rasom/orgs",
      "repos_url": "https://api.github.com/users/rasom/repos",
      "events_url": "https://api.github.com/users/rasom/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rasom/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": {
    "url": "https://api.github.com/repos/status-im/status-mobile/milestones/37",
    "html_url": "https://github.com/status-im/status-mobile/milestone/37",
    "labels_url": "https://api.github.com/repos/status-im/status-mobile/milestones/37/labels",
    "id": 5622881,
    "node_id": "MDk6TWlsZXN0b25lNTYyMjg4MQ==",
    "number": 37,
    "title": "Mobile bug fixes and small improvements",
    "description": "Bug fixes and small improvements release",
    "creator": {
      "login": "hesterbruikman",
      "id": 35233054,
      "node_id": "MDQ6VXNlcjM1MjMzMDU0",
      "avatar_url": "https://avatars.githubusercontent.com/u/35233054?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hesterbruikman",
      "html_url": "https://github.com/hesterbruikman",
      "followers_url": "https://api.github.com/users/hesterbruikman/followers",
      "following_url": "https://api.github.com/users/hesterbruikman/following{/other_user}",
      "gists_url": "https://api.github.com/users/hesterbruikman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hesterbruikman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hesterbruikman/subscriptions",
      "organizations_url": "https://api.github.com/users/hesterbruikman/orgs",
      "repos_url": "https://api.github.com/users/hesterbruikman/repos",
      "events_url": "https://api.github.com/users/hesterbruikman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hesterbruikman/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 26,
    "state": "closed",
    "created_at": "2020-07-06T14:06:51Z",
    "updated_at": "2022-12-05T13:03:59Z",
    "due_on": "2020-09-08T07:00:00Z",
    "closed_at": "2020-12-29T09:13:38Z"
  },
  "comments": 3,
  "created_at": "2020-02-05T16:23:53Z",
  "updated_at": "2020-12-21T12:24:22Z",
  "closed_at": "2020-12-21T12:24:22Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "# Feature Issue\n[comment]: # (Please replace ... with your information. Remove < and >)\n\n### User Story\nAs a user, I want to see the most recent tx history of my accounts with no delays using as little internet traffic as possible to be able to know the recent state of my accounts. \n\n### Description\n\n\n* [ ] the way how we listen to recent blocks should be rewritten so that we do not \nfetch an entire block each time. We can use \neth_getBalance/eth_transactionsCount/eth_getLogs instead. The number of requests\nwill increase, but even if we will make hundreds of such requests it will cost\nless traffic than eth_getBlockByNumber with all transactions. And we can make\nthese requests for free as archival node will not be required (reroute them to\ncloudflare for instance).\n* [ ] also the way how we check recent block can be rewritten so that we alway stay\n1-2 blocks behind the \"latest\" instead of allowing some kind of queuing, as we \nhave now. In this case we can avoid unnecessary delays and show actual transfers\nstate faster (and what's probably more important that delay can be relatively \nstable)\n* [ ] (**partially implemented, we do not check blocks while app is in the background**) \non android we could stop listening to each new block when app is in the\nbackground and check history once per 1-2 minutes. That will also save traffic \nand we still will be able to show PNs with transfers (if we plan to do this).\n\n### Acceptance Criteria\n[comment]: # (Rules for the future PR to be accepted.)\n\n### Notes\n[comment]: # (For the developer who will implement. Include planning poker estimates, guidance, etc.)\n\n",
  "closed_by": {
    "login": "rasom",
    "id": 2364994,
    "node_id": "MDQ6VXNlcjIzNjQ5OTQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2364994?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rasom",
    "html_url": "https://github.com/rasom",
    "followers_url": "https://api.github.com/users/rasom/followers",
    "following_url": "https://api.github.com/users/rasom/following{/other_user}",
    "gists_url": "https://api.github.com/users/rasom/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rasom/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rasom/subscriptions",
    "organizations_url": "https://api.github.com/users/rasom/orgs",
    "repos_url": "https://api.github.com/users/rasom/repos",
    "events_url": "https://api.github.com/users/rasom/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rasom/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/9987/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/9987/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/652239849",
    "html_url": "https://github.com/status-im/status-mobile/issues/9987#issuecomment-652239849",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/9987",
    "id": 652239849,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MjIzOTg0OQ==",
    "user": {
      "login": "oskarth",
      "id": 1552237,
      "node_id": "MDQ6VXNlcjE1NTIyMzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1552237?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oskarth",
      "html_url": "https://github.com/oskarth",
      "followers_url": "https://api.github.com/users/oskarth/followers",
      "following_url": "https://api.github.com/users/oskarth/following{/other_user}",
      "gists_url": "https://api.github.com/users/oskarth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oskarth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oskarth/subscriptions",
      "organizations_url": "https://api.github.com/users/oskarth/orgs",
      "repos_url": "https://api.github.com/users/oskarth/repos",
      "events_url": "https://api.github.com/users/oskarth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oskarth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-01T07:18:38Z",
    "updated_at": "2020-07-01T07:18:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "This has a big impact on BW right now from what I understand.\r\n\r\nFrom @cammellos \r\n\r\n> Current usage is driven by wallet, around 1MB per minute. That's a constant and does not increase as network increases. It > ignores mobile data settings for now, something we are aware of.\r\n> \r\n> Another source of bandwidth is disconnection from mailserver, each costs around 250KB, so a few disconnection in a minute > can significantly impact bandwidth.\r\n\r\n@andremedeiros @hesterbruikman are you aware of this issue and is there a plan to address it? W.r.t retention from eating up BW, especially in target markets.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/652239849/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/727948463",
    "html_url": "https://github.com/status-im/status-mobile/issues/9987#issuecomment-727948463",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/9987",
    "id": 727948463,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNzk0ODQ2Mw==",
    "user": {
      "login": "rasom",
      "id": 2364994,
      "node_id": "MDQ6VXNlcjIzNjQ5OTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2364994?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rasom",
      "html_url": "https://github.com/rasom",
      "followers_url": "https://api.github.com/users/rasom/followers",
      "following_url": "https://api.github.com/users/rasom/following{/other_user}",
      "gists_url": "https://api.github.com/users/rasom/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rasom/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rasom/subscriptions",
      "organizations_url": "https://api.github.com/users/rasom/orgs",
      "repos_url": "https://api.github.com/users/rasom/repos",
      "events_url": "https://api.github.com/users/rasom/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rasom/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-16T12:29:19Z",
    "updated_at": "2020-11-16T12:29:19Z",
    "author_association": "MEMBER",
    "body": "@cammellos \r\nSo basically what I would do now:\r\n1. Stop watching each block via `eth_getBlockByNumber`, because it is expensive in terms of traffic (we retrieve transactions along with block) and also 99.9% of those calls are in vain.\r\n2. Instead I would just check a range of blocks each N minutes (let's say 20) using eth_getBalance/eth_transactionsCount/eth_getLogs \r\n3. In case if user sends new transaction I would also start watching each block until tx is confirmed\r\n\r\nI just tested this approach and in case if there is no new transactions we send 48 `eth_*` requests in 21m instead of 580 we currently have in develop (no changes on status-go side). And this 48 number can be reduced about two times because some requests are executed more than once on status-go side (same method and parameters).\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/727948463/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/748947598",
    "html_url": "https://github.com/status-im/status-mobile/issues/9987#issuecomment-748947598",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/9987",
    "id": 748947598,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0ODk0NzU5OA==",
    "user": {
      "login": "rasom",
      "id": 2364994,
      "node_id": "MDQ6VXNlcjIzNjQ5OTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2364994?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rasom",
      "html_url": "https://github.com/rasom",
      "followers_url": "https://api.github.com/users/rasom/followers",
      "following_url": "https://api.github.com/users/rasom/following{/other_user}",
      "gists_url": "https://api.github.com/users/rasom/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rasom/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rasom/subscriptions",
      "organizations_url": "https://api.github.com/users/rasom/orgs",
      "repos_url": "https://api.github.com/users/rasom/repos",
      "events_url": "https://api.github.com/users/rasom/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rasom/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-21T12:24:22Z",
    "updated_at": "2020-12-21T12:24:22Z",
    "author_association": "MEMBER",
    "body": "this one is partially implemented already, the rest of it is likely irrelevant. Closing it ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/748947598/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
