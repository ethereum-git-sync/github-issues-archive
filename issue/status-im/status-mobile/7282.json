{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/7282",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/7282/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/7282/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/7282/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/7282",
  "id": 399422051,
  "node_id": "MDU6SXNzdWUzOTk0MjIwNTE=",
  "number": 7282,
  "title": "Sometimes no history is retrieved if join public chat",
  "user": {
    "login": "annadanchenko",
    "id": 6584810,
    "node_id": "MDQ6VXNlcjY1ODQ4MTA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6584810?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/annadanchenko",
    "html_url": "https://github.com/annadanchenko",
    "followers_url": "https://api.github.com/users/annadanchenko/followers",
    "following_url": "https://api.github.com/users/annadanchenko/following{/other_user}",
    "gists_url": "https://api.github.com/users/annadanchenko/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/annadanchenko/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/annadanchenko/subscriptions",
    "organizations_url": "https://api.github.com/users/annadanchenko/orgs",
    "repos_url": "https://api.github.com/users/annadanchenko/repos",
    "events_url": "https://api.github.com/users/annadanchenko/events{/privacy}",
    "received_events_url": "https://api.github.com/users/annadanchenko/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 330296931,
      "node_id": "MDU6TGFiZWwzMzAyOTY5MzE=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "cammellos",
    "id": 1017008,
    "node_id": "MDQ6VXNlcjEwMTcwMDg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1017008?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cammellos",
    "html_url": "https://github.com/cammellos",
    "followers_url": "https://api.github.com/users/cammellos/followers",
    "following_url": "https://api.github.com/users/cammellos/following{/other_user}",
    "gists_url": "https://api.github.com/users/cammellos/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cammellos/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cammellos/subscriptions",
    "organizations_url": "https://api.github.com/users/cammellos/orgs",
    "repos_url": "https://api.github.com/users/cammellos/repos",
    "events_url": "https://api.github.com/users/cammellos/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cammellos/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "cammellos",
      "id": 1017008,
      "node_id": "MDQ6VXNlcjEwMTcwMDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1017008?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cammellos",
      "html_url": "https://github.com/cammellos",
      "followers_url": "https://api.github.com/users/cammellos/followers",
      "following_url": "https://api.github.com/users/cammellos/following{/other_user}",
      "gists_url": "https://api.github.com/users/cammellos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cammellos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cammellos/subscriptions",
      "organizations_url": "https://api.github.com/users/cammellos/orgs",
      "repos_url": "https://api.github.com/users/cammellos/repos",
      "events_url": "https://api.github.com/users/cammellos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cammellos/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2019-01-15T16:19:11Z",
  "updated_at": "2019-01-29T18:48:17Z",
  "closed_at": "2019-01-29T18:48:17Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Description\r\n\r\n[comment]: # (Feature or Bug? i.e Type: Bug)\r\n*Type*: Bug\r\n\r\n[comment]: # (Describe the feature you would like, or briefly summarise the bug and what you did, what you expected to happen, and what actually happens. Sections below)\r\n*Summary*: Sometimes if join public chat there is no history retrieved (stable wifi connection, even if there is history, even if use \"Fetch last 24 hours\", on mailserver that works fine)\r\n\r\nFound on today's 0.9.33 nightly + staging fleet or on default beta fleet and same nightly\r\n\r\n#### Expected behavior\r\n[comment]: # (Describe what you expected to happen.)\r\nlast 24 h messages are shown in public chat\r\n\r\n#### Actual behavior\r\n[comment]: # (Describe what actually happened.)\r\nNo messages is shown for the chat (even if it has some)\r\n\r\n### Reproduction\r\n[comment]: # (Describe how we can replicate the bug step by step.)\r\n\r\nI can't reproduce it constantly but if try these steps 3-4 times you might be lucky:\r\n\r\n1. create new account\r\n2. add picture to profile (to allow access to Storage)\r\n3. change fleet to staging\r\n4. log in\r\n5. join \"status\" or \"status-core\" chat and check if history is retrieved\r\nIf relaunch app and log in then history is retrieved fine\r\n\r\nI don't think it's because of mailserver. When no messages were retrieved there was \"mail-01.do-ams3.eth.staging\" mailserver. I've killed and started the app again, other mailserver was selected and history was retrieved. Then I've manually selected \"mail-01.do-ams3.eth.staging\" and joined another public chat - history is retrieved fine.\r\n\r\n\r\n\r\n\r\n### Additional Information\r\n[comment]: # (Please do your best to fill this out.)\r\n* Status version: 0.9.33 (2019011503) status-go v0.17.11-beta.e081f3ec\r\n* Operating System: Android 6.0.1 real Galaxy S6 device\r\n\r\n#### Logs\r\nFor staging fleet:\r\n[Status.log](https://github.com/status-im/status-react/files/2760435/Status.log)\r\n[geth.log](https://github.com/status-im/status-react/files/2760437/geth.log)\r\n\r\nFor beta fleet:\r\n[geth.log](https://github.com/status-im/status-react/files/2760484/geth.log)\r\n[Status.log](https://github.com/status-im/status-react/files/2760485/Status.log)\r\n\r\n\r\n",
  "closed_by": {
    "login": "mandrigin",
    "id": 466427,
    "node_id": "MDQ6VXNlcjQ2NjQyNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/466427?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mandrigin",
    "html_url": "https://github.com/mandrigin",
    "followers_url": "https://api.github.com/users/mandrigin/followers",
    "following_url": "https://api.github.com/users/mandrigin/following{/other_user}",
    "gists_url": "https://api.github.com/users/mandrigin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mandrigin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mandrigin/subscriptions",
    "organizations_url": "https://api.github.com/users/mandrigin/orgs",
    "repos_url": "https://api.github.com/users/mandrigin/repos",
    "events_url": "https://api.github.com/users/mandrigin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mandrigin/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/7282/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/7282/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/454679903",
    "html_url": "https://github.com/status-im/status-mobile/issues/7282#issuecomment-454679903",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/7282",
    "id": 454679903,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NDY3OTkwMw==",
    "user": {
      "login": "cammellos",
      "id": 1017008,
      "node_id": "MDQ6VXNlcjEwMTcwMDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1017008?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cammellos",
      "html_url": "https://github.com/cammellos",
      "followers_url": "https://api.github.com/users/cammellos/followers",
      "following_url": "https://api.github.com/users/cammellos/following{/other_user}",
      "gists_url": "https://api.github.com/users/cammellos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cammellos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cammellos/subscriptions",
      "organizations_url": "https://api.github.com/users/cammellos/orgs",
      "repos_url": "https://api.github.com/users/cammellos/repos",
      "events_url": "https://api.github.com/users/cammellos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cammellos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-16T07:31:55Z",
    "updated_at": "2019-01-16T07:31:55Z",
    "author_association": "MEMBER",
    "body": "Looking into this, checking the logs one thing that can be noticed is that the public-chat was joined before the mailserver was ready (that would explain why it only happens sometimes), but will check to validate that.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/454679903/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/454706506",
    "html_url": "https://github.com/status-im/status-mobile/issues/7282#issuecomment-454706506",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/7282",
    "id": 454706506,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NDcwNjUwNg==",
    "user": {
      "login": "annadanchenko",
      "id": 6584810,
      "node_id": "MDQ6VXNlcjY1ODQ4MTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6584810?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/annadanchenko",
      "html_url": "https://github.com/annadanchenko",
      "followers_url": "https://api.github.com/users/annadanchenko/followers",
      "following_url": "https://api.github.com/users/annadanchenko/following{/other_user}",
      "gists_url": "https://api.github.com/users/annadanchenko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/annadanchenko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/annadanchenko/subscriptions",
      "organizations_url": "https://api.github.com/users/annadanchenko/orgs",
      "repos_url": "https://api.github.com/users/annadanchenko/repos",
      "events_url": "https://api.github.com/users/annadanchenko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/annadanchenko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-16T09:14:19Z",
    "updated_at": "2019-01-16T09:14:19Z",
    "author_association": "NONE",
    "body": "using debug PR https://github.com/status-im/status-react/pull/7285 can reproduce on Android build (real Galaxy S6, Android 6.0.1)\r\n\r\nmodified steps:\r\n1. create new account\r\n2. add picture to profile (to allow access to Storage)\r\n3. Log out\r\n4. log in\r\n5. join \"status\" or \"status-core\" chat and check if history is retrieved\r\n\r\n[Status.log](https://github.com/status-im/status-react/files/2763385/Status.log)\r\n[geth.log](https://github.com/status-im/status-react/files/2763388/geth.log)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/454706506/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/454709787",
    "html_url": "https://github.com/status-im/status-mobile/issues/7282#issuecomment-454709787",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/7282",
    "id": 454709787,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NDcwOTc4Nw==",
    "user": {
      "login": "churik",
      "id": 4557972,
      "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/churik",
      "html_url": "https://github.com/churik",
      "followers_url": "https://api.github.com/users/churik/followers",
      "following_url": "https://api.github.com/users/churik/following{/other_user}",
      "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
      "organizations_url": "https://api.github.com/users/churik/orgs",
      "repos_url": "https://api.github.com/users/churik/repos",
      "events_url": "https://api.github.com/users/churik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/churik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-16T09:25:04Z",
    "updated_at": "2019-01-16T10:11:20Z",
    "author_association": "MEMBER",
    "body": "@cammellos tested 0.9.32 release build on `eth.staging` fleet and some messages are not fetched when you go back from offline.\r\n**Steps to reproduce:**\r\n- close app\r\n- send ~10 messages in different chats from another device\r\n- open app and log in\r\n- wait 2+ mins for messages to fetch\r\n\r\n**Expected result:** all messages are fetched\r\n**Actual result:** none of the messages are fetched\r\nReproducible almost every time.\r\nSometimes messages are fetched after switching to `eth.beta`, but not every time.\r\n**Logcat:** [logcat-andr.txt](https://github.com/status-im/status-react/files/2763372/logcat-andr.txt)\r\n\r\nI believe, the reason can be similar, so I've put it as comment. If it is completely different, let me know and I'll create separate issue.\r\n\r\n**NOTE:** it is not reproducible if you have selected `eth.beta` before closing app (5\\5 times)",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/454709787/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/454712037",
    "html_url": "https://github.com/status-im/status-mobile/issues/7282#issuecomment-454712037",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/7282",
    "id": 454712037,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NDcxMjAzNw==",
    "user": {
      "login": "cammellos",
      "id": 1017008,
      "node_id": "MDQ6VXNlcjEwMTcwMDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1017008?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cammellos",
      "html_url": "https://github.com/cammellos",
      "followers_url": "https://api.github.com/users/cammellos/followers",
      "following_url": "https://api.github.com/users/cammellos/following{/other_user}",
      "gists_url": "https://api.github.com/users/cammellos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cammellos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cammellos/subscriptions",
      "organizations_url": "https://api.github.com/users/cammellos/orgs",
      "repos_url": "https://api.github.com/users/cammellos/repos",
      "events_url": "https://api.github.com/users/cammellos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cammellos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-16T09:31:50Z",
    "updated_at": "2019-01-16T09:31:50Z",
    "author_association": "MEMBER",
    "body": "@churik would you mind using the test build from https://github.com/status-im/status-react/pull/7285 and replicate? thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/454712037/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/454733928",
    "html_url": "https://github.com/status-im/status-mobile/issues/7282#issuecomment-454733928",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/7282",
    "id": 454733928,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NDczMzkyOA==",
    "user": {
      "login": "churik",
      "id": 4557972,
      "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/churik",
      "html_url": "https://github.com/churik",
      "followers_url": "https://api.github.com/users/churik/followers",
      "following_url": "https://api.github.com/users/churik/following{/other_user}",
      "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
      "organizations_url": "https://api.github.com/users/churik/orgs",
      "repos_url": "https://api.github.com/users/churik/repos",
      "events_url": "https://api.github.com/users/churik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/churik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-16T10:43:05Z",
    "updated_at": "2019-01-16T14:17:42Z",
    "author_association": "MEMBER",
    "body": "@cammellos can't reproduce https://github.com/status-im/status-react/issues/7282#issuecomment-454709787 on https://github.com/status-im/status-react/pull/7285 on eth.staging. Tried around 10 times with different chats number, mailservers and network -  no success\r\n\r\nUPD: can't reproduce https://github.com/status-im/status-react/issues/7282#issuecomment-454709787 as well on `eth.staging` + 0.9.32, tried around 10 times.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/454733928/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
