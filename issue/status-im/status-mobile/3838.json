{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/3838",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/3838/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/3838/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/3838/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/3838",
  "id": 313319038,
  "node_id": "MDU6SXNzdWUzMTMzMTkwMzg=",
  "number": 3838,
  "title": "Move to yarn instead of npm",
  "user": {
    "login": "cammellos",
    "id": 1017008,
    "node_id": "MDQ6VXNlcjEwMTcwMDg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1017008?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cammellos",
    "html_url": "https://github.com/cammellos",
    "followers_url": "https://api.github.com/users/cammellos/followers",
    "following_url": "https://api.github.com/users/cammellos/following{/other_user}",
    "gists_url": "https://api.github.com/users/cammellos/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cammellos/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cammellos/subscriptions",
    "organizations_url": "https://api.github.com/users/cammellos/orgs",
    "repos_url": "https://api.github.com/users/cammellos/repos",
    "events_url": "https://api.github.com/users/cammellos/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cammellos/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 523025415,
      "node_id": "MDU6TGFiZWw1MjMwMjU0MTU=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bounty",
      "name": "bounty",
      "color": "FAFAD2",
      "default": false,
      "description": null
    },
    {
      "id": 755561122,
      "node_id": "MDU6TGFiZWw3NTU1NjExMjI=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bounty-s",
      "name": "bounty-s",
      "color": "89cbe5",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2018-04-11T13:15:45Z",
  "updated_at": "2018-11-29T15:30:31Z",
  "closed_at": "2018-11-29T15:30:31Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "[comment]: # (Please replace ... with your information. Remove < and >)\r\n\r\n### User Story\r\n\r\nAs a developer,\r\nI would like to use yarn instead of npm,\r\nbecause it's faster (in our case) and does not get stuck installing packages\r\n\r\n### Description\r\n\r\nWe agreed to move to yarn instead of npm.\r\n\r\nWe tried to do so but failed as we were not able to build a release in a reasonable amount of time.\r\n\r\nMoving to yarn is a trivial code change, but after:\r\n`lein prod-build`\r\n\r\nand\r\n\r\n`cd android && ./gradlew assembleRelease`\r\n\r\nit would take a very long time to create the artifact, around 6 hrs on my local machine ( compared to 6 minutes when installing packages through npm). \r\n\r\nThis has been replicated locally, on docker and on the macos build server.\r\n\r\nThe steps that fails is `app:bundleReleaseJsAndAssets`.\r\n\r\nWe see `jest-worker` hogging the CPU at 100%, memory consumption is also quite high, once it actually failed because the node engine could not allocate memory.\r\n\r\n### A few scattered thoughts that might help\r\n\r\nThere are a few issues (some closed) https://github.com/facebook/react-native/issues/11696 which seems to indicate that it's bundling files that it should not be (realm files for example).\r\n\r\nSome people mentioned `.babelrc` was the culprit, but did not elaborate any further.\r\n\r\n### What we tried, but did not work\r\n\r\nIncrease node memory from 4GB to 8GB\r\nIncrease gradlew memory from 1GB to 4GB\r\nAdd `___tests__` to `inputExcludes` in `android/app/react.gradle`\r\nDecrease the number of `jest-workers`\r\n\r\nCurrently we don't have the bandwidth to look into this any further, but if anyone wants to have a go at this it would be helpful.\r\n\r\n",
  "closed_by": {
    "login": "mandrigin",
    "id": 466427,
    "node_id": "MDQ6VXNlcjQ2NjQyNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/466427?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mandrigin",
    "html_url": "https://github.com/mandrigin",
    "followers_url": "https://api.github.com/users/mandrigin/followers",
    "following_url": "https://api.github.com/users/mandrigin/following{/other_user}",
    "gists_url": "https://api.github.com/users/mandrigin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mandrigin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mandrigin/subscriptions",
    "organizations_url": "https://api.github.com/users/mandrigin/orgs",
    "repos_url": "https://api.github.com/users/mandrigin/repos",
    "events_url": "https://api.github.com/users/mandrigin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mandrigin/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/3838/reactions",
    "total_count": 7,
    "+1": 7,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/3838/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/380718872",
    "html_url": "https://github.com/status-im/status-mobile/issues/3838#issuecomment-380718872",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3838",
    "id": 380718872,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDcxODg3Mg==",
    "user": {
      "login": "andytudhope",
      "id": 13001517,
      "node_id": "MDQ6VXNlcjEzMDAxNTE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/13001517?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/andytudhope",
      "html_url": "https://github.com/andytudhope",
      "followers_url": "https://api.github.com/users/andytudhope/followers",
      "following_url": "https://api.github.com/users/andytudhope/following{/other_user}",
      "gists_url": "https://api.github.com/users/andytudhope/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/andytudhope/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andytudhope/subscriptions",
      "organizations_url": "https://api.github.com/users/andytudhope/orgs",
      "repos_url": "https://api.github.com/users/andytudhope/repos",
      "events_url": "https://api.github.com/users/andytudhope/events{/privacy}",
      "received_events_url": "https://api.github.com/users/andytudhope/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-12T08:18:51Z",
    "updated_at": "2018-04-12T08:18:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "@dbalatero got quite far with this before getting busy with his own work. Do you have any thoughts?\r\n\r\nReferences:  \r\nhttps://github.com/status-im/status-react/issues/2541\r\nhttps://github.com/status-im/status-react/pull/2649",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/380718872/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/380724468",
    "html_url": "https://github.com/status-im/status-mobile/issues/3838#issuecomment-380724468",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3838",
    "id": 380724468,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MDcyNDQ2OA==",
    "user": {
      "login": "cammellos",
      "id": 1017008,
      "node_id": "MDQ6VXNlcjEwMTcwMDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1017008?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cammellos",
      "html_url": "https://github.com/cammellos",
      "followers_url": "https://api.github.com/users/cammellos/followers",
      "following_url": "https://api.github.com/users/cammellos/following{/other_user}",
      "gists_url": "https://api.github.com/users/cammellos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cammellos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cammellos/subscriptions",
      "organizations_url": "https://api.github.com/users/cammellos/orgs",
      "repos_url": "https://api.github.com/users/cammellos/repos",
      "events_url": "https://api.github.com/users/cammellos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cammellos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-12T08:39:11Z",
    "updated_at": "2018-04-12T08:39:11Z",
    "author_association": "MEMBER",
    "body": "thanks @andytudhope \r\n#2541 is not an issue anymore, as we don't use rn-nodeify anymore I believe\r\n#2649 seems the same issue I believe, only happens on android",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/380724468/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/382730301",
    "html_url": "https://github.com/status-im/status-mobile/issues/3838#issuecomment-382730301",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3838",
    "id": 382730301,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MjczMDMwMQ==",
    "user": {
      "login": "status-open-bounty",
      "id": 33065743,
      "node_id": "MDQ6VXNlcjMzMDY1NzQz",
      "avatar_url": "https://avatars.githubusercontent.com/u/33065743?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/status-open-bounty",
      "html_url": "https://github.com/status-open-bounty",
      "followers_url": "https://api.github.com/users/status-open-bounty/followers",
      "following_url": "https://api.github.com/users/status-open-bounty/following{/other_user}",
      "gists_url": "https://api.github.com/users/status-open-bounty/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/status-open-bounty/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/status-open-bounty/subscriptions",
      "organizations_url": "https://api.github.com/users/status-open-bounty/orgs",
      "repos_url": "https://api.github.com/users/status-open-bounty/repos",
      "events_url": "https://api.github.com/users/status-open-bounty/events{/privacy}",
      "received_events_url": "https://api.github.com/users/status-open-bounty/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-19T13:15:09Z",
    "updated_at": "2018-10-09T01:42:31Z",
    "author_association": "NONE",
    "body": "Current balance: 0.0 ETH\nTokens: SNT: 880.00\nContract address: [0x19de46086225f3e3355c16344a07ef6e886cf95e](https://etherscan.io/address/0x19de46086225f3e3355c16344a07ef6e886cf95e)\n![QR Code](https://openbounty.status.im/qr/status-im/status-react/bounty/3838/0d4ca89ccf64a0bc02c113d39476f306d9797f569b9eba540a10c73a357e125e/qr.png)\nNetwork: Mainnet\nTo claim this bounty sign up at [https://openbounty.status.im](https://openbounty.status.im) and make sure to update your Ethereum address in `My Payment Details` so that the bounty is correctly allocated.\nTo fund it, send ETH or ERC20/ERC223 tokens to the contract address.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/382730301/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/407460855",
    "html_url": "https://github.com/status-im/status-mobile/issues/3838#issuecomment-407460855",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3838",
    "id": 407460855,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNzQ2MDg1NQ==",
    "user": {
      "login": "jeluard",
      "id": 359723,
      "node_id": "MDQ6VXNlcjM1OTcyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/359723?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jeluard",
      "html_url": "https://github.com/jeluard",
      "followers_url": "https://api.github.com/users/jeluard/followers",
      "following_url": "https://api.github.com/users/jeluard/following{/other_user}",
      "gists_url": "https://api.github.com/users/jeluard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jeluard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jeluard/subscriptions",
      "organizations_url": "https://api.github.com/users/jeluard/orgs",
      "repos_url": "https://api.github.com/users/jeluard/repos",
      "events_url": "https://api.github.com/users/jeluard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jeluard/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-24T16:04:10Z",
    "updated_at": "2018-07-24T16:04:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "Closing for now as it appears moving to yarn is not practical for us.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/407460855/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/407682998",
    "html_url": "https://github.com/status-im/status-mobile/issues/3838#issuecomment-407682998",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3838",
    "id": 407682998,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNzY4Mjk5OA==",
    "user": {
      "login": "jeluard",
      "id": 359723,
      "node_id": "MDQ6VXNlcjM1OTcyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/359723?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jeluard",
      "html_url": "https://github.com/jeluard",
      "followers_url": "https://api.github.com/users/jeluard/followers",
      "following_url": "https://api.github.com/users/jeluard/following{/other_user}",
      "gists_url": "https://api.github.com/users/jeluard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jeluard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jeluard/subscriptions",
      "organizations_url": "https://api.github.com/users/jeluard/orgs",
      "repos_url": "https://api.github.com/users/jeluard/repos",
      "events_url": "https://api.github.com/users/jeluard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jeluard/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-25T08:53:02Z",
    "updated_at": "2018-07-25T08:53:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "@alwx Can you share the gist of your findings?",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/407682998/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
