{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/4080",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/4080/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/4080/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/4080/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/4080",
  "id": 319384573,
  "node_id": "MDU6SXNzdWUzMTkzODQ1NzM=",
  "number": 4080,
  "title": "Require payment to mail server before connecting to it (hidden under flag)",
  "user": {
    "login": "oskarth",
    "id": 1552237,
    "node_id": "MDQ6VXNlcjE1NTIyMzc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1552237?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/oskarth",
    "html_url": "https://github.com/oskarth",
    "followers_url": "https://api.github.com/users/oskarth/followers",
    "following_url": "https://api.github.com/users/oskarth/following{/other_user}",
    "gists_url": "https://api.github.com/users/oskarth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/oskarth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/oskarth/subscriptions",
    "organizations_url": "https://api.github.com/users/oskarth/orgs",
    "repos_url": "https://api.github.com/users/oskarth/repos",
    "events_url": "https://api.github.com/users/oskarth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/oskarth/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 523025415,
      "node_id": "MDU6TGFiZWw1MjMwMjU0MTU=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bounty",
      "name": "bounty",
      "color": "FAFAD2",
      "default": false,
      "description": null
    },
    {
      "id": 755561415,
      "node_id": "MDU6TGFiZWw3NTU1NjE0MTU=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bounty-l",
      "name": "bounty-l",
      "color": "89cbe5",
      "default": false,
      "description": ""
    },
    {
      "id": 1067655928,
      "node_id": "MDU6TGFiZWwxMDY3NjU1OTI4",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/stale",
      "name": "stale",
      "color": "ffffff",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2018-05-02T01:50:37Z",
  "updated_at": "2018-12-07T09:09:43Z",
  "closed_at": "2018-12-07T09:09:43Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "# Problem\r\n\r\nUsers want maximum uptime, reliability and security in messaging. By offering mail servers as a paid resource, we allow them to choose one of many competing providers that best satisfies their needs.\r\n\r\nAs part of an MVP for this, we want to ask user to send a transaction to the mailserver's address before they connect to it.\r\n\r\n# Implementation\r\n\r\nWhen a user selects a mail server under advanced settings, they should first be prompted with a transaction screen. This transaction screen should have have a prefilled amount, address and gas limit., and transaction should be in STT (Status test token).\r\n\r\nFor the purposes of this issue, all of this can be hardcoded to some reasonable numbers. Say 5 SNT, a template address like 0xdeadbeef, etc. Later on this information will come from the mailserver (wnode) data, but for now this can be bound in a sample let binding.\r\n\r\nAll this flow should be hidden under a feature flag, see issue linked to in notes.\r\n\r\nThe transaction id returned upon completion of the transaction should be saved as part of the `save-wnode` call. Example spec: `wnode/payment <unspecified-map>` (see `status-im.ui.screens.offline-messaging-settings.db`). I.e. something like: `wnode/payment {:tx-id <TXID>}`. The specifics of this data format will be specified at a later stage, so whatever gets the job done and is least specified works.\r\n\r\nThis transaction id will then be used in `request-messages` call to mail server as proof of payment (later issue).\r\n\r\nIf transaction doesn't go through, the user should not be able to choose that wnode.\r\n\r\nThe flow is thus:\r\nClick mailserver -> Pay transaction screen -> Sign transaction -> Connect to wnode\r\n\r\n# Acceptance Criteria\r\n\r\nRules for the future PR to be accepted.\r\n\r\n- Prompt for payment upon connecting to wnode\r\n- Save transaction id to wnode\r\n- All behavioral changes hidden under a flag\r\n- No change in behavior when flag is off\r\n\r\n# Notes\r\n\r\n- https://ideas.status.im/ideas/168-paid-master-nodes/README - also see notes on running a mail server and getting test STT\r\n- https://github.com/status-im/status-react/issues/4003\r\n\r\n# Future Steps\r\n\r\nSteps which should be taken after this issue has been resolved.\r\n\r\n- Issue for capturing data in wnode data structure\r\n- Issue for intermediate screen(s), showing user what they are paying for, what happens next etc (UXR)\r\n- Issue for request message with proof of payment\r\n\r\n<blockquote><div>Status - Ideas</div><div><strong><a href=\"http://ideas.status.im/ideas/168-paid-master-nodes/README\">Paid master nodes</a></strong></div><div>Swarm Home. New, completed and in-progress features for Status.</div></blockquote>",
  "closed_by": {
    "login": "status-github-bot[bot]",
    "id": 35452227,
    "node_id": "MDM6Qm90MzU0NTIyMjc=",
    "avatar_url": "https://avatars.githubusercontent.com/in/8157?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/status-github-bot%5Bbot%5D",
    "html_url": "https://github.com/apps/status-github-bot",
    "followers_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/4080/reactions",
    "total_count": 3,
    "+1": 3,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/4080/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/385980594",
    "html_url": "https://github.com/status-im/status-mobile/issues/4080#issuecomment-385980594",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/4080",
    "id": 385980594,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTk4MDU5NA==",
    "user": {
      "login": "ConnorChristie",
      "id": 1206980,
      "node_id": "MDQ6VXNlcjEyMDY5ODA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1206980?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ConnorChristie",
      "html_url": "https://github.com/ConnorChristie",
      "followers_url": "https://api.github.com/users/ConnorChristie/followers",
      "following_url": "https://api.github.com/users/ConnorChristie/following{/other_user}",
      "gists_url": "https://api.github.com/users/ConnorChristie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ConnorChristie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ConnorChristie/subscriptions",
      "organizations_url": "https://api.github.com/users/ConnorChristie/orgs",
      "repos_url": "https://api.github.com/users/ConnorChristie/repos",
      "events_url": "https://api.github.com/users/ConnorChristie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ConnorChristie/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-02T13:38:47Z",
    "updated_at": "2018-05-02T13:38:47Z",
    "author_association": "NONE",
    "body": "I can start working on this issue :)",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/385980594/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/386187641",
    "html_url": "https://github.com/status-im/status-mobile/issues/4080#issuecomment-386187641",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/4080",
    "id": 386187641,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NjE4NzY0MQ==",
    "user": {
      "login": "oskarth",
      "id": 1552237,
      "node_id": "MDQ6VXNlcjE1NTIyMzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1552237?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oskarth",
      "html_url": "https://github.com/oskarth",
      "followers_url": "https://api.github.com/users/oskarth/followers",
      "following_url": "https://api.github.com/users/oskarth/following{/other_user}",
      "gists_url": "https://api.github.com/users/oskarth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oskarth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oskarth/subscriptions",
      "organizations_url": "https://api.github.com/users/oskarth/orgs",
      "repos_url": "https://api.github.com/users/oskarth/repos",
      "events_url": "https://api.github.com/users/oskarth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oskarth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-03T04:17:24Z",
    "updated_at": "2018-05-03T04:17:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "Great @ConnorChristie! Let me know if you have any questions.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/386187641/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/386300831",
    "html_url": "https://github.com/status-im/status-mobile/issues/4080#issuecomment-386300831",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/4080",
    "id": 386300831,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NjMwMDgzMQ==",
    "user": {
      "login": "ConnorChristie",
      "id": 1206980,
      "node_id": "MDQ6VXNlcjEyMDY5ODA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1206980?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ConnorChristie",
      "html_url": "https://github.com/ConnorChristie",
      "followers_url": "https://api.github.com/users/ConnorChristie/followers",
      "following_url": "https://api.github.com/users/ConnorChristie/following{/other_user}",
      "gists_url": "https://api.github.com/users/ConnorChristie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ConnorChristie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ConnorChristie/subscriptions",
      "organizations_url": "https://api.github.com/users/ConnorChristie/orgs",
      "repos_url": "https://api.github.com/users/ConnorChristie/repos",
      "events_url": "https://api.github.com/users/ConnorChristie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ConnorChristie/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-03T13:46:07Z",
    "updated_at": "2018-05-03T13:47:19Z",
    "author_association": "NONE",
    "body": "I do have one question, I am using the event from below to trigger the send transaction modal using an already filled out unsigned-transaction. My problem is that the event logic is using this id but I am unsure where that id gets generated and saved. Is there some way I can generate my own and save it?\r\n\r\nhttps://github.com/status-im/status-react/blob/de03fc2d6a8619860ee9333a787345dae84bca37/src/status_im/ui/screens/wallet/send/events.cljs#L106-L118",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/386300831/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/386577649",
    "html_url": "https://github.com/status-im/status-mobile/issues/4080#issuecomment-386577649",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/4080",
    "id": 386577649,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NjU3NzY0OQ==",
    "user": {
      "login": "ConnorChristie",
      "id": 1206980,
      "node_id": "MDQ6VXNlcjEyMDY5ODA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1206980?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ConnorChristie",
      "html_url": "https://github.com/ConnorChristie",
      "followers_url": "https://api.github.com/users/ConnorChristie/followers",
      "following_url": "https://api.github.com/users/ConnorChristie/following{/other_user}",
      "gists_url": "https://api.github.com/users/ConnorChristie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ConnorChristie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ConnorChristie/subscriptions",
      "organizations_url": "https://api.github.com/users/ConnorChristie/orgs",
      "repos_url": "https://api.github.com/users/ConnorChristie/repos",
      "events_url": "https://api.github.com/users/ConnorChristie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ConnorChristie/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-04T11:50:15Z",
    "updated_at": "2018-05-04T11:50:15Z",
    "author_association": "NONE",
    "body": "@oskarth Okay so I got past that issue and it was because I was calling that handler with an unsigned-transaction instead of a send-transaction. I am however running into another wall with obtaining the transaction hash upon sending. web3 offers a callback which contains the hash but there is nothing handling that in the code currently. And the other time the hash is obtained is in the `sign-request-queued` method but since I am opening a modal, I am unable to pass any callbacks to either the web3 method or the sign-request-queued method...\r\n\r\nIs there a strategy that would work in this case? Is there some way to listen for a db event and respond to that? Can I in-fact send a callback through to a modal? Thx!",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/386577649/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/388683416",
    "html_url": "https://github.com/status-im/status-mobile/issues/4080#issuecomment-388683416",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/4080",
    "id": 388683416,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4ODY4MzQxNg==",
    "user": {
      "login": "oskarth",
      "id": 1552237,
      "node_id": "MDQ6VXNlcjE1NTIyMzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1552237?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oskarth",
      "html_url": "https://github.com/oskarth",
      "followers_url": "https://api.github.com/users/oskarth/followers",
      "following_url": "https://api.github.com/users/oskarth/following{/other_user}",
      "gists_url": "https://api.github.com/users/oskarth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oskarth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oskarth/subscriptions",
      "organizations_url": "https://api.github.com/users/oskarth/orgs",
      "repos_url": "https://api.github.com/users/oskarth/repos",
      "events_url": "https://api.github.com/users/oskarth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oskarth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-14T02:57:38Z",
    "updated_at": "2018-05-14T02:57:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "(Conversation kept going in PR, above seems to have been addressed)",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/388683416/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/443137779",
    "html_url": "https://github.com/status-im/status-mobile/issues/4080#issuecomment-443137779",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/4080",
    "id": 443137779,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MzEzNzc3OQ==",
    "user": {
      "login": "status-github-bot[bot]",
      "id": 35452227,
      "node_id": "MDM6Qm90MzU0NTIyMjc=",
      "avatar_url": "https://avatars.githubusercontent.com/in/8157?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/status-github-bot%5Bbot%5D",
      "html_url": "https://github.com/apps/status-github-bot",
      "followers_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2018-11-30T09:04:22Z",
    "updated_at": "2018-11-30T09:04:22Z",
    "author_association": "NONE",
    "body": "This issue has been automatically marked as stale because it has not had recent activity. It will be closed if no further activity occurs. Thank you for your contributions.\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/443137779/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/445168849",
    "html_url": "https://github.com/status-im/status-mobile/issues/4080#issuecomment-445168849",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/4080",
    "id": 445168849,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NTE2ODg0OQ==",
    "user": {
      "login": "status-github-bot[bot]",
      "id": 35452227,
      "node_id": "MDM6Qm90MzU0NTIyMjc=",
      "avatar_url": "https://avatars.githubusercontent.com/in/8157?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/status-github-bot%5Bbot%5D",
      "html_url": "https://github.com/apps/status-github-bot",
      "followers_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/status-github-bot%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2018-12-07T09:09:42Z",
    "updated_at": "2018-12-07T09:09:42Z",
    "author_association": "NONE",
    "body": "This issue has been automatically closed. Please re-open if this issue is important to you.\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/445168849/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
