{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/2852",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/2852",
  "id": 285130671,
  "node_id": "MDU6SXNzdWUyODUxMzA2NzE=",
  "number": 2852,
  "title": "[Perf] User story 1: Time lags navigating through different app views after log in when user has a lot of sent/received messages ",
  "user": {
    "login": "Serhy",
    "id": 8749671,
    "node_id": "MDQ6VXNlcjg3NDk2NzE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8749671?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Serhy",
    "html_url": "https://github.com/Serhy",
    "followers_url": "https://api.github.com/users/Serhy/followers",
    "following_url": "https://api.github.com/users/Serhy/following{/other_user}",
    "gists_url": "https://api.github.com/users/Serhy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Serhy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Serhy/subscriptions",
    "organizations_url": "https://api.github.com/users/Serhy/orgs",
    "repos_url": "https://api.github.com/users/Serhy/repos",
    "events_url": "https://api.github.com/users/Serhy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Serhy/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 330296931,
      "node_id": "MDU6TGFiZWwzMzAyOTY5MzE=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    },
    {
      "id": 517247009,
      "node_id": "MDU6TGFiZWw1MTcyNDcwMDk=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/high-priority",
      "name": "high-priority",
      "color": "000000",
      "default": false,
      "description": null
    },
    {
      "id": 783781483,
      "node_id": "MDU6TGFiZWw3ODM3ODE0ODM=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/performance",
      "name": "performance",
      "color": "dd3bd8",
      "default": false,
      "description": null
    },
    {
      "id": 794860412,
      "node_id": "MDU6TGFiZWw3OTQ4NjA0MTI=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/release",
      "name": "release",
      "color": "30dcff",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "janherich",
    "id": 1910609,
    "node_id": "MDQ6VXNlcjE5MTA2MDk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1910609?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/janherich",
    "html_url": "https://github.com/janherich",
    "followers_url": "https://api.github.com/users/janherich/followers",
    "following_url": "https://api.github.com/users/janherich/following{/other_user}",
    "gists_url": "https://api.github.com/users/janherich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/janherich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/janherich/subscriptions",
    "organizations_url": "https://api.github.com/users/janherich/orgs",
    "repos_url": "https://api.github.com/users/janherich/repos",
    "events_url": "https://api.github.com/users/janherich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/janherich/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "janherich",
      "id": 1910609,
      "node_id": "MDQ6VXNlcjE5MTA2MDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1910609?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/janherich",
      "html_url": "https://github.com/janherich",
      "followers_url": "https://api.github.com/users/janherich/followers",
      "following_url": "https://api.github.com/users/janherich/following{/other_user}",
      "gists_url": "https://api.github.com/users/janherich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/janherich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/janherich/subscriptions",
      "organizations_url": "https://api.github.com/users/janherich/orgs",
      "repos_url": "https://api.github.com/users/janherich/repos",
      "events_url": "https://api.github.com/users/janherich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/janherich/received_events",
      "type": "User",
      "site_admin": false
    },
    {
      "login": "Serhy",
      "id": 8749671,
      "node_id": "MDQ6VXNlcjg3NDk2NzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8749671?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Serhy",
      "html_url": "https://github.com/Serhy",
      "followers_url": "https://api.github.com/users/Serhy/followers",
      "following_url": "https://api.github.com/users/Serhy/following{/other_user}",
      "gists_url": "https://api.github.com/users/Serhy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Serhy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Serhy/subscriptions",
      "organizations_url": "https://api.github.com/users/Serhy/orgs",
      "repos_url": "https://api.github.com/users/Serhy/repos",
      "events_url": "https://api.github.com/users/Serhy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Serhy/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 14,
  "created_at": "2017-12-29T17:48:25Z",
  "updated_at": "2018-01-19T16:30:11Z",
  "closed_at": "2018-01-19T09:56:01Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "***Type***: Bug\r\n\r\n***Summary***: When user logs in into account, application becomes unresponsive for some time. It depends from how many messages user sent or received - more messages cause more time for app to hung up.\r\nIt's also visible that application retrieves all the messages user sent/received in chats it had before log out.\r\nFor example, in my case with Samsung J7  I had user with about 150 received messages. With such amount, when I logged out and logged back in - it took ~3 minutes since I could with no lags navigate through different views (chats, Profile, Wallet etc). Below TF session session attached.\r\nOn video it's especially visible when Profile screen hides during 01:30-02:00.\r\n\r\nOn iPhone X it's also visible (50 sent messages is enough to have before log in to account) \r\n\r\nTF logs: https://app.testfairy.com/projects/4803622-status/builds/7397034/sessions/4/?accessToken=DCNt-8FbqXifdFksvbCKKRoFwlw\r\n\r\n### Expected behavior\r\nNo time lags while navigating through different app screens after user logged in\r\n\r\n### Actual behavior\r\nTime lags while navigating through different app screens after user logged in\r\n\r\n\r\n### Reproduction\r\n**Precondition**: User exist and has more than 100 messages sent/received (actually it's even enough 20 messages - depends from device)\r\n\r\n- Open Status\r\n- Log in to account\r\n- Navigate through different screen (Profile, 1-1 chat, Wallet, etc)\r\n\r\n### Additional Information\r\n* Status version: Develop 0.9.10-493-g77b966c8+\r\n* Operating System: Android 7.0 (Samsung J7 real device), iOS 11.1.2 (iPhone X)\r\n",
  "closed_by": {
    "login": "Serhy",
    "id": 8749671,
    "node_id": "MDQ6VXNlcjg3NDk2NzE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8749671?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Serhy",
    "html_url": "https://github.com/Serhy",
    "followers_url": "https://api.github.com/users/Serhy/followers",
    "following_url": "https://api.github.com/users/Serhy/following{/other_user}",
    "gists_url": "https://api.github.com/users/Serhy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Serhy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Serhy/subscriptions",
    "organizations_url": "https://api.github.com/users/Serhy/orgs",
    "repos_url": "https://api.github.com/users/Serhy/repos",
    "events_url": "https://api.github.com/users/Serhy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Serhy/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/2852/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/354656194",
    "html_url": "https://github.com/status-im/status-mobile/issues/2852#issuecomment-354656194",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852",
    "id": 354656194,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NDY1NjE5NA==",
    "user": {
      "login": "oskarth",
      "id": 1552237,
      "node_id": "MDQ6VXNlcjE1NTIyMzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1552237?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oskarth",
      "html_url": "https://github.com/oskarth",
      "followers_url": "https://api.github.com/users/oskarth/followers",
      "following_url": "https://api.github.com/users/oskarth/following{/other_user}",
      "gists_url": "https://api.github.com/users/oskarth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oskarth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oskarth/subscriptions",
      "organizations_url": "https://api.github.com/users/oskarth/orgs",
      "repos_url": "https://api.github.com/users/oskarth/repos",
      "events_url": "https://api.github.com/users/oskarth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oskarth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-01T14:31:35Z",
    "updated_at": "2018-01-01T14:31:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for this @Serhy! Will try to reproduce tomorrow.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/354656194/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/354713614",
    "html_url": "https://github.com/status-im/status-mobile/issues/2852#issuecomment-354713614",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852",
    "id": 354713614,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NDcxMzYxNA==",
    "user": {
      "login": "oskarth",
      "id": 1552237,
      "node_id": "MDQ6VXNlcjE1NTIyMzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1552237?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oskarth",
      "html_url": "https://github.com/oskarth",
      "followers_url": "https://api.github.com/users/oskarth/followers",
      "following_url": "https://api.github.com/users/oskarth/following{/other_user}",
      "gists_url": "https://api.github.com/users/oskarth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oskarth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oskarth/subscriptions",
      "organizations_url": "https://api.github.com/users/oskarth/orgs",
      "repos_url": "https://api.github.com/users/oskarth/repos",
      "events_url": "https://api.github.com/users/oskarth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oskarth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-02T07:26:09Z",
    "updated_at": "2018-01-02T07:26:31Z",
    "author_association": "CONTRIBUTOR",
    "body": "Able to reproduce on iPhone X, recent develop build.\r\n\r\n- Sent 100 messages to some test user\r\n- Logout and login again\r\n\r\n- Clicking Sign in takes ~3\r\n- Immediately clicking on the user chat takes 5s for screen to load\r\n- Clicking on other chat with ~3 messages takes maybe ~200ms\r\n- Subsequent clicks on bad chats are pretty much instant\r\n- Also notice scrolling quickly up through messages leads to a janky experience, at least first scroll\r\n\r\nSuspected culprit: realm loading of messages into memory\r\n\r\ncc @janherich FYI",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/354713614/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/354720614",
    "html_url": "https://github.com/status-im/status-mobile/issues/2852#issuecomment-354720614",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852",
    "id": 354720614,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NDcyMDYxNA==",
    "user": {
      "login": "oskarth",
      "id": 1552237,
      "node_id": "MDQ6VXNlcjE1NTIyMzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1552237?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oskarth",
      "html_url": "https://github.com/oskarth",
      "followers_url": "https://api.github.com/users/oskarth/followers",
      "following_url": "https://api.github.com/users/oskarth/following{/other_user}",
      "gists_url": "https://api.github.com/users/oskarth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oskarth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oskarth/subscriptions",
      "organizations_url": "https://api.github.com/users/oskarth/orgs",
      "repos_url": "https://api.github.com/users/oskarth/repos",
      "events_url": "https://api.github.com/users/oskarth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oskarth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-02T08:33:28Z",
    "updated_at": "2018-01-02T08:33:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "Did some further investigation to see where problem is.\r\n\r\n# Rough notes\r\n\r\nOn iPhone 6s simulator on latest develop.\r\n\r\n## A New chat\r\n\r\n1. Add contact, send one message, logout\r\n\r\n2. From click 'sign in' there are maybe ~50 events and can't copy paste, but nothing that takes crazy long time. Longest:\r\n\r\n360ms: add-contacts\r\n330ms: initialize-chats\r\n190ms: change-account-handler\r\n111ms: choose-predefined-expandable-height\r\n\r\n## B Same chat, ~20 messages:\r\n\r\n~100 events, same big ones:\r\n\r\nadd-contacts, initialize-chats, choose-predefined-exanpable-height\r\n\r\nBut a bunch in ~100ms range, most notably update-message-status\r\n\r\nFiltering by events it seems liek update-message-status happens for every single message, ~20+ events, and it ranges from 20ms to 160ms, so at 50ms average that's 1s right there. \r\n\r\nPlus after each update-message-status there is incoming-message, only about 5ms though.\r\n\r\nLogin takes ~9s, loading of messages instant\r\n\r\n## C Same chat, ~50 messages:\r\n\r\n14s to login\r\n\r\nUpdate-message-status ranging from 12ms to 200ms, and ~50 of them I(+ small incoming message).\r\n\r\n## Conclusion\r\n\r\nThree problems\r\n\r\n1) update-message-status blocks login\r\n2) update-message-status O(n), should batch\r\n3) update-message-status sometimes slow (200ms?!)",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/354720614/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/354779995",
    "html_url": "https://github.com/status-im/status-mobile/issues/2852#issuecomment-354779995",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852",
    "id": 354779995,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NDc3OTk5NQ==",
    "user": {
      "login": "janherich",
      "id": 1910609,
      "node_id": "MDQ6VXNlcjE5MTA2MDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1910609?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/janherich",
      "html_url": "https://github.com/janherich",
      "followers_url": "https://api.github.com/users/janherich/followers",
      "following_url": "https://api.github.com/users/janherich/following{/other_user}",
      "gists_url": "https://api.github.com/users/janherich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/janherich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/janherich/subscriptions",
      "organizations_url": "https://api.github.com/users/janherich/orgs",
      "repos_url": "https://api.github.com/users/janherich/repos",
      "events_url": "https://api.github.com/users/janherich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/janherich/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-02T14:40:21Z",
    "updated_at": "2018-01-02T14:40:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "@oskarth I investigated the issue and here are my findings:\r\nOn the sender side, `:update-message-status` indeed takes dominant chunk of the time when user logs in and a lot of messages are to be sent.\r\nThe handling of that event is very ineffective and clumpy in develop, it should be more efficient in my outstanding branch currently tested (https://github.com/status-im/status-react/pull/2807).\r\nIf even that will not be sufficient, I will introduce either async realm writes, or realm write batching (most probably combination of both).\r\nOn the receiver side, dominant time factor with lot of messages received is the `:send-seen!` + `:set-message-shown` events and those are a lot worse time wise then the sender situation, blocking chat for ~5 seconds (with 50 new received messages) even on iOS simulator !\r\nI'm afraid it's more complicated there as it seems to be tied to the protocol (`:send-seen!` always fires off new whisper ack message with `shh-keys/get-sym-key` call in message preparation) so I need to experiment with it little bit and isolate the most perf problematic part of code in that scenario.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/354779995/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/355332712",
    "html_url": "https://github.com/status-im/status-mobile/issues/2852#issuecomment-355332712",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852",
    "id": 355332712,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NTMzMjcxMg==",
    "user": {
      "login": "dmitryn",
      "id": 23836,
      "node_id": "MDQ6VXNlcjIzODM2",
      "avatar_url": "https://avatars.githubusercontent.com/u/23836?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dmitryn",
      "html_url": "https://github.com/dmitryn",
      "followers_url": "https://api.github.com/users/dmitryn/followers",
      "following_url": "https://api.github.com/users/dmitryn/following{/other_user}",
      "gists_url": "https://api.github.com/users/dmitryn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dmitryn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dmitryn/subscriptions",
      "organizations_url": "https://api.github.com/users/dmitryn/orgs",
      "repos_url": "https://api.github.com/users/dmitryn/repos",
      "events_url": "https://api.github.com/users/dmitryn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dmitryn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-04T16:43:39Z",
    "updated_at": "2018-01-04T17:11:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "One more easy/fast way to reproduce the issue:\r\n* Join #status public channel\r\n* Log out\r\n* Log in back\r\n* App is completely unresponsive (real device android or ios simulator)\r\n* Watch events spamming log file: `:incoming-message`, `:chat-received-message/add` \r\n .. wait for app to be responsive\r\n* Go to public chat\r\n* Bunch of `send-seen` events (@janherich already commented on that above)\r\n* App is unresponive again\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/355332712/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/355907979",
    "html_url": "https://github.com/status-im/status-mobile/issues/2852#issuecomment-355907979",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852",
    "id": 355907979,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NTkwNzk3OQ==",
    "user": {
      "login": "oskarth",
      "id": 1552237,
      "node_id": "MDQ6VXNlcjE1NTIyMzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1552237?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oskarth",
      "html_url": "https://github.com/oskarth",
      "followers_url": "https://api.github.com/users/oskarth/followers",
      "following_url": "https://api.github.com/users/oskarth/following{/other_user}",
      "gists_url": "https://api.github.com/users/oskarth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oskarth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oskarth/subscriptions",
      "organizations_url": "https://api.github.com/users/oskarth/orgs",
      "repos_url": "https://api.github.com/users/oskarth/repos",
      "events_url": "https://api.github.com/users/oskarth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oskarth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-08T08:37:20Z",
    "updated_at": "2018-01-08T08:37:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "Workaround, doesn't address underlying problem at all: https://github.com/status-im/status-react/pull/2941\r\n\r\nRoot problem: @janherich and @dmitryn are looking into it AFAIK. What do you guys think about splitting it into receiving /  sending problem? Since events etc are different. And maybe if there's a 3rd problem.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/355907979/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/356188378",
    "html_url": "https://github.com/status-im/status-mobile/issues/2852#issuecomment-356188378",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852",
    "id": 356188378,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NjE4ODM3OA==",
    "user": {
      "login": "oskarth",
      "id": 1552237,
      "node_id": "MDQ6VXNlcjE1NTIyMzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1552237?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oskarth",
      "html_url": "https://github.com/oskarth",
      "followers_url": "https://api.github.com/users/oskarth/followers",
      "following_url": "https://api.github.com/users/oskarth/following{/other_user}",
      "gists_url": "https://api.github.com/users/oskarth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oskarth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oskarth/subscriptions",
      "organizations_url": "https://api.github.com/users/oskarth/orgs",
      "repos_url": "https://api.github.com/users/oskarth/repos",
      "events_url": "https://api.github.com/users/oskarth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oskarth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-09T05:57:43Z",
    "updated_at": "2018-01-09T05:57:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "Also see https://github.com/status-im/status-react/pull/2941#issuecomment-356185956",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/356188378/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/356268910",
    "html_url": "https://github.com/status-im/status-mobile/issues/2852#issuecomment-356268910",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852",
    "id": 356268910,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NjI2ODkxMA==",
    "user": {
      "login": "churik",
      "id": 4557972,
      "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/churik",
      "html_url": "https://github.com/churik",
      "followers_url": "https://api.github.com/users/churik/followers",
      "following_url": "https://api.github.com/users/churik/following{/other_user}",
      "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
      "organizations_url": "https://api.github.com/users/churik/orgs",
      "repos_url": "https://api.github.com/users/churik/repos",
      "events_url": "https://api.github.com/users/churik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/churik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-09T12:20:51Z",
    "updated_at": "2018-01-09T12:20:51Z",
    "author_association": "MEMBER",
    "body": "App freezes when a lot unread messages come in background (~100 in my case)\r\n*Summary*: app freezes if a lot of messages (~100 in my case) come when app is in background.\r\nRelaunch doesn't help (3 attempts)\r\n\r\n### Expected behavior\r\napp is responsive; chats are synchronised;\r\n\r\n### Actual behavior\r\napp is unresponsive; only part of messages are synchronised (17 in my case)\r\n\r\n### Reproduction\r\n\r\n**Precondition**: \r\n- User A, User B, User C are contacts (different devices)\r\n- Status app (User A) is in background (during 1-6)\r\n\r\n1.  open Status (User B)\r\n2. log in to account\r\n3. start group chat with (add User A, User C)\r\n4.  send 30+ messages \r\n5. open 1-1 chat with User A, send 30+ messages\r\n6. repeat 1, 2, 5 with User C so User A has 30+ new messages in group chat, 30+ new messages in 1-1 chats (with User B, User C)\r\n7.  open Status (User A)\r\n8. try to navigate through different screens\r\n\r\n\r\n### Additional Information\r\n[comment]: # (Please do your best to fill this out.)\r\nNoticed that phone temperature increased from 28,7 to 33,3 degrees during 6 short sessions (up to 10 min each).\r\n* Status version: PR-2910 build (0.9.10-529-ga3f61690+ (2086) 09/01 - daily)\r\n* Operating System: Android 7.0 (Samsung Galxy S7 real device)\r\n  \r\n\r\n#### Logs\r\nTF session (after 6 relaunch): https://app.testfairy.com/projects/4803622-status/builds/7462315/sessions/8/?accessToken=y2XoMALLYD1Bc-MNvGRl7O/AqeU\r\n  ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/356268910/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/356309129",
    "html_url": "https://github.com/status-im/status-mobile/issues/2852#issuecomment-356309129",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852",
    "id": 356309129,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NjMwOTEyOQ==",
    "user": {
      "login": "churik",
      "id": 4557972,
      "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/churik",
      "html_url": "https://github.com/churik",
      "followers_url": "https://api.github.com/users/churik/followers",
      "following_url": "https://api.github.com/users/churik/following{/other_user}",
      "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
      "organizations_url": "https://api.github.com/users/churik/orgs",
      "repos_url": "https://api.github.com/users/churik/repos",
      "events_url": "https://api.github.com/users/churik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/churik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-09T15:02:55Z",
    "updated_at": "2018-01-09T15:02:55Z",
    "author_association": "MEMBER",
    "body": "@janherich it shouldn't be closed, I added comment here, it is reproducible in build with PR as well as in develop",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/356309129/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/356310181",
    "html_url": "https://github.com/status-im/status-mobile/issues/2852#issuecomment-356310181",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852",
    "id": 356310181,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NjMxMDE4MQ==",
    "user": {
      "login": "janherich",
      "id": 1910609,
      "node_id": "MDQ6VXNlcjE5MTA2MDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1910609?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/janherich",
      "html_url": "https://github.com/janherich",
      "followers_url": "https://api.github.com/users/janherich/followers",
      "following_url": "https://api.github.com/users/janherich/following{/other_user}",
      "gists_url": "https://api.github.com/users/janherich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/janherich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/janherich/subscriptions",
      "organizations_url": "https://api.github.com/users/janherich/orgs",
      "repos_url": "https://api.github.com/users/janherich/repos",
      "events_url": "https://api.github.com/users/janherich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/janherich/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-09T15:06:26Z",
    "updated_at": "2018-01-09T15:06:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "@churik My bad, the issue was automatically closed because the related PR was merged.\r\n  ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/356310181/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/357148634",
    "html_url": "https://github.com/status-im/status-mobile/issues/2852#issuecomment-357148634",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852",
    "id": 357148634,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzE0ODYzNA==",
    "user": {
      "login": "oskarth",
      "id": 1552237,
      "node_id": "MDQ6VXNlcjE1NTIyMzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1552237?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oskarth",
      "html_url": "https://github.com/oskarth",
      "followers_url": "https://api.github.com/users/oskarth/followers",
      "following_url": "https://api.github.com/users/oskarth/following{/other_user}",
      "gists_url": "https://api.github.com/users/oskarth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oskarth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oskarth/subscriptions",
      "organizations_url": "https://api.github.com/users/oskarth/orgs",
      "repos_url": "https://api.github.com/users/oskarth/repos",
      "events_url": "https://api.github.com/users/oskarth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oskarth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-12T05:44:51Z",
    "updated_at": "2018-01-12T05:44:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "> \"can't verify because more critical blocks it https://github.com/status-im/status-react/issues/2990 Lags and app crash if have two 1-1 chats [Android, release]:\r\nbecause on Android app crashes even without lots of messages in 1-2 minutes after launch\r\nso canâ€™t test lags are better or not for more advanced scenario \" -- Anna",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/357148634/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/357669558",
    "html_url": "https://github.com/status-im/status-mobile/issues/2852#issuecomment-357669558",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852",
    "id": 357669558,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzY2OTU1OA==",
    "user": {
      "login": "Serhy",
      "id": 8749671,
      "node_id": "MDQ6VXNlcjg3NDk2NzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8749671?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Serhy",
      "html_url": "https://github.com/Serhy",
      "followers_url": "https://api.github.com/users/Serhy/followers",
      "following_url": "https://api.github.com/users/Serhy/following{/other_user}",
      "gists_url": "https://api.github.com/users/Serhy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Serhy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Serhy/subscriptions",
      "organizations_url": "https://api.github.com/users/Serhy/orgs",
      "repos_url": "https://api.github.com/users/Serhy/repos",
      "events_url": "https://api.github.com/users/Serhy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Serhy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-15T12:28:37Z",
    "updated_at": "2018-01-15T12:28:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "Tested this with latest release version (Android: http://artifacts.status.im:8081/artifactory/nightlies-local/im.status.ethereum-132082.apk\r\n iOS: https://i.diawi.com/fHejaj) on Samsung J7 (Android 7.0 real device) and iPhoneX. \r\n\r\nUnfortunately, I can't say it became better. \r\nOn Android device with the user having ~170 text/emoji messages (only 1-1 chats used) - after log in almost freezing the app for 35-40 seconds. \r\nTF session: https://app.testfairy.com/projects/4803622-status/builds/7490826/sessions/21/?accessToken=M6-kUEyoZtzAAwNj2cWFkvrVCVY -> check there 00:50 - 01:30 time interval. App is unresponsive. \r\n\r\nSame with iPhoneX.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/357669558/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/358262443",
    "html_url": "https://github.com/status-im/status-mobile/issues/2852#issuecomment-358262443",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852",
    "id": 358262443,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1ODI2MjQ0Mw==",
    "user": {
      "login": "oskarth",
      "id": 1552237,
      "node_id": "MDQ6VXNlcjE1NTIyMzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1552237?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oskarth",
      "html_url": "https://github.com/oskarth",
      "followers_url": "https://api.github.com/users/oskarth/followers",
      "following_url": "https://api.github.com/users/oskarth/following{/other_user}",
      "gists_url": "https://api.github.com/users/oskarth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oskarth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oskarth/subscriptions",
      "organizations_url": "https://api.github.com/users/oskarth/orgs",
      "repos_url": "https://api.github.com/users/oskarth/repos",
      "events_url": "https://api.github.com/users/oskarth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oskarth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-17T10:28:44Z",
    "updated_at": "2018-01-17T10:28:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "@Serhy Can \r\n\r\n> On Android device with the user having ~170 text/emoji messages (only 1-1 chats used) - after log in almost freezing the app for 35-40 seconds.\r\nTF session: https://app.testfairy.com/projects/4803622-status/builds/7490826/sessions/21/?accessToken=M6-kUEyoZtzAAwNj2cWFkvrVCVY -> check there 00:50 - 01:30 time interval. App is unresponsive.\r\n\r\nbe reproduced on 0.9.12? What is behavior there?",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/358262443/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/358277163",
    "html_url": "https://github.com/status-im/status-mobile/issues/2852#issuecomment-358277163",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/2852",
    "id": 358277163,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1ODI3NzE2Mw==",
    "user": {
      "login": "Serhy",
      "id": 8749671,
      "node_id": "MDQ6VXNlcjg3NDk2NzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8749671?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Serhy",
      "html_url": "https://github.com/Serhy",
      "followers_url": "https://api.github.com/users/Serhy/followers",
      "following_url": "https://api.github.com/users/Serhy/following{/other_user}",
      "gists_url": "https://api.github.com/users/Serhy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Serhy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Serhy/subscriptions",
      "organizations_url": "https://api.github.com/users/Serhy/orgs",
      "repos_url": "https://api.github.com/users/Serhy/repos",
      "events_url": "https://api.github.com/users/Serhy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Serhy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-17T11:29:35Z",
    "updated_at": "2018-01-17T11:29:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "On 0.9.12 it looks really well. I can't say this issue is a problem on 0.9.12.\r\n\r\nWith >150 messages after log in on 0.9.12 I almost don't see lags - navigation through different screens not laggy (well lags are up to 1 second) on Samsung J7 (same device used when reported the issue)",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/358277163/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
