{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/16373",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/16373/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/16373/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/16373/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/16373",
  "id": 1771574478,
  "node_id": "I_kwDOAx4p2c5pmBTO",
  "number": 16373,
  "title": "Differences at admin options between desktop and mobile clients (Pin message, Leave community)",
  "user": {
    "login": "churik",
    "id": 4557972,
    "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/churik",
    "html_url": "https://github.com/churik",
    "followers_url": "https://api.github.com/users/churik/followers",
    "following_url": "https://api.github.com/users/churik/following{/other_user}",
    "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
    "organizations_url": "https://api.github.com/users/churik/orgs",
    "repos_url": "https://api.github.com/users/churik/repos",
    "events_url": "https://api.github.com/users/churik/events{/privacy}",
    "received_events_url": "https://api.github.com/users/churik/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 330296931,
      "node_id": "MDU6TGFiZWwzMzAyOTY5MzE=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "cammellos",
    "id": 1017008,
    "node_id": "MDQ6VXNlcjEwMTcwMDg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1017008?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cammellos",
    "html_url": "https://github.com/cammellos",
    "followers_url": "https://api.github.com/users/cammellos/followers",
    "following_url": "https://api.github.com/users/cammellos/following{/other_user}",
    "gists_url": "https://api.github.com/users/cammellos/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cammellos/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cammellos/subscriptions",
    "organizations_url": "https://api.github.com/users/cammellos/orgs",
    "repos_url": "https://api.github.com/users/cammellos/repos",
    "events_url": "https://api.github.com/users/cammellos/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cammellos/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "cammellos",
      "id": 1017008,
      "node_id": "MDQ6VXNlcjEwMTcwMDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1017008?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cammellos",
      "html_url": "https://github.com/cammellos",
      "followers_url": "https://api.github.com/users/cammellos/followers",
      "following_url": "https://api.github.com/users/cammellos/following{/other_user}",
      "gists_url": "https://api.github.com/users/cammellos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cammellos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cammellos/subscriptions",
      "organizations_url": "https://api.github.com/users/cammellos/orgs",
      "repos_url": "https://api.github.com/users/cammellos/repos",
      "events_url": "https://api.github.com/users/cammellos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cammellos/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-06-23T14:36:18Z",
  "updated_at": "2023-07-07T08:39:34Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "# Bug Report\r\n\r\n\r\n## Problem \r\nAfter changing in recent status-go on status mobile there is no option for the community admin to pin messages and \"Leave community\" is available for them (it was not previously)\r\n\r\n\r\n#### Expected behavior\r\n- admin can't \"Leave community\"\r\n- admin can pin message\r\n\r\n#### Actual behavior\r\n- \"Leave community\" is available for community admin (on mobile only)\r\n- no pin message is available for community admin\r\n\r\n\r\n### Reproduction\r\n\r\nOn Desktop (master 22/06/23):\r\n- create user, create a community (\"Any member can pin a message\" is off)\r\nOn mobile (nightly 23/06/23):\r\n- sign in, using QR from Desktop\r\n- long tap > check options for community\r\n- send any message and try to pin it\r\n\r\n### Additional Information\r\n\r\n- Status version: nightly 23/06/23\r\n- Operating System: Android, iOS\r\n\r\n\r\n[comment]: # (Please, add logs/notes if necessary)\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/16373/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/16373/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1621272499",
    "html_url": "https://github.com/status-im/status-mobile/issues/16373#issuecomment-1621272499",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/16373",
    "id": 1621272499,
    "node_id": "IC_kwDOAx4p2c5goqez",
    "user": {
      "login": "yqrashawn",
      "id": 15090582,
      "node_id": "MDQ6VXNlcjE1MDkwNTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/15090582?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yqrashawn",
      "html_url": "https://github.com/yqrashawn",
      "followers_url": "https://api.github.com/users/yqrashawn/followers",
      "following_url": "https://api.github.com/users/yqrashawn/following{/other_user}",
      "gists_url": "https://api.github.com/users/yqrashawn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yqrashawn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yqrashawn/subscriptions",
      "organizations_url": "https://api.github.com/users/yqrashawn/orgs",
      "repos_url": "https://api.github.com/users/yqrashawn/repos",
      "events_url": "https://api.github.com/users/yqrashawn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yqrashawn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-05T08:21:47Z",
    "updated_at": "2023-07-05T08:21:47Z",
    "author_association": "MEMBER",
    "body": "Encountered while working on another issue\r\n\r\nmobile leave and pin use `:admin` key in community to check for admin https://github.com/status-im/status-mobile/blob/c8fb0f7274b2de20388f1e84ee7a67932a2302fe/src/status_im2/contexts/communities/actions/community_options/view.cljs#L146\r\n```clj\r\n(defn get-context-drawers\r\n  [{:keys [id]}]\r\n  (let [{:keys [token-permissions admin joined\r\n                muted banList]} (rf/sub [:communities/community id])\r\n        request-id              (rf/sub [:communities/my-pending-request-to-join id])]\r\n    (cond\r\n      admin      (owner-options id token-permissions muted)\r\n      joined     (joined-options id token-permissions muted)\r\n      request-id (join-request-sent-options id token-permissions request-id)\r\n      banList    (banned-options id token-permissions)\r\n      :else      (not-joined-options id token-permissions))))\r\n```\r\n\r\nbut there's no `:admin` key in community https://github.com/status-im/status-go/blob/4adbacdfe8ed0ed8d5377a7fb04b811ff339fdb4/protocol/communities/community.go#L190\r\n```go\r\nfunc (o *Community) MarshalJSON() ([]byte, error) {\r\n\tif o.config.MemberIdentity == nil {\r\n\t\treturn nil, errors.New(\"member identity not set\")\r\n\t}\r\n\tcommunityItem := struct {\r\n\t\tID                          types.HexBytes                                `json:\"id\"`\r\n\t\tMemberRole                  protobuf.CommunityMember_Roles                `json:\"memberRole\"`\r\n\t\tVerified                    bool                                          `json:\"verified\"`\r\n\t\tJoined                      bool                                          `json:\"joined\"`\r\n\t\tSpectated                   bool                                          `json:\"spectated\"`\r\n\t\tRequestedAccessAt           int                                           `json:\"requestedAccessAt\"`\r\n\t\tName                        string                                        `json:\"name\"`\r\n\t\tDescription                 string                                        `json:\"description\"`\r\n\t\tIntroMessage                string                                        `json:\"introMessage\"`\r\n\t\tOutroMessage                string                                        `json:\"outroMessage\"`\r\n\t\tTags                        []CommunityTag                                `json:\"tags\"`\r\n\t\tChats                       map[string]CommunityChat                      `json:\"chats\"`\r\n\t\tCategories                  map[string]CommunityCategory                  `json:\"categories\"`\r\n\t\tImages                      map[string]images.IdentityImage               `json:\"images\"`\r\n\t\tPermissions                 *protobuf.CommunityPermissions                `json:\"permissions\"`\r\n\t\tMembers                     map[string]*protobuf.CommunityMember          `json:\"members\"`\r\n\t\tCanRequestAccess            bool                                          `json:\"canRequestAccess\"`\r\n\t\tCanManageUsers              bool                                          `json:\"canManageUsers\"`              //TODO: we can remove this\r\n\t\tCanDeleteMessageForEveryone bool                                          `json:\"canDeleteMessageForEveryone\"` //TODO: we can remove this\r\n\t\tCanJoin                     bool                                          `json:\"canJoin\"`\r\n\t\tColor                       string                                        `json:\"color\"`\r\n\t\tRequestedToJoinAt           uint64                                        `json:\"requestedToJoinAt,omitempty\"`\r\n\t\tIsMember                    bool                                          `json:\"isMember\"`\r\n\t\tMuted                       bool                                          `json:\"muted\"`\r\n\t\tMuteTill                    time.Time                                     `json:\"muteTill,omitempty\"`\r\n\t\tCommunityAdminSettings      CommunityAdminSettings                        `json:\"adminSettings\"`\r\n\t\tEncrypted                   bool                                          `json:\"encrypted\"`\r\n\t\tBanList                     []string                                      `json:\"banList\"`\r\n\t\tTokenPermissions            map[string]*protobuf.CommunityTokenPermission `json:\"tokenPermissions\"`\r\n\t\tCommunityTokensMetadata     []*protobuf.CommunityTokenMetadata            `json:\"communityTokensMetadata\"`\r\n\t\tActiveMembersCount          uint64                                        `json:\"activeMembersCount\"`\r\n\t}{\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1621272499/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1625057434",
    "html_url": "https://github.com/status-im/status-mobile/issues/16373#issuecomment-1625057434",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/16373",
    "id": 1625057434,
    "node_id": "IC_kwDOAx4p2c5g3Gia",
    "user": {
      "login": "VladimrLitvinenko",
      "id": 52490791,
      "node_id": "MDQ6VXNlcjUyNDkwNzkx",
      "avatar_url": "https://avatars.githubusercontent.com/u/52490791?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/VladimrLitvinenko",
      "html_url": "https://github.com/VladimrLitvinenko",
      "followers_url": "https://api.github.com/users/VladimrLitvinenko/followers",
      "following_url": "https://api.github.com/users/VladimrLitvinenko/following{/other_user}",
      "gists_url": "https://api.github.com/users/VladimrLitvinenko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/VladimrLitvinenko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/VladimrLitvinenko/subscriptions",
      "organizations_url": "https://api.github.com/users/VladimrLitvinenko/orgs",
      "repos_url": "https://api.github.com/users/VladimrLitvinenko/repos",
      "events_url": "https://api.github.com/users/VladimrLitvinenko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/VladimrLitvinenko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-07T08:38:56Z",
    "updated_at": "2023-07-07T08:39:34Z",
    "author_association": "NONE",
    "body": "## NOTE FOR QA:\r\nRecheck, please the pinned messages styling in the community https://www.figma.com/file/PPWkgOYlZZDxZv5SDGsZVV/Posts-%26-Attachments-for-Mobile?type=design&mode=design&t=oirUpi5yfdydJGYl-0 implemented here https://github.com/status-im/status-mobile/pull/16498",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1625057434/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
