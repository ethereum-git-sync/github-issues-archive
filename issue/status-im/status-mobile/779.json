{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/779",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/779/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/779/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/779/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/779",
  "id": 204417313,
  "node_id": "MDU6SXNzdWUyMDQ0MTczMTM=",
  "number": 779,
  "title": "Move command-content to js files",
  "user": {
    "login": "alwx",
    "id": 911127,
    "node_id": "MDQ6VXNlcjkxMTEyNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/911127?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alwx",
    "html_url": "https://github.com/alwx",
    "followers_url": "https://api.github.com/users/alwx/followers",
    "following_url": "https://api.github.com/users/alwx/following{/other_user}",
    "gists_url": "https://api.github.com/users/alwx/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alwx/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alwx/subscriptions",
    "organizations_url": "https://api.github.com/users/alwx/orgs",
    "repos_url": "https://api.github.com/users/alwx/repos",
    "events_url": "https://api.github.com/users/alwx/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alwx/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 330296933,
      "node_id": "MDU6TGFiZWwzMzAyOTY5MzM=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/enhancement",
      "name": "enhancement",
      "color": "84b6eb",
      "default": true,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "alwx",
    "id": 911127,
    "node_id": "MDQ6VXNlcjkxMTEyNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/911127?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alwx",
    "html_url": "https://github.com/alwx",
    "followers_url": "https://api.github.com/users/alwx/followers",
    "following_url": "https://api.github.com/users/alwx/following{/other_user}",
    "gists_url": "https://api.github.com/users/alwx/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alwx/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alwx/subscriptions",
    "organizations_url": "https://api.github.com/users/alwx/orgs",
    "repos_url": "https://api.github.com/users/alwx/repos",
    "events_url": "https://api.github.com/users/alwx/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alwx/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "alwx",
      "id": 911127,
      "node_id": "MDQ6VXNlcjkxMTEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/911127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alwx",
      "html_url": "https://github.com/alwx",
      "followers_url": "https://api.github.com/users/alwx/followers",
      "following_url": "https://api.github.com/users/alwx/following{/other_user}",
      "gists_url": "https://api.github.com/users/alwx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alwx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alwx/subscriptions",
      "organizations_url": "https://api.github.com/users/alwx/orgs",
      "repos_url": "https://api.github.com/users/alwx/repos",
      "events_url": "https://api.github.com/users/alwx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alwx/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2017-01-31T20:40:40Z",
  "updated_at": "2017-03-01T22:15:24Z",
  "closed_at": "2017-03-01T22:15:24Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "There is a function called `command-content`, and the purpose of this function is to return a nice one-line preview for commands in chat list:\r\n\r\n![screen shot 2017-01-31 at 23 34 40](https://cloud.githubusercontent.com/assets/911127/22483354/ed32a6f6-e80d-11e6-9f7a-5b63a9ddd448.png)\r\n\r\nHere you can see `Transaction: 0.51234 ETH`, and this text comes from `status.i18n` namespace with the help of ` status-im.chats-list.views.inner-item/command-content` function. But this text should be placed in the same place where we store all information about commands â€” in JS files like `commands.js` and `console.js`",
  "closed_by": {
    "login": "rasom",
    "id": 2364994,
    "node_id": "MDQ6VXNlcjIzNjQ5OTQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2364994?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rasom",
    "html_url": "https://github.com/rasom",
    "followers_url": "https://api.github.com/users/rasom/followers",
    "following_url": "https://api.github.com/users/rasom/following{/other_user}",
    "gists_url": "https://api.github.com/users/rasom/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rasom/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rasom/subscriptions",
    "organizations_url": "https://api.github.com/users/rasom/orgs",
    "repos_url": "https://api.github.com/users/rasom/repos",
    "events_url": "https://api.github.com/users/rasom/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rasom/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/779/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/779/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/276989767",
    "html_url": "https://github.com/status-im/status-mobile/issues/779#issuecomment-276989767",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/779",
    "id": 276989767,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3Njk4OTc2Nw==",
    "user": {
      "login": "jumarko",
      "id": 1083629,
      "node_id": "MDQ6VXNlcjEwODM2Mjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1083629?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jumarko",
      "html_url": "https://github.com/jumarko",
      "followers_url": "https://api.github.com/users/jumarko/followers",
      "following_url": "https://api.github.com/users/jumarko/following{/other_user}",
      "gists_url": "https://api.github.com/users/jumarko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jumarko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jumarko/subscriptions",
      "organizations_url": "https://api.github.com/users/jumarko/orgs",
      "repos_url": "https://api.github.com/users/jumarko/repos",
      "events_url": "https://api.github.com/users/jumarko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jumarko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-02T15:32:02Z",
    "updated_at": "2017-02-02T15:32:02Z",
    "author_association": "NONE",
    "body": "I'd like to take a look at this.\r\nBtw. why is information about commands stored in javascript files?",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/276989767/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/276990172",
    "html_url": "https://github.com/status-im/status-mobile/issues/779#issuecomment-276990172",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/779",
    "id": 276990172,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3Njk5MDE3Mg==",
    "user": {
      "login": "0xc1c4da",
      "id": 2714786,
      "node_id": "MDQ6VXNlcjI3MTQ3ODY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2714786?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/0xc1c4da",
      "html_url": "https://github.com/0xc1c4da",
      "followers_url": "https://api.github.com/users/0xc1c4da/followers",
      "following_url": "https://api.github.com/users/0xc1c4da/following{/other_user}",
      "gists_url": "https://api.github.com/users/0xc1c4da/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/0xc1c4da/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0xc1c4da/subscriptions",
      "organizations_url": "https://api.github.com/users/0xc1c4da/orgs",
      "repos_url": "https://api.github.com/users/0xc1c4da/repos",
      "events_url": "https://api.github.com/users/0xc1c4da/events{/privacy}",
      "received_events_url": "https://api.github.com/users/0xc1c4da/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-02T15:33:25Z",
    "updated_at": "2017-02-02T15:33:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "because commands can be defined by 3rd party dapps",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/276990172/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/278372136",
    "html_url": "https://github.com/status-im/status-mobile/issues/779#issuecomment-278372136",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/779",
    "id": 278372136,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3ODM3MjEzNg==",
    "user": {
      "login": "jumarko",
      "id": 1083629,
      "node_id": "MDQ6VXNlcjEwODM2Mjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1083629?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jumarko",
      "html_url": "https://github.com/jumarko",
      "followers_url": "https://api.github.com/users/jumarko/followers",
      "following_url": "https://api.github.com/users/jumarko/following{/other_user}",
      "gists_url": "https://api.github.com/users/jumarko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jumarko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jumarko/subscriptions",
      "organizations_url": "https://api.github.com/users/jumarko/orgs",
      "repos_url": "https://api.github.com/users/jumarko/repos",
      "events_url": "https://api.github.com/users/jumarko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jumarko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-08T16:07:33Z",
    "updated_at": "2017-02-08T16:07:33Z",
    "author_association": "NONE",
    "body": "I spend quite a while by digging into the code base and my current understanding is as follows:\r\n* There are few places when commands are defined and it depends on the \"chat id\"\r\n   * \"console\" -> `console.js` Here are stored the commands for console, in particular commands \"phone\", \"faucet\", and \"browse\"\r\n   * \"wallet\" -> `wallet.js` Here are stored the commands for wallet - just command \"browse\"\r\n   * \"dapp\" -> `dapp.js` Here are stored the commands for dapps - just command \"browse\"\r\n   *  ELSE -> `commands.js` Here are stored commands for other chat ids, e.g. for the chat with a friend (added as a contact)\r\n* Aforementioned logic is implemented in handlers for ::fetch-commands! and ::validate-hash events\r\n* The short text that is shown in chat list overview (e.g. \"Transaction: 0.51234 ETH\") is currently stored in `i18n.cljs` and can be retrieved via `command-content` function\r\n* In order to extract \"command content\" from i18n.cljs to javascript files I need to add another Command field, let's call it `label`:\r\n  * The Command definition in `status.js` has to be updated\r\n  * label has to be added to commands in all javascript files (`console.js`, `wallet.js`, `dapp.js`, `commands.js`)\r\n  * value of command's label has to be loaded and parameterized in view using the value (e.g. amount) from the last message in a chat\r\n\r\n**Issues** (using the new approach):\r\n1. In order to get the `:label` for a command I need to have it available in view component `chat-list-item-inner-view`. \r\n  * I think this info should be in a \"chat\" map: `(:commands chat)`. However, the thing is that the commands are \"added\" into the chat map only when particular chat is opened (except the \"console\" chat, which is populated at application start). For other chats, e.g. \"wallet\", there's no such thing as `:commands` key in a chat map when I accessed the chats screen for the first time.\r\n  * I don't know how to handle this - lazy loading of chat's commands is probably a good thing but now I don't have a label which I could show to the user. \r\n2. parameter values in a label have to be expanded:\r\n  * e.g. \"Transaction: {{amount}} ETH\". \r\n  * Parameters are provided when a view is rendered and this is completely decoupled from the act of loading/parsing commands via API call to status-go (parse-jail). I cannot use something like `Location: {{address}}` in javascript files (e.g. \"commands.js\") because it'd be expanded (by I18n.t) to a string like \"Location: [missing ...]\". \r\n  * Thus I need to use different syntax (e.g. `Location: <<address>>`) and replace the parameter with actual value manually in `status_im/chats_list/views/inner_item.cljs`.\r\n\r\n@alwx Could you please check if I'm going in the right direction and correct me If I am wrong.\r\nMoreover, I'd love to know how to solve the first issue (unpopulated `:commands` field in a chat map).\r\nThank you!\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/278372136/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
