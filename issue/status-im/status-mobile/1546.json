{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/1546",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/1546/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/1546/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/1546/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/1546",
  "id": 247291982,
  "node_id": "MDU6SXNzdWUyNDcyOTE5ODI=",
  "number": 1546,
  "title": "API: scopes for commands",
  "user": {
    "login": "alwx",
    "id": 911127,
    "node_id": "MDQ6VXNlcjkxMTEyNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/911127?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alwx",
    "html_url": "https://github.com/alwx",
    "followers_url": "https://api.github.com/users/alwx/followers",
    "following_url": "https://api.github.com/users/alwx/following{/other_user}",
    "gists_url": "https://api.github.com/users/alwx/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alwx/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alwx/subscriptions",
    "organizations_url": "https://api.github.com/users/alwx/orgs",
    "repos_url": "https://api.github.com/users/alwx/repos",
    "events_url": "https://api.github.com/users/alwx/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alwx/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "alwx",
    "id": 911127,
    "node_id": "MDQ6VXNlcjkxMTEyNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/911127?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alwx",
    "html_url": "https://github.com/alwx",
    "followers_url": "https://api.github.com/users/alwx/followers",
    "following_url": "https://api.github.com/users/alwx/following{/other_user}",
    "gists_url": "https://api.github.com/users/alwx/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alwx/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alwx/subscriptions",
    "organizations_url": "https://api.github.com/users/alwx/orgs",
    "repos_url": "https://api.github.com/users/alwx/repos",
    "events_url": "https://api.github.com/users/alwx/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alwx/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "alwx",
      "id": 911127,
      "node_id": "MDQ6VXNlcjkxMTEyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/911127?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alwx",
      "html_url": "https://github.com/alwx",
      "followers_url": "https://api.github.com/users/alwx/followers",
      "following_url": "https://api.github.com/users/alwx/following{/other_user}",
      "gists_url": "https://api.github.com/users/alwx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alwx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alwx/subscriptions",
      "organizations_url": "https://api.github.com/users/alwx/orgs",
      "repos_url": "https://api.github.com/users/alwx/repos",
      "events_url": "https://api.github.com/users/alwx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alwx/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": {
    "url": "https://api.github.com/repos/status-im/status-mobile/milestones/17",
    "html_url": "https://github.com/status-im/status-mobile/milestone/17",
    "labels_url": "https://api.github.com/repos/status-im/status-mobile/milestones/17/labels",
    "id": 2850056,
    "node_id": "MDk6TWlsZXN0b25lMjg1MDA1Ng==",
    "number": 17,
    "title": "0.9.13",
    "description": "",
    "creator": {
      "login": "oskarth",
      "id": 1552237,
      "node_id": "MDQ6VXNlcjE1NTIyMzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1552237?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oskarth",
      "html_url": "https://github.com/oskarth",
      "followers_url": "https://api.github.com/users/oskarth/followers",
      "following_url": "https://api.github.com/users/oskarth/following{/other_user}",
      "gists_url": "https://api.github.com/users/oskarth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oskarth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oskarth/subscriptions",
      "organizations_url": "https://api.github.com/users/oskarth/orgs",
      "repos_url": "https://api.github.com/users/oskarth/repos",
      "events_url": "https://api.github.com/users/oskarth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oskarth/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 149,
    "state": "closed",
    "created_at": "2017-10-19T08:51:49Z",
    "updated_at": "2019-07-22T12:27:00Z",
    "due_on": null,
    "closed_at": "2018-05-17T18:15:11Z"
  },
  "comments": 2,
  "created_at": "2017-08-02T07:02:00Z",
  "updated_at": "2017-11-13T14:31:39Z",
  "closed_at": "2017-11-13T14:31:39Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Some commands should be available only for group chats, some — only for 1-to-1 chats. Some commands can be used when all participants in group chat are bots, and others cannot.\r\nWe can solve all these issues by introducing visibility scopes.\r\nMore importantly — there should be an ability to define two commands with the same name and different visibility scopes. This improvement will allow us to remove some parameters like `registeredOnly`, get rid of some hardcoded parts and also improve /send and /request commands (for instance, get rid of contact chooser in 1-to-1 chats).",
  "closed_by": {
    "login": "oskarth",
    "id": 1552237,
    "node_id": "MDQ6VXNlcjE1NTIyMzc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1552237?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/oskarth",
    "html_url": "https://github.com/oskarth",
    "followers_url": "https://api.github.com/users/oskarth/followers",
    "following_url": "https://api.github.com/users/oskarth/following{/other_user}",
    "gists_url": "https://api.github.com/users/oskarth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/oskarth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/oskarth/subscriptions",
    "organizations_url": "https://api.github.com/users/oskarth/orgs",
    "repos_url": "https://api.github.com/users/oskarth/repos",
    "events_url": "https://api.github.com/users/oskarth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/oskarth/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/1546/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/1546/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/319590451",
    "html_url": "https://github.com/status-im/status-mobile/issues/1546#issuecomment-319590451",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/1546",
    "id": 319590451,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxOTU5MDQ1MQ==",
    "user": {
      "login": "janherich",
      "id": 1910609,
      "node_id": "MDQ6VXNlcjE5MTA2MDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1910609?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/janherich",
      "html_url": "https://github.com/janherich",
      "followers_url": "https://api.github.com/users/janherich/followers",
      "following_url": "https://api.github.com/users/janherich/following{/other_user}",
      "gists_url": "https://api.github.com/users/janherich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/janherich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/janherich/subscriptions",
      "organizations_url": "https://api.github.com/users/janherich/orgs",
      "repos_url": "https://api.github.com/users/janherich/repos",
      "events_url": "https://api.github.com/users/janherich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/janherich/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-02T07:23:47Z",
    "updated_at": "2017-08-02T09:03:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @alwx when you are already working on this, there is one thing I need to share. The current way how commands are loaded in Status is very poor - when any command function taking message params (validator, preview, shortPreview) is registered through API, Status app loads them from Jail.VM not as a functions ready to be applied to message params, but already as results of function application to message params (which is happening in Jail.VM i guess). \r\nAs a result of this, the logic of loading commands is super complicated (you can't just load command, you need to load command (function) results for every contact/chat/message) and app-db is bloated with command-results for every message.\r\nSince the very short time I have been working on the project, I already encountered 2 bugs directly caused by this (the need to have command fn results loaded for every message).\r\nWhen you introduce command scoping, without addressing this issue, it will be even much worse.\r\n\r\nWhat I propose is to not fetch command results from jail and only use them as needed in Status (for example preview function will be used by subscription for messages ready to be rendered).\r\nWe will need to solve the issue of having to call Jail each time command fn is being called, I will try to investigate if this is viable option and if it wouldn't slow the application too much. ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/319590451/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/338627950",
    "html_url": "https://github.com/status-im/status-mobile/issues/1546#issuecomment-338627950",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/1546",
    "id": 338627950,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzODYyNzk1MA==",
    "user": {
      "login": "oskarth",
      "id": 1552237,
      "node_id": "MDQ6VXNlcjE1NTIyMzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1552237?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oskarth",
      "html_url": "https://github.com/oskarth",
      "followers_url": "https://api.github.com/users/oskarth/followers",
      "following_url": "https://api.github.com/users/oskarth/following{/other_user}",
      "gists_url": "https://api.github.com/users/oskarth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oskarth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oskarth/subscriptions",
      "organizations_url": "https://api.github.com/users/oskarth/orgs",
      "repos_url": "https://api.github.com/users/oskarth/repos",
      "events_url": "https://api.github.com/users/oskarth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oskarth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-23T11:21:51Z",
    "updated_at": "2017-10-23T11:21:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "@flexsurfer @alwx How come this is in 0.9.13 milestone? Hasn't this been fixed for 0.9.12 and can thus be closed? If there are enhancements I suggests these are captured in additional issues.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/338627950/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
