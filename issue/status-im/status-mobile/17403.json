{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/17403",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/17403/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/17403/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/17403/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/17403",
  "id": 1910573143,
  "node_id": "I_kwDOAx4p2c5x4QhX",
  "number": 17403,
  "title": "Tests fail after upgrading react-native to 0.72",
  "user": {
    "login": "siddarthkay",
    "id": 64726664,
    "node_id": "MDQ6VXNlcjY0NzI2NjY0",
    "avatar_url": "https://avatars.githubusercontent.com/u/64726664?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/siddarthkay",
    "html_url": "https://github.com/siddarthkay",
    "followers_url": "https://api.github.com/users/siddarthkay/followers",
    "following_url": "https://api.github.com/users/siddarthkay/following{/other_user}",
    "gists_url": "https://api.github.com/users/siddarthkay/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/siddarthkay/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/siddarthkay/subscriptions",
    "organizations_url": "https://api.github.com/users/siddarthkay/orgs",
    "repos_url": "https://api.github.com/users/siddarthkay/repos",
    "events_url": "https://api.github.com/users/siddarthkay/events{/privacy}",
    "received_events_url": "https://api.github.com/users/siddarthkay/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "siddarthkay",
    "id": 64726664,
    "node_id": "MDQ6VXNlcjY0NzI2NjY0",
    "avatar_url": "https://avatars.githubusercontent.com/u/64726664?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/siddarthkay",
    "html_url": "https://github.com/siddarthkay",
    "followers_url": "https://api.github.com/users/siddarthkay/followers",
    "following_url": "https://api.github.com/users/siddarthkay/following{/other_user}",
    "gists_url": "https://api.github.com/users/siddarthkay/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/siddarthkay/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/siddarthkay/subscriptions",
    "organizations_url": "https://api.github.com/users/siddarthkay/orgs",
    "repos_url": "https://api.github.com/users/siddarthkay/repos",
    "events_url": "https://api.github.com/users/siddarthkay/events{/privacy}",
    "received_events_url": "https://api.github.com/users/siddarthkay/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "siddarthkay",
      "id": 64726664,
      "node_id": "MDQ6VXNlcjY0NzI2NjY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/64726664?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/siddarthkay",
      "html_url": "https://github.com/siddarthkay",
      "followers_url": "https://api.github.com/users/siddarthkay/followers",
      "following_url": "https://api.github.com/users/siddarthkay/following{/other_user}",
      "gists_url": "https://api.github.com/users/siddarthkay/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/siddarthkay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/siddarthkay/subscriptions",
      "organizations_url": "https://api.github.com/users/siddarthkay/orgs",
      "repos_url": "https://api.github.com/users/siddarthkay/repos",
      "events_url": "https://api.github.com/users/siddarthkay/events{/privacy}",
      "received_events_url": "https://api.github.com/users/siddarthkay/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-09-25T03:11:37Z",
  "updated_at": "2023-09-25T05:11:26Z",
  "closed_at": "2023-09-25T05:11:25Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "# Problem\r\n\r\n`make test` fails with : \r\n```\r\nâœ¨  Done in 21.98s.\r\nINFO [09-24|22:43:00.229] Status backend initialized               backend=geth version= commit= IpfsGatewayURL=\r\nSHADOW import error /Users/siddarthkumar/code/experiments/status-mobile/target/test/cljs-runtime/quo.animated.js\r\n/Users/siddarthkumar/code/experiments/status-mobile/target/test/test.js:67\r\n    throw e;\r\n    ^\r\n\r\nError: Oops, Unexpected object value (undefined)\r\n    at /Users/siddarthkumar/code/experiments/status-mobile/target/test/cljs-runtime/quo.animated.js:175:102\r\n    at /Users/siddarthkumar/code/experiments/status-mobile/target/test/cljs-runtime/quo.animated.js:181:4\r\n    at global.SHADOW_IMPORT (/Users/siddarthkumar/code/experiments/status-mobile/target/test/test.js:64:44)\r\n    at /Users/siddarthkumar/code/experiments/status-mobile/target/test/test.js:1622:1\r\n    at Object.<anonymous> (/Users/siddarthkumar/code/experiments/status-mobile/target/test/test.js:2868:3)\r\n    at Module._compile (node:internal/modules/cjs/loader:1254:14)\r\n    at Module._extensions..js (node:internal/modules/cjs/loader:1308:10)\r\n    at Module.load (node:internal/modules/cjs/loader:1117:32)\r\n    at Module._load (node:internal/modules/cjs/loader:958:12)\r\n    at Function.hookedLoader [as _load] (/Users/siddarthkumar/code/experiments/status-mobile/test-resources/override.js:16:10) {\r\n  'cljs$core$IPrintWithWriter$': {},\r\n  'cljs$core$IPrintWithWriter$_pr_writer$arity$3': [Function (anonymous)]\r\n}\r\n\r\nNode.js v18.16.0\r\nmake: *** [test] Error 1\r\n```\r\n\r\nfirst observed here : https://github.com/status-im/status-mobile/pull/17241#issuecomment-1714981272\r\n\r\n## Notes: \r\n- Issue could be related to metro being updated along side of react-native.\r\n- Issue is not related to node version.\r\n- Issue is not related to clojurescript version.\r\n- Issue could be related to `shadow-cljs.edn` file\r\n\r\nlinks that seem related : \r\n- https://github.com/thheller/shadow-cljs/issues/1084\r\n- https://github.com/google/closure-compiler/wiki/JS-Modules#dynamic-import-expressions\r\n- https://github.com/google/closure-compiler/pull/3204\r\n\r\nblocks [react native and other](https://github.com/status-im/status-mobile/pull/17241)\r\n",
  "closed_by": {
    "login": "siddarthkay",
    "id": 64726664,
    "node_id": "MDQ6VXNlcjY0NzI2NjY0",
    "avatar_url": "https://avatars.githubusercontent.com/u/64726664?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/siddarthkay",
    "html_url": "https://github.com/siddarthkay",
    "followers_url": "https://api.github.com/users/siddarthkay/followers",
    "following_url": "https://api.github.com/users/siddarthkay/following{/other_user}",
    "gists_url": "https://api.github.com/users/siddarthkay/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/siddarthkay/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/siddarthkay/subscriptions",
    "organizations_url": "https://api.github.com/users/siddarthkay/orgs",
    "repos_url": "https://api.github.com/users/siddarthkay/repos",
    "events_url": "https://api.github.com/users/siddarthkay/events{/privacy}",
    "received_events_url": "https://api.github.com/users/siddarthkay/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/17403/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/17403/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1732903943",
    "html_url": "https://github.com/status-im/status-mobile/issues/17403#issuecomment-1732903943",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/17403",
    "id": 1732903943,
    "node_id": "IC_kwDOAx4p2c5nSgQH",
    "user": {
      "login": "siddarthkay",
      "id": 64726664,
      "node_id": "MDQ6VXNlcjY0NzI2NjY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/64726664?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/siddarthkay",
      "html_url": "https://github.com/siddarthkay",
      "followers_url": "https://api.github.com/users/siddarthkay/followers",
      "following_url": "https://api.github.com/users/siddarthkay/following{/other_user}",
      "gists_url": "https://api.github.com/users/siddarthkay/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/siddarthkay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/siddarthkay/subscriptions",
      "organizations_url": "https://api.github.com/users/siddarthkay/orgs",
      "repos_url": "https://api.github.com/users/siddarthkay/repos",
      "events_url": "https://api.github.com/users/siddarthkay/events{/privacy}",
      "received_events_url": "https://api.github.com/users/siddarthkay/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-25T04:50:33Z",
    "updated_at": "2023-09-25T04:50:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "I generally stay away from compiled code but looking at `status-mobile/target/test/cljs-runtime/quo.animated.js:175:102`\r\n\r\nI see \r\n`quo.animated.extrapolate = new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,\"clamp\",\"clamp\",1803814940),(function (){var target_obj_20183 = shadow.js.shim.module$react_native_reanimated.Extrapolate;\r\nvar _STAR_runtime_state_STAR__orig_val__20185 = oops.state._STAR_runtime_state_STAR_;\r\nvar _STAR_runtime_state_STAR__temp_val__20186 = oops.state.prepare_state.call(null,target_obj_20183,(new Error()),function(){arguments[0].apply(console,Array.prototype.slice.call(arguments,1))});\r\n(oops.state._STAR_runtime_state_STAR_ = _STAR_runtime_state_STAR__temp_val__20186);\r\n`\r\nThis could be related to the aggressive nuking of re-animated v1 code  here : https://github.com/status-im/status-mobile/pull/16721/commits/9a90592a727ccc766de5509ab4aaa3f6bcb2d829#diff-099675f8cad1cec308b38dbcf3669126954c37da034fe2f8ae4df841c54fa94a",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1732903943/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1732923540",
    "html_url": "https://github.com/status-im/status-mobile/issues/17403#issuecomment-1732923540",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/17403",
    "id": 1732923540,
    "node_id": "IC_kwDOAx4p2c5nSlCU",
    "user": {
      "login": "siddarthkay",
      "id": 64726664,
      "node_id": "MDQ6VXNlcjY0NzI2NjY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/64726664?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/siddarthkay",
      "html_url": "https://github.com/siddarthkay",
      "followers_url": "https://api.github.com/users/siddarthkay/followers",
      "following_url": "https://api.github.com/users/siddarthkay/following{/other_user}",
      "gists_url": "https://api.github.com/users/siddarthkay/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/siddarthkay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/siddarthkay/subscriptions",
      "organizations_url": "https://api.github.com/users/siddarthkay/orgs",
      "repos_url": "https://api.github.com/users/siddarthkay/repos",
      "events_url": "https://api.github.com/users/siddarthkay/events{/privacy}",
      "received_events_url": "https://api.github.com/users/siddarthkay/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-25T05:11:25Z",
    "updated_at": "2023-09-25T05:11:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "The compiled code was failing because of `(def extrapolate {:clamp (oget Extrapolate \"CLAMP\")})`\r\nfixed here https://github.com/status-im/status-mobile/pull/17241/commits/4c7a0ca3fc232bfcce5506922cd3e9df641957ad",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1732923540/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
