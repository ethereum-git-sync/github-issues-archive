{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/3932",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/3932/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/3932/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/3932/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/3932",
  "id": 315803428,
  "node_id": "MDU6SXNzdWUzMTU4MDM0Mjg=",
  "number": 3932,
  "title": "Use :npm-deps false to speed up Figwheel startup",
  "user": {
    "login": "dmitryn",
    "id": 23836,
    "node_id": "MDQ6VXNlcjIzODM2",
    "avatar_url": "https://avatars.githubusercontent.com/u/23836?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dmitryn",
    "html_url": "https://github.com/dmitryn",
    "followers_url": "https://api.github.com/users/dmitryn/followers",
    "following_url": "https://api.github.com/users/dmitryn/following{/other_user}",
    "gists_url": "https://api.github.com/users/dmitryn/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dmitryn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dmitryn/subscriptions",
    "organizations_url": "https://api.github.com/users/dmitryn/orgs",
    "repos_url": "https://api.github.com/users/dmitryn/repos",
    "events_url": "https://api.github.com/users/dmitryn/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dmitryn/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 330296933,
      "node_id": "MDU6TGFiZWwzMzAyOTY5MzM=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/enhancement",
      "name": "enhancement",
      "color": "84b6eb",
      "default": true,
      "description": null
    },
    {
      "id": 523025415,
      "node_id": "MDU6TGFiZWw1MjMwMjU0MTU=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bounty",
      "name": "bounty",
      "color": "FAFAD2",
      "default": false,
      "description": null
    },
    {
      "id": 757942800,
      "node_id": "MDU6TGFiZWw3NTc5NDI4MDA=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bounty-xs",
      "name": "bounty-xs",
      "color": "89cbe5",
      "default": false,
      "description": ""
    },
    {
      "id": 807362947,
      "node_id": "MDU6TGFiZWw4MDczNjI5NDc=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/clojure",
      "name": "clojure",
      "color": "244ae2",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2018-04-19T09:44:31Z",
  "updated_at": "2018-05-02T09:39:03Z",
  "closed_at": "2018-05-01T11:42:38Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Description\r\n\r\nLatest version of ClojureScript supports `:npm-deps false` compiler option.\r\nIt might speed up Figwheel start by 20-45 seconds https://github.com/bhauman/lein-figwheel/pull/678\r\nhttps://twitter.com/mfikes/status/986040242997284865?s=09\r\n\r\n### Solution\r\n\r\nAdd `npm-deps false` compiler option to dev builds. Compile builds for ios and android. Check if it increases Figwheel perfomance.\n\n<blockquote><img src=\"https://pbs.twimg.com/profile_images/909773383902142464/0JAdYoeO_400x400.jpg\" width=\"48\" align=\"right\"><div>Twitter</div><div><strong><a href=\"https://twitter.com/mfikes/status/986040242997284865\">Mike Fikes on Twitter</a></strong></div><div>“If you have a ClojureScript project where there also just happens to be a node_modules directory sitting there that ClojureScript itself doesn’t actually use (for example for React Native), :npm-deps false will be your new best friend. (It saves me 20 to 45 seconds of startup.)”</div></blockquote>",
  "closed_by": {
    "login": "dmitryn",
    "id": 23836,
    "node_id": "MDQ6VXNlcjIzODM2",
    "avatar_url": "https://avatars.githubusercontent.com/u/23836?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dmitryn",
    "html_url": "https://github.com/dmitryn",
    "followers_url": "https://api.github.com/users/dmitryn/followers",
    "following_url": "https://api.github.com/users/dmitryn/following{/other_user}",
    "gists_url": "https://api.github.com/users/dmitryn/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dmitryn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dmitryn/subscriptions",
    "organizations_url": "https://api.github.com/users/dmitryn/orgs",
    "repos_url": "https://api.github.com/users/dmitryn/repos",
    "events_url": "https://api.github.com/users/dmitryn/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dmitryn/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/3932/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/3932/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/383052775",
    "html_url": "https://github.com/status-im/status-mobile/issues/3932#issuecomment-383052775",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3932",
    "id": 383052775,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MzA1Mjc3NQ==",
    "user": {
      "login": "status-open-bounty",
      "id": 33065743,
      "node_id": "MDQ6VXNlcjMzMDY1NzQz",
      "avatar_url": "https://avatars.githubusercontent.com/u/33065743?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/status-open-bounty",
      "html_url": "https://github.com/status-open-bounty",
      "followers_url": "https://api.github.com/users/status-open-bounty/followers",
      "following_url": "https://api.github.com/users/status-open-bounty/following{/other_user}",
      "gists_url": "https://api.github.com/users/status-open-bounty/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/status-open-bounty/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/status-open-bounty/subscriptions",
      "organizations_url": "https://api.github.com/users/status-open-bounty/orgs",
      "repos_url": "https://api.github.com/users/status-open-bounty/repos",
      "events_url": "https://api.github.com/users/status-open-bounty/events{/privacy}",
      "received_events_url": "https://api.github.com/users/status-open-bounty/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-20T10:17:29Z",
    "updated_at": "2018-05-02T09:39:03Z",
    "author_association": "NONE",
    "body": "Balance: 0.000000 ETH\nTokens: SNT: 375.00\nContract address: [0xfda8e90578d0408f7d4f3e3f4dc3b469efa2e16c](https://etherscan.io/address/0xfda8e90578d0408f7d4f3e3f4dc3b469efa2e16c)\nNetwork: Mainnet\nPaid to: endenwer\nVisit [https://openbounty.status.im](https://openbounty.status.im) to learn more.\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/383052775/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/384185236",
    "html_url": "https://github.com/status-im/status-mobile/issues/3932#issuecomment-384185236",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3932",
    "id": 384185236,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDE4NTIzNg==",
    "user": {
      "login": "debragail",
      "id": 552529,
      "node_id": "MDQ6VXNlcjU1MjUyOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/552529?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/debragail",
      "html_url": "https://github.com/debragail",
      "followers_url": "https://api.github.com/users/debragail/followers",
      "following_url": "https://api.github.com/users/debragail/following{/other_user}",
      "gists_url": "https://api.github.com/users/debragail/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/debragail/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/debragail/subscriptions",
      "organizations_url": "https://api.github.com/users/debragail/orgs",
      "repos_url": "https://api.github.com/users/debragail/repos",
      "events_url": "https://api.github.com/users/debragail/events{/privacy}",
      "received_events_url": "https://api.github.com/users/debragail/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-25T07:19:52Z",
    "updated_at": "2018-04-25T07:19:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "Can you post the current performance metrics and logs?",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/384185236/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/384185965",
    "html_url": "https://github.com/status-im/status-mobile/issues/3932#issuecomment-384185965",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3932",
    "id": 384185965,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDE4NTk2NQ==",
    "user": {
      "login": "debragail",
      "id": 552529,
      "node_id": "MDQ6VXNlcjU1MjUyOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/552529?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/debragail",
      "html_url": "https://github.com/debragail",
      "followers_url": "https://api.github.com/users/debragail/followers",
      "following_url": "https://api.github.com/users/debragail/following{/other_user}",
      "gists_url": "https://api.github.com/users/debragail/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/debragail/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/debragail/subscriptions",
      "organizations_url": "https://api.github.com/users/debragail/orgs",
      "repos_url": "https://api.github.com/users/debragail/repos",
      "events_url": "https://api.github.com/users/debragail/events{/privacy}",
      "received_events_url": "https://api.github.com/users/debragail/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-25T07:23:02Z",
    "updated_at": "2018-04-25T07:23:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "https://github.com/bhauman/lein-figwheel/pull/678",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/384185965/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/384186047",
    "html_url": "https://github.com/status-im/status-mobile/issues/3932#issuecomment-384186047",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3932",
    "id": 384186047,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDE4NjA0Nw==",
    "user": {
      "login": "dmitryn",
      "id": 23836,
      "node_id": "MDQ6VXNlcjIzODM2",
      "avatar_url": "https://avatars.githubusercontent.com/u/23836?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dmitryn",
      "html_url": "https://github.com/dmitryn",
      "followers_url": "https://api.github.com/users/dmitryn/followers",
      "following_url": "https://api.github.com/users/dmitryn/following{/other_user}",
      "gists_url": "https://api.github.com/users/dmitryn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dmitryn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dmitryn/subscriptions",
      "organizations_url": "https://api.github.com/users/dmitryn/orgs",
      "repos_url": "https://api.github.com/users/dmitryn/repos",
      "events_url": "https://api.github.com/users/dmitryn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dmitryn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-25T07:23:24Z",
    "updated_at": "2018-04-25T07:23:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "I don't have one. It's actually in scope of this issue to collect and compare such metrics.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/384186047/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/384189011",
    "html_url": "https://github.com/status-im/status-mobile/issues/3932#issuecomment-384189011",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3932",
    "id": 384189011,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDE4OTAxMQ==",
    "user": {
      "login": "debragail",
      "id": 552529,
      "node_id": "MDQ6VXNlcjU1MjUyOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/552529?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/debragail",
      "html_url": "https://github.com/debragail",
      "followers_url": "https://api.github.com/users/debragail/followers",
      "following_url": "https://api.github.com/users/debragail/following{/other_user}",
      "gists_url": "https://api.github.com/users/debragail/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/debragail/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/debragail/subscriptions",
      "organizations_url": "https://api.github.com/users/debragail/orgs",
      "repos_url": "https://api.github.com/users/debragail/repos",
      "events_url": "https://api.github.com/users/debragail/events{/privacy}",
      "received_events_url": "https://api.github.com/users/debragail/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-25T07:35:30Z",
    "updated_at": "2018-04-25T07:35:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "It looks like you use he node_modules folder according to this file:\r\n\r\nfindSymlinkedModules.js.patch\r\n\r\n/**\r\n * Copyright (c) 2015-present, Facebook, Inc.\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree. An additional grant\r\n * of patent rights can be found in the PATENTS file in the same directory.\r\n *\r\n * @format\r\n * @flow\r\n */\r\n\r\nconst path = require('path');\r\nconst fs = require('fs');\r\n\r\n/**\r\n * Find symlinked modules inside \"node_modules.\"\r\n *\r\n * Naively, we could just perform a depth-first search of all folders in\r\n * node_modules, recursing when we find a symlink.\r\n *\r\n * We can be smarter than this due to our knowledge of how npm/Yarn lays out\r\n * \"node_modules\" / how tools that build on top of npm/Yarn (such as Lerna)\r\n * install dependencies.\r\n *\r\n * Starting from a given root node_modules folder, this algorithm will look at\r\n * both the top level descendants of the node_modules folder or second level\r\n * descendants of folders that start with \"@\" (which indicates a scoped\r\n * package). If any of those folders is a symlink, it will recurse into the\r\n * link, and perform the same search in the linked folder.\r\n *\r\n * The end result should be a list of all resolved module symlinks for a given\r\n * root.\r\n */\r\nmodule.exports = function findSymlinkedModules(\r\n  projectRoot: string,\r\n  ignoredRoots: Array<string> = [],\r\n) {\r\n  const timeStart = Date.now();\r\n  const nodeModuleRoot = path.join(projectRoot, 'node_modules');\r\n  const resolvedSymlinks = findModuleSymlinks(nodeModuleRoot, [\r\n    ...ignoredRoots,\r\n    projectRoot,\r\n  ]);\r\n  const timeEnd = Date.now();\r\n\r\n  console.log(\r\n    `Scanning folders for symlinks in ${nodeModuleRoot} (${timeEnd -\r\n      timeStart}ms)`,\r\n  );\r\n\r\n  return resolvedSymlinks;\r\n};\r\n\r\nfunction findModuleSymlinks(\r\n  modulesPath: string,\r\n  ignoredPaths: Array<string> = [],\r\n): Array<string> {\r\n  if (!fs.existsSync(modulesPath)) {\r\n    return [];\r\n  }\r\n\r\n  // Find module symlinks\r\n  const moduleFolders = fs.readdirSync(modulesPath);\r\n  const symlinks = moduleFolders.reduce((links, folderName) => {\r\n    const folderPath = path.join(modulesPath, folderName);\r\n    const maybeSymlinkPaths = [];\r\n    if (folderName.startsWith('@')) {\r\n      const scopedModuleFolders = fs.readdirSync(folderPath);\r\n      maybeSymlinkPaths.push(\r\n        ...scopedModuleFolders.map(name => path.join(folderPath, name)),\r\n      );\r\n    } else {\r\n      maybeSymlinkPaths.push(folderPath);\r\n    }\r\n    return links.concat(resolveSymlinkPaths(maybeSymlinkPaths, ignoredPaths));\r\n  }, []);\r\n\r\n  // For any symlinks found, look in _that_ modules node_modules directory\r\n  // and find any symlinked modules\r\n  const nestedSymlinks = symlinks.reduce(\r\n    (links, symlinkPath) =>\r\n      links.concat(\r\n        // We ignore any found symlinks or anything from the ignored list,\r\n        // to prevent infinite recursion\r\n        findModuleSymlinks(path.join(symlinkPath, 'node_modules'), [\r\n          ...ignoredPaths,\r\n          ...symlinks,\r\n        ]),\r\n      ),\r\n    [],\r\n  );\r\n\r\n  return [...new Set([...symlinks, ...nestedSymlinks])];\r\n}\r\n\r\nfunction resolveSymlinkPaths(maybeSymlinkPaths, ignoredPaths) {\r\n  return maybeSymlinkPaths.reduce((links, maybeSymlinkPath) => {\r\n    if (fs.lstatSync(maybeSymlinkPath).isSymbolicLink()) {\r\n      const resolved = path.resolve(\r\n        path.dirname(maybeSymlinkPath),\r\n        fs.readlinkSync(maybeSymlinkPath),\r\n      );\r\n      if (ignoredPaths.indexOf(resolved) === -1 && fs.existsSync(resolved)) {\r\n        links.push(resolved);\r\n      }\r\n    }\r\n    return links;\r\n  }, []);\r\n}\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/384189011/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/384191950",
    "html_url": "https://github.com/status-im/status-mobile/issues/3932#issuecomment-384191950",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3932",
    "id": 384191950,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDE5MTk1MA==",
    "user": {
      "login": "debragail",
      "id": 552529,
      "node_id": "MDQ6VXNlcjU1MjUyOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/552529?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/debragail",
      "html_url": "https://github.com/debragail",
      "followers_url": "https://api.github.com/users/debragail/followers",
      "following_url": "https://api.github.com/users/debragail/following{/other_user}",
      "gists_url": "https://api.github.com/users/debragail/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/debragail/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/debragail/subscriptions",
      "organizations_url": "https://api.github.com/users/debragail/orgs",
      "repos_url": "https://api.github.com/users/debragail/repos",
      "events_url": "https://api.github.com/users/debragail/events{/privacy}",
      "received_events_url": "https://api.github.com/users/debragail/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-25T07:46:49Z",
    "updated_at": "2018-04-25T07:46:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "Also I don’t know react native tooling that well but it seems to be an issue with 16:\r\n\r\nhttps://github.com/facebook/react-native/issues/15371",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/384191950/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
