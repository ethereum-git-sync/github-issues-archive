{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/3129",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/3129/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/3129/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/3129/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/3129",
  "id": 291213387,
  "node_id": "MDU6SXNzdWUyOTEyMTMzODc=",
  "number": 3129,
  "title": "Message of type contact-request doesn't contain contact object",
  "user": {
    "login": "dmitryn",
    "id": 23836,
    "node_id": "MDQ6VXNlcjIzODM2",
    "avatar_url": "https://avatars.githubusercontent.com/u/23836?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dmitryn",
    "html_url": "https://github.com/dmitryn",
    "followers_url": "https://api.github.com/users/dmitryn/followers",
    "following_url": "https://api.github.com/users/dmitryn/following{/other_user}",
    "gists_url": "https://api.github.com/users/dmitryn/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dmitryn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dmitryn/subscriptions",
    "organizations_url": "https://api.github.com/users/dmitryn/orgs",
    "repos_url": "https://api.github.com/users/dmitryn/repos",
    "events_url": "https://api.github.com/users/dmitryn/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dmitryn/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 330296931,
      "node_id": "MDU6TGFiZWwzMzAyOTY5MzE=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2018-01-24T13:43:52Z",
  "updated_at": "2018-01-24T16:18:24Z",
  "closed_at": "2018-01-24T16:18:24Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "#### Description\r\n\r\n[comment]: # (Feature or Bug? i.e Type: Bug)\r\n*Type*: Bug\r\n\r\n[comment]: # (Describe the feature you would like, or briefly summarise the bug and what you did, what you expected to happen, and what actually happens. Sections below)\r\n*Summary*: While investigating https://github.com/status-im/status-react/pull/3110 we found `contact-request` message that doesn't contain `contact` object inside:\r\n```\r\n{:recipientPublicKey \"0x04e9a494d3ac309fdbd50c1c394cd7a4fb1c7049a7fa895c2c47313fadddb618bca16af16867d90e02bd3f1a69e97723223e9d5b0f246dd9487ef8d2b3fa1ed397\",\r\n :payload {:message-id \"1516730527404-977f74dd-f1de-5cd7-aaf5-c52938d3df13\",\r\n           :type :contact-request,\r\n           :ack? true,\r\n           :ack-of-message \"1516730531058-3f1257aa-41f8-5a2e-8af9-abad3ffdce90\",\r\n           :group-id nil,\r\n           :content nil},\r\n :hash \"0x501dd6dc8428efb8db8036cb9d8fa0e990fd5f164cff40b39249d44a6db0e3b3\",\r\n :pow 0.0066047471620227045,\r\n :topic \"0xaabb11ee\",\r\n :sig \"0x04cf6bd00c93d5404331f916ca8e7b0ebe55a3b7492c654b706b965e32387b120766934cd1d154bbec4253de11fd6d0a1af4f2fdd1dbc014c8cc17b2f00f7ae3b2\",\r\n :ttl 120,\r\n :from \"0x04cf6bd00c93d5404331f916ca8e7b0ebe55a3b7492c654b706b965e32387b120766934cd1d154bbec4253de11fd6d0a1af4f2fdd1dbc014c8cc17b2f00f7ae3b2\",\r\n :padding \"0x54cbd0351e41c9af48257e0a8b9eb1a8a367fdcc77098720f1b46c5e720e4013ec1b3075ed149cec159687f43c3b0f3688d48fe0524254b7f1a322548560bf353b1f7a4a7b5e6d4769ea53c71637e06a55ce106c9ffd9209a9058881451efc89a403e2678e871fd2e5627c3a18dead0c6e9b06895be2a9c8feed8a8d6733b722d6a3d9267ac253c98f668aae2a0a646b943459de0f43168012d0ba91daf3d63cbd9577c265c7e61cb68f1fadeac4098e9f38a25dfce8805533d1f6d44abb25995671eee3b206ac3e1719f6fd1c502c40f77e2b7beb8befb6c49485c27eea94de941f7a15dcca127f28c114bffde45545ddda8c\",\r\n :timestamp 1516730527,\r\n :to \"0x04e9a494d3ac309fdbd50c1c394cd7a4fb1c7049a7fa895c2c47313fadddb618bca16af16867d90e02bd3f1a69e97723223e9d5b0f246dd9487ef8d2b3fa1ed397\"}\r\n\r\n```\r\n\r\nI only see one place where `contact-request` can be created and it always has `contact` in `payload` https://github.com/status-im/status-react/blob/develop/src/status_im/ui/screens/contacts/events.cljs#L66\r\n\r\n#### Steps to reproduce\r\n\r\nDescribed here https://github.com/status-im/status-react/issues/3081\r\n\r\n#### Version\r\n\r\nOnly happens on release build 65 (upgraded from 0.9.12 to this build)\r\n\r\n#### Logs\r\n\r\n[comment]: # (if on Android please replicate bug whilst running adb logcat)\r\n```\r\n# https://app.testfairy.com/projects/4803622-status/builds/7561465/sessions/1/?accessToken=Fkkoa5SmM2Gvr0qOAxLYU4a8110\r\n\r\n00:47 D/ReactNativeJS: DEBUG [status-im.protocol.handlers:315] - Handling protocol message: {:recipientPublicKey \"0x04e9a494d3ac309fdbd50c1c394cd7a4fb1c7049a7fa895c2c47313fadddb618bca16af16867d90e02bd3f1a69e97723223e9d5b0f246dd9487ef8d2b3fa1ed397\", :payload {:message-id \"1516730527404-977f74dd-f1de-5cd7-aaf5-c52938d3df13\", :type :contact-request, :ack? true, :ack-of-message \"1516730531058-3f1257aa-41f8-5a2e-8af9-abad3ffdce90\", :group-id nil, :content nil}, :hash \"0x501dd6dc8428efb8db8036cb9d8fa0e990fd5f164cff40b39249d44a6db0e3b3\", :pow 0.0066047471620227045, :topic \"0xaabb11ee\", :sig \"0x04cf6bd00c93d5404331f916ca8e7b0ebe55a3b7492c654b706b965e32387b120766934cd1d154bbec4253de11fd6d0a1af4f2fdd1dbc014c8cc17b2f00f7ae3b2\", :ttl 120, :from \"0x04cf6bd00c93d5404331f916ca8e7b0ebe55a3b7492c654b706b965e32387b120766934cd1d154bbec4253de11fd6d0a1af4f2fdd1dbc014c8cc17b2f00f7ae3b2\", :padding \"0x54cbd0351e41c9af48257e0a8b9eb1a8a367fdcc77098720f1b46c5e720e4013ec1b3075ed149cec159687f43c3b0f3688d48fe0524254b7f1a322548560bf353b1f7a4a7b5e6d4769ea53c71637e06a55ce106c9ffd9209a9058881451efc89a403e2678e871fd2e5627c3a18dead0c6e9b06895be2a9c8feed8a8d6733b722d6a3d9267ac253c98f668aae2a0a646b943459de0f43168012d0ba91daf3d63cbd9577c265c7e61cb68f1fadeac4098e9f38a25dfce8805533d1f6d44abb25995671eee3b206ac3e1719f6fd1c502c40f77e2b7beb8befb6c49485c27eea94de941f7a15dcca127f28c114bffde45545ddda8c\", :timestamp 1516730527, :to \"0x04e9a494d3ac309fdbd50c1c394cd7a4fb1c7049a7fa895c2c47313fadddb618bca16af16867d90e02bd3f1a69e97723223e9d5b0f246dd9487ef8d2b3fa1ed397\"}\r\n00:47 D/ReactNativeJS: DEBUG [status-im.protocol.handlers:315] - Handling protocol message: {:recipientPublicKey \"0x04e9a494d3ac309fdbd50c1c394cd7a4fb1c7049a7fa895c2c47313fadddb618bca16af16867d90e02bd3f1a69e97723223e9d5b0f246dd9487ef8d2b3fa1ed397\", :payload {:message-id \"1516730521970-1c71d42a-c671-5b71-8ef6-5c9d130978cf\", :requires-ack? true, :type :contact-request, :contact {:name \"Quarterly Amusing Pipit\", :profile-image \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAADAFBMVEXw8PDYjJsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA9DaTzAAABAHRSTlP//wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKmfXxgAABnNJREFUeNoBaAaX+QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQEBAQEAAAAAAAABAQEBAQEAAAAAAAABAQEBAQEAAAAAAAAAAAAAAAEBAQEBAQAAAAAAAAEBAQEBAQAAAAAAAAEBAQEBAQAAAAAAAAAAAAAAAQEBAQEBAAAAAAAAAQEBAQEBAAAAAAAAAQEBAQEBAAAAAAAAAAAAAAABAQEBAQEAAAAAAAABAQEBAQEAAAAAAAABAQEBAQEAAAAAAAAAAAAAAAEBAQEBAQAAAAAAAAEBAQEBAQAAAAAAAAEBAQEBAQAAAAAAAAAAAAAAAQEBAQEBAAAAAAAAAQEBAQEBAAAAAAAAAQEBAQEBAAAAAAAAAAAAAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAAAAAAAAAAAAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQAAAAAAAAAAAAAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAAAAAAAAAAAAAABAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAAAAAAAAAAAAAAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQAAAAAAAAAAAAAAAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQEBAQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAQEBAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEBAQEBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQEBAQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAQEBAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEBAQEBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQEBAQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAQEBAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEBAQEBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQEBAQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAQEBAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEBAQEBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQEBAQEBAQEBAQEBAQEBAQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAQEBAQEBAQEBAQEBAQEBAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEBAQEBAQEBAQEBAQEBAQEBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQEBAQEBAQEBAQEBAQEBAQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAQEBAQEBAQEBAQEBAQEBAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEBAQEBAQEBAQEBAQEBAQEBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\r\n```",
  "closed_by": {
    "login": "dmitryn",
    "id": 23836,
    "node_id": "MDQ6VXNlcjIzODM2",
    "avatar_url": "https://avatars.githubusercontent.com/u/23836?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dmitryn",
    "html_url": "https://github.com/dmitryn",
    "followers_url": "https://api.github.com/users/dmitryn/followers",
    "following_url": "https://api.github.com/users/dmitryn/following{/other_user}",
    "gists_url": "https://api.github.com/users/dmitryn/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dmitryn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dmitryn/subscriptions",
    "organizations_url": "https://api.github.com/users/dmitryn/orgs",
    "repos_url": "https://api.github.com/users/dmitryn/repos",
    "events_url": "https://api.github.com/users/dmitryn/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dmitryn/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/3129/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/3129/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/360150112",
    "html_url": "https://github.com/status-im/status-mobile/issues/3129#issuecomment-360150112",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3129",
    "id": 360150112,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MDE1MDExMg==",
    "user": {
      "login": "dmitryn",
      "id": 23836,
      "node_id": "MDQ6VXNlcjIzODM2",
      "avatar_url": "https://avatars.githubusercontent.com/u/23836?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dmitryn",
      "html_url": "https://github.com/dmitryn",
      "followers_url": "https://api.github.com/users/dmitryn/followers",
      "following_url": "https://api.github.com/users/dmitryn/following{/other_user}",
      "gists_url": "https://api.github.com/users/dmitryn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dmitryn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dmitryn/subscriptions",
      "organizations_url": "https://api.github.com/users/dmitryn/orgs",
      "repos_url": "https://api.github.com/users/dmitryn/repos",
      "events_url": "https://api.github.com/users/dmitryn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dmitryn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-24T14:20:54Z",
    "updated_at": "2018-01-24T14:27:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think we need to implement validation on any incoming/outgoing message to conform to formats described in specs (and have it described here as well https://wiki.status.im/Whisper_Messaging) ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/360150112/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/360154603",
    "html_url": "https://github.com/status-im/status-mobile/issues/3129#issuecomment-360154603",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3129",
    "id": 360154603,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MDE1NDYwMw==",
    "user": {
      "login": "dmitryn",
      "id": 23836,
      "node_id": "MDQ6VXNlcjIzODM2",
      "avatar_url": "https://avatars.githubusercontent.com/u/23836?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dmitryn",
      "html_url": "https://github.com/dmitryn",
      "followers_url": "https://api.github.com/users/dmitryn/followers",
      "following_url": "https://api.github.com/users/dmitryn/following{/other_user}",
      "gists_url": "https://api.github.com/users/dmitryn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dmitryn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dmitryn/subscriptions",
      "organizations_url": "https://api.github.com/users/dmitryn/orgs",
      "repos_url": "https://api.github.com/users/dmitryn/repos",
      "events_url": "https://api.github.com/users/dmitryn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dmitryn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-24T14:35:45Z",
    "updated_at": "2018-01-24T14:35:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "Seems like it's \"ack\" message",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/360154603/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
