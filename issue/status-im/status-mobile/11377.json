{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/11377",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/11377/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/11377/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/11377/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/11377",
  "id": 736978207,
  "node_id": "MDU6SXNzdWU3MzY5NzgyMDc=",
  "number": 11377,
  "title": "Showing channel list when typing # in chat",
  "user": {
    "login": "hesterbruikman",
    "id": 35233054,
    "node_id": "MDQ6VXNlcjM1MjMzMDU0",
    "avatar_url": "https://avatars.githubusercontent.com/u/35233054?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hesterbruikman",
    "html_url": "https://github.com/hesterbruikman",
    "followers_url": "https://api.github.com/users/hesterbruikman/followers",
    "following_url": "https://api.github.com/users/hesterbruikman/following{/other_user}",
    "gists_url": "https://api.github.com/users/hesterbruikman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hesterbruikman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hesterbruikman/subscriptions",
    "organizations_url": "https://api.github.com/users/hesterbruikman/orgs",
    "repos_url": "https://api.github.com/users/hesterbruikman/repos",
    "events_url": "https://api.github.com/users/hesterbruikman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hesterbruikman/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4011372929,
      "node_id": "LA_kwDOAx4p2c7vGLGB",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/E:ChatFeatures",
      "name": "E:ChatFeatures",
      "color": "35103C",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2020-11-05T14:25:12Z",
  "updated_at": "2022-12-05T14:41:13Z",
  "closed_at": "2022-12-05T14:41:13Z",
  "author_association": "COLLABORATOR",
  "active_lock_reason": null,
  "body": "# Problem\nIf channels are not accurately 'mentioned' others can end up in an empty chat because of a typo, misspelling, etc.. Currently, users need to put in effort to manually enter the correct chat name\n\n### User story\nAs a user\nI want to see a list of public chats to select from when 'mentioning' a chat \nBecause I want to make sure I include the exact chat name to prevent others from ending up in an empty chat\n\n### Content requirements\nChat list should include\n- channels already in your list\n- channels in our hard coded list (see https://github.com/status-im/status-react/pull/10934)\n\n\n\n## Acceptance Criteria\n- Channel list is populated and visible upon entering `#`\n- Channel list includes required content alphabetically\n- Continuing to enter manually allows to confirm by tapping on channel from list (replacing the manual input following `#`)\n- cc @errorists for any further input requirements as discussed for mentions\n\n## Future Steps\nThis can in the future be expanded with\n- channels in your community (future)\n- channels where contacts have posted (future)",
  "closed_by": {
    "login": "churik",
    "id": 4557972,
    "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/churik",
    "html_url": "https://github.com/churik",
    "followers_url": "https://api.github.com/users/churik/followers",
    "following_url": "https://api.github.com/users/churik/following{/other_user}",
    "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
    "organizations_url": "https://api.github.com/users/churik/orgs",
    "repos_url": "https://api.github.com/users/churik/repos",
    "events_url": "https://api.github.com/users/churik/events{/privacy}",
    "received_events_url": "https://api.github.com/users/churik/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/11377/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/11377/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/730460898",
    "html_url": "https://github.com/status-im/status-mobile/issues/11377#issuecomment-730460898",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/11377",
    "id": 730460898,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczMDQ2MDg5OA==",
    "user": {
      "login": "shivekkhurana",
      "id": 1925158,
      "node_id": "MDQ6VXNlcjE5MjUxNTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1925158?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shivekkhurana",
      "html_url": "https://github.com/shivekkhurana",
      "followers_url": "https://api.github.com/users/shivekkhurana/followers",
      "following_url": "https://api.github.com/users/shivekkhurana/following{/other_user}",
      "gists_url": "https://api.github.com/users/shivekkhurana/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shivekkhurana/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shivekkhurana/subscriptions",
      "organizations_url": "https://api.github.com/users/shivekkhurana/orgs",
      "repos_url": "https://api.github.com/users/shivekkhurana/repos",
      "events_url": "https://api.github.com/users/shivekkhurana/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shivekkhurana/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-19T15:43:58Z",
    "updated_at": "2020-11-19T15:43:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue not straightforward to implement and will need some changes to how the @ \"at\" mentions work.\r\n\r\n## Current process\r\n- An on-change handler is triggered each time a character is entered\r\n  - This handler is triggered at different places depending on the platform but has the same effect\r\n- A matching function computes the positions of `@` signs\r\n  - For the text: `Yo you @fds Dodd’s fest @fds dad  fed`\r\n  - The at-index representation is `[{:from 7, :to 23, :checked? true, :mention false, :channel-mention? false, :next-at-idx 24} {:from 24, :to 37, :checked? false, :mention false]` \r\n  - The `:from` signifies and `:to` signify the start and end of search term. Everything after the `@` sign is considered to be a search term until the next `@` sign is encountered.\r\n  - If the user didn't choose an autocomplete-suggestion for the first `@` sign, and proceed to type another `@` sign, the first search term is marked as checked:true and mention:false\r\n  - Had the user selected a suggestion, the search term will be marked as checked:true and mention:true\r\n\r\n- If there was indeed a mention\r\n  - The input value is updated with the correct text (for example: `Yo you @fds Dodd’s fest @fds dad  fed  @moxarra jYo you @fds Dodd’s fest @fds dad  fed  @moxarra j`, here moxarra was added when the suggestion was pressed, this could also be a three letter username)\r\n  - Then the same `@` indexing criteria is used to generate the new representation of the text\r\n     - In this case, it would be ` [{:from 7, :to 23, :checked? true, :mention false, :channel-mention? false, :next-at-idx 24} {:from 24, :to 38, :checked? true, :mention false, :next-at-idx 39} {:from 39, :to 46, :checked? true, :mention? true}]`\r\n  - This intermediate state is then used to calculate the new value of the text-input: `[[:text Yo you ] [:text @fds Dodd’s fest ] [:text @fds dad  fed  ] [:mention @moxarra] [:text  j]][[:text Yo you ] [:text @fds Dodd’s fest ] [:text @fds dad  fed  ] [:mention @moxarra] [:text  j]]`\r\n  - The input then renders the blocks marked as `:mention` with a blue color\r\n\r\n## Problem\r\nThe system is built around `@` indexes. `@` signs are anchor points, and everything in between is a search term. Using these `@` indices, the intermediate state is calculated and the new value of text-input is computed.\r\n\r\nIf we were to replicate the same proccess with`#` as an index, instead of `@`, the new value of text-input will be incompatible with the one produced by `@` version. There is no easy way of reconciliation, so the mentions matching needs to happen in the same function, ie. we need to stop considering `@` as the defacto anchor and allow for more anchors like `#`. \r\n\r\nMaybe in future, we can have a `!` anchor for commands, like `!send 1.5 eth`, the commands would have a suggestion list.\r\n\r\nThe current system is brittle, needs more thought and refactoring.\r\n\r\n\r\n \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/730460898/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/730958978",
    "html_url": "https://github.com/status-im/status-mobile/issues/11377#issuecomment-730958978",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/11377",
    "id": 730958978,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczMDk1ODk3OA==",
    "user": {
      "login": "shivekkhurana",
      "id": 1925158,
      "node_id": "MDQ6VXNlcjE5MjUxNTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1925158?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shivekkhurana",
      "html_url": "https://github.com/shivekkhurana",
      "followers_url": "https://api.github.com/users/shivekkhurana/followers",
      "following_url": "https://api.github.com/users/shivekkhurana/following{/other_user}",
      "gists_url": "https://api.github.com/users/shivekkhurana/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shivekkhurana/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shivekkhurana/subscriptions",
      "organizations_url": "https://api.github.com/users/shivekkhurana/orgs",
      "repos_url": "https://api.github.com/users/shivekkhurana/repos",
      "events_url": "https://api.github.com/users/shivekkhurana/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shivekkhurana/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-20T07:24:43Z",
    "updated_at": "2020-11-20T07:25:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "🦆 Thinking out loud here, but one possible solution can be to rebuilt the auto-complete in a simpler way:\r\n```\r\n{:autocompletes \r\n                           [{:anchor \"@\"\r\n                             :search-boundary 3  ;; consider upto 3 words after anchor text as the search term\r\n                             :suggestions (fn [search-term]) ;; return list of suggestions for matched search term\r\n                             :suggestions-render (fn [])}\r\n                             \r\n                            {:anchor \"#\"\r\n                             :search-boundary 1  ;; consider upto 1 words after anchor text as the search term\r\n                             :suggestions (fn [search-term]) ;; return list of suggestions for matched search term\r\n                             :suggestions-render (fn [])}\r\n\r\n                            ;; more anchors if need be\r\n]}\r\n```\r\n\r\nThen this config will be passed to an on-change handler, with the current input value. This function will look for the last match (ie. if there are multiple anchors in a text, like \"Hi @ my name is @shivek and I'm talking in channel #sta\", then only #sta will be processed. Everything else will be considered processed already), and show suggestions. \r\n\r\nI might be missing something here, but this will simplify the current system because we don't need to maintain indices anymore. This will also make it easy to add/remove anchors in future. Say we want to use a `!` sign for commands, just add config and it will start working.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/730958978/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1337497215",
    "html_url": "https://github.com/status-im/status-mobile/issues/11377#issuecomment-1337497215",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/11377",
    "id": 1337497215,
    "node_id": "IC_kwDOAx4p2c5PuJZ_",
    "user": {
      "login": "churik",
      "id": 4557972,
      "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/churik",
      "html_url": "https://github.com/churik",
      "followers_url": "https://api.github.com/users/churik/followers",
      "following_url": "https://api.github.com/users/churik/following{/other_user}",
      "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
      "organizations_url": "https://api.github.com/users/churik/orgs",
      "repos_url": "https://api.github.com/users/churik/repos",
      "events_url": "https://api.github.com/users/churik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/churik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-05T14:41:13Z",
    "updated_at": "2022-12-05T14:41:13Z",
    "author_association": "MEMBER",
    "body": "Obsolete and will be re-considered in the redesigned app.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1337497215/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
