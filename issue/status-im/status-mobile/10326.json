{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/10326",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/10326/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/10326/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/10326/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/10326",
  "id": 599583605,
  "node_id": "MDU6SXNzdWU1OTk1ODM2MDU=",
  "number": 10326,
  "title": "Can't add same account in wallet as the removed 'Watched only account'",
  "user": {
    "login": "Serhy",
    "id": 8749671,
    "node_id": "MDQ6VXNlcjg3NDk2NzE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8749671?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Serhy",
    "html_url": "https://github.com/Serhy",
    "followers_url": "https://api.github.com/users/Serhy/followers",
    "following_url": "https://api.github.com/users/Serhy/following{/other_user}",
    "gists_url": "https://api.github.com/users/Serhy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Serhy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Serhy/subscriptions",
    "organizations_url": "https://api.github.com/users/Serhy/orgs",
    "repos_url": "https://api.github.com/users/Serhy/repos",
    "events_url": "https://api.github.com/users/Serhy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Serhy/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 330296931,
      "node_id": "MDU6TGFiZWwzMzAyOTY5MzE=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "iurimatias",
    "id": 176720,
    "node_id": "MDQ6VXNlcjE3NjcyMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176720?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iurimatias",
    "html_url": "https://github.com/iurimatias",
    "followers_url": "https://api.github.com/users/iurimatias/followers",
    "following_url": "https://api.github.com/users/iurimatias/following{/other_user}",
    "gists_url": "https://api.github.com/users/iurimatias/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iurimatias/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iurimatias/subscriptions",
    "organizations_url": "https://api.github.com/users/iurimatias/orgs",
    "repos_url": "https://api.github.com/users/iurimatias/repos",
    "events_url": "https://api.github.com/users/iurimatias/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iurimatias/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "iurimatias",
      "id": 176720,
      "node_id": "MDQ6VXNlcjE3NjcyMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176720?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iurimatias",
      "html_url": "https://github.com/iurimatias",
      "followers_url": "https://api.github.com/users/iurimatias/followers",
      "following_url": "https://api.github.com/users/iurimatias/following{/other_user}",
      "gists_url": "https://api.github.com/users/iurimatias/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iurimatias/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iurimatias/subscriptions",
      "organizations_url": "https://api.github.com/users/iurimatias/orgs",
      "repos_url": "https://api.github.com/users/iurimatias/repos",
      "events_url": "https://api.github.com/users/iurimatias/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iurimatias/received_events",
      "type": "User",
      "site_admin": false
    },
    {
      "login": "0x-r4bbit",
      "id": 445106,
      "node_id": "MDQ6VXNlcjQ0NTEwNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/445106?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/0x-r4bbit",
      "html_url": "https://github.com/0x-r4bbit",
      "followers_url": "https://api.github.com/users/0x-r4bbit/followers",
      "following_url": "https://api.github.com/users/0x-r4bbit/following{/other_user}",
      "gists_url": "https://api.github.com/users/0x-r4bbit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/0x-r4bbit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0x-r4bbit/subscriptions",
      "organizations_url": "https://api.github.com/users/0x-r4bbit/orgs",
      "repos_url": "https://api.github.com/users/0x-r4bbit/repos",
      "events_url": "https://api.github.com/users/0x-r4bbit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/0x-r4bbit/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2020-04-14T13:42:53Z",
  "updated_at": "2020-04-24T09:40:51Z",
  "closed_at": "2020-04-24T09:40:51Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "# Bug Report\r\n\r\n## Problem\r\n\r\nReported by user originally:\r\nIf you have `Watch only address` as multiaccount instance in Wallet - there is no way to add that account via seed phrase / private key even after `Watch only account` removed\r\n\r\n#### Expected behavior\r\nCan add account via seed phrase / private key  after the same account address removed which was watch only address\r\n\r\n#### Actual behavior\r\n\r\nCan NOT add account via seed phrase / private key  after the same account address removed which was watch only address\r\n\r\n### Reproduction\r\n\r\n1)  Open Status and create new account\r\n2) In the `Wallet` -> `Add account` -> `Add watch only address` add the `0xB798BaA43Ea720dE862E96fefa9EDfd94273D6Db` address\r\n3) Add this account by now as fully accessible account (`Add account` -> `Enter a seed phrase` -> use this seed phrase `lesson original rose sunset crane they document balcony lava jelly select december`\r\n**Actual result = Expected result** `Account already exists` message appears and account is not added\r\n4) Now remove that Watch only address added via it's detail view -> top-right `...` -> `Account settings` -> `Delete account` \r\n5) Add again this account by now as fully accessible account (`Add account` -> `Enter a seed phrase` -> use this seed phrase `lesson original rose sunset crane they document balcony lava jelly select december`\r\n\r\n**Actual result** Account already exists` message appears and account is not added which is not expected since we deleted watch only acc before\r\n\r\n**BIG HINT:** It's all fine if you do not add the same account while `Watch only address` (so if you repeat **Reproduction** but without 3rd step then all fine)\r\n\r\n### Additional Information\r\n\r\n- Status version: release1.2/develop nightly 13th of April\r\n- Operating System: Android and iOS\r\n\r\n#### Logs\r\n\r\n```\r\n04-14 16:40:44.951 17966 17966 D ViewRootImpl@fd7c74d[MainActivity]: ViewPostIme pointer 0\r\n04-14 16:40:45.038 17966 17966 D ViewRootImpl@fd7c74d[MainActivity]: ViewPostIme pointer 1\r\n04-14 16:40:45.063 17966 18008 D ReactNativeJS: DEBUG [status-im.utils.handlers:32] - Handling re-frame event:  :wallet.accounts/add-new-account\r\n04-14 16:40:45.067 17966 18008 D ReactNativeJS: DEBUG [status-im.wallet.accounts.core:230] - [wallet] add-new-account type :seed step nil\r\n04-14 16:40:45.073 17966 18008 D ReactNativeJS: DEBUG [status-im.native-module.core:172] - [native-module] verify\r\n04-14 16:40:45.074 17966 18009 D StatusModule: verify\r\n04-14 16:40:45.934 17966 18008 D ReactNativeJS: DEBUG [status-im.utils.handlers:32] - Handling re-frame event:  :wallet.accounts/add-new-account-password-verifyied\r\n04-14 16:40:45.939 17966 18008 D ReactNativeJS: DEBUG [status-im.native-module.core:351] - [native-module] validate-mnemonic\r\n04-14 16:40:45.939 17966 18009 D StatusModule: validateMnemonic\r\n04-14 16:40:45.943 17966 20418 D StatusModule: {\"error\":\"\"}\r\n04-14 16:40:45.949 17966 18008 D ReactNativeJS: DEBUG [status-im.utils.handlers:32] - Handling re-frame event:  :wallet.accounts/seed-validated\r\n04-14 16:40:45.954 17966 18008 D ReactNativeJS: DEBUG [status-im.native-module.core:155] - [native-module] multiaccount-import-mnemonic\r\n04-14 16:40:45.955 17966 18009 D StatusModule: multiAccountImportMnemonic\r\n04-14 16:40:46.071 17966 18008 D ReactNativeJS: DEBUG [status-im.native-module.core:105] - [native-module]  multiaccount-derive-addresses\r\n04-14 16:40:46.072 17966 18009 D StatusModule: multiAccountDeriveAddresses\r\n04-14 16:40:46.082 17966 18008 D ReactNativeJS: DEBUG [status-im.native-module.core:131] - [native-module]  multiaccount-store-derived account-id 3ab1043a-8b75-476a-be78-9c9143028b2b\r\n04-14 16:40:46.083 17966 18009 D StatusModule: multiAccountStoreDerived\r\n04-14 16:40:46.091 17966 18073 E GoLog   : account already exists\r\n04-14 16:40:46.099 17966 18008 D ReactNativeJS: DEBUG [status-im.utils.handlers:32] - Handling re-frame event:  :status-im.wallet.accounts.core/new-account-error\r\n04-14 16:40:46.386 17966 18073 D StatusModule: Signal event: {\"type\":\"wallet\",\"event\":{\"type\":\"newblock\",\"blockNumber\":9870907,\"accounts\":[],\"newTransactions\":{},\"erc20\":false}}\r\n04-14 16:40:46.402 17966 18008 D ReactNativeJS: DEBUG [status-im.utils.handlers:32] - Handling re-frame event:  :signals/signal-received\r\n04-14 16:40:46.409 17966 18008 D ReactNativeJS: DEBUG [status-im.events:593] - :event-str {\"type\":\"wallet\",\"event\":{\"type\":\"newblock\",\"blockNumber\":9870907,\"accounts\":[],\"newTransactions\":{},\"erc20\":false}}\r\n04-14 16:40:46.417 17966 18008 D ReactNativeJS: DEBUG [status-im.ethereum.subscriptions:96] - [wallet-subs] new-wallet-event event-type newblock\r\n04-14 16:40:46.449 17966 18008 D ReactNativeJS: DEBUG [status-im.ethereum.subscriptions:33] - [wallet-subs] new-block accounts [] block 9870907 transactions-per-account {}\r\n04-14 16:40:46.497 17966 17977 I zygote  : Background concurrent copying GC freed 166047(6MB) AllocSpace objects, 9(216KB) LOS objects, 49% free, 6MB/13MB, paused 441us total 108.245ms\r\n04-14 16:40:46.756 17966 18008 D ReactNativeJS: DEBUG [status-im.utils.handlers:32] - Handling re-frame event:  :mailserver/check-connection-timeout\r\n04-14 16:40:48.086 17966 17966 D ViewRootImpl@fd7c74d[MainActivity]: ViewPostIme pointer 0\r\n04-14 16:40:48.464 17966 17966 D ViewRootImpl@fd7c74d[MainActivity]: ViewPostIme pointer 1\r\n\r\n\r\n\r\n```\r\n",
  "closed_by": {
    "login": "flexsurfer",
    "id": 11790366,
    "node_id": "MDQ6VXNlcjExNzkwMzY2",
    "avatar_url": "https://avatars.githubusercontent.com/u/11790366?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/flexsurfer",
    "html_url": "https://github.com/flexsurfer",
    "followers_url": "https://api.github.com/users/flexsurfer/followers",
    "following_url": "https://api.github.com/users/flexsurfer/following{/other_user}",
    "gists_url": "https://api.github.com/users/flexsurfer/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/flexsurfer/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/flexsurfer/subscriptions",
    "organizations_url": "https://api.github.com/users/flexsurfer/orgs",
    "repos_url": "https://api.github.com/users/flexsurfer/repos",
    "events_url": "https://api.github.com/users/flexsurfer/events{/privacy}",
    "received_events_url": "https://api.github.com/users/flexsurfer/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/10326/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/10326/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/615146351",
    "html_url": "https://github.com/status-im/status-mobile/issues/10326#issuecomment-615146351",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/10326",
    "id": 615146351,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNTE0NjM1MQ==",
    "user": {
      "login": "0x-r4bbit",
      "id": 445106,
      "node_id": "MDQ6VXNlcjQ0NTEwNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/445106?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/0x-r4bbit",
      "html_url": "https://github.com/0x-r4bbit",
      "followers_url": "https://api.github.com/users/0x-r4bbit/followers",
      "following_url": "https://api.github.com/users/0x-r4bbit/following{/other_user}",
      "gists_url": "https://api.github.com/users/0x-r4bbit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/0x-r4bbit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0x-r4bbit/subscriptions",
      "organizations_url": "https://api.github.com/users/0x-r4bbit/orgs",
      "repos_url": "https://api.github.com/users/0x-r4bbit/repos",
      "events_url": "https://api.github.com/users/0x-r4bbit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/0x-r4bbit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-17T09:32:41Z",
    "updated_at": "2020-04-17T09:32:41Z",
    "author_association": "MEMBER",
    "body": "I've been looking into this and I'm experiencing a very weird behaviour.\r\n\r\n- When adding new accounts (watch-only or proper), these are added to the status client. This can be verified by using its RPC API to call into `accounts_getAccount` \r\n- Removing watch accounts also properly removes it from the status client. Verification is done the same way\r\n- Here's the thing, even though the account in question has been removed from both, the memory/re-frame store and the status client (at least per RPC API), it seems the client itself still reports that the account already exists\r\n\r\nThe error is emitted by this API: \r\n\r\nhttps://github.com/status-im/status-react/blob/a79a72fccb27911b0caf96534a52215ba162d92b/src/status_im/native_module/core.cljs#L133-L137\r\n\r\nWhich eventually calls into \r\n\r\nhttps://github.com/status-im/status-react/blob/a79a72fccb27911b0caf96534a52215ba162d92b/modules/react-native-status/android/src/main/java/im/status/ethereum/module/StatusModule.java#L744-L760\r\n\r\n^ This is the API that reports the error, so it **looks** like it's a bug in status-go.\r\n\r\nThoughts @flexsurfer @yenda ?",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/615146351/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/615159099",
    "html_url": "https://github.com/status-im/status-mobile/issues/10326#issuecomment-615159099",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/10326",
    "id": 615159099,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNTE1OTA5OQ==",
    "user": {
      "login": "yenda",
      "id": 1181225,
      "node_id": "MDQ6VXNlcjExODEyMjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1181225?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yenda",
      "html_url": "https://github.com/yenda",
      "followers_url": "https://api.github.com/users/yenda/followers",
      "following_url": "https://api.github.com/users/yenda/following{/other_user}",
      "gists_url": "https://api.github.com/users/yenda/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yenda/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yenda/subscriptions",
      "organizations_url": "https://api.github.com/users/yenda/orgs",
      "repos_url": "https://api.github.com/users/yenda/repos",
      "events_url": "https://api.github.com/users/yenda/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yenda/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-17T10:00:43Z",
    "updated_at": "2020-04-17T10:00:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "@PascalPrecht indeed that should be reported in status-go repo",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/615159099/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/615187660",
    "html_url": "https://github.com/status-im/status-mobile/issues/10326#issuecomment-615187660",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/10326",
    "id": 615187660,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNTE4NzY2MA==",
    "user": {
      "login": "0x-r4bbit",
      "id": 445106,
      "node_id": "MDQ6VXNlcjQ0NTEwNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/445106?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/0x-r4bbit",
      "html_url": "https://github.com/0x-r4bbit",
      "followers_url": "https://api.github.com/users/0x-r4bbit/followers",
      "following_url": "https://api.github.com/users/0x-r4bbit/following{/other_user}",
      "gists_url": "https://api.github.com/users/0x-r4bbit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/0x-r4bbit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0x-r4bbit/subscriptions",
      "organizations_url": "https://api.github.com/users/0x-r4bbit/orgs",
      "repos_url": "https://api.github.com/users/0x-r4bbit/repos",
      "events_url": "https://api.github.com/users/0x-r4bbit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/0x-r4bbit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-17T11:10:59Z",
    "updated_at": "2020-04-17T11:10:59Z",
    "author_association": "MEMBER",
    "body": "Created an issue over at https://github.com/status-im/status-go/issues/1939",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/615187660/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
