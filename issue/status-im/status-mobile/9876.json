{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/9876",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/9876/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/9876/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/9876/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/9876",
  "id": 553410353,
  "node_id": "MDU6SXNzdWU1NTM0MTAzNTM=",
  "number": 9876,
  "title": "No gas estimate for ENS registration",
  "user": {
    "login": "rachelhamlin",
    "id": 15470435,
    "node_id": "MDQ6VXNlcjE1NDcwNDM1",
    "avatar_url": "https://avatars.githubusercontent.com/u/15470435?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rachelhamlin",
    "html_url": "https://github.com/rachelhamlin",
    "followers_url": "https://api.github.com/users/rachelhamlin/followers",
    "following_url": "https://api.github.com/users/rachelhamlin/following{/other_user}",
    "gists_url": "https://api.github.com/users/rachelhamlin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rachelhamlin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rachelhamlin/subscriptions",
    "organizations_url": "https://api.github.com/users/rachelhamlin/orgs",
    "repos_url": "https://api.github.com/users/rachelhamlin/repos",
    "events_url": "https://api.github.com/users/rachelhamlin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rachelhamlin/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 330296931,
      "node_id": "MDU6TGFiZWwzMzAyOTY5MzE=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    },
    {
      "id": 691030971,
      "node_id": "MDU6TGFiZWw2OTEwMzA5NzE=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/wallet",
      "name": "wallet",
      "color": "1d76db",
      "default": false,
      "description": null
    },
    {
      "id": 1745762236,
      "node_id": "MDU6TGFiZWwxNzQ1NzYyMjM2",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/ENS%20names",
      "name": "ENS names",
      "color": "e097ef",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2020-01-22T09:23:39Z",
  "updated_at": "2020-01-27T10:55:08Z",
  "closed_at": "2020-01-24T17:24:41Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "# Bug Report\r\n\r\n## Problem\r\n\r\nENS registration transactions have an empty gas fee calculation:\r\n\r\n![image](https://user-images.githubusercontent.com/15470435/72881289-126d4980-3d33-11ea-9cec-1476c063fb81.png)\r\n\r\n\r\n#### Expected behavior\r\n\r\nWallet estimates a network fee, e.g.\r\n\r\n![image](https://user-images.githubusercontent.com/15470435/72881517-78f26780-3d33-11ea-8fb4-71477f40b145.png)\r\n\r\nTransaction is easier to make.\r\n\r\n#### Actual behavior\r\n\r\nEmpty estimate & error message requires user to manual input.",
  "closed_by": {
    "login": "yenda",
    "id": 1181225,
    "node_id": "MDQ6VXNlcjExODEyMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1181225?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/yenda",
    "html_url": "https://github.com/yenda",
    "followers_url": "https://api.github.com/users/yenda/followers",
    "following_url": "https://api.github.com/users/yenda/following{/other_user}",
    "gists_url": "https://api.github.com/users/yenda/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/yenda/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/yenda/subscriptions",
    "organizations_url": "https://api.github.com/users/yenda/orgs",
    "repos_url": "https://api.github.com/users/yenda/repos",
    "events_url": "https://api.github.com/users/yenda/events{/privacy}",
    "received_events_url": "https://api.github.com/users/yenda/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/9876/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/9876/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/577149484",
    "html_url": "https://github.com/status-im/status-mobile/issues/9876#issuecomment-577149484",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/9876",
    "id": 577149484,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NzE0OTQ4NA==",
    "user": {
      "login": "rachelhamlin",
      "id": 15470435,
      "node_id": "MDQ6VXNlcjE1NDcwNDM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/15470435?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rachelhamlin",
      "html_url": "https://github.com/rachelhamlin",
      "followers_url": "https://api.github.com/users/rachelhamlin/followers",
      "following_url": "https://api.github.com/users/rachelhamlin/following{/other_user}",
      "gists_url": "https://api.github.com/users/rachelhamlin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rachelhamlin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rachelhamlin/subscriptions",
      "organizations_url": "https://api.github.com/users/rachelhamlin/orgs",
      "repos_url": "https://api.github.com/users/rachelhamlin/repos",
      "events_url": "https://api.github.com/users/rachelhamlin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rachelhamlin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-22T12:02:23Z",
    "updated_at": "2020-01-22T12:02:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "Sounds like another Infura issue. I have loads of SNT. ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/577149484/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/578223302",
    "html_url": "https://github.com/status-im/status-mobile/issues/9876#issuecomment-578223302",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/9876",
    "id": 578223302,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3ODIyMzMwMg==",
    "user": {
      "login": "yenda",
      "id": 1181225,
      "node_id": "MDQ6VXNlcjExODEyMjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1181225?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yenda",
      "html_url": "https://github.com/yenda",
      "followers_url": "https://api.github.com/users/yenda/followers",
      "following_url": "https://api.github.com/users/yenda/following{/other_user}",
      "gists_url": "https://api.github.com/users/yenda/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yenda/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yenda/subscriptions",
      "organizations_url": "https://api.github.com/users/yenda/orgs",
      "repos_url": "https://api.github.com/users/yenda/repos",
      "events_url": "https://api.github.com/users/yenda/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yenda/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-24T17:24:41Z",
    "updated_at": "2020-01-24T17:24:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "Was caused by call to `approve` instead of `approveAndCall` more than a year ago when the dapp for ens registration was being developed and tested.\r\n\r\nSolution was to first call `approve` with a value of 0 SNT\r\n\r\nNot related to infura\r\nProbably only concerns that specific accounts so doesn't require a fix in status\r\n\r\nStill here would be the solution proposed by @3esmit in case we have more users complaining about it:\r\n```\r\nyou could treat this case if u want, by:\r\n- if SNT.allowance(userAddress, UsernameRegistrar.address).call() == 0: \r\n- ~ SNT.approveAndCall(UsernameRegistrar.address,10^18, UsernameRegistrar.register(...).encodeABI()).send(). //encode register call in approveAndCall with 10 SNT\r\n- else:\r\n- ~ if SNT.allowance(userAddress, UsernameRegistrar.address).call() < 10^18: SNT.approve(UsernameRegistrar.address, 0).send() and  SNT.approveAndCall(UsernameRegistrar.address,10^18, UsernameRegistrar.register(...).encodeABI()).send() // clear approval and approveAndCall\r\n- ~ else: UsernameRegistrar.register(...).send()//direct call to username registrar\r\nIt might worth the effort if users start having problems, but I dont think anyone will run into this, because, only old users who already have an username would be affected, which are who?\r\nold users is like, before Sep 7, 2018\r\n```\r\n\r\nCareful though:\r\n- the error described is very generic, basically it just means that gas estimate failed, and it can be for various reasons, for instance it could be because the user doesn't have enough tokens for a particular transaction to succeed\r\n- when the error looks like this there is 0 chances infura is involved, because infura wouldn't fail consistently on the same account for the same transaction data and not others",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/578223302/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/578694525",
    "html_url": "https://github.com/status-im/status-mobile/issues/9876#issuecomment-578694525",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/9876",
    "id": 578694525,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3ODY5NDUyNQ==",
    "user": {
      "login": "rachelhamlin",
      "id": 15470435,
      "node_id": "MDQ6VXNlcjE1NDcwNDM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/15470435?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rachelhamlin",
      "html_url": "https://github.com/rachelhamlin",
      "followers_url": "https://api.github.com/users/rachelhamlin/followers",
      "following_url": "https://api.github.com/users/rachelhamlin/following{/other_user}",
      "gists_url": "https://api.github.com/users/rachelhamlin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rachelhamlin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rachelhamlin/subscriptions",
      "organizations_url": "https://api.github.com/users/rachelhamlin/orgs",
      "repos_url": "https://api.github.com/users/rachelhamlin/repos",
      "events_url": "https://api.github.com/users/rachelhamlin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rachelhamlin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-27T10:55:08Z",
    "updated_at": "2020-01-27T10:55:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "@yenda is a legend for fixing this for me.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/578694525/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
