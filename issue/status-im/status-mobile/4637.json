{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/4637",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/4637/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/4637/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/4637/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/4637",
  "id": 329431527,
  "node_id": "MDU6SXNzdWUzMjk0MzE1Mjc=",
  "number": 4637,
  "title": "Instabug survey gets shown after app restart",
  "user": {
    "login": "dmitryn",
    "id": 23836,
    "node_id": "MDQ6VXNlcjIzODM2",
    "avatar_url": "https://avatars.githubusercontent.com/u/23836?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dmitryn",
    "html_url": "https://github.com/dmitryn",
    "followers_url": "https://api.github.com/users/dmitryn/followers",
    "following_url": "https://api.github.com/users/dmitryn/following{/other_user}",
    "gists_url": "https://api.github.com/users/dmitryn/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dmitryn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dmitryn/subscriptions",
    "organizations_url": "https://api.github.com/users/dmitryn/orgs",
    "repos_url": "https://api.github.com/users/dmitryn/repos",
    "events_url": "https://api.github.com/users/dmitryn/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dmitryn/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 330296931,
      "node_id": "MDU6TGFiZWwzMzAyOTY5MzE=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2018-06-05T12:22:49Z",
  "updated_at": "2018-09-21T09:26:22Z",
  "closed_at": "2018-09-21T09:26:22Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Description\r\n\r\nWe're upgrading Instabug to 2.12.0 to make automatic surveys working again https://github.com/status-im/status-react/pull/4571\r\n\r\nAccording to docs survey should be shown right after condition is met (for example, user sends 5 messages), but now it also requires app to be restarted for survey to be shown.\r\n\r\n#### Expected behavior\r\nSurvey is shown after condition is met.\r\n\r\n#### Actual behavior\r\nSurvey is shown after condition is met and app restarted.\r\n\r\n### Reproduction\r\n[comment]: # (Describe how we can replicate the bug step by step.)\r\n\r\n- Open Status\r\n- Send 5 messages\r\n- Restart the app\r\n\r\n#### Logs\r\n\r\nHaving conversation with Instabug support:\r\n\r\n```\r\nHi! We don't see survey appearing on the phone after custom condition (based on user events) has been met https://dashboard.instabug.com/applications/status-6b2838c6-8064-445d-ae12-3c35e96f3a69/beta/surveys/2451\r\n2:38 pm\r\nZiad avatar\r\nHey Nastya, can you tell me Instabug's SDK version you are facing this problem on?\r\nAlso, manually triggering survey doesn't work. Survey doesnt show up https://dashboard.instabug.com/applications/status-6b2838c6-8064-445d-ae12-3c35e96f3a69/beta/surveys/2453\r\nWe use react-native 2.8.1\r\nZiad avatar\r\nThat's probably the problem. 2.8.1 is somehow an old version and we've done a lot of changes in our surveys since then. \r\nDo you mind updating your SDK version and give it a shot? \r\nWe use 2.8.1 in our previous release and manual surveys was working. I see, let me check\r\nZiad avatar\r\nIf you can give it a shot with updating your SDK version please that would be great as a first step do debug this together :)\r\nHey Ziad,\r\nJust tried version 2.12.0\r\nManual survey trigger works, automatic based on user events doesn't work\r\nZiad avatar\r\nThanks for the trial, Nastya. \r\nDo you allow me to access your dashboard and check this from my side? \r\nSure\r\nZiad avatar\r\nThanks a lot. I will check this and get back to you.\r\nJust saw automatic survey (no additional events have been sent), did you change something?\r\nAlso, there is \"App version\" condition can be set for surveys, how can we set \"app version\" parameter?\r\nZiad avatar\r\nI am still checking this. Haven't done any changes. \r\nTo be on the same page now, is the automatic survey working fine now? \r\nYes, it's working with 2.12.0\r\nZiad avatar\r\nYes you can control this while creating the survey. While setting the survey custom conditions. You can customize the survey to appear only to a specific app version. \r\nDo you need further elaboration for this?\r\nYes, how can we set app version parameter from the app? should we set it when we init instabug sdk?\r\nin other works, how instabug knows app version, where it gets app version from and in what format\r\n* in other words\r\nZiad avatar\r\nNo not at all. This should be done from the dashboard while you create the survey on the dashboard from the surveys section.\r\nAllow me please to share a screenshot on this for you that'll help. \r\nZiad avatar\r\nCan you have a look here please? \r\nThanks, Ziad. I've seen that. I'm not sure what value should i put there and in what format. Where instabug gets the app version from?\r\nCan i just set it to \"0.9.18 (6000)\" as it's presented in bug reports?\r\nAh okay. I got your question now.\r\nIf you check any of your bug reports, you'll see the app version as a part of the bug report state. \r\n\r\n\r\n\r\nThis is how Instabug parses the app version.\r\nZiad avatar\r\nSo yes exactly as you said. You can set it in that format.\r\nOk, i got it, thanks. Question about SDK compatibility. How do we know survey stop working in old sdk and we should upgrade? Is it announced in changelog? Or 2.8.1 still supposed to be working and you support backward compatibility?\r\nZiad avatar\r\nThat's absolutely valid. \r\nThe thing here is that we've done some changes in our surveys experience. We totally changed the experience to be a seamless one and we are adding analytics to it right now. \r\nAnalytics like the survey published on X number of devices, number of responses, number of dismisses, .. etc. \r\nWe tried to unify the experience that's why we blocked showing the survey on older SDK versions. \r\nApologies if this was not communicated clearly, we are aware we need to communicate this in a better way; however, we are working on doing this right nowðŸ˜Š\r\nJune 1\r\nHi Ziad,\r\nSurvey doesn't show automatically, but only on app restart. React Native 2.12.0, survey with pre-condition https://dashboard.instabug.com/applications/status-6b2838c6-8064-445d-ae12-3c35e96f3a69/beta/surveys/2451\r\nPeter avatar\r\nThanks Nastya for your feedback ðŸ˜Š\r\nIs it expected? Docs say it should be shown right after condition has been met\r\nPeter avatar\r\nCan you please try to un-install and re-install the app again and see if the survey will pop-up again?\r\nSame. Shown after app restart\r\nPeter avatar\r\nYou can then try to use this API o control when to re-show the survey after being dismissed one time.\r\n\r\nAlso, keep in mind that if the survey is taken/responded to, it won't appear again. \r\nIt was not dismissed, i saw it for first time. Docs saying \"By default, a survey will be presented as soon as the criteria set from the dashboard are met. \" in our case it only gets shown right after app restart\r\nYes, that should be the normal scenario.\r\nPeter avatar\r\nCan you send me a screenshot from the survey setup on the dashboard?\r\nhttps://www.dropbox.com/s/kz0ihilpr9e7jdh/Screenshot%202018-06-01%2017.03.00.png?dl=0\r\nPeter avatar\r\nI don't mean this page, would you please allow me to access your dashboard to investigate this behavior? I donâ€™t need to get your credentials, but I need your permission, please ðŸ˜Š \r\nyes please\r\nPeter avatar\r\nThank you ðŸ˜Š\r\nPeter avatar\r\nI can see that the survey is on draft now?\r\n\r\n\r\nThis survey is published https://dashboard.instabug.com/applications/status-6b2838c6-8064-445d-ae12-3c35e96f3a69/beta/surveys/2451\r\nPeter avatar\r\nThis message was deleted\r\nPeter avatar\r\nWhen you restart your app, is the cache erased?\r\nJune 4\r\nWhat cache do you mean? Not sure we reset something spefically\r\nIs this bug (survey is shown after app restart only) not reported by other Instabug users? Is it something specific happening to us only?\r\nPeter avatar\r\nThe survey should be shown only once per device.\r\n\r\nSo I am not sure why that is happening to your app, you may check while restarting if you reset anything because that may trigger that you didn't take the survey and that is why you can see it several times.\r\nIt's shown once but not when condition met, but when condition is met and app restarted.\r\nPeter avatar\r\nYes, did you take the survey and you saw it in the dashboard?\r\nyes\r\nPeter avatar\r\nIs it possible to check when you restart the app, do you clear the cache or there is a reset is occurring.\r\n\r\nBecause in this case the survey will pop-up every time.\r\nWhat do you mean by cache/reset? Is there corresponding Instabug API call for that?\r\nPeter avatar\r\nNo, but in this case the app when you re-open it. it will be triggered as a new device that is why the survey is shown again.\r\n\r\nIs it possible to try this scenario from another device?\r\n\r\nSame behavior. Condition is met, no survey is shown (waited for 1 minute after condition has been met). Restarted the app, survey is shown almost immediately (couple of seconds after app loaded)\r\nPeter avatar\r\nOk, I will check this further from my side and I'll get back to you.\r\n\r\nPeter avatar\r\nCan you please update me with your current SDK version?\r\n\r\n2.12.0\r\nPeter avatar\r\nThank you ðŸ˜Š\r\n```",
  "closed_by": {
    "login": "dmitryn",
    "id": 23836,
    "node_id": "MDQ6VXNlcjIzODM2",
    "avatar_url": "https://avatars.githubusercontent.com/u/23836?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dmitryn",
    "html_url": "https://github.com/dmitryn",
    "followers_url": "https://api.github.com/users/dmitryn/followers",
    "following_url": "https://api.github.com/users/dmitryn/following{/other_user}",
    "gists_url": "https://api.github.com/users/dmitryn/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dmitryn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dmitryn/subscriptions",
    "organizations_url": "https://api.github.com/users/dmitryn/orgs",
    "repos_url": "https://api.github.com/users/dmitryn/repos",
    "events_url": "https://api.github.com/users/dmitryn/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dmitryn/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/4637/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/4637/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/394689333",
    "html_url": "https://github.com/status-im/status-mobile/issues/4637#issuecomment-394689333",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/4637",
    "id": 394689333,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NDY4OTMzMw==",
    "user": {
      "login": "dmitryn",
      "id": 23836,
      "node_id": "MDQ6VXNlcjIzODM2",
      "avatar_url": "https://avatars.githubusercontent.com/u/23836?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dmitryn",
      "html_url": "https://github.com/dmitryn",
      "followers_url": "https://api.github.com/users/dmitryn/followers",
      "following_url": "https://api.github.com/users/dmitryn/following{/other_user}",
      "gists_url": "https://api.github.com/users/dmitryn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dmitryn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dmitryn/subscriptions",
      "organizations_url": "https://api.github.com/users/dmitryn/orgs",
      "repos_url": "https://api.github.com/users/dmitryn/repos",
      "events_url": "https://api.github.com/users/dmitryn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dmitryn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-05T12:24:19Z",
    "updated_at": "2018-06-05T12:24:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jpbowen i've posted conversation with Instabug support. Last message from them was received 21 hours ago.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/394689333/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
