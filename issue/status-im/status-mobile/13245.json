{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/13245",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/13245/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/13245/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/13245/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/13245",
  "id": 1189831987,
  "node_id": "I_kwDOAx4p2c5G62Uz",
  "number": 13245,
  "title": "PNs are not auto cleared after messages are read. (IOS and Android with turned on local notifications)",
  "user": {
    "login": "pavloburykh",
    "id": 97245802,
    "node_id": "U_kgDOBcvaag",
    "avatar_url": "https://avatars.githubusercontent.com/u/97245802?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pavloburykh",
    "html_url": "https://github.com/pavloburykh",
    "followers_url": "https://api.github.com/users/pavloburykh/followers",
    "following_url": "https://api.github.com/users/pavloburykh/following{/other_user}",
    "gists_url": "https://api.github.com/users/pavloburykh/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pavloburykh/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pavloburykh/subscriptions",
    "organizations_url": "https://api.github.com/users/pavloburykh/orgs",
    "repos_url": "https://api.github.com/users/pavloburykh/repos",
    "events_url": "https://api.github.com/users/pavloburykh/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pavloburykh/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 330296931,
      "node_id": "MDU6TGFiZWwzMzAyOTY5MzE=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    },
    {
      "id": 3990911030,
      "node_id": "LA_kwDOAx4p2c7t4Hg2",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/E:Bugfixes",
      "name": "E:Bugfixes",
      "color": "32BD0C",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "Parveshdhull",
    "id": 17097240,
    "node_id": "MDQ6VXNlcjE3MDk3MjQw",
    "avatar_url": "https://avatars.githubusercontent.com/u/17097240?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Parveshdhull",
    "html_url": "https://github.com/Parveshdhull",
    "followers_url": "https://api.github.com/users/Parveshdhull/followers",
    "following_url": "https://api.github.com/users/Parveshdhull/following{/other_user}",
    "gists_url": "https://api.github.com/users/Parveshdhull/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Parveshdhull/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Parveshdhull/subscriptions",
    "organizations_url": "https://api.github.com/users/Parveshdhull/orgs",
    "repos_url": "https://api.github.com/users/Parveshdhull/repos",
    "events_url": "https://api.github.com/users/Parveshdhull/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Parveshdhull/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "Parveshdhull",
      "id": 17097240,
      "node_id": "MDQ6VXNlcjE3MDk3MjQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/17097240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Parveshdhull",
      "html_url": "https://github.com/Parveshdhull",
      "followers_url": "https://api.github.com/users/Parveshdhull/followers",
      "following_url": "https://api.github.com/users/Parveshdhull/following{/other_user}",
      "gists_url": "https://api.github.com/users/Parveshdhull/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Parveshdhull/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Parveshdhull/subscriptions",
      "organizations_url": "https://api.github.com/users/Parveshdhull/orgs",
      "repos_url": "https://api.github.com/users/Parveshdhull/repos",
      "events_url": "https://api.github.com/users/Parveshdhull/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Parveshdhull/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2022-04-01T13:54:48Z",
  "updated_at": "2022-04-06T17:36:18Z",
  "closed_at": "2022-04-06T17:36:18Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "# Bug Report\r\n\r\n\r\nPNs are not automatically cleared after opening chat (1-1/group/ public) and reading unread messages. Bug is reproducible for IOS and Android with remote notifications on. For local notifications on Android everything works correct. \r\n\r\n### Reproduction \r\n\r\n1. Open Status on Device 1 (message receiver) and Device 2 (message sender)\r\n2. Enable notifications on Device 1\r\n3. In case if Device 1 is Android: turn on Remote notifications (Profile => Notifications => Remote notifications toggle ON) \r\n4. Device 1 starts chat with Device 2\r\n5. Close Device 1 \r\n6. Send message form Device 1 to Device 2 in order to generate PN on Device 1\r\n7. Open chat containing new message on Device 1\r\n8. Pay attention if PN disappeared after reading message on Device 1\r\n \r\n\r\n#### Actual behavior\r\nPN remains uncleared\r\n\r\n#### Expected behavior\r\nPN is cleared \r\n\r\n### Additional Information\r\n\r\n- Status version: nightly \r\n- Operating System: Android(with remote notifs ON), iOS\r\n\r\n\r\n[comment]: # (Please, add logs/notes if necessary)\r\n\r\n\r\nhttps://user-images.githubusercontent.com/97245802/161277859-a257e2f4-a828-4e95-9aa6-7b8eec9b06a9.mp4\r\n\r\n[geth.log](https://github.com/status-im/status-react/files/8398304/geth.log)\r\n",
  "closed_by": {
    "login": "Parveshdhull",
    "id": 17097240,
    "node_id": "MDQ6VXNlcjE3MDk3MjQw",
    "avatar_url": "https://avatars.githubusercontent.com/u/17097240?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Parveshdhull",
    "html_url": "https://github.com/Parveshdhull",
    "followers_url": "https://api.github.com/users/Parveshdhull/followers",
    "following_url": "https://api.github.com/users/Parveshdhull/following{/other_user}",
    "gists_url": "https://api.github.com/users/Parveshdhull/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Parveshdhull/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Parveshdhull/subscriptions",
    "organizations_url": "https://api.github.com/users/Parveshdhull/orgs",
    "repos_url": "https://api.github.com/users/Parveshdhull/repos",
    "events_url": "https://api.github.com/users/Parveshdhull/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Parveshdhull/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/13245/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/13245/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1086070386",
    "html_url": "https://github.com/status-im/status-mobile/issues/13245#issuecomment-1086070386",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/13245",
    "id": 1086070386,
    "node_id": "IC_kwDOAx4p2c5AvB5y",
    "user": {
      "login": "Parveshdhull",
      "id": 17097240,
      "node_id": "MDQ6VXNlcjE3MDk3MjQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/17097240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Parveshdhull",
      "html_url": "https://github.com/Parveshdhull",
      "followers_url": "https://api.github.com/users/Parveshdhull/followers",
      "following_url": "https://api.github.com/users/Parveshdhull/following{/other_user}",
      "gists_url": "https://api.github.com/users/Parveshdhull/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Parveshdhull/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Parveshdhull/subscriptions",
      "organizations_url": "https://api.github.com/users/Parveshdhull/orgs",
      "repos_url": "https://api.github.com/users/Parveshdhull/repos",
      "events_url": "https://api.github.com/users/Parveshdhull/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Parveshdhull/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-01T15:51:33Z",
    "updated_at": "2022-04-01T15:51:33Z",
    "author_association": "MEMBER",
    "body": "hi @pavloburykh, as remote push notifications don't have information about the sender, we don't know which notifications belong to opened chat.\r\none thing we can do is clear all notifications on opening any chat. Will that work?",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1086070386/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1086989435",
    "html_url": "https://github.com/status-im/status-mobile/issues/13245#issuecomment-1086989435",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/13245",
    "id": 1086989435,
    "node_id": "IC_kwDOAx4p2c5AyiR7",
    "user": {
      "login": "Parveshdhull",
      "id": 17097240,
      "node_id": "MDQ6VXNlcjE3MDk3MjQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/17097240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Parveshdhull",
      "html_url": "https://github.com/Parveshdhull",
      "followers_url": "https://api.github.com/users/Parveshdhull/followers",
      "following_url": "https://api.github.com/users/Parveshdhull/following{/other_user}",
      "gists_url": "https://api.github.com/users/Parveshdhull/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Parveshdhull/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Parveshdhull/subscriptions",
      "organizations_url": "https://api.github.com/users/Parveshdhull/orgs",
      "repos_url": "https://api.github.com/users/Parveshdhull/repos",
      "events_url": "https://api.github.com/users/Parveshdhull/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Parveshdhull/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-04T00:33:50Z",
    "updated_at": "2022-04-05T00:15:33Z",
    "author_association": "MEMBER",
    "body": "Also fixing some other issues related to notifications. Adding all here for reference:\r\n(Should I also create a separate issue?)\r\n### Updated Scope:\r\n- [x] Clear all remote notifications on opening any chat\r\n- [x] Clear user local notifications(for one-to-one chat) when a user is blocked\r\n- [x] Clear user local notifications(for one-to-one chat) when a user's chat is deleted\r\n- [x] Clear community chat notifications when leaving the community or Mark read \r\n- [x] Remove notifications from the activity center when leaving the community or Mark read \r\n- [x] Clear group chat notifications when leaving the group or Mark read \r\n- [x] Remove notifications from the activity center when leaving the group or Mark read ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1086989435/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1087381074",
    "html_url": "https://github.com/status-im/status-mobile/issues/13245#issuecomment-1087381074",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/13245",
    "id": 1087381074,
    "node_id": "IC_kwDOAx4p2c5A0B5S",
    "user": {
      "login": "pavloburykh",
      "id": 97245802,
      "node_id": "U_kgDOBcvaag",
      "avatar_url": "https://avatars.githubusercontent.com/u/97245802?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pavloburykh",
      "html_url": "https://github.com/pavloburykh",
      "followers_url": "https://api.github.com/users/pavloburykh/followers",
      "following_url": "https://api.github.com/users/pavloburykh/following{/other_user}",
      "gists_url": "https://api.github.com/users/pavloburykh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pavloburykh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pavloburykh/subscriptions",
      "organizations_url": "https://api.github.com/users/pavloburykh/orgs",
      "repos_url": "https://api.github.com/users/pavloburykh/repos",
      "events_url": "https://api.github.com/users/pavloburykh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pavloburykh/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-04T10:26:19Z",
    "updated_at": "2022-04-04T10:36:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "> hi @pavloburykh, as remote push notifications don't have information about the sender, we don't know which notifications belong to opened chat. one thing we can do is clear all notifications on opening any chat. Will that work?\r\n\r\nHi @Parveshdhull For now, clearing all notifications on opening any chat might be fine solution. Although, if to look in perspective, there is a feature request https://github.com/status-im/status-react/issues/11715 about showing a content of remote PNs. \r\nSo, my question is:\r\n1. Is it theoretically possible in future to implement a feature request about showing a content of remote PNs (described here https://github.com/status-im/status-react/issues/11715)?\r\n2. If it is possible, then current clearing all notifications on opening any chat might not be best solution after implementation of feature about showing a content of remote PNs. Please, share your opinion on that @Parveshdhull ? \r\n3. So, will we be able in future to somehow solve issue of clearing PNs after reading the exact messages those PNs belong to? Or it's totally impossible even in case of refactoring or re-implementation of remote notifications? ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1087381074/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1087383087",
    "html_url": "https://github.com/status-im/status-mobile/issues/13245#issuecomment-1087383087",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/13245",
    "id": 1087383087,
    "node_id": "IC_kwDOAx4p2c5A0CYv",
    "user": {
      "login": "pavloburykh",
      "id": 97245802,
      "node_id": "U_kgDOBcvaag",
      "avatar_url": "https://avatars.githubusercontent.com/u/97245802?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pavloburykh",
      "html_url": "https://github.com/pavloburykh",
      "followers_url": "https://api.github.com/users/pavloburykh/followers",
      "following_url": "https://api.github.com/users/pavloburykh/following{/other_user}",
      "gists_url": "https://api.github.com/users/pavloburykh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pavloburykh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pavloburykh/subscriptions",
      "organizations_url": "https://api.github.com/users/pavloburykh/orgs",
      "repos_url": "https://api.github.com/users/pavloburykh/repos",
      "events_url": "https://api.github.com/users/pavloburykh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pavloburykh/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-04T10:28:20Z",
    "updated_at": "2022-04-04T10:28:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Also fixing some other issues related to notifications. Adding all here for reference: (Should I also create a separate issue?)\r\n> \r\n> ### Updated Scope:\r\n> * [x]  Clear all remote notifications on opening any chat\r\n> * [x]  Clear user local notifications when a user is blocked\r\n> * [x]  Clear user local notifications when a user's chat is deleted\r\n> * [x]  Clear community chat notifications when Mark all read pressed in community\r\n> * [x]  Remove notifications from the activity center when Mark all read pressed in community\r\n> * [x]  Clear community chat notifications when a user leaves the community\r\n> * [x]  Remove notifications from the activity center when a user leaves the community\r\n\r\n@Parveshdhull thank you for your great work! Regarding separate issues, I think it's totally up to you. ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1087383087/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1087396050",
    "html_url": "https://github.com/status-im/status-mobile/issues/13245#issuecomment-1087396050",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/13245",
    "id": 1087396050,
    "node_id": "IC_kwDOAx4p2c5A0FjS",
    "user": {
      "login": "Parveshdhull",
      "id": 17097240,
      "node_id": "MDQ6VXNlcjE3MDk3MjQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/17097240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Parveshdhull",
      "html_url": "https://github.com/Parveshdhull",
      "followers_url": "https://api.github.com/users/Parveshdhull/followers",
      "following_url": "https://api.github.com/users/Parveshdhull/following{/other_user}",
      "gists_url": "https://api.github.com/users/Parveshdhull/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Parveshdhull/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Parveshdhull/subscriptions",
      "organizations_url": "https://api.github.com/users/Parveshdhull/orgs",
      "repos_url": "https://api.github.com/users/Parveshdhull/repos",
      "events_url": "https://api.github.com/users/Parveshdhull/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Parveshdhull/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-04T10:42:04Z",
    "updated_at": "2022-04-04T10:42:04Z",
    "author_association": "MEMBER",
    "body": "> Is it theoretically possible in future to implement a feature request about showing a content of remote PNs\r\n\r\nI think it is possible, but it will be tricky. We need to make sure that the app handles remote notifications delivery instead of the system, so we can decrypt those notifications(somehow) and deliver with content.\r\n\r\n> If it is possible, then current clearing all notifications on opening any chat might not be best solution after implementation of feature about showing a content of remote PNs.\r\n\r\nAs we don't have any timeline on feature implementation, I think we can keep this clearing of all remote notifications on opening any chat for now so that the user's notification center doesn't get cluttered.\r\n\r\n> So, will we be able in future to somehow solve issue of clearing PNs after reading the exact messages those PNs belong to? Or it's totally impossible even in case of refactoring or re-implementation of remote notifications?\r\n\r\nOnce we find the solution of delivering encrypted notifications, I think clearing will not be an issue",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1087396050/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
