{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/3336",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/3336/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/3336/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/3336/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/3336",
  "id": 297361322,
  "node_id": "MDU6SXNzdWUyOTczNjEzMjI=",
  "number": 3336,
  "title": "[Perf] User story 4: Time lags navigating to chat with 200 unread messages",
  "user": {
    "login": "Serhy",
    "id": 8749671,
    "node_id": "MDQ6VXNlcjg3NDk2NzE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8749671?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Serhy",
    "html_url": "https://github.com/Serhy",
    "followers_url": "https://api.github.com/users/Serhy/followers",
    "following_url": "https://api.github.com/users/Serhy/following{/other_user}",
    "gists_url": "https://api.github.com/users/Serhy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Serhy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Serhy/subscriptions",
    "organizations_url": "https://api.github.com/users/Serhy/orgs",
    "repos_url": "https://api.github.com/users/Serhy/repos",
    "events_url": "https://api.github.com/users/Serhy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Serhy/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 330296931,
      "node_id": "MDU6TGFiZWwzMzAyOTY5MzE=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    },
    {
      "id": 783781483,
      "node_id": "MDU6TGFiZWw3ODM3ODE0ODM=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/performance",
      "name": "performance",
      "color": "dd3bd8",
      "default": false,
      "description": null
    },
    {
      "id": 795655580,
      "node_id": "MDU6TGFiZWw3OTU2NTU1ODA=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/chat",
      "name": "chat",
      "color": "f70cb0",
      "default": false,
      "description": null
    },
    {
      "id": 946691481,
      "node_id": "MDU6TGFiZWw5NDY2OTE0ODE=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/mobile-app",
      "name": "mobile-app",
      "color": "f4e949",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "janherich",
    "id": 1910609,
    "node_id": "MDQ6VXNlcjE5MTA2MDk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1910609?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/janherich",
    "html_url": "https://github.com/janherich",
    "followers_url": "https://api.github.com/users/janherich/followers",
    "following_url": "https://api.github.com/users/janherich/following{/other_user}",
    "gists_url": "https://api.github.com/users/janherich/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/janherich/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/janherich/subscriptions",
    "organizations_url": "https://api.github.com/users/janherich/orgs",
    "repos_url": "https://api.github.com/users/janherich/repos",
    "events_url": "https://api.github.com/users/janherich/events{/privacy}",
    "received_events_url": "https://api.github.com/users/janherich/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "janherich",
      "id": 1910609,
      "node_id": "MDQ6VXNlcjE5MTA2MDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1910609?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/janherich",
      "html_url": "https://github.com/janherich",
      "followers_url": "https://api.github.com/users/janherich/followers",
      "following_url": "https://api.github.com/users/janherich/following{/other_user}",
      "gists_url": "https://api.github.com/users/janherich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/janherich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/janherich/subscriptions",
      "organizations_url": "https://api.github.com/users/janherich/orgs",
      "repos_url": "https://api.github.com/users/janherich/repos",
      "events_url": "https://api.github.com/users/janherich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/janherich/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": {
    "url": "https://api.github.com/repos/status-im/status-mobile/milestones/21",
    "html_url": "https://github.com/status-im/status-mobile/milestone/21",
    "labels_url": "https://api.github.com/repos/status-im/status-mobile/milestones/21/labels",
    "id": 3355444,
    "node_id": "MDk6TWlsZXN0b25lMzM1NTQ0NA==",
    "number": 21,
    "title": "Beta",
    "description": "Issues and blockers required for the Q2 beta release",
    "creator": {
      "login": "chadyj",
      "id": 116099,
      "node_id": "MDQ6VXNlcjExNjA5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/116099?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chadyj",
      "html_url": "https://github.com/chadyj",
      "followers_url": "https://api.github.com/users/chadyj/followers",
      "following_url": "https://api.github.com/users/chadyj/following{/other_user}",
      "gists_url": "https://api.github.com/users/chadyj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chadyj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chadyj/subscriptions",
      "organizations_url": "https://api.github.com/users/chadyj/orgs",
      "repos_url": "https://api.github.com/users/chadyj/repos",
      "events_url": "https://api.github.com/users/chadyj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chadyj/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 119,
    "state": "closed",
    "created_at": "2018-05-17T18:10:04Z",
    "updated_at": "2018-07-04T09:00:36Z",
    "due_on": "2018-06-20T07:00:00Z",
    "closed_at": "2018-07-04T09:00:36Z"
  },
  "comments": 13,
  "created_at": "2018-02-15T08:20:53Z",
  "updated_at": "2018-06-13T08:43:40Z",
  "closed_at": "2018-06-13T08:43:39Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "***Type***: Bug\r\n\r\n***Summary***: When ~200+ unread messages are present in the chat (public/group/1-1) - navigating to this chat has a noticeable app lag between user taps on the chat and chat screen appearance.\r\nIt depends from the device: for example on Samsung Galaxy Note 4 (real device) - it takes 10-12 seconds from the time when user taped on chat on Home screen with 200 unread messages till the actual chat screen with the messages appeared\r\n\r\nHowever, navigating to the same chat with all 'read' messages - significantly faster (delay <0.3 seconds)\r\n\r\n#### Expected behavior\r\nWhen contact navigates to chat with 200 unread messages - they appear with the same time value as if contact would navigate to the same chat with all read messages.\r\n\r\n#### Actual behavior\r\nWhen contact navigates to chat with 200 unread messages - it takes 30 times more for messages to appear than navigating to the same chat with all read messages.\r\n\r\nPrecondition: 200 unread messages sent to the contact\r\n### Reproduction\r\n\r\n- Open Status and log in to account\r\n- Wait till all the messages sent to account arrive (the counter of unread messages should stop incrementing)\r\n- Tap on the chat with 200 unread messages\r\n- Check the time when between you tap on chat from Home screen and when chat view with the messages load\r\n\r\n### Additional Information\r\n* Status version: 0.9.16-2-g1abd3c1a+\r\n* Operating System: Android, iOS\r\n\r\n#### Logs\r\nThere are no logs in TF of what happens during the discussed app freeze, but I believe somehow connected to sending the 'Seen' status for list messages.\r\nVideo of behavior navigating to chat with 200 unread messages: from 01:34 - is the time when contact taps on a chat with 200 unread messages. \r\nhttps://app.testfairy.com/projects/4803622-status/builds/8101280/sessions/27/?accessToken=-6aGtzW8RJTwTXdPHAjnS2aqqmA\r\n",
  "closed_by": {
    "login": "Serhy",
    "id": 8749671,
    "node_id": "MDQ6VXNlcjg3NDk2NzE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8749671?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Serhy",
    "html_url": "https://github.com/Serhy",
    "followers_url": "https://api.github.com/users/Serhy/followers",
    "following_url": "https://api.github.com/users/Serhy/following{/other_user}",
    "gists_url": "https://api.github.com/users/Serhy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Serhy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Serhy/subscriptions",
    "organizations_url": "https://api.github.com/users/Serhy/orgs",
    "repos_url": "https://api.github.com/users/Serhy/repos",
    "events_url": "https://api.github.com/users/Serhy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Serhy/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/3336/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/3336/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/365879140",
    "html_url": "https://github.com/status-im/status-mobile/issues/3336#issuecomment-365879140",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3336",
    "id": 365879140,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2NTg3OTE0MA==",
    "user": {
      "login": "janherich",
      "id": 1910609,
      "node_id": "MDQ6VXNlcjE5MTA2MDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1910609?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/janherich",
      "html_url": "https://github.com/janherich",
      "followers_url": "https://api.github.com/users/janherich/followers",
      "following_url": "https://api.github.com/users/janherich/following{/other_user}",
      "gists_url": "https://api.github.com/users/janherich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/janherich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/janherich/subscriptions",
      "organizations_url": "https://api.github.com/users/janherich/orgs",
      "repos_url": "https://api.github.com/users/janherich/repos",
      "events_url": "https://api.github.com/users/janherich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/janherich/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-02-15T10:02:19Z",
    "updated_at": "2018-02-15T10:02:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "This is super strange because we already had solved this exact issue some time ago - I will check if there was not some performance regression introduced very recently.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/365879140/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/381402531",
    "html_url": "https://github.com/status-im/status-mobile/issues/3336#issuecomment-381402531",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3336",
    "id": 381402531,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MTQwMjUzMQ==",
    "user": {
      "login": "Serhy",
      "id": 8749671,
      "node_id": "MDQ6VXNlcjg3NDk2NzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8749671?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Serhy",
      "html_url": "https://github.com/Serhy",
      "followers_url": "https://api.github.com/users/Serhy/followers",
      "following_url": "https://api.github.com/users/Serhy/following{/other_user}",
      "gists_url": "https://api.github.com/users/Serhy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Serhy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Serhy/subscriptions",
      "organizations_url": "https://api.github.com/users/Serhy/orgs",
      "repos_url": "https://api.github.com/users/Serhy/repos",
      "events_url": "https://api.github.com/users/Serhy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Serhy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-15T12:24:56Z",
    "updated_at": "2018-04-15T12:24:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "Since the new protocol introduced the behaviour has changed a little bit. \r\nIssue still takes place as described, however now instead of 'Unshadowing' of the actual messages in message bubbles we had before - lags are taken place on actual chat screen appearance. I.e. there is a delay when user taps on chat from Home screen with the number of unread messages and chat with the list of messages appear.\r\n\r\nI've updated the description with the new notes and with the new TF session.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/381402531/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/387758543",
    "html_url": "https://github.com/status-im/status-mobile/issues/3336#issuecomment-387758543",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3336",
    "id": 387758543,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4Nzc1ODU0Mw==",
    "user": {
      "login": "lukaszfryc",
      "id": 7532782,
      "node_id": "MDQ6VXNlcjc1MzI3ODI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7532782?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lukaszfryc",
      "html_url": "https://github.com/lukaszfryc",
      "followers_url": "https://api.github.com/users/lukaszfryc/followers",
      "following_url": "https://api.github.com/users/lukaszfryc/following{/other_user}",
      "gists_url": "https://api.github.com/users/lukaszfryc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lukaszfryc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lukaszfryc/subscriptions",
      "organizations_url": "https://api.github.com/users/lukaszfryc/orgs",
      "repos_url": "https://api.github.com/users/lukaszfryc/repos",
      "events_url": "https://api.github.com/users/lukaszfryc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lukaszfryc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-09T14:30:30Z",
    "updated_at": "2018-05-09T14:30:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "The issue is still there but it's not critical",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/387758543/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/392417068",
    "html_url": "https://github.com/status-im/status-mobile/issues/3336#issuecomment-392417068",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3336",
    "id": 392417068,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MjQxNzA2OA==",
    "user": {
      "login": "oskarth",
      "id": 1552237,
      "node_id": "MDQ6VXNlcjE1NTIyMzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1552237?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oskarth",
      "html_url": "https://github.com/oskarth",
      "followers_url": "https://api.github.com/users/oskarth/followers",
      "following_url": "https://api.github.com/users/oskarth/following{/other_user}",
      "gists_url": "https://api.github.com/users/oskarth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oskarth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oskarth/subscriptions",
      "organizations_url": "https://api.github.com/users/oskarth/orgs",
      "repos_url": "https://api.github.com/users/oskarth/repos",
      "events_url": "https://api.github.com/users/oskarth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oskarth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-28T04:38:53Z",
    "updated_at": "2018-05-28T04:38:53Z",
    "author_association": "CONTRIBUTOR",
    "body": "What's the state of this issue? Is it still a beta blocker?",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/392417068/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/392528995",
    "html_url": "https://github.com/status-im/status-mobile/issues/3336#issuecomment-392528995",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3336",
    "id": 392528995,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MjUyODk5NQ==",
    "user": {
      "login": "Serhy",
      "id": 8749671,
      "node_id": "MDQ6VXNlcjg3NDk2NzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8749671?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Serhy",
      "html_url": "https://github.com/Serhy",
      "followers_url": "https://api.github.com/users/Serhy/followers",
      "following_url": "https://api.github.com/users/Serhy/following{/other_user}",
      "gists_url": "https://api.github.com/users/Serhy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Serhy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Serhy/subscriptions",
      "organizations_url": "https://api.github.com/users/Serhy/orgs",
      "repos_url": "https://api.github.com/users/Serhy/repos",
      "events_url": "https://api.github.com/users/Serhy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Serhy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-28T13:36:48Z",
    "updated_at": "2018-05-28T13:36:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "It takes 2 seconds now to open chat with 200 new unread messages on the Galaxy Note 4 (and 8-10 seconds chat with 1000 messages)\r\nFor me, such numbers are definitely not a Beta blocker.\r\n\r\nThe goal is not reached though. There is a difference whether contact navigates to chat with the messages that already seen and unread messages. \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/392528995/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/392531177",
    "html_url": "https://github.com/status-im/status-mobile/issues/3336#issuecomment-392531177",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3336",
    "id": 392531177,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MjUzMTE3Nw==",
    "user": {
      "login": "janherich",
      "id": 1910609,
      "node_id": "MDQ6VXNlcjE5MTA2MDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1910609?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/janherich",
      "html_url": "https://github.com/janherich",
      "followers_url": "https://api.github.com/users/janherich/followers",
      "following_url": "https://api.github.com/users/janherich/following{/other_user}",
      "gists_url": "https://api.github.com/users/janherich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/janherich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/janherich/subscriptions",
      "organizations_url": "https://api.github.com/users/janherich/orgs",
      "repos_url": "https://api.github.com/users/janherich/repos",
      "events_url": "https://api.github.com/users/janherich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/janherich/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-28T13:45:54Z",
    "updated_at": "2018-05-28T13:45:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "@Serhy just for the record, what's the difference between opening chat with 1000 new unread/unseen messages (8-10s as you stated) and chat with 1000 red/seen messages ?",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/392531177/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/392547953",
    "html_url": "https://github.com/status-im/status-mobile/issues/3336#issuecomment-392547953",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3336",
    "id": 392547953,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MjU0Nzk1Mw==",
    "user": {
      "login": "Serhy",
      "id": 8749671,
      "node_id": "MDQ6VXNlcjg3NDk2NzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8749671?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Serhy",
      "html_url": "https://github.com/Serhy",
      "followers_url": "https://api.github.com/users/Serhy/followers",
      "following_url": "https://api.github.com/users/Serhy/following{/other_user}",
      "gists_url": "https://api.github.com/users/Serhy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Serhy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Serhy/subscriptions",
      "organizations_url": "https://api.github.com/users/Serhy/orgs",
      "repos_url": "https://api.github.com/users/Serhy/repos",
      "events_url": "https://api.github.com/users/Serhy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Serhy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-28T14:55:47Z",
    "updated_at": "2018-05-28T14:55:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "@janherich Navigating to public chat with 1000 read messages happens really fast, I would say <0.3 seconds. 8-10 seconds when unread message relates to public chat too (not only 1-1 / group).\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/392547953/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/394444187",
    "html_url": "https://github.com/status-im/status-mobile/issues/3336#issuecomment-394444187",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3336",
    "id": 394444187,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NDQ0NDE4Nw==",
    "user": {
      "login": "rasom",
      "id": 2364994,
      "node_id": "MDQ6VXNlcjIzNjQ5OTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2364994?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rasom",
      "html_url": "https://github.com/rasom",
      "followers_url": "https://api.github.com/users/rasom/followers",
      "following_url": "https://api.github.com/users/rasom/following{/other_user}",
      "gists_url": "https://api.github.com/users/rasom/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rasom/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rasom/subscriptions",
      "organizations_url": "https://api.github.com/users/rasom/orgs",
      "repos_url": "https://api.github.com/users/rasom/repos",
      "events_url": "https://api.github.com/users/rasom/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rasom/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-04T17:59:23Z",
    "updated_at": "2018-06-04T17:59:25Z",
    "author_association": "MEMBER",
    "body": "@Serhy i just tested this scenario \r\n> Open Status and log in to account\r\nWait till all the messages sent to account arrive (the counter of unread messages should stop incrementing)\r\nTap on the chat with 200 unread messages\r\nCheck the time when between you tap on chat from Home screen and when chat view with the messages load\r\n\r\non my galaxy note 4, using this build\r\n> Release build \r\nTests: :+1:)\r\nAndroid: http://artifacts.status.im:8081/artifactory/nightlies-local/im.status.ethereum-783f26-rel.apk\r\niOS: https://i.diawi.com/gsHT2m\r\n\r\nand it takes approximately 2.5-2.9s \n\n<blockquote></blockquote>\n<blockquote><div><strong><a href=\"https://i.diawi.com/gsHT2m\">Install - Diawi - Development and In-house Apps Wireless Installation</a></strong></div></blockquote>",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/394444187/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/394529980",
    "html_url": "https://github.com/status-im/status-mobile/issues/3336#issuecomment-394529980",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3336",
    "id": 394529980,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NDUyOTk4MA==",
    "user": {
      "login": "janherich",
      "id": 1910609,
      "node_id": "MDQ6VXNlcjE5MTA2MDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1910609?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/janherich",
      "html_url": "https://github.com/janherich",
      "followers_url": "https://api.github.com/users/janherich/followers",
      "following_url": "https://api.github.com/users/janherich/following{/other_user}",
      "gists_url": "https://api.github.com/users/janherich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/janherich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/janherich/subscriptions",
      "organizations_url": "https://api.github.com/users/janherich/orgs",
      "repos_url": "https://api.github.com/users/janherich/repos",
      "events_url": "https://api.github.com/users/janherich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/janherich/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-04T23:17:17Z",
    "updated_at": "2018-06-04T23:17:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "I spent some time evaluating the issue and here are my findings:\r\n\r\nOn moderately fast platform (Galaxy note 5 in Genymotion Emulator), the biggest culprit for bad performance when navigating to chat with unread messages is the function marking the messages as seen - https://github.com/status-im/status-react/blob/develop/src/status_im/chat/events.cljs#L225-L251\r\nThe function has to iterate over all loaded messages and to set operations which can be quite expensive on platform with poorer js performance.\r\n\r\nOne scenario which I tested was joining the #status channel on new account, immediately navigating back, waiting till all messages are received (takes just couple of seconds) and then navigating to chat again, with some 2-3 seconds lag.\r\n\r\nWhen testing in repl, the function `mark-messages-seen` took over 400ms to compute the results with 1.8k new (unseen) messages, which is quite bad, because it means that only this computation causes 25 dropped frames at minimum and it's linearly growing so when somebody joins very busy public chats with 5000 new messages, it's noticeably worse.\r\n\r\nThe solution seems to be to not iterate over all the (loaded) messages naively each time chat is opened but maintain an 2 layer index `message-state->user->message` which will enable us to select all messages eligible for `seen` marking super fast, with almost no performance hit even with very big number of messages.\r\n\n\n<blockquote><img src=\"https://avatars3.githubusercontent.com/u/11767950?s=400&v=4\" width=\"48\" align=\"right\"><div><img src=\"https://assets-cdn.github.com/favicon.ico\" height=\"14\"> GitHub</div><div><strong><a href=\"https://github.com/status-im/status-react\">status-im/status-react</a></strong></div><div>status-react - a free (libre) open source, mobile OS for Ethereum</div></blockquote>",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/394529980/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/394604863",
    "html_url": "https://github.com/status-im/status-mobile/issues/3336#issuecomment-394604863",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3336",
    "id": 394604863,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NDYwNDg2Mw==",
    "user": {
      "login": "rasom",
      "id": 2364994,
      "node_id": "MDQ6VXNlcjIzNjQ5OTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2364994?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rasom",
      "html_url": "https://github.com/rasom",
      "followers_url": "https://api.github.com/users/rasom/followers",
      "following_url": "https://api.github.com/users/rasom/following{/other_user}",
      "gists_url": "https://api.github.com/users/rasom/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rasom/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rasom/subscriptions",
      "organizations_url": "https://api.github.com/users/rasom/orgs",
      "repos_url": "https://api.github.com/users/rasom/repos",
      "events_url": "https://api.github.com/users/rasom/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rasom/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-05T07:09:39Z",
    "updated_at": "2018-06-05T07:26:07Z",
    "author_association": "MEMBER",
    "body": "@janherich is this enough as quick fix for pubchats? https://github.com/status-im/status-react/commit/7d5e6d5f0f5bb6632c40417d0966952298c72d02\r\nit works ~3 times faster with this change, and as, most likely, we more often will have 200+ unseen messages in public chats than in 1-1 it should be enough as a first step ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/394604863/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/396163602",
    "html_url": "https://github.com/status-im/status-mobile/issues/3336#issuecomment-396163602",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3336",
    "id": 396163602,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjE2MzYwMg==",
    "user": {
      "login": "oskarth",
      "id": 1552237,
      "node_id": "MDQ6VXNlcjE1NTIyMzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1552237?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/oskarth",
      "html_url": "https://github.com/oskarth",
      "followers_url": "https://api.github.com/users/oskarth/followers",
      "following_url": "https://api.github.com/users/oskarth/following{/other_user}",
      "gists_url": "https://api.github.com/users/oskarth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/oskarth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/oskarth/subscriptions",
      "organizations_url": "https://api.github.com/users/oskarth/orgs",
      "repos_url": "https://api.github.com/users/oskarth/repos",
      "events_url": "https://api.github.com/users/oskarth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/oskarth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-11T08:28:56Z",
    "updated_at": "2018-06-11T08:28:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "In its current state, is this a strict beta blocker? Or is it more something we'd really want to (keep) improving?\r\n\r\nIf it's the latter, how about we remove it from beta milestone but keep working on it (barring any other beta blockers)?",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/396163602/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/396205966",
    "html_url": "https://github.com/status-im/status-mobile/issues/3336#issuecomment-396205966",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3336",
    "id": 396205966,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NjIwNTk2Ng==",
    "user": {
      "login": "mandrigin",
      "id": 466427,
      "node_id": "MDQ6VXNlcjQ2NjQyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/466427?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mandrigin",
      "html_url": "https://github.com/mandrigin",
      "followers_url": "https://api.github.com/users/mandrigin/followers",
      "following_url": "https://api.github.com/users/mandrigin/following{/other_user}",
      "gists_url": "https://api.github.com/users/mandrigin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mandrigin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mandrigin/subscriptions",
      "organizations_url": "https://api.github.com/users/mandrigin/orgs",
      "repos_url": "https://api.github.com/users/mandrigin/repos",
      "events_url": "https://api.github.com/users/mandrigin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mandrigin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-11T11:05:05Z",
    "updated_at": "2018-06-11T11:05:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "Let's keep it in the list and re-evaluate when #4660 is merged.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/396205966/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/396851051",
    "html_url": "https://github.com/status-im/status-mobile/issues/3336#issuecomment-396851051",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/3336",
    "id": 396851051,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5Njg1MTA1MQ==",
    "user": {
      "login": "Serhy",
      "id": 8749671,
      "node_id": "MDQ6VXNlcjg3NDk2NzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8749671?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Serhy",
      "html_url": "https://github.com/Serhy",
      "followers_url": "https://api.github.com/users/Serhy/followers",
      "following_url": "https://api.github.com/users/Serhy/following{/other_user}",
      "gists_url": "https://api.github.com/users/Serhy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Serhy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Serhy/subscriptions",
      "organizations_url": "https://api.github.com/users/Serhy/orgs",
      "repos_url": "https://api.github.com/users/Serhy/repos",
      "events_url": "https://api.github.com/users/Serhy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Serhy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-13T08:04:29Z",
    "updated_at": "2018-06-13T08:04:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "#4660 has been closed. \r\n\r\nAt this moment on lastest nighlty develop build (449th Jenkins build, 13th of June) on Galaxy Note 4 when a user navigates to public chat with ~500 unread messages the time delay between a tap on chat from Home screen till the messages appear (along with the app responsiveness) -> it takes ~2 seconds. In 1-1 chat with ~200 unread messages, it's 1-2 seconds.\r\n\r\nThese figures allow us to not only exclude issue from Beta-blockers list but I'm absolutely fine to close it as \"Fixed\". \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/396851051/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
