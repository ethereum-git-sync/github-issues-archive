{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/6210",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/6210/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/6210/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/6210/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/6210",
  "id": 368164439,
  "node_id": "MDU6SXNzdWUzNjgxNjQ0Mzk=",
  "number": 6210,
  "title": "'Unknown' username on user Profile for contact who received message with no contact-request ",
  "user": {
    "login": "Serhy",
    "id": 8749671,
    "node_id": "MDQ6VXNlcjg3NDk2NzE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8749671?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Serhy",
    "html_url": "https://github.com/Serhy",
    "followers_url": "https://api.github.com/users/Serhy/followers",
    "following_url": "https://api.github.com/users/Serhy/following{/other_user}",
    "gists_url": "https://api.github.com/users/Serhy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Serhy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Serhy/subscriptions",
    "organizations_url": "https://api.github.com/users/Serhy/orgs",
    "repos_url": "https://api.github.com/users/Serhy/repos",
    "events_url": "https://api.github.com/users/Serhy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Serhy/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 330296931,
      "node_id": "MDU6TGFiZWwzMzAyOTY5MzE=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    },
    {
      "id": 955294273,
      "node_id": "MDU6TGFiZWw5NTUyOTQyNzM=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/medium-severity",
      "name": "medium-severity",
      "color": "e884a7",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "siphiuel",
    "id": 1019573,
    "node_id": "MDQ6VXNlcjEwMTk1NzM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1019573?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/siphiuel",
    "html_url": "https://github.com/siphiuel",
    "followers_url": "https://api.github.com/users/siphiuel/followers",
    "following_url": "https://api.github.com/users/siphiuel/following{/other_user}",
    "gists_url": "https://api.github.com/users/siphiuel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/siphiuel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/siphiuel/subscriptions",
    "organizations_url": "https://api.github.com/users/siphiuel/orgs",
    "repos_url": "https://api.github.com/users/siphiuel/repos",
    "events_url": "https://api.github.com/users/siphiuel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/siphiuel/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "siphiuel",
      "id": 1019573,
      "node_id": "MDQ6VXNlcjEwMTk1NzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1019573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/siphiuel",
      "html_url": "https://github.com/siphiuel",
      "followers_url": "https://api.github.com/users/siphiuel/followers",
      "following_url": "https://api.github.com/users/siphiuel/following{/other_user}",
      "gists_url": "https://api.github.com/users/siphiuel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/siphiuel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/siphiuel/subscriptions",
      "organizations_url": "https://api.github.com/users/siphiuel/orgs",
      "repos_url": "https://api.github.com/users/siphiuel/repos",
      "events_url": "https://api.github.com/users/siphiuel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/siphiuel/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2018-10-09T11:29:46Z",
  "updated_at": "2018-12-06T10:13:03Z",
  "closed_at": "2018-12-06T10:12:55Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "***Type***: Bug\r\n\r\n*Summary*: When contact receives a message with no contact request we still offer 'Add to contacts' option. However, on user Profile screen such contact username displayed as `Unknown`. \r\nIn the case I tap 'Add to contacts' and 'Send message' from this profile, - the 1-1 chat with `Unknown` user created.\r\nPlease see steps to reproduce to see when it's possible for contact to receive a message without contact request.\r\n**Note:** It's all fine on mobile app.\r\n\r\n#### Expected behavior\r\nNo errors when contact adds a new contact, even there was no contact request.\r\nDefault three-words username is displayed on Profile screen for user who received a message without contact request\r\n\r\n#### Actual behavior\r\nDefault contact name is `Unknown` when you look at the contact profile who didn't sent contact request.\r\n<img width=\"1011\" alt=\"screenshot 2018-11-30 at 16 06 49\" src=\"https://user-images.githubusercontent.com/8749671/49294461-b35bce00-f4bb-11e8-9c5f-dbe4a28cd4ae.png\">\r\n\r\n\r\n### Reproduction from scratch:\r\n\r\n1) Open Status on Device 1 (mobile app) and Device 2 (desktop app)\r\n2) Create new account on Device1 (Contact1) and new account on Device2 (Contact2)\r\n3) Join some unique public chat (e.g. blahuniquesquirrel) with both contacts\r\n4) Contact2 sends a text message in public chat\r\n5) Contact1 sees the message and taps Contact2's user icon to navigate to profile screen\r\n6) Contact1 taps Send transaction option (NOTE: if #6895 is fixed - then further steps may need to be updated)\r\n7) Contact1, - from 1-1 chat sends a message (doesn't matter transaction as the option offered or text message)\r\n8) Contact2 receives message from Contact1 and navigates to it's Profile screen.\r\n**Actual result:** Unknown username is displayed.\r\n**Expected result:** Default three-words username of the Contact1 displayed.\r\n9) Contact2 tap `Add to contacts`\r\n10) Contact2 taps `Send message`\r\n**Actual result:** New 1-1 chat with Unknown user created. Any message sent in this unknown chat are lost in space.\r\n**Expected result:** Contact2 redirected to 1-1 chat with Contact1 \r\n\r\n### Additional Information\r\n* Status version: Develop `8ee407b56` (nightly develop build 29th of Nov 2018)\r\n* Operating System: MacOS",
  "closed_by": {
    "login": "churik",
    "id": 4557972,
    "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/churik",
    "html_url": "https://github.com/churik",
    "followers_url": "https://api.github.com/users/churik/followers",
    "following_url": "https://api.github.com/users/churik/following{/other_user}",
    "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
    "organizations_url": "https://api.github.com/users/churik/orgs",
    "repos_url": "https://api.github.com/users/churik/repos",
    "events_url": "https://api.github.com/users/churik/events{/privacy}",
    "received_events_url": "https://api.github.com/users/churik/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/6210/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/6210/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/433618490",
    "html_url": "https://github.com/status-im/status-mobile/issues/6210#issuecomment-433618490",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/6210",
    "id": 433618490,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMzYxODQ5MA==",
    "user": {
      "login": "churik",
      "id": 4557972,
      "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/churik",
      "html_url": "https://github.com/churik",
      "followers_url": "https://api.github.com/users/churik/followers",
      "following_url": "https://api.github.com/users/churik/following{/other_user}",
      "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
      "organizations_url": "https://api.github.com/users/churik/orgs",
      "repos_url": "https://api.github.com/users/churik/repos",
      "events_url": "https://api.github.com/users/churik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/churik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-27T13:03:25Z",
    "updated_at": "2018-10-27T13:03:25Z",
    "author_association": "MEMBER",
    "body": "Still reproducible. There is no popup with `contact.whisper-identity must be of type 'string' got 'null' `, but still can see `Unknown` in user profile.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/433618490/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/443161775",
    "html_url": "https://github.com/status-im/status-mobile/issues/6210#issuecomment-443161775",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/6210",
    "id": 443161775,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MzE2MTc3NQ==",
    "user": {
      "login": "chadyj",
      "id": 116099,
      "node_id": "MDQ6VXNlcjExNjA5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/116099?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chadyj",
      "html_url": "https://github.com/chadyj",
      "followers_url": "https://api.github.com/users/chadyj/followers",
      "following_url": "https://api.github.com/users/chadyj/following{/other_user}",
      "gists_url": "https://api.github.com/users/chadyj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chadyj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chadyj/subscriptions",
      "organizations_url": "https://api.github.com/users/chadyj/orgs",
      "repos_url": "https://api.github.com/users/chadyj/repos",
      "events_url": "https://api.github.com/users/chadyj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chadyj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-30T10:32:58Z",
    "updated_at": "2018-11-30T10:32:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "Still reproducible? @churik @Serhy ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/443161775/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/443215374",
    "html_url": "https://github.com/status-im/status-mobile/issues/6210#issuecomment-443215374",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/6210",
    "id": 443215374,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0MzIxNTM3NA==",
    "user": {
      "login": "Serhy",
      "id": 8749671,
      "node_id": "MDQ6VXNlcjg3NDk2NzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8749671?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Serhy",
      "html_url": "https://github.com/Serhy",
      "followers_url": "https://api.github.com/users/Serhy/followers",
      "following_url": "https://api.github.com/users/Serhy/following{/other_user}",
      "gists_url": "https://api.github.com/users/Serhy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Serhy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Serhy/subscriptions",
      "organizations_url": "https://api.github.com/users/Serhy/orgs",
      "repos_url": "https://api.github.com/users/Serhy/repos",
      "events_url": "https://api.github.com/users/Serhy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Serhy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-30T14:14:00Z",
    "updated_at": "2018-11-30T14:14:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "@chadyj Yes, it is.\r\nSo original steps from description are not reproducible anymore. I suspect this is because messages *and contact-request* are received from mailservers after account recover (some time ago, when this issue originally noticed and created we did not send requests for history for the new messages after account recover)\r\n\r\nAt the moment there are two use cases which can lead to 'Unknown' contact name in User profile on desktop app. First scenario we need to confirm (it require to wait 24h+) and second scenario gives ability to reproduce right away.\r\n\r\n### Steps to reproduce #1:\r\n\r\n1) Open Status on Device 1 (e.g. mobile app), Device2 (e.g. another Mobile App) and on Desktop app\r\n2) Create new account on Device1 (Contact1)\r\n3) Recover an account on Device2 (Contact2): (e.g. `foot code blue abandon system veteran rare broom satisfy quit aerobic final`)\r\n4) Contact1 adds a new contact (Contact2) and sends a text message.\r\n5) Contact2 receves message from Contact1, sees 'Add to contacts' option. Contact2 tap 'Add to contacts'\r\n6) Contact2 waits >24h (this is offline inbox timing interval we request message history)\r\n7) Contact2 recovers account on Desktop app (to recover `foot code blue abandon system veteran rare broom satisfy quit aerobic final` for our example)\r\n7) Contact1 from mobile app sends a text message to Contact2\r\n8) Contact2 on Desktop app navigates to Profile page of the Contact1\r\n\r\n### Steps to reproduce #2:\r\n\r\n1) Open Status on Device 1 (mobile app) and Device 2 (desktop app)\r\n2) Create new account on Device1 (Contact1) and new account on Device2 (Contact2)\r\n3) Join some unique public chat (e.g. `blahuniquesquirrel`) with both contacts\r\n4) Contact2 sends a text message in public chat\r\n5) Contact1 sees the message and taps Contact2's user icon to navigate to profile screen\r\n6) Contact1 taps `Send transaction` option (NOTE: if #6895 is fixed - then further steps may need to be updated)\r\n7) Contact1, - from 1-1 chat sends a message (doesn't matter transaction as the option offered or text message)\r\n8) Contact2 receives message from Contact1 and navigates to it's Profile screen.\r\n**Actual result:**  Unknown username is displayed. \r\n**Expected result:** Default three-words username of the Contact1 displayed. \r\n9) Contact2 tap `Add to contacts` \r\n10) Contact2 taps `Send message`\r\n**Actual result:** New 1-1 chat with `Unknown` user created. Any message sent in this unknown chat are lost in space. \r\n\r\nI'm updating the description and title of the issue to show relevant data.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/443215374/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/443748284",
    "html_url": "https://github.com/status-im/status-mobile/issues/6210#issuecomment-443748284",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/6210",
    "id": 443748284,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0Mzc0ODI4NA==",
    "user": {
      "login": "SlizkovaGanna",
      "id": 43638377,
      "node_id": "MDQ6VXNlcjQzNjM4Mzc3",
      "avatar_url": "https://avatars.githubusercontent.com/u/43638377?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SlizkovaGanna",
      "html_url": "https://github.com/SlizkovaGanna",
      "followers_url": "https://api.github.com/users/SlizkovaGanna/followers",
      "following_url": "https://api.github.com/users/SlizkovaGanna/following{/other_user}",
      "gists_url": "https://api.github.com/users/SlizkovaGanna/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SlizkovaGanna/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SlizkovaGanna/subscriptions",
      "organizations_url": "https://api.github.com/users/SlizkovaGanna/orgs",
      "repos_url": "https://api.github.com/users/SlizkovaGanna/repos",
      "events_url": "https://api.github.com/users/SlizkovaGanna/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SlizkovaGanna/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-03T15:23:35Z",
    "updated_at": "2018-12-03T15:23:35Z",
    "author_association": "NONE",
    "body": "Retested on the last nightly from 03/12/2018 (after https://github.com/status-im/status-react/pull/6671 was merged) for Scenario #2 - it does not reproduce.\r\nTested for scenario #1 and will update this comment in 24 hours\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/443748284/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/444820060",
    "html_url": "https://github.com/status-im/status-mobile/issues/6210#issuecomment-444820060",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/6210",
    "id": 444820060,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NDgyMDA2MA==",
    "user": {
      "login": "churik",
      "id": 4557972,
      "node_id": "MDQ6VXNlcjQ1NTc5NzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4557972?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/churik",
      "html_url": "https://github.com/churik",
      "followers_url": "https://api.github.com/users/churik/followers",
      "following_url": "https://api.github.com/users/churik/following{/other_user}",
      "gists_url": "https://api.github.com/users/churik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/churik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/churik/subscriptions",
      "organizations_url": "https://api.github.com/users/churik/orgs",
      "repos_url": "https://api.github.com/users/churik/repos",
      "events_url": "https://api.github.com/users/churik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/churik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-06T10:12:55Z",
    "updated_at": "2018-12-06T10:13:03Z",
    "author_association": "MEMBER",
    "body": "is not reproduced anymore",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/444820060/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
