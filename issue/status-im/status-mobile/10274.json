{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/10274",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/10274/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/10274/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/10274/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/10274",
  "id": 594347396,
  "node_id": "MDU6SXNzdWU1OTQzNDczOTY=",
  "number": 10274,
  "title": "Chat screen is flickering",
  "user": {
    "login": "flexsurfer",
    "id": 11790366,
    "node_id": "MDQ6VXNlcjExNzkwMzY2",
    "avatar_url": "https://avatars.githubusercontent.com/u/11790366?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/flexsurfer",
    "html_url": "https://github.com/flexsurfer",
    "followers_url": "https://api.github.com/users/flexsurfer/followers",
    "following_url": "https://api.github.com/users/flexsurfer/following{/other_user}",
    "gists_url": "https://api.github.com/users/flexsurfer/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/flexsurfer/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/flexsurfer/subscriptions",
    "organizations_url": "https://api.github.com/users/flexsurfer/orgs",
    "repos_url": "https://api.github.com/users/flexsurfer/repos",
    "events_url": "https://api.github.com/users/flexsurfer/events{/privacy}",
    "received_events_url": "https://api.github.com/users/flexsurfer/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 330296931,
      "node_id": "MDU6TGFiZWwzMzAyOTY5MzE=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    },
    {
      "id": 517247009,
      "node_id": "MDU6TGFiZWw1MTcyNDcwMDk=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/high-priority",
      "name": "high-priority",
      "color": "000000",
      "default": false,
      "description": null
    },
    {
      "id": 956251551,
      "node_id": "MDU6TGFiZWw5NTYyNTE1NTE=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/high-severity",
      "name": "high-severity",
      "color": "c91a34",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2020-04-05T09:16:39Z",
  "updated_at": "2020-04-29T18:48:06Z",
  "closed_at": "2020-04-16T13:54:17Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "# Bug Report\n\nversion 1.1.0 iPhone\n## Problem\n\nPoor Majestic Icelandgull:\nIt just jumps, as if it’s refreshing the chat. \nFor example, if you scroll up a few messages and then someone sends a new message to the chat, you will notice the chat jump so you know a new message has appeared. \nNow imagine this happening instantly every 4/5 seconds.\nIt’s not doing it now. But if I came out of status and then came back in half an hour it would probably be doing it again. \nIt’s intermittent but when it does happen, it happens a lot. \n\n**But the other day I typed a reply to someone and when I hit send the message just disappeared due to the flickering.**\n\n#### Expected behavior\n\nno flickering",
  "closed_by": {
    "login": "cammellos",
    "id": 1017008,
    "node_id": "MDQ6VXNlcjEwMTcwMDg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1017008?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cammellos",
    "html_url": "https://github.com/cammellos",
    "followers_url": "https://api.github.com/users/cammellos/followers",
    "following_url": "https://api.github.com/users/cammellos/following{/other_user}",
    "gists_url": "https://api.github.com/users/cammellos/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cammellos/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cammellos/subscriptions",
    "organizations_url": "https://api.github.com/users/cammellos/orgs",
    "repos_url": "https://api.github.com/users/cammellos/repos",
    "events_url": "https://api.github.com/users/cammellos/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cammellos/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/10274/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/10274/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/609891697",
    "html_url": "https://github.com/status-im/status-mobile/issues/10274#issuecomment-609891697",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/10274",
    "id": 609891697,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwOTg5MTY5Nw==",
    "user": {
      "login": "flexsurfer",
      "id": 11790366,
      "node_id": "MDQ6VXNlcjExNzkwMzY2",
      "avatar_url": "https://avatars.githubusercontent.com/u/11790366?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/flexsurfer",
      "html_url": "https://github.com/flexsurfer",
      "followers_url": "https://api.github.com/users/flexsurfer/followers",
      "following_url": "https://api.github.com/users/flexsurfer/following{/other_user}",
      "gists_url": "https://api.github.com/users/flexsurfer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/flexsurfer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/flexsurfer/subscriptions",
      "organizations_url": "https://api.github.com/users/flexsurfer/orgs",
      "repos_url": "https://api.github.com/users/flexsurfer/repos",
      "events_url": "https://api.github.com/users/flexsurfer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/flexsurfer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-06T16:14:56Z",
    "updated_at": "2020-04-06T16:14:56Z",
    "author_association": "MEMBER",
    "body": "reproduced this one",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/609891697/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/609904666",
    "html_url": "https://github.com/status-im/status-mobile/issues/10274#issuecomment-609904666",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/10274",
    "id": 609904666,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwOTkwNDY2Ng==",
    "user": {
      "login": "flexsurfer",
      "id": 11790366,
      "node_id": "MDQ6VXNlcjExNzkwMzY2",
      "avatar_url": "https://avatars.githubusercontent.com/u/11790366?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/flexsurfer",
      "html_url": "https://github.com/flexsurfer",
      "followers_url": "https://api.github.com/users/flexsurfer/followers",
      "following_url": "https://api.github.com/users/flexsurfer/following{/other_user}",
      "gists_url": "https://api.github.com/users/flexsurfer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/flexsurfer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/flexsurfer/subscriptions",
      "organizations_url": "https://api.github.com/users/flexsurfer/orgs",
      "repos_url": "https://api.github.com/users/flexsurfer/repos",
      "events_url": "https://api.github.com/users/flexsurfer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/flexsurfer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-06T16:38:56Z",
    "updated_at": "2020-04-06T16:38:56Z",
    "author_association": "MEMBER",
    "body": "![image](https://user-images.githubusercontent.com/11790366/78582625-daf04280-7835-11ea-8f26-f7422ad7b34f.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/609904666/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/609907954",
    "html_url": "https://github.com/status-im/status-mobile/issues/10274#issuecomment-609907954",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/10274",
    "id": 609907954,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwOTkwNzk1NA==",
    "user": {
      "login": "flexsurfer",
      "id": 11790366,
      "node_id": "MDQ6VXNlcjExNzkwMzY2",
      "avatar_url": "https://avatars.githubusercontent.com/u/11790366?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/flexsurfer",
      "html_url": "https://github.com/flexsurfer",
      "followers_url": "https://api.github.com/users/flexsurfer/followers",
      "following_url": "https://api.github.com/users/flexsurfer/following{/other_user}",
      "gists_url": "https://api.github.com/users/flexsurfer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/flexsurfer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/flexsurfer/subscriptions",
      "organizations_url": "https://api.github.com/users/flexsurfer/orgs",
      "repos_url": "https://api.github.com/users/flexsurfer/repos",
      "events_url": "https://api.github.com/users/flexsurfer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/flexsurfer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-06T16:45:16Z",
    "updated_at": "2020-04-06T16:45:16Z",
    "author_association": "MEMBER",
    "body": "https://drive.google.com/file/d/1Mkw4oF9pTxiESxJoQZG4AmqPeFBqSE6a/view?usp=sharing",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/609907954/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/609913579",
    "html_url": "https://github.com/status-im/status-mobile/issues/10274#issuecomment-609913579",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/10274",
    "id": 609913579,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwOTkxMzU3OQ==",
    "user": {
      "login": "cammellos",
      "id": 1017008,
      "node_id": "MDQ6VXNlcjEwMTcwMDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1017008?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cammellos",
      "html_url": "https://github.com/cammellos",
      "followers_url": "https://api.github.com/users/cammellos/followers",
      "following_url": "https://api.github.com/users/cammellos/following{/other_user}",
      "gists_url": "https://api.github.com/users/cammellos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cammellos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cammellos/subscriptions",
      "organizations_url": "https://api.github.com/users/cammellos/orgs",
      "repos_url": "https://api.github.com/users/cammellos/repos",
      "events_url": "https://api.github.com/users/cammellos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cammellos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-06T16:55:25Z",
    "updated_at": "2020-04-06T16:55:25Z",
    "author_association": "MEMBER",
    "body": "Nice, thanks\r\nThis happens because we offload messages, and then we hit `onEndReached` and we load them back.\r\n\r\nBasically we should offload message up to `onEndReached` and no more, so that offloading messages does not trigger it.\r\n\r\nI will take a look at it tomorrow.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/609913579/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/610791683",
    "html_url": "https://github.com/status-im/status-mobile/issues/10274#issuecomment-610791683",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/10274",
    "id": 610791683,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMDc5MTY4Mw==",
    "user": {
      "login": "cammellos",
      "id": 1017008,
      "node_id": "MDQ6VXNlcjEwMTcwMDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1017008?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cammellos",
      "html_url": "https://github.com/cammellos",
      "followers_url": "https://api.github.com/users/cammellos/followers",
      "following_url": "https://api.github.com/users/cammellos/following{/other_user}",
      "gists_url": "https://api.github.com/users/cammellos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cammellos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cammellos/subscriptions",
      "organizations_url": "https://api.github.com/users/cammellos/orgs",
      "repos_url": "https://api.github.com/users/cammellos/repos",
      "events_url": "https://api.github.com/users/cammellos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cammellos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-08T07:12:00Z",
    "updated_at": "2020-04-08T07:12:14Z",
    "author_association": "MEMBER",
    "body": "Steps to replicate:\r\n\r\n1) Open a public chat\r\n2) Publish a very long message\r\n3) Reply to that message, with a very long message\r\n4) Repeat step 3\r\n\r\nThe screen will start flickering every 5s\r\n\r\nThe issue is that for some messages (the ones that are not loaded from the database, for example if you posted them yourself or just received), we use a subscription for the reply text. \r\n\r\nThis is because replies might come out of order, for example you receive first the message that has a reply, but you haven't received the reply yet, eventually you receive the reply.\r\n\r\nIn this case, once we offload the message from the database, the reply will disappear, and then is loaded back again as we reached `onEndReached`, and it appears again, which counts as a scroll, re-triggering the behavior.\r\n\r\nOne solution is to make sure that the reply is stored always in the message, which means more work needs to be done on receiving the message, but would avoid this scenario.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/610791683/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
