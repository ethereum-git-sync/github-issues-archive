{
  "url": "https://api.github.com/repos/status-im/status-mobile/issues/16714",
  "repository_url": "https://api.github.com/repos/status-im/status-mobile",
  "labels_url": "https://api.github.com/repos/status-im/status-mobile/issues/16714/labels{/name}",
  "comments_url": "https://api.github.com/repos/status-im/status-mobile/issues/16714/comments",
  "events_url": "https://api.github.com/repos/status-im/status-mobile/issues/16714/events",
  "html_url": "https://github.com/status-im/status-mobile/issues/16714",
  "id": 1809650755,
  "node_id": "I_kwDOAx4p2c5r3RRD",
  "number": 16714,
  "title": "Android performance issues",
  "user": {
    "login": "pavloburykh",
    "id": 97245802,
    "node_id": "U_kgDOBcvaag",
    "avatar_url": "https://avatars.githubusercontent.com/u/97245802?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pavloburykh",
    "html_url": "https://github.com/pavloburykh",
    "followers_url": "https://api.github.com/users/pavloburykh/followers",
    "following_url": "https://api.github.com/users/pavloburykh/following{/other_user}",
    "gists_url": "https://api.github.com/users/pavloburykh/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pavloburykh/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pavloburykh/subscriptions",
    "organizations_url": "https://api.github.com/users/pavloburykh/orgs",
    "repos_url": "https://api.github.com/users/pavloburykh/repos",
    "events_url": "https://api.github.com/users/pavloburykh/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pavloburykh/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 783781483,
      "node_id": "MDU6TGFiZWw3ODM3ODE0ODM=",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/E:Mobile%20Performance%20MVP",
      "name": "E:Mobile Performance MVP",
      "color": "dd3bd8",
      "default": false,
      "description": ""
    },
    {
      "id": 5818300473,
      "node_id": "LA_kwDOAx4p2c8AAAABWsw4OQ",
      "url": "https://api.github.com/repos/status-im/status-mobile/labels/E:Mobile%20Release%201.26",
      "name": "E:Mobile Release 1.26",
      "color": "B240A1",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "Parveshdhull",
    "id": 17097240,
    "node_id": "MDQ6VXNlcjE3MDk3MjQw",
    "avatar_url": "https://avatars.githubusercontent.com/u/17097240?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Parveshdhull",
    "html_url": "https://github.com/Parveshdhull",
    "followers_url": "https://api.github.com/users/Parveshdhull/followers",
    "following_url": "https://api.github.com/users/Parveshdhull/following{/other_user}",
    "gists_url": "https://api.github.com/users/Parveshdhull/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Parveshdhull/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Parveshdhull/subscriptions",
    "organizations_url": "https://api.github.com/users/Parveshdhull/orgs",
    "repos_url": "https://api.github.com/users/Parveshdhull/repos",
    "events_url": "https://api.github.com/users/Parveshdhull/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Parveshdhull/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "Parveshdhull",
      "id": 17097240,
      "node_id": "MDQ6VXNlcjE3MDk3MjQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/17097240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Parveshdhull",
      "html_url": "https://github.com/Parveshdhull",
      "followers_url": "https://api.github.com/users/Parveshdhull/followers",
      "following_url": "https://api.github.com/users/Parveshdhull/following{/other_user}",
      "gists_url": "https://api.github.com/users/Parveshdhull/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Parveshdhull/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Parveshdhull/subscriptions",
      "organizations_url": "https://api.github.com/users/Parveshdhull/orgs",
      "repos_url": "https://api.github.com/users/Parveshdhull/repos",
      "events_url": "https://api.github.com/users/Parveshdhull/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Parveshdhull/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": {
    "url": "https://api.github.com/repos/status-im/status-mobile/milestones/69",
    "html_url": "https://github.com/status-im/status-mobile/milestone/69",
    "labels_url": "https://api.github.com/repos/status-im/status-mobile/milestones/69/labels",
    "id": 9699548,
    "node_id": "MI_kwDOAx4p2c4AlADc",
    "number": 69,
    "title": "1.26.0 - Alpha",
    "description": "Mobile dev team priorities In priority order:\r\n\r\n**1. Finish anything that wasn't completed in the previous 1.25 cycle**\r\n\r\n**2. Select which accounts to share with each Community's control node**\r\n- Designs should be ready for review and dev feedback by 18th September\r\n\r\n**3. Fix bugs, both functional and UX fit-and-finish defects.**  \r\n\r\n- Great progress during 1.25 on fixing UX fit-and-finish defects :-)  Let's aim to close all issue tagged \"E:Design Feedback 1.24\" by the end of this cycle.\r\n\r\n- Test all Communities functionality using the Public Test Community that will feature all types of token gating that Iuri is going to set up.  \r\n\r\n- Test how Status Mobile responds to community admin changes are made in Status Desktop e.g. when a channel is added or deleted or renamed, is the correctly reflected in Status Mobile?  Are changes to Community meta info like name and banner image correctly reflected in Status Mobile?  Etc, etc...\r\n\r\n- We need to get our quality bar to where we want it to be, and then keep tech. debt at a roughly fixed level as we build out any additional functionality.\r\n\r\n- Going forward, as much as is sensible, all new functionality should meet the higher quality bar we are aiming for before landing.\r\n\r\n**4. Fix any remaining issues related to syncing with Desktop**\r\n\r\n**5. Implement the OOBE light/dark theme selector screen**\r\n- Only if the design for this is ready in time, otherwise it's ok if this happens next cycle\r\n\r\n**--- Things that should NOT be worked on this cycle ---**\r\n\r\n- We shouldn't start anything in Settings or Profile related\r\n\r\n\r\n------------------------\r\n\r\n**Mobile Wallet dev team priority:**\r\n\r\n- Continue building out Mobile wallet MVP\r\n",
    "creator": {
      "login": "John-44",
      "id": 22846356,
      "node_id": "MDQ6VXNlcjIyODQ2MzU2",
      "avatar_url": "https://avatars.githubusercontent.com/u/22846356?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/John-44",
      "html_url": "https://github.com/John-44",
      "followers_url": "https://api.github.com/users/John-44/followers",
      "following_url": "https://api.github.com/users/John-44/following{/other_user}",
      "gists_url": "https://api.github.com/users/John-44/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/John-44/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/John-44/subscriptions",
      "organizations_url": "https://api.github.com/users/John-44/orgs",
      "repos_url": "https://api.github.com/users/John-44/repos",
      "events_url": "https://api.github.com/users/John-44/events{/privacy}",
      "received_events_url": "https://api.github.com/users/John-44/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 23,
    "closed_issues": 63,
    "state": "open",
    "created_at": "2023-07-26T12:45:31Z",
    "updated_at": "2023-11-02T07:31:53Z",
    "due_on": "2023-11-09T08:00:00Z",
    "closed_at": null
  },
  "comments": 5,
  "created_at": "2023-07-18T10:30:29Z",
  "updated_at": "2023-11-02T10:42:53Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Status app has significant performance issues on Android.\r\nThat is not really noticeable on Google Pixel, but you can see how it looks on Samsung Galaxy A52 (Android 12)\r\nspecs: https://www.gsmarena.com/samsung_galaxy_a52-10641.php - it is quite good device.\r\n\r\n\r\nhttps://github.com/status-im/status-mobile/assets/97245802/13a464da-33c6-4138-a8e3-712862762964\r\n\r\n**Steps:** \r\n\r\n1. Create different types of chats/comunities\r\n2. Generate some chat history with different types of messages\r\n3. Scroll through chat history, interact with chat elements (composer, context menus, bottom sheets etc)\r\n4. Pay attention if performance is ok\r\n\r\nActual result: poor performance can be observed. Animation is laggy and twitchy. \r\n\r\n\r\n### Additional Information\r\n\r\n- Status version: nightly \r\n- Operating System: Android\r\n\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/16714/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/status-im/status-mobile/issues/16714/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1663698184",
    "html_url": "https://github.com/status-im/status-mobile/issues/16714#issuecomment-1663698184",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/16714",
    "id": 1663698184,
    "node_id": "IC_kwDOAx4p2c5jKgUI",
    "user": {
      "login": "Parveshdhull",
      "id": 17097240,
      "node_id": "MDQ6VXNlcjE3MDk3MjQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/17097240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Parveshdhull",
      "html_url": "https://github.com/Parveshdhull",
      "followers_url": "https://api.github.com/users/Parveshdhull/followers",
      "following_url": "https://api.github.com/users/Parveshdhull/following{/other_user}",
      "gists_url": "https://api.github.com/users/Parveshdhull/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Parveshdhull/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Parveshdhull/subscriptions",
      "organizations_url": "https://api.github.com/users/Parveshdhull/orgs",
      "repos_url": "https://api.github.com/users/Parveshdhull/repos",
      "events_url": "https://api.github.com/users/Parveshdhull/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Parveshdhull/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-03T10:01:45Z",
    "updated_at": "2023-08-03T10:01:45Z",
    "author_association": "MEMBER",
    "body": "Hi @pavloburykh, Thank you very much for reporting this issue.\r\nIn https://github.com/status-im/status-mobile/pull/16433 for toast animations we started to use layout animations. And in the current version of reanimated layout animations are not that stable and causing weird problems like https://github.com/status-im/status-mobile/issues/16693.\r\n\r\nPlease can you confirm if performance issues happen just after the start of the app, or after a few toasts are shown (like contact request accepted, etc.). If issue only happens once toasts are shown, please can you try build from https://github.com/status-im/status-mobile/pull/16729 and check if issue also present there.",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1663698184/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1664065175",
    "html_url": "https://github.com/status-im/status-mobile/issues/16714#issuecomment-1664065175",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/16714",
    "id": 1664065175,
    "node_id": "IC_kwDOAx4p2c5jL56X",
    "user": {
      "login": "pavloburykh",
      "id": 97245802,
      "node_id": "U_kgDOBcvaag",
      "avatar_url": "https://avatars.githubusercontent.com/u/97245802?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pavloburykh",
      "html_url": "https://github.com/pavloburykh",
      "followers_url": "https://api.github.com/users/pavloburykh/followers",
      "following_url": "https://api.github.com/users/pavloburykh/following{/other_user}",
      "gists_url": "https://api.github.com/users/pavloburykh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pavloburykh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pavloburykh/subscriptions",
      "organizations_url": "https://api.github.com/users/pavloburykh/orgs",
      "repos_url": "https://api.github.com/users/pavloburykh/repos",
      "events_url": "https://api.github.com/users/pavloburykh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pavloburykh/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-03T14:13:22Z",
    "updated_at": "2023-08-03T14:13:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "\r\n\r\n> Hi @pavloburykh, Thank you very much for reporting this issue. In #16433 for toast animations we started to use layout animations. And in the current version of reanimated layout animations are not that stable and causing weird problems like #16693.\r\n> \r\n> Please can you confirm if performance issues happen just after the start of the app, or after a few toasts are shown (like contact request accepted, etc.). If issue only happens once toasts are shown, please can you try build from #16729 and check if issue also present there.\r\n\r\nHi @Parveshdhull! Thank you for looking at this issue. \r\n\r\nI have checked build from https://github.com/status-im/status-mobile/pull/16729 and can confirm that performance issues still exist. It doesn't seem to me that issue is related to toast appearing as interface starts lagging even without toasts being shown.\r\n\r\n@Parveshdhull sorry that I didn't help much. I will try to investigate in future to understand what exactly causing the issues. Cause for some time after app is just being opened performance seems to be ok but after scrolling chat history which contains images, link previews, long messages - interface starts lagging. \r\n\r\nHere is a video recorded on build from https://github.com/status-im/status-mobile/pull/16729\r\n\r\nhttps://github.com/status-im/status-mobile/assets/97245802/8abb6c41-9080-4c8b-9194-fcd4776af72c\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1664065175/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1729503047",
    "html_url": "https://github.com/status-im/status-mobile/issues/16714#issuecomment-1729503047",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/16714",
    "id": 1729503047,
    "node_id": "IC_kwDOAx4p2c5nFh9H",
    "user": {
      "login": "Parveshdhull",
      "id": 17097240,
      "node_id": "MDQ6VXNlcjE3MDk3MjQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/17097240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Parveshdhull",
      "html_url": "https://github.com/Parveshdhull",
      "followers_url": "https://api.github.com/users/Parveshdhull/followers",
      "following_url": "https://api.github.com/users/Parveshdhull/following{/other_user}",
      "gists_url": "https://api.github.com/users/Parveshdhull/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Parveshdhull/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Parveshdhull/subscriptions",
      "organizations_url": "https://api.github.com/users/Parveshdhull/orgs",
      "repos_url": "https://api.github.com/users/Parveshdhull/repos",
      "events_url": "https://api.github.com/users/Parveshdhull/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Parveshdhull/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-21T12:50:25Z",
    "updated_at": "2023-09-21T12:50:25Z",
    "author_association": "MEMBER",
    "body": "Related information: https://www.notion.so/App-Performance-a9ad728b6bf4449ba3a394241e406524",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1729503047/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1776721533",
    "html_url": "https://github.com/status-im/status-mobile/issues/16714#issuecomment-1776721533",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/16714",
    "id": 1776721533,
    "node_id": "IC_kwDOAx4p2c5p5p59",
    "user": {
      "login": "Parveshdhull",
      "id": 17097240,
      "node_id": "MDQ6VXNlcjE3MDk3MjQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/17097240?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Parveshdhull",
      "html_url": "https://github.com/Parveshdhull",
      "followers_url": "https://api.github.com/users/Parveshdhull/followers",
      "following_url": "https://api.github.com/users/Parveshdhull/following{/other_user}",
      "gists_url": "https://api.github.com/users/Parveshdhull/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Parveshdhull/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Parveshdhull/subscriptions",
      "organizations_url": "https://api.github.com/users/Parveshdhull/orgs",
      "repos_url": "https://api.github.com/users/Parveshdhull/repos",
      "events_url": "https://api.github.com/users/Parveshdhull/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Parveshdhull/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-24T08:05:11Z",
    "updated_at": "2023-11-02T10:42:53Z",
    "author_association": "MEMBER",
    "body": "## Update\r\n\r\n### Flashlist\r\n\r\nAs mentioned in the above notion document, the app works well after opening, but after some time performance starts to degrade. So it might be related to high memory usage and leaking.\r\n\r\nThe article (https://www.bam.tech/article/measuring-react-native-performance-with-flashlight) compares performances of flash-list and flat-list and shows a significant decrease in memory usage. So I tried this library in our app and found out some limitations of this library.\r\n\r\n#### 1. Blank spaces\r\n##### How does flash-list improve the app performance?\r\n> Unlike FlatList, FlashList uses recycling. Basically items do not get unmounted-remounted anymore, instead items disappearing from the screen are reused for new items appearing by changing their prop.\r\n\r\nFor this, We need to provide a prop `estimatedItemSize` to flash-list\r\n\r\n> estimatedItemSize is a single numeric value that hints FlashList about the approximate size of the items before they're rendered. FlashList can then use this information to decide how many items it needs to draw on the screen before initial load and while scrolling.\r\n\r\nThe value for this number is suggested(if not provided) and printed in metro logs by the library as a warning message.\r\n\r\nBut this technique for improving performance is causing blank spaces when scrolling fast in our chat screen as shown in the below video. (even with small estimatedItemSize)\r\n\r\n<details>\r\n  <summary> Video </summary>\r\n \r\n<div align=\"center\">\r\n\r\nhttps://github.com/status-im/status-mobile/assets/17097240/3c45f15d-bad2-4a8c-b97a-b3f5cb9affcc\r\n\r\n</div>\r\n\r\n</details>\r\n\r\nhttps://github.com/Shopify/flash-list/issues/868#issuecomment-1702471170 mentions that flash-list has these problems when we have different sizes of items in list (as in our case, messages, image, links etc.)\r\nAlso https://github.com/Shopify/flash-list/issues/618 mentions the problem with fast scrolling and for that [recommended solution](https://github.com/Shopify/flash-list/issues/618#issuecomment-1268647300) is to optimize the items/components. More details on [optimzation](https://shopify.github.io/flash-list/docs/fundamentals/performant-components).\r\n\r\n#### 2. Problem with `columnWrapperStyle`\r\n\r\nOur current implementation is not working well for jump-to screen when migrating to flash-list as `columnWrapperStyle` don't work for it.\r\n\r\n<div align=\"center\">\r\n<img src=\"https://github.com/status-im/status-mobile/assets/17097240/7503e398-3224-47e5-a0f7-0fbc1ffe835e\" alt=\"Screenshot\" height=\"200\"/>\r\n</div>\r\n\r\nThere is probably a work around for this issue, by adding required margins etc in cards itself. Currently we are just using `justify-content :space-between`, to create same effect we need to use screen width and card size etc. Issue is fixable but further complicates implementation.\r\n\r\nFrom initial implementation it didn't looked like there was much drop in memory usage by using flash-list. And we also need to optimize components to get rid of blank spaces and might need to decrease scroll speed etc. Not sure if all these will fix the issues thougs.\r\n\r\n### Memory consumption\r\n\r\nCurrently memory consumption is very high, and with every close and open of chat screen it keeps adding up, as can be be seen as ladder like pattern in below screenshot.\r\n\r\n<div align=\"center\">\r\n<img src=\"https://github.com/status-im/status-mobile/assets/17097240/a129b2b0-3bef-45d5-90ff-ed804edd0dff\" alt=\"Screenshot\" height=\"200\"/>\r\n</div>\r\n\r\nWhile trying to find out which component is causing this problem, I tried to remove 1 by 1 big components and measure increase in memory consumption using flash light, these were results. _(while opening and closing of 1-1 chat 10 times)_\r\n\r\n- Without any change = 175 MB Increase\r\n- Removed chat list = 156 MB Increase\r\n- \\+ Removed navigation top bar = 111 MB Increase\r\n- \\+ Removed composer = 20 MB Increase\r\n\r\nExtra, Only removing composer = 90 MB Increase\r\n\r\nThese results are not sufficient enough to tell why memory is not freeing after closing the screen. **This pattern was also visible with native navigation, surprisingly same 175 MB Increase.**\r\n\r\nWhile using flashlight we need to consider its not reliable way to measure as it can give varying results based on device environment and resources. I also tried to use leak-canary using flipper, but for some reason my app is not being detected by it.\r\n\r\n### Improvement Scope\r\n#### Navigation\r\n\r\n##### How we differ from native navigation?\r\nSome of details about navigation can be found in [this](https://www.notion.so/Navigation-597d2359318d40b89a5d90d57cf08910) notion document. \r\n\r\n**First what's common.**\r\nSimilar to our navigation system, native navigation also keeps previous screens rendered and active re-frame subscriptions active in the background.\r\n\r\n**And What's different**\r\n1. React Native Tree Size -  Native navigation pushes native screen while navigation and renders new React Native Root inside that. Smaller tree size helps updating components etc. This is the major drawback of our custom navigation we are not able to fix.\r\n2.  Animations - As Native navigation don't allow that much customization, there animations are somewhat simple.\r\n\r\n**Example**, if we open a community chat from switcher card\r\nNative navigation - Just pushes a chat screen with simple slide animation from right or bottom\r\nShell navigation - Opens chat screen with a zoom animation from a particular point in screen (switcher card position), with animating position, width, height, border radius etc. And in the background we open community screen, open community home, update switcher card position.\r\n\r\nSo, as we can see there are so much going on in case of shell navigation which we have to keep if we want to keep all the perks of jump-to navigation and cool animations.\r\n\r\nOk, that was limitations, now let's discuss what is better(or can be).\r\n\r\nAs shell navigation is custom navigation system it gives complete freedom to us for improving performance. Currently we are destroying and recreating screen while navigating. But if we optimize and simplify screens enough, we can keep them rendered.\r\nThis is the main thing which makes flash list and our bottom tabs implementation have very good performance. If we are not re-mounting big and heavy components like composer, navigation bar, loading skeleton etc. every time it can significantly improve chat opening time, which is not possible with native navigation system and causes [stumbled opening](https://github.com/status-im/status-mobile/pull/15636#issuecomment-1514440268) of the screen.\r\n\r\n#### Things we should do to improve performance\r\n- As we have seen tree size is problem, we should avoid using subscriptions and reagent atoms in roots components. Because it will lead to rerender whole screen\r\n- Use smaller subscriptions and in child views instead of parent. This will also help in keeping screens rendered, as  whole screen is not re-rendering when we are navigating to different chat or community etc.\r\n- Chat screen is main performance screen. It is very slow and also consumes lots of memory. To improve this screen we have to optimize and simplify it. There are several calculations we probably don't need. For example in case of https://github.com/status-im/status-mobile/pull/16981, we just needed to embed floating shell button in composer instead of calculating its position based on composer state etc. We also need to simplify effects, (they probably not needed). As in https://github.com/status-im/status-mobile/pull/17717 `empty-effect` gets called even before data is loaded and after that it becomes useless. And with dependencies in effects, they are working more like listeners, which is probably not right way to do. Instead of listening and acting on subscriptions etc, these changes should be made while we are performing action which is causing that subscription to change. \r\n- Better compatibility with chat screen navigation. Currently we are just showing loading skeleton while chat screen is opening, than allowing subscriptions etc. This makes whole chat screen re-render. We need to simplify that.\r\n- Improve memory consumption.\r\n\r\n</details>\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1776721533/reactions",
      "total_count": 5,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 5,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1776731388",
    "html_url": "https://github.com/status-im/status-mobile/issues/16714#issuecomment-1776731388",
    "issue_url": "https://api.github.com/repos/status-im/status-mobile/issues/16714",
    "id": 1776731388,
    "node_id": "IC_kwDOAx4p2c5p5sT8",
    "user": {
      "login": "pavloburykh",
      "id": 97245802,
      "node_id": "U_kgDOBcvaag",
      "avatar_url": "https://avatars.githubusercontent.com/u/97245802?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pavloburykh",
      "html_url": "https://github.com/pavloburykh",
      "followers_url": "https://api.github.com/users/pavloburykh/followers",
      "following_url": "https://api.github.com/users/pavloburykh/following{/other_user}",
      "gists_url": "https://api.github.com/users/pavloburykh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pavloburykh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pavloburykh/subscriptions",
      "organizations_url": "https://api.github.com/users/pavloburykh/orgs",
      "repos_url": "https://api.github.com/users/pavloburykh/repos",
      "events_url": "https://api.github.com/users/pavloburykh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pavloburykh/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-24T08:12:09Z",
    "updated_at": "2023-10-24T08:12:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "@Parveshdhull many thanks for this detailed research. ",
    "reactions": {
      "url": "https://api.github.com/repos/status-im/status-mobile/issues/comments/1776731388/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
