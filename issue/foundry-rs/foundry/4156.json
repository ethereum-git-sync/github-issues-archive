{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/4156",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4156/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4156/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4156/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/4156",
  "id": 1552917510,
  "node_id": "I_kwDOGBlvNc5cj6QG",
  "number": 4156,
  "title": "feat(forge): command-line flag \"--fuzz-runs\"",
  "user": {
    "login": "PaulRBerg",
    "id": 8782666,
    "node_id": "MDQ6VXNlcjg3ODI2NjY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8782666?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/PaulRBerg",
    "html_url": "https://github.com/PaulRBerg",
    "followers_url": "https://api.github.com/users/PaulRBerg/followers",
    "following_url": "https://api.github.com/users/PaulRBerg/following{/other_user}",
    "gists_url": "https://api.github.com/users/PaulRBerg/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/PaulRBerg/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/PaulRBerg/subscriptions",
    "organizations_url": "https://api.github.com/users/PaulRBerg/orgs",
    "repos_url": "https://api.github.com/users/PaulRBerg/repos",
    "events_url": "https://api.github.com/users/PaulRBerg/events{/privacy}",
    "received_events_url": "https://api.github.com/users/PaulRBerg/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3593644820,
      "node_id": "LA_kwDOGBlvNc7WMqsU",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-feature",
      "name": "T-feature",
      "color": "BFD4F2",
      "default": false,
      "description": "Type: feature"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "Evalir",
    "id": 26014927,
    "node_id": "MDQ6VXNlcjI2MDE0OTI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Evalir",
    "html_url": "https://github.com/Evalir",
    "followers_url": "https://api.github.com/users/Evalir/followers",
    "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
    "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
    "organizations_url": "https://api.github.com/users/Evalir/orgs",
    "repos_url": "https://api.github.com/users/Evalir/repos",
    "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Evalir/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "Evalir",
      "id": 26014927,
      "node_id": "MDQ6VXNlcjI2MDE0OTI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Evalir",
      "html_url": "https://github.com/Evalir",
      "followers_url": "https://api.github.com/users/Evalir/followers",
      "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
      "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
      "organizations_url": "https://api.github.com/users/Evalir/orgs",
      "repos_url": "https://api.github.com/users/Evalir/repos",
      "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Evalir/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-01-23T11:15:53Z",
  "updated_at": "2023-06-16T16:20:25Z",
  "closed_at": "2023-06-16T16:20:25Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Describe the feature you would like\r\n\r\nImagine you have multiple test categories, as it is the case in [maple-core-v2](https://github.com/maple-labs/maple-core-v2/tree/00f01ae7175885f8d49ac201a1c72465e320b2f6/tests):\r\n\r\n```tree\r\n└── test\r\n   ├── e2e\r\n   ├── fuzz\r\n   └── unit\r\n```\r\n\r\nThe fuzzing requirements for the end-to-test tests may be different from those for the fuzz tests, for the simple reason that the former may contain advanced testing execution flows, which take a long time to run.\r\n\r\nHowever, bar for the different fuzzing requirements, all test profiles may want to use the same Foundry configuration. The only way to do this today is to create a different Foundry profile for all tests, and duplicate all the non-fuzzing configs:\r\n\r\n```toml\r\n[profile.test-e2e]\r\n  fuzz = { runs = 1_000 }\r\n  src = \"test\"\r\n  verbosity = 4\r\n\r\n[profile.test-fuzz]\r\n  fuzz = { runs = 5000 }\r\n  src = \"test\"\r\n  verbosity = 4\r\n\r\n[profile.test-unit]\r\n  fuzz = { runs = 50 }\r\n  src = \"test\"\r\n  verbosity = 4\r\n```\r\n\r\nThis is quite verbose and makes the maintenance of config options more difficult because the developer(s) need to remember that the non-fuzzing config options must be kept in-sync.\r\n\r\nIt would be much easier to have a command-line flag `--fuzz-runs` that always takes precedence over the `fuzz.runs` config option defined in the Foundry config file. This way, the user would be able to write their own custom scripts (in a `package.json` or `Makefile`) that use the desired number of fuzz runs for a specific test profile:\r\n\r\n```json\r\n\"scripts\": {\r\n  \"test:e2e\": \"forge test --fuzz-runs 1000 --match-path 'test/e2e'\",\r\n  \"test:fuzz\": \"forge test --fuzz-runs 5000 --match-path 'test/fuzz'\",\r\n  \"test:unit\": \"forge test --fuzz-runs 50 --match-path 'test/unit'\"\r\n```",
  "closed_by": {
    "login": "Evalir",
    "id": 26014927,
    "node_id": "MDQ6VXNlcjI2MDE0OTI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Evalir",
    "html_url": "https://github.com/Evalir",
    "followers_url": "https://api.github.com/users/Evalir/followers",
    "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
    "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
    "organizations_url": "https://api.github.com/users/Evalir/orgs",
    "repos_url": "https://api.github.com/users/Evalir/repos",
    "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Evalir/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/4156/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4156/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1400556101",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4156#issuecomment-1400556101",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4156",
    "id": 1400556101,
    "node_id": "IC_kwDOGBlvNc5TespF",
    "user": {
      "login": "mds1",
      "id": 17163988,
      "node_id": "MDQ6VXNlcjE3MTYzOTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mds1",
      "html_url": "https://github.com/mds1",
      "followers_url": "https://api.github.com/users/mds1/followers",
      "following_url": "https://api.github.com/users/mds1/following{/other_user}",
      "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
      "organizations_url": "https://api.github.com/users/mds1/orgs",
      "repos_url": "https://api.github.com/users/mds1/repos",
      "events_url": "https://api.github.com/users/mds1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mds1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-23T15:38:47Z",
    "updated_at": "2023-01-23T15:38:47Z",
    "author_association": "COLLABORATOR",
    "body": "Note that you can currently accomplish this with the `FOUNDRY_FUZZ_RUNS` env var.\r\n\r\n```json\r\n\"scripts\": {\r\n  \"test:e2e\": \"FOUNDRY_FUZZ_RUNS=1000 forge test --match-path 'test/e2e'\",\r\n  \"test:fuzz\": \"FOUNDRY_FUZZ_RUNS=5000 forge test --match-path 'test/fuzz'\",\r\n  \"test:unit\": \"FOUNDRY_FUZZ_RUNS=50 forge test --match-path 'test/unit'\"\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1400556101/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1400571704",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4156#issuecomment-1400571704",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4156",
    "id": 1400571704,
    "node_id": "IC_kwDOGBlvNc5Tewc4",
    "user": {
      "login": "PaulRBerg",
      "id": 8782666,
      "node_id": "MDQ6VXNlcjg3ODI2NjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8782666?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PaulRBerg",
      "html_url": "https://github.com/PaulRBerg",
      "followers_url": "https://api.github.com/users/PaulRBerg/followers",
      "following_url": "https://api.github.com/users/PaulRBerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulRBerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PaulRBerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulRBerg/subscriptions",
      "organizations_url": "https://api.github.com/users/PaulRBerg/orgs",
      "repos_url": "https://api.github.com/users/PaulRBerg/repos",
      "events_url": "https://api.github.com/users/PaulRBerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PaulRBerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-23T15:49:26Z",
    "updated_at": "2023-01-23T15:49:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "That is awesome - thanks for the tip, Matt. I forgot about the env var.\r\n\r\nI will keep this issue open though - it would be nice to have a CLI flag for this.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1400571704/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
