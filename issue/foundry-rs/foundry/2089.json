{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2089",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2089/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2089/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2089/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/2089",
  "id": 1282263417,
  "node_id": "I_kwDOGBlvNc5Mbcl5",
  "number": 2089,
  "title": "[anvil] Simulate flashbot endpoint for local forks.",
  "user": {
    "login": "krasi-georgiev",
    "id": 8903888,
    "node_id": "MDQ6VXNlcjg5MDM4ODg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8903888?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/krasi-georgiev",
    "html_url": "https://github.com/krasi-georgiev",
    "followers_url": "https://api.github.com/users/krasi-georgiev/followers",
    "following_url": "https://api.github.com/users/krasi-georgiev/following{/other_user}",
    "gists_url": "https://api.github.com/users/krasi-georgiev/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/krasi-georgiev/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/krasi-georgiev/subscriptions",
    "organizations_url": "https://api.github.com/users/krasi-georgiev/orgs",
    "repos_url": "https://api.github.com/users/krasi-georgiev/repos",
    "events_url": "https://api.github.com/users/krasi-georgiev/events{/privacy}",
    "received_events_url": "https://api.github.com/users/krasi-georgiev/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3593644820,
      "node_id": "LA_kwDOGBlvNc7WMqsU",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-feature",
      "name": "T-feature",
      "color": "BFD4F2",
      "default": false,
      "description": "Type: feature"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2022-06-23T11:38:01Z",
  "updated_at": "2023-04-26T12:20:02Z",
  "closed_at": "2022-06-24T06:42:35Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nAnvil\n\n### Describe the feature you would like\n\nthe salmonella and different variation are a good example of why it would be great to allow testing TX as if they were sent to the flashbot endpoints.\r\n\r\nIdeally can replicate the exact API of flashbot so that software written to interact with flashbot can run it against a local fork without any special handling.\r\n\r\nCurrently, there is no way to run flashbot TX tests on mainnet and this feature would be quite useful I think\n\n### Additional context\n\n_No response_",
  "closed_by": {
    "login": "krasi-georgiev",
    "id": 8903888,
    "node_id": "MDQ6VXNlcjg5MDM4ODg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8903888?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/krasi-georgiev",
    "html_url": "https://github.com/krasi-georgiev",
    "followers_url": "https://api.github.com/users/krasi-georgiev/followers",
    "following_url": "https://api.github.com/users/krasi-georgiev/following{/other_user}",
    "gists_url": "https://api.github.com/users/krasi-georgiev/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/krasi-georgiev/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/krasi-georgiev/subscriptions",
    "organizations_url": "https://api.github.com/users/krasi-georgiev/orgs",
    "repos_url": "https://api.github.com/users/krasi-georgiev/repos",
    "events_url": "https://api.github.com/users/krasi-georgiev/events{/privacy}",
    "received_events_url": "https://api.github.com/users/krasi-georgiev/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2089/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2089/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1164315421",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2089#issuecomment-1164315421",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2089",
    "id": 1164315421,
    "node_id": "IC_kwDOGBlvNc5FZgsd",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-23T11:54:51Z",
    "updated_at": "2022-06-23T11:54:51Z",
    "author_association": "MEMBER",
    "body": "You can use Flashbots's simulation endpoint to run tests against mainnet :)",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1164315421/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1164323873",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2089#issuecomment-1164323873",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2089",
    "id": 1164323873,
    "node_id": "IC_kwDOGBlvNc5FZiwh",
    "user": {
      "login": "krasi-georgiev",
      "id": 8903888,
      "node_id": "MDQ6VXNlcjg5MDM4ODg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8903888?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/krasi-georgiev",
      "html_url": "https://github.com/krasi-georgiev",
      "followers_url": "https://api.github.com/users/krasi-georgiev/followers",
      "following_url": "https://api.github.com/users/krasi-georgiev/following{/other_user}",
      "gists_url": "https://api.github.com/users/krasi-georgiev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/krasi-georgiev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/krasi-georgiev/subscriptions",
      "organizations_url": "https://api.github.com/users/krasi-georgiev/orgs",
      "repos_url": "https://api.github.com/users/krasi-georgiev/repos",
      "events_url": "https://api.github.com/users/krasi-georgiev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/krasi-georgiev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-23T12:04:24Z",
    "updated_at": "2022-06-23T12:04:24Z",
    "author_association": "NONE",
    "body": "I meant run actual TX as if they are sent to a flashbot endpoint. I assume most bots these days run TX through flashbot so if the local node can support those endpoints don't need to do any special handling when running the bot tests.\r\n\r\non a different note the simulation doesn't always work so it is not a reliable source for testing.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1164323873/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1164350241",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2089#issuecomment-1164350241",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2089",
    "id": 1164350241,
    "node_id": "IC_kwDOGBlvNc5FZpMh",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-23T12:33:06Z",
    "updated_at": "2022-06-23T12:33:06Z",
    "author_association": "MEMBER",
    "body": "not sure I fully understand this yet,\r\n\r\nas @onbjerg mentioned flashbots has the bundle simulation endpoint which is basically an `eth_Call` iirc.\r\n\r\nbut sounds like the feature you want is for anvil to support flashbots' rpc endpoints so you can send this locally and mimic mev-geth's bundle execution?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1164350241/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1165254626",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2089#issuecomment-1165254626",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2089",
    "id": 1165254626,
    "node_id": "IC_kwDOGBlvNc5FdF_i",
    "user": {
      "login": "krasi-georgiev",
      "id": 8903888,
      "node_id": "MDQ6VXNlcjg5MDM4ODg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8903888?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/krasi-georgiev",
      "html_url": "https://github.com/krasi-georgiev",
      "followers_url": "https://api.github.com/users/krasi-georgiev/followers",
      "following_url": "https://api.github.com/users/krasi-georgiev/following{/other_user}",
      "gists_url": "https://api.github.com/users/krasi-georgiev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/krasi-georgiev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/krasi-georgiev/subscriptions",
      "organizations_url": "https://api.github.com/users/krasi-georgiev/orgs",
      "repos_url": "https://api.github.com/users/krasi-georgiev/repos",
      "events_url": "https://api.github.com/users/krasi-georgiev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/krasi-georgiev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-24T06:42:30Z",
    "updated_at": "2022-06-24T07:08:00Z",
    "author_association": "NONE",
    "body": "I was thinking to have `eth_sendBundle` and `eth_callBundle` exactly like the flashbot API, but maybe not a good idea as this will just pollute the API with all these custom implementations. I will close for now and will re-open if this turns out to be a big issue again.\r\n\r\n\r\nhttps://docs.flashbots.net/flashbots-auction/searchers/advanced/rpc-endpoint",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1165254626/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1173224538",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2089#issuecomment-1173224538",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2089",
    "id": 1173224538,
    "node_id": "IC_kwDOGBlvNc5F7fxa",
    "user": {
      "login": "sambacha",
      "id": 32783916,
      "node_id": "MDQ6VXNlcjMyNzgzOTE2",
      "avatar_url": "https://avatars.githubusercontent.com/u/32783916?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sambacha",
      "html_url": "https://github.com/sambacha",
      "followers_url": "https://api.github.com/users/sambacha/followers",
      "following_url": "https://api.github.com/users/sambacha/following{/other_user}",
      "gists_url": "https://api.github.com/users/sambacha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sambacha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sambacha/subscriptions",
      "organizations_url": "https://api.github.com/users/sambacha/orgs",
      "repos_url": "https://api.github.com/users/sambacha/repos",
      "events_url": "https://api.github.com/users/sambacha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sambacha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-04T01:08:08Z",
    "updated_at": "2022-07-04T01:08:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I was thinking to have `eth_sendBundle` and `eth_callBundle` exactly like the flashbot API, but maybe not a good idea as this will just pollute the API with all these custom implementations. I will close for now and will re-open if this turns out to be a big issue again.\r\n> \r\n> [docs.flashbots.net/flashbots-auction/searchers/advanced/rpc-endpoint](https://docs.flashbots.net/flashbots-auction/searchers/advanced/rpc-endpoint)\r\n\r\nthis may help: https://github.com/manifoldfinance/bundle-simulator",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1173224538/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1523324762",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2089#issuecomment-1523324762",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2089",
    "id": 1523324762,
    "node_id": "IC_kwDOGBlvNc5azBda",
    "user": {
      "login": "0x366",
      "id": 4774606,
      "node_id": "MDQ6VXNlcjQ3NzQ2MDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4774606?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/0x366",
      "html_url": "https://github.com/0x366",
      "followers_url": "https://api.github.com/users/0x366/followers",
      "following_url": "https://api.github.com/users/0x366/following{/other_user}",
      "gists_url": "https://api.github.com/users/0x366/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/0x366/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0x366/subscriptions",
      "organizations_url": "https://api.github.com/users/0x366/orgs",
      "repos_url": "https://api.github.com/users/0x366/repos",
      "events_url": "https://api.github.com/users/0x366/events{/privacy}",
      "received_events_url": "https://api.github.com/users/0x366/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-26T12:20:01Z",
    "updated_at": "2023-04-26T12:20:01Z",
    "author_association": "NONE",
    "body": "Would also request to add a simulation to anvil. Currently you can theoretically simulate buy reseting anvil to the latest block, sending transactions in a bundle one by one and mining a block. Tho as far as I understand you can't make simulations isolated, so if you do simulations concurrently and bundles are calling the same contracts - the simulations won't be correct. ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1523324762/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
