{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/6542",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6542/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6542/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6542/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/6542",
  "id": 2031559056,
  "node_id": "I_kwDOGBlvNc55FyGQ",
  "number": 6542,
  "title": "Forge script fails to estimate gas for contract deployment",
  "user": {
    "login": "jeffywu",
    "id": 977434,
    "node_id": "MDQ6VXNlcjk3NzQzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/977434?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jeffywu",
    "html_url": "https://github.com/jeffywu",
    "followers_url": "https://api.github.com/users/jeffywu/followers",
    "following_url": "https://api.github.com/users/jeffywu/following{/other_user}",
    "gists_url": "https://api.github.com/users/jeffywu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jeffywu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jeffywu/subscriptions",
    "organizations_url": "https://api.github.com/users/jeffywu/orgs",
    "repos_url": "https://api.github.com/users/jeffywu/repos",
    "events_url": "https://api.github.com/users/jeffywu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jeffywu/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-12-07T21:29:26Z",
  "updated_at": "2023-12-07T23:46:47Z",
  "closed_at": "2023-12-07T23:46:47Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nForge\n\n### Have you ensured that all of these are up to date?\n\n- [X] Foundry\n- [X] Foundryup\n\n### What version of Foundry are you on?\n\nforge 0.2.0 (fdad9fb 2023-12-06T00:17:31.361933000Z)\n\n### What command(s) is the bug in?\n\nforge script\n\n### Operating System\n\nmacOS (Apple Silicon)\n\n### Describe the bug\n\nTried a number of things but forge refuses to work when trying to send the first transaction in the broadcast JSON file below. It works when I send it manually using `cast send --create`. My hunch is that forge does not realize that the gas limit on arbitrum is much higher and does not want to send the transaction.\r\n\r\n\r\n[run-latest.json](https://github.com/foundry-rs/foundry/files/13605631/run-latest.json)\r\n\r\n```\r\nCommand:\r\n\r\nforge script tests/SingleSidedLP/pools/FRAX_USDC_e.t.sol:Test_FRAX \\\r\n    -f $RPC_URL --sender 0x8F5ea3CDe898B208280c0e93F3aDaaf1F5c35a7e \\\r\n    --gas-limit 1125899906842624 --chain 42161 --account ARBITRUM-ONE_DEPLOYER --broadcast --verify\r\n\r\n\r\n## Setting up 1 EVM.\r\n\r\n==========================\r\n\r\nChain 42161\r\n\r\nEstimated gas price: 3.2 gwei\r\n\r\nEstimated total gas used for script: 107628326\r\n\r\nEstimated amount required: 0.3444106432 ETH\r\n\r\n==========================\r\n\r\n###\r\nFinding wallets for all the necessary addresses...\r\nEnter keystore password:\r\n##\r\nSending transactions [0 - 0].\r\n\r\nTransactions saved to: /Users/jwu/code/leveraged-vaults/broadcast/FRAX_USDC_e.t.sol/42161/run-latest.json\r\n\r\nSensitive values saved to: /Users/jwu/code/leveraged-vaults/cache/FRAX_USDC_e.t.sol/42161/run-latest.json\r\n\r\nError: \r\nFailed to estimate gas for tx: 0x1e1ff94ff66b2b1ab38f849a0852de45c858af63727921596f398343aa77ac30\r\n\r\nContext:\r\n- (code: -32000, message: gas required exceeds allowance (77683450), data: None)\r\n```",
  "closed_by": {
    "login": "Evalir",
    "id": 26014927,
    "node_id": "MDQ6VXNlcjI2MDE0OTI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Evalir",
    "html_url": "https://github.com/Evalir",
    "followers_url": "https://api.github.com/users/Evalir/followers",
    "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
    "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
    "organizations_url": "https://api.github.com/users/Evalir/orgs",
    "repos_url": "https://api.github.com/users/Evalir/repos",
    "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Evalir/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/6542/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6542/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1846276243",
    "html_url": "https://github.com/foundry-rs/foundry/issues/6542#issuecomment-1846276243",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6542",
    "id": 1846276243,
    "node_id": "IC_kwDOGBlvNc5uC_CT",
    "user": {
      "login": "Evalir",
      "id": 26014927,
      "node_id": "MDQ6VXNlcjI2MDE0OTI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Evalir",
      "html_url": "https://github.com/Evalir",
      "followers_url": "https://api.github.com/users/Evalir/followers",
      "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
      "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
      "organizations_url": "https://api.github.com/users/Evalir/orgs",
      "repos_url": "https://api.github.com/users/Evalir/repos",
      "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Evalir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-12-07T23:46:47Z",
    "updated_at": "2023-12-07T23:46:47Z",
    "author_association": "MEMBER",
    "body": "Hey ðŸ‘‹ ack this is a bugâ€”but we've gotten multiple issues regarding this type of gas estimation failures on L2s, so i'll close this as we consolidate. We're currently working out how we can improve this.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1846276243/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
