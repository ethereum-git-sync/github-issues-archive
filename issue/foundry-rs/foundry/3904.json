{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3904",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3904/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3904/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3904/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/3904",
  "id": 1501463415,
  "node_id": "I_kwDOGBlvNc5ZfoN3",
  "number": 3904,
  "title": "Permit \"default\" as value for \"optimizerSteps\"",
  "user": {
    "login": "PaulRBerg",
    "id": 8782666,
    "node_id": "MDQ6VXNlcjg3ODI2NjY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8782666?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/PaulRBerg",
    "html_url": "https://github.com/PaulRBerg",
    "followers_url": "https://api.github.com/users/PaulRBerg/followers",
    "following_url": "https://api.github.com/users/PaulRBerg/following{/other_user}",
    "gists_url": "https://api.github.com/users/PaulRBerg/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/PaulRBerg/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/PaulRBerg/subscriptions",
    "organizations_url": "https://api.github.com/users/PaulRBerg/orgs",
    "repos_url": "https://api.github.com/users/PaulRBerg/repos",
    "events_url": "https://api.github.com/users/PaulRBerg/events{/privacy}",
    "received_events_url": "https://api.github.com/users/PaulRBerg/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3593644820,
      "node_id": "LA_kwDOGBlvNc7WMqsU",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-feature",
      "name": "T-feature",
      "color": "BFD4F2",
      "default": false,
      "description": "Type: feature"
    },
    {
      "id": 3703752787,
      "node_id": "LA_kwDOGBlvNc7cwshT",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-forge",
      "name": "C-forge",
      "color": "5319E7",
      "default": false,
      "description": "Command: forge"
    },
    {
      "id": 4444799654,
      "node_id": "LA_kwDOGBlvNc8AAAABCO5Cpg",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/A-compiler",
      "name": "A-compiler",
      "color": "FBCA04",
      "default": false,
      "description": "Area: compiler"
    },
    {
      "id": 4450020906,
      "node_id": "LA_kwDOGBlvNc8AAAABCT3uKg",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/A-config",
      "name": "A-config",
      "color": "FBCA04",
      "default": false,
      "description": "Area: config"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-12-17T16:23:36Z",
  "updated_at": "2023-02-12T22:36:36Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Describe the feature you would like\r\n\r\nThe default Yul optimizer step sequence is quite long-winded - even in the Solidity source code, the default value is [split on multiple lines](https://github.com/ethereum/solidity/blob/73fcf69188fed78c3ad91f81ce7d6ed7c6ee79c6/libsolidity/interface/OptimiserSettings.h#L44-L60) for readability purposes.\r\n\r\nMy feature request is to make it possible to pass the `default` value to the `optimizerSteps` field in the Foundry config, so that users don't have to manually write it up:\r\n\r\n```toml\r\n[profile.default.optimizer_details.yulDetails]\r\nstackAllocation = true\r\noptimizerSteps = \"default\"\r\n```\r\n\r\nThis is useful because users may want to disable the default step sequence during development (i.e. in the `default` profile) in order to speed up the compilation time. But then, in a separate profile such as `production`, users may want to set the step sequence back to the default to get maximum optimization benefits.\r\n\r\n### Additional context\r\n\r\nSee the conversation [here](https://twitter.com/PaulRBerg/status/1604132363700690944).",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3904/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3904/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1356799929",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3904#issuecomment-1356799929",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3904",
    "id": 1356799929,
    "node_id": "IC_kwDOGBlvNc5Q3x-5",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-18T13:36:18Z",
    "updated_at": "2022-12-18T13:36:18Z",
    "author_association": "MEMBER",
    "body": "supportive of that!",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1356799929/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1357785961",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3904#issuecomment-1357785961",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3904",
    "id": 1357785961,
    "node_id": "IC_kwDOGBlvNc5Q7itp",
    "user": {
      "login": "mds1",
      "id": 17163988,
      "node_id": "MDQ6VXNlcjE3MTYzOTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mds1",
      "html_url": "https://github.com/mds1",
      "followers_url": "https://api.github.com/users/mds1/followers",
      "following_url": "https://api.github.com/users/mds1/following{/other_user}",
      "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
      "organizations_url": "https://api.github.com/users/mds1/orgs",
      "repos_url": "https://api.github.com/users/mds1/repos",
      "events_url": "https://api.github.com/users/mds1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mds1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-19T14:53:47Z",
    "updated_at": "2022-12-19T14:53:47Z",
    "author_association": "COLLABORATOR",
    "body": "One caveat here is that it's possible the default sequence of optimizer steps will change between solc versions, and if so we'd need to stay on top of that with each solc release and maintain a mapping from version to step sequence. (Or, maybe it's unlikely to change / will never change, not sure)",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1357785961/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1357899299",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3904#issuecomment-1357899299",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3904",
    "id": 1357899299,
    "node_id": "IC_kwDOGBlvNc5Q7-Yj",
    "user": {
      "login": "PaulRBerg",
      "id": 8782666,
      "node_id": "MDQ6VXNlcjg3ODI2NjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8782666?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PaulRBerg",
      "html_url": "https://github.com/PaulRBerg",
      "followers_url": "https://api.github.com/users/PaulRBerg/followers",
      "following_url": "https://api.github.com/users/PaulRBerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulRBerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PaulRBerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulRBerg/subscriptions",
      "organizations_url": "https://api.github.com/users/PaulRBerg/orgs",
      "repos_url": "https://api.github.com/users/PaulRBerg/repos",
      "events_url": "https://api.github.com/users/PaulRBerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PaulRBerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-19T16:10:19Z",
    "updated_at": "2022-12-19T16:10:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yeah, it's possible that the default sequence will change with time. In this case, I suggest maintaining a mapping as you @mds1 suggest, and throwing an error for those versions for which there is no default value available in Foundry.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1357899299/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1427150554",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3904#issuecomment-1427150554",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3904",
    "id": 1427150554,
    "node_id": "IC_kwDOGBlvNc5VEJba",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-12T22:35:55Z",
    "updated_at": "2023-02-12T22:36:36Z",
    "author_association": "NONE",
    "body": "Why not just omit the option from the JSON passed to the compiler (or from its CLI arguments) when it's set to `\"default\"`? You would not have to keep the mapping. Changes to the sequence aren't rare, especially when we're tweaking the optimizer.\r\n\r\nBy the way, using specifically `\"default\"` to indicate the default does not seem like a good idea because it's in fact a valid sequence: `VarDeclInitializer`, `ExpressionInliner`, `BlockFlattener`, `SSATransform`, `UnusedPruner`, `CircularReferencesPruner`, `StructuralSimplifier`. :)",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1427150554/reactions",
      "total_count": 3,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
