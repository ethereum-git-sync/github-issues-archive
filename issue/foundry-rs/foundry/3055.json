{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/3055",
  "id": 1359139520,
  "node_id": "I_kwDOGBlvNc5RAtLA",
  "number": 3055,
  "title": "bug: snapshot/revertTo causes tests to pass unexpectedly",
  "user": {
    "login": "mds1",
    "id": 17163988,
    "node_id": "MDQ6VXNlcjE3MTYzOTg4",
    "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mds1",
    "html_url": "https://github.com/mds1",
    "followers_url": "https://api.github.com/users/mds1/followers",
    "following_url": "https://api.github.com/users/mds1/following{/other_user}",
    "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
    "organizations_url": "https://api.github.com/users/mds1/orgs",
    "repos_url": "https://api.github.com/users/mds1/repos",
    "events_url": "https://api.github.com/users/mds1/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mds1/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    },
    {
      "id": 3593644915,
      "node_id": "LA_kwDOGBlvNc7WMqtz",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/Cmd-forge-test",
      "name": "Cmd-forge-test",
      "color": "006B75",
      "default": false,
      "description": "Command: forge test"
    },
    {
      "id": 3703752787,
      "node_id": "LA_kwDOGBlvNc7cwshT",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-forge",
      "name": "C-forge",
      "color": "5319E7",
      "default": false,
      "description": "Command: forge"
    },
    {
      "id": 3703752960,
      "node_id": "LA_kwDOGBlvNc7cwskA",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/A-cheatcodes",
      "name": "A-cheatcodes",
      "color": "FBCA04",
      "default": false,
      "description": "Area: cheatcodes"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "mattsse",
    "id": 19890894,
    "node_id": "MDQ6VXNlcjE5ODkwODk0",
    "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mattsse",
    "html_url": "https://github.com/mattsse",
    "followers_url": "https://api.github.com/users/mattsse/followers",
    "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
    "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
    "organizations_url": "https://api.github.com/users/mattsse/orgs",
    "repos_url": "https://api.github.com/users/mattsse/repos",
    "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mattsse/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 12,
  "created_at": "2022-09-01T16:53:23Z",
  "updated_at": "2023-05-18T15:24:44Z",
  "closed_at": "2023-05-18T15:24:44Z",
  "author_association": "COLLABORATOR",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Have you ensured that all of these are up to date?\r\n\r\n- [X] Foundry\r\n- [X] Foundryup\r\n\r\n### What version of Foundry are you on?\r\n\r\nforge 0.2.0 (48d5d79 2022-09-01T00:10:22.933552Z)\r\n\r\n### What command(s) is the bug in?\r\n\r\nforge test\r\n\r\n### Operating System\r\n\r\n_No response_\r\n\r\n### Describe the bug\r\n\r\nIf you run this test, it passes. If you comment out the `vm.revertTo` line it fails. Failure is expected in both cases since the assertion should fail. It seems like the cause is that reverting the state also reverts the `failed` flag: https://github.com/dapphub/ds-test/blob/9310e879db8ba3ea6d5c6489a579118fd264a3f5/src/test.sol#L47-L63\r\n```solidity\r\n// SPDX-License-Identifier: MIT\r\npragma solidity ^0.8.15;\r\nimport \"forge-std/Test.sol\";\r\n\r\ncontract MyTest is Test {\r\n  function test_snapshot() external {\r\n    uint256 snapId = vm.snapshot();\r\n    assertEq(uint256(0), uint256(1));\r\n    vm.revertTo(snapId);\r\n  }\r\n}\r\n```",
  "closed_by": {
    "login": "mattsse",
    "id": 19890894,
    "node_id": "MDQ6VXNlcjE5ODkwODk0",
    "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mattsse",
    "html_url": "https://github.com/mattsse",
    "followers_url": "https://api.github.com/users/mattsse/followers",
    "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
    "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
    "organizations_url": "https://api.github.com/users/mattsse/orgs",
    "repos_url": "https://api.github.com/users/mattsse/repos",
    "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mattsse/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1234586285",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3055#issuecomment-1234586285",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055",
    "id": 1234586285,
    "node_id": "IC_kwDOGBlvNc5Jlkqt",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-01T17:39:46Z",
    "updated_at": "2022-09-01T17:39:46Z",
    "author_association": "MEMBER",
    "body": ">  It seems like the cause is that reverting the state also reverts the failed flag:\r\n\r\nthat sounds right, need to make a check for `failed()` here",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1234586285/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1237190105",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3055#issuecomment-1237190105",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055",
    "id": 1237190105,
    "node_id": "IC_kwDOGBlvNc5JvgXZ",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-05T15:13:46Z",
    "updated_at": "2022-09-05T15:13:46Z",
    "author_association": "MEMBER",
    "body": "with #3087 this now results in\r\n\r\n```console\r\n~/git/rust/foundry/target/debug/forge test                                                                                                           ! master \r\n[⠢] Compiling...\r\nNo files changed, compilation skipped\r\n\r\nRunning 1 test for test/Counter.t.sol:MyTest\r\n[FAIL. Reason: Assertion failed.] test_snapshot() (gas: 15534)\r\nTest result: FAILED. 0 passed; 1 failed; finished in 2.71ms\r\n\r\nFailing tests:\r\nEncountered 1 failing test in test/Counter.t.sol:MyTest\r\n[FAIL. Reason: Assertion failed.] test_snapshot() (gas: 15534)\r\n\r\nEncountered a total of 1 failing tests, 0 tests succeeded\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1237190105/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1328198508",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3055#issuecomment-1328198508",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055",
    "id": 1328198508,
    "node_id": "IC_kwDOGBlvNc5PKrNs",
    "user": {
      "login": "graykode",
      "id": 10525011,
      "node_id": "MDQ6VXNlcjEwNTI1MDEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/10525011?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/graykode",
      "html_url": "https://github.com/graykode",
      "followers_url": "https://api.github.com/users/graykode/followers",
      "following_url": "https://api.github.com/users/graykode/following{/other_user}",
      "gists_url": "https://api.github.com/users/graykode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/graykode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/graykode/subscriptions",
      "organizations_url": "https://api.github.com/users/graykode/orgs",
      "repos_url": "https://api.github.com/users/graykode/repos",
      "events_url": "https://api.github.com/users/graykode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/graykode/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-27T08:49:36Z",
    "updated_at": "2022-11-27T08:49:36Z",
    "author_association": "NONE",
    "body": "This still doesn't work. But after modifying a few lines in forge-std, it works. https://github.com/foundry-rs/forge-std/pull/241 @mattsse ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1328198508/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1328418311",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3055#issuecomment-1328418311",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055",
    "id": 1328418311,
    "node_id": "IC_kwDOGBlvNc5PLg4H",
    "user": {
      "login": "mds1",
      "id": 17163988,
      "node_id": "MDQ6VXNlcjE3MTYzOTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mds1",
      "html_url": "https://github.com/mds1",
      "followers_url": "https://api.github.com/users/mds1/followers",
      "following_url": "https://api.github.com/users/mds1/following{/other_user}",
      "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
      "organizations_url": "https://api.github.com/users/mds1/orgs",
      "repos_url": "https://api.github.com/users/mds1/repos",
      "events_url": "https://api.github.com/users/mds1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mds1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-28T01:44:09Z",
    "updated_at": "2022-11-28T01:44:09Z",
    "author_association": "COLLABORATOR",
    "body": "@mattsse I was able to reproduce the issue from @graykode, any idea on the cause?\r\n\r\nThe forge-std fix in https://github.com/foundry-rs/forge-std/pull/241 does resolve the issue, but I'm not sure why. Regardless though, seems this should be fixed upstream here in foundry instead?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1328418311/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1328855187",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3055#issuecomment-1328855187",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055",
    "id": 1328855187,
    "node_id": "IC_kwDOGBlvNc5PNLiT",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-28T10:31:58Z",
    "updated_at": "2022-11-28T10:31:58Z",
    "author_association": "MEMBER",
    "body": "looks strange, I have to take a closer look",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1328855187/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1330725219",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3055#issuecomment-1330725219",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055",
    "id": 1330725219,
    "node_id": "IC_kwDOGBlvNc5PUUFj",
    "user": {
      "login": "ZeroEkkusu",
      "id": 94782988,
      "node_id": "U_kgDOBaZGDA",
      "avatar_url": "https://avatars.githubusercontent.com/u/94782988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ZeroEkkusu",
      "html_url": "https://github.com/ZeroEkkusu",
      "followers_url": "https://api.github.com/users/ZeroEkkusu/followers",
      "following_url": "https://api.github.com/users/ZeroEkkusu/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZeroEkkusu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ZeroEkkusu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZeroEkkusu/subscriptions",
      "organizations_url": "https://api.github.com/users/ZeroEkkusu/orgs",
      "repos_url": "https://api.github.com/users/ZeroEkkusu/repos",
      "events_url": "https://api.github.com/users/ZeroEkkusu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ZeroEkkusu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-29T14:22:51Z",
    "updated_at": "2022-11-29T14:24:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "@mattsse, see https://github.com/foundry-rs/forge-std/pull/241#pullrequestreview-1197652188. The underlying issue needs to be identified.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1330725219/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1334118460",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3055#issuecomment-1334118460",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055",
    "id": 1334118460,
    "node_id": "IC_kwDOGBlvNc5PhQg8",
    "user": {
      "login": "xenoliss",
      "id": 33523487,
      "node_id": "MDQ6VXNlcjMzNTIzNDg3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33523487?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xenoliss",
      "html_url": "https://github.com/xenoliss",
      "followers_url": "https://api.github.com/users/xenoliss/followers",
      "following_url": "https://api.github.com/users/xenoliss/following{/other_user}",
      "gists_url": "https://api.github.com/users/xenoliss/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xenoliss/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xenoliss/subscriptions",
      "organizations_url": "https://api.github.com/users/xenoliss/orgs",
      "repos_url": "https://api.github.com/users/xenoliss/repos",
      "events_url": "https://api.github.com/users/xenoliss/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xenoliss/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-01T17:35:16Z",
    "updated_at": "2022-12-01T17:35:31Z",
    "author_association": "NONE",
    "body": "Hey ! I'm still facing this issue on forge std `c7d30303fc34b7b2a680c86ddc1cd186bec23614`. Here is a PoC code:\r\n```solidity\r\n// SPDX-License-Identifier: UNLICENSED\r\npragma solidity ^0.8.17;\r\n\r\nimport \"forge-std/Test.sol\";\r\n\r\ncontract TestMe is Test {\r\n    function testMe() public {\r\n        uint256 snapshot = vm.snapshot();\r\n        assertTrue(false);\r\n\r\n        vm.revertTo(snapshot);\r\n        assertTrue(true);\r\n    }\r\n}\r\n```\r\nThis outputs the following:\r\n```\r\n$ forge test --match-test testMe -vv\r\n[⠒] Compiling...\r\nNo files changed, compilation skipped\r\n\r\nRunning 1 test for test/TestMe.t.sol:TestMe\r\n[PASS] testMe() (gas: 11436)\r\nLogs:\r\n  Error: Assertion Failed\r\n```\r\n\r\nThe only was to view the failing test is using a more verbose mode like `-vv`, else this is totally invisible.\r\nAlso when nesting snapshots, the logs are simply vanished and `-vv` does not log the errors.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1334118460/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1492058829",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3055#issuecomment-1492058829",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055",
    "id": 1492058829,
    "node_id": "IC_kwDOGBlvNc5Y7wLN",
    "user": {
      "login": "OliverNChalk",
      "id": 11343499,
      "node_id": "MDQ6VXNlcjExMzQzNDk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/11343499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/OliverNChalk",
      "html_url": "https://github.com/OliverNChalk",
      "followers_url": "https://api.github.com/users/OliverNChalk/followers",
      "following_url": "https://api.github.com/users/OliverNChalk/following{/other_user}",
      "gists_url": "https://api.github.com/users/OliverNChalk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/OliverNChalk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/OliverNChalk/subscriptions",
      "organizations_url": "https://api.github.com/users/OliverNChalk/orgs",
      "repos_url": "https://api.github.com/users/OliverNChalk/repos",
      "events_url": "https://api.github.com/users/OliverNChalk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/OliverNChalk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-31T14:55:33Z",
    "updated_at": "2023-03-31T14:55:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "For those facing this issue, you may wish to use the following as a temp workaround:\r\n```solidity\r\n\r\n    function _revertTo(uint256 aSnapshot) private {\r\n        require(!failed(), \"Fail flag triggered, aborting revert\");\r\n\r\n        vm.revertTo(aSnapshot);\r\n    }\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1492058829/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1492305757",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3055#issuecomment-1492305757",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055",
    "id": 1492305757,
    "node_id": "IC_kwDOGBlvNc5Y8sdd",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-31T17:20:13Z",
    "updated_at": "2023-03-31T17:20:13Z",
    "author_association": "MEMBER",
    "body": "hmm, I'm not quite sure what the issue is here, because both examples fail.\r\n\r\nor is the problem that the first assertion doesn't stop execution?\r\n\r\nthis behavior has ds-test legacy reasons but I'm skeptical that this is any good...",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1492305757/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1492414882",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3055#issuecomment-1492414882",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055",
    "id": 1492414882,
    "node_id": "IC_kwDOGBlvNc5Y9HGi",
    "user": {
      "login": "OliverNChalk",
      "id": 11343499,
      "node_id": "MDQ6VXNlcjExMzQzNDk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/11343499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/OliverNChalk",
      "html_url": "https://github.com/OliverNChalk",
      "followers_url": "https://api.github.com/users/OliverNChalk/followers",
      "following_url": "https://api.github.com/users/OliverNChalk/following{/other_user}",
      "gists_url": "https://api.github.com/users/OliverNChalk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/OliverNChalk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/OliverNChalk/subscriptions",
      "organizations_url": "https://api.github.com/users/OliverNChalk/orgs",
      "repos_url": "https://api.github.com/users/OliverNChalk/repos",
      "events_url": "https://api.github.com/users/OliverNChalk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/OliverNChalk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-31T18:24:18Z",
    "updated_at": "2023-03-31T18:24:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "Interesting, I can get logged test failures without the test failing:\r\n![image](https://user-images.githubusercontent.com/11343499/229199976-94333834-571c-4d44-8c02-fa44860170aa.png)\r\n\r\nI am on a fork while using `vm.revertTo`. My forge version is `forge 0.2.0 (0f1dea4 2023-03-31T00:07:29.356304995Z)`. Let me try get you a repro a bit later",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1492414882/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1493386396",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3055#issuecomment-1493386396",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055",
    "id": 1493386396,
    "node_id": "IC_kwDOGBlvNc5ZA0Sc",
    "user": {
      "login": "OliverNChalk",
      "id": 11343499,
      "node_id": "MDQ6VXNlcjExMzQzNDk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/11343499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/OliverNChalk",
      "html_url": "https://github.com/OliverNChalk",
      "followers_url": "https://api.github.com/users/OliverNChalk/followers",
      "following_url": "https://api.github.com/users/OliverNChalk/following{/other_user}",
      "gists_url": "https://api.github.com/users/OliverNChalk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/OliverNChalk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/OliverNChalk/subscriptions",
      "organizations_url": "https://api.github.com/users/OliverNChalk/orgs",
      "repos_url": "https://api.github.com/users/OliverNChalk/repos",
      "events_url": "https://api.github.com/users/OliverNChalk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/OliverNChalk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-02T16:35:32Z",
    "updated_at": "2023-04-02T16:35:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "@mattsse It appears that fuzz testing breaks whatever code was introduced to persist the failure state. That said, I vaguely remember seeing this fail prior to fuzzing. However, perhaps they share the same root cause.\r\n\r\nThis minimal repro should make it easier to track down:\r\nhttps://github.com/OliverNChalk/revert-to-repro",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1493386396/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1493390241",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3055#issuecomment-1493390241",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3055",
    "id": 1493390241,
    "node_id": "IC_kwDOGBlvNc5ZA1Oh",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-02T16:55:38Z",
    "updated_at": "2023-04-02T16:55:38Z",
    "author_association": "MEMBER",
    "body": "thanks, will check!",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1493390241/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
