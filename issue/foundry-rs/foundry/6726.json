{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/6726",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6726/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6726/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6726/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/6726",
  "id": 2070777351,
  "node_id": "I_kwDOGBlvNc57bY4H",
  "number": 6726,
  "title": "`fmt`: defaults produce different results between two versions",
  "user": {
    "login": "riordant",
    "id": 6988731,
    "node_id": "MDQ6VXNlcjY5ODg3MzE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6988731?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/riordant",
    "html_url": "https://github.com/riordant",
    "followers_url": "https://api.github.com/users/riordant/followers",
    "following_url": "https://api.github.com/users/riordant/following{/other_user}",
    "gists_url": "https://api.github.com/users/riordant/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/riordant/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/riordant/subscriptions",
    "organizations_url": "https://api.github.com/users/riordant/orgs",
    "repos_url": "https://api.github.com/users/riordant/repos",
    "events_url": "https://api.github.com/users/riordant/events{/privacy}",
    "received_events_url": "https://api.github.com/users/riordant/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2024-01-08T16:09:28Z",
  "updated_at": "2024-01-09T09:03:28Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Have you ensured that all of these are up to date?\r\n\r\n- [X] Foundry\r\n- [X] Foundryup\r\n\r\n### What version of Foundry are you on?\r\n\r\nforge 0.2.0 (02292f2 2024-01-08T00:22:29.377806466Z)\r\n\r\n### What command(s) is the bug in?\r\n\r\nforge fmt\r\n\r\n### Operating System\r\n\r\nLinux\r\n\r\n### Describe the bug\r\n\r\nHi guys,\r\n\r\nwe have a strange issue with formatting, that was only introduced from the `nightly-5b7e4cb3c882b28f3c32ba580de27ce7381f415a` release (2023-12-02) onwards. it appears that the default formatting rules have changed.\r\n\r\nhere is how to repro:\r\nclone https://github.com/spoolfi/spool-v2-core/, forge install\r\n\r\n`foundryup -v nightly-60ec00296f00754bc21ed68fd05ab6b54b50e024` (version 2023-11-01)\r\n`forge fmt` - produces no formatting changes.\r\n\r\n`foundryup -v nightly-5b7e4cb3c882b28f3c32ba580de27ce7381f415a` (version 2023-12-02)\r\n`forge fmt` - produces a host of changes.\r\n\r\nOur toml file has no `[fmt]` entries indicating that it should be using the defaults.\r\n\r\nThis means that we can no longer update foundry from this version without the source being modified.\r\n\r\ni have tried to figure out exactly where the issue was introduced, but the only formatting changes are to introduce `hex_underscore` rules which should not affect it. \r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/6726/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6726/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1881468175",
    "html_url": "https://github.com/foundry-rs/foundry/issues/6726#issuecomment-1881468175",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6726",
    "id": 1881468175,
    "node_id": "IC_kwDOGBlvNc5wJO0P",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2024-01-08T16:55:17Z",
    "updated_at": "2024-01-08T16:55:17Z",
    "author_association": "MEMBER",
    "body": "I see a few fixes in the diff, like enum comments, uint256 over uint, but most diffs are things like\r\n\r\n```diff\r\n-        curveStrategy = new Curve3poolStrategyHarness(\r\n-            assetGroupRegistry,\r\n-            accessControl,\r\n-            assetGroupId,\r\n-            swapper\r\n-        );\r\n+        curveStrategy = new Curve3poolStrategyHarness(assetGroupRegistry, accessControl, assetGroupId, swapper);\r\n```\r\n\r\nor \r\n\r\n```diff\r\n-            StrategyRegistry implementation = new StrategyRegistry(\r\n-                masterWallet,\r\n-                spoolAccessControl,\r\n-                usdPriceFeedManager,\r\n-                address(ghostStrategy)\r\n-            );\r\n+            StrategyRegistry implementation =\r\n+                new StrategyRegistry(masterWallet, spoolAccessControl, usdPriceFeedManager, address(ghostStrategy));\r\n```\r\n\r\nwhich would point to https://github.com/foundry-rs/foundry/pull/6408 which I consider a fix because this properly added new stmt formatting, but perhaps we need to tune this.\r\n\r\nany decision you disagree with in the diff?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1881468175/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1882639948",
    "html_url": "https://github.com/foundry-rs/foundry/issues/6726#issuecomment-1882639948",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6726",
    "id": 1882639948,
    "node_id": "IC_kwDOGBlvNc5wNs5M",
    "user": {
      "login": "riordant",
      "id": 6988731,
      "node_id": "MDQ6VXNlcjY5ODg3MzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6988731?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/riordant",
      "html_url": "https://github.com/riordant",
      "followers_url": "https://api.github.com/users/riordant/followers",
      "following_url": "https://api.github.com/users/riordant/following{/other_user}",
      "gists_url": "https://api.github.com/users/riordant/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/riordant/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/riordant/subscriptions",
      "organizations_url": "https://api.github.com/users/riordant/orgs",
      "repos_url": "https://api.github.com/users/riordant/repos",
      "events_url": "https://api.github.com/users/riordant/events{/privacy}",
      "received_events_url": "https://api.github.com/users/riordant/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2024-01-09T08:51:17Z",
    "updated_at": "2024-01-09T09:03:28Z",
    "author_association": "NONE",
    "body": "Ok, thanks for pointing it out. I was just trying to figure out if this was a breaking change or a bug, looks like the former then.\r\n\r\nNo particular thing we disagree with, it's just that it modifies audited code in our `src/`, which we do not want to change anymore. \r\n\r\nIs there anyway to preserve the previous `new` rules with new versions? I guess not as there is not a format option for `new` expressions?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1882639948/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
