{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2264",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2264/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2264/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2264/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/2264",
  "id": 1300672886,
  "node_id": "I_kwDOGBlvNc5NhrF2",
  "number": 2264,
  "title": "Recursive dependency updates can result in breaking otherwise working dependencies",
  "user": {
    "login": "ckoopmann",
    "id": 15629702,
    "node_id": "MDQ6VXNlcjE1NjI5NzAy",
    "avatar_url": "https://avatars.githubusercontent.com/u/15629702?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ckoopmann",
    "html_url": "https://github.com/ckoopmann",
    "followers_url": "https://api.github.com/users/ckoopmann/followers",
    "following_url": "https://api.github.com/users/ckoopmann/following{/other_user}",
    "gists_url": "https://api.github.com/users/ckoopmann/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ckoopmann/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ckoopmann/subscriptions",
    "organizations_url": "https://api.github.com/users/ckoopmann/orgs",
    "repos_url": "https://api.github.com/users/ckoopmann/repos",
    "events_url": "https://api.github.com/users/ckoopmann/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ckoopmann/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-07-11T12:55:28Z",
  "updated_at": "2022-07-14T07:01:31Z",
  "closed_at": "2022-07-14T07:01:31Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Have you ensured that all of these are up to date?\r\n\r\n- [X] Foundry\r\n- [X] Foundryup\r\n\r\n### What version of Foundry are you on?\r\n\r\nforge 0.2.0 (f016135 2022-07-04T00:15:02.930499Z)\r\n\r\n### What command(s) is the bug in?\r\n\r\nforge update\r\n\r\n### Operating System\r\n\r\nmacOS (Intel)\r\n\r\n### Describe the bug\r\n\r\n# Current Behaviour\r\n\r\nWhen updating a dependency using `forge update`, all nested  dependencies are updated to the latest version (if these nested dependencies are also managed using foundry / git submodule).\r\n\r\nThis can result in the installed library being in a state different from it's own source repository (which will be marked as `COMMITHASH-dirty` by git). In case the latest version of the nested dependency is not backwards compatible this can lead to the installed version of the package breaking. I created a sample repo that illustrates that issue [here](https://github.com/ckoopmann/foundry-issue-recursive-updates).\r\n\r\nIn some situations this might render the `forge update` command unusable since the user wont be able to upgrade a dependency without breaking it.\r\n\r\nEven when it doesn't break the dependency it can lead to subtle differences in its behaviour, which might be even more dangerous.\r\n\r\n# Expected behaviour\r\n\r\nThe user should have the option to update the dependency without recursively updating nested dependencies beyond changes in the depencies repo itself.\r\n\r\nCurrently the only way for the user to achieve this is to manually reinstall the package using `forge remove` and `forge install`. It would be more ergonomic to let the user disable / enable recursive updates using a flag.\r\n\r\nAlso one might want to revisit the decision (if it was a conscious one) to have recursive updates by default  since it results in behaviour that many users might find unexpected.\r\n\r\n## Possible solution\r\n\r\nRemove the `--recursive` flag [here](https://github.com/foundry-rs/foundry/blob/79419354d47d9802811a9795d989cb98c78b3c46/cli/src/forge.rs#L75) entirely or conditionally based on user input. \r\n\r\n\r\n",
  "closed_by": {
    "login": "onbjerg",
    "id": 8862627,
    "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/onbjerg",
    "html_url": "https://github.com/onbjerg",
    "followers_url": "https://api.github.com/users/onbjerg/followers",
    "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
    "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
    "organizations_url": "https://api.github.com/users/onbjerg/orgs",
    "repos_url": "https://api.github.com/users/onbjerg/repos",
    "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
    "received_events_url": "https://api.github.com/users/onbjerg/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2264/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2264/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1180745889",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2264#issuecomment-1180745889",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2264",
    "id": 1180745889,
    "node_id": "IC_kwDOGBlvNc5GYMCh",
    "user": {
      "login": "gakonst",
      "id": 17802178,
      "node_id": "MDQ6VXNlcjE3ODAyMTc4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17802178?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gakonst",
      "html_url": "https://github.com/gakonst",
      "followers_url": "https://api.github.com/users/gakonst/followers",
      "following_url": "https://api.github.com/users/gakonst/following{/other_user}",
      "gists_url": "https://api.github.com/users/gakonst/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gakonst/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gakonst/subscriptions",
      "organizations_url": "https://api.github.com/users/gakonst/orgs",
      "repos_url": "https://api.github.com/users/gakonst/repos",
      "events_url": "https://api.github.com/users/gakonst/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gakonst/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-11T18:46:15Z",
    "updated_at": "2022-07-11T18:46:15Z",
    "author_association": "MEMBER",
    "body": "Good catch - I introduced this bug many months ago [here](https://github.com/foundry-rs/foundry/commit/7c8a79e9bfeddb3009d50c5ef6238411bd882a43), should be fine to remove the recursive flag I think.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1180745889/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1181446894",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2264#issuecomment-1181446894",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2264",
    "id": 1181446894,
    "node_id": "IC_kwDOGBlvNc5Ga3Lu",
    "user": {
      "login": "sambacha",
      "id": 32783916,
      "node_id": "MDQ6VXNlcjMyNzgzOTE2",
      "avatar_url": "https://avatars.githubusercontent.com/u/32783916?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sambacha",
      "html_url": "https://github.com/sambacha",
      "followers_url": "https://api.github.com/users/sambacha/followers",
      "following_url": "https://api.github.com/users/sambacha/following{/other_user}",
      "gists_url": "https://api.github.com/users/sambacha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sambacha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sambacha/subscriptions",
      "organizations_url": "https://api.github.com/users/sambacha/orgs",
      "repos_url": "https://api.github.com/users/sambacha/repos",
      "events_url": "https://api.github.com/users/sambacha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sambacha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-12T08:01:48Z",
    "updated_at": "2022-07-12T08:01:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "you should just be doing\r\n\r\n```bash\r\ngit submodule foreach git reset --hard HEAD\r\ngit submodule update --remote --rebase lib/\r\n```\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1181446894/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1184071632",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2264#issuecomment-1184071632",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2264",
    "id": 1184071632,
    "node_id": "IC_kwDOGBlvNc5Gk3_Q",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-14T07:01:31Z",
    "updated_at": "2022-07-14T07:01:31Z",
    "author_association": "MEMBER",
    "body": "Fixed in #2274",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1184071632/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
