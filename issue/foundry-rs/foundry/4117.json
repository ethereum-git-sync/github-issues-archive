{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/4117",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4117/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4117/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4117/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/4117",
  "id": 1538026366,
  "node_id": "I_kwDOGBlvNc5brGt-",
  "number": 4117,
  "title": "`cast run --debug` failed if `ETHERSCAN_API_KEY` is set",
  "user": {
    "login": "NIC619",
    "id": 17670147,
    "node_id": "MDQ6VXNlcjE3NjcwMTQ3",
    "avatar_url": "https://avatars.githubusercontent.com/u/17670147?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/NIC619",
    "html_url": "https://github.com/NIC619",
    "followers_url": "https://api.github.com/users/NIC619/followers",
    "following_url": "https://api.github.com/users/NIC619/following{/other_user}",
    "gists_url": "https://api.github.com/users/NIC619/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/NIC619/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/NIC619/subscriptions",
    "organizations_url": "https://api.github.com/users/NIC619/orgs",
    "repos_url": "https://api.github.com/users/NIC619/repos",
    "events_url": "https://api.github.com/users/NIC619/events{/privacy}",
    "received_events_url": "https://api.github.com/users/NIC619/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-01-18T13:43:21Z",
  "updated_at": "2023-02-25T01:35:48Z",
  "closed_at": "2023-02-25T01:35:48Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nCast\r\n\r\n### Have you ensured that all of these are up to date?\r\n\r\n- [X] Foundry\r\n- [X] Foundryup\r\n\r\n### What version of Foundry are you on?\r\n\r\ncast 0.2.0 (4dc05d2 2023-01-18T00:15:05.61036Z)\r\n\r\n### What command(s) is the bug in?\r\n\r\ncast run --debug 0x72ee56dda15c2cd6c201c0d9bdc0ebd5b3b90d5c0bb88e5c8d014fc25f53a094\r\n\r\n### Operating System\r\n\r\nNone\r\n\r\n### Describe the bug\r\n\r\nCommand to debug a Goerli transaction: `cast run --debug 0x72ee56dda15c2cd6c201c0d9bdc0ebd5b3b90d5c0bb88e5c8d014fc25f53a094` failed when compiling one of the contract.\r\n\r\nError message:\r\n```bash\r\n> cast run --debug 0x72ee56dda15c2cd6c201c0d9bdc0ebd5b3b90d5c0bb88e5c8d014fc25f53a094\r\nExecuting previous transactions from the block.\r\nCompiling: Tokenlon 0x085966ee3e32a0da16467569512535d38626b547\r\nCompiling: TransparentUpgradeableProxy 0x142e4eb0b0dada349e483e355c31ff3495b85ff7\r\nCompiling: Spender 0x5508ef5ea37e42952d470582882b5bf3514265e3\r\nCompiling: AllowanceTarget 0x63dd46f09c2eab341b6affa8261024e85cdf4531\r\nCompiling: TetherToken 0xa93ef9215b907c19e739e2214e1aa5412a0401b5\r\nCompiling: WETH9 0xb4fbf271143f4fbf7b91a5ded31805e42b2208d6\r\nCompiling: LimitOrder 0xe2e5e33aec661241b3853a4460f7aaba65e950c3\r\nCompiling: UserProxy 0xe8b436dca7d20151bc09410a71468cf9c6de397e\r\nCompiling: PermanentStorage 0xfa0a2d2a9174ac175e74fff71b9ea53cbeafc064\r\nError:\r\nCompiler run failed\r\nerror[2314]: ParserError: Expected '{' but got 'constant'\r\n  --> TetherToken/Contract.sol:77:35:\r\n   |\r\n77 |     function totalSupply() public constant returns (uint);\r\n   |                                   ^^^^^^^^\r\n```\r\n\r\n~~This is the [TetherToken contract](https://goerli.etherscan.io/address/0xa93ef9215b907c19e739e2214e1aa5412a0401b5#code) it was trying to compile. It is verified on etherscan and the compiler version is specified on the etherscan. The error seems like it's compiling the contract with a different compiler. I tried compile the contract with the compiler version specified on etherscan (`v0.4.18+commit.9cf6e910`) and it succeeded.~~\r\n\r\n~~**Expected behavior: it should compile the contract with the compiler version specified on etherscan**~~\r\n\r\nWhen `ETHERSCAN_API_KEY` is set, it ran into the error shown above.\r\n\r\n**Expected behavior: it should work fine even if `ETHERSCAN_API_KEY` is set**",
  "closed_by": {
    "login": "onbjerg",
    "id": 8862627,
    "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/onbjerg",
    "html_url": "https://github.com/onbjerg",
    "followers_url": "https://api.github.com/users/onbjerg/followers",
    "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
    "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
    "organizations_url": "https://api.github.com/users/onbjerg/orgs",
    "repos_url": "https://api.github.com/users/onbjerg/repos",
    "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
    "received_events_url": "https://api.github.com/users/onbjerg/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/4117/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4117/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1387132872",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4117#issuecomment-1387132872",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4117",
    "id": 1387132872,
    "node_id": "IC_kwDOGBlvNc5SrffI",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-18T14:09:07Z",
    "updated_at": "2023-01-18T14:09:07Z",
    "author_association": "MEMBER",
    "body": "cc @rkrasiuk this looks solang-parser related I think",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1387132872/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1387145479",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4117#issuecomment-1387145479",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4117",
    "id": 1387145479,
    "node_id": "IC_kwDOGBlvNc5SrikH",
    "user": {
      "login": "rkrasiuk",
      "id": 25429261,
      "node_id": "MDQ6VXNlcjI1NDI5MjYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25429261?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rkrasiuk",
      "html_url": "https://github.com/rkrasiuk",
      "followers_url": "https://api.github.com/users/rkrasiuk/followers",
      "following_url": "https://api.github.com/users/rkrasiuk/following{/other_user}",
      "gists_url": "https://api.github.com/users/rkrasiuk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rkrasiuk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rkrasiuk/subscriptions",
      "organizations_url": "https://api.github.com/users/rkrasiuk/orgs",
      "repos_url": "https://api.github.com/users/rkrasiuk/repos",
      "events_url": "https://api.github.com/users/rkrasiuk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rkrasiuk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-18T14:17:02Z",
    "updated_at": "2023-01-18T14:17:02Z",
    "author_association": "COLLABORATOR",
    "body": "this looks like a solc error. also there shouldn't be a case where `cast run` invokes the parser. hmmm",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1387145479/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1387147902",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4117#issuecomment-1387147902",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4117",
    "id": 1387147902,
    "node_id": "IC_kwDOGBlvNc5SrjJ-",
    "user": {
      "login": "rkrasiuk",
      "id": 25429261,
      "node_id": "MDQ6VXNlcjI1NDI5MjYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25429261?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rkrasiuk",
      "html_url": "https://github.com/rkrasiuk",
      "followers_url": "https://api.github.com/users/rkrasiuk/followers",
      "following_url": "https://api.github.com/users/rkrasiuk/following{/other_user}",
      "gists_url": "https://api.github.com/users/rkrasiuk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rkrasiuk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rkrasiuk/subscriptions",
      "organizations_url": "https://api.github.com/users/rkrasiuk/orgs",
      "repos_url": "https://api.github.com/users/rkrasiuk/repos",
      "events_url": "https://api.github.com/users/rkrasiuk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rkrasiuk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-18T14:18:44Z",
    "updated_at": "2023-01-18T14:18:44Z",
    "author_association": "COLLABORATOR",
    "body": "just ran that command against goerli and there were no obvious errors",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1387147902/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1387257610",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4117#issuecomment-1387257610",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4117",
    "id": 1387257610,
    "node_id": "IC_kwDOGBlvNc5Sr98K",
    "user": {
      "login": "NIC619",
      "id": 17670147,
      "node_id": "MDQ6VXNlcjE3NjcwMTQ3",
      "avatar_url": "https://avatars.githubusercontent.com/u/17670147?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NIC619",
      "html_url": "https://github.com/NIC619",
      "followers_url": "https://api.github.com/users/NIC619/followers",
      "following_url": "https://api.github.com/users/NIC619/following{/other_user}",
      "gists_url": "https://api.github.com/users/NIC619/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NIC619/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NIC619/subscriptions",
      "organizations_url": "https://api.github.com/users/NIC619/orgs",
      "repos_url": "https://api.github.com/users/NIC619/repos",
      "events_url": "https://api.github.com/users/NIC619/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NIC619/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-18T15:29:58Z",
    "updated_at": "2023-01-18T15:30:24Z",
    "author_association": "NONE",
    "body": "> just ran that command against goerli and there were no obvious errors\r\n\r\nThanks for the info. I inspected the env variables I set and found that when `ETHERSCAN_API_KEY` is set, it will result in the error shown above. Everything works if `ETHERSCAN_API_KEY` is not set.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1387257610/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
