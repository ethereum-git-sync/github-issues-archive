{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/5716",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5716/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5716/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5716/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/5716",
  "id": 1865376506,
  "node_id": "I_kwDOGBlvNc5vL2L6",
  "number": 5716,
  "title": "forge coverge aborts with no explanation",
  "user": {
    "login": "drortirosh",
    "id": 40341007,
    "node_id": "MDQ6VXNlcjQwMzQxMDA3",
    "avatar_url": "https://avatars.githubusercontent.com/u/40341007?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/drortirosh",
    "html_url": "https://github.com/drortirosh",
    "followers_url": "https://api.github.com/users/drortirosh/followers",
    "following_url": "https://api.github.com/users/drortirosh/following{/other_user}",
    "gists_url": "https://api.github.com/users/drortirosh/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/drortirosh/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/drortirosh/subscriptions",
    "organizations_url": "https://api.github.com/users/drortirosh/orgs",
    "repos_url": "https://api.github.com/users/drortirosh/repos",
    "events_url": "https://api.github.com/users/drortirosh/events{/privacy}",
    "received_events_url": "https://api.github.com/users/drortirosh/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-08-24T15:12:24Z",
  "updated_at": "2023-10-03T10:27:56Z",
  "closed_at": "2023-09-12T13:36:15Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nForge\n\n### Have you ensured that all of these are up to date?\n\n- [ ] Foundry\n- [ ] Foundryup\n\n### What version of Foundry are you on?\n\nforge 0.2.0 (6c0fce3 2023-07-14T02:45:44.842244000Z)\n\n### What command(s) is the bug in?\n\nforge coverage\n\n### Operating System\n\nmacOS (Apple Silicon)\n\n### Describe the bug\n\ngot error:\r\n```sh\r\n$ forge coverage\r\n[⠢] Compiling...\r\n[⠔] Compiling 113 files with 0.8.20\r\n[⠒] Solc 0.8.20 finished in 1.23s\r\nError:\r\nCompiler run failed:\r\nError: Compiler error (/solidity/libyul/backends/evm/AsmCodeGen.cpp:68):Stack too deep. Try compiling with `--via-ir` (cli) or the equivalent `viaIR: true` (standard JSON) while enabling the optimizer. Otherwise, try removing local variables. When compiling inline assembly: Variable value0 is 1 slot(s) too deep inside the stack. Stack too deep. Try compiling with `--via-ir` (cli) or the equivalent `viaIR: true` (standard JSON) while enabling the optimizer. Otherwise, try removing local variables.\r\n```\r\n\r\nThe error message is not helpful.\r\ntried to run with `--via-ir` (either in command-line or in `foundry.toml`), but it seemed to be ignored.",
  "closed_by": {
    "login": "Evalir",
    "id": 26014927,
    "node_id": "MDQ6VXNlcjI2MDE0OTI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Evalir",
    "html_url": "https://github.com/Evalir",
    "followers_url": "https://api.github.com/users/Evalir/followers",
    "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
    "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
    "organizations_url": "https://api.github.com/users/Evalir/orgs",
    "repos_url": "https://api.github.com/users/Evalir/repos",
    "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Evalir/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/5716/reactions",
    "total_count": 1,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 1,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5716/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1715741301",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5716#issuecomment-1715741301",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5716",
    "id": 1715741301,
    "node_id": "IC_kwDOGBlvNc5mRCJ1",
    "user": {
      "login": "Evalir",
      "id": 26014927,
      "node_id": "MDQ6VXNlcjI2MDE0OTI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Evalir",
      "html_url": "https://github.com/Evalir",
      "followers_url": "https://api.github.com/users/Evalir/followers",
      "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
      "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
      "organizations_url": "https://api.github.com/users/Evalir/orgs",
      "repos_url": "https://api.github.com/users/Evalir/repos",
      "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Evalir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-12T13:36:15Z",
    "updated_at": "2023-09-12T13:36:15Z",
    "author_association": "MEMBER",
    "body": "Hey! this just means that you hit a stack too deep issue—this is somewhat common sadly and apart from the recommended workarounds in the compiler error we don't have too many ways around it. Let's take this to the foundry support channel so more people can chime in for workarounds!",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1715741301/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1716590463",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5716#issuecomment-1716590463",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5716",
    "id": 1716590463,
    "node_id": "IC_kwDOGBlvNc5mURd_",
    "user": {
      "login": "drortirosh",
      "id": 40341007,
      "node_id": "MDQ6VXNlcjQwMzQxMDA3",
      "avatar_url": "https://avatars.githubusercontent.com/u/40341007?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/drortirosh",
      "html_url": "https://github.com/drortirosh",
      "followers_url": "https://api.github.com/users/drortirosh/followers",
      "following_url": "https://api.github.com/users/drortirosh/following{/other_user}",
      "gists_url": "https://api.github.com/users/drortirosh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/drortirosh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/drortirosh/subscriptions",
      "organizations_url": "https://api.github.com/users/drortirosh/orgs",
      "repos_url": "https://api.github.com/users/drortirosh/repos",
      "events_url": "https://api.github.com/users/drortirosh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/drortirosh/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-12T22:15:54Z",
    "updated_at": "2023-09-12T22:15:54Z",
    "author_association": "NONE",
    "body": "The question is why foundry doesn't support the \"remedy\", which is via-ir compilation mode. \r\n\r\nWe had the same issue with sol-coverage, and found out that their latest version supports the via-ir compilation mode, and the solves the attack too deep problem. ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1716590463/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1744679296",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5716#issuecomment-1744679296",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5716",
    "id": 1744679296,
    "node_id": "IC_kwDOGBlvNc5n_bGA",
    "user": {
      "login": "Valentin-Seehausen",
      "id": 10600295,
      "node_id": "MDQ6VXNlcjEwNjAwMjk1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10600295?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Valentin-Seehausen",
      "html_url": "https://github.com/Valentin-Seehausen",
      "followers_url": "https://api.github.com/users/Valentin-Seehausen/followers",
      "following_url": "https://api.github.com/users/Valentin-Seehausen/following{/other_user}",
      "gists_url": "https://api.github.com/users/Valentin-Seehausen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Valentin-Seehausen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Valentin-Seehausen/subscriptions",
      "organizations_url": "https://api.github.com/users/Valentin-Seehausen/orgs",
      "repos_url": "https://api.github.com/users/Valentin-Seehausen/repos",
      "events_url": "https://api.github.com/users/Valentin-Seehausen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Valentin-Seehausen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-03T10:27:56Z",
    "updated_at": "2023-10-03T10:27:56Z",
    "author_association": "NONE",
    "body": "Hey, before opening a new issue: Would it be possible to get more information on which file, contract or even function this happens? This would be amazing as otherwise the only method I know is brute force, which means commenting out the code, removing files, etc.\r\n\r\nFor new projects, I add the coverage report to the GitHub CI pipeline to make sure we don't run into this in the first place, but everyone has to work with legacy code from time to time.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1744679296/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
