{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/4587",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4587/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4587/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4587/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/4587",
  "id": 1629084683,
  "node_id": "I_kwDOGBlvNc5hGdwL",
  "number": 4587,
  "title": "Unable to verify contract that uses external library",
  "user": {
    "login": "j-vp",
    "id": 104004836,
    "node_id": "U_kgDOBjL85A",
    "avatar_url": "https://avatars.githubusercontent.com/u/104004836?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/j-vp",
    "html_url": "https://github.com/j-vp",
    "followers_url": "https://api.github.com/users/j-vp/followers",
    "following_url": "https://api.github.com/users/j-vp/following{/other_user}",
    "gists_url": "https://api.github.com/users/j-vp/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/j-vp/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/j-vp/subscriptions",
    "organizations_url": "https://api.github.com/users/j-vp/orgs",
    "repos_url": "https://api.github.com/users/j-vp/repos",
    "events_url": "https://api.github.com/users/j-vp/events{/privacy}",
    "received_events_url": "https://api.github.com/users/j-vp/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-03-17T10:39:37Z",
  "updated_at": "2023-10-22T18:52:17Z",
  "closed_at": "2023-06-20T18:14:10Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Have you ensured that all of these are up to date?\r\n\r\n- [X] Foundry\r\n- [X] Foundryup\r\n\r\n### What version of Foundry are you on?\r\n\r\nforge 0.2.0 (df8ab09 2023-03-14T09:59:20.944687208Z)\r\n\r\n### What command(s) is the bug in?\r\n\r\nforge verify-contract 0xe1De7d003D27232245B4c6d9D6F29F744f46516b Counter --chain-id 10 --num-of-optimizations 200 --constructor-args $(cast abi-encode \"constructor(address)\" \"0x000000000000000000000000000000000000007B\") --watch --compiler-version v0.8.17+commit.8df45f5f -e $KEY\r\n\r\n### Operating System\r\n\r\nLinux\r\n\r\n### Describe the bug\r\n\r\nProvided contracts deployed at https://github.com/j-vp/foundry-issue-4587\r\n\r\nRunning the following command: \r\n```\r\nforge verify-contract 0xe1De7d003D27232245B4c6d9D6F29F744f46516b Counter --chain-id 10 --num-of-optimizations 200 --constructor-args $(cast abi-encode \"constructor(address)\" \"0x000000000000000000000000000000000000007B\") --watch --compiler-version v0.8.17+commit.8df45f5f -e $OPTETHKEY\r\n```\r\n\r\nreturns with \r\n```\r\nStart verifying contract `0xe1de7d003d27232245b4c6d9d6f29f744f46516b` deployed on optimism\r\n\r\nSubmitting verification for [src/Counter.sol:Counter] \"0xe1De7d003D27232245B4c6d9D6F29F744f46516b\".\r\nSubmitted contract for verification:\r\n        Response: `OK`\r\n        GUID: `sp8tqhdsxc3kdxk8xfemggde3a9hvbcebmvz99gcdpqf2k83ud`\r\n        URL:\r\n        https://optimistic.etherscan.io/address/0xe1de7d003d27232245b4c6d9d6f29f744f46516b\r\nContract verification status:\r\nResponse: `NOTOK`\r\nDetails: `Pending in queue`\r\nContract verification status:\r\nResponse: `NOTOK`\r\nDetails: `Fail - Unable to verify. Error! Plese check for missing Library or invalid name (i.e names are case senstive). Library was required but suitable match not found`\r\nContract failed to verify.\r\n```\r\n\r\nContract `0xe1de7d003d27232245b4c6d9d6f29f744f46516b` (to be verified) uses an external library deployed at `0xC9c0433D488672B7937929002ae014FE21bbb2FF`, named `ExtLib` (see code).\r\n\r\nI cannot seem to get the command working with `--libraries`. For example:\r\n\r\n```\r\nforge verify-contract 0xe1De7d003D27232245B4c6d9D6F29F744f46516b Counter --chain-id 10 --num-of-optimizations 200 --constructor-args $(cast abi-encode \"constructor(address)\" \"0x000000000000000000000000000000000000007B\") --watch --compiler-version v0.8.17+commit.8df45f5f -e $OPTETHKEY --libraries ExtLib\r\n```\r\n```\r\nforge verify-contract 0xe1De7d003D27232245B4c6d9D6F29F744f46516b Counter --chain-id 10 --num-of-optimizations 200 --constructor-args $(cast abi-encode \"constructor(address)\" \"0x000000000000000000000000000000000000007B\") --watch --compiler-version v0.8.17+commit.8df45f5f -e $OPTETHKEY --libraries 0xC9c0433D488672B7937929002ae014FE21bbb2FF\r\n```\r\n```\r\nforge verify-contract 0xe1De7d003D27232245B4c6d9D6F29F744f46516b Counter --chain-id 10 --num-of-optimizations 200 --constructor-args $(cast abi-encode \"constructor(address)\" \"0x000000000000000000000000000000000000007B\") --watch --compiler-version v0.8.17+commit.8df45f5f -e $OPTETHKEY --libraries ExtLib:0xC9c0433D488672B7937929002ae014FE21bbb2FF\r\n```\r\n```\r\nforge verify-contract 0xe1De7d003D27232245B4c6d9D6F29F744f46516b Counter --chain-id 10 --num-of-optimizations 200 --constructor-args $(cast abi-encode \"constructor(address)\" \"0x000000000000000000000000000000000000007B\") --watch --compiler-version v0.8.17+commit.8df45f5f -e $OPTETHKEY --libraries src/ExtLib.sol\r\n```\r\n\r\nall return with \r\n```Error: \r\nfailed to parse library address: 0xC9c0433D488672B7937929002ae014FE21bbb2FF\r\n``` \r\nor similar.\r\n\r\nThe library itself can be verified with `forge verify-contract`\r\n\r\nQuestion: how to use the `--libraries` field?\r\n",
  "closed_by": {
    "login": "Evalir",
    "id": 26014927,
    "node_id": "MDQ6VXNlcjI2MDE0OTI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Evalir",
    "html_url": "https://github.com/Evalir",
    "followers_url": "https://api.github.com/users/Evalir/followers",
    "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
    "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
    "organizations_url": "https://api.github.com/users/Evalir/orgs",
    "repos_url": "https://api.github.com/users/Evalir/repos",
    "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Evalir/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/4587/reactions",
    "total_count": 3,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 1
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4587/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1522159970",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4587#issuecomment-1522159970",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4587",
    "id": 1522159970,
    "node_id": "IC_kwDOGBlvNc5aulFi",
    "user": {
      "login": "nicolas-geniteau",
      "id": 30727364,
      "node_id": "MDQ6VXNlcjMwNzI3MzY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/30727364?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nicolas-geniteau",
      "html_url": "https://github.com/nicolas-geniteau",
      "followers_url": "https://api.github.com/users/nicolas-geniteau/followers",
      "following_url": "https://api.github.com/users/nicolas-geniteau/following{/other_user}",
      "gists_url": "https://api.github.com/users/nicolas-geniteau/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nicolas-geniteau/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nicolas-geniteau/subscriptions",
      "organizations_url": "https://api.github.com/users/nicolas-geniteau/orgs",
      "repos_url": "https://api.github.com/users/nicolas-geniteau/repos",
      "events_url": "https://api.github.com/users/nicolas-geniteau/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nicolas-geniteau/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-25T17:29:22Z",
    "updated_at": "2023-04-25T17:29:22Z",
    "author_association": "NONE",
    "body": "I had the same issue. Valid format for `--libraries` is `file:name:addr` : https://github.com/gakonst/ethers-rs/blob/0b2bf4f6c3d4c5061f833672a23568a928912102/ethers-solc/src/artifacts/mod.rs#L546\r\n\r\n`--libraries src/ExtLib.sol:ExtLib:0xC9c0433D488672B7937929002ae014FE21bbb2FF` works.\r\n\r\nWe should improve documentation for this.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1522159970/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 2,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1599280476",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4587#issuecomment-1599280476",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4587",
    "id": 1599280476,
    "node_id": "IC_kwDOGBlvNc5fUxVc",
    "user": {
      "login": "Evalir",
      "id": 26014927,
      "node_id": "MDQ6VXNlcjI2MDE0OTI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Evalir",
      "html_url": "https://github.com/Evalir",
      "followers_url": "https://api.github.com/users/Evalir/followers",
      "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
      "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
      "organizations_url": "https://api.github.com/users/Evalir/orgs",
      "repos_url": "https://api.github.com/users/Evalir/repos",
      "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Evalir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-20T18:14:10Z",
    "updated_at": "2023-06-20T18:14:10Z",
    "author_association": "MEMBER",
    "body": "Closing—answer was provided.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1599280476/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1774072232",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4587#issuecomment-1774072232",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4587",
    "id": 1774072232,
    "node_id": "IC_kwDOGBlvNc5pvjGo",
    "user": {
      "login": "johnnyonline",
      "id": 103320838,
      "node_id": "U_kgDOBiiNBg",
      "avatar_url": "https://avatars.githubusercontent.com/u/103320838?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/johnnyonline",
      "html_url": "https://github.com/johnnyonline",
      "followers_url": "https://api.github.com/users/johnnyonline/followers",
      "following_url": "https://api.github.com/users/johnnyonline/following{/other_user}",
      "gists_url": "https://api.github.com/users/johnnyonline/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/johnnyonline/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/johnnyonline/subscriptions",
      "organizations_url": "https://api.github.com/users/johnnyonline/orgs",
      "repos_url": "https://api.github.com/users/johnnyonline/repos",
      "events_url": "https://api.github.com/users/johnnyonline/events{/privacy}",
      "received_events_url": "https://api.github.com/users/johnnyonline/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-22T11:47:51Z",
    "updated_at": "2023-10-22T11:47:51Z",
    "author_association": "NONE",
    "body": "how do i pass several arguments (i.e. several libraries) to the `--libraries` flag though?\r\n\r\na space or a `,` seems to fail with `failed to parse, too many arguments passed`.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1774072232/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1774170574",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4587#issuecomment-1774170574",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4587",
    "id": 1774170574,
    "node_id": "IC_kwDOGBlvNc5pv7HO",
    "user": {
      "login": "johnnyonline",
      "id": 103320838,
      "node_id": "U_kgDOBiiNBg",
      "avatar_url": "https://avatars.githubusercontent.com/u/103320838?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/johnnyonline",
      "html_url": "https://github.com/johnnyonline",
      "followers_url": "https://api.github.com/users/johnnyonline/followers",
      "following_url": "https://api.github.com/users/johnnyonline/following{/other_user}",
      "gists_url": "https://api.github.com/users/johnnyonline/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/johnnyonline/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/johnnyonline/subscriptions",
      "organizations_url": "https://api.github.com/users/johnnyonline/orgs",
      "repos_url": "https://api.github.com/users/johnnyonline/repos",
      "events_url": "https://api.github.com/users/johnnyonline/events{/privacy}",
      "received_events_url": "https://api.github.com/users/johnnyonline/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-22T18:52:17Z",
    "updated_at": "2023-10-22T18:52:17Z",
    "author_association": "NONE",
    "body": "> how do i pass several arguments (i.e. several libraries) to the `--libraries` flag though?\r\n> \r\n> a space or a `,` seems to fail with `failed to parse, too many arguments passed`.\r\n\r\nspecifying `--libraries` several times did the trick.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1774170574/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
