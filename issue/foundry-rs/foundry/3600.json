{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/3600",
  "id": 1434218313,
  "node_id": "I_kwDOGBlvNc5VfG9J",
  "number": 3600,
  "title": "`forge coverage` does not work for if statements within for loops",
  "user": {
    "login": "KittyFu307",
    "id": 61280608,
    "node_id": "MDQ6VXNlcjYxMjgwNjA4",
    "avatar_url": "https://avatars.githubusercontent.com/u/61280608?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/KittyFu307",
    "html_url": "https://github.com/KittyFu307",
    "followers_url": "https://api.github.com/users/KittyFu307/followers",
    "following_url": "https://api.github.com/users/KittyFu307/following{/other_user}",
    "gists_url": "https://api.github.com/users/KittyFu307/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/KittyFu307/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/KittyFu307/subscriptions",
    "organizations_url": "https://api.github.com/users/KittyFu307/orgs",
    "repos_url": "https://api.github.com/users/KittyFu307/repos",
    "events_url": "https://api.github.com/users/KittyFu307/events{/privacy}",
    "received_events_url": "https://api.github.com/users/KittyFu307/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    },
    {
      "id": 3703752787,
      "node_id": "LA_kwDOGBlvNc7cwshT",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-forge",
      "name": "C-forge",
      "color": "5319E7",
      "default": false,
      "description": "Command: forge"
    },
    {
      "id": 4233058229,
      "node_id": "LA_kwDOGBlvNc78T1e1",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/Cmd-forge-coverage",
      "name": "Cmd-forge-coverage",
      "color": "006B75",
      "default": false,
      "description": "Command: forge coverage"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 18,
  "created_at": "2022-11-03T07:23:05Z",
  "updated_at": "2023-05-10T15:21:27Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Have you ensured that all of these are up to date?\r\n\r\n- [ ] Foundry\r\n- [X] Foundryup\r\n\r\n### What version of Foundry are you on?\r\n\r\nforge 0.2.0 (70f4fb5 2022-11-03T00:06:25.653195Z)\r\n\r\n### What command(s) is the bug in?\r\n\r\nforge coverage\r\n\r\n### Operating System\r\n\r\nmacOS (Apple Silicon)\r\n\r\n### Describe the bug\r\n\r\nWhen I run `forge coverage` to test the coverage for my code, I found that I have written the code to match the all branches but the result seems not. If I call the external function, it will not cover this branch.\r\n<img width=\"1400\" alt=\"截屏2022-11-03 下午5 00 14\" src=\"https://user-images.githubusercontent.com/61280608/199681927-e6b79bef-0f44-434c-96a9-7fb2993f783d.png\">\r\n\r\n\r\nThe coverage result is \r\n<img width=\"1481\" alt=\"截屏2022-11-03 下午5 03 07\" src=\"https://user-images.githubusercontent.com/61280608/199682048-a97f6741-9e30-4e9e-a0cf-4ddfeb0ca289.png\">\r\n\r\nBut I think my test function have covered all situations, and the result is not\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1339933473",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1339933473",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1339933473,
    "node_id": "IC_kwDOGBlvNc5P3cMh",
    "user": {
      "login": "chrismin",
      "id": 9753941,
      "node_id": "MDQ6VXNlcjk3NTM5NDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9753941?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chrismin",
      "html_url": "https://github.com/chrismin",
      "followers_url": "https://api.github.com/users/chrismin/followers",
      "following_url": "https://api.github.com/users/chrismin/following{/other_user}",
      "gists_url": "https://api.github.com/users/chrismin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chrismin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chrismin/subscriptions",
      "organizations_url": "https://api.github.com/users/chrismin/orgs",
      "repos_url": "https://api.github.com/users/chrismin/repos",
      "events_url": "https://api.github.com/users/chrismin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chrismin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-06T19:58:54Z",
    "updated_at": "2022-12-06T19:58:54Z",
    "author_association": "NONE",
    "body": "I'm unfortunately seeing the same issue. It seems to be related to coverage of \"if\" statements. Is there any update on this bug?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1339933473/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1341896188",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1341896188",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1341896188,
    "node_id": "IC_kwDOGBlvNc5P-7X8",
    "user": {
      "login": "KittyFu307",
      "id": 61280608,
      "node_id": "MDQ6VXNlcjYxMjgwNjA4",
      "avatar_url": "https://avatars.githubusercontent.com/u/61280608?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/KittyFu307",
      "html_url": "https://github.com/KittyFu307",
      "followers_url": "https://api.github.com/users/KittyFu307/followers",
      "following_url": "https://api.github.com/users/KittyFu307/following{/other_user}",
      "gists_url": "https://api.github.com/users/KittyFu307/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/KittyFu307/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KittyFu307/subscriptions",
      "organizations_url": "https://api.github.com/users/KittyFu307/orgs",
      "repos_url": "https://api.github.com/users/KittyFu307/repos",
      "events_url": "https://api.github.com/users/KittyFu307/events{/privacy}",
      "received_events_url": "https://api.github.com/users/KittyFu307/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-08T02:33:02Z",
    "updated_at": "2022-12-08T02:33:02Z",
    "author_association": "NONE",
    "body": "> I'm unfortunately seeing the same issue. It seems to be related to coverage of \"if\" statements. Is there any update on this bug?\r\n\r\nunfortunately not, maybe you can @their-developers in this issue to see if there any updates",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1341896188/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1420828477",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1420828477",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1420828477,
    "node_id": "IC_kwDOGBlvNc5UsB89",
    "user": {
      "login": "PaulRBerg",
      "id": 8782666,
      "node_id": "MDQ6VXNlcjg3ODI2NjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8782666?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PaulRBerg",
      "html_url": "https://github.com/PaulRBerg",
      "followers_url": "https://api.github.com/users/PaulRBerg/followers",
      "following_url": "https://api.github.com/users/PaulRBerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulRBerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PaulRBerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulRBerg/subscriptions",
      "organizations_url": "https://api.github.com/users/PaulRBerg/orgs",
      "repos_url": "https://api.github.com/users/PaulRBerg/repos",
      "events_url": "https://api.github.com/users/PaulRBerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PaulRBerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-07T14:04:38Z",
    "updated_at": "2023-02-07T14:04:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "Just bumped into this, as well:\r\n\r\n<img width=\"1102\" alt=\"Screenshot 2023-02-07 at 4 01 57 PM\" src=\"https://user-images.githubusercontent.com/8782666/217266474-17d9cb68-a4e9-4021-94b4-84ff6df4e6e4.png\">\r\n\r\nIt looks like the common denominator between my case and @KittyFu307's is the presence of an if statement in a for loop.\r\n\r\nTherefore, the title of this issue should be changed to something like \"`forge coverage` does not work for if statements within for loops\".",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1420828477/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1421906471",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1421906471",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1421906471,
    "node_id": "IC_kwDOGBlvNc5UwJIn",
    "user": {
      "login": "KittyFu307",
      "id": 61280608,
      "node_id": "MDQ6VXNlcjYxMjgwNjA4",
      "avatar_url": "https://avatars.githubusercontent.com/u/61280608?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/KittyFu307",
      "html_url": "https://github.com/KittyFu307",
      "followers_url": "https://api.github.com/users/KittyFu307/followers",
      "following_url": "https://api.github.com/users/KittyFu307/following{/other_user}",
      "gists_url": "https://api.github.com/users/KittyFu307/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/KittyFu307/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KittyFu307/subscriptions",
      "organizations_url": "https://api.github.com/users/KittyFu307/orgs",
      "repos_url": "https://api.github.com/users/KittyFu307/repos",
      "events_url": "https://api.github.com/users/KittyFu307/events{/privacy}",
      "received_events_url": "https://api.github.com/users/KittyFu307/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-08T02:53:08Z",
    "updated_at": "2023-02-08T02:53:08Z",
    "author_association": "NONE",
    "body": "Hi @rkrasiuk any update for this issue? Thank you for your time",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1421906471/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1422239051",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1422239051",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1422239051,
    "node_id": "IC_kwDOGBlvNc5UxaVL",
    "user": {
      "login": "PaulRBerg",
      "id": 8782666,
      "node_id": "MDQ6VXNlcjg3ODI2NjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8782666?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PaulRBerg",
      "html_url": "https://github.com/PaulRBerg",
      "followers_url": "https://api.github.com/users/PaulRBerg/followers",
      "following_url": "https://api.github.com/users/PaulRBerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulRBerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PaulRBerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulRBerg/subscriptions",
      "organizations_url": "https://api.github.com/users/PaulRBerg/orgs",
      "repos_url": "https://api.github.com/users/PaulRBerg/repos",
      "events_url": "https://api.github.com/users/PaulRBerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PaulRBerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-08T08:48:15Z",
    "updated_at": "2023-02-08T08:48:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "@KittyFu307 it may be useful to rename the title of this issue to include a reference to for loops so that other users who bump into the same problem can reach us here.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1422239051/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1422284018",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1422284018",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1422284018,
    "node_id": "IC_kwDOGBlvNc5UxlTy",
    "user": {
      "login": "KittyFu307",
      "id": 61280608,
      "node_id": "MDQ6VXNlcjYxMjgwNjA4",
      "avatar_url": "https://avatars.githubusercontent.com/u/61280608?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/KittyFu307",
      "html_url": "https://github.com/KittyFu307",
      "followers_url": "https://api.github.com/users/KittyFu307/followers",
      "following_url": "https://api.github.com/users/KittyFu307/following{/other_user}",
      "gists_url": "https://api.github.com/users/KittyFu307/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/KittyFu307/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KittyFu307/subscriptions",
      "organizations_url": "https://api.github.com/users/KittyFu307/orgs",
      "repos_url": "https://api.github.com/users/KittyFu307/repos",
      "events_url": "https://api.github.com/users/KittyFu307/events{/privacy}",
      "received_events_url": "https://api.github.com/users/KittyFu307/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-08T09:22:11Z",
    "updated_at": "2023-02-08T09:22:11Z",
    "author_association": "NONE",
    "body": "> @KittyFu307 it may be useful to rename the title of this issue to include a reference to for loops so that other users who bump into the same problem can reach us here.\r\n\r\nSure~ have already done",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1422284018/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1422851412",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1422851412",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1422851412,
    "node_id": "IC_kwDOGBlvNc5Uzv1U",
    "user": {
      "login": "PaulRBerg",
      "id": 8782666,
      "node_id": "MDQ6VXNlcjg3ODI2NjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8782666?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PaulRBerg",
      "html_url": "https://github.com/PaulRBerg",
      "followers_url": "https://api.github.com/users/PaulRBerg/followers",
      "following_url": "https://api.github.com/users/PaulRBerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulRBerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PaulRBerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulRBerg/subscriptions",
      "organizations_url": "https://api.github.com/users/PaulRBerg/orgs",
      "repos_url": "https://api.github.com/users/PaulRBerg/repos",
      "events_url": "https://api.github.com/users/PaulRBerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PaulRBerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-08T15:59:32Z",
    "updated_at": "2023-02-08T16:01:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "Actually, as per the code shared by @KittyFu307 in the OP, and per @chrismin's comment, this issue may be about if statements more broadly, not just some cases within for loops.\r\n\r\nI've recently bumped into another nasty bug in the coverage command, which may be related (though this is based on a gut feeling):\r\n\r\nhttps://github.com/foundry-rs/foundry/issues/4309",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1422851412/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1422852640",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1422852640",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1422852640,
    "node_id": "IC_kwDOGBlvNc5UzwIg",
    "user": {
      "login": "PaulRBerg",
      "id": 8782666,
      "node_id": "MDQ6VXNlcjg3ODI2NjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8782666?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PaulRBerg",
      "html_url": "https://github.com/PaulRBerg",
      "followers_url": "https://api.github.com/users/PaulRBerg/followers",
      "following_url": "https://api.github.com/users/PaulRBerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulRBerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PaulRBerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulRBerg/subscriptions",
      "organizations_url": "https://api.github.com/users/PaulRBerg/orgs",
      "repos_url": "https://api.github.com/users/PaulRBerg/repos",
      "events_url": "https://api.github.com/users/PaulRBerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PaulRBerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-08T16:00:17Z",
    "updated_at": "2023-02-08T16:02:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "I can't manage to pin down what this bug is about, exactly.\r\n\r\nhttps://github.com/foundry-rs/foundry/issues/3497 may also be related.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1422852640/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1422929870",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1422929870",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1422929870,
    "node_id": "IC_kwDOGBlvNc5U0C_O",
    "user": {
      "login": "PaulRBerg",
      "id": 8782666,
      "node_id": "MDQ6VXNlcjg3ODI2NjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8782666?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PaulRBerg",
      "html_url": "https://github.com/PaulRBerg",
      "followers_url": "https://api.github.com/users/PaulRBerg/followers",
      "following_url": "https://api.github.com/users/PaulRBerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulRBerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PaulRBerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulRBerg/subscriptions",
      "organizations_url": "https://api.github.com/users/PaulRBerg/orgs",
      "repos_url": "https://api.github.com/users/PaulRBerg/repos",
      "events_url": "https://api.github.com/users/PaulRBerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PaulRBerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-08T16:49:54Z",
    "updated_at": "2023-02-08T16:49:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "**Update**: I have managed to get to the bottom of this, opened an issue here:\r\n\r\nhttps://github.com/foundry-rs/foundry/issues/4310\r\n\r\n@KittyFu307 this is definitely the same issue you encountered in  your `loopChoose` function, though the issue you had in `branchChoose` may be something completely unrelated.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1422929870/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1423229093",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1423229093",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1423229093,
    "node_id": "IC_kwDOGBlvNc5U1MCl",
    "user": {
      "login": "PaulRBerg",
      "id": 8782666,
      "node_id": "MDQ6VXNlcjg3ODI2NjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8782666?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PaulRBerg",
      "html_url": "https://github.com/PaulRBerg",
      "followers_url": "https://api.github.com/users/PaulRBerg/followers",
      "following_url": "https://api.github.com/users/PaulRBerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulRBerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PaulRBerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulRBerg/subscriptions",
      "organizations_url": "https://api.github.com/users/PaulRBerg/orgs",
      "repos_url": "https://api.github.com/users/PaulRBerg/repos",
      "events_url": "https://api.github.com/users/PaulRBerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PaulRBerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-08T20:57:37Z",
    "updated_at": "2023-02-08T20:57:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think that I have figured it out - @KittyFu307, your original issue was actually reporting on two bugs in Foundry. One I documented myself in #4310; the other has been documented and discussed in #3497.\r\n\r\nIf someone else could confirm my guess, then I suggest we close this issue in favor of #4310 and #3497, which are more targeted.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1423229093/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1423730950",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1423730950",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1423730950,
    "node_id": "IC_kwDOGBlvNc5U3GkG",
    "user": {
      "login": "KittyFu307",
      "id": 61280608,
      "node_id": "MDQ6VXNlcjYxMjgwNjA4",
      "avatar_url": "https://avatars.githubusercontent.com/u/61280608?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/KittyFu307",
      "html_url": "https://github.com/KittyFu307",
      "followers_url": "https://api.github.com/users/KittyFu307/followers",
      "following_url": "https://api.github.com/users/KittyFu307/following{/other_user}",
      "gists_url": "https://api.github.com/users/KittyFu307/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/KittyFu307/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KittyFu307/subscriptions",
      "organizations_url": "https://api.github.com/users/KittyFu307/orgs",
      "repos_url": "https://api.github.com/users/KittyFu307/repos",
      "events_url": "https://api.github.com/users/KittyFu307/events{/privacy}",
      "received_events_url": "https://api.github.com/users/KittyFu307/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-09T07:06:40Z",
    "updated_at": "2023-02-09T07:06:40Z",
    "author_association": "NONE",
    "body": "> I think that I have figured it out - @KittyFu307, your original issue was actually reporting on two bugs in Foundry. One I documented myself in #4310; the other has been documented and discussed in #3497.\r\n> \r\n> If someone else could confirm my guess, then I suggest we close this issue in favor of #4310 and #3497, which are more targeted.\r\n\r\nOh @PaulRBerg Thank you for taking the time to debug this error. I am pretty sure that the problem of the `loopChoose` function is the same as that of #4310. This has troubled me for a long time. I hope foundry team can solve it.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1423730950/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1423760659",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1423760659",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1423760659,
    "node_id": "IC_kwDOGBlvNc5U3N0T",
    "user": {
      "login": "PaulRBerg",
      "id": 8782666,
      "node_id": "MDQ6VXNlcjg3ODI2NjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8782666?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PaulRBerg",
      "html_url": "https://github.com/PaulRBerg",
      "followers_url": "https://api.github.com/users/PaulRBerg/followers",
      "following_url": "https://api.github.com/users/PaulRBerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulRBerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PaulRBerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulRBerg/subscriptions",
      "organizations_url": "https://api.github.com/users/PaulRBerg/orgs",
      "repos_url": "https://api.github.com/users/PaulRBerg/repos",
      "events_url": "https://api.github.com/users/PaulRBerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PaulRBerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-09T07:39:53Z",
    "updated_at": "2023-02-09T07:39:53Z",
    "author_association": "CONTRIBUTOR",
    "body": "No worries, @KittyFu307. Pinging @onbjerg in case he could take a quick look? Seems like an easy fix.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1423760659/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1423826579",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1423826579",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1423826579,
    "node_id": "IC_kwDOGBlvNc5U3d6T",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-09T08:43:59Z",
    "updated_at": "2023-02-09T08:44:29Z",
    "author_association": "MEMBER",
    "body": "I am completely out of the loop on Foundry so I do not have the context necessary to figure out if this is an easy fix or not. My best guess is that the common denominator for all of these complexly linked issues is that we detect branches by detecting sequences of bytecode, and it is possible that detection is not strict enough for overlapping cases.\n\nFor the other isssues (array access, calls) there are hidden reverts, so essentially all of the issues boil down to this one, as they can be thought of as an if-statement with a revert in the else clause",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1423826579/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1423921786",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1423921786",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1423921786,
    "node_id": "IC_kwDOGBlvNc5U31J6",
    "user": {
      "login": "PaulRBerg",
      "id": 8782666,
      "node_id": "MDQ6VXNlcjg3ODI2NjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8782666?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PaulRBerg",
      "html_url": "https://github.com/PaulRBerg",
      "followers_url": "https://api.github.com/users/PaulRBerg/followers",
      "following_url": "https://api.github.com/users/PaulRBerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulRBerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PaulRBerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulRBerg/subscriptions",
      "organizations_url": "https://api.github.com/users/PaulRBerg/orgs",
      "repos_url": "https://api.github.com/users/PaulRBerg/repos",
      "events_url": "https://api.github.com/users/PaulRBerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PaulRBerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-09T09:59:50Z",
    "updated_at": "2023-02-09T09:59:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thank you for taking the time to respond, @onbjerg.\r\n\r\n> For the other isssues (array access, calls) there are hidden reverts\r\n\r\nThere are cases when there are clearly no hidden reverts, e.g. the one I documented in #4310:\r\n\r\n```solidity\r\nfunction isOdd(uint256 number) external view returns (bool odd) {\r\n    uint256[] memory arr = new uint256[](1);\r\n    arr[0] = block.timestamp;\r\n\r\n    if (number % 2 == 1) {\r\n        odd = true;\r\n        arr[0];\r\n    } else {\r\n        odd = false;\r\n    }\r\n}\r\n```\r\n\r\nThe `arr` array is initialized with a size of 1, so `arr[0]` cannot revert in this function.\r\n\r\nRegarding calls - it may be the case that a hidden revert is what generates partial coverage for certain calls. However, as I suggested [here](https://github.com/foundry-rs/foundry/issues/3497#issuecomment-1423220193), there should definitely be a way to opt-out of the default revert-covering requirements with a comment (e.g. `// forgecov: ignore-next-line-revert`).",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1423921786/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1424222772",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1424222772",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1424222772,
    "node_id": "IC_kwDOGBlvNc5U4-o0",
    "user": {
      "login": "mds1",
      "id": 17163988,
      "node_id": "MDQ6VXNlcjE3MTYzOTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mds1",
      "html_url": "https://github.com/mds1",
      "followers_url": "https://api.github.com/users/mds1/followers",
      "following_url": "https://api.github.com/users/mds1/following{/other_user}",
      "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
      "organizations_url": "https://api.github.com/users/mds1/orgs",
      "repos_url": "https://api.github.com/users/mds1/repos",
      "events_url": "https://api.github.com/users/mds1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mds1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-09T13:52:15Z",
    "updated_at": "2023-02-09T13:53:31Z",
    "author_association": "COLLABORATOR",
    "body": "That `isOdd` function is not payable, so there is a revert in the case where `msg.value > 0`. Not sure if that's the issue, but just mentioning since there is in fact a hidden revert there. One tip is using `forge inspect MyContract ir-optimized` and checking out what solidity generates to see what it's doing under the hood (you may already know this)",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1424222772/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1424315514",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1424315514",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1424315514,
    "node_id": "IC_kwDOGBlvNc5U5VR6",
    "user": {
      "login": "PaulRBerg",
      "id": 8782666,
      "node_id": "MDQ6VXNlcjg3ODI2NjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8782666?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PaulRBerg",
      "html_url": "https://github.com/PaulRBerg",
      "followers_url": "https://api.github.com/users/PaulRBerg/followers",
      "following_url": "https://api.github.com/users/PaulRBerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulRBerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PaulRBerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulRBerg/subscriptions",
      "organizations_url": "https://api.github.com/users/PaulRBerg/orgs",
      "repos_url": "https://api.github.com/users/PaulRBerg/repos",
      "events_url": "https://api.github.com/users/PaulRBerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PaulRBerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-09T14:53:22Z",
    "updated_at": "2023-02-09T14:53:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "Interesting point, @mds1, but unfortunately, no, this wasn't the issue. After adding the `payable` modifier, the 50% branch coverage stayed put:\r\n\r\n```text\r\n| File        | % Lines       | % Statements  | % Branches   | % Funcs       |\r\n|-------------|---------------|---------------|--------------|---------------|\r\n| src/Foo.sol | 100.00% (5/5) | 100.00% (6/6) | 50.00% (1/2) | 100.00% (1/1) |\r\n| Total       | 100.00% (5/5) | 100.00% (6/6) | 50.00% (1/2) | 100.00% (1/1) |\r\n```\r\n\r\nHowever, if Forge did actually report partial coverage for non-payable functions, that would be a bad user experience IMO.\r\n\r\n1. This is not something obvious, not at all.\r\n2. Developers are interested in testing the business logic of their protocol - not that a standard compiler feature works.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1424315514/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1542230373",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1542230373",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1542230373,
    "node_id": "IC_kwDOGBlvNc5b7JFl",
    "user": {
      "login": "deboguer-jng",
      "id": 71242057,
      "node_id": "MDQ6VXNlcjcxMjQyMDU3",
      "avatar_url": "https://avatars.githubusercontent.com/u/71242057?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/deboguer-jng",
      "html_url": "https://github.com/deboguer-jng",
      "followers_url": "https://api.github.com/users/deboguer-jng/followers",
      "following_url": "https://api.github.com/users/deboguer-jng/following{/other_user}",
      "gists_url": "https://api.github.com/users/deboguer-jng/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/deboguer-jng/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/deboguer-jng/subscriptions",
      "organizations_url": "https://api.github.com/users/deboguer-jng/orgs",
      "repos_url": "https://api.github.com/users/deboguer-jng/repos",
      "events_url": "https://api.github.com/users/deboguer-jng/events{/privacy}",
      "received_events_url": "https://api.github.com/users/deboguer-jng/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-10T13:39:21Z",
    "updated_at": "2023-05-10T13:39:21Z",
    "author_association": "NONE",
    "body": "I've same issues on our project. @PaulRBerg any update on this issue?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1542230373/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1542400093",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3600#issuecomment-1542400093",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3600",
    "id": 1542400093,
    "node_id": "IC_kwDOGBlvNc5b7yhd",
    "user": {
      "login": "PaulRBerg",
      "id": 8782666,
      "node_id": "MDQ6VXNlcjg3ODI2NjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8782666?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PaulRBerg",
      "html_url": "https://github.com/PaulRBerg",
      "followers_url": "https://api.github.com/users/PaulRBerg/followers",
      "following_url": "https://api.github.com/users/PaulRBerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulRBerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PaulRBerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulRBerg/subscriptions",
      "organizations_url": "https://api.github.com/users/PaulRBerg/orgs",
      "repos_url": "https://api.github.com/users/PaulRBerg/repos",
      "events_url": "https://api.github.com/users/PaulRBerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PaulRBerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-10T15:21:27Z",
    "updated_at": "2023-05-10T15:21:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "No, @deboguer-jng. Also, I have never been involved in the development of the `forge coverage` command - I am just a user like you.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1542400093/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 1,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
