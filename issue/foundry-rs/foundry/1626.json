{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/1626",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1626/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1626/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1626/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/1626",
  "id": 1236171707,
  "node_id": "I_kwDOGBlvNc5Jrnu7",
  "number": 1626,
  "title": "anvil_reset not resetting account nonces",
  "user": {
    "login": "kushalbabel",
    "id": 12293028,
    "node_id": "MDQ6VXNlcjEyMjkzMDI4",
    "avatar_url": "https://avatars.githubusercontent.com/u/12293028?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kushalbabel",
    "html_url": "https://github.com/kushalbabel",
    "followers_url": "https://api.github.com/users/kushalbabel/followers",
    "following_url": "https://api.github.com/users/kushalbabel/following{/other_user}",
    "gists_url": "https://api.github.com/users/kushalbabel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kushalbabel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kushalbabel/subscriptions",
    "organizations_url": "https://api.github.com/users/kushalbabel/orgs",
    "repos_url": "https://api.github.com/users/kushalbabel/repos",
    "events_url": "https://api.github.com/users/kushalbabel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kushalbabel/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    },
    {
      "id": 4077188949,
      "node_id": "LA_kwDOGBlvNc7zBPdV",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-anvil",
      "name": "C-anvil",
      "color": "5319E7",
      "default": false,
      "description": "Command: anvil"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 10,
  "created_at": "2022-05-15T02:54:53Z",
  "updated_at": "2022-05-16T15:32:48Z",
  "closed_at": "2022-05-16T15:32:48Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nAnvil\n\n### Have you ensured that all of these are up to date?\n\n- [X] Foundry\n- [X] Foundryup\n\n### What version of Foundry are you on?\n\nforge 0.2.0 (b33422f 2022-05-14T23:44:53.523516601Z)\n\n### What command(s) is the bug in?\n\n anvil --fork-url http://localhost:8545 --fork-block-number 14000000 --port 8544 --order fifo\n\n### Operating System\n\nLinux\n\n### Describe the bug\n\nAccount nonces are not being reset to 0, when calling `anvil_reset`. i.e., transactions with nonce 0 are not being included in the mined block after the following sequence of calls : `anvil_reset` ,  `evm_setAutomine` (to false) , `hardhat_setBalance`  ,  `eth_sendRawTransaction`  and `evm_mine`\r\nPrevious fix that tried resetting everything : https://github.com/foundry-rs/foundry/pull/1614 \r\n\r\n",
  "closed_by": {
    "login": "mattsse",
    "id": 19890894,
    "node_id": "MDQ6VXNlcjE5ODkwODk0",
    "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mattsse",
    "html_url": "https://github.com/mattsse",
    "followers_url": "https://api.github.com/users/mattsse/followers",
    "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
    "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
    "organizations_url": "https://api.github.com/users/mattsse/orgs",
    "repos_url": "https://api.github.com/users/mattsse/repos",
    "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mattsse/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/1626/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1626/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1126848641",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1626#issuecomment-1126848641",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1626",
    "id": 1126848641,
    "node_id": "IC_kwDOGBlvNc5DKliB",
    "user": {
      "login": "kushalbabel",
      "id": 12293028,
      "node_id": "MDQ6VXNlcjEyMjkzMDI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/12293028?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kushalbabel",
      "html_url": "https://github.com/kushalbabel",
      "followers_url": "https://api.github.com/users/kushalbabel/followers",
      "following_url": "https://api.github.com/users/kushalbabel/following{/other_user}",
      "gists_url": "https://api.github.com/users/kushalbabel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kushalbabel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kushalbabel/subscriptions",
      "organizations_url": "https://api.github.com/users/kushalbabel/orgs",
      "repos_url": "https://api.github.com/users/kushalbabel/repos",
      "events_url": "https://api.github.com/users/kushalbabel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kushalbabel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-15T02:55:20Z",
    "updated_at": "2022-05-15T02:55:20Z",
    "author_association": "NONE",
    "body": "@mattsse ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1126848641/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127463237",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1626#issuecomment-1127463237",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1626",
    "id": 1127463237,
    "node_id": "IC_kwDOGBlvNc5DM7lF",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-16T09:52:14Z",
    "updated_at": "2022-05-16T10:55:26Z",
    "author_association": "MEMBER",
    "body": "does the address in question have a nonce > 0 in the original chain?\r\n\r\nor are nonces on the fork not reset?\r\n\r\nhow did you call `anvil_reset`?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127463237/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127687452",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1626#issuecomment-1127687452",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1626",
    "id": 1127687452,
    "node_id": "IC_kwDOGBlvNc5DNyUc",
    "user": {
      "login": "kushalbabel",
      "id": 12293028,
      "node_id": "MDQ6VXNlcjEyMjkzMDI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/12293028?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kushalbabel",
      "html_url": "https://github.com/kushalbabel",
      "followers_url": "https://api.github.com/users/kushalbabel/followers",
      "following_url": "https://api.github.com/users/kushalbabel/following{/other_user}",
      "gists_url": "https://api.github.com/users/kushalbabel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kushalbabel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kushalbabel/subscriptions",
      "organizations_url": "https://api.github.com/users/kushalbabel/orgs",
      "repos_url": "https://api.github.com/users/kushalbabel/repos",
      "events_url": "https://api.github.com/users/kushalbabel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kushalbabel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-16T13:37:45Z",
    "updated_at": "2022-05-16T13:38:03Z",
    "author_association": "NONE",
    "body": "The address in question has nonce = 0 on the original chain. \r\nThe nonces on the fork are not reset.\r\nHere's how to reproduce it:\r\n\r\nServer : `anvil --fork-url http://localhost:8545 --fork-block-number 14000000 --port 8544 --order fifo`\r\n\r\nClient : \r\n`\r\ncurl -X POST -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate' -H 'Connection: keep-alive' -H 'Content-Length: 143' -H 'Content-Type: application/json' -H 'User-Agent: python-requests/2.22.0' -d '{\"jsonrpc\": \"2.0\", \"method\": \"anvil_reset\", \"params\": [{\"forking\": {\"jsonRpcUrl\": \"http://localhost:8545\", \"blockNumber\": 14000000}}], \"id\": 1}' http://localhost:8544/\r\n`\r\n\r\nOut[3]: `{'jsonrpc': '2.0', 'id': 1, 'result': None}`\r\n\r\n`\r\ncurl -X POST -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate' -H 'Connection: keep-alive' -H 'Content-Length: 75' -H 'Content-Type: application/json' -H 'User-Agent: python-requests/2.22.0' -d '{\"jsonrpc\": \"2.0\", \"method\": \"evm_setAutomine\", \"params\": [false], \"id\": 1}' http://localhost:8544/\r\n`\r\n\r\nOut[4]: `{'jsonrpc': '2.0', 'id': 1, 'result': None}`\r\n\r\n`\r\ncurl -X POST -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate' -H 'Connection: keep-alive' -H 'Content-Length: 141' -H 'Content-Type: application/json' -H 'User-Agent: python-requests/2.22.0' -d '{\"jsonrpc\": \"2.0\", \"method\": \"hardhat_setBalance\", \"params\": [\"0x05E3bD644724652DD57246bae865d4A644151603\", \"0x3635c9adc5dea00000\"], \"id\": 1}' http://localhost:8544/\r\n`\r\n\r\nOut[5]: `{'jsonrpc': '2.0', 'id': 1, 'result': None}`\r\n\r\n`\r\ncurl -X POST -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate' -H 'Connection: keep-alive' -H 'Content-Length: 315' -H 'Content-Type: application/json' -H 'User-Agent: python-requests/2.22.0' -d '{\"jsonrpc\": \"2.0\", \"method\": \"eth_sendRawTransaction\", \"params\": [\"0x02f87201018203e885222ca72a9283e4e1c09442bd55c6502e586d66020ece3fda53cb73d73b6d888ac7230489e8000080c001a0ea7ef215784c929f527111e05b94d314abfb9fcff0a2e51c7332a0f5642b9266a04d8322be0166befb42962c2ad6a15ef641c326774cf547f17f8917ac1bf3aed6\"], \"id\": 1}' http://localhost:8544/\r\n`\r\n\r\n`\r\ncurl -X POST -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate' -H 'Connection: keep-alive' -H 'Content-Length: 64' -H 'Content-Type: application/json' -H 'User-Agent: python-requests/2.22.0' -d '{\"jsonrpc\": \"2.0\", \"method\": \"evm_mine\", \"params\": [1], \"id\": 1}' http://localhost:8544/\r\n`\r\n\r\nOut[7]: `{'jsonrpc': '2.0', 'id': 1, 'result': '0x0'}`\r\n\r\n`\r\ncurl -X POST -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate' -H 'Connection: keep-alive' -H 'Content-Length: 91' -H 'Content-Type: application/json' -H 'User-Agent: python-requests/2.22.0' -d '{\"jsonrpc\": \"2.0\", \"method\": \"eth_getBlockByNumber\", \"params\": [\"0xd59f81\", true], \"id\": 1}' http://localhost:8544/\r\n`  \r\n\r\n\r\nOut[8]:\r\n`\r\n{'jsonrpc': '2.0',\r\n 'id': 1,\r\n 'result': {'baseFeePerGas': '0x3b9aca00',\r\n  'difficulty': '0x0',\r\n  'extraData': '0x',\r\n  'gasLimit': '0x1c9c380',\r\n  'gasUsed': '0x5208',\r\n  'hash': '0xc7f4a1e64f55a308a74e3c54dd44446b635882a7a9f9d4a037e0416dde2323ad',\r\n  'logsBloom': '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',\r\n  'miner': '0x0000000000000000000000000000000000000000',\r\n  'mixHash': '0x0000000000000000000000000000000000000000000000000000000000000000',\r\n  'nonce': '0x0',\r\n  'number': '0xd59f81',\r\n  'parentHash': '0x9bff49171de27924fa958faf7b7ce605c1ff0fdee86f4c0c74239e6ae20d9446',\r\n  'receiptsRoot': '0xacc0e2639ea755553beb4b48123fe5d662d7a0d5a30b4f04c99af102ad607faf',\r\n  'sealFields': ['0x0000000000000000000000000000000000000000000000000000000000000000',\r\n   '0x0000000000000000'],\r\n  'sha3Uncles': '0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347',\r\n  'size': '0x26e',\r\n  'stateRoot': '0x0000000000000000000000000000000000000000000000000000000000000000',\r\n  'timestamp': '0x1',\r\n  'totalDifficulty': None,\r\n  'transactions': [{'accessList': [],\r\n    'blockHash': '0xc7f4a1e64f55a308a74e3c54dd44446b635882a7a9f9d4a037e0416dde2323ad',\r\n    'blockNumber': '0xd59f81',\r\n    'chainId': '0x1',\r\n    'from': '0x05e3bd644724652dd57246bae865d4a644151603',\r\n    'gas': '0xe4e1c0',\r\n    'gasPrice': '0x3b9acde8',\r\n    'hash': '0xf2d860d6dd6fe37bc8e094441f0c1408e3432e00f244e3356b0fed01a7bab02e',\r\n    'input': '0x',\r\n    'maxFeePerGas': '0x222ca72a92',\r\n    'maxPriorityFeePerGas': '0x3e8',\r\n    'nonce': '0x0',\r\n    'r': '0x9c0b89a5d0bce12665fb3918d0936e81d73a7b1c7f3e6dae2d9161922753a487',\r\n    's': '0x421da8bef7cb845431f6ec0dd40aa7d37f5abaf48da1fa62de2efa5508b3d063',\r\n    'to': '0x42bd55c6502e586d66020ece3fda53cb73d73b6d',\r\n    'transactionIndex': '0x0',\r\n    'type': '0x2',\r\n    'v': '0x0',\r\n    'value': '0x8ac7230489e80000'}],\r\n  'transactionsRoot': '0x9d2ee2f7e97691aeb4693c2004dd33ca3c02d1f948ad19e1c5096be654e55d6b',\r\n  'uncles': []}}\r\n`\r\n\r\n **Transaction mined in this block with nonce 0. \r\nWhen I repeat the same commands, transaction does not get mined unless I set the nonce in `eth_sendRawTransaction` params to 1.** \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127687452/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127725989",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1626#issuecomment-1127725989",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1626",
    "id": 1127725989,
    "node_id": "IC_kwDOGBlvNc5DN7ul",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-16T14:10:43Z",
    "updated_at": "2022-05-16T14:10:43Z",
    "author_association": "MEMBER",
    "body": "thanks for the instructions, but can't reproduce this on master\r\n\r\nafter evm_mine\r\n```console\r\n curl -X POST -H 'Content-Type: application/json' --data '{\"jsonrpc\":\"2.0\",\"method\":\"eth_getTransactionCount\",\"params\":[\"0x05e3bd644724652dd57246bae865d4a644151603\", \"latest\"],\"id\":1}' http://localhost:8544/\r\n```\r\n\r\nOut: `{\"jsonrpc\":\"2.0\",\"id\":1,\"result\":\"0x1\"}`\r\n\r\n\r\n```console\r\ncurl -X POST -H 'Content-Type: application/json' -d '{\"jsonrpc\": \"2.0\", \"method\": \"anvil_reset\", \"params\": [{\"forking\": {\"jsonRpcUrl\": \"https://eth-mainnet.alchemyapi.io/v2/Lc7oIGYeL_QvInzI0Wiu_pOZZDEKBrdf\", \"blockNumber\": 14000000}}], \"id\": 1}' http://localhost:8544/\r\n```\r\n\r\n```console\r\n curl -X POST -H 'Content-Type: application/json' --data '{\"jsonrpc\":\"2.0\",\"method\":\"eth_getTransactionCount\",\"params\":[\"0x05e3bd644724652dd57246bae865d4a644151603\", \"latest\"],\"id\":1}' http://localhost:8544/\r\n```\r\n\r\nOut: `{\"jsonrpc\":\"2.0\",\"id\":1,\"result\":\"0x0\"}`\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127725989/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127741552",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1626#issuecomment-1127741552",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1626",
    "id": 1127741552,
    "node_id": "IC_kwDOGBlvNc5DN_hw",
    "user": {
      "login": "kushalbabel",
      "id": 12293028,
      "node_id": "MDQ6VXNlcjEyMjkzMDI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/12293028?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kushalbabel",
      "html_url": "https://github.com/kushalbabel",
      "followers_url": "https://api.github.com/users/kushalbabel/followers",
      "following_url": "https://api.github.com/users/kushalbabel/following{/other_user}",
      "gists_url": "https://api.github.com/users/kushalbabel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kushalbabel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kushalbabel/subscriptions",
      "organizations_url": "https://api.github.com/users/kushalbabel/orgs",
      "repos_url": "https://api.github.com/users/kushalbabel/repos",
      "events_url": "https://api.github.com/users/kushalbabel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kushalbabel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-16T14:23:10Z",
    "updated_at": "2022-05-16T14:27:23Z",
    "author_association": "NONE",
    "body": "Strange, I'm able to reproduce using the same calls! I'm building from commit b33422f on master. Could it be because I'm running a local node whereas you are trying with alchemy, and that somehow has different caching behaviours etc.?\r\n\r\n`\r\ncurl -X POST -H 'Content-Type: application/json' --data '{\"jsonrpc\":\"2.0\",\"method\":\"eth_getTransactionCount\",\"params\":[\"0x05e3bd644724652dd57246bae865d4a644151603\", \"latest\"],\"id\":1}' http://localhost:8544/\r\n`\r\n\r\n`\r\n{\"jsonrpc\":\"2.0\",\"id\":1,\"result\":\"0x1\"}\r\n`\r\n\r\n`\r\ncurl -X POST -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate' -H 'Connection: keep-alive' -H 'Content-Length: 143' -H 'Content-Type: application/json' -H 'User-Agent: python-requests/2.22.0' -d '{\"jsonrpc\": \"2.0\", \"method\": \"anvil_reset\", \"params\": [{\"forking\": {\"jsonRpcUrl\": \"http://localhost:8545\", \"blockNumber\": 14000000}}], \"id\": 1}' http://localhost:8544\r\n`\r\n\r\n`\r\ncurl -X POST -H 'Content-Type: application/json' --data '{\"jsonrpc\":\"2.0\",\"method\":\"eth_getTransactionCount\",\"params\":[\"0x05e3bd644724652dd57246bae865d4a644151603\", \"latest\"],\"id\":1}' http://localhost:8544/\r\n`\r\n\r\n`\r\n{\"jsonrpc\":\"2.0\",\"id\":1,\"result\":\"0x1\"}\r\n`",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127741552/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127761686",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1626#issuecomment-1127761686",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1626",
    "id": 1127761686,
    "node_id": "IC_kwDOGBlvNc5DOEcW",
    "user": {
      "login": "kushalbabel",
      "id": 12293028,
      "node_id": "MDQ6VXNlcjEyMjkzMDI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/12293028?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kushalbabel",
      "html_url": "https://github.com/kushalbabel",
      "followers_url": "https://api.github.com/users/kushalbabel/followers",
      "following_url": "https://api.github.com/users/kushalbabel/following{/other_user}",
      "gists_url": "https://api.github.com/users/kushalbabel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kushalbabel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kushalbabel/subscriptions",
      "organizations_url": "https://api.github.com/users/kushalbabel/orgs",
      "repos_url": "https://api.github.com/users/kushalbabel/repos",
      "events_url": "https://api.github.com/users/kushalbabel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kushalbabel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-16T14:40:01Z",
    "updated_at": "2022-05-16T14:57:23Z",
    "author_association": "NONE",
    "body": "Also able to reproduce with your Alchemy url. I'm here : forge 0.2.0 (https://github.com/foundry-rs/foundry/commit/b33422f4468261ba74939bc36e236bcf6ccceb5f 2022-05-14T23:44:53.523516601Z)  on Ubuntu 20.04.3 LTS\r\n\r\nServer : ` anvil --fork-url https://eth-mainnet.alchemyapi.io/v2/Lc7oIGYeL_QvInzI0Wiu_pOZZDEKBrdf --fork-block-number 14000000 --port 8544 --order fifo `\r\n\r\nClient : \r\n\r\n`curl -X POST -H 'Content-Type: application/json' -d '{\"jsonrpc\": \"2.0\", \"method\": \"anvil_reset\", \"params\": [{\"forking\": {\"jsonRpcUrl\": \"https://eth-mainnet.alchemyapi.io/v2/Lc7oIGYeL_QvInzI0Wiu_pOZZDEKBrdf\", \"blockNumber\": 14000000}}], \"id\": 1}' http://localhost:8544/`\r\n\r\n`curl -X POST -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate' -H 'Connection: keep-alive' -H 'Content-Length: 75' -H 'Content-Type: application/json' -H 'User-Agent: python-requests/2.22.0' -d '{\"jsonrpc\": \"2.0\", \"method\": \"evm_setAutomine\", \"params\": [false], \"id\": 1}' http://localhost:8544/`\r\n\r\n`curl -X POST -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate' -H 'Connection: keep-alive' -H 'Content-Length: 141' -H 'Content-Type: application/json' -H 'User-Agent: python-requests/2.22.0' -d '{\"jsonrpc\": \"2.0\", \"method\": \"hardhat_setBalance\", \"params\": [\"0x05E3bD644724652DD57246bae865d4A644151603\", \"0x3635c9adc5dea00000\"], \"id\": 1}' http://localhost:8544/`\r\n\r\n`curl -X POST -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate' -H 'Connection: keep-alive' -H 'Content-Length: 315' -H 'Content-Type: application/json' -H 'User-Agent: python-requests/2.22.0' -d '{\"jsonrpc\": \"2.0\", \"method\": \"eth_sendRawTransaction\", \"params\": [\"0x02f87201018203e885222ca72a9283e4e1c09442bd55c6502e586d66020ece3fda53cb73d73b6d888ac7230489e8000080c001a0ea7ef215784c929f527111e05b94d314abfb9fcff0a2e51c7332a0f5642b9266a04d8322be0166befb42962c2ad6a15ef641c326774cf547f17f8917ac1bf3aed6\"], \"id\": 1}' http://localhost:8544/`\r\n\r\n`curl -X POST -H 'Accept: */*' -H 'Accept-Encoding: gzip, deflate' -H 'Connection: keep-alive' -H 'Content-Length: 64' -H 'Content-Type: application/json' -H 'User-Agent: python-requests/2.22.0' -d '{\"jsonrpc\": \"2.0\", \"method\": \"evm_mine\", \"params\": [1], \"id\": 1}' http://localhost:8544/`\r\n\r\n`curl -X POST -H 'Content-Type: application/json' -d '{\"jsonrpc\": \"2.0\", \"method\": \"anvil_reset\", \"params\": [{\"forking\": {\"jsonRpcUrl\": \"https://eth-mainnet.alchemyapi.io/v2/Lc7oIGYeL_QvInzI0Wiu_pOZZDEKBrdf\", \"blockNumber\": 14000000}}], \"id\": 1}' http://localhost:8544/`\r\n\r\n`curl -X POST -H 'Content-Type: application/json' --data '{\"jsonrpc\":\"2.0\",\"method\":\"eth_getTransactionCount\",\"params\":[\"0x05e3bd644724652dd57246bae865d4a644151603\", \"latest\"],\"id\":1}' http://localhost:8544/`\r\n\r\nreturns `{\"jsonrpc\":\"2.0\",\"id\":1,\"result\":\"0x1\"}`",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127761686/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127788666",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1626#issuecomment-1127788666",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1626",
    "id": 1127788666,
    "node_id": "IC_kwDOGBlvNc5DOLB6",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-16T15:03:59Z",
    "updated_at": "2022-05-16T15:03:59Z",
    "author_association": "MEMBER",
    "body": "tried all commands on the current master 34d2414, which yields \r\n\r\n```console\r\ncurl -X POST -H 'Content-Type: application/json' --data '{\"jsonrpc\":\"2.0\",\"method\":\"eth_getTransactionCount\",\"params\":[\"0x05e3bd644724652dd57246bae865d4a644151603\", \"latest\"],\"id\":1}' http://localhost:8544/\r\n```\r\n```\r\n{\"jsonrpc\":\"2.0\",\"id\":1,\"result\":\"0x0\"}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127788666/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127804167",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1626#issuecomment-1127804167",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1626",
    "id": 1127804167,
    "node_id": "IC_kwDOGBlvNc5DOO0H",
    "user": {
      "login": "kushalbabel",
      "id": 12293028,
      "node_id": "MDQ6VXNlcjEyMjkzMDI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/12293028?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kushalbabel",
      "html_url": "https://github.com/kushalbabel",
      "followers_url": "https://api.github.com/users/kushalbabel/followers",
      "following_url": "https://api.github.com/users/kushalbabel/following{/other_user}",
      "gists_url": "https://api.github.com/users/kushalbabel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kushalbabel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kushalbabel/subscriptions",
      "organizations_url": "https://api.github.com/users/kushalbabel/orgs",
      "repos_url": "https://api.github.com/users/kushalbabel/repos",
      "events_url": "https://api.github.com/users/kushalbabel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kushalbabel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-16T15:17:05Z",
    "updated_at": "2022-05-16T15:17:30Z",
    "author_association": "NONE",
    "body": "Ahh, it works correctly on the latest commit https://github.com/foundry-rs/foundry/commit/34d24142fe556bee02b43719deb87c5e6a8bfaaf !\r\nLooks like it was fixed in https://github.com/foundry-rs/foundry/commit/35f60f1e80348ada20e8b54e7a61bea0fe61c076 after I opened this issue",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127804167/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127805115",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1626#issuecomment-1127805115",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1626",
    "id": 1127805115,
    "node_id": "IC_kwDOGBlvNc5DOPC7",
    "user": {
      "login": "kushalbabel",
      "id": 12293028,
      "node_id": "MDQ6VXNlcjEyMjkzMDI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/12293028?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kushalbabel",
      "html_url": "https://github.com/kushalbabel",
      "followers_url": "https://api.github.com/users/kushalbabel/followers",
      "following_url": "https://api.github.com/users/kushalbabel/following{/other_user}",
      "gists_url": "https://api.github.com/users/kushalbabel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kushalbabel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kushalbabel/subscriptions",
      "organizations_url": "https://api.github.com/users/kushalbabel/orgs",
      "repos_url": "https://api.github.com/users/kushalbabel/repos",
      "events_url": "https://api.github.com/users/kushalbabel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kushalbabel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-16T15:17:57Z",
    "updated_at": "2022-05-16T15:17:57Z",
    "author_association": "NONE",
    "body": "Thanks a lot @mattsse :)",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127805115/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127822547",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1626#issuecomment-1127822547",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1626",
    "id": 1127822547,
    "node_id": "IC_kwDOGBlvNc5DOTTT",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-16T15:32:48Z",
    "updated_at": "2022-05-16T15:32:48Z",
    "author_association": "MEMBER",
    "body": "gg closing now",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1127822547/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
