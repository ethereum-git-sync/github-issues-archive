{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/330",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/330/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/330/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/330/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/330",
  "id": 1090685651,
  "node_id": "I_kwDOGBlvNc5BAorT",
  "number": 330,
  "title": "feat(forge): fuzzer should bias towards edge cases",
  "user": {
    "login": "mds1",
    "id": 17163988,
    "node_id": "MDQ6VXNlcjE3MTYzOTg4",
    "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mds1",
    "html_url": "https://github.com/mds1",
    "followers_url": "https://api.github.com/users/mds1/followers",
    "following_url": "https://api.github.com/users/mds1/following{/other_user}",
    "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
    "organizations_url": "https://api.github.com/users/mds1/orgs",
    "repos_url": "https://api.github.com/users/mds1/repos",
    "events_url": "https://api.github.com/users/mds1/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mds1/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-12-29T18:31:07Z",
  "updated_at": "2022-01-06T03:40:47Z",
  "closed_at": "2022-01-06T03:40:47Z",
  "author_association": "COLLABORATOR",
  "active_lock_reason": null,
  "body": "Fuzzing is done with proptest, which generates uniformly distributed values. This has the [downside](https://github.com/AltSysrq/proptest#limitations-of-property-testing) of almost never generating edge case values, and it's important to generate these when fuzzing as the extremes are often where issues arise.\r\n\r\nproptest [does not](https://github.com/AltSysrq/proptest/issues/82) have a way to bias these values towards extremes, so that will need be manually. Dapptools uses quickcheck and handles this with the following behavior:\r\n\r\n> For number types dapptools does 1/3 this type of \"low numbers more likely\"\r\n> 1/3 uniform distribution \r\n> 1/3 maxint - \"low numbers more likely\"\r\n>\r\n> larger values can still pop up in the \"small types are more likely mode\"\r\n> \r\n> Not sure exactly what that distribution looks like, there's a nice comment about it in the quickcheck code citing some paper\r\n\r\nSo:\r\n- We should look for this paper and implement that algorithm. [Here](https://github.com/nick8325/quickcheck/issues/98) is a quickcheck issue that discusses biasing and might reference the paper\r\n- Might be able to take the uniformly distributed random number and feed it to a function to change the distribution so it biases extremes\r\n- Probably can't hurt to hardcode some edge cases to be sure theyâ€™re covered, such as 0, 1, max, min, max - 1, min + 1",
  "closed_by": {
    "login": "mds1",
    "id": 17163988,
    "node_id": "MDQ6VXNlcjE3MTYzOTg4",
    "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mds1",
    "html_url": "https://github.com/mds1",
    "followers_url": "https://api.github.com/users/mds1/followers",
    "following_url": "https://api.github.com/users/mds1/following{/other_user}",
    "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
    "organizations_url": "https://api.github.com/users/mds1/orgs",
    "repos_url": "https://api.github.com/users/mds1/repos",
    "events_url": "https://api.github.com/users/mds1/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mds1/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/330/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/330/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1003762771",
    "html_url": "https://github.com/foundry-rs/foundry/issues/330#issuecomment-1003762771",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/330",
    "id": 1003762771,
    "node_id": "IC_kwDOGBlvNc471DRT",
    "user": {
      "login": "mds1",
      "id": 17163988,
      "node_id": "MDQ6VXNlcjE3MTYzOTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mds1",
      "html_url": "https://github.com/mds1",
      "followers_url": "https://api.github.com/users/mds1/followers",
      "following_url": "https://api.github.com/users/mds1/following{/other_user}",
      "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
      "organizations_url": "https://api.github.com/users/mds1/orgs",
      "repos_url": "https://api.github.com/users/mds1/repos",
      "events_url": "https://api.github.com/users/mds1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mds1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-02T19:22:51Z",
    "updated_at": "2022-01-02T19:22:51Z",
    "author_association": "COLLABORATOR",
    "body": "The third bullet could be a good compromise for now as it's a simple way to get similar behavior without finding and implementing the quickcheck/dapptools algorithm.\r\n\r\nWe can hardcode edge case values by type and use [`proptest::sample::select`](https://docs.rs/proptest/latest/proptest/sample/fn.select.html) to generate a strategy of those values, then use [`prop_union`](https://docs.rs/proptest/latest/proptest/strategy/trait.Strategy.html#method.prop_union) to sample from either a random value or our hardcoded edge cases. Need to make sure this approach is smart enough to only sample each hardcoded edge case value once",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1003762771/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1006260234",
    "html_url": "https://github.com/foundry-rs/foundry/issues/330#issuecomment-1006260234",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/330",
    "id": 1006260234,
    "node_id": "IC_kwDOGBlvNc47-lAK",
    "user": {
      "login": "mds1",
      "id": 17163988,
      "node_id": "MDQ6VXNlcjE3MTYzOTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mds1",
      "html_url": "https://github.com/mds1",
      "followers_url": "https://api.github.com/users/mds1/followers",
      "following_url": "https://api.github.com/users/mds1/following{/other_user}",
      "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
      "organizations_url": "https://api.github.com/users/mds1/orgs",
      "repos_url": "https://api.github.com/users/mds1/repos",
      "events_url": "https://api.github.com/users/mds1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mds1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-06T03:40:47Z",
    "updated_at": "2022-01-06T03:40:47Z",
    "author_association": "COLLABORATOR",
    "body": "closing in favor of https://github.com/gakonst/foundry/issues/387 to consolidate all fuzzer discussion",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1006260234/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
