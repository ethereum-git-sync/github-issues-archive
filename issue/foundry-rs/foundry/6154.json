{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/6154",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6154/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6154/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6154/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/6154",
  "id": 1966275289,
  "node_id": "I_kwDOGBlvNc51MvrZ",
  "number": 6154,
  "title": "Scripting borked: No such file or directory (os error 2)",
  "user": {
    "login": "robriks",
    "id": 80549215,
    "node_id": "MDQ6VXNlcjgwNTQ5MjE1",
    "avatar_url": "https://avatars.githubusercontent.com/u/80549215?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/robriks",
    "html_url": "https://github.com/robriks",
    "followers_url": "https://api.github.com/users/robriks/followers",
    "following_url": "https://api.github.com/users/robriks/following{/other_user}",
    "gists_url": "https://api.github.com/users/robriks/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/robriks/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/robriks/subscriptions",
    "organizations_url": "https://api.github.com/users/robriks/orgs",
    "repos_url": "https://api.github.com/users/robriks/repos",
    "events_url": "https://api.github.com/users/robriks/events{/privacy}",
    "received_events_url": "https://api.github.com/users/robriks/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2023-10-27T22:47:23Z",
  "updated_at": "2023-10-28T19:01:27Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Have you ensured that all of these are up to date?\r\n\r\n- [X] Foundry\r\n- [X] Foundryup\r\n\r\n### What version of Foundry are you on?\r\n\r\nforge 0.2.0 (602460e 2023-10-24T00:16:58.926357929Z)\r\n\r\n### What command(s) is the bug in?\r\n\r\nforge script\r\n\r\n### Operating System\r\n\r\nLinux\r\n\r\n### Describe the bug\r\n\r\nRunning `forge script` has started to fail with error \"No such file or directory (os error 2)\" and I am not sure why.\r\n\r\nFor example, ` forge script script/accountGroup/AccountGroup.s.sol` on a file that definitely exists (see screenshot) fails.\r\n\r\n![image](https://github.com/foundry-rs/foundry/assets/80549215/59b7ebd4-1190-4eb3-9753-b1bbc6e48972)\r\n\r\nRelevant items that I have investigated to no avail:\r\n- Deleting `../.svm` worked once, but I can no longer use this fix since the .svm file is either no longer being generated or only worked the first time. Have had trouble finding documentation around the .svm file and what generates it. I feel like it is the strongest lead since nuking it fixed the problem once\r\n- Installing z3 prover theorem did not help (problem started on an Ubuntu VM running on Apple M1 silicon, not sure if it is relevant)\r\n- Downloading Solc binary from solc-bin repository and using the local binary did not help\r\n- Cloning the repository to a new environment (cpu architecture, OS) worked for a bit but begins to fail similarly within a day (usually when `forge build --force` or `forge update` is invoked). I discovered this by switching to Ubuntu WSL running on Windows 10, which worked briefly before borking. Same for switching to Ubuntu 22.04 desktop on AMD64.\r\n- There is a file I am reading from using `vm.readFile()` that sometimes doesn't exist, but for months it had given a more verbose warning reminding me to create the file and not caused any issues of this scale. The os error 2 warning is different, and creating the file in both the 0xRails git submodule and the GroupOS parent repository does not resolve the error\r\n- Attempted purging all submodules and re-adding them using `forge install purged_submodule` did not make a difference\r\n- Tried ensuring remappings from submodules do not overwrite by using declarations in remappings.txt like `src/=src/` and `test/=test/` etc\r\n\r\nCan provide a reference branch to reproduce this issue, but I need to make some changes first.\r\n\r\nPlease help, I am running out of leads to investigate! I feel like the .svm and the git submodule leads are most relevant since I confirmed issues WRT both, but resolving them does not fix the problem.\r\n\r\nPossibly related? `forge update` fails with errors caused by submodule dependencies like the below:\r\n`fatal: Needed a single revision\r\nfatal: Unable to find current origin/v1.3.0 revision in submodule path 'lib/forge-std'\r\nfatal: Needed a single revision\r\nfatal: Unable to find current origin/v4.9.3 revision in submodule path 'lib/openzeppelin-contracts'\r\nfatal: Needed a single revision\r\nfatal: Unable to find current origin/v0.3.1 revision in submodule path 'lib/erc6551'`",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/6154/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6154/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1783594355",
    "html_url": "https://github.com/foundry-rs/foundry/issues/6154#issuecomment-1783594355",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6154",
    "id": 1783594355,
    "node_id": "IC_kwDOGBlvNc5qT31z",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-27T22:57:55Z",
    "updated_at": "2023-10-27T22:57:55Z",
    "author_association": "MEMBER",
    "body": "thanks for looking into this.\r\n\r\nis this public by any chance?\r\n\r\ncan you charge the logs that you get from running with RUST_LOG like `RUST_LOG=trace forge ...`?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1783594355/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1783595001",
    "html_url": "https://github.com/foundry-rs/foundry/issues/6154#issuecomment-1783595001",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6154",
    "id": 1783595001,
    "node_id": "IC_kwDOGBlvNc5qT3_5",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-27T22:59:03Z",
    "updated_at": "2023-10-27T22:59:03Z",
    "author_association": "MEMBER",
    "body": "can you also try after foundryup, we fixed a few issues the last few days.\r\n\r\nsorry for the inconveniences ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1783595001/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1783859146",
    "html_url": "https://github.com/foundry-rs/foundry/issues/6154#issuecomment-1783859146",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6154",
    "id": 1783859146,
    "node_id": "IC_kwDOGBlvNc5qU4fK",
    "user": {
      "login": "robriks",
      "id": 80549215,
      "node_id": "MDQ6VXNlcjgwNTQ5MjE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/80549215?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/robriks",
      "html_url": "https://github.com/robriks",
      "followers_url": "https://api.github.com/users/robriks/followers",
      "following_url": "https://api.github.com/users/robriks/following{/other_user}",
      "gists_url": "https://api.github.com/users/robriks/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/robriks/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/robriks/subscriptions",
      "organizations_url": "https://api.github.com/users/robriks/orgs",
      "repos_url": "https://api.github.com/users/robriks/repos",
      "events_url": "https://api.github.com/users/robriks/events{/privacy}",
      "received_events_url": "https://api.github.com/users/robriks/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-28T16:09:10Z",
    "updated_at": "2023-10-28T16:37:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yeah of course! `foundryup` does not fix the issue. Here are the `RUST_LOG=trace` outputs, unfortunately there are so many that my terminal cannot fit all of them so it is truncated. If you need more of the logs I can try to find a way to modify my terminal to fit and copy paste the entirety of it.\r\n\r\nI think the traces at the end of the logs are probably what we are after anyway. I can also pass the `--force` flag for more info or provide the `solidity-files-cache.json` file if that is helpful.\r\n\r\n[RustTraceLogs.txt](https://github.com/foundry-rs/foundry/files/13196244/RustTraceLogs.txt)\r\n\r\nNote that this is the output when run from the Ubuntu on WSL (AMD64 arch) setup. ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1783859146/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1783872391",
    "html_url": "https://github.com/foundry-rs/foundry/issues/6154#issuecomment-1783872391",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6154",
    "id": 1783872391,
    "node_id": "IC_kwDOGBlvNc5qU7uH",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-28T17:06:09Z",
    "updated_at": "2023-10-28T17:06:09Z",
    "author_association": "MEMBER",
    "body": "hmm, I believe this is a linking bug, but hard to debug/fix without a proper way to reproduce...\r\n\r\ncould you perhaps try:\r\n* updating all submodules: `git submodule update --init --recursive`\r\n* `forge clean`\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1783872391/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1783898522",
    "html_url": "https://github.com/foundry-rs/foundry/issues/6154#issuecomment-1783898522",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6154",
    "id": 1783898522,
    "node_id": "IC_kwDOGBlvNc5qVCGa",
    "user": {
      "login": "robriks",
      "id": 80549215,
      "node_id": "MDQ6VXNlcjgwNTQ5MjE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/80549215?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/robriks",
      "html_url": "https://github.com/robriks",
      "followers_url": "https://api.github.com/users/robriks/followers",
      "following_url": "https://api.github.com/users/robriks/following{/other_user}",
      "gists_url": "https://api.github.com/users/robriks/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/robriks/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/robriks/subscriptions",
      "organizations_url": "https://api.github.com/users/robriks/orgs",
      "repos_url": "https://api.github.com/users/robriks/repos",
      "events_url": "https://api.github.com/users/robriks/events{/privacy}",
      "received_events_url": "https://api.github.com/users/robriks/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-28T19:01:27Z",
    "updated_at": "2023-10-28T19:01:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "Unfortunately that did not fix the bug, still getting \"No such file or directory (os error 2)\"\r\n\r\nA linking bug would make sense as the nuking .svm file solution I found was taken from the NixOS thread below, which appears to be a similar issue though I am not using NixOS or a FHS-challenged Linux distro. The fact that I use Ubuntu VMs on both WSL and Apple M1 silicon seems similar enough, but what is confusing is that now the error is appearing on a plain jane Ubuntu AMD64 architecture desktop and vanilla MacOS on M1.\r\nhttps://github.com/foundry-rs/foundry/issues/545\r\n\r\nI piped the entire output of the `forge script` command into the file below in case the truncated output was not enough information.\r\n\r\n[RustTraceLogs.txt](https://github.com/foundry-rs/foundry/files/13196529/RustTraceLogs.txt)\r\n\r\nIf these are not enough information to properly debug, I will provide a reproducible branch for you to examine. At the moment one submodule is private so I'd just need to remove that one and delete references to it\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1783898522/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
