{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/4824",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4824/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4824/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4824/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/4824",
  "id": 1684119830,
  "node_id": "I_kwDOGBlvNc5kYaEW",
  "number": 4824,
  "title": "Forking Anvil off another Anvil omits transactions in parent",
  "user": {
    "login": "jewei1997",
    "id": 13339959,
    "node_id": "MDQ6VXNlcjEzMzM5OTU5",
    "avatar_url": "https://avatars.githubusercontent.com/u/13339959?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jewei1997",
    "html_url": "https://github.com/jewei1997",
    "followers_url": "https://api.github.com/users/jewei1997/followers",
    "following_url": "https://api.github.com/users/jewei1997/following{/other_user}",
    "gists_url": "https://api.github.com/users/jewei1997/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jewei1997/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jewei1997/subscriptions",
    "organizations_url": "https://api.github.com/users/jewei1997/orgs",
    "repos_url": "https://api.github.com/users/jewei1997/repos",
    "events_url": "https://api.github.com/users/jewei1997/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jewei1997/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-04-26T01:51:12Z",
  "updated_at": "2023-05-01T03:27:26Z",
  "closed_at": "2023-05-01T03:27:26Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nAnvil\n\n### Have you ensured that all of these are up to date?\n\n- [X] Foundry\n- [X] Foundryup\n\n### What version of Foundry are you on?\n\nforge 0.2.0 (dedc31e 2023-04-26T00:13:24.012522000Z)\n\n### What command(s) is the bug in?\n\nanvil --fork-url\n\n### Operating System\n\nmacOS (Apple Silicon)\n\n### Describe the bug\n\nHi,\r\n\r\nWhen forking an anvil instance off of another anvil instance, it seems like state changes on the parent are not reflected in the child fork.\r\n\r\nHere are some steps to replicate the issue:\r\n\r\n1. Start an anvil instance\r\n```\r\n$ anvil\r\n```\r\n\r\n2. Make a transaction on that instance.\r\n```\r\n$ cast send --from 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 --value 1ether 0x70997970C51812dc3A010C7d01b50e0d17dc79C8\r\n```\r\n\r\n3. Confirm transaction went through\r\n```\r\n$ cast balance 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\r\n9998999916000000000000\r\n```\r\n\r\n3. Create another anvil fork forking off the parent anvil. Notice how it says `Block number:   1` which is due to the transaction we just made.\r\n```\r\n$ anvil --fork-url http://127.0.0.1:8545 --port 8546\r\n```\r\n\r\n5. Do the same balance query we did before on the parent chain, on the child chain:\r\n```\r\n$ cast balance 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266 --rpc-url=http://127.0.0.1:8546\r\n10000000000000000000000 # should be 9998999916000000000000\r\n```\r\n\r\nTransaction in parent anvil does not seem to be reflected in child fork even though it the block number increment is reflected.",
  "closed_by": {
    "login": "jewei1997",
    "id": 13339959,
    "node_id": "MDQ6VXNlcjEzMzM5OTU5",
    "avatar_url": "https://avatars.githubusercontent.com/u/13339959?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jewei1997",
    "html_url": "https://github.com/jewei1997",
    "followers_url": "https://api.github.com/users/jewei1997/followers",
    "following_url": "https://api.github.com/users/jewei1997/following{/other_user}",
    "gists_url": "https://api.github.com/users/jewei1997/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jewei1997/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jewei1997/subscriptions",
    "organizations_url": "https://api.github.com/users/jewei1997/orgs",
    "repos_url": "https://api.github.com/users/jewei1997/repos",
    "events_url": "https://api.github.com/users/jewei1997/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jewei1997/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/4824/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4824/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1529306951",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4824#issuecomment-1529306951",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4824",
    "id": 1529306951,
    "node_id": "IC_kwDOGBlvNc5bJ19H",
    "user": {
      "login": "jewei1997",
      "id": 13339959,
      "node_id": "MDQ6VXNlcjEzMzM5OTU5",
      "avatar_url": "https://avatars.githubusercontent.com/u/13339959?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jewei1997",
      "html_url": "https://github.com/jewei1997",
      "followers_url": "https://api.github.com/users/jewei1997/followers",
      "following_url": "https://api.github.com/users/jewei1997/following{/other_user}",
      "gists_url": "https://api.github.com/users/jewei1997/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jewei1997/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jewei1997/subscriptions",
      "organizations_url": "https://api.github.com/users/jewei1997/orgs",
      "repos_url": "https://api.github.com/users/jewei1997/repos",
      "events_url": "https://api.github.com/users/jewei1997/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jewei1997/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-01T03:27:26Z",
    "updated_at": "2023-05-01T03:27:26Z",
    "author_association": "NONE",
    "body": "Oh, I discovered that if I fork it from the newly updated block, it actually does include the transactions in the parent",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1529306951/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
