{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2765",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2765/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2765/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2765/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/2765",
  "id": 1338227135,
  "node_id": "I_kwDOGBlvNc5Pw7m_",
  "number": 2765,
  "title": "set default blockchain for `forge-script` to Anvil",
  "user": {
    "login": "skaunov",
    "id": 65976143,
    "node_id": "MDQ6VXNlcjY1OTc2MTQz",
    "avatar_url": "https://avatars.githubusercontent.com/u/65976143?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/skaunov",
    "html_url": "https://github.com/skaunov",
    "followers_url": "https://api.github.com/users/skaunov/followers",
    "following_url": "https://api.github.com/users/skaunov/following{/other_user}",
    "gists_url": "https://api.github.com/users/skaunov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/skaunov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/skaunov/subscriptions",
    "organizations_url": "https://api.github.com/users/skaunov/orgs",
    "repos_url": "https://api.github.com/users/skaunov/repos",
    "events_url": "https://api.github.com/users/skaunov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/skaunov/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3593644820,
      "node_id": "LA_kwDOGBlvNc7WMqsU",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-feature",
      "name": "T-feature",
      "color": "BFD4F2",
      "default": false,
      "description": "Type: feature"
    },
    {
      "id": 3703752787,
      "node_id": "LA_kwDOGBlvNc7cwshT",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-forge",
      "name": "C-forge",
      "color": "5319E7",
      "default": false,
      "description": "Command: forge"
    },
    {
      "id": 4182991461,
      "node_id": "LA_kwDOGBlvNc75U2Jl",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/Cmd-forge-script",
      "name": "Cmd-forge-script",
      "color": "006B75",
      "default": false,
      "description": "Command: forge script"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2022-08-14T12:16:24Z",
  "updated_at": "2022-08-16T18:18:41Z",
  "closed_at": "2022-08-16T18:18:40Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Describe the feature you would like\r\n\r\nRunning `forge script` without indicating fork or RPC-URL it would be great if it would try to connect and operate on local Anvil testnet.\r\n\r\n### Additional context\r\n\r\nI feel like this behavior would be inline with other frameworks, and so predictable to users. And this default is harmless since local testnet is usually highly volatile, nothing could be damaged by accidentally running a script over it.\r\n\r\nAlso that would resemble `cast` behavior which plays nice with local Anvil when given no RPC-URL.",
  "closed_by": {
    "login": "gakonst",
    "id": 17802178,
    "node_id": "MDQ6VXNlcjE3ODAyMTc4",
    "avatar_url": "https://avatars.githubusercontent.com/u/17802178?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gakonst",
    "html_url": "https://github.com/gakonst",
    "followers_url": "https://api.github.com/users/gakonst/followers",
    "following_url": "https://api.github.com/users/gakonst/following{/other_user}",
    "gists_url": "https://api.github.com/users/gakonst/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gakonst/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gakonst/subscriptions",
    "organizations_url": "https://api.github.com/users/gakonst/orgs",
    "repos_url": "https://api.github.com/users/gakonst/repos",
    "events_url": "https://api.github.com/users/gakonst/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gakonst/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2765/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2765/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1215580101",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2765#issuecomment-1215580101",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2765",
    "id": 1215580101,
    "node_id": "IC_kwDOGBlvNc5IdEfF",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-15T18:26:26Z",
    "updated_at": "2022-08-15T18:26:26Z",
    "author_association": "MEMBER",
    "body": "Unsure - `forge script` with no RPC URL is essentially running on the same EVM as Anvil would do, albeit you can't setup any state prior to that. I'd argue this is actually preferable as you want your script to be self-contained and reproducible if possible, so requiring people to set up state on Anvil prior to that is usually an anti-pattern.\r\n\r\nAlways running on top of Anvil also slows down `forge script` since it has to do RPC calls even if it is not needed. What is the primary use case here?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1215580101/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1216009973",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2765#issuecomment-1216009973",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2765",
    "id": 1216009973,
    "node_id": "IC_kwDOGBlvNc5Ietb1",
    "user": {
      "login": "skaunov",
      "id": 65976143,
      "node_id": "MDQ6VXNlcjY1OTc2MTQz",
      "avatar_url": "https://avatars.githubusercontent.com/u/65976143?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/skaunov",
      "html_url": "https://github.com/skaunov",
      "followers_url": "https://api.github.com/users/skaunov/followers",
      "following_url": "https://api.github.com/users/skaunov/following{/other_user}",
      "gists_url": "https://api.github.com/users/skaunov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/skaunov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/skaunov/subscriptions",
      "organizations_url": "https://api.github.com/users/skaunov/orgs",
      "repos_url": "https://api.github.com/users/skaunov/repos",
      "events_url": "https://api.github.com/users/skaunov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/skaunov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-16T00:23:12Z",
    "updated_at": "2022-08-16T00:23:12Z",
    "author_association": "NONE",
    "body": "Totally agree. On the second thought when remember that it basically spin up it's own testnet current behavior is most reasonable. \r\n\r\nThe small thing that cause confusion is when there is running Anvil which could be modified by `cast`s, and user expect (due to points in original form) that the script will work with it. And it takes some effort to find out that `forge script` is self-contained by default.\r\n> What is the primary use case here?\r\n\r\nNot sure what would be the best here if the issue will be addressed. Is it too much to check for local Anvil running and print a warning in the beginning of `forge script` output?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1216009973/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1216396604",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2765#issuecomment-1216396604",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2765",
    "id": 1216396604,
    "node_id": "IC_kwDOGBlvNc5IgL08",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-16T09:34:00Z",
    "updated_at": "2022-08-16T09:34:00Z",
    "author_association": "MEMBER",
    "body": "Cast just defaults to connecting to any RPC running on your port 8545, it's not Anvil specific. It makes sense that it does this since most commands in Cast don't work without specifying an RPC URL, and 8545 is a safe default. For Forge it doesn't make sense to default since forking off of a node has different implications (both for performance and script/test outcomes) than running without forking.\r\n\r\nI don't think warning users that Anvil is not running upon invoking `forge script` makes sense.\r\n\r\ncc @gakonst / @mattsse for opinions here as well, I'm leaning towards closing as out of scope",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1216396604/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1216979566",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2765#issuecomment-1216979566",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2765",
    "id": 1216979566,
    "node_id": "IC_kwDOGBlvNc5IiaJu",
    "user": {
      "login": "skaunov",
      "id": 65976143,
      "node_id": "MDQ6VXNlcjY1OTc2MTQz",
      "avatar_url": "https://avatars.githubusercontent.com/u/65976143?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/skaunov",
      "html_url": "https://github.com/skaunov",
      "followers_url": "https://api.github.com/users/skaunov/followers",
      "following_url": "https://api.github.com/users/skaunov/following{/other_user}",
      "gists_url": "https://api.github.com/users/skaunov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/skaunov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/skaunov/subscriptions",
      "organizations_url": "https://api.github.com/users/skaunov/orgs",
      "repos_url": "https://api.github.com/users/skaunov/repos",
      "events_url": "https://api.github.com/users/skaunov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/skaunov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-16T18:08:40Z",
    "updated_at": "2022-08-16T18:08:40Z",
    "author_association": "NONE",
    "body": "Totally agree again.\r\n\r\nI meant warning message in reverse direction. When *there is* a testnet running on 8545, and `forge script` ran without `rpc-url` flag. That's a case when user might have forgot it.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1216979566/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1216989351",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2765#issuecomment-1216989351",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2765",
    "id": 1216989351,
    "node_id": "IC_kwDOGBlvNc5Iicin",
    "user": {
      "login": "gakonst",
      "id": 17802178,
      "node_id": "MDQ6VXNlcjE3ODAyMTc4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17802178?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gakonst",
      "html_url": "https://github.com/gakonst",
      "followers_url": "https://api.github.com/users/gakonst/followers",
      "following_url": "https://api.github.com/users/gakonst/following{/other_user}",
      "gists_url": "https://api.github.com/users/gakonst/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gakonst/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gakonst/subscriptions",
      "organizations_url": "https://api.github.com/users/gakonst/orgs",
      "repos_url": "https://api.github.com/users/gakonst/repos",
      "events_url": "https://api.github.com/users/gakonst/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gakonst/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-16T18:18:40Z",
    "updated_at": "2022-08-16T18:18:40Z",
    "author_association": "MEMBER",
    "body": "Same page as @onbjerg. I'd rather be explicit here because you might by accident broadcast some transaction you didn't intend to, e.g. if localhost points to a real node.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1216989351/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
