{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/4374",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4374/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4374/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4374/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/4374",
  "id": 1588540714,
  "node_id": "I_kwDOGBlvNc5erzUq",
  "number": 4374,
  "title": "As input to debugger, map source files to contract addresses encountered during debug session",
  "user": {
    "login": "AllTradesz",
    "id": 29447712,
    "node_id": "MDQ6VXNlcjI5NDQ3NzEy",
    "avatar_url": "https://avatars.githubusercontent.com/u/29447712?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AllTradesz",
    "html_url": "https://github.com/AllTradesz",
    "followers_url": "https://api.github.com/users/AllTradesz/followers",
    "following_url": "https://api.github.com/users/AllTradesz/following{/other_user}",
    "gists_url": "https://api.github.com/users/AllTradesz/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AllTradesz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AllTradesz/subscriptions",
    "organizations_url": "https://api.github.com/users/AllTradesz/orgs",
    "repos_url": "https://api.github.com/users/AllTradesz/repos",
    "events_url": "https://api.github.com/users/AllTradesz/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AllTradesz/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3593644820,
      "node_id": "LA_kwDOGBlvNc7WMqsU",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-feature",
      "name": "T-feature",
      "color": "BFD4F2",
      "default": false,
      "description": "Type: feature"
    },
    {
      "id": 3703752787,
      "node_id": "LA_kwDOGBlvNc7cwshT",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-forge",
      "name": "C-forge",
      "color": "5319E7",
      "default": false,
      "description": "Command: forge"
    },
    {
      "id": 3776975605,
      "node_id": "LA_kwDOGBlvNc7hIBL1",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/Cmd-forge-debug",
      "name": "Cmd-forge-debug",
      "color": "006B75",
      "default": false,
      "description": "Command: forge run"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-02-17T00:00:38Z",
  "updated_at": "2023-11-17T11:22:00Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nForge\n\n### Describe the feature you would like\n\nThe title captures it pretty much.\r\n\r\nLike when the top-level function of your `forge script` calls into an external contract you also have the source to, mappings can be checked to put the source into the source window when the execution flow enters it.\n\n### Additional context\n\nMy current case has me using a script to hit a proxied contract I've upgraded on an anvil fork of a mainnet. I upgraded the implementation on the fork and then fire the script to test a complicated scenario. It would be great if I could debug, with source highlighting, the flow from the script into the upgraded logic (implementation) contract.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/4374/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4374/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1508050925",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4374#issuecomment-1508050925",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4374",
    "id": 1508050925,
    "node_id": "IC_kwDOGBlvNc5Z4wft",
    "user": {
      "login": "AllTradesz",
      "id": 29447712,
      "node_id": "MDQ6VXNlcjI5NDQ3NzEy",
      "avatar_url": "https://avatars.githubusercontent.com/u/29447712?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AllTradesz",
      "html_url": "https://github.com/AllTradesz",
      "followers_url": "https://api.github.com/users/AllTradesz/followers",
      "following_url": "https://api.github.com/users/AllTradesz/following{/other_user}",
      "gists_url": "https://api.github.com/users/AllTradesz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AllTradesz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AllTradesz/subscriptions",
      "organizations_url": "https://api.github.com/users/AllTradesz/orgs",
      "repos_url": "https://api.github.com/users/AllTradesz/repos",
      "events_url": "https://api.github.com/users/AllTradesz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AllTradesz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-14T07:25:23Z",
    "updated_at": "2023-04-14T07:25:23Z",
    "author_association": "NONE",
    "body": "related to #3006",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1508050925/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1816196288",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4374#issuecomment-1816196288",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4374",
    "id": 1816196288,
    "node_id": "IC_kwDOGBlvNc5sQPTA",
    "user": {
      "login": "janbro",
      "id": 1494590,
      "node_id": "MDQ6VXNlcjE0OTQ1OTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1494590?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/janbro",
      "html_url": "https://github.com/janbro",
      "followers_url": "https://api.github.com/users/janbro/followers",
      "following_url": "https://api.github.com/users/janbro/following{/other_user}",
      "gists_url": "https://api.github.com/users/janbro/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/janbro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/janbro/subscriptions",
      "organizations_url": "https://api.github.com/users/janbro/orgs",
      "repos_url": "https://api.github.com/users/janbro/repos",
      "events_url": "https://api.github.com/users/janbro/events{/privacy}",
      "received_events_url": "https://api.github.com/users/janbro/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-11-17T11:21:25Z",
    "updated_at": "2023-11-17T11:22:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "I tried adding the functionality from #3006 to the test debugger and it seems like very little changes need to be made to support this, something similar in the script debugger would probably also work.\r\n\r\nSeems like the DebuggerArgs sources parameter isn't using the `get_compiled_contracts` function made in #3006.\r\nhttps://github.com/foundry-rs/foundry/blob/3e12d889fa0537ab0866b9ef6165bcf371ae03cf/crates/forge/bin/cmd/test/mod.rs#L318-L323\r\n\r\nAdding in the call to `get_compiled_contracts` and using that source output as the base for the local artifact builder seems to solve some of the issue, and I can see source maps for some Etherscan verified contracts, but it's not working consistently. Here's the commit of the changes I made to get bare minimum sources working. Someone who knows more than me might be able to tell me why it's not consistently mapping the instructions to the downloaded sources.\r\n\r\nhttps://github.com/janbro/foundry/commit/4d3a40483d49d6ca4d3585008ca9a8002ee46082#diff-289e6e32b190bdcdd1d4512466e34391afa813e748f99ed7316054a0352e7db8",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1816196288/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
