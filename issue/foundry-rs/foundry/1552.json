{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/1552",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1552/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1552/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1552/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/1552",
  "id": 1228832141,
  "node_id": "I_kwDOGBlvNc5JPn2N",
  "number": 1552,
  "title": "Expect revert not behaving as expected",
  "user": {
    "login": "FredCoen",
    "id": 43670554,
    "node_id": "MDQ6VXNlcjQzNjcwNTU0",
    "avatar_url": "https://avatars.githubusercontent.com/u/43670554?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/FredCoen",
    "html_url": "https://github.com/FredCoen",
    "followers_url": "https://api.github.com/users/FredCoen/followers",
    "following_url": "https://api.github.com/users/FredCoen/following{/other_user}",
    "gists_url": "https://api.github.com/users/FredCoen/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/FredCoen/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/FredCoen/subscriptions",
    "organizations_url": "https://api.github.com/users/FredCoen/orgs",
    "repos_url": "https://api.github.com/users/FredCoen/repos",
    "events_url": "https://api.github.com/users/FredCoen/events{/privacy}",
    "received_events_url": "https://api.github.com/users/FredCoen/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    },
    {
      "id": 3593644915,
      "node_id": "LA_kwDOGBlvNc7WMqtz",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/Cmd-forge-test",
      "name": "Cmd-forge-test",
      "color": "006B75",
      "default": false,
      "description": "Command: forge test"
    },
    {
      "id": 3703752787,
      "node_id": "LA_kwDOGBlvNc7cwshT",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-forge",
      "name": "C-forge",
      "color": "5319E7",
      "default": false,
      "description": "Command: forge"
    },
    {
      "id": 3703752960,
      "node_id": "LA_kwDOGBlvNc7cwskA",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/A-cheatcodes",
      "name": "A-cheatcodes",
      "color": "FBCA04",
      "default": false,
      "description": "Area: cheatcodes"
    },
    {
      "id": 3759719259,
      "node_id": "LA_kwDOGBlvNc7gGMNb",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/P-high",
      "name": "P-high",
      "color": "D93F0B",
      "default": false,
      "description": "Priority: high"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "onbjerg",
    "id": 8862627,
    "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/onbjerg",
    "html_url": "https://github.com/onbjerg",
    "followers_url": "https://api.github.com/users/onbjerg/followers",
    "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
    "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
    "organizations_url": "https://api.github.com/users/onbjerg/orgs",
    "repos_url": "https://api.github.com/users/onbjerg/repos",
    "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
    "received_events_url": "https://api.github.com/users/onbjerg/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 9,
  "created_at": "2022-05-08T08:57:24Z",
  "updated_at": "2023-08-25T13:16:22Z",
  "closed_at": "2022-05-11T09:17:47Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Have you ensured that all of these are up to date?\r\n\r\n- [ ] Foundry\r\n- [X] Foundryup\r\n\r\n### What version of Foundry are you on?\r\n\r\n➜   0.2.0 (a97090d 2022-05-02T00:06:08.934182+00:00)\r\n\r\n### What command(s) is the bug in?\r\n\r\nforge test --match-path src/tests/functional/\\*.sol -vvvvv --fork-url <rpc>\r\n\r\n### Operating System\r\n\r\nmacOS (M1)\r\n\r\n### Describe the bug\r\n\r\nExpect a revert with a given reason does not seem to work. The test fails for that reason anyway\r\n\r\n```\r\nvm.expectRevert('ERC721: owner query for nonexistent token');\r\nposition.ownerOf(0);\r\n```\r\n\r\nTest fails with:\r\nPosition Contract::ownerOf(0) [staticcall]\r\n    │   └─ ← \"ERC721: owner query for nonexistent token\"\r\n    └─ ← \"ERC721: owner query for nonexistent token\"\r\n    \r\nUsing a simple expectRevert without any reason fails the same way",
  "closed_by": {
    "login": "FredCoen",
    "id": 43670554,
    "node_id": "MDQ6VXNlcjQzNjcwNTU0",
    "avatar_url": "https://avatars.githubusercontent.com/u/43670554?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/FredCoen",
    "html_url": "https://github.com/FredCoen",
    "followers_url": "https://api.github.com/users/FredCoen/followers",
    "following_url": "https://api.github.com/users/FredCoen/following{/other_user}",
    "gists_url": "https://api.github.com/users/FredCoen/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/FredCoen/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/FredCoen/subscriptions",
    "organizations_url": "https://api.github.com/users/FredCoen/orgs",
    "repos_url": "https://api.github.com/users/FredCoen/repos",
    "events_url": "https://api.github.com/users/FredCoen/events{/privacy}",
    "received_events_url": "https://api.github.com/users/FredCoen/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/1552/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1552/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1120413998",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1552#issuecomment-1120413998",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1552",
    "id": 1120413998,
    "node_id": "IC_kwDOGBlvNc5CyCku",
    "user": {
      "login": "marc-aurele-besner",
      "id": 82244926,
      "node_id": "MDQ6VXNlcjgyMjQ0OTI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/82244926?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/marc-aurele-besner",
      "html_url": "https://github.com/marc-aurele-besner",
      "followers_url": "https://api.github.com/users/marc-aurele-besner/followers",
      "following_url": "https://api.github.com/users/marc-aurele-besner/following{/other_user}",
      "gists_url": "https://api.github.com/users/marc-aurele-besner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/marc-aurele-besner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/marc-aurele-besner/subscriptions",
      "organizations_url": "https://api.github.com/users/marc-aurele-besner/orgs",
      "repos_url": "https://api.github.com/users/marc-aurele-besner/repos",
      "events_url": "https://api.github.com/users/marc-aurele-besner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/marc-aurele-besner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-08T12:55:39Z",
    "updated_at": "2022-05-08T12:55:39Z",
    "author_association": "NONE",
    "body": "Hi,\r\nexpectRevert take in bytes not string\r\nso:\r\nvm.expectRevert(bytes(\"ERC721: owner query for nonexistent token\"));",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1120413998/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1120461801",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1552#issuecomment-1120461801",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1552",
    "id": 1120461801,
    "node_id": "IC_kwDOGBlvNc5CyOPp",
    "user": {
      "login": "FredCoen",
      "id": 43670554,
      "node_id": "MDQ6VXNlcjQzNjcwNTU0",
      "avatar_url": "https://avatars.githubusercontent.com/u/43670554?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/FredCoen",
      "html_url": "https://github.com/FredCoen",
      "followers_url": "https://api.github.com/users/FredCoen/followers",
      "following_url": "https://api.github.com/users/FredCoen/following{/other_user}",
      "gists_url": "https://api.github.com/users/FredCoen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/FredCoen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/FredCoen/subscriptions",
      "organizations_url": "https://api.github.com/users/FredCoen/orgs",
      "repos_url": "https://api.github.com/users/FredCoen/repos",
      "events_url": "https://api.github.com/users/FredCoen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/FredCoen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-08T18:01:18Z",
    "updated_at": "2022-05-08T18:01:18Z",
    "author_association": "NONE",
    "body": "nope same thing unfortunately, also the conversion to bytes should be implicit",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1120461801/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1120488862",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1552#issuecomment-1120488862",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1552",
    "id": 1120488862,
    "node_id": "IC_kwDOGBlvNc5CyU2e",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-08T21:20:10Z",
    "updated_at": "2022-05-08T21:20:10Z",
    "author_association": "MEMBER",
    "body": "Can you provide a minimal example?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1120488862/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1123413244",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1552#issuecomment-1123413244",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1552",
    "id": 1123413244,
    "node_id": "IC_kwDOGBlvNc5C9ez8",
    "user": {
      "login": "FredCoen",
      "id": 43670554,
      "node_id": "MDQ6VXNlcjQzNjcwNTU0",
      "avatar_url": "https://avatars.githubusercontent.com/u/43670554?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/FredCoen",
      "html_url": "https://github.com/FredCoen",
      "followers_url": "https://api.github.com/users/FredCoen/followers",
      "following_url": "https://api.github.com/users/FredCoen/following{/other_user}",
      "gists_url": "https://api.github.com/users/FredCoen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/FredCoen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/FredCoen/subscriptions",
      "organizations_url": "https://api.github.com/users/FredCoen/orgs",
      "repos_url": "https://api.github.com/users/FredCoen/repos",
      "events_url": "https://api.github.com/users/FredCoen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/FredCoen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-11T09:17:47Z",
    "updated_at": "2022-05-11T09:17:47Z",
    "author_association": "NONE",
    "body": "@onbjerg my bad error on my side forge working as expected ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1123413244/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1172769625",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1552#issuecomment-1172769625",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1552",
    "id": 1172769625,
    "node_id": "IC_kwDOGBlvNc5F5wtZ",
    "user": {
      "login": "cucupac",
      "id": 46691282,
      "node_id": "MDQ6VXNlcjQ2NjkxMjgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/46691282?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cucupac",
      "html_url": "https://github.com/cucupac",
      "followers_url": "https://api.github.com/users/cucupac/followers",
      "following_url": "https://api.github.com/users/cucupac/following{/other_user}",
      "gists_url": "https://api.github.com/users/cucupac/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cucupac/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cucupac/subscriptions",
      "organizations_url": "https://api.github.com/users/cucupac/orgs",
      "repos_url": "https://api.github.com/users/cucupac/repos",
      "events_url": "https://api.github.com/users/cucupac/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cucupac/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-01T22:51:28Z",
    "updated_at": "2022-07-01T22:51:28Z",
    "author_association": "NONE",
    "body": "@FredCoen What was the issue? I'm running into the same problem.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1172769625/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1174818046",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1552#issuecomment-1174818046",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1552",
    "id": 1174818046,
    "node_id": "IC_kwDOGBlvNc5GBkz-",
    "user": {
      "login": "FredCoen",
      "id": 43670554,
      "node_id": "MDQ6VXNlcjQzNjcwNTU0",
      "avatar_url": "https://avatars.githubusercontent.com/u/43670554?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/FredCoen",
      "html_url": "https://github.com/FredCoen",
      "followers_url": "https://api.github.com/users/FredCoen/followers",
      "following_url": "https://api.github.com/users/FredCoen/following{/other_user}",
      "gists_url": "https://api.github.com/users/FredCoen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/FredCoen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/FredCoen/subscriptions",
      "organizations_url": "https://api.github.com/users/FredCoen/orgs",
      "repos_url": "https://api.github.com/users/FredCoen/repos",
      "events_url": "https://api.github.com/users/FredCoen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/FredCoen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-05T09:11:50Z",
    "updated_at": "2022-07-05T09:11:50Z",
    "author_association": "NONE",
    "body": "logic was flawed on my side. It should work as stated above @AdamCuculich ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1174818046/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1302760779",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1552#issuecomment-1302760779",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1552",
    "id": 1302760779,
    "node_id": "IC_kwDOGBlvNc5Npo1L",
    "user": {
      "login": "haythemsellami",
      "id": 17862704,
      "node_id": "MDQ6VXNlcjE3ODYyNzA0",
      "avatar_url": "https://avatars.githubusercontent.com/u/17862704?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haythemsellami",
      "html_url": "https://github.com/haythemsellami",
      "followers_url": "https://api.github.com/users/haythemsellami/followers",
      "following_url": "https://api.github.com/users/haythemsellami/following{/other_user}",
      "gists_url": "https://api.github.com/users/haythemsellami/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haythemsellami/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haythemsellami/subscriptions",
      "organizations_url": "https://api.github.com/users/haythemsellami/orgs",
      "repos_url": "https://api.github.com/users/haythemsellami/repos",
      "events_url": "https://api.github.com/users/haythemsellami/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haythemsellami/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-03T22:43:28Z",
    "updated_at": "2022-11-03T22:43:28Z",
    "author_association": "NONE",
    "body": "Facing similar issue, what was the flawed logic on ur side @FredCoen ?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1302760779/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1659374762",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1552#issuecomment-1659374762",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1552",
    "id": 1659374762,
    "node_id": "IC_kwDOGBlvNc5i6Ayq",
    "user": {
      "login": "Rossnkama",
      "id": 22099247,
      "node_id": "MDQ6VXNlcjIyMDk5MjQ3",
      "avatar_url": "https://avatars.githubusercontent.com/u/22099247?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Rossnkama",
      "html_url": "https://github.com/Rossnkama",
      "followers_url": "https://api.github.com/users/Rossnkama/followers",
      "following_url": "https://api.github.com/users/Rossnkama/following{/other_user}",
      "gists_url": "https://api.github.com/users/Rossnkama/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Rossnkama/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Rossnkama/subscriptions",
      "organizations_url": "https://api.github.com/users/Rossnkama/orgs",
      "repos_url": "https://api.github.com/users/Rossnkama/repos",
      "events_url": "https://api.github.com/users/Rossnkama/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Rossnkama/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-01T00:12:08Z",
    "updated_at": "2023-08-01T00:14:23Z",
    "author_association": "NONE",
    "body": "@haythemsellami  The expectRevert check expects that the next TX will revert.\r\n\r\nThis will fail:\r\n```\r\nfunction testCannotAddWhenMaxUINT() public {\r\n\tvm.expectRevert(stdError.arithmeticError);\r\n\t// Fails as this next TX below doesn't revert\r\n\tbank.add(AccountType.Savings, UINT256_MAX); \r\n\tbank.add(AccountType.Savings, 1);\r\n}\r\n```\r\n\r\nThis will pass:\r\n```\r\nfunction testCannotAddWhenMaxUINT() public {\r\n\tbank.add(AccountType.Savings, UINT256_MAX);\r\n\t// Passes, we're testing the overflow prone TX under the revert check that will revert\r\n\tvm.expectRevert(stdError.arithmeticError);\r\n\tbank.add(AccountType.Savings, 1);\r\n}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1659374762/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1693347621",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1552#issuecomment-1693347621",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1552",
    "id": 1693347621,
    "node_id": "IC_kwDOGBlvNc5k7m8l",
    "user": {
      "login": "shryder",
      "id": 8571381,
      "node_id": "MDQ6VXNlcjg1NzEzODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8571381?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shryder",
      "html_url": "https://github.com/shryder",
      "followers_url": "https://api.github.com/users/shryder/followers",
      "following_url": "https://api.github.com/users/shryder/following{/other_user}",
      "gists_url": "https://api.github.com/users/shryder/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shryder/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shryder/subscriptions",
      "organizations_url": "https://api.github.com/users/shryder/orgs",
      "repos_url": "https://api.github.com/users/shryder/repos",
      "events_url": "https://api.github.com/users/shryder/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shryder/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-25T13:16:21Z",
    "updated_at": "2023-08-25T13:16:21Z",
    "author_association": "NONE",
    "body": "For anyone that runs into the same issue as I did:\r\n\r\n```\r\nvm.expectRevert(\"Total supply cannot exceed max supply\");\r\ntoken.mint(address(0x1337), token.maxSupply() - token.totalSupply() + 1);\r\n```\r\n\r\nThis will not behave as you think it should because foundry expects the (next) call to `token.maxSupply()` to revert, not `token.mint(...)`.\r\n\r\nShould separate the calls instead like this:\r\n\r\n```\r\nuint maxSupply = token.maxSupply();\r\nuint totalSupply = token.totalSupply();\r\n\r\nvm.expectRevert(\"Total supply cannot exceed max supply\");\r\ntoken.mint(address(0x1337), maxSupply - totalSupply + 1);\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1693347621/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
