{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3442",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3442/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3442/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3442/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/3442",
  "id": 1395249461,
  "node_id": "I_kwDOGBlvNc5TKdE1",
  "number": 3442,
  "title": "`The application panicked (crashed). Message:  No target contract Location: utils/src/lib.rs:146`",
  "user": {
    "login": "bstchow",
    "id": 36556453,
    "node_id": "MDQ6VXNlcjM2NTU2NDUz",
    "avatar_url": "https://avatars.githubusercontent.com/u/36556453?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bstchow",
    "html_url": "https://github.com/bstchow",
    "followers_url": "https://api.github.com/users/bstchow/followers",
    "following_url": "https://api.github.com/users/bstchow/following{/other_user}",
    "gists_url": "https://api.github.com/users/bstchow/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bstchow/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bstchow/subscriptions",
    "organizations_url": "https://api.github.com/users/bstchow/orgs",
    "repos_url": "https://api.github.com/users/bstchow/repos",
    "events_url": "https://api.github.com/users/bstchow/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bstchow/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    },
    {
      "id": 3593644915,
      "node_id": "LA_kwDOGBlvNc7WMqtz",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/Cmd-forge-test",
      "name": "Cmd-forge-test",
      "color": "006B75",
      "default": false,
      "description": "Command: forge test"
    },
    {
      "id": 3703752787,
      "node_id": "LA_kwDOGBlvNc7cwshT",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-forge",
      "name": "C-forge",
      "color": "5319E7",
      "default": false,
      "description": "Command: forge"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2022-10-03T19:58:31Z",
  "updated_at": "2022-10-11T18:14:52Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nForge\n\n### Have you ensured that all of these are up to date?\n\n- [X] Foundry\n- [x] Foundryup\n\n### What version of Foundry are you on?\n\nforge 0.2.0 (d7733ee 2022-10-03T00:08:41.50531996Z)\n\n### What command(s) is the bug in?\n\nforge test\n\n### Operating System\n\nLinux\n\n### Describe the bug\n\nRunning into the following issue when running `forge test`.\r\n\r\n```\r\nThe application panicked (crashed).\r\nMessage:  No target contract\r\nLocation: utils/src/lib.rs:146\r\n\r\nThis is a bug. Consider reporting it at https://github.com/foundry-rs/foundry\r\n\r\n  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ BACKTRACE ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\r\n   1: __libc_start_main<unknown>\r\n      at <unknown source file>:<unknown line>\r\n\r\nRun with COLORBT_SHOW_HIDDEN=1 environment variable to disable frame filtering.\r\n/home/runner/work/_temp/obfusedworkername.sh: line 1:  2819 Aborted                 (core dumped) RUST_BACKTRACE=full forge test -vvv --gas-report --force\r\nError: Process completed with exit code 134.\r\n```\r\n\r\nThis occurs when running forge test with combinations of the flags `-vvv`, `--optimize`, and `--gas-report`.\r\nThis does not occur on my local, it only occurs when running in a GitHub action context.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3442/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3442/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1265965431",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3442#issuecomment-1265965431",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3442",
    "id": 1265965431,
    "node_id": "IC_kwDOGBlvNc5LdRl3",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-03T20:03:17Z",
    "updated_at": "2022-10-03T20:03:17Z",
    "author_association": "MEMBER",
    "body": "hmm, this looks like a linking issue.\r\n\r\nlooks like you're running this from a script, could you check that the root path is correct?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1265965431/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1265971155",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3442#issuecomment-1265971155",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3442",
    "id": 1265971155,
    "node_id": "IC_kwDOGBlvNc5LdS_T",
    "user": {
      "login": "bstchow",
      "id": 36556453,
      "node_id": "MDQ6VXNlcjM2NTU2NDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/36556453?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstchow",
      "html_url": "https://github.com/bstchow",
      "followers_url": "https://api.github.com/users/bstchow/followers",
      "following_url": "https://api.github.com/users/bstchow/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstchow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstchow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstchow/subscriptions",
      "organizations_url": "https://api.github.com/users/bstchow/orgs",
      "repos_url": "https://api.github.com/users/bstchow/repos",
      "events_url": "https://api.github.com/users/bstchow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstchow/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-03T20:08:45Z",
    "updated_at": "2022-10-03T20:08:45Z",
    "author_association": "NONE",
    "body": "@mattsse Thank you for the quick response. I just double checked our path where we are running `forge test` and it seems correct (the same directory as where I run it in my local).\r\n\r\nI should also note this job was running without crashes before. The only common difference between failing jobs and successful jobs is some new Solidity contracts and Solidity Forge tests that we have added. ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1265971155/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1265994346",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3442#issuecomment-1265994346",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3442",
    "id": 1265994346,
    "node_id": "IC_kwDOGBlvNc5LdYpq",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-03T20:26:56Z",
    "updated_at": "2022-10-03T20:26:56Z",
    "author_association": "MEMBER",
    "body": "> is some new Solidity contracts\r\n\r\nthose are checked in? it works locally but not in CI?\r\n\r\nis this public?\r\n\r\nit looks like the contract depends on another contract that we don't find in the project graph.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1265994346/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1265995141",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3442#issuecomment-1265995141",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3442",
    "id": 1265995141,
    "node_id": "IC_kwDOGBlvNc5LdY2F",
    "user": {
      "login": "bstchow",
      "id": 36556453,
      "node_id": "MDQ6VXNlcjM2NTU2NDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/36556453?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstchow",
      "html_url": "https://github.com/bstchow",
      "followers_url": "https://api.github.com/users/bstchow/followers",
      "following_url": "https://api.github.com/users/bstchow/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstchow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstchow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstchow/subscriptions",
      "organizations_url": "https://api.github.com/users/bstchow/orgs",
      "repos_url": "https://api.github.com/users/bstchow/repos",
      "events_url": "https://api.github.com/users/bstchow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstchow/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-03T20:27:40Z",
    "updated_at": "2022-10-03T20:27:40Z",
    "author_association": "NONE",
    "body": "@mattsse Gotcha - I'll take a look at the contract dependencies and see if one of them is incorrectly referenced",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1265995141/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1265995815",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3442#issuecomment-1265995815",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3442",
    "id": 1265995815,
    "node_id": "IC_kwDOGBlvNc5LdZAn",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-03T20:28:19Z",
    "updated_at": "2022-10-03T20:28:19Z",
    "author_association": "MEMBER",
    "body": "also try forge tree \r\n\r\nmaybe there's something off with different versions",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1265995815/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1266038422",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3442#issuecomment-1266038422",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3442",
    "id": 1266038422,
    "node_id": "IC_kwDOGBlvNc5LdjaW",
    "user": {
      "login": "bstchow",
      "id": 36556453,
      "node_id": "MDQ6VXNlcjM2NTU2NDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/36556453?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstchow",
      "html_url": "https://github.com/bstchow",
      "followers_url": "https://api.github.com/users/bstchow/followers",
      "following_url": "https://api.github.com/users/bstchow/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstchow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstchow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstchow/subscriptions",
      "organizations_url": "https://api.github.com/users/bstchow/orgs",
      "repos_url": "https://api.github.com/users/bstchow/repos",
      "events_url": "https://api.github.com/users/bstchow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstchow/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-03T20:56:48Z",
    "updated_at": "2022-10-03T20:56:48Z",
    "author_association": "NONE",
    "body": "Hmm `forge tree` doesn't seem to be outputting any error messages",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1266038422/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1270439727",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3442#issuecomment-1270439727",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3442",
    "id": 1270439727,
    "node_id": "IC_kwDOGBlvNc5LuV8v",
    "user": {
      "login": "bstchow",
      "id": 36556453,
      "node_id": "MDQ6VXNlcjM2NTU2NDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/36556453?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bstchow",
      "html_url": "https://github.com/bstchow",
      "followers_url": "https://api.github.com/users/bstchow/followers",
      "following_url": "https://api.github.com/users/bstchow/following{/other_user}",
      "gists_url": "https://api.github.com/users/bstchow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bstchow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bstchow/subscriptions",
      "organizations_url": "https://api.github.com/users/bstchow/orgs",
      "repos_url": "https://api.github.com/users/bstchow/repos",
      "events_url": "https://api.github.com/users/bstchow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bstchow/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-06T17:24:05Z",
    "updated_at": "2022-10-06T17:24:05Z",
    "author_association": "NONE",
    "body": "@mattsse The updates you merged into main were extremely helpful.\r\n\r\nNow I am able to reproduce the issue locally (I suspect some artifact in my local foundry cache was preventing the error from occurring) and I get a helpful error message:\r\n```\r\nThe application panicked (crashed).\r\nMessage:  No target contract named FiduHelpers.json:FiduHelpers\r\nLocation: utils/src/lib.rs:151\r\n```\r\n\r\nHowever it seems like my path to FiduHelpers.json is correct where it is referenced in a separate solidity files.\r\n\r\nFiduHelpers.sol has a `pragma solidity ^0.8.16;` statement at the top of the file, and the contract that imports it also has a `pragma solidity ^0.8.16;` statement at the top of the file.\r\n\r\nI noticed Hardhat was compiling the build artifacts into two separate Solidity version named files FIduHelpers.0.8.16.json & FiduHelpers.0.8.17.json, and I guessed that Forge might be doing something similar under the hood during compilation.\r\n\r\nI also noticed the following under our solidity-files-cache.json:\r\n```\r\n    \"contracts/library/FiduHelpers.sol\": {\r\n      \"lastModificationDate\": 1665076677316,\r\n      \"contentHash\": \"f237dca93231eb55cc4012593c0eea8b\",\r\n      \"sourceName\": \"contracts/library/FiduHelpers.sol\",\r\n      \"solcConfig\": {\r\n        \"settings\": {\r\n          \"optimizer\": {\r\n            \"enabled\": true,\r\n            \"runs\": 200\r\n          },\r\n          \"metadata\": {\r\n            \"bytecodeHash\": \"ipfs\"\r\n          },\r\n          \"outputSelection\": {\r\n            \"*\": {\r\n              \"\": [\r\n                \"ast\"\r\n              ],\r\n              \"*\": [\r\n                \"abi\",\r\n                \"evm.bytecode\",\r\n                \"evm.deployedBytecode\",\r\n                \"evm.methodIdentifiers\",\r\n                \"metadata\"\r\n              ]\r\n            }\r\n          },\r\n          \"evmVersion\": \"london\",\r\n          \"libraries\": {}\r\n        }\r\n      },\r\n      \"imports\": [],\r\n      \"versionRequirement\": \"^0.8.16\",\r\n      \"artifacts\": {\r\n        \"FiduHelpers\": {\r\n          \"0.8.17+commit.8df45f5f.Darwin.appleclang\": \"FiduHelpers.sol/FiduHelpers.0.8.17.json\"\r\n        }\r\n      }\r\n    },\r\n```\r\n\r\n\r\nWhen I pin `FiduHelpers` to Solidity 0.8.16 by modifying the pragma statement in `FiduHelpers` to `pragma solidity 0.8.16;`, the error no longer occurs.\r\n\r\nI also see these changes in the solidity-files-cache.json file:\r\n```\r\n    \"contracts/library/FiduHelpers.sol\": {\r\n      \"lastModificationDate\": 1665076829358,\r\n      \"contentHash\": \"9c660b81b0dde7332e6ce49b4c49971e\",\r\n      \"sourceName\": \"contracts/library/FiduHelpers.sol\",\r\n      \"solcConfig\": {\r\n        \"settings\": {\r\n          \"optimizer\": {\r\n            \"enabled\": true,\r\n            \"runs\": 200\r\n          },\r\n          \"metadata\": {\r\n            \"bytecodeHash\": \"ipfs\"\r\n          },\r\n          \"outputSelection\": {\r\n            \"*\": {\r\n              \"\": [\r\n                \"ast\"\r\n              ],\r\n              \"*\": [\r\n                \"abi\",\r\n                \"evm.bytecode\",\r\n                \"evm.deployedBytecode\",\r\n                \"evm.methodIdentifiers\",\r\n                \"metadata\"\r\n              ]\r\n            }\r\n          },\r\n          \"evmVersion\": \"london\",\r\n          \"libraries\": {}\r\n        }\r\n      },\r\n      \"imports\": [],\r\n      \"versionRequirement\": \"=0.8.16\",\r\n      \"artifacts\": {\r\n        \"FiduHelpers\": {\r\n          \"0.8.16+commit.07a7930e.Darwin.appleclang\": \"FiduHelpers.sol/FiduHelpers.json\"\r\n        }\r\n      }\r\n    },\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1270439727/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
