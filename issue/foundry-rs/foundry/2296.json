{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2296",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2296/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2296/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2296/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/2296",
  "id": 1303236703,
  "node_id": "I_kwDOGBlvNc5NrdBf",
  "number": 2296,
  "title": "`cast send` help text incorrect and incomplete",
  "user": {
    "login": "moodysalem",
    "id": 7897876,
    "node_id": "MDQ6VXNlcjc4OTc4NzY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7897876?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/moodysalem",
    "html_url": "https://github.com/moodysalem",
    "followers_url": "https://api.github.com/users/moodysalem/followers",
    "following_url": "https://api.github.com/users/moodysalem/following{/other_user}",
    "gists_url": "https://api.github.com/users/moodysalem/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/moodysalem/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/moodysalem/subscriptions",
    "organizations_url": "https://api.github.com/users/moodysalem/orgs",
    "repos_url": "https://api.github.com/users/moodysalem/repos",
    "events_url": "https://api.github.com/users/moodysalem/events{/privacy}",
    "received_events_url": "https://api.github.com/users/moodysalem/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    },
    {
      "id": 3703752609,
      "node_id": "LA_kwDOGBlvNc7cwseh",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-cast",
      "name": "C-cast",
      "color": "5319E7",
      "default": false,
      "description": "Command: cast"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2022-07-13T10:29:20Z",
  "updated_at": "2022-08-11T19:18:49Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nCast\r\n\r\n### Have you ensured that all of these are up to date?\r\n\r\n- [X] Foundry\r\n- [X] Foundryup\r\n\r\n### What version of Foundry are you on?\r\n\r\nforge 0.2.0 (16b4ef6 2022-07-13T00:15:34.493056Z)\r\n\r\n### What command(s) is the bug in?\r\n\r\ncast send\r\n\r\n### Operating System\r\n\r\nmacOS (Apple Silicon)\r\n\r\n### Describe the bug\r\n\r\nre: https://twitter.com/msolomon44/status/1545848902674530305\r\n\r\ncast send does not actually require the etherscan api key, but the usage text made me think that it does since it's the only argument described and included in the usage example\r\n\r\n```\r\nmoody@MacBook-Pro ~> cast send\r\nerror: The following required arguments were not provided:\r\n    <TO>\r\n\r\nUSAGE:\r\n    cast send --etherscan-api-key <KEY> <TO>\r\n```",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2296/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2296/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1183552279",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2296#issuecomment-1183552279",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2296",
    "id": 1183552279,
    "node_id": "IC_kwDOGBlvNc5Gi5MX",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-13T18:37:09Z",
    "updated_at": "2022-07-13T18:37:09Z",
    "author_association": "MEMBER",
    "body": "can't reproduce this\r\n\r\n```console\r\ncast send                                                                                                                                                                                                                                  \r\nerror: The following required arguments were not provided:\r\n    <TO>\r\n\r\nUSAGE:\r\n    cast send [OPTIONS] <TO> [ARGS]\r\n\r\nFor more information try --help\r\n```\r\n\r\n```console\r\ncast --version                                                                                                                                                                                                                             \r\ncast 0.2.0 (16b4ef6 2022-07-13T00:07:21.31175Z)\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1183552279/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1183688893",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2296#issuecomment-1183688893",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2296",
    "id": 1183688893,
    "node_id": "IC_kwDOGBlvNc5Gjai9",
    "user": {
      "login": "mds1",
      "id": 17163988,
      "node_id": "MDQ6VXNlcjE3MTYzOTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mds1",
      "html_url": "https://github.com/mds1",
      "followers_url": "https://api.github.com/users/mds1/followers",
      "following_url": "https://api.github.com/users/mds1/following{/other_user}",
      "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
      "organizations_url": "https://api.github.com/users/mds1/orgs",
      "repos_url": "https://api.github.com/users/mds1/repos",
      "events_url": "https://api.github.com/users/mds1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mds1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-13T21:19:27Z",
    "updated_at": "2022-07-13T21:20:07Z",
    "author_association": "COLLABORATOR",
    "body": "Here's my output with `cast 0.2.0 (16b4ef6 2022-07-13T00:07:21.31175Z)`, which it seems is different than both of the above. \r\n\r\nI'm on an intel macOS (so no M1), in case this is somehow OS dependent (which would be surprising). I get the same output running `cast send` within a forge project and within a random directory. My best guess is this has something to do with set env vars? I have `ETH_RPC_URL` and `ETHERSCAN_API_KEY` always set in my `~/.zshrc`, and a while back I setup a keystore with dapptools, so presumably all 3 of those are being picked up and guiding the help text.\r\n\r\n```\r\n$ cast send\r\nerror: The following required arguments were not provided:\r\n    <TO>\r\n\r\nUSAGE:\r\n    cast send --rpc-url <URL> --etherscan-api-key <KEY> --keystore <PATH> <TO>\r\n\r\nFor more information try --help\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1183688893/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1184046726",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2296#issuecomment-1184046726",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2296",
    "id": 1184046726,
    "node_id": "IC_kwDOGBlvNc5Gkx6G",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-14T06:26:41Z",
    "updated_at": "2022-07-14T06:26:41Z",
    "author_association": "MEMBER",
    "body": "I get this:\r\n\r\n```\r\n$ cast send\r\nerror: The following required arguments were not provided:\r\n    <TO>\r\n\r\nUSAGE:\r\n    cast send [OPTIONS] <TO> [ARGS]\r\n\r\nFor more information try --help\r\n```\r\n\r\nOn Manjaro\r\n\r\n```\r\n$ uname -a\r\nLinux dagr 5.16.20-2-MANJARO #1 SMP PREEMPT Thu Apr 14 06:44:39 UTC 2022 x86_64 GNU/Linux\r\n```\r\n\r\nRegardless, all of this is generated by Clap, so it's not really something we have complete control over. My best guess is that we all use different terminal emulators, and maybe Clap can query dimensions for some of them and display more info when the terminal is wide, and less when it is thin?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1184046726/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1184264273",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2296#issuecomment-1184264273",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2296",
    "id": 1184264273,
    "node_id": "IC_kwDOGBlvNc5GlnBR",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-14T10:18:04Z",
    "updated_at": "2022-07-14T10:18:04Z",
    "author_association": "MEMBER",
    "body": "turns out, the clap `env` feature is responsible for this: https://docs.rs/clap/latest/clap/#optional-features\r\n\r\n> env: Turns on the usage of environment variables during parsing.\r\n\r\n```\r\nexport ETHERSCAN_API_KEY=...\r\n\r\n cast send\r\nerror: The following required arguments were not provided:\r\n    <TO>\r\n\r\nUSAGE:\r\n    cast send --etherscan-api-key <KEY> <TO>\r\n\r\nFor more information try --help\r\n\r\n```\r\n\r\nso that makes sense, but it looks like the core is is that we have a bunch of additional arguments that are not needed here @onbjerg ?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1184264273/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1185965204",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2296#issuecomment-1185965204",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2296",
    "id": 1185965204,
    "node_id": "IC_kwDOGBlvNc5GsGSU",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-15T21:37:32Z",
    "updated_at": "2022-07-15T21:37:32Z",
    "author_association": "MEMBER",
    "body": "Unsure why it's there, it isn't marked as required anywhere",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1185965204/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1212391282",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2296#issuecomment-1212391282",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2296",
    "id": 1212391282,
    "node_id": "IC_kwDOGBlvNc5IQ59y",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-11T19:18:49Z",
    "updated_at": "2022-08-11T19:18:49Z",
    "author_association": "MEMBER",
    "body": "The fix would be to write a custom args type since the one for `cast send` has a bunch of options we don't need, but the underlying behavior is in clap-rs",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1212391282/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
