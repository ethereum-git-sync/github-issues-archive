{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/1179",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1179/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1179/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1179/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/1179",
  "id": 1190982208,
  "node_id": "I_kwDOGBlvNc5G_PJA",
  "number": 1179,
  "title": "When adding remappings.txt, forge build throws an error",
  "user": {
    "login": "Saw-mon-and-Natalie",
    "id": 3140080,
    "node_id": "MDQ6VXNlcjMxNDAwODA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3140080?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Saw-mon-and-Natalie",
    "html_url": "https://github.com/Saw-mon-and-Natalie",
    "followers_url": "https://api.github.com/users/Saw-mon-and-Natalie/followers",
    "following_url": "https://api.github.com/users/Saw-mon-and-Natalie/following{/other_user}",
    "gists_url": "https://api.github.com/users/Saw-mon-and-Natalie/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Saw-mon-and-Natalie/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Saw-mon-and-Natalie/subscriptions",
    "organizations_url": "https://api.github.com/users/Saw-mon-and-Natalie/orgs",
    "repos_url": "https://api.github.com/users/Saw-mon-and-Natalie/repos",
    "events_url": "https://api.github.com/users/Saw-mon-and-Natalie/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Saw-mon-and-Natalie/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2022-04-03T16:45:41Z",
  "updated_at": "2022-04-04T09:44:04Z",
  "closed_at": "2022-04-04T09:43:21Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nForge\n\n### Have you ensured that all of these are up to date?\n\n- [X] Foundry\n- [ ] Foundryup\n\n### What version of Foundry are you on?\n\nforge 0.2.0 (3480a8d 2022-04-03T11:39:36.163735900+00:00)\n\n### What command(s) is the bug in?\n\nforge build\n\n### Operating System\n\nWindows\n\n### Describe the bug\n\nAfter running \r\n\r\n```sh\r\nforge init hello\r\ncd hello\r\nforge remappings > remappings.txt\r\n```\r\n\r\n, `forge build` throws the following error (`\"stream did not contain valid UTF-8\"`):\r\n\r\n```sh\r\nThe application panicked (crashed).\r\nMessage:  failed to extract from provider: Error { tag: Tag(Default, 7), profile: Some(Profile(Uncased { string: \"default\" })), metadata: Some(Metadata { name: \"Remapping Provider\", source: None, provide_location: Some(Location { file: \"config\\\\src\\\\lib.rs\", line: 808, col: 29 }), interpolater:  }), path: [], kind: Message(\"stream did not contain valid UTF-8\"), prev: None }\r\nLocation: config\\src\\lib.rs:286\r\n\r\n  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ BACKTRACE ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\r\n   1: hid_write<unknown>\r\n      at <unknown source file>:<unknown line>\r\n   2: hid_write<unknown>\r\n      at <unknown source file>:<unknown line>\r\n   3: hid_write<unknown>\r\n      at <unknown source file>:<unknown line>\r\n   4: BaseThreadInitThunk<unknown>\r\n      at <unknown source file>:<unknown line>\r\n   5: RtlUserThreadStart<unknown>\r\n      at <unknown source file>:<unknown line>\r\n```\r\n\r\nIf I delete the `remappings.txt` the error goes away and the contract compiles.\r\n\r\n`remappings.txt` file:\r\n\r\n```hex\r\n  Offset: 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F \t\r\n00000000: FF FE 64 00 73 00 2D 00 74 00 65 00 73 00 74 00    .~d.s.-.t.e.s.t.\r\n00000010: 2F 00 3D 00 6C 00 69 00 62 00 5C 00 64 00 73 00    /.=.l.i.b.\\.d.s.\r\n00000020: 2D 00 74 00 65 00 73 00 74 00 5C 00 73 00 72 00    -.t.e.s.t.\\.s.r.\r\n00000030: 63 00 2F 00 0D 00 0A 00                            c./.....\r\n\r\n```",
  "closed_by": {
    "login": "mattsse",
    "id": 19890894,
    "node_id": "MDQ6VXNlcjE5ODkwODk0",
    "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mattsse",
    "html_url": "https://github.com/mattsse",
    "followers_url": "https://api.github.com/users/mattsse/followers",
    "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
    "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
    "organizations_url": "https://api.github.com/users/mattsse/orgs",
    "repos_url": "https://api.github.com/users/mattsse/repos",
    "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mattsse/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/1179/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1179/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1086931662",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1179#issuecomment-1086931662",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1179",
    "id": 1086931662,
    "node_id": "IC_kwDOGBlvNc5AyULO",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-03T19:19:59Z",
    "updated_at": "2022-04-03T19:19:59Z",
    "author_association": "MEMBER",
    "body": "it appears your path is not utf8 conform, which is a windows thing..\r\ntry deleting the line and replacing it with\r\n`ds-test/=lib/ds-test/src/`",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1086931662/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1087316106",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1179#issuecomment-1087316106",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1179",
    "id": 1087316106,
    "node_id": "IC_kwDOGBlvNc5AzyCK",
    "user": {
      "login": "Saw-mon-and-Natalie",
      "id": 3140080,
      "node_id": "MDQ6VXNlcjMxNDAwODA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3140080?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Saw-mon-and-Natalie",
      "html_url": "https://github.com/Saw-mon-and-Natalie",
      "followers_url": "https://api.github.com/users/Saw-mon-and-Natalie/followers",
      "following_url": "https://api.github.com/users/Saw-mon-and-Natalie/following{/other_user}",
      "gists_url": "https://api.github.com/users/Saw-mon-and-Natalie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Saw-mon-and-Natalie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Saw-mon-and-Natalie/subscriptions",
      "organizations_url": "https://api.github.com/users/Saw-mon-and-Natalie/orgs",
      "repos_url": "https://api.github.com/users/Saw-mon-and-Natalie/repos",
      "events_url": "https://api.github.com/users/Saw-mon-and-Natalie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Saw-mon-and-Natalie/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-04T09:19:31Z",
    "updated_at": "2022-04-04T09:25:26Z",
    "author_association": "NONE",
    "body": "changing it to `ds-test/=lib/ds-test/src/`\r\n\r\n```\r\n  Offset: 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F \t\r\n00000000: FF FE 64 00 73 00 2D 00 74 00 65 00 73 00 74 00    .~d.s.-.t.e.s.t.\r\n00000010: 2F 00 3D 00 6C 00 69 00 62 00 2F 00 64 00 73 00    /.=.l.i.b./.d.s.\r\n00000020: 2D 00 74 00 65 00 73 00 74 00 2F 00 73 00 72 00    -.t.e.s.t./.s.r.\r\n00000030: 63 00 2F 00 0D 00 0A 00                            c./.....\r\n```\r\n\r\nproduces the same error.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1087316106/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1087336765",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1179#issuecomment-1087336765",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1179",
    "id": 1087336765,
    "node_id": "IC_kwDOGBlvNc5Az3E9",
    "user": {
      "login": "Saw-mon-and-Natalie",
      "id": 3140080,
      "node_id": "MDQ6VXNlcjMxNDAwODA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3140080?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Saw-mon-and-Natalie",
      "html_url": "https://github.com/Saw-mon-and-Natalie",
      "followers_url": "https://api.github.com/users/Saw-mon-and-Natalie/followers",
      "following_url": "https://api.github.com/users/Saw-mon-and-Natalie/following{/other_user}",
      "gists_url": "https://api.github.com/users/Saw-mon-and-Natalie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Saw-mon-and-Natalie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Saw-mon-and-Natalie/subscriptions",
      "organizations_url": "https://api.github.com/users/Saw-mon-and-Natalie/orgs",
      "repos_url": "https://api.github.com/users/Saw-mon-and-Natalie/repos",
      "events_url": "https://api.github.com/users/Saw-mon-and-Natalie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Saw-mon-and-Natalie/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-04T09:40:26Z",
    "updated_at": "2022-04-04T09:40:26Z",
    "author_association": "NONE",
    "body": "If I don't use the `forge remappings > remappings.txt` command and create the file manually and put in `ds-test/=lib/ds-test/src/`\r\n\r\nThe hex dump of the file becomes:\r\n\r\n```\r\n  Offset: 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F \t\r\n00000000: 64 73 2D 74 65 73 74 2F 3D 6C 69 62 2F 64 73 2D    ds-test/=lib/ds-\r\n00000010: 74 65 73 74 2F 73 72 63 2F 0D 0A                   test/src/..\r\n```\r\n\r\nand `forge build` runs successfully.\r\n\r\n```sh\r\nfile remappings.txt\r\nremappings.txt: ASCII text, with CRLF line terminators\r\n```\r\n\r\nWhere as before when creating the `remappings.txt` using `forge remappings > remappings.txt` on `powershell`, I would get:\r\n\r\n```sh\r\nfile remappings.txt\r\nremappings.txt: Unicode text, UTF-16, little-endian text, with CRLF line terminators\r\n```\r\n\r\nIf I run the same command on `Git Bash` , `forge remappings > remappings.txt`, I would get\r\n\r\n```sh\r\nfile remappings.txt\r\nremappings.txt: ASCII text\r\n```\r\n\r\nand `forge build` runs successfully.\r\n\r\nI guess the problem is with `powershell` using `utf-16` encoding for the file. The question is should `forge` support `utf-16` encoding?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1087336765/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1087339073",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1179#issuecomment-1087339073",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1179",
    "id": 1087339073,
    "node_id": "IC_kwDOGBlvNc5Az3pB",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-04T09:43:01Z",
    "updated_at": "2022-04-04T09:43:01Z",
    "author_association": "MEMBER",
    "body": "was just about to write that,\r\njust noticed all the null bytes.\r\n\r\nrust strings are utf8\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1087339073/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1087340034",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1179#issuecomment-1087340034",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1179",
    "id": 1087340034,
    "node_id": "IC_kwDOGBlvNc5Az34C",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-04T09:44:04Z",
    "updated_at": "2022-04-04T09:44:04Z",
    "author_association": "MEMBER",
    "body": "not a windows expert but interesting that powershell, pipes content as utf-16",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1087340034/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
