{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3265",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3265/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3265/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3265/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/3265",
  "id": 1377301617,
  "node_id": "I_kwDOGBlvNc5SF_Rx",
  "number": 3265,
  "title": "`forge flatten` with renamed interface import does not compile",
  "user": {
    "login": "chad-js",
    "id": 22300733,
    "node_id": "MDQ6VXNlcjIyMzAwNzMz",
    "avatar_url": "https://avatars.githubusercontent.com/u/22300733?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chad-js",
    "html_url": "https://github.com/chad-js",
    "followers_url": "https://api.github.com/users/chad-js/followers",
    "following_url": "https://api.github.com/users/chad-js/following{/other_user}",
    "gists_url": "https://api.github.com/users/chad-js/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chad-js/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chad-js/subscriptions",
    "organizations_url": "https://api.github.com/users/chad-js/orgs",
    "repos_url": "https://api.github.com/users/chad-js/repos",
    "events_url": "https://api.github.com/users/chad-js/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chad-js/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    },
    {
      "id": 3703752787,
      "node_id": "LA_kwDOGBlvNc7cwshT",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-forge",
      "name": "C-forge",
      "color": "5319E7",
      "default": false,
      "description": "Command: forge"
    },
    {
      "id": 4385331440,
      "node_id": "LA_kwDOGBlvNc8AAAABBWLY8A",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/Cmd-forge-flatten",
      "name": "Cmd-forge-flatten",
      "color": "006B75",
      "default": false,
      "description": "Command: forge flatten"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "rkrasiuk",
    "id": 25429261,
    "node_id": "MDQ6VXNlcjI1NDI5MjYx",
    "avatar_url": "https://avatars.githubusercontent.com/u/25429261?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rkrasiuk",
    "html_url": "https://github.com/rkrasiuk",
    "followers_url": "https://api.github.com/users/rkrasiuk/followers",
    "following_url": "https://api.github.com/users/rkrasiuk/following{/other_user}",
    "gists_url": "https://api.github.com/users/rkrasiuk/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rkrasiuk/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rkrasiuk/subscriptions",
    "organizations_url": "https://api.github.com/users/rkrasiuk/orgs",
    "repos_url": "https://api.github.com/users/rkrasiuk/repos",
    "events_url": "https://api.github.com/users/rkrasiuk/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rkrasiuk/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "rkrasiuk",
      "id": 25429261,
      "node_id": "MDQ6VXNlcjI1NDI5MjYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25429261?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rkrasiuk",
      "html_url": "https://github.com/rkrasiuk",
      "followers_url": "https://api.github.com/users/rkrasiuk/followers",
      "following_url": "https://api.github.com/users/rkrasiuk/following{/other_user}",
      "gists_url": "https://api.github.com/users/rkrasiuk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rkrasiuk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rkrasiuk/subscriptions",
      "organizations_url": "https://api.github.com/users/rkrasiuk/orgs",
      "repos_url": "https://api.github.com/users/rkrasiuk/repos",
      "events_url": "https://api.github.com/users/rkrasiuk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rkrasiuk/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-09-19T02:26:52Z",
  "updated_at": "2022-10-05T15:24:19Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Component\n\nForge\n\n### Have you ensured that all of these are up to date?\n\n- [X] Foundry\n- [X] Foundryup\n\n### What version of Foundry are you on?\n\nforge 0.2.0 (084ef3d 2022-09-19T00:04:35.98318Z)\n\n### What command(s) is the bug in?\n\nforge flatten\n\n### Operating System\n\nmacOS (Apple Silicon)\n\n### Describe the bug\n\nIf I have a contract using a named import of an interface, such as \r\n```solidity\r\nimport { IERC20 as MyIERC20 } from \"src/interfaces/IERC20.sol\";\r\n```\r\n\r\n`forge flatten` on that file results in output that includes the IERC20 interface, and the contract using the named import. Since the contract uses the named import `MyIERC20`, and the flattened file includes `interface IERC20` but not `interface MyIERC20`, `forge build` fails with `DeclarationError: Identifier not found or not unique.`\r\n\r\nThis seems related to https://github.com/foundry-rs/foundry/issues/1440",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3265/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3265/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1252664579",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3265#issuecomment-1252664579",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3265",
    "id": 1252664579,
    "node_id": "IC_kwDOGBlvNc5KqiUD",
    "user": {
      "login": "adhusson",
      "id": 2977,
      "node_id": "MDQ6VXNlcjI5Nzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2977?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/adhusson",
      "html_url": "https://github.com/adhusson",
      "followers_url": "https://api.github.com/users/adhusson/followers",
      "following_url": "https://api.github.com/users/adhusson/following{/other_user}",
      "gists_url": "https://api.github.com/users/adhusson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/adhusson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adhusson/subscriptions",
      "organizations_url": "https://api.github.com/users/adhusson/orgs",
      "repos_url": "https://api.github.com/users/adhusson/repos",
      "events_url": "https://api.github.com/users/adhusson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/adhusson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-20T17:19:43Z",
    "updated_at": "2022-09-20T17:19:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "Also related to #2545 (maybe the same?).",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1252664579/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1265016046",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3265#issuecomment-1265016046",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3265",
    "id": 1265016046,
    "node_id": "IC_kwDOGBlvNc5LZpzu",
    "user": {
      "login": "rkrasiuk",
      "id": 25429261,
      "node_id": "MDQ6VXNlcjI1NDI5MjYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25429261?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rkrasiuk",
      "html_url": "https://github.com/rkrasiuk",
      "followers_url": "https://api.github.com/users/rkrasiuk/followers",
      "following_url": "https://api.github.com/users/rkrasiuk/following{/other_user}",
      "gists_url": "https://api.github.com/users/rkrasiuk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rkrasiuk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rkrasiuk/subscriptions",
      "organizations_url": "https://api.github.com/users/rkrasiuk/orgs",
      "repos_url": "https://api.github.com/users/rkrasiuk/repos",
      "events_url": "https://api.github.com/users/rkrasiuk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rkrasiuk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-03T07:02:07Z",
    "updated_at": "2022-10-03T07:08:10Z",
    "author_association": "COLLABORATOR",
    "body": "@chad-js sorry for delay on this. the issue is a little bit different than the above, however, the underlying problem is also non-trivial.\r\nin your opinion, what would be the expected behavior if the same source unit is aliased differently across source files\r\ni.e.\r\n```solidity\r\n// file1.sol\r\nimport { IERC20 } from \"src/interfaces/IERC20.sol\";\r\n\r\n// file2.sol\r\nimport { IERC20 as MyIERC20 } from \"src/interfaces/IERC20.sol\";\r\n\r\n// file3.sol\r\nimport { IERC20 as CustomIERC20 } from \"src/interfaces/IERC20.sol\";\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1265016046/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1268593570",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3265#issuecomment-1268593570",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3265",
    "id": 1268593570,
    "node_id": "IC_kwDOGBlvNc5LnTOi",
    "user": {
      "login": "mds1",
      "id": 17163988,
      "node_id": "MDQ6VXNlcjE3MTYzOTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mds1",
      "html_url": "https://github.com/mds1",
      "followers_url": "https://api.github.com/users/mds1/followers",
      "following_url": "https://api.github.com/users/mds1/following{/other_user}",
      "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
      "organizations_url": "https://api.github.com/users/mds1/orgs",
      "repos_url": "https://api.github.com/users/mds1/repos",
      "events_url": "https://api.github.com/users/mds1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mds1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-05T15:24:19Z",
    "updated_at": "2022-10-05T15:24:19Z",
    "author_association": "COLLABORATOR",
    "body": "@rkrasiuk in your above example, can you just drop the renames and then everything is the same IERC20?\r\n\r\nBut if the IERC20's are from different file paths, it gets more complex. In that case I think we can include the renamed interfaces in the flattened file, such as:\r\n- `interface IERC20 { /* snip */ }` is left unchanged\r\n- `interface MyERC20 { /*snip */}` holds the code that was in it's imported `IERC20` interface\r\n- `interface CustomIERC20 { /*snip */}` holds the code that was in that imported `IERC20` interface\r\n\r\nPerhaps I am misunderstanding the complications though?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1268593570/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
