{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/4865",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4865/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4865/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4865/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/4865",
  "id": 1692464373,
  "node_id": "I_kwDOGBlvNc5k4PT1",
  "number": 4865,
  "title": "Failed to deserialize response: expected value at line 1 column 1",
  "user": {
    "login": "mpeyfuss",
    "id": 82735893,
    "node_id": "MDQ6VXNlcjgyNzM1ODkz",
    "avatar_url": "https://avatars.githubusercontent.com/u/82735893?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mpeyfuss",
    "html_url": "https://github.com/mpeyfuss",
    "followers_url": "https://api.github.com/users/mpeyfuss/followers",
    "following_url": "https://api.github.com/users/mpeyfuss/following{/other_user}",
    "gists_url": "https://api.github.com/users/mpeyfuss/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mpeyfuss/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mpeyfuss/subscriptions",
    "organizations_url": "https://api.github.com/users/mpeyfuss/orgs",
    "repos_url": "https://api.github.com/users/mpeyfuss/repos",
    "events_url": "https://api.github.com/users/mpeyfuss/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mpeyfuss/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-05-02T13:49:33Z",
  "updated_at": "2023-06-06T02:56:44Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nForge\n\n### Have you ensured that all of these are up to date?\n\n- [X] Foundry\n- [X] Foundryup\n\n### What version of Foundry are you on?\n\nforge 0.2.0 (8307d6d 2023-04-20T00:05:51.425008000Z)\n\n### What command(s) is the bug in?\n\nforge verify-contract\n\n### Operating System\n\nLinux\n\n### Describe the bug\n\nI am running forge in an AWS EC2 instance and on verification keep getting a 403 error from Etherscan which results in the `Failed to deserialize response: expected value at line 1 column 1` error as it returns html with a captcha rather than json. \r\n\r\nI've reached out to Etherscan and this was their response:\r\n\r\n> We are aware of our CloudFlare protections being particularly sensitive to unknown automated scripts, and returning 403 responses as a result. \r\n> We're looking into whitelisting this at the moment, however a quick workaround for this would be to make your request more identifiable by attaching a User Agent string\r\n\r\nMy understanding is that reqwest doesn't set a default User-Agent header and so CloudFlare decides to block my request.\r\n\r\nDoes anyone know of a way to add a User-Agent header to outgoing requests on forge?\r\n\r\nThis seems like it currently affects just a small subset of users, although it would future proof everyone if a default user agent was set by forge/foundry. For example, curl automatically applies a default user agent so it would make sense for forge/foundry to do the same.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/4865/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4865/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1531711347",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4865#issuecomment-1531711347",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4865",
    "id": 1531711347,
    "node_id": "IC_kwDOGBlvNc5bTA9z",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-02T15:50:03Z",
    "updated_at": "2023-05-02T15:50:03Z",
    "author_association": "MEMBER",
    "body": "> Does anyone know of a way to add a User-Agent header to outgoing requests on forge?\r\n\r\nwe already set this\r\n\r\nhttps://github.com/foundry-rs/foundry/blob/e15e33a07c0920189fc336391f538c3dad53da73/config/src/etherscan.rs#L276-L277\r\n\r\nwe check for various cloudflare errors, but this one we're missing apparently, do you know what kind of error is returned?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1531711347/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1531845261",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4865#issuecomment-1531845261",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4865",
    "id": 1531845261,
    "node_id": "IC_kwDOGBlvNc5bThqN",
    "user": {
      "login": "mpeyfuss",
      "id": 82735893,
      "node_id": "MDQ6VXNlcjgyNzM1ODkz",
      "avatar_url": "https://avatars.githubusercontent.com/u/82735893?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mpeyfuss",
      "html_url": "https://github.com/mpeyfuss",
      "followers_url": "https://api.github.com/users/mpeyfuss/followers",
      "following_url": "https://api.github.com/users/mpeyfuss/following{/other_user}",
      "gists_url": "https://api.github.com/users/mpeyfuss/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mpeyfuss/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mpeyfuss/subscriptions",
      "organizations_url": "https://api.github.com/users/mpeyfuss/orgs",
      "repos_url": "https://api.github.com/users/mpeyfuss/repos",
      "events_url": "https://api.github.com/users/mpeyfuss/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mpeyfuss/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-02T17:12:10Z",
    "updated_at": "2023-05-02T17:15:15Z",
    "author_association": "NONE",
    "body": "ah thanks for pointing me to that. I was on an older build but just now built again from source on the EC2. about to test\r\n\r\nNot 100% sure the kind of error returned as it doesn't seem like a regular 403 error. But here is the html body that foundry couldn't deserialize. \r\n```\r\n<!DOCTYPE html>\r\n<html lang=\"en-US\">\r\n<head>\r\n    <title>Just a moment...</title>\r\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\r\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=Edge\">\r\n    <meta name=\"robots\" content=\"noindex,nofollow\">\r\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1\">\r\n    <link href=\"/cdn-cgi/styles/challenges.css\" rel=\"stylesheet\">\r\n    \r\n\r\n</head>\r\n<body class=\"no-js\">\r\n    <div class=\"main-wrapper\" role=\"main\">\r\n    <div class=\"main-content\">\r\n        <noscript>\r\n            <div id=\"challenge-error-title\">\r\n                <div class=\"h2\">\r\n                    <span class=\"icon-wrapper\">\r\n                        <div class=\"heading-icon warning-icon\"></div>\r\n                    </span>\r\n                    <span id=\"challenge-error-text\">\r\n                        Enable JavaScript and cookies to continue\r\n                    </span>\r\n                </div>\r\n            </div>\r\n        </noscript>\r\n        <div id=\"trk_jschal_js\" style=\"display:none;background-image:url('/cdn-cgi/images/trace/captcha/nojs/transparent.gif?ray=7c08c85288277fb7')\"></div>\r\n        <form id=\"challenge-form\" action=\"/api/?__cf_chl_f_tk=Q7F3hkX.VOk8KSj37RUZQAEw34ohIhGvc9K2pEp9d2c-1682952056-0-gaNycGzNMDs\" method=\"POST\" enctype=\"application/x-www-form-urlencoded\">\r\n            <input type=\"hidden\" name=\"md\" value=\"REAALLYY LONG VALUE OMITTED HERE\">\r\n        </form>\r\n    </div>\r\n</div>\r\n<script>\r\n    (function(){\r\n        window._cf_chl_opt={\r\n            cvId: '2',\r\n            cZone: 'api-goerli.etherscan.io',\r\n            cType: 'interactive',\r\n            cNounce: '11195',\r\n            cRay: '7c08c85288277fb7',\r\n            cHash: '98433f73c9870d8',\r\n            cUPMDTk: \"\\\\/api\\\\/?__cf_chl_tk=Q7F3hkX.VOk8KSj37RUZQAEw34ohIhGvc9K2pEp9d2c-1682952056-0-gaNycGzNMDs\",\r\n            cFPWv: 'g',\r\n            cTTimeMs: '1000',\r\n            cMTimeMs: '0',\r\n            cTplV: 5,\r\n            cTplB: 'cf',\r\n            cK: \"\",\r\n            cRq: {\r\n                ru: 'aHR0cHM6Ly9hcGktZ29lcmxpLmV0aGVyc2Nhbi5pby9hcGkv',\r\n                ra: 'Tk9fVUE=',\r\n                rm: 'UE9TVA==',\r\n                d: 'HyOwClHdzKb0QWhXxeflQnZhLi9iZ7fHD9C+JBVClbvYfmbSMr0eTICiMY/XSloNj3BuVgnWI+iu9KVE7ISpl/t5XVS9v+jUUDQib5iMmaaTHcfWA/+cod0Jr95xHjnrv35LHfPkoZPgjKL2zuAlSahaeIRqYat5vw+1SQ9hoApJoTqZ77JRRqrrFodhQdFYRQPT2pl5PrbMb6YrksC26y6IDqUF/3pkVm+A0Qfs0u4Qaxltqm2RvbO7Ibx0MoYHxZyeZhTEa52lwtRNoDvN3vqJWYHlA3A0x8cOQ2YPE1YiuGtF/fjrqTSw9GOXasLgU0UTZXp2xY674bry0b/Cirzb3ElR612wVlOvyo7cfwsljp1lZf5I6OmhQXw/3lTG8lfcsyTYRk7Cvs0vigejlt6VsQXhYhgpXf0OwpPNIsEyjNg4X+7F6AA6zqPwfcSpHIdvmkOc6G+7rH49Ag2L0g9wWGpVGTmWvW9s+Zb/eDogqy3pJrkIVnHBi73V6r7BKMl/LgJoIqolCUlg0DoqdZRIju9ijDlPQYYaYKycLVT033HyzJdDWrJDGKwokRkGIwbZ7+P/eqDpXoUBrr3YzcKfUL5P6aMKrPg66gYrr99etaJ+xnoZ/GmS2/NjqwFZ',\r\n                t: 'MTY4Mjk1MjA1Ni43MjkwMDA=',\r\n                m: '43Q+P85nrusAlMAenGBEOgWlw5AZs3ny6hjIRkI0ew0=',\r\n                i1: 'LNiT0NzLFeZ2oBCfHihVjQ==',\r\n                i2: 'asxnmYxvJS85O7q/1ITnUQ==',\r\n                zh: 'qb4aFuGlbJn/rUOkKXjUqElKDKE10jDqu5PE014OTwk=',\r\n                uh: 'DV4j3Tmrbi5Rs1q3ahwVS6SgbPbI7np5884QO1u1Cgg=',\r\n                hh: 'Ax949TKiHbaXasTISC7ryL1/i3VsF1So3LziNEbpSQM=',\r\n            }\r\n        };\r\n        var trkjs = document.createElement('img');\r\n        trkjs.setAttribute('src', '/cdn-cgi/images/trace/captcha/js/transparent.gif?ray=7c08c85288277fb7');\r\n        trkjs.setAttribute('alt', '');\r\n        trkjs.setAttribute('style', 'display: none');\r\n        document.body.appendChild(trkjs);\r\n        var cpo = document.createElement('script');\r\n        cpo.src = '/cdn-cgi/challenge-platform/h/g/orchestrate/captcha/v1?ray=7c08c85288277fb7';\r\n        window._cf_chl_opt.cOgUHash = location.hash === '' && location.href.indexOf('#') !== -1 ? '#' : location.hash;\r\n        window._cf_chl_opt.cOgUQuery = location.search === '' && location.href.slice(0, location.href.length - window._cf_chl_opt.cOgUHash.length).indexOf('?') !== -1 ? '?' : location.search;\r\n        if (window.history && window.history.replaceState) {\r\n            var ogU = location.pathname + window._cf_chl_opt.cOgUQuery + window._cf_chl_opt.cOgUHash;\r\n            history.replaceState(null, null, \"\\\\/api\\\\/?__cf_chl_rt_tk=Q7F3hkX.VOk8KSj37RUZQAEw34ohIhGvc9K2pEp9d2c-1682952056-0-gaNycGzNMDs\" + window._cf_chl_opt.cOgUHash);\r\n            cpo.onload = function() {\r\n                history.replaceState(null, null, ogU);\r\n            };\r\n        }\r\n        document.getElementsByTagName('head')[0].appendChild(cpo);\r\n    }());\r\n</script>\r\n\r\n\r\n</body>\r\n\r\n</html>\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1531845261/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1531863075",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4865#issuecomment-1531863075",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4865",
    "id": 1531863075,
    "node_id": "IC_kwDOGBlvNc5bTmAj",
    "user": {
      "login": "mpeyfuss",
      "id": 82735893,
      "node_id": "MDQ6VXNlcjgyNzM1ODkz",
      "avatar_url": "https://avatars.githubusercontent.com/u/82735893?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mpeyfuss",
      "html_url": "https://github.com/mpeyfuss",
      "followers_url": "https://api.github.com/users/mpeyfuss/followers",
      "following_url": "https://api.github.com/users/mpeyfuss/following{/other_user}",
      "gists_url": "https://api.github.com/users/mpeyfuss/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mpeyfuss/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mpeyfuss/subscriptions",
      "organizations_url": "https://api.github.com/users/mpeyfuss/orgs",
      "repos_url": "https://api.github.com/users/mpeyfuss/repos",
      "events_url": "https://api.github.com/users/mpeyfuss/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mpeyfuss/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-02T17:24:48Z",
    "updated_at": "2023-05-02T17:24:48Z",
    "author_association": "NONE",
    "body": "Ah, unfortunately still getting the same response even with the latest build.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1531863075/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1577820536",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4865#issuecomment-1577820536",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4865",
    "id": 1577820536,
    "node_id": "IC_kwDOGBlvNc5eC6F4",
    "user": {
      "login": "Pythonberg1997",
      "id": 48975233,
      "node_id": "MDQ6VXNlcjQ4OTc1MjMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/48975233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Pythonberg1997",
      "html_url": "https://github.com/Pythonberg1997",
      "followers_url": "https://api.github.com/users/Pythonberg1997/followers",
      "following_url": "https://api.github.com/users/Pythonberg1997/following{/other_user}",
      "gists_url": "https://api.github.com/users/Pythonberg1997/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Pythonberg1997/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Pythonberg1997/subscriptions",
      "organizations_url": "https://api.github.com/users/Pythonberg1997/orgs",
      "repos_url": "https://api.github.com/users/Pythonberg1997/repos",
      "events_url": "https://api.github.com/users/Pythonberg1997/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Pythonberg1997/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-06T02:56:44Z",
    "updated_at": "2023-06-06T02:56:44Z",
    "author_association": "NONE",
    "body": "Same issue",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1577820536/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
