{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2800",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2800/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2800/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2800/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/2800",
  "id": 1340516101,
  "node_id": "I_kwDOGBlvNc5P5qcF",
  "number": 2800,
  "title": "Document how to test upgradeable smart contracts",
  "user": {
    "login": "grp06",
    "id": 1573959,
    "node_id": "MDQ6VXNlcjE1NzM5NTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1573959?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/grp06",
    "html_url": "https://github.com/grp06",
    "followers_url": "https://api.github.com/users/grp06/followers",
    "following_url": "https://api.github.com/users/grp06/following{/other_user}",
    "gists_url": "https://api.github.com/users/grp06/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/grp06/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/grp06/subscriptions",
    "organizations_url": "https://api.github.com/users/grp06/orgs",
    "repos_url": "https://api.github.com/users/grp06/repos",
    "events_url": "https://api.github.com/users/grp06/events{/privacy}",
    "received_events_url": "https://api.github.com/users/grp06/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3593644820,
      "node_id": "LA_kwDOGBlvNc7WMqsU",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-feature",
      "name": "T-feature",
      "color": "BFD4F2",
      "default": false,
      "description": "Type: feature"
    },
    {
      "id": 3593644915,
      "node_id": "LA_kwDOGBlvNc7WMqtz",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/Cmd-forge-test",
      "name": "Cmd-forge-test",
      "color": "006B75",
      "default": false,
      "description": "Command: forge test"
    },
    {
      "id": 3703752787,
      "node_id": "LA_kwDOGBlvNc7cwshT",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-forge",
      "name": "C-forge",
      "color": "5319E7",
      "default": false,
      "description": "Command: forge"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2022-08-16T15:18:32Z",
  "updated_at": "2023-02-10T23:44:09Z",
  "closed_at": "2022-08-19T21:06:49Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nForge\n\n### Describe the feature you would like\n\nAny serious solidity project is going to be built to be upgradeable. And with Foundry's existing tools, there isn't a clear-cut way to test contracts that use proxies. \r\n\r\nIt feels limiting to simply point out anything related to supporting upgrades as \"out of scope\" https://github.com/foundry-rs/foundry/issues/2666#issuecomment-1209802183 or as just a \"specialized vendor tool\" https://github.com/foundry-rs/foundry/issues/2279#issuecomment-1186295707\r\n\r\nTesting upgradeable smart contracts seems important enough that if you're not going to support it, your docs should directly address this in your docs and guide users how to use Forge to do this.\n\n### Additional context\n\n_No response_",
  "closed_by": {
    "login": "onbjerg",
    "id": 8862627,
    "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/onbjerg",
    "html_url": "https://github.com/onbjerg",
    "followers_url": "https://api.github.com/users/onbjerg/followers",
    "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
    "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
    "organizations_url": "https://api.github.com/users/onbjerg/orgs",
    "repos_url": "https://api.github.com/users/onbjerg/repos",
    "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
    "received_events_url": "https://api.github.com/users/onbjerg/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2800/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2800/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1216807740",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2800#issuecomment-1216807740",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2800",
    "id": 1216807740,
    "node_id": "IC_kwDOGBlvNc5IhwM8",
    "user": {
      "login": "joshieDo",
      "id": 93316087,
      "node_id": "U_kgDOBY_j9w",
      "avatar_url": "https://avatars.githubusercontent.com/u/93316087?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/joshieDo",
      "html_url": "https://github.com/joshieDo",
      "followers_url": "https://api.github.com/users/joshieDo/followers",
      "following_url": "https://api.github.com/users/joshieDo/following{/other_user}",
      "gists_url": "https://api.github.com/users/joshieDo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/joshieDo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/joshieDo/subscriptions",
      "organizations_url": "https://api.github.com/users/joshieDo/orgs",
      "repos_url": "https://api.github.com/users/joshieDo/repos",
      "events_url": "https://api.github.com/users/joshieDo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/joshieDo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-16T15:36:52Z",
    "updated_at": "2022-08-16T15:38:41Z",
    "author_association": "COLLABORATOR",
    "body": "> Any serious solidity project is going to be built to be upgradeable.\r\n\r\nI'd highly disagree, and there are a ton of really serious projects which don't have it. \r\n\r\nIn any case, have you tried out https://github.com/odyslam/foundry-upgrades/ ? What do you think is lacking there? I haven't personally used it, but it might be a good place to start and maybe help improve?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1216807740/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1217065986",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2800#issuecomment-1217065986",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2800",
    "id": 1217065986,
    "node_id": "IC_kwDOGBlvNc5IivQC",
    "user": {
      "login": "tynes",
      "id": 6626818,
      "node_id": "MDQ6VXNlcjY2MjY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6626818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tynes",
      "html_url": "https://github.com/tynes",
      "followers_url": "https://api.github.com/users/tynes/followers",
      "following_url": "https://api.github.com/users/tynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/tynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tynes/subscriptions",
      "organizations_url": "https://api.github.com/users/tynes/orgs",
      "repos_url": "https://api.github.com/users/tynes/repos",
      "events_url": "https://api.github.com/users/tynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-16T19:25:00Z",
    "updated_at": "2022-08-16T19:25:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "> > Any serious solidity project is going to be built to be upgradeable.\r\n> \r\n> I'd highly disagree, and there are a ton of really serious projects which don't have it.\r\n> \r\n\r\nDefinitely agree with this, contracts that are not upgradable are important for the future of the ecosystem.\r\n\r\nMany systems do need upgradability built in as projects work towards product market fit - here are some examples of proxy tests:\r\n- https://github.com/ethereum-optimism/optimism/blob/develop/packages/contracts-bedrock/contracts/test/Proxy.t.sol\r\n- https://github.com/ethereum-optimism/optimism/blob/e4ef92a63c3aceeda2a2306429b04df4a25c97c8/packages/contracts-bedrock/contracts/test/OptimismPortal.t.sol#L591\r\n- https://github.com/ethereum-optimism/optimism/blob/develop/packages/contracts-bedrock/contracts/test/ProxyAdmin.t.sol\r\n\r\nAre you looking for tooling to manage upgrades with `forge script`? People have talked about writing libraries that can handle that, its also possible to do that in Typescript with the `foundry-rs/hardhat` plugin with hardhat tasks",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1217065986/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1217858921",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2800#issuecomment-1217858921",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2800",
    "id": 1217858921,
    "node_id": "IC_kwDOGBlvNc5Ilw1p",
    "user": {
      "login": "jordaniza",
      "id": 45881807,
      "node_id": "MDQ6VXNlcjQ1ODgxODA3",
      "avatar_url": "https://avatars.githubusercontent.com/u/45881807?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jordaniza",
      "html_url": "https://github.com/jordaniza",
      "followers_url": "https://api.github.com/users/jordaniza/followers",
      "following_url": "https://api.github.com/users/jordaniza/following{/other_user}",
      "gists_url": "https://api.github.com/users/jordaniza/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jordaniza/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jordaniza/subscriptions",
      "organizations_url": "https://api.github.com/users/jordaniza/orgs",
      "repos_url": "https://api.github.com/users/jordaniza/repos",
      "events_url": "https://api.github.com/users/jordaniza/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jordaniza/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-17T11:00:42Z",
    "updated_at": "2022-08-17T11:01:06Z",
    "author_association": "NONE",
    "body": "@grp06 does [this help](https://github.com/jordaniza/OZ-Upgradeable-Foundry)",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1217858921/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1221092663",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2800#issuecomment-1221092663",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2800",
    "id": 1221092663,
    "node_id": "IC_kwDOGBlvNc5IyGU3",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-19T21:06:49Z",
    "updated_at": "2022-08-19T21:07:50Z",
    "author_association": "MEMBER",
    "body": "Closing this since we've had other issues where we decided we don't want to specifically integrate with any upgradeable proxies *natively* in Forge, so we won't have `forge upgrade` etc. commands.\r\n\r\nIn terms of documenting how to test proxies, I think that's more of a book issue if anything, so it should be discussed in that repository.\r\n\r\nOutside of that I also think that we cannot account for every type of smart contract out there in our canonical documentation, so if any community docs (as linked above) work, we should just refer to them when possible.\r\n\r\nEdit: I'd also like to point out that it is entirely possible to test proxies, so the closed issues do not reflect that this is not possible. It only reflects that we won't have a tool like what OpenZeppelin has for upgrading/deploying proxies.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1221092663/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1239637474",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2800#issuecomment-1239637474",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2800",
    "id": 1239637474,
    "node_id": "IC_kwDOGBlvNc5J413i",
    "user": {
      "login": "HashHaran",
      "id": 106789241,
      "node_id": "U_kgDOBl15eQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/106789241?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/HashHaran",
      "html_url": "https://github.com/HashHaran",
      "followers_url": "https://api.github.com/users/HashHaran/followers",
      "following_url": "https://api.github.com/users/HashHaran/following{/other_user}",
      "gists_url": "https://api.github.com/users/HashHaran/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/HashHaran/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/HashHaran/subscriptions",
      "organizations_url": "https://api.github.com/users/HashHaran/orgs",
      "repos_url": "https://api.github.com/users/HashHaran/repos",
      "events_url": "https://api.github.com/users/HashHaran/events{/privacy}",
      "received_events_url": "https://api.github.com/users/HashHaran/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-07T16:45:21Z",
    "updated_at": "2022-09-07T16:45:21Z",
    "author_association": "NONE",
    "body": "> ### Component\r\n> Forge\r\n> \r\n> ### Describe the feature you would like\r\n> Any serious solidity project is going to be built to be upgradeable. And with Foundry's existing tools, there isn't a clear-cut way to test contracts that use proxies.\r\n> \r\n> It feels limiting to simply point out anything related to supporting upgrades as \"out of scope\" [#2666 (comment)](https://github.com/foundry-rs/foundry/issues/2666#issuecomment-1209802183) or as just a \"specialized vendor tool\" [#2279 (comment)](https://github.com/foundry-rs/foundry/issues/2279#issuecomment-1186295707)\r\n> \r\n> Testing upgradeable smart contracts seems important enough that if you're not going to support it, your docs should directly address this in your docs and guide users how to use Forge to do this.\r\n> \r\n> ### Additional context\r\n> _No response_\r\n\r\nWhile the deployment and management of contracts involved in different proxy patterns can be done with forge scripts, it's hard to do upgrade safety checks in them. For this reason I have used a hardhat parallel set up with my foundry project to use open zeppelin upgrades plugin. Check if [this ](https://github.com/HashHaran/foundry-upgrade-hardhat) helps.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1239637474/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1366449709",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2800#issuecomment-1366449709",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2800",
    "id": 1366449709,
    "node_id": "IC_kwDOGBlvNc5Rcl4t",
    "user": {
      "login": "MatinR1",
      "id": 94117377,
      "node_id": "U_kgDOBZweAQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/94117377?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MatinR1",
      "html_url": "https://github.com/MatinR1",
      "followers_url": "https://api.github.com/users/MatinR1/followers",
      "following_url": "https://api.github.com/users/MatinR1/following{/other_user}",
      "gists_url": "https://api.github.com/users/MatinR1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MatinR1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MatinR1/subscriptions",
      "organizations_url": "https://api.github.com/users/MatinR1/orgs",
      "repos_url": "https://api.github.com/users/MatinR1/repos",
      "events_url": "https://api.github.com/users/MatinR1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MatinR1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-28T08:05:55Z",
    "updated_at": "2022-12-28T08:05:55Z",
    "author_association": "NONE",
    "body": "Hey all!\r\nWe have worked on upgradeability mechanism testing using Foundry's Forge for UUPS-type proxies.\r\nIt's possible to test different functionalities of implementation-proxy pairs using Forge.\r\n\r\nI'd be glad to check this link out:\r\nhttps://github.com/MatinR1/UpgradeableTest/blob/master/test/UpgradeabilityTest.t.sol",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1366449709/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 2,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1426497563",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2800#issuecomment-1426497563",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2800",
    "id": 1426497563,
    "node_id": "IC_kwDOGBlvNc5VBqAb",
    "user": {
      "login": "PatrickAlphaC",
      "id": 54278053,
      "node_id": "MDQ6VXNlcjU0Mjc4MDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/54278053?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PatrickAlphaC",
      "html_url": "https://github.com/PatrickAlphaC",
      "followers_url": "https://api.github.com/users/PatrickAlphaC/followers",
      "following_url": "https://api.github.com/users/PatrickAlphaC/following{/other_user}",
      "gists_url": "https://api.github.com/users/PatrickAlphaC/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PatrickAlphaC/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PatrickAlphaC/subscriptions",
      "organizations_url": "https://api.github.com/users/PatrickAlphaC/orgs",
      "repos_url": "https://api.github.com/users/PatrickAlphaC/repos",
      "events_url": "https://api.github.com/users/PatrickAlphaC/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PatrickAlphaC/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-10T23:44:08Z",
    "updated_at": "2023-02-10T23:44:08Z",
    "author_association": "NONE",
    "body": "This was very helpful, thanks! ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1426497563/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 2,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
