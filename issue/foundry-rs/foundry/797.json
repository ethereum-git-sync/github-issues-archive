{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/797",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/797/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/797/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/797/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/797",
  "id": 1147960372,
  "node_id": "I_kwDOGBlvNc5EbHw0",
  "number": 797,
  "title": "Snapshot tests",
  "user": {
    "login": "onbjerg",
    "id": 8862627,
    "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/onbjerg",
    "html_url": "https://github.com/onbjerg",
    "followers_url": "https://api.github.com/users/onbjerg/followers",
    "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
    "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
    "organizations_url": "https://api.github.com/users/onbjerg/orgs",
    "repos_url": "https://api.github.com/users/onbjerg/repos",
    "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
    "received_events_url": "https://api.github.com/users/onbjerg/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394237,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjM3",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-question",
      "name": "T-question",
      "color": "BFD4F2",
      "default": false,
      "description": "Type: question"
    },
    {
      "id": 3746533612,
      "node_id": "LA_kwDOGBlvNc7fT5Ds",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-meta",
      "name": "T-meta",
      "color": "BFD4F2",
      "default": false,
      "description": "Type: meta"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-02-23T11:15:08Z",
  "updated_at": "2022-02-28T20:17:17Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "This issue is to discuss the possibility of using snapshot testing in various capacities.\r\n\r\nPlaces I think it will definitely make sense to use snapshot tests:\r\n\r\n- `forge fmt` tests since it takes some text and transforms it. Updating the tests for a full-fledged formatting run can end up being a pain.\r\n- `forge flatten` tests. Same reasoning as above.\r\n\r\nAdditionally, it might make sense to use snapshot tests for a larger Solidity test suite. Currently we have `testdata` directories in multiple crates, some with duplicate tests, and some that are entirely unused. Some crates refer directly to `evm-adapters/testdata` instead.\r\n\r\nI propose we create a top-level directory with various tests inside. Each test would be in its own folder and could either be a full project (for CLI integration tests) or single files (for behavioural tests).\r\n\r\nThere are also some obvious drawbacks to snapshot tests however that we must keep in mind:\r\n\r\n- We need to be strict with accepting changes to snapshots\r\n- We need to be careful not to overuse snapshot tests, i.e. we should only use snapshot tests in cases where we want to test large outputs against complex inputs. If we're testing against a very specific behaviour, e.g. that a field or two have a specific value, then we should use unit tests instead.\r\n\r\nWhat are your thoughts?\r\n\r\nSnapshot test library for Rust: https://crates.io/crates/insta",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/797/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/797/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1048678482",
    "html_url": "https://github.com/foundry-rs/foundry/issues/797#issuecomment-1048678482",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/797",
    "id": 1048678482,
    "node_id": "IC_kwDOGBlvNc4-gZBS",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-23T11:17:40Z",
    "updated_at": "2022-02-23T11:17:40Z",
    "author_association": "MEMBER",
    "body": "See also a thought I had for the behavioural tests for the test runners that might be better: https://github.com/onbjerg/foundry-test (the repo is a test suite I'm building up while migrating to REVM)",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1048678482/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1054626182",
    "html_url": "https://github.com/foundry-rs/foundry/issues/797#issuecomment-1054626182",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/797",
    "id": 1054626182,
    "node_id": "IC_kwDOGBlvNc4-3FGG",
    "user": {
      "login": "gakonst",
      "id": 17802178,
      "node_id": "MDQ6VXNlcjE3ODAyMTc4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17802178?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gakonst",
      "html_url": "https://github.com/gakonst",
      "followers_url": "https://api.github.com/users/gakonst/followers",
      "following_url": "https://api.github.com/users/gakonst/following{/other_user}",
      "gists_url": "https://api.github.com/users/gakonst/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gakonst/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gakonst/subscriptions",
      "organizations_url": "https://api.github.com/users/gakonst/orgs",
      "repos_url": "https://api.github.com/users/gakonst/repos",
      "events_url": "https://api.github.com/users/gakonst/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gakonst/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-28T20:17:17Z",
    "updated_at": "2022-02-28T20:17:17Z",
    "author_association": "MEMBER",
    "body": "Supportive of the idea, no strong opinions on the form factor",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1054626182/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
