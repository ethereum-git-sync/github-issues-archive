{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/6601",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6601/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6601/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6601/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/6601",
  "id": 2041975130,
  "node_id": "I_kwDOGBlvNc55thFa",
  "number": 6601,
  "title": "Script not sending specified amount of gas with transaction.",
  "user": {
    "login": "commercium-sys",
    "id": 13490713,
    "node_id": "MDQ6VXNlcjEzNDkwNzEz",
    "avatar_url": "https://avatars.githubusercontent.com/u/13490713?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/commercium-sys",
    "html_url": "https://github.com/commercium-sys",
    "followers_url": "https://api.github.com/users/commercium-sys/followers",
    "following_url": "https://api.github.com/users/commercium-sys/following{/other_user}",
    "gists_url": "https://api.github.com/users/commercium-sys/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/commercium-sys/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/commercium-sys/subscriptions",
    "organizations_url": "https://api.github.com/users/commercium-sys/orgs",
    "repos_url": "https://api.github.com/users/commercium-sys/repos",
    "events_url": "https://api.github.com/users/commercium-sys/events{/privacy}",
    "received_events_url": "https://api.github.com/users/commercium-sys/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-12-14T15:48:54Z",
  "updated_at": "2023-12-14T15:52:12Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Have you ensured that all of these are up to date?\r\n\r\n- [X] Foundry\r\n- [X] Foundryup\r\n\r\n### What version of Foundry are you on?\r\n\r\n0.2.0\r\n\r\n### What command(s) is the bug in?\r\n\r\nforge script\r\n\r\n### Operating System\r\n\r\nmacOS (Apple Silicon)\r\n\r\n### Describe the bug\r\n\r\nI have a script that is invoking a method on a contract on Sepolia. I'm instructing it to use a great deal of gas, but it is not reflecting that amount in the stack trace with the verbose printout.\r\n\r\nThe offending line looks like this:\r\n`entrypoint.handleOps{gas: 200000}(ops, payable(wallet.addr));`\r\n\r\nAnd the stacktrace looks like this:\r\n\r\n```\r\n    ├─ [84018] 0x5FF137D4b0FDCD49DcA30c7CF57E578a026d2789::handleOps([UserOperation({ sender: 0xCEf159675026e08e355cA1a00270Ec7d1cb36d00, nonce: 0, initCode: 0xb1d4bddc41d51057587bdf373ebcaf61c76f31c85fbfb9cf00000000000000000000000071d0fc7d1c570b1ed786382b551a09391c91e33d0000000000000000000000000000000000000000000000000000000000000001, callData: 0x, callGasLimit: 7000000 [7e6], verificationGasLimit: 70000 [7e4], preVerificationGas: 50000 [5e4], maxFeePerGas: 1000000000 [1e9], maxPriorityFeePerGas: 1000000000 [1e9], paymasterAndData: 0x40cd4ffc9d4bfc82fdf5fb922d07be8d0032299d00000000000000000000000000000000000000000000000000000000657e303000000000000000000000000000000000000000000000000000000000657b22f076fa0ac4259dbe85c335661e7cd721e789faee324d05bbfc791e64f4a2c79bba61c268f598cbffd3761e0b04c614db051422976bb981c611f9c5c074cb73b4891b, signature: 0x5123633ae014c4f1103c83eb6c77d855e8bc557672f9799e94a436164d59c9754411e9fd4c88ed3b0d0690f932831c397ee42e709e2c30a2a3861a45018fa36b1c })], wallet: [0x71D0Fc7d1C570b1ED786382B551a09391C91E33d])\r\n    │   ├─ [68595] 0x7fc98430eAEdbb6070B35B39D798725049088348::createSender(0xb1d4bddc41d51057587bdf373ebcaf61c76f31c85fbfb9cf00000000000000000000000071d0fc7d1c570b1ed786382b551a09391c91e33d0000000000000000000000000000000000000000000000000000000000000001)\r\n    │   │   ├─ [67816] 0xb1d4bDDc41d51057587bdF373ebcaf61c76f31c8::createAccount(wallet: [0x71D0Fc7d1C570b1ED786382B551a09391C91E33d], 1)\r\n    │   │   │   ├─ [29883] → new <unknown>@0xCEf159675026e08e355cA1a00270Ec7d1cb36d00\r\n    │   │   │   │   ├─ emit Upgraded(implementation: 0x73cFe0Bd6a07B69C908B62216Ce1150E9e86491c)\r\n    │   │   │   │   ├─ [2572] 0x73cFe0Bd6a07B69C908B62216Ce1150E9e86491c::initialize(wallet: [0x71D0Fc7d1C570b1ED786382B551a09391C91E33d]) [delegatecall]\r\n    │   │   │   │   │   └─ ← EvmError: OutOfGas\r\n    │   │   │   │   └─ ← 0 bytes of code\r\n    │   │   │   └─ ← EvmError: Revert\r\n    │   │   └─ ← 0x0000000000000000000000000000000000000000\r\n    │   └─ ← \r\n    └─ ← \r\n```\r\n    \r\nYou can see this method only has 84018 gas available to it by the time it is invoked in the stack trace. If I increase the gas for the method, it is not reflected. However, I can decrease the amount of gas beneath the 84018 it is reporting and it will be reflected in the stack trace.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/6601/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6601/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1856096359",
    "html_url": "https://github.com/foundry-rs/foundry/issues/6601#issuecomment-1856096359",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6601",
    "id": 1856096359,
    "node_id": "IC_kwDOGBlvNc5uochn",
    "user": {
      "login": "commercium-sys",
      "id": 13490713,
      "node_id": "MDQ6VXNlcjEzNDkwNzEz",
      "avatar_url": "https://avatars.githubusercontent.com/u/13490713?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/commercium-sys",
      "html_url": "https://github.com/commercium-sys",
      "followers_url": "https://api.github.com/users/commercium-sys/followers",
      "following_url": "https://api.github.com/users/commercium-sys/following{/other_user}",
      "gists_url": "https://api.github.com/users/commercium-sys/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/commercium-sys/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/commercium-sys/subscriptions",
      "organizations_url": "https://api.github.com/users/commercium-sys/orgs",
      "repos_url": "https://api.github.com/users/commercium-sys/repos",
      "events_url": "https://api.github.com/users/commercium-sys/events{/privacy}",
      "received_events_url": "https://api.github.com/users/commercium-sys/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-12-14T15:50:00Z",
    "updated_at": "2023-12-14T15:52:12Z",
    "author_association": "NONE",
    "body": "I configured some contracts for easy reproducibility with a Sepolia RPC endpoint. The code is in this repository here and should be very easy to set up and run. It's doing some more things than may be strictly necessary to reproduce this bug, but I figured maybe it is a good idea to keep that in there. \r\n\r\nThe offending line concerning the gas given to this method is at the bottom of the script. \r\n\r\nhttps://github.com/commercium-sys/foundry-sketches/blob/main/script/EIP4337Gas.s.sol",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1856096359/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
