{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2194",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2194/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2194/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2194/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/2194",
  "id": 1292148996,
  "node_id": "I_kwDOGBlvNc5NBKEE",
  "number": 2194,
  "title": "Coverage doesn't cover functions that only return a value",
  "user": {
    "login": "iFrostizz",
    "id": 51274081,
    "node_id": "MDQ6VXNlcjUxMjc0MDgx",
    "avatar_url": "https://avatars.githubusercontent.com/u/51274081?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iFrostizz",
    "html_url": "https://github.com/iFrostizz",
    "followers_url": "https://api.github.com/users/iFrostizz/followers",
    "following_url": "https://api.github.com/users/iFrostizz/following{/other_user}",
    "gists_url": "https://api.github.com/users/iFrostizz/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iFrostizz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iFrostizz/subscriptions",
    "organizations_url": "https://api.github.com/users/iFrostizz/orgs",
    "repos_url": "https://api.github.com/users/iFrostizz/repos",
    "events_url": "https://api.github.com/users/iFrostizz/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iFrostizz/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    },
    {
      "id": 3703752787,
      "node_id": "LA_kwDOGBlvNc7cwshT",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-forge",
      "name": "C-forge",
      "color": "5319E7",
      "default": false,
      "description": "Command: forge"
    },
    {
      "id": 4233058229,
      "node_id": "LA_kwDOGBlvNc78T1e1",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/Cmd-forge-coverage",
      "name": "Cmd-forge-coverage",
      "color": "006B75",
      "default": false,
      "description": "Command: forge coverage"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "onbjerg",
    "id": 8862627,
    "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/onbjerg",
    "html_url": "https://github.com/onbjerg",
    "followers_url": "https://api.github.com/users/onbjerg/followers",
    "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
    "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
    "organizations_url": "https://api.github.com/users/onbjerg/orgs",
    "repos_url": "https://api.github.com/users/onbjerg/repos",
    "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
    "received_events_url": "https://api.github.com/users/onbjerg/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/milestones/1",
    "html_url": "https://github.com/foundry-rs/foundry/milestone/1",
    "labels_url": "https://api.github.com/repos/foundry-rs/foundry/milestones/1/labels",
    "id": 8140456,
    "node_id": "MI_kwDOGBlvNc4AfDao",
    "number": 1,
    "title": "v1.0.0",
    "description": "",
    "creator": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 10,
    "closed_issues": 125,
    "state": "open",
    "created_at": "2022-06-28T08:15:32Z",
    "updated_at": "2023-05-12T14:44:03Z",
    "due_on": null,
    "closed_at": null
  },
  "comments": 5,
  "created_at": "2022-07-02T21:49:56Z",
  "updated_at": "2022-08-03T10:21:38Z",
  "closed_at": "2022-08-03T10:21:37Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Component\n\nForge\n\n### Have you ensured that all of these are up to date?\n\n- [X] Foundry\n- [ ] Foundryup\n\n### What version of Foundry are you on?\n\nforge 0.2.0 (153ae19 2022-06-26T00:04:15.775569508Z)\n\n### What command(s) is the bug in?\n\nforge coverage\n\n### Operating System\n\nLinux\n\n### Describe the bug\n\nHello,\r\n\r\nWhen working on a weird ERC20 and checking the coverage, I noticed that public functions that just return a value are not marked as covered in the coverage report even if properly tested.\r\n\r\n![Screenshot from 2022-07-02 23-48-19](https://user-images.githubusercontent.com/51274081/177017024-3bb22b72-327d-46f1-a0c5-8dc7cf9fbf98.png)\r\n![Screenshot from 2022-07-02 23-49-22](https://user-images.githubusercontent.com/51274081/177017047-3556fbfd-d2f8-4384-abe5-c424a8dc70eb.png)\r\n\r\n\r\nI've prepared a repo in order for you to quickly reproduce the bug: https://github.com/iFrostizz/broken-token-cov-repro\r\n\r\nThanks for the amazing work",
  "closed_by": {
    "login": "onbjerg",
    "id": 8862627,
    "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/onbjerg",
    "html_url": "https://github.com/onbjerg",
    "followers_url": "https://api.github.com/users/onbjerg/followers",
    "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
    "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
    "organizations_url": "https://api.github.com/users/onbjerg/orgs",
    "repos_url": "https://api.github.com/users/onbjerg/repos",
    "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
    "received_events_url": "https://api.github.com/users/onbjerg/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2194/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2194/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1172968721",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2194#issuecomment-1172968721",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2194",
    "id": 1172968721,
    "node_id": "IC_kwDOGBlvNc5F6hUR",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-02T21:56:48Z",
    "updated_at": "2022-07-02T21:56:48Z",
    "author_association": "MEMBER",
    "body": "The constructors do not work yet (see https://github.com/foundry-rs/foundry/issues/1963), for the other functions I'm unsure but will check it out.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1172968721/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1173370631",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2194#issuecomment-1173370631",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2194",
    "id": 1173370631,
    "node_id": "IC_kwDOGBlvNc5F8DcH",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-04T05:36:29Z",
    "updated_at": "2022-07-04T05:36:29Z",
    "author_association": "MEMBER",
    "body": "Note for later: Interestingly this is only the case if you return a 0-y value like `false` or `0`. Seems like a Solidity optimization, but we lose the source maps",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1173370631/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1179576004",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2194#issuecomment-1179576004",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2194",
    "id": 1179576004,
    "node_id": "IC_kwDOGBlvNc5GTubE",
    "user": {
      "login": "iFrostizz",
      "id": 51274081,
      "node_id": "MDQ6VXNlcjUxMjc0MDgx",
      "avatar_url": "https://avatars.githubusercontent.com/u/51274081?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iFrostizz",
      "html_url": "https://github.com/iFrostizz",
      "followers_url": "https://api.github.com/users/iFrostizz/followers",
      "following_url": "https://api.github.com/users/iFrostizz/following{/other_user}",
      "gists_url": "https://api.github.com/users/iFrostizz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iFrostizz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iFrostizz/subscriptions",
      "organizations_url": "https://api.github.com/users/iFrostizz/orgs",
      "repos_url": "https://api.github.com/users/iFrostizz/repos",
      "events_url": "https://api.github.com/users/iFrostizz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iFrostizz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-09T17:12:54Z",
    "updated_at": "2022-07-09T17:12:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "@onbjerg I don't know if you've already started working on it, but I a new rustacean and would love to learn how it gets done.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1179576004/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1179791887",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2194#issuecomment-1179791887",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2194",
    "id": 1179791887,
    "node_id": "IC_kwDOGBlvNc5GUjIP",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-10T20:16:25Z",
    "updated_at": "2022-07-10T20:16:36Z",
    "author_association": "MEMBER",
    "body": "I am working on this unfortunately, but I appreciate it :smile: ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1179791887/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1198405099",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2194#issuecomment-1198405099",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2194",
    "id": 1198405099,
    "node_id": "IC_kwDOGBlvNc5HbjXr",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-28T17:00:54Z",
    "updated_at": "2022-07-28T17:00:54Z",
    "author_association": "MEMBER",
    "body": "Seems to be fixed in #2504, at least with this smaller reproduction:\r\n\r\n```solidity\r\n// Contract.sol\r\npragma solidity >=0.4.0;\r\n\r\ncontract Dummy {\r\n    bool public stuff;\r\n    function setStuff(bool _stuff) public {\r\n        _setStuff(_stuff);\r\n    }\r\n    function _setStuff(bool _stuff) internal {\r\n        stuff = _stuff;\r\n    }\r\n    function transfer(address, uint256) public returns (bool) {\r\n        return false;\r\n    }\r\n}\r\n```\r\n\r\n```solidity\r\n// Contract.t.sol\r\npragma solidity ^0.8.13;\r\n\r\nimport \"forge-std/Test.sol\";\r\nimport \"src/Contract.sol\";\r\n\r\ncontract ContractTest is Test {\r\n    Dummy d;\r\n    function setUp() public {\r\n        d = new Dummy();\r\n    }\r\n\r\n    function testExample() public {\r\n        assertTrue(!d.transfer(address(100), 1));\r\n    }\r\n}\r\n```\r\n\r\n```sh\r\n$ ../../foundry-rs/foundry/target/local/forge coverage\r\n[⠊] Compiling...\r\n[⠃] Compiling 9 files with 0.8.15\r\n[⠊] Solc 0.8.15 finished in 826.92ms\r\nCompiler run successful (with warnings)\r\nwarning[2018]: Warning: Function state mutability can be restricted to pure\r\n  --> src/Contract.sol:12:5:\r\n   |\r\n12 |     function transfer(address, uint256) public returns (bool) {\r\n   |     ^ (Relevant source part starts here and spans across multiple lines).\r\n\r\n\r\n\r\nAnalysing contracts...\r\nRunning tests...\r\n+-----------------------+---------------+---------------+---------------+---------------+\r\n| File                  | % Lines       | % Statements  | % Branches    | % Funcs       |\r\n+=======================================================================================+\r\n| script/Contract.s.sol | 0.00% (0/1)   | 0.00% (0/1)   | 100.00% (0/0) | 0.00% (0/2)   |\r\n|-----------------------+---------------+---------------+---------------+---------------|\r\n| src/Contract.sol      | 100.00% (3/3) | 100.00% (3/3) | 100.00% (0/0) | 100.00% (3/3) |\r\n|-----------------------+---------------+---------------+---------------+---------------|\r\n| Total                 | 75.00% (3/4)  | 75.00% (3/4)  | 100.00% (0/0) | 60.00% (3/5)  |\r\n+-----------------------+---------------+---------------+---------------+---------------+\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1198405099/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
