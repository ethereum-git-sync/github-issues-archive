{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3003",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3003/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3003/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3003/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/3003",
  "id": 1354155441,
  "node_id": "I_kwDOGBlvNc5QtsWx",
  "number": 3003,
  "title": "pending transaction on remote anvil",
  "user": {
    "login": "henry-hz",
    "id": 1010008,
    "node_id": "MDQ6VXNlcjEwMTAwMDg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1010008?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/henry-hz",
    "html_url": "https://github.com/henry-hz",
    "followers_url": "https://api.github.com/users/henry-hz/followers",
    "following_url": "https://api.github.com/users/henry-hz/following{/other_user}",
    "gists_url": "https://api.github.com/users/henry-hz/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/henry-hz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/henry-hz/subscriptions",
    "organizations_url": "https://api.github.com/users/henry-hz/orgs",
    "repos_url": "https://api.github.com/users/henry-hz/repos",
    "events_url": "https://api.github.com/users/henry-hz/events{/privacy}",
    "received_events_url": "https://api.github.com/users/henry-hz/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    },
    {
      "id": 4077188949,
      "node_id": "LA_kwDOGBlvNc7zBPdV",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-anvil",
      "name": "C-anvil",
      "color": "5319E7",
      "default": false,
      "description": "Command: anvil"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-08-29T11:44:25Z",
  "updated_at": "2022-11-14T20:12:08Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nAnvil\n\n### Have you ensured that all of these are up to date?\n\n- [x] Foundry\n- [x] Foundryup\n\n### What version of Foundry are you on?\n\nanvil 0.1.0 (307576d 2022-08-29T00:07:45.642497737Z)\n\n### What command(s) is the bug in?\n\nanvil --host 0.0.0.0 --chain-id 1337\n\n### Operating System\n\n_No response_\n\n### Describe the bug\n\nWhen sending transaction to an anvil that is installed in a remote machine, using \r\n```\r\nanvil --host 0.0.0.0 --chain-id 1337\r\n```\r\n\r\nthe transaction simply does not occur, and it keep requesting the getTransactionByHash, but... when running in a local machine, it works perfectly.\r\n\r\n```\r\neth_getTransactionByHash\r\neth_getTransactionByHash\r\neth_blockNumber\r\neth_networkId\r\neth_chainId\r\neth_chainId\r\neth_getTransactionCount\r\neth_getBlockByNumber\r\neth_feeHistory\r\neth_estimateGas\r\neth_sendRawTransaction\r\neth_getTransactionByHash\r\neth_getTransactionByHash\r\neth_getTransactionByHash\r\neth_getTransactionByHash\r\n```\r\n\r\nThe machine is a debian in aws with enough memory and good latency:\r\n```\r\n64 bytes from 52.29.64.130: icmp_seq=332 ttl=47 time=66.9 ms\r\n64 bytes from 52.29.64.130: icmp_seq=333 ttl=47 time=67.0 ms                                                                          \r\n64 bytes from 52.29.64.130: icmp_seq=334 ttl=47 time=66.9 ms  \r\n```\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3003/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3003/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1230246234",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3003#issuecomment-1230246234",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3003",
    "id": 1230246234,
    "node_id": "IC_kwDOGBlvNc5JVBFa",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-29T12:52:48Z",
    "updated_at": "2022-08-29T12:52:48Z",
    "author_association": "MEMBER",
    "body": "> When sending transaction to an anvil that is installed in a remote machine\r\n\r\nsending the tx works? the node accepts the tx?\r\n\r\ncould you enable logs \r\n\r\n```console\r\nRUST_LOG=backend,api,node,rpc=warn anvil ...\r\n```\r\n\r\nare those the logs of the remote or local node?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1230246234/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1231310584",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3003#issuecomment-1231310584",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3003",
    "id": 1231310584,
    "node_id": "IC_kwDOGBlvNc5JZE74",
    "user": {
      "login": "henry-hz",
      "id": 1010008,
      "node_id": "MDQ6VXNlcjEwMTAwMDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1010008?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/henry-hz",
      "html_url": "https://github.com/henry-hz",
      "followers_url": "https://api.github.com/users/henry-hz/followers",
      "following_url": "https://api.github.com/users/henry-hz/following{/other_user}",
      "gists_url": "https://api.github.com/users/henry-hz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/henry-hz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/henry-hz/subscriptions",
      "organizations_url": "https://api.github.com/users/henry-hz/orgs",
      "repos_url": "https://api.github.com/users/henry-hz/repos",
      "events_url": "https://api.github.com/users/henry-hz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/henry-hz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-30T08:10:04Z",
    "updated_at": "2022-08-30T09:03:58Z",
    "author_association": "NONE",
    "body": "@mattsse thanks for the followup. the log above was from the remote.  I am almost sure I got what happened, and now it's working. it was a bug on my side, difficult to catch, once I had a vage error message.  My bash script check the nonce, before sending the deploys and transactions, but.... the 'cast nonce'  a vage error mesage,  and was showing:\r\n\r\n```\r\nError: \r\nerror sending request for url (http://localhost:8545/): error trying to connect: tcp connect error: Connection refused (os error 111)\r\n\r\nContext:\r\n- Error #0: error trying to connect: tcp connect error: Connection refused (os error 111)\r\n- Error #1: tcp connect error: Connection refused (os error 111)\r\n- Error #2: Connection refused (os error 111)\r\n```\r\n\r\nthe problem with this message is that I didn't catch WHO is sending it, so I got nonce from other network when it was up, and used in the intened network, so I had a spaghetti nonce.\r\n\r\nusing seth, it's possible to identify WHO is failing, once the 'seth-rpc-curl' is printed:\r\n\r\n```\r\nseth nonce 0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266                                                              10:49:31\r\ncurl: (7) Failed to connect to 127.0.0.1 port 8545: Connection refused\r\nseth-rpc-curl: Please make sure that you are running a local Ethereum node:\r\nseth-rpc-curl:   For example, try running either `parity' or `geth --rpc'.\r\nseth-rpc-curl: You could also try connecting to an external Ethereum node:\r\nseth-rpc-curl:   For example, try `export ETH_RPC_URL=https://mainnet.infura.io'.\r\nseth-rpc-curl:   If you have an Infura API key, add it to the end of the URL.\r\n```\r\nso let me change this bug request [it seems to work right now] to a feature request:  once all the cast and forge commands are in principle to be used with bash, and bash is not the most cozy environment that exits out there, let me suggest the following:  normalized and detail error message for every request, showing:\r\n- command call\r\n- parameters\r\n- why it happened\r\n- private error number [the os error 111 is far from informative].",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1231310584/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1313483415",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3003#issuecomment-1313483415",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3003",
    "id": 1313483415,
    "node_id": "IC_kwDOGBlvNc5OSiqX",
    "user": {
      "login": "vanillaHill",
      "id": 34197445,
      "node_id": "MDQ6VXNlcjM0MTk3NDQ1",
      "avatar_url": "https://avatars.githubusercontent.com/u/34197445?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vanillaHill",
      "html_url": "https://github.com/vanillaHill",
      "followers_url": "https://api.github.com/users/vanillaHill/followers",
      "following_url": "https://api.github.com/users/vanillaHill/following{/other_user}",
      "gists_url": "https://api.github.com/users/vanillaHill/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vanillaHill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vanillaHill/subscriptions",
      "organizations_url": "https://api.github.com/users/vanillaHill/orgs",
      "repos_url": "https://api.github.com/users/vanillaHill/repos",
      "events_url": "https://api.github.com/users/vanillaHill/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vanillaHill/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-14T10:59:09Z",
    "updated_at": "2022-11-14T10:59:09Z",
    "author_association": "NONE",
    "body": "@henry-hz Sorry how did you fix this issue, I got the same issue here.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1313483415/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1314316544",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3003#issuecomment-1314316544",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3003",
    "id": 1314316544,
    "node_id": "IC_kwDOGBlvNc5OVuEA",
    "user": {
      "login": "henry-hz",
      "id": 1010008,
      "node_id": "MDQ6VXNlcjEwMTAwMDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1010008?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/henry-hz",
      "html_url": "https://github.com/henry-hz",
      "followers_url": "https://api.github.com/users/henry-hz/followers",
      "following_url": "https://api.github.com/users/henry-hz/following{/other_user}",
      "gists_url": "https://api.github.com/users/henry-hz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/henry-hz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/henry-hz/subscriptions",
      "organizations_url": "https://api.github.com/users/henry-hz/orgs",
      "repos_url": "https://api.github.com/users/henry-hz/repos",
      "events_url": "https://api.github.com/users/henry-hz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/henry-hz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-14T20:12:08Z",
    "updated_at": "2022-11-14T20:12:08Z",
    "author_association": "NONE",
    "body": "Hi @vanillaHill , my nonce was wrong, check step by step if you get the right nonce before sending the transaction. ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1314316544/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
