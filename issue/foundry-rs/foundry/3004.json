{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3004",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3004/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3004/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3004/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/3004",
  "id": 1354303246,
  "node_id": "I_kwDOGBlvNc5QuQcO",
  "number": 3004,
  "title": "tokio-run-time index out of bounds on eth_getTransactionReceipt.",
  "user": {
    "login": "sunwrobert",
    "id": 6511174,
    "node_id": "MDQ6VXNlcjY1MTExNzQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6511174?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sunwrobert",
    "html_url": "https://github.com/sunwrobert",
    "followers_url": "https://api.github.com/users/sunwrobert/followers",
    "following_url": "https://api.github.com/users/sunwrobert/following{/other_user}",
    "gists_url": "https://api.github.com/users/sunwrobert/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sunwrobert/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sunwrobert/subscriptions",
    "organizations_url": "https://api.github.com/users/sunwrobert/orgs",
    "repos_url": "https://api.github.com/users/sunwrobert/repos",
    "events_url": "https://api.github.com/users/sunwrobert/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sunwrobert/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "mattsse",
    "id": 19890894,
    "node_id": "MDQ6VXNlcjE5ODkwODk0",
    "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mattsse",
    "html_url": "https://github.com/mattsse",
    "followers_url": "https://api.github.com/users/mattsse/followers",
    "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
    "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
    "organizations_url": "https://api.github.com/users/mattsse/orgs",
    "repos_url": "https://api.github.com/users/mattsse/repos",
    "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mattsse/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-08-29T13:29:21Z",
  "updated_at": "2022-08-29T15:23:40Z",
  "closed_at": "2022-08-29T15:23:40Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nAnvil\n\n### Have you ensured that all of these are up to date?\n\n- [ ] Foundry\n- [ ] Foundryup\n\n### What version of Foundry are you on?\n\nforge 0.2.0 (7278695 2022-08-27T00:28:29.89913Z)\n\n### What command(s) is the bug in?\n\nanvil\n\n### Operating System\n\n_No response_\n\n### Describe the bug\n\nBeen seeing instances of this occur sproadically in our tests. Don't have a realible way of repro-ing but wondering if the logs hint at anything.\r\n\r\n```\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  | thread 'tokio-runtime-worker' panicked at 'index out of bounds: the len is 1 but the index is 3', anvil/src/eth/backend/mem/mod.rs:1445:27\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  | stack backtrace:\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  | [2m2022-08-29T11:17:44.756569Z[0m [32m INFO[0m [2mnode::user[0m[2m:[0m eth_getTransactionReceipt\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |    0:     0x563a9f542d00 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |    1:     0x563a9f23420c - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |    2:     0x563a9f520740 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |    3:     0x563a9f5439d5 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |    4:     0x563a9f5447d4 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |    5:     0x563a9f544372 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |    6:     0x563a9f5442e6 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |    7:     0x563a9f5442a2 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |    8:     0x563a9eed5e62 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |    9:     0x563a9eed5ee1 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   10:     0x563a9efbee4b - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   11:     0x563a9efa18f5 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   12:     0x563a9efa027e - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   13:     0x563a9ef6f906 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   14:     0x563a9ef6d1a1 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   15:     0x563a9f1bc031 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   16:     0x563a9f1b8be8 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   17:     0x563a9ef48805 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   18:     0x563a9ef48546 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   19:     0x563a9ef48450 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   20:     0x563a9ef49000 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   21:     0x563a9ef48805 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   22:     0x563a9ef48546 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   23:     0x563a9ef48450 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   24:     0x563a9ef49000 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   25:     0x563a9ef48805 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   26:     0x563a9ef48546 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   27:     0x563a9ef4d3fa - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   28:     0x563a9ef6a3bc - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   29:     0x563a9ef48805 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   30:     0x563a9ef48546 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   31:     0x563a9ef4b086 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   32:     0x563a9ef4bbd5 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   33:     0x563a9ef48805 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   34:     0x563a9ef2cb3e - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   35:     0x563a9eef4fb3 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   36:     0x563a9ef2913e - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   37:     0x563a9ef24378 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   38:     0x563a9f55b13d - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   39:     0x563a9f55a12b - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   40:     0x563a9f288d03 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   41:     0x563a9f55f164 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   42:     0x563a9f560425 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   43:     0x563a9f545ae5 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   44:     0x7fe0b3ae5ea7 - start_thread\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   45:     0x7fe0b38cbdef - clone\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  |   46:                0x0 - <unknown>\r\napi_2948024161_undefined-ethereum-mainnet-anvil-1  | ./scripts/run_ethereum.sh: line 4:    10 Aborted                 (core dumped) RUST_LOG=backend,node,miner,rpc=warn RUST_BACKTRACE=full anvil --host 0.0.0.0 --fork-url=\"https://eth-mainnet.g.alchemy.com/v2/XXX\" --fork-block-number=15347924 --port=8545 --block-time=4 --chain-id=1 --timeout=3000 --retries=5\r\n```",
  "closed_by": {
    "login": "gakonst",
    "id": 17802178,
    "node_id": "MDQ6VXNlcjE3ODAyMTc4",
    "avatar_url": "https://avatars.githubusercontent.com/u/17802178?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gakonst",
    "html_url": "https://github.com/gakonst",
    "followers_url": "https://api.github.com/users/gakonst/followers",
    "following_url": "https://api.github.com/users/gakonst/following{/other_user}",
    "gists_url": "https://api.github.com/users/gakonst/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gakonst/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gakonst/subscriptions",
    "organizations_url": "https://api.github.com/users/gakonst/orgs",
    "repos_url": "https://api.github.com/users/gakonst/repos",
    "events_url": "https://api.github.com/users/gakonst/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gakonst/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3004/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3004/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1230367853",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3004#issuecomment-1230367853",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3004",
    "id": 1230367853,
    "node_id": "IC_kwDOGBlvNc5JVext",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-29T14:14:03Z",
    "updated_at": "2022-08-29T14:14:03Z",
    "author_association": "MEMBER",
    "body": "this looks like we're messing up the transaction index counter somewhere, checking",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1230367853/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1230431978",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3004#issuecomment-1230431978",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3004",
    "id": 1230431978,
    "node_id": "IC_kwDOGBlvNc5JVubq",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-29T14:59:32Z",
    "updated_at": "2022-08-29T14:59:32Z",
    "author_association": "MEMBER",
    "body": "thx for flagging, this was indeed a smol issue with how the index was computed, fixed in #3008",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1230431978/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
