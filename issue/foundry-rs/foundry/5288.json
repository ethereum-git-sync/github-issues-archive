{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/5288",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5288/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5288/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5288/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/5288",
  "id": 1787322799,
  "node_id": "I_kwDOGBlvNc5qiGGv",
  "number": 5288,
  "title": "incorrect docs for vm.expectRevert",
  "user": {
    "login": "thedavidmeister",
    "id": 629710,
    "node_id": "MDQ6VXNlcjYyOTcxMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/629710?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/thedavidmeister",
    "html_url": "https://github.com/thedavidmeister",
    "followers_url": "https://api.github.com/users/thedavidmeister/followers",
    "following_url": "https://api.github.com/users/thedavidmeister/following{/other_user}",
    "gists_url": "https://api.github.com/users/thedavidmeister/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/thedavidmeister/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/thedavidmeister/subscriptions",
    "organizations_url": "https://api.github.com/users/thedavidmeister/orgs",
    "repos_url": "https://api.github.com/users/thedavidmeister/repos",
    "events_url": "https://api.github.com/users/thedavidmeister/events{/privacy}",
    "received_events_url": "https://api.github.com/users/thedavidmeister/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-07-04T07:23:25Z",
  "updated_at": "2023-07-05T02:17:01Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nForge\n\n### Have you ensured that all of these are up to date?\n\n- [X] Foundry\n- [ ] Foundryup\n\n### What version of Foundry are you on?\n\nforge 0.2.0 (42fb694 2023-07-04T00:04:51.760418000Z)\n\n### What command(s) is the bug in?\n\nforge test\n\n### Operating System\n\nmacOS (Apple Silicon)\n\n### Describe the bug\n\nThe docs state that string literals are supported by `vm.expectRevert`\r\n\r\n<img width=\"857\" alt=\"Screenshot 2023-07-04 at 11 22 22\" src=\"https://github.com/foundry-rs/foundry/assets/629710/7880ce46-2c5d-4aae-8a14-d93c5f8b6a9b\">\r\n\r\nhttps://book.getfoundry.sh/cheatcodes/expect-revert\r\n\r\nBut actually it seems only the form where you first cast the string to bytes like `vm.expectRevert(bytes(\"foo\"))` is supported\r\n\r\n```\r\nCompiler run failed:\r\nError (6675): Member \"expectRevert\" not unique after argument-dependent lookup in contract Vm.\r\n  --> test/concrete/Foo.t.sol:26:9:\r\n   |\r\n26 |         vm.expectRevert(\"foo\");\r\n```",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/5288/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5288/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1620477422",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5288#issuecomment-1620477422",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5288",
    "id": 1620477422,
    "node_id": "IC_kwDOGBlvNc5gloXu",
    "user": {
      "login": "klkvr",
      "id": 62447812,
      "node_id": "MDQ6VXNlcjYyNDQ3ODEy",
      "avatar_url": "https://avatars.githubusercontent.com/u/62447812?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/klkvr",
      "html_url": "https://github.com/klkvr",
      "followers_url": "https://api.github.com/users/klkvr/followers",
      "following_url": "https://api.github.com/users/klkvr/following{/other_user}",
      "gists_url": "https://api.github.com/users/klkvr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/klkvr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/klkvr/subscriptions",
      "organizations_url": "https://api.github.com/users/klkvr/orgs",
      "repos_url": "https://api.github.com/users/klkvr/repos",
      "events_url": "https://api.github.com/users/klkvr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/klkvr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-04T15:52:31Z",
    "updated_at": "2023-07-04T20:28:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "Actually, `vm.expectRevert` supports only `bytes4` and `bytes` inputs. But you are able to pass string literals to it because Solidity allows implicit casting of string literals into bytes.\r\n\r\nMentioned error is happening because Solidity also allows implicit casting of strings with length <= 4 into bytes4. \r\n\r\nSo, in case of short revert strings you would have to use `vm.expectRevert(bytes(\"foo\"))`",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1620477422/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1620521378",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5288#issuecomment-1620521378",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5288",
    "id": 1620521378,
    "node_id": "IC_kwDOGBlvNc5glzGi",
    "user": {
      "login": "thedavidmeister",
      "id": 629710,
      "node_id": "MDQ6VXNlcjYyOTcxMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/629710?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thedavidmeister",
      "html_url": "https://github.com/thedavidmeister",
      "followers_url": "https://api.github.com/users/thedavidmeister/followers",
      "following_url": "https://api.github.com/users/thedavidmeister/following{/other_user}",
      "gists_url": "https://api.github.com/users/thedavidmeister/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thedavidmeister/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thedavidmeister/subscriptions",
      "organizations_url": "https://api.github.com/users/thedavidmeister/orgs",
      "repos_url": "https://api.github.com/users/thedavidmeister/repos",
      "events_url": "https://api.github.com/users/thedavidmeister/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thedavidmeister/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-04T16:37:16Z",
    "updated_at": "2023-07-04T16:37:16Z",
    "author_association": "NONE",
    "body": "hmm, ok, not sure if it's worth mentioning in docs",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1620521378/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1620921441",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5288#issuecomment-1620921441",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5288",
    "id": 1620921441,
    "node_id": "IC_kwDOGBlvNc5gnUxh",
    "user": {
      "login": "xeno097",
      "id": 42520800,
      "node_id": "MDQ6VXNlcjQyNTIwODAw",
      "avatar_url": "https://avatars.githubusercontent.com/u/42520800?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xeno097",
      "html_url": "https://github.com/xeno097",
      "followers_url": "https://api.github.com/users/xeno097/followers",
      "following_url": "https://api.github.com/users/xeno097/following{/other_user}",
      "gists_url": "https://api.github.com/users/xeno097/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xeno097/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xeno097/subscriptions",
      "organizations_url": "https://api.github.com/users/xeno097/orgs",
      "repos_url": "https://api.github.com/users/xeno097/repos",
      "events_url": "https://api.github.com/users/xeno097/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xeno097/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-05T02:15:22Z",
    "updated_at": "2023-07-05T02:17:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "It is mentioned in the docs nearly at the bottom of the page although maybe an improvement could be made to clarify that if a string long <= 4 bytes is used, an explicit conversion should be performed to help the compiler decide which override should be used (The docs say that you should do it in case you use a 4 char long string).\r\n\r\n![image](https://github.com/foundry-rs/foundry/assets/42520800/40cb722d-bc30-4b6c-80de-57615812ba2c)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1620921441/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
