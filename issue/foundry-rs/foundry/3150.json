{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3150",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3150/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3150/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3150/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/3150",
  "id": 1368069883,
  "node_id": "I_kwDOGBlvNc5Rixb7",
  "number": 3150,
  "title": "Sending TXs bears an RPC error on Optimistic Goerli",
  "user": {
    "login": "akirillo",
    "id": 20803092,
    "node_id": "MDQ6VXNlcjIwODAzMDky",
    "avatar_url": "https://avatars.githubusercontent.com/u/20803092?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/akirillo",
    "html_url": "https://github.com/akirillo",
    "followers_url": "https://api.github.com/users/akirillo/followers",
    "following_url": "https://api.github.com/users/akirillo/following{/other_user}",
    "gists_url": "https://api.github.com/users/akirillo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/akirillo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/akirillo/subscriptions",
    "organizations_url": "https://api.github.com/users/akirillo/orgs",
    "repos_url": "https://api.github.com/users/akirillo/repos",
    "events_url": "https://api.github.com/users/akirillo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/akirillo/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2022-09-09T16:38:40Z",
  "updated_at": "2022-09-22T15:37:57Z",
  "closed_at": "2022-09-09T18:21:02Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nForge, Cast\n\n### Have you ensured that all of these are up to date?\n\n- [X] Foundry\n- [X] Foundryup\n\n### What version of Foundry are you on?\n\nforge 0.2.0 (f540aa9 2022-09-09T00:05:32.599852Z)\n\n### What command(s) is the bug in?\n\ncast send, forge create\n\n### Operating System\n\nmacOS (Apple Silicon)\n\n### Describe the bug\n\nI discovered this bug at first when trying to use `forge create` to deploy a contract to Optimistic Goerli. On [their website](https://community.optimism.io/docs/developers/build/using-tools/#foundry), they claim that one can use Foundry out-of-the-box with Optimism by just providing an Optimism RPC URL.\r\nLater on, I tried using `cast send` for a basic Ether transfer, and encountered the same error as I had for `forge create`:\r\n```bash\r\n$ cast send --rpc-url=https://goerli.optimism.io --private-key=$PRIVATE_KEY 0xf5de760f2e916647fd766B4AD9E85ff943cE3A2b --value 0.1ether\r\n  Error:\r\n  (code: -32602, message: too many arguments, want at most 1, data: None)\r\n```\r\nI tracked this error message down and found that it stems from the `eth_sendTransaction` JSON RPC getting more parameters than expected ([SO link](https://ethereum.stackexchange.com/questions/15138/sendtransaction-code-32602-messagetoo-many-arguments-want-at-most-1)).\r\n\r\nNote that I was able to deploy to Optimistic Goerli using Remix, and send transactions using the [Optimistic Goerli Etherscan](https://goerli-optimism.etherscan.io/), so I don't believe the issue is on their end.\r\n\r\nI tried hopping through the Foundry codebase to track down how the RPC payload is packaged for `eth_sendTransaction`, and afaict, everything was implemented correctly, and the TX itself is the only parameter in the payload. That said, I'm _very_ new to the codebase, so I'm not surprised I couldn't find the issue on my first pass.\r\n\r\nFwiw, I'm happy to help address this issue, if someone more experienced with the codebase doesn't mind taking some time to walk me through / pair on it a bit :)",
  "closed_by": {
    "login": "rkrasiuk",
    "id": 25429261,
    "node_id": "MDQ6VXNlcjI1NDI5MjYx",
    "avatar_url": "https://avatars.githubusercontent.com/u/25429261?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rkrasiuk",
    "html_url": "https://github.com/rkrasiuk",
    "followers_url": "https://api.github.com/users/rkrasiuk/followers",
    "following_url": "https://api.github.com/users/rkrasiuk/following{/other_user}",
    "gists_url": "https://api.github.com/users/rkrasiuk/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rkrasiuk/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rkrasiuk/subscriptions",
    "organizations_url": "https://api.github.com/users/rkrasiuk/orgs",
    "repos_url": "https://api.github.com/users/rkrasiuk/repos",
    "events_url": "https://api.github.com/users/rkrasiuk/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rkrasiuk/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3150/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3150/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1242236664",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3150#issuecomment-1242236664",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3150",
    "id": 1242236664,
    "node_id": "IC_kwDOGBlvNc5KCwb4",
    "user": {
      "login": "gakonst",
      "id": 17802178,
      "node_id": "MDQ6VXNlcjE3ODAyMTc4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17802178?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gakonst",
      "html_url": "https://github.com/gakonst",
      "followers_url": "https://api.github.com/users/gakonst/followers",
      "following_url": "https://api.github.com/users/gakonst/following{/other_user}",
      "gists_url": "https://api.github.com/users/gakonst/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gakonst/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gakonst/subscriptions",
      "organizations_url": "https://api.github.com/users/gakonst/orgs",
      "repos_url": "https://api.github.com/users/gakonst/repos",
      "events_url": "https://api.github.com/users/gakonst/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gakonst/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-09T17:09:24Z",
    "updated_at": "2022-09-09T17:09:24Z",
    "author_association": "MEMBER",
    "body": "Can you run your command with `RUST_LOG=ethers=trace`? Would help to see what tag is being passed. I think we had a similar issue elsewhere @ngotchac ?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1242236664/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1242244926",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3150#issuecomment-1242244926",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3150",
    "id": 1242244926,
    "node_id": "IC_kwDOGBlvNc5KCyc-",
    "user": {
      "login": "akirillo",
      "id": 20803092,
      "node_id": "MDQ6VXNlcjIwODAzMDky",
      "avatar_url": "https://avatars.githubusercontent.com/u/20803092?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/akirillo",
      "html_url": "https://github.com/akirillo",
      "followers_url": "https://api.github.com/users/akirillo/followers",
      "following_url": "https://api.github.com/users/akirillo/following{/other_user}",
      "gists_url": "https://api.github.com/users/akirillo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/akirillo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/akirillo/subscriptions",
      "organizations_url": "https://api.github.com/users/akirillo/orgs",
      "repos_url": "https://api.github.com/users/akirillo/repos",
      "events_url": "https://api.github.com/users/akirillo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/akirillo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-09T17:17:23Z",
    "updated_at": "2022-09-09T17:17:23Z",
    "author_association": "NONE",
    "body": "ooh, spicy:\r\n```shell\r\n$ RUST_LOG=ethers=trace cast send --rpc-url=https://goerli.optimism.io --private-key=$PRIVATE_KEY 0xf5de760f2e916647fd766B4AD9E85ff943cE3A2b --value 0.1ether\r\n2022-09-09T17:14:58.317675Z TRACE rpc{method=\"eth_chainId\" params=\"null\"}: ethers_providers::provider: tx\r\n2022-09-09T17:14:58.547324Z TRACE rpc{method=\"eth_chainId\" params=\"null\"}: ethers_providers::provider: rx=\"\\\"0x1a4\\\"\"\r\n2022-09-09T17:14:58.547959Z TRACE rpc{method=\"eth_getTransactionCount\" params=\"[\\\"0xbc19ffef966bff35cb0fee54741fef4f1a33662a\\\",\\\"latest\\\"]\"}: ethers_providers::provider: tx\r\n2022-09-09T17:14:58.711883Z TRACE rpc{method=\"eth_getTransactionCount\" params=\"[\\\"0xbc19ffef966bff35cb0fee54741fef4f1a33662a\\\",\\\"latest\\\"]\"}: ethers_providers::provider: rx=\"\\\"0x4\\\"\"\r\n2022-09-09T17:14:58.711992Z TRACE rpc{method=\"eth_gasPrice\" params=\"null\"}: ethers_providers::provider: tx\r\n2022-09-09T17:14:58.884208Z TRACE rpc{method=\"eth_gasPrice\" params=\"null\"}: ethers_providers::provider: rx=\"\\\"0x1\\\"\"\r\n2022-09-09T17:14:58.884405Z TRACE rpc{method=\"eth_estimateGas\" params=\"[{\\\"from\\\":\\\"0xbc19ffef966bff35cb0fee54741fef4f1a33662a\\\",\\\"gasPrice\\\":\\\"0x1\\\",\\\"nonce\\\":\\\"0x4\\\",\\\"to\\\":\\\"0xf5de760f2e916647fd766b4ad9e85ff943ce3a2b\\\",\\\"type\\\":\\\"0x00\\\",\\\"value\\\":\\\"0x16345785d8a0000\\\"},\\\"latest\\\"]\"}: ethers_providers::provider: tx\r\n2022-09-09T17:14:59.039531Z TRACE rpc{method=\"eth_estimateGas\" params=\"[{\\\"from\\\":\\\"0xbc19ffef966bff35cb0fee54741fef4f1a33662a\\\",\\\"gasPrice\\\":\\\"0x1\\\",\\\"nonce\\\":\\\"0x4\\\",\\\"to\\\":\\\"0xf5de760f2e916647fd766b4ad9e85ff943ce3a2b\\\",\\\"type\\\":\\\"0x00\\\",\\\"value\\\":\\\"0x16345785d8a0000\\\"},\\\"latest\\\"]\"}: ethers_providers::transports::retry: should not retry err=JsonRpcClientError(JsonRpcError(JsonRpcError { code: -32602, message: \"too many arguments, want at most 1\", data: None }))\r\nError:\r\n(code: -32602, message: too many arguments, want at most 1, data: None)\r\n```\r\nlooks like it stems from the `eth_estimateGas` call also inputting the `\"latest\"` param?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1242244926/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1242276837",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3150#issuecomment-1242276837",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3150",
    "id": 1242276837,
    "node_id": "IC_kwDOGBlvNc5KC6Pl",
    "user": {
      "login": "rkrasiuk",
      "id": 25429261,
      "node_id": "MDQ6VXNlcjI1NDI5MjYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25429261?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rkrasiuk",
      "html_url": "https://github.com/rkrasiuk",
      "followers_url": "https://api.github.com/users/rkrasiuk/followers",
      "following_url": "https://api.github.com/users/rkrasiuk/following{/other_user}",
      "gists_url": "https://api.github.com/users/rkrasiuk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rkrasiuk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rkrasiuk/subscriptions",
      "organizations_url": "https://api.github.com/users/rkrasiuk/orgs",
      "repos_url": "https://api.github.com/users/rkrasiuk/repos",
      "events_url": "https://api.github.com/users/rkrasiuk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rkrasiuk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-09T17:41:48Z",
    "updated_at": "2022-09-09T18:03:15Z",
    "author_association": "COLLABORATOR",
    "body": "@akirillo doesn't seem like optimism goerli supports the block param which goes against the rpc spec. without the block param it works just fine tho\r\n<img width=\"828\" alt=\"Screenshot 2022-09-09 at 20 39 24\" src=\"https://user-images.githubusercontent.com/25429261/189411731-422068e8-35d3-4313-bbbb-f651c0e9a7a8.png\">\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1242276837/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1242314188",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3150#issuecomment-1242314188",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3150",
    "id": 1242314188,
    "node_id": "IC_kwDOGBlvNc5KDDXM",
    "user": {
      "login": "tynes",
      "id": 6626818,
      "node_id": "MDQ6VXNlcjY2MjY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6626818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tynes",
      "html_url": "https://github.com/tynes",
      "followers_url": "https://api.github.com/users/tynes/followers",
      "following_url": "https://api.github.com/users/tynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/tynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tynes/subscriptions",
      "organizations_url": "https://api.github.com/users/tynes/orgs",
      "repos_url": "https://api.github.com/users/tynes/repos",
      "events_url": "https://api.github.com/users/tynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-09T18:13:22Z",
    "updated_at": "2022-09-09T18:13:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "This has been tracked down to the current deployment of Optimism being based off of an older version of geth that doesn't support a block tag for gas estimation. We are looking into putting out a new release that fixes this",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1242314188/reactions",
      "total_count": 5,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 5,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1242314900",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3150#issuecomment-1242314900",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3150",
    "id": 1242314900,
    "node_id": "IC_kwDOGBlvNc5KDDiU",
    "user": {
      "login": "akirillo",
      "id": 20803092,
      "node_id": "MDQ6VXNlcjIwODAzMDky",
      "avatar_url": "https://avatars.githubusercontent.com/u/20803092?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/akirillo",
      "html_url": "https://github.com/akirillo",
      "followers_url": "https://api.github.com/users/akirillo/followers",
      "following_url": "https://api.github.com/users/akirillo/following{/other_user}",
      "gists_url": "https://api.github.com/users/akirillo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/akirillo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/akirillo/subscriptions",
      "organizations_url": "https://api.github.com/users/akirillo/orgs",
      "repos_url": "https://api.github.com/users/akirillo/repos",
      "events_url": "https://api.github.com/users/akirillo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/akirillo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-09T18:14:09Z",
    "updated_at": "2022-09-09T18:14:09Z",
    "author_association": "NONE",
    "body": "is there an issue on optimism that's already tracking this? if not, am happy to make",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1242314900/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1242321335",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3150#issuecomment-1242321335",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3150",
    "id": 1242321335,
    "node_id": "IC_kwDOGBlvNc5KDFG3",
    "user": {
      "login": "rkrasiuk",
      "id": 25429261,
      "node_id": "MDQ6VXNlcjI1NDI5MjYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25429261?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rkrasiuk",
      "html_url": "https://github.com/rkrasiuk",
      "followers_url": "https://api.github.com/users/rkrasiuk/followers",
      "following_url": "https://api.github.com/users/rkrasiuk/following{/other_user}",
      "gists_url": "https://api.github.com/users/rkrasiuk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rkrasiuk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rkrasiuk/subscriptions",
      "organizations_url": "https://api.github.com/users/rkrasiuk/orgs",
      "repos_url": "https://api.github.com/users/rkrasiuk/repos",
      "events_url": "https://api.github.com/users/rkrasiuk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rkrasiuk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-09T18:21:02Z",
    "updated_at": "2022-09-09T18:21:02Z",
    "author_association": "COLLABORATOR",
    "body": "closing this one, thanks for raising @akirillo ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1242321335/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1255206213",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3150#issuecomment-1255206213",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3150",
    "id": 1255206213,
    "node_id": "IC_kwDOGBlvNc5K0O1F",
    "user": {
      "login": "tynes",
      "id": 6626818,
      "node_id": "MDQ6VXNlcjY2MjY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6626818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tynes",
      "html_url": "https://github.com/tynes",
      "followers_url": "https://api.github.com/users/tynes/followers",
      "following_url": "https://api.github.com/users/tynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/tynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tynes/subscriptions",
      "organizations_url": "https://api.github.com/users/tynes/orgs",
      "repos_url": "https://api.github.com/users/tynes/repos",
      "events_url": "https://api.github.com/users/tynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-22T15:37:57Z",
    "updated_at": "2022-09-22T15:37:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "This should be fixed now",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1255206213/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 2,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
