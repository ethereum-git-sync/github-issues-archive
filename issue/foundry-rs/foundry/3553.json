{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3553",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3553/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3553/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3553/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/3553",
  "id": 1424044921,
  "node_id": "I_kwDOGBlvNc5U4TN5",
  "number": 3553,
  "title": "contract verification ordering degraded",
  "user": {
    "login": "wminshew",
    "id": 9845502,
    "node_id": "MDQ6VXNlcjk4NDU1MDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9845502?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wminshew",
    "html_url": "https://github.com/wminshew",
    "followers_url": "https://api.github.com/users/wminshew/followers",
    "following_url": "https://api.github.com/users/wminshew/following{/other_user}",
    "gists_url": "https://api.github.com/users/wminshew/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wminshew/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wminshew/subscriptions",
    "organizations_url": "https://api.github.com/users/wminshew/orgs",
    "repos_url": "https://api.github.com/users/wminshew/repos",
    "events_url": "https://api.github.com/users/wminshew/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wminshew/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    },
    {
      "id": 3703752787,
      "node_id": "LA_kwDOGBlvNc7cwshT",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-forge",
      "name": "C-forge",
      "color": "5319E7",
      "default": false,
      "description": "Command: forge"
    },
    {
      "id": 3854218343,
      "node_id": "LA_kwDOGBlvNc7lurRn",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/Cmd-forge-verify",
      "name": "Cmd-forge-verify",
      "color": "006B75",
      "default": false,
      "description": "Command: forge verify-contract"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2022-10-26T13:40:08Z",
  "updated_at": "2023-04-18T08:34:15Z",
  "closed_at": "2023-04-18T08:34:15Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nForge\n\n### Have you ensured that all of these are up to date?\n\n- [X] Foundry\n- [X] Foundryup\n\n### What version of Foundry are you on?\n\nforge 0.2.0 (9d64f1f 2022-10-26T00:11:13.985133Z)\n\n### What command(s) is the bug in?\n\nforge verify-contract\n\n### Operating System\n\nmacOS (Intel)\n\n### Describe the bug\n\nit looks like somewhat recently (last ~20 days?) the ordering for verified contracts changed from contract / import order to.. something that's almost alphabetical but somehow even worse?\r\n\r\nold/good example @ https://etherscan.io/address/0x4Df01754eBd055498C8087b1e9a5c7a9ad19b0F6#code\r\nnew/bad example @ https://arbiscan.io/address/0x4Df01754eBd055498C8087b1e9a5c7a9ad19b0F6#code\r\n\r\nthe former is far more useful/readable imo",
  "closed_by": {
    "login": "mattsse",
    "id": 19890894,
    "node_id": "MDQ6VXNlcjE5ODkwODk0",
    "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mattsse",
    "html_url": "https://github.com/mattsse",
    "followers_url": "https://api.github.com/users/mattsse/followers",
    "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
    "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
    "organizations_url": "https://api.github.com/users/mattsse/orgs",
    "repos_url": "https://api.github.com/users/mattsse/repos",
    "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mattsse/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3553/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3553/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1292350689",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3553#issuecomment-1292350689",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3553",
    "id": 1292350689,
    "node_id": "IC_kwDOGBlvNc5NB7Th",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-26T17:09:26Z",
    "updated_at": "2022-10-26T17:09:39Z",
    "author_association": "MEMBER",
    "body": "@rkrasiuk anything comes to mind that might have caused this?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1292350689/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1292397819",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3553#issuecomment-1292397819",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3553",
    "id": 1292397819,
    "node_id": "IC_kwDOGBlvNc5NCGz7",
    "user": {
      "login": "rkrasiuk",
      "id": 25429261,
      "node_id": "MDQ6VXNlcjI1NDI5MjYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25429261?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rkrasiuk",
      "html_url": "https://github.com/rkrasiuk",
      "followers_url": "https://api.github.com/users/rkrasiuk/followers",
      "following_url": "https://api.github.com/users/rkrasiuk/following{/other_user}",
      "gists_url": "https://api.github.com/users/rkrasiuk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rkrasiuk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rkrasiuk/subscriptions",
      "organizations_url": "https://api.github.com/users/rkrasiuk/orgs",
      "repos_url": "https://api.github.com/users/rkrasiuk/repos",
      "events_url": "https://api.github.com/users/rkrasiuk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rkrasiuk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-26T17:50:45Z",
    "updated_at": "2022-10-26T17:50:45Z",
    "author_association": "COLLABORATOR",
    "body": "@mattsse nothing obvious comes to mind. dyk of any graph resolution changes in ethers that might've caused this? also, arbiscan is hella weird by itself, not a 1-to-1 port of etherscan. @wminshew any chance you observed this on other explorers?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1292397819/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1292427436",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3553#issuecomment-1292427436",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3553",
    "id": 1292427436,
    "node_id": "IC_kwDOGBlvNc5NCOCs",
    "user": {
      "login": "wminshew",
      "id": 9845502,
      "node_id": "MDQ6VXNlcjk4NDU1MDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9845502?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wminshew",
      "html_url": "https://github.com/wminshew",
      "followers_url": "https://api.github.com/users/wminshew/followers",
      "following_url": "https://api.github.com/users/wminshew/following{/other_user}",
      "gists_url": "https://api.github.com/users/wminshew/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wminshew/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wminshew/subscriptions",
      "organizations_url": "https://api.github.com/users/wminshew/orgs",
      "repos_url": "https://api.github.com/users/wminshew/repos",
      "events_url": "https://api.github.com/users/wminshew/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wminshew/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-26T18:19:48Z",
    "updated_at": "2022-10-26T18:19:48Z",
    "author_association": "NONE",
    "body": "@rkrasiuk yes, can see everything deployed/verified by foundry in a more recent repo mirrors the new/bad arbiscan pattern above:\r\n\r\n[repo](https://github.com/0xSplits/splits-liquid)\r\n[etherscan](https://etherscan.io/address/0xdecd8b99b7f763e16141450daa5ea414b7994831#code)\r\n[other flavors of etherscan](https://blockscan.com/address/0xdecd8b99b7f763e16141450daa5ea414b7994831)\r\n\r\npotentially related / worth mentioning, in both repos (waterfall in the og links & liquid in the above links) the `--verify` flag wasn't working w `forge script` (I assume bc of deterministic deployment? but I didn't dig into it) so all of these were verified w separate `verify-contract` calls",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1292427436/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1386479147",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3553#issuecomment-1386479147",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3553",
    "id": 1386479147,
    "node_id": "IC_kwDOGBlvNc5So_4r",
    "user": {
      "login": "wminshew",
      "id": 9845502,
      "node_id": "MDQ6VXNlcjk4NDU1MDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9845502?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wminshew",
      "html_url": "https://github.com/wminshew",
      "followers_url": "https://api.github.com/users/wminshew/followers",
      "following_url": "https://api.github.com/users/wminshew/following{/other_user}",
      "gists_url": "https://api.github.com/users/wminshew/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wminshew/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wminshew/subscriptions",
      "organizations_url": "https://api.github.com/users/wminshew/orgs",
      "repos_url": "https://api.github.com/users/wminshew/repos",
      "events_url": "https://api.github.com/users/wminshew/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wminshew/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-18T04:42:47Z",
    "updated_at": "2023-01-18T04:42:47Z",
    "author_association": "NONE",
    "body": "appears to still be the case https://gnosisscan.io/address/0x1a1314121b06f1e358eec90e76e459a679c88863#code\r\n\r\n(also `--verify` still doesn't work w script)",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1386479147/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1498320665",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3553#issuecomment-1498320665",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3553",
    "id": 1498320665,
    "node_id": "IC_kwDOGBlvNc5ZTo8Z",
    "user": {
      "login": "mpeyfuss",
      "id": 82735893,
      "node_id": "MDQ6VXNlcjgyNzM1ODkz",
      "avatar_url": "https://avatars.githubusercontent.com/u/82735893?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mpeyfuss",
      "html_url": "https://github.com/mpeyfuss",
      "followers_url": "https://api.github.com/users/mpeyfuss/followers",
      "following_url": "https://api.github.com/users/mpeyfuss/following{/other_user}",
      "gists_url": "https://api.github.com/users/mpeyfuss/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mpeyfuss/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mpeyfuss/subscriptions",
      "organizations_url": "https://api.github.com/users/mpeyfuss/orgs",
      "repos_url": "https://api.github.com/users/mpeyfuss/repos",
      "events_url": "https://api.github.com/users/mpeyfuss/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mpeyfuss/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-06T00:16:06Z",
    "updated_at": "2023-04-06T00:16:06Z",
    "author_association": "NONE",
    "body": "I looked into this a bit more since it's been bugging me. Not super familiar with rust so I can't pinpoint exactly what's going on but this is what I've found.\r\n\r\nI had a friend using commit `1d9a34e` deploy and verify a multipart contract and it resulted in a good example. Same commit on my machine resulted in a bad example for the same contract.\r\n\r\nLooking at the build info (JSON standard input), it looks like the sources are ordered opposite. The build info was retrieved using `forge build --build-info`.\r\n\r\nIt feels crazy but is there machine dependent ordering of the source list in the JSON standard input? Block explorers take the list supplied as is and that determines the order of the files shown.\r\n\r\nI'll keep looking into this but hopefully this sparks some inspiration and hopefully we can close out this issue. Perhaps @rkrasiuk this helps ðŸ¤ž ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1498320665/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1498740788",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3553#issuecomment-1498740788",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3553",
    "id": 1498740788,
    "node_id": "IC_kwDOGBlvNc5ZVPg0",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-06T09:13:18Z",
    "updated_at": "2023-04-06T09:13:18Z",
    "author_association": "MEMBER",
    "body": "sorry totally forgot about this one, turns out we were sorting alphabetically again\r\n\r\nwill be fixed by #4698",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1498740788/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 2,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1499148896",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3553#issuecomment-1499148896",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3553",
    "id": 1499148896,
    "node_id": "IC_kwDOGBlvNc5ZWzJg",
    "user": {
      "login": "mpeyfuss",
      "id": 82735893,
      "node_id": "MDQ6VXNlcjgyNzM1ODkz",
      "avatar_url": "https://avatars.githubusercontent.com/u/82735893?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mpeyfuss",
      "html_url": "https://github.com/mpeyfuss",
      "followers_url": "https://api.github.com/users/mpeyfuss/followers",
      "following_url": "https://api.github.com/users/mpeyfuss/following{/other_user}",
      "gists_url": "https://api.github.com/users/mpeyfuss/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mpeyfuss/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mpeyfuss/subscriptions",
      "organizations_url": "https://api.github.com/users/mpeyfuss/orgs",
      "repos_url": "https://api.github.com/users/mpeyfuss/repos",
      "events_url": "https://api.github.com/users/mpeyfuss/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mpeyfuss/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-06T14:23:31Z",
    "updated_at": "2023-04-06T14:23:31Z",
    "author_association": "NONE",
    "body": "ah this makes a ton of sense. Thanks friend!",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1499148896/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
