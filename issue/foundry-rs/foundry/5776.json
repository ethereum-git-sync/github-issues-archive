{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/5776",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5776/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5776/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5776/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/5776",
  "id": 1878487666,
  "node_id": "I_kwDOGBlvNc5v93Jy",
  "number": 5776,
  "title": "Slow mode and skip simulation for script don't work",
  "user": {
    "login": "beeb",
    "id": 703631,
    "node_id": "MDQ6VXNlcjcwMzYzMQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/703631?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/beeb",
    "html_url": "https://github.com/beeb",
    "followers_url": "https://api.github.com/users/beeb/followers",
    "following_url": "https://api.github.com/users/beeb/following{/other_user}",
    "gists_url": "https://api.github.com/users/beeb/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/beeb/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/beeb/subscriptions",
    "organizations_url": "https://api.github.com/users/beeb/orgs",
    "repos_url": "https://api.github.com/users/beeb/repos",
    "events_url": "https://api.github.com/users/beeb/events{/privacy}",
    "received_events_url": "https://api.github.com/users/beeb/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "Evalir",
    "id": 26014927,
    "node_id": "MDQ6VXNlcjI2MDE0OTI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Evalir",
    "html_url": "https://github.com/Evalir",
    "followers_url": "https://api.github.com/users/Evalir/followers",
    "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
    "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
    "organizations_url": "https://api.github.com/users/Evalir/orgs",
    "repos_url": "https://api.github.com/users/Evalir/repos",
    "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Evalir/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "Evalir",
      "id": 26014927,
      "node_id": "MDQ6VXNlcjI2MDE0OTI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Evalir",
      "html_url": "https://github.com/Evalir",
      "followers_url": "https://api.github.com/users/Evalir/followers",
      "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
      "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
      "organizations_url": "https://api.github.com/users/Evalir/orgs",
      "repos_url": "https://api.github.com/users/Evalir/repos",
      "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Evalir/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 11,
  "created_at": "2023-09-02T08:34:29Z",
  "updated_at": "2023-12-23T17:00:19Z",
  "closed_at": "2023-12-22T06:17:44Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Have you ensured that all of these are up to date?\r\n\r\n- [X] Foundry\r\n- [X] Foundryup\r\n\r\n### What version of Foundry are you on?\r\n\r\nforge 0.2.0 (2f4a77e 2023-08-31T00:32:46.319290372Z)\r\n\r\n### What command(s) is the bug in?\r\n\r\nforge script\r\n\r\n### Operating System\r\n\r\nLinux\r\n\r\n### Describe the bug\r\n\r\nI'm trying to run multiple transactions in subsequent blocks as part of a single script run.\r\n\r\nI came accross the `--slow` argument which is supposed to do that, and I found [a PR](https://github.com/foundry-rs/foundry/pull/2481) that described that it would skip blocks between transactions in simulation mode.\r\n\r\nHowever, when I try to run the script below with `--slow`, the second call reverts (meaning it's in the same block as the first one).\r\n\r\nWhat's more, when trying to actually run the script with broadcast on testnet, I can't get past the simulation with the `--skip-simulation` argument and no transaction is broadcast at all (not even the contract deployment).\r\n\r\n```solidity\r\n// script/Bug.sol\r\n// SPDX-License-Identifier: UNLICENSED\r\npragma solidity 0.8.20;\r\n\r\nimport { Script, console2 } from \"forge-std/Script.sol\";\r\n\r\ncontract Test {\r\n    uint256 public lastBlock;\r\n\r\n    function test() external {\r\n        if (lastBlock == block.number) {\r\n            revert();\r\n        }\r\n        lastBlock = block.number;\r\n    }\r\n}\r\n\r\n/// Run with `forge script --slow --rpc-url sepolia script/Bug.sol:MyScript`\r\ncontract MyScript is Script {\r\n    function run() public {\r\n        uint256 deployerPrivateKey = vm.envUint(\"DEPLOYER_PRIVATE_KEY\");\r\n        vm.startBroadcast(deployerPrivateKey);\r\n        Test test = new Test();\r\n\r\n        for (uint256 i = 0; i < 10; i++) {\r\n            console2.log(block.number);\r\n            test.test();\r\n        }\r\n\r\n        console2.log(test.lastBlock());\r\n        vm.stopBroadcast();\r\n    }\r\n}\r\n```\r\n\r\n```\r\nTraces:\r\n  [282344] → new MyScript@0x5b73C5498c1E3b4dbA84de0F1833c4a029d90519\r\n    └─ ← 1189 bytes of code\r\n\r\n  [115630] MyScript::run() \r\n    ├─ [0] VM::envUint(DEPLOYER_PRIVATE_KEY) [staticcall]\r\n    │   └─ ← <env var value>\r\n    ├─ [0] VM::startBroadcast(<pk>) \r\n    │   └─ ← ()\r\n    ├─ [32487] → new Test@0x953f8C492E577E471F4C72e10D02a7f1893a011C\r\n    │   └─ ← 162 bytes of code\r\n    ├─ [0] console::log(4209527 [4.209e6]) [staticcall]\r\n    │   └─ ← ()\r\n    ├─ [22271] Test::test() \r\n    │   └─ ← ()\r\n    ├─ [0] console::log(4209527 [4.209e6]) [staticcall]\r\n    │   └─ ← ()\r\n    ├─ [262] Test::test() \r\n    │   └─ ← \"EvmError: Revert\"\r\n    └─ ← \"EvmError: Revert\"\r\n\r\n\r\n\r\n== Logs ==\r\n  4209527\r\n  4209527\r\n```",
  "closed_by": {
    "login": "Evalir",
    "id": 26014927,
    "node_id": "MDQ6VXNlcjI2MDE0OTI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Evalir",
    "html_url": "https://github.com/Evalir",
    "followers_url": "https://api.github.com/users/Evalir/followers",
    "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
    "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
    "organizations_url": "https://api.github.com/users/Evalir/orgs",
    "repos_url": "https://api.github.com/users/Evalir/repos",
    "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Evalir/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/5776/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5776/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1703768585",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5776#issuecomment-1703768585",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5776",
    "id": 1703768585,
    "node_id": "IC_kwDOGBlvNc5ljXIJ",
    "user": {
      "login": "beeb",
      "id": 703631,
      "node_id": "MDQ6VXNlcjcwMzYzMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/703631?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/beeb",
      "html_url": "https://github.com/beeb",
      "followers_url": "https://api.github.com/users/beeb/followers",
      "following_url": "https://api.github.com/users/beeb/following{/other_user}",
      "gists_url": "https://api.github.com/users/beeb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/beeb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/beeb/subscriptions",
      "organizations_url": "https://api.github.com/users/beeb/orgs",
      "repos_url": "https://api.github.com/users/beeb/repos",
      "events_url": "https://api.github.com/users/beeb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/beeb/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-02T08:52:05Z",
    "updated_at": "2023-09-02T08:52:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "I just found another reported issue with `script` CLI arguments, maybe related (if the command ignores some arguments altogether) https://github.com/foundry-rs/foundry/issues/5709",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1703768585/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1707158923",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5776#issuecomment-1707158923",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5776",
    "id": 1707158923,
    "node_id": "IC_kwDOGBlvNc5lwS2L",
    "user": {
      "login": "emo-eth",
      "id": 6371847,
      "node_id": "MDQ6VXNlcjYzNzE4NDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6371847?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emo-eth",
      "html_url": "https://github.com/emo-eth",
      "followers_url": "https://api.github.com/users/emo-eth/followers",
      "following_url": "https://api.github.com/users/emo-eth/following{/other_user}",
      "gists_url": "https://api.github.com/users/emo-eth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emo-eth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emo-eth/subscriptions",
      "organizations_url": "https://api.github.com/users/emo-eth/orgs",
      "repos_url": "https://api.github.com/users/emo-eth/repos",
      "events_url": "https://api.github.com/users/emo-eth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emo-eth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-05T18:56:25Z",
    "updated_at": "2023-09-05T18:56:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "I can also report that `--skip-simulation` is not working on my end.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1707158923/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1710706808",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5776#issuecomment-1710706808",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5776",
    "id": 1710706808,
    "node_id": "IC_kwDOGBlvNc5l91B4",
    "user": {
      "login": "imthatcarlos",
      "id": 20136572,
      "node_id": "MDQ6VXNlcjIwMTM2NTcy",
      "avatar_url": "https://avatars.githubusercontent.com/u/20136572?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/imthatcarlos",
      "html_url": "https://github.com/imthatcarlos",
      "followers_url": "https://api.github.com/users/imthatcarlos/followers",
      "following_url": "https://api.github.com/users/imthatcarlos/following{/other_user}",
      "gists_url": "https://api.github.com/users/imthatcarlos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/imthatcarlos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/imthatcarlos/subscriptions",
      "organizations_url": "https://api.github.com/users/imthatcarlos/orgs",
      "repos_url": "https://api.github.com/users/imthatcarlos/repos",
      "events_url": "https://api.github.com/users/imthatcarlos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/imthatcarlos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-07T20:06:22Z",
    "updated_at": "2023-09-07T20:06:22Z",
    "author_association": "NONE",
    "body": "same, `--skip-simulation` stopped working a few days ago",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1710706808/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1711026955",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5776#issuecomment-1711026955",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5776",
    "id": 1711026955,
    "node_id": "IC_kwDOGBlvNc5l_DML",
    "user": {
      "login": "Sabnock01",
      "id": 24715302,
      "node_id": "MDQ6VXNlcjI0NzE1MzAy",
      "avatar_url": "https://avatars.githubusercontent.com/u/24715302?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sabnock01",
      "html_url": "https://github.com/Sabnock01",
      "followers_url": "https://api.github.com/users/Sabnock01/followers",
      "following_url": "https://api.github.com/users/Sabnock01/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sabnock01/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sabnock01/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sabnock01/subscriptions",
      "organizations_url": "https://api.github.com/users/Sabnock01/orgs",
      "repos_url": "https://api.github.com/users/Sabnock01/repos",
      "events_url": "https://api.github.com/users/Sabnock01/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sabnock01/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-08T03:33:22Z",
    "updated_at": "2023-09-08T03:33:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "@DaniPopes my hunch is that this is related to the recent directory reorg? ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1711026955/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1713903435",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5776#issuecomment-1713903435",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5776",
    "id": 1713903435,
    "node_id": "IC_kwDOGBlvNc5mKBdL",
    "user": {
      "login": "Evalir",
      "id": 26014927,
      "node_id": "MDQ6VXNlcjI2MDE0OTI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Evalir",
      "html_url": "https://github.com/Evalir",
      "followers_url": "https://api.github.com/users/Evalir/followers",
      "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
      "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
      "organizations_url": "https://api.github.com/users/Evalir/orgs",
      "repos_url": "https://api.github.com/users/Evalir/repos",
      "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Evalir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-11T13:38:25Z",
    "updated_at": "2023-09-11T13:38:25Z",
    "author_association": "MEMBER",
    "body": "Looking at this",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1713903435/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1714220460",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5776#issuecomment-1714220460",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5776",
    "id": 1714220460,
    "node_id": "IC_kwDOGBlvNc5mLO2s",
    "user": {
      "login": "Evalir",
      "id": 26014927,
      "node_id": "MDQ6VXNlcjI2MDE0OTI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Evalir",
      "html_url": "https://github.com/Evalir",
      "followers_url": "https://api.github.com/users/Evalir/followers",
      "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
      "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
      "organizations_url": "https://api.github.com/users/Evalir/orgs",
      "repos_url": "https://api.github.com/users/Evalir/repos",
      "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Evalir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-11T16:31:25Z",
    "updated_at": "2023-09-11T16:31:25Z",
    "author_association": "MEMBER",
    "body": "hi all! tried to quickly repro but can't neither repro `--skip-simulation` nor `--slow` not working. Is it possible for y'all to post a more minimal repro?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1714220460/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1714325740",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5776#issuecomment-1714325740",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5776",
    "id": 1714325740,
    "node_id": "IC_kwDOGBlvNc5mLojs",
    "user": {
      "login": "beeb",
      "id": 703631,
      "node_id": "MDQ6VXNlcjcwMzYzMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/703631?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/beeb",
      "html_url": "https://github.com/beeb",
      "followers_url": "https://api.github.com/users/beeb/followers",
      "following_url": "https://api.github.com/users/beeb/following{/other_user}",
      "gists_url": "https://api.github.com/users/beeb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/beeb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/beeb/subscriptions",
      "organizations_url": "https://api.github.com/users/beeb/orgs",
      "repos_url": "https://api.github.com/users/beeb/repos",
      "events_url": "https://api.github.com/users/beeb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/beeb/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-11T17:46:25Z",
    "updated_at": "2023-09-11T17:51:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Is it possible for y'all to post a more minimal repro?\r\n\r\n@Evalir my repro is a small as it gets, one single file that you can run against a sepolia fork (I use an alias in my foundry.toml, see below).\r\n\r\n```console\r\nforge script --slow --rpc-url sepolia script/Bug.sol:MyScript\r\n```\r\n\r\nThe script above should NOT revert. The error is clearly shown in the logs: the first and second call to `test()` happen in the same block.\r\n\r\n```toml\r\n# foundry.toml\r\n[rpc_endpoints]\r\nsepolia = \"https://sepolia.gateway.tenderly.co\"\r\n```\r\n\r\nWhich version did you use? I just reproduced now with `forge 0.2.0 (5cfed63 2023-09-11T00:24:34.136213513Z)`",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1714325740/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1859446270",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5776#issuecomment-1859446270",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5776",
    "id": 1859446270,
    "node_id": "IC_kwDOGBlvNc5u1OX-",
    "user": {
      "login": "adu-web3",
      "id": 25078682,
      "node_id": "MDQ6VXNlcjI1MDc4Njgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/25078682?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/adu-web3",
      "html_url": "https://github.com/adu-web3",
      "followers_url": "https://api.github.com/users/adu-web3/followers",
      "following_url": "https://api.github.com/users/adu-web3/following{/other_user}",
      "gists_url": "https://api.github.com/users/adu-web3/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/adu-web3/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adu-web3/subscriptions",
      "organizations_url": "https://api.github.com/users/adu-web3/orgs",
      "repos_url": "https://api.github.com/users/adu-web3/repos",
      "events_url": "https://api.github.com/users/adu-web3/events{/privacy}",
      "received_events_url": "https://api.github.com/users/adu-web3/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-12-18T02:28:28Z",
    "updated_at": "2023-12-18T02:28:28Z",
    "author_association": "NONE",
    "body": "Hi, do you have any workaround to enable skip local simulation? simulation is good but not friendly to evm chains with precompiles\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1859446270/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1860450966",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5776#issuecomment-1860450966",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5776",
    "id": 1860450966,
    "node_id": "IC_kwDOGBlvNc5u5DqW",
    "user": {
      "login": "adu-web3",
      "id": 25078682,
      "node_id": "MDQ6VXNlcjI1MDc4Njgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/25078682?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/adu-web3",
      "html_url": "https://github.com/adu-web3",
      "followers_url": "https://api.github.com/users/adu-web3/followers",
      "following_url": "https://api.github.com/users/adu-web3/following{/other_user}",
      "gists_url": "https://api.github.com/users/adu-web3/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/adu-web3/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adu-web3/subscriptions",
      "organizations_url": "https://api.github.com/users/adu-web3/orgs",
      "repos_url": "https://api.github.com/users/adu-web3/repos",
      "events_url": "https://api.github.com/users/adu-web3/events{/privacy}",
      "received_events_url": "https://api.github.com/users/adu-web3/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-12-18T13:06:04Z",
    "updated_at": "2023-12-18T13:06:04Z",
    "author_association": "NONE",
    "body": "@Evalir Hi sir, have you investigated into this problem? I'd like to help if anybody could share some insights on this",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1860450966/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1867287499",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5776#issuecomment-1867287499",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5776",
    "id": 1867287499,
    "node_id": "IC_kwDOGBlvNc5vTIvL",
    "user": {
      "login": "Evalir",
      "id": 26014927,
      "node_id": "MDQ6VXNlcjI2MDE0OTI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Evalir",
      "html_url": "https://github.com/Evalir",
      "followers_url": "https://api.github.com/users/Evalir/followers",
      "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
      "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
      "organizations_url": "https://api.github.com/users/Evalir/orgs",
      "repos_url": "https://api.github.com/users/Evalir/repos",
      "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Evalir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-12-22T06:17:44Z",
    "updated_at": "2023-12-22T06:17:44Z",
    "author_association": "MEMBER",
    "body": "So, coming back to this @beeb / @adu-web3:\r\n\r\nSlow mode and skip simulation _both work as intended_. What is happening here, and what happens with chains with custom precompiles, is a script limitation:\r\n-  `--skip-simulation` avoids using the provided URL to do gas estimation. It *does not prevent foundry from simulating the script locally*. The latter is not possible to disable, as we must simulate the script to gather all the transactions to broadcast. If the local simulation fails, the whole script fails.\r\n  - Right now it is _impossible_ for `forge script` to simulate block changes, as we don't have safe evm manipulation cheatcodes for scripts (`warp`/`roll` equivalents) and foundry tests/simulations are run as a single transaction. This means that simulating this script locally is impossible. It works as intended if you remove the `block.number` check and use `slow`.\r\n- `--slow` does simulate mining if it's an onchain simulation. This is not the case for the unskippable local simulation. While this does mean that checking for block changes locally on scripts is impossible, it's still possible to create scripts that depend on transactions being mined, as the `--slow` flag will simulate this on-chain, and wait for tx receipts before sending the next tx in the sequence.\r\n\r\nAs a result, I'm going to close _this_ specific issue as it's misleading (it does work), but it's a limitation which we should remove in a future script refactor and I'll document this in a new issue.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1867287499/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1868331425",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5776#issuecomment-1868331425",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5776",
    "id": 1868331425,
    "node_id": "IC_kwDOGBlvNc5vXHmh",
    "user": {
      "login": "beeb",
      "id": 703631,
      "node_id": "MDQ6VXNlcjcwMzYzMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/703631?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/beeb",
      "html_url": "https://github.com/beeb",
      "followers_url": "https://api.github.com/users/beeb/followers",
      "following_url": "https://api.github.com/users/beeb/following{/other_user}",
      "gists_url": "https://api.github.com/users/beeb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/beeb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/beeb/subscriptions",
      "organizations_url": "https://api.github.com/users/beeb/orgs",
      "repos_url": "https://api.github.com/users/beeb/repos",
      "events_url": "https://api.github.com/users/beeb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/beeb/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-12-23T17:00:17Z",
    "updated_at": "2023-12-23T17:00:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hey @Evalir , thanks for the in-depth explanation.\r\n\r\nSo if I understand correctly, it's not currently possible to run with broadcast a script where each transaction must happen in a separate block due to a revert condition? The internal simulation of the script, which cannot be disabled, would fail and so the transaction discovery could not be done.\r\n\r\nLet's hope a future refactor of the evm simulation makes this possible, as this would enable some deployments with safety locks preventing two transactions from being in the same block.\r\n\r\nCheers\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1868331425/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
