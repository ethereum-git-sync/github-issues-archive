{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3880",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3880/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3880/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3880/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/3880",
  "id": 1492040536,
  "node_id": "I_kwDOGBlvNc5Y7rtY",
  "number": 3880,
  "title": "\"Transaction dropped from memory pool\" when transaction is successful on-chain",
  "user": {
    "login": "aliceho",
    "id": 10519421,
    "node_id": "MDQ6VXNlcjEwNTE5NDIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/10519421?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/aliceho",
    "html_url": "https://github.com/aliceho",
    "followers_url": "https://api.github.com/users/aliceho/followers",
    "following_url": "https://api.github.com/users/aliceho/following{/other_user}",
    "gists_url": "https://api.github.com/users/aliceho/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/aliceho/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/aliceho/subscriptions",
    "organizations_url": "https://api.github.com/users/aliceho/orgs",
    "repos_url": "https://api.github.com/users/aliceho/repos",
    "events_url": "https://api.github.com/users/aliceho/events{/privacy}",
    "received_events_url": "https://api.github.com/users/aliceho/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    },
    {
      "id": 3703752787,
      "node_id": "LA_kwDOGBlvNc7cwshT",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-forge",
      "name": "C-forge",
      "color": "5319E7",
      "default": false,
      "description": "Command: forge"
    },
    {
      "id": 4182991461,
      "node_id": "LA_kwDOGBlvNc75U2Jl",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/Cmd-forge-script",
      "name": "Cmd-forge-script",
      "color": "006B75",
      "default": false,
      "description": "Command: forge script"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2022-12-12T14:39:57Z",
  "updated_at": "2023-02-16T06:59:24Z",
  "closed_at": "2023-01-03T13:53:37Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Have you ensured that all of these are up to date?\r\n\r\n- [X] Foundry\r\n- [X] Foundryup\r\n\r\n### What version of Foundry are you on?\r\n\r\n0.2.0\r\n\r\n### What command(s) is the bug in?\r\n\r\nforge script forge-scripts/deploy_contracts.sol \\     --rpc-url $RPC \\     --private-key $PRIVATE_KEY \\     --broadcast\r\n\r\n### Operating System\r\n\r\nmacOS (Apple Silicon)\r\n\r\n### Describe the bug\r\n\r\nwhile running the command the error received is :\r\nTransaction dropped from the mempool: 0xaa6d6cf356d14eaed26585cdacc143087a7b2271cb03b1a845554ad91a7ea88b\r\nTransaction dropped from the mempool: 0x9711633969b6cc81a9983c44db9c09e4d2aae2c2e68b31af20e849a76c74aedb\r\n\r\n\r\nBut when checked on https://testnet.snowtrace.io/ these transaction hash show successful transaction.\r\n\r\nAnd after the script is updated to \"forge script forge-scripts/deploy_contracts.sol \\\r\n    --rpc-url $RPC \\\r\n    --private-key $PRIVATE_KEY \\\r\n    --broadcast --resume\" to resume the transaction  the error received is (code: -32000, message: nonce too low: address 0xC470686e8cb845246DCDF5BCcAf509883A4859AE current nonce (7) > tx nonce (6), data: None)",
  "closed_by": {
    "login": "joshieDo",
    "id": 93316087,
    "node_id": "U_kgDOBY_j9w",
    "avatar_url": "https://avatars.githubusercontent.com/u/93316087?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/joshieDo",
    "html_url": "https://github.com/joshieDo",
    "followers_url": "https://api.github.com/users/joshieDo/followers",
    "following_url": "https://api.github.com/users/joshieDo/following{/other_user}",
    "gists_url": "https://api.github.com/users/joshieDo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/joshieDo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/joshieDo/subscriptions",
    "organizations_url": "https://api.github.com/users/joshieDo/orgs",
    "repos_url": "https://api.github.com/users/joshieDo/repos",
    "events_url": "https://api.github.com/users/joshieDo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/joshieDo/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3880/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3880/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1362957624",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3880#issuecomment-1362957624",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3880",
    "id": 1362957624,
    "node_id": "IC_kwDOGBlvNc5RPRU4",
    "user": {
      "login": "drgorillamd",
      "id": 83670532,
      "node_id": "MDQ6VXNlcjgzNjcwNTMy",
      "avatar_url": "https://avatars.githubusercontent.com/u/83670532?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/drgorillamd",
      "html_url": "https://github.com/drgorillamd",
      "followers_url": "https://api.github.com/users/drgorillamd/followers",
      "following_url": "https://api.github.com/users/drgorillamd/following{/other_user}",
      "gists_url": "https://api.github.com/users/drgorillamd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/drgorillamd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/drgorillamd/subscriptions",
      "organizations_url": "https://api.github.com/users/drgorillamd/orgs",
      "repos_url": "https://api.github.com/users/drgorillamd/repos",
      "events_url": "https://api.github.com/users/drgorillamd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/drgorillamd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-22T15:13:41Z",
    "updated_at": "2022-12-22T15:13:41Z",
    "author_association": "NONE",
    "body": "Same behaviour,\r\nUbuntu 22.04\r\n\r\nfoundryup: installed - forge 0.2.0 (8c4294c 2022-12-22T00:03:55.083004205Z)\r\nfoundryup: installed - cast 0.2.0 (8c4294c 2022-12-22T00:03:55.083004205Z)\r\nfoundryup: installed - anvil 0.1.0 (8c4294c 2022-12-22T00:04:20.109568457Z)\r\n\r\nI'm deploying 5 contracts, only the last 2 or 3 tx are incorrectly flagged as dropped (and have no receipt in the broadcast json)\r\n\r\n@aliceho if needed, for me, this consistently happened with Infura -> changing rpc provider (Ankr) fixed it!\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1362957624/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1365490295",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3880#issuecomment-1365490295",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3880",
    "id": 1365490295,
    "node_id": "IC_kwDOGBlvNc5RY7p3",
    "user": {
      "login": "jameswenzel",
      "id": 6371847,
      "node_id": "MDQ6VXNlcjYzNzE4NDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6371847?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jameswenzel",
      "html_url": "https://github.com/jameswenzel",
      "followers_url": "https://api.github.com/users/jameswenzel/followers",
      "following_url": "https://api.github.com/users/jameswenzel/following{/other_user}",
      "gists_url": "https://api.github.com/users/jameswenzel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jameswenzel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jameswenzel/subscriptions",
      "organizations_url": "https://api.github.com/users/jameswenzel/orgs",
      "repos_url": "https://api.github.com/users/jameswenzel/repos",
      "events_url": "https://api.github.com/users/jameswenzel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jameswenzel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-26T22:29:11Z",
    "updated_at": "2022-12-26T22:29:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "Also running into this on Optimism and Optimism Goerli on latest foundry. For N transactions I need to run the script N times. Wonder if it's due to fast block times?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1365490295/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1368993723",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3880#issuecomment-1368993723",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3880",
    "id": 1368993723,
    "node_id": "IC_kwDOGBlvNc5RmS-7",
    "user": {
      "login": "kontrol-apa",
      "id": 97230398,
      "node_id": "U_kgDOBcuePg",
      "avatar_url": "https://avatars.githubusercontent.com/u/97230398?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kontrol-apa",
      "html_url": "https://github.com/kontrol-apa",
      "followers_url": "https://api.github.com/users/kontrol-apa/followers",
      "following_url": "https://api.github.com/users/kontrol-apa/following{/other_user}",
      "gists_url": "https://api.github.com/users/kontrol-apa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kontrol-apa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kontrol-apa/subscriptions",
      "organizations_url": "https://api.github.com/users/kontrol-apa/orgs",
      "repos_url": "https://api.github.com/users/kontrol-apa/repos",
      "events_url": "https://api.github.com/users/kontrol-apa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kontrol-apa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-02T14:28:39Z",
    "updated_at": "2023-01-02T16:58:15Z",
    "author_association": "NONE",
    "body": "I am having the same issue on fuji testnet, exactly as described by @aliceho. ~I havent tried it with a different rpc provider since i am not aware of any easily accessible, free rpc provider for Fuji~. I have tried it with a QuickNode Fuji RPC url but this also didnt help me.\r\n\r\nI have also tried with `--slow`, and the issue still persists.\r\n\r\nSending only 1 tx per `forge script ...` run seems to **sometimes** remedy this but it really is cumbersome to deploy multiple contracts this way. \r\n\r\nIt seems like the dropped tx always goes thru (in N transactions the very first one seems to always go thru) but my main problem is the verification. It directly fails in a dropped tx scenario and manually verifying (even with forge verify-contract) is quite tedious work.  ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1368993723/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1369794878",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3880#issuecomment-1369794878",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3880",
    "id": 1369794878,
    "node_id": "IC_kwDOGBlvNc5RpWk-",
    "user": {
      "login": "joshieDo",
      "id": 93316087,
      "node_id": "U_kgDOBY_j9w",
      "avatar_url": "https://avatars.githubusercontent.com/u/93316087?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/joshieDo",
      "html_url": "https://github.com/joshieDo",
      "followers_url": "https://api.github.com/users/joshieDo/followers",
      "following_url": "https://api.github.com/users/joshieDo/following{/other_user}",
      "gists_url": "https://api.github.com/users/joshieDo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/joshieDo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/joshieDo/subscriptions",
      "organizations_url": "https://api.github.com/users/joshieDo/orgs",
      "repos_url": "https://api.github.com/users/joshieDo/repos",
      "events_url": "https://api.github.com/users/joshieDo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/joshieDo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-03T13:53:37Z",
    "updated_at": "2023-01-03T13:53:37Z",
    "author_association": "COLLABORATOR",
    "body": "fixed by #4010 ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1369794878/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 2,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1432613850",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3880#issuecomment-1432613850",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3880",
    "id": 1432613850,
    "node_id": "IC_kwDOGBlvNc5VY_Pa",
    "user": {
      "login": "Rizary",
      "id": 7221768,
      "node_id": "MDQ6VXNlcjcyMjE3Njg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7221768?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Rizary",
      "html_url": "https://github.com/Rizary",
      "followers_url": "https://api.github.com/users/Rizary/followers",
      "following_url": "https://api.github.com/users/Rizary/following{/other_user}",
      "gists_url": "https://api.github.com/users/Rizary/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Rizary/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Rizary/subscriptions",
      "organizations_url": "https://api.github.com/users/Rizary/orgs",
      "repos_url": "https://api.github.com/users/Rizary/repos",
      "events_url": "https://api.github.com/users/Rizary/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Rizary/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-16T06:59:24Z",
    "updated_at": "2023-02-16T06:59:24Z",
    "author_association": "NONE",
    "body": "@joshieDo I still got the error. Here's the error says:\r\n```bash\r\nTransactions saved to: /home/rizary/smart-contract/broadcast/Deploy.s.sol/80001/run-latest.json\r\n\r\nError: \r\nTransaction dropped from the mempool: 0xc6a1f6cec634ad525bd75c916224fb594621113235b5c276c6f8dc5977b1a1e3\r\n```\r\n\r\nhere's my Deploy.s.sol script\r\n\r\n```solidity\r\npragma solidity ^0.8.15;\r\n\r\nimport \"forge-std/Script.sol\";\r\nimport \"../src/1.0/FractionalizedNFT.sol\";\r\nimport \"../src/1.0/FractionToken.sol\";\r\nimport \"../src/1.0/SoonanTsoorNFT.sol\";\r\nimport \"../src/1.0/StakingFractionNFT.sol\";\r\n\r\ncontract Deploy is Script {\r\n    address public fractionalizedNFT;\r\n    address public fractionToken;\r\n    address public soonanTsoorNFT;\r\n    address public stakingFractionNFT;\r\n    address public USDCAddress;\r\n\r\n    constructor() Script() {\r\n    }\r\n\r\n    function run() external {\r\n        USDCAddress = vm.envAddress(\"USDC_ADDRESS\");\r\n        vm.startBroadcast();\r\n        // deploy SoonanTsoorNFT contract\r\n        SoonanTsoorNFT soonanTsoorNFTContract = new SoonanTsoorNFT(USDCAddress);\r\n        soonanTsoorNFT = address(soonanTsoorNFTContract);\r\n        \r\n        FractionToken fractionTokenContract = new FractionToken();\r\n        fractionToken = address(fractionTokenContract);\r\n\r\n        // deploy FractionalizedNFT contract\r\n        FractionalizedNFT fractionalizedNFTContract = new FractionalizedNFT(fractionToken, soonanTsoorNFT, USDCAddress);\r\n        fractionalizedNFT = address(fractionalizedNFTContract);\r\n\r\n        // deploy StakingFractionNFT contract\r\n        StakingFractionNFT stakingFractionNFTContract = new StakingFractionNFT();\r\n        stakingFractionNFT = address(stakingFractionNFTContract);\r\n        \r\n        vm.stopBroadcast();\r\n    }\r\n}\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1432613850/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
