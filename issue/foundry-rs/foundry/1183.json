{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/1183",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1183/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1183/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1183/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/1183",
  "id": 1191135300,
  "node_id": "I_kwDOGBlvNc5G_0hE",
  "number": 1183,
  "title": "Flaky: Text file busy (os error 26)",
  "user": {
    "login": "claysauruswrecks",
    "id": 44852834,
    "node_id": "MDQ6VXNlcjQ0ODUyODM0",
    "avatar_url": "https://avatars.githubusercontent.com/u/44852834?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/claysauruswrecks",
    "html_url": "https://github.com/claysauruswrecks",
    "followers_url": "https://api.github.com/users/claysauruswrecks/followers",
    "following_url": "https://api.github.com/users/claysauruswrecks/following{/other_user}",
    "gists_url": "https://api.github.com/users/claysauruswrecks/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/claysauruswrecks/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/claysauruswrecks/subscriptions",
    "organizations_url": "https://api.github.com/users/claysauruswrecks/orgs",
    "repos_url": "https://api.github.com/users/claysauruswrecks/repos",
    "events_url": "https://api.github.com/users/claysauruswrecks/events{/privacy}",
    "received_events_url": "https://api.github.com/users/claysauruswrecks/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3746533612,
      "node_id": "LA_kwDOGBlvNc7fT5Ds",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-meta",
      "name": "T-meta",
      "color": "BFD4F2",
      "default": false,
      "description": "Type: meta"
    },
    {
      "id": 3759721040,
      "node_id": "LA_kwDOGBlvNc7gGMpQ",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/D-chore",
      "name": "D-chore",
      "color": "0E8A16",
      "default": false,
      "description": "Difficulty: chore"
    },
    {
      "id": 3904002822,
      "node_id": "LA_kwDOGBlvNc7oslsG",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-debt",
      "name": "T-debt",
      "color": "BFD4F2",
      "default": false,
      "description": "Type: code debt"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-04-04T01:33:55Z",
  "updated_at": "2022-06-08T19:29:37Z",
  "closed_at": "2022-06-08T19:29:37Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nOther (please describe)\r\n\r\n### Have you ensured that all of these are up to date?\r\n\r\n- [X] Foundry\r\n- [X] Foundryup\r\n\r\n### What version of Foundry are you on?\r\n\r\nmaster branch 0544afd1949e75c4b44370584433f451c80625b9\r\n\r\n### What command(s) is the bug in?\r\n\r\ncargo test --locked --workspace --test '*'\r\n\r\n### Operating System\r\n\r\nLinux\r\n\r\n### Describe the bug\r\n\r\nSimilar issue mentioned in #442, but I was unable to consistently reproduce the error.\r\nI setup the environment like this:\r\n```\r\ndocker run -it -v $PWD:/opt/foundry/ rust:1-bullseye\r\n```\r\nAnd ran the test suite like this:\r\n```\r\nroot@8ef1dc3ddda5:/opt/foundry# cargo test --locked --workspace --test '*'                 \r\n   Compiling sha2 v0.9.9\r\n   Compiling tungstenite v0.17.2\r\n   Compiling foundry-cli v0.2.0 (/opt/foundry/cli)\r\n   Compiling reqwest v0.11.10\r\n   Compiling k256 v0.10.4\r\n   Compiling coins-core v0.2.2\r\n   Compiling pbkdf2 v0.8.0\r\n   Compiling tokio-tungstenite v0.17.1\r\n   Compiling ethers-core v0.6.0 (https://github.com/gakonst/ethers-rs#110d1bee)\r\n   Compiling coins-bip32 v0.6.0\r\n   Compiling revm_precompiles v0.4.0 (https://github.com/bluealloy/revm#211c83ba)\r\n   Compiling revm v1.2.0 (https://github.com/bluealloy/revm#211c83ba)\r\n   Compiling coins-bip39 v0.6.0\r\n   Compiling svm-rs v0.2.9 (https://github.com/roynalnaruto/svm-rs#a128bea6)\r\n   Compiling svm-rs-builds v0.1.0 (https://github.com/roynalnaruto/svm-rs#a128bea6)\r\n   Compiling ethers-providers v0.6.0 (https://github.com/gakonst/ethers-rs#110d1bee)\r\n   Compiling ethers-contract-abigen v0.6.0 (https://github.com/gakonst/ethers-rs#110d1bee)\r\n   Compiling ethers-signers v0.6.0 (https://github.com/gakonst/ethers-rs#110d1bee)\r\n   Compiling ethers-addressbook v0.1.0 (https://github.com/gakonst/ethers-rs#110d1bee)\r\n   Compiling ethers-contract-derive v0.6.0 (https://github.com/gakonst/ethers-rs#110d1bee)\r\n   Compiling ethers-solc v0.3.0 (https://github.com/gakonst/ethers-rs#110d1bee)\r\n   Compiling ethers-etherscan v0.2.0 (https://github.com/gakonst/ethers-rs#110d1bee)\r\n   Compiling foundry-config v0.2.0 (/opt/foundry/config)\r\n   Compiling foundry-cli-test-utils v0.1.0 (/opt/foundry/cli/test-utils)\r\n   Compiling ethers-contract v0.6.0 (https://github.com/gakonst/ethers-rs#110d1bee)\r\n   Compiling foundry-utils v0.2.0 (/opt/foundry/utils)\r\n   Compiling ethers-middleware v0.6.0 (https://github.com/gakonst/ethers-rs#110d1bee)\r\n   Compiling cast v0.2.0 (/opt/foundry/cast)\r\n   Compiling ethers v0.6.0 (https://github.com/gakonst/ethers-rs#110d1bee)\r\n   Compiling foundry-evm v0.2.0 (/opt/foundry/evm)\r\n   Compiling forge v0.2.0 (/opt/foundry/forge)\r\n   Compiling ui v0.2.0 (/opt/foundry/ui)\r\n    Finished test [unoptimized + debuginfo] target(s) in 1m 27s\r\n     Running tests/it/main.rs (target/debug/deps/it-710d20b40e5989aa)\r\n\r\nrunning 36 tests\r\ntest cmd::can_compile_local_spells ... ignored\r\ntest cast::finds_block ... ok\r\ntest cmd::can_clean_non_existing ... ok\r\ntest cmd::can_clean_hardhat ... ok\r\ntest cmd::can_clean ... ok\r\ntest cmd::can_emit_extra_output ... ok\r\ntest cmd::can_execute_run_command ... ok\r\ntest cmd::can_init_no_git ... ok\r\ntest cmd::can_execute_inspect_command ... FAILED\r\ntest cmd::can_execute_run_command_with_args ... ok\r\ntest cmd::can_execute_run_command_with_sig ... ok\r\ntest cmd::can_handle_direct_imports_into_src ... ok\r\ntest cmd::can_compile_without_warnings ... ok\r\ntest cmd::forge_utils::tests::foundry_path_ext_works ... ok\r\ntest cmd::can_check_snapshot ... ok\r\ntest cmd::can_init_non_empty ... ok\r\ntest cmd::can_clean_config ... ok\r\ntest cmd::can_init_quiet ... ok\r\ntest cmd::can_init_repo_repeatedly_with_force ... ok\r\ntest cmd::can_init_repo_with_config ... ok\r\ntest config::can_set_solc_explicitly ... ok\r\ntest config::can_set_yul_optimizer ... ok\r\ntest config::forge_utils::tests::foundry_path_ext_works ... ok\r\ntest config::can_parse_dapp_libraries ... ok\r\ntest test::forge_utils::tests::foundry_path_ext_works ... ok\r\ntest config::can_override_config ... ok\r\ntest cmd::print_help ... ok\r\ntest cmd::can_print_warnings ... ok\r\ntest config::can_detect_config_vals ... ok\r\ntest config::can_set_config_values ... ok\r\ntest config::can_extract_config_values ... ok\r\ntest config::can_show_config ... ok\r\ntest cmd::can_init_vscode ... ok\r\ntest config::can_use_solc ... ok\r\ntest test::can_fuzz_array_params ... ok\r\ntest config::can_get_evm_opts ... ok\r\n\r\nfailures:\r\n\r\n---- cmd::can_execute_inspect_command stdout ----\r\nthread 'cmd::can_execute_inspect_command' panicked at '\r\n\r\n==========\r\ncommand failed but expected success!\r\n\r\ncommand: \"/opt/foundry/target/debug/deps/../forge\" \"inspect\" \"Foo\" \"bytecode\"\r\n\r\ncwd: root: /tmp/can_execute_inspect_command-0jB3uKo\r\ncontracts: /tmp/can_execute_inspect_command-0jB3uKo/src\r\nartifacts: /tmp/can_execute_inspect_command-0jB3uKo/out\r\ntests: /tmp/can_execute_inspect_command-0jB3uKo/tests\r\nlibs:\r\n    /tmp/can_execute_inspect_command-0jB3uKo/lib\r\nremappings:\r\n\r\n\r\nstatus: exit status: 1\r\n\r\nstdout: \r\n\r\nstderr: Error: \r\n   0: \"/root/.svm/0.8.10/solc-0.8.10\": Text file busy (os error 26)\r\n\r\nLocation:\r\n   cli/src/cmd/utils.rs:104\r\n\r\nBacktrace omitted.\r\nRun with RUST_BACKTRACE=1 environment variable to display it.\r\nRun with RUST_BACKTRACE=full to include source snippets.\r\n\r\n\r\n==========\r\n', cli/test-utils/src/util.rs:519:13\r\nnote: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\r\n\r\n\r\nfailures:\r\n    cmd::can_execute_inspect_command\r\n\r\ntest result: FAILED. 34 passed; 1 failed; 1 ignored; 0 measured; 0 filtered out; finished in 19.73s\r\n\r\nerror: test failed, to rerun pass '-p foundry-cli --test it'\r\n```",
  "closed_by": {
    "login": "mattsse",
    "id": 19890894,
    "node_id": "MDQ6VXNlcjE5ODkwODk0",
    "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mattsse",
    "html_url": "https://github.com/mattsse",
    "followers_url": "https://api.github.com/users/mattsse/followers",
    "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
    "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
    "organizations_url": "https://api.github.com/users/mattsse/orgs",
    "repos_url": "https://api.github.com/users/mattsse/repos",
    "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mattsse/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/1183/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1183/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1087287826",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1183#issuecomment-1087287826",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1183",
    "id": 1087287826,
    "node_id": "IC_kwDOGBlvNc5AzrIS",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-04T08:52:10Z",
    "updated_at": "2022-04-04T08:52:10Z",
    "author_association": "MEMBER",
    "body": "oh while we fixed the install with an additional lockfile properly, this still can happen when operating on the actual target location `/root/.svm/0.8.10/solc-0.8.10`",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1087287826/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1150314004",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1183#issuecomment-1150314004",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1183",
    "id": 1150314004,
    "node_id": "IC_kwDOGBlvNc5EkGYU",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-08T19:29:37Z",
    "updated_at": "2022-06-08T19:29:37Z",
    "author_association": "MEMBER",
    "body": "this should be fixed now since we run serial tests now ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1150314004/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
