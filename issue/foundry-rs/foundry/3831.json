{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3831",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3831/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3831/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3831/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/3831",
  "id": 1474959026,
  "node_id": "I_kwDOGBlvNc5X6hay",
  "number": 3831,
  "title": "`forgefmt: disable-line` match prettier's `prettier-ignore` behavior",
  "user": {
    "login": "0xPhaze",
    "id": 103113487,
    "node_id": "U_kgDOBiVjDw",
    "avatar_url": "https://avatars.githubusercontent.com/u/103113487?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/0xPhaze",
    "html_url": "https://github.com/0xPhaze",
    "followers_url": "https://api.github.com/users/0xPhaze/followers",
    "following_url": "https://api.github.com/users/0xPhaze/following{/other_user}",
    "gists_url": "https://api.github.com/users/0xPhaze/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/0xPhaze/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/0xPhaze/subscriptions",
    "organizations_url": "https://api.github.com/users/0xPhaze/orgs",
    "repos_url": "https://api.github.com/users/0xPhaze/repos",
    "events_url": "https://api.github.com/users/0xPhaze/events{/privacy}",
    "received_events_url": "https://api.github.com/users/0xPhaze/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3593644820,
      "node_id": "LA_kwDOGBlvNc7WMqsU",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-feature",
      "name": "T-feature",
      "color": "BFD4F2",
      "default": false,
      "description": "Type: feature"
    },
    {
      "id": 3703752787,
      "node_id": "LA_kwDOGBlvNc7cwshT",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-forge",
      "name": "C-forge",
      "color": "5319E7",
      "default": false,
      "description": "Command: forge"
    },
    {
      "id": 3854691308,
      "node_id": "LA_kwDOGBlvNc7lwevs",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/Cmd-forge-fmt",
      "name": "Cmd-forge-fmt",
      "color": "006B75",
      "default": false,
      "description": "Command: forge fmt"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-12-04T16:19:08Z",
  "updated_at": "2023-11-09T09:33:46Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Describe the feature you would like\r\n\r\nIt would be nice if `forgefmt: disable-line` behaved similarly to prettier's `prettier-ignore`. This would make switching formatters easier.\r\n\r\n```solidity\r\ncontract TestContract is Test {\r\n    function test() public {\r\n        assembly { sstore(0, 0) }// prettier-ignore\r\n\r\n// prettier-ignore\r\n        assembly { sstore(0, 0) }\r\n\r\n        // prettier-ignore\r\n        assembly { sstore(0, 0) \r\n\r\n        sstore(0, 0) \r\n        }\r\n\r\n        this;      // prettier-ignore\r\n    }\r\n}\r\n```\r\n\r\ngets turned into\r\n\r\n```solidity\r\ncontract TestContract is Test {\r\n    function test() public {\r\n        assembly { sstore(0, 0) } // prettier-ignore\r\n\r\n        // prettier-ignore\r\n        assembly { sstore(0, 0) }\r\n\r\n        // prettier-ignore\r\n        assembly { sstore(0, 0) \r\n\r\n        sstore(0, 0) \r\n        }\r\n\r\n        this; // prettier-ignore\r\n    }\r\n}\r\n```\r\n\r\nwhile `forge fmt` transforms the same into\r\n```solidity\r\ncontract TestContract is Test {\r\n    function test() public {\r\n        assembly { sstore(0, 0) }// forgefmt: disable-line\r\n\r\n    // forgefmt: disable-line\r\n        assembly {\r\n            sstore(0, 0)\r\n        }// forgefmt: disable-line\r\n        assembly {\r\n            sstore(0, 0)\r\n\r\n            sstore(0, 0)\r\n        }\r\n\r\n        this;      // forgefmt: disable-line\r\n    }\r\n}\r\n```\r\nI'd first note that some of the whitespace formatting doesn't look good.\r\n\r\nI know there is the `disable-next-line`, but I'd argue that I've never had a need to distinguish those two cases. If there is code before the comment, it should apply to that. If the line is otherwise empty, then it's applied to the next line.\r\n\r\nWhat's more is that `disable-next-line` doesn't work on scope, e.g.\r\n```solidity\r\n        // forgefmt: disable-next-line\r\n        assembly { sstore(0, 0) \r\n        }\r\n```\r\nis transformed to\r\n```solidity\r\n        // forgefmt: disable-next-line\r\n        assembly {\r\n            sstore(0, 0)\r\n        }\r\n```\r\n\r\nand\r\n```solidity\r\n        assembly { sstore(0, 0) // forgefmt: disable-line\r\n        }\r\n```\r\nis transformed to.\r\n```solidity\r\n        assembly {\r\n            sstore(0, 0)// forgefmt: disable-line\r\n        }\r\n```\r\n\r\nAlso writing `// prettier-ignore` is more succinct, than `// forgefmt: disable-line`. It's slightly confusing that there is no dash between *forge* and *fmt* while there is one for *disable-line* and having both, a semicolon and a dash makes it harder to type (or remember).\r\n\r\nI'm not sure what other kind of comments could be needed (I don't think prettier has many more), but perhaps it could be changed to `// forge-fmt-ignore`, `// forgefmt-ignore` or `// fmt-ignore`.\r\n\r\n### Additional context\r\n\r\n_No response_",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/3831/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3831/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1336917831",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3831#issuecomment-1336917831",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3831",
    "id": 1336917831,
    "node_id": "IC_kwDOGBlvNc5Pr79H",
    "user": {
      "login": "rkrasiuk",
      "id": 25429261,
      "node_id": "MDQ6VXNlcjI1NDI5MjYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25429261?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rkrasiuk",
      "html_url": "https://github.com/rkrasiuk",
      "followers_url": "https://api.github.com/users/rkrasiuk/followers",
      "following_url": "https://api.github.com/users/rkrasiuk/following{/other_user}",
      "gists_url": "https://api.github.com/users/rkrasiuk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rkrasiuk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rkrasiuk/subscriptions",
      "organizations_url": "https://api.github.com/users/rkrasiuk/orgs",
      "repos_url": "https://api.github.com/users/rkrasiuk/repos",
      "events_url": "https://api.github.com/users/rkrasiuk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rkrasiuk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-05T08:06:13Z",
    "updated_at": "2022-12-05T08:06:13Z",
    "author_association": "COLLABORATOR",
    "body": "thanks for reporting this @0xPhaze. `forgefmt: disable-line` does not map to `prettier-ignore` directly, since the latter has a broader variety of usage. this can be achieved by combining different `forgefmt` directives: `disable-line` (disable formatting of the **current** line), `disable-next-line` (disable formatting of the **next** line), `disable-next-item` (disable next pt token).\r\n\r\nregarding the style of the directive, curious to hear what @mds1 thinks",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1336917831/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1337478544",
    "html_url": "https://github.com/foundry-rs/foundry/issues/3831#issuecomment-1337478544",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/3831",
    "id": 1337478544,
    "node_id": "IC_kwDOGBlvNc5PuE2Q",
    "user": {
      "login": "mds1",
      "id": 17163988,
      "node_id": "MDQ6VXNlcjE3MTYzOTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mds1",
      "html_url": "https://github.com/mds1",
      "followers_url": "https://api.github.com/users/mds1/followers",
      "following_url": "https://api.github.com/users/mds1/following{/other_user}",
      "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
      "organizations_url": "https://api.github.com/users/mds1/orgs",
      "repos_url": "https://api.github.com/users/mds1/repos",
      "events_url": "https://api.github.com/users/mds1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mds1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-05T14:34:47Z",
    "updated_at": "2022-12-05T14:34:47Z",
    "author_association": "COLLABORATOR",
    "body": "I can see the argument for merging the `disable-line` and `disable-next-line` directives, since it should be easy for the formatter to distinguish between the two and it does make migrating from prettier easier. (Can still keep `disable-next-line` for backwards compatibility, and maybe add a warning that it's deprecated so it can be removed later).\r\n\r\nRegarding `// forgefmt: disable-line` vs. `forgefmt-disable-line` or `forgefmt-ignore`, I'm kind of indifferent on syntax and at this point it's probably worth leaving since it'd be a breaking change unless both are supported. I'm guessing the rationale for the current style is:\r\n- ESLint uses the \"disable line\" terminology\r\n- `rust fmt` uses the `rustfmt` syntax (without a dash)\r\n\r\nso there is some prior art / it's not a totally new directive style. If I had to choose I'd probably agree with @0xPhaze and prefer `// forgefmt-disable-line`, since it also matches nicely with `// slither-disable` and `// slither-disable-start`",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1337478544/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
