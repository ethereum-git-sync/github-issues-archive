{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/1573",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1573/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1573/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1573/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/1573",
  "id": 1231115840,
  "node_id": "I_kwDOGBlvNc5JYVZA",
  "number": 1573,
  "title": "Hardhat-compatible artifacts (directory structure)",
  "user": {
    "login": "naps62",
    "id": 283819,
    "node_id": "MDQ6VXNlcjI4MzgxOQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/283819?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/naps62",
    "html_url": "https://github.com/naps62",
    "followers_url": "https://api.github.com/users/naps62/followers",
    "following_url": "https://api.github.com/users/naps62/following{/other_user}",
    "gists_url": "https://api.github.com/users/naps62/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/naps62/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/naps62/subscriptions",
    "organizations_url": "https://api.github.com/users/naps62/orgs",
    "repos_url": "https://api.github.com/users/naps62/repos",
    "events_url": "https://api.github.com/users/naps62/events{/privacy}",
    "received_events_url": "https://api.github.com/users/naps62/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3593644820,
      "node_id": "LA_kwDOGBlvNc7WMqsU",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-feature",
      "name": "T-feature",
      "color": "BFD4F2",
      "default": false,
      "description": "Type: feature"
    },
    {
      "id": 3703752787,
      "node_id": "LA_kwDOGBlvNc7cwshT",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-forge",
      "name": "C-forge",
      "color": "5319E7",
      "default": false,
      "description": "Command: forge"
    },
    {
      "id": 3759719790,
      "node_id": "LA_kwDOGBlvNc7gGMVu",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/P-low",
      "name": "P-low",
      "color": "D93F0B",
      "default": false,
      "description": "Priority: low"
    },
    {
      "id": 3777098561,
      "node_id": "LA_kwDOGBlvNc7hIfNB",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/Cmd-forge-build",
      "name": "Cmd-forge-build",
      "color": "006B75",
      "default": false,
      "description": "Command: forge build"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-05-10T12:57:34Z",
  "updated_at": "2022-06-02T08:32:32Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Describe the feature you would like\r\n\r\nFoundry has a hardhat-compatibility flag (which from my understanding, sets `libs` and `src` config values)\r\n\r\nIt also seems to detect existing hardhat projects. When calling `forge init --force` in an existing hardhat repo, I noticed it filled out those same configs as `--hh` would. But it also set `out = 'artifacts'`, which is the directory used by hardhat.\r\n\r\nWhen seeing that, I took it as having the ability to share compilation artifacts with hardhat. Which is a great thing to have, since it means I could do a single compilation, and run both `forge test` and `hardhat test`\r\n\r\nHowever, the artifacts generated by foundry are apparently not compatible, due to the directory structure generated. It flattens all contracts into a subdir of `artifacts`, whereas hardhat mimics the structure of `contracts`\r\n\r\nSo for the following project:\r\n\r\n```\r\nroot\r\n|-- contracts\r\n|   |-- libs\r\n|   |   `-- MyLib.sol\r\n|   `-- MyToken.sol\r\n`-- node_modules\r\n    `-- @openzeppelin\r\n```\r\n\r\nHardhat would give me:\r\n\r\n```\r\nroot\r\n|-- artifacts\r\n|   |-- contracts\r\n|   |   |-- mylib\r\n|   |   |   `-- MyLib.sol\r\n|   |   `-- MyToken.sol\r\n|   `-- @openzeppelin\r\n```\r\n\r\nbut apparently foundry gives me:\r\n\r\n```\r\nroot\r\n|-- artifacts\r\n|   |-- Context.sol\r\n|   |-- ERC20.sol\r\n|   |-- ...\r\n|   |-- MyLib.sol\r\n|   `-- MyToken.sol\r\n```\r\n\r\nBesides breaking the original expectation (which would be very cool to have, if possible), it also means that `forge init --force` actually creates a broken setup, since artifacts will end up duplicated inside the `artifacts` directory. If hardhat is using typechain to infer typings from those, compilation errors will be thrown due to all the duplicates\r\n\r\n### Additional context\r\n\r\nThis is the PR where I tried adding foundry to an existing project: https://github.com/subvisual/discoveryDAO/pull/149\r\n\r\nI had to explicitly remove `out = 'artifacts'` due to the described issues. CI is currently set to run two independent compilations",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/1573/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1573/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1122493377",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1573#issuecomment-1122493377",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1573",
    "id": 1122493377,
    "node_id": "IC_kwDOGBlvNc5C5-PB",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-10T14:45:07Z",
    "updated_at": "2022-05-10T14:46:51Z",
    "author_association": "MEMBER",
    "body": "Requires changes in ethers-solc\r\n\r\nSince Foundry sort of supports Hardhat-style artifacts (read only, not all cases IIRC) we could have a config setting to choose artifact flavor.\r\n\r\nSee also https://github.com/foundry-rs/foundry/issues/73",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1122493377/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1128996609",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1573#issuecomment-1128996609",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1573",
    "id": 1128996609,
    "node_id": "IC_kwDOGBlvNc5DSx8B",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-17T15:14:24Z",
    "updated_at": "2022-05-17T15:14:24Z",
    "author_association": "MEMBER",
    "body": "you might be interested in this https://github.com/foundry-rs/hardhat/pull/16\r\nwhich bakes forge directly into hardhat and also uses an artifacts handler that's compatible with hardhat",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1128996609/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1131941679",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1573#issuecomment-1131941679",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1573",
    "id": 1131941679,
    "node_id": "IC_kwDOGBlvNc5DeA8v",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-19T16:37:08Z",
    "updated_at": "2022-05-19T16:37:08Z",
    "author_association": "MEMBER",
    "body": "@naps62 Let us know if using the Foundry Hardhat plugin solves this for you :)",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1131941679/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1144597269",
    "html_url": "https://github.com/foundry-rs/foundry/issues/1573#issuecomment-1144597269",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/1573",
    "id": 1144597269,
    "node_id": "IC_kwDOGBlvNc5EOSsV",
    "user": {
      "login": "naps62",
      "id": 283819,
      "node_id": "MDQ6VXNlcjI4MzgxOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/283819?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naps62",
      "html_url": "https://github.com/naps62",
      "followers_url": "https://api.github.com/users/naps62/followers",
      "following_url": "https://api.github.com/users/naps62/following{/other_user}",
      "gists_url": "https://api.github.com/users/naps62/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naps62/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naps62/subscriptions",
      "organizations_url": "https://api.github.com/users/naps62/orgs",
      "repos_url": "https://api.github.com/users/naps62/repos",
      "events_url": "https://api.github.com/users/naps62/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naps62/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-02T08:32:32Z",
    "updated_at": "2022-06-02T08:32:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "@onbjerg sorry for taking so long. I am mostly away from the project where this was an issue, so didn't have time to check until now.\r\nI'm still interested in figuring this out though, regardless of the project\r\n\r\nSo here's where I'm at: I tested that plugin. but maybe I misunderstood it's functionality, or didn't find some configuration I should add.\r\nRunning `hardhat test` seems to now runs `forge test` only. What I actually wanted was to keep both test suites in place, but sharing compilation artifacts, so as not to cause conflicting artifacts, and to keep CI times where they are",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1144597269/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
