{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/4136",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4136/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4136/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4136/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/4136",
  "id": 1550165985,
  "node_id": "I_kwDOGBlvNc5cZafh",
  "number": 4136,
  "title": "Forge not interacting as expected with local Anvil Goerli Optimism fork.",
  "user": {
    "login": "HardlyCodeMan",
    "id": 72480678,
    "node_id": "MDQ6VXNlcjcyNDgwNjc4",
    "avatar_url": "https://avatars.githubusercontent.com/u/72480678?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/HardlyCodeMan",
    "html_url": "https://github.com/HardlyCodeMan",
    "followers_url": "https://api.github.com/users/HardlyCodeMan/followers",
    "following_url": "https://api.github.com/users/HardlyCodeMan/following{/other_user}",
    "gists_url": "https://api.github.com/users/HardlyCodeMan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/HardlyCodeMan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/HardlyCodeMan/subscriptions",
    "organizations_url": "https://api.github.com/users/HardlyCodeMan/orgs",
    "repos_url": "https://api.github.com/users/HardlyCodeMan/repos",
    "events_url": "https://api.github.com/users/HardlyCodeMan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/HardlyCodeMan/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-01-20T00:50:27Z",
  "updated_at": "2023-01-20T01:10:02Z",
  "closed_at": "2023-01-20T01:09:32Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Have you ensured that all of these are up to date?\r\n\r\n- [X] Foundry\r\n- [X] Foundryup\r\n\r\n### What version of Foundry are you on?\r\n\r\nforge 0.2.0 (23c41b1 2023-01-19T00:08:45.857013991Z)\r\n\r\n### What command(s) is the bug in?\r\n\r\nanvil -f $GOERLI_OPTIMISIM_RPC; forge script script/script.s.sol --rpc-url http://127.0.0.1:8545\r\n\r\n### Operating System\r\n\r\nLinux\r\n\r\n### Describe the bug\r\n\r\nPotentially related to [#4094](https://github.com/foundry-rs/foundry/issues/4094)\r\n\r\nAttempted to run a basic script to interact with an Ethernaut level directly through Alchemy rpc, works as expected.\r\n\r\nForked goerli optimism through anvil via Alchemy rpc, works as expected. Ran the script to interact with anvil forked version of the same rpc and it crashes. Block 4373432 noted in Error #0 is reported as the block returned by the Alchemy rpc.\r\n\r\nAnvil \r\n```\r\nFork\r\n==================\r\nEndpoint:       https://opt-goerli.g.alchemy.com/v2/..............\r\nBlock number:   4373432\r\nBlock hash:     0x0b24d96429bf0f54c1377fd5c7e16b32faa560f30e8bbccab93b029bf2176e82\r\nChain ID:       420\r\n\r\n\r\nListening on 127.0.0.1:8545\r\neth_getTransactionCount\r\neth_blockNumber\r\neth_getBlockByNumber\r\neth_chainId\r\n```\r\n\r\nForge\r\n```\r\nThe application panicked (crashed).\r\nMessage:  Could not instantiate forked environment: \r\nCould not instantiate forked environment with fork url: http://127.0.0.1:8545\r\n\r\nContext:\r\n- Error #0: Failed to get block 4373432\r\n- Error #1: (code: -32603, message: Fork Error: JsonRpcClientError(SerdeJson { err: Error(\"missing field `v`\", line: 1, column: 1016), text: \"{\\\"number\\\":\\\"0x42bbb8\\\",\\\"hash\\\":\\\"0x0b24d96429bf0f54c1377fd5c7e16b32faa560f30e8bbccab93b029bf2176e82\\\",\\\"transactions\\\":[{\\\"blockHash\\\":\\\"0x0b24d96429bf0f54c1377fd5c7e16b32faa560f30e8bbccab93b029bf2176e82\\\",\\\"blockNumber\\\":\\\"0x42bbb8\\\",\\\"hash\\\":\\\"0x3cd0589d89d27b9d6d0b77091d4c92ff0f06a3d6f4c472aa4d2fbacfcc3eb3fc\\\",\\\"from\\\":\\\"0xdeaddeaddeaddeaddeaddeaddeaddeaddead0001\\\",\\\"gas\\\":\\\"0x8f0d180\\\",\\\"input\\\":\\\"0x015d8eb900000000000000000000000000000000000000000000000000000000007f476e0000000000000000000000000000000000000000000000000000000063c9e1b4000000000000000000000000000000000000000000000000000000000000002011eee208a68b555c39a65ba0ac5fc2a9b697c7bbb99c5d9c30fb540e5043059500000000000000000000000000000000000000000000000000000000000000020000000000000000000000007431310e026b69bfc676c0013e12a1a11411eec9000000000000000000000000000000000000000000000000000000000000083400000000000000000000000000000000000000000000000000000000000f4240\\\",\\\"nonce\\\":\\\"0x0\\\",\\\"to\\\":\\\"0x4200000000000000000000000000000000000015\\\",\\\"transactionIndex\\\":\\\"0x0\\\",\\\"type\\\":\\\"0x7e\\\",\\\"value\\\":\\\"0x0\\\"}],\\\"difficulty\\\":\\\"0x0\\\",\\\"extraData\\\":\\\"0x\\\",\\\"gasLimit\\\":\\\"0x17d7840\\\",\\\"gasUsed\\\":\\\"0x0\\\",\\\"logsBloom\\\":\\\"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\\\",\\\"miner\\\":\\\"0x4200000000000000000000000000000000000011\\\",\\\"mixHash\\\":\\\"0x8ae2a35c7bf2409a6992b3025c12b2f33184982219706a0275087cb8100a9081\\\",\\\"nonce\\\":\\\"0x0000000000000000\\\",\\\"parentHash\\\":\\\"0xc19e10e824008299d9bcc35c39030f0ae9f2395d33b85fef6488a3dd6e79aa9a\\\",\\\"receiptsRoot\\\":\\\"0x3fd774ff8fe515813d7a8f9d3748e58e857bc002823a458a93be90a3bc2e0894\\\",\\\"sha3Uncles\\\":\\\"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347\\\",\\\"size\\\":\\\"0x364\\\",\\\"stateRoot\\\":\\\"0xb0a1858f00eb8acaa40eef8773f2ea8e478afbe852853584073d716d680fdf54\\\",\\\"timestamp\\\":\\\"0x63c9e1d4\\\",\\\"totalDifficulty\\\":\\\"0x0\\\",\\\"transactionsRoot\\\":\\\"0xcdd83db2b10986bfd577c9157c3ba98e5d5fa955ce06dc7fa9c41c50c09661b7\\\",\\\"uncles\\\":[],\\\"baseFeePerGas\\\":\\\"0x31\\\"}\" }), data: None)\r\nLocation: /home/runner/work/foundry/foundry/evm/src/executor/opts.rs:56\r\n\r\nThis is a bug. Consider reporting it at https://github.com/foundry-rs/foundry\r\n\r\n  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ BACKTRACE ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\r\n   1: __libc_start_call_main<unknown>\r\n      at ./csu/../sysdeps/nptl/libc_start_call_main.h:58\r\n   2: __libc_start_main_impl<unknown>\r\n      at ./csu/../csu/libc-start.c:392\r\n```",
  "closed_by": {
    "login": "mattsse",
    "id": 19890894,
    "node_id": "MDQ6VXNlcjE5ODkwODk0",
    "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mattsse",
    "html_url": "https://github.com/mattsse",
    "followers_url": "https://api.github.com/users/mattsse/followers",
    "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
    "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
    "organizations_url": "https://api.github.com/users/mattsse/orgs",
    "repos_url": "https://api.github.com/users/mattsse/repos",
    "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mattsse/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/4136/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4136/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1397806381",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4136#issuecomment-1397806381",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4136",
    "id": 1397806381,
    "node_id": "IC_kwDOGBlvNc5TUNUt",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-20T01:09:32Z",
    "updated_at": "2023-01-20T01:10:02Z",
    "author_association": "MEMBER",
    "body": "closing as dup of #4094\r\n\r\nyeh that is the same issue, see rpc error message",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1397806381/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
