{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/6779",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6779/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6779/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6779/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/6779",
  "id": 2079553658,
  "node_id": "I_kwDOGBlvNc5783h6",
  "number": 6779,
  "title": "Attempt to subtract with overflow while using bound in invariant test",
  "user": {
    "login": "FaisalAli19",
    "id": 20942500,
    "node_id": "MDQ6VXNlcjIwOTQyNTAw",
    "avatar_url": "https://avatars.githubusercontent.com/u/20942500?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/FaisalAli19",
    "html_url": "https://github.com/FaisalAli19",
    "followers_url": "https://api.github.com/users/FaisalAli19/followers",
    "following_url": "https://api.github.com/users/FaisalAli19/following{/other_user}",
    "gists_url": "https://api.github.com/users/FaisalAli19/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/FaisalAli19/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/FaisalAli19/subscriptions",
    "organizations_url": "https://api.github.com/users/FaisalAli19/orgs",
    "repos_url": "https://api.github.com/users/FaisalAli19/repos",
    "events_url": "https://api.github.com/users/FaisalAli19/events{/privacy}",
    "received_events_url": "https://api.github.com/users/FaisalAli19/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2024-01-12T19:27:04Z",
  "updated_at": "2024-01-17T20:56:48Z",
  "closed_at": "2024-01-17T20:56:48Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nForge\n\n### Have you ensured that all of these are up to date?\n\n- [X] Foundry\n- [X] Foundryup\n\n### What version of Foundry are you on?\n\nforge 0.2.0 (b9d9a5c 2023-12-19T12:25:23.960984000Z)\n\n### What command(s) is the bug in?\n\nforge test\n\n### Operating System\n\nmacOS (Intel)\n\n### Describe the bug\n\nHello,\r\n\r\nI encountered an issue while using the bound function in an invariant test. The test fails with the error \"attempt to subtract with overflow\" when the minimum value passed to bound is set to 1. However, if I set the minimum value to 0, the test runs correctly but fails when the value is 1 or more.\r\n\r\n<img width=\"734\" alt=\"Screenshot 2024-01-13 at 12 47 38â€¯AM\" src=\"https://github.com/foundry-rs/foundry/assets/20942500/3e3633db-9f60-4c0c-8a14-bba9e8072605\">\r\n\r\n\r\nHere's the code snippet:\r\n\r\nThis works\r\n\r\n```solidity\r\nfunction depositToken(uint256 _amount) public {\r\n    uint256 amount = bound(_amount, 0, INITIAL_BALANCE);\r\n    vm.startPrank(user);\r\n    tokenA.approve(address(pool), amount);\r\n    tokenB.approve(address(pool), amount);\r\n    tokenC.approve(address(pool), amount);\r\n    pool.deposit(amount, uint64(block.timestamp + 10 days));\r\n    vm.stopPrank();\r\n}\r\n```\r\n\r\nThis doesn't\r\n\r\n```solidity\r\nfunction depositToken(uint256 _amount) public {\r\n    uint256 amount = bound(_amount, 1, INITIAL_BALANCE);\r\n    vm.startPrank(user);\r\n    tokenA.approve(address(pool), amount);\r\n    tokenB.approve(address(pool), amount);\r\n    tokenC.approve(address(pool), amount);\r\n    pool.deposit(amount, uint64(block.timestamp + 10 days));\r\n    vm.stopPrank();\r\n}\r\n```\r\n\r\nI would appreciate any guidance or suggestions on how to handle this issue effectively.\r\n\r\nThank you!",
  "closed_by": {
    "login": "mattsse",
    "id": 19890894,
    "node_id": "MDQ6VXNlcjE5ODkwODk0",
    "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mattsse",
    "html_url": "https://github.com/mattsse",
    "followers_url": "https://api.github.com/users/mattsse/followers",
    "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
    "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
    "organizations_url": "https://api.github.com/users/mattsse/orgs",
    "repos_url": "https://api.github.com/users/mattsse/repos",
    "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mattsse/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/6779/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6779/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1896674823",
    "html_url": "https://github.com/foundry-rs/foundry/issues/6779#issuecomment-1896674823",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6779",
    "id": 1896674823,
    "node_id": "IC_kwDOGBlvNc5xDPYH",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2024-01-17T20:56:48Z",
    "updated_at": "2024-01-17T20:56:48Z",
    "author_association": "MEMBER",
    "body": "this should be closed by https://github.com/foundry-rs/foundry/pull/6819",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1896674823/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
