{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/385",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/385/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/385/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/385/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/385",
  "id": 1094762041,
  "node_id": "I_kwDOGBlvNc5BQL45",
  "number": 385,
  "title": "forge: storage slot retrieval errors",
  "user": {
    "login": "naszam",
    "id": 23325228,
    "node_id": "MDQ6VXNlcjIzMzI1MjI4",
    "avatar_url": "https://avatars.githubusercontent.com/u/23325228?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/naszam",
    "html_url": "https://github.com/naszam",
    "followers_url": "https://api.github.com/users/naszam/followers",
    "following_url": "https://api.github.com/users/naszam/following{/other_user}",
    "gists_url": "https://api.github.com/users/naszam/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/naszam/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/naszam/subscriptions",
    "organizations_url": "https://api.github.com/users/naszam/orgs",
    "repos_url": "https://api.github.com/users/naszam/repos",
    "events_url": "https://api.github.com/users/naszam/events{/privacy}",
    "received_events_url": "https://api.github.com/users/naszam/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 12,
  "created_at": "2022-01-05T21:34:24Z",
  "updated_at": "2022-01-08T14:54:35Z",
  "closed_at": "2022-01-07T02:09:41Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Hi @gakonst,\r\n\r\nI was running `forge` against https://github.com/makerdao/spells-mainnet/pull/213 via:\r\n`make test-forge`\r\nusing:\r\n- hardhat mainnet fork pinned at block n. `13779177` (deployed spell block)\r\n\r\nand I'm getting the following failures:\r\n```haskell\r\n./test-dssspell-forge.sh \r\ncompiling...\r\nsuccess.\r\nRunning 13 tests for DssSpellTest\r\n[FAIL. Reason: ] testCastCost() (gas: 73435)\r\n[PASS] testFailTooEarly() (gas: 3580)\r\n[PASS] testFailTooLate() (gas: 3591)\r\n[PASS] testFailWrongDay() (gas: 3614)\r\n[PASS] testFail_notScheduled() (gas: 7225)\r\n[FAIL. Reason: ] testOnTime() (gas: 73392)\r\n[FAIL. Reason: ] testSpellIsCast_GENERAL() (gas: 2859664)\r\n[FAIL. Reason: ] testVestTransfer() (gas: 92795)\r\n[FAIL. Reason: ] test_auth() (gas: 73454)\r\n[FAIL. Reason: ] test_auth_in_sources() (gas: 73455)\r\n[PASS] test_bytecode_matches() (gas: 2783386)\r\n[FAIL. Reason: ] test_nextCastTime() (gas: 73955)\r\n[FAIL. Reason: ] test_use_eta() (gas: 73956)\r\n\r\nFailure: testCastCost()\r\n\r\n\r\n[20770927] DssSpellTest::setUp()\r\n  ├─ → new DssExec@0x6898…e52f\r\n  │   ├─ → new DssSpellAction@0x000a…d9b9\r\n  │   │   └─ ← 9851 bytes of code\r\n  │   ├─ [2569] 0xda0a…740f::21f8a721(4d43445f50415553450000000000000000000000000000000000000000000000)\r\n  │   │   └─ ← 0x000000000000000000000000be286431454714f511008713973d3b053a2d38f3\r\n  │   └─ ← 3543 bytes of code\r\n  └─ ← ()\r\n  ```\r\n  also, noticed the following errors in the hardhat trace as well:\r\n  ```haskell\r\n  eth_getTransactionCount\r\neth_getCode\r\neth_getStorageAt\r\n\r\n  Errors encountered in param 1: Invalid value \"0x000000000000000000000000000000000000000000000000000000000000001a\" supplied to : QUANTITY\r\n\r\neth_getBalance\r\neth_getTransactionCount\r\neth_getCode\r\neth_getStorageAt\r\n```\r\n\r\nI've tried to reproduce via `dapp` and the tests pass via:\r\n`make test`\r\n- opts off (commenting `test-dssspell.sh` L6-L7)\r\n\r\n```haskell\r\ndapp-test: rpc block: latest\r\nRunning 13 tests for src/DssSpell.t.sol:DssSpellTest\r\n[PASS] testFail_notScheduled() (gas: 7161)\r\n[PASS] test_auth_in_sources() (gas: 281473904699493)\r\n[PASS] test_use_eta() (gas: 326798)\r\n[PASS] testOnTime() (gas: 2688502)\r\n[PASS] testVestTransfer() (gas: 4063768)\r\n[PASS] test_nextCastTime() (gas: 327693)\r\n[PASS] testFailTooEarly() (gas: 3528)\r\n[PASS] test_bytecode_matches() (gas: 2783322)\r\n[PASS] test_auth() (gas: 281473910475780)\r\n[PASS] testSpellIsCast_GENERAL() (gas: 11536781)\r\n[PASS] testFailWrongDay() (gas: 3550)\r\n[PASS] testCastCost() (gas: 2690091)\r\n[PASS] testFailTooLate() (gas: 3527)\r\n```\r\n\r\nForge: `forgeup` to master branch\r\nDapp: 0.35.0\r\nHevm: 0.49.0\r\n\r\nAny idea?\r\nThanks!\r\n\r\n",
  "closed_by": {
    "login": "brockelmore",
    "id": 31553173,
    "node_id": "MDQ6VXNlcjMxNTUzMTcz",
    "avatar_url": "https://avatars.githubusercontent.com/u/31553173?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/brockelmore",
    "html_url": "https://github.com/brockelmore",
    "followers_url": "https://api.github.com/users/brockelmore/followers",
    "following_url": "https://api.github.com/users/brockelmore/following{/other_user}",
    "gists_url": "https://api.github.com/users/brockelmore/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/brockelmore/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/brockelmore/subscriptions",
    "organizations_url": "https://api.github.com/users/brockelmore/orgs",
    "repos_url": "https://api.github.com/users/brockelmore/repos",
    "events_url": "https://api.github.com/users/brockelmore/events{/privacy}",
    "received_events_url": "https://api.github.com/users/brockelmore/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/385/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/385/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1006110156",
    "html_url": "https://github.com/foundry-rs/foundry/issues/385#issuecomment-1006110156",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/385",
    "id": 1006110156,
    "node_id": "IC_kwDOGBlvNc47-AXM",
    "user": {
      "login": "gakonst",
      "id": 17802178,
      "node_id": "MDQ6VXNlcjE3ODAyMTc4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17802178?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gakonst",
      "html_url": "https://github.com/gakonst",
      "followers_url": "https://api.github.com/users/gakonst/followers",
      "following_url": "https://api.github.com/users/gakonst/following{/other_user}",
      "gists_url": "https://api.github.com/users/gakonst/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gakonst/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gakonst/subscriptions",
      "organizations_url": "https://api.github.com/users/gakonst/orgs",
      "repos_url": "https://api.github.com/users/gakonst/repos",
      "events_url": "https://api.github.com/users/gakonst/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gakonst/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-05T21:57:35Z",
    "updated_at": "2022-01-05T21:57:35Z",
    "author_association": "MEMBER",
    "body": "Can you re-run the same test with `RUST_LOG=ethers=trace`? This should log all ethers requests/responses, and then we should grep through them to understand what request is being generated that causes this error.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1006110156/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1006128125",
    "html_url": "https://github.com/foundry-rs/foundry/issues/385#issuecomment-1006128125",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/385",
    "id": 1006128125,
    "node_id": "IC_kwDOGBlvNc47-Ev9",
    "user": {
      "login": "naszam",
      "id": 23325228,
      "node_id": "MDQ6VXNlcjIzMzI1MjI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/23325228?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naszam",
      "html_url": "https://github.com/naszam",
      "followers_url": "https://api.github.com/users/naszam/followers",
      "following_url": "https://api.github.com/users/naszam/following{/other_user}",
      "gists_url": "https://api.github.com/users/naszam/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naszam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naszam/subscriptions",
      "organizations_url": "https://api.github.com/users/naszam/orgs",
      "repos_url": "https://api.github.com/users/naszam/repos",
      "events_url": "https://api.github.com/users/naszam/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naszam/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-05T22:28:03Z",
    "updated_at": "2022-01-05T22:30:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "I've just run `forgeup` again, set the env var, re-run the tests and put the logs here:\r\nhttps://gist.github.com/naszam/fd2d22db9f31a3ed7ce422792192af2c",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1006128125/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1006134196",
    "html_url": "https://github.com/foundry-rs/foundry/issues/385#issuecomment-1006134196",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/385",
    "id": 1006134196,
    "node_id": "IC_kwDOGBlvNc47-GO0",
    "user": {
      "login": "naszam",
      "id": 23325228,
      "node_id": "MDQ6VXNlcjIzMzI1MjI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/23325228?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naszam",
      "html_url": "https://github.com/naszam",
      "followers_url": "https://api.github.com/users/naszam/followers",
      "following_url": "https://api.github.com/users/naszam/following{/other_user}",
      "gists_url": "https://api.github.com/users/naszam/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naszam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naszam/subscriptions",
      "organizations_url": "https://api.github.com/users/naszam/orgs",
      "repos_url": "https://api.github.com/users/naszam/repos",
      "events_url": "https://api.github.com/users/naszam/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naszam/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-05T22:39:49Z",
    "updated_at": "2022-01-05T22:41:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "running:\r\n`make test-forge | grep 0x000000000000000000000000000000000000000000000000000000000000001a`\r\nwith `export RUST_BACKTRACE=full`\r\nI get:\r\n```haskell\r\nJan 05 22:40:46.797 TRACE rpc{method=\"eth_getStorageAt\" params=\"[\\\"0xbd770416a3345f91e4b34576cb804a576fa48eb1\\\",\\\"0x000000000000000000000000000000000000000000000000000000000000001a\\\",\\\"latest\\\"]\"}: ethers_providers::provider: tx\r\nError: \r\n   0: Encountered a total of 8 failing tests, 5 tests succeeded\r\n\r\nLocation:\r\n   cli/src/cmd/test.rs:150\r\n\r\n  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ BACKTRACE ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\r\n                                ⋮ 5 frames hidden ⋮                               \r\n   6: forge::cmd::test::TestOutcome::ensure_ok::h0c91dea2602ff2c6\r\n      at /home/naszam/.cargo/git/checkouts/foundry-f45668fa08523154/0785187/cli/src/cmd/test.rs:150\r\n       148 │             if failures > 0 {\r\n       149 │                 let successes = self.successes().count();\r\n       150 >                 eyre::bail!(\r\n       151 │                     \"Encountered a total of {} failing tests, {} tests succeeded\",\r\n       152 │                     failures,\r\n   7: forge::main::h62a9e5834485ff9f\r\n      at /home/naszam/.cargo/git/checkouts/foundry-f45668fa08523154/0785187/cli/src/forge.rs:20\r\n        18 │         Subcommands::Test(cmd) => {\r\n        19 │             let outcome = cmd.run()?;\r\n        20 >             outcome.ensure_ok()?;\r\n        21 │         }\r\n        22 │         Subcommands::Build(cmd) => {\r\n   8: core::ops::function::FnOnce::call_once::hc123afd5dfa79ae4\r\n      at /rustc/f1edd0429582dd29cccacaf50fd134b05593bd9c/library/core/src/ops/function.rs:227\r\n                                ⋮ 4 frames hidden ⋮                               \r\n\r\nRun with COLORBT_SHOW_HIDDEN=1 environment variable to disable frame filtering.\r\nmake: *** [Makefile:7: test-forge] Error 1\r\n\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1006134196/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1006823029",
    "html_url": "https://github.com/foundry-rs/foundry/issues/385#issuecomment-1006823029",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/385",
    "id": 1006823029,
    "node_id": "IC_kwDOGBlvNc48AuZ1",
    "user": {
      "login": "brockelmore",
      "id": 31553173,
      "node_id": "MDQ6VXNlcjMxNTUzMTcz",
      "avatar_url": "https://avatars.githubusercontent.com/u/31553173?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brockelmore",
      "html_url": "https://github.com/brockelmore",
      "followers_url": "https://api.github.com/users/brockelmore/followers",
      "following_url": "https://api.github.com/users/brockelmore/following{/other_user}",
      "gists_url": "https://api.github.com/users/brockelmore/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brockelmore/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brockelmore/subscriptions",
      "organizations_url": "https://api.github.com/users/brockelmore/orgs",
      "repos_url": "https://api.github.com/users/brockelmore/repos",
      "events_url": "https://api.github.com/users/brockelmore/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brockelmore/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-06T18:36:57Z",
    "updated_at": "2022-01-06T18:37:06Z",
    "author_association": "MEMBER",
    "body": "Could this be a hardhat bug? Seems like hardhat just refused to hand back a value from it's forked state. The input parameters seems valid for the `eth_getStorageAt`. Is there a reason you can't use built-in forking capability (i.e. cumbersome to increment blocks)?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1006823029/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1006931236",
    "html_url": "https://github.com/foundry-rs/foundry/issues/385#issuecomment-1006931236",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/385",
    "id": 1006931236,
    "node_id": "IC_kwDOGBlvNc48BI0k",
    "user": {
      "login": "gakonst",
      "id": 17802178,
      "node_id": "MDQ6VXNlcjE3ODAyMTc4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17802178?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gakonst",
      "html_url": "https://github.com/gakonst",
      "followers_url": "https://api.github.com/users/gakonst/followers",
      "following_url": "https://api.github.com/users/gakonst/following{/other_user}",
      "gists_url": "https://api.github.com/users/gakonst/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gakonst/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gakonst/subscriptions",
      "organizations_url": "https://api.github.com/users/gakonst/orgs",
      "repos_url": "https://api.github.com/users/gakonst/repos",
      "events_url": "https://api.github.com/users/gakonst/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gakonst/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-06T21:00:22Z",
    "updated_at": "2022-01-06T21:00:22Z",
    "author_association": "MEMBER",
    "body": "Good point @brockelmore, I wonder if this bug still persists if @naszam used a remote node directly.\r\n\r\nI believe Dapptools users use hardhat's forking mode to leverage the caching, to improve the forking speed.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1006931236/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1006941521",
    "html_url": "https://github.com/foundry-rs/foundry/issues/385#issuecomment-1006941521",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/385",
    "id": 1006941521,
    "node_id": "IC_kwDOGBlvNc48BLVR",
    "user": {
      "login": "brockelmore",
      "id": 31553173,
      "node_id": "MDQ6VXNlcjMxNTUzMTcz",
      "avatar_url": "https://avatars.githubusercontent.com/u/31553173?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brockelmore",
      "html_url": "https://github.com/brockelmore",
      "followers_url": "https://api.github.com/users/brockelmore/followers",
      "following_url": "https://api.github.com/users/brockelmore/following{/other_user}",
      "gists_url": "https://api.github.com/users/brockelmore/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brockelmore/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brockelmore/subscriptions",
      "organizations_url": "https://api.github.com/users/brockelmore/orgs",
      "repos_url": "https://api.github.com/users/brockelmore/repos",
      "events_url": "https://api.github.com/users/brockelmore/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brockelmore/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-06T21:17:49Z",
    "updated_at": "2022-01-06T21:17:49Z",
    "author_association": "MEMBER",
    "body": "i can try to reproduce it without hardhat",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1006941521/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1006945805",
    "html_url": "https://github.com/foundry-rs/foundry/issues/385#issuecomment-1006945805",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/385",
    "id": 1006945805,
    "node_id": "IC_kwDOGBlvNc48BMYN",
    "user": {
      "login": "brockelmore",
      "id": 31553173,
      "node_id": "MDQ6VXNlcjMxNTUzMTcz",
      "avatar_url": "https://avatars.githubusercontent.com/u/31553173?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brockelmore",
      "html_url": "https://github.com/brockelmore",
      "followers_url": "https://api.github.com/users/brockelmore/followers",
      "following_url": "https://api.github.com/users/brockelmore/following{/other_user}",
      "gists_url": "https://api.github.com/users/brockelmore/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brockelmore/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brockelmore/subscriptions",
      "organizations_url": "https://api.github.com/users/brockelmore/orgs",
      "repos_url": "https://api.github.com/users/brockelmore/repos",
      "events_url": "https://api.github.com/users/brockelmore/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brockelmore/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-06T21:25:11Z",
    "updated_at": "2022-01-06T21:26:34Z",
    "author_association": "MEMBER",
    "body": "```bash\r\nforge test --fork-url \"$ETH_RPC_URL\" --fork-block-number 13779177 --libraries \"src/DssSpell.sol:DssExecLib:0xfD88CeE74f7D78697775aBDAE53f9Da1559728E4\" -vvv --force --match \"$1\"\r\n```\r\n\r\nproduces this output:\r\n```bash\r\nRunning 13 tests for DssSpellTest\r\n[PASS] testCastCost() (gas: 2864655)\r\n[PASS] testFailTooEarly() (gas: 3580)\r\n[PASS] testFailTooLate() (gas: 3591)\r\n[PASS] testFailWrongDay() (gas: 3614)\r\n[PASS] testFail_notScheduled() (gas: 7225)\r\n[PASS] testOnTime() (gas: 2863066)\r\n[PASS] testSpellIsCast_GENERAL() (gas: 11711549)\r\n[PASS] testVestTransfer() (gas: 4238332)\r\n[PASS] test_auth() (gas: 18446673704903691408)\r\n[PASS] test_auth_in_sources() (gas: 18446673704895359685)\r\n[PASS] test_bytecode_matches() (gas: 2783386)\r\n[PASS] test_nextCastTime() (gas: 340057)\r\n[PASS] test_use_eta() (gas: 338962)\r\n```\r\n\r\n\r\nSeems like a hardhat bug",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1006945805/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1007074175",
    "html_url": "https://github.com/foundry-rs/foundry/issues/385#issuecomment-1007074175",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/385",
    "id": 1007074175,
    "node_id": "IC_kwDOGBlvNc48Brt_",
    "user": {
      "login": "naszam",
      "id": 23325228,
      "node_id": "MDQ6VXNlcjIzMzI1MjI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/23325228?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naszam",
      "html_url": "https://github.com/naszam",
      "followers_url": "https://api.github.com/users/naszam/followers",
      "following_url": "https://api.github.com/users/naszam/following{/other_user}",
      "gists_url": "https://api.github.com/users/naszam/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naszam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naszam/subscriptions",
      "organizations_url": "https://api.github.com/users/naszam/orgs",
      "repos_url": "https://api.github.com/users/naszam/repos",
      "events_url": "https://api.github.com/users/naszam/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naszam/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-07T01:48:34Z",
    "updated_at": "2022-01-07T01:48:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @brockelmore,\r\n\r\nI've just run:\r\n```\r\nforge test --fork-url \"$ETH_RPC_URL\" --fork-block-number 13779177 --libraries \"src/DssSpell.sol:DssExecLib:0xfD88CeE74f7D78697775aBDAE53f9Da1559728E4\" -vvv --force\r\n```\r\nusing Rivet, as you suggested in chat, and Test PASS :tada:\r\n\r\n```haskell\r\ncompiling...\r\nsuccess.\r\nRunning 13 tests for DssSpellTest\r\n[PASS] testCastCost() (gas: 2864655)\r\n[PASS] testFailTooEarly() (gas: 3580)\r\n[PASS] testFailTooLate() (gas: 3591)\r\n[PASS] testFailWrongDay() (gas: 3614)\r\n[PASS] testFail_notScheduled() (gas: 7225)\r\n[PASS] testOnTime() (gas: 2863066)\r\n[PASS] testSpellIsCast_GENERAL() (gas: 11711345)\r\n[PASS] testVestTransfer() (gas: 4238332)\r\n[PASS] test_auth() (gas: 18446673704902181312)\r\n[PASS] test_auth_in_sources() (gas: 18446673704896405025)\r\n[PASS] test_bytecode_matches() (gas: 2783386)\r\n[PASS] test_nextCastTime() (gas: 340057)\r\n[PASS] test_use_eta() (gas: 338962)\r\n```\r\n\r\nThanks!",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1007074175/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1007082664",
    "html_url": "https://github.com/foundry-rs/foundry/issues/385#issuecomment-1007082664",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/385",
    "id": 1007082664,
    "node_id": "IC_kwDOGBlvNc48Btyo",
    "user": {
      "login": "brockelmore",
      "id": 31553173,
      "node_id": "MDQ6VXNlcjMxNTUzMTcz",
      "avatar_url": "https://avatars.githubusercontent.com/u/31553173?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brockelmore",
      "html_url": "https://github.com/brockelmore",
      "followers_url": "https://api.github.com/users/brockelmore/followers",
      "following_url": "https://api.github.com/users/brockelmore/following{/other_user}",
      "gists_url": "https://api.github.com/users/brockelmore/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brockelmore/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brockelmore/subscriptions",
      "organizations_url": "https://api.github.com/users/brockelmore/orgs",
      "repos_url": "https://api.github.com/users/brockelmore/repos",
      "events_url": "https://api.github.com/users/brockelmore/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brockelmore/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-07T02:09:41Z",
    "updated_at": "2022-01-07T02:09:41Z",
    "author_association": "MEMBER",
    "body": "closing for now as it appears to be an issue with hardhat",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1007082664/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1007726506",
    "html_url": "https://github.com/foundry-rs/foundry/issues/385#issuecomment-1007726506",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/385",
    "id": 1007726506,
    "node_id": "IC_kwDOGBlvNc48EK-q",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-07T20:41:00Z",
    "updated_at": "2022-01-07T20:41:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi, someone mentioned this issue in our discord server, but AFAIK no one has opened an issue about it in our repo. Can someone help me understand the issue so I can create a minimal reproduction example (or, if someone can create the minimal example, even better).",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1007726506/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1007796535",
    "html_url": "https://github.com/foundry-rs/foundry/issues/385#issuecomment-1007796535",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/385",
    "id": 1007796535,
    "node_id": "IC_kwDOGBlvNc48EcE3",
    "user": {
      "login": "brockelmore",
      "id": 31553173,
      "node_id": "MDQ6VXNlcjMxNTUzMTcz",
      "avatar_url": "https://avatars.githubusercontent.com/u/31553173?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brockelmore",
      "html_url": "https://github.com/brockelmore",
      "followers_url": "https://api.github.com/users/brockelmore/followers",
      "following_url": "https://api.github.com/users/brockelmore/following{/other_user}",
      "gists_url": "https://api.github.com/users/brockelmore/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brockelmore/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brockelmore/subscriptions",
      "organizations_url": "https://api.github.com/users/brockelmore/orgs",
      "repos_url": "https://api.github.com/users/brockelmore/repos",
      "events_url": "https://api.github.com/users/brockelmore/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brockelmore/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-07T22:42:48Z",
    "updated_at": "2022-01-07T22:43:04Z",
    "author_association": "MEMBER",
    "body": "hi @fvictorio! I believe the reproduction is just a hardhat mainnet fork (using cached state? @naszam can confirm) and calling this rpc method: `rpc{method=\"eth_getStorageAt\" params=\"[\\\"0xbd770416a3345f91e4b34576cb804a576fa48eb1\\\",\\\"0x000000000000000000000000000000000000000000000000000000000000001a\\\",\\\"latest\\\"]\"}`\r\n\r\nI may have gotten some things wrong here but ultimately something weird happened in the rpc call as you see above",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1007796535/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1008013886",
    "html_url": "https://github.com/foundry-rs/foundry/issues/385#issuecomment-1008013886",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/385",
    "id": 1008013886,
    "node_id": "IC_kwDOGBlvNc48FRI-",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-08T14:54:35Z",
    "updated_at": "2022-01-08T14:54:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "Oh, thank you. @alcuadrado found out that we are probably implementing the spec wrong: we are expecting the storage slot to be a quantity (so no leading zeros), when in reality it seems like you _have_ to pass a 32 bytes hex. We'll open an issue about this. Thanks again!",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1008013886/reactions",
      "total_count": 5,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
