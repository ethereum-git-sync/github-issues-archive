{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/5154",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5154/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5154/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5154/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/5154",
  "id": 1755750027,
  "node_id": "I_kwDOGBlvNc5opp6L",
  "number": 5154,
  "title": "Bug: CI Pipeline is not publishing macOS binaries",
  "user": {
    "login": "sambacha",
    "id": 32783916,
    "node_id": "MDQ6VXNlcjMyNzgzOTE2",
    "avatar_url": "https://avatars.githubusercontent.com/u/32783916?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sambacha",
    "html_url": "https://github.com/sambacha",
    "followers_url": "https://api.github.com/users/sambacha/followers",
    "following_url": "https://api.github.com/users/sambacha/following{/other_user}",
    "gists_url": "https://api.github.com/users/sambacha/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sambacha/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sambacha/subscriptions",
    "organizations_url": "https://api.github.com/users/sambacha/orgs",
    "repos_url": "https://api.github.com/users/sambacha/repos",
    "events_url": "https://api.github.com/users/sambacha/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sambacha/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-06-13T22:42:40Z",
  "updated_at": "2023-06-14T11:13:06Z",
  "closed_at": "2023-06-14T11:13:06Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Component\n\nForge, Cast, Anvil, Chisel, Other (please describe)\n\n### Have you ensured that all of these are up to date?\n\n- [X] Foundry\n- [X] Foundryup\n\n### What version of Foundry are you on?\n\n_No response_\n\n### What command(s) is the bug in?\n\n_No response_\n\n### Operating System\n\nmacOS (Apple Silicon)\n\n### Describe the bug\n\n## macOS Binaries missing from GitHub Release Artifacts \r\n\r\nsee latest release https://github.com/foundry-rs/foundry/releases/tag/nightly-2ffa619a1cda6b39e57d5e0ee567ffc1e3cc42d9\r\n\r\nprevious release: https://github.com/foundry-rs/foundry/releases/tag/nightly-03aa926203e6dabdcf9b7e59219271294717c2eb\r\n\r\nIt only goes back to the second latest release where they are missing. \r\n\r\n### GraphQL Query\r\n\r\n```graphql\r\n{\r\n  repository(owner: \"foundry-rs\", name: \"foundry\") {\r\n    releases(first: 100) {\r\n      nodes {\r\n        tag {\r\n          name\r\n        }\r\n        releaseAssets(first: 100) {\r\n          nodes {\r\n            name\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n#### Response \r\n\r\n```jsonc\r\n{\r\n  \"data\": {\r\n    \"repository\": {\r\n      \"releases\": {\r\n        \"nodes\": [\r\n          {\r\n            \"tag\": {\r\n              \"name\": \"nightly-2ffa619a1cda6b39e57d5e0ee567ffc1e3cc42d9\"\r\n            },\r\n            \"releaseAssets\": {\r\n              \"nodes\": [\r\n                {\r\n                  \"name\": \"foundry_nightly_linux_amd64.tar.gz\"\r\n                },\r\n                {\r\n                  \"name\": \"foundry_man_nightly.tar.gz\"\r\n                },\r\n                {\r\n                  \"name\": \"foundry_nightly_linux_arm64.tar.gz\"\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          {\r\n            \"tag\": {\r\n              \"name\": \"nightly-03aa926203e6dabdcf9b7e59219271294717c2eb\"\r\n            },\r\n            \"releaseAssets\": {\r\n              \"nodes\": [\r\n                {\r\n                  \"name\": \"foundry_man_nightly.tar.gz\"\r\n                },\r\n                {\r\n                  \"name\": \"foundry_nightly_linux_amd64.tar.gz\"\r\n                }\r\n              ]\r\n            }\r\n          },\r\n          {\r\n            \"tag\": {\r\n              \"name\": \"nightly-08a629a5e3f33b6750222526c8f58e2beb83f794\"\r\n            },\r\n            \"releaseAssets\": {\r\n              \"nodes\": [\r\n                {\r\n                  \"name\": \"foundry_nightly_linux_amd64.tar.gz\"\r\n                },\r\n                {\r\n                  \"name\": \"foundry_man_nightly.tar.gz\"\r\n                },\r\n                {\r\n                  \"name\": \"foundry_nightly_linux_arm64.tar.gz\"\r\n                },\r\n                {\r\n                  \"name\": \"foundry_nightly_win32_amd64.zip\"\r\n                },\r\n                {\r\n                  \"name\": \"foundry_nightly_darwin_amd64.tar.gz\"\r\n                },\r\n                {\r\n                  \"name\": \"foundry_nightly_darwin_arm64.tar.gz\"\r\n                }\r\n              ]\r\n            }\r\n          }\r\n}\r\n}\r\n}\r\n```",
  "closed_by": {
    "login": "mattsse",
    "id": 19890894,
    "node_id": "MDQ6VXNlcjE5ODkwODk0",
    "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mattsse",
    "html_url": "https://github.com/mattsse",
    "followers_url": "https://api.github.com/users/mattsse/followers",
    "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
    "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
    "organizations_url": "https://api.github.com/users/mattsse/orgs",
    "repos_url": "https://api.github.com/users/mattsse/repos",
    "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mattsse/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/5154/reactions",
    "total_count": 1,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 1,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5154/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1590186333",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5154#issuecomment-1590186333",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5154",
    "id": 1590186333,
    "node_id": "IC_kwDOGBlvNc5eyFFd",
    "user": {
      "login": "sambacha",
      "id": 32783916,
      "node_id": "MDQ6VXNlcjMyNzgzOTE2",
      "avatar_url": "https://avatars.githubusercontent.com/u/32783916?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sambacha",
      "html_url": "https://github.com/sambacha",
      "followers_url": "https://api.github.com/users/sambacha/followers",
      "following_url": "https://api.github.com/users/sambacha/following{/other_user}",
      "gists_url": "https://api.github.com/users/sambacha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sambacha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sambacha/subscriptions",
      "organizations_url": "https://api.github.com/users/sambacha/orgs",
      "repos_url": "https://api.github.com/users/sambacha/repos",
      "events_url": "https://api.github.com/users/sambacha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sambacha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-13T23:24:07Z",
    "updated_at": "2023-06-13T23:24:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think this may have been an issue with compiling anvil, looking at my CI logs:\r\n\r\nhttps://github.com/sambacha/foundry/actions/runs/5171908900/jobs/9315744971#step:7:34\r\n\r\n> CI Timed out at 5h 48m 50s runtime\r\n\r\n```console\r\nRun actions-rs/cargo@v[1](https://github.com/sambacha/foundry/actions/runs/5171908900/jobs/9315744971#step:7:1)\r\n/Users/runner/.cargo/bin/cargo build --release --bins --target aarch64-apple-darwin\r\n   Compiling foundry-config v0.2.0 (/Users/runner/work/foundry/foundry/config)\r\n   Compiling foundry-macros-impl v0.0.0 (/Users/runner/work/foundry/foundry/macros/impl)\r\n   Compiling foundry-abi v0.1.0 (/Users/runner/work/foundry/foundry/abi)\r\n   Compiling foundry-macros v0.1.0 (/Users/runner/work/foundry/foundry/macros)\r\n   Compiling foundry-cli v0.2.0 (/Users/runner/work/foundry/foundry/cli)\r\n   Compiling chisel v0.1.1 (/Users/runner/work/foundry/foundry/chisel)\r\n   Compiling anvil v0.1.0 (/Users/runner/work/foundry/foundry/anvil)\r\n   Compiling anvil-rpc v0.1.0 (/Users/runner/work/foundry/foundry/anvil/rpc)\r\n   Compiling anvil-server v0.1.0 (/Users/runner/work/foundry/foundry/anvil/server)\r\n   Compiling foundry-common v0.1.0 (/Users/runner/work/foundry/foundry/common)\r\n   Compiling forge-fmt v0.2.0 (/Users/runner/work/foundry/foundry/fmt)\r\n   Compiling foundry-utils v0.2.0 (/Users/runner/work/foundry/foundry/utils)\r\n   Compiling forge-doc v0.1.0 (/Users/runner/work/foundry/foundry/doc)\r\n   Compiling foundry-evm v0.2.0 (/Users/runner/work/foundry/foundry/evm)\r\n   Compiling forge v0.2.0 (/Users/runner/work/foundry/foundry/forge)\r\n   Compiling cast v0.2.0 (/Users/runner/work/foundry/foundry/cast)\r\n   Compiling ui v0.2.0 (/Users/runner/work/foundry/foundry/ui)\r\n   Compiling anvil-core v0.1.0 (/Users/runner/work/foundry/foundry/anvil/core)\r\nError: The operation was canceled.\r\n```\r\n\r\n\r\n## Draft Fix\r\n\r\nSomething like this\r\n\r\n```yaml\r\n  completion:\r\n    name: \"CI Pass Check\"\r\n    needs: [release, cleanup] # Maybe different job than cleanup\r\n    if: ${{ success() || failure() }}\r\n    runs-on: \"ubuntu-22.04\"\r\n    steps:\r\n      - name: CI Passed\r\n        if: ${{ (needs.supported.result == 'success' && needs.other-check.result == 'success') || (needs.supported.result == 'skipped' && needs.other-check.result == 'skipped') }}\r\n        run: |\r\n          echo \"CI workflow completed successfully.\";\r\n\r\n      - name: CI Failed\r\n        if: ${{ needs.supported.result == 'failure' && needs.other-check.result == 'failure' }}\r\n        run: |\r\n          echo \"CI workflow failed at some point.\";\r\n          exit 1;\r\n\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1590186333/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1590197371",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5154#issuecomment-1590197371",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5154",
    "id": 1590197371,
    "node_id": "IC_kwDOGBlvNc5eyHx7",
    "user": {
      "login": "Evalir",
      "id": 26014927,
      "node_id": "MDQ6VXNlcjI2MDE0OTI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Evalir",
      "html_url": "https://github.com/Evalir",
      "followers_url": "https://api.github.com/users/Evalir/followers",
      "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
      "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
      "organizations_url": "https://api.github.com/users/Evalir/orgs",
      "repos_url": "https://api.github.com/users/Evalir/repos",
      "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Evalir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-13T23:38:51Z",
    "updated_at": "2023-06-13T23:38:51Z",
    "author_association": "MEMBER",
    "body": "ty sir for this—looked into it, turns out this was caused by IPC not compiling on windows. This was fixed today: 087837ec9748a21b8732a2085521194e1f1346c9\r\n\r\na new job is running which should pass https://github.com/foundry-rs/foundry/actions/runs/5261179484",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1590197371/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
