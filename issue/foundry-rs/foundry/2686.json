{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2686",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2686/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2686/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2686/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/2686",
  "id": 1333944249,
  "node_id": "I_kwDOGBlvNc5Pgl-5",
  "number": 2686,
  "title": "Anvil - trace_transaction for transactions executed before fork",
  "user": {
    "login": "naddison36",
    "id": 6491112,
    "node_id": "MDQ6VXNlcjY0OTExMTI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6491112?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/naddison36",
    "html_url": "https://github.com/naddison36",
    "followers_url": "https://api.github.com/users/naddison36/followers",
    "following_url": "https://api.github.com/users/naddison36/following{/other_user}",
    "gists_url": "https://api.github.com/users/naddison36/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/naddison36/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/naddison36/subscriptions",
    "organizations_url": "https://api.github.com/users/naddison36/orgs",
    "repos_url": "https://api.github.com/users/naddison36/repos",
    "events_url": "https://api.github.com/users/naddison36/events{/privacy}",
    "received_events_url": "https://api.github.com/users/naddison36/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3593644820,
      "node_id": "LA_kwDOGBlvNc7WMqsU",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-feature",
      "name": "T-feature",
      "color": "BFD4F2",
      "default": false,
      "description": "Type: feature"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-08-10T01:20:46Z",
  "updated_at": "2022-08-11T17:57:59Z",
  "closed_at": "2022-08-11T17:57:59Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nAnvil\n\n### Describe the feature you would like\n\nThe main use case I have for using Anvil is to trace transactions from Mainnet or other chains like Polygon and Arbitrum.\r\nNot all Ethereum node providers support tracing and the ones that do required paid plans to call `trace_transaction` or `debug_traceTransaction`. By connecting Anvil to an archive node, I can trace a transaction connected to an archive node provider. eg Alchemy\r\n\r\nIdeally, I'd like to fork from a block and then trace a transaction from that block or earlier.\r\nThis is not how Anvil currently works, though. If the transaction was not executed on Anvil, it will send the `trace_transaction` request to the node provider. This will fail as only a limited number of providers support `trace_transaction` and they require paid plans. For example\r\n```\r\n\"trace_transaction is not available on the Free tier - upgrade to Growth or Enterprise for access.\r\n```\r\n\r\nThe workaround is to fork the previous block and then send a copy of the transaction to Anvil. `trace_transaction`  will then work as the tx was executed on Anvil.\n\n### Additional context\n\nFYI, Hardhat node can run `debug_traceTransaction` against transactions from before it was forked. The problem is it's extremely slow and doesn't support the `tracer` option for `debug_traceTransaction` or `trace_transaction`.",
  "closed_by": {
    "login": "onbjerg",
    "id": 8862627,
    "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/onbjerg",
    "html_url": "https://github.com/onbjerg",
    "followers_url": "https://api.github.com/users/onbjerg/followers",
    "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
    "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
    "organizations_url": "https://api.github.com/users/onbjerg/orgs",
    "repos_url": "https://api.github.com/users/onbjerg/repos",
    "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
    "received_events_url": "https://api.github.com/users/onbjerg/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2686/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2686/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1210705331",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2686#issuecomment-1210705331",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2686",
    "id": 1210705331,
    "node_id": "IC_kwDOGBlvNc5IKeWz",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-10T13:51:44Z",
    "updated_at": "2022-08-10T13:51:44Z",
    "author_association": "MEMBER",
    "body": "linking this to https://github.com/foundry-rs/foundry/issues/2673 as this should use the same code.\r\n\r\nwe already can replay entire blocks, the logic should moved to `evm` crate so it can be used as cmd and by anvil",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1210705331/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1212304511",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2686#issuecomment-1212304511",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2686",
    "id": 1212304511,
    "node_id": "IC_kwDOGBlvNc5IQkx_",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-11T17:57:59Z",
    "updated_at": "2022-08-11T17:57:59Z",
    "author_association": "MEMBER",
    "body": "Closing as duplicate of #2673 since the underlying code will be the same",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1212304511/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
