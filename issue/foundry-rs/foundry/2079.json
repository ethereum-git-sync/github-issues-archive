{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2079",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2079/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2079/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2079/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/2079",
  "id": 1280612855,
  "node_id": "I_kwDOGBlvNc5MVJn3",
  "number": 2079,
  "title": "Option to preserve directories in `out` artifacts",
  "user": {
    "login": "holic",
    "id": 508855,
    "node_id": "MDQ6VXNlcjUwODg1NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/508855?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holic",
    "html_url": "https://github.com/holic",
    "followers_url": "https://api.github.com/users/holic/followers",
    "following_url": "https://api.github.com/users/holic/following{/other_user}",
    "gists_url": "https://api.github.com/users/holic/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holic/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holic/subscriptions",
    "organizations_url": "https://api.github.com/users/holic/orgs",
    "repos_url": "https://api.github.com/users/holic/repos",
    "events_url": "https://api.github.com/users/holic/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holic/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3593644820,
      "node_id": "LA_kwDOGBlvNc7WMqsU",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-feature",
      "name": "T-feature",
      "color": "BFD4F2",
      "default": false,
      "description": "Type: feature"
    },
    {
      "id": 3703752787,
      "node_id": "LA_kwDOGBlvNc7cwshT",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-forge",
      "name": "C-forge",
      "color": "5319E7",
      "default": false,
      "description": "Command: forge"
    },
    {
      "id": 3777098561,
      "node_id": "LA_kwDOGBlvNc7hIfNB",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/Cmd-forge-build",
      "name": "Cmd-forge-build",
      "color": "006B75",
      "default": false,
      "description": "Command: forge build"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2022-06-22T17:33:22Z",
  "updated_at": "2023-10-20T07:16:49Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Describe the feature you would like\r\n\r\nForge writes out Solidity artifacts in a flat structure. Is it possible to allow for maintaining the directory structure (or at least the top level directories like `src` `lib` and `test`) inside the artifacts `out`?\r\n\r\nI am using TypeChain to generate TS types for contracts and when I point it at the `out` directory, I get a lot of typed files for Solidity that I'll never end up using (mostly test stuff). I am able to exclude files with `.t.sol` extensions but it doesn't help for transitive dependencies like `Test.sol` and `Vm.sol` and `console.sol` from `forge-std`.\r\n\r\nMy typechain command looks something like:\r\n```bash\r\ntypechain --target ethers-v5 \"out/**/!(*.t|test).sol/!(*.abi).json\" --out-dir types\r\n```\r\n\r\nI'd rather not have to maintain a list of every contract/solidity file to generate types for and update that as I add more to the list. A slightly more nested directory structure in `out` would help with this and could use a glob like:\r\n```bash\r\ntypechain --target ethers-v5 \"out/src/**/!(*.abi).json\" --out-dir types\r\n```\r\n\r\nAlso open to other ideas!\r\n\r\n### Additional context\r\n\r\nHere's an example repo using forge: https://github.com/holic/web3-scaffold\r\n\r\nAnd a recent PR that moves from `ds-test` to `forge-std`: https://github.com/holic/web3-scaffold/pull/20\r\n\r\nI've opted to generate types (and compile down to JS) + check them into the repo for ease of use when importing them into/using them from the app package. I have a CI script that ensures the built files are up to date with the source files. (This was all previously done at deploy time but added too much time to the deploy step, which happens more often than editing Solidity).",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2079/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2079/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1163420444",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2079#issuecomment-1163420444",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2079",
    "id": 1163420444,
    "node_id": "IC_kwDOGBlvNc5FWGMc",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-22T17:35:48Z",
    "updated_at": "2022-06-22T17:36:02Z",
    "author_association": "MEMBER",
    "body": "Related #1488",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1163420444/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1163424027",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2079#issuecomment-1163424027",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2079",
    "id": 1163424027,
    "node_id": "IC_kwDOGBlvNc5FWHEb",
    "user": {
      "login": "mattsse",
      "id": 19890894,
      "node_id": "MDQ6VXNlcjE5ODkwODk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/19890894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mattsse",
      "html_url": "https://github.com/mattsse",
      "followers_url": "https://api.github.com/users/mattsse/followers",
      "following_url": "https://api.github.com/users/mattsse/following{/other_user}",
      "gists_url": "https://api.github.com/users/mattsse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mattsse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mattsse/subscriptions",
      "organizations_url": "https://api.github.com/users/mattsse/orgs",
      "repos_url": "https://api.github.com/users/mattsse/repos",
      "events_url": "https://api.github.com/users/mattsse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mattsse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-22T17:39:55Z",
    "updated_at": "2022-06-22T17:39:55Z",
    "author_association": "MEMBER",
    "body": "this is a reasonable request and probably the best solution for #1488\r\n\r\nI think I can make this happen on ethers-solc which is responsible for emitting artifacts. \r\nI'll make this optional first and then we can decide whether we make this or some adjacent layout the default",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1163424027/reactions",
      "total_count": 3,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1163436058",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2079#issuecomment-1163436058",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2079",
    "id": 1163436058,
    "node_id": "IC_kwDOGBlvNc5FWKAa",
    "user": {
      "login": "holic",
      "id": 508855,
      "node_id": "MDQ6VXNlcjUwODg1NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/508855?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holic",
      "html_url": "https://github.com/holic",
      "followers_url": "https://api.github.com/users/holic/followers",
      "following_url": "https://api.github.com/users/holic/following{/other_user}",
      "gists_url": "https://api.github.com/users/holic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holic/subscriptions",
      "organizations_url": "https://api.github.com/users/holic/orgs",
      "repos_url": "https://api.github.com/users/holic/repos",
      "events_url": "https://api.github.com/users/holic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-22T17:53:02Z",
    "updated_at": "2022-06-22T17:53:02Z",
    "author_association": "NONE",
    "body": "Rad, thanks ya'll ðŸ™ ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1163436058/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1165712373",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2079#issuecomment-1165712373",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2079",
    "id": 1165712373,
    "node_id": "IC_kwDOGBlvNc5Fe1v1",
    "user": {
      "login": "tynes",
      "id": 6626818,
      "node_id": "MDQ6VXNlcjY2MjY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6626818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tynes",
      "html_url": "https://github.com/tynes",
      "followers_url": "https://api.github.com/users/tynes/followers",
      "following_url": "https://api.github.com/users/tynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/tynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tynes/subscriptions",
      "organizations_url": "https://api.github.com/users/tynes/orgs",
      "repos_url": "https://api.github.com/users/tynes/repos",
      "events_url": "https://api.github.com/users/tynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-24T15:59:40Z",
    "updated_at": "2022-06-24T15:59:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "We use typechain with https://github.com/foundry-rs/hardhat which creates hardhat style artifacts that typechain can consume",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1165712373/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1212399541",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2079#issuecomment-1212399541",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2079",
    "id": 1212399541,
    "node_id": "IC_kwDOGBlvNc5IQ7-1",
    "user": {
      "login": "onbjerg",
      "id": 8862627,
      "node_id": "MDQ6VXNlcjg4NjI2Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8862627?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/onbjerg",
      "html_url": "https://github.com/onbjerg",
      "followers_url": "https://api.github.com/users/onbjerg/followers",
      "following_url": "https://api.github.com/users/onbjerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/onbjerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/onbjerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/onbjerg/subscriptions",
      "organizations_url": "https://api.github.com/users/onbjerg/orgs",
      "repos_url": "https://api.github.com/users/onbjerg/repos",
      "events_url": "https://api.github.com/users/onbjerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/onbjerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-11T19:28:27Z",
    "updated_at": "2022-08-11T19:28:27Z",
    "author_association": "MEMBER",
    "body": "Note here: This should be an optional mode",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1212399541/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1772194192",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2079#issuecomment-1772194192",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2079",
    "id": 1772194192,
    "node_id": "IC_kwDOGBlvNc5poYmQ",
    "user": {
      "login": "hellowodl",
      "id": 40890064,
      "node_id": "MDQ6VXNlcjQwODkwMDY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/40890064?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hellowodl",
      "html_url": "https://github.com/hellowodl",
      "followers_url": "https://api.github.com/users/hellowodl/followers",
      "following_url": "https://api.github.com/users/hellowodl/following{/other_user}",
      "gists_url": "https://api.github.com/users/hellowodl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hellowodl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hellowodl/subscriptions",
      "organizations_url": "https://api.github.com/users/hellowodl/orgs",
      "repos_url": "https://api.github.com/users/hellowodl/repos",
      "events_url": "https://api.github.com/users/hellowodl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hellowodl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-20T07:02:32Z",
    "updated_at": "2023-10-20T07:16:49Z",
    "author_association": "NONE",
    "body": "> We use typechain with https://github.com/foundry-rs/hardhat which creates hardhat style artifacts that typechain can consume\r\n\r\nIn order to not tempt coworkers into using Hardhat functionality when there's an alternative within Foundry itself, I've opted to write a script that generates & executes a TypeChain command based upon the files available in ./src/\r\n\r\n```js\r\nimport { glob } from \"glob\";\r\nimport { basename, normalize } from \"node:path\";\r\n\r\nconst files = (await glob(\"./src/**/*.sol\")).map((str) => basename(str));\r\n\r\nconst { stdout, stderr } = Bun.spawn([\r\n  \"bun\",\r\n  \"typechain\",\r\n  \"--target=ethers-v6\",\r\n  normalize(`./out/{${files.join(\",\")}}/*.json`),\r\n]);\r\n```\r\nIt's written with Bun, though it should be fairly simple to convert it to node.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1772194192/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
