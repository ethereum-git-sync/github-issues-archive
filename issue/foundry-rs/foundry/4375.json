{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/4375",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4375/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4375/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4375/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/4375",
  "id": 1588644274,
  "node_id": "I_kwDOGBlvNc5esMmy",
  "number": 4375,
  "title": "forge bind generates extraneous bindings ",
  "user": {
    "login": "FrankieIsLost",
    "id": 88221686,
    "node_id": "MDQ6VXNlcjg4MjIxNjg2",
    "avatar_url": "https://avatars.githubusercontent.com/u/88221686?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/FrankieIsLost",
    "html_url": "https://github.com/FrankieIsLost",
    "followers_url": "https://api.github.com/users/FrankieIsLost/followers",
    "following_url": "https://api.github.com/users/FrankieIsLost/following{/other_user}",
    "gists_url": "https://api.github.com/users/FrankieIsLost/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/FrankieIsLost/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/FrankieIsLost/subscriptions",
    "organizations_url": "https://api.github.com/users/FrankieIsLost/orgs",
    "repos_url": "https://api.github.com/users/FrankieIsLost/repos",
    "events_url": "https://api.github.com/users/FrankieIsLost/events{/privacy}",
    "received_events_url": "https://api.github.com/users/FrankieIsLost/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-02-17T02:06:00Z",
  "updated_at": "2023-02-17T02:21:33Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Component\r\n\r\nForge\r\n\r\n### Have you ensured that all of these are up to date?\r\n\r\n- [X] Foundry\r\n- [X] Foundryup\r\n\r\n### What version of Foundry are you on?\r\n\r\nforge 0.2.0 (54e02a7 2023-02-15T19:38:32.464976Z)\r\n\r\n### What command(s) is the bug in?\r\n\r\nforge bind \r\n\r\n### Operating System\r\n\r\nmacOS (Apple Silicon)\r\n\r\n### Describe the bug\r\n\r\nRunning `forge bind` tends to generate more bindings than expected, resulting in larger-than-needed crates with irrelevant modules. For example, running `forge bind --bindings-path ./bindings --crate-name bindings` in the [ArtGobblers repo](https://github.com/artgobblers/art-gobblers) generates a crate with 37 modules. Most users would likely expect only 7 modules to be created here (one for each contract in the src directory).\r\n\r\nThe issue seems to be that `forge bind` generates a binding module for every artifact generated by `forge build`, while excluding certain patterns [here](https://github.com/foundry-rs/foundry/blob/ecddbdb5081d9bce725d91a62d7ebc96f2701616/cli/src/cmd/forge/bind.rs#LL130C12-L130C12). However, it's easy for the list to fall out of date (for example, when new Std contracts are added). \r\n\r\nAnother issue is that bindings are generated for each contract in the inheritance graph. If I have `contract A is ERC20` in my `src` directory, I likely only want to generate bindings for `A`, not both `A` and `ERC20`. \r\n\r\nOne possible solution might be generate bindings only for contracts defined in the `src` directory, instead of the current approach of generating contracts for every artifact in the build output, and then filtering out the test/script contracts. \r\n\r\n ",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/4375/reactions",
    "total_count": 1,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 1,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4375/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1433996553",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4375#issuecomment-1433996553",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4375",
    "id": 1433996553,
    "node_id": "IC_kwDOGBlvNc5VeQ0J",
    "user": {
      "login": "gakonst",
      "id": 17802178,
      "node_id": "MDQ6VXNlcjE3ODAyMTc4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17802178?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gakonst",
      "html_url": "https://github.com/gakonst",
      "followers_url": "https://api.github.com/users/gakonst/followers",
      "following_url": "https://api.github.com/users/gakonst/following{/other_user}",
      "gists_url": "https://api.github.com/users/gakonst/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gakonst/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gakonst/subscriptions",
      "organizations_url": "https://api.github.com/users/gakonst/orgs",
      "repos_url": "https://api.github.com/users/gakonst/repos",
      "events_url": "https://api.github.com/users/gakonst/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gakonst/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-17T02:08:57Z",
    "updated_at": "2023-02-17T02:08:57Z",
    "author_association": "MEMBER",
    "body": "@mattsse @prestwich should we make it default to only generating the `src` dir? and have the option to bind everything if the user opts in? not sure if @prestwich you use bindings to deps. maybe it's useful in some weird monorepo setup?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1433996553/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1433997992",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4375#issuecomment-1433997992",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4375",
    "id": 1433997992,
    "node_id": "IC_kwDOGBlvNc5VeRKo",
    "user": {
      "login": "prestwich",
      "id": 10149425,
      "node_id": "MDQ6VXNlcjEwMTQ5NDI1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10149425?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestwich",
      "html_url": "https://github.com/prestwich",
      "followers_url": "https://api.github.com/users/prestwich/followers",
      "following_url": "https://api.github.com/users/prestwich/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestwich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestwich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestwich/subscriptions",
      "organizations_url": "https://api.github.com/users/prestwich/orgs",
      "repos_url": "https://api.github.com/users/prestwich/repos",
      "events_url": "https://api.github.com/users/prestwich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestwich/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-17T02:11:20Z",
    "updated_at": "2023-02-17T02:11:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "`forge bind` uses the `out/` dir, which doesn't preserve the `src` layout, and will include extraneous files. we should probably solve this with filtering options?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1433997992/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1434004597",
    "html_url": "https://github.com/foundry-rs/foundry/issues/4375#issuecomment-1434004597",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/4375",
    "id": 1434004597,
    "node_id": "IC_kwDOGBlvNc5VeSx1",
    "user": {
      "login": "FrankieIsLost",
      "id": 88221686,
      "node_id": "MDQ6VXNlcjg4MjIxNjg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/88221686?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/FrankieIsLost",
      "html_url": "https://github.com/FrankieIsLost",
      "followers_url": "https://api.github.com/users/FrankieIsLost/followers",
      "following_url": "https://api.github.com/users/FrankieIsLost/following{/other_user}",
      "gists_url": "https://api.github.com/users/FrankieIsLost/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/FrankieIsLost/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/FrankieIsLost/subscriptions",
      "organizations_url": "https://api.github.com/users/FrankieIsLost/orgs",
      "repos_url": "https://api.github.com/users/FrankieIsLost/repos",
      "events_url": "https://api.github.com/users/FrankieIsLost/events{/privacy}",
      "received_events_url": "https://api.github.com/users/FrankieIsLost/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-17T02:21:33Z",
    "updated_at": "2023-02-17T02:21:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "one option might be to use `compilationTarget` in the artifact metadata, which seems to contain a path to the source file, but not sure how reliable this is ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1434004597/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
