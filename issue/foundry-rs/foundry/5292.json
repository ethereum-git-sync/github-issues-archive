{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/5292",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5292/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5292/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5292/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/5292",
  "id": 1788081083,
  "node_id": "I_kwDOGBlvNc5qk_O7",
  "number": 5292,
  "title": "Getting an error when running forge test",
  "user": {
    "login": "vhawk19",
    "id": 24829996,
    "node_id": "MDQ6VXNlcjI0ODI5OTk2",
    "avatar_url": "https://avatars.githubusercontent.com/u/24829996?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vhawk19",
    "html_url": "https://github.com/vhawk19",
    "followers_url": "https://api.github.com/users/vhawk19/followers",
    "following_url": "https://api.github.com/users/vhawk19/following{/other_user}",
    "gists_url": "https://api.github.com/users/vhawk19/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vhawk19/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vhawk19/subscriptions",
    "organizations_url": "https://api.github.com/users/vhawk19/orgs",
    "repos_url": "https://api.github.com/users/vhawk19/repos",
    "events_url": "https://api.github.com/users/vhawk19/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vhawk19/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-07-04T14:46:58Z",
  "updated_at": "2023-07-04T15:48:07Z",
  "closed_at": "2023-07-04T15:48:06Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nForge\n\n### Have you ensured that all of these are up to date?\n\n- [X] Foundry\n- [X] Foundryup\n\n### What version of Foundry are you on?\n\nforge 0.2.0 (43974b0 2023-05-09T00:17:51.920839000Z)\n\n### What command(s) is the bug in?\n\nforge test\n\n### Operating System\n\nmacOS (Apple Silicon)\n\n### Describe the bug\n\nWhen running a test from a forkt, I am encountering this error from `forge` looks like an error from the storage. Is this conclusive of anything?:\r\n```2023-07-04T14:38:13.493498Z ERROR sharedbackend: Failed to send/recv `basic` err=GetAccount(0xb64e280e9d1b5dbec4accedb2257a87b400db149,\r\n(code: -32000, message: missing trie node c9d3e0f8bda4532a36686f260b763beac7a2b1686946ced6cbe300d9cb9d4221 (path ) <nil>, data: None)) address=0xb64e280e9d1b5dbec4accedb2257a87b400db149\r\n2023-07-04T14:38:13.493759Z ERROR forge::runner: err=Eyre(\r\nbackend: failed while inspecting: Database(GetAccount(0xb64e280e9d1b5dbec4accedb2257a87b400db149,\r\n(code: -32000, message: missing trie node c9d3e0f8bda4532a36686f260b763beac7a2b1686946ced6cbe300d9cb9d4221 (path ) <nil>, data: None))))\r\n2023-07-04T14:38:13.826844Z ERROR sharedbackend: Failed to send/recv `storage` err=GetStorage(0x0180dee5df18ebf76642e50faaef426f7b2874f7, 24104238192154634397086764757107460916121686968778083312312813627901926985726,\r\n(code: -32000, message: missing trie node c9d3e0f8bda4532a36686f260b763beac7a2b1686946ced6cbe300d9cb9d4221 (path ) <nil>, data: None)) address=0x0180dee5df18ebf76642e50faaef426f7b2874f7 index=0x354a83ed9988f79f6038d4c7a7dadbad8af32f4ad6df893e0e5807a1b1944ffe_U256\r\n2023-07-04T14:38:13.827326Z ERROR forge::runner: err=Eyre(\r\nbackend: failed while inspecting: Database(GetStorage(0x0180dee5df18ebf76642e50faaef426f7b2874f7, 24104238192154634397086764757107460916121686968778083312312813627901926985726,\r\n(code: -32000, message: missing trie node c9d3e0f8bda4532a36686f260b763beac7a2b1686946ced6cbe300d9cb9d4221 (path ) <nil>, data: None))))```",
  "closed_by": {
    "login": "Evalir",
    "id": 26014927,
    "node_id": "MDQ6VXNlcjI2MDE0OTI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Evalir",
    "html_url": "https://github.com/Evalir",
    "followers_url": "https://api.github.com/users/Evalir/followers",
    "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
    "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
    "organizations_url": "https://api.github.com/users/Evalir/orgs",
    "repos_url": "https://api.github.com/users/Evalir/repos",
    "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Evalir/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/5292/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5292/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1620461534",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5292#issuecomment-1620461534",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5292",
    "id": 1620461534,
    "node_id": "IC_kwDOGBlvNc5glkfe",
    "user": {
      "login": "klkvr",
      "id": 62447812,
      "node_id": "MDQ6VXNlcjYyNDQ3ODEy",
      "avatar_url": "https://avatars.githubusercontent.com/u/62447812?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/klkvr",
      "html_url": "https://github.com/klkvr",
      "followers_url": "https://api.github.com/users/klkvr/followers",
      "following_url": "https://api.github.com/users/klkvr/following{/other_user}",
      "gists_url": "https://api.github.com/users/klkvr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/klkvr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/klkvr/subscriptions",
      "organizations_url": "https://api.github.com/users/klkvr/orgs",
      "repos_url": "https://api.github.com/users/klkvr/repos",
      "events_url": "https://api.github.com/users/klkvr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/klkvr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-04T15:38:38Z",
    "updated_at": "2023-07-04T15:38:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "This error is coming from an rpc provider and caused by querying data too far in past. This may happen in case when you are querying non-archive node and your tests are running so long that the block at which you forked the chain has already been pruned after some time. One of possible solutions could be to change RPC-provider to infura or alchemy rpc, or some another archive data provider",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1620461534/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1620472696",
    "html_url": "https://github.com/foundry-rs/foundry/issues/5292#issuecomment-1620472696",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/5292",
    "id": 1620472696,
    "node_id": "IC_kwDOGBlvNc5glnN4",
    "user": {
      "login": "Evalir",
      "id": 26014927,
      "node_id": "MDQ6VXNlcjI2MDE0OTI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/26014927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Evalir",
      "html_url": "https://github.com/Evalir",
      "followers_url": "https://api.github.com/users/Evalir/followers",
      "following_url": "https://api.github.com/users/Evalir/following{/other_user}",
      "gists_url": "https://api.github.com/users/Evalir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Evalir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Evalir/subscriptions",
      "organizations_url": "https://api.github.com/users/Evalir/orgs",
      "repos_url": "https://api.github.com/users/Evalir/repos",
      "events_url": "https://api.github.com/users/Evalir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Evalir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-04T15:48:06Z",
    "updated_at": "2023-07-04T15:48:06Z",
    "author_association": "MEMBER",
    "body": "Indeed, as @klkvr commented this is due to your RPC provider. If you're forking from old blocks, you'll need archive functionalityâ€”if not, it will fail as the node won't have the data needed.\r\n\r\nClosing, as not related to foundry.",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1620472696/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
