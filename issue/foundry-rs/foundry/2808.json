{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2808",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2808/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2808/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2808/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/2808",
  "id": 1341310353,
  "node_id": "I_kwDOGBlvNc5P8sWR",
  "number": 2808,
  "title": "Verification exits without warning when importing files from outside of `src` folder",
  "user": {
    "login": "jordaniza",
    "id": 45881807,
    "node_id": "MDQ6VXNlcjQ1ODgxODA3",
    "avatar_url": "https://avatars.githubusercontent.com/u/45881807?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jordaniza",
    "html_url": "https://github.com/jordaniza",
    "followers_url": "https://api.github.com/users/jordaniza/followers",
    "following_url": "https://api.github.com/users/jordaniza/following{/other_user}",
    "gists_url": "https://api.github.com/users/jordaniza/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jordaniza/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jordaniza/subscriptions",
    "organizations_url": "https://api.github.com/users/jordaniza/orgs",
    "repos_url": "https://api.github.com/users/jordaniza/repos",
    "events_url": "https://api.github.com/users/jordaniza/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jordaniza/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    },
    {
      "id": 3703752787,
      "node_id": "LA_kwDOGBlvNc7cwshT",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/C-forge",
      "name": "C-forge",
      "color": "5319E7",
      "default": false,
      "description": "Command: forge"
    },
    {
      "id": 3854218343,
      "node_id": "LA_kwDOGBlvNc7lurRn",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/Cmd-forge-verify",
      "name": "Cmd-forge-verify",
      "color": "006B75",
      "default": false,
      "description": "Command: forge verify-contract"
    },
    {
      "id": 4182991461,
      "node_id": "LA_kwDOGBlvNc75U2Jl",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/Cmd-forge-script",
      "name": "Cmd-forge-script",
      "color": "006B75",
      "default": false,
      "description": "Command: forge script"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-08-17T07:30:17Z",
  "updated_at": "2023-04-11T21:51:45Z",
  "closed_at": "2023-04-11T21:51:39Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Component\n\nForge\n\n### Have you ensured that all of these are up to date?\n\n- [X] Foundry\n- [X] Foundryup\n\n### What version of Foundry are you on?\n\nforge 0.2.0 (ccb9aa5 2022-08-17T00:03:47.513943128Z)\n\n### What command(s) is the bug in?\n\nforge verify\n\n### Operating System\n\nLinux\n\n### Describe the bug\n\nRelated to [previous issue on verify](https://github.com/foundry-rs/foundry/issues/2807), it's possible to have a directory setup in foundry using remappings like so:\r\n\r\n```\r\n- lib/\r\n- script/\r\n  -- ImportBothContracts.s.sol\r\n- src/\r\n  -- ContractA.sol\r\n- some_other_folder/\r\n  -- ContractB.sol\r\n- remappings.txt\r\n- foundry.toml\r\n```\r\n\r\nIn our case, we had existing repos, audits, deploy scripts and tests in Brownie but needed access to the contracts, so we have been importing contracts from both our newer repos (written in foundry) and older repos (brownie) into single deploy scripts. This works from a scripting, testing perspective, and works quite nicely using remappings to avoid relative imports, but verification specifically struggles with the setup.\r\n\r\nIf my script is something like:\r\n\r\n```ts\r\nimport \"../src/MainContractA.sol\";\r\nimport \"../some_other_folder/ContractB.sol\";\r\n\r\ncontract S is Script {\r\n   function run() public {\r\n      new ContractA();\r\n      new ContractB();\r\n   }\r\n}\r\n```\r\nand I run with `forge script .... --verify --etherscan-api-key 1235 --broadcast`\r\n\r\nThen I will verify contract A but NOT contract B. \r\n\r\nI am not sure I'd consider this a serious bug, as the forge documentation and foundry.toml ask you to state the source folder. However it is interesting that forge script and forge test work with no problems, and forge verify does not seem to. Instead, it exits verification of Contract B with no messaging. If you ONLY try and deploy Contract B from Script S, you have the issue 2807 where the verification process starts and exits with no indication that it failed to verify.\r\n",
  "closed_by": {
    "login": "mds1",
    "id": 17163988,
    "node_id": "MDQ6VXNlcjE3MTYzOTg4",
    "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mds1",
    "html_url": "https://github.com/mds1",
    "followers_url": "https://api.github.com/users/mds1/followers",
    "following_url": "https://api.github.com/users/mds1/following{/other_user}",
    "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
    "organizations_url": "https://api.github.com/users/mds1/orgs",
    "repos_url": "https://api.github.com/users/mds1/repos",
    "events_url": "https://api.github.com/users/mds1/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mds1/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/2808/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2808/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1217942315",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2808#issuecomment-1217942315",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2808",
    "id": 1217942315,
    "node_id": "IC_kwDOGBlvNc5ImFMr",
    "user": {
      "login": "joshieDo",
      "id": 93316087,
      "node_id": "U_kgDOBY_j9w",
      "avatar_url": "https://avatars.githubusercontent.com/u/93316087?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/joshieDo",
      "html_url": "https://github.com/joshieDo",
      "followers_url": "https://api.github.com/users/joshieDo/followers",
      "following_url": "https://api.github.com/users/joshieDo/following{/other_user}",
      "gists_url": "https://api.github.com/users/joshieDo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/joshieDo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/joshieDo/subscriptions",
      "organizations_url": "https://api.github.com/users/joshieDo/orgs",
      "repos_url": "https://api.github.com/users/joshieDo/repos",
      "events_url": "https://api.github.com/users/joshieDo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/joshieDo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-17T12:26:24Z",
    "updated_at": "2022-08-17T12:26:24Z",
    "author_association": "COLLABORATOR",
    "body": "Unfortunately, I was not able to reproduce this.\r\n\r\nI included `some_other_folder/`  inside the project folder: verified ✅ .\r\nI put `some_other_folder/` outside the project folder, and linked it with remappings: verified ✅ .\r\n\r\nDid I misunderstand the structure?\r\n\r\nIs there a reproducible repo that you can share?",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1217942315/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1217963133",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2808#issuecomment-1217963133",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2808",
    "id": 1217963133,
    "node_id": "IC_kwDOGBlvNc5ImKR9",
    "user": {
      "login": "jordaniza",
      "id": 45881807,
      "node_id": "MDQ6VXNlcjQ1ODgxODA3",
      "avatar_url": "https://avatars.githubusercontent.com/u/45881807?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jordaniza",
      "html_url": "https://github.com/jordaniza",
      "followers_url": "https://api.github.com/users/jordaniza/followers",
      "following_url": "https://api.github.com/users/jordaniza/following{/other_user}",
      "gists_url": "https://api.github.com/users/jordaniza/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jordaniza/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jordaniza/subscriptions",
      "organizations_url": "https://api.github.com/users/jordaniza/orgs",
      "repos_url": "https://api.github.com/users/jordaniza/repos",
      "events_url": "https://api.github.com/users/jordaniza/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jordaniza/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-17T12:46:16Z",
    "updated_at": "2022-08-17T12:46:16Z",
    "author_association": "NONE",
    "body": "Yeah not a problem, I'll share my old kinda funky setup and see if we can find something interesting, will upload it later today. ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1217963133/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1504152150",
    "html_url": "https://github.com/foundry-rs/foundry/issues/2808#issuecomment-1504152150",
    "issue_url": "https://api.github.com/repos/foundry-rs/foundry/issues/2808",
    "id": 1504152150,
    "node_id": "IC_kwDOGBlvNc5Zp4pW",
    "user": {
      "login": "mds1",
      "id": 17163988,
      "node_id": "MDQ6VXNlcjE3MTYzOTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mds1",
      "html_url": "https://github.com/mds1",
      "followers_url": "https://api.github.com/users/mds1/followers",
      "following_url": "https://api.github.com/users/mds1/following{/other_user}",
      "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
      "organizations_url": "https://api.github.com/users/mds1/orgs",
      "repos_url": "https://api.github.com/users/mds1/repos",
      "events_url": "https://api.github.com/users/mds1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mds1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-11T21:51:39Z",
    "updated_at": "2023-04-11T21:51:45Z",
    "author_association": "COLLABORATOR",
    "body": "Since (1) @joshieDo was not able to reproduce, (2) we never got a repro from @jordaniza, and (3) verification code has changed a lot since to make it more robust, I'm going to close this ",
    "reactions": {
      "url": "https://api.github.com/repos/foundry-rs/foundry/issues/comments/1504152150/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
