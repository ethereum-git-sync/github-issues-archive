{
  "url": "https://api.github.com/repos/foundry-rs/foundry/issues/6368",
  "repository_url": "https://api.github.com/repos/foundry-rs/foundry",
  "labels_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6368/labels{/name}",
  "comments_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6368/comments",
  "events_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6368/events",
  "html_url": "https://github.com/foundry-rs/foundry/issues/6368",
  "id": 2002450130,
  "node_id": "I_kwDOGBlvNc53WvbS",
  "number": 6368,
  "title": "`forge script --verify` skips verification silently if etherscan API key is not provided",
  "user": {
    "login": "klkvr",
    "id": 62447812,
    "node_id": "MDQ6VXNlcjYyNDQ3ODEy",
    "avatar_url": "https://avatars.githubusercontent.com/u/62447812?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/klkvr",
    "html_url": "https://github.com/klkvr",
    "followers_url": "https://api.github.com/users/klkvr/followers",
    "following_url": "https://api.github.com/users/klkvr/following{/other_user}",
    "gists_url": "https://api.github.com/users/klkvr/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/klkvr/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/klkvr/subscriptions",
    "organizations_url": "https://api.github.com/users/klkvr/orgs",
    "repos_url": "https://api.github.com/users/klkvr/repos",
    "events_url": "https://api.github.com/users/klkvr/events{/privacy}",
    "received_events_url": "https://api.github.com/users/klkvr/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3334394228,
      "node_id": "MDU6TGFiZWwzMzM0Mzk0MjI4",
      "url": "https://api.github.com/repos/foundry-rs/foundry/labels/T-bug",
      "name": "T-bug",
      "color": "d73a4a",
      "default": false,
      "description": "Type: bug"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2023-11-20T15:25:18Z",
  "updated_at": "2023-11-20T15:25:18Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Component\n\nForge\n\n### Have you ensured that all of these are up to date?\n\n- [ ] Foundry\n- [ ] Foundryup\n\n### What version of Foundry are you on?\n\n_No response_\n\n### What command(s) is the bug in?\n\n_No response_\n\n### Operating System\n\nNone\n\n### Describe the bug\n\nWhen running script with `--verify` flag without providing etherscan API key in either foundry.toml or CLI parameter, verification will be silently skipped. This may be unexpected for user and leave him in uncomfortable position of spending gas on deployment of contracts which were not verified.\r\n\r\nThis happens because of the following snippet: https://github.com/foundry-rs/foundry/blob/3bab117ec76dc1cd63aa6b8ca25eaaef909f2535/crates/forge/bin/cmd/script/sequence.rs#L258-L262\r\n\r\n`verify.etherscan.key` is set in `set_chain` function called.\r\n\r\nhttps://github.com/foundry-rs/foundry/blob/3bab117ec76dc1cd63aa6b8ca25eaaef909f2535/crates/forge/bin/cmd/script/verify.rs#L58-L63\r\n\r\n`get_etherscan_api_key` will return `None` for keys which are not found in `foundry.toml`, env variable or CLI param\r\n\r\nOn the other hand, `forge verify` fails with `ETHERSCAN_API_KEY must be set`, if API key is not found",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/foundry-rs/foundry/issues/6368/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/foundry-rs/foundry/issues/6368/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[

]
