{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/5249",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/5249/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/5249/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/5249/events",
  "html_url": "https://github.com/hyperledger/besu/issues/5249",
  "id": 1633267616,
  "node_id": "I_kwDODE2jmc5hWa-g",
  "number": 5249,
  "title": "QBFT validator smart contract method does not work with london fork with Fees.",
  "user": {
    "login": "D3athGr1p",
    "id": 86771928,
    "node_id": "MDQ6VXNlcjg2NzcxOTI4",
    "avatar_url": "https://avatars.githubusercontent.com/u/86771928?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/D3athGr1p",
    "html_url": "https://github.com/D3athGr1p",
    "followers_url": "https://api.github.com/users/D3athGr1p/followers",
    "following_url": "https://api.github.com/users/D3athGr1p/following{/other_user}",
    "gists_url": "https://api.github.com/users/D3athGr1p/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/D3athGr1p/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/D3athGr1p/subscriptions",
    "organizations_url": "https://api.github.com/users/D3athGr1p/orgs",
    "repos_url": "https://api.github.com/users/D3athGr1p/repos",
    "events_url": "https://api.github.com/users/D3athGr1p/events{/privacy}",
    "received_events_url": "https://api.github.com/users/D3athGr1p/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1537362490,
      "node_id": "MDU6TGFiZWwxNTM3MzYyNDkw",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    },
    {
      "id": 1921587647,
      "node_id": "MDU6TGFiZWwxOTIxNTg3NjQ3",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/TeamGroot",
      "name": "TeamGroot",
      "color": "1d76db",
      "default": false,
      "description": "GH issues worked on by Groot Team"
    },
    {
      "id": 5290172097,
      "node_id": "LA_kwDODE2jmc8AAAABO1GewQ",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/non%20mainnet%20(private%20networks)",
      "name": "non mainnet (private networks)",
      "color": "0052cc",
      "default": false,
      "description": "not related to mainnet features - covers privacy, permissioning, IBFT2, QBFT"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "siladu",
    "id": 2893793,
    "node_id": "MDQ6VXNlcjI4OTM3OTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2893793?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/siladu",
    "html_url": "https://github.com/siladu",
    "followers_url": "https://api.github.com/users/siladu/followers",
    "following_url": "https://api.github.com/users/siladu/following{/other_user}",
    "gists_url": "https://api.github.com/users/siladu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/siladu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/siladu/subscriptions",
    "organizations_url": "https://api.github.com/users/siladu/orgs",
    "repos_url": "https://api.github.com/users/siladu/repos",
    "events_url": "https://api.github.com/users/siladu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/siladu/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "siladu",
      "id": 2893793,
      "node_id": "MDQ6VXNlcjI4OTM3OTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2893793?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/siladu",
      "html_url": "https://github.com/siladu",
      "followers_url": "https://api.github.com/users/siladu/followers",
      "following_url": "https://api.github.com/users/siladu/following{/other_user}",
      "gists_url": "https://api.github.com/users/siladu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/siladu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/siladu/subscriptions",
      "organizations_url": "https://api.github.com/users/siladu/orgs",
      "repos_url": "https://api.github.com/users/siladu/repos",
      "events_url": "https://api.github.com/users/siladu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/siladu/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2023-03-21T05:42:42Z",
  "updated_at": "2023-03-31T06:56:08Z",
  "closed_at": "2023-03-30T05:25:24Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I want to use EIP-1559 fee stucture but when i try using london fork it does not work with validator smart contract. it works fine with blockheader selection method. i tried both way using ```londonBlock: 0``` and \r\n```\r\n\"transitions\": {\r\n      \"qbft\": [\r\n        {\r\n          \"block\": 25,\r\n          \"validatorselectionmode\": \"contract\",\r\n          \"validatorcontractaddress\": \"0x42699A7612A82f1d9C36148af9C77354759b210b\"\r\n        }\r\n      ]\r\n    }\r\n```\r\n\r\nbut i'm getting this error\r\n![image](https://user-images.githubusercontent.com/86771928/226526894-06e906c4-647c-46fe-99a0-1b840f7b60b9.png)\r\n\r\n\r\nas for genesis file  :\r\n```\r\n{\r\n  \"config\": {\r\n    \"chainId\": 878145,\r\n    \"londonBlock\": 0,\r\n    \"berlinBlock\": 0,\r\n    \"qbft\": {\r\n      \"blockperiodseconds\": 2,\r\n      \"epochlength\": 30000,\r\n      \"requesttimeoutseconds\": 4,\r\n      \"blockreward\": \"1500000000000000000\"\r\n    },\r\n    \"transitions\": {\r\n      \"qbft\": [\r\n        {\r\n          \"block\": 50,\r\n          \"validatorselectionmode\": \"contract\",\r\n          \"validatorcontractaddress\": \"0xb9A219631Aed55eBC3D998f17C3840B7eC39C0cc\"\r\n        }\r\n      ]\r\n    }\r\n  },\r\n  \"nonce\": \"0x0\",\r\n  \"timestamp\": \"0x58ee40ba\",\r\n  \"gasLimit\": \"0x47b760\",\r\n  \"difficulty\": \"0x1\",\r\n  \"mixHash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n  \"coinbase\": \"0x0000000000000000000000000000000000000000\",\r\n  \"alloc\": {\r\n    \"f17f52151EbEF6C7334FAD080c5704D77216b732\" : {\r\n      \"balance\" : \"0x446c3b15f9926687d2c40534fdb56400\"\r\n    }\r\n  },\r\n  \"extraData\": \"0xf87aa00000000000000000000000000000000000000000000000000000000000000000f8549447349b0e16718f7439261616c48fd1b92a9d64d7945c2ec9937230a20ab9a6008bc32952d0551c14fc94903e1eedcb60cc27a386ee2879274b2a445bd72a9457a71c05d16403165c21ce27914573ef5ffad819c080c0\"\r\n}\r\n```\r\n\r\nI also tried londonBlock at 55 and my `\"validatorselectionmode\": \"contract\"` at block 50 but still got same issue.\r\n\r\nas for validator smart contract I'm using [ConsenSys](https://github.com/ConsenSys/validator-smart-contracts) and this works fine without london block",
  "closed_by": {
    "login": "siladu",
    "id": 2893793,
    "node_id": "MDQ6VXNlcjI4OTM3OTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2893793?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/siladu",
    "html_url": "https://github.com/siladu",
    "followers_url": "https://api.github.com/users/siladu/followers",
    "following_url": "https://api.github.com/users/siladu/following{/other_user}",
    "gists_url": "https://api.github.com/users/siladu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/siladu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/siladu/subscriptions",
    "organizations_url": "https://api.github.com/users/siladu/orgs",
    "repos_url": "https://api.github.com/users/siladu/repos",
    "events_url": "https://api.github.com/users/siladu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/siladu/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/5249/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/5249/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1477613395",
    "html_url": "https://github.com/hyperledger/besu/issues/5249#issuecomment-1477613395",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/5249",
    "id": 1477613395,
    "node_id": "IC_kwDODE2jmc5YEpdT",
    "user": {
      "login": "notatestuser",
      "id": 1255926,
      "node_id": "MDQ6VXNlcjEyNTU5MjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1255926?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/notatestuser",
      "html_url": "https://github.com/notatestuser",
      "followers_url": "https://api.github.com/users/notatestuser/followers",
      "following_url": "https://api.github.com/users/notatestuser/following{/other_user}",
      "gists_url": "https://api.github.com/users/notatestuser/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/notatestuser/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/notatestuser/subscriptions",
      "organizations_url": "https://api.github.com/users/notatestuser/orgs",
      "repos_url": "https://api.github.com/users/notatestuser/repos",
      "events_url": "https://api.github.com/users/notatestuser/events{/privacy}",
      "received_events_url": "https://api.github.com/users/notatestuser/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-21T10:42:30Z",
    "updated_at": "2023-03-21T10:42:30Z",
    "author_association": "NONE",
    "body": "The solution is here: https://github.com/hyperledger/besu/issues/3883#issuecomment-1162623267\r\n\r\nOr add `\"zeroBaseFee\": true` to the `config` section.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1477613395/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1477763541",
    "html_url": "https://github.com/hyperledger/besu/issues/5249#issuecomment-1477763541",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/5249",
    "id": 1477763541,
    "node_id": "IC_kwDODE2jmc5YFOHV",
    "user": {
      "login": "D3athGr1p",
      "id": 86771928,
      "node_id": "MDQ6VXNlcjg2NzcxOTI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/86771928?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/D3athGr1p",
      "html_url": "https://github.com/D3athGr1p",
      "followers_url": "https://api.github.com/users/D3athGr1p/followers",
      "following_url": "https://api.github.com/users/D3athGr1p/following{/other_user}",
      "gists_url": "https://api.github.com/users/D3athGr1p/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/D3athGr1p/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/D3athGr1p/subscriptions",
      "organizations_url": "https://api.github.com/users/D3athGr1p/orgs",
      "repos_url": "https://api.github.com/users/D3athGr1p/repos",
      "events_url": "https://api.github.com/users/D3athGr1p/events{/privacy}",
      "received_events_url": "https://api.github.com/users/D3athGr1p/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-21T12:35:29Z",
    "updated_at": "2023-03-21T12:35:55Z",
    "author_association": "NONE",
    "body": "Still this is not working for me i already tried this solution\r\n\r\n> The solution is here: [#3883 (comment)](https://github.com/hyperledger/besu/issues/3883#issuecomment-1162623267)\r\n> \r\n> Or add `\"zeroBaseFee\": true` to the `config` section.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1477763541/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1486201458",
    "html_url": "https://github.com/hyperledger/besu/issues/5249#issuecomment-1486201458",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/5249",
    "id": 1486201458,
    "node_id": "IC_kwDODE2jmc5YlaJy",
    "user": {
      "login": "siladu",
      "id": 2893793,
      "node_id": "MDQ6VXNlcjI4OTM3OTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2893793?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/siladu",
      "html_url": "https://github.com/siladu",
      "followers_url": "https://api.github.com/users/siladu/followers",
      "following_url": "https://api.github.com/users/siladu/following{/other_user}",
      "gists_url": "https://api.github.com/users/siladu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/siladu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/siladu/subscriptions",
      "organizations_url": "https://api.github.com/users/siladu/orgs",
      "repos_url": "https://api.github.com/users/siladu/repos",
      "events_url": "https://api.github.com/users/siladu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/siladu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-28T04:33:40Z",
    "updated_at": "2023-03-28T04:34:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "@D3athGr1p - I have recreated your issue. Enabling DEBUG reveals what is likely the actual problem:\r\n> 2023-03-28 14:23:53.040+10:00 | BftProcessorExecutor-QBFT-0 | DEBUG | MainnetTransactionProcessor | Invalid transaction: gasPrice is less than the current BaseFee \r\n\r\nUsing validator contract mode results in an internal \"transaction\"...it's actually a simulated transaction, similar to eth_call which _shouldn't_ charge for the gas cost. Seems the bug is related to requiring a non-zero gas price regardless. Looking into it now.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1486201458/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1491402162",
    "html_url": "https://github.com/hyperledger/besu/issues/5249#issuecomment-1491402162",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/5249",
    "id": 1491402162,
    "node_id": "IC_kwDODE2jmc5Y5P2y",
    "user": {
      "login": "siladu",
      "id": 2893793,
      "node_id": "MDQ6VXNlcjI4OTM3OTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2893793?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/siladu",
      "html_url": "https://github.com/siladu",
      "followers_url": "https://api.github.com/users/siladu/followers",
      "following_url": "https://api.github.com/users/siladu/following{/other_user}",
      "gists_url": "https://api.github.com/users/siladu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/siladu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/siladu/subscriptions",
      "organizations_url": "https://api.github.com/users/siladu/orgs",
      "repos_url": "https://api.github.com/users/siladu/repos",
      "events_url": "https://api.github.com/users/siladu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/siladu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-31T06:52:24Z",
    "updated_at": "2023-03-31T06:52:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "@D3athGr1p This fix is on the besu main branch now, but unreleased. If you'd like to test it out before the next release you can either build from source: https://wiki.hyperledger.org/display/BESU/Building+from+source\r\nOr use the `develop` docker tag: `docker pull hyperledger/besu:develop`",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1491402162/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1491405229",
    "html_url": "https://github.com/hyperledger/besu/issues/5249#issuecomment-1491405229",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/5249",
    "id": 1491405229,
    "node_id": "IC_kwDODE2jmc5Y5Qmt",
    "user": {
      "login": "D3athGr1p",
      "id": 86771928,
      "node_id": "MDQ6VXNlcjg2NzcxOTI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/86771928?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/D3athGr1p",
      "html_url": "https://github.com/D3athGr1p",
      "followers_url": "https://api.github.com/users/D3athGr1p/followers",
      "following_url": "https://api.github.com/users/D3athGr1p/following{/other_user}",
      "gists_url": "https://api.github.com/users/D3athGr1p/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/D3athGr1p/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/D3athGr1p/subscriptions",
      "organizations_url": "https://api.github.com/users/D3athGr1p/orgs",
      "repos_url": "https://api.github.com/users/D3athGr1p/repos",
      "events_url": "https://api.github.com/users/D3athGr1p/events{/privacy}",
      "received_events_url": "https://api.github.com/users/D3athGr1p/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-31T06:55:54Z",
    "updated_at": "2023-03-31T06:56:08Z",
    "author_association": "NONE",
    "body": "> @D3athGr1p This fix is on the besu main branch now, but unreleased. If you'd like to test it out before the next release you can either build from source: https://wiki.hyperledger.org/display/BESU/Building+from+source Or use the `develop` docker tag: `docker pull hyperledger/besu:develop`\r\n\r\nThanks a lot I'll check it out",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1491405229/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
