{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/4048",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/4048/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/4048/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/4048/events",
  "html_url": "https://github.com/hyperledger/besu/issues/4048",
  "id": 1292478787,
  "node_id": "I_kwDODE2jmc5NCalD",
  "number": 4048,
  "title": "Sync fails after reaching last PoW block on Ropsten network",
  "user": {
    "login": "ronaldjmaas",
    "id": 32280203,
    "node_id": "MDQ6VXNlcjMyMjgwMjAz",
    "avatar_url": "https://avatars.githubusercontent.com/u/32280203?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ronaldjmaas",
    "html_url": "https://github.com/ronaldjmaas",
    "followers_url": "https://api.github.com/users/ronaldjmaas/followers",
    "following_url": "https://api.github.com/users/ronaldjmaas/following{/other_user}",
    "gists_url": "https://api.github.com/users/ronaldjmaas/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ronaldjmaas/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ronaldjmaas/subscriptions",
    "organizations_url": "https://api.github.com/users/ronaldjmaas/orgs",
    "repos_url": "https://api.github.com/users/ronaldjmaas/repos",
    "events_url": "https://api.github.com/users/ronaldjmaas/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ronaldjmaas/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-07-04T01:03:28Z",
  "updated_at": "2022-07-11T04:11:47Z",
  "closed_at": "2022-07-11T04:11:47Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!-- Have you done the following? -->\r\n<!--   * read the Code of Conduct? By filing an Issue, you are expected to -->  \r\n<!--     comply with it, including treating everyone with respect: -->\r\n<!--     https://github.com/hyperledger/besu/blob/main/CODE_OF_CONDUCT.md -->\r\n<!--   * Reproduced the issue in the latest version of the software -->\r\n<!--   * Read the debugging docs: https://besu.hyperledger.org/en/stable/HowTo/Monitor/Logging/ -->\r\n<!--   * Duplicate Issue check:  https://github.com/search?q=+is%3Aissue+repo%3Ahyperledger/Besu -->\r\n<!-- Note:  Not all sections will apply to all issue types. -->\r\n\r\n### Description\r\nBesu throws and exception when trying to sync after reaching final PoW block and fails to synchronize to head on the Ropsten network. Restarting Besu did not resolve this.\r\n\r\n### Acceptance Criteria\r\nSuccessfully synchronizes to head on Ropsten network\r\n\r\n### Steps to Reproduce (Bug)\r\n1. Copy snapshot of both Besu data and Lighthouse data that were created on 4 Jne 2022 (a few days before reaching final TTD)\r\n2. Run Besu and Lighthouse clients.\r\n\r\n**Expected behavior:**\r\nBoth Besu client and Lighthouse client successfully synchronize to head. Note this is important in case people want to switch to Besu some time after the merge. Without this issue being fixed, any new user is unable to successfully setup a new node using Besu as execution client.\r\n\r\n**Actual behavior:** \r\nWhen Besu continuous sync after reaching final PoW block it throws an exception and sync stops progressing.\r\n\r\nLogs after Besu reaches final PoW block first:\r\n\r\n[Besu Logs 1.txt](https://github.com/hyperledger/besu/files/9035741/Besu.Logs.1.txt)\r\n\r\nLogs after Lighthouse reaches final PoW block first:\r\n\r\n[Besu Logs 2.txt](https://github.com/hyperledger/besu/files/9035742/Besu.Logs.2.txt)\r\n\r\n**Frequency:** 100%\r\n\r\n### Versions (Add all that apply)\r\n* Software version: 22.4.3\r\n* Java version: openjdk version \"17.0.3\" 2022-04-19\r\n* OS Name & Version: Debian GNU/Linux 11\r\n* Kernel Version: Linux xeon 5.10.0-15-amd64 SMP Debian 5.10.120-1 (2022-06-09) x86_64 GNU/Linux\r\n* Virtual Machine software & version: N/A\r\n* Docker Version: N/A\r\n* Cloud VM, type, size: N/A\r\n\r\n### Smart contract information (If you're reporting an issue arising from deploying or calling a smart contract, please supply related information)\r\n* Solidity version: N/A\r\n* Repo with minimal set of deployable/reproducible contract code - please provide a link: N/A\r\n* Please include specifics on how you are deploying/calling the contract: N/A\r\n* Have you reproduced the issue on other eth clients: No. Geth + Lighthouse combo successfully syncs to head on Ropsten network\r\n\r\n### Additional Information (Add any of the following or anything else that may be relevant)\r\n* Besu setup info - genesis file, config options: /home/besu/besu-v22.4.3/ropsten/bin/besu --data-path=/mnt/ethereum/besu@/ropsten --data-storage-format=BONSAI --network=ROPSTEN --sync-mode=FAST --p2p-port=30307 --rpc-http-enabled --rpc-http-host=0.0.0.0 --host-whitelist='*' --engine-jwt-secret=/mnt/ethereum/besu@/ropsten/jwt-besu-ropsten --engine-host-allowlist='*' --color-enabled=false\r\n* System info - memory, CPU: Intel(R) Xeon(R) CPU E5-2620 v3 @ 2.40GHz, 64 MB RAM, 2 TB SSD\r\n* When repeating the same steps using snapshots of both Besu data and Lighthouse data created on 14 June 2022 (a few days after reaching final TTD), both Lighthouse and Besu are successfully able to sync to the head on the Ropsten network\r\n",
  "closed_by": {
    "login": "ronaldjmaas",
    "id": 32280203,
    "node_id": "MDQ6VXNlcjMyMjgwMjAz",
    "avatar_url": "https://avatars.githubusercontent.com/u/32280203?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ronaldjmaas",
    "html_url": "https://github.com/ronaldjmaas",
    "followers_url": "https://api.github.com/users/ronaldjmaas/followers",
    "following_url": "https://api.github.com/users/ronaldjmaas/following{/other_user}",
    "gists_url": "https://api.github.com/users/ronaldjmaas/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ronaldjmaas/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ronaldjmaas/subscriptions",
    "organizations_url": "https://api.github.com/users/ronaldjmaas/orgs",
    "repos_url": "https://api.github.com/users/ronaldjmaas/repos",
    "events_url": "https://api.github.com/users/ronaldjmaas/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ronaldjmaas/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/4048/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/4048/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1179944671",
    "html_url": "https://github.com/hyperledger/besu/issues/4048#issuecomment-1179944671",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4048",
    "id": 1179944671,
    "node_id": "IC_kwDODE2jmc5GVIbf",
    "user": {
      "login": "ronaldjmaas",
      "id": 32280203,
      "node_id": "MDQ6VXNlcjMyMjgwMjAz",
      "avatar_url": "https://avatars.githubusercontent.com/u/32280203?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ronaldjmaas",
      "html_url": "https://github.com/ronaldjmaas",
      "followers_url": "https://api.github.com/users/ronaldjmaas/followers",
      "following_url": "https://api.github.com/users/ronaldjmaas/following{/other_user}",
      "gists_url": "https://api.github.com/users/ronaldjmaas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ronaldjmaas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ronaldjmaas/subscriptions",
      "organizations_url": "https://api.github.com/users/ronaldjmaas/orgs",
      "repos_url": "https://api.github.com/users/ronaldjmaas/repos",
      "events_url": "https://api.github.com/users/ronaldjmaas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ronaldjmaas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-11T04:11:47Z",
    "updated_at": "2022-07-11T04:11:47Z",
    "author_association": "NONE",
    "body": "Successfully synced both Sepolia and Ropsten from genesis block with Besu 22.4.4. Closing as issue has been resolved.\r\n\r\nThanks for all the hard work.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1179944671/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
