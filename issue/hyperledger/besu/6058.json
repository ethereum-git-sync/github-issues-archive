{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/6058",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/6058/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/6058/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/6058/events",
  "html_url": "https://github.com/hyperledger/besu/issues/6058",
  "id": 1951893294,
  "node_id": "I_kwDODE2jmc50V4cu",
  "number": 6058,
  "title": "[FEATURE REQUEST] Set  DEFAULT_LOWEST_INVALID_KNOWN_NONCE_CACHE configurable, like others transaction pool options",
  "user": {
    "login": "tzdesing",
    "id": 9799146,
    "node_id": "MDQ6VXNlcjk3OTkxNDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9799146?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tzdesing",
    "html_url": "https://github.com/tzdesing",
    "followers_url": "https://api.github.com/users/tzdesing/followers",
    "following_url": "https://api.github.com/users/tzdesing/following{/other_user}",
    "gists_url": "https://api.github.com/users/tzdesing/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tzdesing/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tzdesing/subscriptions",
    "organizations_url": "https://api.github.com/users/tzdesing/orgs",
    "repos_url": "https://api.github.com/users/tzdesing/repos",
    "events_url": "https://api.github.com/users/tzdesing/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tzdesing/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2023-10-19T10:57:08Z",
  "updated_at": "2023-10-20T17:31:56Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!-- Have you done the following? -->\r\n<!--   * read the Code of Conduct? By filing an Issue, you are expected to -->  \r\n<!--     comply with it, including treating everyone with respect: -->\r\n<!--     https://github.com/hyperledger/besu/blob/main/CODE_OF_CONDUCT.md -->\r\n<!--   * Reproduced the issue in the latest version of the software -->\r\n<!--   * Read the debugging docs: https://besu.hyperledger.org/en/stable/HowTo/Monitor/Logging/ -->\r\n<!--   * Duplicate Issue check:  https://github.com/search?q=+is%3Aissue+repo%3Ahyperledger/Besu -->\r\n<!-- Note:  Not all sections will apply to all issue types. -->\r\n\r\n### Description\r\nWe are In a private free gas chain , using QBFT protocol, to implement a national CBDC, when a trasanction get stucked in TX_POOL, that transactions are included in cache. We are unable to send a new transaction with higher gas, so the only way is set our TX_POOL_MAX_SIZE to 0 , and back to default value, then we are able to sent new transactons, but , the invalid transaction was included in cache of validator and we are unable to reset then. because of network rules. So always we sent new transactions BESU will check this cache, and invalidate again because we have a higher nonce.\r\n\r\n### Acceptance Criteria\r\nIF we are able to set LOWEST_INVALID_KNOWN_NONCE_CACHE = 0 on bootstrap of validators nodes, we can transact normally and transactions will not being invalidated every time, because we haven't a cache, in our case this cache isn't necessary. \r\n\r\n\r\n\r\n\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/6058/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/6058/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1770911167",
    "html_url": "https://github.com/hyperledger/besu/issues/6058#issuecomment-1770911167",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/6058",
    "id": 1770911167,
    "node_id": "IC_kwDODE2jmc5pjfW_",
    "user": {
      "login": "alexcostars",
      "id": 6418743,
      "node_id": "MDQ6VXNlcjY0MTg3NDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6418743?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcostars",
      "html_url": "https://github.com/alexcostars",
      "followers_url": "https://api.github.com/users/alexcostars/followers",
      "following_url": "https://api.github.com/users/alexcostars/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcostars/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcostars/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcostars/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcostars/orgs",
      "repos_url": "https://api.github.com/users/alexcostars/repos",
      "events_url": "https://api.github.com/users/alexcostars/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcostars/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-19T12:43:32Z",
    "updated_at": "2023-10-19T12:43:32Z",
    "author_association": "NONE",
    "body": "We are facing the same problem. In our case, we have a lot of accounts that as blocked (all transactions signed by these accounts are getting stuck in TX_POOL).\r\n\r\nOne other option is a command line option that disables invalid nonce cache control.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1770911167/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1773006266",
    "html_url": "https://github.com/hyperledger/besu/issues/6058#issuecomment-1773006266",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/6058",
    "id": 1773006266,
    "node_id": "IC_kwDODE2jmc5pre26",
    "user": {
      "login": "matthew1001",
      "id": 6599269,
      "node_id": "MDQ6VXNlcjY1OTkyNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6599269?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matthew1001",
      "html_url": "https://github.com/matthew1001",
      "followers_url": "https://api.github.com/users/matthew1001/followers",
      "following_url": "https://api.github.com/users/matthew1001/following{/other_user}",
      "gists_url": "https://api.github.com/users/matthew1001/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matthew1001/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matthew1001/subscriptions",
      "organizations_url": "https://api.github.com/users/matthew1001/orgs",
      "repos_url": "https://api.github.com/users/matthew1001/repos",
      "events_url": "https://api.github.com/users/matthew1001/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matthew1001/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-20T16:03:16Z",
    "updated_at": "2023-10-20T16:03:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "I raised a discussion on discord about exactly this issue a couple of days ago: https://discord.com/channels/905194001349627914/905205502940696607/1164623046389272699\r\n\r\nI was considering a PR that would prevent invalid TXs entering the invalid nonce cache if the reason was `NONCE_TOO_LOW` (which is the reason I've seen it happening with). The `NONCE_TOO_LOW` error seems to be the least sensible reason to set the invalid nonce cache to that value - because by definition, you couldn't submit a new TX at that nonce anyway.\r\n\r\nI'll potentially raise that PR, but I think the new layered pool implementation doesn't use an invalid nonce cache. So you could set `--tx-pool=layered` and see if that prevents the invalid nonce cache from blocking up the pool.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1773006266/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1773026889",
    "html_url": "https://github.com/hyperledger/besu/issues/6058#issuecomment-1773026889",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/6058",
    "id": 1773026889,
    "node_id": "IC_kwDODE2jmc5prj5J",
    "user": {
      "login": "matthew1001",
      "id": 6599269,
      "node_id": "MDQ6VXNlcjY1OTkyNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6599269?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matthew1001",
      "html_url": "https://github.com/matthew1001",
      "followers_url": "https://api.github.com/users/matthew1001/followers",
      "following_url": "https://api.github.com/users/matthew1001/following{/other_user}",
      "gists_url": "https://api.github.com/users/matthew1001/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matthew1001/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matthew1001/subscriptions",
      "organizations_url": "https://api.github.com/users/matthew1001/orgs",
      "repos_url": "https://api.github.com/users/matthew1001/repos",
      "events_url": "https://api.github.com/users/matthew1001/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matthew1001/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-20T16:17:05Z",
    "updated_at": "2023-10-20T16:17:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "I've raised https://github.com/hyperledger/besu/pull/6067 which I think could help in a large number of the cases.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1773026889/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1773029476",
    "html_url": "https://github.com/hyperledger/besu/issues/6058#issuecomment-1773029476",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/6058",
    "id": 1773029476,
    "node_id": "IC_kwDODE2jmc5prkhk",
    "user": {
      "login": "matthew1001",
      "id": 6599269,
      "node_id": "MDQ6VXNlcjY1OTkyNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6599269?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matthew1001",
      "html_url": "https://github.com/matthew1001",
      "followers_url": "https://api.github.com/users/matthew1001/followers",
      "following_url": "https://api.github.com/users/matthew1001/following{/other_user}",
      "gists_url": "https://api.github.com/users/matthew1001/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matthew1001/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matthew1001/subscriptions",
      "organizations_url": "https://api.github.com/users/matthew1001/orgs",
      "repos_url": "https://api.github.com/users/matthew1001/repos",
      "events_url": "https://api.github.com/users/matthew1001/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matthew1001/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-20T16:18:58Z",
    "updated_at": "2023-10-20T16:18:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "Note that I think this issue which I raised yesterday is closely related to the scenario described:\r\n\r\nhttps://github.com/hyperledger/besu/issues/6043\r\n\r\nCurrently even if you set `--tx-pool-price-bump=0` you cannot replace existing transactions. I think for QBFT, permissioned deployments it is very difficult to manage the pool through set its max size, or its retention time, when problematic transactions make their way into the pool.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1773029476/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1773122761",
    "html_url": "https://github.com/hyperledger/besu/issues/6058#issuecomment-1773122761",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/6058",
    "id": 1773122761,
    "node_id": "IC_kwDODE2jmc5pr7TJ",
    "user": {
      "login": "alexcostars",
      "id": 6418743,
      "node_id": "MDQ6VXNlcjY0MTg3NDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6418743?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alexcostars",
      "html_url": "https://github.com/alexcostars",
      "followers_url": "https://api.github.com/users/alexcostars/followers",
      "following_url": "https://api.github.com/users/alexcostars/following{/other_user}",
      "gists_url": "https://api.github.com/users/alexcostars/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alexcostars/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alexcostars/subscriptions",
      "organizations_url": "https://api.github.com/users/alexcostars/orgs",
      "repos_url": "https://api.github.com/users/alexcostars/repos",
      "events_url": "https://api.github.com/users/alexcostars/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alexcostars/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-20T17:27:33Z",
    "updated_at": "2023-10-20T17:27:33Z",
    "author_association": "NONE",
    "body": "@matthew1001 as you mentioned, there is a new layered pool implementation. Has this new implementation already been released?",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1773122761/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1773127266",
    "html_url": "https://github.com/hyperledger/besu/issues/6058#issuecomment-1773127266",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/6058",
    "id": 1773127266,
    "node_id": "IC_kwDODE2jmc5pr8Zi",
    "user": {
      "login": "matthew1001",
      "id": 6599269,
      "node_id": "MDQ6VXNlcjY1OTkyNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6599269?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matthew1001",
      "html_url": "https://github.com/matthew1001",
      "followers_url": "https://api.github.com/users/matthew1001/followers",
      "following_url": "https://api.github.com/users/matthew1001/following{/other_user}",
      "gists_url": "https://api.github.com/users/matthew1001/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matthew1001/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matthew1001/subscriptions",
      "organizations_url": "https://api.github.com/users/matthew1001/orgs",
      "repos_url": "https://api.github.com/users/matthew1001/repos",
      "events_url": "https://api.github.com/users/matthew1001/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matthew1001/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-20T17:30:30Z",
    "updated_at": "2023-10-20T17:30:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "> @matthew1001 as you mentioned, there is a new layered pool implementation. Has this new implementation already been released?\n\nYes it's available in 23.10.0 as the default pool implementation.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1773127266/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1773130118",
    "html_url": "https://github.com/hyperledger/besu/issues/6058#issuecomment-1773130118",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/6058",
    "id": 1773130118,
    "node_id": "IC_kwDODE2jmc5pr9GG",
    "user": {
      "login": "matthew1001",
      "id": 6599269,
      "node_id": "MDQ6VXNlcjY1OTkyNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6599269?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matthew1001",
      "html_url": "https://github.com/matthew1001",
      "followers_url": "https://api.github.com/users/matthew1001/followers",
      "following_url": "https://api.github.com/users/matthew1001/following{/other_user}",
      "gists_url": "https://api.github.com/users/matthew1001/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matthew1001/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matthew1001/subscriptions",
      "organizations_url": "https://api.github.com/users/matthew1001/orgs",
      "repos_url": "https://api.github.com/users/matthew1001/repos",
      "events_url": "https://api.github.com/users/matthew1001/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matthew1001/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-20T17:31:56Z",
    "updated_at": "2023-10-20T17:31:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "Before 23.10.0 you need to set `--Xlayered-tx-pool=true` to use it ",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1773130118/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
