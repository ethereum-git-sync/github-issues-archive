{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/2358",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/2358/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/2358/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/2358/events",
  "html_url": "https://github.com/hyperledger/besu/issues/2358",
  "id": 908565913,
  "node_id": "MDU6SXNzdWU5MDg1NjU5MTM=",
  "number": 2358,
  "title": "Hash of proto-block header to block-on-chain mapping",
  "user": {
    "login": "wpwrak",
    "id": 1292352,
    "node_id": "MDQ6VXNlcjEyOTIzNTI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1292352?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wpwrak",
    "html_url": "https://github.com/wpwrak",
    "followers_url": "https://api.github.com/users/wpwrak/followers",
    "following_url": "https://api.github.com/users/wpwrak/following{/other_user}",
    "gists_url": "https://api.github.com/users/wpwrak/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wpwrak/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wpwrak/subscriptions",
    "organizations_url": "https://api.github.com/users/wpwrak/orgs",
    "repos_url": "https://api.github.com/users/wpwrak/repos",
    "events_url": "https://api.github.com/users/wpwrak/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wpwrak/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1537362496,
      "node_id": "MDU6TGFiZWwxNTM3MzYyNDk2",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/enhancement",
      "name": "enhancement",
      "color": "a2eeef",
      "default": true,
      "description": "New feature or request"
    },
    {
      "id": 3033596993,
      "node_id": "MDU6TGFiZWwzMDMzNTk2OTkz",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/mining",
      "name": "mining",
      "color": "2465B3",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-06-01T18:16:09Z",
  "updated_at": "2023-01-28T06:29:35Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Description\r\nAs a miner, I want to be able to easily identify what happened with blocks I mined so that I can see what the pool is doing with them.\r\n\r\nI mentioned this on the ETC discord, and Antoine Toulme suggested I put it on the besu issue tracker.\r\n\r\nThe general problem is as follows: a miner only sees the header-hash of the proto-block (nonce set to 0) but has no easy way to map this header-hash (let's call it the \"miner's hash\") to the block that may end up in the chain. The miner may also not be able to tell whether it has actually found a block or not.\r\n\r\nTo map the miner's hash to a block, the miner would have to retrieve the headers of likely candidates, calculate the corresponding miner's hash for each, until it either finds a match with the miner's hashes for which it has submitted possible solutions, or until it runs out of candidate blocks (which would mean that the block's nonce was either not good enough or that the block didn't make it to he chain for some other reason).\r\n\r\nA more direct lookup would be nice, e.g., in the form of chain explorers offering to find blocks by their miner's hash.  I'm not sure how chain explorers are generally organized, and whether support for such a feature may be inside the scope of clients, like besu.\r\n\r\nBeing able to map miner's hashes (which the miner would have to record) to blocks would allow to track what the pool is doing with the miner's hash power, e.g., whether it is using it for objectionable activities, like running attacks against the chain/coin.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/2358/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/2358/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/888624441",
    "html_url": "https://github.com/hyperledger/besu/issues/2358#issuecomment-888624441",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2358",
    "id": 888624441,
    "node_id": "IC_kwDODE2jmc4091U5",
    "user": {
      "login": "vmichalik",
      "id": 12459761,
      "node_id": "MDQ6VXNlcjEyNDU5NzYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/12459761?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vmichalik",
      "html_url": "https://github.com/vmichalik",
      "followers_url": "https://api.github.com/users/vmichalik/followers",
      "following_url": "https://api.github.com/users/vmichalik/following{/other_user}",
      "gists_url": "https://api.github.com/users/vmichalik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vmichalik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vmichalik/subscriptions",
      "organizations_url": "https://api.github.com/users/vmichalik/orgs",
      "repos_url": "https://api.github.com/users/vmichalik/repos",
      "events_url": "https://api.github.com/users/vmichalik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vmichalik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-28T21:11:47Z",
    "updated_at": "2021-07-28T21:11:47Z",
    "author_association": "NONE",
    "body": "@atoulme FYI as you weren't tagged in-text!",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/888624441/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/888646463",
    "html_url": "https://github.com/hyperledger/besu/issues/2358#issuecomment-888646463",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2358",
    "id": 888646463,
    "node_id": "IC_kwDODE2jmc4096s_",
    "user": {
      "login": "atoulme",
      "id": 16758,
      "node_id": "MDQ6VXNlcjE2NzU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16758?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/atoulme",
      "html_url": "https://github.com/atoulme",
      "followers_url": "https://api.github.com/users/atoulme/followers",
      "following_url": "https://api.github.com/users/atoulme/following{/other_user}",
      "gists_url": "https://api.github.com/users/atoulme/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/atoulme/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/atoulme/subscriptions",
      "organizations_url": "https://api.github.com/users/atoulme/orgs",
      "repos_url": "https://api.github.com/users/atoulme/repos",
      "events_url": "https://api.github.com/users/atoulme/events{/privacy}",
      "received_events_url": "https://api.github.com/users/atoulme/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-28T21:54:18Z",
    "updated_at": "2021-07-28T21:54:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "1. You could potentially use the mix hash of the block that you compute when you send the solution to see if your block makes it. You can also check block bodies to see if your mix hash is the mix hash of a block ommer.\r\n\r\n2. If you're mining directly against the client, you might want to be able to see if the client's computed blocks become part of the canonical chain. I think that's better than adopting a solution where the miner is not trusting the client. In that case, when Besu computes a block and sends it to the network, how do we know if it becomes part of the canonical chain?\r\n\r\nOne way to do the job is to grep Besu logs for this type of log line:\r\n```\r\n2021-07-28 14:49:07.073-07:00 | pool-7-thread-1 | INFO  | BlockMiner | Produced #11 / 0 tx / 0 om / 0 (0.0%) gas / (0x96d26ee96f4b9766b96c6f6a9d3aa5bb14e64c3a8d164b1a0611376ebd0cd8ff) in 2.049s\r\n```\r\nCatch the block hash and test it against the canonical chain after a number of confirmations. This should provide you with assurance that your block was indeed accepted by the chain.\r\n\r\nSo to do this job, you will need to follow the chain entirely and index all block headers and ommer block headers. You will also need to keep track of mix hashes you compute when sending solutions. I hope that helps.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/888646463/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1404822444",
    "html_url": "https://github.com/hyperledger/besu/issues/2358#issuecomment-1404822444",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2358",
    "id": 1404822444,
    "node_id": "IC_kwDODE2jmc5Tu-Os",
    "user": {
      "login": "non-fungible-nelson",
      "id": 85905982,
      "node_id": "MDQ6VXNlcjg1OTA1OTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/85905982?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/non-fungible-nelson",
      "html_url": "https://github.com/non-fungible-nelson",
      "followers_url": "https://api.github.com/users/non-fungible-nelson/followers",
      "following_url": "https://api.github.com/users/non-fungible-nelson/following{/other_user}",
      "gists_url": "https://api.github.com/users/non-fungible-nelson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/non-fungible-nelson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/non-fungible-nelson/subscriptions",
      "organizations_url": "https://api.github.com/users/non-fungible-nelson/orgs",
      "repos_url": "https://api.github.com/users/non-fungible-nelson/repos",
      "events_url": "https://api.github.com/users/non-fungible-nelson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/non-fungible-nelson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-26T10:39:24Z",
    "updated_at": "2023-01-26T10:39:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "@diega @atoulme - still needed?",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1404822444/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1407308420",
    "html_url": "https://github.com/hyperledger/besu/issues/2358#issuecomment-1407308420",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2358",
    "id": 1407308420,
    "node_id": "IC_kwDODE2jmc5T4dKE",
    "user": {
      "login": "atoulme",
      "id": 16758,
      "node_id": "MDQ6VXNlcjE2NzU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16758?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/atoulme",
      "html_url": "https://github.com/atoulme",
      "followers_url": "https://api.github.com/users/atoulme/followers",
      "following_url": "https://api.github.com/users/atoulme/following{/other_user}",
      "gists_url": "https://api.github.com/users/atoulme/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/atoulme/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/atoulme/subscriptions",
      "organizations_url": "https://api.github.com/users/atoulme/orgs",
      "repos_url": "https://api.github.com/users/atoulme/repos",
      "events_url": "https://api.github.com/users/atoulme/events{/privacy}",
      "received_events_url": "https://api.github.com/users/atoulme/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-28T06:29:34Z",
    "updated_at": "2023-01-28T06:29:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "@wpwrak, did my explanation earlier help? Do you still need this enhancement?",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1407308420/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
