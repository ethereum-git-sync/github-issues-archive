{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/5064",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/5064/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/5064/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/5064/events",
  "html_url": "https://github.com/hyperledger/besu/issues/5064",
  "id": 1575406746,
  "node_id": "I_kwDODE2jmc5d5sya",
  "number": 5064,
  "title": "Recent getBlockByNumber changes caused Goerli sync issue",
  "user": {
    "login": "siladu",
    "id": 2893793,
    "node_id": "MDQ6VXNlcjI4OTM3OTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2893793?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/siladu",
    "html_url": "https://github.com/siladu",
    "followers_url": "https://api.github.com/users/siladu/followers",
    "following_url": "https://api.github.com/users/siladu/following{/other_user}",
    "gists_url": "https://api.github.com/users/siladu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/siladu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/siladu/subscriptions",
    "organizations_url": "https://api.github.com/users/siladu/orgs",
    "repos_url": "https://api.github.com/users/siladu/repos",
    "events_url": "https://api.github.com/users/siladu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/siladu/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1921587647,
      "node_id": "MDU6TGFiZWwxOTIxNTg3NjQ3",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/TeamGroot",
      "name": "TeamGroot",
      "color": "1d76db",
      "default": false,
      "description": "GH issues worked on by Groot Team"
    },
    {
      "id": 3013559202,
      "node_id": "MDU6TGFiZWwzMDEzNTU5MjAy",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/mainnet",
      "name": "mainnet",
      "color": "9D578C",
      "default": false,
      "description": ""
    },
    {
      "id": 3372108177,
      "node_id": "MDU6TGFiZWwzMzcyMTA4MTc3",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/EIP",
      "name": "EIP",
      "color": "006b75",
      "default": false,
      "description": "Ethereum Improvement Proposal"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-02-08T03:37:17Z",
  "updated_at": "2023-02-20T23:13:51Z",
  "closed_at": "2023-02-20T23:13:23Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "This commit caused an issue when syncing fresh goerli nodes: https://github.com/hyperledger/besu/commit/9ceebc4a57f648ed412ed6dcbc12a42699fffe54\r\n\r\n`\r\n{\"@timestamp\":\"2023-02-07T21:49:39,513\",\"level\":\"INFO\",\"thread\":\"EthScheduler-Workers-0\",\"class\":\"CoinbaseHeaderValidationRule\",\"message\":\"Invalid block header: No clique in/out voting may occur on epoch blocks (7470000)\",\"throwable\":\"\"}\r\n{\"@timestamp\":\"2023-02-07T21:49:44,311\",\"level\":\"WARN\",\"thread\":\"EthScheduler-Services-800 (downloadHeaders)\",\"class\":\"PipelineChainDownloader\",\"message\":\"Invalid block detected (BREACH_OF_PROTOCOL). Disconnecting from sync target. Header failed validation.: Invalid block at #7470000 (0xaaea1696007267a518ee5c6550742f58c81333e71cdee6c38dc2403b628816e1)\",\"throwable\":\"\"}\r\n`\r\n\r\nThe issue was experienced during 23.1.0-RC2 burn-in, specifically on four of these nodes after needing to resync due to another bug: https://github.com/ConsenSys/protocols-aws-inventories/blob/master/clc-goerli.yml\r\n\r\nThese were all BONSAI, mostly X_SNAP but one FAST.\r\nI then span up a further three nodes to confirm and got the same error with FOREST (with X_SNAP).\r\n\r\nThe issue was **not experienced while syncing sepolia**: https://github.com/ConsenSys/protocols-aws-inventories/blob/master/clc-sepolia.yml\r\n\r\nI am yet to confirm mainnet is unaffected as nodes are still syncing.",
  "closed_by": {
    "login": "iamhsk",
    "id": 2249367,
    "node_id": "MDQ6VXNlcjIyNDkzNjc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2249367?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iamhsk",
    "html_url": "https://github.com/iamhsk",
    "followers_url": "https://api.github.com/users/iamhsk/followers",
    "following_url": "https://api.github.com/users/iamhsk/following{/other_user}",
    "gists_url": "https://api.github.com/users/iamhsk/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iamhsk/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iamhsk/subscriptions",
    "organizations_url": "https://api.github.com/users/iamhsk/orgs",
    "repos_url": "https://api.github.com/users/iamhsk/repos",
    "events_url": "https://api.github.com/users/iamhsk/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iamhsk/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/5064/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/5064/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1421947127",
    "html_url": "https://github.com/hyperledger/besu/issues/5064#issuecomment-1421947127",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/5064",
    "id": 1421947127,
    "node_id": "IC_kwDODE2jmc5UwTD3",
    "user": {
      "login": "jframe",
      "id": 909467,
      "node_id": "MDQ6VXNlcjkwOTQ2Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/909467?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jframe",
      "html_url": "https://github.com/jframe",
      "followers_url": "https://api.github.com/users/jframe/followers",
      "following_url": "https://api.github.com/users/jframe/following{/other_user}",
      "gists_url": "https://api.github.com/users/jframe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jframe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jframe/subscriptions",
      "organizations_url": "https://api.github.com/users/jframe/orgs",
      "repos_url": "https://api.github.com/users/jframe/repos",
      "events_url": "https://api.github.com/users/jframe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jframe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-08T03:39:00Z",
    "updated_at": "2023-02-08T03:46:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "This commit was reverted on main https://github.com/hyperledger/besu/pull/5063",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1421947127/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1421966892",
    "html_url": "https://github.com/hyperledger/besu/issues/5064#issuecomment-1421966892",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/5064",
    "id": 1421966892,
    "node_id": "IC_kwDODE2jmc5UwX4s",
    "user": {
      "login": "siladu",
      "id": 2893793,
      "node_id": "MDQ6VXNlcjI4OTM3OTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2893793?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/siladu",
      "html_url": "https://github.com/siladu",
      "followers_url": "https://api.github.com/users/siladu/followers",
      "following_url": "https://api.github.com/users/siladu/following{/other_user}",
      "gists_url": "https://api.github.com/users/siladu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/siladu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/siladu/subscriptions",
      "organizations_url": "https://api.github.com/users/siladu/orgs",
      "repos_url": "https://api.github.com/users/siladu/repos",
      "events_url": "https://api.github.com/users/siladu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/siladu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-08T04:05:39Z",
    "updated_at": "2023-02-08T04:07:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "To save a full resync, I stopped besu on a node with a database that is synced to just before the issue will occur: \r\n*dev-besu-clc-teku-ohio-goerli-23.1.0-RC2-snap-getByBlockHeader-test*\r\n\r\n`{\"@timestamp\":\"2023-02-08T04:04:07,623\",\"level\":\"INFO\",\"thread\":\"EthScheduler-Services-29 (importBlock)\",\"class\":\"FastImportBlocksStep\",\"message\":\"Block import progress: 7329800 of 8452736 (86%)\",\"throwable\":\"\"}`\r\n\r\nIssue will occur at block #7470000",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1421966892/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1437659501",
    "html_url": "https://github.com/hyperledger/besu/issues/5064#issuecomment-1437659501",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/5064",
    "id": 1437659501,
    "node_id": "IC_kwDODE2jmc5VsPFt",
    "user": {
      "login": "iamhsk",
      "id": 2249367,
      "node_id": "MDQ6VXNlcjIyNDkzNjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2249367?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iamhsk",
      "html_url": "https://github.com/iamhsk",
      "followers_url": "https://api.github.com/users/iamhsk/followers",
      "following_url": "https://api.github.com/users/iamhsk/following{/other_user}",
      "gists_url": "https://api.github.com/users/iamhsk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iamhsk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iamhsk/subscriptions",
      "organizations_url": "https://api.github.com/users/iamhsk/orgs",
      "repos_url": "https://api.github.com/users/iamhsk/repos",
      "events_url": "https://api.github.com/users/iamhsk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iamhsk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-20T23:13:50Z",
    "updated_at": "2023-02-20T23:13:50Z",
    "author_association": "NONE",
    "body": "Related to #4789",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1437659501/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
