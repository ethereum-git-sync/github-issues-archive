{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/4191",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/4191/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/4191/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/4191/events",
  "html_url": "https://github.com/hyperledger/besu/issues/4191",
  "id": 1321007905,
  "node_id": "I_kwDODE2jmc5OvPsh",
  "number": 4191,
  "title": "Warning about missing 'libjemalloc.so' with 22.7.0-RC3 on Ubuntu 22.04 server",
  "user": {
    "login": "remyroy",
    "id": 303593,
    "node_id": "MDQ6VXNlcjMwMzU5Mw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/303593?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/remyroy",
    "html_url": "https://github.com/remyroy",
    "followers_url": "https://api.github.com/users/remyroy/followers",
    "following_url": "https://api.github.com/users/remyroy/following{/other_user}",
    "gists_url": "https://api.github.com/users/remyroy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/remyroy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/remyroy/subscriptions",
    "organizations_url": "https://api.github.com/users/remyroy/orgs",
    "repos_url": "https://api.github.com/users/remyroy/repos",
    "events_url": "https://api.github.com/users/remyroy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/remyroy/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1838110784,
      "node_id": "MDU6TGFiZWwxODM4MTEwNzg0",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/doc-change-required",
      "name": "doc-change-required",
      "color": "fbca04",
      "default": false,
      "description": "Indicates an issue or PR that requires doc to be updated"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "non-fungible-nelson",
    "id": 85905982,
    "node_id": "MDQ6VXNlcjg1OTA1OTgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/85905982?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/non-fungible-nelson",
    "html_url": "https://github.com/non-fungible-nelson",
    "followers_url": "https://api.github.com/users/non-fungible-nelson/followers",
    "following_url": "https://api.github.com/users/non-fungible-nelson/following{/other_user}",
    "gists_url": "https://api.github.com/users/non-fungible-nelson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/non-fungible-nelson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/non-fungible-nelson/subscriptions",
    "organizations_url": "https://api.github.com/users/non-fungible-nelson/orgs",
    "repos_url": "https://api.github.com/users/non-fungible-nelson/repos",
    "events_url": "https://api.github.com/users/non-fungible-nelson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/non-fungible-nelson/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "non-fungible-nelson",
      "id": 85905982,
      "node_id": "MDQ6VXNlcjg1OTA1OTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/85905982?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/non-fungible-nelson",
      "html_url": "https://github.com/non-fungible-nelson",
      "followers_url": "https://api.github.com/users/non-fungible-nelson/followers",
      "following_url": "https://api.github.com/users/non-fungible-nelson/following{/other_user}",
      "gists_url": "https://api.github.com/users/non-fungible-nelson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/non-fungible-nelson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/non-fungible-nelson/subscriptions",
      "organizations_url": "https://api.github.com/users/non-fungible-nelson/orgs",
      "repos_url": "https://api.github.com/users/non-fungible-nelson/repos",
      "events_url": "https://api.github.com/users/non-fungible-nelson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/non-fungible-nelson/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-07-28T14:19:40Z",
  "updated_at": "2022-08-04T12:43:58Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Description\r\nAs a user of Besu, I don't expect to see any error message when starting Besu so that I have a high confidence about my usage of this software. \r\n\r\n### Acceptance Criteria\r\n* No error message is shown when starting Besu.\r\n\r\n### Steps to Reproduce (Bug)\r\n1. Download Besu 22.7.0-RC3 on Ubuntu 22.04 server\r\n2. Install libjemalloc with `sudo apt install libjemalloc2`\r\n3. Install [Eclipse Tumerin JDK from Adoptium](https://adoptium.net/installation/linux/)\r\n4. Start besu with `bin/besu --version`\r\n5. Notice the following error message: `ERROR: ld.so: object 'libjemalloc.so' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.`\r\n\r\n**Expected behavior:** No error message is shown when starting Besu.\r\n\r\n**Actual behavior:** The following error message is shown when starting besu: `ERROR: ld.so: object 'libjemalloc.so' from LD_PRELOAD cannot be preloaded (cannot open shared object file): ignored.`\r\n\r\n**Frequency:** 100% of the time\r\n\r\n### Versions (Add all that apply)\r\n* Software version: `besu/v22.7.0-RC3/linux-x86_64/openjdk-java-17`\r\n* Java version:\r\n```\r\nopenjdk version \"17.0.3\" 2022-04-19\r\nOpenJDK Runtime Environment Temurin-17.0.3+7 (build 17.0.3+7)\r\nOpenJDK 64-Bit Server VM Temurin-17.0.3+7 (build 17.0.3+7, mixed mode, sharing)\r\n```\r\n* OS Name & Version:\r\n```\r\nDISTRIB_ID=Ubuntu\r\nDISTRIB_RELEASE=22.04\r\nDISTRIB_CODENAME=jammy\r\nDISTRIB_DESCRIPTION=\"Ubuntu 22.04 LTS\"\r\nPRETTY_NAME=\"Ubuntu 22.04 LTS\"\r\nNAME=\"Ubuntu\"\r\nVERSION_ID=\"22.04\"\r\nVERSION=\"22.04 LTS (Jammy Jellyfish)\"\r\nVERSION_CODENAME=jammy\r\nID=ubuntu\r\nID_LIKE=debian\r\nHOME_URL=\"https://www.ubuntu.com/\"\r\nSUPPORT_URL=\"https://help.ubuntu.com/\"\r\nBUG_REPORT_URL=\"https://bugs.launchpad.net/ubuntu/\"\r\nPRIVACY_POLICY_URL=\"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\"\r\nUBUNTU_CODENAME=jammy\r\n```\r\n* Kernel Version: `Linux ubuntu-serser-2204 5.15.0-43-generic #46-Ubuntu SMP Tue Jul 12 10:30:17 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux`\r\n* Virtual Machine software & version: VMwareÂ® Workstation 16 Player (16.2.4 build-20089737)\r\n\r\n### Temporary solution\r\n\r\nI edited `/bin/besu` and replaced the LD_PRELOAD line with: `export LD_PRELOAD=libjemalloc.so.2` and it fixed my issue. This might be a naming thing on Ubuntu as the libjemalloc is installed in `/usr/lib/x86_64-linux-gnu/libjemalloc.so.2`.\r\n\r\nOther more elegant solutions might involve using a symlink as part of the installation on Ubuntu or rewriting that unixStartScript to account for different libjemalloc names.\r\n\r\n### Related\r\n\r\nPR who introduced this change: #4126 \r\nAuthor of this change: @garyschulte \r\nReviewer: @jflo ",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/4191/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/4191/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1198279143",
    "html_url": "https://github.com/hyperledger/besu/issues/4191#issuecomment-1198279143",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4191",
    "id": 1198279143,
    "node_id": "IC_kwDODE2jmc5HbEnn",
    "user": {
      "login": "daniellehrner",
      "id": 6727189,
      "node_id": "MDQ6VXNlcjY3MjcxODk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6727189?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/daniellehrner",
      "html_url": "https://github.com/daniellehrner",
      "followers_url": "https://api.github.com/users/daniellehrner/followers",
      "following_url": "https://api.github.com/users/daniellehrner/following{/other_user}",
      "gists_url": "https://api.github.com/users/daniellehrner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/daniellehrner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daniellehrner/subscriptions",
      "organizations_url": "https://api.github.com/users/daniellehrner/orgs",
      "repos_url": "https://api.github.com/users/daniellehrner/repos",
      "events_url": "https://api.github.com/users/daniellehrner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/daniellehrner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-28T15:05:51Z",
    "updated_at": "2022-07-28T15:05:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "@remyroy Could you try to install `libjemalloc-dev`?  We use that one in the docker images and don't see any error message. ",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1198279143/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1198301352",
    "html_url": "https://github.com/hyperledger/besu/issues/4191#issuecomment-1198301352",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4191",
    "id": 1198301352,
    "node_id": "IC_kwDODE2jmc5HbKCo",
    "user": {
      "login": "remyroy",
      "id": 303593,
      "node_id": "MDQ6VXNlcjMwMzU5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/303593?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/remyroy",
      "html_url": "https://github.com/remyroy",
      "followers_url": "https://api.github.com/users/remyroy/followers",
      "following_url": "https://api.github.com/users/remyroy/following{/other_user}",
      "gists_url": "https://api.github.com/users/remyroy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/remyroy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/remyroy/subscriptions",
      "organizations_url": "https://api.github.com/users/remyroy/orgs",
      "repos_url": "https://api.github.com/users/remyroy/repos",
      "events_url": "https://api.github.com/users/remyroy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/remyroy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-28T15:20:31Z",
    "updated_at": "2022-07-28T15:20:57Z",
    "author_association": "NONE",
    "body": "It seems like installing the `libjemalloc-dev` package also installs the `libjemalloc2` package and it creates the required symlink on Ubuntu 22.04.\r\n\r\n```\r\n$ ls -al /usr/lib/x86_64-linux-gnu/libjemalloc*\r\n-rw-r--r-- 1 root root 1119814 Jan 24  2022 /usr/lib/x86_64-linux-gnu/libjemalloc.a\r\n-rw-r--r-- 1 root root 1119970 Jan 24  2022 /usr/lib/x86_64-linux-gnu/libjemalloc_pic.a\r\nlrwxrwxrwx 1 root root      16 Jan 24  2022 /usr/lib/x86_64-linux-gnu/libjemalloc.so -> libjemalloc.so.2\r\n-rw-r--r-- 1 root root  744440 Jan 24  2022 /usr/lib/x86_64-linux-gnu/libjemalloc.so.2\r\n```\r\n\r\nIt also fixes this issue. This can be closed.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1198301352/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1198408861",
    "html_url": "https://github.com/hyperledger/besu/issues/4191#issuecomment-1198408861",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4191",
    "id": 1198408861,
    "node_id": "IC_kwDODE2jmc5HbkSd",
    "user": {
      "login": "garyschulte",
      "id": 1238512,
      "node_id": "MDQ6VXNlcjEyMzg1MTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1238512?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/garyschulte",
      "html_url": "https://github.com/garyschulte",
      "followers_url": "https://api.github.com/users/garyschulte/followers",
      "following_url": "https://api.github.com/users/garyschulte/following{/other_user}",
      "gists_url": "https://api.github.com/users/garyschulte/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/garyschulte/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/garyschulte/subscriptions",
      "organizations_url": "https://api.github.com/users/garyschulte/orgs",
      "repos_url": "https://api.github.com/users/garyschulte/repos",
      "events_url": "https://api.github.com/users/garyschulte/events{/privacy}",
      "received_events_url": "https://api.github.com/users/garyschulte/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-28T17:05:23Z",
    "updated_at": "2022-07-28T17:05:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think we are going to keep this issue open and use it to track a better UX for this error.  The benefits of using jemalloc are substantial, so it is worth a better and more actionable error.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1198408861/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1201449131",
    "html_url": "https://github.com/hyperledger/besu/issues/4191#issuecomment-1201449131",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4191",
    "id": 1201449131,
    "node_id": "IC_kwDODE2jmc5HnKir",
    "user": {
      "login": "non-fungible-nelson",
      "id": 85905982,
      "node_id": "MDQ6VXNlcjg1OTA1OTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/85905982?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/non-fungible-nelson",
      "html_url": "https://github.com/non-fungible-nelson",
      "followers_url": "https://api.github.com/users/non-fungible-nelson/followers",
      "following_url": "https://api.github.com/users/non-fungible-nelson/following{/other_user}",
      "gists_url": "https://api.github.com/users/non-fungible-nelson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/non-fungible-nelson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/non-fungible-nelson/subscriptions",
      "organizations_url": "https://api.github.com/users/non-fungible-nelson/orgs",
      "repos_url": "https://api.github.com/users/non-fungible-nelson/repos",
      "events_url": "https://api.github.com/users/non-fungible-nelson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/non-fungible-nelson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-01T16:40:50Z",
    "updated_at": "2022-08-01T16:40:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi docs team - please ping me when you pick this up ",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1201449131/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
