{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/3091",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/3091/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/3091/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/3091/events",
  "html_url": "https://github.com/hyperledger/besu/issues/3091",
  "id": 1059310803,
  "node_id": "I_kwDODE2jmc4_I8zT",
  "number": 3091,
  "title": "Update exsiting genesis file on the private network for compatible istanbulForkBlock and berlinForkBlock and londonForkBlock ",
  "user": {
    "login": "eu09",
    "id": 75402889,
    "node_id": "MDQ6VXNlcjc1NDAyODg5",
    "avatar_url": "https://avatars.githubusercontent.com/u/75402889?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/eu09",
    "html_url": "https://github.com/eu09",
    "followers_url": "https://api.github.com/users/eu09/followers",
    "following_url": "https://api.github.com/users/eu09/following{/other_user}",
    "gists_url": "https://api.github.com/users/eu09/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/eu09/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/eu09/subscriptions",
    "organizations_url": "https://api.github.com/users/eu09/orgs",
    "repos_url": "https://api.github.com/users/eu09/repos",
    "events_url": "https://api.github.com/users/eu09/events{/privacy}",
    "received_events_url": "https://api.github.com/users/eu09/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2021-11-21T07:20:51Z",
  "updated_at": "2021-11-22T21:08:10Z",
  "closed_at": "2021-11-22T21:08:10Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Because I found on my private chain it can't compatible the opcode for  selfbalance  , so  how can we update the contents on my existing genesis for compatible istanbulForkBlock and berlinForkBlock and londonForkBlock by \"transitions\" ? \r\n\r\nMy existing  genesis file\r\n{\r\n  \"config\" : {\r\n    \"chainId\" : 2021,\r\n    \"constantinoplefixblock\" : 0,\r\n    \"contractSizeLimit\": 2147483647,\r\n    \"ibft2\" : {\r\n      \"blockperiodseconds\" : 2,\r\n      \"epochlength\" : 30000,\r\n      \"requesttimeoutseconds\" : 10,\r\n      \"blockreward\": \"5000000000000000\",\r\n      \"miningbeneficiary\": \"0xe0275e0cf831d5a74089e1a66c810b57891c2d85\"\r\n    }\r\n  },\r\n  \"nonce\" : \"0x0\",\r\n  \"timestamp\" : \"0x58ee40ba\",\r\n  \"gasLimit\" : \"0x1fffffffffffff\",\r\n  \"difficulty\" : \"0x1\",\r\n  \"mixHash\" : \"0x63746963616c2062797a616e74696e65206661756c7420746f6c6572616e6365\",\r\n  \"coinbase\" : \"0x0000000000000000000000000000000000000000\",\r\n  \"alloc\" : {\r\n    \"01a6d1dd2171a45e6a3d3dc52952b40be413fa93\" : {\r\n      \"comment\" : \"private key and this comment are ignored.  In a real chain, the private key should NOT be stored\",\r\n      \"balance\" : \"0xad78ebc5ac6200000\"\r\n    },\r\n    \"4f0d0ed3755381f703f385a2c2ec5508e0b7e5da\" : {\r\n      \"comment\" : \"private key and this comment are ignored.  In a real chain, the private key should NOT be stored\",\r\n      \"balance\" : \"80000000000000000000000\"\r\n    },\r\n    \"5c28178b275657c0b71f1513a239705605988bd4\" : {\r\n      \"comment\" : \"private key and this comment are ignored.  In a real chain, the private key should NOT be stored\",\r\n      \"balance\" : \"90000000000000000000000\"\r\n    }\r\n  },\r\n  \"extraData\" : \"0xf8d2a00000000000000000000000000000000000000000000000000000000000000000f8a8944f0d0ed3755381f703f385a2c2ec5508e0b7e5da94bf48277a2700bbd5c107f4a8317fe960bf25e02494fc638101f646aef1fc921478bce1f35e9071bf7b949c4893a042a3968448d4f074f65a1b13216121ec9471313d00ea729de47e1c288d9e39e8af990f3e5c9401a6d1dd2171a45e6a3d3dc52952b40be413fa93945c28178b275657c0b71f1513a239705605988bd49486cc50976da37da2e83092e695d0cc9133153b2f808400000000c0\"\r\n}\r\n\r\n\r\n\r\nCan I using transitions to update the my genesis block as following input \r\n\r\n{\r\n  \"config\" : {\r\n    \"chainId\" : 2021,\r\n    \"constantinoplefixblock\" : 0,\r\n    \r\n    \"contractSizeLimit\": 2147483647,\r\n    \"ibft2\" : {\r\n      \"blockperiodseconds\" : 2,\r\n      \"epochlength\" : 30000,\r\n      \"requesttimeoutseconds\" : 10,\r\n      \"blockreward\": \"5000000000000000\",\r\n      \"miningbeneficiary\": \"0xe0275e0cf831d5a74089e1a66c810b57891c2d85\"\r\n    },\r\n    \"transitions\" : {\r\n      \"config\": [\r\n      {\r\n        \"block\": 9701480,\r\n        \"istanbulForkBlock\": \"0x9701480\"\r\n       \"berlinForkBlock\" : \"0x9701481\"\r\n       \"londonForkBlock\" : \"0x9701482\"\r\n      }\r\n      ]\r\n   }\r\n  },\r\n  \"nonce\" : \"0x0\",\r\n  \"timestamp\" : \"0x58ee40ba\",\r\n  \"gasLimit\" : \"0x1fffffffffffff\",\r\n  \"difficulty\" : \"0x1\",\r\n  \"mixHash\" : \"0x63746963616c2062797a616e74696e65206661756c7420746f6c6572616e6365\",\r\n  \"coinbase\" : \"0x0000000000000000000000000000000000000000\",\r\n  \"alloc\" : {\r\n    \"01a6d1dd2171a45e6a3d3dc52952b40be413fa93\" : {\r\n      \"comment\" : \"private key and this comment are ignored.  In a real chain, the private key should NOT be stored\",\r\n      \"balance\" : \"0xad78ebc5ac6200000\"\r\n    },\r\n    \"4f0d0ed3755381f703f385a2c2ec5508e0b7e5da\" : {\r\n      \"comment\" : \"private key and this comment are ignored.  In a real chain, the private key should NOT be stored\",\r\n      \"balance\" : \"80000000000000000000000\"\r\n    },\r\n    \"5c28178b275657c0b71f1513a239705605988bd4\" : {\r\n      \"comment\" : \"private key and this comment are ignored.  In a real chain, the private key should NOT be stored\",\r\n      \"balance\" : \"90000000000000000000000\"\r\n    }\r\n  },\r\n  \"extraData\" : \"0xf8d2a00000000000000000000000000000000000000000000000000000000000000000f8a8944f0d0ed3755381f703f385a2c2ec5508e0b7e5da94bf48277a2700bbd5c107f4a8317fe960bf25e02494fc638101f646aef1fc921478bce1f35e9071bf7b949c4893a042a3968448d4f074f65a1b13216121ec9471313d00ea729de47e1c288d9e39e8af990f3e5c9401a6d1dd2171a45e6a3d3dc52952b40be413fa93945c28178b275657c0b71f1513a239705605988bd49486cc50976da37da2e83092e695d0cc9133153b2f808400000000c0\"\r\n}\r\n",
  "closed_by": {
    "login": "eu09",
    "id": 75402889,
    "node_id": "MDQ6VXNlcjc1NDAyODg5",
    "avatar_url": "https://avatars.githubusercontent.com/u/75402889?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/eu09",
    "html_url": "https://github.com/eu09",
    "followers_url": "https://api.github.com/users/eu09/followers",
    "following_url": "https://api.github.com/users/eu09/following{/other_user}",
    "gists_url": "https://api.github.com/users/eu09/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/eu09/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/eu09/subscriptions",
    "organizations_url": "https://api.github.com/users/eu09/orgs",
    "repos_url": "https://api.github.com/users/eu09/repos",
    "events_url": "https://api.github.com/users/eu09/events{/privacy}",
    "received_events_url": "https://api.github.com/users/eu09/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/3091/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/3091/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/974911233",
    "html_url": "https://github.com/hyperledger/besu/issues/3091#issuecomment-974911233",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/3091",
    "id": 974911233,
    "node_id": "IC_kwDODE2jmc46G_cB",
    "user": {
      "login": "jframe",
      "id": 909467,
      "node_id": "MDQ6VXNlcjkwOTQ2Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/909467?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jframe",
      "html_url": "https://github.com/jframe",
      "followers_url": "https://api.github.com/users/jframe/followers",
      "following_url": "https://api.github.com/users/jframe/following{/other_user}",
      "gists_url": "https://api.github.com/users/jframe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jframe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jframe/subscriptions",
      "organizations_url": "https://api.github.com/users/jframe/orgs",
      "repos_url": "https://api.github.com/users/jframe/repos",
      "events_url": "https://api.github.com/users/jframe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jframe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-21T22:44:08Z",
    "updated_at": "2021-11-21T22:44:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "Transitions are only used to modify configuration on the consensus mechanism for IBFT, IBFT2 or QBFT. They cannot be used to change the network protocol.\r\n\r\nTo change network protocol you need to add the milestone blocks to the config section https://besu.hyperledger.org/en/latest/Reference/Config-Items/#milestone-blocks\r\n\r\nThis page has more details on how to upgrade the protocol for a private network https://besu.hyperledger.org/en/latest/HowTo/Upgrade/Upgrade-Protocol/",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/974911233/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 1,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/974953920",
    "html_url": "https://github.com/hyperledger/besu/issues/3091#issuecomment-974953920",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/3091",
    "id": 974953920,
    "node_id": "IC_kwDODE2jmc46HJ3A",
    "user": {
      "login": "eu09",
      "id": 75402889,
      "node_id": "MDQ6VXNlcjc1NDAyODg5",
      "avatar_url": "https://avatars.githubusercontent.com/u/75402889?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eu09",
      "html_url": "https://github.com/eu09",
      "followers_url": "https://api.github.com/users/eu09/followers",
      "following_url": "https://api.github.com/users/eu09/following{/other_user}",
      "gists_url": "https://api.github.com/users/eu09/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eu09/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eu09/subscriptions",
      "organizations_url": "https://api.github.com/users/eu09/orgs",
      "repos_url": "https://api.github.com/users/eu09/repos",
      "events_url": "https://api.github.com/users/eu09/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eu09/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-22T00:45:58Z",
    "updated_at": "2021-11-22T00:45:58Z",
    "author_association": "NONE",
    "body": "But we are using a private network , and the last block no is 9702187 , so we just add following content to update the protocol  ? \r\n\r\n    \"istanbulForkBlock\" : 9702188,\r\n    \"berlinForkBlock\" : 9702190,\r\n    \"londonForkBlock\" : 9702195, ",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/974953920/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/975002104",
    "html_url": "https://github.com/hyperledger/besu/issues/3091#issuecomment-975002104",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/3091",
    "id": 975002104,
    "node_id": "IC_kwDODE2jmc46HVn4",
    "user": {
      "login": "jframe",
      "id": 909467,
      "node_id": "MDQ6VXNlcjkwOTQ2Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/909467?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jframe",
      "html_url": "https://github.com/jframe",
      "followers_url": "https://api.github.com/users/jframe/followers",
      "following_url": "https://api.github.com/users/jframe/following{/other_user}",
      "gists_url": "https://api.github.com/users/jframe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jframe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jframe/subscriptions",
      "organizations_url": "https://api.github.com/users/jframe/orgs",
      "repos_url": "https://api.github.com/users/jframe/repos",
      "events_url": "https://api.github.com/users/jframe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jframe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-22T01:56:47Z",
    "updated_at": "2021-11-22T01:56:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "That looks correct. You just need to ensure that this is for a future block and that all nodes are restarted to get this config before the block is reached.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/975002104/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/975018455",
    "html_url": "https://github.com/hyperledger/besu/issues/3091#issuecomment-975018455",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/3091",
    "id": 975018455,
    "node_id": "IC_kwDODE2jmc46HZnX",
    "user": {
      "login": "eu09",
      "id": 75402889,
      "node_id": "MDQ6VXNlcjc1NDAyODg5",
      "avatar_url": "https://avatars.githubusercontent.com/u/75402889?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eu09",
      "html_url": "https://github.com/eu09",
      "followers_url": "https://api.github.com/users/eu09/followers",
      "following_url": "https://api.github.com/users/eu09/following{/other_user}",
      "gists_url": "https://api.github.com/users/eu09/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eu09/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eu09/subscriptions",
      "organizations_url": "https://api.github.com/users/eu09/orgs",
      "repos_url": "https://api.github.com/users/eu09/repos",
      "events_url": "https://api.github.com/users/eu09/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eu09/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-22T02:37:25Z",
    "updated_at": "2021-11-22T02:37:25Z",
    "author_association": "NONE",
    "body": "But we still encode a problem when call selfbalance . Here is the contract we using .\r\n\r\npragma solidity =0.6.6;\r\n\r\ncontract ChainID {\r\n    function get() external pure returns (uint256) {\r\n        uint256 chainID;\r\n        assembly {\r\n            chainID := chainid()\r\n        }\r\n        return chainID;\r\n    }\r\n\r\n    function getWithGas() external returns (uint256) {\r\n        uint256 chainID;\r\n        assembly {\r\n            chainID := chainid()\r\n        }\r\n        return chainID;\r\n    }\r\n\r\n    function bal() external view returns (uint256) {\r\n        return address(this).balance;\r\n    }\r\n\r\n    function balWithGas() external returns (uint256) {\r\n        return address(this).balance;\r\n    }\r\n}\r\n\r\nThe Output \r\n34/35) JUMPDEST\r\n  PC = 109 = 0x6d\r\n\r\n4978594 gas remaining\r\n\r\nChainID.sol:\r\n\r\n22:     }\r\n23:\r\n24:     function balWithGas() external returns (uint256) {\r\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n\r\ndebug(dev:0x38bb825b...)>\r\n\r\nStack:\r\n  00000000000000000000000000000000000000000000000000000000224312f5 (1 from top)\r\n  0000000000000000000000000000000000000000000000000000000000000051 (top)\r\n\r\n(35/35) SELFBALANCE\r\n  PC = 110 = 0x6e\r\n\r\n4978593 gas remaining\r\n\r\nChainID.sol:\r\n\r\n23:\r\n24:     function balWithGas() external returns (uint256) {\r\n25:         return address(this).balance;\r\n                   ^^^^^^^^^^^^^^^^^^^^^\r\n\r\ndebug(dev:0x38bb825b...)>\r\n\r\nTransaction halted with a RUNTIME ERROR.\r\n\r\nThere was no revert message.  This may be due to an in intentional halting expression, such as assert(), revert(), or require(), or could be due to an unintentional exception such as out-of-gas exceptions.\r\nPlease inspect your transaction parameters and contract code to determine the meaning of this error.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/975018455/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/975919563",
    "html_url": "https://github.com/hyperledger/besu/issues/3091#issuecomment-975919563",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/3091",
    "id": 975919563,
    "node_id": "IC_kwDODE2jmc46K1nL",
    "user": {
      "login": "eu09",
      "id": 75402889,
      "node_id": "MDQ6VXNlcjc1NDAyODg5",
      "avatar_url": "https://avatars.githubusercontent.com/u/75402889?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eu09",
      "html_url": "https://github.com/eu09",
      "followers_url": "https://api.github.com/users/eu09/followers",
      "following_url": "https://api.github.com/users/eu09/following{/other_user}",
      "gists_url": "https://api.github.com/users/eu09/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eu09/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eu09/subscriptions",
      "organizations_url": "https://api.github.com/users/eu09/orgs",
      "repos_url": "https://api.github.com/users/eu09/repos",
      "events_url": "https://api.github.com/users/eu09/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eu09/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-22T21:08:10Z",
    "updated_at": "2021-11-22T21:08:10Z",
    "author_association": "NONE",
    "body": "I found the root case for above issue , because I mistyped the protocol name as above \r\n\r\n\"istanbulForkBlock\" : 9702188,\r\n\"berlinForkBlock\" : 9702190,\r\n\"londonForkBlock\" : 9702195, \r\n\r\nit should be \r\n   \"istanbulBlock\" : 9702188,\r\n    \"berlinBlock\" : 9702190,\r\n    \"londonBlock\" : 9702195\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/975919563/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
