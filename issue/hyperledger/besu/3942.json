{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/3942",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/3942/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/3942/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/3942/events",
  "html_url": "https://github.com/hyperledger/besu/issues/3942",
  "id": 1263285468,
  "node_id": "I_kwDODE2jmc5LTDTc",
  "number": 3942,
  "title": "Hive: Transition to a Chain with Invalid Terminal Block, Higher Configured Total Difficulty (Transition Payload)",
  "user": {
    "login": "fab-10",
    "id": 91944855,
    "node_id": "U_kgDOBXr3lw",
    "avatar_url": "https://avatars.githubusercontent.com/u/91944855?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fab-10",
    "html_url": "https://github.com/fab-10",
    "followers_url": "https://api.github.com/users/fab-10/followers",
    "following_url": "https://api.github.com/users/fab-10/following{/other_user}",
    "gists_url": "https://api.github.com/users/fab-10/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fab-10/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fab-10/subscriptions",
    "organizations_url": "https://api.github.com/users/fab-10/orgs",
    "repos_url": "https://api.github.com/users/fab-10/repos",
    "events_url": "https://api.github.com/users/fab-10/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fab-10/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1810629110,
      "node_id": "MDU6TGFiZWwxODEwNjI5MTEw",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/testing",
      "name": "testing",
      "color": "bfdadc",
      "default": false,
      "description": ""
    },
    {
      "id": 3013559202,
      "node_id": "MDU6TGFiZWwzMDEzNTU5MjAy",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/mainnet",
      "name": "mainnet",
      "color": "9D578C",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "gezero",
    "id": 22477,
    "node_id": "MDQ6VXNlcjIyNDc3",
    "avatar_url": "https://avatars.githubusercontent.com/u/22477?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gezero",
    "html_url": "https://github.com/gezero",
    "followers_url": "https://api.github.com/users/gezero/followers",
    "following_url": "https://api.github.com/users/gezero/following{/other_user}",
    "gists_url": "https://api.github.com/users/gezero/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gezero/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gezero/subscriptions",
    "organizations_url": "https://api.github.com/users/gezero/orgs",
    "repos_url": "https://api.github.com/users/gezero/repos",
    "events_url": "https://api.github.com/users/gezero/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gezero/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "gezero",
      "id": 22477,
      "node_id": "MDQ6VXNlcjIyNDc3",
      "avatar_url": "https://avatars.githubusercontent.com/u/22477?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gezero",
      "html_url": "https://github.com/gezero",
      "followers_url": "https://api.github.com/users/gezero/followers",
      "following_url": "https://api.github.com/users/gezero/following{/other_user}",
      "gists_url": "https://api.github.com/users/gezero/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gezero/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gezero/subscriptions",
      "organizations_url": "https://api.github.com/users/gezero/orgs",
      "repos_url": "https://api.github.com/users/gezero/repos",
      "events_url": "https://api.github.com/users/gezero/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gezero/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-06-07T13:17:19Z",
  "updated_at": "2022-06-22T14:13:49Z",
  "closed_at": "2022-06-22T14:13:49Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "<!-- Have you done the following? -->\r\n<!--   * read the Code of Conduct? By filing an Issue, you are expected to -->  \r\n<!--     comply with it, including treating everyone with respect: -->\r\n<!--     https://github.com/hyperledger/besu/blob/main/CODE_OF_CONDUCT.md -->\r\n<!--   * Reproduced the issue in the latest version of the software -->\r\n<!--   * Read the debugging docs: https://besu.hyperledger.org/en/stable/HowTo/Monitor/Logging/ -->\r\n<!--   * Duplicate Issue check:  https://github.com/search?q=+is%3Aissue+repo%3Ahyperledger/Besu -->\r\n<!-- Note:  Not all sections will apply to all issue types. -->\r\n\r\n### Description\r\nTest is failing with:\r\n\r\nFAIL (Transition to a Chain with Invalid Terminal Block, Higher Configured Total Difficulty (Transition Payload)): Timeout while waiting for sync on the alternative PoW chain\r\n\r\n### Versions (Add all that apply)\r\n* Software version: 22.4.3-SNAPSHOT\r\n",
  "closed_by": {
    "login": "gezero",
    "id": 22477,
    "node_id": "MDQ6VXNlcjIyNDc3",
    "avatar_url": "https://avatars.githubusercontent.com/u/22477?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gezero",
    "html_url": "https://github.com/gezero",
    "followers_url": "https://api.github.com/users/gezero/followers",
    "following_url": "https://api.github.com/users/gezero/following{/other_user}",
    "gists_url": "https://api.github.com/users/gezero/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gezero/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gezero/subscriptions",
    "organizations_url": "https://api.github.com/users/gezero/orgs",
    "repos_url": "https://api.github.com/users/gezero/repos",
    "events_url": "https://api.github.com/users/gezero/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gezero/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/3942/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/3942/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1149653479",
    "html_url": "https://github.com/hyperledger/besu/issues/3942#issuecomment-1149653479",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/3942",
    "id": 1149653479,
    "node_id": "IC_kwDODE2jmc5EhlHn",
    "user": {
      "login": "fab-10",
      "id": 91944855,
      "node_id": "U_kgDOBXr3lw",
      "avatar_url": "https://avatars.githubusercontent.com/u/91944855?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fab-10",
      "html_url": "https://github.com/fab-10",
      "followers_url": "https://api.github.com/users/fab-10/followers",
      "following_url": "https://api.github.com/users/fab-10/following{/other_user}",
      "gists_url": "https://api.github.com/users/fab-10/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fab-10/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fab-10/subscriptions",
      "organizations_url": "https://api.github.com/users/fab-10/orgs",
      "repos_url": "https://api.github.com/users/fab-10/repos",
      "events_url": "https://api.github.com/users/fab-10/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fab-10/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-08T09:02:46Z",
    "updated_at": "2022-06-08T09:02:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "Client 1 starts with chain G <- A, Client 2 starts with chain G <- A <- B.  \r\nClient 1's configured TTD is reached by A.\r\nClient 2's configured TTD is reached by B.\r\nForkchoiceUpdated is sent to both clients with B as Head.  \r\nP1 is prepared by Client 2 on top of G <- A <- B.\r\n`newPayload(P1)` is sent to Client 1 and verification is made that `{status: INVALID, latestValidHash: 0x00..00}`\r\n\r\non the #3808 branch\r\n\r\n```\r\n2022-06-07 17:28:19.590+00:00 | vert.x-worker-thread-18 | DEBUG | JsonRpcExecutor | JSON-RPC request -> engine_forkchoiceUpdatedV1 [{headBlockHash=0x2d4f65a26a8d5ca4f8000010b4741652decb89c8ccf19119b5d9f58846efbbd4, safeBlockHash=0x0000000000000000000000000000000000000000000000000000000000000000, finalizedBlockHash=0x0000000000000000000000000000000000000000000000000000000000000000}, null]\r\n2022-06-07 17:28:19.591+00:00 | vert.x-worker-thread-0 | DEBUG | ExecutionEngineJsonRpcMethod | execution engine JSON-RPC request engine_forkchoiceUpdatedV1 [{headBlockHash=0x2d4f65a26a8d5ca4f8000010b4741652decb89c8ccf19119b5d9f58846efbbd4, safeBlockHash=0x0000000000000000000000000000000000000000000000000000000000000000, finalizedBlockHash=0x0000000000000000000000000000000000000000000000000000000000000000}, null]\r\n2022-06-07 17:28:19.591+00:00 | vert.x-worker-thread-0 | DEBUG | FinalizedBlockHashSupplier | New finalized block hash announced Optional.empty\r\n2022-06-07 17:28:19.592+00:00 | vert.x-worker-thread-0 | DEBUG | FinalizedBlockHashSupplier | New finalized block hash announced Optional.empty\r\n2022-06-07 17:28:19.593+00:00 | vert.x-worker-thread-0 | DEBUG | MergeCoordinator | appending block hash 0x2d4f65a26a8d5ca4f8000010b4741652decb89c8ccf19119b5d9f58846efbbd4 to backward sync\r\n2022-06-07 17:28:19.594+00:00 | vert.x-worker-thread-0 | INFO  | BackwardSyncContext | Starting new backward sync towards a pivot 0x2d4f65a26a8d5ca4f8000010b4741652decb89c8ccf19119b5d9f58846efbbd4\r\n2022-06-07 17:28:19.608+00:00 | EthScheduler-Workers-0 | DEBUG | RetryingGetBlockFromPeersTask | Getting block -1 (Optional[0x2d4f65a26a8d5ca4f8000010b4741652decb89c8ccf19119b5d9f58846efbbd4]) from peer Optional[Peer 0x2e178b6db499439305... PeerReputation 100, validated? true, disconnected? false], attempt 1\r\n2022-06-07 17:28:19.609+00:00 | EthScheduler-Workers-0 | DEBUG | GetBlockFromPeerTask | Downloading block -1 (Optional[0x2d4f65a26a8d5ca4f8000010b4741652decb89c8ccf19119b5d9f58846efbbd4]) from peer Peer 0x2e178b6db499439305... PeerReputation 100, validated? true, disconnected? false.\r\n2022-06-07 17:28:19.610+00:00 | EthScheduler-Workers-0 | DEBUG | GetHeadersFromPeerByHashTask | Requesting 1 headers from peer Peer 0x2e178b6db499439305... PeerReputation 100, validated? true, disconnected? false.\r\n2022-06-07 17:28:19.611+00:00 | EthScheduler-Workers-0 | TRACE | AbstractPeerConnection | Writing RawMessage{code=3, data=0xe601e4a02d4f65a26a8d5ca4f8000010b4741652decb89c8ccf19119b5d9f58846efbbd4018080} to PeerInfo{version=5, clientId='besu/v22.4.3-dev/linux-x86_64/openjdk-java-11', capabilities=[eth/62, eth/63, eth/64, eth/65, eth/66, snap/1], port=30303, nodeId=0x2e178b6db499439305a11c95966f5ce31ba4ddd8e6f0d14c8dd618b929f583fb36830669e8c894ec084f726f7f4faff6d0a05875a9e42570a7261859c44c6fda} via protocol eth/66\r\n2022-06-07 17:28:19.630+00:00 | nioEventLoopGroup-3-2 | TRACE | EthProtocolManager | Process message eth/66, 4\r\n2022-06-07 17:28:19.636+00:00 | nioEventLoopGroup-3-2 | TRACE | AbstractGetHeadersFromPeerTask | Peer chain state ChainState{estimatedHeight=2, bestBlock=BestBlock{totalDifficulty=0x000000000000000000000000000000000000000000000000000000000008ffa0, blockHash=0x2d4f65a26a8d5ca4f8000010b4741652decb89c8ccf19119b5d9f58846efbbd4, number=2}}\r\n2022-06-07 17:28:19.636+00:00 | nioEventLoopGroup-3-2 | DEBUG | AbstractGetHeadersFromPeerTask | Received 1 of 1 headers requested from peer Peer 0x2e178b6db499439305... PeerReputation 100, validated? true, disconnected? false\r\n2022-06-07 17:28:19.639+00:00 | nioEventLoopGroup-3-2 | DEBUG | GetBodiesFromPeerTask | Requesting 1 bodies from peer Peer 0x2e178b6db499439305... PeerReputation 100, validated? true, disconnected? false.\r\n2022-06-07 17:28:19.640+00:00 | nioEventLoopGroup-3-2 | TRACE | AbstractPeerConnection | Writing RawMessage{code=5, data=0xe380e1a02d4f65a26a8d5ca4f8000010b4741652decb89c8ccf19119b5d9f58846efbbd4} to PeerInfo{version=5, clientId='besu/v22.4.3-dev/linux-x86_64/openjdk-java-11', capabilities=[eth/62, eth/63, eth/64, eth/65, eth/66, snap/1], port=30303, nodeId=0x2e178b6db499439305a11c95966f5ce31ba4ddd8e6f0d14c8dd618b929f583fb36830669e8c894ec084f726f7f4faff6d0a05875a9e42570a7261859c44c6fda} via protocol eth/66\r\n2022-06-07 17:28:19.660+00:00 | nioEventLoopGroup-3-2 | TRACE | EthProtocolManager | Process message eth/66, 6\r\n2022-06-07 17:28:19.663+00:00 | nioEventLoopGroup-3-2 | DEBUG | GetBlockFromPeerTask | Successfully downloaded block -1 (Optional[0x2d4f65a26a8d5ca4f8000010b4741652decb89c8ccf19119b5d9f58846efbbd4]) from peer Peer 0x2e178b6db499439305... PeerReputation 100, validated? true, disconnected? false.\r\n2022-06-07 17:28:19.664+00:00 | nioEventLoopGroup-3-2 | DEBUG | SyncStepStep | Appending block 2(0x2d4f65a26a8d5ca4f8000010b4741652decb89c8ccf19119b5d9f58846efbbd4)\r\n2022-06-07 17:28:19.667+00:00 | nioEventLoopGroup-3-2 | DEBUG | BackwardsSyncAlgorithm | Nothing to validate yet, consensus layer did not provide a new finalized block\r\n2022-06-07 17:28:19.670+00:00 | nioEventLoopGroup-3-2 | INFO  | BackwardsSyncAlgorithm | Backward sync reached final header, starting Forward sync\r\n2022-06-07 17:28:19.679+00:00 | ForkJoinPool.commonPool-worker-3 | DEBUG | ForwardSyncStep | Requesting 1 blocks 2->2 (0x2d4f65a26a8d5ca4f8000010b4741652decb89c8ccf19119b5d9f58846efbbd4)\r\n2022-06-07 17:28:19.680+00:00 | ForkJoinPool.commonPool-worker-3 | DEBUG | GetBodiesFromPeerTask | Requesting 1 bodies from peer Peer 0x2e178b6db499439305... PeerReputation 100, validated? true, disconnected? false.\r\n2022-06-07 17:28:19.682+00:00 | ForkJoinPool.commonPool-worker-3 | TRACE | AbstractPeerConnection | Writing RawMessage{code=5, data=0xe301e1a02d4f65a26a8d5ca4f8000010b4741652decb89c8ccf19119b5d9f58846efbbd4} to PeerInfo{version=5, clientId='besu/v22.4.3-dev/linux-x86_64/openjdk-java-11', capabilities=[eth/62, eth/63, eth/64, eth/65, eth/66, snap/1], port=30303, nodeId=0x2e178b6db499439305a11c95966f5ce31ba4ddd8e6f0d14c8dd618b929f583fb36830669e8c894ec084f726f7f4faff6d0a05875a9e42570a7261859c44c6fda} via protocol eth/66\r\n2022-06-07 17:28:19.689+00:00 | nioEventLoopGroup-3-2 | TRACE | EthProtocolManager | Process message eth/66, 6\r\n2022-06-07 17:28:19.691+00:00 | nioEventLoopGroup-3-2 | TRACE | BackwardSyncContext | Going to validate block 2 (0x2d4f65a26a8d5ca4f8000010b4741652decb89c8ccf19119b5d9f58846efbbd4)\r\n2022-06-07 17:28:19.691+00:00 | nioEventLoopGroup-3-2 | DEBUG | BackwardSyncContext | Finalized block not known yet...\r\n2022-06-07 17:28:19.692+00:00 | nioEventLoopGroup-3-2 | TRACE | LondonFeeMarket | block #2 parentBaseFee: 0x00000000000000000000000000000000000000000000000000000000342770c0 parentGasUsed: 43104 parentGasTarget: 1570796 baseFee: 0x000000000000000000000000000000000000000000000000000000002dd04ea9\r\n2022-06-07 17:28:19.692+00:00 | nioEventLoopGroup-3-2 | DEBUG | BlockHeaderValidator | org.hyperledger.besu.consensus.merge.headervalidationrules.NoNonceRule rule failed\r\n2022-06-07 17:28:19.692+00:00 | nioEventLoopGroup-3-2 | ERROR | MainnetBlockValidator | Invalid block header. Block 2 (0x2d4f65a26a8d5ca4f8000010b4741652decb89c8ccf19119b5d9f58846efbbd4)\r\n2022-06-07 17:28:19.694+00:00 | nioEventLoopGroup-3-2 | INFO  | ForwardSyncStep | Saved blocks 2 -> 2 (target: 2)\r\n2022-06-07 17:28:19.695+00:00 | nioEventLoopGroup-3-2 | DEBUG | BackwardsSyncAlgorithm | Nothing to validate yet, consensus layer did not provide a new finalized block\r\n2022-06-07 17:28:19.695+00:00 | nioEventLoopGroup-3-2 | INFO  | BackwardsSyncAlgorithm | Backward sync reached final header, starting Forward sync\r\n2022-06-07 17:28:19.695+00:00 | ForkJoinPool.commonPool-worker-3 | DEBUG | ForwardSyncStep | Requesting 1 blocks 2->2 (0x2d4f65a26a8d5ca4f8000010b4741652decb89c8ccf19119b5d9f58846efbbd4)\r\n2022-06-07 17:28:19.696+00:00 | ForkJoinPool.commonPool-worker-3 | DEBUG | GetBodiesFromPeerTask | Requesting 1 bodies from peer Peer 0x2e178b6db499439305... PeerReputation 100, validated? true, disconnected? false.\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1149653479/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
