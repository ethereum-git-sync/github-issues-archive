{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/1707",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/1707/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/1707/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/1707/events",
  "html_url": "https://github.com/hyperledger/besu/issues/1707",
  "id": 766789246,
  "node_id": "MDU6SXNzdWU3NjY3ODkyNDY=",
  "number": 1707,
  "title": "Performance updates to DNS discovery",
  "user": {
    "login": "davemec",
    "id": 1975126,
    "node_id": "MDQ6VXNlcjE5NzUxMjY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1975126?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/davemec",
    "html_url": "https://github.com/davemec",
    "followers_url": "https://api.github.com/users/davemec/followers",
    "following_url": "https://api.github.com/users/davemec/following{/other_user}",
    "gists_url": "https://api.github.com/users/davemec/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/davemec/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/davemec/subscriptions",
    "organizations_url": "https://api.github.com/users/davemec/orgs",
    "repos_url": "https://api.github.com/users/davemec/repos",
    "events_url": "https://api.github.com/users/davemec/events{/privacy}",
    "received_events_url": "https://api.github.com/users/davemec/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2058129555,
      "node_id": "MDU6TGFiZWwyMDU4MTI5NTU1",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/performance",
      "name": "performance",
      "color": "d29ce2",
      "default": false,
      "description": ""
    },
    {
      "id": 3805591260,
      "node_id": "LA_kwDODE2jmc7i1Lbc",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/peering",
      "name": "peering",
      "color": "006b75",
      "default": false,
      "description": ""
    },
    {
      "id": 4164098293,
      "node_id": "LA_kwDODE2jmc74Mxj1",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/icebox",
      "name": "icebox",
      "color": "1D76DB",
      "default": false,
      "description": "items that need more consideration, time, or can wait"
    },
    {
      "id": 4328706977,
      "node_id": "LA_kwDODE2jmc8AAAABAgLToQ",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/TeamChupa",
      "name": "TeamChupa",
      "color": "fbca04",
      "default": false,
      "description": "GH issues worked on by Chupacabara Team"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2020-12-14T18:16:47Z",
  "updated_at": "2022-07-19T17:37:33Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Description\n- Modify DNS discovery code to not dump all of the results into discovery immediately but slowly add them in batches of roughly 25 at a time\n- Modify to not always traverse the DNS tree in the same order, that puts pressure on “earlier” leaves.  Perhaps adding in a random xor and then using that to sort the depth first traversals.\n- Modify trie traversal logic to depth first and emitting nodes as trie leafs are encountered",
  "closed_by": {
    "login": "non-fungible-nelson",
    "id": 85905982,
    "node_id": "MDQ6VXNlcjg1OTA1OTgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/85905982?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/non-fungible-nelson",
    "html_url": "https://github.com/non-fungible-nelson",
    "followers_url": "https://api.github.com/users/non-fungible-nelson/followers",
    "following_url": "https://api.github.com/users/non-fungible-nelson/following{/other_user}",
    "gists_url": "https://api.github.com/users/non-fungible-nelson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/non-fungible-nelson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/non-fungible-nelson/subscriptions",
    "organizations_url": "https://api.github.com/users/non-fungible-nelson/orgs",
    "repos_url": "https://api.github.com/users/non-fungible-nelson/repos",
    "events_url": "https://api.github.com/users/non-fungible-nelson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/non-fungible-nelson/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/1707/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/1707/timeline",
  "performed_via_github_app": null,
  "state_reason": "reopened"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1129527706",
    "html_url": "https://github.com/hyperledger/besu/issues/1707#issuecomment-1129527706",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1707",
    "id": 1129527706,
    "node_id": "IC_kwDODE2jmc5DUzma",
    "user": {
      "login": "iamhsk",
      "id": 2249367,
      "node_id": "MDQ6VXNlcjIyNDkzNjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2249367?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iamhsk",
      "html_url": "https://github.com/iamhsk",
      "followers_url": "https://api.github.com/users/iamhsk/followers",
      "following_url": "https://api.github.com/users/iamhsk/following{/other_user}",
      "gists_url": "https://api.github.com/users/iamhsk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iamhsk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iamhsk/subscriptions",
      "organizations_url": "https://api.github.com/users/iamhsk/orgs",
      "repos_url": "https://api.github.com/users/iamhsk/repos",
      "events_url": "https://api.github.com/users/iamhsk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iamhsk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-18T03:27:48Z",
    "updated_at": "2022-05-18T03:27:48Z",
    "author_association": "NONE",
    "body": "@garyschulte Could you help provide a bit more context on what this issue is trying to achieve? Is this issue still relevant? If not, we'll close it. ",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1129527706/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1130499866",
    "html_url": "https://github.com/hyperledger/besu/issues/1707#issuecomment-1130499866",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1707",
    "id": 1130499866,
    "node_id": "IC_kwDODE2jmc5DYg8a",
    "user": {
      "login": "garyschulte",
      "id": 1238512,
      "node_id": "MDQ6VXNlcjEyMzg1MTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1238512?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/garyschulte",
      "html_url": "https://github.com/garyschulte",
      "followers_url": "https://api.github.com/users/garyschulte/followers",
      "following_url": "https://api.github.com/users/garyschulte/following{/other_user}",
      "gists_url": "https://api.github.com/users/garyschulte/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/garyschulte/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/garyschulte/subscriptions",
      "organizations_url": "https://api.github.com/users/garyschulte/orgs",
      "repos_url": "https://api.github.com/users/garyschulte/repos",
      "events_url": "https://api.github.com/users/garyschulte/events{/privacy}",
      "received_events_url": "https://api.github.com/users/garyschulte/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-18T20:23:23Z",
    "updated_at": "2022-05-18T20:31:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "This may be relevant to a prior DNS Discovery implementation, but I believe it is still a viable improvement to our current use of tuweni's DNSDaemon.  We use DNSDaemon to periodically poll DNS txt records for ethereum nodes for the network we are on (if the dns entry exists).  \r\n\r\nI am skeptical of the first bullet item, batching. I believe a better batching behavior would be to batch the DNS queries in DNSDaemon rather than recursively hitting an upstream dns server for all the nodes found.  This would be an improvement in tuweni, rather than besu (and may or may not already have been addressed)\r\n\r\nThe second item, if we randomize our access to the returned entries we could spread the peering load across all nodes rather than attempting to connect to the same public nodes in the same order for all besu nodes.  This is good for both besu and for the p2p network\r\n\r\nThird item is a variation of the second, but since tuweni returns nodes in a list rather than a tree structure it isn't relevant to besu.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1130499866/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1130566269",
    "html_url": "https://github.com/hyperledger/besu/issues/1707#issuecomment-1130566269",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1707",
    "id": 1130566269,
    "node_id": "IC_kwDODE2jmc5DYxJ9",
    "user": {
      "login": "shemnon",
      "id": 38109,
      "node_id": "MDQ6VXNlcjM4MTA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/38109?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shemnon",
      "html_url": "https://github.com/shemnon",
      "followers_url": "https://api.github.com/users/shemnon/followers",
      "following_url": "https://api.github.com/users/shemnon/following{/other_user}",
      "gists_url": "https://api.github.com/users/shemnon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shemnon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shemnon/subscriptions",
      "organizations_url": "https://api.github.com/users/shemnon/orgs",
      "repos_url": "https://api.github.com/users/shemnon/repos",
      "events_url": "https://api.github.com/users/shemnon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shemnon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-18T21:24:32Z",
    "updated_at": "2022-05-18T21:24:32Z",
    "author_association": "MEMBER",
    "body": "The biggest gain I see is quickly finding good peers.  If we start in the middle of the trie, stream nodes one by one, and add the to the pool as we find them we can get good peering much quicker than waiting for a complete walk of the dns tree.\r\n\r\nI did a spike while I was at Reddit and needed some stress relief.  I'll see if I can find it and post it.  I didn't use Tuweni code.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1130566269/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1131213258",
    "html_url": "https://github.com/hyperledger/besu/issues/1707#issuecomment-1131213258",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1707",
    "id": 1131213258,
    "node_id": "IC_kwDODE2jmc5DbPHK",
    "user": {
      "login": "shemnon",
      "id": 38109,
      "node_id": "MDQ6VXNlcjM4MTA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/38109?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shemnon",
      "html_url": "https://github.com/shemnon",
      "followers_url": "https://api.github.com/users/shemnon/followers",
      "following_url": "https://api.github.com/users/shemnon/following{/other_user}",
      "gists_url": "https://api.github.com/users/shemnon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shemnon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shemnon/subscriptions",
      "organizations_url": "https://api.github.com/users/shemnon/orgs",
      "repos_url": "https://api.github.com/users/shemnon/repos",
      "events_url": "https://api.github.com/users/shemnon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shemnon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-19T05:22:06Z",
    "updated_at": "2022-05-19T05:22:15Z",
    "author_association": "MEMBER",
    "body": "Here's the proof of concept spike code.  Not done.  Probably not worth the effort to bring in compared to other priorites.  Possibly a good entry issue for new contributors.\r\n\r\nhttps://github.com/shemnon/besu/tree/streamdns",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1131213258/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1189370839",
    "html_url": "https://github.com/hyperledger/besu/issues/1707#issuecomment-1189370839",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1707",
    "id": 1189370839,
    "node_id": "IC_kwDODE2jmc5G5FvX",
    "user": {
      "login": "non-fungible-nelson",
      "id": 85905982,
      "node_id": "MDQ6VXNlcjg1OTA1OTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/85905982?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/non-fungible-nelson",
      "html_url": "https://github.com/non-fungible-nelson",
      "followers_url": "https://api.github.com/users/non-fungible-nelson/followers",
      "following_url": "https://api.github.com/users/non-fungible-nelson/following{/other_user}",
      "gists_url": "https://api.github.com/users/non-fungible-nelson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/non-fungible-nelson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/non-fungible-nelson/subscriptions",
      "organizations_url": "https://api.github.com/users/non-fungible-nelson/orgs",
      "repos_url": "https://api.github.com/users/non-fungible-nelson/repos",
      "events_url": "https://api.github.com/users/non-fungible-nelson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/non-fungible-nelson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-19T17:36:10Z",
    "updated_at": "2022-07-19T17:37:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "Can we close in favor of other peering fixes and DNS discovery outsourced to Tuweni library? Do we need to implement #4018 in light of this --> post-Merge we will be looking to move to discV5 discovery regardless, which will remove the need for v4 improvements. ",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1189370839/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
