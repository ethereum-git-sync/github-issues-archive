{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/2830",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/2830/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/2830/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/2830/events",
  "html_url": "https://github.com/hyperledger/besu/issues/2830",
  "id": 1012799446,
  "node_id": "I_kwDODE2jmc48XhfW",
  "number": 2830,
  "title": "Merge Interop Milestone Tracking",
  "user": {
    "login": "garyschulte",
    "id": 1238512,
    "node_id": "MDQ6VXNlcjEyMzg1MTI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1238512?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/garyschulte",
    "html_url": "https://github.com/garyschulte",
    "followers_url": "https://api.github.com/users/garyschulte/followers",
    "following_url": "https://api.github.com/users/garyschulte/following{/other_user}",
    "gists_url": "https://api.github.com/users/garyschulte/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/garyschulte/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/garyschulte/subscriptions",
    "organizations_url": "https://api.github.com/users/garyschulte/orgs",
    "repos_url": "https://api.github.com/users/garyschulte/repos",
    "events_url": "https://api.github.com/users/garyschulte/events{/privacy}",
    "received_events_url": "https://api.github.com/users/garyschulte/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "garyschulte",
    "id": 1238512,
    "node_id": "MDQ6VXNlcjEyMzg1MTI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1238512?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/garyschulte",
    "html_url": "https://github.com/garyschulte",
    "followers_url": "https://api.github.com/users/garyschulte/followers",
    "following_url": "https://api.github.com/users/garyschulte/following{/other_user}",
    "gists_url": "https://api.github.com/users/garyschulte/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/garyschulte/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/garyschulte/subscriptions",
    "organizations_url": "https://api.github.com/users/garyschulte/orgs",
    "repos_url": "https://api.github.com/users/garyschulte/repos",
    "events_url": "https://api.github.com/users/garyschulte/events{/privacy}",
    "received_events_url": "https://api.github.com/users/garyschulte/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "garyschulte",
      "id": 1238512,
      "node_id": "MDQ6VXNlcjEyMzg1MTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1238512?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/garyschulte",
      "html_url": "https://github.com/garyschulte",
      "followers_url": "https://api.github.com/users/garyschulte/followers",
      "following_url": "https://api.github.com/users/garyschulte/following{/other_user}",
      "gists_url": "https://api.github.com/users/garyschulte/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/garyschulte/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/garyschulte/subscriptions",
      "organizations_url": "https://api.github.com/users/garyschulte/orgs",
      "repos_url": "https://api.github.com/users/garyschulte/repos",
      "events_url": "https://api.github.com/users/garyschulte/events{/privacy}",
      "received_events_url": "https://api.github.com/users/garyschulte/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-10-01T02:05:14Z",
  "updated_at": "2021-10-12T16:17:17Z",
  "closed_at": "2021-10-12T16:17:17Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "# Tracking issue for [Merge Interop Milestones](https://hackmd.io/@tvanepps/amphora-milestones#Milestones)\r\n\r\n## Milestones\r\n- [X] M0: Implementation started\r\n- [x] M1: Upgrade to latest spec - https://github.com/hyperledger/besu/issues/2831\r\n- [x] M2: 1-to-1 Interop (no transition) – One EL and one CL team pair off for basic interop\r\n- [x] M3: 1-to-1 Interop (with transition) – One EL and one CL team pair off for full interop testing\r\n- [x] M4: Many-to-Many Interop – 2 or more EL and CL teams perform interop testing\r\n- [x] M5: All-to-All persistent devnet – All ready EL and CL teams create a long-lived devnet\r\n\r\n\r\n## Building and Running Besu in Interop Mode \r\n* clone/fetch the [latest merge branch](https://github.com/hyperledger/besu/tree/merge)\r\n* merge consensus is gated by a flag `--Xmerge-support=true`\r\n* Besu will run/transition from whatever consensus mechanism is defined in the genesis config file at the specified terminalTotalDifficulty\r\n* to start besu in interop mining mode from the checked-out repo, e.g.:\r\n```bash\r\ngit clone --recursive https://github.com/hyperledger/besu\r\ngit checkout merge\r\n./gradlew --parallel installDist && build/install/besu/bin/besu --config-file=besu-config.toml\r\n```\r\n\r\n`besu-config.toml`\r\n```toml\r\ngenesis-file=\"genesis.json\"\r\ndata-path=\"besu-data\"\r\nnetwork-id=7882\r\nrpc-http-enabled=true\r\nrpc-http-api=[\"ADMIN\",\"ETH\",\"NET\",\"DEBUG\",\"TXPOOL\",\"EXECUTION\"]\r\nhost-allowlist=[\"*\"]\r\nrpc-http-cors-origins=[\"*\"]\r\nrpc-http-port=8550\r\nXmerge-support=true\r\nlogging=\"DEBUG\"\r\n```\r\n\r\n\r\n* if using clique, there is no need to specify `--miner-enabled`\r\n* genesis config files require a consensus engine block.  Unlike geth besu does not default to ethash if there is no explicit consensus mechanism.  The hacknet genesis files typically require the addition of `ethash{}` to config block.",
  "closed_by": {
    "login": "sajz",
    "id": 5994549,
    "node_id": "MDQ6VXNlcjU5OTQ1NDk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5994549?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sajz",
    "html_url": "https://github.com/sajz",
    "followers_url": "https://api.github.com/users/sajz/followers",
    "following_url": "https://api.github.com/users/sajz/following{/other_user}",
    "gists_url": "https://api.github.com/users/sajz/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sajz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sajz/subscriptions",
    "organizations_url": "https://api.github.com/users/sajz/orgs",
    "repos_url": "https://api.github.com/users/sajz/repos",
    "events_url": "https://api.github.com/users/sajz/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sajz/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/2830/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/2830/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/933050977",
    "html_url": "https://github.com/hyperledger/besu/issues/2830#issuecomment-933050977",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2830",
    "id": 933050977,
    "node_id": "IC_kwDODE2jmc43nTph",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-03T23:36:16Z",
    "updated_at": "2021-10-03T23:36:16Z",
    "author_association": "NONE",
    "body": "Hi there :wave: I'm working on Besu interop with Lighthouse and I came across the following error:\r\n\r\n```\r\n2021-10-04 11:25:31.121+11:00 | vert.x-worker-thread-0 | INFO  | ExecutionEngineJsonRpcMethod | consensus JSON-RPC request engine_forkchoiceUpdated\r\n2021-10-04 11:25:31.123+11:00 | vert.x-eventloop-thread-4 | ERROR | ExecutionEngineJsonRpcMethod | failed to exec consensus method engine_forkchoiceUpdated\r\njava.util.NoSuchElementException: No value present\r\n\tat java.base/java.util.Optional.orElseThrow(Optional.java:377)\r\n\tat org.hyperledger.besu.consensus.merge.MergeBlockProcessor$CandidateBlock.updateForkChoice(MergeBlockProcessor.java:166)\r\n\tat org.hyperledger.besu.consensus.merge.PostMergeContext.updateForkChoice(PostMergeContext.java:109)\r\n\tat org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.engine.EngineForkchoiceUpdated.syncResponse(EngineForkchoiceUpdated.java:43)\r\n\tat org.hyperledger.besu.ethereum.api.jsonrpc.internal.methods.ExecutionEngineJsonRpcMethod.lambda$response$0(ExecutionEngineJsonRpcMethod.java:66)\r\n\tat io.vertx.core.impl.ContextImpl.lambda$executeBlocking$2(ContextImpl.java:313)\r\n\tat io.vertx.core.impl.TaskQueue.run(TaskQueue.java:76)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1130)\r\n\tat java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:630)\r\n\tat io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30)\r\n\tat java.base/java.lang.Thread.run(Thread.java:831)\r\n```\r\n\r\nThis error was raised when Lighthouse sent a forkchoice update with the finalized block hash as 0x00..00:\r\n\r\n```\r\nOct 04 11:25:31.119 INFO Issuing engine_forkchoiceUpdated        head_block_hash: 0x8ce8e58b1fa79c11850b60106dc77a680867cac09109e969eaf7a491ac7681d8, finalized_block_hash: 0x0000000000000000000000000000000000000000000000000000000000000000, service: exec\r\n```\r\n\r\nI had a seemingly [similar issue](https://github.com/ethereum/go-ethereum/pull/23607#issuecomment-931897512) with Geth where they couldn't process the 0x00..00 finalized block hash. Perhaps that is the issue here too?",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/933050977/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/934332336",
    "html_url": "https://github.com/hyperledger/besu/issues/2830#issuecomment-934332336",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2830",
    "id": 934332336,
    "node_id": "IC_kwDODE2jmc43sMew",
    "user": {
      "login": "garyschulte",
      "id": 1238512,
      "node_id": "MDQ6VXNlcjEyMzg1MTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1238512?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/garyschulte",
      "html_url": "https://github.com/garyschulte",
      "followers_url": "https://api.github.com/users/garyschulte/followers",
      "following_url": "https://api.github.com/users/garyschulte/following{/other_user}",
      "gists_url": "https://api.github.com/users/garyschulte/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/garyschulte/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/garyschulte/subscriptions",
      "organizations_url": "https://api.github.com/users/garyschulte/orgs",
      "repos_url": "https://api.github.com/users/garyschulte/repos",
      "events_url": "https://api.github.com/users/garyschulte/events{/privacy}",
      "received_events_url": "https://api.github.com/users/garyschulte/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-05T11:43:59Z",
    "updated_at": "2021-10-05T11:43:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I had a seemingly [similar issue](https://github.com/ethereum/go-ethereum/pull/23607#issuecomment-931897512) with Geth where they couldn't process the 0x00..00 finalized block hash. Perhaps that is the issue here too?\r\n\r\nSorry for the slow reply.  Yes, that was it exactly, and we are playing nicely now :+1:",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/934332336/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
