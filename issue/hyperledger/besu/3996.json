{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/3996",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/3996/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/3996/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/3996/events",
  "html_url": "https://github.com/hyperledger/besu/issues/3996",
  "id": 1278127224,
  "node_id": "I_kwDODE2jmc5MLqx4",
  "number": 3996,
  "title": "Fast sync fails with Max Retries reached and backward sync keeps waiting for pre-conditions",
  "user": {
    "login": "ricardolyn",
    "id": 1945557,
    "node_id": "MDQ6VXNlcjE5NDU1NTc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1945557?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ricardolyn",
    "html_url": "https://github.com/ricardolyn",
    "followers_url": "https://api.github.com/users/ricardolyn/followers",
    "following_url": "https://api.github.com/users/ricardolyn/following{/other_user}",
    "gists_url": "https://api.github.com/users/ricardolyn/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ricardolyn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ricardolyn/subscriptions",
    "organizations_url": "https://api.github.com/users/ricardolyn/orgs",
    "repos_url": "https://api.github.com/users/ricardolyn/repos",
    "events_url": "https://api.github.com/users/ricardolyn/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ricardolyn/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1537362490,
      "node_id": "MDU6TGFiZWwxNTM3MzYyNDkw",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    },
    {
      "id": 2152224197,
      "node_id": "MDU6TGFiZWwyMTUyMjI0MTk3",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/TeamRevenant",
      "name": "TeamRevenant",
      "color": "78e298",
      "default": false,
      "description": "GH issues worked on by Revenant Team"
    },
    {
      "id": 3013559202,
      "node_id": "MDU6TGFiZWwzMDEzNTU5MjAy",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/mainnet",
      "name": "mainnet",
      "color": "9D578C",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "Gabriel-Trintinalia",
    "id": 14837672,
    "node_id": "MDQ6VXNlcjE0ODM3Njcy",
    "avatar_url": "https://avatars.githubusercontent.com/u/14837672?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Gabriel-Trintinalia",
    "html_url": "https://github.com/Gabriel-Trintinalia",
    "followers_url": "https://api.github.com/users/Gabriel-Trintinalia/followers",
    "following_url": "https://api.github.com/users/Gabriel-Trintinalia/following{/other_user}",
    "gists_url": "https://api.github.com/users/Gabriel-Trintinalia/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Gabriel-Trintinalia/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Gabriel-Trintinalia/subscriptions",
    "organizations_url": "https://api.github.com/users/Gabriel-Trintinalia/orgs",
    "repos_url": "https://api.github.com/users/Gabriel-Trintinalia/repos",
    "events_url": "https://api.github.com/users/Gabriel-Trintinalia/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Gabriel-Trintinalia/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "Gabriel-Trintinalia",
      "id": 14837672,
      "node_id": "MDQ6VXNlcjE0ODM3Njcy",
      "avatar_url": "https://avatars.githubusercontent.com/u/14837672?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gabriel-Trintinalia",
      "html_url": "https://github.com/Gabriel-Trintinalia",
      "followers_url": "https://api.github.com/users/Gabriel-Trintinalia/followers",
      "following_url": "https://api.github.com/users/Gabriel-Trintinalia/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gabriel-Trintinalia/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gabriel-Trintinalia/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gabriel-Trintinalia/subscriptions",
      "organizations_url": "https://api.github.com/users/Gabriel-Trintinalia/orgs",
      "repos_url": "https://api.github.com/users/Gabriel-Trintinalia/repos",
      "events_url": "https://api.github.com/users/Gabriel-Trintinalia/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gabriel-Trintinalia/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-06-21T08:59:50Z",
  "updated_at": "2022-07-19T08:52:17Z",
  "closed_at": "2022-07-13T23:42:01Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "<!-- Have you done the following? -->\r\n<!--   * read the Code of Conduct? By filing an Issue, you are expected to -->  \r\n<!--     comply with it, including treating everyone with respect: -->\r\n<!--     https://github.com/hyperledger/besu/blob/main/CODE_OF_CONDUCT.md -->\r\n<!--   * Reproduced the issue in the latest version of the software -->\r\n<!--   * Read the debugging docs: https://besu.hyperledger.org/en/stable/HowTo/Monitor/Logging/ -->\r\n<!--   * Duplicate Issue check:  https://github.com/search?q=+is%3Aissue+repo%3Ahyperledger/Besu -->\r\n<!-- Note:  Not all sections will apply to all issue types. -->\r\n\r\n### Description\r\n\r\nWhen setting up a Besu node to sync with the Kiln network and connected to a Lighthouse Beacon, we keep having issues with syncing (using FAST sync mode) and finding peers.\r\n\r\n### Steps to Reproduce (Bug)\r\n1. Configure a Besu node for Kiln\r\n2. Configure a Lighthouse beacon for Kiln, and set the Execution client as the Besu node.\r\n3. Start both services\r\n\r\n**Expected behavior:** [What you expect to happen]\r\n\r\nBoth Lighthouse and Besu are able to sync. \r\n\r\n**Actual behavior:** [What actually happens]\r\n\r\nLighthouse gets synced and connected to Besu.\r\nHowever, keeps showing errors that Besu is Far behind (even if besu showed logs that confirmed the control from Beacon).\r\n\r\n\r\n\r\n**Frequency:** 100% of times on this setup.\r\n\r\n### Versions (Add all that apply)\r\n* Image version: `fab10/besu:22.4.3-SNAPSHOT` (running on kubernetes)\r\n\r\n### Additional Information (Add any of the following or anything else that may be relevant)\r\n* Besu setup info - genesis file, config options\r\n```\r\n       --data-path=/data                                                                                                                                                                                        │\r\n│       --host-allowlist=*                                                                                                                                                                                       │\r\n│       --network=kiln                                                                                                                                                                                           │\r\n│       --rpc-http-enabled=true                                                                                                                                                                                  │\r\n│       --rpc-http-host=0.0.0.0                                                                                                                                                                                  │\r\n│       --rpc-http-cors-origins=*                                                                                                                                                                                │\r\n│       --rpc-http-port=8545                                                                                                                                                                                     │\r\n│       --rpc-http-max-active-connections=300                                                                                                                                                                    │\r\n│       --rpc-ws-enabled=true                                                                                                                                                                                    │\r\n│       --rpc-ws-host=0.0.0.0                                                                                                                                                                                    │\r\n│       --rpc-ws-port=8546                                                                                                                                                                                       │\r\n│       --engine-host-allowlist=*                                                                                                                                                                                │\r\n│       --engine-rpc-http-port=8550                                                                                                                                                                              │\r\n│       --engine-jwt-enabled=true                                                                                                                                                                                │\r\n│       --engine-jwt-secret=/opt/secrets/jwtsecret.hex                                                                                                                                                           │\r\n│       --override-genesis-config=terminalTotalDifficulty=20000000000000                                                                                                                                         │\r\n│       --data-storage-format=BONSAI                                                                                                                                                                             │\r\n│       --sync-mode=FAST                                                                                                                                                                                         │\r\n│       --fast-sync-min-peers=1                                                                                                                                                                                  │\r\n│       --rpc-http-enabled=true                                                                                                                                                                                  │\r\n│       --rpc-http-api=ETH,ADMIN,NET,WEB3\r\n```\r\n\r\n### Logs\r\n\r\n1. **Logs with errors on fast sync:**\r\n\r\n```\r\n 2022-06-20 14:39:00.618+00:00 | nioEventLoopGroup-3-1 | INFO  | SyncTargetManager | Found common ancestor with peer Peer 0xe2c33c7b8a5c0ed167... PeerReputation 100, validated? true, disconnected? false at b │\r\n│ 2022-06-20 14:39:03.857+00:00 | nioEventLoopGroup-3-1 | INFO  | SyncTargetManager | Found common ancestor with peer Peer 0xe2c33c7b8a5c0ed167... PeerReputation 100, validated? true, disconnected? false at b │\r\n│ 2022-06-20 14:39:06.946+00:00 | nioEventLoopGroup-3-1 | INFO  | SyncTargetManager | Found common ancestor with peer Peer 0xe2c33c7b8a5c0ed167... PeerReputation 100, validated? true, disconnected? false at b │\r\n│ 2022-06-20 14:39:11.938+00:00 | nioEventLoopGroup-3-1 | INFO  | FastSyncDownloader | Re-pivoting to newer block.                                                                                               │\r\n│ 2022-06-20 14:39:11.938+00:00 | nioEventLoopGroup-3-1 | INFO  | FastSyncDownloader | Starting sync.                                                                                                            │\r\n│ 2022-06-20 14:39:11.938+00:00 | nioEventLoopGroup-3-1 | INFO  | FastSyncDownloader | Clearing bonsai flat account db                                                                                           │\r\n│ 2022-06-20 14:39:12.065+00:00 | nioEventLoopGroup-3-1 | INFO  | TransitionPivotSelector | A finalized block is present, use it as pivot                                                                        │\r\n│ 2022-06-20 14:39:12.066+00:00 | nioEventLoopGroup-3-1 | INFO  | PivotSelectorFromFinalizedBlock | Returning finalized block hash as pivot: 0xde6cad12a72f83e8f24fd936a49bef5fa67ebdee68100aedd58b4d5463613b1a  │\r\n│ 2022-06-20 14:39:12.069+00:00 | nioEventLoopGroup-3-1 | INFO  | AbstractRetryingPeerTask | No useful peer found, checking remaining current peers for usefulness: 0                                            │\r\n│ 2022-06-20 14:39:17.070+00:00 | EthScheduler-Timer-0 | INFO  | AbstractRetryingPeerTask | No useful peer found, checking remaining current peers for usefulness: 0                                             │\r\n│ 2022-06-20 14:39:22.070+00:00 | EthScheduler-Timer-0 | INFO  | AbstractRetryingPeerTask | No useful peer found, checking remaining current peers for usefulness: 0                                             │\r\n│ 2022-06-20 14:39:27.073+00:00 | EthScheduler-Timer-0 | ERROR | FastSyncDownloader | Encountered an unexpected error during fast sync. Restarting fast sync in PT5S seconds.                                    │\r\n│ java.util.concurrent.CompletionException: org.hyperledger.besu.ethereum.eth.manager.exceptions.MaxRetriesReachedException: Task failed: MAX_RETRIES_REACHED                                                    │\r\n│     at java.base/java.util.concurrent.CompletableFuture.encodeThrowable(CompletableFuture.java:331)                                                                                                            │\r\n│     at java.base/java.util.concurrent.CompletableFuture.completeThrowable(CompletableFuture.java:346)                                                                                                          │\r\n│     at java.base/java.util.concurrent.CompletableFuture$UniApply.tryFire(CompletableFuture.java:632)                                                                                                           │\r\n│     at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)                                                                                                               │\r\n│     at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)                                                                                                     │\r\n│     at org.hyperledger.besu.ethereum.eth.manager.task.AbstractRetryingPeerTask.executeTask(AbstractRetryingPeerTask.java:85)                                                                                   │\r\n│     at org.hyperledger.besu.ethereum.eth.manager.task.AbstractEthTask.executeTaskTimed(AbstractEthTask.java:150)                                                                                               │\r\n│     at org.hyperledger.besu.ethereum.eth.manager.task.AbstractRetryingPeerTask.lambda$handleTaskError$1(AbstractRetryingPeerTask.java:126)                                                                     │\r\n│     at java.base/java.util.concurrent.CompletableFuture.uniWhenComplete(CompletableFuture.java:859)                                                                                                            │\r\n│     at java.base/java.util.concurrent.CompletableFuture$UniWhenComplete.tryFire(CompletableFuture.java:837)                                                                                                    │\r\n│     at java.base/java.util.concurrent.CompletableFuture.postComplete(CompletableFuture.java:506)                                                                                                               │\r\n│     at java.base/java.util.concurrent.CompletableFuture.completeExceptionally(CompletableFuture.java:2088)                                                                                                     │\r\n│     at org.hyperledger.besu.ethereum.eth.manager.EthScheduler.lambda$failAfterTimeout$11(EthScheduler.java:278)                                                                                                │\r\n│     at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)                                                                                                                                      │\r\n│     at java.base/java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:304)                                                                                │\r\n│     at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)                                                                                                               │\r\n│     at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)                                                                                                               │\r\n│     at java.base/java.lang.Thread.run(Thread.java:829)                                                                                                                                                         │\r\n│ Caused by: org.hyperledger.besu.ethereum.eth.manager.exceptions.MaxRetriesReachedException: Task failed: MAX_RETRIES_REACHED                                                                                   │\r\n│     ... 13 more                                                                                                                                                                                                │\r\n│ 2022-06-20 14:39:32.075+00:00 | EthScheduler-Timer-0 | INFO  | FastSyncDownloader | Starting sync.                                                                                                             │\r\n│ 2022-06-20 14:39:32.075+00:00 | EthScheduler-Timer-0 | INFO  | FastSyncDownloader | Clearing bonsai flat account db                                                                                            │\r\n│ 2022-06-20 14:39:32.193+00:00 | EthScheduler-Timer-0 | INFO  | WaitForPeersTask | Waiting for 1 total peers to connect. 0 peers currently connected.                                                           │\r\n│ 2022-06-20 14:40:37.465+00:00 | Thread-13 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                         │\r\n│ 2022-06-20 14:42:37.466+00:00 | Thread-14 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                         │\r\n│ 2022-06-20 14:43:24.990+00:00 | vert.x-worker-thread-0 | INFO  | EthProtocolManager | disconnecting peers with total difficulty over 20001479054577                                                            │\r\n│ 2022-06-20 14:44:37.467+00:00 | Thread-15 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                         │\r\n│ 2022-06-20 14:46:37.467+00:00 | Thread-16 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                         │\r\n│ 2022-06-20 14:48:37.468+00:00 | Thread-17 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                         │\r\n│ 2022-06-20 14:49:48.736+00:00 | vert.x-worker-thread-0 | INFO  | EthProtocolManager | disconnecting peers with total difficulty over 20001479054577                                                            │\r\n│ 2022-06-20 14:50:37.469+00:00 | Thread-18 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                         │\r\n│ 2022-06-20 14:52:37.470+00:00 | Thread-19 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                         │\r\n│ 2022-06-20 14:54:37.471+00:00 | Thread-20 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                         │\r\n│ 2022-06-20 14:56:12.569+00:00 | vert.x-worker-thread-0 | INFO  | EthProtocolManager | disconnecting peers with total difficulty over 20001479054577                                                            │\r\n│ 2022-06-20 14:56:37.472+00:00 | Thread-21 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                         │\r\n│ 2022-06-20 14:58:37.473+00:00 | Thread-22 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                         │\r\n│ 2022-06-20 15:00:37.474+00:00 | Thread-23 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                         │\r\n│ 2022-06-20 15:02:36.715+00:00 | vert.x-worker-thread-0 | INFO  | EthProtocolManager | disconnecting peers with total difficulty over 20001479054577\r\n```\r\n\r\n2. **Same issue after 12h hours:**\r\n\r\n```\r\n│ 2022-06-21 08:06:36.761+00:00 | vert.x-worker-thread-0 | INFO  | EthProtocolManager | disconnecting peers with total difficulty over 20001479054577                                                            │\r\n│ 2022-06-21 08:06:37.851+00:00 | Thread-536 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:08:37.852+00:00 | Thread-537 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:10:37.853+00:00 | Thread-538 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:12:37.853+00:00 | Thread-539 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:13:00.932+00:00 | vert.x-worker-thread-0 | INFO  | EthProtocolManager | disconnecting peers with total difficulty over 20001479054577                                                            │\r\n│ 2022-06-21 08:14:37.854+00:00 | Thread-540 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:16:37.855+00:00 | Thread-541 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:18:37.855+00:00 | Thread-542 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:19:24.808+00:00 | vert.x-worker-thread-0 | INFO  | EthProtocolManager | disconnecting peers with total difficulty over 20001479054577                                                            │\r\n│ 2022-06-21 08:20:37.856+00:00 | Thread-543 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:22:37.856+00:00 | Thread-544 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:24:37.857+00:00 | Thread-545 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:25:48.575+00:00 | vert.x-worker-thread-0 | INFO  | EthProtocolManager | disconnecting peers with total difficulty over 20001479054577                                                            │\r\n│ 2022-06-21 08:26:37.858+00:00 | Thread-546 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:28:37.858+00:00 | Thread-547 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:30:37.859+00:00 | Thread-548 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:32:12.658+00:00 | vert.x-worker-thread-0 | INFO  | EthProtocolManager | disconnecting peers with total difficulty over 20001479054577                                                            │\r\n│ 2022-06-21 08:32:37.860+00:00 | Thread-549 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:34:37.860+00:00 | Thread-550 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:36:37.861+00:00 | Thread-551 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:38:36.787+00:00 | vert.x-worker-thread-0 | INFO  | EthProtocolManager | disconnecting peers with total difficulty over 20001479054577                                                            │\r\n│ 2022-06-21 08:38:37.862+00:00 | Thread-552 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:40:37.862+00:00 | Thread-553 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:42:37.863+00:00 | Thread-554 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:44:37.864+00:00 | Thread-555 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:45:00.576+00:00 | vert.x-worker-thread-0 | INFO  | EthProtocolManager | disconnecting peers with total difficulty over 20001479054577                                                            │\r\n│ 2022-06-21 08:46:37.864+00:00 | Thread-556 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:48:37.865+00:00 | Thread-557 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:50:37.866+00:00 | Thread-558 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:51:24.804+00:00 | vert.x-worker-thread-0 | INFO  | EthProtocolManager | disconnecting peers with total difficulty over 20001479054577                                                            │\r\n│ 2022-06-21 08:52:37.867+00:00 | Thread-559 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:54:37.867+00:00 | Thread-560 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:56:37.868+00:00 | Thread-561 | INFO  | BackwardSyncContext | Waiting for preconditions...                                                                                                        │\r\n│ 2022-06-21 08:57:48.839+00:00 | vert.x-worker-thread-0 | INFO  | EthProtocolManager | disconnecting peers with total difficulty over 20001479054577                                                            │\r\n│ 2022-06-21 08:58:37.869+00:00 | Thread-562 | INFO  | BackwardSyncContext | Waiting for preconditions...\r\n```\r\nand Logs from lighthouse:\r\n\r\n```\r\n│ Jun 21 08:57:48.585 INFO New block received                      root: 0xa19595f352018856e6d42467b9a530a620c13ac4dc0a0d528fc9cebe880582c9, slot: 732864                                                        │\r\n│ Jun 21 08:57:54.000 WARN Head execution payload is unverified    execution_block_hash: ExecutionBlockHash(0x48e8703b1e02d25afc619d1bbfbb0d19caaa192d128134ae6e8d22fdc701f7eb), service: slot_notifier          │\r\n│ Jun 21 08:57:54.001 INFO Synced                                  slot: 732864, block: 0xa195…82c9, epoch: 22902, finalized_epoch: 22900, finalized_root: 0x7c5d…c37f, exec_hash: 0x48e8…f7eb (unverified), pee │\r\n│ Jun 21 08:58:00.624 INFO New block received                      root: 0xc4ef6c18201443621ec8ab32985e4aaa36f5cd68a2cce2eb095398d89fc431af, slot: 732865                                                        │\r\n│ Jun 21 08:58:06.001 WARN Head execution payload is unverified    execution_block_hash: ExecutionBlockHash(0x1c6591b7627a307aeec7a15ea40e7725bcd5ea8b00c5b1907a08e13ae60272d5), service: slot_notifier          │\r\n│ Jun 21 08:58:06.001 INFO Synced                                  slot: 732865, block: 0xc4ef…31af, epoch: 22902, finalized_epoch: 22900, finalized_root: 0x7c5d…c37f, exec_hash: 0x1c65…72d5 (unverified), pee │\r\n│ Jun 21 08:58:18.001 WARN Head execution payload is unverified    execution_block_hash: ExecutionBlockHash(0x1c6591b7627a307aeec7a15ea40e7725bcd5ea8b00c5b1907a08e13ae60272d5), service: slot_notifier          │\r\n│ Jun 21 08:58:18.001 INFO Synced                                  slot: 732866, block:    …  empty, epoch: 22902, finalized_epoch: 22900, finalized_root: 0x7c5d…c37f, exec_hash: 0x1c65…72d5 (unverified), pee │\r\n│ Jun 21 08:58:24.197 INFO New block received                      root: 0xb73db67f143c486890d95d2929431c3bb67248c81dfb6316a29fde7f296fdb3d, slot: 732867                                                        │\r\n│ Jun 21 08:58:30.001 WARN Head execution payload is unverified    execution_block_hash: ExecutionBlockHash(0x3ace7a3a2fd43e2686cfac48d568357aebe8dc63317c59da90cf6b015fffbf0c), service: slot_notifier          │\r\n│ Jun 21 08:58:30.001 INFO Synced                                  slot: 732867, block: 0xb73d…db3d, epoch: 22902, finalized_epoch: 22900, finalized_root: 0x7c5d…c37f, exec_hash: 0x3ace…bf0c (unverified), pee │\r\n│ Jun 21 08:58:37.671 INFO New block received                      root: 0xdc93885ce79a92edae1754305039cba47f28186ce005900587b700d68d6097be, slot: 732868                                                        │\r\n│ Jun 21 08:58:42.001 WARN Head execution payload is unverified    execution_block_hash: ExecutionBlockHash(0x5dbf8712fab6ab4a99388b184950ebbe26a8d4f4a544af131001623ee2acdfc4), service: slot_notifier          │\r\n│ Jun 21 08:58:42.001 INFO Synced                                  slot: 732868, block: 0xdc93…97be, epoch: 22902, finalized_epoch: 22900, finalized_root: 0x7c5d…c37f, exec_hash: 0x5dbf…dfc4 (unverified), pee │\r\n│ Jun 21 08:58:48.217 INFO New block received                      root: 0x13d84c4bd54e4377b784c65a6999f2dae3aef57ffed34081c43143fc847b4e30, slot: 732869                                                        │\r\n│ Jun 21 08:58:53.727 ERRO Error fetching block for peer           error: BlockHashMissingFromExecutionLayer(ExecutionBlockHash(0xf23681bc9b1587fd33113797fd35dd353ca5dee8436662e706ded0017af000ad)), block_root │\r\n│ Jun 21 08:58:54.001 WARN Head execution payload is unverified    execution_block_hash: ExecutionBlockHash(0x48c3fd2228ebc2df49f1f04a72f4d5f8cae329680023ffce1f4270abda19f49e), service: slot_notifier          │\r\n│ Jun 21 08:58:54.001 INFO Synced                                  slot: 732869, block: 0x13d8…4e30, epoch: 22902, finalized_epoch: 22900, finalized_root: 0x7c5d…c37f, exec_hash: 0x48c3…f49e (unverified), pee │\r\n│ Jun 21 08:58:54.636 ERRO Error fetching block for peer           error: BlockHashMissingFromExecutionLayer(ExecutionBlockHash(0x6cb7f7287d181ffa93ac08db4ab1bc7f5f8c8fe1f6239a30be060bfe0aa3e8a9)), block_root │\r\n│ Jun 21 08:58:55.231 ERRO Error fetching block for peer           error: BlockHashMissingFromExecutionLayer(ExecutionBlockHash(0x09986e0a44f3a7387f79fad0c8fcffe81e4e8bd0a688b5a292ea32470d89f908)), block_root │\r\n│ Jun 21 08:59:00.153 INFO New block received                      root: 0x84f3e46d78a69d88e68081b220982281b334122ce1b710b4b35f166d636053f7, slot: 732870                                                        │\r\n│ Jun 21 08:59:06.001 WARN Head execution payload is unverified    execution_block_hash: ExecutionBlockHash(0x585b5bddd510467e6a6100e7fb555d5c1e005b42471355a80833f113fefdb2d4), service: slot_notifier          │\r\n│ Jun 21 08:59:06.001 INFO Synced                                  slot: 732870, block: 0x84f3…53f7, epoch: 22902, finalized_epoch: 22900, finalized_root: 0x7c5d…c37f, exec_hash: 0x585b…b2d4 (unverified), pee │\r\n│ Jun 21 08:59:12.254 INFO New block received                      root: 0x3eabcbd0f0fa52e09b8611a9419845d019d6ad31c9fcf8f9ddc8b3952222b041, slot: 732871                                                        │\r\n│ Jun 21 08:59:18.001 WARN Head execution payload is unverified    execution_block_hash: ExecutionBlockHash(0xe002453629192b9ed8fa8f90586038f03c91f4e94d79697ef2c30480bb76d843), service: slot_notifier          │\r\n│ Jun 21 08:59:18.001 INFO Synced                                  slot: 732871, block: 0x3eab…b041, epoch: 22902, finalized_epoch: 22900, finalized_root: 0x7c5d…c37f, exec_hash: 0xe002…d843 (unverified), pee │\r\n│ Jun 21 08:59:24.167 INFO New block received                      root: 0xe4994f031b02975573539f8242ec6f902d6dd9eeccedce8feb845ba7d44b3eb3, slot: 732872\r\n```",
  "closed_by": {
    "login": "macfarla",
    "id": 2627919,
    "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/macfarla",
    "html_url": "https://github.com/macfarla",
    "followers_url": "https://api.github.com/users/macfarla/followers",
    "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
    "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
    "organizations_url": "https://api.github.com/users/macfarla/orgs",
    "repos_url": "https://api.github.com/users/macfarla/repos",
    "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
    "received_events_url": "https://api.github.com/users/macfarla/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/3996/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/3996/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1181423402",
    "html_url": "https://github.com/hyperledger/besu/issues/3996#issuecomment-1181423402",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/3996",
    "id": 1181423402,
    "node_id": "IC_kwDODE2jmc5Gaxcq",
    "user": {
      "login": "Gabriel-Trintinalia",
      "id": 14837672,
      "node_id": "MDQ6VXNlcjE0ODM3Njcy",
      "avatar_url": "https://avatars.githubusercontent.com/u/14837672?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gabriel-Trintinalia",
      "html_url": "https://github.com/Gabriel-Trintinalia",
      "followers_url": "https://api.github.com/users/Gabriel-Trintinalia/followers",
      "following_url": "https://api.github.com/users/Gabriel-Trintinalia/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gabriel-Trintinalia/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gabriel-Trintinalia/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gabriel-Trintinalia/subscriptions",
      "organizations_url": "https://api.github.com/users/Gabriel-Trintinalia/orgs",
      "repos_url": "https://api.github.com/users/Gabriel-Trintinalia/repos",
      "events_url": "https://api.github.com/users/Gabriel-Trintinalia/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gabriel-Trintinalia/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-12T07:38:05Z",
    "updated_at": "2022-07-12T07:39:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi Ricardo, \r\n\r\nI was not able to replicate this issue using the latest (22.4.4) version of Besu with the latest unstable version of lighthouse. I was able to get them to sync. The message (FarBehind) on LH appeared until Besu finished sync \r\n\r\nInitially, I also could not find the message: \r\n\r\n`INFO  disconnecting peers with total difficulty over. `\r\n \r\nLooking into the code, it seems that the code where best got stuck was introduced by the PR:  https://github.com/hyperledger/besu/pull/3944. \r\n\r\nI believe that the issue was caused by the block: \r\nhttps://github.com/jflo/besu/blob/e8674bdea9cd885c66be52c63bca78d68479a940/ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/manager/EthProtocolManager.java#L394\r\n\r\nThis code, however, was reverted by the PR https://github.com/hyperledger/besu/pull/3978. \r\n\r\nWould be able to test it again with the latest stable version of Besu?\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1181423402/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1183752954",
    "html_url": "https://github.com/hyperledger/besu/issues/3996#issuecomment-1183752954",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/3996",
    "id": 1183752954,
    "node_id": "IC_kwDODE2jmc5GjqL6",
    "user": {
      "login": "Gabriel-Trintinalia",
      "id": 14837672,
      "node_id": "MDQ6VXNlcjE0ODM3Njcy",
      "avatar_url": "https://avatars.githubusercontent.com/u/14837672?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gabriel-Trintinalia",
      "html_url": "https://github.com/Gabriel-Trintinalia",
      "followers_url": "https://api.github.com/users/Gabriel-Trintinalia/followers",
      "following_url": "https://api.github.com/users/Gabriel-Trintinalia/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gabriel-Trintinalia/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gabriel-Trintinalia/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gabriel-Trintinalia/subscriptions",
      "organizations_url": "https://api.github.com/users/Gabriel-Trintinalia/orgs",
      "repos_url": "https://api.github.com/users/Gabriel-Trintinalia/repos",
      "events_url": "https://api.github.com/users/Gabriel-Trintinalia/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gabriel-Trintinalia/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-13T22:41:49Z",
    "updated_at": "2022-07-13T22:41:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "Closing this one since the issue seems to be caused by an unstable code that got removed from Besu ",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1183752954/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1188780950",
    "html_url": "https://github.com/hyperledger/besu/issues/3996#issuecomment-1188780950",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/3996",
    "id": 1188780950,
    "node_id": "IC_kwDODE2jmc5G21uW",
    "user": {
      "login": "ricardolyn",
      "id": 1945557,
      "node_id": "MDQ6VXNlcjE5NDU1NTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1945557?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ricardolyn",
      "html_url": "https://github.com/ricardolyn",
      "followers_url": "https://api.github.com/users/ricardolyn/followers",
      "following_url": "https://api.github.com/users/ricardolyn/following{/other_user}",
      "gists_url": "https://api.github.com/users/ricardolyn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ricardolyn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ricardolyn/subscriptions",
      "organizations_url": "https://api.github.com/users/ricardolyn/orgs",
      "repos_url": "https://api.github.com/users/ricardolyn/repos",
      "events_url": "https://api.github.com/users/ricardolyn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ricardolyn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-19T08:52:17Z",
    "updated_at": "2022-07-19T08:52:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "thanks @Gabriel-Trintinalia ",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1188780950/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
