{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/829",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/829/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/829/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/829/events",
  "html_url": "https://github.com/hyperledger/besu/issues/829",
  "id": 611206683,
  "node_id": "MDU6SXNzdWU2MTEyMDY2ODM=",
  "number": 829,
  "title": "Syncing besu with a geth clique network - TimestampMoreRecentThanParent | Invalid block header: timestamp is not sufficiently newer than parent timestamp",
  "user": {
    "login": "ivica7",
    "id": 17837189,
    "node_id": "MDQ6VXNlcjE3ODM3MTg5",
    "avatar_url": "https://avatars.githubusercontent.com/u/17837189?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ivica7",
    "html_url": "https://github.com/ivica7",
    "followers_url": "https://api.github.com/users/ivica7/followers",
    "following_url": "https://api.github.com/users/ivica7/following{/other_user}",
    "gists_url": "https://api.github.com/users/ivica7/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ivica7/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ivica7/subscriptions",
    "organizations_url": "https://api.github.com/users/ivica7/orgs",
    "repos_url": "https://api.github.com/users/ivica7/repos",
    "events_url": "https://api.github.com/users/ivica7/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ivica7/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2020-05-02T14:52:25Z",
  "updated_at": "2020-05-06T11:08:04Z",
  "closed_at": "2020-05-02T21:31:43Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Currently I am experimenting with migrating our clique network from geth 1.8.2 to besu 1.4.4. The network has 5s block time and is running now already for more than 1y. My idea was to connect a new besu client to the existing geth clients in the network and then replace geth clients one-by-one.\r\n\r\nThe synchronisation starts as expected but at block no. 200, I am getting this:\r\n\r\n```\r\n02 14:31:53.942+00:00 | EthScheduler-Workers-2 | TRACE | TimestampMoreRecentThanParent | Invalid block header: timestamp 1568792908 is not sufficiently newer than parent timestamp 1568792903\r\n\r\n2020-05-02 14:31:53.943+00:00 | EthScheduler-Workers-2 | DEBUG | DownloadHeaderSequenceTask | Received invalid headers from peer, disconnecting from: 0x2e80c9de69d97df46a...\r\n\r\n\r\n2020-05-02 14:31:53.943+00:00 | EthScheduler-Workers-2 | DEBUG | AbstractPeerConnection | Disconnecting (0x02 BREACH_OF_PROTOCOL) from PeerInfo{version=5, clientId='Geth/v1.8.2-stable-b8b9f7f4/linux-amd64/go1.9.4', capabilities=[eth/63, eth/62], port=0, nodeId=0x2e80c9de69d97df46a3ad74d1824968e799df32ae3923029b828b99d7a40fc2d160b9c914df93cf4656f4cd15f7b8e7655f2a181b6a2f2ab3bcc74218d32ba86}\r\n\r\n2020-05-02 14:31:53.943+00:00 | EthScheduler-Workers-2 | DEBUG | RlpxAgent | Disconnecting from peer that is not permitted to maintain ongoing connection: org.hyperledger.besu.ethereum.p2p.rlpx.connections.RlpxConnection$LocallyInitiatedRlpxConnection@56566cab\r\n\r\n2020-05-02 14:31:53.943+00:00 | EthScheduler-Workers-2 | DEBUG | EthPeer | Received useless response for headers from peer 0x2e80c9de69d97df46a...\r\n2020-05-02 14:31:53.944+00:00 | EthScheduler-Workers-2 | DEBUG | EthPeer | Received useless response for headers from peer 0x2e80c9de69d97df46a...\r\n2020-05-02 14:31:53.944+00:00 | EthScheduler-Workers-3 | DEBUG | DownloadHeaderSequenceTask | Downloading headers from 401 to 600.\r\n2020-05-02 14:31:53.945+00:00 | EthScheduler-Workers-1 | DEBUG | DownloadHeaderSequenceTask | Downloading headers from 601 to 800.\r\n2020-05-02 14:31:53.945+00:00 | EthScheduler-Workers-3 | INFO  | AbstractRetryingPeerTask | No peers available, waiting for peers: 0\r\n\r\n```\r\n\r\nThe only hint why this happens seems to be `TimestampMoreRecentThanParent | Invalid block header: timestamp 1568792908 is not sufficiently newer than parent timestamp 1568792903`, however, the delta between the two timestamp is perfectly fine, which is 5s as specified in the genesis file.",
  "closed_by": {
    "login": "ivica7",
    "id": 17837189,
    "node_id": "MDQ6VXNlcjE3ODM3MTg5",
    "avatar_url": "https://avatars.githubusercontent.com/u/17837189?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ivica7",
    "html_url": "https://github.com/ivica7",
    "followers_url": "https://api.github.com/users/ivica7/followers",
    "following_url": "https://api.github.com/users/ivica7/following{/other_user}",
    "gists_url": "https://api.github.com/users/ivica7/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ivica7/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ivica7/subscriptions",
    "organizations_url": "https://api.github.com/users/ivica7/orgs",
    "repos_url": "https://api.github.com/users/ivica7/repos",
    "events_url": "https://api.github.com/users/ivica7/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ivica7/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/829/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/829/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/623015993",
    "html_url": "https://github.com/hyperledger/besu/issues/829#issuecomment-623015993",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/829",
    "id": 623015993,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMzAxNTk5Mw==",
    "user": {
      "login": "ivica7",
      "id": 17837189,
      "node_id": "MDQ6VXNlcjE3ODM3MTg5",
      "avatar_url": "https://avatars.githubusercontent.com/u/17837189?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ivica7",
      "html_url": "https://github.com/ivica7",
      "followers_url": "https://api.github.com/users/ivica7/followers",
      "following_url": "https://api.github.com/users/ivica7/following{/other_user}",
      "gists_url": "https://api.github.com/users/ivica7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ivica7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ivica7/subscriptions",
      "organizations_url": "https://api.github.com/users/ivica7/orgs",
      "repos_url": "https://api.github.com/users/ivica7/repos",
      "events_url": "https://api.github.com/users/ivica7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ivica7/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-02T21:31:43Z",
    "updated_at": "2020-05-02T21:31:43Z",
    "author_association": "NONE",
    "body": "Got it. The problem was that I reused geth's genesis.json which uses \"clique.period\" and \"clique.epoch\" instead of besu's \"clique.blockperiodsecond\" and \"clique.epochlength\" as expected by CliqueConfigOptions class. Since the code in CliqueConfigOptions didn't find the values in the JSON files, defaults were triggered (15s block time).",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/623015993/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/624585033",
    "html_url": "https://github.com/hyperledger/besu/issues/829#issuecomment-624585033",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/829",
    "id": 624585033,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDU4NTAzMw==",
    "user": {
      "login": "thorstenhirsch",
      "id": 619741,
      "node_id": "MDQ6VXNlcjYxOTc0MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/619741?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/thorstenhirsch",
      "html_url": "https://github.com/thorstenhirsch",
      "followers_url": "https://api.github.com/users/thorstenhirsch/followers",
      "following_url": "https://api.github.com/users/thorstenhirsch/following{/other_user}",
      "gists_url": "https://api.github.com/users/thorstenhirsch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/thorstenhirsch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/thorstenhirsch/subscriptions",
      "organizations_url": "https://api.github.com/users/thorstenhirsch/orgs",
      "repos_url": "https://api.github.com/users/thorstenhirsch/repos",
      "events_url": "https://api.github.com/users/thorstenhirsch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/thorstenhirsch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-06T11:08:04Z",
    "updated_at": "2020-05-06T11:08:04Z",
    "author_association": "NONE",
    "body": "If anyone else stumbles upon this: \"clique.blockperiodseconds\" (plural) is the correct parameter name.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/624585033/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
