{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/528",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/528/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/528/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/528/events",
  "html_url": "https://github.com/hyperledger/besu/issues/528",
  "id": 584748770,
  "node_id": "MDU6SXNzdWU1ODQ3NDg3NzA=",
  "number": 528,
  "title": "On-chain permissioning nodes can't peer when using a non-validator bootnode",
  "user": {
    "login": "arash009",
    "id": 33149995,
    "node_id": "MDQ6VXNlcjMzMTQ5OTk1",
    "avatar_url": "https://avatars.githubusercontent.com/u/33149995?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/arash009",
    "html_url": "https://github.com/arash009",
    "followers_url": "https://api.github.com/users/arash009/followers",
    "following_url": "https://api.github.com/users/arash009/following{/other_user}",
    "gists_url": "https://api.github.com/users/arash009/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/arash009/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/arash009/subscriptions",
    "organizations_url": "https://api.github.com/users/arash009/orgs",
    "repos_url": "https://api.github.com/users/arash009/repos",
    "events_url": "https://api.github.com/users/arash009/events{/privacy}",
    "received_events_url": "https://api.github.com/users/arash009/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1537362490,
      "node_id": "MDU6TGFiZWwxNTM3MzYyNDkw",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "mark-terry",
    "id": 36909937,
    "node_id": "MDQ6VXNlcjM2OTA5OTM3",
    "avatar_url": "https://avatars.githubusercontent.com/u/36909937?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mark-terry",
    "html_url": "https://github.com/mark-terry",
    "followers_url": "https://api.github.com/users/mark-terry/followers",
    "following_url": "https://api.github.com/users/mark-terry/following{/other_user}",
    "gists_url": "https://api.github.com/users/mark-terry/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mark-terry/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mark-terry/subscriptions",
    "organizations_url": "https://api.github.com/users/mark-terry/orgs",
    "repos_url": "https://api.github.com/users/mark-terry/repos",
    "events_url": "https://api.github.com/users/mark-terry/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mark-terry/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    {
      "login": "mark-terry",
      "id": 36909937,
      "node_id": "MDQ6VXNlcjM2OTA5OTM3",
      "avatar_url": "https://avatars.githubusercontent.com/u/36909937?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mark-terry",
      "html_url": "https://github.com/mark-terry",
      "followers_url": "https://api.github.com/users/mark-terry/followers",
      "following_url": "https://api.github.com/users/mark-terry/following{/other_user}",
      "gists_url": "https://api.github.com/users/mark-terry/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mark-terry/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mark-terry/subscriptions",
      "organizations_url": "https://api.github.com/users/mark-terry/orgs",
      "repos_url": "https://api.github.com/users/mark-terry/repos",
      "events_url": "https://api.github.com/users/mark-terry/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mark-terry/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2020-03-19T23:02:32Z",
  "updated_at": "2020-05-25T13:06:34Z",
  "closed_at": "2020-05-25T13:06:34Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Nodes are not able to peer to each other when using on-chain permissioning with a bootnode that is not a validator. In this configuration the bootnode is not a validator and all the validator nodes in the POA network have on-chain node permissioning enabled.\r\n\r\nHypothesis\r\n\r\nWhat appears to be happening is that all the validator nodes are able to connect to the bootnode but not to each other. This appears to be happening because the network is never in sync. When the network is not in sync on-chain permissioning is only able to connect to the bootnodes and so we are not able to connect the bootnodes neighbours or peers.\r\n\r\nIn the SyncStatusNodePermissioningProvider the hasReachedSync flag defaults to false and will toggle to true when we get an in sync event. We never get a sync status change event because the network state never changes and is stalled because none of the validators are able to connect to each other.\r\n\r\nWhen a validator node is used as a bootnode that node has peer connections to all the other nodes same as in the other case but because it is an IBFT validator it also gossiping IBFT messages. So the same issue with peers still occurs in this case but the network is able to function because all IBFT messages are going via the bootnode using gossip.\r\n\r\n \r\n\r\nDefect Prioritisation\r\n\r\nProbability: Frequent. This will always happen in a scenario where IBFT2.0 is used along with a bootnode that is not a validator\r\n\r\nSeverity: Critical. The network stalls and is unable to produce blocks.",
  "closed_by": {
    "login": "mark-terry",
    "id": 36909937,
    "node_id": "MDQ6VXNlcjM2OTA5OTM3",
    "avatar_url": "https://avatars.githubusercontent.com/u/36909937?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mark-terry",
    "html_url": "https://github.com/mark-terry",
    "followers_url": "https://api.github.com/users/mark-terry/followers",
    "following_url": "https://api.github.com/users/mark-terry/following{/other_user}",
    "gists_url": "https://api.github.com/users/mark-terry/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mark-terry/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mark-terry/subscriptions",
    "organizations_url": "https://api.github.com/users/mark-terry/orgs",
    "repos_url": "https://api.github.com/users/mark-terry/repos",
    "events_url": "https://api.github.com/users/mark-terry/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mark-terry/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/528/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/528/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/601455962",
    "html_url": "https://github.com/hyperledger/besu/issues/528#issuecomment-601455962",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/528",
    "id": 601455962,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwMTQ1NTk2Mg==",
    "user": {
      "login": "arash009",
      "id": 33149995,
      "node_id": "MDQ6VXNlcjMzMTQ5OTk1",
      "avatar_url": "https://avatars.githubusercontent.com/u/33149995?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arash009",
      "html_url": "https://github.com/arash009",
      "followers_url": "https://api.github.com/users/arash009/followers",
      "following_url": "https://api.github.com/users/arash009/following{/other_user}",
      "gists_url": "https://api.github.com/users/arash009/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arash009/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arash009/subscriptions",
      "organizations_url": "https://api.github.com/users/arash009/orgs",
      "repos_url": "https://api.github.com/users/arash009/repos",
      "events_url": "https://api.github.com/users/arash009/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arash009/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-03-19T23:03:05Z",
    "updated_at": "2020-03-19T23:03:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "Refer to https://jira.hyperledger.org/browse/BESU-181 for more information",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/601455962/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/614957930",
    "html_url": "https://github.com/hyperledger/besu/issues/528#issuecomment-614957930",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/528",
    "id": 614957930,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNDk1NzkzMA==",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-16T23:58:35Z",
    "updated_at": "2020-04-16T23:58:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "timebox this to 3 days",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/614957930/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/627657619",
    "html_url": "https://github.com/hyperledger/besu/issues/528#issuecomment-627657619",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/528",
    "id": 627657619,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNzY1NzYxOQ==",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-12T23:41:04Z",
    "updated_at": "2020-05-12T23:41:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "when this is fixed, need to add a CHANGELOG entry and remove from known issues",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/627657619/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
