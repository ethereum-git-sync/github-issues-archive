{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/1760",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/1760/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/1760/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/1760/events",
  "html_url": "https://github.com/hyperledger/besu/issues/1760",
  "id": 781640891,
  "node_id": "MDU6SXNzdWU3ODE2NDA4OTE=",
  "number": 1760,
  "title": "Deploying private contract with constructor parameters doesn't work",
  "user": {
    "login": "lucassaldanha",
    "id": 1766440,
    "node_id": "MDQ6VXNlcjE3NjY0NDA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1766440?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/lucassaldanha",
    "html_url": "https://github.com/lucassaldanha",
    "followers_url": "https://api.github.com/users/lucassaldanha/followers",
    "following_url": "https://api.github.com/users/lucassaldanha/following{/other_user}",
    "gists_url": "https://api.github.com/users/lucassaldanha/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/lucassaldanha/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/lucassaldanha/subscriptions",
    "organizations_url": "https://api.github.com/users/lucassaldanha/orgs",
    "repos_url": "https://api.github.com/users/lucassaldanha/repos",
    "events_url": "https://api.github.com/users/lucassaldanha/events{/privacy}",
    "received_events_url": "https://api.github.com/users/lucassaldanha/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1537362490,
      "node_id": "MDU6TGFiZWwxNTM3MzYyNDkw",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    },
    {
      "id": 2051683573,
      "node_id": "MDU6TGFiZWwyMDUxNjgzNTcz",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/P3",
      "name": "P3",
      "color": "ffff00",
      "default": false,
      "description": "Medium (ex: JSON-RPC request not working with a specific client library due to loose spec assumtion)"
    },
    {
      "id": 2152224197,
      "node_id": "MDU6TGFiZWwyMTUyMjI0MTk3",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/TeamRevenant",
      "name": "TeamRevenant",
      "color": "78e298",
      "default": false,
      "description": "GH issues worked on by Revenant Team"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "macfarla",
    "id": 2627919,
    "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/macfarla",
    "html_url": "https://github.com/macfarla",
    "followers_url": "https://api.github.com/users/macfarla/followers",
    "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
    "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
    "organizations_url": "https://api.github.com/users/macfarla/orgs",
    "repos_url": "https://api.github.com/users/macfarla/repos",
    "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
    "received_events_url": "https://api.github.com/users/macfarla/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2021-01-07T22:01:52Z",
  "updated_at": "2021-02-01T21:00:30Z",
  "closed_at": "2021-02-01T21:00:30Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "### Description\r\nRegarding deploying the contract (with constructor parameters) to privacy group. Getting the transaction receipt, but it’s failing to deploy. (And the same contract works fine without privacy group.) Any help on this would be appreciated.\r\n\r\n### Acceptance Criteria\r\n* Deployment should succeed in the same way it succeeds when deploying it as a public contract\r\n\r\n### Steps to Reproduce (Bug)\r\n1. Run the attached script to create a private contract\r\n2. The receipt shows that deployment fails\r\n\r\n**Expected behavior:** [What you expect to happen]\r\n- Successful deployment\r\n\r\n**Actual behavior:** [What actually happens]\r\n- Getting the transaction receipt, but it’s failing to deploy\r\n\r\n**Frequency:** [What percentage of the time does it occur?]\r\n- Everytime\r\n\r\n### Versions (Add all that apply)\r\nN/A\r\n\r\n### Additional Information\r\n[script_and_output.zip](https://github.com/hyperledger/besu/files/5784156/script_and_output.zip)\r\n- Attached the script being used (script.js)\r\n- Attached output of script execution (output.js)\r\n\r\n### Assessment\r\n- Probability: Probable - smart contracts with constructor parameters are commonly used\r\n- Severity: Moderate - the specific contract won't work, but it won't break privacy as a whole\r\n- Assessment: P3\r\n",
  "closed_by": {
    "login": "macfarla",
    "id": 2627919,
    "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/macfarla",
    "html_url": "https://github.com/macfarla",
    "followers_url": "https://api.github.com/users/macfarla/followers",
    "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
    "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
    "organizations_url": "https://api.github.com/users/macfarla/orgs",
    "repos_url": "https://api.github.com/users/macfarla/repos",
    "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
    "received_events_url": "https://api.github.com/users/macfarla/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/1760/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/1760/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/756415721",
    "html_url": "https://github.com/hyperledger/besu/issues/1760#issuecomment-756415721",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1760",
    "id": 756415721,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NjQxNTcyMQ==",
    "user": {
      "login": "lucassaldanha",
      "id": 1766440,
      "node_id": "MDQ6VXNlcjE3NjY0NDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1766440?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lucassaldanha",
      "html_url": "https://github.com/lucassaldanha",
      "followers_url": "https://api.github.com/users/lucassaldanha/followers",
      "following_url": "https://api.github.com/users/lucassaldanha/following{/other_user}",
      "gists_url": "https://api.github.com/users/lucassaldanha/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lucassaldanha/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lucassaldanha/subscriptions",
      "organizations_url": "https://api.github.com/users/lucassaldanha/orgs",
      "repos_url": "https://api.github.com/users/lucassaldanha/repos",
      "events_url": "https://api.github.com/users/lucassaldanha/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lucassaldanha/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-07T22:04:05Z",
    "updated_at": "2021-01-07T22:04:05Z",
    "author_association": "MEMBER",
    "body": "From Kantesha:\r\n\r\n> The issue seems to be with the size of the binary (size of the contract). I tried removing part by part, after removing half of the code, it deployed successfully. Now the question is how can we deploy the whole contract.\r\n\r\n> I haven’t set any size limit in genesis file. And I think there’s a 24576 byte limit for contract size. I tried increasing this, but still it failed. The size of the token contract is less than the 24576 (build/contracts/ERC1400HoldableToken.json: 21204.5). Is it the encoding which is increasing the size?",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/756415721/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/760733891",
    "html_url": "https://github.com/hyperledger/besu/issues/1760#issuecomment-760733891",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1760",
    "id": 760733891,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MDczMzg5MQ==",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-15T08:11:21Z",
    "updated_at": "2021-01-15T08:11:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "This is the contract in question:\r\nhttps://github.com/ConsenSys/UniversalToken/blob/master/contracts/tokens/ERC1400HoldableToken.sol",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/760733891/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/762445605",
    "html_url": "https://github.com/hyperledger/besu/issues/1760#issuecomment-762445605",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1760",
    "id": 762445605,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MjQ0NTYwNQ==",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-18T19:58:46Z",
    "updated_at": "2021-01-18T20:17:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "To deploy as a public contract, they used truffle.\nhttps://github.com/ConsenSys/UniversalToken/blob/master/migrations/5_erc1400_holdable.js\n\nLooking at the truffle deployment, there is a lot of other supporting contracts that get deployed. If I delete all the other migration scripts and just run migrations/5_erc1400_holdable.js I hit a revert\n```\n5_erc1400_holdable.js\n=====================\n   Replacing 'ERC1400HoldableToken'\n   --------------------------------\n   > transaction hash:    0xd8bd320b9ae5c21b80890523d792d58a3676890087bc68f0a6da831a19040bec\n   > ERC1400HoldableToken token deployment without extension: Success --> 0xf204a4Ef082f5c04bB89F7D5E6568B796096735a\nError:  *** Deployment Failed ***\n\"ERC1400HoldableToken\" hit a require or revert statement somewhere in its constructor. Try:\n   * Verifying that your constructor params satisfy all require conditions.\n   * Adding reason strings to your require statements.\n\n```\nAnd if I add back in migrations/2_erc1820_registry.js it does not hit the revert.\nHence this means you need to deploy the registry contract for the token to work.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/762445605/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/764117780",
    "html_url": "https://github.com/hyperledger/besu/issues/1760#issuecomment-764117780",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1760",
    "id": 764117780,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2NDExNzc4MA==",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-21T00:53:40Z",
    "updated_at": "2021-02-01T21:00:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "There are a few different environments involved here\n* AWS environment - truffle based public deployment works fine\n* Kanthesha's quorum-dev-quickstart - contract size limit issue is a factor - with the default setup\n* Sally's besu-local-nodes - truffle based public deployment (ERC1400HoldableToken, ERC1400TokensValidator), and script-based private deployment (ERC1400TokensValidator) work - so size limit is not a problem there",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/764117780/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/765061065",
    "html_url": "https://github.com/hyperledger/besu/issues/1760#issuecomment-765061065",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1760",
    "id": 765061065,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2NTA2MTA2NQ==",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-22T01:57:50Z",
    "updated_at": "2021-01-22T01:57:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "The steps required to deploy the ERC1400HoldableToken are described in a private repo.\nKanthesha is working on getting his local environment setup so that he can test out the deployment locally.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/765061065/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/771154525",
    "html_url": "https://github.com/hyperledger/besu/issues/1760#issuecomment-771154525",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1760",
    "id": 771154525,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MTE1NDUyNQ==",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-01T21:00:30Z",
    "updated_at": "2021-02-01T21:00:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "@sally.macfarlane Sorry! I thought I already updated you. With this https://github.com/lucassaldanha/besu-local-nodes setup. It is working fine. thanks\n",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/771154525/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
