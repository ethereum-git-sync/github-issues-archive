{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/799",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/799/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/799/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/799/events",
  "html_url": "https://github.com/hyperledger/besu/issues/799",
  "id": 607857841,
  "node_id": "MDU6SXNzdWU2MDc4NTc4NDE=",
  "number": 799,
  "title": "GraphQL problems",
  "user": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "shemnon",
    "id": 38109,
    "node_id": "MDQ6VXNlcjM4MTA5",
    "avatar_url": "https://avatars.githubusercontent.com/u/38109?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/shemnon",
    "html_url": "https://github.com/shemnon",
    "followers_url": "https://api.github.com/users/shemnon/followers",
    "following_url": "https://api.github.com/users/shemnon/following{/other_user}",
    "gists_url": "https://api.github.com/users/shemnon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/shemnon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/shemnon/subscriptions",
    "organizations_url": "https://api.github.com/users/shemnon/orgs",
    "repos_url": "https://api.github.com/users/shemnon/repos",
    "events_url": "https://api.github.com/users/shemnon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/shemnon/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "shemnon",
      "id": 38109,
      "node_id": "MDQ6VXNlcjM4MTA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/38109?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shemnon",
      "html_url": "https://github.com/shemnon",
      "followers_url": "https://api.github.com/users/shemnon/followers",
      "following_url": "https://api.github.com/users/shemnon/following{/other_user}",
      "gists_url": "https://api.github.com/users/shemnon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shemnon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shemnon/subscriptions",
      "organizations_url": "https://api.github.com/users/shemnon/orgs",
      "repos_url": "https://api.github.com/users/shemnon/repos",
      "events_url": "https://api.github.com/users/shemnon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shemnon/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2020-04-27T21:14:25Z",
  "updated_at": "2020-05-11T17:39:02Z",
  "closed_at": "2020-05-11T17:39:02Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "See https://hivetests.ethdevops.io/?suite=1587575032-6a6d0e841290bc4726bb016a9a9ba43f.json\r\n\r\nFor example, `invalidAccount` (click to expand it): \r\n\r\n\r\nTest failed. Query:\r\n```\r\nquery invalidAccount {\r\n  block {\r\n    account(address: \"0xdeadbeef\") {\r\n      balance\r\n    }\r\n  }\r\n}\r\n\r\nexpected:\r\n\r\n{\r\n  \"errors\": [\r\n    {\r\n      \"message\": \"Invalid account address: \\\"0xdeadbeef\\\"\",\r\n      \"locations\": [\r\n        {\r\n          \"line\": 1,\r\n          \"column\": 2\r\n        }\r\n      ],\r\n      \"path\": [\"account\"],\r\n      \"extensions\": {\r\n        \"classification\": \"DataFetchingException\"\r\n      }\r\n    }\r\n  ],\r\n  \"data\": null\r\n}\r\n\r\ngot:\r\n\r\n{\r\n  \"errors\" : [ {\r\n    \"message\" : \"Validation error of type WrongType: argument 'address' with value 'StringValue{value='0xdeadbeef'}' is not a valid 'Address' @ 'block/account'\",\r\n    \"locations\" : [ {\r\n      \"line\" : 3,\r\n      \"column\" : 13\r\n    } ],\r\n    \"extensions\" : {\r\n      \"classification\" : \"ValidationError\"\r\n    }\r\n  } ]\r\n}\r\n```\r\n. HTTP response status: 400 Bad Request\r\n\r\nSo I'm curious, are the graphql tests that I use outdated? How come you don't get these errors yourselves when running your own testcases? Am I doing something wrong? ",
  "closed_by": {
    "login": "timbeiko",
    "id": 9390255,
    "node_id": "MDQ6VXNlcjkzOTAyNTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9390255?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/timbeiko",
    "html_url": "https://github.com/timbeiko",
    "followers_url": "https://api.github.com/users/timbeiko/followers",
    "following_url": "https://api.github.com/users/timbeiko/following{/other_user}",
    "gists_url": "https://api.github.com/users/timbeiko/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/timbeiko/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/timbeiko/subscriptions",
    "organizations_url": "https://api.github.com/users/timbeiko/orgs",
    "repos_url": "https://api.github.com/users/timbeiko/repos",
    "events_url": "https://api.github.com/users/timbeiko/events{/privacy}",
    "received_events_url": "https://api.github.com/users/timbeiko/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/799/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/799/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/620661927",
    "html_url": "https://github.com/hyperledger/besu/issues/799#issuecomment-620661927",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/799",
    "id": 620661927,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMDY2MTkyNw==",
    "user": {
      "login": "shemnon",
      "id": 38109,
      "node_id": "MDQ6VXNlcjM4MTA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/38109?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shemnon",
      "html_url": "https://github.com/shemnon",
      "followers_url": "https://api.github.com/users/shemnon/followers",
      "following_url": "https://api.github.com/users/shemnon/following{/other_user}",
      "gists_url": "https://api.github.com/users/shemnon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shemnon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shemnon/subscriptions",
      "organizations_url": "https://api.github.com/users/shemnon/orgs",
      "repos_url": "https://api.github.com/users/shemnon/repos",
      "events_url": "https://api.github.com/users/shemnon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shemnon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-28T15:00:50Z",
    "updated_at": "2020-04-28T15:00:50Z",
    "author_association": "MEMBER",
    "body": "Where did you get these tests?  \r\n\r\n(a) not all of them are from besu.  Per the test description \"initially from Besu\". The one you quoted is not in our test set\r\n(b) some of the ones from our test set was changed.  `blocks_byWrongRange` for example was formatted across multiple lines and wrapped in a query block.  \r\n(c) The EIP for GraphQL does not specify a format for errors, so doing a deep comparison across clients gives bad signal.  For error cases we should be checking for the presence of an error.  These test cases were only written with the intent of validating besu.\r\n\r\nThe other non-error calls have some variability in what an answer can be (gas price is an estimate, pending depends on what TXes have been seen, etc.), so a straight json comparison on those also may not be the best conformance test.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/620661927/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/620720207",
    "html_url": "https://github.com/hyperledger/besu/issues/799#issuecomment-620720207",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/799",
    "id": 620720207,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMDcyMDIwNw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-28T16:36:26Z",
    "updated_at": "2020-04-28T16:36:26Z",
    "author_association": "NONE",
    "body": "Well, I think they're all from Besu, but I'm not sure. Frank pulled them from Besu, but afaik the graphql hive tests never actually worked until now. \r\n\r\nI'll update them so they match what you have now, for starters. Better than nothing.\r\nRe C), I'm aware of that, so I'll implement something less strict than what it does now (https://github.com/ethereum/hive/blob/master/simulators/ethereum/graphql/graphql.go#L172 ) -- comparing the json structs. \r\n\r\nIt otherwise shouldn't fluctuate, all nodes are fed the same 10 bllocks, so they've all \"seen\" the same things. ",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/620720207/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/621139452",
    "html_url": "https://github.com/hyperledger/besu/issues/799#issuecomment-621139452",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/799",
    "id": 621139452,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMTEzOTQ1Mg==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-29T11:21:46Z",
    "updated_at": "2020-04-29T11:21:46Z",
    "author_association": "NONE",
    "body": "Updated to the latest: https://hivetests.ethdevops.io/?suite=1588157943-bc222871de0abaa627e9ad880e66837c.json  . Now only 7 failures out of 49 cases",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/621139452/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/621143314",
    "html_url": "https://github.com/hyperledger/besu/issues/799#issuecomment-621143314",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/799",
    "id": 621143314,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMTE0MzMxNA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-29T11:29:33Z",
    "updated_at": "2020-04-29T11:30:03Z",
    "author_association": "NONE",
    "body": "Here's a typical failure on geth: \r\n```\r\n{block(number :\"0x8\") {number call (data : {from : \"a94f5374fce5edbc8e2a8697c15331677e6ebf0b\", to: \"0x6295ee1b4f6dd65047762f924ecd367c17eabf8f\", data :\"0x12a7b914\"}){data status}}}\r\n\r\nExpected:\r\n\r\n{\r\n  \"data\": {\r\n    \"block\": {\r\n      \"call\": {\r\n        \"data\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n        \"status\": 1\r\n      },\r\n      \"number\": 8\r\n    }\r\n  }\r\n}\r\n\r\nGot:\r\n\r\n{\"errors\":[{\"message\":\"hex string without 0x prefix\"}],\"data\":{\"block\":{\"number\":\"0x8\"}}}\r\n\r\nHTTP response status: 200 OK\r\n```\r\nIn essence, geth doesn't like hex-strings that are not prefixed (`a94f5374fce5edbc8e2a8697c15331677e6ebf0b`) . And I think that's a sane approach, unless the client can be 100% certain that it's indeed hex-data. If the client 'sniffs' the data-type, we wind up with quirky behaviour on e.g. `1000` -- is it `1000` or is it `0x1000` ? \r\n\r\nSo.. .is there any spec for these inputs? Should geh be changed? Should I change the test to supply `0x` ? Thoughts? \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/621143314/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/621243629",
    "html_url": "https://github.com/hyperledger/besu/issues/799#issuecomment-621243629",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/799",
    "id": 621243629,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMTI0MzYyOQ==",
    "user": {
      "login": "shemnon",
      "id": 38109,
      "node_id": "MDQ6VXNlcjM4MTA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/38109?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shemnon",
      "html_url": "https://github.com/shemnon",
      "followers_url": "https://api.github.com/users/shemnon/followers",
      "following_url": "https://api.github.com/users/shemnon/following{/other_user}",
      "gists_url": "https://api.github.com/users/shemnon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shemnon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shemnon/subscriptions",
      "organizations_url": "https://api.github.com/users/shemnon/orgs",
      "repos_url": "https://api.github.com/users/shemnon/repos",
      "events_url": "https://api.github.com/users/shemnon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shemnon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-29T14:22:27Z",
    "updated_at": "2020-04-29T14:22:27Z",
    "author_association": "MEMBER",
    "body": "The header of the GraphQL EIP requires `0x` prefixes for Bytes32 data types. - https://github.com/ethereum/EIPs/blob/master/EIPS/eip-1767.md#schema - so I think we should have tests where the 0x is not provided and it is a required failure.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/621243629/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/621276905",
    "html_url": "https://github.com/hyperledger/besu/issues/799#issuecomment-621276905",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/799",
    "id": 621276905,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMTI3NjkwNQ==",
    "user": {
      "login": "shemnon",
      "id": 38109,
      "node_id": "MDQ6VXNlcjM4MTA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/38109?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shemnon",
      "html_url": "https://github.com/shemnon",
      "followers_url": "https://api.github.com/users/shemnon/followers",
      "following_url": "https://api.github.com/users/shemnon/following{/other_user}",
      "gists_url": "https://api.github.com/users/shemnon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shemnon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shemnon/subscriptions",
      "organizations_url": "https://api.github.com/users/shemnon/orgs",
      "repos_url": "https://api.github.com/users/shemnon/repos",
      "events_url": "https://api.github.com/users/shemnon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shemnon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-29T15:13:43Z",
    "updated_at": "2020-04-29T15:13:43Z",
    "author_association": "MEMBER",
    "body": "Opened #811 to cover the Besu failures for 0x prefixed graphql calls.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/621276905/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
