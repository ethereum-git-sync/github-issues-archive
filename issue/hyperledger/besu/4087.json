{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/4087",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/4087/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/4087/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/4087/events",
  "html_url": "https://github.com/hyperledger/besu/issues/4087",
  "id": 1302716253,
  "node_id": "I_kwDODE2jmc5Npd9d",
  "number": 4087,
  "title": "[SPIKE] Design for how to add discv5 support 3",
  "user": {
    "login": "macfarla",
    "id": 2627919,
    "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/macfarla",
    "html_url": "https://github.com/macfarla",
    "followers_url": "https://api.github.com/users/macfarla/followers",
    "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
    "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
    "organizations_url": "https://api.github.com/users/macfarla/orgs",
    "repos_url": "https://api.github.com/users/macfarla/repos",
    "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
    "received_events_url": "https://api.github.com/users/macfarla/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2152224197,
      "node_id": "MDU6TGFiZWwyMTUyMjI0MTk3",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/TeamRevenant",
      "name": "TeamRevenant",
      "color": "78e298",
      "default": false,
      "description": "GH issues worked on by Revenant Team"
    },
    {
      "id": 3013559202,
      "node_id": "MDU6TGFiZWwzMDEzNTU5MjAy",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/mainnet",
      "name": "mainnet",
      "color": "9D578C",
      "default": false,
      "description": ""
    },
    {
      "id": 3805591260,
      "node_id": "LA_kwDODE2jmc7i1Lbc",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/peering",
      "name": "peering",
      "color": "006b75",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-07-12T23:21:05Z",
  "updated_at": "2022-07-19T16:21:59Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "- [ ] investigate how to utilise the discv5 library https://github.com/consensys/discovery\n- [ ] look at Teku code - https://github.com/ConsenSys/teku/blob/ce6e13e32f2c5029aa05895f400c00a9c72a3f38/networking/p2p/src/main/java/tech/pegasys/teku/networking/p2p/discovery/discv5/DiscV5Service.java\n- [ ] Come up with a plan for how to add support for discovery v5 - how to handle v5 incoming packets\n- [ ] Share plan with other besu dev teams and get feedback\n\n### Note\nPer Meredith, '... was chatting with Adrian Sutton and he mentioned that the teku discv5 implementation actually holds onto [all live nodes in memory ](https://github.com/ConsenSys/discovery/blob/1ffc42f4a295f00007ec17e4db7707a29aa269bb/src/main/java/org/ethereum/beacon/discovery/pipeline/handler/NodeSessionManager.java#L46-L47)instead of just relying on the buckets data structure used within the discovery protocol.  When peers are streamed from the discovery service, the [bucket structure is searched as well as the list of active sessions](https://github.com/ConsenSys/discovery/blob/c4d6d62926211319aef543c26f0c819a6c44f133/src/main/java/org/ethereum/beacon/discovery/DiscoverySystem.java#L109-L112).'\n\nTimebox - 3 days",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/4087/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/4087/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1188494466",
    "html_url": "https://github.com/hyperledger/besu/issues/4087#issuecomment-1188494466",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4087",
    "id": 1188494466,
    "node_id": "IC_kwDODE2jmc5G1vyC",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-19T01:25:39Z",
    "updated_at": "2022-07-19T01:25:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "there is a spec\r\ndiscv5.1\r\nusing the consensys/discovery library which would be v5.1 https://github.com/ConsenSys/discovery/pull/72",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1188494466/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1189295651",
    "html_url": "https://github.com/hyperledger/besu/issues/4087#issuecomment-1189295651",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4087",
    "id": 1189295651,
    "node_id": "IC_kwDODE2jmc5G4zYj",
    "user": {
      "login": "non-fungible-nelson",
      "id": 85905982,
      "node_id": "MDQ6VXNlcjg1OTA1OTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/85905982?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/non-fungible-nelson",
      "html_url": "https://github.com/non-fungible-nelson",
      "followers_url": "https://api.github.com/users/non-fungible-nelson/followers",
      "following_url": "https://api.github.com/users/non-fungible-nelson/following{/other_user}",
      "gists_url": "https://api.github.com/users/non-fungible-nelson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/non-fungible-nelson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/non-fungible-nelson/subscriptions",
      "organizations_url": "https://api.github.com/users/non-fungible-nelson/orgs",
      "repos_url": "https://api.github.com/users/non-fungible-nelson/repos",
      "events_url": "https://api.github.com/users/non-fungible-nelson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/non-fungible-nelson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-19T16:21:44Z",
    "updated_at": "2022-07-19T16:21:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "Spoke with the other client teams. It looks like in Geth it is optional for users at this time (the client can run v4 and v5 simultaneously). We are going to have a discussion with them post-Merge to determine when/how we should move all Els to v5. And I would definitely recommend consolidating around the Teku library if it makes sense. \r\n\r\nDiscord context [here](https://discord.com/channels/595666850260713488/688075293562503241/998635805847322774) on Eth R&D.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1189295651/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
