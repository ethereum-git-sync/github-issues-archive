{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/1992",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/1992/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/1992/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/1992/events",
  "html_url": "https://github.com/hyperledger/besu/issues/1992",
  "id": 825496591,
  "node_id": "MDU6SXNzdWU4MjU0OTY1OTE=",
  "number": 1992,
  "title": "Chain import exits if import contains bad blocks",
  "user": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2021-03-09T08:10:32Z",
  "updated_at": "2021-03-15T16:15:53Z",
  "closed_at": "2021-03-15T16:15:53Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "This ticket is a replica of https://github.com/ethereum/hive/issues/454 . \r\n\r\nIt appears that when we try to import a block rlp, the besu client hard-exits. See https://hivetests.ethdevops.io/viewer.html?file=results/besu/client-1ee56fdf80c8c214c71beb592811724e358e72af5aa0e7d069fb54273a4da824.log#L38 . It would be better if the block is simply rejected, and the client moves on and tries to import the next block in the rlp input. Then the tests would pass.\r\n\r\nAlternatively, we can feed the blocks one by one, but that makes everything a lot slower, since we'd have to start a new java runtime for each block to import.\r\n\r\n",
  "closed_by": {
    "login": "holiman",
    "id": 142290,
    "node_id": "MDQ6VXNlcjE0MjI5MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/holiman",
    "html_url": "https://github.com/holiman",
    "followers_url": "https://api.github.com/users/holiman/followers",
    "following_url": "https://api.github.com/users/holiman/following{/other_user}",
    "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
    "organizations_url": "https://api.github.com/users/holiman/orgs",
    "repos_url": "https://api.github.com/users/holiman/repos",
    "events_url": "https://api.github.com/users/holiman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/holiman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/1992/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/1992/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/796524960",
    "html_url": "https://github.com/hyperledger/besu/issues/1992#issuecomment-796524960",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1992",
    "id": 796524960,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5NjUyNDk2MA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-11T07:24:07Z",
    "updated_at": "2021-03-11T07:24:07Z",
    "author_association": "NONE",
    "body": "To elaborate a bit, because the description above was not entirely correct. \r\n\r\n- Other nodes (geth, OE), has import as a separate step. So we first do an import command (as many as needed), and we ignore any failures from that step. Once all the blocks have been imported, we re-enalbe the error check (`set -e`) and start the node \"properly\". \r\n- Besu works differently: import imports blocks, then starts the node. However, if the importing fails, then the node does not start.\r\n\r\nI can try to work around this via bash, but I'm not quite sure how yet. ",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/796524960/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/796526876",
    "html_url": "https://github.com/hyperledger/besu/issues/1992#issuecomment-796526876",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1992",
    "id": 796526876,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5NjUyNjg3Ng==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-11T07:27:30Z",
    "updated_at": "2021-03-11T07:27:30Z",
    "author_association": "NONE",
    "body": "I guess one thing we can do is _not_ do `--run`, which is the command which starts the client after import. However, removing that means that we'll start the JRE twice per test, further increasing the runtime (which is already around a day)",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/796526876/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/796528168",
    "html_url": "https://github.com/hyperledger/besu/issues/1992#issuecomment-796528168",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1992",
    "id": 796528168,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5NjUyODE2OA==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-11T07:29:55Z",
    "updated_at": "2021-03-11T07:29:55Z",
    "author_association": "NONE",
    "body": "Oh, we can do a work-around: https://github.com/hyperledger/besu/blob/master/besu/src/main/java/org/hyperledger/besu/cli/subcommands/blocks/BlocksSubCommand.java#L218 -- we can specify some dummy file as a second command, so there is always more than one file to import. It will cause the import to log an error but otherwise continue. Ugly but should work. ",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/796528168/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/796534623",
    "html_url": "https://github.com/hyperledger/besu/issues/1992#issuecomment-796534623",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1992",
    "id": 796534623,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5NjUzNDYyMw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-11T07:41:10Z",
    "updated_at": "2021-03-11T07:41:10Z",
    "author_association": "NONE",
    "body": "You might not have to do anything. I'll close this if the work-around works out",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/796534623/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/799548257",
    "html_url": "https://github.com/hyperledger/besu/issues/1992#issuecomment-799548257",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1992",
    "id": 799548257,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5OTU0ODI1Nw==",
    "user": {
      "login": "holiman",
      "id": 142290,
      "node_id": "MDQ6VXNlcjE0MjI5MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/142290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/holiman",
      "html_url": "https://github.com/holiman",
      "followers_url": "https://api.github.com/users/holiman/followers",
      "following_url": "https://api.github.com/users/holiman/following{/other_user}",
      "gists_url": "https://api.github.com/users/holiman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/holiman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/holiman/subscriptions",
      "organizations_url": "https://api.github.com/users/holiman/orgs",
      "repos_url": "https://api.github.com/users/holiman/repos",
      "events_url": "https://api.github.com/users/holiman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/holiman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-15T16:15:53Z",
    "updated_at": "2021-03-15T16:15:53Z",
    "author_association": "NONE",
    "body": "Fixed!",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/799548257/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
