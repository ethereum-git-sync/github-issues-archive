{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/4292",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/4292/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/4292/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/4292/events",
  "html_url": "https://github.com/hyperledger/besu/issues/4292",
  "id": 1346944176,
  "node_id": "I_kwDODE2jmc5QSLyw",
  "number": 4292,
  "title": "Read file permission denied when starting besu from docker image",
  "user": {
    "login": "br-kwon",
    "id": 13758635,
    "node_id": "MDQ6VXNlcjEzNzU4NjM1",
    "avatar_url": "https://avatars.githubusercontent.com/u/13758635?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/br-kwon",
    "html_url": "https://github.com/br-kwon",
    "followers_url": "https://api.github.com/users/br-kwon/followers",
    "following_url": "https://api.github.com/users/br-kwon/following{/other_user}",
    "gists_url": "https://api.github.com/users/br-kwon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/br-kwon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/br-kwon/subscriptions",
    "organizations_url": "https://api.github.com/users/br-kwon/orgs",
    "repos_url": "https://api.github.com/users/br-kwon/repos",
    "events_url": "https://api.github.com/users/br-kwon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/br-kwon/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1537362490,
      "node_id": "MDU6TGFiZWwxNTM3MzYyNDkw",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    },
    {
      "id": 1537362500,
      "node_id": "MDU6TGFiZWwxNTM3MzYyNTAw",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/good%20first%20issue",
      "name": "good first issue",
      "color": "7057ff",
      "default": true,
      "description": "Good for newcomers"
    },
    {
      "id": 2129007612,
      "node_id": "MDU6TGFiZWwyMTI5MDA3NjEy",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/dev%20experience",
      "name": "dev experience",
      "color": "2a0b89",
      "default": false,
      "description": "The build system, things that enable easier development etc."
    },
    {
      "id": 4426494776,
      "node_id": "LA_kwDODE2jmc8AAAABB9bzOA",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/snack",
      "name": "snack",
      "color": "fef2c0",
      "default": false,
      "description": "Small coding task"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2022-08-22T20:27:06Z",
  "updated_at": "2023-04-11T01:46:54Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!-- Have you done the following? -->\r\n<!--   * read the Code of Conduct? By filing an Issue, you are expected to -->  \r\n<!--     comply with it, including treating everyone with respect: -->\r\n<!--     https://github.com/hyperledger/besu/blob/main/CODE_OF_CONDUCT.md -->\r\n<!--   * Reproduced the issue in the latest version of the software -->\r\n<!--   * Read the debugging docs: https://besu.hyperledger.org/en/stable/HowTo/Monitor/Logging/ -->\r\n<!--   * Duplicate Issue check:  https://github.com/search?q=+is%3Aissue+repo%3Ahyperledger/Besu -->\r\n<!-- Note:  Not all sections will apply to all issue types. -->\r\n\r\n### Description\r\n\r\nHello, I'm looking for help with running besu from docker image. The problem I am running into is mounting a named volume (which i named \"besu\") to a path i specified with `--data-path`. The container errors out saying:\r\n\r\n```\r\nFailed to retrieve the RocksDB database meta version: /var/lib/besu/DATABASE_METADATA.json (Permission denied) could not be found. You may not have the appropriate permission to access the item.\r\n```\r\n\r\nI suspect that since user is changed from [root to \"besu\"](https://github.com/hyperledger/besu/blob/332ca416ba6c995605cad3b25b3fc1441879407c/docker/graalvm/Dockerfile#L8), the user \"besu\" does not have permissions to write in the `--data-path` dir that i specified.\r\n\r\ni can work around this by setting the docker run config `--user=0` to switch back to root, but this obviously doesn't seem like the most optimal solution.\r\n\r\n### Acceptance Criteria\r\n* I can mount a volume to the besu `--data-path` config without overriding the user in the container\r\nor\r\n* volume mount is automatically done by the container\r\n\r\n### Steps to Reproduce (Bug)\r\n1. Create a named volume called \"besu\": `docker volume create besu`\r\n2. run `docker run --name besu  -v besu:/var/lib/besu hyperledger/besu:latest --data-path=/var/lib/besu`\r\n\r\n**Expected behavior:** \r\n\r\nexpected to run besu without error (i.e. container user has permissions to read/write to specified volume)\r\n\r\n**Actual behavior:**\r\n\r\ncontainer errors out with message seen in the Description\r\n**Frequency:** [What percentage of the time does it occur?]\r\n100%\r\n\r\n### Versions (Add all that apply)\r\n* Software version: hyperledger/besu:latest (docker image)\r\n* OS Name & Version: Ubuntu 22.04.1 LTS\r\n* Kernel Version: 5.15.0-46-generic\r\n* Docker Version: 20.10.17\r\n\r\nEdit: Updated issue description with given layout (sorry didn't see when clicking \"Reference in new issue\" from code line!)\r\n\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/4292/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/4292/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1222968326",
    "html_url": "https://github.com/hyperledger/besu/issues/4292#issuecomment-1222968326",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4292",
    "id": 1222968326,
    "node_id": "IC_kwDODE2jmc5I5QQG",
    "user": {
      "login": "br-kwon",
      "id": 13758635,
      "node_id": "MDQ6VXNlcjEzNzU4NjM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/13758635?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/br-kwon",
      "html_url": "https://github.com/br-kwon",
      "followers_url": "https://api.github.com/users/br-kwon/followers",
      "following_url": "https://api.github.com/users/br-kwon/following{/other_user}",
      "gists_url": "https://api.github.com/users/br-kwon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/br-kwon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/br-kwon/subscriptions",
      "organizations_url": "https://api.github.com/users/br-kwon/orgs",
      "repos_url": "https://api.github.com/users/br-kwon/repos",
      "events_url": "https://api.github.com/users/br-kwon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/br-kwon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-22T20:34:55Z",
    "updated_at": "2022-08-22T20:34:55Z",
    "author_association": "NONE",
    "body": "some ideas:\r\n- somehow read runtime configurations for `--data-path` in the Dockerfile and allow read/write access for user \"besu\"\r\n- refactor so container creates the volume (users wouldn't have to mount volumes or binds themselves)",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1222968326/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1404954820",
    "html_url": "https://github.com/hyperledger/besu/issues/4292#issuecomment-1404954820",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4292",
    "id": 1404954820,
    "node_id": "IC_kwDODE2jmc5TvejE",
    "user": {
      "login": "non-fungible-nelson",
      "id": 85905982,
      "node_id": "MDQ6VXNlcjg1OTA1OTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/85905982?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/non-fungible-nelson",
      "html_url": "https://github.com/non-fungible-nelson",
      "followers_url": "https://api.github.com/users/non-fungible-nelson/followers",
      "following_url": "https://api.github.com/users/non-fungible-nelson/following{/other_user}",
      "gists_url": "https://api.github.com/users/non-fungible-nelson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/non-fungible-nelson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/non-fungible-nelson/subscriptions",
      "organizations_url": "https://api.github.com/users/non-fungible-nelson/orgs",
      "repos_url": "https://api.github.com/users/non-fungible-nelson/repos",
      "events_url": "https://api.github.com/users/non-fungible-nelson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/non-fungible-nelson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-26T12:44:11Z",
    "updated_at": "2023-01-26T12:44:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi there are you still experiencing this issue? we have made many changes to rocksDB recently. I might tag this as a good first issue to fix, since it is mostly rocksDB config. ",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1404954820/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1404954989",
    "html_url": "https://github.com/hyperledger/besu/issues/4292#issuecomment-1404954989",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4292",
    "id": 1404954989,
    "node_id": "IC_kwDODE2jmc5Tvelt",
    "user": {
      "login": "non-fungible-nelson",
      "id": 85905982,
      "node_id": "MDQ6VXNlcjg1OTA1OTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/85905982?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/non-fungible-nelson",
      "html_url": "https://github.com/non-fungible-nelson",
      "followers_url": "https://api.github.com/users/non-fungible-nelson/followers",
      "following_url": "https://api.github.com/users/non-fungible-nelson/following{/other_user}",
      "gists_url": "https://api.github.com/users/non-fungible-nelson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/non-fungible-nelson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/non-fungible-nelson/subscriptions",
      "organizations_url": "https://api.github.com/users/non-fungible-nelson/orgs",
      "repos_url": "https://api.github.com/users/non-fungible-nelson/repos",
      "events_url": "https://api.github.com/users/non-fungible-nelson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/non-fungible-nelson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-26T12:44:17Z",
    "updated_at": "2023-01-26T12:44:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "@br-kwon ",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1404954989/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1449424971",
    "html_url": "https://github.com/hyperledger/besu/issues/4292#issuecomment-1449424971",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4292",
    "id": 1449424971,
    "node_id": "IC_kwDODE2jmc5WZHhL",
    "user": {
      "login": "ananthanir",
      "id": 25743008,
      "node_id": "MDQ6VXNlcjI1NzQzMDA4",
      "avatar_url": "https://avatars.githubusercontent.com/u/25743008?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ananthanir",
      "html_url": "https://github.com/ananthanir",
      "followers_url": "https://api.github.com/users/ananthanir/followers",
      "following_url": "https://api.github.com/users/ananthanir/following{/other_user}",
      "gists_url": "https://api.github.com/users/ananthanir/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ananthanir/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ananthanir/subscriptions",
      "organizations_url": "https://api.github.com/users/ananthanir/orgs",
      "repos_url": "https://api.github.com/users/ananthanir/repos",
      "events_url": "https://api.github.com/users/ananthanir/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ananthanir/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-01T06:26:55Z",
    "updated_at": "2023-03-01T06:29:05Z",
    "author_association": "NONE",
    "body": "Is there any solution, I am facing this issues.\r\n\r\nThe issue only there if I use volume.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1449424971/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1457936801",
    "html_url": "https://github.com/hyperledger/besu/issues/4292#issuecomment-1457936801",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4292",
    "id": 1457936801,
    "node_id": "IC_kwDODE2jmc5W5lmh",
    "user": {
      "login": "MatrixYe",
      "id": 104983441,
      "node_id": "U_kgDOBkHrkQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/104983441?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MatrixYe",
      "html_url": "https://github.com/MatrixYe",
      "followers_url": "https://api.github.com/users/MatrixYe/followers",
      "following_url": "https://api.github.com/users/MatrixYe/following{/other_user}",
      "gists_url": "https://api.github.com/users/MatrixYe/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MatrixYe/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MatrixYe/subscriptions",
      "organizations_url": "https://api.github.com/users/MatrixYe/orgs",
      "repos_url": "https://api.github.com/users/MatrixYe/repos",
      "events_url": "https://api.github.com/users/MatrixYe/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MatrixYe/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-07T10:36:43Z",
    "updated_at": "2023-03-07T10:36:43Z",
    "author_association": "NONE",
    "body": "> Is there any solution, I am facing this issues.\r\n> \r\n> The issue only there if I use volume.\r\n\r\ni meet a same problem, and fix it .you need edit `data-path` config , and set volume mapping.example: `docker run -itd --name besu --network ethereum -p 30303:30303/tcp -p 30303:30303/udp -p 8545:8545 -p 8551:8551 -e JAVA_OPTS=-Xmx8g -v $HOME/data1/xypTest:/opt/data   -v $HOME/data1/JWT:/JWT hyperledger/besu:latest --network=mainnet --sync-mode=X_SNAP  --data-storage-format=BONSAI --rpc-http-enabled --rpc-http-host=0.0.0.0 --rpc-http-api=ETH,NET,WEB3 --rpc-http-cors-origins=* --host-allowlist=* --engine-host-allowlist=* --engine-jwt-secret=/JWT/jwtsecret --engine-rpc-port=8551 --data-path=/opt/data`",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1457936801/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1458735161",
    "html_url": "https://github.com/hyperledger/besu/issues/4292#issuecomment-1458735161",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4292",
    "id": 1458735161,
    "node_id": "IC_kwDODE2jmc5W8og5",
    "user": {
      "login": "jgresham",
      "id": 3721291,
      "node_id": "MDQ6VXNlcjM3MjEyOTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3721291?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jgresham",
      "html_url": "https://github.com/jgresham",
      "followers_url": "https://api.github.com/users/jgresham/followers",
      "following_url": "https://api.github.com/users/jgresham/following{/other_user}",
      "gists_url": "https://api.github.com/users/jgresham/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jgresham/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jgresham/subscriptions",
      "organizations_url": "https://api.github.com/users/jgresham/orgs",
      "repos_url": "https://api.github.com/users/jgresham/repos",
      "events_url": "https://api.github.com/users/jgresham/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jgresham/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-07T19:45:45Z",
    "updated_at": "2023-03-07T19:45:45Z",
    "author_association": "NONE",
    "body": "+1 . I don't seem to be having this issue with other eth clients",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1458735161/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1458843534",
    "html_url": "https://github.com/hyperledger/besu/issues/4292#issuecomment-1458843534",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4292",
    "id": 1458843534,
    "node_id": "IC_kwDODE2jmc5W9C-O",
    "user": {
      "login": "non-fungible-nelson",
      "id": 85905982,
      "node_id": "MDQ6VXNlcjg1OTA1OTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/85905982?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/non-fungible-nelson",
      "html_url": "https://github.com/non-fungible-nelson",
      "followers_url": "https://api.github.com/users/non-fungible-nelson/followers",
      "following_url": "https://api.github.com/users/non-fungible-nelson/following{/other_user}",
      "gists_url": "https://api.github.com/users/non-fungible-nelson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/non-fungible-nelson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/non-fungible-nelson/subscriptions",
      "organizations_url": "https://api.github.com/users/non-fungible-nelson/orgs",
      "repos_url": "https://api.github.com/users/non-fungible-nelson/repos",
      "events_url": "https://api.github.com/users/non-fungible-nelson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/non-fungible-nelson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-07T20:40:14Z",
    "updated_at": "2023-03-07T20:40:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for these reports all, we are looking to reprioritize this. should be a small fix. ",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1458843534/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1502570352",
    "html_url": "https://github.com/hyperledger/besu/issues/4292#issuecomment-1502570352",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4292",
    "id": 1502570352,
    "node_id": "IC_kwDODE2jmc5Zj2dw",
    "user": {
      "login": "jgresham",
      "id": 3721291,
      "node_id": "MDQ6VXNlcjM3MjEyOTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3721291?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jgresham",
      "html_url": "https://github.com/jgresham",
      "followers_url": "https://api.github.com/users/jgresham/followers",
      "following_url": "https://api.github.com/users/jgresham/following{/other_user}",
      "gists_url": "https://api.github.com/users/jgresham/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jgresham/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jgresham/subscriptions",
      "organizations_url": "https://api.github.com/users/jgresham/orgs",
      "repos_url": "https://api.github.com/users/jgresham/repos",
      "events_url": "https://api.github.com/users/jgresham/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jgresham/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-11T01:46:54Z",
    "updated_at": "2023-04-11T01:46:54Z",
    "author_association": "NONE",
    "body": "Is there a work-around for this? Do we need to set the user to `besu`? ",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1502570352/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
