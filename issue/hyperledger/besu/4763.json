{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/4763",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/4763/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/4763/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/4763/events",
  "html_url": "https://github.com/hyperledger/besu/issues/4763",
  "id": 1472232782,
  "node_id": "I_kwDODE2jmc5XwH1O",
  "number": 4763,
  "title": "seg fault with 22.10.1",
  "user": {
    "login": "macfarla",
    "id": 2627919,
    "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/macfarla",
    "html_url": "https://github.com/macfarla",
    "followers_url": "https://api.github.com/users/macfarla/followers",
    "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
    "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
    "organizations_url": "https://api.github.com/users/macfarla/orgs",
    "repos_url": "https://api.github.com/users/macfarla/repos",
    "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
    "received_events_url": "https://api.github.com/users/macfarla/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-12-02T02:51:21Z",
  "updated_at": "2022-12-02T03:31:05Z",
  "closed_at": "2022-12-02T03:31:04Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Reported by a RocketPool user in discord\r\nupon upgrade to 22.10.1\r\nbesu fails to start\r\n\r\nhttps://discord.com/channels/697535391594446898/888098626264502302/1048036763718914088\r\n```\r\nCurrent thread (0x00007f4428234c00):  JavaThread \"ForkJoinPool.commonPool-worker-3\" daemon [_thread_in_native, id=201, stack(0x00007f440d076000,0x00007f440d177000)]\r\n\r\nStack: [0x00007f440d076000,0x00007f440d177000],  sp=0x00007f440d1728e0,  free space=1010k\r\nNative frames: (J=compiled Java code, j=interpreted, Vv=VM code, C=native code)\r\nC  [libc.so.6+0x22941]  abort+0x213\r\nC  [librocksdbjni10510826821327533153.so+0x2cc325]  txn_get_helper(JNIEnv_*, std::function<rocksdb::Status (rocksdb::ReadOptions const&, rocksdb::Slice const&, std::string*)> const&, long const&, _jbyteArray* const&, int const&)+0x85\r\nC  [librocksdbjni10510826821327533153.so+0x2cc4cf]  Java_org_rocksdb_Transaction_get__JJ_3BIJ+0x7f\r\nJ 6397  org.rocksdb.Transaction.get(JJ[BIJ)[B (0 bytes) @ 0x00007f4453898698 [0x00007f44538985c0+0x00000000000000d8]\r\nJ 6596 c1 org.rocksdb.Transaction.get(Lorg/rocksdb/ColumnFamilyHandle;Lorg/rocksdb/ReadOptions;[B)[B (41 bytes) @ 0x00007f444ca8f664 [0x00007f444ca8f5c0+0x00000000000000a4]\r\nJ 6621 c1 org.hyperledger.besu.plugin.services.storage.rocksdb.segmented.RocksDBSnapshotTransaction.get([B)Ljava/util/Optional; (79 bytes) @ 0x00007f444ca96cc4 [0x00007f444ca96b40+0x0000000000000184]\r\nJ 6595 c1 org.hyperledger.besu.plugin.services.storage.rocksdb.segmented.RocksDBColumnarKeyValueSnapshot.get([B)Ljava/util/Optional; (9 bytes) @ 0x00007f444ca8f24c [0x00007f444ca8f1c0+0x000000000000008c]\r\nJ 7097 c1 org.hyperledger.besu.ethereum.bonsai.BonsaiWorldStateKeyValueStorage.getAccountStateTrieNode(Lorg/apache/tuweni/bytes/Bytes;Lorg/apache/tuweni/bytes/Bytes32;)Ljava/util/Optional; (74 bytes) @ 0x00007f444cbd592c [0x00007f444cbd5560+0x00000000000003cc]\r\nJ 6659 c1 org.hyperledger.besu.ethereum.bonsai.CachedMerkleTrieLoader$$Lambda$1262+0x0000000801207a80.getNode(Lorg/apache/tuweni/bytes/Bytes;Lorg/apache/tuweni/bytes/Bytes32;)Ljava/util/Optional; (14 bytes) @ 0x00007f444caa7f14 [0x00007f444caa7dc0+0x0000000000000154]\r\n\r\n```",
  "closed_by": {
    "login": "macfarla",
    "id": 2627919,
    "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/macfarla",
    "html_url": "https://github.com/macfarla",
    "followers_url": "https://api.github.com/users/macfarla/followers",
    "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
    "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
    "organizations_url": "https://api.github.com/users/macfarla/orgs",
    "repos_url": "https://api.github.com/users/macfarla/repos",
    "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
    "received_events_url": "https://api.github.com/users/macfarla/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/4763/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/4763/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1334698906",
    "html_url": "https://github.com/hyperledger/besu/issues/4763#issuecomment-1334698906",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4763",
    "id": 1334698906,
    "node_id": "IC_kwDODE2jmc5PjeOa",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-02T02:55:07Z",
    "updated_at": "2022-12-02T02:55:07Z",
    "author_association": "CONTRIBUTOR",
    "body": " downgraded to 22.10.0 and back to normal\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1334698906/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1334700150",
    "html_url": "https://github.com/hyperledger/besu/issues/4763#issuecomment-1334700150",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4763",
    "id": 1334700150,
    "node_id": "IC_kwDODE2jmc5Pjeh2",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-02T02:57:54Z",
    "updated_at": "2022-12-02T02:57:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "from @garyschulte  - I believe rocketpool is enabling snapshots by default in their latest release. You have to tweak the startup script to disable, but I would try that if they are getting persistent segfaults",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1334700150/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1334718400",
    "html_url": "https://github.com/hyperledger/besu/issues/4763#issuecomment-1334718400",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4763",
    "id": 1334718400,
    "node_id": "IC_kwDODE2jmc5Pji_A",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-02T03:30:58Z",
    "updated_at": "2022-12-02T03:30:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "fixed by setting --Xbonsai-use-snapshots=false",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1334718400/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1334718464",
    "html_url": "https://github.com/hyperledger/besu/issues/4763#issuecomment-1334718464",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/4763",
    "id": 1334718464,
    "node_id": "IC_kwDODE2jmc5PjjAA",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-02T03:31:04Z",
    "updated_at": "2022-12-02T03:31:04Z",
    "author_association": "CONTRIBUTOR",
    "body": " RocketPool users - if you're seeing segfault errors like ^ above with Besu 22.10.1 - recommend setting --Xbonsai-use-snapshots=false in your config (it's set to true in latest RP)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1334718464/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
