{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/654",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/654/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/654/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/654/events",
  "html_url": "https://github.com/hyperledger/besu/issues/654",
  "id": 595024520,
  "node_id": "MDU6SXNzdWU1OTUwMjQ1MjA=",
  "number": 654,
  "title": "golang ethereum client: github.com/ethereum/go-ethereum cannot subscribe to log events via websocket",
  "user": {
    "login": "nikolas-digitalBabylon",
    "id": 12189842,
    "node_id": "MDQ6VXNlcjEyMTg5ODQy",
    "avatar_url": "https://avatars.githubusercontent.com/u/12189842?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nikolas-digitalBabylon",
    "html_url": "https://github.com/nikolas-digitalBabylon",
    "followers_url": "https://api.github.com/users/nikolas-digitalBabylon/followers",
    "following_url": "https://api.github.com/users/nikolas-digitalBabylon/following{/other_user}",
    "gists_url": "https://api.github.com/users/nikolas-digitalBabylon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nikolas-digitalBabylon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nikolas-digitalBabylon/subscriptions",
    "organizations_url": "https://api.github.com/users/nikolas-digitalBabylon/orgs",
    "repos_url": "https://api.github.com/users/nikolas-digitalBabylon/repos",
    "events_url": "https://api.github.com/users/nikolas-digitalBabylon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nikolas-digitalBabylon/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1537362490,
      "node_id": "MDU6TGFiZWwxNTM3MzYyNDkw",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "RatanRSur",
    "id": 4733314,
    "node_id": "MDQ6VXNlcjQ3MzMzMTQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4733314?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/RatanRSur",
    "html_url": "https://github.com/RatanRSur",
    "followers_url": "https://api.github.com/users/RatanRSur/followers",
    "following_url": "https://api.github.com/users/RatanRSur/following{/other_user}",
    "gists_url": "https://api.github.com/users/RatanRSur/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/RatanRSur/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/RatanRSur/subscriptions",
    "organizations_url": "https://api.github.com/users/RatanRSur/orgs",
    "repos_url": "https://api.github.com/users/RatanRSur/repos",
    "events_url": "https://api.github.com/users/RatanRSur/events{/privacy}",
    "received_events_url": "https://api.github.com/users/RatanRSur/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "RatanRSur",
      "id": 4733314,
      "node_id": "MDQ6VXNlcjQ3MzMzMTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4733314?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RatanRSur",
      "html_url": "https://github.com/RatanRSur",
      "followers_url": "https://api.github.com/users/RatanRSur/followers",
      "following_url": "https://api.github.com/users/RatanRSur/following{/other_user}",
      "gists_url": "https://api.github.com/users/RatanRSur/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RatanRSur/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RatanRSur/subscriptions",
      "organizations_url": "https://api.github.com/users/RatanRSur/orgs",
      "repos_url": "https://api.github.com/users/RatanRSur/repos",
      "events_url": "https://api.github.com/users/RatanRSur/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RatanRSur/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": {
    "url": "https://api.github.com/repos/hyperledger/besu/milestones/3",
    "html_url": "https://github.com/hyperledger/besu/milestone/3",
    "labels_url": "https://api.github.com/repos/hyperledger/besu/milestones/3/labels",
    "id": 5333988,
    "node_id": "MDk6TWlsZXN0b25lNTMzMzk4OA==",
    "number": 3,
    "title": "Chupacabra Sprint 63",
    "description": "April 22 - May 6",
    "creator": {
      "login": "timbeiko",
      "id": 9390255,
      "node_id": "MDQ6VXNlcjkzOTAyNTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9390255?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/timbeiko",
      "html_url": "https://github.com/timbeiko",
      "followers_url": "https://api.github.com/users/timbeiko/followers",
      "following_url": "https://api.github.com/users/timbeiko/following{/other_user}",
      "gists_url": "https://api.github.com/users/timbeiko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/timbeiko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/timbeiko/subscriptions",
      "organizations_url": "https://api.github.com/users/timbeiko/orgs",
      "repos_url": "https://api.github.com/users/timbeiko/repos",
      "events_url": "https://api.github.com/users/timbeiko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/timbeiko/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 2,
    "closed_issues": 11,
    "state": "closed",
    "created_at": "2020-04-21T15:13:45Z",
    "updated_at": "2020-05-06T17:00:14Z",
    "due_on": "2020-05-06T07:00:00Z",
    "closed_at": "2020-05-06T17:00:14Z"
  },
  "comments": 3,
  "created_at": "2020-04-06T11:13:57Z",
  "updated_at": "2020-05-04T02:14:26Z",
  "closed_at": "2020-05-03T23:37:16Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Description\r\nAs a golang application Developer, I want subscribe to smart-contract event logs via websocket api so that i receive push events \r\n\r\n### Acceptance Criteria\r\n* Besu RPC node is compatible with ethereum golang client websocket API\r\n\r\n### Steps to Reproduce (Bug)\r\n1. Import  github.com/ethereum/go-ethereum eth client\r\n2. Try to create a subscription for smart contract log events with the client reaching the Besu ws port\r\n\r\n**Expected behavior:** \r\nApplication should receive push events as emitted by deployed smart contracts\r\n\r\n**Actual behavior:** \r\nApplication Besu node returns an error upon subscription\r\n\r\n**Frequency:** \r\nAlways\r\n\r\n### Versions\r\n* Software version:\r\nModified sample network from commit b9bfa831194763f18cc99deca235ffe754b66aae , Date:   Mon Jan 27 18:52:10 2020 +1000\r\n\r\n* Docker Version: 19.03.8\r\n* OS: Latest Ubuntu LTS (18.04). \r\n* golang ethereum client: github.com/ethereum/go-ethereum v1.9.12\r\n### Additional Information\r\n\r\nCapturing the websocket packages transmitted with the standard golang ethereum client reveals a payload of:\r\n`{\"jsonrpc\":\"2.0\",\"id\":1,\"method\":\"eth_subscribe\",\"params\":[\"logs\",{\"address\":[\"0xb9a219631aed55ebc3d998f17c3840b7ec39c0cc\"],\"fromBlock\":\"0x0\",\"toBlock\":\"latest\",\"topics\":null}]}\\n` to which the Besu node responds with `{\"jsonrpc\":\"2.0\",\"id\":1,\"error\":{\"code\":-32600,\"message\":\"Invalid Request\"}}` \r\n\r\nI implemented an own client that submits `{\"id\":123,\"method\":\"eth_subscribe\",\"params\":[\"logs\",{\"address\":\"0xb9a219631aed55ebc3d998f17c3840b7ec39c0cc\"}]}\\n` and works as expected. I can then receive and decode events.\r\n\r\nOne important difference to notice, is that the standard ethereum client transmits an array of contract addresses.\r\n",
  "closed_by": {
    "login": "lucassaldanha",
    "id": 1766440,
    "node_id": "MDQ6VXNlcjE3NjY0NDA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1766440?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/lucassaldanha",
    "html_url": "https://github.com/lucassaldanha",
    "followers_url": "https://api.github.com/users/lucassaldanha/followers",
    "following_url": "https://api.github.com/users/lucassaldanha/following{/other_user}",
    "gists_url": "https://api.github.com/users/lucassaldanha/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/lucassaldanha/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/lucassaldanha/subscriptions",
    "organizations_url": "https://api.github.com/users/lucassaldanha/orgs",
    "repos_url": "https://api.github.com/users/lucassaldanha/repos",
    "events_url": "https://api.github.com/users/lucassaldanha/events{/privacy}",
    "received_events_url": "https://api.github.com/users/lucassaldanha/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/654/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/654/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/609881949",
    "html_url": "https://github.com/hyperledger/besu/issues/654#issuecomment-609881949",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/654",
    "id": 609881949,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwOTg4MTk0OQ==",
    "user": {
      "login": "shemnon",
      "id": 38109,
      "node_id": "MDQ6VXNlcjM4MTA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/38109?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shemnon",
      "html_url": "https://github.com/shemnon",
      "followers_url": "https://api.github.com/users/shemnon/followers",
      "following_url": "https://api.github.com/users/shemnon/following{/other_user}",
      "gists_url": "https://api.github.com/users/shemnon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shemnon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shemnon/subscriptions",
      "organizations_url": "https://api.github.com/users/shemnon/orgs",
      "repos_url": "https://api.github.com/users/shemnon/repos",
      "events_url": "https://api.github.com/users/shemnon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shemnon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-06T15:57:57Z",
    "updated_at": "2020-04-06T15:57:57Z",
    "author_association": "MEMBER",
    "body": "My instinct says we are not playing well with the null `\"topics\"` argument.  Thanks for the JSON-RPC, this will help a lot.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/609881949/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/611171567",
    "html_url": "https://github.com/hyperledger/besu/issues/654#issuecomment-611171567",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/654",
    "id": 611171567,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMTE3MTU2Nw==",
    "user": {
      "login": "shemnon",
      "id": 38109,
      "node_id": "MDQ6VXNlcjM4MTA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/38109?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shemnon",
      "html_url": "https://github.com/shemnon",
      "followers_url": "https://api.github.com/users/shemnon/followers",
      "following_url": "https://api.github.com/users/shemnon/following{/other_user}",
      "gists_url": "https://api.github.com/users/shemnon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shemnon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shemnon/subscriptions",
      "organizations_url": "https://api.github.com/users/shemnon/orgs",
      "repos_url": "https://api.github.com/users/shemnon/repos",
      "events_url": "https://api.github.com/users/shemnon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shemnon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-08T20:17:35Z",
    "updated_at": "2020-04-08T20:19:01Z",
    "author_association": "MEMBER",
    "body": "The problem was different.  geth does not follow it's own published spec for this API (https://github.com/ethereum/go-ethereum/wiki/RPC-PUB-SUB#logs or https://geth.ethereum.org/docs/rpc/pubsub) and includes `fromBlock` and `toBlock` in the subscription arguments.  Only `address` and `topics` are documented.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/611171567/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 1
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/623228322",
    "html_url": "https://github.com/hyperledger/besu/issues/654#issuecomment-623228322",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/654",
    "id": 623228322,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMzIyODMyMg==",
    "user": {
      "login": "RatanRSur",
      "id": 4733314,
      "node_id": "MDQ6VXNlcjQ3MzMzMTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4733314?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RatanRSur",
      "html_url": "https://github.com/RatanRSur",
      "followers_url": "https://api.github.com/users/RatanRSur/followers",
      "following_url": "https://api.github.com/users/RatanRSur/following{/other_user}",
      "gists_url": "https://api.github.com/users/RatanRSur/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RatanRSur/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RatanRSur/subscriptions",
      "organizations_url": "https://api.github.com/users/RatanRSur/orgs",
      "repos_url": "https://api.github.com/users/RatanRSur/repos",
      "events_url": "https://api.github.com/users/RatanRSur/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RatanRSur/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-04T02:14:26Z",
    "updated_at": "2020-05-04T02:14:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for the bug report and repro! The fix should be in the master branch now.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/623228322/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
