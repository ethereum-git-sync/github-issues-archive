{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/3576",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/3576/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/3576/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/3576/events",
  "html_url": "https://github.com/hyperledger/besu/issues/3576",
  "id": 1167266589,
  "node_id": "I_kwDODE2jmc5FkxMd",
  "number": 3576,
  "title": "amount of gas returned from eth_estimateGas API is so large for the transactions that are going to fail",
  "user": {
    "login": "GowthamParamasivam",
    "id": 43418883,
    "node_id": "MDQ6VXNlcjQzNDE4ODgz",
    "avatar_url": "https://avatars.githubusercontent.com/u/43418883?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/GowthamParamasivam",
    "html_url": "https://github.com/GowthamParamasivam",
    "followers_url": "https://api.github.com/users/GowthamParamasivam/followers",
    "following_url": "https://api.github.com/users/GowthamParamasivam/following{/other_user}",
    "gists_url": "https://api.github.com/users/GowthamParamasivam/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/GowthamParamasivam/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/GowthamParamasivam/subscriptions",
    "organizations_url": "https://api.github.com/users/GowthamParamasivam/orgs",
    "repos_url": "https://api.github.com/users/GowthamParamasivam/repos",
    "events_url": "https://api.github.com/users/GowthamParamasivam/events{/privacy}",
    "received_events_url": "https://api.github.com/users/GowthamParamasivam/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-03-12T11:52:16Z",
  "updated_at": "2022-03-15T13:06:30Z",
  "closed_at": "2022-03-15T13:06:30Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "As a besu user, we have a private network, we have smart contracts deployed in the network, while interacting with the contracts, there may be transactions that will fail due to some constraints, but for these transactions, the return value from the [eth_estimateGas](https://besu.hyperledger.org/en/stable/Reference/API-Methods/#eth_estimategas) api is so large than the same transaction that will success. \r\n\r\nFor example, consider onlyOwner function is called from another address than the owner in that case the eth_estimateGas api is large than the same transaction is done from the owner's address.\r\n\r\n### **Steps to reproduce the bug**\r\n1. Deploy a smart contract with a function with any validation.\r\n2. Initiate a transaction with failed validation.\r\n3. The gas limit shown on the wallet apps is too large than the success scenario.\r\n\r\n**Expected behavior:**\r\nThe eth_estimateGas api, after stimulating the transaction should return the gas limit needed for the transaction.\r\n\r\n**Actual behavior:**\r\nThe eth_estimateGas api returns a gas limit value too large for the transaction.\r\n\r\n### Versions (Add all that apply)\r\n* Software version: besu/v22.1.1/linux-x86_64/oracle_openjdk-java-16\r\n* Java version: openjdk 16 2021-03-16\r\n* OS Name & Version: Ubuntu 20.04.3 LTS\r\n* Kernel Version: Linux ip-10-0-100-135 5.11.0-1022-aws 23~20.04.1-Ubuntu SMP Mon Nov 15 14:03:19 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux\r\n* Cloud VM, type, size: [Amazon Web Services t2-large]\r\n\r\n### Additional Information\r\nThe transactions is initialized through remix ide and blockscout explorer. In other clients like geth we are not facing this issue.\r\n",
  "closed_by": {
    "login": "GowthamParamasivam",
    "id": 43418883,
    "node_id": "MDQ6VXNlcjQzNDE4ODgz",
    "avatar_url": "https://avatars.githubusercontent.com/u/43418883?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/GowthamParamasivam",
    "html_url": "https://github.com/GowthamParamasivam",
    "followers_url": "https://api.github.com/users/GowthamParamasivam/followers",
    "following_url": "https://api.github.com/users/GowthamParamasivam/following{/other_user}",
    "gists_url": "https://api.github.com/users/GowthamParamasivam/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/GowthamParamasivam/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/GowthamParamasivam/subscriptions",
    "organizations_url": "https://api.github.com/users/GowthamParamasivam/orgs",
    "repos_url": "https://api.github.com/users/GowthamParamasivam/repos",
    "events_url": "https://api.github.com/users/GowthamParamasivam/events{/privacy}",
    "received_events_url": "https://api.github.com/users/GowthamParamasivam/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/3576/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/3576/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1066210103",
    "html_url": "https://github.com/hyperledger/besu/issues/3576#issuecomment-1066210103",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/3576",
    "id": 1066210103,
    "node_id": "IC_kwDODE2jmc4_jRM3",
    "user": {
      "login": "frankisawesome",
      "id": 39414003,
      "node_id": "MDQ6VXNlcjM5NDE0MDAz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39414003?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frankisawesome",
      "html_url": "https://github.com/frankisawesome",
      "followers_url": "https://api.github.com/users/frankisawesome/followers",
      "following_url": "https://api.github.com/users/frankisawesome/following{/other_user}",
      "gists_url": "https://api.github.com/users/frankisawesome/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frankisawesome/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frankisawesome/subscriptions",
      "organizations_url": "https://api.github.com/users/frankisawesome/orgs",
      "repos_url": "https://api.github.com/users/frankisawesome/repos",
      "events_url": "https://api.github.com/users/frankisawesome/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frankisawesome/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-13T23:48:55Z",
    "updated_at": "2022-03-13T23:48:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hey @GowthamParamasivam are you able to package the contracts into a repo so we can replicate the issue?",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1066210103/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1067489641",
    "html_url": "https://github.com/hyperledger/besu/issues/3576#issuecomment-1067489641",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/3576",
    "id": 1067489641,
    "node_id": "IC_kwDODE2jmc4_oJlp",
    "user": {
      "login": "GowthamParamasivam",
      "id": 43418883,
      "node_id": "MDQ6VXNlcjQzNDE4ODgz",
      "avatar_url": "https://avatars.githubusercontent.com/u/43418883?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/GowthamParamasivam",
      "html_url": "https://github.com/GowthamParamasivam",
      "followers_url": "https://api.github.com/users/GowthamParamasivam/followers",
      "following_url": "https://api.github.com/users/GowthamParamasivam/following{/other_user}",
      "gists_url": "https://api.github.com/users/GowthamParamasivam/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/GowthamParamasivam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GowthamParamasivam/subscriptions",
      "organizations_url": "https://api.github.com/users/GowthamParamasivam/orgs",
      "repos_url": "https://api.github.com/users/GowthamParamasivam/repos",
      "events_url": "https://api.github.com/users/GowthamParamasivam/events{/privacy}",
      "received_events_url": "https://api.github.com/users/GowthamParamasivam/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-15T02:15:20Z",
    "updated_at": "2022-03-15T02:15:20Z",
    "author_association": "NONE",
    "body": "Hi @frankisawesome , I have a very basic solidity contract, just to add a number with a condition the number should be greater than 10. You can find the [repo here](https://github.com/GowthamParamasivam/besu-issue-3576). \r\n\r\ngas estimate for simple addition that will fail \r\n![image](https://user-images.githubusercontent.com/43418883/158292079-9cf2f614-6cbb-4f68-b694-2d6a04622eda.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1067489641/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1067967316",
    "html_url": "https://github.com/hyperledger/besu/issues/3576#issuecomment-1067967316",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/3576",
    "id": 1067967316,
    "node_id": "IC_kwDODE2jmc4_p-NU",
    "user": {
      "login": "GowthamParamasivam",
      "id": 43418883,
      "node_id": "MDQ6VXNlcjQzNDE4ODgz",
      "avatar_url": "https://avatars.githubusercontent.com/u/43418883?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/GowthamParamasivam",
      "html_url": "https://github.com/GowthamParamasivam",
      "followers_url": "https://api.github.com/users/GowthamParamasivam/followers",
      "following_url": "https://api.github.com/users/GowthamParamasivam/following{/other_user}",
      "gists_url": "https://api.github.com/users/GowthamParamasivam/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/GowthamParamasivam/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GowthamParamasivam/subscriptions",
      "organizations_url": "https://api.github.com/users/GowthamParamasivam/orgs",
      "repos_url": "https://api.github.com/users/GowthamParamasivam/repos",
      "events_url": "https://api.github.com/users/GowthamParamasivam/events{/privacy}",
      "received_events_url": "https://api.github.com/users/GowthamParamasivam/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-15T13:06:30Z",
    "updated_at": "2022-03-15T13:06:30Z",
    "author_association": "NONE",
    "body": "Seems like the issue is with the metamask wallet app and not on the besu side, there are few [issues](https://github.com/MetaMask/metamask-extension/issues/10276) opened on the metamask side related to this. So I am closing this issue.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1067967316/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
