{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/2113",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/2113/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/2113/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/2113/events",
  "html_url": "https://github.com/hyperledger/besu/issues/2113",
  "id": 852376861,
  "node_id": "MDU6SXNzdWU4NTIzNzY4NjE=",
  "number": 2113,
  "title": "SELFDESTRUCT creates wrong traces? ",
  "user": {
    "login": "alecalve",
    "id": 3832610,
    "node_id": "MDQ6VXNlcjM4MzI2MTA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3832610?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alecalve",
    "html_url": "https://github.com/alecalve",
    "followers_url": "https://api.github.com/users/alecalve/followers",
    "following_url": "https://api.github.com/users/alecalve/following{/other_user}",
    "gists_url": "https://api.github.com/users/alecalve/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alecalve/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alecalve/subscriptions",
    "organizations_url": "https://api.github.com/users/alecalve/orgs",
    "repos_url": "https://api.github.com/users/alecalve/repos",
    "events_url": "https://api.github.com/users/alecalve/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alecalve/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1537362490,
      "node_id": "MDU6TGFiZWwxNTM3MzYyNDkw",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    },
    {
      "id": 2051683573,
      "node_id": "MDU6TGFiZWwyMDUxNjgzNTcz",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/P3",
      "name": "P3",
      "color": "ffff00",
      "default": false,
      "description": "Medium (ex: JSON-RPC request not working with a specific client library due to loose spec assumtion)"
    },
    {
      "id": 3013559202,
      "node_id": "MDU6TGFiZWwzMDEzNTU5MjAy",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/mainnet",
      "name": "mainnet",
      "color": "9D578C",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "matkt",
    "id": 26581503,
    "node_id": "MDQ6VXNlcjI2NTgxNTAz",
    "avatar_url": "https://avatars.githubusercontent.com/u/26581503?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/matkt",
    "html_url": "https://github.com/matkt",
    "followers_url": "https://api.github.com/users/matkt/followers",
    "following_url": "https://api.github.com/users/matkt/following{/other_user}",
    "gists_url": "https://api.github.com/users/matkt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/matkt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/matkt/subscriptions",
    "organizations_url": "https://api.github.com/users/matkt/orgs",
    "repos_url": "https://api.github.com/users/matkt/repos",
    "events_url": "https://api.github.com/users/matkt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/matkt/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "matkt",
      "id": 26581503,
      "node_id": "MDQ6VXNlcjI2NTgxNTAz",
      "avatar_url": "https://avatars.githubusercontent.com/u/26581503?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matkt",
      "html_url": "https://github.com/matkt",
      "followers_url": "https://api.github.com/users/matkt/followers",
      "following_url": "https://api.github.com/users/matkt/following{/other_user}",
      "gists_url": "https://api.github.com/users/matkt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matkt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matkt/subscriptions",
      "organizations_url": "https://api.github.com/users/matkt/orgs",
      "repos_url": "https://api.github.com/users/matkt/repos",
      "events_url": "https://api.github.com/users/matkt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matkt/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-04-07T12:51:09Z",
  "updated_at": "2021-05-31T08:40:46Z",
  "closed_at": "2021-05-31T08:40:46Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Description\r\nWe run several `21.1.1` nodes with the following configuration:\r\n\r\n```\r\n      --network=classic\r\n      --sync-mode=FAST\r\n      --pruning-enabled=true\r\n      --pruning-blocks-retained=100000\r\n      --Xsynchronizer-fast-sync-pivot-distance=50000\r\n      --rpc-http-api ETH,NET,TRACE,WEB3\r\n```\r\n\r\nThe call tree for [the following transaction](https://blockscout.com/etc/mainnet/tx/0xf0248d795b32193b93d40511a3d7364d070a2ce6f45868e2848d1b0fd08dddc6/token-transfers), obtained using `trace_block`, is as follow: \r\n\r\n```\r\nCALL from=0x88bb...0af2 to=0xe793...635d value=0.01 ETC\r\n    → CALL from=0xe793...635d to=0x31b3...2d5d value=0.01 ETC\r\n        → DELEGATECALL from=0x31b3...2d5d to=0xd44a...14ac value=0.01 ETC\r\n            → STATICCALL from=0x31b3...2d5d to=0xdadc...693a value=0 ETC\r\n            → CALL from=0x31b3...2d5d to=0xdadc...693a value=0 ETC\r\n    → CALL from=0xe793...635d to=0x0000...992c value=0 ETC\r\n        → CALL from=0x0000...992c to=0xe5c6...52cd value=0.01 ETC\r\n            → SUICIDE from=0xe5c6...52cd to=0x0000...992c value=0 ETC\r\n        → CALL from=0x0000...992c to=0x937e...c343 value=0.01 ETC\r\n            → SUICIDE from=0x937e...c343 to=0x0000...992c value=0 ETC\r\n        → CALL from=0x0000...992c to=0xc1c2...2593 value=0.01 ETC\r\n            → SUICIDE from=0xc1c2...2593 to=0x0000...992c value=0 ETC\r\n```\r\n\r\n**Expected behavior:** From my understanding of how `SELFDESTRUCT` works, the 3 suicide actions in that transaction should have values equal to the balance of the contracts at the time (so at least 0.01 ETC since they received that right before being destructed).\r\n\r\n**Actual behavior:** Traces for these suicide actions have a balance value of 0\r\n\r\n**Frequency:** This can be replicated on our 3 nodes and also on data obtained by blockscout.com.\r\n",
  "closed_by": {
    "login": "matkt",
    "id": 26581503,
    "node_id": "MDQ6VXNlcjI2NTgxNTAz",
    "avatar_url": "https://avatars.githubusercontent.com/u/26581503?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/matkt",
    "html_url": "https://github.com/matkt",
    "followers_url": "https://api.github.com/users/matkt/followers",
    "following_url": "https://api.github.com/users/matkt/following{/other_user}",
    "gists_url": "https://api.github.com/users/matkt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/matkt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/matkt/subscriptions",
    "organizations_url": "https://api.github.com/users/matkt/orgs",
    "repos_url": "https://api.github.com/users/matkt/repos",
    "events_url": "https://api.github.com/users/matkt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/matkt/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/2113/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/2113/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/815021262",
    "html_url": "https://github.com/hyperledger/besu/issues/2113#issuecomment-815021262",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2113",
    "id": 815021262,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNTAyMTI2Mg==",
    "user": {
      "login": "alecalve",
      "id": 3832610,
      "node_id": "MDQ6VXNlcjM4MzI2MTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3832610?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alecalve",
      "html_url": "https://github.com/alecalve",
      "followers_url": "https://api.github.com/users/alecalve/followers",
      "following_url": "https://api.github.com/users/alecalve/following{/other_user}",
      "gists_url": "https://api.github.com/users/alecalve/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alecalve/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alecalve/subscriptions",
      "organizations_url": "https://api.github.com/users/alecalve/orgs",
      "repos_url": "https://api.github.com/users/alecalve/repos",
      "events_url": "https://api.github.com/users/alecalve/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alecalve/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-07T15:46:42Z",
    "updated_at": "2021-04-07T15:46:42Z",
    "author_association": "NONE",
    "body": "A thought that occured to me is that it could be the value of the `SELFDESTRUCT`'s parents which is wrong. It would be the first time `0x0000...992c` would transact ETC.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/815021262/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
