{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/2932",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/2932/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/2932/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/2932/events",
  "html_url": "https://github.com/hyperledger/besu/issues/2932",
  "id": 1031548197,
  "node_id": "I_kwDODE2jmc49fC0l",
  "number": 2932,
  "title": "Full sync extremely slow",
  "user": {
    "login": "adean-consensys",
    "id": 83668448,
    "node_id": "MDQ6VXNlcjgzNjY4NDQ4",
    "avatar_url": "https://avatars.githubusercontent.com/u/83668448?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/adean-consensys",
    "html_url": "https://github.com/adean-consensys",
    "followers_url": "https://api.github.com/users/adean-consensys/followers",
    "following_url": "https://api.github.com/users/adean-consensys/following{/other_user}",
    "gists_url": "https://api.github.com/users/adean-consensys/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/adean-consensys/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/adean-consensys/subscriptions",
    "organizations_url": "https://api.github.com/users/adean-consensys/orgs",
    "repos_url": "https://api.github.com/users/adean-consensys/repos",
    "events_url": "https://api.github.com/users/adean-consensys/events{/privacy}",
    "received_events_url": "https://api.github.com/users/adean-consensys/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 3805591260,
      "node_id": "LA_kwDODE2jmc7i1Lbc",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/peering",
      "name": "peering",
      "color": "006b75",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 12,
  "created_at": "2021-10-20T15:28:32Z",
  "updated_at": "2022-04-06T11:23:14Z",
  "closed_at": "2022-04-06T11:23:14Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Description\r\nMainnet full sync is taking multiple weeks - running besu:21.7.2 in an Azure AKS Cluster with 10Gi of memory and 2 CPU cores and 3TB storage dedicated to chain data\r\n25 peers\r\n\r\n**Expected behavior:**\r\nSync to occur within a reasonable amount of time\r\n\r\n**Actual behavior:**\r\nProcessing about 200 blocks per 40 minutes\r\n\r\n\r\n### Versions (Add all that apply)\r\n* Software version: `21.7.2`\r\n* Java version: `openjdk version \"11.0.11\" 2021-04-20`\r\n* OS Name & Version: Docker?\r\n* Kernel Version: `Linux besu-node-0 5.4.0-1059-azure #62~18.04.1-Ubuntu SMP Tue Sep 14 17:53:18 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux`\r\n* Virtual Machine software & version: `Ubuntu 18.04.6 LTS`\r\n* Docker Version: [`containerd://1.4.9+azure`]\r\n* Cloud VM, type, size: [`Azure AKS Standard_D4as_v4`]\r\n\r\n### Additional Information\r\n\r\n![image](https://user-images.githubusercontent.com/83668448/138122123-a3e82655-a9af-4523-915d-b8cc4b4f4360.png)\r\n\r\n![image](https://user-images.githubusercontent.com/83668448/138123507-39c51ef8-2bda-47e6-8e47-0807d2e85e4c.png)\r\n\r\nLogs:\r\n```\r\n2021-10-20 12:33:55.784+00:00 | EthScheduler-Services-5 (importBlock) | INFO  | FullImportBlockStep | Import reached block 13425400 (0xcc2f5263fcf689e9d102d5806ca369476088d68114af9461c507877ff9b1d01e), 1.714 Mg/s, Peers: 25\r\n2021-10-20 12:59:01.764+00:00 | EthScheduler-Services-5 (importBlock) | INFO  | FullImportBlockStep | Import reached block 13425600 (0xefc9cf23d7fc3226f6f485a7d5921ea57aaa76ee6431ab62f8c78a84be71db72), 2.024 Mg/s, Peers: 25\r\n2021-10-20 13:32:37.342+00:00 | EthScheduler-Services-5 (importBlock) | INFO  | FullImportBlockStep | Import reached block 13425800 (0xc61bb21c79877516c7824f60854b061d5c261a7154a5ff9991c080782050f4fd), 1.524 Mg/s, Peers: 25\r\n2021-10-20 14:07:40.270+00:00 | EthScheduler-Services-5 (importBlock) | INFO  | FullImportBlockStep | Import reached block 13426000 (0xe8028f2e7ffdd28677f3e149304a422ea81559bb7d006536f497c8fcf4367f1d), 1.465 Mg/s, Peers: 25\r\n2021-10-20 14:44:26.835+00:00 | EthScheduler-Services-5 (importBlock) | INFO  | FullImportBlockStep | Import reached block 13426200 (0xa1433c5cc63e8fea55d83efa5f75df38cc5fc27e57aa4ae6d9090602aa8d67eb), 1.402 Mg/s, Peers: 25\r\n```\r\n\r\nI've checked metrics, the process is not using much the CPU at all, using about 60% of the memory limit (~6Gi) and storage utilization is very low (see charts).  How can we expedite this sync?",
  "closed_by": {
    "login": "macfarla",
    "id": 2627919,
    "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/macfarla",
    "html_url": "https://github.com/macfarla",
    "followers_url": "https://api.github.com/users/macfarla/followers",
    "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
    "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
    "organizations_url": "https://api.github.com/users/macfarla/orgs",
    "repos_url": "https://api.github.com/users/macfarla/repos",
    "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
    "received_events_url": "https://api.github.com/users/macfarla/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/2932/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/2932/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/950888469",
    "html_url": "https://github.com/hyperledger/besu/issues/2932#issuecomment-950888469",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2932",
    "id": 950888469,
    "node_id": "IC_kwDODE2jmc44rWgV",
    "user": {
      "login": "jflo",
      "id": 345937,
      "node_id": "MDQ6VXNlcjM0NTkzNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/345937?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jflo",
      "html_url": "https://github.com/jflo",
      "followers_url": "https://api.github.com/users/jflo/followers",
      "following_url": "https://api.github.com/users/jflo/following{/other_user}",
      "gists_url": "https://api.github.com/users/jflo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jflo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jflo/subscriptions",
      "organizations_url": "https://api.github.com/users/jflo/orgs",
      "repos_url": "https://api.github.com/users/jflo/repos",
      "events_url": "https://api.github.com/users/jflo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jflo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-25T12:46:34Z",
    "updated_at": "2021-10-25T12:46:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "If you have metrics setup, you can get a report of your block times during sync. That number will give us some good insight- I would expect it to be between 50-200ms depending on the complexity of the transactions in the block.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/950888469/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/950951698",
    "html_url": "https://github.com/hyperledger/besu/issues/2932#issuecomment-950951698",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2932",
    "id": 950951698,
    "node_id": "IC_kwDODE2jmc44rl8S",
    "user": {
      "login": "adean-consensys",
      "id": 83668448,
      "node_id": "MDQ6VXNlcjgzNjY4NDQ4",
      "avatar_url": "https://avatars.githubusercontent.com/u/83668448?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/adean-consensys",
      "html_url": "https://github.com/adean-consensys",
      "followers_url": "https://api.github.com/users/adean-consensys/followers",
      "following_url": "https://api.github.com/users/adean-consensys/following{/other_user}",
      "gists_url": "https://api.github.com/users/adean-consensys/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/adean-consensys/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adean-consensys/subscriptions",
      "organizations_url": "https://api.github.com/users/adean-consensys/orgs",
      "repos_url": "https://api.github.com/users/adean-consensys/repos",
      "events_url": "https://api.github.com/users/adean-consensys/events{/privacy}",
      "received_events_url": "https://api.github.com/users/adean-consensys/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-25T13:52:26Z",
    "updated_at": "2021-10-25T13:52:26Z",
    "author_association": "NONE",
    "body": "I do have metrics setup via Prometheus, I think we found what was causing this issue.  To clarify the data you're asking for, we were seeing 5m average Block Time in the *13 second* range.  I checked on the configuration and found that the besu pod storage class was set to Azure Standard HDD LRS (slow spinning disk).  We changed the configuration to use Azure Standard SSD LRS instead and began a brand new sync process, for which we're seeing ~ 9ms 5m Average Block times.\r\n\r\nI am not sure if this new average time will remain consistent all the way through the sync but it's an order of magnitude of difference.  I'll update this thread if it's relevant for future users who run into a similar situation.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/950951698/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/956290846",
    "html_url": "https://github.com/hyperledger/besu/issues/2932#issuecomment-956290846",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2932",
    "id": 956290846,
    "node_id": "IC_kwDODE2jmc44_9ce",
    "user": {
      "login": "adean-consensys",
      "id": 83668448,
      "node_id": "MDQ6VXNlcjgzNjY4NDQ4",
      "avatar_url": "https://avatars.githubusercontent.com/u/83668448?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/adean-consensys",
      "html_url": "https://github.com/adean-consensys",
      "followers_url": "https://api.github.com/users/adean-consensys/followers",
      "following_url": "https://api.github.com/users/adean-consensys/following{/other_user}",
      "gists_url": "https://api.github.com/users/adean-consensys/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/adean-consensys/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adean-consensys/subscriptions",
      "organizations_url": "https://api.github.com/users/adean-consensys/orgs",
      "repos_url": "https://api.github.com/users/adean-consensys/repos",
      "events_url": "https://api.github.com/users/adean-consensys/events{/privacy}",
      "received_events_url": "https://api.github.com/users/adean-consensys/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-01T14:39:31Z",
    "updated_at": "2021-11-01T14:48:14Z",
    "author_association": "NONE",
    "body": "Appears that the disk type has some bearing on the speed for which the sync occurs, once we completed the `PipelineChainDownloader` phase, it went into a world state download stage where it got really far behind in syncing.  We restarted the pod and we're syncing again but very slowly, averaging over 4s per block\r\n\r\n```\r\n2021-10-29 17:30:25.216+00:00 | EthScheduler-Services-32 (importBlock) | INFO  | FastImportBlocksStep | Completed importing chain segment 13107401 to 13107500, Peers: 26\r\n2021-10-29 17:30:25.216+00:00 | EthScheduler-Services-32 (importBlock) | INFO  | PipelineChainDownloader | Chain download complete\r\n2021-10-29 17:35:28.895+00:00 | EthScheduler-Services-7 (requestCompleteTask) | INFO  | CompleteTaskStep | Downloaded 254000000 world state nodes. At least 32296960 nodes remaining.\r\n```\r\n\r\nImport slowness:\r\n```\r\n2021-11-01 14:04:18.349+00:00 | EthScheduler-Services-36 (importBlock) | INFO  | FullImportBlockStep | Import reached block 13120600 (0x3653604dd9ded0342321b6487a80df41c3585ce3c9054d96ffff896252c9676f), 3.758 Mg/s, Peers: 26\r\n2021-11-01 14:18:46.622+00:00 | EthScheduler-Services-36 (importBlock) | INFO  | FullImportBlockStep | Import reached block 13120800 (0x4bf97218c6d8e36658d1d30c1b8ebd548d28a0c2cbba52fd11e19f332b43c881), 3.644 Mg/s, Peers: 26\r\n2021-11-01 14:36:30.111+00:00 | EthScheduler-Services-36 (importBlock) | INFO  | FullImportBlockStep | Import reached block 13121000 (0xaf0eddb673290b0737774f76aac2898959b8deccc773ac6d3f55dda50d1ae325), 2.896 Mg/s, Peers: 26\r\n```\r\n\r\n![image](https://user-images.githubusercontent.com/83668448/139689121-0c73f81d-2a61-49e8-ba28-18036fedaf48.png)\r\n\r\nWe're essentially back at the stage we were with the old instance on the slow HDD, CPU util isn't maxed out and there's plenty of memory.  What else can we do to kickstart this thing back into processing quickly?  ",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/956290846/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/965688417",
    "html_url": "https://github.com/hyperledger/besu/issues/2932#issuecomment-965688417",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2932",
    "id": 965688417,
    "node_id": "IC_kwDODE2jmc45jzxh",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-10T19:50:16Z",
    "updated_at": "2021-11-10T19:50:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "Peers stays constant at 25\r\nAverage block time is about 6.5 seconds\r\nWhen it was in fast sync it was in the millisecond range, shot up afterwards\r\nIt’s catching up, it’s just really slow.  12 hours ago it was at 327,359 behind and currently it is at 323,504\r\nIs that expected speed for a full sync?",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/965688417/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/967181202",
    "html_url": "https://github.com/hyperledger/besu/issues/2932#issuecomment-967181202",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2932",
    "id": 967181202,
    "node_id": "IC_kwDODE2jmc45pgOS",
    "user": {
      "login": "adean-consensys",
      "id": 83668448,
      "node_id": "MDQ6VXNlcjgzNjY4NDQ4",
      "avatar_url": "https://avatars.githubusercontent.com/u/83668448?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/adean-consensys",
      "html_url": "https://github.com/adean-consensys",
      "followers_url": "https://api.github.com/users/adean-consensys/followers",
      "following_url": "https://api.github.com/users/adean-consensys/following{/other_user}",
      "gists_url": "https://api.github.com/users/adean-consensys/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/adean-consensys/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adean-consensys/subscriptions",
      "organizations_url": "https://api.github.com/users/adean-consensys/orgs",
      "repos_url": "https://api.github.com/users/adean-consensys/repos",
      "events_url": "https://api.github.com/users/adean-consensys/events{/privacy}",
      "received_events_url": "https://api.github.com/users/adean-consensys/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-12T14:59:25Z",
    "updated_at": "2021-11-12T14:59:34Z",
    "author_association": "NONE",
    "body": "Block time chart (not sure what happened mid-10/29 through end-of 10/31, maybe didn't report a value?)\r\n\r\n![image](https://user-images.githubusercontent.com/83668448/141487197-6c128450-022c-41ac-bf9b-1e2939de004e.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/967181202/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/983732353",
    "html_url": "https://github.com/hyperledger/besu/issues/2932#issuecomment-983732353",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2932",
    "id": 983732353,
    "node_id": "IC_kwDODE2jmc46opCB",
    "user": {
      "login": "adean-consensys",
      "id": 83668448,
      "node_id": "MDQ6VXNlcjgzNjY4NDQ4",
      "avatar_url": "https://avatars.githubusercontent.com/u/83668448?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/adean-consensys",
      "html_url": "https://github.com/adean-consensys",
      "followers_url": "https://api.github.com/users/adean-consensys/followers",
      "following_url": "https://api.github.com/users/adean-consensys/following{/other_user}",
      "gists_url": "https://api.github.com/users/adean-consensys/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/adean-consensys/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adean-consensys/subscriptions",
      "organizations_url": "https://api.github.com/users/adean-consensys/orgs",
      "repos_url": "https://api.github.com/users/adean-consensys/repos",
      "events_url": "https://api.github.com/users/adean-consensys/events{/privacy}",
      "received_events_url": "https://api.github.com/users/adean-consensys/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-01T15:06:46Z",
    "updated_at": "2021-12-01T15:06:46Z",
    "author_association": "NONE",
    "body": "Checking if there had been any progress on finding out the cause.  Block time average is still 10 seconds, and we're still 218,641 blocks behind.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/983732353/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/984957876",
    "html_url": "https://github.com/hyperledger/besu/issues/2932#issuecomment-984957876",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2932",
    "id": 984957876,
    "node_id": "IC_kwDODE2jmc46tUO0",
    "user": {
      "login": "garyschulte",
      "id": 1238512,
      "node_id": "MDQ6VXNlcjEyMzg1MTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1238512?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/garyschulte",
      "html_url": "https://github.com/garyschulte",
      "followers_url": "https://api.github.com/users/garyschulte/followers",
      "following_url": "https://api.github.com/users/garyschulte/following{/other_user}",
      "gists_url": "https://api.github.com/users/garyschulte/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/garyschulte/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/garyschulte/subscriptions",
      "organizations_url": "https://api.github.com/users/garyschulte/orgs",
      "repos_url": "https://api.github.com/users/garyschulte/repos",
      "events_url": "https://api.github.com/users/garyschulte/events{/privacy}",
      "received_events_url": "https://api.github.com/users/garyschulte/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-02T20:01:18Z",
    "updated_at": "2021-12-02T20:01:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "is the SSD gettinfg close to full?  the long period of no blocks processing looks a lot like either a rocksdb compaction or heavy SSD garbage collection.  The write performance of SSD drops off significantly when it approaches full.\r\n\r\n[ssd performance](https://web.archive.org/web/20210816151518/https://www.seagate.com/tech-insights/lies-damn-lies-and-ssd-benchmark-master-ti/)\r\n\r\nhow full is the disk?",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/984957876/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/985010390",
    "html_url": "https://github.com/hyperledger/besu/issues/2932#issuecomment-985010390",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2932",
    "id": 985010390,
    "node_id": "IC_kwDODE2jmc46thDW",
    "user": {
      "login": "adean-consensys",
      "id": 83668448,
      "node_id": "MDQ6VXNlcjgzNjY4NDQ4",
      "avatar_url": "https://avatars.githubusercontent.com/u/83668448?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/adean-consensys",
      "html_url": "https://github.com/adean-consensys",
      "followers_url": "https://api.github.com/users/adean-consensys/followers",
      "following_url": "https://api.github.com/users/adean-consensys/following{/other_user}",
      "gists_url": "https://api.github.com/users/adean-consensys/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/adean-consensys/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adean-consensys/subscriptions",
      "organizations_url": "https://api.github.com/users/adean-consensys/orgs",
      "repos_url": "https://api.github.com/users/adean-consensys/repos",
      "events_url": "https://api.github.com/users/adean-consensys/events{/privacy}",
      "received_events_url": "https://api.github.com/users/adean-consensys/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-02T21:21:12Z",
    "updated_at": "2021-12-02T21:21:36Z",
    "author_association": "NONE",
    "body": "Disk is reporting 37% full, CPU time is averaging under around .6, so it's not doing a whole lot.  How much space do we need to be mindful of for a full besu node?\r\n\r\nPrometheus reports around 1k R/W IOPS, 30MB/s read throughput, 250kB/s write throughput.  I assume it should be writing a heckuva lot more if there's still 200k blocks to go?",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/985010390/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/987515368",
    "html_url": "https://github.com/hyperledger/besu/issues/2932#issuecomment-987515368",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2932",
    "id": 987515368,
    "node_id": "IC_kwDODE2jmc463Eno",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-07T02:41:41Z",
    "updated_at": "2021-12-07T02:41:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "Other thoughts from @garyschulte \r\nwhat is the max number of open files?  mainnet nodes usually have many thousands of rocksdb segments.\r\nwhen running on a i/o bandwidth constrained machine I have found tweaking these params help:\r\n```\r\nXplugin-rocksdb-max-background-compactions=1\r\nXplugin-rocksdb-max-open-files=8192\r\nXplugin-rocksdb-cache-capacity=67108864\r\n```\r\nI tuned the number of max open files in accordance to the number of rocksdb segments, bumped up the ulimit for max open files, bumped up the cache capacity, and limited the number of concurrent compactions.\r\n\r\nif you are experiencing io constraints - those configs helped a lot on a raspi bonsai node. \r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/987515368/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1014298187",
    "html_url": "https://github.com/hyperledger/besu/issues/2932#issuecomment-1014298187",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2932",
    "id": 1014298187,
    "node_id": "IC_kwDODE2jmc48dPZL",
    "user": {
      "login": "jmcruz1983",
      "id": 15966694,
      "node_id": "MDQ6VXNlcjE1OTY2Njk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/15966694?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmcruz1983",
      "html_url": "https://github.com/jmcruz1983",
      "followers_url": "https://api.github.com/users/jmcruz1983/followers",
      "following_url": "https://api.github.com/users/jmcruz1983/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmcruz1983/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmcruz1983/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmcruz1983/subscriptions",
      "organizations_url": "https://api.github.com/users/jmcruz1983/orgs",
      "repos_url": "https://api.github.com/users/jmcruz1983/repos",
      "events_url": "https://api.github.com/users/jmcruz1983/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmcruz1983/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-17T09:15:12Z",
    "updated_at": "2022-01-17T09:15:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "Any update here?",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1014298187/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1014680490",
    "html_url": "https://github.com/hyperledger/besu/issues/2932#issuecomment-1014680490",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2932",
    "id": 1014680490,
    "node_id": "IC_kwDODE2jmc48esuq",
    "user": {
      "login": "garyschulteog",
      "id": 30323939,
      "node_id": "MDQ6VXNlcjMwMzIzOTM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/30323939?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/garyschulteog",
      "html_url": "https://github.com/garyschulteog",
      "followers_url": "https://api.github.com/users/garyschulteog/followers",
      "following_url": "https://api.github.com/users/garyschulteog/following{/other_user}",
      "gists_url": "https://api.github.com/users/garyschulteog/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/garyschulteog/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/garyschulteog/subscriptions",
      "organizations_url": "https://api.github.com/users/garyschulteog/orgs",
      "repos_url": "https://api.github.com/users/garyschulteog/repos",
      "events_url": "https://api.github.com/users/garyschulteog/events{/privacy}",
      "received_events_url": "https://api.github.com/users/garyschulteog/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-17T15:49:39Z",
    "updated_at": "2022-01-17T15:49:39Z",
    "author_association": "NONE",
    "body": "We identified some optimizations in fast sync that makes fast sync retain much more of its world state download progress after a re-pivot.  This fix is in the nightly already and should make it into a release version soon:\n\nhttps://github.com/hyperledger/besu/pull/3202",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1014680490/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1066431062",
    "html_url": "https://github.com/hyperledger/besu/issues/2932#issuecomment-1066431062",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/2932",
    "id": 1066431062,
    "node_id": "IC_kwDODE2jmc4_kHJW",
    "user": {
      "login": "macfarla",
      "id": 2627919,
      "node_id": "MDQ6VXNlcjI2Mjc5MTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2627919?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macfarla",
      "html_url": "https://github.com/macfarla",
      "followers_url": "https://api.github.com/users/macfarla/followers",
      "following_url": "https://api.github.com/users/macfarla/following{/other_user}",
      "gists_url": "https://api.github.com/users/macfarla/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macfarla/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macfarla/subscriptions",
      "organizations_url": "https://api.github.com/users/macfarla/orgs",
      "repos_url": "https://api.github.com/users/macfarla/repos",
      "events_url": "https://api.github.com/users/macfarla/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macfarla/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-14T06:37:01Z",
    "updated_at": "2022-03-14T07:12:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @jmcruz1983 @adean-consensys - realise it's been a while but we have made some improvements in peering and syncing (22.1.0 had the fast sync optimisation mentioned above #3202 ). Additionally we are beginning a holistic assessment of peering behavior including any outstanding issues. So we're hoping that either those changes have it fixed already, or that you're able to give us an update if you're still having related issues? ",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1066431062/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
