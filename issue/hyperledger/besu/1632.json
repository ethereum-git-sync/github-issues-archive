{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/1632",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/1632/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/1632/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/1632/events",
  "html_url": "https://github.com/hyperledger/besu/issues/1632",
  "id": 752523152,
  "node_id": "MDU6SXNzdWU3NTI1MjMxNTI=",
  "number": 1632,
  "title": "Add option to configure discovery in genesis json",
  "user": {
    "login": "shemnon",
    "id": 38109,
    "node_id": "MDQ6VXNlcjM4MTA5",
    "avatar_url": "https://avatars.githubusercontent.com/u/38109?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/shemnon",
    "html_url": "https://github.com/shemnon",
    "followers_url": "https://api.github.com/users/shemnon/followers",
    "following_url": "https://api.github.com/users/shemnon/following{/other_user}",
    "gists_url": "https://api.github.com/users/shemnon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/shemnon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/shemnon/subscriptions",
    "organizations_url": "https://api.github.com/users/shemnon/orgs",
    "repos_url": "https://api.github.com/users/shemnon/repos",
    "events_url": "https://api.github.com/users/shemnon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/shemnon/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1537362496,
      "node_id": "MDU6TGFiZWwxNTM3MzYyNDk2",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/enhancement",
      "name": "enhancement",
      "color": "a2eeef",
      "default": true,
      "description": "New feature or request"
    },
    {
      "id": 1537362500,
      "node_id": "MDU6TGFiZWwxNTM3MzYyNTAw",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/good%20first%20issue",
      "name": "good first issue",
      "color": "7057ff",
      "default": true,
      "description": "Good for newcomers"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-11-28T01:11:48Z",
  "updated_at": "2021-11-09T06:14:32Z",
  "closed_at": "2021-11-09T06:14:32Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "### Description\r\nAs an administrator, I want to be able add bootnodes and dns discovery to the config json files so that all critical chain information can be setup in one file.\r\n\r\nCurrently if you have a custom network with custom bootnodes or DNS discovery you need to add that information to the CLI or the config.toml that proxies the CLI.  This feature would move that into the shared json file so that only node specific information (such as RPC ports) must be configured via CLI.  The cli flags should continue to work as well. \r\n\r\n### Acceptance Criteria\r\nThe new json section should look something like this, or highly similar\r\n\r\n```\r\n{\r\n  \"config\": {\r\n    // ...\r\n    \"discovery\" : {\r\n      \"bootnodes\": [\r\n        \"enode://...@0.1.2.3:4567\",\r\n        \"enode://...@0.1.2.9:8765\"\r\n      ],\r\n      \"dns\": \"enrtree://ABASETHIRTYTWOSTRING@besu.your.corp.net\"\r\n    },\r\n    // ...\r\n  },\r\n  // ...\r\n}\r\n```\r\n\r\n`bootnodes` and `dns` are both optional, which means we may have an empty `discovery` object, which should not produce any errors even if it looks weird.  But if they put anything other than an object in the `discovery` field, such as a string, errors are fine.\r\n\r\n",
  "closed_by": {
    "login": "atoulme",
    "id": 16758,
    "node_id": "MDQ6VXNlcjE2NzU4",
    "avatar_url": "https://avatars.githubusercontent.com/u/16758?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/atoulme",
    "html_url": "https://github.com/atoulme",
    "followers_url": "https://api.github.com/users/atoulme/followers",
    "following_url": "https://api.github.com/users/atoulme/following{/other_user}",
    "gists_url": "https://api.github.com/users/atoulme/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/atoulme/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/atoulme/subscriptions",
    "organizations_url": "https://api.github.com/users/atoulme/orgs",
    "repos_url": "https://api.github.com/users/atoulme/repos",
    "events_url": "https://api.github.com/users/atoulme/events{/privacy}",
    "received_events_url": "https://api.github.com/users/atoulme/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/1632/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/1632/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/740200823",
    "html_url": "https://github.com/hyperledger/besu/issues/1632#issuecomment-740200823",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1632",
    "id": 740200823,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MDIwMDgyMw==",
    "user": {
      "login": "atoulme",
      "id": 16758,
      "node_id": "MDQ6VXNlcjE2NzU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16758?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/atoulme",
      "html_url": "https://github.com/atoulme",
      "followers_url": "https://api.github.com/users/atoulme/followers",
      "following_url": "https://api.github.com/users/atoulme/following{/other_user}",
      "gists_url": "https://api.github.com/users/atoulme/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/atoulme/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/atoulme/subscriptions",
      "organizations_url": "https://api.github.com/users/atoulme/orgs",
      "repos_url": "https://api.github.com/users/atoulme/repos",
      "events_url": "https://api.github.com/users/atoulme/events{/privacy}",
      "received_events_url": "https://api.github.com/users/atoulme/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-07T21:50:09Z",
    "updated_at": "2020-12-07T21:50:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "An important discussion point here is that the EthProtocolManager checks the hash of the genesis file when performing a status exchange, and will disconnect if the genesis hashes don't match (https://github.com/hyperledger/besu/blob/master/ethereum/eth/src/main/java/org/hyperledger/besu/ethereum/eth/manager/EthProtocolManager.java#L332) \r\n\r\nIn effect, it makes it impossible to amend the genesis file after the fact, especially if you need to fix the DNS entry or the bootnodes list.\r\n\r\nDoes it make sense in that case to move this type of config inside genesis? Is there a way to be smart about this?\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/740200823/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/740233016",
    "html_url": "https://github.com/hyperledger/besu/issues/1632#issuecomment-740233016",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1632",
    "id": 740233016,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MDIzMzAxNg==",
    "user": {
      "login": "shemnon",
      "id": 38109,
      "node_id": "MDQ6VXNlcjM4MTA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/38109?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shemnon",
      "html_url": "https://github.com/shemnon",
      "followers_url": "https://api.github.com/users/shemnon/followers",
      "following_url": "https://api.github.com/users/shemnon/following{/other_user}",
      "gists_url": "https://api.github.com/users/shemnon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shemnon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shemnon/subscriptions",
      "organizations_url": "https://api.github.com/users/shemnon/orgs",
      "repos_url": "https://api.github.com/users/shemnon/repos",
      "events_url": "https://api.github.com/users/shemnon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shemnon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-07T23:01:27Z",
    "updated_at": "2020-12-07T23:04:37Z",
    "author_association": "MEMBER",
    "body": "That's the hash of the genesis block.  Which only includes _some_ of the data in the genesis.json file.  None of it is discovery focused.  Basically only stuff that would go into a block header contributes to that hash.  Everything in the `\"config\"` block is not part of the genesis hash, otherwise we would never be able to hard-fork.\r\n\r\nSo adding more data in the config block will not break anything.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/740233016/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/740391674",
    "html_url": "https://github.com/hyperledger/besu/issues/1632#issuecomment-740391674",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1632",
    "id": 740391674,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MDM5MTY3NA==",
    "user": {
      "login": "atoulme",
      "id": 16758,
      "node_id": "MDQ6VXNlcjE2NzU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16758?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/atoulme",
      "html_url": "https://github.com/atoulme",
      "followers_url": "https://api.github.com/users/atoulme/followers",
      "following_url": "https://api.github.com/users/atoulme/following{/other_user}",
      "gists_url": "https://api.github.com/users/atoulme/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/atoulme/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/atoulme/subscriptions",
      "organizations_url": "https://api.github.com/users/atoulme/orgs",
      "repos_url": "https://api.github.com/users/atoulme/repos",
      "events_url": "https://api.github.com/users/atoulme/events{/privacy}",
      "received_events_url": "https://api.github.com/users/atoulme/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-08T05:43:30Z",
    "updated_at": "2020-12-08T05:43:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "D'oh, you're right of course. Would you have CLI and config file take precedence on the genesis configuration?",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/740391674/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/740715519",
    "html_url": "https://github.com/hyperledger/besu/issues/1632#issuecomment-740715519",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/1632",
    "id": 740715519,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MDcxNTUxOQ==",
    "user": {
      "login": "shemnon",
      "id": 38109,
      "node_id": "MDQ6VXNlcjM4MTA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/38109?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shemnon",
      "html_url": "https://github.com/shemnon",
      "followers_url": "https://api.github.com/users/shemnon/followers",
      "following_url": "https://api.github.com/users/shemnon/following{/other_user}",
      "gists_url": "https://api.github.com/users/shemnon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shemnon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shemnon/subscriptions",
      "organizations_url": "https://api.github.com/users/shemnon/orgs",
      "repos_url": "https://api.github.com/users/shemnon/repos",
      "events_url": "https://api.github.com/users/shemnon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shemnon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-08T16:08:22Z",
    "updated_at": "2020-12-08T16:09:20Z",
    "author_association": "MEMBER",
    "body": "yes.  There is precedent for that as \"--override-genesis-config\" can override fork block ids.  CLI is an escape hatch for defaults that need to be overridden, like say if a fork is cancelled on short notice or a discovery DNS goes offline or is no longer being updated, or if the end user wants a custom set of bootnodes because they are behind a firewall and need different boot nodes to bridge.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/740715519/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
