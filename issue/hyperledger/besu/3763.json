{
  "url": "https://api.github.com/repos/hyperledger/besu/issues/3763",
  "repository_url": "https://api.github.com/repos/hyperledger/besu",
  "labels_url": "https://api.github.com/repos/hyperledger/besu/issues/3763/labels{/name}",
  "comments_url": "https://api.github.com/repos/hyperledger/besu/issues/3763/comments",
  "events_url": "https://api.github.com/repos/hyperledger/besu/issues/3763/events",
  "html_url": "https://github.com/hyperledger/besu/issues/3763",
  "id": 1216224045,
  "node_id": "I_kwDODE2jmc5Ifhst",
  "number": 3763,
  "title": "ibft2 ignores --min-gas-price=0",
  "user": {
    "login": "danillosl",
    "id": 7883154,
    "node_id": "MDQ6VXNlcjc4ODMxNTQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7883154?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/danillosl",
    "html_url": "https://github.com/danillosl",
    "followers_url": "https://api.github.com/users/danillosl/followers",
    "following_url": "https://api.github.com/users/danillosl/following{/other_user}",
    "gists_url": "https://api.github.com/users/danillosl/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/danillosl/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/danillosl/subscriptions",
    "organizations_url": "https://api.github.com/users/danillosl/orgs",
    "repos_url": "https://api.github.com/users/danillosl/repos",
    "events_url": "https://api.github.com/users/danillosl/events{/privacy}",
    "received_events_url": "https://api.github.com/users/danillosl/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1921587647,
      "node_id": "MDU6TGFiZWwxOTIxNTg3NjQ3",
      "url": "https://api.github.com/repos/hyperledger/besu/labels/TeamGroot",
      "name": "TeamGroot",
      "color": "1d76db",
      "default": false,
      "description": "GH issues worked on by Groot Team"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "siladu",
    "id": 2893793,
    "node_id": "MDQ6VXNlcjI4OTM3OTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2893793?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/siladu",
    "html_url": "https://github.com/siladu",
    "followers_url": "https://api.github.com/users/siladu/followers",
    "following_url": "https://api.github.com/users/siladu/following{/other_user}",
    "gists_url": "https://api.github.com/users/siladu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/siladu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/siladu/subscriptions",
    "organizations_url": "https://api.github.com/users/siladu/orgs",
    "repos_url": "https://api.github.com/users/siladu/repos",
    "events_url": "https://api.github.com/users/siladu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/siladu/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "siladu",
      "id": 2893793,
      "node_id": "MDQ6VXNlcjI4OTM3OTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2893793?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/siladu",
      "html_url": "https://github.com/siladu",
      "followers_url": "https://api.github.com/users/siladu/followers",
      "following_url": "https://api.github.com/users/siladu/following{/other_user}",
      "gists_url": "https://api.github.com/users/siladu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/siladu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/siladu/subscriptions",
      "organizations_url": "https://api.github.com/users/siladu/orgs",
      "repos_url": "https://api.github.com/users/siladu/repos",
      "events_url": "https://api.github.com/users/siladu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/siladu/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-04-26T16:48:40Z",
  "updated_at": "2022-07-06T07:51:00Z",
  "closed_at": "2022-06-30T05:45:23Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Description\r\nI'm running a 4 nodes ibft2 from the besu website but apparently the network is ignoring the `--min-gas-price=0`, even though the result of `eth_gasPrice` is `{\"jsonrpc\" : \"2.0\", \"id\" : 53, \"result\" : \"0x0\"}` when i try to deploy a contract with truffle i get:\r\n\r\n```\r\n> truffle migrate --reset --network besu\r\n\r\n\r\nCompiling your contracts...\r\n===========================\r\n> Everything is up to date, there is nothing to compile.\r\n\r\n\r\nStarting migrations...\r\n======================\r\n> Network name:    'besu'\r\n> Network id:      1337\r\n> Block gas limit: 9007199254740991 (0x1fffffffffffff)\r\n\r\n\r\n1_initial_migration.js\r\n======================\r\n\r\n   Replacing 'Migrations'\r\n   ----------------------\r\n   > transaction hash:    0x21e0a743a9cc684d9a6b21ad3b9c4d72e83c9e672040f1b1b99727abf1b0e4cb\r\n   > Blocks: 0            Seconds: 0\r\n   > contract address:    0x42699A7612A82f1d9C36148af9C77354759b210b\r\n   > block number:        10\r\n   > block timestamp:     1650988775\r\n   > account:             0xFE3B557E8Fb62b89F4916B721be55cEb828dBd73\r\n   > balance:             199.999438700537858346\r\n   > gas used:            203143 (0x31987)\r\n   > gas price:           2.763075578 gwei\r\n   > value sent:          0 ETH\r\n   > total cost:          0.000561299462141654 ETH\r\n\r\n   > Saving migration to chain.\r\n   > Saving artifacts\r\n   -------------------------------------\r\n   > Total cost:     0.000561299462141654 ETH\r\n\r\n\r\n2_deploy_contracts.js\r\n=====================\r\n\r\n   Replacing 'contractA'\r\n   --------------------------\r\n   > transaction hash:    0x7ae277c256cb64f8e3487868cdc2f9884d3955ee7c3fe5e47193db08d456bb8e\r\n   > Blocks: 0            Seconds: 0\r\n   > contract address:    0x9a3DBCa554e9f6b9257aAa24010DA8377C57c17e\r\n   > block number:        12\r\n   > block timestamp:     1650988779\r\n   > account:             0xFE3B557E8Fb62b89F4916B721be55cEb828dBd73\r\n   > balance:             199.98087195961082743\r\n   > gas used:            6826558 (0x682a3e)\r\n   > gas price:           2.70141724 gwei\r\n   > value sent:          0 ETH\r\n   > total cost:          0.01844138147105992 ETH\r\n\r\n\r\n   Replacing 'contractB'\r\n   -------------------------------\r\n   > transaction hash:    0x930918fb20d3ceadeb67db8c9314772c5ee6847cfbc60fede610ce645898c009\r\n   > Blocks: 0            Seconds: 0\r\n   > contract address:    0x9B8397f1B0FEcD3a1a40CdD5E8221Fa461898517\r\n   > block number:        13\r\n   > block timestamp:     1650988781\r\n   > account:             0xFE3B557E8Fb62b89F4916B721be55cEb828dBd73\r\n   > balance:             199.97611977347131766\r\n   > gas used:            1775695 (0x1b184f)\r\n   > gas price:           2.676240086 gwei\r\n   > value sent:          0 ETH\r\n   > total cost:          0.00475218613950977 ETH\r\n\r\n   > Saving migration to chain.\r\n   > Saving artifacts\r\n   -------------------------------------\r\n   > Total cost:     0.02319356761056969 ETH\r\n\r\nSummary\r\n=======\r\n> Total deployments:   3\r\n> Final cost:          0.023754867072711344 ETH\r\n```\r\n\r\nAnd if a try to deploy with an account that has no funds :\r\n\r\n```\r\nCompiling your contracts...\r\n===========================\r\n> Everything is up to date, there is nothing to compile.\r\n\r\n\r\nStarting migrations...\r\n======================\r\n> Network name:    'besu'\r\n> Network id:      1337\r\n> Block gas limit: 9007199254740991 (0x1fffffffffffff)\r\n\r\n\r\n1_initial_migration.js\r\n======================\r\n\r\n   Replacing 'Migrations'\r\n   ----------------------\r\n *** Deployment Failed ***\r\n\r\n\"Migrations\" -- Upfront cost exceeds account balance.\r\n```\r\n\r\nThe deploy log shows that the gas price is around 2.676240086 gwei even tough all nodes are running with --min-gas-price set to zero.\r\n\r\nHere is all the files needed to recreate the network [ibft2-example.zip](https://github.com/hyperledger/besu/files/8564984/ibft2-example.zip).\r\n\r\n### Acceptance Criteria\r\nGas price be set to zero.\r\n\r\n### Steps to Reproduce\r\n1. Download the ibft2 network example at [ibft2-example.zip](https://github.com/hyperledger/besu/files/8564984/ibft2-example.zip).\r\n2. run each node with the run.sh script inside each node folder.\r\n3. try to deploy a contract.\r\n\r\n**Expected behavior:**\r\nGas price be set to zero.\r\n\r\n**Actual behavior:** [What actually happens]\r\n gas price is around 2.676240086 gwei\r\n\r\n### Versions\r\n* Truffle version: `Truffle v5.5.11 (core: 5.5.11)`\r\n* Software version: `besu/v22.1.3/linux-x86_64/openjdk-java-11`\r\n* Java version: `openjdk version \"11.0.14.1\" 2022-02-08`\r\n* OS Name & Version: `\"Linux Mint\"`,`\"20.2 (Uma)\"` \r\n* Kernel Version: `5.4.0-109-generic`",
  "closed_by": {
    "login": "siladu",
    "id": 2893793,
    "node_id": "MDQ6VXNlcjI4OTM3OTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2893793?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/siladu",
    "html_url": "https://github.com/siladu",
    "followers_url": "https://api.github.com/users/siladu/followers",
    "following_url": "https://api.github.com/users/siladu/following{/other_user}",
    "gists_url": "https://api.github.com/users/siladu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/siladu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/siladu/subscriptions",
    "organizations_url": "https://api.github.com/users/siladu/orgs",
    "repos_url": "https://api.github.com/users/siladu/repos",
    "events_url": "https://api.github.com/users/siladu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/siladu/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/3763/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/hyperledger/besu/issues/3763/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1114988042",
    "html_url": "https://github.com/hyperledger/besu/issues/3763#issuecomment-1114988042",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/3763",
    "id": 1114988042,
    "node_id": "IC_kwDODE2jmc5CdV4K",
    "user": {
      "login": "megatronweb3",
      "id": 102201818,
      "node_id": "U_kgDOBhd52g",
      "avatar_url": "https://avatars.githubusercontent.com/u/102201818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/megatronweb3",
      "html_url": "https://github.com/megatronweb3",
      "followers_url": "https://api.github.com/users/megatronweb3/followers",
      "following_url": "https://api.github.com/users/megatronweb3/following{/other_user}",
      "gists_url": "https://api.github.com/users/megatronweb3/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/megatronweb3/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/megatronweb3/subscriptions",
      "organizations_url": "https://api.github.com/users/megatronweb3/orgs",
      "repos_url": "https://api.github.com/users/megatronweb3/repos",
      "events_url": "https://api.github.com/users/megatronweb3/events{/privacy}",
      "received_events_url": "https://api.github.com/users/megatronweb3/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-02T14:47:10Z",
    "updated_at": "2022-05-02T14:47:10Z",
    "author_association": "NONE",
    "body": "Free gas n/w seem to work for me, all the nodes get stuck with the message - \"No sync target, waiting for peers\"",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1114988042/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1170981718",
    "html_url": "https://github.com/hyperledger/besu/issues/3763#issuecomment-1170981718",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/3763",
    "id": 1170981718,
    "node_id": "IC_kwDODE2jmc5Fy8NW",
    "user": {
      "login": "siladu",
      "id": 2893793,
      "node_id": "MDQ6VXNlcjI4OTM3OTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2893793?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/siladu",
      "html_url": "https://github.com/siladu",
      "followers_url": "https://api.github.com/users/siladu/followers",
      "following_url": "https://api.github.com/users/siladu/following{/other_user}",
      "gists_url": "https://api.github.com/users/siladu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/siladu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/siladu/subscriptions",
      "organizations_url": "https://api.github.com/users/siladu/orgs",
      "repos_url": "https://api.github.com/users/siladu/repos",
      "events_url": "https://api.github.com/users/siladu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/siladu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-30T09:25:29Z",
    "updated_at": "2022-06-30T09:25:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @danillosl I believe this PR should fix this issue: https://github.com/hyperledger/besu/pull/4003\r\n\r\nIt's available on the main branch and hopefully it'll make it into the next release. \r\nIn addition to the code in the PR, you must also include `\"baseFeePerGas\": \"0x0\"` at the top level of the genesis file.\r\nWe will update the documentation to reflect this.\r\n\r\nPlease reopen or create a new issue if the problem persists even with this code.",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1170981718/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1175901014",
    "html_url": "https://github.com/hyperledger/besu/issues/3763#issuecomment-1175901014",
    "issue_url": "https://api.github.com/repos/hyperledger/besu/issues/3763",
    "id": 1175901014,
    "node_id": "IC_kwDODE2jmc5GFtNW",
    "user": {
      "login": "siladu",
      "id": 2893793,
      "node_id": "MDQ6VXNlcjI4OTM3OTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2893793?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/siladu",
      "html_url": "https://github.com/siladu",
      "followers_url": "https://api.github.com/users/siladu/followers",
      "following_url": "https://api.github.com/users/siladu/following{/other_user}",
      "gists_url": "https://api.github.com/users/siladu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/siladu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/siladu/subscriptions",
      "organizations_url": "https://api.github.com/users/siladu/orgs",
      "repos_url": "https://api.github.com/users/siladu/repos",
      "events_url": "https://api.github.com/users/siladu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/siladu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-06T07:51:00Z",
    "updated_at": "2022-07-06T07:51:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "The fix has been released: https://github.com/hyperledger/besu/releases/tag/22.7.0-RC1",
    "reactions": {
      "url": "https://api.github.com/repos/hyperledger/besu/issues/comments/1175901014/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
