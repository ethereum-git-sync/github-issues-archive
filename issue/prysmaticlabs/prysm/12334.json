{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/12334",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/12334/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/12334/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/12334/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/12334",
  "id": 1684135505,
  "node_id": "I_kwDOBvuov85kYd5R",
  "number": 12334,
  "title": "Missing Lots of Sync Committee Duties Until Restarting Prysm",
  "user": {
    "login": "biteric2000",
    "id": 60996182,
    "node_id": "MDQ6VXNlcjYwOTk2MTgy",
    "avatar_url": "https://avatars.githubusercontent.com/u/60996182?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/biteric2000",
    "html_url": "https://github.com/biteric2000",
    "followers_url": "https://api.github.com/users/biteric2000/followers",
    "following_url": "https://api.github.com/users/biteric2000/following{/other_user}",
    "gists_url": "https://api.github.com/users/biteric2000/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/biteric2000/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/biteric2000/subscriptions",
    "organizations_url": "https://api.github.com/users/biteric2000/orgs",
    "repos_url": "https://api.github.com/users/biteric2000/repos",
    "events_url": "https://api.github.com/users/biteric2000/events{/privacy}",
    "received_events_url": "https://api.github.com/users/biteric2000/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 802129904,
      "node_id": "MDU6TGFiZWw4MDIxMjk5MDQ=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Bug",
      "name": "Bug",
      "color": "ee0701",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1966354762,
      "node_id": "MDU6TGFiZWwxOTY2MzU0NzYy",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Need-Info",
      "name": "Need-Info",
      "color": "fbca04",
      "default": false,
      "description": "Need more information from author"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2023-04-26T02:06:21Z",
  "updated_at": "2023-05-24T00:33:27Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "# ðŸž Bug Report\r\n\r\n### Description\r\n\r\nHello Prysm team, my node is missing sync committee duties a lot. \r\nThe problem has persisted for quite some time. The general issue is:\r\n\r\nAttestations and proposals are good.\r\nThe sync committee duties are good for the first several hours and then it will begin to struggle with lots of misses & penalties. \r\nDuring the struggle the peer count and logs are fine.\r\nThe problem will be solved once I restart Prysm client. \r\nBut restarting during sync committee also hurts.\r\n\r\nThis happens every time when my validators enter the sync committee.\r\n\r\nI have found reports by others with same problem:\r\nhttps://www.reddit.com/r/ethstaker/comments/113s1so/every_sync_committee_i_have_to_reboot_prysm_to/\r\nhttps://discord.com/channels/694822223575384095/782670371735732274/937392575294349355\r\n\r\n### Has this worked before in a previous version?\r\nThe problem has lasted for quite long time (at least the recent 3-4 Prysm versions). \r\nI thought it was network issue until I found restarting will almost always help.\r\n\r\n## ðŸŒ  Your Environment\r\n\r\n**Operating System:**\r\nWindows 11\r\n\r\n**What version of Prysm are you running? (Which release)**\r\n4.0.3\r\n\r\n**Hardware Info:**\r\nIntel NUC latest gen i5-1240p 64GB RAM\r\n4TB SSD dedicated for prysm and 8TB SSD for Geth\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/12334/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/12334/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1522723664",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/12334#issuecomment-1522723664",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/12334",
    "id": 1522723664,
    "node_id": "IC_kwDOBvuov85awutQ",
    "user": {
      "login": "biteric2000",
      "id": 60996182,
      "node_id": "MDQ6VXNlcjYwOTk2MTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/60996182?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/biteric2000",
      "html_url": "https://github.com/biteric2000",
      "followers_url": "https://api.github.com/users/biteric2000/followers",
      "following_url": "https://api.github.com/users/biteric2000/following{/other_user}",
      "gists_url": "https://api.github.com/users/biteric2000/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/biteric2000/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/biteric2000/subscriptions",
      "organizations_url": "https://api.github.com/users/biteric2000/orgs",
      "repos_url": "https://api.github.com/users/biteric2000/repos",
      "events_url": "https://api.github.com/users/biteric2000/events{/privacy}",
      "received_events_url": "https://api.github.com/users/biteric2000/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-26T03:30:22Z",
    "updated_at": "2023-04-26T03:30:22Z",
    "author_association": "NONE",
    "body": "Found another post reporting the same issue:\r\nhttps://www.reddit.com/r/ethstaker/comments/z2r7ee/what_explains_sync_penalties_when_the_validator/",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1522723664/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1522735043",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/12334#issuecomment-1522735043",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/12334",
    "id": 1522735043,
    "node_id": "IC_kwDOBvuov85awxfD",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-26T03:49:25Z",
    "updated_at": "2023-04-26T03:50:18Z",
    "author_association": "MEMBER",
    "body": "Possibly the only thing that could explain it is that you do start receiving blocks later or your node becomes stressed during this period. Did you have debug logs enabled during this period ? We haven't seen this on our nodes so far but not ruling anything out yet. \r\n\r\nOne possible thing you could do is run prysm with `--pprof` and then fetch a profile via \r\n```\r\ncurl http://localhost:6060/debug/pprof/profile -o cpu.pprof\r\n```\r\nwhen you see your node's performance deteriorating ",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1522735043/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1522767208",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/12334#issuecomment-1522767208",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/12334",
    "id": 1522767208,
    "node_id": "IC_kwDOBvuov85aw5Vo",
    "user": {
      "login": "biteric2000",
      "id": 60996182,
      "node_id": "MDQ6VXNlcjYwOTk2MTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/60996182?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/biteric2000",
      "html_url": "https://github.com/biteric2000",
      "followers_url": "https://api.github.com/users/biteric2000/followers",
      "following_url": "https://api.github.com/users/biteric2000/following{/other_user}",
      "gists_url": "https://api.github.com/users/biteric2000/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/biteric2000/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/biteric2000/subscriptions",
      "organizations_url": "https://api.github.com/users/biteric2000/orgs",
      "repos_url": "https://api.github.com/users/biteric2000/repos",
      "events_url": "https://api.github.com/users/biteric2000/events{/privacy}",
      "received_events_url": "https://api.github.com/users/biteric2000/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-26T04:33:53Z",
    "updated_at": "2023-04-26T04:33:53Z",
    "author_association": "NONE",
    "body": "> Possibly the only thing that could explain it is that you do start receiving blocks later or your node becomes stressed during this period. Did you have debug logs enabled during this period ? We haven't seen this on our nodes so far but not ruling anything out yet.\r\n> \r\n> One possible thing you could do is run prysm with `--pprof` and then fetch a profile via\r\n> \r\n> ```\r\n> curl http://localhost:6060/debug/pprof/profile -o cpu.pprof\r\n> ```\r\n> \r\n> when you see your node's performance deteriorating\r\n\r\nYes, Prysm was started with --ppof enabled. I'll fetch a profile with the command you suggested.\r\n\r\nIn the mean time, if it is the stressed issue which caused the problem, how can I reduce the resource usage without switch the rig? \r\nThought the hardware configuration should be decent (or even a bit future proof) for running a node.\r\nMaybe by reducing peers, or is there other effective methods?",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1522767208/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1522771794",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/12334#issuecomment-1522771794",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/12334",
    "id": 1522771794,
    "node_id": "IC_kwDOBvuov85aw6dS",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-26T04:41:50Z",
    "updated_at": "2023-04-26T04:41:50Z",
    "author_association": "MEMBER",
    "body": "> In the mean time, if it is the stressed issue which caused the problem, how can I reduce the resource usage without switch the rig?\r\nThought the hardware configuration should be decent (or even a bit future proof) for running a node.\r\n\r\nHonestly, I can't say for sure without more data. We have never seen this issue in our testing, so I am not sure if the node is actually stressed or there is some other issue at play here. Debug logs + a profile would help us investigate this further. You could try to keep your system's clock synced and see if that helps when you start running into this issue as an out of sync clock is the only thing that would explain what you have observed. ",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1522771794/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1522778340",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/12334#issuecomment-1522778340",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/12334",
    "id": 1522778340,
    "node_id": "IC_kwDOBvuov85aw8Dk",
    "user": {
      "login": "biteric2000",
      "id": 60996182,
      "node_id": "MDQ6VXNlcjYwOTk2MTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/60996182?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/biteric2000",
      "html_url": "https://github.com/biteric2000",
      "followers_url": "https://api.github.com/users/biteric2000/followers",
      "following_url": "https://api.github.com/users/biteric2000/following{/other_user}",
      "gists_url": "https://api.github.com/users/biteric2000/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/biteric2000/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/biteric2000/subscriptions",
      "organizations_url": "https://api.github.com/users/biteric2000/orgs",
      "repos_url": "https://api.github.com/users/biteric2000/repos",
      "events_url": "https://api.github.com/users/biteric2000/events{/privacy}",
      "received_events_url": "https://api.github.com/users/biteric2000/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-26T04:52:30Z",
    "updated_at": "2023-04-26T04:52:30Z",
    "author_association": "NONE",
    "body": "Thank you for the reply. I'll try to provide profile and verbose logs on the issue when the situation deteriorate again. Maybe because the validator amount is larger than normal scenarios (or other reasons), the problem is not shown on every configuration. The system is auto-synced with a specific service we installed.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1522778340/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1538215320",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/12334#issuecomment-1538215320",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/12334",
    "id": 1538215320,
    "node_id": "IC_kwDOBvuov85br02Y",
    "user": {
      "login": "biteric2000",
      "id": 60996182,
      "node_id": "MDQ6VXNlcjYwOTk2MTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/60996182?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/biteric2000",
      "html_url": "https://github.com/biteric2000",
      "followers_url": "https://api.github.com/users/biteric2000/followers",
      "following_url": "https://api.github.com/users/biteric2000/following{/other_user}",
      "gists_url": "https://api.github.com/users/biteric2000/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/biteric2000/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/biteric2000/subscriptions",
      "organizations_url": "https://api.github.com/users/biteric2000/orgs",
      "repos_url": "https://api.github.com/users/biteric2000/repos",
      "events_url": "https://api.github.com/users/biteric2000/events{/privacy}",
      "received_events_url": "https://api.github.com/users/biteric2000/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-08T11:36:49Z",
    "updated_at": "2023-05-08T11:36:49Z",
    "author_association": "NONE",
    "body": "> Possibly the only thing that could explain it is that you do start receiving blocks later or your node becomes stressed during this period. Did you have debug logs enabled during this period ? We haven't seen this on our nodes so far but not ruling anything out yet.\r\n> \r\n> One possible thing you could do is run prysm with `--pprof` and then fetch a profile via\r\n> \r\n> ```\r\n> curl http://localhost:6060/debug/pprof/profile -o cpu.pprof\r\n> ```\r\n> \r\n> when you see your node's performance deteriorating\r\n\r\nHello, @nisdas !\r\n\r\nCould you please tell me how to continuously monitor / obtain the cpu.pprof profile? It seems that the gathering of data will be stopped after a short while, like ~30 seconds. \r\n\r\nTherefore it is unlikely to get the info around the right moment when the situation deteriorates. Only the profiles before and after, once I found the problem emerged. (Or maybe that's already enough?)\r\n\r\nThe Prysm node's OS is Windows, and curl is ported from linux (some functions may not be exact the same). \r\n\r\nThanks!",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1538215320/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1560253520",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/12334#issuecomment-1560253520",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/12334",
    "id": 1560253520,
    "node_id": "IC_kwDOBvuov85c_5RQ",
    "user": {
      "login": "Chaz27",
      "id": 3690369,
      "node_id": "MDQ6VXNlcjM2OTAzNjk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3690369?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Chaz27",
      "html_url": "https://github.com/Chaz27",
      "followers_url": "https://api.github.com/users/Chaz27/followers",
      "following_url": "https://api.github.com/users/Chaz27/following{/other_user}",
      "gists_url": "https://api.github.com/users/Chaz27/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Chaz27/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Chaz27/subscriptions",
      "organizations_url": "https://api.github.com/users/Chaz27/orgs",
      "repos_url": "https://api.github.com/users/Chaz27/repos",
      "events_url": "https://api.github.com/users/Chaz27/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Chaz27/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-23T23:28:21Z",
    "updated_at": "2023-05-23T23:28:21Z",
    "author_association": "NONE",
    "body": "I think I'm encountering a similar issue. Attestation performance is usually ~99%, however sync performance is much lower, sometimes less than 90%. Also running on Windows 11.\r\n\r\nWhat I have noticed recently is the cpu usage maxing only 4 logical processors each slot and leaving a lot of cores/processors unused. The node is subscribed to a lot of gossip channels, so maybe that is the issue.\r\n\r\n![image](https://github.com/prysmaticlabs/prysm/assets/3690369/b9544d23-3e08-4f49-95ea-a1c8333fc672)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1560253520/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1560294982",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/12334#issuecomment-1560294982",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/12334",
    "id": 1560294982,
    "node_id": "IC_kwDOBvuov85dADZG",
    "user": {
      "login": "biteric2000",
      "id": 60996182,
      "node_id": "MDQ6VXNlcjYwOTk2MTgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/60996182?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/biteric2000",
      "html_url": "https://github.com/biteric2000",
      "followers_url": "https://api.github.com/users/biteric2000/followers",
      "following_url": "https://api.github.com/users/biteric2000/following{/other_user}",
      "gists_url": "https://api.github.com/users/biteric2000/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/biteric2000/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/biteric2000/subscriptions",
      "organizations_url": "https://api.github.com/users/biteric2000/orgs",
      "repos_url": "https://api.github.com/users/biteric2000/repos",
      "events_url": "https://api.github.com/users/biteric2000/events{/privacy}",
      "received_events_url": "https://api.github.com/users/biteric2000/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-24T00:33:26Z",
    "updated_at": "2023-05-24T00:33:26Z",
    "author_association": "NONE",
    "body": "Yes, the problem still persists. \r\nWhere can I send the logs and profiles? Maybe specify an email address please @nisdas , thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1560294982/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
