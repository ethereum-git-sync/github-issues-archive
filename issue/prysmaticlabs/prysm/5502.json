{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5502",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5502/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5502/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5502/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/5502",
  "id": 602576150,
  "node_id": "MDU6SXNzdWU2MDI1NzYxNTA=",
  "number": 5502,
  "title": "Initial sync in a loop",
  "user": {
    "login": "terencechain",
    "id": 21316537,
    "node_id": "MDQ6VXNlcjIxMzE2NTM3",
    "avatar_url": "https://avatars.githubusercontent.com/u/21316537?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/terencechain",
    "html_url": "https://github.com/terencechain",
    "followers_url": "https://api.github.com/users/terencechain/followers",
    "following_url": "https://api.github.com/users/terencechain/following{/other_user}",
    "gists_url": "https://api.github.com/users/terencechain/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/terencechain/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/terencechain/subscriptions",
    "organizations_url": "https://api.github.com/users/terencechain/orgs",
    "repos_url": "https://api.github.com/users/terencechain/repos",
    "events_url": "https://api.github.com/users/terencechain/events{/privacy}",
    "received_events_url": "https://api.github.com/users/terencechain/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "farazdagi",
    "id": 188194,
    "node_id": "MDQ6VXNlcjE4ODE5NA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/188194?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/farazdagi",
    "html_url": "https://github.com/farazdagi",
    "followers_url": "https://api.github.com/users/farazdagi/followers",
    "following_url": "https://api.github.com/users/farazdagi/following{/other_user}",
    "gists_url": "https://api.github.com/users/farazdagi/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/farazdagi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/farazdagi/subscriptions",
    "organizations_url": "https://api.github.com/users/farazdagi/orgs",
    "repos_url": "https://api.github.com/users/farazdagi/repos",
    "events_url": "https://api.github.com/users/farazdagi/events{/privacy}",
    "received_events_url": "https://api.github.com/users/farazdagi/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "farazdagi",
      "id": 188194,
      "node_id": "MDQ6VXNlcjE4ODE5NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/188194?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/farazdagi",
      "html_url": "https://github.com/farazdagi",
      "followers_url": "https://api.github.com/users/farazdagi/followers",
      "following_url": "https://api.github.com/users/farazdagi/following{/other_user}",
      "gists_url": "https://api.github.com/users/farazdagi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/farazdagi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/farazdagi/subscriptions",
      "organizations_url": "https://api.github.com/users/farazdagi/orgs",
      "repos_url": "https://api.github.com/users/farazdagi/repos",
      "events_url": "https://api.github.com/users/farazdagi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/farazdagi/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2020-04-18T23:37:03Z",
  "updated_at": "2020-04-20T08:34:29Z",
  "closed_at": "2020-04-20T08:34:29Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "See screen shot, initial syncing went from `6917 -> 6887` three times before entering the next phase\r\n\r\n<img width=\"1271\" alt=\"Screen Shot 2020-04-18 at 4 34 57 PM\" src=\"https://user-images.githubusercontent.com/21316537/79673886-b16adb80-8192-11ea-8d80-d31222bda5f0.png\">\r\n",
  "closed_by": {
    "login": "farazdagi",
    "id": 188194,
    "node_id": "MDQ6VXNlcjE4ODE5NA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/188194?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/farazdagi",
    "html_url": "https://github.com/farazdagi",
    "followers_url": "https://api.github.com/users/farazdagi/followers",
    "following_url": "https://api.github.com/users/farazdagi/following{/other_user}",
    "gists_url": "https://api.github.com/users/farazdagi/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/farazdagi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/farazdagi/subscriptions",
    "organizations_url": "https://api.github.com/users/farazdagi/orgs",
    "repos_url": "https://api.github.com/users/farazdagi/repos",
    "events_url": "https://api.github.com/users/farazdagi/events{/privacy}",
    "received_events_url": "https://api.github.com/users/farazdagi/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5502/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5502/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/616232005",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/5502#issuecomment-616232005",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5502",
    "id": 616232005,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNjIzMjAwNQ==",
    "user": {
      "login": "torfbolt",
      "id": 233423,
      "node_id": "MDQ6VXNlcjIzMzQyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/233423?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/torfbolt",
      "html_url": "https://github.com/torfbolt",
      "followers_url": "https://api.github.com/users/torfbolt/followers",
      "following_url": "https://api.github.com/users/torfbolt/following{/other_user}",
      "gists_url": "https://api.github.com/users/torfbolt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/torfbolt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/torfbolt/subscriptions",
      "organizations_url": "https://api.github.com/users/torfbolt/orgs",
      "repos_url": "https://api.github.com/users/torfbolt/repos",
      "events_url": "https://api.github.com/users/torfbolt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/torfbolt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-19T22:00:47Z",
    "updated_at": "2020-04-19T22:00:47Z",
    "author_association": "NONE",
    "body": "I'm pretty sure I've seen this issue already several weeks ago. Unfortunately I didn't file an issue then, but it might be something that already existed before the new init sync code.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/616232005/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/616397152",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/5502#issuecomment-616397152",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5502",
    "id": 616397152,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNjM5NzE1Mg==",
    "user": {
      "login": "farazdagi",
      "id": 188194,
      "node_id": "MDQ6VXNlcjE4ODE5NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/188194?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/farazdagi",
      "html_url": "https://github.com/farazdagi",
      "followers_url": "https://api.github.com/users/farazdagi/followers",
      "following_url": "https://api.github.com/users/farazdagi/following{/other_user}",
      "gists_url": "https://api.github.com/users/farazdagi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/farazdagi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/farazdagi/subscriptions",
      "organizations_url": "https://api.github.com/users/farazdagi/orgs",
      "repos_url": "https://api.github.com/users/farazdagi/repos",
      "events_url": "https://api.github.com/users/farazdagi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/farazdagi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-20T08:34:29Z",
    "updated_at": "2020-04-20T08:34:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "If it doesn't get out of loop - then, it is something unexpected. However, in presence of many skipped blocks, some redundant calls are expected. Here is how it works in `init-sync` state machine:\r\n- blocks are fetched normally, once fetched their parent roots are checked, and blocks are saved\r\n- on skipped and forked slots, system cannot save blocks, but since in specs it is allowed for peer node to return no blocks (that's absence of blocks from peers doesn't mean no blocks exist) and furthermore in presence of evil peers pushing incoherent data, system doesn't know whether the block that can be saved exists **within the range it already fetched or in some future slot**\r\n- when this happens, system will quickly peek the future blocks (moving mostly forward), but constantly and redundantly re-requesting within the existing range as well (so that if some evil peer or peer with missing blocks wasn't providing info, it is obtained now).\r\n- this redundancy tends to increase on many skipped blocks (especially when they are interwoven with many valid blocks) and when we are near the head (as head is constantly moving as well - sync takes time, and by time we are at head we need to re-request to see if chain has progressed)\r\n\r\n@terencechain please let me know if you think that sth else is going on here (or if you've got stuck in that loop forever). Otherwise, it is not a bug, it is how I've implemented `init-sync` to guarantee that if there's at least one healthy peer, sync will progress, even in presence of missing/misleading info from other peers.\r\n\r\n@torfbolt Thank you for that extra information, previously we had the looping you've mentioned indeed (and pretty bad one for that matter - loop that occurred from time to time and is permanent, and the new sync - albeit with above-mentioned redundancy - was created in part to solve that looping prob as well).\r\n\r\nClosing for now, please, feel free to re-open if the explanation above covers the case insufficiently.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/616397152/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
