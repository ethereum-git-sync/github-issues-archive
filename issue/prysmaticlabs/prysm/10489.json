{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/10489",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/10489/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/10489/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/10489/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/10489",
  "id": 1195131259,
  "node_id": "I_kwDOBvuov85HPEF7",
  "number": 10489,
  "title": "Merge test coverage",
  "user": {
    "login": "terencechain",
    "id": 21316537,
    "node_id": "MDQ6VXNlcjIxMzE2NTM3",
    "avatar_url": "https://avatars.githubusercontent.com/u/21316537?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/terencechain",
    "html_url": "https://github.com/terencechain",
    "followers_url": "https://api.github.com/users/terencechain/followers",
    "following_url": "https://api.github.com/users/terencechain/following{/other_user}",
    "gists_url": "https://api.github.com/users/terencechain/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/terencechain/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/terencechain/subscriptions",
    "organizations_url": "https://api.github.com/users/terencechain/orgs",
    "repos_url": "https://api.github.com/users/terencechain/repos",
    "events_url": "https://api.github.com/users/terencechain/events{/privacy}",
    "received_events_url": "https://api.github.com/users/terencechain/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1241586918,
      "node_id": "MDU6TGFiZWwxMjQxNTg2OTE4",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Tracking",
      "name": "Tracking",
      "color": "d0ff7f",
      "default": false,
      "description": "Gotta Catch 'Em All"
    },
    {
      "id": 3533498087,
      "node_id": "LA_kwDOBvuov87SnObn",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Merge",
      "name": "Merge",
      "color": "92E643",
      "default": false,
      "description": "PRs related to the great milestone the merge"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-04-06T20:17:34Z",
  "updated_at": "2023-01-04T16:42:33Z",
  "closed_at": "2023-01-04T16:42:33Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "# Merge test cases\r\n\r\n## Initial Syncing (beacon_blocks_by_range)\r\n- [x] BN(fresh) <-> EE(fresh) can sync to head\r\n- [x] BN(fresh) <-> EE(synced) can sync to head\r\n- [x] BN(close to synced) <->(fresh) can sync to head\r\n- [ ] Validate when EE goes offline, the UX is still smooth\r\n- [ ] Validate when EE times out, the UX is still smooth\r\n- [ ] Validate BN can retrospectively validate terminal block for optimistic syncing\r\n- [ ] Can optimistic sync through very long non-finality durations \r\n\r\n## Regular syncing (gossip-sub)\r\n- [x] Can submit a voluntary exit\r\n- [ ] Can slash someone and be slashed \r\n- [ ] Validate when EE goes offline, the UX is still smooth\r\n- [ ] Validate when EE times out, the UX is still smooth\r\n\r\n## Emergency conditions\r\n- [ ] Gracefully shut down when an invalid block is justified/finalized\r\n- [ ] `--safe-slots-to-import-optimistically` works as expected\r\n- [ ] `TERMINAL_BLOCK_HASH` works as expected\r\n\r\n## Validator\r\n- [x] Duties are prevented under an optimistic mode, ensure smooth UX\r\n- [x] Web3signer works post-merge\r\n- [x] Fee recipient works with BN default\r\n- [x] Fee recipient works with VC default from the config file\r\n- [x] Fee recipient works with VC from local config file \r\n- [x] Fee recipient works with VC from remote URL config file\r\n- [x] Fee recipient works with dynamically updating VC fee recipients\r\n- [ ] Checkpoint sync works past-merge, or when EE is syncing and beacon is optimistic\r\n\r\n## APIs\r\n- [ ] Test all the prysm API endpoints post-Bellatrix\r\n- [ ] Test all the official beacon API endpoints post-Bellatrix\r\n\r\n## Stress\r\n- [ ] Test large blocks\r\n- [ ] Test shorter slot times\r\n\r\n## Performance\r\n- [ ] Validate histogram of response times for the different API methods\r\n- [ ] Validate pprof during various run-time conditions\r\n- [ ] Validate Jaeger in Prysm post-merge when it comes to common, processing operations\r\n- [ ] Validate performance during optimistic sync?\r\n- [ ] Validate disk-size growth for both EL and CL",
  "closed_by": {
    "login": "rauljordan",
    "id": 5572669,
    "node_id": "MDQ6VXNlcjU1NzI2Njk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5572669?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rauljordan",
    "html_url": "https://github.com/rauljordan",
    "followers_url": "https://api.github.com/users/rauljordan/followers",
    "following_url": "https://api.github.com/users/rauljordan/following{/other_user}",
    "gists_url": "https://api.github.com/users/rauljordan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rauljordan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rauljordan/subscriptions",
    "organizations_url": "https://api.github.com/users/rauljordan/orgs",
    "repos_url": "https://api.github.com/users/rauljordan/repos",
    "events_url": "https://api.github.com/users/rauljordan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rauljordan/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/10489/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/10489/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1101914292",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/10489#issuecomment-1101914292",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/10489",
    "id": 1101914292,
    "node_id": "IC_kwDOBvuov85BreC0",
    "user": {
      "login": "SeaMonkey82",
      "id": 20866869,
      "node_id": "MDQ6VXNlcjIwODY2ODY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/20866869?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SeaMonkey82",
      "html_url": "https://github.com/SeaMonkey82",
      "followers_url": "https://api.github.com/users/SeaMonkey82/followers",
      "following_url": "https://api.github.com/users/SeaMonkey82/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeaMonkey82/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SeaMonkey82/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeaMonkey82/subscriptions",
      "organizations_url": "https://api.github.com/users/SeaMonkey82/orgs",
      "repos_url": "https://api.github.com/users/SeaMonkey82/repos",
      "events_url": "https://api.github.com/users/SeaMonkey82/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SeaMonkey82/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-19T01:50:48Z",
    "updated_at": "2022-04-19T01:50:48Z",
    "author_association": "NONE",
    "body": "Some initial thoughts based on testing done so far:\r\n\r\n> # Merge test cases\r\n> ## Initial Syncing (beacon_blocks_by_range)\r\n> \r\n>     * [ ]  BN(fresh) <-> EE(fresh) can sync to head\r\n> \r\n>     * [ ]  BN(fresh) <-> EE(synced) can sync to head\r\n> \r\n>     * [ ]  BN(close to synced) <->(fresh) can sync to head\r\n> \r\n\r\nThese are true for all EL clients except ethereumjs at the moment since it doesn't currently support optimistic sync, so if the CL gets ahead, the only way to get it to sync is to start fresh.  Resuming sync is something that gets tested usually more than once per day, as I'm always checking for the latest commits.  If there are conditions which present potential changes in behavior specifically for a fresh sync, please let me know.\r\n\r\n> ## Regular syncing (gossip-sub)\r\n>     * [ ]  Validate when EE goes offline, the UX is still smooth\r\n> \r\n\r\nThis isn't currently true.   Lots of error noise.\r\n\r\n```\r\n[2022-04-18 21:10:00] ERROR sync: Could not handle p2p pubsub error=Post \"http://localhost:8578\": dial tcp 127.0.0.1:8578: connect: connection refused\r\ngot an unexpected error\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/powchain.handleRPCError\r\n        beacon-chain/powchain/engine_client.go:290\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/powchain.(*Service).NewPayload\r\n        beacon-chain/powchain/engine_client.go:71\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/blockchain.(*Service).notifyNewPayload\r\n        beacon-chain/blockchain/optimistic_sync.go:136\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/blockchain.(*Service).onBlock\r\n        beacon-chain/blockchain/process_block.go:116\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/blockchain.(*Service).ReceiveBlock\r\n        beacon-chain/blockchain/receive_block.go:39\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/sync.(*Service).beaconBlockSubscriber\r\n        beacon-chain/sync/subscriber_beacon_blocks.go:34\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/sync.(*Service).subscribeWithBase.func1\r\n        beacon-chain/sync/subscriber.go:190\r\nruntime.goexit\r\n        GOROOT/src/runtime/asm_amd64.s:1581\r\ncould not validate execution payload from execution engine\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/blockchain.(*Service).notifyNewPayload\r\n        beacon-chain/blockchain/optimistic_sync.go:161\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/blockchain.(*Service).onBlock\r\n        beacon-chain/blockchain/process_block.go:116\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/blockchain.(*Service).ReceiveBlock\r\n        beacon-chain/blockchain/receive_block.go:39\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/sync.(*Service).beaconBlockSubscriber\r\n        beacon-chain/sync/subscriber_beacon_blocks.go:34\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/sync.(*Service).subscribeWithBase.func1\r\n        beacon-chain/sync/subscriber.go:190\r\nruntime.goexit\r\n        GOROOT/src/runtime/asm_amd64.s:1581\r\ncould not verify new payload\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/blockchain.(*Service).onBlock\r\n        beacon-chain/blockchain/process_block.go:118\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/blockchain.(*Service).ReceiveBlock\r\n        beacon-chain/blockchain/receive_block.go:39\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/sync.(*Service).beaconBlockSubscriber\r\n        beacon-chain/sync/subscriber_beacon_blocks.go:34\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/sync.(*Service).subscribeWithBase.func1\r\n        beacon-chain/sync/subscriber.go:190\r\nruntime.goexit\r\n        GOROOT/src/runtime/asm_amd64.s:1581\r\ncould not process block\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/blockchain.(*Service).ReceiveBlock\r\n        beacon-chain/blockchain/receive_block.go:40\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/sync.(*Service).beaconBlockSubscriber\r\n        beacon-chain/sync/subscriber_beacon_blocks.go:34\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/sync.(*Service).subscribeWithBase.func1\r\n        beacon-chain/sync/subscriber.go:190\r\nruntime.goexit\r\n        GOROOT/src/runtime/asm_amd64.s:1581 topic=/eth2/e7acb210/beacon_block/ssz_snappy\r\n```\r\n\r\n> ## Validator\r\n> \r\n>     * [ ]  Duties are prevented under an optimistic mode, ensure smooth UX\r\n> \r\n\r\nThis works fine.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1101914292/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1112694264",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/10489#issuecomment-1112694264",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/10489",
    "id": 1112694264,
    "node_id": "IC_kwDOBvuov85CUl34",
    "user": {
      "login": "SeaMonkey82",
      "id": 20866869,
      "node_id": "MDQ6VXNlcjIwODY2ODY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/20866869?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SeaMonkey82",
      "html_url": "https://github.com/SeaMonkey82",
      "followers_url": "https://api.github.com/users/SeaMonkey82/followers",
      "following_url": "https://api.github.com/users/SeaMonkey82/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeaMonkey82/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SeaMonkey82/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeaMonkey82/subscriptions",
      "organizations_url": "https://api.github.com/users/SeaMonkey82/orgs",
      "repos_url": "https://api.github.com/users/SeaMonkey82/repos",
      "events_url": "https://api.github.com/users/SeaMonkey82/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SeaMonkey82/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-28T22:02:17Z",
    "updated_at": "2022-04-28T22:02:42Z",
    "author_association": "NONE",
    "body": "Some notes on docs:\r\n\r\nhttps://docs.prylabs.network/docs/wallet/nondeterministic\r\nThe \"Import validator accounts\" section of this page is the only one that doesn't include a table of available flags.  `--keys-dir` is given in the example, but `--wallet-dir` is omitted.\r\n\r\nhttps://docs.prylabs.network/docs/how-prysm-works/ethereum-public-api\r\nPage describes versions of the API spec as \"[v1](https://ethereum.github.io/beacon-APIs/?urls.primaryName=v1), [v2.0.0](https://ethereum.github.io/beacon-APIs/) and [dev](https://ethereum.github.io/beacon-APIs/?urls.primaryName=dev)\"\r\nCurrent version of the spec is [v2.2.0](https://ethereum.github.io/beacon-APIs/?urls.primaryName=v2.2.0) and prior version is [v2.1.0](https://ethereum.github.io/beacon-APIs/?urls.primaryName=v2.1.0).",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1112694264/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1114013581",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/10489#issuecomment-1114013581",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/10489",
    "id": 1114013581,
    "node_id": "IC_kwDOBvuov85CZn-N",
    "user": {
      "login": "SeaMonkey82",
      "id": 20866869,
      "node_id": "MDQ6VXNlcjIwODY2ODY5",
      "avatar_url": "https://avatars.githubusercontent.com/u/20866869?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SeaMonkey82",
      "html_url": "https://github.com/SeaMonkey82",
      "followers_url": "https://api.github.com/users/SeaMonkey82/followers",
      "following_url": "https://api.github.com/users/SeaMonkey82/following{/other_user}",
      "gists_url": "https://api.github.com/users/SeaMonkey82/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SeaMonkey82/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SeaMonkey82/subscriptions",
      "organizations_url": "https://api.github.com/users/SeaMonkey82/orgs",
      "repos_url": "https://api.github.com/users/SeaMonkey82/repos",
      "events_url": "https://api.github.com/users/SeaMonkey82/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SeaMonkey82/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-30T16:14:48Z",
    "updated_at": "2022-04-30T16:14:48Z",
    "author_association": "NONE",
    "body": "Submitted a voluntary exit without incident today.\r\n```\r\n      \"index\": \"110393\",\r\n      \"balance\": \"32008291207\",\r\n      \"status\": \"exited_unslashed\",\r\n      \"validator\": {\r\n        \"pubkey\": \"0xb55c538917ac6f096677b794ab52cf4c82c1431771f97693fbff189d7b3ffbaf218174562c8b9aa168ad7ba33df04b7e\",\r\n        \"withdrawal_credentials\": \"0x00fd2d67e5cb6eac9f1019400267ecf9aad4570bec7fd25a130c884922f9621f\",\r\n        \"effective_balance\": \"32000000000\",\r\n        \"slashed\": false,\r\n        \"activation_eligibility_epoch\": \"10932\",\r\n        \"activation_epoch\": \"10938\",\r\n        \"exit_epoch\": \"11265\",\r\n        \"withdrawable_epoch\": \"11521\"\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1114013581/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
