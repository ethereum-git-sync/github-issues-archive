{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8783",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8783/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8783/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8783/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/8783",
  "id": 860137358,
  "node_id": "MDU6SXNzdWU4NjAxMzczNTg=",
  "number": 8783,
  "title": "Unify gRPC Gateways Into Single, Shared Package",
  "user": {
    "login": "rauljordan",
    "id": 5572669,
    "node_id": "MDQ6VXNlcjU1NzI2Njk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5572669?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rauljordan",
    "html_url": "https://github.com/rauljordan",
    "followers_url": "https://api.github.com/users/rauljordan/followers",
    "following_url": "https://api.github.com/users/rauljordan/following{/other_user}",
    "gists_url": "https://api.github.com/users/rauljordan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rauljordan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rauljordan/subscriptions",
    "organizations_url": "https://api.github.com/users/rauljordan/orgs",
    "repos_url": "https://api.github.com/users/rauljordan/repos",
    "events_url": "https://api.github.com/users/rauljordan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rauljordan/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 802129907,
      "node_id": "MDU6TGFiZWw4MDIxMjk5MDc=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Help%20Wanted",
      "name": "Help Wanted",
      "color": "33aa3f",
      "default": false,
      "description": "Extra attention is needed"
    },
    {
      "id": 802129908,
      "node_id": "MDU6TGFiZWw4MDIxMjk5MDg=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Good%20First%20Issue",
      "name": "Good First Issue",
      "color": "7057ff",
      "default": false,
      "description": "Good for newcomers"
    },
    {
      "id": 2185788365,
      "node_id": "MDU6TGFiZWwyMTg1Nzg4MzY1",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Cleanup",
      "name": "Cleanup",
      "color": "9ffce6",
      "default": false,
      "description": "Code health!"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2021-04-16T20:19:43Z",
  "updated_at": "2021-05-04T15:20:58Z",
  "closed_at": "2021-05-04T15:20:58Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "<!--ðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’Ž\r\n\r\nHellooo! ðŸ˜„ \r\n\r\nTo help us tend to your issue faster, please search our currently open issues before submitting a new one.\r\nExisting issues often contain information about workarounds, resolution, or progress updates.\r\n\r\nðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’ŽðŸ’Ž-->\r\n\r\n# ðŸ’Ž Issue\r\n\r\n### Background\r\n\r\nWe have several instaces of gRPC gateways which are essentially duplicated code, all throughout Prysm. We have one in the beacon node, one in the validator, and we should definitely create a shared/gateway package that contains this code in a single place to make it more maintanable.",
  "closed_by": {
    "login": "rkapka",
    "id": 28876818,
    "node_id": "MDQ6VXNlcjI4ODc2ODE4",
    "avatar_url": "https://avatars.githubusercontent.com/u/28876818?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rkapka",
    "html_url": "https://github.com/rkapka",
    "followers_url": "https://api.github.com/users/rkapka/followers",
    "following_url": "https://api.github.com/users/rkapka/following{/other_user}",
    "gists_url": "https://api.github.com/users/rkapka/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rkapka/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rkapka/subscriptions",
    "organizations_url": "https://api.github.com/users/rkapka/orgs",
    "repos_url": "https://api.github.com/users/rkapka/repos",
    "events_url": "https://api.github.com/users/rkapka/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rkapka/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8783/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8783/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/822497756",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/8783#issuecomment-822497756",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8783",
    "id": 822497756,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMjQ5Nzc1Ng==",
    "user": {
      "login": "ahadda5",
      "id": 21275079,
      "node_id": "MDQ6VXNlcjIxMjc1MDc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/21275079?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ahadda5",
      "html_url": "https://github.com/ahadda5",
      "followers_url": "https://api.github.com/users/ahadda5/followers",
      "following_url": "https://api.github.com/users/ahadda5/following{/other_user}",
      "gists_url": "https://api.github.com/users/ahadda5/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ahadda5/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ahadda5/subscriptions",
      "organizations_url": "https://api.github.com/users/ahadda5/orgs",
      "repos_url": "https://api.github.com/users/ahadda5/repos",
      "events_url": "https://api.github.com/users/ahadda5/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ahadda5/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-19T14:10:37Z",
    "updated_at": "2021-04-19T14:12:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "Anyone working on this?   \r\nI see the duplicate code and I have questions: \r\n1)  beacon's code handles dialUnix and  dialTCP.  I guess validator only needs to HTTP-json traffic to the \"local\" beacon node, unlike the beacon which has to connect and thus support any peer out there\r\n2) what is the Swaggerserver which beacon-chain supports and not validator gRPC gateway. \r\n3) What is your take on modularity of functions in terms of files. So cors.go is separate in beacon-chain but in the same file in validator/rpc. Which one is more the style here? \r\n4) There is the main func/server package, part of the beacon gateway, which runs the beacon server itself. That remains untouched obviously. \r\n\r\nIn terms of Strategy to get into a single, shared package\r\nA shared/gateway will be created which will have\r\n\r\n- Gateway struct defined\r\n- New func call\r\n- Start func\r\n- Handlers registration \r\n- Status func\r\n- Stop func\r\n\r\nA new variable will be introduced , mainly caller-type (beacon or validator) to handle divergence in code scenarios mentioned above. \r\nIs that the road plan or am I complicating things? \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/822497756/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/822578463",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/8783#issuecomment-822578463",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8783",
    "id": 822578463,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMjU3ODQ2Mw==",
    "user": {
      "login": "rauljordan",
      "id": 5572669,
      "node_id": "MDQ6VXNlcjU1NzI2Njk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5572669?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rauljordan",
      "html_url": "https://github.com/rauljordan",
      "followers_url": "https://api.github.com/users/rauljordan/followers",
      "following_url": "https://api.github.com/users/rauljordan/following{/other_user}",
      "gists_url": "https://api.github.com/users/rauljordan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rauljordan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rauljordan/subscriptions",
      "organizations_url": "https://api.github.com/users/rauljordan/orgs",
      "repos_url": "https://api.github.com/users/rauljordan/repos",
      "events_url": "https://api.github.com/users/rauljordan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rauljordan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-19T15:53:14Z",
    "updated_at": "2021-04-19T15:53:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @ahadda5 no one is working on this yet. \r\n\r\n1. We should create a general, shared gateway package that can support both\r\n2. The beacon chain RPC is a combination of internal RPC endpoints defined in proto/beacon/rpc/v1 and https://github.com/prysmaticlabs/ethereumapis. The latter has swagger definitions but the former does not. The validator RPC endpoints also do not have swagger definitions\r\n3. It is fine to separate that into files, no preference. It is useful when a file gets way too big and we want to split them up. In general, we should aim to keep files under 200 or 300 loc.\r\n4. No need to differentiate callers if it is a generic, shared package",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/822578463/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/823391583",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/8783#issuecomment-823391583",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8783",
    "id": 823391583,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMzM5MTU4Mw==",
    "user": {
      "login": "ahadda5",
      "id": 21275079,
      "node_id": "MDQ6VXNlcjIxMjc1MDc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/21275079?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ahadda5",
      "html_url": "https://github.com/ahadda5",
      "followers_url": "https://api.github.com/users/ahadda5/followers",
      "following_url": "https://api.github.com/users/ahadda5/following{/other_user}",
      "gists_url": "https://api.github.com/users/ahadda5/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ahadda5/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ahadda5/subscriptions",
      "organizations_url": "https://api.github.com/users/ahadda5/orgs",
      "repos_url": "https://api.github.com/users/ahadda5/repos",
      "events_url": "https://api.github.com/users/ahadda5/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ahadda5/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-20T15:51:22Z",
    "updated_at": "2021-04-21T06:52:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm trying to merge beacon and validator gateways (easier to maintain shared lib) and the  obstacles are: \r\nFirst the beacon gateway uses remoteCerrt, enableDebugRPCEndpoints  and maxCallRecvMsgSize  in its struct. \r\nThose are used by the beacon's gateway inhouse dial function which uses the remoteCert and the  MaxCallRcvmsgSize when calling (google.golang) grpc\r\nThe validator does a direct call to grpc DialOption func with no use of those options. \r\n\r\nSecond, the handlers are different.  Beacon has a beachon-chain handler, health handler etc, while\r\nvalidator has its own Auth, wallet, health account handlers, each requiring its own library . When merging the code, we need some caller distinction or a struct/list of handlers to be registered respectively , otherwise how do you handle this ?",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/823391583/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
