{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8736",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8736/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8736/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8736/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/8736",
  "id": 855134592,
  "node_id": "MDU6SXNzdWU4NTUxMzQ1OTI=",
  "number": 8736,
  "title": "No information shown if trying to import slashing protection after importing validator keys (creating wallet)",
  "user": {
    "login": "unexpectedbit",
    "id": 71844554,
    "node_id": "MDQ6VXNlcjcxODQ0NTU0",
    "avatar_url": "https://avatars.githubusercontent.com/u/71844554?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/unexpectedbit",
    "html_url": "https://github.com/unexpectedbit",
    "followers_url": "https://api.github.com/users/unexpectedbit/followers",
    "following_url": "https://api.github.com/users/unexpectedbit/following{/other_user}",
    "gists_url": "https://api.github.com/users/unexpectedbit/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/unexpectedbit/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/unexpectedbit/subscriptions",
    "organizations_url": "https://api.github.com/users/unexpectedbit/orgs",
    "repos_url": "https://api.github.com/users/unexpectedbit/repos",
    "events_url": "https://api.github.com/users/unexpectedbit/events{/privacy}",
    "received_events_url": "https://api.github.com/users/unexpectedbit/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 802129904,
      "node_id": "MDU6TGFiZWw4MDIxMjk5MDQ=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Bug",
      "name": "Bug",
      "color": "ee0701",
      "default": false,
      "description": "Something isn't working"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-04-10T19:01:33Z",
  "updated_at": "2021-09-08T08:33:30Z",
  "closed_at": "2021-08-11T17:24:25Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!--üíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíé\r\n\r\nHellooo! üòÑ \r\n\r\nTo help us tend to your issue faster, please search our currently open issues before submitting a new one.\r\nExisting issues often contain information about workarounds, resolution, or progress updates.\r\n\r\nüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíé-->\r\n\r\n# üíé Importing slashing protection file fails with no feedback.\r\n\r\nImporting of the slashing protection json file should be possible _before_ running the validator with imported keys for the first time.\r\n\r\n### Background\r\n\r\n<!-- ‚úçÔ∏è--> If the validator.db is missing, importing of the slashing protection json file will fail (only feedback message is \"WARN flags: Running on the Prater Testnet\" or \"WARN flags: Running on ETH2 Mainnet\"). The validator.db file is created only after the validator is run and so it exposes it to publish the attestation for the same block (that is not yet imported via slashing protection file), risking a slashing condition to occur. \r\n\r\n### Description\r\n\r\nCommands to reproduce the issue:\r\n\r\n1. `./prysm.sh validator accounts import --keys-dir=$HOME/eth2deposit/validator_keys --prater`\r\n\r\n2. `./prysm.sh validator slashing-protection import --datadir=/home/user/.eth2validators/prysm-wallet-v2/direct --slashing-protection-json-file=~/prysm/slash/slashing_protection.json`\r\n\r\n    Output:\r\n    Starting Prysm validator slashing-protection import --datadir=/home/user/.eth2validators/prysm-wallet-v2/direct --slashing-protection-json-file=~/prysm/slash/slashing_protection.json\r\n\r\n    Prysmatic Labs Terms of Use\r\n\r\n    By downloading, accessing or using the Prysm implementation (‚ÄúPrysm‚Äù), you (referenced herein\r\nas ‚Äúyou‚Äù or the ‚Äúuser‚Äù) certify that you have read and agreed to the terms and conditions below.\r\n\r\n     TERMS AND CONDITIONS: https://github.com/prysmaticlabs/prysm/blob/master/TERMS_OF_SERVICE.md\r\n\r\n\r\n    Type \"accept\" to accept this terms and conditions [accept/decline]: (default: decline):\r\n    _Accept_\r\n\r\n    WARN flags: Running on ETH2 Mainnet\r\n\r\n3. By now the user doesn't know that the slashing protection has not been imported. Also there is no way to import the slashing protection before running the next command:\r\n   `./prysm.sh validator --prater`\r\n     *Here the possibility for slashing occurs.\r\n\r\n4. `./prysm.sh validator slashing-protection import --datadir=/home/user/.eth2validators/prysm-wallet-v2/direct --slashing-protection-json-file=~/prysm/slash/slashing_protection.json`\r\n\r\n    Output:\r\n    WARN flags: Running on ETH2 Mainnet\r\n    Importing attesting history for validator public keys 100% [==========]  [0s:0s]\r\n    INFO slashingprotection: Slashing protection JSON successfully imported\r\n\r\n    *Only now is the slashing protection file imported.\r\n\r\n",
  "closed_by": {
    "login": "prylabs-bulldozer[bot]",
    "id": 58059840,
    "node_id": "MDM6Qm90NTgwNTk4NDA=",
    "avatar_url": "https://avatars.githubusercontent.com/in/47372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D",
    "html_url": "https://github.com/apps/prylabs-bulldozer",
    "followers_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8736/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8736/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/817672046",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/8736#issuecomment-817672046",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8736",
    "id": 817672046,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNzY3MjA0Ng==",
    "user": {
      "login": "ahadda5",
      "id": 21275079,
      "node_id": "MDQ6VXNlcjIxMjc1MDc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/21275079?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ahadda5",
      "html_url": "https://github.com/ahadda5",
      "followers_url": "https://api.github.com/users/ahadda5/followers",
      "following_url": "https://api.github.com/users/ahadda5/following{/other_user}",
      "gists_url": "https://api.github.com/users/ahadda5/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ahadda5/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ahadda5/subscriptions",
      "organizations_url": "https://api.github.com/users/ahadda5/orgs",
      "repos_url": "https://api.github.com/users/ahadda5/repos",
      "events_url": "https://api.github.com/users/ahadda5/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ahadda5/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-12T09:59:49Z",
    "updated_at": "2021-04-12T09:59:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "Good description, but what you propose is a meaningful feedback if validator.db is not yet created(imported)? ",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/817672046/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/817823406",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/8736#issuecomment-817823406",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8736",
    "id": 817823406,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNzgyMzQwNg==",
    "user": {
      "login": "ahadda5",
      "id": 21275079,
      "node_id": "MDQ6VXNlcjIxMjc1MDc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/21275079?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ahadda5",
      "html_url": "https://github.com/ahadda5",
      "followers_url": "https://api.github.com/users/ahadda5/followers",
      "following_url": "https://api.github.com/users/ahadda5/following{/other_user}",
      "gists_url": "https://api.github.com/users/ahadda5/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ahadda5/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ahadda5/subscriptions",
      "organizations_url": "https://api.github.com/users/ahadda5/orgs",
      "repos_url": "https://api.github.com/users/ahadda5/repos",
      "events_url": "https://api.github.com/users/ahadda5/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ahadda5/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-12T13:43:25Z",
    "updated_at": "2021-04-12T13:43:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "so @unexpectedbit   i created a new account and followed your steps, Unfortunately at the step 2, it passes. It could be because i already had another account, but validator was not running though. \r\nI guess for you , that was a 'clean' machine with no previous wallet/accounts? \r\n\r\n```\r\n>./prysm.sh validator slashing-protection import  --datadir=~/.eth2validators/prysm-wallet-v2/\r\nLatest Prysm version is v1.3.6.\r\nValidator is up to date.\r\nVerifying binary integrity.\r\nvalidator-v1.3.6-linux-amd64: OK\r\ngpg: Signature made 06 ÿ£ÿ®ÿ±, 2021 02:12:38 ÿµ +04\r\ngpg:                using RSA key 0AE0051D647BA3C1A917AF4072E33E4DF1A5036E\r\ngpg: Good signature from \"Preston Van Loon <preston@prysmaticlabs.com>\" [unknown]\r\ngpg: WARNING: This key is not certified with a trusted signature!\r\ngpg:          There is no indication that the signature belongs to the owner.\r\nPrimary key fingerprint: 0AE0 051D 647B A3C1 A917  AF40 72E3 3E4D F1A5 036E\r\nVerified ~/prysm/dist/validator-v1.3.6-linux-amd64 has been signed by Prysmatic Labs.\r\nStarting Prysm validator slashing-protection import --datadir=~/.eth2validators/prysm-wallet-v2/\r\n\r\nPrysmatic Labs Terms of Use\r\n\r\nBy downloading, accessing or using the Prysm implementation (‚ÄúPrysm‚Äù), you (referenced herein\r\nas ‚Äúyou‚Äù or the ‚Äúuser‚Äù) certify that you have read and agreed to the terms and conditions below.\r\n\r\nTERMS AND CONDITIONS: https://github.com/prysmaticlabs/prysm/blob/master/TERMS_OF_SERVICE.md\r\n\r\n\r\nType \"accept\" to accept this terms and conditions [accept/decline]: (default: decline):\r\naccept\r\n[2021-04-12 17:31:36]  WARN flags: Running on ETH2 Mainnet\r\nEnter the the filepath of your EIP-3076 Slashing Protection JSON from your previously used validator client:\r\n~/slashing_protection.json\r\nImporting proposals for validator public key 0xaa7625331276 100% [===========================================]  [0s:0s]\r\nImporting attesting history for validator public keys 100% [=================================================]  [0s:0s]\r\n[2021-04-12 17:32:37]  INFO slashingprotection: Slashing protection JSON successfully imported\r\n\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/817823406/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/821042230",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/8736#issuecomment-821042230",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8736",
    "id": 821042230,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMTA0MjIzMA==",
    "user": {
      "login": "unexpectedbit",
      "id": 71844554,
      "node_id": "MDQ6VXNlcjcxODQ0NTU0",
      "avatar_url": "https://avatars.githubusercontent.com/u/71844554?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/unexpectedbit",
      "html_url": "https://github.com/unexpectedbit",
      "followers_url": "https://api.github.com/users/unexpectedbit/followers",
      "following_url": "https://api.github.com/users/unexpectedbit/following{/other_user}",
      "gists_url": "https://api.github.com/users/unexpectedbit/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/unexpectedbit/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/unexpectedbit/subscriptions",
      "organizations_url": "https://api.github.com/users/unexpectedbit/orgs",
      "repos_url": "https://api.github.com/users/unexpectedbit/repos",
      "events_url": "https://api.github.com/users/unexpectedbit/events{/privacy}",
      "received_events_url": "https://api.github.com/users/unexpectedbit/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-16T09:18:45Z",
    "updated_at": "2021-04-18T18:53:28Z",
    "author_association": "NONE",
    "body": "That is correct - it fails when there is no validator.db file, e.g. on completely new machine, after importing the validator keys. The validator.db file is created only if one runs the validator with imported keys.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/821042230/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/915033289",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/8736#issuecomment-915033289",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8736",
    "id": 915033289,
    "node_id": "IC_kwDOBvuov842ikzJ",
    "user": {
      "login": "aimxhaisse",
      "id": 149659,
      "node_id": "MDQ6VXNlcjE0OTY1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/149659?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aimxhaisse",
      "html_url": "https://github.com/aimxhaisse",
      "followers_url": "https://api.github.com/users/aimxhaisse/followers",
      "following_url": "https://api.github.com/users/aimxhaisse/following{/other_user}",
      "gists_url": "https://api.github.com/users/aimxhaisse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aimxhaisse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aimxhaisse/subscriptions",
      "organizations_url": "https://api.github.com/users/aimxhaisse/orgs",
      "repos_url": "https://api.github.com/users/aimxhaisse/repos",
      "events_url": "https://api.github.com/users/aimxhaisse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aimxhaisse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-08T08:33:30Z",
    "updated_at": "2021-09-08T08:33:30Z",
    "author_association": "NONE",
    "body": "In the meantime (looks like this fix didn't make it in 1.4.4), a possible workaround if you want to import from an empty validator is to create an empty file named validator.db, it considers it as a valid empty database:\r\n\r\n`touch validator.db`\r\n\r\nAnd you can import EIP-3076 files afterwards, before starting the validator.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/915033289/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
