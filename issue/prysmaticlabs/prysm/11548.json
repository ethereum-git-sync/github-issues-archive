{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/11548",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/11548/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/11548/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/11548/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/11548",
  "id": 1401874422,
  "node_id": "I_kwDOBvuov85Tjuf2",
  "number": 11548,
  "title": "Potential block packing weakness in algorithm",
  "user": {
    "login": "mcdee",
    "id": 511384,
    "node_id": "MDQ6VXNlcjUxMTM4NA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/511384?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mcdee",
    "html_url": "https://github.com/mcdee",
    "followers_url": "https://api.github.com/users/mcdee/followers",
    "following_url": "https://api.github.com/users/mcdee/following{/other_user}",
    "gists_url": "https://api.github.com/users/mcdee/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mcdee/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mcdee/subscriptions",
    "organizations_url": "https://api.github.com/users/mcdee/orgs",
    "repos_url": "https://api.github.com/users/mcdee/repos",
    "events_url": "https://api.github.com/users/mcdee/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mcdee/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-10-08T08:42:29Z",
  "updated_at": "2023-08-06T14:32:11Z",
  "closed_at": "2023-08-06T14:32:11Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "# üêû Bug Report\r\n\r\nMainnet block 4864065 was possibly generated by prysm (as per blockprint).  If so, it shows a weakness in prysm's block packing algorithm where it prefers low-value attestations with a lower inclusion distance than high-value attestations with a higher inclusion distance.\r\n\r\n### Description\r\n\r\nBlock 4864064 included no attestations (due to an issue with a different client).  this means that come the time that 4864065's proposal the attestation pool should contain a large number of attestations for both blocks 4864063 and 4864064.  however, looking at the attestations in block 4864065 they are exclusively for block 4864064.  The block packing starts off well, with attestations containing large numbers of highly populated aggregate attestations with the correct votes and inclusion distance of 1, however jumping down to the last attestation in the block it only had 8 votes, 5 of which were duplicates from prior attestations in the same block.  This, and a number of slots above it, would have served better by including one of the highly populated aggregate attestations with distance 2.\r\n\r\n(Note that I am making an assumption here that there were attestations for block 4864063 in the attestation pool at this time, however if not we likely have a bigger problem!  The block was received by nodes around the 2 second mark, so it wasn't delivered late and should have been attested to.  It was also built upon for the block 4864064.  Finally, even if it were received late then the attestation pool should still have had lots of highly populated aggregate attestations with correct source/target that should have been worth more than some of the attestations included in the block.)\r\n\r\n### Has this worked before in a previous version?\r\n\r\nUnknown.  Note that the prysm version here is also unknown, because this was seen on the network but not generated by a specific known node.",
  "closed_by": {
    "login": "terencechain",
    "id": 21316537,
    "node_id": "MDQ6VXNlcjIxMzE2NTM3",
    "avatar_url": "https://avatars.githubusercontent.com/u/21316537?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/terencechain",
    "html_url": "https://github.com/terencechain",
    "followers_url": "https://api.github.com/users/terencechain/followers",
    "following_url": "https://api.github.com/users/terencechain/following{/other_user}",
    "gists_url": "https://api.github.com/users/terencechain/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/terencechain/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/terencechain/subscriptions",
    "organizations_url": "https://api.github.com/users/terencechain/orgs",
    "repos_url": "https://api.github.com/users/terencechain/repos",
    "events_url": "https://api.github.com/users/terencechain/events{/privacy}",
    "received_events_url": "https://api.github.com/users/terencechain/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/11548/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/11548/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1272282995",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/11548#issuecomment-1272282995",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/11548",
    "id": 1272282995,
    "node_id": "IC_kwDOBvuov85L1X9z",
    "user": {
      "login": "potuz",
      "id": 16044918,
      "node_id": "MDQ6VXNlcjE2MDQ0OTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16044918?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/potuz",
      "html_url": "https://github.com/potuz",
      "followers_url": "https://api.github.com/users/potuz/followers",
      "following_url": "https://api.github.com/users/potuz/following{/other_user}",
      "gists_url": "https://api.github.com/users/potuz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/potuz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/potuz/subscriptions",
      "organizations_url": "https://api.github.com/users/potuz/orgs",
      "repos_url": "https://api.github.com/users/potuz/repos",
      "events_url": "https://api.github.com/users/potuz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/potuz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-08T10:04:11Z",
    "updated_at": "2022-10-08T10:04:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "There's a trade-off here in that it's preferable to have attestations with the right target for the current epoch as justification is more important than validator earnings. But it's a great find, we need to discuss the design around this",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1272282995/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1272290386",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/11548#issuecomment-1272290386",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/11548",
    "id": 1272290386,
    "node_id": "IC_kwDOBvuov85L1ZxS",
    "user": {
      "login": "mcdee",
      "id": 511384,
      "node_id": "MDQ6VXNlcjUxMTM4NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/511384?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mcdee",
      "html_url": "https://github.com/mcdee",
      "followers_url": "https://api.github.com/users/mcdee/followers",
      "following_url": "https://api.github.com/users/mcdee/following{/other_user}",
      "gists_url": "https://api.github.com/users/mcdee/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mcdee/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mcdee/subscriptions",
      "organizations_url": "https://api.github.com/users/mcdee/orgs",
      "repos_url": "https://api.github.com/users/mcdee/repos",
      "events_url": "https://api.github.com/users/mcdee/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mcdee/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-08T10:43:29Z",
    "updated_at": "2022-10-08T10:43:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "This may be a larger discussion, then, but in my opinion the rewards for any attestation should be totally aligned with their value to the chain.  If that is not the case then we should revisit the rewards so that they are, otherwise we will end up with a conflict between what is best for the chain Vs .what is best for the proposer (at least in this specific situation).",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1272290386/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1666879836",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/11548#issuecomment-1666879836",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/11548",
    "id": 1666879836,
    "node_id": "IC_kwDOBvuov85jWpFc",
    "user": {
      "login": "terencechain",
      "id": 21316537,
      "node_id": "MDQ6VXNlcjIxMzE2NTM3",
      "avatar_url": "https://avatars.githubusercontent.com/u/21316537?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/terencechain",
      "html_url": "https://github.com/terencechain",
      "followers_url": "https://api.github.com/users/terencechain/followers",
      "following_url": "https://api.github.com/users/terencechain/following{/other_user}",
      "gists_url": "https://api.github.com/users/terencechain/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/terencechain/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/terencechain/subscriptions",
      "organizations_url": "https://api.github.com/users/terencechain/orgs",
      "repos_url": "https://api.github.com/users/terencechain/repos",
      "events_url": "https://api.github.com/users/terencechain/events{/privacy}",
      "received_events_url": "https://api.github.com/users/terencechain/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-06T14:32:11Z",
    "updated_at": "2023-08-06T14:32:11Z",
    "author_association": "MEMBER",
    "body": "I'm going to close this but feel free to open if we need to push it forward ",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1666879836/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
