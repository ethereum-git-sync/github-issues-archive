{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4331",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4331/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4331/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4331/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/4331",
  "id": 540549699,
  "node_id": "MDU6SXNzdWU1NDA1NDk2OTk=",
  "number": 4331,
  "title": "Cannot Start Containers: file permission denied",
  "user": {
    "login": "metanull-operator",
    "id": 54516310,
    "node_id": "MDQ6VXNlcjU0NTE2MzEw",
    "avatar_url": "https://avatars.githubusercontent.com/u/54516310?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/metanull-operator",
    "html_url": "https://github.com/metanull-operator",
    "followers_url": "https://api.github.com/users/metanull-operator/followers",
    "following_url": "https://api.github.com/users/metanull-operator/following{/other_user}",
    "gists_url": "https://api.github.com/users/metanull-operator/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/metanull-operator/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/metanull-operator/subscriptions",
    "organizations_url": "https://api.github.com/users/metanull-operator/orgs",
    "repos_url": "https://api.github.com/users/metanull-operator/repos",
    "events_url": "https://api.github.com/users/metanull-operator/events{/privacy}",
    "received_events_url": "https://api.github.com/users/metanull-operator/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 802129907,
      "node_id": "MDU6TGFiZWw4MDIxMjk5MDc=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Help%20Wanted",
      "name": "Help Wanted",
      "color": "33aa3f",
      "default": false,
      "description": "Extra attention is needed"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2019-12-19T20:36:26Z",
  "updated_at": "2020-01-08T19:53:00Z",
  "closed_at": "2020-01-08T19:53:00Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "I cannot start either the beacon-chain or validator using docker. After trying to get latest earlier today, I got the following errors:\r\n\r\n`[2019-12-19 19:09:06] ERROR main: mkdir /data/beaconchaindata: permission denied`\r\n\r\nand \r\n\r\n`[2019-12-19 20:22:19] ERROR main: could not get private key: open /data/validatorprivatekey82fc5770988d: permission denied`\r\n\r\nI started my beacon-chain with the following command:\r\n\r\n`docker run --user $(id -u):$(id -g) -d --name beacon-chain -t -v $HOME/prysm-data:/data -p 4000:4000 -p 13000:13000 -p 12000:12000 gcr.io/prysmaticlabs/prysm/beacon-chain:latest --datadir=/data --p2p-host-ip XXX.XXX.XXX.XXX --snappy`\r\n\r\nand my validator with:\r\n\r\n`docker run --user $(id -u):$(id -g) --name validator -dt -v $HOME/prysm-docker:/data --network=\"host\" gcr.io/prysmaticlabs/prysm/validator:latest --graffiti=\"metanull (Prysm)\" --beacon-rpc-provider=127.0.0.1:4000 --keystore-path=/data --password=PASSWORD`\r\n\r\nI deleted my ~/prysm-data directory prior to starting the beacon-chain so that I would not have an existing folder with existing permissions. The mkdir command fails with permission denied.\r\n\r\nI believe I even received this error when run as root, which I thought was odd.\r\n\r\nvalidator version Prysm/Git commit: da637668a89ec323ab771665691497eab76e1e91\r\nbeacon-chain version Prysm/Git commit: 20168ad7293ae53315fc09cc88f6b23cba6f3625\r\n\r\n@prestonvanloon confirmed this independently, I believe.\r\n\r\nLet me know what additional information you need.",
  "closed_by": {
    "login": "prylabs-bulldozer[bot]",
    "id": 58059840,
    "node_id": "MDM6Qm90NTgwNTk4NDA=",
    "avatar_url": "https://avatars.githubusercontent.com/in/47372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D",
    "html_url": "https://github.com/apps/prylabs-bulldozer",
    "followers_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4331/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4331/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/567710962",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/4331#issuecomment-567710962",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4331",
    "id": 567710962,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NzcxMDk2Mg==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-19T22:45:25Z",
    "updated_at": "2019-12-19T22:45:25Z",
    "author_association": "MEMBER",
    "body": "This is certainly caused by #4320 where we changed the default docker container user to be uid 1001. This user likely does not have the permissions to write/read in those directories. I recommended setting the docker `--user` flag to be your user ID and group ID which is what $(id -u):($id -g) is doing, but this seems not to work for some users. \r\n\r\nRead more about this feature here: https://docs.docker.com/engine/reference/run/#user\r\n\r\nI do not have a solid fix at this time, but once we find a resolution then we need to update the documentation for running Prysm. We should not have been using the default docker user (root) in the first place so this temporary pain is acceptable trade off for the potential security increase gain from running as a non-privileged user. ",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/567710962/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/567794932",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/4331#issuecomment-567794932",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4331",
    "id": 567794932,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2Nzc5NDkzMg==",
    "user": {
      "login": "metanull-operator",
      "id": 54516310,
      "node_id": "MDQ6VXNlcjU0NTE2MzEw",
      "avatar_url": "https://avatars.githubusercontent.com/u/54516310?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/metanull-operator",
      "html_url": "https://github.com/metanull-operator",
      "followers_url": "https://api.github.com/users/metanull-operator/followers",
      "following_url": "https://api.github.com/users/metanull-operator/following{/other_user}",
      "gists_url": "https://api.github.com/users/metanull-operator/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/metanull-operator/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/metanull-operator/subscriptions",
      "organizations_url": "https://api.github.com/users/metanull-operator/orgs",
      "repos_url": "https://api.github.com/users/metanull-operator/repos",
      "events_url": "https://api.github.com/users/metanull-operator/events{/privacy}",
      "received_events_url": "https://api.github.com/users/metanull-operator/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-20T05:33:47Z",
    "updated_at": "2019-12-20T05:33:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "This may not be a problem with the code. I tried an older build (8701c835e2e6990f6362fc705b8c147ff78e56e629732e134bfefef951aa8e90), from prior to the root user change, and I still get the same error.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/567794932/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/568133914",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/4331#issuecomment-568133914",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4331",
    "id": 568133914,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2ODEzMzkxNA==",
    "user": {
      "login": "torfbolt",
      "id": 233423,
      "node_id": "MDQ6VXNlcjIzMzQyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/233423?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/torfbolt",
      "html_url": "https://github.com/torfbolt",
      "followers_url": "https://api.github.com/users/torfbolt/followers",
      "following_url": "https://api.github.com/users/torfbolt/following{/other_user}",
      "gists_url": "https://api.github.com/users/torfbolt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/torfbolt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/torfbolt/subscriptions",
      "organizations_url": "https://api.github.com/users/torfbolt/orgs",
      "repos_url": "https://api.github.com/users/torfbolt/repos",
      "events_url": "https://api.github.com/users/torfbolt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/torfbolt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-21T00:31:14Z",
    "updated_at": "2019-12-21T00:31:14Z",
    "author_association": "NONE",
    "body": "Had the same problem today, temporary workaround for me was to do a chmod 0777 on the data dir.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/568133914/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/568348683",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/4331#issuecomment-568348683",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4331",
    "id": 568348683,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2ODM0ODY4Mw==",
    "user": {
      "login": "metanull-operator",
      "id": 54516310,
      "node_id": "MDQ6VXNlcjU0NTE2MzEw",
      "avatar_url": "https://avatars.githubusercontent.com/u/54516310?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/metanull-operator",
      "html_url": "https://github.com/metanull-operator",
      "followers_url": "https://api.github.com/users/metanull-operator/followers",
      "following_url": "https://api.github.com/users/metanull-operator/following{/other_user}",
      "gists_url": "https://api.github.com/users/metanull-operator/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/metanull-operator/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/metanull-operator/subscriptions",
      "organizations_url": "https://api.github.com/users/metanull-operator/orgs",
      "repos_url": "https://api.github.com/users/metanull-operator/repos",
      "events_url": "https://api.github.com/users/metanull-operator/events{/privacy}",
      "received_events_url": "https://api.github.com/users/metanull-operator/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-23T04:18:56Z",
    "updated_at": "2019-12-23T04:18:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thank you. That workaround got me back up and running. My own troubleshooting has not resolved this issue yet, but chmod 777 at least stopped the bleeding to penalties. I am tempted to try a clean install of Ubuntu to try again, because I have probably broken my docker installation in other ways in an attempt to fix this/get up and running again. ",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/568348683/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/571820683",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/4331#issuecomment-571820683",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4331",
    "id": 571820683,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTgyMDY4Mw==",
    "user": {
      "login": "ethgasstation",
      "id": 34357853,
      "node_id": "MDQ6VXNlcjM0MzU3ODUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/34357853?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ethgasstation",
      "html_url": "https://github.com/ethgasstation",
      "followers_url": "https://api.github.com/users/ethgasstation/followers",
      "following_url": "https://api.github.com/users/ethgasstation/following{/other_user}",
      "gists_url": "https://api.github.com/users/ethgasstation/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ethgasstation/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ethgasstation/subscriptions",
      "organizations_url": "https://api.github.com/users/ethgasstation/orgs",
      "repos_url": "https://api.github.com/users/ethgasstation/repos",
      "events_url": "https://api.github.com/users/ethgasstation/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ethgasstation/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-07T23:25:10Z",
    "updated_at": "2020-01-07T23:25:10Z",
    "author_association": "NONE",
    "body": "I was unable to create the validator account due to this permission denied problem.   The workaround for me was to use 'docker run --user 0:0 ...' - which runs the container as root\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/571820683/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/572164129",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/4331#issuecomment-572164129",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4331",
    "id": 572164129,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MjE2NDEyOQ==",
    "user": {
      "login": "ethgasstation",
      "id": 34357853,
      "node_id": "MDQ6VXNlcjM0MzU3ODUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/34357853?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ethgasstation",
      "html_url": "https://github.com/ethgasstation",
      "followers_url": "https://api.github.com/users/ethgasstation/followers",
      "following_url": "https://api.github.com/users/ethgasstation/following{/other_user}",
      "gists_url": "https://api.github.com/users/ethgasstation/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ethgasstation/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ethgasstation/subscriptions",
      "organizations_url": "https://api.github.com/users/ethgasstation/orgs",
      "repos_url": "https://api.github.com/users/ethgasstation/repos",
      "events_url": "https://api.github.com/users/ethgasstation/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ethgasstation/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-08T17:05:28Z",
    "updated_at": "2020-01-08T17:05:28Z",
    "author_association": "NONE",
    "body": "FYI- I think you will need to revert #4320 - docker daemon should always run as root.  The only way to get the current version to work on Ubuntu is to use the flag  '--user 0:0'  which essentially reverts #4320 ",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/572164129/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/572212525",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/4331#issuecomment-572212525",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4331",
    "id": 572212525,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MjIxMjUyNQ==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-08T19:09:25Z",
    "updated_at": "2020-01-08T19:09:25Z",
    "author_association": "MEMBER",
    "body": "yeah, let's just revert #4320. It has been causing a lot of issues.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/572212525/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
