{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4815",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4815/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4815/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4815/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/4815",
  "id": 562608254,
  "node_id": "MDU6SXNzdWU1NjI2MDgyNTQ=",
  "number": 4815,
  "title": "Separate Block Fetching from Processing",
  "user": {
    "login": "nisdas",
    "id": 33201827,
    "node_id": "MDQ6VXNlcjMzMjAxODI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nisdas",
    "html_url": "https://github.com/nisdas",
    "followers_url": "https://api.github.com/users/nisdas/followers",
    "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
    "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
    "organizations_url": "https://api.github.com/users/nisdas/orgs",
    "repos_url": "https://api.github.com/users/nisdas/repos",
    "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nisdas/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1500585773,
      "node_id": "MDU6TGFiZWwxNTAwNTg1Nzcz",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Networking",
      "name": "Networking",
      "color": "c7a5f7",
      "default": false,
      "description": "P2P related items"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "farazdagi",
    "id": 188194,
    "node_id": "MDQ6VXNlcjE4ODE5NA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/188194?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/farazdagi",
    "html_url": "https://github.com/farazdagi",
    "followers_url": "https://api.github.com/users/farazdagi/followers",
    "following_url": "https://api.github.com/users/farazdagi/following{/other_user}",
    "gists_url": "https://api.github.com/users/farazdagi/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/farazdagi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/farazdagi/subscriptions",
    "organizations_url": "https://api.github.com/users/farazdagi/orgs",
    "repos_url": "https://api.github.com/users/farazdagi/repos",
    "events_url": "https://api.github.com/users/farazdagi/events{/privacy}",
    "received_events_url": "https://api.github.com/users/farazdagi/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "farazdagi",
      "id": 188194,
      "node_id": "MDQ6VXNlcjE4ODE5NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/188194?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/farazdagi",
      "html_url": "https://github.com/farazdagi",
      "followers_url": "https://api.github.com/users/farazdagi/followers",
      "following_url": "https://api.github.com/users/farazdagi/following{/other_user}",
      "gists_url": "https://api.github.com/users/farazdagi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/farazdagi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/farazdagi/subscriptions",
      "organizations_url": "https://api.github.com/users/farazdagi/orgs",
      "repos_url": "https://api.github.com/users/farazdagi/repos",
      "events_url": "https://api.github.com/users/farazdagi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/farazdagi/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/milestones/8",
    "html_url": "https://github.com/prysmaticlabs/prysm/milestone/8",
    "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/milestones/8/labels",
    "id": 5107261,
    "node_id": "MDk6TWlsZXN0b25lNTEwNzI2MQ==",
    "number": 8,
    "title": "Testnet restart for v0.10.x & v0.11.x",
    "description": "Targeting eth2 spec releases \r\n\r\n[0.11.0](https://github.com/ethereum/eth2.0-specs/releases/tag/v0.11.0)\r\n\r\n[0.10.1](https://github.com/ethereum/eth2.0-specs/releases/tag/v0.10.1)\r\n\r\n[0.10.0](https://github.com/ethereum/eth2.0-specs/releases/tag/v0.10.0)",
    "creator": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 39,
    "state": "closed",
    "created_at": "2020-02-14T19:04:26Z",
    "updated_at": "2020-04-23T18:51:54Z",
    "due_on": "2020-04-06T07:00:00Z",
    "closed_at": "2020-04-13T18:00:54Z"
  },
  "comments": 3,
  "created_at": "2020-02-10T14:44:44Z",
  "updated_at": "2020-03-17T17:27:19Z",
  "closed_at": "2020-03-17T17:27:19Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "In initial sync, currently block downloading and processing are tightly coupled together. However this leads to a penalty in our syncing speeds as we have to wait for other peers to return blocks back before being able to process them.\r\n\r\nWhat we should be able to do is concurrently download blocks and also process them at the same time. What this will accomplish is allow us to seamlessly process one block after the next, while not being hampered by the response speeds of our peers. ",
  "closed_by": {
    "login": "rauljordan",
    "id": 5572669,
    "node_id": "MDQ6VXNlcjU1NzI2Njk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5572669?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rauljordan",
    "html_url": "https://github.com/rauljordan",
    "followers_url": "https://api.github.com/users/rauljordan/followers",
    "following_url": "https://api.github.com/users/rauljordan/following{/other_user}",
    "gists_url": "https://api.github.com/users/rauljordan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rauljordan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rauljordan/subscriptions",
    "organizations_url": "https://api.github.com/users/rauljordan/orgs",
    "repos_url": "https://api.github.com/users/rauljordan/repos",
    "events_url": "https://api.github.com/users/rauljordan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rauljordan/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4815/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4815/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/587280095",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/4815#issuecomment-587280095",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4815",
    "id": 587280095,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4NzI4MDA5NQ==",
    "user": {
      "login": "rauljordan",
      "id": 5572669,
      "node_id": "MDQ6VXNlcjU1NzI2Njk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5572669?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rauljordan",
      "html_url": "https://github.com/rauljordan",
      "followers_url": "https://api.github.com/users/rauljordan/followers",
      "following_url": "https://api.github.com/users/rauljordan/following{/other_user}",
      "gists_url": "https://api.github.com/users/rauljordan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rauljordan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rauljordan/subscriptions",
      "organizations_url": "https://api.github.com/users/rauljordan/orgs",
      "repos_url": "https://api.github.com/users/rauljordan/repos",
      "events_url": "https://api.github.com/users/rauljordan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rauljordan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-18T05:03:12Z",
    "updated_at": "2020-02-18T05:03:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "This code concerns the round robin initial sync process written [here](https://github.com/prysmaticlabs/prysm/blob/40afef8b9e076fed4200f2aaa1cb2ab7c46b5b57/beacon-chain/sync/initial-sync/round_robin.go#L210) which basically requests blocks and then sequentially processes them through the block processing pipeline. This prevents us from requesting more blocks until processing is complete. An approach that is idiomatic with Go would be to use 2 goroutines, one for round robin block download and perhaps another for processing with both communicating via the usage of channels. We can use a buffered channel with a decent size buffer size (depending on how comfortable we are with memory usage) so that block downloading can fill that buffer to the brim while another routine shaves off items from that channel and processes them. This could radically help us stop the \"choppiness\" we see in initial sync regarding block retrieval via p2p and processing.\r\n\r\n@farazdagi please see https://github.com/prysmaticlabs/prysm/issues/4222#issuecomment-587278464 as to guidelines on some basic contributions to tackle this. This could become a multi PR feature so that we can properly review it and add nice tests to ensure all works as expected.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/587280095/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/589915688",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/4815#issuecomment-589915688",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4815",
    "id": 589915688,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4OTkxNTY4OA==",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-22T04:06:05Z",
    "updated_at": "2020-02-22T04:06:05Z",
    "author_association": "MEMBER",
    "body": "This is the current design doc for this issue:\r\nhttps://docs.google.com/document/d/1mm__vLgJfkq25iryIAqWNSgFNfaXqU2tM7P31e8jyf8/edit?usp=sharing",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/589915688/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/590462874",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/4815#issuecomment-590462874",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/4815",
    "id": 590462874,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5MDQ2Mjg3NA==",
    "user": {
      "login": "farazdagi",
      "id": 188194,
      "node_id": "MDQ6VXNlcjE4ODE5NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/188194?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/farazdagi",
      "html_url": "https://github.com/farazdagi",
      "followers_url": "https://api.github.com/users/farazdagi/followers",
      "following_url": "https://api.github.com/users/farazdagi/following{/other_user}",
      "gists_url": "https://api.github.com/users/farazdagi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/farazdagi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/farazdagi/subscriptions",
      "organizations_url": "https://api.github.com/users/farazdagi/orgs",
      "repos_url": "https://api.github.com/users/farazdagi/repos",
      "events_url": "https://api.github.com/users/farazdagi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/farazdagi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-24T17:50:14Z",
    "updated_at": "2020-02-24T17:50:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "note (to myself): when working on block processing it is worth reviewing the #3898",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/590462874/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
