{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/9052",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/9052/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/9052/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/9052/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/9052",
  "id": 922992424,
  "node_id": "MDU6SXNzdWU5MjI5OTI0MjQ=",
  "number": 9052,
  "title": "validator healthz endpoint not working",
  "user": {
    "login": "Belkaar",
    "id": 2395990,
    "node_id": "MDQ6VXNlcjIzOTU5OTA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2395990?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Belkaar",
    "html_url": "https://github.com/Belkaar",
    "followers_url": "https://api.github.com/users/Belkaar/followers",
    "following_url": "https://api.github.com/users/Belkaar/following{/other_user}",
    "gists_url": "https://api.github.com/users/Belkaar/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Belkaar/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Belkaar/subscriptions",
    "organizations_url": "https://api.github.com/users/Belkaar/orgs",
    "repos_url": "https://api.github.com/users/Belkaar/repos",
    "events_url": "https://api.github.com/users/Belkaar/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Belkaar/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "rkapka",
    "id": 28876818,
    "node_id": "MDQ6VXNlcjI4ODc2ODE4",
    "avatar_url": "https://avatars.githubusercontent.com/u/28876818?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rkapka",
    "html_url": "https://github.com/rkapka",
    "followers_url": "https://api.github.com/users/rkapka/followers",
    "following_url": "https://api.github.com/users/rkapka/following{/other_user}",
    "gists_url": "https://api.github.com/users/rkapka/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rkapka/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rkapka/subscriptions",
    "organizations_url": "https://api.github.com/users/rkapka/orgs",
    "repos_url": "https://api.github.com/users/rkapka/repos",
    "events_url": "https://api.github.com/users/rkapka/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rkapka/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "rkapka",
      "id": 28876818,
      "node_id": "MDQ6VXNlcjI4ODc2ODE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/28876818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rkapka",
      "html_url": "https://github.com/rkapka",
      "followers_url": "https://api.github.com/users/rkapka/followers",
      "following_url": "https://api.github.com/users/rkapka/following{/other_user}",
      "gists_url": "https://api.github.com/users/rkapka/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rkapka/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rkapka/subscriptions",
      "organizations_url": "https://api.github.com/users/rkapka/orgs",
      "repos_url": "https://api.github.com/users/rkapka/repos",
      "events_url": "https://api.github.com/users/rkapka/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rkapka/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-06-16T19:11:34Z",
  "updated_at": "2021-06-30T11:40:49Z",
  "closed_at": "2021-06-30T11:40:49Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "\r\n# üêû Bug Report\r\n\r\n### Description\r\ncalling \"curl -s http://localhost:8081/healthz\" returns no data and log contains errors.\r\n\r\n\r\n### Has this worked before in a previous version?\r\n\r\nYes, the previous version in which this bug was not present was: not really sure, but smaller than 1.3.9\r\n\r\n## üî¨ Minimal Reproduction\r\n\r\nstart validator with these params: \r\n`/opt/prysm/validator_active --accept-terms-of-use --attest-timely --graffiti \"XXXXXX\" --datadir /mnt/store_0/validator --wallet-dir /mnt/store_0/validator/wallet --wallet-password-file /mnt/store_0/validator/passwords/wallet.pass --web`\r\n\r\ncall curl -s http://localhost:8081/healthz\r\n\r\n## üî• Error\r\n\r\n<pre><code>\r\nJun 16 21:04:39 eth2 validator_active[14512]: 2021/06/16 21:04:39 http: panic serving 127.0.0.1:40808: runtime error: invalid memory address or nil pointer dereference\r\nJun 16 21:04:39 eth2 validator_active[14512]: goroutine 715 [running]:\r\nJun 16 21:04:39 eth2 validator_active[14512]: net/http.(*conn).serve.func1(0xc001db3720)\r\nJun 16 21:04:39 eth2 validator_active[14512]:         GOROOT/src/net/http/server.go:1824 +0x153\r\nJun 16 21:04:39 eth2 validator_active[14512]: panic(0x10fcaa0, 0x1accf30)\r\nJun 16 21:04:39 eth2 validator_active[14512]:         GOROOT/src/runtime/panic.go:971 +0x499\r\nJun 16 21:04:39 eth2 validator_active[14512]: google.golang.org/grpc.(*ClientConn).GetState(...)\r\nJun 16 21:04:39 eth2 validator_active[14512]:         external/org_golang_google_grpc/clientconn.go:544\r\nJun 16 21:04:39 eth2 validator_active[14512]: github.com/prysmaticlabs/prysm/shared/gateway.(*Gateway).Status(0xc000ae15e0, 0xc001146ff0, 0xc001d99878)\r\nJun 16 21:04:39 eth2 validator_active[14512]:         shared/gateway/gateway.go:202 +0x3a\r\nJun 16 21:04:39 eth2 validator_active[14512]: github.com/prysmaticlabs/prysm/shared.(*ServiceRegistry).Statuses(0xc00111eda0, 0xc001d99928)\r\nJun 16 21:04:39 eth2 validator_active[14512]:         shared/service_registry.go:67 +0xe8\r\nJun 16 21:04:39 eth2 validator_active[14512]: github.com/prysmaticlabs/prysm/shared/prometheus.(*Service).healthzHandler(0xc00111f340, 0x142b4f0, 0xc001f44540, 0xc002000900)\r\nJun 16 21:04:39 eth2 validator_active[14512]:         shared/prometheus/service.go:70 +0x47\r\nJun 16 21:04:39 eth2 validator_active[14512]: net/http.HandlerFunc.ServeHTTP(0xc0011b23d0, 0x142b4f0, 0xc001f44540, 0xc002000900)\r\nJun 16 21:04:39 eth2 validator_active[14512]:         GOROOT/src/net/http/server.go:2069 +0x44\r\nJun 16 21:04:39 eth2 validator_active[14512]: net/http.(*ServeMux).ServeHTTP(0xc00115aa00, 0x142b4f0, 0xc001f44540, 0xc002000900)\r\nJun 16 21:04:39 eth2 validator_active[14512]:         GOROOT/src/net/http/server.go:2448 +0x1ad\r\nJun 16 21:04:39 eth2 validator_active[14512]: net/http.serverHandler.ServeHTTP(0xc0011947e0, 0x142b4f0, 0xc001f44540, 0xc002000900)\r\nJun 16 21:04:39 eth2 validator_active[14512]:         GOROOT/src/net/http/server.go:2887 +0xa3\r\nJun 16 21:04:39 eth2 validator_active[14512]: net/http.(*conn).serve(0xc001db3720, 0x142df38, 0xc001f74540)\r\nJun 16 21:04:39 eth2 validator_active[14512]:         GOROOT/src/net/http/server.go:1952 +0x8cd\r\nJun 16 21:04:39 eth2 validator_active[14512]: created by net/http.(*Server).Serve\r\nJun 16 21:04:39 eth2 validator_active[14512]:         GOROOT/src/net/http/server.go:3013 +0x39b\r\n\r\n</code></pre>\r\n\r\n\r\n## üåç  Your Environment\r\n\r\n**Operating System:**\r\n\r\n<pre>\r\n  <code>\r\nDebian Linux amd64\r\n  </code>\r\n</pre>\r\n\r\n**What version of Prysm are you running? (Which release)**\r\n\r\n<pre>\r\n  <code>\r\n1.3.11 (also happens on 1.3.10 and 1.3.9)\r\n  </code>\r\n</pre>\r\n\r\n**Anything else relevant (validator index / public key)?**\r\n\r\n",
  "closed_by": {
    "login": "rkapka",
    "id": 28876818,
    "node_id": "MDQ6VXNlcjI4ODc2ODE4",
    "avatar_url": "https://avatars.githubusercontent.com/u/28876818?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rkapka",
    "html_url": "https://github.com/rkapka",
    "followers_url": "https://api.github.com/users/rkapka/followers",
    "following_url": "https://api.github.com/users/rkapka/following{/other_user}",
    "gists_url": "https://api.github.com/users/rkapka/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rkapka/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rkapka/subscriptions",
    "organizations_url": "https://api.github.com/users/rkapka/orgs",
    "repos_url": "https://api.github.com/users/rkapka/repos",
    "events_url": "https://api.github.com/users/rkapka/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rkapka/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/9052/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/9052/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/862645334",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/9052#issuecomment-862645334",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/9052",
    "id": 862645334,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MjY0NTMzNA==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-16T19:14:02Z",
    "updated_at": "2021-06-16T19:14:02Z",
    "author_association": "MEMBER",
    "body": "Was your validator connected to a beacon node?",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/862645334/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/862646890",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/9052#issuecomment-862646890",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/9052",
    "id": 862646890,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MjY0Njg5MA==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-16T19:16:37Z",
    "updated_at": "2021-06-16T19:16:37Z",
    "author_association": "MEMBER",
    "body": "@rkapka Looks related to some gateway work. `g.conn` seems that it is not set when calling Status(). Any idea?\r\n\r\nSimple solution is to check that it is not nil.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/862646890/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/862653170",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/9052#issuecomment-862653170",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/9052",
    "id": 862653170,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MjY1MzE3MA==",
    "user": {
      "login": "Belkaar",
      "id": 2395990,
      "node_id": "MDQ6VXNlcjIzOTU5OTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2395990?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Belkaar",
      "html_url": "https://github.com/Belkaar",
      "followers_url": "https://api.github.com/users/Belkaar/followers",
      "following_url": "https://api.github.com/users/Belkaar/following{/other_user}",
      "gists_url": "https://api.github.com/users/Belkaar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Belkaar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Belkaar/subscriptions",
      "organizations_url": "https://api.github.com/users/Belkaar/orgs",
      "repos_url": "https://api.github.com/users/Belkaar/repos",
      "events_url": "https://api.github.com/users/Belkaar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Belkaar/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-16T19:26:48Z",
    "updated_at": "2021-06-16T19:26:48Z",
    "author_association": "NONE",
    "body": "> Was your validator connected to a beacon node?\r\n\r\nYes and correctly attesting",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/862653170/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/871329530",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/9052#issuecomment-871329530",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/9052",
    "id": 871329530,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3MTMyOTUzMA==",
    "user": {
      "login": "rkapka",
      "id": 28876818,
      "node_id": "MDQ6VXNlcjI4ODc2ODE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/28876818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rkapka",
      "html_url": "https://github.com/rkapka",
      "followers_url": "https://api.github.com/users/rkapka/followers",
      "following_url": "https://api.github.com/users/rkapka/following{/other_user}",
      "gists_url": "https://api.github.com/users/rkapka/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rkapka/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rkapka/subscriptions",
      "organizations_url": "https://api.github.com/users/rkapka/orgs",
      "repos_url": "https://api.github.com/users/rkapka/repos",
      "events_url": "https://api.github.com/users/rkapka/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rkapka/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-30T11:40:49Z",
    "updated_at": "2021-06-30T11:40:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "This was fixed in https://github.com/prysmaticlabs/prysm/pull/9050",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/871329530/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
