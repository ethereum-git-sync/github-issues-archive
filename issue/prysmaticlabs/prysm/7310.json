{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7310",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7310/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7310/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7310/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/7310",
  "id": 706638748,
  "node_id": "MDU6SXNzdWU3MDY2Mzg3NDg=",
  "number": 7310,
  "title": "Config file params ignored when running subcommand",
  "user": {
    "login": "bidlocode",
    "id": 12061168,
    "node_id": "MDQ6VXNlcjEyMDYxMTY4",
    "avatar_url": "https://avatars.githubusercontent.com/u/12061168?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bidlocode",
    "html_url": "https://github.com/bidlocode",
    "followers_url": "https://api.github.com/users/bidlocode/followers",
    "following_url": "https://api.github.com/users/bidlocode/following{/other_user}",
    "gists_url": "https://api.github.com/users/bidlocode/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bidlocode/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bidlocode/subscriptions",
    "organizations_url": "https://api.github.com/users/bidlocode/orgs",
    "repos_url": "https://api.github.com/users/bidlocode/repos",
    "events_url": "https://api.github.com/users/bidlocode/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bidlocode/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 802129904,
      "node_id": "MDU6TGFiZWw4MDIxMjk5MDQ=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Bug",
      "name": "Bug",
      "color": "ee0701",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 802129907,
      "node_id": "MDU6TGFiZWw4MDIxMjk5MDc=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Help%20Wanted",
      "name": "Help Wanted",
      "color": "33aa3f",
      "default": false,
      "description": "Extra attention is needed"
    },
    {
      "id": 802129908,
      "node_id": "MDU6TGFiZWw4MDIxMjk5MDg=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Good%20First%20Issue",
      "name": "Good First Issue",
      "color": "7057ff",
      "default": false,
      "description": "Good for newcomers"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2020-09-22T19:32:33Z",
  "updated_at": "2020-11-05T16:49:09Z",
  "closed_at": "2020-10-11T15:27:00Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "üêû Bug Report\r\n\r\n### Description\r\n\r\nConfig file parameters ignored when running subcommand. Config file parameters in question:\r\n<pre>\r\n  <code>\r\nwallet-dir: /data/wallets\r\nwallet-password-file: /data/passwords/wallet-password\r\nkeys-dir: /launchpad/eth2.0-deposit-cli/validator_keys\r\n  </code>\r\n</pre>\r\n\r\n## üî¨ Minimal Reproduction\r\n\r\nEverything works as expected:\r\n<pre>\r\n  <code>\r\n./prysm.sh validator --config-file=/config/validator.yaml\r\n./prysm.sh validator accounts-v2 import --wallet-dir=\"/data/wallets\" --wallet-password-file=\"/data/passwords/wallet-password\" --keys-dir=\"/launchpad/eth2.0-deposit-cli/validator_keys\"\r\n  </code>\r\n</pre>\r\n\r\nBut ignored when:\r\n<pre>\r\n  <code>\r\n./prysm.sh validator --config-file=/config/validator.yaml accounts-v2 import\r\n\r\n#wallet-dir, wallet-password-file from config still ignored\r\n./prysm.sh validator --config-file=/config/validator.yaml accounts-v2 import --keys-dir=\"/launchpad/eth2.0-deposit-cli/validator_keys\"\r\n  </code>\r\n</pre>\r\n\r\n## üåç  Your Environment\r\n\r\n**Operating System:**\r\n\r\n<pre>\r\n  <code>\r\nlinux docker\r\n  </code>\r\n</pre>\r\n\r\n**What version of Prysm are you running? (Which release)**\r\n\r\n<pre>\r\n  <code>\r\nPrysm/v1.0.0-alpha.26/22bcfd2c340a8cb682468e5a7112404aee1e3849. Built at: 2020-09-22 15:28:34+00:00 (docker image)\r\n  </code>\r\n</pre>\r\n",
  "closed_by": {
    "login": "terencechain",
    "id": 21316537,
    "node_id": "MDQ6VXNlcjIxMzE2NTM3",
    "avatar_url": "https://avatars.githubusercontent.com/u/21316537?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/terencechain",
    "html_url": "https://github.com/terencechain",
    "followers_url": "https://api.github.com/users/terencechain/followers",
    "following_url": "https://api.github.com/users/terencechain/following{/other_user}",
    "gists_url": "https://api.github.com/users/terencechain/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/terencechain/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/terencechain/subscriptions",
    "organizations_url": "https://api.github.com/users/terencechain/orgs",
    "repos_url": "https://api.github.com/users/terencechain/repos",
    "events_url": "https://api.github.com/users/terencechain/events{/privacy}",
    "received_events_url": "https://api.github.com/users/terencechain/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7310/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7310/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/700189237",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7310#issuecomment-700189237",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7310",
    "id": 700189237,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMDE4OTIzNw==",
    "user": {
      "login": "bidlocode",
      "id": 12061168,
      "node_id": "MDQ6VXNlcjEyMDYxMTY4",
      "avatar_url": "https://avatars.githubusercontent.com/u/12061168?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bidlocode",
      "html_url": "https://github.com/bidlocode",
      "followers_url": "https://api.github.com/users/bidlocode/followers",
      "following_url": "https://api.github.com/users/bidlocode/following{/other_user}",
      "gists_url": "https://api.github.com/users/bidlocode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bidlocode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bidlocode/subscriptions",
      "organizations_url": "https://api.github.com/users/bidlocode/orgs",
      "repos_url": "https://api.github.com/users/bidlocode/repos",
      "events_url": "https://api.github.com/users/bidlocode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bidlocode/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-28T17:55:37Z",
    "updated_at": "2020-09-28T17:56:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "Looks like the problem is that all flags from config-file get redefined in all subcommands. In this case it happens in `validator/accounts/v2/cmd_accounts.go`\r\n```\t\t\r\n\t\t{\r\n\t\t\tName:        \"import\",\r\n\t\t\tDescription: `imports eth2 validator accounts stored in EIP-2335 keystore.json files from an external directory`,\r\n\t\t\tFlags: []cli.Flag{\r\n\t\t\t\tflags.WalletDirFlag,\r\n\t\t\t\tflags.KeysDirFlag,\r\n\t\t\t\tflags.WalletPasswordFileFlag,\r\n\t\t\t\tflags.AccountPasswordFileFlag,\r\n\t\t\t\tflags.ImportPrivateKeyFileFlag,\r\n\t\t\t\tfeatureconfig.AltonaTestnet,\r\n\t\t\t\tfeatureconfig.OnyxTestnet,\r\n\t\t\t\tfeatureconfig.SpadinaTestnet,\r\n\t\t\t\tflags.DeprecatedPasswordsDirFlag,\r\n\t\t\t},\r\n\t\t\tAction: func(cliCtx *cli.Context) error {\r\n\t\t\t\tfeatureconfig.ConfigureValidator(cliCtx)\r\n\t\t\t\tif err := ImportAccountsCli(cliCtx); err != nil {\r\n\t\t\t\t\tlog.Fatalf(\"Could not import accounts: %v\", err)\r\n\t\t\t\t}\r\n\t\t\t\treturn nil\r\n\t\t\t},\r\n\t\t},\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/700189237/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/700202870",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7310#issuecomment-700202870",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7310",
    "id": 700202870,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMDIwMjg3MA==",
    "user": {
      "login": "dmcclung",
      "id": 35938,
      "node_id": "MDQ6VXNlcjM1OTM4",
      "avatar_url": "https://avatars.githubusercontent.com/u/35938?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dmcclung",
      "html_url": "https://github.com/dmcclung",
      "followers_url": "https://api.github.com/users/dmcclung/followers",
      "following_url": "https://api.github.com/users/dmcclung/following{/other_user}",
      "gists_url": "https://api.github.com/users/dmcclung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dmcclung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dmcclung/subscriptions",
      "organizations_url": "https://api.github.com/users/dmcclung/orgs",
      "repos_url": "https://api.github.com/users/dmcclung/repos",
      "events_url": "https://api.github.com/users/dmcclung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dmcclung/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-28T18:22:07Z",
    "updated_at": "2020-09-28T18:22:07Z",
    "author_association": "NONE",
    "body": "Is there a way to check the cliCtx to see if the configure yaml has already been parsed?",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/700202870/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/700211918",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7310#issuecomment-700211918",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7310",
    "id": 700211918,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMDIxMTkxOA==",
    "user": {
      "login": "bidlocode",
      "id": 12061168,
      "node_id": "MDQ6VXNlcjEyMDYxMTY4",
      "avatar_url": "https://avatars.githubusercontent.com/u/12061168?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bidlocode",
      "html_url": "https://github.com/bidlocode",
      "followers_url": "https://api.github.com/users/bidlocode/followers",
      "following_url": "https://api.github.com/users/bidlocode/following{/other_user}",
      "gists_url": "https://api.github.com/users/bidlocode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bidlocode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bidlocode/subscriptions",
      "organizations_url": "https://api.github.com/users/bidlocode/orgs",
      "repos_url": "https://api.github.com/users/bidlocode/repos",
      "events_url": "https://api.github.com/users/bidlocode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bidlocode/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-28T18:40:42Z",
    "updated_at": "2020-09-28T18:40:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "just by checking the `cmd.ConfigFileFlag` i guess\r\n\r\nconfig-file being parsed every time app initialized in `validator/main.go` (when `cmd.ConfigFileFlag` flag is set) \r\n```\r\n\tapp.Before = func(ctx *cli.Context) error {\r\n\t\tif ctx.IsSet(cmd.ConfigFileFlag.Name) {\r\n\t\t\tif err := altsrc.InitInputSourceWithContext(appFlags, altsrc.NewYamlSourceFromFlagFunc(cmd.ConfigFileFlag.Name))(ctx); err != nil {\r\n\t\t\t\treturn err\r\n\t\t\t}\r\n\t\t}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/700211918/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/700240283",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7310#issuecomment-700240283",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7310",
    "id": 700240283,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMDI0MDI4Mw==",
    "user": {
      "login": "bidlocode",
      "id": 12061168,
      "node_id": "MDQ6VXNlcjEyMDYxMTY4",
      "avatar_url": "https://avatars.githubusercontent.com/u/12061168?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bidlocode",
      "html_url": "https://github.com/bidlocode",
      "followers_url": "https://api.github.com/users/bidlocode/followers",
      "following_url": "https://api.github.com/users/bidlocode/following{/other_user}",
      "gists_url": "https://api.github.com/users/bidlocode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bidlocode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bidlocode/subscriptions",
      "organizations_url": "https://api.github.com/users/bidlocode/orgs",
      "repos_url": "https://api.github.com/users/bidlocode/repos",
      "events_url": "https://api.github.com/users/bidlocode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bidlocode/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-28T19:39:03Z",
    "updated_at": "2020-09-28T20:00:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "possible fix is to leave only subcommand related flags in all subcommand definitions\r\n\r\n```\r\n\t\t\tFlags: []cli.Flag{\r\n\t\t\t\tflags.ImportPrivateKeyFileFlag,\r\n\t\t\t},\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/700240283/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/700303037",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7310#issuecomment-700303037",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7310",
    "id": 700303037,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMDMwMzAzNw==",
    "user": {
      "login": "dmcclung",
      "id": 35938,
      "node_id": "MDQ6VXNlcjM1OTM4",
      "avatar_url": "https://avatars.githubusercontent.com/u/35938?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dmcclung",
      "html_url": "https://github.com/dmcclung",
      "followers_url": "https://api.github.com/users/dmcclung/followers",
      "following_url": "https://api.github.com/users/dmcclung/following{/other_user}",
      "gists_url": "https://api.github.com/users/dmcclung/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dmcclung/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dmcclung/subscriptions",
      "organizations_url": "https://api.github.com/users/dmcclung/orgs",
      "repos_url": "https://api.github.com/users/dmcclung/repos",
      "events_url": "https://api.github.com/users/dmcclung/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dmcclung/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-28T21:53:33Z",
    "updated_at": "2020-09-28T21:53:33Z",
    "author_association": "NONE",
    "body": "The context has a parent context.\r\nhttps://github.com/urfave/cli/blob/master/context.go\r\n\r\nI would debug and see if that parent context is there. I'm guessing that a sub command should have the context of the parent which then should have the flags set. When the validator is configured, it may need to look at the parent context if available.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/700303037/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/702082685",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7310#issuecomment-702082685",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7310",
    "id": 702082685,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMjA4MjY4NQ==",
    "user": {
      "login": "bidlocode",
      "id": 12061168,
      "node_id": "MDQ6VXNlcjEyMDYxMTY4",
      "avatar_url": "https://avatars.githubusercontent.com/u/12061168?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bidlocode",
      "html_url": "https://github.com/bidlocode",
      "followers_url": "https://api.github.com/users/bidlocode/followers",
      "following_url": "https://api.github.com/users/bidlocode/following{/other_user}",
      "gists_url": "https://api.github.com/users/bidlocode/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bidlocode/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bidlocode/subscriptions",
      "organizations_url": "https://api.github.com/users/bidlocode/orgs",
      "repos_url": "https://api.github.com/users/bidlocode/repos",
      "events_url": "https://api.github.com/users/bidlocode/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bidlocode/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-01T11:53:48Z",
    "updated_at": "2020-10-02T19:29:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "If we follow this current concept:\r\n<pre><code>USAGE:\r\n   prysm.sh [options] command [command options] [arguments...]</code></pre>\r\nAs i see it, in subcommand definitions, it should be either:\r\n- only subcommand related flags (so all global flags will be in subcommand context naturally)\r\n\r\nor:\r\n- as it is now, and to check if any not set flag in **currtent ctx** were set in **parent ctx**\r\n\r\nFirst one will require from users correct positional(common, subcommand) usage of the flags\r\nThe last one with redundant flags in every subcommand will be easier on user (and in line with the current docs)\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/702082685/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/722499734",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7310#issuecomment-722499734",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7310",
    "id": 722499734,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyMjQ5OTczNA==",
    "user": {
      "login": "rauljordan",
      "id": 5572669,
      "node_id": "MDQ6VXNlcjU1NzI2Njk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5572669?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rauljordan",
      "html_url": "https://github.com/rauljordan",
      "followers_url": "https://api.github.com/users/rauljordan/followers",
      "following_url": "https://api.github.com/users/rauljordan/following{/other_user}",
      "gists_url": "https://api.github.com/users/rauljordan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rauljordan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rauljordan/subscriptions",
      "organizations_url": "https://api.github.com/users/rauljordan/orgs",
      "repos_url": "https://api.github.com/users/rauljordan/repos",
      "events_url": "https://api.github.com/users/rauljordan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rauljordan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-05T16:49:09Z",
    "updated_at": "2020-11-05T16:49:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "NOTE: Accounts-v2 is deprecated, do not use accounts-v2 in Prysm",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/722499734/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
