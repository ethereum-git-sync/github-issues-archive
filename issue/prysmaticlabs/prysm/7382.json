{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7382",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7382/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7382/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7382/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/7382",
  "id": 711677267,
  "node_id": "MDU6SXNzdWU3MTE2NzcyNjc=",
  "number": 7382,
  "title": "Beaconnode: runtime panic: Index out of bounds",
  "user": {
    "login": "MariusVanDerWijden",
    "id": 16664698,
    "node_id": "MDQ6VXNlcjE2NjY0Njk4",
    "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/MariusVanDerWijden",
    "html_url": "https://github.com/MariusVanDerWijden",
    "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
    "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
    "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
    "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
    "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
    "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
    "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 802129904,
      "node_id": "MDU6TGFiZWw4MDIxMjk5MDQ=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Bug",
      "name": "Bug",
      "color": "ee0701",
      "default": false,
      "description": "Something isn't working"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2020-09-30T06:38:30Z",
  "updated_at": "2020-11-23T08:36:43Z",
  "closed_at": "2020-10-22T17:35:38Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "# üêû Bug Report\r\n\r\n### Description\r\n\r\nRunning the beacon node with `--spadina` fails for me with an index out of bounds.\r\nWhat I did was run it an older version normally with no flags. This synced up the chain properly, then I switched to the newest version and ran `./prysm.sh beacon-chain --http-web3provider=$HOME/.ethereum/goerli/geth.ipc --spadina` which produced the following error: `[2020-09-30 08:27:10] ERROR main: database contract is 0x07b39f4fde4a38bace212b546dac87c58dfe3fdc but tried to run with 0x48b597f4b53c21b48ad95c7256b49d1779bd5890\r\n`\r\nI then tried to delete my beaconchaindata directory. After this I could sync until it failed with an out of bounds.\r\n\r\n### Has this worked before in a previous version?\r\n\r\nYep it worked on the previous release\r\n\r\n## üî¨ Minimal Reproduction\r\n\r\n```\r\n> ./prysm.sh beacon-chain --http-web3provider=$HOME/.ethereum/goerli/geth.ipc\r\nctrl+c\r\n> rm -rf $Home/.eth2/beaconchaindata\r\n> ./prysm.sh beacon-chain --http-web3provider=$HOME/.ethereum/goerli/geth.ipc --spadina\r\n```\r\n\r\n## üî• Error\r\n\r\n<pre><code>\r\n[2020-09-30 08:29:17]  INFO powchain: Minimum number of validators reached for beacon-chain to start ChainStartTime=2020-09-29 14:00:13 +0200 CEST\r\n[2020-09-30 08:29:17]  INFO blockchain: Initialized beacon chain genesis state\r\npanic: runtime error: index out of range [2338] with length 0\r\n\r\ngoroutine 228 [running]:\r\ngithub.com/prysmaticlabs/prysm/proto/beacon/db.(*ChainStartData).MarshalToSizedBuffer(0xc00010f080, 0xc00c2b6000, 0x3c8143, 0x870778, 0x54686, 0x3c8144, 0x0)\r\n\tbazel-out/k8-opt/bin/proto/beacon/db/linux_amd64_stripped/db_go_proto%/github.com/prysmaticlabs/prysm/proto/beacon/db/powchain.pb.go:659 +0x40b\r\ngithub.com/prysmaticlabs/prysm/proto/beacon/db.(*ETH1ChainData).MarshalToSizedBuffer(0xc0026dd8c0, 0xc00c2b6000, 0x870778, 0x870778, 0x101, 0xc002c59358, 0xc002c593d0)\r\n\tbazel-out/k8-opt/bin/proto/beacon/db/linux_amd64_stripped/db_go_proto%/github.com/prysmaticlabs/prysm/proto/beacon/db/powchain.pb.go:558 +0x353\r\ngithub.com/prysmaticlabs/prysm/proto/beacon/db.(*ETH1ChainData).XXX_Marshal(0xc0026dd8c0, 0xc00c2b6000, 0x0, 0x870778, 0xc0026dd800, 0x1, 0x1, 0x1ffffffff, 0x10, 0x10)\r\n\tbazel-out/k8-opt/bin/proto/beacon/db/linux_amd64_stripped/db_go_proto%/github.com/prysmaticlabs/prysm/proto/beacon/db/powchain.pb.go:52 +0x5b\r\ngithub.com/gogo/protobuf/proto.Marshal(0x1cc0f40, 0xc0026dd8c0, 0x8, 0x8, 0xc005518680, 0xc002c594d0, 0x10245e8)\r\n\texternal/com_github_gogo_protobuf/proto/table_marshal.go:2940 +0x2d6\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/db/kv.(*Store).SavePowchainData.func1(0xc0001d4380, 0x1, 0xc0001d4380)\r\n\tbeacon-chain/db/kv/powchain.go:19 +0x86\r\ngo.etcd.io/bbolt.(*DB).Update(0xc0008ae000, 0xc002c595a0, 0x0, 0x0)\r\n\texternal/io_etcd_go_bbolt/db.go:694 +0x8e\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/db/kv.(*Store).SavePowchainData(0xc0008f8480, 0x1cca840, 0xc0004d2700, 0xc0026dd8c0, 0x0, 0x0)\r\n\tbeacon-chain/db/kv/powchain.go:17 +0xd4\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/powchain.(*Service).ProcessLog(0xc000465b00, 0x1cca840, 0xc0004d2700, 0xb4213cb5f497b548, 0x179db456725cd98a, 0x9058bd79, 0xc00715f500, 0x1, 0x4, 0xc005ba9200, ...)\r\n\tbeacon-chain/powchain/log_processing.go:91 +0x53c\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/powchain.(*Service).processPastLogs(0xc000465b00, 0x1cca840, 0xc0004d2700, 0xaf3ac7a77df82f3b, 0xbd3ee82449f92b9)\r\n\tbeacon-chain/powchain/log_processing.go:328 +0x307\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/powchain.(*Service).initPOWService(0xc000465b00)\r\n\tbeacon-chain/powchain/service.go:658 +0x27e\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/powchain.(*Service).run(0xc000465b00, 0xc0001425a0)\r\n\tbeacon-chain/powchain/service.go:673 +0x89\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/powchain.(*Service).Start.func1(0xc000465b00)\r\n\tbeacon-chain/powchain/service.go:244 +0x50\r\ncreated by github.com/prysmaticlabs/prysm/beacon-chain/powchain.(*Service).Start\r\n\tbeacon-chain/powchain/service.go:242 +0x60\r\n\r\n\r\n</code></pre>\r\n\r\n\r\n## üåç  Your Environment\r\n\r\n**Operating System:**\r\n\r\n<pre>\r\n  <code>\r\nlinux\r\n  </code>\r\n</pre>\r\n\r\n**What version of Prysm are you running? (Which release)**\r\n\r\n<pre>\r\n  <code>\r\nnewest: v1.0.0-alpha.27\r\n  </code>\r\n</pre>\r\n\r\n**Anything else relevant (validator index / public key)?**\r\n\r\n",
  "closed_by": {
    "login": "rauljordan",
    "id": 5572669,
    "node_id": "MDQ6VXNlcjU1NzI2Njk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5572669?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rauljordan",
    "html_url": "https://github.com/rauljordan",
    "followers_url": "https://api.github.com/users/rauljordan/followers",
    "following_url": "https://api.github.com/users/rauljordan/following{/other_user}",
    "gists_url": "https://api.github.com/users/rauljordan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rauljordan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rauljordan/subscriptions",
    "organizations_url": "https://api.github.com/users/rauljordan/orgs",
    "repos_url": "https://api.github.com/users/rauljordan/repos",
    "events_url": "https://api.github.com/users/rauljordan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rauljordan/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7382/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7382/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/701191690",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7382#issuecomment-701191690",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7382",
    "id": 701191690,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMTE5MTY5MA==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-30T06:42:09Z",
    "updated_at": "2020-09-30T06:42:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "Purging the Eth2 dir solved the problem \r\n`rm -rf $HOME/.eth2`\r\nBut I think there should be some check that this gracefully exits",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/701191690/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/709452942",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7382#issuecomment-709452942",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7382",
    "id": 709452942,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwOTQ1Mjk0Mg==",
    "user": {
      "login": "0xKiwi",
      "id": 6251510,
      "node_id": "MDQ6VXNlcjYyNTE1MTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6251510?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/0xKiwi",
      "html_url": "https://github.com/0xKiwi",
      "followers_url": "https://api.github.com/users/0xKiwi/followers",
      "following_url": "https://api.github.com/users/0xKiwi/following{/other_user}",
      "gists_url": "https://api.github.com/users/0xKiwi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/0xKiwi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0xKiwi/subscriptions",
      "organizations_url": "https://api.github.com/users/0xKiwi/orgs",
      "repos_url": "https://api.github.com/users/0xKiwi/repos",
      "events_url": "https://api.github.com/users/0xKiwi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/0xKiwi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-15T16:46:51Z",
    "updated_at": "2020-10-15T16:46:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "@prestonvanloon any confirmations if this has been fixed? @MariusVanDerWijden have you encountered the issue again?",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/709452942/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/709518217",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7382#issuecomment-709518217",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7382",
    "id": 709518217,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwOTUxODIxNw==",
    "user": {
      "login": "MariusVanDerWijden",
      "id": 16664698,
      "node_id": "MDQ6VXNlcjE2NjY0Njk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16664698?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MariusVanDerWijden",
      "html_url": "https://github.com/MariusVanDerWijden",
      "followers_url": "https://api.github.com/users/MariusVanDerWijden/followers",
      "following_url": "https://api.github.com/users/MariusVanDerWijden/following{/other_user}",
      "gists_url": "https://api.github.com/users/MariusVanDerWijden/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MariusVanDerWijden/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MariusVanDerWijden/subscriptions",
      "organizations_url": "https://api.github.com/users/MariusVanDerWijden/orgs",
      "repos_url": "https://api.github.com/users/MariusVanDerWijden/repos",
      "events_url": "https://api.github.com/users/MariusVanDerWijden/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MariusVanDerWijden/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-15T18:40:18Z",
    "updated_at": "2020-10-15T18:40:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "I haven't tried, but the repro is pretty easy: init the node with one genesis, kill the node, run with another genesis",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/709518217/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/714649019",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7382#issuecomment-714649019",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7382",
    "id": 714649019,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNDY0OTAxOQ==",
    "user": {
      "login": "rauljordan",
      "id": 5572669,
      "node_id": "MDQ6VXNlcjU1NzI2Njk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5572669?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rauljordan",
      "html_url": "https://github.com/rauljordan",
      "followers_url": "https://api.github.com/users/rauljordan/followers",
      "following_url": "https://api.github.com/users/rauljordan/following{/other_user}",
      "gists_url": "https://api.github.com/users/rauljordan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rauljordan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rauljordan/subscriptions",
      "organizations_url": "https://api.github.com/users/rauljordan/orgs",
      "repos_url": "https://api.github.com/users/rauljordan/repos",
      "events_url": "https://api.github.com/users/rauljordan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rauljordan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-22T17:35:38Z",
    "updated_at": "2020-10-22T17:35:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "No longer possible given we return err if saving a nil eth1 data",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/714649019/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/731084094",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7382#issuecomment-731084094",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7382",
    "id": 731084094,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczMTA4NDA5NA==",
    "user": {
      "login": "jeffprestes",
      "id": 533337,
      "node_id": "MDQ6VXNlcjUzMzMzNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/533337?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jeffprestes",
      "html_url": "https://github.com/jeffprestes",
      "followers_url": "https://api.github.com/users/jeffprestes/followers",
      "following_url": "https://api.github.com/users/jeffprestes/following{/other_user}",
      "gists_url": "https://api.github.com/users/jeffprestes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jeffprestes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jeffprestes/subscriptions",
      "organizations_url": "https://api.github.com/users/jeffprestes/orgs",
      "repos_url": "https://api.github.com/users/jeffprestes/repos",
      "events_url": "https://api.github.com/users/jeffprestes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jeffprestes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-20T10:25:51Z",
    "updated_at": "2020-11-20T10:25:51Z",
    "author_association": "NONE",
    "body": "Got same issue. I did what was suggested by @MariusVanDerWijden and later when I was trying to move to Pyrmont testnet ```/srv/prysm$ ./prysm.sh beacon-chain --pyrmont --http-web3provider=/home/jeffprestes/.ethereum/goerli/geth.ipc ``` \r\nI got this error: ```ERROR main: database contract is 0x00000000219ab540356cbb839cbe05303d7705fa but tried to run with 0x8c5fecdc472e27bc447696f431e425d02dd46a8c``` \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/731084094/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
