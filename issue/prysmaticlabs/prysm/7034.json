{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7034",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7034/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7034/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7034/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/7034",
  "id": 680328593,
  "node_id": "MDU6SXNzdWU2ODAzMjg1OTM=",
  "number": 7034,
  "title": "eth2stats client causing beacon node runtime error when pulling for peers",
  "user": {
    "login": "KevinVitale",
    "id": 276137,
    "node_id": "MDQ6VXNlcjI3NjEzNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/276137?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/KevinVitale",
    "html_url": "https://github.com/KevinVitale",
    "followers_url": "https://api.github.com/users/KevinVitale/followers",
    "following_url": "https://api.github.com/users/KevinVitale/following{/other_user}",
    "gists_url": "https://api.github.com/users/KevinVitale/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/KevinVitale/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/KevinVitale/subscriptions",
    "organizations_url": "https://api.github.com/users/KevinVitale/orgs",
    "repos_url": "https://api.github.com/users/KevinVitale/repos",
    "events_url": "https://api.github.com/users/KevinVitale/events{/privacy}",
    "received_events_url": "https://api.github.com/users/KevinVitale/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2020-08-17T15:36:32Z",
  "updated_at": "2020-08-19T00:49:23Z",
  "closed_at": "2020-08-19T00:49:23Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "# üêû Bug Report\r\n\r\n### Description\r\n\r\n[I opened a ticket](https://github.com/Alethio/eth2stats-client/issues/53) on the _eth2stats_ first, not knowing if this was an issue for Prysm. **Please close it if it's an _eth2stats_ issue**. However, I looked at the logs of my beacon node and noticed the flood of runtime errors in the gRPC call (see below). These were being caused by the _eth2stats_ client trying to pull for peers.\r\n\r\n### Has this worked before in a previous version?\r\n\r\n<!-- Did this behavior use to work in the previous version? -->\r\n<!-- ‚úçÔ∏è--> Yes, the previous version in which this bug was not present was: ....\r\n\r\n## üî¨ Minimal Reproduction\r\n\r\n<!--\r\nPlease let us know how we can reproduce this issue. Include the exact method you used to run Prysm along with any flags used in your beacon chain and/or validator. Make sure you don't upload any confidential files or private keys.\r\n-->\r\n\r\nRun an _eth2stats_ client and connect it to your beacon node.\r\n\r\n## üî• Error\r\n\r\n```\r\nbeacon-chain  | time=\"2020-08-17 15:29:38\" level=error msg=\"gRPC panicked!\" error=\"runtime error: invalid memory address or nil pointer dereference\" stack=\"goroutine 3485295 [running]:\r\nbeacon-chain  | runtime/debug.Stack(0xc0000ea000, 0x5dffe7, 0x5)\r\nbeacon-chain  | \tGOROOT/src/runtime/debug/stack.go:24 +0x9d\r\nbeacon-chain  | github.com/prysmaticlabs/prysm/shared/traceutil.RecoveryHandlerFunc(0x9e60a0, 0xc095262b10, 0x3b4c80, 0x26bd590, 0xc0953a2860, 0xc012118000)\r\nbeacon-chain  | \tshared/traceutil/recovery_interceptor_option.go:29 +0x155\r\nbeacon-chain  | github.com/grpc-ecosystem/go-grpc-middleware/recovery.recoverFrom(0x9e60a0, 0xc095262b10, 0x3b4c80, 0x26bd590, 0x7b2368, 0x7f6cebecaad0, 0x40010000000000)\r\nbeacon-chain  | \texternal/com_github_grpc_ecosystem_go_grpc_middleware/recovery/interceptors.go:53 +0x5a\r\nbeacon-chain  | github.com/grpc-ecosystem/go-grpc-middleware/recovery.UnaryServerInterceptor.func1.1(0x9e60a0, 0xc095262b10, 0xc007cde018, 0xc081e23ab0)\r\nbeacon-chain  | \texternal/com_github_grpc_ecosystem_go_grpc_middleware/recovery/interceptors.go:27 +0x77\r\nbeacon-chain  | panic(0x3b4c80, 0x26bd590)\r\nbeacon-chain  | \tGOROOT/src/runtime/panic.go:969 +0x166\r\nbeacon-chain  | github.com/prysmaticlabs/prysm/beacon-chain/rpc/node.(*Server).ListPeers(0xc007cd8230, 0x9e60a0, 0xc095262ba0, 0xc0492625c0, 0xc007cd8230, 0xc0006484c0, 0x7b3af0)\r\nbeacon-chain  | \tbeacon-chain/rpc/node/server.go:193 +0x325\r\nbeacon-chain  | github.com/prysmaticlabs/ethereumapis/eth/v1alpha1._Node_ListPeers_Handler.func1(0x9e60a0, 0xc095262ba0, 0x56c640, 0xc0492625c0, 0x3b2ee0, 0x284e868, 0x535880, 0x284e320)\r\nbeacon-chain  | \tbazel-out/k8-opt/bin/external/com_github_prysmaticlabs_ethereumapis/eth/v1alpha1/linux_amd64_stripped/go_proto%/github.com/prysmaticlabs/ethereumapis/eth/v1alpha1/node.pb.go:868 +0x86\r\nbeacon-chain  | github.com/prysmaticlabs/prysm/beacon-chain/rpc.(*Service).validatorUnaryConnectionInterceptor(0xc000648280, 0x9e60a0, 0xc095262ba0, 0x56c640, 0xc0492625c0, 0xc0492625e0, 0xc049262600, 0xc095262ba0, 0x9ff6e0, 0x284e320, ...)\r\nbeacon-chain  | \tbeacon-chain/rpc/service.go:400 +0x77\r\nbeacon-chain  | github.com/grpc-ecosystem/go-grpc-middleware.ChainUnaryServer.func1.1.1(0x9e60a0, 0xc095262ba0, 0x56c640, 0xc0492625c0, 0x615a6e, 0x25, 0x9e60a0, 0xc095262ba0)\r\nbeacon-chain  | \texternal/com_github_grpc_ecosystem_go_grpc_middleware/chain.go:25 +0x63\r\nbeacon-chain  | github.com/grpc-ecosystem/go-grpc-middleware/tracing/opentracing.UnaryServerInterceptor.func1(0x9e60a0, 0xc095262b10, 0x56c640, 0xc0492625c0, 0xc0492625e0, 0xc049262620, 0x3, 0x3, 0x9f1e80, 0xc054bfa8a0)\r\nbeacon-chain  | \texternal/com_github_grpc_ecosystem_go_grpc_middleware/tracing/opentracing/server_interceptors.go:31 +0x165\r\nbeacon-chain  | github.com/grpc-ecosystem/go-grpc-middleware.ChainUnaryServer.func1.1.1(0x9e60a0, 0xc095262b10, 0x56c640, 0xc0492625c0, 0x25, 0xc0716fd090, 0xc0570b2120, 0x7f6dc9f88501)\r\nbeacon-chain  | \texternal/com_github_grpc_ecosystem_go_grpc_middleware/chain.go:25 +0x63\r\nbeacon-chain  | github.com/grpc-ecosystem/go-grpc-prometheus.(*ServerMetrics).UnaryServerInterceptor.func1(0x9e60a0, 0xc095262b10, 0x56c640, 0xc0492625c0, 0xc0492625e0, 0xc049262640, 0xc095262a20, 0xc02ff44a68, 0x15d8a96, 0xc049262680)\r\nbeacon-chain  | \texternal/com_github_grpc_ecosystem_go_grpc_prometheus/server_metrics.go:107 +0xad\r\nbeacon-chain  | github.com/grpc-ecosystem/go-grpc-middleware.ChainUnaryServer.func1.1.1(0x9e60a0, 0xc095262b10, 0x56c640, 0xc0492625c0, 0x20, 0xc049262680, 0x203012, 0x203012)\r\nbeacon-chain  | \texternal/com_github_grpc_ecosystem_go_grpc_middleware/chain.go:25 +0x63\r\nbeacon-chain  | github.com/grpc-ecosystem/go-grpc-middleware/recovery.UnaryServerInterceptor.func1(0x9e60a0, 0xc095262b10, 0x56c640, 0xc0492625c0, 0xc0492625e0, 0xc049262660, 0x0, 0x0, 0x0, 0x0)\r\nbeacon-chain  | \texternal/com_github_grpc_ecosystem_go_grpc_middleware/recovery/interceptors.go:31 +0xbc\r\nbeacon-chain  | github.com/grpc-ecosystem/go-grpc-middleware.ChainUnaryServer.func1.1.1(0x9e60a0, 0xc095262b10, 0x56c640, 0xc0492625c0, 0xc0518f1200, 0xc049262580, 0xc02ff44b30, 0x15d9308)\r\nbeacon-chain  | \texternal/com_github_grpc_ecosystem_go_grpc_middleware/chain.go:25 +0x63\r\nbeacon-chain  | github.com/grpc-ecosystem/go-grpc-middleware.ChainUnaryServer.func1(0x9e60a0, 0xc095262b10, 0x56c640, 0xc0492625c0, 0xc0492625e0, 0xc049262600, 0xc02ff44ba0, 0x16f9c08, 0x4cccc0, 0xc095262b10)\r\nbeacon-chain  | \texternal/com_github_grpc_ecosystem_go_grpc_middleware/chain.go:34 +0xd5\r\nbeacon-chain  | github.com/prysmaticlabs/ethereumapis/eth/v1alpha1._Node_ListPeers_Handler(0x49e0e0, 0xc007cd8230, 0x9e60a0, 0xc095262b10, 0xc05575af60, 0xc007cd01b0, 0x9e60a0, 0xc095262b10, 0x0, 0x0)\r\nbeacon-chain  | \tbazel-out/k8-opt/bin/external/com_github_prysmaticlabs_ethereumapis/eth/v1alpha1/linux_amd64_stripped/go_proto%/github.com/prysmaticlabs/ethereumapis/eth/v1alpha1/node.pb.go:870 +0x14b\r\nbeacon-chain  | google.golang.org/grpc.(*Server).processUnaryRPC(0xc007ce4000, 0x9f99e0, 0xc05fd5bc80, 0xc0518f1200, 0xc007cd04e0, 0x26d4ff0, 0x0, 0x0, 0x0)\r\nbeacon-chain  | \texternal/org_golang_google_grpc/server.go:1082 +0x50a\r\nbeacon-chain  | google.golang.org/grpc.(*Server).handleStream(0xc007ce4000, 0x9f99e0, 0xc05fd5bc80, 0xc0518f1200, 0x0)\r\nbeacon-chain  | \texternal/org_golang_google_grpc/server.go:1405 +0xccb\r\nbeacon-chain  | google.golang.org/grpc.(*Server).serveStreams.func1.1(0xc04c05e650, 0xc007ce4000, 0x9f99e0, 0xc05fd5bc80, 0xc0518f1200)\r\nbeacon-chain  | \texternal/org_golang_google_grpc/server.go:746 +0xa1\r\nbeacon-chain  | created by google.golang.org/grpc.(*Server).serveStreams.func1\r\nbeacon-chain  | \texternal/org_golang_google_grpc/server.go:744 +0xa1\r\nbeacon-chain  | \"\r\n```\r\n\r\n## üåç  Your Environment\r\n\r\n**Operating System:**\r\n\r\n<pre>\r\n  <code>\r\n  Ubuntu 18.04 LTS\r\n  </code>\r\n</pre>\r\n\r\n**What version of Prysm are you running? (Which release)**\r\n\r\n<pre>\r\n  <code>\r\n  beacon-chain  | time=\"2020-08-17 13:46:52\" level=info msg=\"Starting beacon node\" prefix=node version=\"Prysm/v1.0.0-alpha.21/f193dc2f54a84ee63b014a1f3ce33c53f29f4aaf. Built at: 2020-08-17 08:49:31+00:00\"\r\n  </code>\r\n</pre>\r\n\r\n**Anything else relevant (validator index / public key)?**\r\n\r\n",
  "closed_by": {
    "login": "KevinVitale",
    "id": 276137,
    "node_id": "MDQ6VXNlcjI3NjEzNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/276137?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/KevinVitale",
    "html_url": "https://github.com/KevinVitale",
    "followers_url": "https://api.github.com/users/KevinVitale/followers",
    "following_url": "https://api.github.com/users/KevinVitale/following{/other_user}",
    "gists_url": "https://api.github.com/users/KevinVitale/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/KevinVitale/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/KevinVitale/subscriptions",
    "organizations_url": "https://api.github.com/users/KevinVitale/orgs",
    "repos_url": "https://api.github.com/users/KevinVitale/repos",
    "events_url": "https://api.github.com/users/KevinVitale/events{/privacy}",
    "received_events_url": "https://api.github.com/users/KevinVitale/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7034/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7034/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/675789069",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7034#issuecomment-675789069",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7034",
    "id": 675789069,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3NTc4OTA2OQ==",
    "user": {
      "login": "KevinVitale",
      "id": 276137,
      "node_id": "MDQ6VXNlcjI3NjEzNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/276137?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/KevinVitale",
      "html_url": "https://github.com/KevinVitale",
      "followers_url": "https://api.github.com/users/KevinVitale/followers",
      "following_url": "https://api.github.com/users/KevinVitale/following{/other_user}",
      "gists_url": "https://api.github.com/users/KevinVitale/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/KevinVitale/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KevinVitale/subscriptions",
      "organizations_url": "https://api.github.com/users/KevinVitale/orgs",
      "repos_url": "https://api.github.com/users/KevinVitale/repos",
      "events_url": "https://api.github.com/users/KevinVitale/events{/privacy}",
      "received_events_url": "https://api.github.com/users/KevinVitale/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-19T00:49:23Z",
    "updated_at": "2020-08-19T00:49:23Z",
    "author_association": "NONE",
    "body": "I retried eth2stats and this no longer seems to be an issue. Closing.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/675789069/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
