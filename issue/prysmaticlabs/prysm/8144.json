{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8144",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8144/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8144/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8144/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/8144",
  "id": 770002920,
  "node_id": "MDU6SXNzdWU3NzAwMDI5MjA=",
  "number": 8144,
  "title": "Discovery on Windows is Broken With Clock Drifts",
  "user": {
    "login": "nisdas",
    "id": 33201827,
    "node_id": "MDQ6VXNlcjMzMjAxODI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nisdas",
    "html_url": "https://github.com/nisdas",
    "followers_url": "https://api.github.com/users/nisdas/followers",
    "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
    "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
    "organizations_url": "https://api.github.com/users/nisdas/orgs",
    "repos_url": "https://api.github.com/users/nisdas/repos",
    "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nisdas/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 802129904,
      "node_id": "MDU6TGFiZWw4MDIxMjk5MDQ=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Bug",
      "name": "Bug",
      "color": "ee0701",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1085357069,
      "node_id": "MDU6TGFiZWwxMDg1MzU3MDY5",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Priority:%20High",
      "name": "Priority: High",
      "color": "f7ea26",
      "default": false,
      "description": "High priority item"
    },
    {
      "id": 1500585773,
      "node_id": "MDU6TGFiZWwxNTAwNTg1Nzcz",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Networking",
      "name": "Networking",
      "color": "c7a5f7",
      "default": false,
      "description": "P2P related items"
    },
    {
      "id": 2587650947,
      "node_id": "MDU6TGFiZWwyNTg3NjUwOTQ3",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Windows",
      "name": "Windows",
      "color": "2fa4ce",
      "default": false,
      "description": "Anything related only to Windows OS"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2020-12-17T13:03:35Z",
  "updated_at": "2021-03-23T11:34:09Z",
  "closed_at": "2021-03-23T11:34:09Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "# üêû Bug Report\r\n\r\n### Description\r\n\r\nCurrently there have been a non trivial amount of users complaining on Windows about their number of peers\r\nslowly reducing to zero. v1.05 has had some important changes with regards to stream management and subnet search. \r\nHowever none of these components should have had any material impact on discovery. Windows machines being more\r\nsusceptible to clock drifts suddenly stop being able to find new peers for some reason, being minutes ahead/behind with respect to the network time should by right not have any effect in finding new peers.\r\n\r\n### Has this worked before in a previous version?\r\n\r\nThis seems to have been introduced in v1.05, previous versions were perfectly fine in regards to discovery.\r\n\r\n## üî¨ Minimal Reproduction\r\n\r\nRun a windows node for a few hours on v1.05\r\n\r\n## üî• Error\r\n\r\nPeer count slowly starts decreasing, and eventually bottoms out at zero.\r\n\r\n\r\n## üåç  Your Environment\r\n\r\n**Operating System:**\r\n\r\nWindows\r\n\r\n**What version of Prysm are you running? (Which release)**\r\n\r\nv1.05\r\n\r\n",
  "closed_by": {
    "login": "nisdas",
    "id": 33201827,
    "node_id": "MDQ6VXNlcjMzMjAxODI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nisdas",
    "html_url": "https://github.com/nisdas",
    "followers_url": "https://api.github.com/users/nisdas/followers",
    "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
    "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
    "organizations_url": "https://api.github.com/users/nisdas/orgs",
    "repos_url": "https://api.github.com/users/nisdas/repos",
    "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nisdas/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8144/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8144/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/753716363",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/8144#issuecomment-753716363",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8144",
    "id": 753716363,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1MzcxNjM2Mw==",
    "user": {
      "login": "yv989c",
      "id": 3805212,
      "node_id": "MDQ6VXNlcjM4MDUyMTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3805212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yv989c",
      "html_url": "https://github.com/yv989c",
      "followers_url": "https://api.github.com/users/yv989c/followers",
      "following_url": "https://api.github.com/users/yv989c/following{/other_user}",
      "gists_url": "https://api.github.com/users/yv989c/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yv989c/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yv989c/subscriptions",
      "organizations_url": "https://api.github.com/users/yv989c/orgs",
      "repos_url": "https://api.github.com/users/yv989c/repos",
      "events_url": "https://api.github.com/users/yv989c/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yv989c/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-04T01:44:21Z",
    "updated_at": "2021-01-04T01:44:21Z",
    "author_association": "NONE",
    "body": "I haven't experienced this yet as a Windows user running a beacon node for over 15 days now. I turned on the option that keeps the system clock in sync using NTP. I'm limiting my peers to 5 via `p2p-max-peers` in case this is relevant.\r\n`Beacon node: v1.0.5`\r\n`OS: Windows 10 Pro (2004)`",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/753716363/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/753790989",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/8144#issuecomment-753790989",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8144",
    "id": 753790989,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1Mzc5MDk4OQ==",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-04T06:46:16Z",
    "updated_at": "2021-01-04T06:46:16Z",
    "author_association": "MEMBER",
    "body": "Ah k thanks for the report, @yv989c I am assuming you are not running any validators here ? I haven't been able to reproduce on my windows machine yet, but it does seem like an issue for a non trivial amount of windows users. I will be investigating it this week.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/753790989/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/755881417",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/8144#issuecomment-755881417",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8144",
    "id": 755881417,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NTg4MTQxNw==",
    "user": {
      "login": "yv989c",
      "id": 3805212,
      "node_id": "MDQ6VXNlcjM4MDUyMTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3805212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yv989c",
      "html_url": "https://github.com/yv989c",
      "followers_url": "https://api.github.com/users/yv989c/followers",
      "following_url": "https://api.github.com/users/yv989c/following{/other_user}",
      "gists_url": "https://api.github.com/users/yv989c/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yv989c/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yv989c/subscriptions",
      "organizations_url": "https://api.github.com/users/yv989c/orgs",
      "repos_url": "https://api.github.com/users/yv989c/repos",
      "events_url": "https://api.github.com/users/yv989c/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yv989c/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-07T04:47:53Z",
    "updated_at": "2021-01-07T04:47:53Z",
    "author_association": "NONE",
    "body": "Hi @nisdas . My validator became active yesterday, everything was working fine for about 9 hours, then efficiency started dropping (was getting less rewards). After inspecting the validator console, I can see the that in the `Previous epoch voting summary` the `correctlyVotedHead=false` message becomes more frequent over time, which I believe is the reason for lower rewards (+0.00002 ETH vs +0.00005 ETH per attestation). If that's the case, do you know what condition causes `correctlyVotedHead=false`?\r\n\r\nThanks.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/755881417/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/755899580",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/8144#issuecomment-755899580",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8144",
    "id": 755899580,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NTg5OTU4MA==",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-07T05:46:52Z",
    "updated_at": "2021-01-07T05:46:52Z",
    "author_association": "MEMBER",
    "body": "@yv989c Are you running with 5 peers as a max ? ",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/755899580/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/756437577",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/8144#issuecomment-756437577",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8144",
    "id": 756437577,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NjQzNzU3Nw==",
    "user": {
      "login": "yv989c",
      "id": 3805212,
      "node_id": "MDQ6VXNlcjM4MDUyMTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3805212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yv989c",
      "html_url": "https://github.com/yv989c",
      "followers_url": "https://api.github.com/users/yv989c/followers",
      "following_url": "https://api.github.com/users/yv989c/following{/other_user}",
      "gists_url": "https://api.github.com/users/yv989c/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yv989c/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yv989c/subscriptions",
      "organizations_url": "https://api.github.com/users/yv989c/orgs",
      "repos_url": "https://api.github.com/users/yv989c/repos",
      "events_url": "https://api.github.com/users/yv989c/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yv989c/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-07T22:58:04Z",
    "updated_at": "2021-01-08T04:00:43Z",
    "author_association": "NONE",
    "body": "Hi @nisdas it was but I increased it to 25 peers max after I wrote the above message just to see if that makes any difference (I also noticed that my clock was 1 second behind, I fixed it). About one hour after the change I started getting subsequent +0.00005 ETH attestations in beaconcha.in and my effectiveness went from 75% to 92% as of this morning (running for about 8 hours), and now is at 84% getting subsequent +0.00002 ETH per attestation.\r\n\r\nAny guidance on troubleshooting this will be appreciated. Thanks.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/756437577/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/756531334",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/8144#issuecomment-756531334",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8144",
    "id": 756531334,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NjUzMTMzNA==",
    "user": {
      "login": "yv989c",
      "id": 3805212,
      "node_id": "MDQ6VXNlcjM4MDUyMTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3805212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yv989c",
      "html_url": "https://github.com/yv989c",
      "followers_url": "https://api.github.com/users/yv989c/followers",
      "following_url": "https://api.github.com/users/yv989c/following{/other_user}",
      "gists_url": "https://api.github.com/users/yv989c/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yv989c/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yv989c/subscriptions",
      "organizations_url": "https://api.github.com/users/yv989c/orgs",
      "repos_url": "https://api.github.com/users/yv989c/repos",
      "events_url": "https://api.github.com/users/yv989c/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yv989c/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-08T03:58:07Z",
    "updated_at": "2021-01-08T03:58:07Z",
    "author_association": "NONE",
    "body": "This may be related to my system's clock. Now I found it 2 seconds behind, so it's drifting fairly quickly in a day and what I thought was supposed to keep it in sync is not working.\r\n\r\nI wrote a script to ensure it syncs against a NTP authority every hour. Hopefully this solves my issue. I'll keep you posted.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/756531334/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/757052592",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/8144#issuecomment-757052592",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8144",
    "id": 757052592,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NzA1MjU5Mg==",
    "user": {
      "login": "yv989c",
      "id": 3805212,
      "node_id": "MDQ6VXNlcjM4MDUyMTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3805212?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yv989c",
      "html_url": "https://github.com/yv989c",
      "followers_url": "https://api.github.com/users/yv989c/followers",
      "following_url": "https://api.github.com/users/yv989c/following{/other_user}",
      "gists_url": "https://api.github.com/users/yv989c/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yv989c/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yv989c/subscriptions",
      "organizations_url": "https://api.github.com/users/yv989c/orgs",
      "repos_url": "https://api.github.com/users/yv989c/repos",
      "events_url": "https://api.github.com/users/yv989c/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yv989c/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-08T23:51:07Z",
    "updated_at": "2021-01-08T23:51:07Z",
    "author_association": "NONE",
    "body": "So far so good! It's doing perfect now. It seems the problem was the drifting clock. I need to read more about the protocol, it's interesting to see how just a couple of seconds off had such a dramatic effect on attestation.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/757052592/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/804829877",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/8144#issuecomment-804829877",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8144",
    "id": 804829877,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNDgyOTg3Nw==",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-23T11:34:08Z",
    "updated_at": "2021-03-23T11:34:08Z",
    "author_association": "MEMBER",
    "body": "Closing this as this issue hasn't been reported in a while in our last few releases. ",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/804829877/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
