{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/1524",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/1524/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/1524/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/1524/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/1524",
  "id": 408188558,
  "node_id": "MDU6SXNzdWU0MDgxODg1NTg=",
  "number": 1524,
  "title": "TestNodeClose Fails w/o Network Device",
  "user": {
    "login": "terencechain",
    "id": 21316537,
    "node_id": "MDQ6VXNlcjIxMzE2NTM3",
    "avatar_url": "https://avatars.githubusercontent.com/u/21316537?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/terencechain",
    "html_url": "https://github.com/terencechain",
    "followers_url": "https://api.github.com/users/terencechain/followers",
    "following_url": "https://api.github.com/users/terencechain/following{/other_user}",
    "gists_url": "https://api.github.com/users/terencechain/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/terencechain/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/terencechain/subscriptions",
    "organizations_url": "https://api.github.com/users/terencechain/orgs",
    "repos_url": "https://api.github.com/users/terencechain/repos",
    "events_url": "https://api.github.com/users/terencechain/events{/privacy}",
    "received_events_url": "https://api.github.com/users/terencechain/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 802129904,
      "node_id": "MDU6TGFiZWw4MDIxMjk5MDQ=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Bug",
      "name": "Bug",
      "color": "ee0701",
      "default": false,
      "description": "Something isn't working"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2019-02-08T14:59:52Z",
  "updated_at": "2019-03-12T03:01:46Z",
  "closed_at": "2019-03-12T03:01:46Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "`TestNodeClose` in `node_test.go` will fail if you detach the network device. \r\n\r\nHow to reproduce:\r\n1.) With proper network connection, run the test, make sure it passes\r\n2.) Disable network device, make one change to the code, rerun test\r\n3.) TestNodeClose will fail with the following messages\r\n\r\n```\r\n=== RUN   TestNodeClose\r\ntime=\"2019-02-08T15:53:45+01:00\" level=info msg=\"checking db\" prefix=node\r\ntime=\"2019-02-08T15:53:45+01:00\" level=error msg=\"Could not get IPv4 address: are you connected to the network?\" prefix=p2p\r\ntime=\"2019-02-08T15:53:45+01:00\" level=error msg=\"Failed to p2p listen: failed to parse ip4:  failed to parse ip4 addr: \" prefix=p2p\r\ntime=\"2019-02-08T15:53:45+01:00\" level=error msg=\"Could not get IPv4 address: are you connected to the network?\" prefix=p2p\r\n--- FAIL: TestNodeClose (0.14s)\r\npanic: runtime error: invalid memory address or nil pointer dereference [recovered]\r\n\tpanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x38 pc=0x4825f75]\r\n\r\ngoroutine 40 [running]:\r\ntesting.tRunner.func1(0xc000448600)\r\n\t/usr/local/Cellar/go/1.11.4/libexec/src/testing/testing.go:792 +0x387\r\npanic(0x4b8e040, 0x592d8e0)\r\n\t/usr/local/Cellar/go/1.11.4/libexec/src/runtime/panic.go:513 +0x1b9\r\ngithub.com/libp2p/go-libp2p-swarm.(*Swarm).TransportForListening(0xc0001e4000, 0x0, 0x0, 0x0, 0x0)\r\n\t/Users/terencetsao/go/src/github.com/libp2p/go-libp2p-swarm/swarm_transport.go:42 +0x45\r\ngithub.com/libp2p/go-libp2p-swarm.(*Swarm).AddListenAddr(0xc0001e4000, 0x0, 0x0, 0xc000134160, 0x1)\r\n\t/Users/terencetsao/go/src/github.com/libp2p/go-libp2p-swarm/swarm_listen.go:39 +0x4c\r\ngithub.com/libp2p/go-libp2p-swarm.(*Swarm).Listen(0xc0001e4000, 0xc00016d0c0, 0x1, 0x1, 0xc0000aa740, 0x0)\r\n\t/Users/terencetsao/go/src/github.com/libp2p/go-libp2p-swarm/swarm_listen.go:16 +0x347\r\ngithub.com/libp2p/go-libp2p/config.(*Config).NewNode(0xc000170b40, 0x4f5c2c0, 0xc00017afc0, 0x4, 0x0, 0x0, 0xc000167880)\r\n\t/Users/terencetsao/go/src/github.com/libp2p/go-libp2p/config/config.go:166 +0x4f3\r\ngithub.com/libp2p/go-libp2p.NewWithoutDefaults(0x4f5c2c0, 0xc00017afc0, 0xc000167880, 0x3, 0x4, 0xc000167880, 0x2, 0x4, 0x5995a40)\r\n\t/Users/terencetsao/go/src/github.com/libp2p/go-libp2p/libp2p.go:68 +0xb5\r\ngithub.com/libp2p/go-libp2p.New(0x4f5c2c0, 0xc00017afc0, 0xc00016ce40, 0x2, 0x2, 0x3, 0xc000044a70, 0xc000044a00, 0x0)\r\n\t/Users/terencetsao/go/src/github.com/libp2p/go-libp2p/libp2p.go:54 +0x7c\r\ngithub.com/prysmaticlabs/prysm/shared/p2p.NewServer(0xc0004cfdb8, 0x4d0d260, 0x8, 0x0)\r\n\t/Users/terencetsao/go/src/github.com/prysmaticlabs/prysm/shared/p2p/service.go:63 +0x118\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/node.configureP2P(0xc0004462c0, 0x0, 0xc000180320, 0x4b254e0)\r\n\t/Users/terencetsao/go/src/github.com/prysmaticlabs/prysm/beacon-chain/node/p2p_config.go:28 +0x152\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/node.(*BeaconNode).registerP2P(0xc00017acc0, 0xc0004462c0, 0x0, 0x0)\r\n\t/Users/terencetsao/go/src/github.com/prysmaticlabs/prysm/beacon-chain/node/node.go:167 +0x2f\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/node.NewBeaconNode(0xc0004462c0, 0xc0004462c0, 0xb, 0xc000450101)\r\n\t/Users/terencetsao/go/src/github.com/prysmaticlabs/prysm/beacon-chain/node/node.go:69 +0x14b\r\ngithub.com/prysmaticlabs/prysm/beacon-chain/node.TestNodeClose(0xc000448600)\r\n\t/Users/terencetsao/go/src/github.com/prysmaticlabs/prysm/beacon-chain/node/node_test.go:63 +0x24c\r\ntesting.tRunner(0xc000448600, 0x4e82c58)\r\n\t/usr/local/Cellar/go/1.11.4/libexec/src/testing/testing.go:827 +0xbf\r\ncreated by testing.(*T).Run\r\n\t/usr/local/Cellar/go/1.11.4/libexec/src/testing/testing.go:878 +0x35c\r\n```",
  "closed_by": {
    "login": "terencechain",
    "id": 21316537,
    "node_id": "MDQ6VXNlcjIxMzE2NTM3",
    "avatar_url": "https://avatars.githubusercontent.com/u/21316537?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/terencechain",
    "html_url": "https://github.com/terencechain",
    "followers_url": "https://api.github.com/users/terencechain/followers",
    "following_url": "https://api.github.com/users/terencechain/following{/other_user}",
    "gists_url": "https://api.github.com/users/terencechain/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/terencechain/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/terencechain/subscriptions",
    "organizations_url": "https://api.github.com/users/terencechain/orgs",
    "repos_url": "https://api.github.com/users/terencechain/repos",
    "events_url": "https://api.github.com/users/terencechain/events{/privacy}",
    "received_events_url": "https://api.github.com/users/terencechain/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/1524/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/1524/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[

]
