{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/6950",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/6950/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/6950/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/6950/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/6950",
  "id": 676161917,
  "node_id": "MDU6SXNzdWU2NzYxNjE5MTc=",
  "number": 6950,
  "title": "Refactor Find Peers With Subnet Method",
  "user": {
    "login": "nisdas",
    "id": 33201827,
    "node_id": "MDQ6VXNlcjMzMjAxODI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nisdas",
    "html_url": "https://github.com/nisdas",
    "followers_url": "https://api.github.com/users/nisdas/followers",
    "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
    "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
    "organizations_url": "https://api.github.com/users/nisdas/orgs",
    "repos_url": "https://api.github.com/users/nisdas/repos",
    "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nisdas/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 934596141,
      "node_id": "MDU6TGFiZWw5MzQ1OTYxNDE=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Discussion",
      "name": "Discussion",
      "color": "f9d0c4",
      "default": false,
      "description": "Simply a thread for talking about stuff"
    },
    {
      "id": 1500585773,
      "node_id": "MDU6TGFiZWwxNTAwNTg1Nzcz",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Networking",
      "name": "Networking",
      "color": "c7a5f7",
      "default": false,
      "description": "P2P related items"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-08-10T14:03:30Z",
  "updated_at": "2021-02-10T17:02:06Z",
  "closed_at": "2021-02-10T17:02:06Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "# ðŸ’Ž Issue\r\n\r\n### Background\r\n\r\nIn the course of working on #6893, it came to attention that the `FindPeersWithSubnet` method was problematic and could lead to very high CPU usage. On initial benchmarks, running the method concurrently in 100 separate go-routines increased the runtime of each call linearly based on the number of go-routines running. This would indicate each network lookup was bounded by a global lock. \r\n\r\n### Description\r\n\r\nHaving a global lock for network lookups makes using this method inefficient as we might use this method when searching for subnets for many attesters. This would lead the method to take some very long times. Ex: 100 seconds, etc. The goal of the issue would be to implement a more efficient method for searching for peers of a particular subnet. Currently we simply perform a global network search and try to filter their enrs out. \r\n\r\nA potential solution would be a background routine which would look through the network asynchronously and try to filter out peers with the desired subnets. This maybe a better way to find peers then spamming network searches which yield limited results. ",
  "closed_by": {
    "login": "nisdas",
    "id": 33201827,
    "node_id": "MDQ6VXNlcjMzMjAxODI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nisdas",
    "html_url": "https://github.com/nisdas",
    "followers_url": "https://api.github.com/users/nisdas/followers",
    "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
    "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
    "organizations_url": "https://api.github.com/users/nisdas/orgs",
    "repos_url": "https://api.github.com/users/nisdas/repos",
    "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nisdas/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/6950/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/6950/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/689651356",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/6950#issuecomment-689651356",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/6950",
    "id": 689651356,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4OTY1MTM1Ng==",
    "user": {
      "login": "rauljordan",
      "id": 5572669,
      "node_id": "MDQ6VXNlcjU1NzI2Njk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5572669?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rauljordan",
      "html_url": "https://github.com/rauljordan",
      "followers_url": "https://api.github.com/users/rauljordan/followers",
      "following_url": "https://api.github.com/users/rauljordan/following{/other_user}",
      "gists_url": "https://api.github.com/users/rauljordan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rauljordan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rauljordan/subscriptions",
      "organizations_url": "https://api.github.com/users/rauljordan/orgs",
      "repos_url": "https://api.github.com/users/rauljordan/repos",
      "events_url": "https://api.github.com/users/rauljordan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rauljordan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-09T15:49:53Z",
    "updated_at": "2020-09-09T15:49:53Z",
    "author_association": "CONTRIBUTOR",
    "body": "@nisdas is this still relevant or have there been significant improvements to this code? I recall this part of the codebase has changed a bit since the Medalla incident",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/689651356/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/696629782",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/6950#issuecomment-696629782",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/6950",
    "id": 696629782,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NjYyOTc4Mg==",
    "user": {
      "login": "shayzluf",
      "id": 5848741,
      "node_id": "MDQ6VXNlcjU4NDg3NDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5848741?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shayzluf",
      "html_url": "https://github.com/shayzluf",
      "followers_url": "https://api.github.com/users/shayzluf/followers",
      "following_url": "https://api.github.com/users/shayzluf/following{/other_user}",
      "gists_url": "https://api.github.com/users/shayzluf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shayzluf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shayzluf/subscriptions",
      "organizations_url": "https://api.github.com/users/shayzluf/orgs",
      "repos_url": "https://api.github.com/users/shayzluf/repos",
      "events_url": "https://api.github.com/users/shayzluf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shayzluf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-22T10:11:42Z",
    "updated_at": "2020-09-22T10:11:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "@nisdas any update on this issue?",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/696629782/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/776861161",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/6950#issuecomment-776861161",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/6950",
    "id": 776861161,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3Njg2MTE2MQ==",
    "user": {
      "login": "rauljordan",
      "id": 5572669,
      "node_id": "MDQ6VXNlcjU1NzI2Njk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5572669?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rauljordan",
      "html_url": "https://github.com/rauljordan",
      "followers_url": "https://api.github.com/users/rauljordan/followers",
      "following_url": "https://api.github.com/users/rauljordan/following{/other_user}",
      "gists_url": "https://api.github.com/users/rauljordan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rauljordan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rauljordan/subscriptions",
      "organizations_url": "https://api.github.com/users/rauljordan/orgs",
      "repos_url": "https://api.github.com/users/rauljordan/repos",
      "events_url": "https://api.github.com/users/rauljordan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rauljordan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-10T16:59:52Z",
    "updated_at": "2021-02-10T16:59:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "@nisdas is this something we'll ever get to or are we ok to close?",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/776861161/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/776863002",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/6950#issuecomment-776863002",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/6950",
    "id": 776863002,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3Njg2MzAwMg==",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-10T17:02:06Z",
    "updated_at": "2021-02-10T17:02:06Z",
    "author_association": "MEMBER",
    "body": "This has actually already been done here #8048. Closing this now",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/776863002/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
