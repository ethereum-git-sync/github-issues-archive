{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8369",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8369/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8369/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8369/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/8369",
  "id": 797520718,
  "node_id": "MDU6SXNzdWU3OTc1MjA3MTg=",
  "number": 8369,
  "title": "Validator process exits when \"Waiting for beacon chain start log from the ETH 1.0 deposit contract\" ",
  "user": {
    "login": "augustohalvarez",
    "id": 29642577,
    "node_id": "MDQ6VXNlcjI5NjQyNTc3",
    "avatar_url": "https://avatars.githubusercontent.com/u/29642577?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/augustohalvarez",
    "html_url": "https://github.com/augustohalvarez",
    "followers_url": "https://api.github.com/users/augustohalvarez/followers",
    "following_url": "https://api.github.com/users/augustohalvarez/following{/other_user}",
    "gists_url": "https://api.github.com/users/augustohalvarez/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/augustohalvarez/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/augustohalvarez/subscriptions",
    "organizations_url": "https://api.github.com/users/augustohalvarez/orgs",
    "repos_url": "https://api.github.com/users/augustohalvarez/repos",
    "events_url": "https://api.github.com/users/augustohalvarez/events{/privacy}",
    "received_events_url": "https://api.github.com/users/augustohalvarez/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-01-30T20:09:43Z",
  "updated_at": "2021-02-01T21:47:38Z",
  "closed_at": "2021-02-01T21:47:33Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!--üíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíé\r\n\r\nHellooo! üòÑ \r\n\r\nTo help us tend to your issue faster, please search our currently open issues before submitting a new one.\r\nExisting issues often contain information about workarounds, resolution, or progress updates.\r\n\r\nüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíé-->\r\n\r\n# üêû Bug Report\r\n\r\n### Description\r\n\r\nWith Geth node and beacon chain fully synced and running, starting the validator process exits immediately after the log \"Waiting for beacon chain start log from the ETH 1.0 deposit contract\"\r\n\r\n### Has this worked before in a previous version?\r\n\r\n<!-- Did this behavior use to work in the previous version? -->\r\n<!-- ‚úçÔ∏è--> Unclear. Same commands worked on Pyrmont testnet, though this is the first time running on mainnet\r\n\r\n## üî¨ Minimal Reproduction\r\n\r\n<!--\r\nPlease let us know how we can reproduce this issue. Include the exact method you used to run Prysm along with any flags used in your beacon chain and/or validator. Make sure you don't upload any confidential files or private keys.\r\n-->\r\nsuccessfully imported validator_keys into the prysm wallet. The accounts list shows just one, and the pub key matches what I'm seeing in beaconcha.in (btw, validator is waiting to be activated)\r\nhttps://beaconcha.in/validator/9075fe0036a41dc6694e4ab0526b9e4fb8620e811135a07d2440f529c62d163c0758f0ae56e5711b1347d9f7367213b0#deposits\r\n\r\nGeth was started as a systemd service:\r\n```\r\n[Unit]\r\nDescription     = geth eth1 service\r\nWants           = network-online.target\r\nAfter           = network-online.target\r\n\r\n[Service]\r\nUser            = augusto\r\nExecStart       = /usr/bin/geth --http --metrics --pprof\r\nRestart         = on-failure\r\nRestartSec      = 3\r\n\r\n[Install]\r\nWantedBy    = multi-user.target\r\n```  \r\nThe Geth javascript consle shows eth.syncing as `false` and the service seems to be running okay. Here's a snippet of the logs when restarting the service:\r\n[eth1.log](https://github.com/prysmaticlabs/prysm/files/5898552/eth1.log)\r\n\r\n\r\nBeacon chain started as systemd service:\r\n```\r\n[Unit]\r\nDescription     = eth2 beacon chain service\r\nWants           = network-online.target\r\nAfter           = network-online.target\r\n\r\n[Service]\r\nType            = simple\r\nUser            = augusto\r\nExecStart       = /home/augusto/prysm/prysm.sh beacon-chain --mainnet --p2p-max-peers=75 --monitoring-host=\"0.0.0.0\" --http-web3provider=http://127.0.0.1:8545 --accept-terms-of-use\r\nRestart         = on-failure\r\n\r\n[Install]\r\nWantedBy    = multi-user.target\r\n```\r\n\r\nAppears to be fully synced and working as expected from looking at the logs. Here's a snippet of restarting the service:\r\n[beacon-chain.log](https://github.com/prysmaticlabs/prysm/files/5898563/beacon-chain.log)\r\n\r\nValidator is also a systemd service:\r\n```\r\n[Unit]\r\nDescription     = eth2 validator service\r\nWants           = network-online.target beacon-chain.service\r\nAfter           = network-online.target\r\n\r\n[Service]\r\nUser            = augusto\r\nExecStart       = /home/augusto/prysm/prysm.sh validator --mainnet --graffiti \"Me and my franklins here, we take off!\" --accept-terms-of-use --wallet-password-file /home/augusto/.eth2validators/validators-password.txt --verbosity=trace\r\nRestart         = no\r\n\r\n[Install]\r\nWantedBy= multi-user.target\r\n```\r\n\r\nAll three services started the same way `systemctl start {service name}`\r\nWith both the Geth node and beacon chain synced and running, starting the validator gives the following output:  \r\n\r\n## üî• Error\r\n\r\n<pre><code>\r\n<!-- If the issue is accompanied by an error, please share the error logs with us below. If you have a lot of logs, place make a paste bin with your logs and share the link with us here: -->\r\n<!-- ‚úçÔ∏è-->\r\nJan 30 09:47:21 augusto-NUC8i5BEK systemd[1]: Started eth2 validator service.\r\nJan 30 09:47:22 augusto-NUC8i5BEK prysm.sh[13100]: Latest Prysm version is v1.1.0.\r\nJan 30 09:47:22 augusto-NUC8i5BEK prysm.sh[13100]: Validator is up to date.\r\nJan 30 09:47:22 augusto-NUC8i5BEK prysm.sh[13100]: Verifying binary integrity.\r\nJan 30 09:47:22 augusto-NUC8i5BEK prysm.sh[13100]: validator-v1.1.0-linux-amd64: OK\r\nJan 30 09:47:22 augusto-NUC8i5BEK prysm.sh[13100]: gpg: Signature made Mon 18 Jan 2021 01:04:00 PM PST using RSA key ID F1A5036E\r\nJan 30 09:47:22 augusto-NUC8i5BEK prysm.sh[13100]: gpg: Good signature from \"Preston Van Loon <preston@prysmaticlabs.com>\"\r\nJan 30 09:47:22 augusto-NUC8i5BEK prysm.sh[13100]: gpg: WARNING: This key is not certified with a trusted signature!\r\nJan 30 09:47:22 augusto-NUC8i5BEK prysm.sh[13100]: gpg:          There is no indication that the signature belongs to the owner.\r\nJan 30 09:47:22 augusto-NUC8i5BEK prysm.sh[13100]: Primary key fingerprint: 0AE0 051D 647B A3C1 A917  AF40 72E3 3E4D F1A5 036E\r\nJan 30 09:47:22 augusto-NUC8i5BEK prysm.sh[13100]: Verified /home/augusto/prysm/dist/validator-v1.1.0-linux-amd64 has been signed by Prysmatic Labs.\r\nJan 30 09:47:22 augusto-NUC8i5BEK prysm.sh[13100]: Starting Prysm validator --mainnet --graffiti Me and my franklins here, we take off! --accept-terms-of-use --wallet-password-file /home/augusto/.eth2validators/validators-password.txt --verbosity=trace\r\nJan 30 09:47:23 augusto-NUC8i5BEK prysm.sh[13100]: time=\"2021-01-30 09:47:23\" level=warning msg=\"Running on ETH2 Mainnet\" prefix=flags\r\nJan 30 09:47:23 augusto-NUC8i5BEK prysm.sh[13100]: time=\"2021-01-30 09:47:23\" level=info msg=\"(wallet path) /home/augusto/.eth2validators/prysm-wallet-v2\" prefix=prompt\r\nJan 30 09:47:23 augusto-NUC8i5BEK prysm.sh[13100]: time=\"2021-01-30 09:47:23\" level=info msg=\"Opened validator wallet\" keymanager-kind=direct prefix=node wallet=\"/home/augusto/.eth2validators/prysm-wallet-v2/direct\"\r\nJan 30 09:47:23 augusto-NUC8i5BEK prysm.sh[13100]: time=\"2021-01-30 09:47:23\" level=info msg=\"Checking DB\" databasePath=\"/home/augusto/.eth2validators/prysm-wallet-v2/direct\" prefix=node\r\nJan 30 09:47:23 augusto-NUC8i5BEK prysm.sh[13100]: time=\"2021-01-30 09:47:23\" level=info msg=\"Starting validator node\" prefix=node version=\"Prysm/v1.1.0/9b367b36fc12ecf565ad649209aa2b5bba8c7797. Built at: 2021-01-18 19:47:14+00:00\"\r\nJan 30 09:47:23 augusto-NUC8i5BEK prysm.sh[13100]: time=\"2021-01-30 09:47:23\" level=debug msg=\"Starting 2 services: [*prometheus.Service *client.ValidatorService]\" prefix=registry\r\nJan 30 09:47:23 augusto-NUC8i5BEK prysm.sh[13100]: time=\"2021-01-30 09:47:23\" level=debug msg=\"Starting service type *prometheus.Service\" prefix=registry\r\nJan 30 09:47:23 augusto-NUC8i5BEK prysm.sh[13100]: time=\"2021-01-30 09:47:23\" level=debug msg=\"Starting service type *client.ValidatorService\" prefix=registry\r\nJan 30 09:47:23 augusto-NUC8i5BEK prysm.sh[13100]: time=\"2021-01-30 09:47:23\" level=warning msg=\"You are using an insecure gRPC connection. If you are running your beacon node and validator on the same machines, you can ignore this message. If you want to know how to enable secure connections, see: https://docs.prylabs.network/docs/prysm-usage/secure-grpc\" prefix=validator\r\nJan 30 09:47:23 augusto-NUC8i5BEK prysm.sh[13100]: time=\"2021-01-30 09:47:23\" level=debug msg=\"Starting prometheus service\" address=\"127.0.0.1:8081\" prefix=prometheus\r\nJan 30 09:47:23 augusto-NUC8i5BEK prysm.sh[13100]: time=\"2021-01-30 09:47:23\" level=info msg=\"Validating for public key\" prefix=validator publicKey=0x9075fe0036a4\r\nJan 30 09:47:23 augusto-NUC8i5BEK prysm.sh[13100]: time=\"2021-01-30 09:47:23\" level=debug msg=\"gRPC stream started.\" backend=[] method=\"/ethereum.eth.v1alpha1.BeaconNodeValidator/WaitForChainStart\"\r\nJan 30 09:47:23 augusto-NUC8i5BEK prysm.sh[13100]: time=\"2021-01-30 09:47:23\" level=info msg=\"Waiting for beacon chain start log from the ETH 1.0 deposit contract\" prefix=validator\r\nJan 30 09:47:23 augusto-NUC8i5BEK systemd[1]: validator.service: Main process exited, code=exited, status=1/FAILURE\r\nJan 30 09:47:23 augusto-NUC8i5BEK systemd[1]: validator.service: Unit entered failed state.\r\nJan 30 09:47:23 augusto-NUC8i5BEK systemd[1]: validator.service: Failed with result 'exit-code'.\r\n\r\n</code></pre>\r\n\r\n\r\n## üåç  Your Environment\r\n\r\n**Operating System:**\r\n\r\n<pre>\r\n  <code>\r\nDistributor ID:\tUbuntu\r\nDescription:\tUbuntu 16.04.7 LTS\r\nRelease:\t16.04\r\nCodename:\txenial\r\n  </code>\r\n</pre>\r\n\r\n**What version of Prysm are you running? (Which release)**\r\n\r\n<pre>\r\n  <code>\r\nbeacon-chain version Prysm/v1.1.0/9b367b36fc12ecf565ad649209aa2b5bba8c7797. Built at: 2021-01-18 19:47:14+00:00\r\nvalidator version Prysm/v1.1.0/9b367b36fc12ecf565ad649209aa2b5bba8c7797. Built at: 2021-01-18 19:47:14+00:00\r\n  </code>\r\n</pre>\r\n\r\n**Anything else relevant (validator index / public key)?**\r\nValidator public key: `0x9075fe0036a41dc6694e4ab0526b9e4fb8620e811135a07d2440f529c62d163c0758f0ae56e5711b1347d9f7367213b0`\r\n Also shown in link to beaconcha.in with some more info.\r\n\r\nSome things to note:\r\nI did encounter a bit of weirdness when transitioning off the Pyrmont testnet. I had everything running smoothly for a bit so I decided to perform a voluntary exit before starting mainnet. That was a success so I went ahead and created new validator keys with the deposit cli and imported into my prysm wallet. When running `validator accounts list --mainnet`, it showed two accounts, the one I used for testnet and the newly imported account. I thought maybe I had left out the pyrmont flag when importing the key (still unsure), so I went ahead and deleted that account, leaving only the new mainnet one. Not sure if this did anything but thought I should mention.\r\n\r\nI have tried a full resync of the beacon chain by deleting the data directory and restarting the service but I'm still seeing the same error.\r\n\r\nI have been running each service in separate tmux sessions but I've tried running them in separate terminal windows and still seeing the same error.\r\n\r\nPlease let me know if you need any more info. I realize this may be hard to reproduce so any help or further direction on how to debug would be immensely appreciated. Thanks for all the hard work and maintaining the discord channel, it's been incredibly helpful so far!\r\n",
  "closed_by": {
    "login": "augustohalvarez",
    "id": 29642577,
    "node_id": "MDQ6VXNlcjI5NjQyNTc3",
    "avatar_url": "https://avatars.githubusercontent.com/u/29642577?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/augustohalvarez",
    "html_url": "https://github.com/augustohalvarez",
    "followers_url": "https://api.github.com/users/augustohalvarez/followers",
    "following_url": "https://api.github.com/users/augustohalvarez/following{/other_user}",
    "gists_url": "https://api.github.com/users/augustohalvarez/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/augustohalvarez/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/augustohalvarez/subscriptions",
    "organizations_url": "https://api.github.com/users/augustohalvarez/orgs",
    "repos_url": "https://api.github.com/users/augustohalvarez/repos",
    "events_url": "https://api.github.com/users/augustohalvarez/events{/privacy}",
    "received_events_url": "https://api.github.com/users/augustohalvarez/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8369/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8369/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/770651194",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/8369#issuecomment-770651194",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8369",
    "id": 770651194,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MDY1MTE5NA==",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-01T07:55:42Z",
    "updated_at": "2021-02-01T07:55:42Z",
    "author_association": "MEMBER",
    "body": "@augustohalvarez You can try deleting your validator db either manually or with `--clear-db`in your validator client. I am assuming the fact that you are running the same validator directory for both the testnet/mainnet might have caused issues here. Let me know if after that your validator is back up and running.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/770651194/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/771181435",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/8369#issuecomment-771181435",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/8369",
    "id": 771181435,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MTE4MTQzNQ==",
    "user": {
      "login": "augustohalvarez",
      "id": 29642577,
      "node_id": "MDQ6VXNlcjI5NjQyNTc3",
      "avatar_url": "https://avatars.githubusercontent.com/u/29642577?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/augustohalvarez",
      "html_url": "https://github.com/augustohalvarez",
      "followers_url": "https://api.github.com/users/augustohalvarez/followers",
      "following_url": "https://api.github.com/users/augustohalvarez/following{/other_user}",
      "gists_url": "https://api.github.com/users/augustohalvarez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/augustohalvarez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/augustohalvarez/subscriptions",
      "organizations_url": "https://api.github.com/users/augustohalvarez/orgs",
      "repos_url": "https://api.github.com/users/augustohalvarez/repos",
      "events_url": "https://api.github.com/users/augustohalvarez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/augustohalvarez/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-01T21:47:33Z",
    "updated_at": "2021-02-01T21:47:33Z",
    "author_association": "NONE",
    "body": "Thanks so much @nisdas, looks like it's working as expected since I'm seeing this in the logs now:\r\n`Feb 01 13:42:54 augusto-NUC8i5BEK prysm.sh[10632]: time=\"2021-02-01 13:42:54\" level=info msg=\"Deposit processed, entering activation queue after finalization\" index=88277 positionInActivationQueue=11227 prefix=validator pubKey=0x9075fe0036a4 status=DEPOSITED`\r\n\r\nReally appreciate the suggestion! Going to close the issue now.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/771181435/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
