{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2859",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2859/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2859/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2859/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/2859",
  "id": 460750573,
  "node_id": "MDU6SXNzdWU0NjA3NTA1NzM=",
  "number": 2859,
  "title": "bls error panic: runtime error: invalid memory address or nil pointer dereference",
  "user": {
    "login": "zsp042",
    "id": 52188840,
    "node_id": "MDQ6VXNlcjUyMTg4ODQw",
    "avatar_url": "https://avatars.githubusercontent.com/u/52188840?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/zsp042",
    "html_url": "https://github.com/zsp042",
    "followers_url": "https://api.github.com/users/zsp042/followers",
    "following_url": "https://api.github.com/users/zsp042/following{/other_user}",
    "gists_url": "https://api.github.com/users/zsp042/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/zsp042/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/zsp042/subscriptions",
    "organizations_url": "https://api.github.com/users/zsp042/orgs",
    "repos_url": "https://api.github.com/users/zsp042/repos",
    "events_url": "https://api.github.com/users/zsp042/events{/privacy}",
    "received_events_url": "https://api.github.com/users/zsp042/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2019-06-26T04:14:06Z",
  "updated_at": "2019-06-28T06:58:24Z",
  "closed_at": "2019-06-28T06:58:24Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "go version go1.12.6 darwin/amd64\r\n\r\ncode\r\n\r\n```\r\n\r\npackage main\r\n\r\nimport (\r\n\t\"encoding/base64\"\r\n\r\n\t\"github.com/prysmaticlabs/prysm/shared/bls\"\r\n)\r\n\r\nfunc main() {\r\n\r\n\ttoken, err := base64.RawURLEncoding.DecodeString(\"7JylYw6E0deEDZKLXCjXVSCToi5_9ZfzYFeXm3Pp7wA\")\r\n\tif err != nil {\r\n\t\tpanic(err)\r\n\t}\r\n\r\n\tb64token := base64.RawURLEncoding.EncodeToString(token)\r\n\tprintln(\"secret\", b64token)\r\n\r\n\tsecret, err := bls.SecretKeyFromBytes(token)\r\n\tif err != nil {\r\n\t\tpanic(err)\r\n\t}\r\n\r\n\tsign := secret.Sign([]byte(\"123\"), 1)\r\n\r\n\tprintln(\"sign.Marshal len\", len(sign.Marshal()))\r\n\r\n}\r\n\r\n```\r\n\r\nerror\r\n\r\n```\r\n\r\npanic: runtime error: invalid memory address or nil pointer dereference\r\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x10b776a]\r\n\r\ngoroutine 1 [running]:\r\ngithub.com/phoreproject/bls.(*FR).Copy(...)\r\n\t/Users/z/go/pkg/mod/github.com/phoreproject/bls@v0.0.0-20190621015719-e008a268030e/fr.go:31\r\ngithub.com/phoreproject/bls.(*FR).ToRepr(0x0, 0x0)\r\n\t/Users/z/go/pkg/mod/github.com/phoreproject/bls@v0.0.0-20190621015719-e008a268030e/fr.go:317 +0x2a\r\ngithub.com/phoreproject/bls/g1pubs.SignWithDomain(0x333231, 0x0, 0x0, 0x0, 0xc00000e030, 0x1, 0xf397f57f2ea29320)\r\n\t/Users/z/go/pkg/mod/github.com/phoreproject/bls@v0.0.0-20190621015719-e008a268030e/g1pubs/bls.go:129 +0x7e\r\ngithub.com/prysmaticlabs/prysm/shared/bls.(*SecretKey).Sign(0xc00000e038, 0xc000080f5d, 0x3, 0x3, 0x1, 0x0)\r\n\t/Users/z/go/pkg/mod/github.com/prysmaticlabs/prysm@v0.0.0-20190625165747-9bd614702745/shared/bls/bls.go:74 +0x89\r\nmain.main()\r\n\t/Users/z/git/6du/u6du/tmp.go:24 +0x18c\r\n\r\nProcess finished with exit code 2\r\n\r\n```",
  "closed_by": {
    "login": "zsp042",
    "id": 52188840,
    "node_id": "MDQ6VXNlcjUyMTg4ODQw",
    "avatar_url": "https://avatars.githubusercontent.com/u/52188840?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/zsp042",
    "html_url": "https://github.com/zsp042",
    "followers_url": "https://api.github.com/users/zsp042/followers",
    "following_url": "https://api.github.com/users/zsp042/following{/other_user}",
    "gists_url": "https://api.github.com/users/zsp042/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/zsp042/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/zsp042/subscriptions",
    "organizations_url": "https://api.github.com/users/zsp042/orgs",
    "repos_url": "https://api.github.com/users/zsp042/repos",
    "events_url": "https://api.github.com/users/zsp042/events{/privacy}",
    "received_events_url": "https://api.github.com/users/zsp042/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2859/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2859/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/505738608",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2859#issuecomment-505738608",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2859",
    "id": 505738608,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNTczODYwOA==",
    "user": {
      "login": "nisdas",
      "id": 33201827,
      "node_id": "MDQ6VXNlcjMzMjAxODI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33201827?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nisdas",
      "html_url": "https://github.com/nisdas",
      "followers_url": "https://api.github.com/users/nisdas/followers",
      "following_url": "https://api.github.com/users/nisdas/following{/other_user}",
      "gists_url": "https://api.github.com/users/nisdas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nisdas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nisdas/subscriptions",
      "organizations_url": "https://api.github.com/users/nisdas/orgs",
      "repos_url": "https://api.github.com/users/nisdas/repos",
      "events_url": "https://api.github.com/users/nisdas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nisdas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-26T06:29:20Z",
    "updated_at": "2019-06-26T06:30:50Z",
    "author_association": "MEMBER",
    "body": "Hey @i6du we use the [phore](https://github.com/phoreproject/bls) library as our underlying BLS library. This issue would be better raised there but as far as I understand from the library, the given token maps to an invalid FR point leading to the bytes being unmarshalled to an invalid secret key. This leads to the panic when trying to sign a message. \r\n\r\n @meyer9 would be able to dig into this issue better",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/505738608/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/506149139",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2859#issuecomment-506149139",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2859",
    "id": 506149139,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjE0OTEzOQ==",
    "user": {
      "login": "meyer9",
      "id": 1247379,
      "node_id": "MDQ6VXNlcjEyNDczNzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1247379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/meyer9",
      "html_url": "https://github.com/meyer9",
      "followers_url": "https://api.github.com/users/meyer9/followers",
      "following_url": "https://api.github.com/users/meyer9/following{/other_user}",
      "gists_url": "https://api.github.com/users/meyer9/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/meyer9/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/meyer9/subscriptions",
      "organizations_url": "https://api.github.com/users/meyer9/orgs",
      "repos_url": "https://api.github.com/users/meyer9/repos",
      "events_url": "https://api.github.com/users/meyer9/events{/privacy}",
      "received_events_url": "https://api.github.com/users/meyer9/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-27T04:11:53Z",
    "updated_at": "2019-06-27T04:11:53Z",
    "author_association": "NONE",
    "body": "I'll look into it tonight. I think this might happen when the private key is too big.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/506149139/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/506440246",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2859#issuecomment-506440246",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2859",
    "id": 506440246,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjQ0MDI0Ng==",
    "user": {
      "login": "meyer9",
      "id": 1247379,
      "node_id": "MDQ6VXNlcjEyNDczNzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1247379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/meyer9",
      "html_url": "https://github.com/meyer9",
      "followers_url": "https://api.github.com/users/meyer9/followers",
      "following_url": "https://api.github.com/users/meyer9/following{/other_user}",
      "gists_url": "https://api.github.com/users/meyer9/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/meyer9/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/meyer9/subscriptions",
      "organizations_url": "https://api.github.com/users/meyer9/orgs",
      "repos_url": "https://api.github.com/users/meyer9/repos",
      "events_url": "https://api.github.com/users/meyer9/events{/privacy}",
      "received_events_url": "https://api.github.com/users/meyer9/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-27T17:33:07Z",
    "updated_at": "2019-06-27T17:33:07Z",
    "author_association": "NONE",
    "body": "Ah, you're using `DeserializeSecretKey` which should use the output from `SerializeSecretKey`.\r\n\r\nYou should use `DeriveSecretKey` which can take arbitrary bytes.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/506440246/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
