{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/10138",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/10138/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/10138/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/10138/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/10138",
  "id": 1115547312,
  "node_id": "I_kwDOBvuov85Cfeaw",
  "number": 10138,
  "title": "End-to-End Test Coverage for Standard API Compliance Between Clients",
  "user": {
    "login": "rauljordan",
    "id": 5572669,
    "node_id": "MDQ6VXNlcjU1NzI2Njk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5572669?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rauljordan",
    "html_url": "https://github.com/rauljordan",
    "followers_url": "https://api.github.com/users/rauljordan/followers",
    "following_url": "https://api.github.com/users/rauljordan/following{/other_user}",
    "gists_url": "https://api.github.com/users/rauljordan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rauljordan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rauljordan/subscriptions",
    "organizations_url": "https://api.github.com/users/rauljordan/orgs",
    "repos_url": "https://api.github.com/users/rauljordan/repos",
    "events_url": "https://api.github.com/users/rauljordan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rauljordan/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 802129907,
      "node_id": "MDU6TGFiZWw4MDIxMjk5MDc=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Help%20Wanted",
      "name": "Help Wanted",
      "color": "33aa3f",
      "default": false,
      "description": "Extra attention is needed"
    },
    {
      "id": 1085356222,
      "node_id": "MDU6TGFiZWwxMDg1MzU2MjIy",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/CI",
      "name": "CI",
      "color": "c9bffc",
      "default": false,
      "description": "Continuous integration related items"
    },
    {
      "id": 1701740543,
      "node_id": "MDU6TGFiZWwxNzAxNzQwNTQz",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/API",
      "name": "API",
      "color": "30ef13",
      "default": false,
      "description": "Api related tasks"
    },
    {
      "id": 1815029259,
      "node_id": "MDU6TGFiZWwxODE1MDI5MjU5",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Security",
      "name": "Security",
      "color": "aa3137",
      "default": false,
      "description": "Security Related Issues"
    },
    {
      "id": 3126461723,
      "node_id": "MDU6TGFiZWwzMTI2NDYxNzIz",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/E2E%20Tests",
      "name": "E2E Tests",
      "color": "1C4D5E",
      "default": false,
      "description": "End-To-End testing"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-01-26T22:06:00Z",
  "updated_at": "2022-01-31T16:52:41Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "# ðŸš€ Feature Request\r\n\r\n### Description\r\n\r\nCredits to @kasey for suggesting this idea.\r\n\r\nGiven a recent issue in #10132 surfaced in differing behavior between consensus clients' APIs, we need to prevent any future cases. Currently, we have no compliance tests for the [consensus clients' standard API](https://ethereum.github.io/beacon-APIs/), which is being used by all clients today. If there is a discrepancy in the responses to common queries between clients, it could lead to dangerous bugs in the future.\r\n\r\nGiven @nisdas has recently added support for the lighthouse consensus client in our e2e test suite in #10020, we could write conformity tests that check for equivalent responses between Prysm and Lighthouse in our CI. \r\n\r\n### Describe the solution you'd like\r\n\r\nThe general idea is we hit different endpoints of the standard API in our Prysm and Lighthouse nodes during e2e tests and ensure they have matching responses. The coverage should be comprehensive regarding important data such as blocks, attestations, balances, and beacon state.\r\n\r\n### Describe alternatives you've considered\r\n\r\nInstead, we could push forward to have compliance tests on mainnet from fixtures obtained from the standard API and try to run those in our production nodes. However, the e2e solution is nicer as it requires less coordination and accomplishes similar results. Unfortunately, it will only detect discrepancies between Prysm and Lighthouse, unless we add more clients to our e2e, which has significant overhead.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/10138/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/10138/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1025990394",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/10138#issuecomment-1025990394",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/10138",
    "id": 1025990394,
    "node_id": "IC_kwDOBvuov849J176",
    "user": {
      "login": "potuz",
      "id": 16044918,
      "node_id": "MDQ6VXNlcjE2MDQ0OTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16044918?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/potuz",
      "html_url": "https://github.com/potuz",
      "followers_url": "https://api.github.com/users/potuz/followers",
      "following_url": "https://api.github.com/users/potuz/following{/other_user}",
      "gists_url": "https://api.github.com/users/potuz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/potuz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/potuz/subscriptions",
      "organizations_url": "https://api.github.com/users/potuz/orgs",
      "repos_url": "https://api.github.com/users/potuz/repos",
      "events_url": "https://api.github.com/users/potuz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/potuz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-31T16:52:40Z",
    "updated_at": "2022-01-31T16:52:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "Notice that it may be subtle to raise the issue of #10132 for example as the query needs to be on a slot that the validator's balance has changed. So the e2e tests not only need to make the API calls but also make sure that the states involved are generic enough",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/1025990394/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
