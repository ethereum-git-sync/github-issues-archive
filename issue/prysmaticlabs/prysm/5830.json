{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/5830",
  "id": 616716077,
  "node_id": "MDU6SXNzdWU2MTY3MTYwNzc=",
  "number": 5830,
  "title": "`./prysm.sh validator accounts create` gives OOM on devices with low RAM / swap",
  "user": {
    "login": "chrishobcroft",
    "id": 2212651,
    "node_id": "MDQ6VXNlcjIyMTI2NTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2212651?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chrishobcroft",
    "html_url": "https://github.com/chrishobcroft",
    "followers_url": "https://api.github.com/users/chrishobcroft/followers",
    "following_url": "https://api.github.com/users/chrishobcroft/following{/other_user}",
    "gists_url": "https://api.github.com/users/chrishobcroft/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chrishobcroft/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chrishobcroft/subscriptions",
    "organizations_url": "https://api.github.com/users/chrishobcroft/orgs",
    "repos_url": "https://api.github.com/users/chrishobcroft/repos",
    "events_url": "https://api.github.com/users/chrishobcroft/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chrishobcroft/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 802129904,
      "node_id": "MDU6TGFiZWw4MDIxMjk5MDQ=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Bug",
      "name": "Bug",
      "color": "ee0701",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 802129907,
      "node_id": "MDU6TGFiZWw4MDIxMjk5MDc=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Help%20Wanted",
      "name": "Help Wanted",
      "color": "33aa3f",
      "default": false,
      "description": "Extra attention is needed"
    },
    {
      "id": 1085357783,
      "node_id": "MDU6TGFiZWwxMDg1MzU3Nzgz",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Priority:%20Low",
      "name": "Priority: Low",
      "color": "26f7bd",
      "default": false,
      "description": "Low priority item"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/milestones/3",
    "html_url": "https://github.com/prysmaticlabs/prysm/milestone/3",
    "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/milestones/3/labels",
    "id": 3141844,
    "node_id": "MDk6TWlsZXN0b25lMzE0MTg0NA==",
    "number": 3,
    "title": "Diamond",
    "description": "The Diamond Release: Ethereum Mainnet",
    "creator": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 0,
    "closed_issues": 113,
    "state": "closed",
    "created_at": "2018-02-25T21:24:26Z",
    "updated_at": "2020-11-25T18:06:34Z",
    "due_on": "2020-11-20T08:00:00Z",
    "closed_at": "2020-11-25T18:06:34Z"
  },
  "comments": 12,
  "created_at": "2020-05-12T14:46:11Z",
  "updated_at": "2020-08-06T03:58:29Z",
  "closed_at": "2020-08-06T03:58:29Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "<!--üíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíé\r\n\r\nHellooo! üòÑ \r\n\r\nTo help us tend to your issue faster, please search our currently open issues before submitting a new one.\r\nExisting issues often contain information about workarounds, resolution, or progress updates.\r\n\r\nüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíé-->\r\n\r\n# üêû Bug Report\r\n\r\n### Description\r\n\r\n<!-- ‚úçÔ∏è-->\r\n\r\n`./prysm.sh validator accounts create` fails consistently, reporting `Killed`, when running on `Ubuntu 20.04 LTS` with **`512Mb` `RAM`** and **`0` `swap`**\r\n\r\n### Has this worked before in a previous version?\r\n\r\n<!-- Did this behavior use to work in the previous version? -->\r\n<!-- ‚úçÔ∏è--> Not to my knowledge.\r\n\r\n## üî¨ Minimal Reproduction\r\n\r\n<!--\r\nPlease let us know how we can reproduce this issue. Include the exact method you used to run Prysm along with any flags used in your beacon chain and/or validator. Make sure you don't upload any confidential files or private keys.\r\n-->\r\n\r\n1. Deploy and connect to `Ubuntu 20.04 LTS` server with `1 vCPU`, `512 Mb RAM`\r\n\r\n![image](https://user-images.githubusercontent.com/2212651/81699537-22956a00-9485-11ea-892e-7af03f3df230.png)\r\n\r\n2. Run the following commands:\r\n```\r\nmkdir prysm \\\r\n                  && cd prysm \r\ncurl https://raw.githubusercontent.com/prysmaticlabs/prysm/master/prysm.sh \\\r\n                  --output prysm.sh \\\r\n                  && chmod +x prysm.sh \r\n./prysm.sh \\\r\n                  validator \\\r\n                  accounts \\\r\n                  create \\\r\n                  --password changeme \\\r\n                  --keystore-path /home/ubuntu/.eth2validators\r\n```\r\n\r\n3. See the process generate the `shardwithdrawalkey...` and then fail with `Killed`, _without generating_ the `validatorprivatekey...` (see below for full transcript of session)\r\n\r\nThis process was repeated 20 times, with the same results each time.\r\n\r\nPrior to running any process, the memory usage / availability reported by `top` was\r\n```\r\nMiB Mem :    474.5 total,     57.9 free,    127.6 used,    289.0 buff/cache\r\nMiB Swap:      0.0 total,      0.0 free,      0.0 used.    329.0 avail Mem \r\n```\r\n\r\n## üî• Error\r\n\r\nThe process fails, and reports `Killed`.\r\n\r\nUpon further investigation using `top`, it appears that the process requires more memory than is available, to generate the `validatorprivatekey...` files.\r\n\r\n### Adding swap\r\n\r\n#### 512Mb RAM + 192Mb swap\r\n\r\nWhen a total of **192Mb of swap** was added to the **512Mb of physical RAM**, the process **failed to create the `validatorprivatekey` as per above** 10/10 times.\r\n\r\nPrior to running any process, the memory usage / availability reported by `top` was\r\n```\r\nMiB Mem :    474.5 total,    290.1 free,    126.6 used,     57.8 buff/cache\r\nMiB Swap:    192.0 total,    192.0 free,      0.0 used.    326.8 avail Mem \r\n```\r\n\r\n#### 512Mb RAM + 240Mb swap\r\n\r\nWhen a total of **240Mb of swap** was added to the **512Mb of physical RAM**, the process **succeeded** 10/10 times in creating _both keystore files_, BUT failed 2/10 times to generate the `Raw Transaction Data` with `Killed`.\r\n\r\nPrior to running any process, the memory usage / availability reported by `top` was\r\n```\r\nMiB Mem :    474.5 total,     71.5 free,    128.0 used,    274.9 buff/cache\r\nMiB Swap:    240.0 total,    240.0 free,      0.0 used.    327.0 avail Mem \r\n```\r\n\r\n#### 512Mb RAM + 256Mb swap\r\n\r\nWhen a total of **256Mb of swap** was added to the **512Mb of physical RAM**, the process **succeeded** 9/10 times in creating _both keystore files_, AND failed 1/10 times to generate the `Raw Transaction Data` with `Killed`.\r\n\r\nPrior to running any process, the memory usage / availability reported by `top` was\r\n```\r\nMiB Mem :    474.5 total,    297.7 free,    125.6 used,     51.2 buff/cache\r\nMiB Swap:    256.0 total,    256.0 free,      0.0 used.    327.7 avail Mem \r\n```\r\n\r\n## üåç  Your Environment\r\n\r\n`Ubuntu 20.04 LTS` server with `1 vCPU`, `512 Mb RAM`\r\n\r\n**What version of Prysm are you running? (Which release)**\r\n\r\n`validator-v1.0.0-alpha.7-linux-amd64`\r\n\r\n**Full transcript of session**\r\n```\r\nubuntu@pistachio:~$ mkdir prysm \\\r\n>                   && cd prysm \r\nubuntu@pistachio:~/prysm$ curl https://raw.githubusercontent.com/prysmaticlabs/prysm/master/prysm.sh \\\r\n>                   --output prysm.sh \\\r\n>                   && chmod +x prysm.sh \r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100  7772  100  7772    0     0  28785      0 --:--:-- --:--:-- --:--:-- 28678\r\nubuntu@pistachio:~/prysm$ ./prysm.sh \\\r\n>                   validator \\\r\n>                   accounts \\\r\n>                   create \\\r\n>                   --password changeme \\\r\n>                   --keystore-path /home/ubuntu/.eth2validators\r\nLatest Prysm version is v1.0.0-alpha.7.\r\nDownloading validator@v1.0.0-alpha.7 to /home/ubuntu/prysm/dist/validator-v1.0.0-alpha.7-linux-amd64 (automatically selected latest available version)\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100 32.4M  100 32.4M    0     0   150M      0 --:--:-- --:--:-- --:--:--  150M\r\nVerifying binary integrity.\r\ngpg: key 72E33E4DF1A5036E: public key \"Preston Van Loon <preston@prysmaticlabs.com>\" imported\r\ngpg: Total number processed: 1\r\ngpg:               imported: 1\r\nvalidator-v1.0.0-alpha.7-linux-amd64: OK\r\ngpg: Signature made Sat May  9 19:59:36 2020 UTC\r\ngpg:                using RSA key 0AE0051D647BA3C1A917AF4072E33E4DF1A5036E\r\ngpg: Good signature from \"Preston Van Loon <preston@prysmaticlabs.com>\" [unknown]\r\ngpg: WARNING: This key is not certified with a trusted signature!\r\ngpg:          There is no indication that the signature belongs to the owner.\r\nPrimary key fingerprint: 0AE0 051D 647B A3C1 A917  AF40 72E3 3E4D F1A5 036E\r\nVerified /home/ubuntu/prysm/dist/validator-v1.0.0-alpha.7-linux-amd64 has been signed by Prysmatic Labs.\r\nStarting Prysm validator accounts create --password changeme --keystore-path /home/ubuntu/.eth2validators\r\n2020/05/12 14:03:26 maxprocs: Leaving GOMAXPROCS=1: CPU quota undefined\r\n[2020-05-12 14:03:26]  WARN flags: Using default mainnet config\r\n[2020-05-12 14:03:27]  INFO accounts: Keystore generated for shard withdrawals at path path=/home/ubuntu/.eth2validators/shardwithdrawalkeya53410e31197\r\nKilled\r\nubuntu@pistachio:~/prysm$ \r\n```",
  "closed_by": {
    "login": "rauljordan",
    "id": 5572669,
    "node_id": "MDQ6VXNlcjU1NzI2Njk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5572669?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rauljordan",
    "html_url": "https://github.com/rauljordan",
    "followers_url": "https://api.github.com/users/rauljordan/followers",
    "following_url": "https://api.github.com/users/rauljordan/following{/other_user}",
    "gists_url": "https://api.github.com/users/rauljordan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rauljordan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rauljordan/subscriptions",
    "organizations_url": "https://api.github.com/users/rauljordan/orgs",
    "repos_url": "https://api.github.com/users/rauljordan/repos",
    "events_url": "https://api.github.com/users/rauljordan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rauljordan/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/627435391",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/5830#issuecomment-627435391",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830",
    "id": 627435391,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNzQzNTM5MQ==",
    "user": {
      "login": "0xKiwi",
      "id": 6251510,
      "node_id": "MDQ6VXNlcjYyNTE1MTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6251510?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/0xKiwi",
      "html_url": "https://github.com/0xKiwi",
      "followers_url": "https://api.github.com/users/0xKiwi/followers",
      "following_url": "https://api.github.com/users/0xKiwi/following{/other_user}",
      "gists_url": "https://api.github.com/users/0xKiwi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/0xKiwi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0xKiwi/subscriptions",
      "organizations_url": "https://api.github.com/users/0xKiwi/orgs",
      "repos_url": "https://api.github.com/users/0xKiwi/repos",
      "events_url": "https://api.github.com/users/0xKiwi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/0xKiwi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-12T15:59:20Z",
    "updated_at": "2020-05-12T15:59:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for reporting @chrishobcroft ! @prestonvanloon , how do you think we should handle this? This is a rather simple process so I'm surprised it takes up so much memory, could there be something we can improve?",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/627435391/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/627453571",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/5830#issuecomment-627453571",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830",
    "id": 627453571,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNzQ1MzU3MQ==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-12T16:31:12Z",
    "updated_at": "2020-05-12T16:31:12Z",
    "author_association": "MEMBER",
    "body": "We can look at the memory usage of the keystore creation to see if where we can reduce the memory profile. Otherwise, this system is below the minimum supported requirements for memory. ",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/627453571/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/627802468",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/5830#issuecomment-627802468",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830",
    "id": 627802468,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNzgwMjQ2OA==",
    "user": {
      "login": "chrishobcroft",
      "id": 2212651,
      "node_id": "MDQ6VXNlcjIyMTI2NTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2212651?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chrishobcroft",
      "html_url": "https://github.com/chrishobcroft",
      "followers_url": "https://api.github.com/users/chrishobcroft/followers",
      "following_url": "https://api.github.com/users/chrishobcroft/following{/other_user}",
      "gists_url": "https://api.github.com/users/chrishobcroft/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chrishobcroft/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chrishobcroft/subscriptions",
      "organizations_url": "https://api.github.com/users/chrishobcroft/orgs",
      "repos_url": "https://api.github.com/users/chrishobcroft/repos",
      "events_url": "https://api.github.com/users/chrishobcroft/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chrishobcroft/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-13T07:29:05Z",
    "updated_at": "2020-05-13T07:46:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "@prestonvanloon this system is only running a Validator, with a remote Beacon Chain. I couldn't find any minimum supported requirements for memory for a node running only a Validator - do you know of any?\r\n\r\nFrom initial testing, it would appear that the Validator process requires somewhere between `18Mb` and `26Mb` during normal operations on `Ubuntu 20.04 LTS` (see below screenshot from Grafana)\r\n\r\n![Screenshot from 2020-05-13 12-27-00](https://user-images.githubusercontent.com/2212651/81781405-adbe4080-9515-11ea-9211-32a6b8acdb3a.png)\r\n\r\nAlso, the node operates at 48-52% of RAM used, `Ubuntu 20.04 LTS` server with `512Mb RAM`and no swap (ironically, with Prometheus and Grafana using more RAM than Validator!) (see below screenshot from `top`):\r\n\r\n![image](https://user-images.githubusercontent.com/2212651/81782029-d135bb00-9516-11ea-9c86-699fe9dcb49c.png)\r\n\r\nSo, it would seem that the process requires _much_ more RAM (~300-400Mb) for setup (generate keys, generate raw txn data) and also for startup (decrypt keys, start validating), than it does for ongoing validation (~18-26Mb)\r\n\r\nDoing something which reduces this initial resource requirement can help in getting Validators (with remote Beacons) operating on devices with substantially lower resource availability.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/627802468/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/628259721",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/5830#issuecomment-628259721",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830",
    "id": 628259721,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyODI1OTcyMQ==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-13T21:38:27Z",
    "updated_at": "2020-05-13T21:38:27Z",
    "author_association": "MEMBER",
    "body": "@chrishobcroft This is great feedback. Thanks for taking the time to put it together with screenshots and all of your analysis. I agree that the validator in this setup should be very lightweight on memory usage. I believe the default keystore, which is used in go-ethereum, might be a memory hard encryption scheme or somehow needs to load a relatively significant portion of memory to complete the number of encryption / decryption rounds it needs.\r\n\r\nWith that said, the current default key management is soon to be deprecated and replaced. I would like to keep this issue open as a hard requirement for the next keystore implementation, which should be picking up progress in the next few weeks. Ideally, this change would land before the scheduled Topaz reset (after v0.12 spec release) and become the new default. \r\n\r\nWith regards to minimum requirements for a validator, we haven't taken the time to properly bench these processes so I don't have a great answer at the moment. All we know is that there is still much room for improvement in certain areas of the application for resource usage.\r\n\r\nHow does all of that sound?",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/628259721/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/628407350",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/5830#issuecomment-628407350",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830",
    "id": 628407350,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyODQwNzM1MA==",
    "user": {
      "login": "criticaltv",
      "id": 59374467,
      "node_id": "MDQ6VXNlcjU5Mzc0NDY3",
      "avatar_url": "https://avatars.githubusercontent.com/u/59374467?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/criticaltv",
      "html_url": "https://github.com/criticaltv",
      "followers_url": "https://api.github.com/users/criticaltv/followers",
      "following_url": "https://api.github.com/users/criticaltv/following{/other_user}",
      "gists_url": "https://api.github.com/users/criticaltv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/criticaltv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/criticaltv/subscriptions",
      "organizations_url": "https://api.github.com/users/criticaltv/orgs",
      "repos_url": "https://api.github.com/users/criticaltv/repos",
      "events_url": "https://api.github.com/users/criticaltv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/criticaltv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-14T06:05:10Z",
    "updated_at": "2020-05-14T06:05:10Z",
    "author_association": "NONE",
    "body": "@prestonvanloon it all sounds very good. Thank you for taking the time to explain the situation!\r\n\r\nSadly my coding skills are very rusty, but I enjoy the analysis side of running platforms and protocols.\r\n\r\nKeep up the great work @prysmaticlabs",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/628407350/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/628829647",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/5830#issuecomment-628829647",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830",
    "id": 628829647,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyODgyOTY0Nw==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-14T19:02:35Z",
    "updated_at": "2020-05-14T19:02:35Z",
    "author_association": "MEMBER",
    "body": "Another user reported about 500mb validator usage at startup of normal operations. The memory was eventually reclaimed without restarting. I suspect there is something terrible with the keystore.\r\n\r\n![image](https://user-images.githubusercontent.com/7246818/81974696-c3496e00-95da-11ea-8ae8-403b7e335be8.png)\r\n\r\nYellow line = validator memory",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/628829647/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/629702095",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/5830#issuecomment-629702095",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830",
    "id": 629702095,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyOTcwMjA5NQ==",
    "user": {
      "login": "GuillaumeMiralles",
      "id": 23481418,
      "node_id": "MDQ6VXNlcjIzNDgxNDE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/23481418?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/GuillaumeMiralles",
      "html_url": "https://github.com/GuillaumeMiralles",
      "followers_url": "https://api.github.com/users/GuillaumeMiralles/followers",
      "following_url": "https://api.github.com/users/GuillaumeMiralles/following{/other_user}",
      "gists_url": "https://api.github.com/users/GuillaumeMiralles/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/GuillaumeMiralles/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GuillaumeMiralles/subscriptions",
      "organizations_url": "https://api.github.com/users/GuillaumeMiralles/orgs",
      "repos_url": "https://api.github.com/users/GuillaumeMiralles/repos",
      "events_url": "https://api.github.com/users/GuillaumeMiralles/events{/privacy}",
      "received_events_url": "https://api.github.com/users/GuillaumeMiralles/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-16T20:31:16Z",
    "updated_at": "2020-05-16T21:23:16Z",
    "author_association": "NONE",
    "body": "I want to clarify something here, the graph is using the metrics `process_resident_memory_bytes` which seems to be the allocated memory for the process, and not the used one in the end.\r\n\r\nWith the metrics `go_memstats_alloc_bytes` the spike is way shorter and smaller at start\r\n\r\nThis screenshot shows the exact moment than the previous one but with the `go_memstats_alloc_bytes` metric instead\r\n![image](https://user-images.githubusercontent.com/23481418/82129667-bab48b80-97c4-11ea-9e79-81c9c5323e3a.png)\r\n\r\nThe validator is taking twice less memory and only for 10 minutes maximum\r\n\r\nNot sure this info is useful, but better sharing still",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/629702095/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/629746601",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/5830#issuecomment-629746601",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830",
    "id": 629746601,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyOTc0NjYwMQ==",
    "user": {
      "login": "criticaltv",
      "id": 59374467,
      "node_id": "MDQ6VXNlcjU5Mzc0NDY3",
      "avatar_url": "https://avatars.githubusercontent.com/u/59374467?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/criticaltv",
      "html_url": "https://github.com/criticaltv",
      "followers_url": "https://api.github.com/users/criticaltv/followers",
      "following_url": "https://api.github.com/users/criticaltv/following{/other_user}",
      "gists_url": "https://api.github.com/users/criticaltv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/criticaltv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/criticaltv/subscriptions",
      "organizations_url": "https://api.github.com/users/criticaltv/orgs",
      "repos_url": "https://api.github.com/users/criticaltv/repos",
      "events_url": "https://api.github.com/users/criticaltv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/criticaltv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-17T05:40:13Z",
    "updated_at": "2020-05-17T05:40:13Z",
    "author_association": "NONE",
    "body": "Thanks @GuillaumeMiralles - it's hard to see the Validator RAM on this diagram.\r\n\r\nGiven that the RAM usage for a Beacon is an order of magnitude higher than a Validator, perhaps the Grafana dashboard template could split them to separate graphs?",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/629746601/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/629749563",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/5830#issuecomment-629749563",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830",
    "id": 629749563,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyOTc0OTU2Mw==",
    "user": {
      "login": "GuillaumeMiralles",
      "id": 23481418,
      "node_id": "MDQ6VXNlcjIzNDgxNDE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/23481418?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/GuillaumeMiralles",
      "html_url": "https://github.com/GuillaumeMiralles",
      "followers_url": "https://api.github.com/users/GuillaumeMiralles/followers",
      "following_url": "https://api.github.com/users/GuillaumeMiralles/following{/other_user}",
      "gists_url": "https://api.github.com/users/GuillaumeMiralles/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/GuillaumeMiralles/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GuillaumeMiralles/subscriptions",
      "organizations_url": "https://api.github.com/users/GuillaumeMiralles/orgs",
      "repos_url": "https://api.github.com/users/GuillaumeMiralles/repos",
      "events_url": "https://api.github.com/users/GuillaumeMiralles/events{/privacy}",
      "received_events_url": "https://api.github.com/users/GuillaumeMiralles/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-17T06:16:18Z",
    "updated_at": "2020-05-17T06:16:18Z",
    "author_association": "NONE",
    "body": "What really matters here is to see the spike at the restart, which we can see it on the graph.\r\nBut to make it more clear, I've done the graph for the **validator only** using the `go_memstat_alloc_bytes` still on the same timeFrame \r\n![image](https://user-images.githubusercontent.com/23481418/82137248-9aadb800-9816-11ea-9dcd-6aeae4d2d7b0.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/629749563/reactions",
      "total_count": 3,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/629749760",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/5830#issuecomment-629749760",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830",
    "id": 629749760,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyOTc0OTc2MA==",
    "user": {
      "login": "criticaltv",
      "id": 59374467,
      "node_id": "MDQ6VXNlcjU5Mzc0NDY3",
      "avatar_url": "https://avatars.githubusercontent.com/u/59374467?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/criticaltv",
      "html_url": "https://github.com/criticaltv",
      "followers_url": "https://api.github.com/users/criticaltv/followers",
      "following_url": "https://api.github.com/users/criticaltv/following{/other_user}",
      "gists_url": "https://api.github.com/users/criticaltv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/criticaltv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/criticaltv/subscriptions",
      "organizations_url": "https://api.github.com/users/criticaltv/orgs",
      "repos_url": "https://api.github.com/users/criticaltv/repos",
      "events_url": "https://api.github.com/users/criticaltv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/criticaltv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-17T06:18:43Z",
    "updated_at": "2020-05-17T06:18:43Z",
    "author_association": "NONE",
    "body": "Thank you @GuillaumeMiralles this is perfect evidence to characterise the issue! Presumably ths spike was after a restart of `validator`?",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/629749760/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/629754086",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/5830#issuecomment-629754086",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830",
    "id": 629754086,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyOTc1NDA4Ng==",
    "user": {
      "login": "GuillaumeMiralles",
      "id": 23481418,
      "node_id": "MDQ6VXNlcjIzNDgxNDE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/23481418?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/GuillaumeMiralles",
      "html_url": "https://github.com/GuillaumeMiralles",
      "followers_url": "https://api.github.com/users/GuillaumeMiralles/followers",
      "following_url": "https://api.github.com/users/GuillaumeMiralles/following{/other_user}",
      "gists_url": "https://api.github.com/users/GuillaumeMiralles/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/GuillaumeMiralles/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GuillaumeMiralles/subscriptions",
      "organizations_url": "https://api.github.com/users/GuillaumeMiralles/orgs",
      "repos_url": "https://api.github.com/users/GuillaumeMiralles/repos",
      "events_url": "https://api.github.com/users/GuillaumeMiralles/events{/privacy}",
      "received_events_url": "https://api.github.com/users/GuillaumeMiralles/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-17T07:11:16Z",
    "updated_at": "2020-05-17T07:11:16Z",
    "author_association": "NONE",
    "body": "Yes it is on restart. after the restart this is all good",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/629754086/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/669668963",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/5830#issuecomment-669668963",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/5830",
    "id": 669668963,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2OTY2ODk2Mw==",
    "user": {
      "login": "rauljordan",
      "id": 5572669,
      "node_id": "MDQ6VXNlcjU1NzI2Njk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5572669?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rauljordan",
      "html_url": "https://github.com/rauljordan",
      "followers_url": "https://api.github.com/users/rauljordan/followers",
      "following_url": "https://api.github.com/users/rauljordan/following{/other_user}",
      "gists_url": "https://api.github.com/users/rauljordan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rauljordan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rauljordan/subscriptions",
      "organizations_url": "https://api.github.com/users/rauljordan/orgs",
      "repos_url": "https://api.github.com/users/rauljordan/repos",
      "events_url": "https://api.github.com/users/rauljordan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rauljordan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-06T03:58:29Z",
    "updated_at": "2020-08-06T03:58:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "No longer relevant",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/669668963/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
