{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7766",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7766/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7766/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7766/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/7766",
  "id": 740088716,
  "node_id": "MDU6SXNzdWU3NDAwODg3MTY=",
  "number": 7766,
  "title": "Missed proposal due to \"validator has already submitted an exit\", but no exit submitted",
  "user": {
    "login": "leontodd",
    "id": 8823227,
    "node_id": "MDQ6VXNlcjg4MjMyMjc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8823227?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/leontodd",
    "html_url": "https://github.com/leontodd",
    "followers_url": "https://api.github.com/users/leontodd/followers",
    "following_url": "https://api.github.com/users/leontodd/following{/other_user}",
    "gists_url": "https://api.github.com/users/leontodd/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/leontodd/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/leontodd/subscriptions",
    "organizations_url": "https://api.github.com/users/leontodd/orgs",
    "repos_url": "https://api.github.com/users/leontodd/repos",
    "events_url": "https://api.github.com/users/leontodd/events{/privacy}",
    "received_events_url": "https://api.github.com/users/leontodd/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 802129904,
      "node_id": "MDU6TGFiZWw4MDIxMjk5MDQ=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Bug",
      "name": "Bug",
      "color": "ee0701",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 1085357069,
      "node_id": "MDU6TGFiZWwxMDg1MzU3MDY5",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Priority:%20High",
      "name": "Priority: High",
      "color": "f7ea26",
      "default": false,
      "description": "High priority item"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-11-10T17:08:19Z",
  "updated_at": "2020-11-11T19:04:13Z",
  "closed_at": "2020-11-11T19:04:12Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!--üíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíé\r\n\r\nHellooo! üòÑ \r\n\r\nTo help us tend to your issue faster, please search our currently open issues before submitting a new one.\r\nExisting issues often contain information about workarounds, resolution, or progress updates.\r\n\r\nüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíé-->\r\n\r\n# üêû Bug Report\r\n\r\n### Description\r\n\r\nI noticed that my validators had been attesting but consistently missing all proposals. I've included the logs from the time of one of the missed proposals below. The log seems to indicate that the proposal failed because the validator had already submitted an exit. I have not exited any validators and can't seem to find any indication that this validator has been submitted for exit.\r\n\r\nI restarted the beacon node and am no longer experiencing this issue - proposals seem to be fine now.\r\n\r\n### Has this worked before in a previous version?\r\n\r\n<!-- Did this behavior use to work in the previous version? -->\r\nI have never experienced this before in previous versions.\r\n\r\n## üî¨ Minimal Reproduction\r\n\r\n<!--\r\nPlease let us know how we can reproduce this issue. Include the exact method you used to run Prysm along with any flags used in your beacon chain and/or validator. Make sure you don't upload any confidential files or private keys.\r\n-->\r\nUnknown\r\n\r\n## üî• Error\r\n\r\n<pre><code>\r\n<!-- If the issue is accompanied by an error, please share the error logs with us below. If you have a lot of logs, place make a paste bin with your logs and share the link with us here: -->\r\ntime=\"2020-11-10 10:24:33\" level=error msg=\"Failed to request block from beacon node\" blockSlot=704822 error=\"rpc error: code = Internal desc = Could not compute state root: could not calculate state root at slot 704821: could not process block: could not process block operation: could not process validator exits: could not verify exit 2: validator has already submitted an exit, which will take place at epoch: 28012\" prefix=validator pubKey=0x88105fd3a50c\r\n\r\n</code></pre>\r\n\r\n\r\n## üåç  Your Environment\r\n\r\n**Operating System:**\r\n\r\n<pre>\r\n  <code>\r\nUbuntu 20.04.1 LTS\r\n  </code>\r\n</pre>\r\n\r\n**What version of Prysm are you running? (Which release)**\r\n\r\n<pre>\r\n  <code>\r\nPrysm v1.0.0-beta.1\r\n  </code>\r\n</pre>\r\n\r\n**Anything else relevant (validator index / public key)?**\r\n\r\nThis is the validator that attempted to propose before the above log was generated, look for the missed proposal at the same timestamp as the log:\r\nhttps://medalla.beaconcha.in/validator/78693\r\n\r\nI have 160 active validators. The 160 validators had 14 proposals from `2020-11-10 01:43:58` to `2020-11-10 12:01:57` (UTC+1).\r\nAll 14 of those showed this same error, but all 14 had different pub keys.",
  "closed_by": {
    "login": "prestonvanloon",
    "id": 7246818,
    "node_id": "MDQ6VXNlcjcyNDY4MTg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/prestonvanloon",
    "html_url": "https://github.com/prestonvanloon",
    "followers_url": "https://api.github.com/users/prestonvanloon/followers",
    "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
    "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
    "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
    "repos_url": "https://api.github.com/users/prestonvanloon/repos",
    "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7766/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7766/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/725593213",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7766#issuecomment-725593213",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7766",
    "id": 725593213,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNTU5MzIxMw==",
    "user": {
      "login": "rkapka",
      "id": 28876818,
      "node_id": "MDQ6VXNlcjI4ODc2ODE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/28876818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rkapka",
      "html_url": "https://github.com/rkapka",
      "followers_url": "https://api.github.com/users/rkapka/followers",
      "following_url": "https://api.github.com/users/rkapka/following{/other_user}",
      "gists_url": "https://api.github.com/users/rkapka/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rkapka/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rkapka/subscriptions",
      "organizations_url": "https://api.github.com/users/rkapka/orgs",
      "repos_url": "https://api.github.com/users/rkapka/repos",
      "events_url": "https://api.github.com/users/rkapka/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rkapka/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-11T18:41:16Z",
    "updated_at": "2020-11-11T18:41:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "I don't think anything can be done here without an explanation of how to reproduce this, @leontodd. Are you able to provide more details?",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/725593213/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/725598016",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7766#issuecomment-725598016",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7766",
    "id": 725598016,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNTU5ODAxNg==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-11T18:51:20Z",
    "updated_at": "2020-11-11T18:51:20Z",
    "author_association": "MEMBER",
    "body": "@rkapka It seems like they had voluntary exit in their queue when that voluntary exit had already been included in the chain. \r\n\r\nThis user is likely not going to be able to give us reproduction instructions so we will have to reverse engineer the problem. \r\nIt is very likely that something is wrong with this method:\r\nhttps://github.com/prysmaticlabs/prysm/blob/fcbb168c76ac6a471fdd6c5a2a1611857883499d/beacon-chain/operations/voluntaryexits/service.go#L34-L57",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/725598016/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/725599375",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7766#issuecomment-725599375",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7766",
    "id": 725599375,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNTU5OTM3NQ==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-11T18:54:13Z",
    "updated_at": "2020-11-11T18:54:13Z",
    "author_association": "MEMBER",
    "body": "I suspect that their voluntary exit pool had two different exits for the same validator.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/725599375/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/725604172",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7766#issuecomment-725604172",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7766",
    "id": 725604172,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNTYwNDE3Mg==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-11T19:04:12Z",
    "updated_at": "2020-11-11T19:04:12Z",
    "author_association": "MEMBER",
    "body": "Fixed by #7774 ",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/725604172/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
