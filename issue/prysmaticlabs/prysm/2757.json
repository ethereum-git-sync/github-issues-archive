{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/2757",
  "id": 452484234,
  "node_id": "MDU6SXNzdWU0NTI0ODQyMzQ=",
  "number": 2757,
  "title": "Enable UPnP for p2p",
  "user": {
    "login": "zediir",
    "id": 418053,
    "node_id": "MDQ6VXNlcjQxODA1Mw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/418053?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/zediir",
    "html_url": "https://github.com/zediir",
    "followers_url": "https://api.github.com/users/zediir/followers",
    "following_url": "https://api.github.com/users/zediir/following{/other_user}",
    "gists_url": "https://api.github.com/users/zediir/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/zediir/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/zediir/subscriptions",
    "organizations_url": "https://api.github.com/users/zediir/orgs",
    "repos_url": "https://api.github.com/users/zediir/repos",
    "events_url": "https://api.github.com/users/zediir/events{/privacy}",
    "received_events_url": "https://api.github.com/users/zediir/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 802129907,
      "node_id": "MDU6TGFiZWw4MDIxMjk5MDc=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Help%20Wanted",
      "name": "Help Wanted",
      "color": "33aa3f",
      "default": false,
      "description": "Extra attention is needed"
    },
    {
      "id": 802129908,
      "node_id": "MDU6TGFiZWw4MDIxMjk5MDg=",
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/labels/Good%20First%20Issue",
      "name": "Good First Issue",
      "color": "7057ff",
      "default": false,
      "description": "Good for newcomers"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "katzdan",
    "id": 3205072,
    "node_id": "MDQ6VXNlcjMyMDUwNzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3205072?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/katzdan",
    "html_url": "https://github.com/katzdan",
    "followers_url": "https://api.github.com/users/katzdan/followers",
    "following_url": "https://api.github.com/users/katzdan/following{/other_user}",
    "gists_url": "https://api.github.com/users/katzdan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/katzdan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/katzdan/subscriptions",
    "organizations_url": "https://api.github.com/users/katzdan/orgs",
    "repos_url": "https://api.github.com/users/katzdan/repos",
    "events_url": "https://api.github.com/users/katzdan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/katzdan/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "katzdan",
      "id": 3205072,
      "node_id": "MDQ6VXNlcjMyMDUwNzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3205072?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/katzdan",
      "html_url": "https://github.com/katzdan",
      "followers_url": "https://api.github.com/users/katzdan/followers",
      "following_url": "https://api.github.com/users/katzdan/following{/other_user}",
      "gists_url": "https://api.github.com/users/katzdan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/katzdan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/katzdan/subscriptions",
      "organizations_url": "https://api.github.com/users/katzdan/orgs",
      "repos_url": "https://api.github.com/users/katzdan/repos",
      "events_url": "https://api.github.com/users/katzdan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/katzdan/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 16,
  "created_at": "2019-06-05T12:52:39Z",
  "updated_at": "2021-05-24T14:03:20Z",
  "closed_at": "2019-06-26T21:09:28Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Apparently libp2p already supports UPnP and PMP https://github.com/libp2p/go-libp2p/issues/319#issuecomment-383505818\r\n\r\nEnabling this would mean users with UPnP enabled routers would not need to configure port forwarding if they want to expose the p2p port.\r\n\r\nNot sure how this would behave with the docker images",
  "closed_by": {
    "login": "prestonvanloon",
    "id": 7246818,
    "node_id": "MDQ6VXNlcjcyNDY4MTg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/prestonvanloon",
    "html_url": "https://github.com/prestonvanloon",
    "followers_url": "https://api.github.com/users/prestonvanloon/followers",
    "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
    "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
    "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
    "repos_url": "https://api.github.com/users/prestonvanloon/repos",
    "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/499195177",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2757#issuecomment-499195177",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757",
    "id": 499195177,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5OTE5NTE3Nw==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-05T18:11:50Z",
    "updated_at": "2019-06-05T18:16:23Z",
    "author_association": "MEMBER",
    "body": "I _think_ this functionality is already enabled within libp2p core library. Also see: https://github.com/libp2p/go-libp2p/issues/375#issuecomment-407122416\r\n\r\nIt seems that providing [NatPortMap](https://godoc.org/github.com/libp2p/go-libp2p#NATPortMap) option might be enough to enable this functionality. I'm not sure how to test this actually works as this method has no explicit tests and documentation is lacking details. Does this automatically broadcast the allocated port / public IP from the router? \r\n\r\nOther references:\r\n- [NatManager](https://godoc.org/github.com/libp2p/go-libp2p/p2p/host/basic#NATManager)\r\n- [go-libp2p-nat](https://godoc.org/github.com/libp2p/go-libp2p-nat) (Wish there were more docs and tests here!!!)\r\n\r\n\r\nWith regards to docker, I believe you can give it access to the host network with `--network host`. That should allow upnp functionality within a docker image. ",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/499195177/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/499195496",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2757#issuecomment-499195496",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757",
    "id": 499195496,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5OTE5NTQ5Ng==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-05T18:12:46Z",
    "updated_at": "2019-06-05T18:12:46Z",
    "author_association": "MEMBER",
    "body": "Labelling with help wanted, if anyone wants to investigate this issue and report their findings here.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/499195496/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/500493891",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2757#issuecomment-500493891",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757",
    "id": 500493891,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMDQ5Mzg5MQ==",
    "user": {
      "login": "katzdan",
      "id": 3205072,
      "node_id": "MDQ6VXNlcjMyMDUwNzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3205072?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/katzdan",
      "html_url": "https://github.com/katzdan",
      "followers_url": "https://api.github.com/users/katzdan/followers",
      "following_url": "https://api.github.com/users/katzdan/following{/other_user}",
      "gists_url": "https://api.github.com/users/katzdan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/katzdan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/katzdan/subscriptions",
      "organizations_url": "https://api.github.com/users/katzdan/orgs",
      "repos_url": "https://api.github.com/users/katzdan/repos",
      "events_url": "https://api.github.com/users/katzdan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/katzdan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-10T16:56:52Z",
    "updated_at": "2019-06-10T16:56:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'll look into it.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/500493891/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/501613587",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2757#issuecomment-501613587",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757",
    "id": 501613587,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMTYxMzU4Nw==",
    "user": {
      "login": "katzdan",
      "id": 3205072,
      "node_id": "MDQ6VXNlcjMyMDUwNzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3205072?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/katzdan",
      "html_url": "https://github.com/katzdan",
      "followers_url": "https://api.github.com/users/katzdan/followers",
      "following_url": "https://api.github.com/users/katzdan/following{/other_user}",
      "gists_url": "https://api.github.com/users/katzdan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/katzdan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/katzdan/subscriptions",
      "organizations_url": "https://api.github.com/users/katzdan/orgs",
      "repos_url": "https://api.github.com/users/katzdan/repos",
      "events_url": "https://api.github.com/users/katzdan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/katzdan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-13T08:55:18Z",
    "updated_at": "2019-06-13T08:55:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "Initial test results:\r\n1. I added the libp2p.NATPortMap() option in the libp2p new instance creation in /shared/options.go, /tools/bootnode.go, /tools/bootnode-query/main.go and in /boot/relaynode/relaynode.go.\r\n2. I enabled UPNP on my router.\r\n3. Ran the beacon-chain service with and without UPNP and saw there are differences in the logs:\r\nWithout UPNP : \r\n![without_upnp](https://user-images.githubusercontent.com/3205072/59418332-0e6b6780-8df3-11e9-8e27-c7f93f59ba75.png)\r\n\r\nWith UPNP:\r\n![with_upnp](https://user-images.githubusercontent.com/3205072/59418404-30fd8080-8df3-11e9-8fbb-a489efb04cf9.png)\r\n\r\nI can see lots of \r\n - \"ERROR p2p : Failed to write handshare to peer\" \r\n - \"WARN p2p : Disconnecting from peer on different contract\" \r\n\r\nI didn't see these msgs when UPNP was disabled on the router.\r\n\r\nTeam, any ideas?",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/501613587/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/501731088",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2757#issuecomment-501731088",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757",
    "id": 501731088,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMTczMTA4OA==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-13T14:37:21Z",
    "updated_at": "2019-06-13T14:37:21Z",
    "author_association": "MEMBER",
    "body": "Those warnings are normal. It means that someone else is connect to the network and asking for the wrong contract. These context failures seem like a bigger issue.\r\n\r\nThe real test is if you can dial your node from the outside world. Have you been able to verify that? ",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/501731088/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/501736947",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2757#issuecomment-501736947",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757",
    "id": 501736947,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMTczNjk0Nw==",
    "user": {
      "login": "katzdan",
      "id": 3205072,
      "node_id": "MDQ6VXNlcjMyMDUwNzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3205072?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/katzdan",
      "html_url": "https://github.com/katzdan",
      "followers_url": "https://api.github.com/users/katzdan/followers",
      "following_url": "https://api.github.com/users/katzdan/following{/other_user}",
      "gists_url": "https://api.github.com/users/katzdan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/katzdan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/katzdan/subscriptions",
      "organizations_url": "https://api.github.com/users/katzdan/orgs",
      "repos_url": "https://api.github.com/users/katzdan/repos",
      "events_url": "https://api.github.com/users/katzdan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/katzdan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-13T14:50:58Z",
    "updated_at": "2019-06-13T14:50:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks @prestonvanloon , I'll check that and report.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/501736947/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/503664594",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2757#issuecomment-503664594",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757",
    "id": 503664594,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMzY2NDU5NA==",
    "user": {
      "login": "katzdan",
      "id": 3205072,
      "node_id": "MDQ6VXNlcjMyMDUwNzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3205072?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/katzdan",
      "html_url": "https://github.com/katzdan",
      "followers_url": "https://api.github.com/users/katzdan/followers",
      "following_url": "https://api.github.com/users/katzdan/following{/other_user}",
      "gists_url": "https://api.github.com/users/katzdan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/katzdan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/katzdan/subscriptions",
      "organizations_url": "https://api.github.com/users/katzdan/orgs",
      "repos_url": "https://api.github.com/users/katzdan/repos",
      "events_url": "https://api.github.com/users/katzdan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/katzdan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-19T17:53:57Z",
    "updated_at": "2019-06-19T17:53:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi,\r\n\r\nfindings: \r\n1. When enabling UPNP  and using NATPortMap() as one of the option in libp2p.New() - a new address is added to the multiAddr \r\nWithout NATPortMap() :\r\n[2019-06-19 22:39:01]  INFO p2p: [/ip4/192.168.0.107/tcp/12000]\r\nWith  NATPortMap() :\r\n[2019-06-19 22:42:21]  INFO p2p: [/ip4/192.168.0.107/tcp/12000 **/ip4/118.173.172.41/tcp/10331**]\r\nThe second address' ip address segment is, of course, my public ip address.\r\n\r\n2. I can see that libp2p used UPNP to open a port in the router admin console:\r\n![upnp-stats](https://user-images.githubusercontent.com/3205072/59782794-f14e0180-92e8-11e9-8326-082d63409768.png)\r\n\r\n3. Finally - I created a node.js script that tries to connect to the peerId of the beacon service directly. \r\n2019-06-19T17:46:01.778638+00:00 app[web.1]: node has started (true/false): true\r\n2019-06-19T17:46:01.779088+00:00 app[web.1]: listening on:\r\n2019-06-19T17:46:01.779300+00:00 app[web.1]: /ip4/127.0.0.1/tcp/46115/ipfs/QmS82vo2wdQrn8nBeJta54zodfNJW7BaeFJAbaCZAWfg9r\r\n2019-06-19T17:46:01.779456+00:00 app[web.1]: /ip4/172.19.46.50/tcp/46115/ipfs/QmS82vo2wdQrn8nBeJta54zodfNJW7BaeFJAbaCZAWfg9r\r\n2019-06-19T17:46:02.603465+00:00 app[web.1]: /app/prysm-libp2p-upnp-test.js:62\r\n2019-06-19T17:46:02.603496+00:00 app[web.1]: throw err\r\n2019-06-19T17:46:02.603504+00:00 app[web.1]: **Error: \"/plaintext/1.0.0\" not supported**\r\n\r\nThe last line shows that there is a connection (it's rejected because the sample sends a protocol that's not supported but at that point the peers are already connected).\r\n\r\nTo conclude - the NATPortMap() looks like it's working.\r\n@terencechain -  thanks for the guidelines you gave me.\r\n@prestonvanloon  - are there any additional tests/research that needs to be done? or shall I move forward with code changes and add NATPortMap() in the libp2p.New calls?\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/503664594/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/503805871",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2757#issuecomment-503805871",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757",
    "id": 503805871,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwMzgwNTg3MQ==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-20T01:34:38Z",
    "updated_at": "2019-06-20T01:34:38Z",
    "author_association": "MEMBER",
    "body": "Awesome! This is excellent work. \r\n\r\nLet’s add this as a feature flag where the default value is OFF. We can test it out in a few scenarios and then graduate the flag with default value ON. ",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/503805871/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/505478630",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2757#issuecomment-505478630",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757",
    "id": 505478630,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNTQ3ODYzMA==",
    "user": {
      "login": "gitcoinbot",
      "id": 27903976,
      "node_id": "MDQ6VXNlcjI3OTAzOTc2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27903976?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gitcoinbot",
      "html_url": "https://github.com/gitcoinbot",
      "followers_url": "https://api.github.com/users/gitcoinbot/followers",
      "following_url": "https://api.github.com/users/gitcoinbot/following{/other_user}",
      "gists_url": "https://api.github.com/users/gitcoinbot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gitcoinbot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gitcoinbot/subscriptions",
      "organizations_url": "https://api.github.com/users/gitcoinbot/orgs",
      "repos_url": "https://api.github.com/users/gitcoinbot/repos",
      "events_url": "https://api.github.com/users/gitcoinbot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gitcoinbot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-25T14:46:51Z",
    "updated_at": "2019-06-25T14:46:51Z",
    "author_association": "NONE",
    "body": "Issue Status: 1. **Open** 2. Started 3. Submitted 4. Done \n\n<hr>\n\n__This issue now has a funding of 300.0 DAI (300.0 USD @ $1.0/DAI)  attached to it.__\n\n * If you would like to work on this issue you can 'start work' [on the Gitcoin Issue Details page](https://gitcoin.co/issue/prysmaticlabs/prysm/2757/3178).\n* Want to chip in? Add your own contribution [here](https://gitcoin.co/issue/prysmaticlabs/prysm/2757/3178).\n* Questions? Checkout <a href='https://gitcoin.co/help'>Gitcoin Help</a> or the <a href='https://gitcoin.co/slack'>Gitcoin Slack</a>\n* $129,280.43 more funded OSS Work available on the [Gitcoin Issue Explorer](https://gitcoin.co/explorer)\n",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/505478630/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/505504015",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2757#issuecomment-505504015",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757",
    "id": 505504015,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNTUwNDAxNQ==",
    "user": {
      "login": "gitcoinbot",
      "id": 27903976,
      "node_id": "MDQ6VXNlcjI3OTAzOTc2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27903976?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gitcoinbot",
      "html_url": "https://github.com/gitcoinbot",
      "followers_url": "https://api.github.com/users/gitcoinbot/followers",
      "following_url": "https://api.github.com/users/gitcoinbot/following{/other_user}",
      "gists_url": "https://api.github.com/users/gitcoinbot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gitcoinbot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gitcoinbot/subscriptions",
      "organizations_url": "https://api.github.com/users/gitcoinbot/orgs",
      "repos_url": "https://api.github.com/users/gitcoinbot/repos",
      "events_url": "https://api.github.com/users/gitcoinbot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gitcoinbot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-25T15:45:46Z",
    "updated_at": "2019-07-09T17:33:05Z",
    "author_association": "NONE",
    "body": "Issue Status: 1. Open 2. Started 3. Submitted 4. **Done** \n\n<hr>\n\n__Work has been started__.\n\n\nThese users each claimed they can complete the work by 11 months, 2 weeks from now.\nPlease review their action plans below:\n\n\n**1) [katzdan](https://gitcoin.co/profile/katzdan) has been approved to start work.**\n\nAdd the option for NAT enabled comm during libp2p init.\n\nLearn more [on the Gitcoin Issue Details page](https://gitcoin.co/issue/prysmaticlabs/prysm/2757/3178).\n\n",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/505504015/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/506046024",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2757#issuecomment-506046024",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757",
    "id": 506046024,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjA0NjAyNA==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-26T21:09:26Z",
    "updated_at": "2019-06-26T21:09:26Z",
    "author_association": "MEMBER",
    "body": "Resolved in #2860. Thanks for all of the research and a quick turn around on the feature! ",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/506046024/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/506712669",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2757#issuecomment-506712669",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757",
    "id": 506712669,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwNjcxMjY2OQ==",
    "user": {
      "login": "gitcoinbot",
      "id": 27903976,
      "node_id": "MDQ6VXNlcjI3OTAzOTc2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27903976?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gitcoinbot",
      "html_url": "https://github.com/gitcoinbot",
      "followers_url": "https://api.github.com/users/gitcoinbot/followers",
      "following_url": "https://api.github.com/users/gitcoinbot/following{/other_user}",
      "gists_url": "https://api.github.com/users/gitcoinbot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gitcoinbot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gitcoinbot/subscriptions",
      "organizations_url": "https://api.github.com/users/gitcoinbot/orgs",
      "repos_url": "https://api.github.com/users/gitcoinbot/repos",
      "events_url": "https://api.github.com/users/gitcoinbot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gitcoinbot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-28T12:15:34Z",
    "updated_at": "2019-06-28T12:15:34Z",
    "author_association": "NONE",
    "body": "Issue Status: 1. Open 2. Started 3. **Submitted** 4. Done \n\n<hr>\n\n__Work for 300.0 DAI (300.0 USD @ $1.0/DAI) has been submitted by__:\n\n 1. [@katzdan](https://gitcoin.co/profile/katzdan)\n\n\n\n@ceresstation please take a look at the submitted work:\n* [PR](https://github.com/prysmaticlabs/prysm/pull/2860) by @katzdan\n\n<hr>\n\n* Learn more [on the Gitcoin Issue Details page](https://gitcoin.co/issue/prysmaticlabs/prysm/2757/3178)\n* Want to chip in? Add your own contribution [here](https://gitcoin.co/issue/prysmaticlabs/prysm/2757/3178).\n* Questions? Checkout <a href='https://gitcoin.co/help'>Gitcoin Help</a> or the <a href='https://gitcoin.co/slack'>Gitcoin Slack</a>\n* $129,667.20 more funded OSS Work available on the [Gitcoin Issue Explorer](https://gitcoin.co/explorer)",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/506712669/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/508204436",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2757#issuecomment-508204436",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757",
    "id": 508204436,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwODIwNDQzNg==",
    "user": {
      "login": "prestonvanloon",
      "id": 7246818,
      "node_id": "MDQ6VXNlcjcyNDY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7246818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestonvanloon",
      "html_url": "https://github.com/prestonvanloon",
      "followers_url": "https://api.github.com/users/prestonvanloon/followers",
      "following_url": "https://api.github.com/users/prestonvanloon/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestonvanloon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestonvanloon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestonvanloon/subscriptions",
      "organizations_url": "https://api.github.com/users/prestonvanloon/orgs",
      "repos_url": "https://api.github.com/users/prestonvanloon/repos",
      "events_url": "https://api.github.com/users/prestonvanloon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestonvanloon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-07-03T18:22:30Z",
    "updated_at": "2019-07-03T18:22:30Z",
    "author_association": "MEMBER",
    "body": "@ceresstation can you help to release the bounty please?",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/508204436/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/509735273",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2757#issuecomment-509735273",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757",
    "id": 509735273,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUwOTczNTI3Mw==",
    "user": {
      "login": "gitcoinbot",
      "id": 27903976,
      "node_id": "MDQ6VXNlcjI3OTAzOTc2",
      "avatar_url": "https://avatars.githubusercontent.com/u/27903976?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gitcoinbot",
      "html_url": "https://github.com/gitcoinbot",
      "followers_url": "https://api.github.com/users/gitcoinbot/followers",
      "following_url": "https://api.github.com/users/gitcoinbot/following{/other_user}",
      "gists_url": "https://api.github.com/users/gitcoinbot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gitcoinbot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gitcoinbot/subscriptions",
      "organizations_url": "https://api.github.com/users/gitcoinbot/orgs",
      "repos_url": "https://api.github.com/users/gitcoinbot/repos",
      "events_url": "https://api.github.com/users/gitcoinbot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gitcoinbot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-07-09T17:33:17Z",
    "updated_at": "2019-07-09T17:33:17Z",
    "author_association": "NONE",
    "body": "Issue Status: 1. Open 2. Started 3. Submitted 4. **Done** \n\n<hr>\n\n__The funding of 300.0 DAI (300.0 USD @ $1.0/DAI)  attached to this issue has been approved & issued to @katzdan.__  \n\n \n* Learn more [on the Gitcoin Issue Details page](https://gitcoin.co/issue/prysmaticlabs/prysm/2757/3178)\n* Questions? Checkout <a href='https://gitcoin.co/help'>Gitcoin Help</a> or the <a href='https://gitcoin.co/slack'>Gitcoin Slack</a>\n* $136,036.43 more funded OSS Work available on the [Gitcoin Issue Explorer](https://gitcoin.co/explorer)\n",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/509735273/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/846995632",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2757#issuecomment-846995632",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757",
    "id": 846995632,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0Njk5NTYzMg==",
    "user": {
      "login": "valepakh",
      "id": 8614891,
      "node_id": "MDQ6VXNlcjg2MTQ4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8614891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/valepakh",
      "html_url": "https://github.com/valepakh",
      "followers_url": "https://api.github.com/users/valepakh/followers",
      "following_url": "https://api.github.com/users/valepakh/following{/other_user}",
      "gists_url": "https://api.github.com/users/valepakh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/valepakh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/valepakh/subscriptions",
      "organizations_url": "https://api.github.com/users/valepakh/orgs",
      "repos_url": "https://api.github.com/users/valepakh/repos",
      "events_url": "https://api.github.com/users/valepakh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/valepakh/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-24T12:01:53Z",
    "updated_at": "2021-05-24T12:02:31Z",
    "author_association": "NONE",
    "body": "I found that UPnP doesn't help me in maintaining a list of peers.\r\nI see two problems here: first, even without UPnP enabled, when doing initial-sync, I quickly get a lot of peers, around 50, then they gradually disconnect and then I left in a state without enough peers: `INFO initial-sync: Waiting for enough suitable peers before syncing required=3 suitable=2`.\r\nI think something can be improved here, maybe run peer discovery again when there're not enough suitable peers?\r\n\r\nSecond, when UPnP is enabled through the flag, I can see the port forwarded in the router but there's no traffic going through it.\r\nThe client says `INFO p2p: Node started p2p server multiAddr=/ip4/192.168.88.162/tcp/13000/p2p/16Uiu2HAmF2BqggiCKRhXZeV7SHTWHAW6xDxuGqvPuUyuMzrsDqPD`\r\nBut in the comment above I see that the public IP address was printed in this line.\r\nOther services seems to be working fine with UPnP, I can see a couple with non-null traffic in the router interface.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/846995632/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/847063979",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/2757#issuecomment-847063979",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/2757",
    "id": 847063979,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NzA2Mzk3OQ==",
    "user": {
      "login": "valepakh",
      "id": 8614891,
      "node_id": "MDQ6VXNlcjg2MTQ4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8614891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/valepakh",
      "html_url": "https://github.com/valepakh",
      "followers_url": "https://api.github.com/users/valepakh/followers",
      "following_url": "https://api.github.com/users/valepakh/following{/other_user}",
      "gists_url": "https://api.github.com/users/valepakh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/valepakh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/valepakh/subscriptions",
      "organizations_url": "https://api.github.com/users/valepakh/orgs",
      "repos_url": "https://api.github.com/users/valepakh/repos",
      "events_url": "https://api.github.com/users/valepakh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/valepakh/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-24T14:03:20Z",
    "updated_at": "2021-05-24T14:03:20Z",
    "author_association": "NONE",
    "body": "I found possible reason why default UPnP doesn't work - the port opened on the router is random and p2p client doesn't seem to be getting this port to broadcast to peers. So the proper fix would probably be to get the mapping from the library, if libp2p can do this.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/847063979/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
