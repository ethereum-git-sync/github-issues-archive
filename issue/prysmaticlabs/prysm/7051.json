{
  "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7051",
  "repository_url": "https://api.github.com/repos/prysmaticlabs/prysm",
  "labels_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7051/labels{/name}",
  "comments_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7051/comments",
  "events_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7051/events",
  "html_url": "https://github.com/prysmaticlabs/prysm/issues/7051",
  "id": 681844169,
  "node_id": "MDU6SXNzdWU2ODE4NDQxNjk=",
  "number": 7051,
  "title": "Prysm attacknet config bug",
  "user": {
    "login": "protolambda",
    "id": 19571989,
    "node_id": "MDQ6VXNlcjE5NTcxOTg5",
    "avatar_url": "https://avatars.githubusercontent.com/u/19571989?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/protolambda",
    "html_url": "https://github.com/protolambda",
    "followers_url": "https://api.github.com/users/protolambda/followers",
    "following_url": "https://api.github.com/users/protolambda/following{/other_user}",
    "gists_url": "https://api.github.com/users/protolambda/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/protolambda/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/protolambda/subscriptions",
    "organizations_url": "https://api.github.com/users/protolambda/orgs",
    "repos_url": "https://api.github.com/users/protolambda/repos",
    "events_url": "https://api.github.com/users/protolambda/events{/privacy}",
    "received_events_url": "https://api.github.com/users/protolambda/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2020-08-19T13:32:55Z",
  "updated_at": "2020-08-19T15:42:25Z",
  "closed_at": "2020-08-19T15:42:25Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!--üíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíé\r\n\r\nHellooo! üòÑ \r\n\r\nTo help us tend to your issue faster, please search our currently open issues before submitting a new one.\r\nExisting issues often contain information about workarounds, resolution, or progress updates.\r\n\r\nüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíéüíé-->\r\n\r\n# üêû Bug Report\r\n\r\n### Description\r\n\r\nWhen configured with to run on the attacknet, it reports a correct chain, correct deposit, but bad genesis time: it reports the medalla genesis time instead of attacknet genesis time. Status message validation subsequently fails, and prysm nodes lost all peers.\r\n\r\n### Has this worked before in a previous version?\r\n\r\n<!-- Did this behavior use to work in the previous version? -->\r\n<!-- ‚úçÔ∏è--> Yes, the previous version in which this bug was not present was: ....\r\n\r\nYes, this exact configuration worked on a previous version, at least around the time before the medalla incident.\r\n\r\n## üî¨ Minimal Reproduction\r\n\r\n<!--\r\nPlease let us know how we can reproduce this issue. Include the exact method you used to run Prysm along with any flags used in your beacon chain and/or validator. Make sure you don't upload any confidential files or private keys.\r\n-->\r\n\r\nTry and start a prysm node on the multi-client attacknet, with configuration from here: https://github.com/ethereum/public-attacknets/blob/master/attacknets/beta-1/mc-attack-0/prysm_config.yml\r\n\r\nAnd run args:\r\n```\r\n--datadir=/data --chain-config-file=/data/custom_testnet_config/prysm_config.yaml --deposit-contract=0x38c750cFFb382cDD3644C40A39540a9b4b46b0cf --contract-deployment-block=3150443 --p2p-max-peers=60 --p2p-udp-port=9000 --p2p-tcp-port=9000 --monitoring-host=0.0.0.0 --monitoring-port=8080 --rpc-host=0.0.0.0 --rpc-port=4001 --grpc-gateway-host=0.0.0.0 --grpc-gateway-port=4000 --verbosity=debug --enable-debug-rpc-endpoints --min-sync-peers 1 --bootstrap-node=enr:-Ku4QI8MOucZczvp5J9-du3Sw7QFYOJwwhEYYNSJT5wva9t2IRV7d_IZ1kghxAccr4-dUcM7mCCtl8fhGPLX8aCZJ6EDh2F0dG5ldHOIAAAAAAAAAACEZXRoMpBVtop0AACwHf__________gmlkgnY0gmlwhDbdsRuJc2VjcDI1NmsxoQJhL9xgltjZulN0GGB1TOJNUyDx6aE2yf1m8L_ZJZ_UR4N1ZHCCIyg\"\r\n```\r\n\r\n## üî• Error\r\n\r\n<pre><code>\r\ncurl localhost:4000/eth/v1alpha1/node/genesis\r\n{\"genesisTime\":\"2020-08-04T13:00:08Z\",\"depositContractAddress\":\"OMdQz/s4LN02RMQKOVQKm0tGsM8=\",\"genesisValidatorsRoot\":\"YO42PkQeUzsYxqi22r9asCRtt717XtTv2E+KHDstCIs=\"}\r\n\r\n</code></pre>\r\n\r\n<pre><code>\r\ntime=\"2020-08-19 12:55:29\" level=debug msg=\"Invalid status message from peer\" error=\"invalid epoch\" handler=status peer=16Uiu2HAmAwBJYx2iyJZCqtXjPdaaMKQYG3gHMHS6gB4WSvzqJX2S prefix=sync\r\ntime=\"2020-08-19 12:55:29\" level=warning msg=\"Failed to handle p2p RPC\" error=\"invalid epoch\" peer=16Uiu2HAmAwBJYx2iyJZCqtXjPdaaMKQYG3gHMHS6gB4WSvzqJX2S prefix=sync topic=\"/eth2/beacon_chain/req/status/1/ssz_snappy\"\r\ntime=\"2020-08-19 12:55:32\" level=debug msg=\"Invalid status message from peer\" error=\"invalid epoch\" handler=status peer=16Uiu2HAmA9154AurpYJtJKXet2ethgEBB7JtmzEQW6dSyZqHZmmq prefix=sync\r\ntime=\"2020-08-19 12:55:32\" level=warning msg=\"Failed to handle p2p RPC\" error=\"invalid epoch\" peer=16Uiu2HAmA9154AurpYJtJKXet2ethgEBB7JtmzEQW6dSyZqHZmmq prefix=sync topic=\"/eth2/beacon_chain/req/status/1/ssz_snappy\"\r\ntime=\"2020-08-19 12:56:37\" level=debug msg=\"Invalid status message from peer\" error=\"invalid epoch\" handler=status peer=16Uiu2HAmSqsQjDBoExaSvr4shrTAL1rGQ2K43tBvZ5dwaQH7ScRm prefix=sync\r\ntime=\"2020-08-19 12:56:37\" level=warning msg=\"Failed to handle p2p RPC\" error=\"invalid epoch\" peer=16Uiu2HAmSqsQjDBoExaSvr4shrTAL1rGQ2K43tBvZ5dwaQH7ScRm prefix=sync topic=\"/eth2/beacon_chain/req/status/1/ssz_snappy\"\r\ntime=\"2020-08-19 12:58:29\" level=debug msg=\"Invalid status message from peer\" error=\"invalid epoch\" handler=status peer=16Uiu2HAmRSNezc57XCLGfAH2PfoadQ3eR2pV4YPHJCDHqZsqBXHo prefix=sync\r\ntime=\"2020-08-19 12:58:30\" level=warning msg=\"Failed to handle p2p RPC\" error=\"invalid epoch\" peer=16Uiu2HAmRSNezc57XCLGfAH2PfoadQ3eR2pV4YPHJCDHqZsqBXHo prefix=sync topic=\"/eth2/beacon_chain/req/status/1/ssz_snappy\"\r\ntime=\"2020-08-19 12:58:59\" level=debug msg=\"Invalid status message from peer\" error=\"invalid epoch\" handler=status peer=16Uiu2HAmRSNezc57XCLGfAH2PfoadQ3eR2pV4YPHJCDHqZsqBXHo prefix=sync\r\ntime=\"2020-08-19 12:58:59\" level=warning msg=\"Failed to handle p2p RPC\" error=\"invalid epoch\" peer=16Uiu2HAmRSNezc57XCLGfAH2PfoadQ3eR2pV4YPHJCDHqZsqBXHo prefix=sync topic=\"/eth2/beacon_chain/req/status/1/ssz_snappy\"\r\n\r\n</code></pre>\r\n\r\n\r\n## üåç  Your Environment\r\n\r\n**Operating System:**\r\n\r\n<pre>\r\n  <code>\r\ndocker, in ubuntu 18\r\n  </code>\r\n</pre>\r\n\r\n**What version of Prysm are you running? (Which release)**\r\n\r\n(note: version number in docker is bugged, the commit hash is latest master as of now)\r\n<pre>\r\n  <code>\r\ncurl localhost:4000/eth/v1alpha1/node/version\r\n{\"version\":\"Prysm/v1.0.0-alpha.22/399dc85737639df62f3dc2f7d95478307812440f. Built at: 2020-08-18 16:29:25+00:00\",\"metadata\":\"\"}\r\n  </code>\r\n</pre>\r\n\r\n**Anything else relevant (validator index / public key)?**\r\n\r\n",
  "closed_by": {
    "login": "prylabs-bulldozer[bot]",
    "id": 58059840,
    "node_id": "MDM6Qm90NTgwNTk4NDA=",
    "avatar_url": "https://avatars.githubusercontent.com/in/47372?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D",
    "html_url": "https://github.com/apps/prylabs-bulldozer",
    "followers_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/prylabs-bulldozer%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7051/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7051/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/676381663",
    "html_url": "https://github.com/prysmaticlabs/prysm/issues/7051#issuecomment-676381663",
    "issue_url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/7051",
    "id": 676381663,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3NjM4MTY2Mw==",
    "user": {
      "login": "protolambda",
      "id": 19571989,
      "node_id": "MDQ6VXNlcjE5NTcxOTg5",
      "avatar_url": "https://avatars.githubusercontent.com/u/19571989?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/protolambda",
      "html_url": "https://github.com/protolambda",
      "followers_url": "https://api.github.com/users/protolambda/followers",
      "following_url": "https://api.github.com/users/protolambda/following{/other_user}",
      "gists_url": "https://api.github.com/users/protolambda/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/protolambda/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/protolambda/subscriptions",
      "organizations_url": "https://api.github.com/users/protolambda/orgs",
      "repos_url": "https://api.github.com/users/protolambda/repos",
      "events_url": "https://api.github.com/users/protolambda/events{/privacy}",
      "received_events_url": "https://api.github.com/users/protolambda/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-19T13:44:12Z",
    "updated_at": "2020-08-19T13:44:12Z",
    "author_association": "NONE",
    "body": "Config: https://gist.github.com/protolambda/726704afa73c3ca35dbc5045fe3de43e\r\nFrom discord chat: appears the config loaded a medalla genesis time value, while it shouldn't have loaded it.",
    "reactions": {
      "url": "https://api.github.com/repos/prysmaticlabs/prysm/issues/comments/676381663/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
