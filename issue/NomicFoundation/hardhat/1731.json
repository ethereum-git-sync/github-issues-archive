{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1731",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1731/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1731/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1731/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/1731",
  "id": 953272870,
  "node_id": "MDU6SXNzdWU5NTMyNzI4NzA=",
  "number": 1731,
  "title": "Confusing `estimateGas` error message in Hardhat node",
  "user": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4937718880,
      "node_id": "LA_kwDOB7jojM8AAAABJk-cYA",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/type:improvement",
      "name": "type:improvement",
      "color": "FBCA04",
      "default": false,
      "description": ""
    },
    {
      "id": 4937720577,
      "node_id": "LA_kwDOB7jojM8AAAABJk-jAQ",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/status:ready",
      "name": "status:ready",
      "color": "0E8A16",
      "default": false,
      "description": "This issue is ready to be worked on"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2021-07-26T20:44:43Z",
  "updated_at": "2023-01-03T09:17:03Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "A user got this output in their node:\r\n\r\n![image](https://user-images.githubusercontent.com/417134/127056391-354affce-dedb-4eae-bb77-d77de11e821c.png)\r\n\r\nI don't have reproduction steps, although it can probably be simulated locally by hardcoding some `throw` somewhere. The point is that a message like that is very confusing and we should either not show anything at all or show something better.\r\n\r\nMy guess of how to reproduce this:\r\n\r\n1. Check the part of the code that throws when an unrecognized error happens\r\n2. Hardcode that to make it always throw\r\n3. Start an `hh node` and send an `eth_estimateGas`\r\n\r\n**EDIT**: I'm pretty sure that most of the time this happens because of #3474; check that issue for an explanation and a workaround. This issue is still valid though: we should show a better error message when an unhandled error is thrown.\r\n\r\n**EDIT 2**: we should improve this for all JSON-RPC methods, not just `eth_estimateGas`. See for example #1311.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1731/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1731/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1207067995",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1731#issuecomment-1207067995",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1731",
    "id": 1207067995,
    "node_id": "IC_kwDOB7jojM5H8mVb",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-08-05T22:34:08Z",
    "updated_at": "2022-08-05T22:34:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue was marked as stale because it didn't have any activity in the last 30 days. If you think it's still relevant, please leave a comment indicating so. Otherwise, it will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1207067995/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1210933570",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1731#issuecomment-1210933570",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1731",
    "id": 1210933570,
    "node_id": "IC_kwDOB7jojM5ILWFC",
    "user": {
      "login": "degoev",
      "id": 50908619,
      "node_id": "MDQ6VXNlcjUwOTA4NjE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/50908619?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/degoev",
      "html_url": "https://github.com/degoev",
      "followers_url": "https://api.github.com/users/degoev/followers",
      "following_url": "https://api.github.com/users/degoev/following{/other_user}",
      "gists_url": "https://api.github.com/users/degoev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/degoev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/degoev/subscriptions",
      "organizations_url": "https://api.github.com/users/degoev/orgs",
      "repos_url": "https://api.github.com/users/degoev/repos",
      "events_url": "https://api.github.com/users/degoev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/degoev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-10T16:10:22Z",
    "updated_at": "2022-08-10T16:10:22Z",
    "author_association": "NONE",
    "body": "have this issue too",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1210933570/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1220292181",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1731#issuecomment-1220292181",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1731",
    "id": 1220292181,
    "node_id": "IC_kwDOB7jojM5IvC5V",
    "user": {
      "login": "toshtossbot",
      "id": 16233120,
      "node_id": "MDQ6VXNlcjE2MjMzMTIw",
      "avatar_url": "https://avatars.githubusercontent.com/u/16233120?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/toshtossbot",
      "html_url": "https://github.com/toshtossbot",
      "followers_url": "https://api.github.com/users/toshtossbot/followers",
      "following_url": "https://api.github.com/users/toshtossbot/following{/other_user}",
      "gists_url": "https://api.github.com/users/toshtossbot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/toshtossbot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/toshtossbot/subscriptions",
      "organizations_url": "https://api.github.com/users/toshtossbot/orgs",
      "repos_url": "https://api.github.com/users/toshtossbot/repos",
      "events_url": "https://api.github.com/users/toshtossbot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/toshtossbot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-19T06:14:12Z",
    "updated_at": "2022-08-19T06:14:12Z",
    "author_association": "NONE",
    "body": "have this issue too with apple m1  and node v18.4.0, hardhat 2.10.2",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1220292181/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1238275877",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1731#issuecomment-1238275877",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1731",
    "id": 1238275877,
    "node_id": "IC_kwDOB7jojM5Jzpcl",
    "user": {
      "login": "gapon2401",
      "id": 4976144,
      "node_id": "MDQ6VXNlcjQ5NzYxNDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4976144?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gapon2401",
      "html_url": "https://github.com/gapon2401",
      "followers_url": "https://api.github.com/users/gapon2401/followers",
      "following_url": "https://api.github.com/users/gapon2401/following{/other_user}",
      "gists_url": "https://api.github.com/users/gapon2401/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gapon2401/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gapon2401/subscriptions",
      "organizations_url": "https://api.github.com/users/gapon2401/orgs",
      "repos_url": "https://api.github.com/users/gapon2401/repos",
      "events_url": "https://api.github.com/users/gapon2401/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gapon2401/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-06T15:01:44Z",
    "updated_at": "2022-09-06T15:01:44Z",
    "author_association": "NONE",
    "body": "I have the same issue. Hardhat 2.11.0\r\nI'm trying to test smartcontract locally.\r\n\r\nMy steps to reproduce:\r\n\r\n1) Fork the mainnet:\r\n\r\nA part of hardhat.config.ts\r\n```\r\nnetworks: {\r\n    hardhat: {\r\n      allowUnlimitedContractSize: true,\r\n      forking: {\r\n        url: \"https://eth-mainnet.g.alchemy.com/v2/<ALCHEMY_KEY>\",\r\n      }\r\n    },\r\n    localhost: {\r\n      allowUnlimitedContractSize: true,\r\n      chainId: 31337,\r\n      accounts: [`PRIVATE_KEY1`, `PRIVATE_KEY2`],\r\n    },\r\n}\r\n```\r\n\r\n2) Auth in metamask, connect to network localhost:8545 with chainId 31337\r\n3) Add hardhat account in metamask with PRIVATE_KEY1\r\n4) Deploy smartcontract\r\n5) Trying to send eth to smartcontract in metamask. Button, which starts the transaction, is inactive\r\n\r\nHere, what I have in console:\r\n\r\n![SharedScreenshot](https://user-images.githubusercontent.com/4976144/188669019-59c7d1c5-4e16-486b-8372-c2d3a35c8af4.jpg)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1238275877/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1279983078",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1731#issuecomment-1279983078",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1731",
    "id": 1279983078,
    "node_id": "IC_kwDOB7jojM5MSv3m",
    "user": {
      "login": "victorshevtsov",
      "id": 32890592,
      "node_id": "MDQ6VXNlcjMyODkwNTky",
      "avatar_url": "https://avatars.githubusercontent.com/u/32890592?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/victorshevtsov",
      "html_url": "https://github.com/victorshevtsov",
      "followers_url": "https://api.github.com/users/victorshevtsov/followers",
      "following_url": "https://api.github.com/users/victorshevtsov/following{/other_user}",
      "gists_url": "https://api.github.com/users/victorshevtsov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/victorshevtsov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/victorshevtsov/subscriptions",
      "organizations_url": "https://api.github.com/users/victorshevtsov/orgs",
      "repos_url": "https://api.github.com/users/victorshevtsov/repos",
      "events_url": "https://api.github.com/users/victorshevtsov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/victorshevtsov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-16T14:40:26Z",
    "updated_at": "2022-10-16T14:40:26Z",
    "author_association": "NONE",
    "body": "I confirm. I'm facing the same issue.\r\nAbsolutely reproducible.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1279983078/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1280004508",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1731#issuecomment-1280004508",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1731",
    "id": 1280004508,
    "node_id": "IC_kwDOB7jojM5MS1Gc",
    "user": {
      "login": "victorshevtsov",
      "id": 32890592,
      "node_id": "MDQ6VXNlcjMyODkwNTky",
      "avatar_url": "https://avatars.githubusercontent.com/u/32890592?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/victorshevtsov",
      "html_url": "https://github.com/victorshevtsov",
      "followers_url": "https://api.github.com/users/victorshevtsov/followers",
      "following_url": "https://api.github.com/users/victorshevtsov/following{/other_user}",
      "gists_url": "https://api.github.com/users/victorshevtsov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/victorshevtsov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/victorshevtsov/subscriptions",
      "organizations_url": "https://api.github.com/users/victorshevtsov/orgs",
      "repos_url": "https://api.github.com/users/victorshevtsov/repos",
      "events_url": "https://api.github.com/users/victorshevtsov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/victorshevtsov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-16T16:34:39Z",
    "updated_at": "2022-10-16T16:34:39Z",
    "author_association": "NONE",
    "body": "It looks like the issue is in MetaMask browser extension.\r\n\r\nIt works just fine with MetaMask for Android.\r\nAll the transactions to `hardhat node` goes well when performed from mobile wallet but not from a browser extension.\r\n\r\nI tried Chrome and FireFox extensions.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1280004508/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1280036313",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1731#issuecomment-1280036313",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1731",
    "id": 1280036313,
    "node_id": "IC_kwDOB7jojM5MS83Z",
    "user": {
      "login": "victorshevtsov",
      "id": 32890592,
      "node_id": "MDQ6VXNlcjMyODkwNTky",
      "avatar_url": "https://avatars.githubusercontent.com/u/32890592?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/victorshevtsov",
      "html_url": "https://github.com/victorshevtsov",
      "followers_url": "https://api.github.com/users/victorshevtsov/followers",
      "following_url": "https://api.github.com/users/victorshevtsov/following{/other_user}",
      "gists_url": "https://api.github.com/users/victorshevtsov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/victorshevtsov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/victorshevtsov/subscriptions",
      "organizations_url": "https://api.github.com/users/victorshevtsov/orgs",
      "repos_url": "https://api.github.com/users/victorshevtsov/repos",
      "events_url": "https://api.github.com/users/victorshevtsov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/victorshevtsov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-16T19:23:54Z",
    "updated_at": "2022-10-16T19:23:54Z",
    "author_association": "NONE",
    "body": "Finally I got it!\r\nIt took almost whole day to figure out what is the cause.\r\n\r\nThe default `chainId` of Hardhat node is `31337` and this causes the issue.\r\nI changed it to `1337` and everything works now.\r\n\r\n```javascript\r\n/// hardhat.config.js:\r\n\r\n/** @type import('hardhat/config').HardhatUserConfig */\r\nmodule.exports = {\r\n  solidity: \"0.8.17\",\r\n  networks: {\r\n    hardhat: {\r\n      chainId: 1337, // default is 31337\r\n    }\r\n  }\r\n};\r\n```\r\n\r\nI'm sure the root of the problem is out there.\r\nI hope somebody will figure it out and get it fixed eventually.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1280036313/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1317466308",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1731#issuecomment-1317466308",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1731",
    "id": 1317466308,
    "node_id": "IC_kwDOB7jojM5OhvDE",
    "user": {
      "login": "nfts2me",
      "id": 109629895,
      "node_id": "U_kgDOBojRxw",
      "avatar_url": "https://avatars.githubusercontent.com/u/109629895?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nfts2me",
      "html_url": "https://github.com/nfts2me",
      "followers_url": "https://api.github.com/users/nfts2me/followers",
      "following_url": "https://api.github.com/users/nfts2me/following{/other_user}",
      "gists_url": "https://api.github.com/users/nfts2me/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nfts2me/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nfts2me/subscriptions",
      "organizations_url": "https://api.github.com/users/nfts2me/orgs",
      "repos_url": "https://api.github.com/users/nfts2me/repos",
      "events_url": "https://api.github.com/users/nfts2me/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nfts2me/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-16T18:21:30Z",
    "updated_at": "2022-11-16T20:28:11Z",
    "author_association": "NONE",
    "body": "> Finally I got it! It took almost whole day to figure out what is the cause.\r\n> \r\n> The default `chainId` of Hardhat node is `31337` and this causes the issue. I changed it to `1337` and everything works now.\r\n> \r\n> ```js\r\n> /// hardhat.config.js:\r\n> \r\n> /** @type import('hardhat/config').HardhatUserConfig */\r\n> module.exports = {\r\n>   solidity: \"0.8.17\",\r\n>   networks: {\r\n>     hardhat: {\r\n>       chainId: 1337, // default is 31337\r\n>     }\r\n>   }\r\n> };\r\n> ```\r\n> \r\n> I'm sure the root of the problem is out there. I hope somebody will figure it out and get it fixed eventually.\r\n\r\nAs described here: \r\nhttps://github.com/NomicFoundation/hardhat/issues/3089#issuecomment-1317460141\r\nI'm getting this error as well.\r\nBut changing the chainId didn't fix the issue.\r\n\r\nMay it be related to this?\r\nhttps://github.com/trufflesuite/ganache/issues/3332",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1317466308/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
