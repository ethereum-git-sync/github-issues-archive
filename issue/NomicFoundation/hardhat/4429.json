{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4429",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4429/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4429/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4429/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/4429",
  "id": 1918798863,
  "node_id": "I_kwDOB7jojM5yXowP",
  "number": 4429,
  "title": "Hedera Hashgraph ",
  "user": {
    "login": "stefan-stefanooov",
    "id": 10372129,
    "node_id": "MDQ6VXNlcjEwMzcyMTI5",
    "avatar_url": "https://avatars.githubusercontent.com/u/10372129?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/stefan-stefanooov",
    "html_url": "https://github.com/stefan-stefanooov",
    "followers_url": "https://api.github.com/users/stefan-stefanooov/followers",
    "following_url": "https://api.github.com/users/stefan-stefanooov/following{/other_user}",
    "gists_url": "https://api.github.com/users/stefan-stefanooov/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/stefan-stefanooov/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/stefan-stefanooov/subscriptions",
    "organizations_url": "https://api.github.com/users/stefan-stefanooov/orgs",
    "repos_url": "https://api.github.com/users/stefan-stefanooov/repos",
    "events_url": "https://api.github.com/users/stefan-stefanooov/events{/privacy}",
    "received_events_url": "https://api.github.com/users/stefan-stefanooov/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4937119027,
      "node_id": "LA_kwDOB7jojM8AAAABJkZ1Mw",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/status:triaging",
      "name": "status:triaging",
      "color": "0E8A16",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": true,
  "assignee": {
    "login": "ChristopherDedominici",
    "id": 18092467,
    "node_id": "MDQ6VXNlcjE4MDkyNDY3",
    "avatar_url": "https://avatars.githubusercontent.com/u/18092467?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ChristopherDedominici",
    "html_url": "https://github.com/ChristopherDedominici",
    "followers_url": "https://api.github.com/users/ChristopherDedominici/followers",
    "following_url": "https://api.github.com/users/ChristopherDedominici/following{/other_user}",
    "gists_url": "https://api.github.com/users/ChristopherDedominici/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ChristopherDedominici/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ChristopherDedominici/subscriptions",
    "organizations_url": "https://api.github.com/users/ChristopherDedominici/orgs",
    "repos_url": "https://api.github.com/users/ChristopherDedominici/repos",
    "events_url": "https://api.github.com/users/ChristopherDedominici/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ChristopherDedominici/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "ChristopherDedominici",
      "id": 18092467,
      "node_id": "MDQ6VXNlcjE4MDkyNDY3",
      "avatar_url": "https://avatars.githubusercontent.com/u/18092467?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ChristopherDedominici",
      "html_url": "https://github.com/ChristopherDedominici",
      "followers_url": "https://api.github.com/users/ChristopherDedominici/followers",
      "following_url": "https://api.github.com/users/ChristopherDedominici/following{/other_user}",
      "gists_url": "https://api.github.com/users/ChristopherDedominici/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ChristopherDedominici/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ChristopherDedominici/subscriptions",
      "organizations_url": "https://api.github.com/users/ChristopherDedominici/orgs",
      "repos_url": "https://api.github.com/users/ChristopherDedominici/repos",
      "events_url": "https://api.github.com/users/ChristopherDedominici/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ChristopherDedominici/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-09-29T08:09:16Z",
  "updated_at": "2024-01-19T00:14:24Z",
  "closed_at": "2023-10-20T13:32:45Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "### Version of Hardhat\r\n\r\n^2.17.3\r\n\r\n### What happened?\r\n\r\nHello everyone,\r\n\r\nI am working on the [Hedera Hashgraph](https://hedera.com/) project.\r\nWe are trying to integrate with your wonderful project for obvious reasons :)\r\n\r\nIn **Hedera** we have a thing called system contracts that allow the network to expose native service implementations on top of the EVM through smart contracts.\r\n\r\nThey are called from a predefined address. (\"0x167\" for example)\r\nIf we create a smart contract, that uses this address and write a test for it with your tool, we get the following **error**:\r\n<img width=\"1095\" alt=\"image\" src=\"https://github.com/NomicFoundation/hardhat/assets/10372129/af08f7cb-0930-47d9-9ac7-64e246b7a935\">\r\n\r\nA little something from the **\"--show-stack-traces\"** flag ... \r\n<img width=\"1117\" alt=\"image\" src=\"https://github.com/NomicFoundation/hardhat/assets/10372129/860438fb-122d-446a-9027-68769f7cce6f\">\r\n\r\nCan you please have a look?\r\nWe would really like for you to support our project.\r\n\r\nPlease let me know if I can do anything else to help US solve this. \r\n\r\nBest of wishes,\r\nStefan\r\n\r\n### Minimal reproduction steps\r\n\r\n- Create a normal out of the box **hardhat** project. \r\n`npm install --save-dev hardhat`\r\n`npx hardhat init` --- use TypeScript \r\n- add the 4 contracts and test file in the [GitHub gist](https://gist.github.com/stefan-stefanooov/08191e704db60aacda6e6c7d0332969c) \r\n- run the tests\r\n- we also use this [tool](https://www.npmjs.com/package/solidity-coverage) for our code-caverage \r\n\r\n### Search terms\r\n\r\nhedera hashgraph hardhat precompile address code-coverage",
  "closed_by": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4429/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4429/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1755786933",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/4429#issuecomment-1755786933",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4429",
    "id": 1755786933,
    "node_id": "IC_kwDOB7jojM5opy61",
    "user": {
      "login": "ChristopherDedominici",
      "id": 18092467,
      "node_id": "MDQ6VXNlcjE4MDkyNDY3",
      "avatar_url": "https://avatars.githubusercontent.com/u/18092467?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ChristopherDedominici",
      "html_url": "https://github.com/ChristopherDedominici",
      "followers_url": "https://api.github.com/users/ChristopherDedominici/followers",
      "following_url": "https://api.github.com/users/ChristopherDedominici/following{/other_user}",
      "gists_url": "https://api.github.com/users/ChristopherDedominici/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ChristopherDedominici/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ChristopherDedominici/subscriptions",
      "organizations_url": "https://api.github.com/users/ChristopherDedominici/orgs",
      "repos_url": "https://api.github.com/users/ChristopherDedominici/repos",
      "events_url": "https://api.github.com/users/ChristopherDedominici/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ChristopherDedominici/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-10T16:21:43Z",
    "updated_at": "2023-10-10T16:22:13Z",
    "author_association": "COLLABORATOR",
    "body": "Hi @stefan-stefanooov, I'm checking the issue and I have a question: is the GitHub gist that you shared correct? I see a lot of code  that I cannot understand, see screenshot:\r\n\r\n<img width=\"793\" alt=\"image\" src=\"https://github.com/NomicFoundation/hardhat/assets/18092467/20039f0b-15ec-4a5f-8f1d-994127076c05\">\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1755786933/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1755846981",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/4429#issuecomment-1755846981",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4429",
    "id": 1755846981,
    "node_id": "IC_kwDOB7jojM5oqBlF",
    "user": {
      "login": "stefan-stefanooov",
      "id": 10372129,
      "node_id": "MDQ6VXNlcjEwMzcyMTI5",
      "avatar_url": "https://avatars.githubusercontent.com/u/10372129?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stefan-stefanooov",
      "html_url": "https://github.com/stefan-stefanooov",
      "followers_url": "https://api.github.com/users/stefan-stefanooov/followers",
      "following_url": "https://api.github.com/users/stefan-stefanooov/following{/other_user}",
      "gists_url": "https://api.github.com/users/stefan-stefanooov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stefan-stefanooov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stefan-stefanooov/subscriptions",
      "organizations_url": "https://api.github.com/users/stefan-stefanooov/orgs",
      "repos_url": "https://api.github.com/users/stefan-stefanooov/repos",
      "events_url": "https://api.github.com/users/stefan-stefanooov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stefan-stefanooov/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-10T16:48:58Z",
    "updated_at": "2023-10-10T16:48:58Z",
    "author_association": "NONE",
    "body": "Apologies Sir @ChristopherDedominici , \r\nI just edited my link ...hopefully to the correct gist.\r\nPlease confirm that you can open it. And that it's something meaningful. \r\n\r\nI'll also add it here.\r\nhttps://gist.github.com/stefan-stefanooov/08191e704db60aacda6e6c7d0332969c\r\n\r\nThank you for checking this out :) \r\nI am here for you if you need me for more clarifications.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1755846981/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1772749317",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/4429#issuecomment-1772749317",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4429",
    "id": 1772749317,
    "node_id": "IC_kwDOB7jojM5pqgIF",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-20T13:32:45Z",
    "updated_at": "2023-10-20T13:32:45Z",
    "author_association": "MEMBER",
    "body": "Hey @stefan-stefanooov, I can confirm that your transaction is reverting, but that doesn't necessarily mean there's a bug in Hardhat.\r\n\r\nIf you think this is happening because the code assumes that some precompile exist, then the problem is that the Hardhat network only has Ethereum's standard precompiles. If you want to simulate those, then you need to have some bytecode in those addresses with the same functionality (you can use `hardhat_setCode` for that).\r\n\r\nI'm tentatively closing this, but I can re-open it if there's indeed a problem on our side.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1772749317/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1772761639",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/4429#issuecomment-1772761639",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4429",
    "id": 1772761639,
    "node_id": "IC_kwDOB7jojM5pqjIn",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-20T13:40:42Z",
    "updated_at": "2023-10-20T13:40:42Z",
    "author_association": "MEMBER",
    "body": "I think what's going on here. This code:\r\n\r\n```solidity\r\n        (bool success, bytes memory result) = precompileAddress.call(\r\n            abi.encodeWithSelector(IHederaTokenService.cryptoTransfer.selector, tokenTransfers));\r\n        responseCode = success ? abi.decode(result, (int32)) : HederaResponseCodes.UNKNOWN;\r\n```\r\n\r\nis making a call to an address (0x167) that doesn't have bytecode. But low-level calls (done with `address.call`) to addresses without bytecode always succeed, with an empty result. You can confirm this by adding some logs:\r\n\r\n```solidity\r\n        (bool success, bytes memory result) = precompileAddress.call(\r\n            abi.encodeWithSelector(IHederaTokenService.cryptoTransfer.selector, tokenTransfers));\r\n        console.log(success);\r\n        console.logBytes(result);\r\n        responseCode = success ? abi.decode(result, (int32)) : HederaResponseCodes.UNKNOWN;\r\n```\r\n\r\nSo you are doing `abi.decode(result, (int32))` with an empty result, and that fails.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1772761639/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
