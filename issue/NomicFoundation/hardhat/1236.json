{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/1236",
  "id": 805159824,
  "node_id": "MDU6SXNzdWU4MDUxNTk4MjQ=",
  "number": 1236,
  "title": "bsc network ProviderError: missing trie node 02f51875869cc574b03cf7d12d586f1f74e8cac6011d84cb98fdae84c426a3aa (path )",
  "user": {
    "login": "jin10086",
    "id": 15347911,
    "node_id": "MDQ6VXNlcjE1MzQ3OTEx",
    "avatar_url": "https://avatars.githubusercontent.com/u/15347911?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jin10086",
    "html_url": "https://github.com/jin10086",
    "followers_url": "https://api.github.com/users/jin10086/followers",
    "following_url": "https://api.github.com/users/jin10086/following{/other_user}",
    "gists_url": "https://api.github.com/users/jin10086/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jin10086/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jin10086/subscriptions",
    "organizations_url": "https://api.github.com/users/jin10086/orgs",
    "repos_url": "https://api.github.com/users/jin10086/repos",
    "events_url": "https://api.github.com/users/jin10086/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jin10086/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 13,
  "created_at": "2021-02-10T04:35:52Z",
  "updated_at": "2022-11-17T21:40:30Z",
  "closed_at": "2021-02-10T05:27:20Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "```\r\nhardhat: {\r\n      forking: {\r\n        url: \"https://bsc-dataseed.binance.org\",\r\n        blockNumber: 4745245  \r\n      },\r\n```",
  "closed_by": {
    "login": "jin10086",
    "id": 15347911,
    "node_id": "MDQ6VXNlcjE1MzQ3OTEx",
    "avatar_url": "https://avatars.githubusercontent.com/u/15347911?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jin10086",
    "html_url": "https://github.com/jin10086",
    "followers_url": "https://api.github.com/users/jin10086/followers",
    "following_url": "https://api.github.com/users/jin10086/following{/other_user}",
    "gists_url": "https://api.github.com/users/jin10086/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jin10086/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jin10086/subscriptions",
    "organizations_url": "https://api.github.com/users/jin10086/orgs",
    "repos_url": "https://api.github.com/users/jin10086/repos",
    "events_url": "https://api.github.com/users/jin10086/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jin10086/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/904089491",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1236#issuecomment-904089491",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236",
    "id": 904089491,
    "node_id": "IC_kwDOB7jojM4140-T",
    "user": {
      "login": "5hanth",
      "id": 4287700,
      "node_id": "MDQ6VXNlcjQyODc3MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4287700?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/5hanth",
      "html_url": "https://github.com/5hanth",
      "followers_url": "https://api.github.com/users/5hanth/followers",
      "following_url": "https://api.github.com/users/5hanth/following{/other_user}",
      "gists_url": "https://api.github.com/users/5hanth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/5hanth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/5hanth/subscriptions",
      "organizations_url": "https://api.github.com/users/5hanth/orgs",
      "repos_url": "https://api.github.com/users/5hanth/repos",
      "events_url": "https://api.github.com/users/5hanth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/5hanth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-23T20:15:07Z",
    "updated_at": "2021-08-23T20:15:07Z",
    "author_association": "NONE",
    "body": "what was the issue here?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/904089491/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/904846041",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1236#issuecomment-904846041",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236",
    "id": 904846041,
    "node_id": "IC_kwDOB7jojM417trZ",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-24T17:42:49Z",
    "updated_at": "2021-08-24T17:42:49Z",
    "author_association": "MEMBER",
    "body": "@5hanth this error usually means that you are not forking from an archive node. When Hardhat asks data that is some blocks old (say, 15 or whatever) a non-archival node will consider that \"historical\" information and return that error.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/904846041/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/905525178",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1236#issuecomment-905525178",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236",
    "id": 905525178,
    "node_id": "IC_kwDOB7jojM41-Te6",
    "user": {
      "login": "itoukaijiE",
      "id": 81021864,
      "node_id": "MDQ6VXNlcjgxMDIxODY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/81021864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/itoukaijiE",
      "html_url": "https://github.com/itoukaijiE",
      "followers_url": "https://api.github.com/users/itoukaijiE/followers",
      "following_url": "https://api.github.com/users/itoukaijiE/following{/other_user}",
      "gists_url": "https://api.github.com/users/itoukaijiE/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/itoukaijiE/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/itoukaijiE/subscriptions",
      "organizations_url": "https://api.github.com/users/itoukaijiE/orgs",
      "repos_url": "https://api.github.com/users/itoukaijiE/repos",
      "events_url": "https://api.github.com/users/itoukaijiE/events{/privacy}",
      "received_events_url": "https://api.github.com/users/itoukaijiE/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-25T13:58:12Z",
    "updated_at": "2021-08-25T13:58:12Z",
    "author_association": "NONE",
    "body": "it seems to be a problem only occurs in bsc, that the block forked is far behind the newest block even when block number is not pinned, which means if configured like this\r\n```\r\nhardhat: {\r\n      forking: {\r\n        url: \"https://bsc-dataseed.binance.org\"\r\n      },\r\n```\r\nand try to get the block number in the beginning of some testing snippet code, the block number is quite far behind the newest block(it is more than 30 blocks for me), then the historical data cannot be viewed.\r\n\r\nit is interesting that eth or heco mainnet do not have this problem. is there something to note in hardhat?\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/905525178/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/905668238",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1236#issuecomment-905668238",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236",
    "id": 905668238,
    "node_id": "IC_kwDOB7jojM41-2aO",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-25T16:09:16Z",
    "updated_at": "2021-08-25T16:09:16Z",
    "author_association": "MEMBER",
    "body": "@itoukaijiE that has to do with reorg protection. When you don't specify a block number, the latest block number is used **minus** some number of blocks. For unsupported networks, like BSC, that value is 30. We don't have a way to circumvent that right now, but there's an ugly workaround that you can use: at the beginning of your script/test, you run something like this:\r\n\r\n```js\r\n  const bscProvider = new ethers.providers.JsonRpcProvider(BSC_URL);\r\n\r\n  const latestBlock = await bscProvider.getBlockNumber();\r\n\r\n  await network.provider.send(\"hardhat_reset\", [{\r\n    forking: {\r\n      jsonRpcUrl: BSC_URL,\r\n      blockNumber: latestBlock\r\n    }\r\n  }])\r\n```\r\n\r\nAgain, it's not pretty, but maybe it can help you for the time being.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/905668238/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/906307982",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1236#issuecomment-906307982",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236",
    "id": 906307982,
    "node_id": "IC_kwDOB7jojM42BSmO",
    "user": {
      "login": "itoukaijiE",
      "id": 81021864,
      "node_id": "MDQ6VXNlcjgxMDIxODY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/81021864?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/itoukaijiE",
      "html_url": "https://github.com/itoukaijiE",
      "followers_url": "https://api.github.com/users/itoukaijiE/followers",
      "following_url": "https://api.github.com/users/itoukaijiE/following{/other_user}",
      "gists_url": "https://api.github.com/users/itoukaijiE/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/itoukaijiE/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/itoukaijiE/subscriptions",
      "organizations_url": "https://api.github.com/users/itoukaijiE/orgs",
      "repos_url": "https://api.github.com/users/itoukaijiE/repos",
      "events_url": "https://api.github.com/users/itoukaijiE/events{/privacy}",
      "received_events_url": "https://api.github.com/users/itoukaijiE/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-26T11:06:04Z",
    "updated_at": "2021-08-26T11:06:04Z",
    "author_association": "NONE",
    "body": "i guess it works.\r\nas bsc is some kind of centralized, and hardhat fork is usually used for testing,  maybe 30 is a too big number.\r\nhow about make lastBlock forking configurable in hardhat.config.ts?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/906307982/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/906321963",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1236#issuecomment-906321963",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236",
    "id": 906321963,
    "node_id": "IC_kwDOB7jojM42BWAr",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-26T11:27:35Z",
    "updated_at": "2021-08-26T11:27:35Z",
    "author_association": "MEMBER",
    "body": "> how about make lastBlock forking configurable in hardhat.config.ts?\r\n\r\nYes, we have plans for doing that. I don't have an ETA but it's definitely something we'll add.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/906321963/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/958184137",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1236#issuecomment-958184137",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236",
    "id": 958184137,
    "node_id": "IC_kwDOB7jojM45HLrJ",
    "user": {
      "login": "codler",
      "id": 102052,
      "node_id": "MDQ6VXNlcjEwMjA1Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/102052?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/codler",
      "html_url": "https://github.com/codler",
      "followers_url": "https://api.github.com/users/codler/followers",
      "following_url": "https://api.github.com/users/codler/following{/other_user}",
      "gists_url": "https://api.github.com/users/codler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/codler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/codler/subscriptions",
      "organizations_url": "https://api.github.com/users/codler/orgs",
      "repos_url": "https://api.github.com/users/codler/repos",
      "events_url": "https://api.github.com/users/codler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/codler/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-02T21:33:33Z",
    "updated_at": "2021-11-02T21:33:33Z",
    "author_association": "NONE",
    "body": "@fvictorio Hmm, Im trying to make a generic fetching blockNumber but I don't manage to solve it. This is what I got so far. Maybe you can see what am missing in `hardhat.config.ts`? Url is `https://bsc-dataseed.binance.org/`\r\n```ts\r\ntask(\"test\", async (args, hre, runSuper) => {\r\n  if ((hre.network.config as HardhatNetworkConfig).forking?.enabled) {\r\n    const blockNumber = BigNumber.from(\r\n      await hre.network.provider.send(\"eth_blockNumber\")\r\n    ).toNumber();\r\n    const jsonRpcUrl = (hre.network.config as HardhatNetworkConfig).forking\r\n      ?.url;\r\n\r\n    await hre.network.provider.request({\r\n      method: \"hardhat_reset\",\r\n      params: [\r\n        {\r\n          forking: {\r\n            jsonRpcUrl,\r\n            blockNumber,\r\n          },\r\n        },\r\n      ],\r\n    });\r\n  }\r\n\r\n  return await runSuper(args);\r\n});",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/958184137/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/959208994",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1236#issuecomment-959208994",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236",
    "id": 959208994,
    "node_id": "IC_kwDOB7jojM45LF4i",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-03T14:17:57Z",
    "updated_at": "2021-11-03T14:17:57Z",
    "author_association": "MEMBER",
    "body": "@codler The problem is that you are doing this:\r\n\r\n```js\r\nawait hre.network.provider.send(\"eth_blockNumber\")\r\n```\r\n\r\nWhich uses the already forked provider, and so it won't give you the latest block number of the remote network. That is, this reset it's pretty much a no-op. Instead you should do something like this:\r\n\r\n```ts\r\n    const jsonRpcUrl = (hre.network.config as HardhatNetworkConfig).forking\r\n      ?.url;\r\n    const remoteProvider = new ethers.providers.JsonRpcProvider(jsonRpcUrl)\r\n    const blockNumber = (await remoteProvider.getBlockNumber()).toNumber();\r\n```\r\n\r\nIf you have more questions, please use [our Discord server](https://hardhat.org/discord) or [GitHub's Discussions](https://github.com/nomiclabs/hardhat/discussions)",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/959208994/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/971565494",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1236#issuecomment-971565494",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236",
    "id": 971565494,
    "node_id": "IC_kwDOB7jojM456Om2",
    "user": {
      "login": "npitsillos",
      "id": 9141826,
      "node_id": "MDQ6VXNlcjkxNDE4MjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9141826?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/npitsillos",
      "html_url": "https://github.com/npitsillos",
      "followers_url": "https://api.github.com/users/npitsillos/followers",
      "following_url": "https://api.github.com/users/npitsillos/following{/other_user}",
      "gists_url": "https://api.github.com/users/npitsillos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/npitsillos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/npitsillos/subscriptions",
      "organizations_url": "https://api.github.com/users/npitsillos/orgs",
      "repos_url": "https://api.github.com/users/npitsillos/repos",
      "events_url": "https://api.github.com/users/npitsillos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/npitsillos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-17T13:11:26Z",
    "updated_at": "2021-11-17T13:11:26Z",
    "author_association": "NONE",
    "body": "@fvictorio  As a newcomer to both blockchain technology and javascript I have a question after trying to use your answer.  Assuming I have the following hardhat.config.js\r\n```javascript\r\nconst { task } = require(\"hardhat/config\");\r\nrequire(\"@nomiclabs/hardhat-waffle\");\r\n\r\n// BSC_URL = \"https://bsc-dataseed.binance.org/\"\r\n// This is a sample Hardhat task. To learn how to create your own go to\r\n// https://hardhat.org/guides/create-task.html\r\ntask(\"accounts\", \"Prints the list of accounts\", async (taskArgs, hre) => {\r\n  const accounts = await hre.ethers.getSigners();\r\n  for (const account of accounts) {\r\n    console.log(account.address);\r\n  }\r\n});\r\n\r\n// You need to export an object to set up your config\r\n// Go to https://hardhat.org/config/ to learn more\r\n\r\n/**\r\n * @type import('hardhat/config').HardhatUserConfig\r\n */\r\nmodule.exports = {\r\n  networks: {\r\n    hardhat: {\r\n      chainId: 56\r\n    }\r\n  },\r\n  solidity: \"0.8.4\",\r\n};\r\n```\r\n\r\nI fork the mainnet BSC node using the following:\r\n```npx hardhat node --fork https://bsc-dataseed.binance.org/```\r\n\r\nTo use your answer here\r\n\r\n> @itoukaijiE that has to do with reorg protection. When you don't specify a block number, the latest block number is used **minus** some number of blocks. For unsupported networks, like BSC, that value is 30. We don't have a way to circumvent that right now, but there's an ugly workaround that you can use: at the beginning of your script/test, you run something like this:\r\n> \r\n> ```js\r\n>   const bscProvider = new ethers.providers.JsonRpcProvider(BSC_URL);\r\n> \r\n>   const latestBlock = await bscProvider.getBlockNumber();\r\n> \r\n>   await network.provider.send(\"hardhat_reset\", [{\r\n>     forking: {\r\n>       jsonRpcUrl: BSC_URL,\r\n>       blockNumber: latestBlock\r\n>     }\r\n>   }])\r\n> ```\r\n> \r\n> Again, it's not pretty, but maybe it can help you for the time being.\r\n\r\nShould I add this to a script and call ```node <script>```?\r\n\r\nNote that I have tried this and still get this error.  Hope I have been clear and provided enough information for the problem I am facing.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/971565494/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/971593134",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1236#issuecomment-971593134",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236",
    "id": 971593134,
    "node_id": "IC_kwDOB7jojM456VWu",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-17T13:40:31Z",
    "updated_at": "2021-11-17T13:40:31Z",
    "author_association": "MEMBER",
    "body": "> Should I add this to a script and call `node <script>`?\r\n\r\nMy snippet was meant to be used inside the test task that @codler shared. It should work in a hardhat script too.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/971593134/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/971685829",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1236#issuecomment-971685829",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236",
    "id": 971685829,
    "node_id": "IC_kwDOB7jojM456r_F",
    "user": {
      "login": "npitsillos",
      "id": 9141826,
      "node_id": "MDQ6VXNlcjkxNDE4MjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9141826?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/npitsillos",
      "html_url": "https://github.com/npitsillos",
      "followers_url": "https://api.github.com/users/npitsillos/followers",
      "following_url": "https://api.github.com/users/npitsillos/following{/other_user}",
      "gists_url": "https://api.github.com/users/npitsillos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/npitsillos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/npitsillos/subscriptions",
      "organizations_url": "https://api.github.com/users/npitsillos/orgs",
      "repos_url": "https://api.github.com/users/npitsillos/repos",
      "events_url": "https://api.github.com/users/npitsillos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/npitsillos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-17T15:23:25Z",
    "updated_at": "2021-11-17T15:23:25Z",
    "author_association": "NONE",
    "body": "Thank you for your comment! I will try that but for completeness I have modified the `hardhat.config.js` file following this [site](https://www.binance.org/en/blog/using-hardhat-for-binance-smart-chain/).  I made a couple transactions with the public accounts provided from `npx hardhat node` and it worked fine",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/971685829/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1179222506",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1236#issuecomment-1179222506",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236",
    "id": 1179222506,
    "node_id": "IC_kwDOB7jojM5GSYHq",
    "user": {
      "login": "cryptoinhero",
      "id": 33366277,
      "node_id": "MDQ6VXNlcjMzMzY2Mjc3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33366277?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cryptoinhero",
      "html_url": "https://github.com/cryptoinhero",
      "followers_url": "https://api.github.com/users/cryptoinhero/followers",
      "following_url": "https://api.github.com/users/cryptoinhero/following{/other_user}",
      "gists_url": "https://api.github.com/users/cryptoinhero/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cryptoinhero/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cryptoinhero/subscriptions",
      "organizations_url": "https://api.github.com/users/cryptoinhero/orgs",
      "repos_url": "https://api.github.com/users/cryptoinhero/repos",
      "events_url": "https://api.github.com/users/cryptoinhero/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cryptoinhero/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-08T17:36:42Z",
    "updated_at": "2022-07-08T17:37:10Z",
    "author_association": "NONE",
    "body": "> @fvictorio Hmm, Im trying to make a generic fetching blockNumber but I don't manage to solve it. This is what I got so far. Maybe you can see what am missing in `hardhat.config.ts`? Url is `https://bsc-dataseed.binance.org/`\r\n> \r\n> ```ts\r\n> task(\"test\", async (args, hre, runSuper) => {\r\n>   if ((hre.network.config as HardhatNetworkConfig).forking?.enabled) {\r\n>     const blockNumber = BigNumber.from(\r\n>       await hre.network.provider.send(\"eth_blockNumber\")\r\n>     ).toNumber();\r\n>     const jsonRpcUrl = (hre.network.config as HardhatNetworkConfig).forking\r\n>       ?.url;\r\n> \r\n>     await hre.network.provider.request({\r\n>       method: \"hardhat_reset\",\r\n>       params: [\r\n>         {\r\n>           forking: {\r\n>             jsonRpcUrl,\r\n>             blockNumber,\r\n>           },\r\n>         },\r\n>       ],\r\n>     });\r\n>   }\r\n> \r\n>   return await runSuper(args);\r\n> });\r\n> ```\r\n\r\nWhen fork BSC network, it occurred \"ProviderError: missing trie node\" issue.\r\nIt seems like hardhat config does not allow forking for bsc with block number.\r\nIf I remove blockNumber param, it works for me.\r\n```\r\n    hardhat: {\r\n          accounts: { mnemonic},\r\n          forking: {\r\n            url: \"https://bsc-dataseed.binance.org/\",\r\n          }\r\n    }\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1179222506/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1180241778",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1236#issuecomment-1180241778",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1236",
    "id": 1180241778,
    "node_id": "IC_kwDOB7jojM5GWQ9y",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-11T10:45:14Z",
    "updated_at": "2022-07-11T10:45:14Z",
    "author_association": "MEMBER",
    "body": "@cryptoinhero please read [my previous comment](https://github.com/NomicFoundation/hardhat/issues/1236#issuecomment-904846041).",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1180241778/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
