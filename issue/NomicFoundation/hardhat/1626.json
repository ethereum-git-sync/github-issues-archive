{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1626",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1626/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1626/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1626/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/1626",
  "id": 935100385,
  "node_id": "MDU6SXNzdWU5MzUxMDAzODU=",
  "number": 1626,
  "title": "Possible bug around CREATE2",
  "user": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 901960538,
      "node_id": "MDU6TGFiZWw5MDE5NjA1Mzg=",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/type:bug",
      "name": "type:bug",
      "color": "FBCA04",
      "default": false,
      "description": "Something isn't working"
    }
  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 9,
  "created_at": "2021-07-01T18:15:37Z",
  "updated_at": "2022-11-18T16:00:44Z",
  "closed_at": "2021-09-15T14:17:13Z",
  "author_association": "MEMBER",
  "active_lock_reason": "resolved",
  "body": "Reproduction repo: https://github.com/Shadowfiend/hardhat-create2-bug\r\n\r\nI took an initial look into this and it seems indeed like a bug, but maybe I'm missing something.\r\n\r\nThanks @Shadowfiend for letting us know about this and making a superb reproduction example!\r\n\r\nSome things I've already tried:\r\n- Using the same address than waffle provider initializes (it doesn't make sense anyway, the first account is only used to fund the account that deploys the factory).\r\n- Using `ethers.provider` instead of `waffle.provider`",
  "closed_by": {
    "login": "feuGeneA",
    "id": 7883777,
    "node_id": "MDQ6VXNlcjc4ODM3Nzc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7883777?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/feuGeneA",
    "html_url": "https://github.com/feuGeneA",
    "followers_url": "https://api.github.com/users/feuGeneA/followers",
    "following_url": "https://api.github.com/users/feuGeneA/following{/other_user}",
    "gists_url": "https://api.github.com/users/feuGeneA/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/feuGeneA/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/feuGeneA/subscriptions",
    "organizations_url": "https://api.github.com/users/feuGeneA/orgs",
    "repos_url": "https://api.github.com/users/feuGeneA/repos",
    "events_url": "https://api.github.com/users/feuGeneA/events{/privacy}",
    "received_events_url": "https://api.github.com/users/feuGeneA/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1626/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1626/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/876762458",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1626#issuecomment-876762458",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1626",
    "id": 876762458,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3Njc2MjQ1OA==",
    "user": {
      "login": "Shadowfiend",
      "id": 8245,
      "node_id": "MDQ6VXNlcjgyNDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8245?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Shadowfiend",
      "html_url": "https://github.com/Shadowfiend",
      "followers_url": "https://api.github.com/users/Shadowfiend/followers",
      "following_url": "https://api.github.com/users/Shadowfiend/following{/other_user}",
      "gists_url": "https://api.github.com/users/Shadowfiend/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Shadowfiend/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Shadowfiend/subscriptions",
      "organizations_url": "https://api.github.com/users/Shadowfiend/orgs",
      "repos_url": "https://api.github.com/users/Shadowfiend/repos",
      "events_url": "https://api.github.com/users/Shadowfiend/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Shadowfiend/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-08T21:36:00Z",
    "updated_at": "2021-07-08T21:37:19Z",
    "author_association": "NONE",
    "body": "Okay, so I dug some more here. The issue is that the way the EIP-2470 `SingletonFactory` works will produce a successful transaction even if the CREATE2 fails, because it's just a direct call to CREATE2, and CREATE2 is defined as returning 0 but not throwing/reverting on failure, which sucks ðŸ™ƒ\r\n\r\nAt its core, what we're seeing is an out-of-gas for the CREATE2 call. In fact, the gas limit set when using the Hardhat provider is 68538, whereas with the waffle `MockProvider` it's 68655. Sure enough, passing an explicit `gasLimit: 68655` in both cases makes both pass; as such, this means the likely issue is in gas estimation here.\r\n\r\nFrom a quick skim of the gas estimation code, the fact that the CREATE2 call won't revert means the initial estimate correction will miscategorize the initial estimate as correct, and even if it wasn't marked correct it would be considered correct during the binary search:\r\n\r\nhttps://github.com/nomiclabs/hardhat/blob/7637c942e9ab7b424cab08a58306e13e8feaf32e/packages/hardhat-core/src/internal/hardhat-network/provider/node.ts#L1676-L1678\r\n\r\nhttps://github.com/nomiclabs/hardhat/blob/7637c942e9ab7b424cab08a58306e13e8feaf32e/packages/hardhat-core/src/internal/hardhat-network/provider/node.ts#L1748-L1756\r\n\r\nIn both of these cases the call has no error---but has a different effect than what was intended.\r\n\r\nThe context does, however, have the necessary information to decide this more appropriately: `result.execResult` here carries `returnValue`, which varies between the two. I'm not sure if it's the right thing to have the estimate correction code pay attention to this, or if it's better to dig into why the initial estimation differs---both may be outside the scope of what I can currently do, however.\r\n\r\nLast datapoint: although in this minimized example, the difference in estimated vs actual gas is a mere 17 gas, in the more complex use case that triggered this bug we're looking at a much larger difference of 104504â€”unclear what the most relevant difference might be, other than that the deployment bytes are much larger (2880 vs 92) and the constructor code for the non-minimized example is rather more complex and itself deploys another contract via the `SingletonFactory`.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/876762458/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/879846289",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1626#issuecomment-879846289",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1626",
    "id": 879846289,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3OTg0NjI4OQ==",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-14T12:24:25Z",
    "updated_at": "2021-07-14T12:24:25Z",
    "author_association": "MEMBER",
    "body": "Wow, that's very, very helpful. Thanks a lot for sharing @Shadowfiend!",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/879846289/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 2,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/915219363",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1626#issuecomment-915219363",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1626",
    "id": 915219363,
    "node_id": "IC_kwDOB7jojM42jSOj",
    "user": {
      "login": "PaulRBerg",
      "id": 8782666,
      "node_id": "MDQ6VXNlcjg3ODI2NjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8782666?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PaulRBerg",
      "html_url": "https://github.com/PaulRBerg",
      "followers_url": "https://api.github.com/users/PaulRBerg/followers",
      "following_url": "https://api.github.com/users/PaulRBerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulRBerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PaulRBerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulRBerg/subscriptions",
      "organizations_url": "https://api.github.com/users/PaulRBerg/orgs",
      "repos_url": "https://api.github.com/users/PaulRBerg/repos",
      "events_url": "https://api.github.com/users/PaulRBerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PaulRBerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-08T13:02:40Z",
    "updated_at": "2021-09-08T13:02:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "Just bumped into this as well. More data points:\r\n\r\n- This bug does not occur if the compiler optimizer is disabled\r\n- The bug does not occur if I check if the address returned by CREATE2, and revert if it is zero\r\n\r\nHere's my function:\r\n\r\n```sol\r\nfunction clone(bytes32 salt) internal returns (address payable proxy) {\r\n    bytes20 impl = bytes20(address(implementation));\r\n    assembly {\r\n        let bytecode := mload(0x40)\r\n        mstore(bytecode, 0x3d602d80600a3d3981f3363d3d373d3d3d363d73000000000000000000000000)\r\n        mstore(add(bytecode, 0x14), impl)\r\n        mstore(add(bytecode, 0x28), 0x5af43d82803e903d91602b57fd5bf30000000000000000000000000000000000)\r\n        proxy := create2(0, bytecode, 0x37, salt)\r\n    }\r\n}\r\n```\r\n\r\nWhich was called by a child contract that exposed the `clone` function:\r\n\r\n```sol\r\nfunction __godMode_clone(bytes32 salt) external returns (address payable proxy) {\r\n    proxy = clone(salt);\r\n}\r\n```\r\n\r\nLuckily, in my case, I was able to fix this by checking the proxy address:\r\n\r\n```sol\r\nfunction clone(bytes32 salt) internal returns (address payable proxy) {\r\n    // ...\r\n    if (proxy == address(0)) {\r\n        revert PRBProxyFactory__CloneFailed(salt);\r\n    }\r\n}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/915219363/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/919186317",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1626#issuecomment-919186317",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1626",
    "id": 919186317,
    "node_id": "IC_kwDOB7jojM42yauN",
    "user": {
      "login": "feuGeneA",
      "id": 7883777,
      "node_id": "MDQ6VXNlcjc4ODM3Nzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7883777?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/feuGeneA",
      "html_url": "https://github.com/feuGeneA",
      "followers_url": "https://api.github.com/users/feuGeneA/followers",
      "following_url": "https://api.github.com/users/feuGeneA/following{/other_user}",
      "gists_url": "https://api.github.com/users/feuGeneA/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/feuGeneA/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/feuGeneA/subscriptions",
      "organizations_url": "https://api.github.com/users/feuGeneA/orgs",
      "repos_url": "https://api.github.com/users/feuGeneA/repos",
      "events_url": "https://api.github.com/users/feuGeneA/events{/privacy}",
      "received_events_url": "https://api.github.com/users/feuGeneA/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-14T14:06:50Z",
    "updated_at": "2021-09-14T14:06:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "@alcuadrado and I worked together on this.  We reduced the reproduction and showed that there is no problem in the Waffle or Ethers layers, and that the problem must be either in Hardhat Network or in ethereumjs/vm.  To show this, we translated the wonderful reproduction repository given in this issue into the following simple sequence of RPC calls:\r\n\r\n```javascript\r\nconst hre = require(\"hardhat\");\r\n\r\nconst myMain = async function() {\r\n    // fund the address that will deploy the transaction:\r\n    await hre.network.provider.request({\r\n        \"method\": \"eth_sendRawTransaction\",\r\n        \"params\": [\r\n            \"0x02f874827a6980849502f90085010c388d0082520994bb6e024b9cffacb947a71991e386681b1cd1477d8757c084e5f3c00080c001a0a3d1ec8375a6de1b1243026b36e5358f4bd2fa7a89c40f9b097a3c297db03267a055910d1cb33e5c9a0c414e582dbdcb25ebcce8d565455fe1adaa0b63851dbac7\"\r\n        ]\r\n    })\r\n    // execute singletonFactoryDeploymentTx that's hardcoded into eip-2470\r\n    await hre.network.provider.request({\r\n        \"method\": \"eth_sendRawTransaction\",\r\n        \"params\": [\r\n            \"0xf9016c8085174876e8008303c4d88080b90154608060405234801561001057600080fd5b50610134806100206000396000f3fe6080604052348015600f57600080fd5b506004361060285760003560e01c80634af63f0214602d575b600080fd5b60cf60048036036040811015604157600080fd5b810190602081018135640100000000811115605b57600080fd5b820183602082011115606c57600080fd5b80359060200191846001830284011164010000000083111715608d57600080fd5b91908080601f016020809104026020016040519081016040528093929190818152602001838380828437600092019190915250929550509135925060eb915050565b604080516001600160a01b039092168252519081900360200190f35b6000818351602085016000f5939250505056fea26469706673582212206b44f8a82cb6b156bfcc3dc6aadd6df4eefd204bc928a4397fd15dacf6d5320564736f6c634300060200331b83247000822470\"\r\n        ]\r\n    })\r\n    // deploy our custom contract using the factory that was just deployed above\r\n    await hre.network.provider.request({\r\n        \"method\": \"eth_sendRawTransaction\",\r\n        \"params\": [\r\n            \"0x02f90132827a6901849502f90084f04caa9a83010bba94ce0042b868300000d44a59004da54a005ffdcf9f80b8c44af63f020000000000000000000000000000000000000000000000000000000000000040c02b59f772cb23a75b6ffb9f7602ba25fdd5d8e75ad88efcc013fec2c63b0895000000000000000000000000000000000000000000000000000000000000005c6080604052348015600f57600080fd5b50603f80601d6000396000f3fe6080604052600080fdfea2646970667358221220d7820c7c7f73919e8d23d9ac00f2a8282d3b057807f960372a8b61b956c3c73264736f6c6343000800003300000000c001a0242ed16b22d01a1b49735491223b2a978f6d13a219d6554ff12b02a83d353a2da06dc55ff7989e7956883e2a384518137837a65bf952da41cfd0a4f2c9878169a8\"\r\n        ]\r\n    })\r\n    // make sure there's code deployed at the address\r\n    console.log(await hre.network.provider.request({\r\n        \"method\": \"eth_getCode\",\r\n        \"params\": [\r\n            \"0xb37f3d9239733da8c83f548a79916384181fa427\",\r\n            \"latest\"\r\n        ]\r\n    }))\r\n}\r\n\r\nmyMain()\r\n```\r\n\r\nand then ran that via `yarn hardhat run script.js`, which can be run in an empty hardhat project.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/919186317/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/920060704",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1626#issuecomment-920060704",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1626",
    "id": 920060704,
    "node_id": "IC_kwDOB7jojM421wMg",
    "user": {
      "login": "feuGeneA",
      "id": 7883777,
      "node_id": "MDQ6VXNlcjc4ODM3Nzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7883777?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/feuGeneA",
      "html_url": "https://github.com/feuGeneA",
      "followers_url": "https://api.github.com/users/feuGeneA/followers",
      "following_url": "https://api.github.com/users/feuGeneA/following{/other_user}",
      "gists_url": "https://api.github.com/users/feuGeneA/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/feuGeneA/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/feuGeneA/subscriptions",
      "organizations_url": "https://api.github.com/users/feuGeneA/orgs",
      "repos_url": "https://api.github.com/users/feuGeneA/repos",
      "events_url": "https://api.github.com/users/feuGeneA/events{/privacy}",
      "received_events_url": "https://api.github.com/users/feuGeneA/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-15T14:17:13Z",
    "updated_at": "2021-09-15T14:17:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "Had another discussion with @alcuadrado about this.\r\n\r\nWe verified that using the same gas limit across all of (Hardhat Network, ganache *and* geth) results in the same behavior.  So we don't think there is an issue in Hardhat Network's execution of `create2`.\r\n\r\nThe only difference that we can see is that ganache gives a higher gas estimation whereas Hardhat Network and geth give a lower one.  Both Hardhat Network and geth fail to execute the test correctly when their gas estimation is used (rather than using a hardcoded value).  It's known that Hardhat Network and geth estimate gas in a similar way; and that ganache uses alternative methods.\r\n\r\nIt seems to us that the `SingletonFactory`'s `deploy` method, as depicted in EIP-2470, is not handling any error result from the `create2` opcode execution.  Because of that, both Hardhat Network and geth return a lower estimation than what's needed.  @paulrberg this is related the scenario you encountered; you should always validate the return of `create2`, unlike that implementation in EIP-2470.  Because of this deficiency in the EIP-2470 implementation, we feel this is not an issue in Hardhat, so we're closing this issue.\r\n\r\nNote also that in the test provided by @Shadowfiend , the assertion comparing of the destination address generated via `callStatic` to the address computed by `getCreate2Address` will always pass because the gas limit for `eth_call` (used by `callStatic`) is very high, much higher than what the gas estimation returns.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/920060704/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/920314979",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1626#issuecomment-920314979",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1626",
    "id": 920314979,
    "node_id": "IC_kwDOB7jojM422uRj",
    "user": {
      "login": "feuGeneA",
      "id": 7883777,
      "node_id": "MDQ6VXNlcjc4ODM3Nzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7883777?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/feuGeneA",
      "html_url": "https://github.com/feuGeneA",
      "followers_url": "https://api.github.com/users/feuGeneA/followers",
      "following_url": "https://api.github.com/users/feuGeneA/following{/other_user}",
      "gists_url": "https://api.github.com/users/feuGeneA/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/feuGeneA/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/feuGeneA/subscriptions",
      "organizations_url": "https://api.github.com/users/feuGeneA/orgs",
      "repos_url": "https://api.github.com/users/feuGeneA/repos",
      "events_url": "https://api.github.com/users/feuGeneA/events{/privacy}",
      "received_events_url": "https://api.github.com/users/feuGeneA/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-15T19:27:13Z",
    "updated_at": "2021-09-15T19:27:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "Here's an example of error checking that could/should be done for the `create2` opcode: https://github.com/OpenZeppelin/openzeppelin-contracts/blob/296223f876924da18b5aadd3343f4e2324f6176c/contracts/utils/Create2.sol#L40",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/920314979/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/920846244",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1626#issuecomment-920846244",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1626",
    "id": 920846244,
    "node_id": "IC_kwDOB7jojM424v-k",
    "user": {
      "login": "Shadowfiend",
      "id": 8245,
      "node_id": "MDQ6VXNlcjgyNDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8245?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Shadowfiend",
      "html_url": "https://github.com/Shadowfiend",
      "followers_url": "https://api.github.com/users/Shadowfiend/followers",
      "following_url": "https://api.github.com/users/Shadowfiend/following{/other_user}",
      "gists_url": "https://api.github.com/users/Shadowfiend/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Shadowfiend/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Shadowfiend/subscriptions",
      "organizations_url": "https://api.github.com/users/Shadowfiend/orgs",
      "repos_url": "https://api.github.com/users/Shadowfiend/repos",
      "events_url": "https://api.github.com/users/Shadowfiend/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Shadowfiend/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-16T12:10:32Z",
    "updated_at": "2021-09-16T12:10:32Z",
    "author_association": "NONE",
    "body": "Sweet, thanks for confirming my suspicions above so thoroughly!\n\n> It's known that Hardhat Network and geth estimate gas in a similar way; and that ganache uses alternative methods.\n\nThis is something I didn't know, and explains that estimate discrepancy for sure! Did you happen to see if there was any easy adjustment that could help this estimate be more correct in HardHat Network, and if so a process to propose and implement such an adjustment?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/920846244/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/920965560",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1626#issuecomment-920965560",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1626",
    "id": 920965560,
    "node_id": "IC_kwDOB7jojM425NG4",
    "user": {
      "login": "alcuadrado",
      "id": 176499,
      "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alcuadrado",
      "html_url": "https://github.com/alcuadrado",
      "followers_url": "https://api.github.com/users/alcuadrado/followers",
      "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
      "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
      "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
      "repos_url": "https://api.github.com/users/alcuadrado/repos",
      "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-16T14:42:43Z",
    "updated_at": "2021-09-16T14:43:31Z",
    "author_association": "MEMBER",
    "body": "We implemented `eth_estimateGas` to closely mimic what geth does, so that testing with Hardhat Network is closer to running against mainnet. This is doing a binary search of a somewhat tight upper bound of the required gas limit. This is slow, as you need to execute the same tx multiple times, but it's exactly what geth does.\r\n\r\nGanache, on the contrary, executes the tx onces and tries to compute an upper bound based on a single execution trace. This is faster, but can lead to pretty different results when compared to geth, as the gas limit itself alters the execution of the tx.\r\n\r\nI'd say that Hardhat Network's implementation is more \"correct\", but just slower. We have other plans to improve its performance though.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/920965560/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/921331130",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1626#issuecomment-921331130",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1626",
    "id": 921331130,
    "node_id": "IC_kwDOB7jojM426mW6",
    "user": {
      "login": "Shadowfiend",
      "id": 8245,
      "node_id": "MDQ6VXNlcjgyNDU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8245?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Shadowfiend",
      "html_url": "https://github.com/Shadowfiend",
      "followers_url": "https://api.github.com/users/Shadowfiend/followers",
      "following_url": "https://api.github.com/users/Shadowfiend/following{/other_user}",
      "gists_url": "https://api.github.com/users/Shadowfiend/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Shadowfiend/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Shadowfiend/subscriptions",
      "organizations_url": "https://api.github.com/users/Shadowfiend/orgs",
      "repos_url": "https://api.github.com/users/Shadowfiend/repos",
      "events_url": "https://api.github.com/users/Shadowfiend/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Shadowfiend/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-16T23:29:08Z",
    "updated_at": "2021-09-16T23:29:08Z",
    "author_association": "NONE",
    "body": "Awesome, thanks for the detailed explanation!",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/921331130/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
