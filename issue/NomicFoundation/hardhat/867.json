{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/867",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/867/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/867/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/867/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/867",
  "id": 718541834,
  "node_id": "MDU6SXNzdWU3MTg1NDE4MzQ=",
  "number": 867,
  "title": "What is the right way of constructing TransactionRequest ?",
  "user": {
    "login": "shamb0",
    "id": 47242317,
    "node_id": "MDQ6VXNlcjQ3MjQyMzE3",
    "avatar_url": "https://avatars.githubusercontent.com/u/47242317?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/shamb0",
    "html_url": "https://github.com/shamb0",
    "followers_url": "https://api.github.com/users/shamb0/followers",
    "following_url": "https://api.github.com/users/shamb0/following{/other_user}",
    "gists_url": "https://api.github.com/users/shamb0/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/shamb0/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/shamb0/subscriptions",
    "organizations_url": "https://api.github.com/users/shamb0/orgs",
    "repos_url": "https://api.github.com/users/shamb0/repos",
    "events_url": "https://api.github.com/users/shamb0/events{/privacy}",
    "received_events_url": "https://api.github.com/users/shamb0/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2020-10-10T06:00:08Z",
  "updated_at": "2023-03-31T00:14:30Z",
  "closed_at": "2022-12-30T11:35:08Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "I was trying Simple example derived from [SWC-136](https://swcregistry.io/docs/SWC-136)\r\n, Complete buidler workspace at [gitrepo](https://github.com/shamb0/ssec-swc-136-unencrypted-secrets) ...\r\n\r\nFor Use-case **\"tst-item-002-usr1-play\"**, When running under ganache network context,\r\nI see an exception like **\"Exception Err Error: VM Exception while processing transaction: invalid opcode\"**. But when running under buidlerevm context no exception, and function corresponds to transaction gets executed but \"address(this).balance\" state is not persistence & no gas is consumed.\r\n\r\nBut when I execute Use-case **\"tst-item-001-print-index\"** I can see proper gas is consumed.\r\n\r\nHere I am using \"encodeFunctionData()\" to construct the TransactionRequest\r\n\r\n**Trace Under ganache context**\r\n\r\n```shell\r\nmain$ env DEBUG=\"debug*,info*,error*\" yarn run test test/OddEvenV2.spec.ts --network ganache\r\nyarn run v1.22.4\r\n$ yarn run test:contracts test/OddEvenV2.spec.ts --network ganache\r\n$ cross-env SOLPP_FLAGS=\"FLAG_IS_TEST,FLAG_IS_DEBUG\" buidler test --show-stack-traces test/OddEvenV2.spec.ts --network ganache\r\n$(process.argv.length)\r\nAll contracts have already been compiled, skipping compilation.\r\n\r\n\r\n  unencrypted-secrets Test\r\n  info:Unencrypted-Secrets-Test Admin :: 0xDeB360ee222a06a2C11B95BBfC4Fc0b550086698 +0ms\r\n  info:Unencrypted-Secrets-Test Usr1 :: 0x2FE360CBA3907188548f54f5591AE647EB21A53a +0ms\r\n  info:Unencrypted-Secrets-Test Usr2 :: 0xe53CF32b013fE26444766DF91a0a33064F134AEf +0ms\r\n  info:Unencrypted-Secrets-Test Usr3 :: 0xAdd261257057fF1590cCc073aDc6EdC48BE9332B +0ms\r\n  debug:Unencrypted-Secrets-Test Network Gas price @ 13314 +0ms\r\n  debug:Unencrypted-Secrets-Test Network Gas price @ 0.000000000000013314 +1ms\r\n  debug:Unencrypted-Secrets-Test S1-Ent wallet bal :: 200.0 +8ms\r\n  debug:Unencrypted-Secrets-Test OddEven @ 0xc509aA36275bca7A10D2A9D7f3C423983e2e2646 +105ms\r\n  debug:Unencrypted-Secrets-Test OddEven balance :: 0.0 +7ms\r\n  debug:Unencrypted-Secrets-Test S1-Ext wallet bal :: 199.999999993369108754 +8ms\r\n  debug:Unencrypted-Secrets-Test S2.1-Ent :: 199.999999993369108754 +8ms\r\n  debug:Unencrypted-Secrets-Test Int Index :: 0 +58ms\r\n  debug:Unencrypted-Secrets-Test S2.1-Ext :: 199.999999993012999196 +8ms\r\n    ✓ tst-item-001-print-index (74ms)\r\n  debug:Unencrypted-Secrets-Test OddEven balance :: 0.0 +8ms\r\n  debug:Unencrypted-Secrets-Test S3-Ext wallet bal :: 199.999999993012999196 +9ms\r\n  debug:Unencrypted-Secrets-Test S2-Ent :: 199.999999993012999196 +9ms\r\n  debug:Unencrypted-Secrets-Test S2-Ent usr1 bal :: 200.0 +8ms\r\n  debug:Unencrypted-Secrets-Test S2.2 nounce :: 0 +9ms\r\n  error:Unencrypted-Secrets-Test Exception Err Error: VM Exception while processing transaction: invalid opcode +0ms\r\n    ✓ tst-item-002-usr1-play (50ms)\r\n  debug:Unencrypted-Secrets-Test OddEven balance :: 0.0 +31ms\r\n  debug:Unencrypted-Secrets-Test S3-Ext wallet bal :: 199.999999993012999196 +8ms\r\n  debug:Unencrypted-Secrets-Test OddEven balance :: 0.0 +11ms\r\n  debug:Unencrypted-Secrets-Test S4-Ext wallet bal :: 199.999999993012999196 +9ms\r\n\r\n\r\n  2 passing (408ms)\r\n\r\nDone in 7.80s.\r\n```\r\n\r\n**Trace Under buidlerevm context**\r\n\r\n```shell\r\nmain $ env DEBUG=\"debug*,info*,error*\" yarn run test test/OddEvenV2.spec.ts\r\nyarn run v1.22.4\r\n$ yarn run test:contracts test/OddEvenV2.spec.ts\r\n$ cross-env SOLPP_FLAGS=\"FLAG_IS_TEST,FLAG_IS_DEBUG\" buidler test --show-stack-traces test/OddEvenV2.spec.ts\r\n$(process.argv.length)\r\nAll contracts have already been compiled, skipping compilation.\r\n\r\n\r\n  unencrypted-secrets Test\r\n  info:Unencrypted-Secrets-Test Admin :: 0x17ec8597ff92C3F44523bDc65BF0f1bE632917ff +0ms\r\n  info:Unencrypted-Secrets-Test Usr1 :: 0x63FC2aD3d021a4D7e64323529a55a9442C444dA0 +0ms\r\n  info:Unencrypted-Secrets-Test Usr2 :: 0xD1D84F0e28D6fedF03c73151f98dF95139700aa7 +0ms\r\n  info:Unencrypted-Secrets-Test Usr3 :: 0xd59ca627Af68D29C547B91066297a7c469a7bF72 +0ms\r\n  debug:Unencrypted-Secrets-Test Network Gas price @ 8000000000 +0ms\r\n  debug:Unencrypted-Secrets-Test Network Gas price @ 0.000000008 +0ms\r\n  debug:Unencrypted-Secrets-Test S1-Ent wallet bal :: 200.0 +5ms\r\nOddEven@constructor owner addr[0x17ec8597ff92c3f44523bdc65bf0f1be632917ff]\r\n  debug:Unencrypted-Secrets-Test OddEven @ 0xA193E42526F1FEA8C99AF609dcEabf30C1c29fAA +75ms\r\n  debug:Unencrypted-Secrets-Test OddEven balance :: 0.0 +2ms\r\n  debug:Unencrypted-Secrets-Test S1-Ext wallet bal :: 199.99681348 +2ms\r\n  debug:Unencrypted-Secrets-Test S2.1-Ent :: 199.99681348 +3ms\r\n  debug:Unencrypted-Secrets-Test Int Index :: 0 +77ms\r\n  debug:Unencrypted-Secrets-Test S2.1-Ext :: 199.996629968 +3ms\r\n    ✓ tst-item-001-print-index (83ms)\r\n  debug:Unencrypted-Secrets-Test OddEven balance :: 0.0 +2ms\r\n  debug:Unencrypted-Secrets-Test S3-Ext wallet bal :: 199.996629968 +2ms\r\n  debug:Unencrypted-Secrets-Test S2-Ent :: 199.996629968 +3ms\r\n  debug:Unencrypted-Secrets-Test S2-Ent usr1 bal :: 200.0 +3ms\r\n  debug:Unencrypted-Secrets-Test S2.2 nounce :: 0 +4ms\r\narg addr[0x63fc2ad3d021a4d7e64323529a55a9442c444da0] val[2]\r\nCont bal[10000000000000000000]\r\naddr[0x63fc2ad3d021a4d7e64323529a55a9442c444da0]::numb[2]\r\n  debug:Unencrypted-Secrets-Test OddEven balance :: 0.0 +25ms\r\n  debug:Unencrypted-Secrets-Test S2-Ext usr1 bal :: 200.0 +2ms\r\n  debug:Unencrypted-Secrets-Test ======================== Usr2 Trans ======================== +0ms\r\n  debug:Unencrypted-Secrets-Test S2-Ent usr2 bal :: 200.0 +2ms\r\n  debug:Unencrypted-Secrets-Test S2.2 nounce :: 0 +3ms\r\nOddEven@receive fromaddr[0xd1d84f0e28d6fedf03c73151f98df95139700aa7] bal[10000000000000000000]\r\n  debug:Unencrypted-Secrets-Test OddEven balance :: 0.0 +12ms\r\n  debug:Unencrypted-Secrets-Test S2-Ext usr2 bal :: 200.0 +4ms\r\n  debug:Unencrypted-Secrets-Test S2-Ext :: 199.996629968 +2ms\r\n    ✓ tst-item-002-usr1-play (59ms)\r\n  debug:Unencrypted-Secrets-Test OddEven balance :: 0.0 +2ms\r\n  debug:Unencrypted-Secrets-Test S3-Ext wallet bal :: 199.996629968 +2ms\r\n  debug:Unencrypted-Secrets-Test OddEven balance :: 0.0 +2ms\r\n  debug:Unencrypted-Secrets-Test S4-Ext wallet bal :: 199.996629968 +2ms\r\n\r\n\r\n  2 passing (430ms)\r\n\r\nDone in 7.81s.\r\n```",
  "closed_by": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/867/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/867/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/706532024",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/867#issuecomment-706532024",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/867",
    "id": 706532024,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNjUzMjAyNA==",
    "user": {
      "login": "alcuadrado",
      "id": 176499,
      "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alcuadrado",
      "html_url": "https://github.com/alcuadrado",
      "followers_url": "https://api.github.com/users/alcuadrado/followers",
      "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
      "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
      "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
      "repos_url": "https://api.github.com/users/alcuadrado/repos",
      "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-10T11:12:16Z",
    "updated_at": "2020-10-10T11:12:16Z",
    "author_association": "MEMBER",
    "body": "Hey @shamb0, can you provide a series of executable steps to reproduce this? Thanks",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/706532024/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/706539919",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/867#issuecomment-706539919",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/867",
    "id": 706539919,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNjUzOTkxOQ==",
    "user": {
      "login": "shamb0",
      "id": 47242317,
      "node_id": "MDQ6VXNlcjQ3MjQyMzE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/47242317?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shamb0",
      "html_url": "https://github.com/shamb0",
      "followers_url": "https://api.github.com/users/shamb0/followers",
      "following_url": "https://api.github.com/users/shamb0/following{/other_user}",
      "gists_url": "https://api.github.com/users/shamb0/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shamb0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shamb0/subscriptions",
      "organizations_url": "https://api.github.com/users/shamb0/orgs",
      "repos_url": "https://api.github.com/users/shamb0/repos",
      "events_url": "https://api.github.com/users/shamb0/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shamb0/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-10T12:14:24Z",
    "updated_at": "2020-10-10T12:14:24Z",
    "author_association": "NONE",
    "body": "Hi @alcuadrado, thanks for support ...\r\n\r\nPlz find the steps below ...\r\n\r\n1. To clone the repo ...\r\n\r\n```shell\r\ngit clone https://github.com/shamb0/ssec-swc-136-unencrypted-secrets.git\r\ncd ssec-swc-136-unencrypted-secrets\r\n```\r\n\r\n2. To build ...\r\n\r\n```shell\r\nyarn install\r\nyarn build\r\n```\r\n\r\n3. To run on buidlerevm with trace prints enabled ...\r\n\r\n```shell\r\nenv DEBUG=\"debug*,info*,error*\" yarn run test test/OddEvenV2.spec.ts\r\n```\r\n\r\n4. To run on ganache with trace prints enabled ...\r\n\r\n```shell\r\nenv DEBUG=\"debug*,info*,error*\" yarn run test test/OddEvenV2.spec.ts --network ganache\r\n```\r\n\r\nPlz let me know if additional details required ...\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/706539919/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1367872354",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/867#issuecomment-1367872354",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/867",
    "id": 1367872354,
    "node_id": "IC_kwDOB7jojM5RiBNi",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-30T11:35:08Z",
    "updated_at": "2022-12-30T11:35:08Z",
    "author_association": "MEMBER",
    "body": "Hi, I'm closing old issues that are unlikely to still be relevant. Please let us know if that's not the case, and sorry for not responding to this after your last comment.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1367872354/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
