{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1477",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1477/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1477/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1477/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/1477",
  "id": 898982033,
  "node_id": "MDU6SXNzdWU4OTg5ODIwMzM=",
  "number": 1477,
  "title": "Error: Transaction reverted and Hardhat couldn't infer the reason",
  "user": {
    "login": "JoyCood",
    "id": 8186555,
    "node_id": "MDQ6VXNlcjgxODY1NTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8186555?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/JoyCood",
    "html_url": "https://github.com/JoyCood",
    "followers_url": "https://api.github.com/users/JoyCood/followers",
    "following_url": "https://api.github.com/users/JoyCood/following{/other_user}",
    "gists_url": "https://api.github.com/users/JoyCood/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/JoyCood/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/JoyCood/subscriptions",
    "organizations_url": "https://api.github.com/users/JoyCood/orgs",
    "repos_url": "https://api.github.com/users/JoyCood/repos",
    "events_url": "https://api.github.com/users/JoyCood/events{/privacy}",
    "received_events_url": "https://api.github.com/users/JoyCood/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2474207618,
      "node_id": "MDU6TGFiZWwyNDc0MjA3NjE4",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/status:needs-more-info",
      "name": "status:needs-more-info",
      "color": "0E8A16",
      "default": false,
      "description": "There's not enough information to start working on this issue"
    }
  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-05-23T09:59:59Z",
  "updated_at": "2022-11-18T18:26:12Z",
  "closed_at": "2021-06-17T12:17:45Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "error message:\r\n\r\n> web3_clientVersion\r\neth_chainId\r\neth_accounts (2)\r\neth_chainId\r\neth_estimateGas\r\neth_gasPrice\r\neth_sendTransaction\r\n  Contract call:       Diamond#<unrecognized-selector>\r\n  Transaction:         0x683b56b9df884d7ce0a0db6dedabf806694a50e9aa94f23ac99a589ed08f0879\r\n  From:                0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266\r\n  To:                  0xb7f8bc63bbcad18155201308c8f3540b07f84f5e\r\n  Value:               0 ETH\r\n  Gas used:            51257 of 51657\r\n  Block #24:           0x89a308c60799d153e68bf3301d831853eb7cddfc2f9f6a702088b43c1555d344\r\n  eth_chainId\r\n    eth_getTransactionByHash\r\n    eth_blockNumber\r\neth_chainId (2)\r\neth_estimateGas (2)\r\neth_call\r\n  Contract call:       Diamond#<unrecognized-selector>\r\n  From:                0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266\r\n  To:                  0x9a9f2ccfde556a7e9ff0848998aa4a0cfd8863ae\r\n  eth_sendTransaction\r\n  Contract call:       Diamond#<unrecognized-selector>\r\n  Transaction:         0xe7a4ff2f211a7f3b7f64ca9456ea73c9d740b95ae1099f0e8c3898550ff011ef\r\n  From:                0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266\r\n  To:                  0x9a9f2ccfde556a7e9ff0848998aa4a0cfd8863ae\r\n  Value:               0 ETH\r\n  Gas used:            388348 of 424755\r\n  Block #25:           0xea27d937dffaa4f4dbb47114eb8fb55ab8cd97c9cb07d7d270a5edcc193d5df2\r\n\r\neth_sendTransaction\r\n  Contract call:       Diamond#<unrecognized-selector>\r\n  Transaction:         0x7dd650d6c9f77b33a262581fa36f4c891b5648578cfd3d9cb80b0be81b9fc820\r\n  From:                0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266\r\n  To:                  0x9a9f2ccfde556a7e9ff0848998aa4a0cfd8863ae\r\n  Value:               0 ETH\r\n  Gas used:            418575 of 424755\r\n  Block #26:           0x946474d9af3aee5a58a77c178af2c9588a443137df894d04aece06f26c36c05c\r\n\r\n  Error: Transaction reverted and Hardhat couldn't infer the reason. Please report this to help us improve Hardhat.\r\n      at ERC721MarketplaceFacet.addERC721ListingItem (contracts/marketplace/libraries/LibERC721Marketplace.sol:67)\r\n      at ERC721MarketplaceFacet.addERC721Listing (contracts/marketplace/facets/ERC721MarketplaceFacet.sol:131)\r\n      at ERC721MarketplaceFacet.addERC721Listing (contracts/marketplace/facets/ERC721MarketplaceFacet.sol:93)\r\n      at Diamond.<fallback> (contracts/shared/Diamond.sol:27)\r\n      at HardhatNode._mineBlockWithPendingTxs (/Users/knight/Projects/valuemaster/node_modules/hardhat/src/internal/hardhat-network/provider/node.ts:1154:23)\r\n      at HardhatNode.mineBlock (/Users/knight/Projects/valuemaster/node_modules/hardhat/src/internal/hardhat-network/provider/node.ts:377:16)\r\n      at EthModule._sendTransactionAndReturnHash (/Users/knight/Projects/valuemaster/node_modules/hardhat/src/internal/hardhat-network/provider/modules/eth.ts:1376:18)\r\n      at HardhatNetworkProvider._sendWithLogging (/Users/knight/Projects/valuemaster/node_modules/hardhat/src/internal/hardhat-network/provider/provider.ts:119:22)\r\n      at HardhatNetworkProvider.request (/Users/knight/Projects/valuemaster/node_modules/hardhat/src/internal/hardhat-network/provider/provider.ts:99:18)\r\n      at JsonRpcHandler._handleRequest (/Users/knight/Projects/valuemaster/node_modules/hardhat/src/internal/hardhat-network/jsonrpc/handler.ts:188:20)\r\n      at JsonRpcHandler._handleSingleRequest (/Users/knight/Projects/valuemaster/node_modules/hardhat/src/internal/hardhat-network/jsonrpc/handler.ts:167:17)\r\n\r\njavascript:\r\n`\r\n    const { meta } = require('./meta.js')\r\n    const tokens = [\r\n        {\"id\": 1, \"price\": \"1\"}, \r\n        {\"id\": 2, \"price\": \"2\"}, \r\n    ]\r\n\r\n    async function main() {\r\n        const metaVars = await meta()\r\n        const slimeDiamond = metaVars.slimeDiamond\r\n        const valuemasterDiamond = metaVars.valuemasterDiamond\r\n\r\n        const erc721MarketplaceFacet = await ethers.getContractAt('ERC721MarketplaceFacet', valuemasterDiamond)\r\n        const slimeFacet = await ethers.getContractAt('SlimeFacet', slimeDiamond)\r\n\r\n        await slimeFacet.setApprovalForAll(valuemasterDiamond, true)\r\n\r\n        await tokens.map(async token => {\r\n            await erc721MarketplaceFacet.addERC721Listing(slimeDiamond, token.id, ethers.utils.parseEther(token.price))\r\n        })\r\n        let listings = await erc721MarketplaceFacet.getERC721Listings(0, \"listed\", 20)\r\n        console.log(\"listings: \", listings)\r\n    }\r\n\r\n    if (require.main === module) {\r\n        main()\r\n\t    .then(() => process.exit(0))\r\n\t    .catch(error => {\r\n\t        console.error(error)\r\n\t        process.exit(1)\r\n\t    })\r\n    }`",
  "closed_by": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1477/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1477/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/848863210",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1477#issuecomment-848863210",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1477",
    "id": 848863210,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0ODg2MzIxMA==",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-26T15:22:51Z",
    "updated_at": "2021-05-26T15:22:51Z",
    "author_association": "MEMBER",
    "body": "@JoyCood is your repo public? If not, could you tell us how to reproduce this besides the script you shared?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/848863210/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/849711515",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1477#issuecomment-849711515",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1477",
    "id": 849711515,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0OTcxMTUxNQ==",
    "user": {
      "login": "JoyCood",
      "id": 8186555,
      "node_id": "MDQ6VXNlcjgxODY1NTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8186555?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JoyCood",
      "html_url": "https://github.com/JoyCood",
      "followers_url": "https://api.github.com/users/JoyCood/followers",
      "following_url": "https://api.github.com/users/JoyCood/following{/other_user}",
      "gists_url": "https://api.github.com/users/JoyCood/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JoyCood/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JoyCood/subscriptions",
      "organizations_url": "https://api.github.com/users/JoyCood/orgs",
      "repos_url": "https://api.github.com/users/JoyCood/repos",
      "events_url": "https://api.github.com/users/JoyCood/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JoyCood/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-27T15:05:38Z",
    "updated_at": "2021-05-27T15:07:57Z",
    "author_association": "NONE",
    "body": "> @JoyCood is your repo public? If not, could you tell us how to reproduce this besides the script you shared?\r\nthanks for your response, my **hardhat version is 2.3.0**\r\nyou can check this [repo](https://github.com/aavegotchi/aavegotchi-contracts/blob/master/contracts/Aavegotchi/libraries/LibERC721Marketplace.sol) on line 67, and call the contract function `addERC721ListingItem ` using `\r\nconst tokens = [\r\n    {\"id\": 1, \"price\": \"1\"}, \r\n    {\"id\": 2, \"price\": \"2\"}, \r\n]\r\n**// below two comment out lines work fine, but use the loop statement will failed**\r\n  //await erc721MarketplaceFacet.addERC721Listing(slimeDiamond, tokens[0].id, ethers.utils.parseEther(tokens[0].price))\r\n   // await erc721MarketplaceFacet.addERC721Listing(slimeDiamond, tokens[1].id, ethers.utils.parseEther(tokens[1].price))\r\n\r\n    await tokens.map(async token => {\r\n        await erc721MarketplaceFacet.addERC721Listing(slimeDiamond, token.id, ethers.utils.parseEther(token.price))\r\n    })\r\n` l",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/849711515/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/855850332",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1477#issuecomment-855850332",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1477",
    "id": 855850332,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1NTg1MDMzMg==",
    "user": {
      "login": "sirpy",
      "id": 671095,
      "node_id": "MDQ6VXNlcjY3MTA5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/671095?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sirpy",
      "html_url": "https://github.com/sirpy",
      "followers_url": "https://api.github.com/users/sirpy/followers",
      "following_url": "https://api.github.com/users/sirpy/following{/other_user}",
      "gists_url": "https://api.github.com/users/sirpy/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sirpy/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sirpy/subscriptions",
      "organizations_url": "https://api.github.com/users/sirpy/orgs",
      "repos_url": "https://api.github.com/users/sirpy/repos",
      "events_url": "https://api.github.com/users/sirpy/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sirpy/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-07T11:34:51Z",
    "updated_at": "2021-06-07T11:34:51Z",
    "author_association": "NONE",
    "body": "we started having these issue when add/removing a single line from the contract\r\nwe are using solidity 8 though.\r\nbut it is still strange that revert reason works ok, but after adding a line of code in unrelated place, some revert reasons stop working. we validated that it reverts at the correct place",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/855850332/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/863190162",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1477#issuecomment-863190162",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1477",
    "id": 863190162,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MzE5MDE2Mg==",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-17T12:17:45Z",
    "updated_at": "2021-06-17T12:17:45Z",
    "author_association": "MEMBER",
    "body": "Hi, Hardhat [2.4.0](https://github.com/nomiclabs/hardhat/releases/tag/hardhat-core-v2.4.0) now has a better error detection mechanism that might fix this. Please try it out and feel free to re-open this issue if you are still having issues.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/863190162/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
