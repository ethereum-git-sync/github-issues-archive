{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1732",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1732/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1732/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1732/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/1732",
  "id": 954447340,
  "node_id": "MDU6SXNzdWU5NTQ0NDczNDA=",
  "number": 1732,
  "title": "Testing methods reject hex-encoded parameters",
  "user": {
    "login": "wolflo",
    "id": 33909953,
    "node_id": "MDQ6VXNlcjMzOTA5OTUz",
    "avatar_url": "https://avatars.githubusercontent.com/u/33909953?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wolflo",
    "html_url": "https://github.com/wolflo",
    "followers_url": "https://api.github.com/users/wolflo/followers",
    "following_url": "https://api.github.com/users/wolflo/following{/other_user}",
    "gists_url": "https://api.github.com/users/wolflo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wolflo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wolflo/subscriptions",
    "organizations_url": "https://api.github.com/users/wolflo/orgs",
    "repos_url": "https://api.github.com/users/wolflo/repos",
    "events_url": "https://api.github.com/users/wolflo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wolflo/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 901960542,
      "node_id": "MDU6TGFiZWw5MDE5NjA1NDI=",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/good-first-issue",
      "name": "good-first-issue",
      "color": "006B75",
      "default": false,
      "description": "Good for newcomers. Guidance available if needed"
    }
  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2021-07-28T03:55:33Z",
  "updated_at": "2022-11-18T13:10:40Z",
  "closed_at": "2021-11-26T12:03:53Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": "resolved",
  "body": "Testing methods like `evm_mine` and `evm_increaseTime` expect integer parameters. Unlike other methods, they reject these parameters if they are not decimal-encoded.\r\n\r\n### To reproduce\r\n\r\n`npx hardhat --version` -> `2.5.0`\r\n\r\nRun `npx hardhat node` and make the following rpc calls:\r\n```\r\n> curl -H \"Content-Type: application/json\" -X POST --data \\\r\n        '{\"id\":1337,\"jsonrpc\":\"2.0\",\"method\":\"evm_increaseTime\",\"params\":[32]}' \\\r\n        http://localhost:8545\r\n{\"jsonrpc\":\"2.0\",\"id\":1337,\"result\":\"41\"}\r\n\r\n> curl -H \"Content-Type: application/json\" -X POST --data \\\r\n        '{\"id\":1337,\"jsonrpc\":\"2.0\",\"method\":\"evm_increaseTime\",\"params\":[\"0x20\"]}' \\\r\n        http://localhost:8545\r\n{\"jsonrpc\":\"2.0\",\"id\":1337,\"error\":{\"code\":-32602,\"message\":\"Errors encountered in param 0: Invalid value \\\"0x20\\\" supplied to : number\"}}\r\n```",
  "closed_by": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1732/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1732/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/888468666",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1732#issuecomment-888468666",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1732",
    "id": 888468666,
    "node_id": "IC_kwDOB7jojM409PS6",
    "user": {
      "login": "wolflo",
      "id": 33909953,
      "node_id": "MDQ6VXNlcjMzOTA5OTUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/33909953?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wolflo",
      "html_url": "https://github.com/wolflo",
      "followers_url": "https://api.github.com/users/wolflo/followers",
      "following_url": "https://api.github.com/users/wolflo/following{/other_user}",
      "gists_url": "https://api.github.com/users/wolflo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wolflo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wolflo/subscriptions",
      "organizations_url": "https://api.github.com/users/wolflo/orgs",
      "repos_url": "https://api.github.com/users/wolflo/repos",
      "events_url": "https://api.github.com/users/wolflo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wolflo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-28T16:57:57Z",
    "updated_at": "2021-07-28T16:57:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "This appears to be enforced in the test suite for `evm_increaseTime`. \r\n\r\nhttps://github.com/nomiclabs/hardhat/blob/c9e8a609be8b7751ce375a22159d4d2af162dad2/packages/hardhat-core/test/internal/hardhat-network/provider/modules/evm.ts#L127-L131\r\n\r\nI would disagree that this should be the case, though. \r\n\r\nI don't know the reasoning for returning the total adjusted time from this method as a decimal-encoded value rather than hex-encoded, but that does seem to be intentional. However, ganache does still accept a hex-encoded argument to the method. Changing this behavior requires a special case for `evm_increaseTime` in any library that automatically encodes arguments to rpc methods as hex strings.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/888468666/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/888472265",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1732#issuecomment-888472265",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1732",
    "id": 888472265,
    "node_id": "IC_kwDOB7jojM409QLJ",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-28T17:03:21Z",
    "updated_at": "2021-07-28T17:03:31Z",
    "author_association": "MEMBER",
    "body": "I think it makes sense to be more permissive and accept hex-encoded arguments in these methods. But we can't change the output of the methods since that would be a breaking change.\r\n\r\n@alcuadrado thoughts?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/888472265/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/888505254",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1732#issuecomment-888505254",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1732",
    "id": 888505254,
    "node_id": "IC_kwDOB7jojM409YOm",
    "user": {
      "login": "wolflo",
      "id": 33909953,
      "node_id": "MDQ6VXNlcjMzOTA5OTUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/33909953?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wolflo",
      "html_url": "https://github.com/wolflo",
      "followers_url": "https://api.github.com/users/wolflo/followers",
      "following_url": "https://api.github.com/users/wolflo/following{/other_user}",
      "gists_url": "https://api.github.com/users/wolflo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wolflo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wolflo/subscriptions",
      "organizations_url": "https://api.github.com/users/wolflo/orgs",
      "repos_url": "https://api.github.com/users/wolflo/repos",
      "events_url": "https://api.github.com/users/wolflo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wolflo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-28T17:53:55Z",
    "updated_at": "2021-07-28T17:53:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "Seems that the opposite is true, too. Ganache accepts decimal-encoded values for non-test methods like `eth_getBlockByNumber`, while hardhat (and geth) reject them.\r\n\r\n`ganache-cli`\r\n```\r\n~ ❯ curl -H \"Content-Type: application/json\" -X POST --data \\\r\n        '{\"id\":1337,\"jsonrpc\":\"2.0\",\"method\":\"eth_getBlockByNumber\",\"params\":[1, true]}' \\\r\n        http://localhost:8545\r\n{\"id\":1337,\"jsonrpc\":\"2.0\",\"result\":null}\r\n\r\n~ ❯ curl -H \"Content-Type: application/json\" -X POST --data \\\r\n        '{\"id\":1337,\"jsonrpc\":\"2.0\",\"method\":\"eth_getBlockByNumber\",\"params\":[\"0x1\", true]}' \\\r\n        http://localhost:8545\r\n{\"id\":1337,\"jsonrpc\":\"2.0\",\"result\":null}\r\n```\r\n\r\n`npx hardhat node`\r\n```\r\n~ ❯ curl -H \"Content-Type: application/json\" -X POST --data \\\r\n        '{\"id\":1337,\"jsonrpc\":\"2.0\",\"method\":\"eth_getBlockByNumber\",\"params\":[1, true]}' \\\r\n        http://localhost:8545\r\n{\"jsonrpc\":\"2.0\",\"id\":1337,\"error\":{\"code\":-32602,\"message\":\"Errors encountered in param 0: Invalid value 1 supplied to : (QUANTITY | \\\"earliest\\\" | \\\"latest\\\" | \\\"pending\\\")/0: QUANTITY, Invalid value 1 supplied to : (QUANTITY | \\\"earliest\\\" | \\\"latest\\\" | \\\"pending\\\")/1: \\\"earliest\\\" | \\\"latest\\\" | \\\"pending\\\"\"}}\r\n\r\n~ ❯ curl -H \"Content-Type: application/json\" -X POST --data \\\r\n        '{\"id\":1337,\"jsonrpc\":\"2.0\",\"method\":\"eth_getBlockByNumber\",\"params\":[\"0x1\", true]}' \\\r\n        http://localhost:8545\r\n{\"jsonrpc\":\"2.0\",\"id\":1337,\"result\":null}%\r\n```\r\n\r\n`geth --dev --http`\r\n```\r\n~ ❯ curl -H \"Content-Type: application/json\" -X POST --data \\\r\n        '{\"id\":1337,\"jsonrpc\":\"2.0\",\"method\":\"eth_getBlockByNumber\",\"params\":[1, true]}' \\\r\n        http://localhost:8545\r\n{\"jsonrpc\":\"2.0\",\"id\":1337,\"error\":{\"code\":-32602,\"message\":\"invalid argument 0: hex string without 0x prefix\"}}\r\n\r\n~ ❯ curl -H \"Content-Type: application/json\" -X POST --data \\\r\n        '{\"id\":1337,\"jsonrpc\":\"2.0\",\"method\":\"eth_getBlockByNumber\",\"params\":[\"0x1\", true]}' \\\r\n        http://localhost:8545\r\n{\"jsonrpc\":\"2.0\",\"id\":1337,\"result\":null}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/888505254/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/888509186",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1732#issuecomment-888509186",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1732",
    "id": 888509186,
    "node_id": "IC_kwDOB7jojM409ZMC",
    "user": {
      "login": "wolflo",
      "id": 33909953,
      "node_id": "MDQ6VXNlcjMzOTA5OTUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/33909953?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wolflo",
      "html_url": "https://github.com/wolflo",
      "followers_url": "https://api.github.com/users/wolflo/followers",
      "following_url": "https://api.github.com/users/wolflo/following{/other_user}",
      "gists_url": "https://api.github.com/users/wolflo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wolflo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wolflo/subscriptions",
      "organizations_url": "https://api.github.com/users/wolflo/orgs",
      "repos_url": "https://api.github.com/users/wolflo/repos",
      "events_url": "https://api.github.com/users/wolflo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wolflo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-28T18:00:13Z",
    "updated_at": "2021-07-28T18:00:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "My thought would be that matching geth for non-test methods is important to prevent divergence between an action's behavior against hardhat vs. mainnet. This also has the benefit of not requiring changes.\r\n\r\nFor methods that don't exist on mainnet (e.g. `evm_increaseTime`), being more permissive probably isn't bad. It seems to make sense to _either_ keep the same criteria for integer arguments as mainnet methods (meaning accept hex-encoded and reject decimal-encoded) _or_ be more permissive (accepting both). Since the first option would probably be a breaking change, allowing hex-encoded parameters in addition to the currently accepted decimal-encoded parameters seems to make the most sense.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/888509186/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/888584557",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1732#issuecomment-888584557",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1732",
    "id": 888584557,
    "node_id": "IC_kwDOB7jojM409rlt",
    "user": {
      "login": "alcuadrado",
      "id": 176499,
      "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alcuadrado",
      "html_url": "https://github.com/alcuadrado",
      "followers_url": "https://api.github.com/users/alcuadrado/followers",
      "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
      "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
      "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
      "repos_url": "https://api.github.com/users/alcuadrado/repos",
      "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-28T20:03:34Z",
    "updated_at": "2021-07-28T20:03:34Z",
    "author_association": "MEMBER",
    "body": "> My thought would be that matching geth for non-test methods is important to prevent divergence between an action's behavior against hardhat vs. mainnet. This also has the benefit of not requiring changes.\r\n\r\nExactly\r\n\r\n> I think it makes sense to be more permissive and accept hex-encoded arguments in these methods. But we can't change the output of the methods since that would be a breaking change.\r\n\r\nAgreed\r\n\r\n> For methods that don't exist on mainnet (e.g. `evm_increaseTime`), being more permissive probably isn't bad. It seems to make sense to _either_ keep the same criteria for integer arguments as mainnet methods (meaning accept hex-encoded and reject decimal-encoded) _or_ be more permissive (accepting both). Since the first option would probably be a breaking change, allowing hex-encoded parameters in addition to the currently accepted decimal-encoded parameters seems to make the most sense.\r\n\r\nI agree with this. the `evm` module has always felt weird, and we've had this discussion before. I believe at the time ganache didn't accept hex values, or we incorrectly assumed that.\r\n\r\nWe should accept numbers or hex values in the evm module. But for now, I'd keep the `hardhat` module as strict as it is now.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/888584557/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/979929051",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1732#issuecomment-979929051",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1732",
    "id": 979929051,
    "node_id": "IC_kwDOB7jojM46aIfb",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-26T12:03:53Z",
    "updated_at": "2021-11-26T12:03:53Z",
    "author_association": "MEMBER",
    "body": "Closed by #1735.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/979929051/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
