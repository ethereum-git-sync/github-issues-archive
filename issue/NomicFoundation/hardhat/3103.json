{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3103",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3103/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3103/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3103/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/3103",
  "id": 1355890238,
  "node_id": "I_kwDOB7jojM5Q0T4-",
  "number": 3103,
  "title": "No proper error message when encoding/decoding struct(tuple) with invalid enum ",
  "user": {
    "login": "ethereumdegen",
    "id": 6249263,
    "node_id": "MDQ6VXNlcjYyNDkyNjM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6249263?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ethereumdegen",
    "html_url": "https://github.com/ethereumdegen",
    "followers_url": "https://api.github.com/users/ethereumdegen/followers",
    "following_url": "https://api.github.com/users/ethereumdegen/following{/other_user}",
    "gists_url": "https://api.github.com/users/ethereumdegen/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ethereumdegen/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ethereumdegen/subscriptions",
    "organizations_url": "https://api.github.com/users/ethereumdegen/orgs",
    "repos_url": "https://api.github.com/users/ethereumdegen/repos",
    "events_url": "https://api.github.com/users/ethereumdegen/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ethereumdegen/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-08-30T14:48:47Z",
  "updated_at": "2023-03-29T00:15:47Z",
  "closed_at": "2022-12-28T06:56:11Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "<!--\r\n\r\nThank you for using Hardhat and taking the time to open an issue!\r\n\r\n**Note that this issue tracker is not a support channel.**\r\n\r\n- For help with Hardhat and Hardhat network, please use our [Discord server](https://hardhat.org/discord).\r\n- For help with ethers.js, please go to [its Github Discussions](https://github.com/ethers-io/ethers.js/discussions).\r\n\r\nIf you are reporting a bug, please include reproduction steps. The best way to do this is to include a [Minimal Reproducible Example](https://stackoverflow.com/help/minimal-reproducible-example). If you can't do that, then include a link to your repo, and the steps to reproduce the problem. The easiest it is to reproduce your problem, the faster we are going to be able to fix it.\r\n\r\nIf you are submitting a feature request, please take the time to clearly describe your use case, and not only your proposed solution.\r\n\r\nThis issue will be automatically assigned to a Hardhat team member. This person will act as the point of contact between you and the team, but won't necessarily fix it nor address it in any way. An issue being assigned does not mean that it's being worked on.\r\n\r\n-->\r\n\r\n If you pass an enum uint in a struct into a method in solidity and the uint is larger than the enum could possibly be (invalid enum input) then when you encode/decode that struct execution will revert and hardhat+ethers will not tell you why!\r\n\r\n\r\n\r\nHOW TO REPLICATE:  \r\n\r\nCreate an enum\r\n MyEnum {\r\nSTATE_ZERO, STATE_ONE\r\n}\r\n\r\nCreate a struct with that enum \r\nMyStruct{\r\nMyEnum enum;\r\n}\r\n\r\nCreate a method that inputs that struct \r\n function foo(MStruct memory s) public {} \r\n\r\nDevise an invalid value tuple for the struct such as  [  ( 3 )  ]  where you are passing in the enum with an invalid number like 3   (valids are only 0 and 1 of course) \r\n\r\nNow if you pass in that invalid instance of that tuple to the method foo while it is configured as 'memory', it will revert but hardhat will NOT tell you the reason for the error ! it SHOULD tell you the reason like... 'malformed tuple' or cannot 'deserialize enum' .   \r\n\r\nEven worse yet if you pass in an instance of that tuple to the method foo with it being 'calldata', it will NOT error until a point in your execution where the calldata tuple is serialized and deserialized such as being converted to memory.  When the execution environment (at runtime) tries to deserialize the data to memory it will fail as it cannot cast the number '3' to that enum since the only valid values for the enum are 0 or 1.  \r\n\r\nI lost 16 hours of my life on this lack of an error message.   \r\n",
  "closed_by": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3103/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3103/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1231775392",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3103#issuecomment-1231775392",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3103",
    "id": 1231775392,
    "node_id": "IC_kwDOB7jojM5Ja2ag",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-08-30T14:49:10Z",
    "updated_at": "2022-08-30T14:49:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue is also being [tracked on Linear](https://linear.app/nomic-foundation/issue/HH-1113/no-proper-error-message-when-encodingdecoding-structtuple-with-invalid).\n\nWe use Linear to manage our development process, but we keep the conversations on Github.\n\nLINEAR-ID: a4f354a8-4c58-4845-af06-0c2d3db5ca66",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1231775392/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1265530336",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3103#issuecomment-1265530336",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3103",
    "id": 1265530336,
    "node_id": "IC_kwDOB7jojM5LbnXg",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-03T14:28:11Z",
    "updated_at": "2022-10-03T14:28:11Z",
    "author_association": "MEMBER",
    "body": "Hi @apexmfer, thanks for reporting this and sorry for not responding before.\r\n\r\nFor the record, I get this message:\r\n\r\n> Error: Transaction reverted: function was called with incorrect parameters\r\n\r\nWhich is not ideal, but it points to the line number of the signature. Were you getting something worse than that?\r\n\r\nNote for ourselves:\r\n\r\nI wonder why this doesn't cause the correct panic code (`0x21 (Tried to convert a value into an enum, but the value was too big or negative)`). Maybe we are ignoring the panic code when we shouldn't? If not, this might be a thing that solc could improve. In both cases, it's worth looking into it.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1265530336/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1366414642",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3103#issuecomment-1366414642",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3103",
    "id": 1366414642,
    "node_id": "IC_kwDOB7jojM5RcdUy",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-28T06:56:11Z",
    "updated_at": "2022-12-28T06:56:29Z",
    "author_association": "MEMBER",
    "body": "Closing in favor of https://github.com/ethereum/solidity/issues/13832.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1366414642/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
