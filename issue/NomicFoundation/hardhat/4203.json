{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4203",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4203/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4203/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4203/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/4203",
  "id": 1824178181,
  "node_id": "I_kwDOB7jojM5susAF",
  "number": 4203,
  "title": "Functions that use assembly create/create2 and return the address don't get the right return type",
  "user": {
    "login": "ndavd",
    "id": 74260683,
    "node_id": "MDQ6VXNlcjc0MjYwNjgz",
    "avatar_url": "https://avatars.githubusercontent.com/u/74260683?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ndavd",
    "html_url": "https://github.com/ndavd",
    "followers_url": "https://api.github.com/users/ndavd/followers",
    "following_url": "https://api.github.com/users/ndavd/following{/other_user}",
    "gists_url": "https://api.github.com/users/ndavd/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ndavd/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ndavd/subscriptions",
    "organizations_url": "https://api.github.com/users/ndavd/orgs",
    "repos_url": "https://api.github.com/users/ndavd/repos",
    "events_url": "https://api.github.com/users/ndavd/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ndavd/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4937119027,
      "node_id": "LA_kwDOB7jojM8AAAABJkZ1Mw",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/status:triaging",
      "name": "status:triaging",
      "color": "0E8A16",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-07-27T11:31:02Z",
  "updated_at": "2023-10-31T00:13:09Z",
  "closed_at": "2023-08-01T13:25:14Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "In a basic setup of Hardhat, ethers and TypeChain if we deploy a contract and proceed to call a function in the tests it normally looks something like this:\r\n```ts\r\nimport { deployments } from 'hardhat';\r\nimport { MyContract } from '../typechain';\r\nawait deployments.fixture(['myContract']);\r\nconst myContract: MyContract = await ethers.getContract('MyContract');\r\nconst addr = myContract.foo()\r\n// Say foo returns some address, we will notice that the type of addr is string, as it should\r\n```\r\nBut if that function (say `foo()`) was to get that address from a create or create2 call in yul assembly (something like the `deploy` function from https://solidity-by-example.org/app/create2), then we'd see something like this instead:\r\n```ts\r\nconst addr = myContract.foo()\r\n// The type of addr is ContractTransactionResponse\r\n```\r\nAnd if we do `addr.wait()` and get a receipt we notice that `contractAddress` is null.\r\nHowever, if we do call `myContract.foo.staticCall()` instead, we then actually get back a string (the actual address).",
  "closed_by": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4203/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4203/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1653494679",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/4203#issuecomment-1653494679",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4203",
    "id": 1653494679,
    "node_id": "IC_kwDOB7jojM5ijlOX",
    "user": {
      "login": "ndavd",
      "id": 74260683,
      "node_id": "MDQ6VXNlcjc0MjYwNjgz",
      "avatar_url": "https://avatars.githubusercontent.com/u/74260683?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ndavd",
      "html_url": "https://github.com/ndavd",
      "followers_url": "https://api.github.com/users/ndavd/followers",
      "following_url": "https://api.github.com/users/ndavd/following{/other_user}",
      "gists_url": "https://api.github.com/users/ndavd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ndavd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ndavd/subscriptions",
      "organizations_url": "https://api.github.com/users/ndavd/orgs",
      "repos_url": "https://api.github.com/users/ndavd/repos",
      "events_url": "https://api.github.com/users/ndavd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ndavd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-07-27T12:13:27Z",
    "updated_at": "2023-07-27T12:13:27Z",
    "author_association": "NONE",
    "body": "Apparently related with https://ethereum.stackexchange.com/questions/66869/unable-to-fetch-output-from-a-public-function-in-solidity",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1653494679/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1660313864",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/4203#issuecomment-1660313864",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4203",
    "id": 1660313864,
    "node_id": "IC_kwDOB7jojM5i9mEI",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-01T13:25:14Z",
    "updated_at": "2023-08-01T13:25:14Z",
    "author_association": "MEMBER",
    "body": "Hi @ndavd, I think the answer to that question explains the situation correctly. The reason the type changed is because you changed a function from view to non-view. Happy to explain this further if you have questions, but for now I'm closing this issue because there isn't much we can do.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1660313864/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1660353425",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/4203#issuecomment-1660353425",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4203",
    "id": 1660353425,
    "node_id": "IC_kwDOB7jojM5i9vuR",
    "user": {
      "login": "ndavd",
      "id": 74260683,
      "node_id": "MDQ6VXNlcjc0MjYwNjgz",
      "avatar_url": "https://avatars.githubusercontent.com/u/74260683?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ndavd",
      "html_url": "https://github.com/ndavd",
      "followers_url": "https://api.github.com/users/ndavd/followers",
      "following_url": "https://api.github.com/users/ndavd/following{/other_user}",
      "gists_url": "https://api.github.com/users/ndavd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ndavd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ndavd/subscriptions",
      "organizations_url": "https://api.github.com/users/ndavd/orgs",
      "repos_url": "https://api.github.com/users/ndavd/repos",
      "events_url": "https://api.github.com/users/ndavd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ndavd/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-01T13:39:10Z",
    "updated_at": "2023-08-01T13:39:10Z",
    "author_association": "NONE",
    "body": "> Hi @ndavd, I think the answer to that question explains the situation correctly. The reason the type changed is because you changed a function from view to non-view. Happy to explain this further if you have questions, but for now I'm closing this issue because there isn't much we can do.\n\nHi, thanks for the reply. Indeed. The reason I re-opened the issue was in hopes of knowing whether a hardhat native solution for this issue was in development. I am aware of hardhat-exposed which creates a copy of the original contracts with the private and internal functions as public so that we can use them in our tests but currently it doesn't seem to work with TypeChain https://github.com/dethcrypto/TypeChain/issues/691. It only seems natural to be able to test all kinds of functions without recurring to third party plugins.\n",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1660353425/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1660417065",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/4203#issuecomment-1660417065",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4203",
    "id": 1660417065,
    "node_id": "IC_kwDOB7jojM5i9_Qp",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-01T14:12:59Z",
    "updated_at": "2023-08-01T14:12:59Z",
    "author_association": "MEMBER",
    "body": "That's fair! I opened https://github.com/NomicFoundation/hardhat/issues/4223 to think about that.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1660417065/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
