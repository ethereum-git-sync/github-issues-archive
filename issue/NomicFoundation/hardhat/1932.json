{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1932",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1932/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1932/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1932/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/1932",
  "id": 1016678575,
  "node_id": "I_kwDOB7jojM48mUiv",
  "number": 1932,
  "title": "Can't send real mainnet tx to forked mainnet",
  "user": {
    "login": "dancju",
    "id": 3108734,
    "node_id": "MDQ6VXNlcjMxMDg3MzQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3108734?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dancju",
    "html_url": "https://github.com/dancju",
    "followers_url": "https://api.github.com/users/dancju/followers",
    "following_url": "https://api.github.com/users/dancju/following{/other_user}",
    "gists_url": "https://api.github.com/users/dancju/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dancju/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dancju/subscriptions",
    "organizations_url": "https://api.github.com/users/dancju/orgs",
    "repos_url": "https://api.github.com/users/dancju/repos",
    "events_url": "https://api.github.com/users/dancju/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dancju/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2021-10-05T18:57:24Z",
  "updated_at": "2022-11-18T16:00:38Z",
  "closed_at": "2021-10-06T12:56:21Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "I am trying to replicate the historical txs on a forked main-net.\r\n\r\nWhen I sent a real historical tx (with original signature) through `sendTransaction`, it reports that the chain-ids do not agree.\r\n\r\n```\r\nError: Incompatible EIP155-based V 37 and chain id 31337. See the Common parameter of the Transaction constructor to set the chain id.\r\n```\r\n\r\nIs there any way I can send a real main-net tx to a forked main-net?",
  "closed_by": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1932/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1932/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/934686057",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1932#issuecomment-934686057",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1932",
    "id": 934686057,
    "node_id": "IC_kwDOB7jojM43ti1p",
    "user": {
      "login": "alcuadrado",
      "id": 176499,
      "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alcuadrado",
      "html_url": "https://github.com/alcuadrado",
      "followers_url": "https://api.github.com/users/alcuadrado/followers",
      "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
      "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
      "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
      "repos_url": "https://api.github.com/users/alcuadrado/repos",
      "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-05T18:59:50Z",
    "updated_at": "2021-10-05T18:59:50Z",
    "author_association": "MEMBER",
    "body": "Are you using `eth_sendRawTransaction`?\r\n\r\nYou should set the `chainId` to `1`",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/934686057/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/934690827",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1932#issuecomment-934690827",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1932",
    "id": 934690827,
    "node_id": "IC_kwDOB7jojM43tkAL",
    "user": {
      "login": "dancju",
      "id": 3108734,
      "node_id": "MDQ6VXNlcjMxMDg3MzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3108734?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dancju",
      "html_url": "https://github.com/dancju",
      "followers_url": "https://api.github.com/users/dancju/followers",
      "following_url": "https://api.github.com/users/dancju/following{/other_user}",
      "gists_url": "https://api.github.com/users/dancju/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dancju/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dancju/subscriptions",
      "organizations_url": "https://api.github.com/users/dancju/orgs",
      "repos_url": "https://api.github.com/users/dancju/repos",
      "events_url": "https://api.github.com/users/dancju/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dancju/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-05T19:05:11Z",
    "updated_at": "2021-10-05T19:05:11Z",
    "author_association": "NONE",
    "body": "> Are you using `eth_sendRawTransaction`?\r\n> \r\n> You should set the `chainId` to `1`\r\n\r\nI am using `waffle.provider.sendTransaction`.\r\nYes, I am trying to set the `chainId`. Can I set it in code instead of in the config file?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/934690827/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/934789372",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1932#issuecomment-934789372",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1932",
    "id": 934789372,
    "node_id": "IC_kwDOB7jojM43t8D8",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-05T20:34:09Z",
    "updated_at": "2021-10-05T20:34:09Z",
    "author_association": "MEMBER",
    "body": "> Can I set it in code instead of in the config file?\r\n\r\nTo prevent the EIP-155 check from failing, you need to set it in the config. Since you are re-playing transactions (or at least that's what I understood), those txs might include a `chainId` of 1, which is then \"compared\" to the one in the network.\r\n\r\nThe alternative would be to re-play the txs with a chain id of 31337, but that's probably not what you want.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/934789372/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/934817214",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1932#issuecomment-934817214",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1932",
    "id": 934817214,
    "node_id": "IC_kwDOB7jojM43uC2-",
    "user": {
      "login": "dancju",
      "id": 3108734,
      "node_id": "MDQ6VXNlcjMxMDg3MzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3108734?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dancju",
      "html_url": "https://github.com/dancju",
      "followers_url": "https://api.github.com/users/dancju/followers",
      "following_url": "https://api.github.com/users/dancju/following{/other_user}",
      "gists_url": "https://api.github.com/users/dancju/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dancju/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dancju/subscriptions",
      "organizations_url": "https://api.github.com/users/dancju/orgs",
      "repos_url": "https://api.github.com/users/dancju/repos",
      "events_url": "https://api.github.com/users/dancju/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dancju/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-05T20:53:24Z",
    "updated_at": "2021-10-05T21:43:20Z",
    "author_association": "NONE",
    "body": "> To prevent the EIP-155 check from failing, you need to set it in the config. Since you are re-playing transactions (or at least that's what I understood), those txs might include a `chainId` of 1, which is then \"compared\" to the one in the network.\r\n> \r\n> The alternative would be to re-play the txs with a chain id of 31337, but that's probably not what you want.\r\n\r\nThank you for replying! Yes changing the `chainId` of the chain would be better. If we change the `chainId` of the tx, the original signature would be invalid, then we'll have to use `hardhat_impersonateAccount`.\r\n\r\nMay I ask another question here? I successfully re-playing 100-ish txs. There was one tx just can't be replayed.\r\n\r\n```\r\n{\r\n  to: '0x169332Ae7D143E4B5c6baEdb2FEF77BFBdDB4011',\r\n  from: '0xC6C36027878Ba38964E4D5A60Ddb20D09565354E',\r\n  contractAddress: null,\r\n  transactionIndex: 1,\r\n  gasUsed: BigNumber { _hex: '0xe644', _isBigNumber: true },\r\n  logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000100000000000000000000000000000000000000000010000000000000000000000000200400000000000000000000000000000000000000000000000000000000000000000000000000000000000',\r\n  blockHash: '0xe1c353752c83ffc7779ecdd8569cd06a590a6ef4ced99c41d0279a5b00a6bf69',\r\n  transactionHash: '0x3a3edc9554047b344079bc292d781fdea7b331d43549de86e1032d10bc00eabc',\r\n  logs: [\r\n    {\r\n      transactionIndex: 1,\r\n      blockNumber: 12038871,\r\n      transactionHash: '0x3a3edc9554047b344079bc292d781fdea7b331d43549de86e1032d10bc00eabc',\r\n      address: '0x169332Ae7D143E4B5c6baEdb2FEF77BFBdDB4011',\r\n      topics: [Array],\r\n      data: '0x000000000000000000000000000000000000000000000000000000000000000f0000000000000000000000000000000000000000000000000000000000000017',\r\n      logIndex: 0,\r\n      blockHash: '0xe1c353752c83ffc7779ecdd8569cd06a590a6ef4ced99c41d0279a5b00a6bf69'\r\n    }\r\n  ],\r\n  blockNumber: 12038871,\r\n  confirmations: 1322384,\r\n  cumulativeGasUsed: BigNumber { _hex: '0x027838', _isBigNumber: true },\r\n  effectiveGasPrice: BigNumber { _hex: '0x482d709c00', _isBigNumber: true },\r\n  status: 1,\r\n  type: 0,\r\n  byzantium: true\r\n}\r\n```\r\n\r\nHere is the error msg.\r\n\r\n```\r\nTransactionExecutionError: Transaction ran out of gas\r\n    at HardhatNode._manageErrors (/home/dan/git/tmp/node_modules/hardhat/src/internal/hardhat-network/provider/node.ts:1738:14)\r\n    at HardhatNode._gatherTraces (/home/dan/git/tmp/node_modules/hardhat/src/internal/hardhat-network/provider/node.ts:1468:30)\r\n    at async HardhatNode._mineBlockWithPendingTxs (/home/dan/git/tmp/node_modules/hardhat/src/internal/hardhat-network/provider/node.ts:1582:23)\r\n    at async HardhatNode.mineBlock (/home/dan/git/tmp/node_modules/hardhat/src/internal/hardhat-network/provider/node.ts:435:16)\r\n    at async EthModule._sendTransactionAndReturnHash (/home/dan/git/tmp/node_modules/hardhat/src/internal/hardhat-network/provider/modules/eth.ts:1494:18)\r\n    at async HardhatNetworkProvider.request (/home/dan/git/tmp/node_modules/hardhat/src/internal/hardhat-network/provider/provider.ts:108:18)\r\n    at async EthersProviderWrapper.send (/home/dan/git/tmp/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:20)\r\nerror Command failed with exit code 1.\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/934817214/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/936186313",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1932#issuecomment-936186313",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1932",
    "id": 936186313,
    "node_id": "IC_kwDOB7jojM43zRHJ",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-06T12:56:21Z",
    "updated_at": "2021-10-06T12:56:21Z",
    "author_association": "MEMBER",
    "body": "Hard to know. Replaying transactions is very tricky. It might mean that the transaction did something different because of some condition (maybe the timestamp of the block you are running is different, or something else). Also, that seems to be a pre-London block, so make sure you are using the right hardfork.\r\n\r\nI think we can close this issue, can't we? Feel free to use [our Discord server](https://hardhat.org/discord) if you have more questions.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/936186313/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/936830899",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1932#issuecomment-936830899",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1932",
    "id": 936830899,
    "node_id": "IC_kwDOB7jojM431uez",
    "user": {
      "login": "dancju",
      "id": 3108734,
      "node_id": "MDQ6VXNlcjMxMDg3MzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3108734?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dancju",
      "html_url": "https://github.com/dancju",
      "followers_url": "https://api.github.com/users/dancju/followers",
      "following_url": "https://api.github.com/users/dancju/following{/other_user}",
      "gists_url": "https://api.github.com/users/dancju/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dancju/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dancju/subscriptions",
      "organizations_url": "https://api.github.com/users/dancju/orgs",
      "repos_url": "https://api.github.com/users/dancju/repos",
      "events_url": "https://api.github.com/users/dancju/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dancju/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-06T18:15:31Z",
    "updated_at": "2021-10-06T18:15:31Z",
    "author_association": "NONE",
    "body": "@fvictorio Thank you for your reply!",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/936830899/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
