{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1870",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1870/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1870/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1870/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/1870",
  "id": 991903291,
  "node_id": "MDU6SXNzdWU5OTE5MDMyOTE=",
  "number": 1870,
  "title": "Issues with using --network localhost",
  "user": {
    "login": "zendevil",
    "id": 30054030,
    "node_id": "MDQ6VXNlcjMwMDU0MDMw",
    "avatar_url": "https://avatars.githubusercontent.com/u/30054030?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/zendevil",
    "html_url": "https://github.com/zendevil",
    "followers_url": "https://api.github.com/users/zendevil/followers",
    "following_url": "https://api.github.com/users/zendevil/following{/other_user}",
    "gists_url": "https://api.github.com/users/zendevil/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/zendevil/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/zendevil/subscriptions",
    "organizations_url": "https://api.github.com/users/zendevil/orgs",
    "repos_url": "https://api.github.com/users/zendevil/repos",
    "events_url": "https://api.github.com/users/zendevil/events{/privacy}",
    "received_events_url": "https://api.github.com/users/zendevil/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-09-09T07:38:26Z",
  "updated_at": "2022-11-18T16:00:46Z",
  "closed_at": "2021-09-10T13:07:38Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "There are a few issues when I use --network localhost with npx hardhat test:\r\n\r\n1. console.log doesn't show.\r\nI have imported hardhat/console.log and use it like so:\r\n```\r\n    function totalAmountRaised() public view returns (uint) {\r\n        uint totalRaised = 0;\r\n        for (uint i = 0; i < initialStakesList.length; i++) {\r\n            totalRaised += initialStakes[initialStakesList[i]];\r\n            console.log(\"stake of %s: %s\", \r\n                        initialStakesList[i], initialStakes[initialStakesList[i]]);\r\n        }\r\n        return totalRaised;\r\n    }\r\n```\r\n\r\nHere's the test:\r\n```\r\nconst YieldToken = artifacts.require(\"YieldToken\");\r\nconst { expect } = require(\"chai\");\r\nconst { ethers } = require(\"hardhat\");\r\n\r\ndescribe(\"YieldToken\", function () {\r\n    it(\"buying, giving up, minting and payouts with ethers\", \r\n        async function () {\r\n            const YieldToken = await ethers.getContractFactory(\"YieldToken\");\r\n            const yieldToken = await YieldToken.deploy(\"ipfs\", 1, 1, 1, 1, 1, 1, 1);\r\n            await yieldToken.deployed();\r\n\r\n            const signers = await ethers.getSigners();\r\n            yieldToken.connect(signers[1]).buyStake({value: 1000});\r\n            yieldToken.connect(signers[2]).buyStake({value: 2000});\r\n            yieldToken.connect(signers[3]).buyStake({value: 3000});\r\n            yieldToken.connect(signers[4]).buyStake({value: 4000});\r\n            yieldToken.connect(signers[5]).buyStake({value: 5000});\r\n            yieldToken.connect(signers[6]).buyStake({value: 6000});\r\n                 \r\n\r\n\r\n            raised = await yieldToken.connect(signers[1]).totalAmountRaised();\r\n            expect(raised.toNumber()).to.equal(21000);\r\n\r\n        });\r\n});\r\n```\r\n\r\nbut I don't see anything logs from the totalAmountRaised call when using --network localhost, but do without it. \r\n\r\n2. The test doesn't pass when it should.\r\nWhen I use --network localhost, the test fails and gives this output:\r\n     ```\r\n       1) YieldToken\r\n       buying, giving up, minting and payouts with ethers:\r\n\r\n      AssertionError: expected 0 to equal 21000\r\n      + expected - actual\r\n\r\n      -0\r\n      +21000\r\n\r\n      at Context.<anonymous> (test/YieldToken.js:23:42)\r\n      at processTicksAndRejections (internal/process/task_queues.js:93:5)\r\n      ```\r\n      But it passes when --network localhost isn't used.\r\n\r\nFWIW all transactions show up in the hardhat node logs.",
  "closed_by": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1870/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1870/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/916584591",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1870#issuecomment-916584591",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1870",
    "id": 916584591,
    "node_id": "IC_kwDOB7jojM42ofiP",
    "user": {
      "login": "Kayaba-Attribution",
      "id": 63566185,
      "node_id": "MDQ6VXNlcjYzNTY2MTg1",
      "avatar_url": "https://avatars.githubusercontent.com/u/63566185?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Kayaba-Attribution",
      "html_url": "https://github.com/Kayaba-Attribution",
      "followers_url": "https://api.github.com/users/Kayaba-Attribution/followers",
      "following_url": "https://api.github.com/users/Kayaba-Attribution/following{/other_user}",
      "gists_url": "https://api.github.com/users/Kayaba-Attribution/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Kayaba-Attribution/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Kayaba-Attribution/subscriptions",
      "organizations_url": "https://api.github.com/users/Kayaba-Attribution/orgs",
      "repos_url": "https://api.github.com/users/Kayaba-Attribution/repos",
      "events_url": "https://api.github.com/users/Kayaba-Attribution/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Kayaba-Attribution/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-10T02:33:58Z",
    "updated_at": "2021-09-10T02:33:58Z",
    "author_association": "NONE",
    "body": "Perhaps you need to await for the transactions when using .buystake() ?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/916584591/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/916890716",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1870#issuecomment-916890716",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1870",
    "id": 916890716,
    "node_id": "IC_kwDOB7jojM42pqRc",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-10T13:07:38Z",
    "updated_at": "2021-09-10T13:07:38Z",
    "author_association": "MEMBER",
    "body": "> 1. console.log doesn't show.\r\n\r\nThe logs will show up in the terminal where you are running the node, not in the one that is running the tests.\r\n\r\n> 2. The test doesn't pass when it should.\r\n\r\nAs @Kayaba-Attribution mentioned, that's probably because you are missing some `await`s.\r\n\r\nPlease use [our Discord server](https://hardhat.org/discord) if you have more questions, since the issue tracker is only for bug reports or feature requests.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/916890716/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
