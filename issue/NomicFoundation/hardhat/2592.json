{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/2592",
  "id": 1199732719,
  "node_id": "I_kwDOB7jojM5Hgnfv",
  "number": 2592,
  "title": "Unexpected revert when testing library functions with struct parameters",
  "user": {
    "login": "murderteeth",
    "id": 89237203,
    "node_id": "MDQ6VXNlcjg5MjM3MjAz",
    "avatar_url": "https://avatars.githubusercontent.com/u/89237203?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/murderteeth",
    "html_url": "https://github.com/murderteeth",
    "followers_url": "https://api.github.com/users/murderteeth/followers",
    "following_url": "https://api.github.com/users/murderteeth/following{/other_user}",
    "gists_url": "https://api.github.com/users/murderteeth/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/murderteeth/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/murderteeth/subscriptions",
    "organizations_url": "https://api.github.com/users/murderteeth/orgs",
    "repos_url": "https://api.github.com/users/murderteeth/repos",
    "events_url": "https://api.github.com/users/murderteeth/events{/privacy}",
    "received_events_url": "https://api.github.com/users/murderteeth/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": true,
  "assignee": {
    "login": "feuGeneA",
    "id": 7883777,
    "node_id": "MDQ6VXNlcjc4ODM3Nzc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7883777?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/feuGeneA",
    "html_url": "https://github.com/feuGeneA",
    "followers_url": "https://api.github.com/users/feuGeneA/followers",
    "following_url": "https://api.github.com/users/feuGeneA/following{/other_user}",
    "gists_url": "https://api.github.com/users/feuGeneA/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/feuGeneA/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/feuGeneA/subscriptions",
    "organizations_url": "https://api.github.com/users/feuGeneA/orgs",
    "repos_url": "https://api.github.com/users/feuGeneA/repos",
    "events_url": "https://api.github.com/users/feuGeneA/events{/privacy}",
    "received_events_url": "https://api.github.com/users/feuGeneA/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "feuGeneA",
      "id": 7883777,
      "node_id": "MDQ6VXNlcjc4ODM3Nzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7883777?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/feuGeneA",
      "html_url": "https://github.com/feuGeneA",
      "followers_url": "https://api.github.com/users/feuGeneA/followers",
      "following_url": "https://api.github.com/users/feuGeneA/following{/other_user}",
      "gists_url": "https://api.github.com/users/feuGeneA/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/feuGeneA/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/feuGeneA/subscriptions",
      "organizations_url": "https://api.github.com/users/feuGeneA/orgs",
      "repos_url": "https://api.github.com/users/feuGeneA/repos",
      "events_url": "https://api.github.com/users/feuGeneA/events{/privacy}",
      "received_events_url": "https://api.github.com/users/feuGeneA/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 13,
  "created_at": "2022-04-11T10:10:52Z",
  "updated_at": "2022-11-17T21:40:15Z",
  "closed_at": "2022-05-27T12:43:38Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "I have a solidity library containing a function that takes a struct as a parameter. I can call this function from a contract without a problem. But when I try testing this function directly I get an error. Further, if I copy the same function to a contract and test it, it works. Here's an example:\r\n\r\n### contracts/library/Example.sol\r\n```solidity\r\n//SPDX-License-Identifier: MIT\r\npragma solidity ^0.8.7;\r\n\r\nstruct AB {\r\n  uint8 a;\r\n  uint8 b;\r\n}\r\n\r\ncontract TheContract {\r\n  function add(AB memory ab) public pure returns(uint8) {\r\n    return ab.a + ab.b;\r\n  }\r\n}\r\n\r\nlibrary TheLibrary {\r\n  function add(AB memory ab) public pure returns(uint8) {\r\n    return ab.a + ab.b;\r\n  }\r\n}\r\n```\r\n\r\n### mocha tests\r\n```ts\r\nimport { expect } from 'chai'\r\nimport { smock } from '@defi-wonderland/smock'\r\nimport { TheContract__factory, TheLibrary__factory } from '../../typechain/library'\r\n\r\ndescribe.only('Calling with struct params', function () {\r\n  before(async function () {\r\n    this.theContract = await(await smock.mock<TheContract__factory>('contracts/library/Example.sol:TheContract')).deploy()\r\n    this.theLibrary = await(await smock.mock<TheLibrary__factory>('contracts/library/Example.sol:TheLibrary')).deploy()\r\n  })\r\n\r\n  it('add AB struct with the contract', async function () {\r\n    expect(await this.theContract.add([1, 1])).to.eq(2)\r\n  })\r\n\r\n  it('add AB struct with the library', async function () {\r\n    expect(await this.theLibrary.add([1, 1])).to.eq(2)\r\n  })\r\n})\r\n```\r\n\r\n### result\r\n```console\r\n  Calling with struct params\r\n    âœ” add AB struct with the contract (73ms)\r\n    1) add AB struct with the library\r\n\r\n\r\n  1 passing (5s)\r\n  1 failing\r\n\r\n  1) Calling with struct params\r\n       add AB struct with the library:\r\n     Error: Transaction reverted: library was called directly\r\n    at TheLibrary.<unknown> (contracts/library/Example.sol:15)\r\n    at HardhatNode._gatherTraces (node_modules/hardhat/src/internal/hardhat-network/provider/node.ts:1652:30)\r\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)\r\n    at runNextTicks (node:internal/process/task_queues:65:3)\r\n    at listOnTimeout (node:internal/timers:526:9)\r\n    at processTimers (node:internal/timers:500:7)\r\n    at async HardhatNode.runCall (node_modules/hardhat/src/internal/hardhat-network/provider/node.ts:615:20)\r\n    at async EthModule._callAction (node_modules/hardhat/src/internal/hardhat-network/provider/modules/eth.ts:353:9)\r\n\r\n```\r\n\r\nThe contract test passes, but the library test fails. I've tested many library functions without a problem in the past, so I believe the error `Transaction reverted: library was called directly` is a mislead per https://github.com/NomicFoundation/hardhat/issues/1873\r\n\r\n",
  "closed_by": {
    "login": "github-actions[bot]",
    "id": 41898282,
    "node_id": "MDM6Qm90NDE4OTgyODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/github-actions%5Bbot%5D",
    "html_url": "https://github.com/apps/github-actions",
    "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1094861832",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2592#issuecomment-1094861832",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592",
    "id": 1094861832,
    "node_id": "IC_kwDOB7jojM5BQkQI",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-04-11T10:11:20Z",
    "updated_at": "2022-04-11T10:11:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue is also being [tracked on Linear](https://linear.app/nomic-foundation/issue/HH-533/unexpected-revert-when-testing-library-functions-with-struct).\n\nWe use Linear to manage our development process, but we keep the conversations on Github.\n\nLINEAR-ID: 7f018aae-7ce0-4dee-9406-1d3db940ba1f",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1094861832/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1098736426",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2592#issuecomment-1098736426",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592",
    "id": 1098736426,
    "node_id": "IC_kwDOB7jojM5BfWMq",
    "user": {
      "login": "ClementWalter",
      "id": 18620296,
      "node_id": "MDQ6VXNlcjE4NjIwMjk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/18620296?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ClementWalter",
      "html_url": "https://github.com/ClementWalter",
      "followers_url": "https://api.github.com/users/ClementWalter/followers",
      "following_url": "https://api.github.com/users/ClementWalter/following{/other_user}",
      "gists_url": "https://api.github.com/users/ClementWalter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ClementWalter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ClementWalter/subscriptions",
      "organizations_url": "https://api.github.com/users/ClementWalter/orgs",
      "repos_url": "https://api.github.com/users/ClementWalter/repos",
      "events_url": "https://api.github.com/users/ClementWalter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ClementWalter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-14T05:55:32Z",
    "updated_at": "2022-04-14T05:55:32Z",
    "author_association": "NONE",
    "body": "same problem using solidity 0.8.12 and hardhat 2.8.0",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1098736426/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1101709827",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2592#issuecomment-1101709827",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592",
    "id": 1101709827,
    "node_id": "IC_kwDOB7jojM5BqsID",
    "user": {
      "login": "ClementWalter",
      "id": 18620296,
      "node_id": "MDQ6VXNlcjE4NjIwMjk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/18620296?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ClementWalter",
      "html_url": "https://github.com/ClementWalter",
      "followers_url": "https://api.github.com/users/ClementWalter/followers",
      "following_url": "https://api.github.com/users/ClementWalter/following{/other_user}",
      "gists_url": "https://api.github.com/users/ClementWalter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ClementWalter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ClementWalter/subscriptions",
      "organizations_url": "https://api.github.com/users/ClementWalter/orgs",
      "repos_url": "https://api.github.com/users/ClementWalter/repos",
      "events_url": "https://api.github.com/users/ClementWalter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ClementWalter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-18T19:54:16Z",
    "updated_at": "2022-04-18T19:54:16Z",
    "author_association": "NONE",
    "body": "Is there any news on this? @murderteeth did you have a workaround? this is becoming critical for me atm.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1101709827/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1101746132",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2592#issuecomment-1101746132",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592",
    "id": 1101746132,
    "node_id": "IC_kwDOB7jojM5Bq0_U",
    "user": {
      "login": "murderteeth",
      "id": 89237203,
      "node_id": "MDQ6VXNlcjg5MjM3MjAz",
      "avatar_url": "https://avatars.githubusercontent.com/u/89237203?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/murderteeth",
      "html_url": "https://github.com/murderteeth",
      "followers_url": "https://api.github.com/users/murderteeth/followers",
      "following_url": "https://api.github.com/users/murderteeth/following{/other_user}",
      "gists_url": "https://api.github.com/users/murderteeth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/murderteeth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/murderteeth/subscriptions",
      "organizations_url": "https://api.github.com/users/murderteeth/orgs",
      "repos_url": "https://api.github.com/users/murderteeth/repos",
      "events_url": "https://api.github.com/users/murderteeth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/murderteeth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-18T20:43:15Z",
    "updated_at": "2022-04-18T20:43:15Z",
    "author_association": "NONE",
    "body": "> Is there any news on this? @murderteeth did you have a workaround? this is becoming critical for me atm.\r\n\r\nIn my case, I use a wrapper function that \"destructures\" the struct's fields.. for example:\r\n\r\n```solidity\r\nlibrary TheLibrary {\r\n  function add(AB memory ab) public pure returns(uint8) {\r\n    return ab.a + ab.b;\r\n  }\r\n\r\n  function add_test_wrapper(uint8 a, uint8 b) public pure returns(uint8) {\r\n    return add(AB(a, b));\r\n  }\r\n}\r\n```\r\n\r\nThis is fine for me because my struct's don't have too many fields. If your struct has more than 16 though, you'll run out of stack.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1101746132/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1102518354",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2592#issuecomment-1102518354",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592",
    "id": 1102518354,
    "node_id": "IC_kwDOB7jojM5BtxhS",
    "user": {
      "login": "ClementWalter",
      "id": 18620296,
      "node_id": "MDQ6VXNlcjE4NjIwMjk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/18620296?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ClementWalter",
      "html_url": "https://github.com/ClementWalter",
      "followers_url": "https://api.github.com/users/ClementWalter/followers",
      "following_url": "https://api.github.com/users/ClementWalter/following{/other_user}",
      "gists_url": "https://api.github.com/users/ClementWalter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ClementWalter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ClementWalter/subscriptions",
      "organizations_url": "https://api.github.com/users/ClementWalter/orgs",
      "repos_url": "https://api.github.com/users/ClementWalter/repos",
      "events_url": "https://api.github.com/users/ClementWalter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ClementWalter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-19T11:15:29Z",
    "updated_at": "2022-04-19T11:15:29Z",
    "author_association": "NONE",
    "body": "ok thanks for sharing, I have quite a lot of these so I'm not going to make it this way; will try to spend some time investigating this this week hopefully",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1102518354/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1102666449",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2592#issuecomment-1102666449",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592",
    "id": 1102666449,
    "node_id": "IC_kwDOB7jojM5BuVrR",
    "user": {
      "login": "ClementWalter",
      "id": 18620296,
      "node_id": "MDQ6VXNlcjE4NjIwMjk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/18620296?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ClementWalter",
      "html_url": "https://github.com/ClementWalter",
      "followers_url": "https://api.github.com/users/ClementWalter/followers",
      "following_url": "https://api.github.com/users/ClementWalter/following{/other_user}",
      "gists_url": "https://api.github.com/users/ClementWalter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ClementWalter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ClementWalter/subscriptions",
      "organizations_url": "https://api.github.com/users/ClementWalter/orgs",
      "repos_url": "https://api.github.com/users/ClementWalter/repos",
      "events_url": "https://api.github.com/users/ClementWalter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ClementWalter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-19T13:36:33Z",
    "updated_at": "2022-04-19T13:36:33Z",
    "author_association": "NONE",
    "body": "actually I'm not sure that this is a hardhat issue; I asked the question on SO as well https://ethereum.stackexchange.com/questions/126507/can-a-library-have-a-public-function-using-struct-memory",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1102666449/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1102703764",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2592#issuecomment-1102703764",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592",
    "id": 1102703764,
    "node_id": "IC_kwDOB7jojM5BueyU",
    "user": {
      "login": "mudgen",
      "id": 49092,
      "node_id": "MDQ6VXNlcjQ5MDky",
      "avatar_url": "https://avatars.githubusercontent.com/u/49092?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mudgen",
      "html_url": "https://github.com/mudgen",
      "followers_url": "https://api.github.com/users/mudgen/followers",
      "following_url": "https://api.github.com/users/mudgen/following{/other_user}",
      "gists_url": "https://api.github.com/users/mudgen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mudgen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mudgen/subscriptions",
      "organizations_url": "https://api.github.com/users/mudgen/orgs",
      "repos_url": "https://api.github.com/users/mudgen/repos",
      "events_url": "https://api.github.com/users/mudgen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mudgen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-19T14:09:24Z",
    "updated_at": "2022-04-19T14:44:31Z",
    "author_association": "NONE",
    "body": "Solidity libraries are not designed to be called off-chain.  Smart contracts call library functions.  That's why you are getting this error: `Transaction reverted: library was called directly`",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1102703764/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1102875768",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2592#issuecomment-1102875768",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592",
    "id": 1102875768,
    "node_id": "IC_kwDOB7jojM5BvIx4",
    "user": {
      "login": "hroussille",
      "id": 7825509,
      "node_id": "MDQ6VXNlcjc4MjU1MDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7825509?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hroussille",
      "html_url": "https://github.com/hroussille",
      "followers_url": "https://api.github.com/users/hroussille/followers",
      "following_url": "https://api.github.com/users/hroussille/following{/other_user}",
      "gists_url": "https://api.github.com/users/hroussille/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hroussille/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hroussille/subscriptions",
      "organizations_url": "https://api.github.com/users/hroussille/orgs",
      "repos_url": "https://api.github.com/users/hroussille/repos",
      "events_url": "https://api.github.com/users/hroussille/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hroussille/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-19T16:53:53Z",
    "updated_at": "2022-04-19T16:53:53Z",
    "author_association": "NONE",
    "body": "> Solidity libraries are not designed to be called off-chain. Smart contracts call library functions. That's why you are getting this error: `Transaction reverted: library was called directly`\r\n\r\nThat partly contradicts the [documentation](https://solidity-fr.readthedocs.io/fr/latest/contracts.html?highlight=libraries#libraries) : \r\n\r\n>  Library functions can only be called directly (i.e. without the use of DELEGATECALL) if they do not modify the state (i.e. if they are view or pure functions), because libraries are assumed to be stateless.\r\n\r\nThis function is pure, and should be allowed to be called directly.\r\n\r\nAfter taking a look to the following library from @ClementWalter post on Ethereum Stack Exchange : \r\n\r\n```solidity\r\nlibrary TheLibrary {\r\n  function add(AB memory ab) public pure returns(uint8) {\r\n    return ab.a + ab.b;\r\n  }\r\n```\r\n\r\nIt seemed to me more like an error in the ABI encoding than anything else.\r\n\r\nThe compiler checks for the following signature in the generated bytecode : `0x70c40302` which is the first 4 bytes of `keccak256(\"add(AB)\")`. From Remix (using the generated ABI), the calldata contains the following signature : `0x2f563ac4` which is the first 4 bytes of `keccak256(\"add((uint8, uint8))\")`\r\n\r\nAnd indeed, if you were to craft the following message to call `add(AB)` with both member set to 1 : \r\n\r\n`0x70c4030200000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001`\r\n\r\nThe result is `0x0000000000000000000000000000000000000000000000000000000000000002` as expected.\r\n\r\nThe same doesn't happen with contracts where the generated byte code check for what  the ABI exposes, I submitted [an issue](https://github.com/ethereum/solidity/issues/12947) on the solidity repo.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1102875768/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1103015488",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2592#issuecomment-1103015488",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592",
    "id": 1103015488,
    "node_id": "IC_kwDOB7jojM5Bvq5A",
    "user": {
      "login": "murderteeth",
      "id": 89237203,
      "node_id": "MDQ6VXNlcjg5MjM3MjAz",
      "avatar_url": "https://avatars.githubusercontent.com/u/89237203?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/murderteeth",
      "html_url": "https://github.com/murderteeth",
      "followers_url": "https://api.github.com/users/murderteeth/followers",
      "following_url": "https://api.github.com/users/murderteeth/following{/other_user}",
      "gists_url": "https://api.github.com/users/murderteeth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/murderteeth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/murderteeth/subscriptions",
      "organizations_url": "https://api.github.com/users/murderteeth/orgs",
      "repos_url": "https://api.github.com/users/murderteeth/repos",
      "events_url": "https://api.github.com/users/murderteeth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/murderteeth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-19T19:30:45Z",
    "updated_at": "2022-04-19T19:30:45Z",
    "author_association": "NONE",
    "body": "> Solidity libraries are not designed to be called off-chain. Smart contracts call library functions. That's why you are getting this error: `Transaction reverted: library was called directly`\r\n\r\nSee https://github.com/NomicFoundation/hardhat/issues/1873",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1103015488/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1103022443",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2592#issuecomment-1103022443",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592",
    "id": 1103022443,
    "node_id": "IC_kwDOB7jojM5Bvslr",
    "user": {
      "login": "murderteeth",
      "id": 89237203,
      "node_id": "MDQ6VXNlcjg5MjM3MjAz",
      "avatar_url": "https://avatars.githubusercontent.com/u/89237203?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/murderteeth",
      "html_url": "https://github.com/murderteeth",
      "followers_url": "https://api.github.com/users/murderteeth/followers",
      "following_url": "https://api.github.com/users/murderteeth/following{/other_user}",
      "gists_url": "https://api.github.com/users/murderteeth/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/murderteeth/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/murderteeth/subscriptions",
      "organizations_url": "https://api.github.com/users/murderteeth/orgs",
      "repos_url": "https://api.github.com/users/murderteeth/repos",
      "events_url": "https://api.github.com/users/murderteeth/events{/privacy}",
      "received_events_url": "https://api.github.com/users/murderteeth/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-19T19:36:10Z",
    "updated_at": "2022-04-19T19:36:10Z",
    "author_association": "NONE",
    "body": "> > Solidity libraries are not designed to be called off-chain. Smart contracts call library functions. That's why you are getting this error: `Transaction reverted: library was called directly`\r\n> \r\n> That partly contradicts the [documentation](https://solidity-fr.readthedocs.io/fr/latest/contracts.html?highlight=libraries#libraries) :\r\n> \r\n> > Library functions can only be called directly (i.e. without the use of DELEGATECALL) if they do not modify the state (i.e. if they are view or pure functions), because libraries are assumed to be stateless.\r\n> \r\n> This function is pure, and should be allowed to be called directly.\r\n> \r\n> After taking a look to the following library from @ClementWalter post on Ethereum Stack Exchange :\r\n> \r\n> ```solidity\r\n> library TheLibrary {\r\n>   function add(AB memory ab) public pure returns(uint8) {\r\n>     return ab.a + ab.b;\r\n>   }\r\n> ```\r\n> \r\n> It seemed to me more like an error in the ABI encoding than anything else.\r\n> \r\n> The compiler checks for the following signature in the generated bytecode : `0x70c40302` which is the first 4 bytes of `keccak256(\"add(AB)\")`. From Remix (using the generated ABI), the calldata contains the following signature : `0x2f563ac4` which is the first 4 bytes of `keccak256(\"add((uint8, uint8))\")`\r\n> \r\n> And indeed, if you were to craft the following message to call `add(AB)` with both member set to 1 :\r\n> \r\n> `0x70c4030200000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001`\r\n> \r\n> The result is `0x0000000000000000000000000000000000000000000000000000000000000002` as expected.\r\n> \r\n> The same doesn't happen with contracts where the generated byte code check for what the ABI exposes, I submitted [an issue](https://github.com/ethereum/solidity/issues/12947) on the solidity repo.\r\n\r\nThat makes a lot of sense, thank you @hroussille !",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1103022443/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1132858522",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2592#issuecomment-1132858522",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592",
    "id": 1132858522,
    "node_id": "IC_kwDOB7jojM5Dhgya",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-05-20T12:43:32Z",
    "updated_at": "2022-05-20T12:43:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue was marked as stale because it didn't have any activity in the last 30 days. If you think it's still relevant, please leave a comment indicating so. Otherwise, it will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1132858522/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1139584006",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2592#issuecomment-1139584006",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592",
    "id": 1139584006,
    "node_id": "IC_kwDOB7jojM5D7KwG",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-05-27T12:43:38Z",
    "updated_at": "2022-05-27T12:43:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue was closed because it has been stalled for 7 days with no activity.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1139584006/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1191339743",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2592#issuecomment-1191339743",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2592",
    "id": 1191339743,
    "node_id": "IC_kwDOB7jojM5HAmbf",
    "user": {
      "login": "nicolasguasca1",
      "id": 33971632,
      "node_id": "MDQ6VXNlcjMzOTcxNjMy",
      "avatar_url": "https://avatars.githubusercontent.com/u/33971632?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nicolasguasca1",
      "html_url": "https://github.com/nicolasguasca1",
      "followers_url": "https://api.github.com/users/nicolasguasca1/followers",
      "following_url": "https://api.github.com/users/nicolasguasca1/following{/other_user}",
      "gists_url": "https://api.github.com/users/nicolasguasca1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nicolasguasca1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nicolasguasca1/subscriptions",
      "organizations_url": "https://api.github.com/users/nicolasguasca1/orgs",
      "repos_url": "https://api.github.com/users/nicolasguasca1/repos",
      "events_url": "https://api.github.com/users/nicolasguasca1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nicolasguasca1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-21T10:53:18Z",
    "updated_at": "2022-07-21T10:53:18Z",
    "author_association": "NONE",
    "body": "Hey! :) any updates on this?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1191339743/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
