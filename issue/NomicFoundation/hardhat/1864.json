{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1864",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1864/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1864/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1864/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/1864",
  "id": 990206784,
  "node_id": "MDU6SXNzdWU5OTAyMDY3ODQ=",
  "number": 1864,
  "title": "`test` task and pre-compile issue",
  "user": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 901960538,
      "node_id": "MDU6TGFiZWw5MDE5NjA1Mzg=",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/type:bug",
      "name": "type:bug",
      "color": "FBCA04",
      "default": false,
      "description": "Something isn't working"
    }
  ],
  "state": "closed",
  "locked": true,
  "assignee": {
    "login": "alcuadrado",
    "id": 176499,
    "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alcuadrado",
    "html_url": "https://github.com/alcuadrado",
    "followers_url": "https://api.github.com/users/alcuadrado/followers",
    "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
    "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
    "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
    "repos_url": "https://api.github.com/users/alcuadrado/repos",
    "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "alcuadrado",
      "id": 176499,
      "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alcuadrado",
      "html_url": "https://github.com/alcuadrado",
      "followers_url": "https://api.github.com/users/alcuadrado/followers",
      "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
      "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
      "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
      "repos_url": "https://api.github.com/users/alcuadrado/repos",
      "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2021-09-07T17:39:19Z",
  "updated_at": "2022-11-17T21:12:20Z",
  "closed_at": "2022-08-18T15:58:01Z",
  "author_association": "MEMBER",
  "active_lock_reason": "resolved",
  "body": "Reproduction steps:\r\n\r\n1. `git clone https://github.com/fvictorio/nexusmutual`\r\n2. Install dependencies and run tests twice.\r\n3. Notice that the error message is different the second time\r\n\r\nAnother way of doing this is running `hh clean && hh test` vs `hh clean && hh compile && hh test`\r\n\r\nThe reason might be related to this:\r\n\r\n```js\r\ntask('test', async (_, hre, runSuper) => {\r\n  hre.accounts = await hre.web3.eth.getAccounts();\r\n  const testFiles = _.testFiles.length ? _.testFiles : ['./test/index.js'];\r\n  await runSuper({ testFiles });\r\n});\r\n```",
  "closed_by": {
    "login": "feuGeneA",
    "id": 7883777,
    "node_id": "MDQ6VXNlcjc4ODM3Nzc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7883777?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/feuGeneA",
    "html_url": "https://github.com/feuGeneA",
    "followers_url": "https://api.github.com/users/feuGeneA/followers",
    "following_url": "https://api.github.com/users/feuGeneA/following{/other_user}",
    "gists_url": "https://api.github.com/users/feuGeneA/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/feuGeneA/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/feuGeneA/subscriptions",
    "organizations_url": "https://api.github.com/users/feuGeneA/orgs",
    "repos_url": "https://api.github.com/users/feuGeneA/repos",
    "events_url": "https://api.github.com/users/feuGeneA/events{/privacy}",
    "received_events_url": "https://api.github.com/users/feuGeneA/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1864/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1864/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/957020259",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1864#issuecomment-957020259",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1864",
    "id": 957020259,
    "node_id": "IC_kwDOB7jojM45Cvhj",
    "user": {
      "login": "sisco0",
      "id": 25695302,
      "node_id": "MDQ6VXNlcjI1Njk1MzAy",
      "avatar_url": "https://avatars.githubusercontent.com/u/25695302?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sisco0",
      "html_url": "https://github.com/sisco0",
      "followers_url": "https://api.github.com/users/sisco0/followers",
      "following_url": "https://api.github.com/users/sisco0/following{/other_user}",
      "gists_url": "https://api.github.com/users/sisco0/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sisco0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sisco0/subscriptions",
      "organizations_url": "https://api.github.com/users/sisco0/orgs",
      "repos_url": "https://api.github.com/users/sisco0/repos",
      "events_url": "https://api.github.com/users/sisco0/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sisco0/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-02T01:30:38Z",
    "updated_at": "2022-01-07T14:13:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "Output logs for the two tests runs are included next.\r\n\r\n# First run\r\n---\r\n  Nexus Mutual\r\n    UNIT TESTS\r\n      TokenController\r\n        removeEmptyReason\r\n          1) reverts when index is out of bounds\r\n\r\n\r\n  0 passing (357ms)\r\n  1 failing\r\n\r\n  1) Nexus Mutual\r\n       UNIT TESTS\r\n         TokenController\r\n           removeEmptyReason\r\n             reverts when index is out of bounds:\r\n     Error: Transaction reverted without a reason string\r\n      at <UnrecognizedContract>.<unknown> (0x5fc8d32690cc91d4c39d9d3abcbd16989f875707)\r\n      at TruffleContract.removeEmptyReason (node_modules/@nomiclabs/truffle-contract/lib/execute.js:169:26)\r\n      at Context.<anonymous> (test/unit/TokenController/removeEmptyReason.js:39:27)\r\n      at processTicksAndRejections (internal/process/task_queues.js:93:5)\r\n---\r\n# Second run\r\n---\r\n  Nexus Mutual\r\n    UNIT TESTS\r\n      TokenController\r\n        removeEmptyReason\r\n          1) reverts when index is out of bounds\r\n\r\n\r\n  0 passing (369ms)\r\n  1 failing\r\n\r\n  1) Nexus Mutual\r\n       UNIT TESTS\r\n         TokenController\r\n           removeEmptyReason\r\n             reverts when index is out of bounds:\r\n     Error: VM Exception while processing transaction: invalid opcode\r\n      at TokenController._removeEmptyReason (contracts/modules/token/TokenController.sol:658)\r\n      at TokenController.removeEmptyReason (contracts/modules/token/TokenController.sol:636)\r\n      at TruffleContract.removeEmptyReason (node_modules/@nomiclabs/truffle-contract/lib/execute.js:169:26)\r\n      at Context.<anonymous> (test/unit/TokenController/removeEmptyReason.js:39:27)\r\n      at processTicksAndRejections (internal/process/task_queues.js:93:5)",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/957020259/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/957443746",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1864#issuecomment-957443746",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1864",
    "id": 957443746,
    "node_id": "IC_kwDOB7jojM45EW6i",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-02T12:25:34Z",
    "updated_at": "2021-11-02T12:25:34Z",
    "author_association": "MEMBER",
    "body": "@sisco0 you've seem to have fixed something in the reproduction example, but the problem has to be in Hardhat: even if the test is wrong, the fact that the results are inconsistent (in one scenario de test case passes but in the other it doesn't) suggest that there might be a bug on Hardhat's side.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/957443746/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1006127854",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1864#issuecomment-1006127854",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1864",
    "id": 1006127854,
    "node_id": "IC_kwDOB7jojM47-Eru",
    "user": {
      "login": "alcuadrado",
      "id": 176499,
      "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alcuadrado",
      "html_url": "https://github.com/alcuadrado",
      "followers_url": "https://api.github.com/users/alcuadrado/followers",
      "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
      "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
      "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
      "repos_url": "https://api.github.com/users/alcuadrado/repos",
      "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-05T22:27:30Z",
    "updated_at": "2022-01-05T22:27:30Z",
    "author_association": "MEMBER",
    "body": "This error is the same one that I mentioned as (1) [here](https://github.com/nomiclabs/hardhat/issues/1996#issuecomment-1006110954), and I've already fixed it. I'll submit a PR tomorrow.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1006127854/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1199882084",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1864#issuecomment-1199882084",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1864",
    "id": 1199882084,
    "node_id": "IC_kwDOB7jojM5HhL9k",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-07-29T19:31:42Z",
    "updated_at": "2022-07-29T19:31:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue was marked as stale because it didn't have any activity in the last 30 days. If you think it's still relevant, please leave a comment indicating so. Otherwise, it will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1199882084/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1206793102",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1864#issuecomment-1206793102",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1864",
    "id": 1206793102,
    "node_id": "IC_kwDOB7jojM5H7jOO",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-08-05T19:32:08Z",
    "updated_at": "2022-08-05T19:32:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue was closed because it has been stalled for 7 days with no activity.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1206793102/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1219665603",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1864#issuecomment-1219665603",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1864",
    "id": 1219665603,
    "node_id": "IC_kwDOB7jojM5Isp7D",
    "user": {
      "login": "feuGeneA",
      "id": 7883777,
      "node_id": "MDQ6VXNlcjc4ODM3Nzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7883777?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/feuGeneA",
      "html_url": "https://github.com/feuGeneA",
      "followers_url": "https://api.github.com/users/feuGeneA/followers",
      "following_url": "https://api.github.com/users/feuGeneA/following{/other_user}",
      "gists_url": "https://api.github.com/users/feuGeneA/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/feuGeneA/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/feuGeneA/subscriptions",
      "organizations_url": "https://api.github.com/users/feuGeneA/orgs",
      "repos_url": "https://api.github.com/users/feuGeneA/repos",
      "events_url": "https://api.github.com/users/feuGeneA/events{/privacy}",
      "received_events_url": "https://api.github.com/users/feuGeneA/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-18T15:58:01Z",
    "updated_at": "2022-08-18T15:58:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "Fixed via #2218 ",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1219665603/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
