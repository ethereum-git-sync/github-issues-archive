{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1067",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1067/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1067/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1067/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/1067",
  "id": 752919629,
  "node_id": "MDU6SXNzdWU3NTI5MTk2Mjk=",
  "number": 1067,
  "title": "Request: HardHat network can emit specific blocks to subscribers",
  "user": {
    "login": "CodeForcer",
    "id": 31618931,
    "node_id": "MDQ6VXNlcjMxNjE4OTMx",
    "avatar_url": "https://avatars.githubusercontent.com/u/31618931?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/CodeForcer",
    "html_url": "https://github.com/CodeForcer",
    "followers_url": "https://api.github.com/users/CodeForcer/followers",
    "following_url": "https://api.github.com/users/CodeForcer/following{/other_user}",
    "gists_url": "https://api.github.com/users/CodeForcer/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/CodeForcer/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/CodeForcer/subscriptions",
    "organizations_url": "https://api.github.com/users/CodeForcer/orgs",
    "repos_url": "https://api.github.com/users/CodeForcer/repos",
    "events_url": "https://api.github.com/users/CodeForcer/events{/privacy}",
    "received_events_url": "https://api.github.com/users/CodeForcer/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 947232611,
      "node_id": "MDU6TGFiZWw5NDcyMzI2MTE=",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/type:feature",
      "name": "type:feature",
      "color": "FBCA04",
      "default": false,
      "description": "Feature request"
    }
  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-11-29T13:39:51Z",
  "updated_at": "2023-03-31T00:14:35Z",
  "closed_at": "2022-12-30T10:14:44Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "A typical setup for a production trading application is to subscribe to the blockchain with `eth_subscribe`, and process new blocks which are emitted, before deciding whether to make transactions.\r\n\r\nFor the purposes of back-testing DeFi applications, it would be extremely useful to be able to emit blocks to applications which are subscribed to your local HardHat network.\r\n\r\nI believe most of the architecture necessary for this feature is already completed thanks to the main-net forking feature of HardHat. However, currently it doesn't seem to emit blocks to subscribers when you fork from a specific block.\r\n\r\nThe ideal work-flow would be (potentially):\r\n\r\n1. Start HardHat locally:\r\n```\r\nnpx hardhat node --fork <archive node url>\r\n```\r\n2. Connect applications to HardHat using `eth_subscribe`\r\n3. Run a HardHat command for main-net forking at a block:\r\n```\r\ncurl -H \"Content-Type: application/json\" -X POST --data \\\r\n        '{\"id\":1337,\"jsonrpc\":\"2.0\",\"method\":\"hardhat_reset\",\"params\":[\"11297907\"]}' \\\r\n        http://localhost:8545\r\n```\r\n4. HardHat network emits the desired block to all subscribers\r\n\r\nThis feature would allow DeFi traders to seamlessly integrate production applications for backtesting alongside smart contracts written in HardHat.\r\n\r\nThank you for your excellent development toolkit!",
  "closed_by": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1067/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1067/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/747616100",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1067#issuecomment-747616100",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1067",
    "id": 747616100,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NzYxNjEwMA==",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-17T18:25:54Z",
    "updated_at": "2020-12-17T18:25:54Z",
    "author_association": "MEMBER",
    "body": "@CodeForcer if I understand this correctly, you want the hardhat network to emit a block that is already mined in the mainnet. If that's the case, I think a slightly different way of doing this would be this (assuming you want to mine block 100):\r\n\r\n1. Fork mainnet from block 99\r\n2. Call an rpc method that advances the fork one block\r\n\r\nWould that work for your use case?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/747616100/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/764989479",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1067#issuecomment-764989479",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1067",
    "id": 764989479,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2NDk4OTQ3OQ==",
    "user": {
      "login": "CodeForcer",
      "id": 31618931,
      "node_id": "MDQ6VXNlcjMxNjE4OTMx",
      "avatar_url": "https://avatars.githubusercontent.com/u/31618931?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CodeForcer",
      "html_url": "https://github.com/CodeForcer",
      "followers_url": "https://api.github.com/users/CodeForcer/followers",
      "following_url": "https://api.github.com/users/CodeForcer/following{/other_user}",
      "gists_url": "https://api.github.com/users/CodeForcer/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CodeForcer/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CodeForcer/subscriptions",
      "organizations_url": "https://api.github.com/users/CodeForcer/orgs",
      "repos_url": "https://api.github.com/users/CodeForcer/repos",
      "events_url": "https://api.github.com/users/CodeForcer/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CodeForcer/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-21T22:44:56Z",
    "updated_at": "2021-01-21T22:44:56Z",
    "author_association": "NONE",
    "body": "@fvictorio sorry about late reply, just saw this.\r\n\r\nThat would be great, but right now it suffers from the above issue that subscribers to the RPC method do not receive the new blocks. So you call the rpc method which advances the fork by a block, but nothing is actually emitted to the subscribers.\r\n\r\nWith this ability in HardHat, I would be able to deprecate Ganache entirely for local simulation and solely use HardHat.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/764989479/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1194308692",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1067#issuecomment-1194308692",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1067",
    "id": 1194308692,
    "node_id": "IC_kwDOB7jojM5HL7RU",
    "user": {
      "login": "0xDualCube",
      "id": 99014423,
      "node_id": "U_kgDOBebXFw",
      "avatar_url": "https://avatars.githubusercontent.com/u/99014423?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/0xDualCube",
      "html_url": "https://github.com/0xDualCube",
      "followers_url": "https://api.github.com/users/0xDualCube/followers",
      "following_url": "https://api.github.com/users/0xDualCube/following{/other_user}",
      "gists_url": "https://api.github.com/users/0xDualCube/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/0xDualCube/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0xDualCube/subscriptions",
      "organizations_url": "https://api.github.com/users/0xDualCube/orgs",
      "repos_url": "https://api.github.com/users/0xDualCube/repos",
      "events_url": "https://api.github.com/users/0xDualCube/events{/privacy}",
      "received_events_url": "https://api.github.com/users/0xDualCube/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-25T16:19:16Z",
    "updated_at": "2022-07-25T16:19:16Z",
    "author_association": "NONE",
    "body": "+1",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1194308692/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1367838839",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1067#issuecomment-1367838839",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1067",
    "id": 1367838839,
    "node_id": "IC_kwDOB7jojM5Rh5B3",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-30T10:14:44Z",
    "updated_at": "2022-12-30T10:14:44Z",
    "author_association": "MEMBER",
    "body": "Hi, I'm not sure what to do about this issue.\r\n\r\nAs far as I can tell, `eth_subscribe` does work. And the part about simulating a new block from the fork can be done with [this plugin](https://www.npmjs.com/package/hardhat-live-fork) (I haven't tried it though).\r\n\r\nI think I'm going to tentatively close this, but please let me know if we should have a follow-up issue for some aspect of this.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1367838839/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
