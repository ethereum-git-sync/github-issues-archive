{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3691",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3691/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3691/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3691/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/3691",
  "id": 1589866350,
  "node_id": "I_kwDOB7jojM5ew29u",
  "number": 3691,
  "title": "Missing last character in error message when trying to import `@hardhat/console.sol`",
  "user": {
    "login": "N-dcool",
    "id": 107427909,
    "node_id": "U_kgDOBmc4RQ",
    "avatar_url": "https://avatars.githubusercontent.com/u/107427909?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/N-dcool",
    "html_url": "https://github.com/N-dcool",
    "followers_url": "https://api.github.com/users/N-dcool/followers",
    "following_url": "https://api.github.com/users/N-dcool/following{/other_user}",
    "gists_url": "https://api.github.com/users/N-dcool/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/N-dcool/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/N-dcool/subscriptions",
    "organizations_url": "https://api.github.com/users/N-dcool/orgs",
    "repos_url": "https://api.github.com/users/N-dcool/repos",
    "events_url": "https://api.github.com/users/N-dcool/events{/privacy}",
    "received_events_url": "https://api.github.com/users/N-dcool/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 901960538,
      "node_id": "MDU6TGFiZWw5MDE5NjA1Mzg=",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/type:bug",
      "name": "type:bug",
      "color": "FBCA04",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 4937720577,
      "node_id": "LA_kwDOB7jojM8AAAABJk-jAQ",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/status:ready",
      "name": "status:ready",
      "color": "0E8A16",
      "default": false,
      "description": "This issue is ready to be worked on"
    },
    {
      "id": 5666138810,
      "node_id": "LA_kwDOB7jojM8AAAABUbpqug",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/area:compilation",
      "name": "area:compilation",
      "color": "5319E7",
      "default": false,
      "description": "Related to the built-in compile task"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2023-02-17T19:34:59Z",
  "updated_at": "2023-06-26T13:50:58Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Version of Hardhat\n\n2.12.7\n\n### What happened?\n\n when I compile a smart contract with an uninstalled npm dependency it errors out  \r\n\r\n ---> Error HH411: The library `library name with last character missing`, imported from `contract path`, is not installed. Try installing it using npm \r\n\r\n in terminal.\r\n\r\n<img width=\"1432\" alt=\"bugReport\" src=\"https://user-images.githubusercontent.com/107427909/219768770-61d5c59d-eb4b-42fc-a6e9-d7ffe83ae257.png\">\r\n\r\n## another example : \r\n<img width=\"964\" alt=\"bug2\" src=\"https://user-images.githubusercontent.com/107427909/219770112-3dd75af2-f28f-4ecd-adba-d1ee1a306410.png\">\r\n\r\n\r\n\n\n### Minimal reproduction steps\n\ntry with any uninstalled npm dependencies having `@` at the prefix\r\ncompile smart contract: `npx hardhat compile`\n\n### Search terms\n\n_No response_",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3691/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3691/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1435147586",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3691#issuecomment-1435147586",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3691",
    "id": 1435147586,
    "node_id": "IC_kwDOB7jojM5Vip1C",
    "user": {
      "login": "N-dcool",
      "id": 107427909,
      "node_id": "U_kgDOBmc4RQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/107427909?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/N-dcool",
      "html_url": "https://github.com/N-dcool",
      "followers_url": "https://api.github.com/users/N-dcool/followers",
      "following_url": "https://api.github.com/users/N-dcool/following{/other_user}",
      "gists_url": "https://api.github.com/users/N-dcool/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/N-dcool/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/N-dcool/subscriptions",
      "organizations_url": "https://api.github.com/users/N-dcool/orgs",
      "repos_url": "https://api.github.com/users/N-dcool/repos",
      "events_url": "https://api.github.com/users/N-dcool/events{/privacy}",
      "received_events_url": "https://api.github.com/users/N-dcool/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-17T19:40:43Z",
    "updated_at": "2023-02-17T19:40:43Z",
    "author_association": "NONE",
    "body": "I open pull request I think I got the solution #3692",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1435147586/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1438268125",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3691#issuecomment-1438268125",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3691",
    "id": 1438268125,
    "node_id": "IC_kwDOB7jojM5Vujrd",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-21T10:53:19Z",
    "updated_at": "2023-02-21T10:53:19Z",
    "author_association": "MEMBER",
    "body": "Thank you @N-dcool. Just to double-check, this is about the error message having that issue, right?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1438268125/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1438295601",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3691#issuecomment-1438295601",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3691",
    "id": 1438295601,
    "node_id": "IC_kwDOB7jojM5VuqYx",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-21T11:10:59Z",
    "updated_at": "2023-02-21T11:10:59Z",
    "author_association": "MEMBER",
    "body": "Ok, I looked into this a bit more. Some comments about this.\r\n\r\nFirst, I think this only happens if you are making a mistake in your imports. Hardhat uses node to resolve dependencies, and in node a package can be either something like `foo` or something like `@foo/bar`, but you can't have a package named `@foo`. That means that you can never import a contract doing `@foo/contract.sol`. In your example, you are doing `@hardhat/console.sol` instead of `hardhat/console.sol`.\r\n\r\nThat being said, we should show a better error message when a user makes that mistake. Plus, that assumption might break in a project that uses our `hardhat-foundry` plugin.\r\n\r\nI think the problem is in this line:\r\n\r\nhttps://github.com/NomicFoundation/hardhat/blob/68ea1ad47bdfdd0440390974b09ec544d7b58474/packages/hardhat-core/src/internal/solidity/resolver.ts#L405\r\n\r\nThis is basically saying \"if the import starts with `@`, then it will have two slashes\", which as I explained might not be the case.\r\n\r\nI'm not sure what's the right fix here. Maybe just check if the resulting index is `-1` before slicing, and use `sourceName.length` instead in that case. Feel free to send a PR fixing this, but this should probably include a new test.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1438295601/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1438329906",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3691#issuecomment-1438329906",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3691",
    "id": 1438329906,
    "node_id": "IC_kwDOB7jojM5Vuywy",
    "user": {
      "login": "N-dcool",
      "id": 107427909,
      "node_id": "U_kgDOBmc4RQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/107427909?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/N-dcool",
      "html_url": "https://github.com/N-dcool",
      "followers_url": "https://api.github.com/users/N-dcool/followers",
      "following_url": "https://api.github.com/users/N-dcool/following{/other_user}",
      "gists_url": "https://api.github.com/users/N-dcool/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/N-dcool/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/N-dcool/subscriptions",
      "organizations_url": "https://api.github.com/users/N-dcool/orgs",
      "repos_url": "https://api.github.com/users/N-dcool/repos",
      "events_url": "https://api.github.com/users/N-dcool/events{/privacy}",
      "received_events_url": "https://api.github.com/users/N-dcool/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-21T11:37:49Z",
    "updated_at": "2023-02-21T11:37:49Z",
    "author_association": "NONE",
    "body": "> Thank you @N-dcool. Just to double-check, this is about the error message having that issue, right?\r\n\r\nYes I thought it should fix issue.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1438329906/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1438334508",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3691#issuecomment-1438334508",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3691",
    "id": 1438334508,
    "node_id": "IC_kwDOB7jojM5Vuz4s",
    "user": {
      "login": "N-dcool",
      "id": 107427909,
      "node_id": "U_kgDOBmc4RQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/107427909?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/N-dcool",
      "html_url": "https://github.com/N-dcool",
      "followers_url": "https://api.github.com/users/N-dcool/followers",
      "following_url": "https://api.github.com/users/N-dcool/following{/other_user}",
      "gists_url": "https://api.github.com/users/N-dcool/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/N-dcool/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/N-dcool/subscriptions",
      "organizations_url": "https://api.github.com/users/N-dcool/orgs",
      "repos_url": "https://api.github.com/users/N-dcool/repos",
      "events_url": "https://api.github.com/users/N-dcool/events{/privacy}",
      "received_events_url": "https://api.github.com/users/N-dcool/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-21T11:41:39Z",
    "updated_at": "2023-02-21T11:41:39Z",
    "author_association": "NONE",
    "body": "> Ok, I looked into this a bit more. Some comments about this.\r\n> \r\n> First, I think this only happens if you are making a mistake in your imports. Hardhat uses node to resolve dependencies, and in node a package can be either something like `foo` or something like `@foo/bar`, but you can't have a package named `@foo`. That means that you can never import a contract doing `@foo/contract.sol`. In your example, you are doing `@hardhat/console.sol` instead of `hardhat/console.sol`.\r\n> \r\n> That being said, we should show a better error message when a user makes that mistake. Plus, that assumption might break in a project that uses our `hardhat-foundry` plugin.\r\n> \r\n> I think the problem is in this line:\r\n> \r\n> https://github.com/NomicFoundation/hardhat/blob/68ea1ad47bdfdd0440390974b09ec544d7b58474/packages/hardhat-core/src/internal/solidity/resolver.ts#L405\r\n> \r\n> This is basically saying \"if the import starts with `@`, then it will have two slashes\", which as I explained might not be the case.\r\n> \r\n> I'm not sure what's the right fix here. Maybe just check if the resulting index is `-1` before slicing, and use `sourceName.length` instead in that case. Feel free to send a PR fixing this, but this should probably include a new test.\r\n\r\nThanks for your time to explaining me it made me understand how it works, and got to know little more.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1438334508/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
