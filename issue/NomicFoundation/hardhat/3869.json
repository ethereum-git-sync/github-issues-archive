{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3869",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3869/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3869/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3869/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/3869",
  "id": 1674610945,
  "node_id": "I_kwDOB7jojM5j0IkB",
  "number": 3869,
  "title": "Update `ConfigurableTaskDefinition` to accept a generic type variable `TaskArgumentsT extends TaskArguments`",
  "user": {
    "login": "misicnenad",
    "id": 19427053,
    "node_id": "MDQ6VXNlcjE5NDI3MDUz",
    "avatar_url": "https://avatars.githubusercontent.com/u/19427053?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/misicnenad",
    "html_url": "https://github.com/misicnenad",
    "followers_url": "https://api.github.com/users/misicnenad/followers",
    "following_url": "https://api.github.com/users/misicnenad/following{/other_user}",
    "gists_url": "https://api.github.com/users/misicnenad/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/misicnenad/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/misicnenad/subscriptions",
    "organizations_url": "https://api.github.com/users/misicnenad/orgs",
    "repos_url": "https://api.github.com/users/misicnenad/repos",
    "events_url": "https://api.github.com/users/misicnenad/events{/privacy}",
    "received_events_url": "https://api.github.com/users/misicnenad/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4935639218,
      "node_id": "LA_kwDOB7jojM8AAAABJi_gsg",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/status:needs-decision",
      "name": "status:needs-decision",
      "color": "0E8A16",
      "default": false,
      "description": "We need to make a decision about this"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2023-04-19T10:18:19Z",
  "updated_at": "2023-10-10T18:43:26Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Describe the feature\r\n\r\nWhen writing tasks in TypeScript, it should be possible to pass a generic type to [ConfigurableTaskDefinition](https://github.com/NomicFoundation/hardhat/blob/b80801fcff958f94efaf8905e12ce2b6cdba76cd/packages/hardhat-core/src/types/runtime.ts#L43) that would look like `TaskArgumentsT extends TaskArguments`, similar to how it is done with [task](https://github.com/NomicFoundation/hardhat/blob/main/packages/hardhat-core/src/internal/core/config/config-env.ts#L22) and use this generic to automatically set required/optional parameter names, potentially even parameter type and allowed default values, as well as automatically set the correct `taskArguments` type in [setAction](https://github.com/NomicFoundation/hardhat/blob/b80801fcff958f94efaf8905e12ce2b6cdba76cd/packages/hardhat-core/src/types/runtime.ts#L46).\r\n\r\nThis would allow for much improved type safety when adding/working with parameters.\r\n\r\nFor example, given a task definition like:\r\n```ts\r\nimport { task, types } from \"hardhat/config\";\r\n\r\ntype CustomTaskArguments = { field1: string; field2: number };\r\n\r\ntask(\"taskName\", \"Will perform some task\")\r\n    .addParam(\"field1\", \"Field 1 description\", \"default value\", types.string)\r\n    .addParam(\"field3\", \"Field 2 description\", 1, types.int) // `field3` does not exist in `CustomTaskArguments`\r\n    .setAction(async (taskArguments: CustomTaskArguments, hre) => {\r\n      const field2 = taskArguments.field2; // value is always undefined, but no compiler error\r\n      ...\r\n    });\r\n```\r\n\r\nEven though `taskArguments` in `.setAction` has the correct type, we still need to make sure that parameter names in `.addParam` are typed correctly. In example above there is a `field3` parameter defined in the second `.addParam` even though it does not exist in `CustomTaskArguments`, but the compiler does not complain as it has no way of knowing that there's something wrong. One would have to find out the hard way why `field2` is undefined.\r\n\r\nBy having the option to set a generic task argument type when calling `task` and passing this generic to its return value `ConfigurableTaskDefinition` (see [`task` definition](https://github.com/NomicFoundation/hardhat/blob/main/packages/hardhat-core/src/internal/core/config/config-env.ts#L22)) and its appropriate functions, it would make it easier for the compiler to notice such things, as `addParam > name` would be typed as `keyof CustomTaskArguments`.\r\n\r\n```ts\r\nimport { task, types } from \"hardhat/config\";\r\n\r\ntype CustomTaskArguments = { field1: string; field2: number };\r\n\r\ntask<CustomTaskArguments>(\"taskName\", \"Will perform some task\")\r\n    .addParam(\"field1\", \"Field 1 description\", \"default value\", types.string)\r\n    .addParam(\"field3\", \"Field 2 description\", 1, types.int) // compiler error, `field3` does not exist in `CustomTaskArguments`!!!\r\n    .setAction(async (taskArguments, hre) => { // no need to explicitly set `taskArguments` type as it is `CustomTaskArguments` by default\r\n      const field2 = taskArguments.field2;\r\n      ...\r\n    });\r\n```\r\n\r\nP.S.\r\nIt would be awesome if it were possible to make sure that for every key defined in `CustomTaskArguments` there is a corresponding `.addParam` or `.addOptionalParam`, but not sure if that can be done in TypeScript.\r\n\r\n### Search terms\r\n\r\ntask type, task argument, task generic, task argument generic, argument type, param type, taskargument",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3869/reactions",
    "total_count": 1,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 1,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3869/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1523094643",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3869#issuecomment-1523094643",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3869",
    "id": 1523094643,
    "node_id": "IC_kwDOB7jojM5ayJRz",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-26T09:31:44Z",
    "updated_at": "2023-04-26T09:31:44Z",
    "author_association": "MEMBER",
    "body": "Interesting! Thanks for this @misicnenad.\r\n\r\n@alcuadrado: we've talked about this a couple of times and your opinion was that this wasn't doable in the general case, but maybe it's possible with this proposal?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1523094643/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1532673307",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3869#issuecomment-1532673307",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3869",
    "id": 1532673307,
    "node_id": "IC_kwDOB7jojM5bWr0b",
    "user": {
      "login": "misicnenad",
      "id": 19427053,
      "node_id": "MDQ6VXNlcjE5NDI3MDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/19427053?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/misicnenad",
      "html_url": "https://github.com/misicnenad",
      "followers_url": "https://api.github.com/users/misicnenad/followers",
      "following_url": "https://api.github.com/users/misicnenad/following{/other_user}",
      "gists_url": "https://api.github.com/users/misicnenad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/misicnenad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/misicnenad/subscriptions",
      "organizations_url": "https://api.github.com/users/misicnenad/orgs",
      "repos_url": "https://api.github.com/users/misicnenad/repos",
      "events_url": "https://api.github.com/users/misicnenad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/misicnenad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-03T08:58:20Z",
    "updated_at": "2023-05-04T08:02:01Z",
    "author_association": "NONE",
    "body": "@fvictorio if by chance I find some time in the near future, I could give this a shot and create a PR.\r\nIs this OK or would it be better to wait for some further input/discussion by the team?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1532673307/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1731542040",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3869#issuecomment-1731542040",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3869",
    "id": 1731542040,
    "node_id": "IC_kwDOB7jojM5nNTwY",
    "user": {
      "login": "misicnenad",
      "id": 19427053,
      "node_id": "MDQ6VXNlcjE5NDI3MDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/19427053?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/misicnenad",
      "html_url": "https://github.com/misicnenad",
      "followers_url": "https://api.github.com/users/misicnenad/followers",
      "following_url": "https://api.github.com/users/misicnenad/following{/other_user}",
      "gists_url": "https://api.github.com/users/misicnenad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/misicnenad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/misicnenad/subscriptions",
      "organizations_url": "https://api.github.com/users/misicnenad/orgs",
      "repos_url": "https://api.github.com/users/misicnenad/repos",
      "events_url": "https://api.github.com/users/misicnenad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/misicnenad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-22T14:41:34Z",
    "updated_at": "2023-09-22T14:41:34Z",
    "author_association": "NONE",
    "body": "@fvictorio @alcuadrado are there any updates on this issue? I haven't managed to devote enough time to working on this, but would still be a great feature to have.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1731542040/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1748653110",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3869#issuecomment-1748653110",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3869",
    "id": 1748653110,
    "node_id": "IC_kwDOB7jojM5oOlQ2",
    "user": {
      "login": "misicnenad",
      "id": 19427053,
      "node_id": "MDQ6VXNlcjE5NDI3MDUz",
      "avatar_url": "https://avatars.githubusercontent.com/u/19427053?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/misicnenad",
      "html_url": "https://github.com/misicnenad",
      "followers_url": "https://api.github.com/users/misicnenad/followers",
      "following_url": "https://api.github.com/users/misicnenad/following{/other_user}",
      "gists_url": "https://api.github.com/users/misicnenad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/misicnenad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/misicnenad/subscriptions",
      "organizations_url": "https://api.github.com/users/misicnenad/orgs",
      "repos_url": "https://api.github.com/users/misicnenad/repos",
      "events_url": "https://api.github.com/users/misicnenad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/misicnenad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-05T10:55:07Z",
    "updated_at": "2023-10-05T10:55:07Z",
    "author_association": "NONE",
    "body": "@fvictorio any updates?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1748653110/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1756027803",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3869#issuecomment-1756027803",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3869",
    "id": 1756027803,
    "node_id": "IC_kwDOB7jojM5oqtub",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-10T18:43:25Z",
    "updated_at": "2023-10-10T18:43:25Z",
    "author_association": "MEMBER",
    "body": "Hey @misicnenad, I took another look at this and I believe it's possible to do at the type-level, and agree that it would be pretty useful. The problem is that we need to be careful when implementing this and be sure it doesn't cause false compilation errors in existing projects. Sadly we don't have the bandwidth to do that properly right now.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1756027803/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
