{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2881",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2881/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2881/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2881/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/2881",
  "id": 1284778447,
  "node_id": "I_kwDOB7jojM5MlCnP",
  "number": 2881,
  "title": "How to pass array as parameter to CLI plugin",
  "user": {
    "login": "sunliang711",
    "id": 16303258,
    "node_id": "MDQ6VXNlcjE2MzAzMjU4",
    "avatar_url": "https://avatars.githubusercontent.com/u/16303258?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sunliang711",
    "html_url": "https://github.com/sunliang711",
    "followers_url": "https://api.github.com/users/sunliang711/followers",
    "following_url": "https://api.github.com/users/sunliang711/following{/other_user}",
    "gists_url": "https://api.github.com/users/sunliang711/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sunliang711/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sunliang711/subscriptions",
    "organizations_url": "https://api.github.com/users/sunliang711/orgs",
    "repos_url": "https://api.github.com/users/sunliang711/repos",
    "events_url": "https://api.github.com/users/sunliang711/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sunliang711/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": true,
  "assignee": {
    "login": "feuGeneA",
    "id": 7883777,
    "node_id": "MDQ6VXNlcjc4ODM3Nzc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7883777?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/feuGeneA",
    "html_url": "https://github.com/feuGeneA",
    "followers_url": "https://api.github.com/users/feuGeneA/followers",
    "following_url": "https://api.github.com/users/feuGeneA/following{/other_user}",
    "gists_url": "https://api.github.com/users/feuGeneA/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/feuGeneA/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/feuGeneA/subscriptions",
    "organizations_url": "https://api.github.com/users/feuGeneA/orgs",
    "repos_url": "https://api.github.com/users/feuGeneA/repos",
    "events_url": "https://api.github.com/users/feuGeneA/events{/privacy}",
    "received_events_url": "https://api.github.com/users/feuGeneA/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "feuGeneA",
      "id": 7883777,
      "node_id": "MDQ6VXNlcjc4ODM3Nzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7883777?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/feuGeneA",
      "html_url": "https://github.com/feuGeneA",
      "followers_url": "https://api.github.com/users/feuGeneA/followers",
      "following_url": "https://api.github.com/users/feuGeneA/following{/other_user}",
      "gists_url": "https://api.github.com/users/feuGeneA/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/feuGeneA/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/feuGeneA/subscriptions",
      "organizations_url": "https://api.github.com/users/feuGeneA/orgs",
      "repos_url": "https://api.github.com/users/feuGeneA/repos",
      "events_url": "https://api.github.com/users/feuGeneA/events{/privacy}",
      "received_events_url": "https://api.github.com/users/feuGeneA/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-06-26T02:35:23Z",
  "updated_at": "2022-11-17T21:12:44Z",
  "closed_at": "2022-07-11T15:57:59Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "Hello, I wrote a plugin to deploy contract\r\n```\r\n    task(\"Deploy\", \"deploy contract\", async (args, hre, runSuper) => {\r\n        const networkName = hre.network.name;\r\n        const networkUrl = hre.network.config.url\r\n        console.log(\">> Network Name: \", networkName)\r\n        console.log(\">> Network URL: \", networkUrl)\r\n        for (const arg of args.args) {\r\n            console.log(`arg: ${arg}`)\r\n        }\r\n\r\n        await hre.run('compile')\r\n\r\n        const [...signers] = await hre.ethers.getSigners()\r\n        const owner = signers[0]\r\n        const factory = await hre.ethers.getContractFactory(args.name, owner)\r\n        if (args.args && args.args.length > 0) {\r\n            contract = await factory.deploy(...args.args)\r\n        } else {\r\n            contract = await factory.deploy()\r\n        }\r\n        await contract.deployed()\r\n        const deployTransaction = contract.deployTransaction\r\n        console.log(\"contract address:\", contract.address)\r\n        console.log(\"tx hash:\", deployTransaction.hash)\r\n\r\n    })\r\n        .addParam(\"name\", \"contract name (Token20, Token721, Token1155)\")\r\n        .addOptionalVariadicPositionalParam(\"args\", \"constructor arguments\")\r\n```\r\n\r\nif the contract I want to deploy has a constructor of this form \r\n```\r\n    constructor(address[] memory signers_) {\r\n        require(signers_.length == 3, \"Invalid number of signers\");\r\n\r\n        for (uint8 i = 0; i < signers_.length; i++) {\r\n            require(signers_[i] != address(0), \"Invalid signer\");\r\n            signers[signers_[i]] = true;\r\n        }\r\n    }\r\n```\r\n\r\nhow to pass CLI parameter to my Deploy plugin?\r\n\r\nI used \r\nnpx hardhat Deploy --name MultiSig \"[0xCe6512491Ad9D7F87b4bdE76368c5C8920600759,0xB44E0D2F23059F93CF4b74025085C93e9df2b5a0,0xB37B8122eDefab3268aE4EaD6B1d2941E08aB4eb]\" \r\nbut hardhat notify me with this error msg:\r\n```\r\nAn unexpected error occurred:\r\n\r\nError: invalid value for array (argument=\"value\", value=\"[0xCe6512491Ad9D7F87b4bdE76368c5C8920600759,0xB44E0D2F23059F93CF4b74025085C93e9df2b5a0,0xB37B8122eDefab3268aE4EaD6B1d2941E08aB4eb]\", code=INVALID_ARGUMENT, version=contracts/5.5.0)\r\n    at Logger.makeError (/home/eagle/Workspace/node/standard-tokens/node_modules/@ethersproject/logger/src.ts/index.ts:225:28)\r\n    at /home/eagle/Workspace/node/standard-tokens/node_modules/@ethersproject/contracts/src.ts/index.ts:165:42\r\n    at step (/home/eagle/Workspace/node/standard-tokens/node_modules/@ethersproject/contracts/lib/index.js:48:23)\r\n    at Object.next (/home/eagle/Workspace/node/standard-tokens/node_modules/@ethersproject/contracts/lib/index.js:29:53)\r\n    at /home/eagle/Workspace/node/standard-tokens/node_modules/@ethersproject/contracts/lib/index.js:23:71\r\n    at new Promise (<anonymous>)\r\n    at __awaiter (/home/eagle/Workspace/node/standard-tokens/node_modules/@ethersproject/contracts/lib/index.js:19:12)\r\n    at resolveAddresses (/home/eagle/Workspace/node/standard-tokens/node_modules/@ethersproject/contracts/lib/index.js:118:12)\r\n    at /home/eagle/Workspace/node/standard-tokens/node_modules/@ethersproject/contracts/src.ts/index.ts:147:20\r\n    at Array.map (<anonymous>) {\r\n  reason: 'invalid value for array',\r\n  code: 'INVALID_ARGUMENT',\r\n  argument: 'value',\r\n  value: '[0xCe6512491Ad9D7F87b4bdE76368c5C8920600759,0xB44E0D2F23059F93CF4b74025085C93e9df2b5a0,0xB37B8122eDefab3268aE4EaD6B1d2941E08aB4eb]'\r\n}\r\n```",
  "closed_by": {
    "login": "feuGeneA",
    "id": 7883777,
    "node_id": "MDQ6VXNlcjc4ODM3Nzc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7883777?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/feuGeneA",
    "html_url": "https://github.com/feuGeneA",
    "followers_url": "https://api.github.com/users/feuGeneA/followers",
    "following_url": "https://api.github.com/users/feuGeneA/following{/other_user}",
    "gists_url": "https://api.github.com/users/feuGeneA/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/feuGeneA/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/feuGeneA/subscriptions",
    "organizations_url": "https://api.github.com/users/feuGeneA/orgs",
    "repos_url": "https://api.github.com/users/feuGeneA/repos",
    "events_url": "https://api.github.com/users/feuGeneA/events{/privacy}",
    "received_events_url": "https://api.github.com/users/feuGeneA/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2881/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2881/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1166402624",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2881#issuecomment-1166402624",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2881",
    "id": 1166402624,
    "node_id": "IC_kwDOB7jojM5FheRA",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-06-26T02:35:52Z",
    "updated_at": "2022-06-26T02:35:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue is also being [tracked on Linear](https://linear.app/nomic-foundation/issue/HH-884/how-to-pass-array-as-parameter-to-cli-plugin).\n\nWe use Linear to manage our development process, but we keep the conversations on Github.\n\nLINEAR-ID: 1ac6acff-18a9-4b9a-8f9c-388ba694e795",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1166402624/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1179709444",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2881#issuecomment-1179709444",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2881",
    "id": 1179709444,
    "node_id": "IC_kwDOB7jojM5GUPAE",
    "user": {
      "login": "SfyMantissa",
      "id": 38407640,
      "node_id": "MDQ6VXNlcjM4NDA3NjQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/38407640?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SfyMantissa",
      "html_url": "https://github.com/SfyMantissa",
      "followers_url": "https://api.github.com/users/SfyMantissa/followers",
      "following_url": "https://api.github.com/users/SfyMantissa/following{/other_user}",
      "gists_url": "https://api.github.com/users/SfyMantissa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SfyMantissa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SfyMantissa/subscriptions",
      "organizations_url": "https://api.github.com/users/SfyMantissa/orgs",
      "repos_url": "https://api.github.com/users/SfyMantissa/repos",
      "events_url": "https://api.github.com/users/SfyMantissa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SfyMantissa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-10T11:25:26Z",
    "updated_at": "2022-07-10T11:40:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hello!\r\n\r\nThe \"array\" you're passing to your task is still just a string for JS.\r\nIn order to correctly parse the input as an array, you need to first split the input string.\r\n\r\nLet's take [one of my pet projects as an example](https://github.com/SfyMantissa/TokenMarketplace).\r\n\r\nHere I have task _balanceOfBatchSatsuki_ which takes mandatory arguments _accounts_ and _tokenids_ with \"arrays\" of addresses and token IDs.\r\n\r\nAs you may see, it works just fine:\r\n\r\n```\r\nsfy@neonblaze: ~/repos/TokenMarketplace ❱❱ hh balanceOfBatchSatsuki --accounts \"0x9271EfD9709270334721f58f722DDc5C8Ee0E3DF,0x9271EfD9709270334721f58f722DDc5C8Ee0E3DF,0x9271EfD9709270334721f58f722DDc5C8Ee0E3DF\" --tokenids \"1,2,3\"\r\n0x9271EfD9709270334721f58f722DDc5C8Ee0E3DF has 21 of Satsuki tokens with ID 1.\r\n0x9271EfD9709270334721f58f722DDc5C8Ee0E3DF has 101 of Satsuki tokens with ID 2.\r\n0x9271EfD9709270334721f58f722DDc5C8Ee0E3DF has 1 of Satsuki tokens with ID 3.\r\n```\r\n\r\nNow let's look at the code of my task:\r\n\r\n```\r\nimport \"@nomiclabs/hardhat-ethers\";\r\nimport { task } from \"hardhat/config\";\r\nimport config from '../../config';\r\n\r\ntask(\"balanceOfBatchSatsuki\",\r\n  \"Get the Satsuki batch balance for multiple accounts and tokens.\")\r\n  .addParam(\"accounts\", \"User addresses array.\")\r\n  .addParam(\"tokenids\", \"IDs of the token collections array.\")\r\n  .setAction(async (args, { ethers }) => {\r\n    const Satsuki = await ethers.getContractFactory(\"Satsuki\");\r\n    const satsuki = Satsuki.attach(config.SATSUKI_ADDRESS);\r\n\r\n    let accounts = args.accounts.split(',');\r\n    let tokenIds = args.tokenids.split(',');\r\n\r\n    const balanceOf = await satsuki.balanceOfBatch(accounts, tokenIds);\r\n\r\n    for (let i = 0; i < accounts.length; i++) {\r\n      console.log(accounts[i] + ' has ' + balanceOf[i]\r\n        + ' of Satsuki tokens with ID ' + tokenIds[i] + '.');\r\n    }\r\n  });\r\n```\r\n\r\nIn\r\n\r\n```\r\n    ...\r\n    let accounts = args.accounts.split(',');\r\n    let tokenIds = args.tokenids.split(',');\r\n    ...\r\n```\r\n\r\nI parse the input strings to work with them as proper arrays.\r\nI think you need to try doing the same.\r\n\r\nHope this helps.\r\n\r\nP.S. _hh_ is just an alias for _npx hardhat_.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1179709444/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 2,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1204702058",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2881#issuecomment-1204702058",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2881",
    "id": 1204702058,
    "node_id": "IC_kwDOB7jojM5Hzktq",
    "user": {
      "login": "sunliang711",
      "id": 16303258,
      "node_id": "MDQ6VXNlcjE2MzAzMjU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/16303258?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sunliang711",
      "html_url": "https://github.com/sunliang711",
      "followers_url": "https://api.github.com/users/sunliang711/followers",
      "following_url": "https://api.github.com/users/sunliang711/following{/other_user}",
      "gists_url": "https://api.github.com/users/sunliang711/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sunliang711/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sunliang711/subscriptions",
      "organizations_url": "https://api.github.com/users/sunliang711/orgs",
      "repos_url": "https://api.github.com/users/sunliang711/repos",
      "events_url": "https://api.github.com/users/sunliang711/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sunliang711/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-04T03:04:20Z",
    "updated_at": "2022-08-04T03:04:20Z",
    "author_association": "NONE",
    "body": "Great, thanks !",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1204702058/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
