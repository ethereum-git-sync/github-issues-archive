{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1341",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1341/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1341/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1341/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/1341",
  "id": 835761503,
  "node_id": "MDU6SXNzdWU4MzU3NjE1MDM=",
  "number": 1341,
  "title": "Proposal: Use relative instead of absolute paths for file references",
  "user": {
    "login": "fubhy",
    "id": 1172528,
    "node_id": "MDQ6VXNlcjExNzI1Mjg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1172528?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fubhy",
    "html_url": "https://github.com/fubhy",
    "followers_url": "https://api.github.com/users/fubhy/followers",
    "following_url": "https://api.github.com/users/fubhy/following{/other_user}",
    "gists_url": "https://api.github.com/users/fubhy/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fubhy/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fubhy/subscriptions",
    "organizations_url": "https://api.github.com/users/fubhy/orgs",
    "repos_url": "https://api.github.com/users/fubhy/repos",
    "events_url": "https://api.github.com/users/fubhy/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fubhy/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4937718880,
      "node_id": "LA_kwDOB7jojM8AAAABJk-cYA",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/type:improvement",
      "name": "type:improvement",
      "color": "FBCA04",
      "default": false,
      "description": ""
    },
    {
      "id": 4937720577,
      "node_id": "LA_kwDOB7jojM8AAAABJk-jAQ",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/status:ready",
      "name": "status:ready",
      "color": "0E8A16",
      "default": false,
      "description": "This issue is ready to be worked on"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-03-19T09:39:51Z",
  "updated_at": "2023-01-03T09:17:21Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Storing absolute paths in any sort of artifact (cache maps, build artifacts, deployment artifacts), etc. means that they are not portable.\r\n\r\nMoving the project root directory to a different parent directory on the local machine should not bust all caches and invalidate the build artifacts. This is more of an edge case of course but it also affects some more elaborate CI stacks. For instance, we share build artifacts across different test runners with different defaults for the working directory of the CI runtime environment. In each of these, we currently run 12 parallel test process  (ever growing as we add more stuff) and each of them currently spends ~30 seconds in `hardhat compile`. By caching the build artifacts we can bring this down to ~5 seconds which saves us quite a bit of time and money for our pull requests. We managed to achieve this by using custom configuration in all our CI runners to end up in the same absolute directory hierarchy but that shouldn't be necessary in my opinion and could cause other problems in CI runners that do not support this (we were lucky).\r\n\r\nHence, I'd suggest to switch to relative file paths. Either relative to the root directory (maybe determined by location of the hardhat config?) or relative to the root directory as configured in the hardhat config.\r\n\r\n\r\n\r\nOff-topic: After optimizing our CI workflows I also looked at your github workflow (CI.yaml): I noticed that the cache actions are set up inefficiently currently with too many things cached with unrelated cache key hashes (e.g. hardhat stuff is cached based on  node dependencies / lock files) and that you are not caching the hardhat compile output and fork cache at all. I think it should be possible to significantly reduce the time spend in CI by optimizing the caches there a bit. I could work on a PR for that if you don't mind but figured I'd raise that for discussion first :-)",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1341/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1341/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/850704149",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1341#issuecomment-850704149",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1341",
    "id": 850704149,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MDcwNDE0OQ==",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-28T22:28:25Z",
    "updated_at": "2021-05-28T22:28:25Z",
    "author_association": "MEMBER",
    "body": "Hey @fubhy, thanks for this and sorry for not responding before. I think this makes sense, although we'll need to evaluate the trade-offs (if any, maybe this doesn't have any downside). At some point we'll need to revisit our whole compilation pipeline to fix several minor things, so this is very useful.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/850704149/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
