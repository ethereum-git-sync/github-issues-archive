{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/596",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/596/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/596/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/596/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/596",
  "id": 622734031,
  "node_id": "MDU6SXNzdWU2MjI3MzQwMzE=",
  "number": 596,
  "title": "Better feedback when fallback and/or receive are missing in 0.6",
  "user": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": true,
  "assignee": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-05-21T19:36:51Z",
  "updated_at": "2022-11-19T00:15:55Z",
  "closed_at": "2020-06-18T18:35:45Z",
  "author_association": "MEMBER",
  "active_lock_reason": "resolved",
  "body": "If a transaction isn't handled by the contract, the error is always that the fallback function is missing. After 0.6, the error can be more informative. For example:\r\n\r\n- If the transaction has calldata and no value: \"missing fallback function\"\r\n- If the transaction has calldata and value: \"missing payable fallback function\"\r\n- If the transaction doesn't have calldata and value: \"missing receive function\"\r\n\r\nWith respect to the remaining case, when the transaction doesn't have nor calldata nor value, I don't know which function makes more sense to inform as missing. I'd say \"receive\", but I guess it's debatable.",
  "closed_by": {
    "login": "alcuadrado",
    "id": 176499,
    "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alcuadrado",
    "html_url": "https://github.com/alcuadrado",
    "followers_url": "https://api.github.com/users/alcuadrado/followers",
    "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
    "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
    "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
    "repos_url": "https://api.github.com/users/alcuadrado/repos",
    "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/596/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/596/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/634309207",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/596#issuecomment-634309207",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/596",
    "id": 634309207,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNDMwOTIwNw==",
    "user": {
      "login": "alcuadrado",
      "id": 176499,
      "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alcuadrado",
      "html_url": "https://github.com/alcuadrado",
      "followers_url": "https://api.github.com/users/alcuadrado/followers",
      "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
      "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
      "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
      "repos_url": "https://api.github.com/users/alcuadrado/repos",
      "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-26T22:15:04Z",
    "updated_at": "2020-05-26T22:16:38Z",
    "author_association": "MEMBER",
    "body": "This is more complex than it seemed, so I created a table with all the relevant cases:\r\n\r\n\r\n\r\nTransaction has calldata | Transaction has value | Contract has fallback | Fallback is payable | Contract has receive | Error\r\n-- | -- | -- | -- | -- | --\r\nYes | Yes | Yes | Yes | --- | NO ERROR -- Uses fallback\r\nYes | Yes | Yes | No | --- | FALLBACK_NOT_PAYABLE_ERROR\r\nYes | Yes | No | --- | --- | UNRECOGNIZED_FUNCTION_WITHOUT_FALLBACK_ERROR\r\n  |   |   |   |   |  \r\nYes | No | Yes | --- | --- | NO ERROR -- Uses fallback\r\nYes | No | No | --- | --- | UNRECOGNIZED_FUNCTION_WITHOUT_FALLBACK_ERROR\r\n  |   |   |   |   |  \r\nNo | Yes | --- | --- | Yes | NO ERROR -- Uses receive\r\nNo | Yes | Yes | Yes | No | NO ERROR -- Uses fallback\r\nNo | Yes | Yes | No | No | Solidity 0.5: FALLBACK_NOT_PAYABLE_ERROR <br> Solidity 0.6: **FALLBACK_NOT_PAYABLE_AND_NO_RECEIVE_ERROR**\r\nNo | Yes | No | --- | No | Solidity 0.5: UNRECOGNIZED_FUNCTION_WITHOUT_FALLBACK_ERROR <br> Solidity 0.6: **MISSING_FALLBACK_AND_RECEIVE_ERROR**\r\n  |   |   |   |   |  \r\nNo | No | --- | --- | Yes | NO ERROR -- Uses receive\r\nNo | No | Yes | --- | No | NO ERROR -- Uses fallback\r\nNo | No | No | --- | No | Solidity 0.5: UNRECOGNIZED_FUNCTION_WITHOUT_FALLBACK_ERROR <br> Solidity 0.6: **MISSING_FALLBACK_AND_RECEIVE_ERROR**\r\n\r\nThe \"---\" cells can be read as \"both value\"/\"doesn't matter\".\r\n\r\nI think we should add the error types that are in **bold**.\r\n\r\nWhat do you think, @fvictorio ?\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/634309207/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/634965517",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/596#issuecomment-634965517",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/596",
    "id": 634965517,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNDk2NTUxNw==",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-27T21:59:57Z",
    "updated_at": "2020-05-27T21:59:57Z",
    "author_association": "MEMBER",
    "body": "I think the last two should be different, shouldn't them? The first one is _\"You need to add a payable fallback or a receive function\"_ and the second one is _\"You need to add a fallback or a receive function\"_  But the last one is a veeery edge case though, so I don't think this is too important.\r\n\r\nAnother minor nitpick is that maybe the error should be called `MISSING_FALLBACK_OR_RECEIVE_ERROR`.\r\n\r\nOther than that, looks great.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/634965517/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/635580147",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/596#issuecomment-635580147",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/596",
    "id": 635580147,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNTU4MDE0Nw==",
    "user": {
      "login": "alcuadrado",
      "id": 176499,
      "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alcuadrado",
      "html_url": "https://github.com/alcuadrado",
      "followers_url": "https://api.github.com/users/alcuadrado/followers",
      "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
      "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
      "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
      "repos_url": "https://api.github.com/users/alcuadrado/repos",
      "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-28T20:15:14Z",
    "updated_at": "2020-05-28T20:15:14Z",
    "author_association": "MEMBER",
    "body": "> I think the last two should be different, shouldn't them? The first one is _\"You need to add a payable fallback or a receive function\"_ and the second one is _\"You need to add a fallback or a receive function\"_ But the last one is a veeery edge case though, so I don't think this is too important.\r\n\r\nLet's keep a single error. In the worst case, users will add a non payable fallback, rerun their tests and get a much more precise error.\r\n\r\n> Another minor nitpick is that maybe the error should be called `MISSING_FALLBACK_OR_RECEIVE_ERROR`.\r\n\r\n👌",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/635580147/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/646237175",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/596#issuecomment-646237175",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/596",
    "id": 646237175,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0NjIzNzE3NQ==",
    "user": {
      "login": "alcuadrado",
      "id": 176499,
      "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alcuadrado",
      "html_url": "https://github.com/alcuadrado",
      "followers_url": "https://api.github.com/users/alcuadrado/followers",
      "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
      "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
      "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
      "repos_url": "https://api.github.com/users/alcuadrado/repos",
      "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-18T18:35:45Z",
    "updated_at": "2020-06-18T18:35:45Z",
    "author_association": "MEMBER",
    "body": "This has already been implemented",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/646237175/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
