{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1872",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1872/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1872/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1872/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/1872",
  "id": 993068729,
  "node_id": "MDU6SXNzdWU5OTMwNjg3Mjk=",
  "number": 1872,
  "title": "[Dev exp] Lazy load the config file",
  "user": {
    "login": "nathandem",
    "id": 26671461,
    "node_id": "MDQ6VXNlcjI2NjcxNDYx",
    "avatar_url": "https://avatars.githubusercontent.com/u/26671461?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/nathandem",
    "html_url": "https://github.com/nathandem",
    "followers_url": "https://api.github.com/users/nathandem/followers",
    "following_url": "https://api.github.com/users/nathandem/following{/other_user}",
    "gists_url": "https://api.github.com/users/nathandem/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/nathandem/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/nathandem/subscriptions",
    "organizations_url": "https://api.github.com/users/nathandem/orgs",
    "repos_url": "https://api.github.com/users/nathandem/repos",
    "events_url": "https://api.github.com/users/nathandem/events{/privacy}",
    "received_events_url": "https://api.github.com/users/nathandem/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-09-10T09:43:57Z",
  "updated_at": "2022-11-18T16:00:47Z",
  "closed_at": "2021-09-10T11:06:03Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "[Issue]\r\n\r\nHardhat fails to run when the configuration file (`hardhat.config.js`) is invalid because of missing values.\r\n\r\n[Minimal Reproducible Example]\r\n```\r\n# hardhat.config.js\r\nrequire(\"@nomiclabs/hardhat-waffle\");\r\n\r\n// For deployment\r\nconst ALCHEMY_KOVAN_API_KEY = process.env.ALCHEMY_KOVAN_API_KEY;\r\nconst DEPLOYMENT_PK = process.env.DEPLOYMENT_PK;\r\n\r\nmodule.exports = {\r\n    solidity: \"0.8.4\",\r\n    networks: {\r\n        hardhat: {\r\n            chainId: 1337,\r\n        },\r\n        kovan: {\r\n            url: `https://eth-kovan.alchemyapi.io/v2/${ALCHEMY_KOVAN_API_KEY}`,\r\n            accounts: [`0x${DEPLOYMENT_PK}`],\r\n        },\r\n    },\r\n};\r\n```\r\nIn this minimal example, hardhat will fail to run any command until it is able to get the values of `ALCHEMY_KOVAN_API_KEY` and `DEPLOYMENT_PK`.\r\n\r\nThe thing is these 2 environment variables are only needed when deploying the contract, not the rest of the time. Hardhat doesn't need to load this part of the configuration file when running tests, when testing locally with the hardhat chain, etc.\r\n\r\nIn short, I'm asking for a lazy load of the configuration depending on what segment of the configuration hardhat needs (instead of eagerly loading it to satisfy the type `HttpNetworkConfig`). For example, when running tests, hardhat only needs to know about the hardhat network (`networks.hardhat`), not the kovan one (`networks.kovan`).\r\n\r\n[Benefits]\r\n\r\nNot having to load environment variables unless needed, especially useful when working with different developers with a env file not checked out. It's also better for developer experience, especially when using a tool like `env-cmd` to pull env vars from a local file. It avoids having to prefix all hardhat commands to pull env variables which are not needed.\r\n\r\n_PS: in the meantime, I set default values when these environment variables are not defined (like below), it'd be better not to have to._\r\n```\r\nconst ALCHEMY_KOVAN_API_KEY = process.env.ALCHEMY_KOVAN_API_KEY || 'dummy';\r\nconst DEPLOYMENT_PK = process.env.DEPLOYMENT_PK || '0000000000';\r\n```\r\n",
  "closed_by": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1872/reactions",
    "total_count": 1,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 1,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1872/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/916820908",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1872#issuecomment-916820908",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1872",
    "id": 916820908,
    "node_id": "IC_kwDOB7jojM42pZOs",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-10T11:06:03Z",
    "updated_at": "2021-09-10T11:06:03Z",
    "author_association": "MEMBER",
    "body": "Hi @nathandem, thanks for the feedback. Sadly, doing something like this would mean a huge change in how Hardhat works, so it's very unlikely we'll implement it.\r\n\r\nAs you mention, the workaround right now is to use default values like that. We want to add better support for handling these kinds of secret parameters in the future, and maybe that would make this problem less annoying. But lazy loading probably won't happen.\r\n\r\nI'm going to close this, but we read comments in closed issues, so anyone feel free to comment here. Maybe we re-consider this in the long term.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/916820908/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
