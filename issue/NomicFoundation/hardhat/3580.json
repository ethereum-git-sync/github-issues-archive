{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3580",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3580/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3580/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3580/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/3580",
  "id": 1532944774,
  "node_id": "I_kwDOB7jojM5bXuGG",
  "number": 3580,
  "title": "Property 'revertedWithCustomError' does not exist on type 'Assertion'",
  "user": {
    "login": "advra",
    "id": 1753803,
    "node_id": "MDQ6VXNlcjE3NTM4MDM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1753803?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/advra",
    "html_url": "https://github.com/advra",
    "followers_url": "https://api.github.com/users/advra/followers",
    "following_url": "https://api.github.com/users/advra/following{/other_user}",
    "gists_url": "https://api.github.com/users/advra/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/advra/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/advra/subscriptions",
    "organizations_url": "https://api.github.com/users/advra/orgs",
    "repos_url": "https://api.github.com/users/advra/repos",
    "events_url": "https://api.github.com/users/advra/events{/privacy}",
    "received_events_url": "https://api.github.com/users/advra/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4937119027,
      "node_id": "LA_kwDOB7jojM8AAAABJkZ1Mw",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/status:triaging",
      "name": "status:triaging",
      "color": "0E8A16",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2023-01-13T21:37:38Z",
  "updated_at": "2023-05-07T00:13:50Z",
  "closed_at": "2023-01-19T09:26:21Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "### Describe the feature\n\nIm updating my project from Javascript to Typescript. Up until now I had no issues using `revertedWithCustomError`. When trying to assert with `revertedWithCustomError` I get the following linter error messaged \"Property 'revertedWithCustomError' does not exist on type 'Assertion'.\"\r\n\r\nThe header imports in my TS look like:\r\n```typescript\r\nconst ethers = require(\"ethers\");\r\nimport { loadFixture } from \"@nomicfoundation/hardhat-network-helpers\";\r\nimport { expect } from \"chai\";\r\nimport { BigNumber, constants } from \"ethers\";\r\n```\r\nHere is an example test snippet:\r\n```Tyypescript\r\n    it(\"Should validate list errors 721\", async function () {\r\n      const { Marketplace, Rentable4907Nft, Rentable1155Nft, Rentable721Nft } = await loadFixture(deployFixture);\r\n      await expect(marketplace.connect(USER).listNFT(\r\n        marketplace.address, \r\n        BigNumber.from(1), \r\n        ethers.utils.parseEther(\"1\"), \r\n        TOMORROW, IN_FIVE_DAYS, \r\n        { value: listingFee}\r\n      )).to.be.revertedWithCustomError(marketplace, \"UnsupportedNftInterface\");\r\n  });\r\n```\r\nWhat am I doing incorrectly? \n\n### Search terms\n\ntypescript revertedWithCustomError",
  "closed_by": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3580/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3580/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1382580006",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3580#issuecomment-1382580006",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3580",
    "id": 1382580006,
    "node_id": "IC_kwDOB7jojM5SaH8m",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-13T23:23:01Z",
    "updated_at": "2023-01-13T23:23:01Z",
    "author_association": "MEMBER",
    "body": "@advra do you have a `tsconfig.json`? Can you share its contents?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1382580006/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1382634075",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3580#issuecomment-1382634075",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3580",
    "id": 1382634075,
    "node_id": "IC_kwDOB7jojM5SaVJb",
    "user": {
      "login": "advra",
      "id": 1753803,
      "node_id": "MDQ6VXNlcjE3NTM4MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1753803?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/advra",
      "html_url": "https://github.com/advra",
      "followers_url": "https://api.github.com/users/advra/followers",
      "following_url": "https://api.github.com/users/advra/following{/other_user}",
      "gists_url": "https://api.github.com/users/advra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/advra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/advra/subscriptions",
      "organizations_url": "https://api.github.com/users/advra/orgs",
      "repos_url": "https://api.github.com/users/advra/repos",
      "events_url": "https://api.github.com/users/advra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/advra/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-14T02:06:54Z",
    "updated_at": "2023-01-14T05:23:22Z",
    "author_association": "NONE",
    "body": "@fvictorio  Hi this is my tsconfig.json\r\n```json\r\n{\r\n  \"compilerOptions\": {\r\n    \"target\": \"es2020\",\r\n    \"module\": \"commonjs\",\r\n    \"esModuleInterop\": true,\r\n    \"forceConsistentCasingInFileNames\": true,\r\n    \"strict\": true,\r\n    \"skipLibCheck\": true\r\n  },\r\n  \"exclude\": [\"dist\", \"node_modules\"],\r\n  \"include\": [\"./src\", \"./scripts\"],\r\n  \"files\": [\"./hardhat.config.ts\"]\r\n}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1382634075/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1382904931",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3580#issuecomment-1382904931",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3580",
    "id": 1382904931,
    "node_id": "IC_kwDOB7jojM5SbXRj",
    "user": {
      "login": "advra",
      "id": 1753803,
      "node_id": "MDQ6VXNlcjE3NTM4MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1753803?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/advra",
      "html_url": "https://github.com/advra",
      "followers_url": "https://api.github.com/users/advra/followers",
      "following_url": "https://api.github.com/users/advra/following{/other_user}",
      "gists_url": "https://api.github.com/users/advra/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/advra/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/advra/subscriptions",
      "organizations_url": "https://api.github.com/users/advra/orgs",
      "repos_url": "https://api.github.com/users/advra/repos",
      "events_url": "https://api.github.com/users/advra/events{/privacy}",
      "received_events_url": "https://api.github.com/users/advra/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-14T20:09:53Z",
    "updated_at": "2023-01-14T20:10:06Z",
    "author_association": "NONE",
    "body": "Okay I fixed the issue. The documentation in the hardhat website uses `hre` since types arent shared globally like it is in javascript. The documentation shows [a test file imports](https://hardhat.org/hardhat-runner/docs/guides/test-contracts): \r\n```javascript\r\nimport { expect } from \"chai\";\r\nimport hre from \"hardhat\";\r\nimport { time } from \"@nomicfoundation/hardhat-network-helpers\";\r\n```\r\n\r\nSo my resulting code below works using hre:\r\n```javascript\r\nimport { loadFixture } from \"@nomicfoundation/hardhat-network-helpers\";\r\nimport \"@nomicfoundation/hardhat-chai-matchers\"; //Added for revertWithCustomErrors\r\nimport { expect } from \"chai\";\r\nimport { BigNumber, constants } from \"ethers\";\r\nimport hre from \"hardhat\";\r\n\r\n// within test code using hre.ethers\r\nawait expect(marketplace.connect(USER).listNFT(\r\n    marketplace.address, \r\n    hre.ethers.utils.parseEther(\"1\"), \r\n    { value: listingFee}\r\n)).to.be.revertedWithCustomError(marketplace, \"UnsupportedNftInterface\");\r\n```\r\n\r\nAlternatively I found you can do this  import without hre like below though I am unsure of the correctness:\r\n```javascript\r\nimport { ethers } from \"hardhat\";\r\n\r\n// within test code using ethers\r\nawait expect(marketplace.connect(USER).listNFT(\r\n    marketplace.address, \r\n    ethers.utils.parseEther(\"1\"), \r\n    { value: listingFee}\r\n)).to.be.revertedWithCustomError(marketplace, \"UnsupportedNftInterface\");\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1382904931/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1396674167",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3580#issuecomment-1396674167",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3580",
    "id": 1396674167,
    "node_id": "IC_kwDOB7jojM5TP453",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-19T09:26:21Z",
    "updated_at": "2023-01-19T09:26:21Z",
    "author_association": "MEMBER",
    "body": "To clarify, it wasn't working for you before because you were not importing the `\"hardhat\"` module anywhere in your test? That makes sense, but at the same time I wonder how you managed to do anything in your test without using at least something from the HRE.\r\n\r\nI also think that the reason might be related to the `include`/`exclude`/`files` fields in your tsconfig.json, but I'm not 100% sure. For the record, our recommended ts config is [here](https://hardhat.org/hardhat-runner/docs/guides/typescript#typescript-configuration).\r\n\r\nI'm going to close this issue now because I'm not sure if there's something to do on our side. Please let me know if you disagree.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1396674167/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1418242557",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3580#issuecomment-1418242557",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3580",
    "id": 1418242557,
    "node_id": "IC_kwDOB7jojM5UiKn9",
    "user": {
      "login": "doublesharp",
      "id": 571472,
      "node_id": "MDQ6VXNlcjU3MTQ3Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/571472?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/doublesharp",
      "html_url": "https://github.com/doublesharp",
      "followers_url": "https://api.github.com/users/doublesharp/followers",
      "following_url": "https://api.github.com/users/doublesharp/following{/other_user}",
      "gists_url": "https://api.github.com/users/doublesharp/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/doublesharp/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/doublesharp/subscriptions",
      "organizations_url": "https://api.github.com/users/doublesharp/orgs",
      "repos_url": "https://api.github.com/users/doublesharp/repos",
      "events_url": "https://api.github.com/users/doublesharp/events{/privacy}",
      "received_events_url": "https://api.github.com/users/doublesharp/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-05T19:16:14Z",
    "updated_at": "2023-02-05T19:16:14Z",
    "author_association": "NONE",
    "body": "I had a conflict with `hardhat-waffle`, once it was removed with `import \"@nomicfoundation/hardhat-chai-matchers\";` in the Hardhat config file, all worked as expected.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1418242557/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
