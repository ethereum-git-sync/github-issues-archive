{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/570",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/570/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/570/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/570/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/570",
  "id": 615993308,
  "node_id": "MDU6SXNzdWU2MTU5OTMzMDg=",
  "number": 570,
  "title": "Buidler doesn't work with monorepos using hoisting",
  "user": {
    "login": "alcuadrado",
    "id": 176499,
    "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alcuadrado",
    "html_url": "https://github.com/alcuadrado",
    "followers_url": "https://api.github.com/users/alcuadrado/followers",
    "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
    "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
    "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
    "repos_url": "https://api.github.com/users/alcuadrado/repos",
    "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2020-05-11T15:54:48Z",
  "updated_at": "2022-11-19T00:15:48Z",
  "closed_at": "2020-08-24T12:41:16Z",
  "author_association": "MEMBER",
  "active_lock_reason": "resolved",
  "body": "Moving this conversation here from https://github.com/austintgriffith/scaffold-eth/pull/5\r\n\r\n> > Hey @forshtat! Patricio from Buidler here.\r\n> > How can I reproduce the problem with workspaces and Buidler plugins?\r\n> > Thanks\r\n> \r\n> So, for my environment (macOS 10.15.4; yarn 1.16.0; node v13.11.0) in this repo on [cb81fbd](https://github.com/austintgriffith/scaffold-eth/commit/cb81fbd30a09aed7855dd6d25272546cd8d0ab5c) do yarn install. All '@nomiclabs' dependencies go to the root node_modules folder.\r\n> \r\n> <img alt=\"Screenshot 2020-05-11 at 14 13 28\" width=\"606\" src=\"https://user-images.githubusercontent.com/40541447/81556192-96a31580-9392-11ea-85c2-5a538ac17518.png\">\r\n> \r\n> Now `cd packages/buidler/` and `yarn add @opengsn/gsn`\r\n> \r\n> The resulting modules layout is different, as some modules get to a different location:\r\n> \r\n> <img alt=\"Screenshot 2020-05-11 at 14 17 24\" width=\"612\" src=\"https://user-images.githubusercontent.com/40541447/81556232-a3276e00-9392-11ea-9530-6b536ca49cfe.png\">\r\n> \r\n> <img alt=\"Screenshot 2020-05-11 at 14 17 35\" width=\"629\" src=\"https://user-images.githubusercontent.com/40541447/81556241-a6225e80-9392-11ea-98af-c153b59c46cf.png\">\r\n> \r\n> Now trying to run buidler chain:\r\n> \r\n> ```\r\n> yarn run v1.16.0\r\n> $ cd packages/buidler && npx buidler node --verbose\r\n>   ...\r\n>   ...\r\n>   buidler:core:plugins Loading plugin file /Users/alexf/scaffold-eth/node_modules/@nomiclabs/buidler/builtin-tasks/test +23ms\r\n>   buidler:core:plugins Loading plugin @nomiclabs/buidler-truffle5 +2ms\r\n> Error BDLR800: Plugin @nomiclabs/buidler-truffle5 is not installed.\r\n> Please run: npm install --save-dev @nomiclabs/buidler-truffle5\r\n> \r\n> For more info go to https://buidler.dev/BDLR800 or run Buidler with --show-stack-traces\r\n> error Command failed with exit code 1.\r\n> ```\r\n\r\n",
  "closed_by": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/570/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/570/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/626793043",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/570#issuecomment-626793043",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/570",
    "id": 626793043,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNjc5MzA0Mw==",
    "user": {
      "login": "alcuadrado",
      "id": 176499,
      "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alcuadrado",
      "html_url": "https://github.com/alcuadrado",
      "followers_url": "https://api.github.com/users/alcuadrado/followers",
      "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
      "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
      "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
      "repos_url": "https://api.github.com/users/alcuadrado/repos",
      "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-11T15:58:45Z",
    "updated_at": "2020-05-11T15:58:45Z",
    "author_association": "MEMBER",
    "body": "@0xGabi, is this the same problem that was affecting you?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/626793043/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/626987699",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/570#issuecomment-626987699",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/570",
    "id": 626987699,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNjk4NzY5OQ==",
    "user": {
      "login": "PierrickGT",
      "id": 2401738,
      "node_id": "MDQ6VXNlcjI0MDE3Mzg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2401738?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PierrickGT",
      "html_url": "https://github.com/PierrickGT",
      "followers_url": "https://api.github.com/users/PierrickGT/followers",
      "following_url": "https://api.github.com/users/PierrickGT/following{/other_user}",
      "gists_url": "https://api.github.com/users/PierrickGT/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PierrickGT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PierrickGT/subscriptions",
      "organizations_url": "https://api.github.com/users/PierrickGT/orgs",
      "repos_url": "https://api.github.com/users/PierrickGT/repos",
      "events_url": "https://api.github.com/users/PierrickGT/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PierrickGT/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-11T21:58:24Z",
    "updated_at": "2020-05-11T21:58:24Z",
    "author_association": "NONE",
    "body": "I've forked `scaffold-eth` and found a way to make it work with `yarn workspace`. Here is the commit where you can see the changes I've made: https://github.com/PierrickGT/pooltogether-pod/commit/68b587e0837b49fefbbf530b1b2720b58609767f\r\n\r\nI think the main problem is due to the fact that the npm script command is: `cd packages/buidler && npx buidler node --verbose`\r\nBy using `npx`, we're using `npm` rather than `yarn` and so I think that's why `npx` can't locate `@nomiclabs/buidler-truffle5`.\r\n\r\nBy using the command `yarn workspace buidler chain`, we ensure that `yarn` will use the npm script `\"chain\": \"buidler node\",` present in the `package.json` of `packages/buidler`, by doing so, we ensure that `yarn` uses the modules that it installed in `packages/buidler`.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/626987699/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/631570738",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/570#issuecomment-631570738",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/570",
    "id": 631570738,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMTU3MDczOA==",
    "user": {
      "login": "PaulRBerg",
      "id": 8782666,
      "node_id": "MDQ6VXNlcjg3ODI2NjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8782666?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PaulRBerg",
      "html_url": "https://github.com/PaulRBerg",
      "followers_url": "https://api.github.com/users/PaulRBerg/followers",
      "following_url": "https://api.github.com/users/PaulRBerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/PaulRBerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PaulRBerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PaulRBerg/subscriptions",
      "organizations_url": "https://api.github.com/users/PaulRBerg/orgs",
      "repos_url": "https://api.github.com/users/PaulRBerg/repos",
      "events_url": "https://api.github.com/users/PaulRBerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PaulRBerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-20T16:04:58Z",
    "updated_at": "2020-05-20T16:04:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "FWIW, I'm using Buidler within a yarn workspaces repo and everything works fine, so this should be indeed an issue with your `npx` scripts.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/631570738/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/633315208",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/570#issuecomment-633315208",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/570",
    "id": 633315208,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMzMxNTIwOA==",
    "user": {
      "login": "0xGabi",
      "id": 9082013,
      "node_id": "MDQ6VXNlcjkwODIwMTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9082013?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/0xGabi",
      "html_url": "https://github.com/0xGabi",
      "followers_url": "https://api.github.com/users/0xGabi/followers",
      "following_url": "https://api.github.com/users/0xGabi/following{/other_user}",
      "gists_url": "https://api.github.com/users/0xGabi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/0xGabi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/0xGabi/subscriptions",
      "organizations_url": "https://api.github.com/users/0xGabi/orgs",
      "repos_url": "https://api.github.com/users/0xGabi/repos",
      "events_url": "https://api.github.com/users/0xGabi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/0xGabi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-24T23:21:25Z",
    "updated_at": "2020-05-24T23:21:25Z",
    "author_association": "NONE",
    "body": "Hi @alcuadrado sorry for the late answer. I think it is related but not quite the same as we are using Lerna instead of yarn workspaces.\r\n\r\nThe comment from @PierrickGT about using `npx` makes me wonder if that might be related. Because we use `npx` in an internal script that start ganache-cli ðŸ¤”",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/633315208/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/685865645",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/570#issuecomment-685865645",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/570",
    "id": 685865645,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NTg2NTY0NQ==",
    "user": {
      "login": "alcuadrado",
      "id": 176499,
      "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alcuadrado",
      "html_url": "https://github.com/alcuadrado",
      "followers_url": "https://api.github.com/users/alcuadrado/followers",
      "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
      "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
      "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
      "repos_url": "https://api.github.com/users/alcuadrado/repos",
      "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-02T16:54:46Z",
    "updated_at": "2020-09-02T16:54:46Z",
    "author_association": "MEMBER",
    "body": "This issue was fixed and released as 1.4.5.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/685865645/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
