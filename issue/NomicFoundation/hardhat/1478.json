{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1478",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1478/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1478/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1478/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/1478",
  "id": 899058684,
  "node_id": "MDU6SXNzdWU4OTkwNTg2ODQ=",
  "number": 1478,
  "title": "Configure provider to avoid disk I/O",
  "user": {
    "login": "barakman",
    "id": 7003246,
    "node_id": "MDQ6VXNlcjcwMDMyNDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7003246?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/barakman",
    "html_url": "https://github.com/barakman",
    "followers_url": "https://api.github.com/users/barakman/followers",
    "following_url": "https://api.github.com/users/barakman/following{/other_user}",
    "gists_url": "https://api.github.com/users/barakman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/barakman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/barakman/subscriptions",
    "organizations_url": "https://api.github.com/users/barakman/orgs",
    "repos_url": "https://api.github.com/users/barakman/repos",
    "events_url": "https://api.github.com/users/barakman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/barakman/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 10,
  "created_at": "2021-05-23T16:35:31Z",
  "updated_at": "2022-11-18T18:48:25Z",
  "closed_at": "2021-05-28T21:05:19Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "**Feature Request**:\r\n\r\nAllow the user to configure the provider to avoid disk I/O.\r\n\r\nThis is typically possible when the provider is ganache, by setting [the `db` property](https://github.com/trufflesuite/ganache-core/tree/master#options) to `memdown()`.\r\n\r\nIn Truffle, for example, this can be achieved via the configuration file:\r\n```\r\nconst memdown = require('memdown');\r\n\r\nmodule.exports = {\r\n    networks: {\r\n        networkName: {\r\n            provider: ganache.provider({\r\n                db: memdown(),\r\n                ...\r\n            }),\r\n            ...\r\n        },\r\n        ...\r\n    },\r\n    ...\r\n};\r\n```\r\n\r\nI tried to configure this in HardHat via the `paths.cache` [configuration option](https://hardhat.org/config/#available-config-options), but HardHat expects a string for this property, thus throwing an exception at [config-validation.ts](https://github.com/nomiclabs/hardhat/blob/master/packages/hardhat-core/src/internal/core/config/config-validation.ts#L24).\r\n\r\nI suppose that there might be way to do this by sending an asynchronous request to the provider itself, but executing such a request from HardHat's configuration file is not really an option.\r\n\r\nThanks",
  "closed_by": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1478/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1478/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/846591686",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1478#issuecomment-846591686",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1478",
    "id": 846591686,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NjU5MTY4Ng==",
    "user": {
      "login": "alcuadrado",
      "id": 176499,
      "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alcuadrado",
      "html_url": "https://github.com/alcuadrado",
      "followers_url": "https://api.github.com/users/alcuadrado/followers",
      "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
      "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
      "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
      "repos_url": "https://api.github.com/users/alcuadrado/repos",
      "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-23T16:43:59Z",
    "updated_at": "2021-05-23T16:43:59Z",
    "author_association": "MEMBER",
    "body": "I don't think we ever used a disk-based db, but I may be getting this wrongly. Do you know where/how this happen?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/846591686/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/846592660",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1478#issuecomment-846592660",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1478",
    "id": 846592660,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NjU5MjY2MA==",
    "user": {
      "login": "barakman",
      "id": 7003246,
      "node_id": "MDQ6VXNlcjcwMDMyNDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7003246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/barakman",
      "html_url": "https://github.com/barakman",
      "followers_url": "https://api.github.com/users/barakman/followers",
      "following_url": "https://api.github.com/users/barakman/following{/other_user}",
      "gists_url": "https://api.github.com/users/barakman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/barakman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/barakman/subscriptions",
      "organizations_url": "https://api.github.com/users/barakman/orgs",
      "repos_url": "https://api.github.com/users/barakman/repos",
      "events_url": "https://api.github.com/users/barakman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/barakman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-23T16:51:11Z",
    "updated_at": "2021-05-23T16:54:16Z",
    "author_association": "NONE",
    "body": "@alcuadrado : Wow, thank you for the incredibly fast response!\r\n\r\nNote that I've removed the 'reduce process memory size' incentive, as I've realized that it wouldn't necessarily achieve that.\r\n\r\nIn fact, `db: memdown()` might actually make the process-memory problem worse, who knows...\r\n\r\nWe are currently experiencing `heap out of memory` when executing `hardhat coverage` (at some point during execution).\r\n\r\nChanging it to `NODE_OPTIONS='--max-old-space-size=SomeSize' hardhat coverage` doesn't resolve the problem.\r\n\r\nBut regardless, supporting the `db` option would be a great benefit IMO, as it may significantly increase HH performance.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/846592660/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/846593692",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1478#issuecomment-846593692",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1478",
    "id": 846593692,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NjU5MzY5Mg==",
    "user": {
      "login": "alcuadrado",
      "id": 176499,
      "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alcuadrado",
      "html_url": "https://github.com/alcuadrado",
      "followers_url": "https://api.github.com/users/alcuadrado/followers",
      "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
      "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
      "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
      "repos_url": "https://api.github.com/users/alcuadrado/repos",
      "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-23T16:58:58Z",
    "updated_at": "2021-05-23T16:59:35Z",
    "author_association": "MEMBER",
    "body": "There's not such an option in Hardhat, I don't even know what it does in Ganache tbh. We just don't use that db thing. Everything is already in-memory. Maybe using a disk-based one can result in less memory being used.\r\n\r\nRight now we don't use merkle-patricia-tree either, as it has a bug.\r\n\r\nIs the OOM error immediate, or after running multiple tests?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/846593692/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/846594984",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1478#issuecomment-846594984",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1478",
    "id": 846594984,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NjU5NDk4NA==",
    "user": {
      "login": "barakman",
      "id": 7003246,
      "node_id": "MDQ6VXNlcjcwMDMyNDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7003246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/barakman",
      "html_url": "https://github.com/barakman",
      "followers_url": "https://api.github.com/users/barakman/followers",
      "following_url": "https://api.github.com/users/barakman/following{/other_user}",
      "gists_url": "https://api.github.com/users/barakman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/barakman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/barakman/subscriptions",
      "organizations_url": "https://api.github.com/users/barakman/orgs",
      "repos_url": "https://api.github.com/users/barakman/repos",
      "events_url": "https://api.github.com/users/barakman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/barakman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-23T17:09:13Z",
    "updated_at": "2021-05-23T17:10:21Z",
    "author_association": "NONE",
    "body": "@alcuadrado: The OOM error occurs after running for several hours.\r\n\r\nIt is not something new BTW, I do know that `solidity-coverage` suffers this problem on large test suites.\r\n\r\nIn the distant past (solidity-coverage v0.5.x), I have managed to devise a fix for that within the package source code (which I have applied using a script executed immediately after `npm install`).\r\n\r\nBut solidity-coverage is now at v0.7.x, and in any case, I don't feel that applying this type of \"hot fix\" is the right way for solving such problems.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/846594984/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/846602234",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1478#issuecomment-846602234",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1478",
    "id": 846602234,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NjYwMjIzNA==",
    "user": {
      "login": "alcuadrado",
      "id": 176499,
      "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alcuadrado",
      "html_url": "https://github.com/alcuadrado",
      "followers_url": "https://api.github.com/users/alcuadrado/followers",
      "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
      "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
      "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
      "repos_url": "https://api.github.com/users/alcuadrado/repos",
      "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-23T18:06:04Z",
    "updated_at": "2021-05-23T18:06:04Z",
    "author_association": "MEMBER",
    "body": "I suspect it's the coverage that's using too much memory. @cgewecke does this sounds familiar to you?\r\n\r\nBTW, several hours?! ðŸ˜±",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/846602234/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/846605271",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1478#issuecomment-846605271",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1478",
    "id": 846605271,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NjYwNTI3MQ==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-23T18:29:13Z",
    "updated_at": "2021-05-23T18:29:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "@alcuadrado \r\n\r\nI've been seeing HardhatEVM OOM periodically when I launch it once in a separate tab and repeatedly run test suites with the same client instance. I don't believe the issue is coverage specific and have just assumed that if everything's in memory...why wouldn't it eventually run out? \r\n\r\n@barakman Since it's hours, perhaps you could look at partitioning the suite into smaller pieces? There are some recipes for parallelizing coverage in CI and merging the reports for each job in a final step here: \r\n\r\n+ [Synthetix (codecov)][1]\r\n+ [SetProtocol-V2 (coveralls)][2]\r\n\r\n[1]: https://github.com/Synthetixio/synthetix/pull/1275\r\n[2]: https://github.com/SetProtocol/set-protocol-v2/blob/aa894d7aef2f3db0819b05f06d18e7b3d851b25b/.circleci/config.yml#L60-L121 ",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/846605271/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/846609684",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1478#issuecomment-846609684",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1478",
    "id": 846609684,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NjYwOTY4NA==",
    "user": {
      "login": "barakman",
      "id": 7003246,
      "node_id": "MDQ6VXNlcjcwMDMyNDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7003246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/barakman",
      "html_url": "https://github.com/barakman",
      "followers_url": "https://api.github.com/users/barakman/followers",
      "following_url": "https://api.github.com/users/barakman/following{/other_user}",
      "gists_url": "https://api.github.com/users/barakman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/barakman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/barakman/subscriptions",
      "organizations_url": "https://api.github.com/users/barakman/orgs",
      "repos_url": "https://api.github.com/users/barakman/repos",
      "events_url": "https://api.github.com/users/barakman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/barakman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-23T19:05:33Z",
    "updated_at": "2021-05-23T19:10:42Z",
    "author_association": "NONE",
    "body": "@alcuadrado:\r\nIt's pretty logical to me that this is a coverage issue, since `hardhat test` completes successfully and `hardhat coverage` doesn't.\r\nSeveral hours - yes.\r\nNot only do we have a very large test-suite, but we also refrain from using `before`, i.e., we use `beforeEach` only, and as you can imagine, the execution subsequently takes much longer.\r\nThat being said, execution time doesn't necessarily impact the memory consumption of the process (in fact, it most likely doesn't).\r\nWe have in our code many cases of `it` clauses and even `describe` clauses inside `for` loops.\r\nThese loops are \"unrolled\" (by mocha?) before the tests start running, and I suspect that this might increase the process memory consumption significantly.\r\n\r\n@cgewecke:\r\nThank you, I will look into that.\r\nBTW, you may recall that back in v0.5.x, I used to apply a patch on your source code in order to reduce memory consumption.\r\nIt is described in one of the (now closed I suppose) issues on your GitHub.\r\nIt was around the area where you used to save the pre and post events inside an in-memory table, which would technically become huge when a large amount of Solidity code was being tested (or a large number of `it` clauses were being executed, not sure which one is the reason).\r\nI suppose that you no longer maintain such a table in memory, correct?\r\nIf it helps, some of the code that I tweaked back then was in and around function `generate(events, pathPrefix)` and function `processEvent(line)`.\r\n\r\nThank you both :)",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/846609684/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/848870165",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1478#issuecomment-848870165",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1478",
    "id": 848870165,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0ODg3MDE2NQ==",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-26T15:30:50Z",
    "updated_at": "2021-05-26T15:30:50Z",
    "author_association": "MEMBER",
    "body": "Hey @barakman, thanks for all the details. I'm curious about what we can do about this. At the very least, it would be interesting to know if hardhat OOMs in large test suites (without coverage), but apparently it doesn't in your case?\r\n\r\nAnd if the problem is when `solidity-coverage` is used, it would still be very useful to know if there's something we can do. For example, I think it's completely possible that the problem is actually in hardhat, but that it only happens after `solidity-coverage` instruments the code.\r\n\r\n@barakman if your repo is public and the way to reproduce this is to just run the tests with coverage enabled, could you please share it with us?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/848870165/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/848995168",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1478#issuecomment-848995168",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1478",
    "id": 848995168,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0ODk5NTE2OA==",
    "user": {
      "login": "barakman",
      "id": 7003246,
      "node_id": "MDQ6VXNlcjcwMDMyNDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7003246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/barakman",
      "html_url": "https://github.com/barakman",
      "followers_url": "https://api.github.com/users/barakman/followers",
      "following_url": "https://api.github.com/users/barakman/following{/other_user}",
      "gists_url": "https://api.github.com/users/barakman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/barakman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/barakman/subscriptions",
      "organizations_url": "https://api.github.com/users/barakman/orgs",
      "repos_url": "https://api.github.com/users/barakman/repos",
      "events_url": "https://api.github.com/users/barakman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/barakman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-26T17:55:15Z",
    "updated_at": "2021-05-26T17:55:15Z",
    "author_association": "NONE",
    "body": "@fvictorio : Thank you for your reply.\r\nWe were able to solve this by increasing `max-old-space-size` to 8192, i.e:\r\n```\r\n\"NODE_OPTIONS='--max-old-space-size=8192' hardhat coverage\r\n```\r\nThanks again for your help :)",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/848995168/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/850669268",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1478#issuecomment-850669268",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1478",
    "id": 850669268,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MDY2OTI2OA==",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-28T21:05:19Z",
    "updated_at": "2021-05-28T21:05:19Z",
    "author_association": "MEMBER",
    "body": "I'm going to close this in favor of #1186, but feel free to re-open if you think it should be treated as a different issue.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/850669268/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
