{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2364",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2364/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2364/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2364/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/2364",
  "id": 1130384646,
  "node_id": "I_kwDOB7jojM5DYE0G",
  "number": 2364,
  "title": "`gas` config value must be within a set range, or mysterious errors abound",
  "user": {
    "login": "sebbacon",
    "id": 211271,
    "node_id": "MDQ6VXNlcjIxMTI3MQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/211271?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sebbacon",
    "html_url": "https://github.com/sebbacon",
    "followers_url": "https://api.github.com/users/sebbacon/followers",
    "following_url": "https://api.github.com/users/sebbacon/following{/other_user}",
    "gists_url": "https://api.github.com/users/sebbacon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sebbacon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sebbacon/subscriptions",
    "organizations_url": "https://api.github.com/users/sebbacon/orgs",
    "repos_url": "https://api.github.com/users/sebbacon/repos",
    "events_url": "https://api.github.com/users/sebbacon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sebbacon/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 901960538,
      "node_id": "MDU6TGFiZWw5MDE5NjA1Mzg=",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/type:bug",
      "name": "type:bug",
      "color": "FBCA04",
      "default": false,
      "description": "Something isn't working"
    },
    {
      "id": 4937720577,
      "node_id": "LA_kwDOB7jojM8AAAABJk-jAQ",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/status:ready",
      "name": "status:ready",
      "color": "0E8A16",
      "default": false,
      "description": "This issue is ready to be worked on"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2022-02-10T16:07:31Z",
  "updated_at": "2023-05-26T00:15:39Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "The `gas` setting in the network config allows a user to specify maximum gas.\r\n\r\nHowever, if a users sets this number to less than a million, then when they hit this code...\r\n\r\nhttps://github.com/nomiclabs/hardhat/blob/9f1a0a36058f7546fa38aae949a0d29d91512aba/packages/hardhat-ethers/src/internal/helpers.ts#L367-L372\r\n\r\n\r\nit results in a negative `gasLimit`, which when subsequently validated by `ethers` causes an error like this:\r\n\r\n```\r\n{\r\n  reason: 'invalid hex string',\r\n  code: 'INVALID_ARGUMENT',\r\n  argument: 'value',\r\n  value: '-0x0ee491'\r\n}\r\n```\r\n\r\n**Reproduction steps**\r\n\r\nMake any minimal contract, deploy it, and try calling it with `gas` set to a number less than 1M in `hardhat.config.js` and a real RPC network configured.\r\n\r\n\r\nA quick fix would be to update the documentation to say the number should be between 1,000,000 and 4,700,000.\r\n\r\n**Search Terms**\r\n\r\nI searched for `gas`, `gasLimit` and `invalid hex string` when looking for resolutions to this problem\r\n",
  "closed_by": {
    "login": "github-actions[bot]",
    "id": 41898282,
    "node_id": "MDM6Qm90NDE4OTgyODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/github-actions%5Bbot%5D",
    "html_url": "https://github.com/apps/github-actions",
    "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2364/reactions",
    "total_count": 6,
    "+1": 3,
    "-1": 0,
    "laugh": 1,
    "hooray": 0,
    "confused": 1,
    "heart": 0,
    "rocket": 1,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2364/timeline",
  "performed_via_github_app": null,
  "state_reason": "reopened"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1107640517",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2364#issuecomment-1107640517",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2364",
    "id": 1107640517,
    "node_id": "IC_kwDOB7jojM5CBUDF",
    "user": {
      "login": "folego",
      "id": 20648959,
      "node_id": "MDQ6VXNlcjIwNjQ4OTU5",
      "avatar_url": "https://avatars.githubusercontent.com/u/20648959?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/folego",
      "html_url": "https://github.com/folego",
      "followers_url": "https://api.github.com/users/folego/followers",
      "following_url": "https://api.github.com/users/folego/following{/other_user}",
      "gists_url": "https://api.github.com/users/folego/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/folego/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/folego/subscriptions",
      "organizations_url": "https://api.github.com/users/folego/orgs",
      "repos_url": "https://api.github.com/users/folego/repos",
      "events_url": "https://api.github.com/users/folego/events{/privacy}",
      "received_events_url": "https://api.github.com/users/folego/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-23T20:00:51Z",
    "updated_at": "2022-04-23T20:00:51Z",
    "author_association": "NONE",
    "body": "Thank you, man. I am struggling for hours here.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1107640517/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1135113515",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2364#issuecomment-1135113515",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2364",
    "id": 1135113515,
    "node_id": "IC_kwDOB7jojM5DqHUr",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-05-23T20:35:12Z",
    "updated_at": "2022-05-23T20:35:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue was marked as stale because it didn't have any activity in the last 30 days. If you think it's still relevant, please leave a comment indicating so. Otherwise, it will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1135113515/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1135596656",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2364#issuecomment-1135596656",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2364",
    "id": 1135596656,
    "node_id": "IC_kwDOB7jojM5Dr9Rw",
    "user": {
      "login": "sebbacon",
      "id": 211271,
      "node_id": "MDQ6VXNlcjIxMTI3MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/211271?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sebbacon",
      "html_url": "https://github.com/sebbacon",
      "followers_url": "https://api.github.com/users/sebbacon/followers",
      "following_url": "https://api.github.com/users/sebbacon/following{/other_user}",
      "gists_url": "https://api.github.com/users/sebbacon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sebbacon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sebbacon/subscriptions",
      "organizations_url": "https://api.github.com/users/sebbacon/orgs",
      "repos_url": "https://api.github.com/users/sebbacon/repos",
      "events_url": "https://api.github.com/users/sebbacon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sebbacon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-24T08:57:05Z",
    "updated_at": "2022-05-24T08:57:05Z",
    "author_association": "NONE",
    "body": "I think this is still relevant. See the comment from last month from a user who had lost hours of time with this issue.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1135596656/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1164248784",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2364#issuecomment-1164248784",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2364",
    "id": 1164248784,
    "node_id": "IC_kwDOB7jojM5FZQbQ",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-06-23T10:36:08Z",
    "updated_at": "2022-06-23T10:36:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue was marked as stale because it didn't have any activity in the last 30 days. If you think it's still relevant, please leave a comment indicating so. Otherwise, it will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1164248784/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1171055728",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2364#issuecomment-1171055728",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2364",
    "id": 1171055728,
    "node_id": "IC_kwDOB7jojM5FzORw",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-06-30T10:37:57Z",
    "updated_at": "2022-06-30T10:37:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue was closed because it has been stalled for 7 days with no activity.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1171055728/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1190122993",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2364#issuecomment-1190122993",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2364",
    "id": 1190122993,
    "node_id": "IC_kwDOB7jojM5G79Xx",
    "user": {
      "login": "marceljay",
      "id": 37071670,
      "node_id": "MDQ6VXNlcjM3MDcxNjcw",
      "avatar_url": "https://avatars.githubusercontent.com/u/37071670?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/marceljay",
      "html_url": "https://github.com/marceljay",
      "followers_url": "https://api.github.com/users/marceljay/followers",
      "following_url": "https://api.github.com/users/marceljay/following{/other_user}",
      "gists_url": "https://api.github.com/users/marceljay/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/marceljay/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/marceljay/subscriptions",
      "organizations_url": "https://api.github.com/users/marceljay/orgs",
      "repos_url": "https://api.github.com/users/marceljay/repos",
      "events_url": "https://api.github.com/users/marceljay/events{/privacy}",
      "received_events_url": "https://api.github.com/users/marceljay/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-20T10:48:21Z",
    "updated_at": "2022-07-20T11:10:24Z",
    "author_association": "NONE",
    "body": "Lost half a day figuring out this error, because I set a value of 500000 instead of 5000000 in my `.env` file.\r\n\r\nit also seems that in many cases, ethers or hardhat-ethers substracts 1m gas of the set gas limit. So if you set the gas limit to e.g. 5m, the transaction object will just have ~4.02m.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1190122993/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1563638018",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2364#issuecomment-1563638018",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2364",
    "id": 1563638018,
    "node_id": "IC_kwDOB7jojM5dMzkC",
    "user": {
      "login": "hiroshitash",
      "id": 1159921,
      "node_id": "MDQ6VXNlcjExNTk5MjE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1159921?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hiroshitash",
      "html_url": "https://github.com/hiroshitash",
      "followers_url": "https://api.github.com/users/hiroshitash/followers",
      "following_url": "https://api.github.com/users/hiroshitash/following{/other_user}",
      "gists_url": "https://api.github.com/users/hiroshitash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hiroshitash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hiroshitash/subscriptions",
      "organizations_url": "https://api.github.com/users/hiroshitash/orgs",
      "repos_url": "https://api.github.com/users/hiroshitash/repos",
      "events_url": "https://api.github.com/users/hiroshitash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hiroshitash/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-25T23:47:57Z",
    "updated_at": "2023-05-26T00:15:39Z",
    "author_association": "NONE",
    "body": "@fvictorio \r\n\r\nPlease check [PR](https://github.com/NomicFoundation/hardhat/pull/3956). The issue can be reproduced at https://github.com/hiroshitash/hardhat-wrong-network-config-gas.\r\n\r\n- check for 1,000,000 < networkConfig.gas added in hardhat-ethers/src/internal/helpers.ts\r\n- tests for the above modified or added\r\n- existing tests failing and filed an issue at https://github.com/NomicFoundation/hardhat/issues/3955\r\n\r\nI limit the change to checking `1,000,000 < networkConfig.gas` and not `networkConfig.gas < 4,700,000` because default networkConfig.gas is currently 30,000,000 (set in [hardhat-core](https://github.com/hiroshitash/hardhat/blob/2b7efe09e8d1a4d523f646e66ec54613b121133d/packages/hardhat-core/src/internal/core/config/config-resolution.ts#L179)). I do not know the implication of changing it in hardhat-core.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1563638018/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
