{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4471",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4471/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4471/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4471/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/4471",
  "id": 1939952167,
  "node_id": "I_kwDOB7jojM5zoVIn",
  "number": 4471,
  "title": "frontrunning issue with gas: 'auto' vs gas: number ( neither works like in prev hardhat version )",
  "user": {
    "login": "C0D3O",
    "id": 75484297,
    "node_id": "MDQ6VXNlcjc1NDg0Mjk3",
    "avatar_url": "https://avatars.githubusercontent.com/u/75484297?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/C0D3O",
    "html_url": "https://github.com/C0D3O",
    "followers_url": "https://api.github.com/users/C0D3O/followers",
    "following_url": "https://api.github.com/users/C0D3O/following{/other_user}",
    "gists_url": "https://api.github.com/users/C0D3O/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/C0D3O/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/C0D3O/subscriptions",
    "organizations_url": "https://api.github.com/users/C0D3O/orgs",
    "repos_url": "https://api.github.com/users/C0D3O/repos",
    "events_url": "https://api.github.com/users/C0D3O/events{/privacy}",
    "received_events_url": "https://api.github.com/users/C0D3O/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2474207618,
      "node_id": "MDU6TGFiZWwyNDc0MjA3NjE4",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/status:needs-more-info",
      "name": "status:needs-more-info",
      "color": "0E8A16",
      "default": false,
      "description": "There's not enough information to start working on this issue"
    }
  ],
  "state": "closed",
  "locked": true,
  "assignee": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-10-12T13:01:59Z",
  "updated_at": "2024-01-30T00:13:06Z",
  "closed_at": "2023-10-31T08:25:31Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "### Version of Hardhat\r\n\r\n2.17.3\r\n\r\n### What happened?\r\n\r\nI'm simulating a frontrunning attack using one of the latest hardhat version ( yes, I've found the closed issue here, when it only allows a single tx to be in a block, without gas 'auto' in the config ( BUT it presents some new issue )). \r\n\r\nIn short, if I use gas: 'auto', frontrunning logic doesn't work... I have only 3 txs: contract deployment, victim tx and the attacker tx, and the evm_mine call at the end of the code.. ( I will provide it if you need it, but it seems like the problem should be clear for you hopefully even without it ). \r\nSo, when using gas auto, I don't even see my transaction, tho I'm using the victims tx data and sending it with the bigger gasPrice or maxPriorityFeePerGas ( I tried both ) amount. It seems like tho the block is not mined yet, hardhat is already decided that the victim's tx should be first, cause it's higher in the code or sth, and then the attacker tx is just being reverted cause the victim's tx already got ETH from the contract.\r\n\r\nBut when gas: number is used everything seems to work. BUT ONLY IF there's little amount of tx and they are not too complex. I can't get it work either way when I have lots of tx that I need to sort through to find the victim's tx.... Could you please explain why so and what's the proper way to 'fix' it if there's sth to fix in the first place. Thank you\r\n\r\n### Minimal reproduction steps\r\n\r\ncomparing behavior using gas: auto vs gas: number in the config\r\n\r\n### Search terms\r\n\r\n_No response_",
  "closed_by": {
    "login": "C0D3O",
    "id": 75484297,
    "node_id": "MDQ6VXNlcjc1NDg0Mjk3",
    "avatar_url": "https://avatars.githubusercontent.com/u/75484297?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/C0D3O",
    "html_url": "https://github.com/C0D3O",
    "followers_url": "https://api.github.com/users/C0D3O/followers",
    "following_url": "https://api.github.com/users/C0D3O/following{/other_user}",
    "gists_url": "https://api.github.com/users/C0D3O/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/C0D3O/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/C0D3O/subscriptions",
    "organizations_url": "https://api.github.com/users/C0D3O/orgs",
    "repos_url": "https://api.github.com/users/C0D3O/repos",
    "events_url": "https://api.github.com/users/C0D3O/events{/privacy}",
    "received_events_url": "https://api.github.com/users/C0D3O/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4471/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4471/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1772804173",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/4471#issuecomment-1772804173",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4471",
    "id": 1772804173,
    "node_id": "IC_kwDOB7jojM5pqthN",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-20T14:05:33Z",
    "updated_at": "2023-10-20T14:05:33Z",
    "author_association": "MEMBER",
    "body": "Hey @moneyDev1111, I'm not sure I understand your problem. If you are trying to simulate a frontrunning attack, then I guess you are disabling automining, sending a tx 1, and then sending a tx 2 with a higher gas price. Then, if you send a `hardhat_mine` method, both should be mined and tx 2 should be included first in the block. Is this what you are saying? I'm not sure what `gas: \"auto\"` has to do with this because that's related to the gas limit, not the gas price.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1772804173/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1778840937",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/4471#issuecomment-1778840937",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4471",
    "id": 1778840937,
    "node_id": "IC_kwDOB7jojM5qBvVp",
    "user": {
      "login": "C0D3O",
      "id": 75484297,
      "node_id": "MDQ6VXNlcjc1NDg0Mjk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/75484297?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/C0D3O",
      "html_url": "https://github.com/C0D3O",
      "followers_url": "https://api.github.com/users/C0D3O/followers",
      "following_url": "https://api.github.com/users/C0D3O/following{/other_user}",
      "gists_url": "https://api.github.com/users/C0D3O/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/C0D3O/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/C0D3O/subscriptions",
      "organizations_url": "https://api.github.com/users/C0D3O/orgs",
      "repos_url": "https://api.github.com/users/C0D3O/repos",
      "events_url": "https://api.github.com/users/C0D3O/events{/privacy}",
      "received_events_url": "https://api.github.com/users/C0D3O/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-25T09:11:31Z",
    "updated_at": "2023-10-25T09:13:24Z",
    "author_association": "NONE",
    "body": "gas: 'auto' or gas: number changes the behavior of hardhat!!! the transactions order",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1778840937/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1778841618",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/4471#issuecomment-1778841618",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4471",
    "id": 1778841618,
    "node_id": "IC_kwDOB7jojM5qBvgS",
    "user": {
      "login": "C0D3O",
      "id": 75484297,
      "node_id": "MDQ6VXNlcjc1NDg0Mjk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/75484297?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/C0D3O",
      "html_url": "https://github.com/C0D3O",
      "followers_url": "https://api.github.com/users/C0D3O/followers",
      "following_url": "https://api.github.com/users/C0D3O/following{/other_user}",
      "gists_url": "https://api.github.com/users/C0D3O/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/C0D3O/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/C0D3O/subscriptions",
      "organizations_url": "https://api.github.com/users/C0D3O/orgs",
      "repos_url": "https://api.github.com/users/C0D3O/repos",
      "events_url": "https://api.github.com/users/C0D3O/events{/privacy}",
      "received_events_url": "https://api.github.com/users/C0D3O/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-25T09:11:56Z",
    "updated_at": "2023-10-25T09:12:46Z",
    "author_association": "NONE",
    "body": "@fvictorio  I will record a video a bit later for a better explanation, non of the settings allow frontrunning\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1778841618/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1786536364",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/4471#issuecomment-1786536364",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/4471",
    "id": 1786536364,
    "node_id": "IC_kwDOB7jojM5qfGGs",
    "user": {
      "login": "C0D3O",
      "id": 75484297,
      "node_id": "MDQ6VXNlcjc1NDg0Mjk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/75484297?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/C0D3O",
      "html_url": "https://github.com/C0D3O",
      "followers_url": "https://api.github.com/users/C0D3O/followers",
      "following_url": "https://api.github.com/users/C0D3O/following{/other_user}",
      "gists_url": "https://api.github.com/users/C0D3O/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/C0D3O/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/C0D3O/subscriptions",
      "organizations_url": "https://api.github.com/users/C0D3O/orgs",
      "repos_url": "https://api.github.com/users/C0D3O/repos",
      "events_url": "https://api.github.com/users/C0D3O/events{/privacy}",
      "received_events_url": "https://api.github.com/users/C0D3O/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-31T06:36:03Z",
    "updated_at": "2023-10-31T06:42:08Z",
    "author_association": "NONE",
    "body": "@fvictorio I've found the working settings for the newer version, If mining interval set to 0 seconds, everything works. If to 10 seconds - doesn't work. Could you please explain why such behavior? Thank you\r\n\r\n50 seconds also works...\r\n20 seconds also works\r\n15 seconds DOESN'T\r\n16 works\r\n\r\nI see I needed to read the docs more carefully, the right answer is to use 0 seconds interval....",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1786536364/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
