{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2071",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2071/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2071/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2071/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/2071",
  "id": 1053987535,
  "node_id": "I_kwDOB7jojM4-0pLP",
  "number": 2071,
  "title": "Feature request: Add support for exporting Hardhat test results",
  "user": {
    "login": "hs2361",
    "id": 51477130,
    "node_id": "MDQ6VXNlcjUxNDc3MTMw",
    "avatar_url": "https://avatars.githubusercontent.com/u/51477130?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hs2361",
    "html_url": "https://github.com/hs2361",
    "followers_url": "https://api.github.com/users/hs2361/followers",
    "following_url": "https://api.github.com/users/hs2361/following{/other_user}",
    "gists_url": "https://api.github.com/users/hs2361/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hs2361/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hs2361/subscriptions",
    "organizations_url": "https://api.github.com/users/hs2361/orgs",
    "repos_url": "https://api.github.com/users/hs2361/repos",
    "events_url": "https://api.github.com/users/hs2361/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hs2361/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 947232611,
      "node_id": "MDU6TGFiZWw5NDcyMzI2MTE=",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/type:feature",
      "name": "type:feature",
      "color": "FBCA04",
      "default": false,
      "description": "Feature request"
    }
  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-11-15T18:42:51Z",
  "updated_at": "2022-11-17T21:40:29Z",
  "closed_at": "2022-07-10T22:33:59Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "**Current situation:**\r\nHardhat supports writing tests using Waffle and Ethers.js as mentioned in the docs [here](https://hardhat.org/guides/waffle-testing.html). Waffle internally uses the Mocha test runner, and supports adding in Mocha configuration in the hardhat.config.js file as mentioned [here](https://github.com/nomiclabs/hardhat/tree/master/docs/config#mocha-configuration).\r\n\r\n**The problem:**\r\nHowever, since Waffle uses an older version of Mocha (specifically v7.1.2) as can be seen here\r\nhttps://github.com/nomiclabs/hardhat/blob/70c8dd19540ec7e7f4527ec88d8046f7e5d9b9ea/packages/hardhat-waffle/package.json#L49\r\nit is not possible to use newer features added into Mocha. Specifically the ability to export test results as JSON and then output the results to a file was added in with the release of [Mocha v9.1.0](https://github.com/mochajs/mocha/releases/tag/v9.1.0).\r\n\r\n**Use case:**\r\nAllowing the ability to use a different reporter for Hardhat tests and to export the test results separately would be a very useful feature for CI pipelines, where these test results can be uploaded and then processed to generate HTML test results (for example, using the [test-reporter GitHub Action](https://github.com/marketplace/actions/test-reporter) which supports Mocha test reports in JSON format). This could potentially make debugging failing Hardhat tests on CI pipelines much easier.\r\n\r\n**Potential steps to add the feature**\r\nUpgrading the version of Mocha used in Waffle to >= 9.1.0 would be one of the steps to add the ability to export test results with Mocha. However, other steps may be necessary depending on how the Mocha configuration has been implemented.\r\n\r\nLooking forward to any suggestions or improvements from the community ðŸ˜„",
  "closed_by": {
    "login": "github-actions[bot]",
    "id": 41898282,
    "node_id": "MDM6Qm90NDE4OTgyODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/github-actions%5Bbot%5D",
    "html_url": "https://github.com/apps/github-actions",
    "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2071/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2071/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/971604977",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2071#issuecomment-971604977",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2071",
    "id": 971604977,
    "node_id": "IC_kwDOB7jojM456YPx",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-17T13:55:27Z",
    "updated_at": "2021-11-17T13:55:27Z",
    "author_association": "MEMBER",
    "body": "Just in case: you can run the tests using mocha directly. Check [this example](https://github.com/fvictorio/hardhat-examples/tree/master/parallel-tests)\r\n\r\nAnyway, I think this issue is still relevant since it makes sense to want to pass something like a `--reporter` flag to the test task.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/971604977/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1172883212",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2071#issuecomment-1172883212",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2071",
    "id": 1172883212,
    "node_id": "IC_kwDOB7jojM5F6McM",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-07-02T11:31:41Z",
    "updated_at": "2022-07-02T11:31:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue was marked as stale because it didn't have any activity in the last 30 days. If you think it's still relevant, please leave a comment indicating so. Otherwise, it will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1172883212/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1179812958",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2071#issuecomment-1179812958",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2071",
    "id": 1179812958,
    "node_id": "IC_kwDOB7jojM5GUoRe",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-07-10T22:33:58Z",
    "updated_at": "2022-07-10T22:33:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue was closed because it has been stalled for 7 days with no activity.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1179812958/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1180304943",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2071#issuecomment-1180304943",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2071",
    "id": 1180304943,
    "node_id": "IC_kwDOB7jojM5GWgYv",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-11T11:40:24Z",
    "updated_at": "2022-07-11T11:40:24Z",
    "author_association": "MEMBER",
    "body": "For the record: this is possible in the latest versions of hardhat. You just need to configure the reporter in your Hardhat config:\r\n\r\n```\r\n  mocha: {\r\n    reporter: \"json\"\r\n  }\r\n```\r\n\r\nYou can also use an environment variable to configure it:\r\n\r\n```\r\n  mocha: {\r\n    reporter: process.env.MOCHA_REPORTER ?? \"spec\"\r\n  }\r\n```\r\n\r\nAnd then `MOCHA_REPORTER=json hh test`\r\n\r\nThere's no `--reporter` param yet; if someone wants that, please open a new issue with that feature request.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1180304943/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
