{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3955",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3955/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3955/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3955/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/3955",
  "id": 1726400304,
  "node_id": "I_kwDOB7jojM5m5scw",
  "number": 3955,
  "title": "`yarn test` in `hardhat-ethers` fails",
  "user": {
    "login": "hiroshitashir",
    "id": 1159921,
    "node_id": "MDQ6VXNlcjExNTk5MjE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1159921?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/hiroshitashir",
    "html_url": "https://github.com/hiroshitashir",
    "followers_url": "https://api.github.com/users/hiroshitashir/followers",
    "following_url": "https://api.github.com/users/hiroshitashir/following{/other_user}",
    "gists_url": "https://api.github.com/users/hiroshitashir/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/hiroshitashir/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/hiroshitashir/subscriptions",
    "organizations_url": "https://api.github.com/users/hiroshitashir/orgs",
    "repos_url": "https://api.github.com/users/hiroshitashir/repos",
    "events_url": "https://api.github.com/users/hiroshitashir/events{/privacy}",
    "received_events_url": "https://api.github.com/users/hiroshitashir/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4937119027,
      "node_id": "LA_kwDOB7jojM8AAAABJkZ1Mw",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/status:triaging",
      "name": "status:triaging",
      "color": "0E8A16",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-05-25T19:48:40Z",
  "updated_at": "2023-09-27T00:13:01Z",
  "closed_at": "2023-06-28T13:47:17Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "**A way to reproduce**\r\n\r\nFrom `hardhat/packages/hardhat-ethers`, run `yarn test` or `./node_modules/.bin/mocha  test/index.ts`.\r\n\r\nYou should see the errors below. Most errors are from comparing with hardcoded addresses. It looks like something changed and the underlining blockchain generates different addresses. Simple fixes would be replacing actual values with expected ones.\r\n\r\n```\r\n  1) Ethers plugin\r\n       ganache\r\n         Provider\r\n           the provider should handle requests:\r\n\r\n      AssertionError: expected '0xf39fd6e51aad88f6f4ce6ab8827279cfffb…' to equal '0x90f8bf6a479f320ead074411a4b0e7944ea…'\r\n      + expected - actual\r\n\r\n      -0xf39fd6e51aad88f6f4ce6ab8827279cfffb92266\r\n      +0x90f8bf6a479f320ead074411a4b0e7944ea8c9c1\r\n\r\n      at Context.<anonymous> (test/index.ts:115:16)\r\n      at processTicksAndRejections (internal/process/task_queues.js:95:5)\r\n\r\n  2) Ethers plugin\r\n       ganache\r\n         Signers and contracts helpers\r\n           getSigners\r\n             should return the signers:\r\n\r\n      AssertionError: expected '0xf39Fd6e51aad88F6F4ce6aB8827279cffFb…' to equal '0x90F8bf6A479f320ead074411a4B0e7944Ea…'\r\n      + expected - actual\r\n\r\n      -0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\r\n      +0x90F8bf6A479f320ead074411a4B0e7944Ea8c9C1\r\n\r\n      at Context.<anonymous> (test/index.ts:135:18)\r\n      at processTicksAndRejections (internal/process/task_queues.js:95:5)\r\n\r\n  3) Ethers plugin\r\n       ganache\r\n         Signers and contracts helpers\r\n           getSigners\r\n             should expose the address synchronously:\r\n\r\n      AssertionError: expected '0xf39Fd6e51aad88F6F4ce6aB8827279cffFb…' to equal '0x90F8bf6A479f320ead074411a4B0e7944Ea…'\r\n      + expected - actual\r\n\r\n      -0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\r\n      +0x90F8bf6A479f320ead074411a4B0e7944Ea8c9C1\r\n\r\n      at Context.<anonymous> (test/index.ts:143:18)\r\n      at processTicksAndRejections (internal/process/task_queues.js:95:5)\r\n\r\n  4) Ethers plugin\r\n       ganache\r\n         Signers and contracts helpers\r\n           getImpersonatedSigner\r\n             should invoke hardhat_impersonateAccount:\r\n     AssertionError: expected promise to be rejected with an error including 'Method hardhat_impersonateAccount not…' but it was fulfilled with SignerWithAddress{ …(4) }\r\n\r\n\r\n  5) Ethers plugin\r\n       ganache\r\n         Signers and contracts helpers\r\n           signer\r\n             should return the balance of the account:\r\n\r\n      AssertionError: expected '9999836450024205015644' to equal '100000000000000000000'\r\n      + expected - actual\r\n\r\n      -9999836450024205015644\r\n      +100000000000000000000\r\n\r\n      at Context.<anonymous> (test/index.ts:191:18)\r\n      at processTicksAndRejections (internal/process/task_queues.js:95:5)\r\n\r\n  6) Ethers plugin\r\n       ganache\r\n         Signers and contracts helpers\r\n           signer\r\n             should return the transaction count of the account:\r\n\r\n      AssertionError: expected '175' to equal '0'\r\n      + expected - actual\r\n\r\n      -175\r\n      +0\r\n\r\n      at Context.<anonymous> (test/index.ts:199:18)\r\n      at processTicksAndRejections (internal/process/task_queues.js:95:5)\r\n\r\n  7) Ethers plugin\r\n       ganache\r\n         Signers and contracts helpers\r\n           signer\r\n             should get the chainId:\r\n\r\n      AssertionError: expected 31337 to equal 1337\r\n      + expected - actual\r\n\r\n      -31337\r\n      +1337\r\n\r\n      at Context.<anonymous> (test/index.ts:242:18)\r\n      at processTicksAndRejections (internal/process/task_queues.js:95:5)\r\n\r\n  8) Ethers plugin\r\n       ganache\r\n         Signers and contracts helpers\r\n           signer\r\n             should get the gas price:\r\n\r\n      AssertionError: expected '1000000008' to equal '20000000000'\r\n      + expected - actual\r\n\r\n      -1000000008\r\n      +20000000000\r\n\r\n      at Context.<anonymous> (test/index.ts:250:18)\r\n      at processTicksAndRejections (internal/process/task_queues.js:95:5)\r\n```",
  "closed_by": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3955/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3955/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1611446930",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3955#issuecomment-1611446930",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3955",
    "id": 1611446930,
    "node_id": "IC_kwDOB7jojM5gDLqS",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-28T13:47:17Z",
    "updated_at": "2023-06-28T13:47:17Z",
    "author_association": "MEMBER",
    "body": "Hi @hiroshitash, sorry but I can't reproduce this. All our tests run in the CI so it's unlikely that they are failing and we didn't notice, so perhaps is something related to your setup. If this is still happening to you, let me know and I'll see if I can help.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1611446930/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
