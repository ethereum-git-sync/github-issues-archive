{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/2234",
  "id": 1097288576,
  "node_id": "I_kwDOB7jojM5BZ0uA",
  "number": 2234,
  "title": "to.be.revertedWith fails for messages having same prefixes",
  "user": {
    "login": "akshatdev0",
    "id": 29691117,
    "node_id": "MDQ6VXNlcjI5NjkxMTE3",
    "avatar_url": "https://avatars.githubusercontent.com/u/29691117?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/akshatdev0",
    "html_url": "https://github.com/akshatdev0",
    "followers_url": "https://api.github.com/users/akshatdev0/followers",
    "following_url": "https://api.github.com/users/akshatdev0/following{/other_user}",
    "gists_url": "https://api.github.com/users/akshatdev0/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/akshatdev0/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/akshatdev0/subscriptions",
    "organizations_url": "https://api.github.com/users/akshatdev0/orgs",
    "repos_url": "https://api.github.com/users/akshatdev0/repos",
    "events_url": "https://api.github.com/users/akshatdev0/events{/privacy}",
    "received_events_url": "https://api.github.com/users/akshatdev0/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": true,
  "assignee": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 15,
  "created_at": "2022-01-09T20:06:31Z",
  "updated_at": "2022-11-17T21:40:18Z",
  "closed_at": "2022-07-18T08:58:21Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "For a contract below:\r\n```\r\npragma solidity >=0.8.4;\r\n\r\ncontract Matchers {\r\n    function doRevert() public pure {\r\n        revert(\"Revert cause\");\r\n    }\r\n}\r\n```\r\n\r\nWrite hardhat test as below:\r\n```\r\ndescribe('Matchers: revertedWith', () => {\r\n  // Test setup\r\n  // ....\r\n\r\n  it('Message starting with same prefixes: Should have FAILED, but PASSES', async () => {\r\n    await expect(matchers.doRevert()).to.be.revertedWith('R');\r\n    await expect(matchers.doRevert()).to.be.revertedWith('Re');\r\n    await expect(matchers.doRevert()).to.be.revertedWith('Rev');\r\n    await expect(matchers.doRevert()).to.be.revertedWith('Reve');\r\n    await expect(matchers.doRevert()).to.be.revertedWith('Rever');\r\n    await expect(matchers.doRevert()).to.be.revertedWith('Revert caus');\r\n  });\r\n});\r\n```\r\n\r\nAll these should have `FAILED` but `PASSED`.\r\n\r\nTo reproduce, follow the steps in the README of this repo below:\r\nhttps://github.com/akshatdev0/hardhat-chai-reverted-with-bug\r\n\r\nThis is not reproducible in [ethereum-waffle](https://github.com/EthWorks/Waffle), everything works as expected, as checked with the below repo:\r\nhttps://github.com/akshatdev0/ethereum-waffle-reverted-with\r\n",
  "closed_by": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1011287447",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2234#issuecomment-1011287447",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234",
    "id": 1011287447,
    "node_id": "IC_kwDOB7jojM48RwWX",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-12T17:31:28Z",
    "updated_at": "2022-01-12T17:31:28Z",
    "author_association": "MEMBER",
    "body": "Hey @akshatdev0, thanks a lot for this and for the reproduction repos.\r\n\r\nI wonder why this happens, we don't do anything special about that matcher.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1011287447/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1023121552",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2234#issuecomment-1023121552",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234",
    "id": 1023121552,
    "node_id": "IC_kwDOB7jojM48-5iQ",
    "user": {
      "login": "teddav",
      "id": 9486739,
      "node_id": "MDQ6VXNlcjk0ODY3Mzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9486739?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/teddav",
      "html_url": "https://github.com/teddav",
      "followers_url": "https://api.github.com/users/teddav/followers",
      "following_url": "https://api.github.com/users/teddav/following{/other_user}",
      "gists_url": "https://api.github.com/users/teddav/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/teddav/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/teddav/subscriptions",
      "organizations_url": "https://api.github.com/users/teddav/orgs",
      "repos_url": "https://api.github.com/users/teddav/repos",
      "events_url": "https://api.github.com/users/teddav/events{/privacy}",
      "received_events_url": "https://api.github.com/users/teddav/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-27T11:41:11Z",
    "updated_at": "2022-01-27T11:41:11Z",
    "author_association": "NONE",
    "body": "Good catch @akshatdev0 \r\nActually it's worse than that, it seems like `revertedWith` checks for the string you pass as argument anywhere in the revert message.  \r\nWe decided to change our revert messages to numbers to save on contract size (not such a good idea, but this is a different matter...). So the problem is:\r\n\r\nIf I'm checking for revert error code \"0\" (which we use for 0 addresses checks), but the actual reverse code is 110, then the test is gonna pass, which makes my tests not reliable.\r\n\r\nHere is a full example just to be clear:\r\n```\r\ncontract MyContract {\r\n  function willRevert(uint256 _i) public {\r\n    require(_i > 10, \"10\");\r\n  }\r\n}\r\n```\r\n\r\n```\r\ndescribe(\"Test\", () => {\r\n  it(\"willRevert\", async () => {\r\n    await expect(myContract.willRevert(3)).to.be.revertedWith('0');\r\n  })\r\n})\r\n```\r\nThis test will pass even though the reverted message is \"10\"",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1023121552/reactions",
      "total_count": 2,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 1,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1023153462",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2234#issuecomment-1023153462",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234",
    "id": 1023153462,
    "node_id": "IC_kwDOB7jojM48_BU2",
    "user": {
      "login": "akshatdev0",
      "id": 29691117,
      "node_id": "MDQ6VXNlcjI5NjkxMTE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/29691117?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/akshatdev0",
      "html_url": "https://github.com/akshatdev0",
      "followers_url": "https://api.github.com/users/akshatdev0/followers",
      "following_url": "https://api.github.com/users/akshatdev0/following{/other_user}",
      "gists_url": "https://api.github.com/users/akshatdev0/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/akshatdev0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/akshatdev0/subscriptions",
      "organizations_url": "https://api.github.com/users/akshatdev0/orgs",
      "repos_url": "https://api.github.com/users/akshatdev0/repos",
      "events_url": "https://api.github.com/users/akshatdev0/events{/privacy}",
      "received_events_url": "https://api.github.com/users/akshatdev0/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-27T12:24:58Z",
    "updated_at": "2022-01-27T12:24:58Z",
    "author_association": "NONE",
    "body": "Yeah, devs will need to be careful around this issue while writing tests from now on until it is fixed. ",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1023153462/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1045974424",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2234#issuecomment-1045974424",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234",
    "id": 1045974424,
    "node_id": "IC_kwDOB7jojM4-WE2Y",
    "user": {
      "login": "pofulu",
      "id": 34123848,
      "node_id": "MDQ6VXNlcjM0MTIzODQ4",
      "avatar_url": "https://avatars.githubusercontent.com/u/34123848?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pofulu",
      "html_url": "https://github.com/pofulu",
      "followers_url": "https://api.github.com/users/pofulu/followers",
      "following_url": "https://api.github.com/users/pofulu/following{/other_user}",
      "gists_url": "https://api.github.com/users/pofulu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pofulu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pofulu/subscriptions",
      "organizations_url": "https://api.github.com/users/pofulu/orgs",
      "repos_url": "https://api.github.com/users/pofulu/repos",
      "events_url": "https://api.github.com/users/pofulu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pofulu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-19T09:14:50Z",
    "updated_at": "2022-02-19T09:16:11Z",
    "author_association": "NONE",
    "body": "Based on what @akshatdev0  said, here are some examples:\r\n\r\nIf reverted message is\r\n```\r\nVM Exception while processing transaction: reverted with reason string 'Mint not open'\r\n```\r\nWhen I check `.revertedWith('hi')`, it will pass! Because the `hi` is `.included` in above message:\r\n```\r\nVM Exception w\"hi\"le processing transaction: reverted with reason string 'Mint not open'\r\n               ^^\r\n```\r\n\r\nMy temporary solution is to wrap my reason string with whole sentence:\r\n\r\n```ts\r\n// This test should failed properly\r\nawait expect(tx).revertedWith(revertReason('hi'))\r\n\r\nfunction revertReason(reason: string) {\r\n  return `VM Exception while processing transaction: reverted with reason string '${reason}'`\r\n}\r\n```\r\n\r\nI think this is the code causing the bug:\r\n<img width=\"1472\" alt=\"reason\" src=\"https://user-images.githubusercontent.com/34123848/154794597-c6964e50-db40-4218-a908-11ac5b38c0c1.png\">\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1045974424/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1125031651",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2234#issuecomment-1125031651",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234",
    "id": 1125031651,
    "node_id": "IC_kwDOB7jojM5DDp7j",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-12T13:59:18Z",
    "updated_at": "2022-05-12T13:59:18Z",
    "author_association": "MEMBER",
    "body": "Hi, we just released a beta version of a new plugin, `@nomicfoundation/hardhat-chai-matchers`. It should work as a drop-in replacement of hardhat-waffle, and (among other things) it fixes this issue. Check [this doc](https://nomiclabs.notion.site/Public-Hardhat-Chai-Matchers-11feb9185dd54591999f4e813f90c10c) if you are interested in giving it a try.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1125031651/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1151789707",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2234#issuecomment-1151789707",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234",
    "id": 1151789707,
    "node_id": "IC_kwDOB7jojM5EpuqL",
    "user": {
      "login": "lukehutch",
      "id": 811305,
      "node_id": "MDQ6VXNlcjgxMTMwNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/811305?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lukehutch",
      "html_url": "https://github.com/lukehutch",
      "followers_url": "https://api.github.com/users/lukehutch/followers",
      "following_url": "https://api.github.com/users/lukehutch/following{/other_user}",
      "gists_url": "https://api.github.com/users/lukehutch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lukehutch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lukehutch/subscriptions",
      "organizations_url": "https://api.github.com/users/lukehutch/orgs",
      "repos_url": "https://api.github.com/users/lukehutch/repos",
      "events_url": "https://api.github.com/users/lukehutch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lukehutch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-10T01:19:19Z",
    "updated_at": "2022-06-10T01:19:19Z",
    "author_association": "NONE",
    "body": "> Hi, we just released a beta version of a new plugin, `@nomicfoundation/hardhat-chai-matchers`. It should work as a drop-in replacement of hardhat-waffle, and (among other things) it fixes this issue. Check [this doc](https://nomiclabs.notion.site/Public-Hardhat-Chai-Matchers-11feb9185dd54591999f4e813f90c10c) if you are interested in giving it a try.\r\n\r\nI tried this out, but got the following warning, even though I removed `ethereum-waffle` as a dependency:\r\n\r\n```\r\nYou have both ethereum-waffle and @nomicfoundation/hardhat-chai-matchers installed. They don't work correctly together, so please make sure you only use one.\r\n\r\nWe recommend you migrate to @nomicfoundation/hardhat-chai-matchers.\r\n```\r\n\r\nand the following error\r\n\r\n```\r\nTypeError: Cannot destructure property 'deployContract' of 'waffle' as it is undefined\r\n```\r\n\r\nCan you please backport the fix for this substring match back to `hardhat-waffle`?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1151789707/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1152374483",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2234#issuecomment-1152374483",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234",
    "id": 1152374483,
    "node_id": "IC_kwDOB7jojM5Er9bT",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-10T13:40:12Z",
    "updated_at": "2022-06-10T13:40:12Z",
    "author_association": "MEMBER",
    "body": "> got the following warning, even though I removed `ethereum-waffle` as a dependency\r\n\r\nThat shouldn't happen. Is your repo public?\r\n\r\n> ```\r\n> TypeError: Cannot destructure property 'deployContract' of 'waffle' as it is undefined\r\n> ```\r\n\r\nIf you uninstalled `ethereum-waffle` and `@nomiclabs/hardhat-waffle` (which is what we suggest, so that's fine), then you'll get that error because waffle won't be there anymore. We don't have a `deployContract` function in our chai matchers because that's out of scope for that package. You can probably replace those with `const Contract = ethers.getContractFactory(\"Contract\")` and `Contract.deploy()`.\r\n\r\n> Can you please backport the fix for this substring match back to `hardhat-waffle`?\r\n\r\nUnfortunately, that's not an easy thing to do, so I don't think we'll have the bandwidth to do it.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1152374483/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1153633996",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2234#issuecomment-1153633996",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234",
    "id": 1153633996,
    "node_id": "IC_kwDOB7jojM5Eww7M",
    "user": {
      "login": "lukehutch",
      "id": 811305,
      "node_id": "MDQ6VXNlcjgxMTMwNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/811305?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lukehutch",
      "html_url": "https://github.com/lukehutch",
      "followers_url": "https://api.github.com/users/lukehutch/followers",
      "following_url": "https://api.github.com/users/lukehutch/following{/other_user}",
      "gists_url": "https://api.github.com/users/lukehutch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lukehutch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lukehutch/subscriptions",
      "organizations_url": "https://api.github.com/users/lukehutch/orgs",
      "repos_url": "https://api.github.com/users/lukehutch/repos",
      "events_url": "https://api.github.com/users/lukehutch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lukehutch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-13T08:33:04Z",
    "updated_at": "2022-06-13T08:33:04Z",
    "author_association": "NONE",
    "body": "> > got the following warning, even though I removed `ethereum-waffle` as a dependency\r\n> \r\n> That shouldn't happen. Is your repo public?\r\n\r\nMy repo is not public, sorry. It sounds like `ethereum-waffle` has to be uninstalled from npm modules, not just removed as a dependency? I just removed it as a dependency.\r\n\r\n> If you uninstalled `ethereum-waffle` and `@nomiclabs/hardhat-waffle` (which is what we suggest, so that's fine), then you'll get that error because waffle won't be there anymore. We don't have a `deployContract` function in our chai matchers because that's out of scope for that package. You can probably replace those with `const Contract = ethers.getContractFactory(\"Contract\")` and `Contract.deploy()`.\r\n\r\nOK, I'll work on porting to the newer framework. Thanks for the tips.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1153633996/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1154596865",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2234#issuecomment-1154596865",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234",
    "id": 1154596865,
    "node_id": "IC_kwDOB7jojM5E0cAB",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-14T00:55:34Z",
    "updated_at": "2022-06-14T00:55:34Z",
    "author_association": "MEMBER",
    "body": "> It sounds like `ethereum-waffle` has to be uninstalled from npm modules, not just removed as a dependency?\r\n\r\nCorrect, it should be uninstalled.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1154596865/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1156236986",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2234#issuecomment-1156236986",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234",
    "id": 1156236986,
    "node_id": "IC_kwDOB7jojM5E6sa6",
    "user": {
      "login": "lukehutch",
      "id": 811305,
      "node_id": "MDQ6VXNlcjgxMTMwNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/811305?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lukehutch",
      "html_url": "https://github.com/lukehutch",
      "followers_url": "https://api.github.com/users/lukehutch/followers",
      "following_url": "https://api.github.com/users/lukehutch/following{/other_user}",
      "gists_url": "https://api.github.com/users/lukehutch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lukehutch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lukehutch/subscriptions",
      "organizations_url": "https://api.github.com/users/lukehutch/orgs",
      "repos_url": "https://api.github.com/users/lukehutch/repos",
      "events_url": "https://api.github.com/users/lukehutch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lukehutch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-15T09:34:51Z",
    "updated_at": "2022-06-15T09:35:02Z",
    "author_association": "NONE",
    "body": "@fvictorio I had to install `ethereum-waffle` in both my project and for my user account to get this to work. Your porting tips worked. For the record (in case anyone else has the same porting issue), I was able to replace waffle's `deployContract` with:\r\n\r\n```\r\nasync function deployContract(wallet, contractJSON, constructorArgs) {\r\n    const instance = await ethers.ContractFactory.fromSolidity(contractJSON, wallet).deploy(...constructorArgs);\r\n    await instance.deployed();\r\n    return instance;\r\n}\r\n```\r\n\r\nThanks for your help!",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1156236986/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1156876866",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2234#issuecomment-1156876866",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234",
    "id": 1156876866,
    "node_id": "IC_kwDOB7jojM5E9IpC",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-15T20:01:16Z",
    "updated_at": "2022-06-15T20:01:16Z",
    "author_association": "MEMBER",
    "body": "> I had to install `ethereum-waffle` in both my project and for my user account to get this to work.\r\n\r\nI'm not sure I understood this, can you elaborate?\r\n\r\nAlso, if you have `ethereum-waffle` installed again, that means you are getting the warning all the time, which must be annoying. We might consider removing it (or adding some way to hide it via config) if it turns out that people can't just uninstall `ethereum-waffle` completely.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1156876866/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1157173824",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2234#issuecomment-1157173824",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234",
    "id": 1157173824,
    "node_id": "IC_kwDOB7jojM5E-RJA",
    "user": {
      "login": "lukehutch",
      "id": 811305,
      "node_id": "MDQ6VXNlcjgxMTMwNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/811305?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lukehutch",
      "html_url": "https://github.com/lukehutch",
      "followers_url": "https://api.github.com/users/lukehutch/followers",
      "following_url": "https://api.github.com/users/lukehutch/following{/other_user}",
      "gists_url": "https://api.github.com/users/lukehutch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lukehutch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lukehutch/subscriptions",
      "organizations_url": "https://api.github.com/users/lukehutch/orgs",
      "repos_url": "https://api.github.com/users/lukehutch/repos",
      "events_url": "https://api.github.com/users/lukehutch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lukehutch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-16T02:51:46Z",
    "updated_at": "2022-06-16T02:51:46Z",
    "author_association": "NONE",
    "body": "I tried uninstalling with `npm uninstall ethereum-waffle` inside my project, that didn't work (I still got the warning). So I tried `npm uninstall ethereum-waffle -D` and `npm uninstall ethereum-waffle -g`, that didn't work. I discovered I had another copy of the library in `~/node_modules`, and I couldn't figure out how to uninstall that, so I just removed all of `~/node_modules`. That still didn't fix the problem. Then I noticed that `npm uninstall` had left an empty directory at `MyProject/node_modules/@ethereum-waffle`, so I manually removed that. I was still seeing the warning. I did an `egrep -r` looking for it anywhere else, and I found that `hardhat-gas-reporter` and `solidity-coverage` both transitively depended upon `ethereum-waffle`. I tried removing these two dependencies from my project, and it still didn't fix it. I messed around some more, and I couldn't figure out any other way that `require.resolve` was finding `ethereum-waffle` -- so I modified the `require.resolve` source code to reveal where the module was found, and poof, magically the problem was resolved (it was a Heisenbug). Apparently there was some caching going on somewhere, and modifying that file invalidated the cache. It was a major headache to fix this though.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1157173824/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1157598555",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2234#issuecomment-1157598555",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234",
    "id": 1157598555,
    "node_id": "IC_kwDOB7jojM5E_41b",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-16T12:22:32Z",
    "updated_at": "2022-06-16T12:22:32Z",
    "author_association": "MEMBER",
    "body": "Ugh, yes, I think we should just drop that warning. Thanks a lot @lukehutch.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1157598555/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1186174952",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2234#issuecomment-1186174952",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234",
    "id": 1186174952,
    "node_id": "IC_kwDOB7jojM5Gs5fo",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-07-16T12:41:34Z",
    "updated_at": "2022-07-16T12:41:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue was marked as stale because it didn't have any activity in the last 30 days. If you think it's still relevant, please leave a comment indicating so. Otherwise, it will be closed in 7 days.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1186174952/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1186942258",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2234#issuecomment-1186942258",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2234",
    "id": 1186942258,
    "node_id": "IC_kwDOB7jojM5Gv00y",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-18T08:58:21Z",
    "updated_at": "2022-07-18T08:58:21Z",
    "author_association": "MEMBER",
    "body": "This works correctly in our new [hardhat-chai-matchers](https://hardhat.org/hardhat-chai-matchers/docs/overview). We don't have plans to backport this fix to hardhat-waffle, given that it's not a minor effort, but our chai matchers are a drop-in replacement so [migrating should be easy](https://hardhat.org/hardhat-chai-matchers/docs/migrate-from-waffle).",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1186942258/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
