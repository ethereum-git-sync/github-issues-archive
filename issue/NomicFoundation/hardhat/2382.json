{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2382",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2382/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2382/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2382/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/2382",
  "id": 1136556337,
  "node_id": "I_kwDOB7jojM5Dvnkx",
  "number": 2382,
  "title": "variable is not change.",
  "user": {
    "login": "DedicatedDev",
    "id": 62229912,
    "node_id": "MDQ6VXNlcjYyMjI5OTEy",
    "avatar_url": "https://avatars.githubusercontent.com/u/62229912?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/DedicatedDev",
    "html_url": "https://github.com/DedicatedDev",
    "followers_url": "https://api.github.com/users/DedicatedDev/followers",
    "following_url": "https://api.github.com/users/DedicatedDev/following{/other_user}",
    "gists_url": "https://api.github.com/users/DedicatedDev/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/DedicatedDev/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/DedicatedDev/subscriptions",
    "organizations_url": "https://api.github.com/users/DedicatedDev/orgs",
    "repos_url": "https://api.github.com/users/DedicatedDev/repos",
    "events_url": "https://api.github.com/users/DedicatedDev/events{/privacy}",
    "received_events_url": "https://api.github.com/users/DedicatedDev/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": true,
  "assignee": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-02-14T00:07:36Z",
  "updated_at": "2022-11-18T10:05:23Z",
  "closed_at": "2022-02-14T08:52:22Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "\"\"\"\r\n// SPDX-License-Identifier: MIT\r\npragma solidity ^0.8.7;\r\nimport \"hardhat/console.sol\";\r\ncontract Delegate {\r\n\r\n    address public owner;\r\n\r\n    constructor(address _owner)  {\r\n        owner = _owner;\r\n    }\r\n\r\n    function pwn() public {\r\n        owner = address(msg.sender);\r\n        console.log(\"owner:=>\",owner);\r\n    }\r\n}\r\n\r\ncontract Delegation {\r\n    address public owner;\r\n    Delegate private delegate;\r\n    constructor(address _delegateAddress) {\r\n        delegate = Delegate(_delegateAddress);\r\n        owner = msg.sender;\r\n    }\r\n\r\n    fallback() external {\r\n        console.log(\"Fallback is Calling\");\r\n        (bool result,) = address(delegate).delegatecall(msg.data);\r\n        if (result) {\r\n            this;\r\n        }\r\n        console.log(\"CurrentOwner:=>\", owner);\r\n    }\r\n}\r\n\"\"\"\r\n\r\nHere is my contract to  get ownership by fallback function. \r\nHere is test script. \r\n\"\"\"\r\nimport { SignerWithAddress } from \"@nomiclabs/hardhat-ethers/signers\"\r\nimport { expect } from \"chai\"\r\nimport { time } from \"console\"\r\nimport { keccak256 } from \"ethers/lib/utils\"\r\nimport { ethers } from \"hardhat\"\r\nimport { Delegate, Delegate__factory, Delegation, Delegation__factory } from \"../typechain\"\r\n\r\ndescribe(\"Delegation\",async()=>{\r\n    let DelegateFactory:Delegate__factory\r\n    let delegate:Delegate\r\n    let DelegationFactory:Delegation__factory\r\n    let delegation:Delegation\r\n    let accounts:SignerWithAddress[]\r\n\r\n    before(async()=>{\r\n        accounts = await ethers.getSigners()\r\n        DelegateFactory = await ethers.getContractFactory(\"Delegate\")\r\n        delegate = await DelegateFactory.deploy(accounts[0].address)\r\n        await delegate.deployed()\r\n        console.log(\"Deployed Owner\",await delegate.owner())\r\n\r\n        DelegationFactory = await ethers.getContractFactory(\"Delegation\")\r\n        delegation = await DelegationFactory.deploy(delegate.address)\r\n        await delegation.deployed()\r\n\r\n    })\r\n\r\n    it(\"Delegation\", async()=>{\r\n        let tx = await accounts[1].sendTransaction({\r\n            from:accounts[1].address,\r\n            to: delegation.address,\r\n            data:ethers.utils.solidityKeccak256(['string'],[\"pwn()\"]),\r\n        })\r\n        \r\n\r\n        const owner = await delegation.owner()\r\n\r\n        console.log(owner)\r\n        //expect(owner).to.equal(accounts[1].address)\r\n    })\r\n})\r\n\"\"\"\r\n\r\nconsole result shows owner value is changed already \r\nbut in test script  await delegation.owner() function still return original value. \r\nso I've defined getOwner function on contract like this. \r\n\"\"\"\r\n function getOwner() external view returns(address) {\r\n        return owner;\r\n    }\r\n\"\"\"\r\n\r\nif I call this function, it is returning correct changed value. \r\nnot sure why public variable call does not return correct value. \r\n\r\nThank you. ",
  "closed_by": {
    "login": "DedicatedDev",
    "id": 62229912,
    "node_id": "MDQ6VXNlcjYyMjI5OTEy",
    "avatar_url": "https://avatars.githubusercontent.com/u/62229912?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/DedicatedDev",
    "html_url": "https://github.com/DedicatedDev",
    "followers_url": "https://api.github.com/users/DedicatedDev/followers",
    "following_url": "https://api.github.com/users/DedicatedDev/following{/other_user}",
    "gists_url": "https://api.github.com/users/DedicatedDev/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/DedicatedDev/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/DedicatedDev/subscriptions",
    "organizations_url": "https://api.github.com/users/DedicatedDev/orgs",
    "repos_url": "https://api.github.com/users/DedicatedDev/repos",
    "events_url": "https://api.github.com/users/DedicatedDev/events{/privacy}",
    "received_events_url": "https://api.github.com/users/DedicatedDev/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2382/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2382/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1038708346",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2382#issuecomment-1038708346",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2382",
    "id": 1038708346,
    "node_id": "IC_kwDOB7jojM496W56",
    "user": {
      "login": "itsfloki",
      "id": 55863324,
      "node_id": "MDQ6VXNlcjU1ODYzMzI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/55863324?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/itsfloki",
      "html_url": "https://github.com/itsfloki",
      "followers_url": "https://api.github.com/users/itsfloki/followers",
      "following_url": "https://api.github.com/users/itsfloki/following{/other_user}",
      "gists_url": "https://api.github.com/users/itsfloki/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/itsfloki/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/itsfloki/subscriptions",
      "organizations_url": "https://api.github.com/users/itsfloki/orgs",
      "repos_url": "https://api.github.com/users/itsfloki/repos",
      "events_url": "https://api.github.com/users/itsfloki/events{/privacy}",
      "received_events_url": "https://api.github.com/users/itsfloki/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-14T06:41:52Z",
    "updated_at": "2022-02-14T06:41:52Z",
    "author_association": "NONE",
    "body": "I have tested your contract locally. Public variable owner call returned the changed value. Here see the below output.\r\n```\r\nDelegation\r\nDeployed Owner 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266\r\nFallback is Calling\r\nowner:=> 0x70997970c51812dc3a010c7d01b50e0d17dc79c8\r\nCurrentOwner:=> 0x70997970c51812dc3a010c7d01b50e0d17dc79c8\r\n0x70997970C51812dc3A010C7d01b50e0d17dc79C8\r\n    âˆš Delegation (97ms)\r\n\r\n\r\n  1 passing (973ms)\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1038708346/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1038814968",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/2382#issuecomment-1038814968",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/2382",
    "id": 1038814968,
    "node_id": "IC_kwDOB7jojM496w74",
    "user": {
      "login": "DedicatedDev",
      "id": 62229912,
      "node_id": "MDQ6VXNlcjYyMjI5OTEy",
      "avatar_url": "https://avatars.githubusercontent.com/u/62229912?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DedicatedDev",
      "html_url": "https://github.com/DedicatedDev",
      "followers_url": "https://api.github.com/users/DedicatedDev/followers",
      "following_url": "https://api.github.com/users/DedicatedDev/following{/other_user}",
      "gists_url": "https://api.github.com/users/DedicatedDev/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DedicatedDev/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DedicatedDev/subscriptions",
      "organizations_url": "https://api.github.com/users/DedicatedDev/orgs",
      "repos_url": "https://api.github.com/users/DedicatedDev/repos",
      "events_url": "https://api.github.com/users/DedicatedDev/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DedicatedDev/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-14T08:52:20Z",
    "updated_at": "2022-02-14T08:52:20Z",
    "author_association": "NONE",
    "body": "now it is working for me. I guess looking there are delay. \r\nSometimes, if I click npx run test, I'm seeing not updated result. \r\nThank you. ",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1038814968/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
