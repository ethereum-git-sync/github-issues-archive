{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3023",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3023/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3023/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3023/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/3023",
  "id": 1333377954,
  "node_id": "I_kwDOB7jojM5Pebui",
  "number": 3023,
  "title": "HH5: HardhatContext is not created (possible cause & solution)",
  "user": {
    "login": "FrozenKiwi",
    "id": 4876160,
    "node_id": "MDQ6VXNlcjQ4NzYxNjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4876160?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/FrozenKiwi",
    "html_url": "https://github.com/FrozenKiwi",
    "followers_url": "https://api.github.com/users/FrozenKiwi/followers",
    "following_url": "https://api.github.com/users/FrozenKiwi/following{/other_user}",
    "gists_url": "https://api.github.com/users/FrozenKiwi/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/FrozenKiwi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/FrozenKiwi/subscriptions",
    "organizations_url": "https://api.github.com/users/FrozenKiwi/orgs",
    "repos_url": "https://api.github.com/users/FrozenKiwi/repos",
    "events_url": "https://api.github.com/users/FrozenKiwi/events{/privacy}",
    "received_events_url": "https://api.github.com/users/FrozenKiwi/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-08-09T14:51:43Z",
  "updated_at": "2023-03-29T00:15:43Z",
  "closed_at": "2022-12-28T08:41:22Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "This isn't really a bug report, it just seemed the best place to put the info that might help someone.\r\n\r\nI got this error when creating my typescript ESM deploy script.  The cause is the specific order of imports.\r\n\r\nIn my `scripts/deploy.ts` file, I had the following includes:\r\n```\r\nimport hre from 'hardhat';\r\nimport '@nomiclabs/hardhat-ethers';\r\nimport '@openzeppelin/hardhat-upgrades';\r\n```\r\n(psuedo) package.json:\r\n```\r\n\"deploy\": \"yarn node ./scripts/deploy.ts\"\r\n```\r\nThis throws because the ethers & hardhat plugins are trying to access `hre` before it is created in the `hardhat` import.\r\n\r\nReversing the order of imports solves the problem.\r\n\r\nNOTES (Why am I importing these packages in the script file?)\r\n\r\nNormally, you don't need the `hardhat-ethers` and `hardhat-upgrades` imports in your script files, however with an ESM project there is a lot of fighting with module types.  If we keep our `hardhat.config.ts` file with the project, hardhat cannot `require` it because the whole folder is an ESM module (renaming to `.cts` did not solve theproblem).  To fix this, I moved the config file into my common `contract-tools` package that compiles as commonjs.  However, then the trick of adding the config to `tsconfig.json > files` attribute seems not to work.  Or at least, I couldn't seem to get it to play nice.  TSC compiles & runs fine, it's just VS Code that reports (false) errors.  To eliminate these annoying red squiggles, I added the imports here (node will ignore a re-import).\r\n\r\nAs hardhat doesn't support ESM modules (please support ESM!) this is more just a record in case anyone else stumbles down the same path.\r\n\r\n",
  "closed_by": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3023/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3023/timeline",
  "performed_via_github_app": null,
  "state_reason": "not_planned"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1209487537",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3023#issuecomment-1209487537",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3023",
    "id": 1209487537,
    "node_id": "IC_kwDOB7jojM5IF1Cx",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-08-09T14:52:44Z",
    "updated_at": "2022-08-09T14:52:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue is also being [tracked on Linear](https://linear.app/nomic-foundation/issue/HH-1023/hh5-hardhatcontext-is-not-created-possible-cause-and-solution).\n\nWe use Linear to manage our development process, but we keep the conversations on Github.\n\nLINEAR-ID: 60a44b94-21d5-4dc0-aded-5dc4f95b8c7f",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1209487537/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1209490839",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3023#issuecomment-1209490839",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3023",
    "id": 1209490839,
    "node_id": "IC_kwDOB7jojM5IF12X",
    "user": {
      "login": "alcuadrado",
      "id": 176499,
      "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alcuadrado",
      "html_url": "https://github.com/alcuadrado",
      "followers_url": "https://api.github.com/users/alcuadrado/followers",
      "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
      "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
      "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
      "repos_url": "https://api.github.com/users/alcuadrado/repos",
      "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-09T14:55:17Z",
    "updated_at": "2022-08-09T14:55:17Z",
    "author_association": "MEMBER",
    "body": "Thanks for opening this issue! It sheds some light on why some users import the plugins like that.\r\n\r\nRelated to the discussion happening here: https://github.com/NomicFoundation/hardhat/issues/2945",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1209490839/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1366470508",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3023#issuecomment-1366470508",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3023",
    "id": 1366470508,
    "node_id": "IC_kwDOB7jojM5Rcq9s",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-28T08:41:22Z",
    "updated_at": "2022-12-28T08:41:22Z",
    "author_association": "MEMBER",
    "body": "Closing this in favor of https://github.com/NomicFoundation/hardhat/issues/3385",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1366470508/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
