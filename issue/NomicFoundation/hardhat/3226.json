{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/3226",
  "id": 1391121357,
  "node_id": "I_kwDOB7jojM5S6tPN",
  "number": 3226,
  "title": "Hardhat dependency on local installation",
  "user": {
    "login": "arijoon",
    "id": 6129983,
    "node_id": "MDQ6VXNlcjYxMjk5ODM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6129983?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/arijoon",
    "html_url": "https://github.com/arijoon",
    "followers_url": "https://api.github.com/users/arijoon/followers",
    "following_url": "https://api.github.com/users/arijoon/following{/other_user}",
    "gists_url": "https://api.github.com/users/arijoon/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/arijoon/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/arijoon/subscriptions",
    "organizations_url": "https://api.github.com/users/arijoon/orgs",
    "repos_url": "https://api.github.com/users/arijoon/repos",
    "events_url": "https://api.github.com/users/arijoon/events{/privacy}",
    "received_events_url": "https://api.github.com/users/arijoon/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 4937720577,
      "node_id": "LA_kwDOB7jojM8AAAABJk-jAQ",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/status:ready",
      "name": "status:ready",
      "color": "0E8A16",
      "default": false,
      "description": "This issue is ready to be worked on"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 14,
  "created_at": "2022-09-29T16:03:11Z",
  "updated_at": "2023-01-11T11:29:32Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "**Issue**\r\n\r\nHardhat requires the real path of the module to be under the current project. This limitation could be in contradiction with some usecases. For example if building each dependency with `nix` as a derivation, hardhat module will be an absolute path defined in `pnp.js` to its derivation (or it'll be a simlink in `node_modules` if not using yarn berry)\r\n\r\nI have found and removed [this check](https://github.com/NomicFoundation/hardhat/blob/c89d933b23d09fb14ee87bf133faaf4a8cee0989/packages/hardhat-core/src/internal/cli/cli.ts#L174-L176) for our usecase, however would like to understand the reasoning behind it existing in the first place. Once understood, I can make a PR to allow for additional methods to address any feature that requires this (e.g. if you need to find something else's path relative to hardhat module, we can allow an env variable to be passed as replacement)\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1262491660",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3226#issuecomment-1262491660",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226",
    "id": 1262491660,
    "node_id": "IC_kwDOB7jojM5LQBgM",
    "user": {
      "login": "github-actions[bot]",
      "id": 41898282,
      "node_id": "MDM6Qm90NDE4OTgyODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/github-actions%5Bbot%5D",
      "html_url": "https://github.com/apps/github-actions",
      "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2022-09-29T16:03:37Z",
    "updated_at": "2022-09-29T16:03:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "This issue is also being [tracked on Linear](https://linear.app/nomic-foundation/issue/HH-1222/hardhat-dependency-on-local-installation-[nomicfoundationhardhat3226]).\n\nWe use Linear to manage our development process, but we keep the conversations on Github.\n\nLINEAR-ID: 55e5e59e-5541-4dfc-a209-07a63d8b7920",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1262491660/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1263474973",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3226#issuecomment-1263474973",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226",
    "id": 1263474973,
    "node_id": "IC_kwDOB7jojM5LTxkd",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-30T11:52:03Z",
    "updated_at": "2022-09-30T11:52:03Z",
    "author_association": "MEMBER",
    "body": "IIRC, it's meant to prevent people from using a globally installed version of Hardhat, since that can cause issues if you then install the plugins locally.\r\n\r\nYour use case seems reasonable to me though. I think we could have an escape hatch for this, but it should be a somewhat advanced (and not documented) mechanism. Maybe an environment variable like `__HARDHAT_ALLOW_NON_LOCAL_INSTALLATION=true`?\r\n\r\n@alcuadrado wdyt?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1263474973/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1263598061",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3226#issuecomment-1263598061",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226",
    "id": 1263598061,
    "node_id": "IC_kwDOB7jojM5LUPnt",
    "user": {
      "login": "alcuadrado",
      "id": 176499,
      "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alcuadrado",
      "html_url": "https://github.com/alcuadrado",
      "followers_url": "https://api.github.com/users/alcuadrado/followers",
      "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
      "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
      "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
      "repos_url": "https://api.github.com/users/alcuadrado/repos",
      "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-30T13:46:24Z",
    "updated_at": "2022-09-30T13:46:24Z",
    "author_association": "MEMBER",
    "body": "The first few versions of Buidler tried to allow global installations, which lead to users doing things like:\r\n\r\n* install hardhat globally\r\n* install plugins locally\r\n* plugins `require`ing `hardhat`\r\n* error\r\n\r\n> Hardhat requires the real path of the module to be under the current project.\r\n\r\nI agree that this check is too strict. Any idea on how to remove it and still rule out global installations?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1263598061/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1263615856",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3226#issuecomment-1263615856",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226",
    "id": 1263615856,
    "node_id": "IC_kwDOB7jojM5LUT9w",
    "user": {
      "login": "arijoon",
      "id": 6129983,
      "node_id": "MDQ6VXNlcjYxMjk5ODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6129983?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arijoon",
      "html_url": "https://github.com/arijoon",
      "followers_url": "https://api.github.com/users/arijoon/followers",
      "following_url": "https://api.github.com/users/arijoon/following{/other_user}",
      "gists_url": "https://api.github.com/users/arijoon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arijoon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arijoon/subscriptions",
      "organizations_url": "https://api.github.com/users/arijoon/orgs",
      "repos_url": "https://api.github.com/users/arijoon/repos",
      "events_url": "https://api.github.com/users/arijoon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arijoon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-30T14:01:37Z",
    "updated_at": "2022-09-30T14:25:47Z",
    "author_association": "CONTRIBUTOR",
    "body": ">  agree that this check is too strict. Any idea on how to remove it and still rule out global installations?\r\n\r\nCan do something similar to yarn v3's checks. It no longer allows a package to be required if its not defined in `package.json`. So you can read the project's package.json and ensure there is a hardhat dependency or devDependency set. \r\n\r\nIf this is only for plugins, I would still recommend this check to be a warning or have an env var that sets the path of `package.json` if in some edge cases it is not correctly resolved",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1263615856/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1263879894",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3226#issuecomment-1263879894",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226",
    "id": 1263879894,
    "node_id": "IC_kwDOB7jojM5LVUbW",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-30T18:19:29Z",
    "updated_at": "2022-09-30T18:19:29Z",
    "author_association": "MEMBER",
    "body": "What about doing: `require.resolve(\"hardhat\", { paths: [process.cwd()] })` to check if Hardhat is available?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1263879894/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1263883795",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3226#issuecomment-1263883795",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226",
    "id": 1263883795,
    "node_id": "IC_kwDOB7jojM5LVVYT",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-30T18:23:13Z",
    "updated_at": "2022-09-30T18:23:13Z",
    "author_association": "MEMBER",
    "body": "Oh, that's exactly what we are doing now :man_facepalming: But in that case I don't understand why it works for you after removing the check @arijoon. If you can't `require(\"hardhat\")` then tests/scripts won't work?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1263883795/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1265097952",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3226#issuecomment-1265097952",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226",
    "id": 1265097952,
    "node_id": "IC_kwDOB7jojM5LZ9zg",
    "user": {
      "login": "arijoon",
      "id": 6129983,
      "node_id": "MDQ6VXNlcjYxMjk5ODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6129983?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arijoon",
      "html_url": "https://github.com/arijoon",
      "followers_url": "https://api.github.com/users/arijoon/followers",
      "following_url": "https://api.github.com/users/arijoon/following{/other_user}",
      "gists_url": "https://api.github.com/users/arijoon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arijoon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arijoon/subscriptions",
      "organizations_url": "https://api.github.com/users/arijoon/orgs",
      "repos_url": "https://api.github.com/users/arijoon/repos",
      "events_url": "https://api.github.com/users/arijoon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arijoon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-03T08:21:25Z",
    "updated_at": "2022-10-03T08:21:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Oh, that's exactly what we are doing now man_facepalming But in that case I don't understand why it works for you after removing the check @arijoon. If you can't require(\"hardhat\") then tests/scripts won't work?\r\n\r\nI can `require('hardhat')`, since it is installed for the project, just not in a sub-directory of the project. The current check asserts location of the hardhat package.json, but we can simply assert whether the current project, has a `hardhat` dependency in its package.json and ignore its real path",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1265097952/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1283781207",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3226#issuecomment-1283781207",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226",
    "id": 1283781207,
    "node_id": "IC_kwDOB7jojM5MhPJX",
    "user": {
      "login": "arijoon",
      "id": 6129983,
      "node_id": "MDQ6VXNlcjYxMjk5ODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6129983?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arijoon",
      "html_url": "https://github.com/arijoon",
      "followers_url": "https://api.github.com/users/arijoon/followers",
      "following_url": "https://api.github.com/users/arijoon/following{/other_user}",
      "gists_url": "https://api.github.com/users/arijoon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arijoon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arijoon/subscriptions",
      "organizations_url": "https://api.github.com/users/arijoon/orgs",
      "repos_url": "https://api.github.com/users/arijoon/repos",
      "events_url": "https://api.github.com/users/arijoon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arijoon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-19T10:27:58Z",
    "updated_at": "2022-10-19T10:27:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "I was unable to find a way of implementing my suggestion above, for the meantime added a skip env variable:\r\nhttps://github.com/NomicFoundation/hardhat/pull/3283\r\n\r\nas commented in the PR, I would highly suggest the check is completely removed, it serves little purpose to restrict the cli in case there'll be a plugin error (the check is too strict and implementation doesn't cover all cases of local installation)",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1283781207/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1365892203",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3226#issuecomment-1365892203",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226",
    "id": 1365892203,
    "node_id": "IC_kwDOB7jojM5Radxr",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-27T13:12:26Z",
    "updated_at": "2022-12-27T13:12:26Z",
    "author_association": "MEMBER",
    "body": "Hey @arijoon, I'm trying to get this issue to an actionable state. For that, I think we should have some minimal way to get the false positive in that check. You mentioned that you are using `nix`. Any chance to create a minimal example, or at least to tell me how to create one?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1365892203/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1377069131",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3226#issuecomment-1377069131",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226",
    "id": 1377069131,
    "node_id": "IC_kwDOB7jojM5SFGhL",
    "user": {
      "login": "arijoon",
      "id": 6129983,
      "node_id": "MDQ6VXNlcjYxMjk5ODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6129983?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arijoon",
      "html_url": "https://github.com/arijoon",
      "followers_url": "https://api.github.com/users/arijoon/followers",
      "following_url": "https://api.github.com/users/arijoon/following{/other_user}",
      "gists_url": "https://api.github.com/users/arijoon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arijoon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arijoon/subscriptions",
      "organizations_url": "https://api.github.com/users/arijoon/orgs",
      "repos_url": "https://api.github.com/users/arijoon/repos",
      "events_url": "https://api.github.com/users/arijoon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arijoon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-10T10:51:00Z",
    "updated_at": "2023-01-10T11:00:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Hey @arijoon, I'm trying to get this issue to an actionable state. For that, I think we should have some minimal way to get the false positive in that check. You mentioned that you are using `nix`. Any chance to create a minimal example, or at least to tell me how to create one?\r\n\r\nI can attempt to create a minimal example, but can describe a simpler flow to reproduce scenario for this case. \r\n\r\n### Using Node modules\r\n\r\nMove the `node_modules` folder to another directory outside the project using hardhat and then symlink to it\r\n\r\n### Using Yarn Berry (we use this method)\r\n\r\nModify the pnp.cjs file to point to the hardhat package outside the project directory, should also be achievable by changing the yarn cache directory to be outside the project\r\n\r\nI will try to create a public repo with a reproducible case using nix for you, but provided above information in the meantime. Effectively this issue can be caused if the module code itself is located elsewhere on the system and linked to either via node_modules or the pnp file. This means theoretically there is no way to get the running module's location from hardhat's package location as they could have no relation. I'm unsure if it is even possible to fetch the module that has required hardhat from within hardhat code",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1377069131/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1377078087",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3226#issuecomment-1377078087",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226",
    "id": 1377078087,
    "node_id": "IC_kwDOB7jojM5SFItH",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-10T10:58:37Z",
    "updated_at": "2023-01-10T10:58:37Z",
    "author_association": "MEMBER",
    "body": "Thank you @arijoon, that's super useful :smiling_face_with_three_hearts: ",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1377078087/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1378356298",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3226#issuecomment-1378356298",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226",
    "id": 1378356298,
    "node_id": "IC_kwDOB7jojM5SKAxK",
    "user": {
      "login": "null-prophet",
      "id": 83577435,
      "node_id": "MDQ6VXNlcjgzNTc3NDM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/83577435?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/null-prophet",
      "html_url": "https://github.com/null-prophet",
      "followers_url": "https://api.github.com/users/null-prophet/followers",
      "following_url": "https://api.github.com/users/null-prophet/following{/other_user}",
      "gists_url": "https://api.github.com/users/null-prophet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/null-prophet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/null-prophet/subscriptions",
      "organizations_url": "https://api.github.com/users/null-prophet/orgs",
      "repos_url": "https://api.github.com/users/null-prophet/repos",
      "events_url": "https://api.github.com/users/null-prophet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/null-prophet/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-11T07:50:26Z",
    "updated_at": "2023-01-11T07:50:50Z",
    "author_association": "NONE",
    "body": "I have a similar issue using `yarn 3.3.0`\r\n\r\nI ended up using `.yarnrc.yml` with:\r\n\r\n```\r\nnodeLinker: \"node-modules\"\r\n```\r\n\r\nNow this works for a template that uses hardhat traditionally (like the [hh-deploy-template](https://github.com/wighawag/template-ethereum-contracts)\r\n\r\nBut I couldn't get that working with the newer toolbox style install. Even after doing a `yarn init -2` then doing the nxp hardhat call to install.\r\n\r\nI think your going to have to look at supporting these newer tools for package management as the instructions on your site right now for yarn are only going to work on older versions (v1.x). Or you will have to tell people not to use them. I spent a few hours yesterday trying this out and couldn't get it working with the site install docs.\r\n\r\nI don't think putting escape flags in is a good idea either. supporting zero installs or explicitly telling people how to configure yarn is your best bet.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1378356298/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1378511090",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3226#issuecomment-1378511090",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226",
    "id": 1378511090,
    "node_id": "IC_kwDOB7jojM5SKmjy",
    "user": {
      "login": "arijoon",
      "id": 6129983,
      "node_id": "MDQ6VXNlcjYxMjk5ODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6129983?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/arijoon",
      "html_url": "https://github.com/arijoon",
      "followers_url": "https://api.github.com/users/arijoon/followers",
      "following_url": "https://api.github.com/users/arijoon/following{/other_user}",
      "gists_url": "https://api.github.com/users/arijoon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/arijoon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/arijoon/subscriptions",
      "organizations_url": "https://api.github.com/users/arijoon/orgs",
      "repos_url": "https://api.github.com/users/arijoon/repos",
      "events_url": "https://api.github.com/users/arijoon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/arijoon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-11T10:07:39Z",
    "updated_at": "2023-01-11T10:07:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "Interestingly I'm **unable** to reproduce this now on a clean repo, unsure on the exact condition that caused it before but here is a working example: https://github.com/arijoon/hardhat-reproduce-local (using yarn berry and nix) which is behaving as expected without the local installation error. \r\nI wonder if it only happens with `node_modules`, will update again if I managed to reproduce this",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1378511090/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1378610255",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/3226#issuecomment-1378610255",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/3226",
    "id": 1378610255,
    "node_id": "IC_kwDOB7jojM5SK-xP",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-11T11:29:32Z",
    "updated_at": "2023-01-11T11:29:32Z",
    "author_association": "MEMBER",
    "body": "Thanks @null-prophet, I agree that our docs are not clear about the fact that we mean yarn v1. I think it's super unfortunate that yarn v2 didn't use a different name, since it's a completely different package manager. But I guess we just have to deal with that.\r\n\r\nAnyway, I opened #3565 as a main tracking issue for this. I believe we'll need several interrelated changes (docs, project initialization, better errors) to improve this experience.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1378610255/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
