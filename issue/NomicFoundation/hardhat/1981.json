{
  "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981",
  "repository_url": "https://api.github.com/repos/NomicFoundation/hardhat",
  "labels_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981/labels{/name}",
  "comments_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981/comments",
  "events_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981/events",
  "html_url": "https://github.com/NomicFoundation/hardhat/issues/1981",
  "id": 1033732174,
  "node_id": "I_kwDOB7jojM49nYBO",
  "number": 1981,
  "title": "Implement personal_sign in Hardhat Network",
  "user": {
    "login": "alcuadrado",
    "id": 176499,
    "node_id": "MDQ6VXNlcjE3NjQ5OQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/176499?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/alcuadrado",
    "html_url": "https://github.com/alcuadrado",
    "followers_url": "https://api.github.com/users/alcuadrado/followers",
    "following_url": "https://api.github.com/users/alcuadrado/following{/other_user}",
    "gists_url": "https://api.github.com/users/alcuadrado/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/alcuadrado/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/alcuadrado/subscriptions",
    "organizations_url": "https://api.github.com/users/alcuadrado/orgs",
    "repos_url": "https://api.github.com/users/alcuadrado/repos",
    "events_url": "https://api.github.com/users/alcuadrado/events{/privacy}",
    "received_events_url": "https://api.github.com/users/alcuadrado/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 947232611,
      "node_id": "MDU6TGFiZWw5NDcyMzI2MTE=",
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/labels/type:feature",
      "name": "type:feature",
      "color": "FBCA04",
      "default": false,
      "description": "Feature request"
    }
  ],
  "state": "closed",
  "locked": true,
  "assignee": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 13,
  "created_at": "2021-10-22T15:59:23Z",
  "updated_at": "2022-11-17T21:12:20Z",
  "closed_at": "2021-11-04T21:54:59Z",
  "author_association": "MEMBER",
  "active_lock_reason": "resolved",
  "body": "As mentioned in #1972, ethers now uses this method, so we should implement it now.",
  "closed_by": {
    "login": "fvictorio",
    "id": 417134,
    "node_id": "MDQ6VXNlcjQxNzEzNA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fvictorio",
    "html_url": "https://github.com/fvictorio",
    "followers_url": "https://api.github.com/users/fvictorio/followers",
    "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
    "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
    "organizations_url": "https://api.github.com/users/fvictorio/orgs",
    "repos_url": "https://api.github.com/users/fvictorio/repos",
    "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fvictorio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981/reactions",
    "total_count": 4,
    "+1": 4,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/951138737",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1981#issuecomment-951138737",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981",
    "id": 951138737,
    "node_id": "IC_kwDOB7jojM44sTmx",
    "user": {
      "login": "mds1",
      "id": 17163988,
      "node_id": "MDQ6VXNlcjE3MTYzOTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mds1",
      "html_url": "https://github.com/mds1",
      "followers_url": "https://api.github.com/users/mds1/followers",
      "following_url": "https://api.github.com/users/mds1/following{/other_user}",
      "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
      "organizations_url": "https://api.github.com/users/mds1/orgs",
      "repos_url": "https://api.github.com/users/mds1/repos",
      "events_url": "https://api.github.com/users/mds1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mds1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-25T17:20:21Z",
    "updated_at": "2021-10-25T17:20:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "Just curious if you have an estimated timeline for implementing `personal_sign`? ðŸ™‚",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/951138737/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/951202004",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1981#issuecomment-951202004",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981",
    "id": 951202004,
    "node_id": "IC_kwDOB7jojM44sjDU",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-25T18:41:26Z",
    "updated_at": "2021-10-25T18:41:26Z",
    "author_association": "MEMBER",
    "body": "Hey @mds1, I'll try to add it this week, it shouldn't be too hard.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/951202004/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/951203242",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1981#issuecomment-951203242",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981",
    "id": 951203242,
    "node_id": "IC_kwDOB7jojM44sjWq",
    "user": {
      "login": "mds1",
      "id": 17163988,
      "node_id": "MDQ6VXNlcjE3MTYzOTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mds1",
      "html_url": "https://github.com/mds1",
      "followers_url": "https://api.github.com/users/mds1/followers",
      "following_url": "https://api.github.com/users/mds1/following{/other_user}",
      "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
      "organizations_url": "https://api.github.com/users/mds1/orgs",
      "repos_url": "https://api.github.com/users/mds1/repos",
      "events_url": "https://api.github.com/users/mds1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mds1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-25T18:42:52Z",
    "updated_at": "2021-10-25T18:42:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "Awesome, thanks a lot!",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/951203242/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/961461409",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1981#issuecomment-961461409",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981",
    "id": 961461409,
    "node_id": "IC_kwDOB7jojM45Tryh",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-04T21:54:59Z",
    "updated_at": "2021-11-04T21:54:59Z",
    "author_association": "MEMBER",
    "body": "Added in `hardhat@2.6.8`.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/961461409/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/961920018",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1981#issuecomment-961920018",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981",
    "id": 961920018,
    "node_id": "IC_kwDOB7jojM45VbwS",
    "user": {
      "login": "mds1",
      "id": 17163988,
      "node_id": "MDQ6VXNlcjE3MTYzOTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mds1",
      "html_url": "https://github.com/mds1",
      "followers_url": "https://api.github.com/users/mds1/followers",
      "following_url": "https://api.github.com/users/mds1/following{/other_user}",
      "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
      "organizations_url": "https://api.github.com/users/mds1/orgs",
      "repos_url": "https://api.github.com/users/mds1/repos",
      "events_url": "https://api.github.com/users/mds1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mds1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-05T14:01:39Z",
    "updated_at": "2021-11-05T14:01:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "It seems this is only supported for signers included in the default hardhat config, which makes sense. I have some fuzz tests that use ethers' `Wallet.createRandom()` to generate random wallets to sign with `personal_sign`, and impersonating them is of course not sufficient since the provider doesn't have the private key. \r\n\r\nI could increase the number of initial accounts or randomize the mnemonic/path used, but this feels a little clunky. One solution is to update `hardhat_impersonateAccount` to take a private key instead of an address, but curious if you had any other thoughts",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/961920018/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/961922711",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1981#issuecomment-961922711",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981",
    "id": 961922711,
    "node_id": "IC_kwDOB7jojM45VcaX",
    "user": {
      "login": "mds1",
      "id": 17163988,
      "node_id": "MDQ6VXNlcjE3MTYzOTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mds1",
      "html_url": "https://github.com/mds1",
      "followers_url": "https://api.github.com/users/mds1/followers",
      "following_url": "https://api.github.com/users/mds1/following{/other_user}",
      "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
      "organizations_url": "https://api.github.com/users/mds1/orgs",
      "repos_url": "https://api.github.com/users/mds1/repos",
      "events_url": "https://api.github.com/users/mds1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mds1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-05T14:05:10Z",
    "updated_at": "2021-11-05T14:05:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "Worth noting that these tests were previously using `wallet.signMessage`, which it seems did not require a request to the provider, so there might be a workaround within ethers that I should look into also",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/961922711/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/962143139",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1981#issuecomment-962143139",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981",
    "id": 962143139,
    "node_id": "IC_kwDOB7jojM45WSOj",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-05T19:02:47Z",
    "updated_at": "2021-11-05T19:02:47Z",
    "author_association": "MEMBER",
    "body": "@mds1 My guess is that you are doing something like this, right?\r\n\r\n```js\r\nwallet = ethers.Wallet.createRandom()\r\nawait hre.network.provider.send(\"hardhat_impersonateAccount\", [wallet.address])\r\nsigner = await ethers.getSigner(wallet.address)\r\nsignedMessage = await signer.signMessage(\"foo\")\r\n```\r\n\r\nIn that case, no, this won't work. But if you use `wallet.signMessage` instead, that will work because the wallet has access to the private key.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/962143139/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/962164329",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1981#issuecomment-962164329",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981",
    "id": 962164329,
    "node_id": "IC_kwDOB7jojM45WXZp",
    "user": {
      "login": "mds1",
      "id": 17163988,
      "node_id": "MDQ6VXNlcjE3MTYzOTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mds1",
      "html_url": "https://github.com/mds1",
      "followers_url": "https://api.github.com/users/mds1/followers",
      "following_url": "https://api.github.com/users/mds1/following{/other_user}",
      "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
      "organizations_url": "https://api.github.com/users/mds1/orgs",
      "repos_url": "https://api.github.com/users/mds1/repos",
      "events_url": "https://api.github.com/users/mds1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mds1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-05T19:31:51Z",
    "updated_at": "2021-11-05T19:31:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yep, that's what I'm doing and totally understand why it doesn't work!\r\n\r\nMainly asked about impersonating via private key or other ideas because I thought `signMessage` didn't add the message prefix, whereas `personal_sign` does, so they'd give different signatures. Though maybe the behavior of `signMessage` has changed since I last looked",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/962164329/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/963140507",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1981#issuecomment-963140507",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981",
    "id": 963140507,
    "node_id": "IC_kwDOB7jojM45aFub",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-08T13:16:38Z",
    "updated_at": "2021-11-08T13:16:38Z",
    "author_association": "MEMBER",
    "body": "Hmm, I get the same result if I use the default signer (which uses `personal_sign`) and if I create a wallet with the private key of that signer and sign the same message.",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/963140507/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/966514426",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1981#issuecomment-966514426",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981",
    "id": 966514426,
    "node_id": "IC_kwDOB7jojM45m9b6",
    "user": {
      "login": "mds1",
      "id": 17163988,
      "node_id": "MDQ6VXNlcjE3MTYzOTg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17163988?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mds1",
      "html_url": "https://github.com/mds1",
      "followers_url": "https://api.github.com/users/mds1/followers",
      "following_url": "https://api.github.com/users/mds1/following{/other_user}",
      "gists_url": "https://api.github.com/users/mds1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mds1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mds1/subscriptions",
      "organizations_url": "https://api.github.com/users/mds1/orgs",
      "repos_url": "https://api.github.com/users/mds1/repos",
      "events_url": "https://api.github.com/users/mds1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mds1/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-11T18:08:54Z",
    "updated_at": "2021-11-11T18:11:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "Ah ok, so I looked at the code and (1) the Hardhat implementation of `eth_sign`, (2) the Hardhat implementation of `personal_sign`, and (3) ethers' `signMessage`, all add the message prefix. (Not all `eth_sign` implementations add the prefix).\r\n\r\nAs a result, these three signing approaches are all equivalent with Hardhat + ethers\r\n\r\n```typescript\r\n// hardhat account 0 with default mnemonic and path path: \"m/44'/60'/1'/0\"\r\nconst signerE = new ethers.Wallet('0x7797c0f3db8b946604ec2039dfd9763e4ffdc53174342a2ed9b14fa3eda666a5'); \r\nconst [signerH] = await ethers.getSigners();\r\nif (signerH.address !== signerE.address) throw new Error('Address mismatch');\r\n\r\nconst provider = ethers.provider;\r\nconst { hexlify, toUtf8Bytes } = ethers.utils;\r\n\r\nconst message = 'Sign this message to access your account';\r\nconst formattedMessage = hexlify(toUtf8Bytes(message));\r\nconst addr = signerH.address.toLowerCase()\r\n\r\nconst sigH_ps = String(await provider.send('personal_sign', [formattedMessage, addr]));\r\nconst sigH_es = String(await provider.send('eth_sign', [addr, formattedMessage]));\r\nconst sigE = String(await signerE.signMessage(message));\r\n\r\nconsole.log('sig hardhat personal_sign: ', sigH_ps);\r\nconsole.log('sig hardhat eth_sign:      ', sigH_es);\r\nconsole.log('sig ethers signMessage:    ', sigE);\r\n```\r\n\r\nSo you are right, I can just continue to use ethers' `signMessage` here. Though the JS library being tested uses `provider.send('personal_sign')` since it doesn't have access a user's private key, so I'll just only sign from accounts the hardhat node is aware of. Thanks a lot @fvictorio!",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/966514426/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1218664218",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1981#issuecomment-1218664218",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981",
    "id": 1218664218,
    "node_id": "IC_kwDOB7jojM5Io1ca",
    "user": {
      "login": "BKopyIo",
      "id": 111377116,
      "node_id": "U_kgDOBqN63A",
      "avatar_url": "https://avatars.githubusercontent.com/u/111377116?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BKopyIo",
      "html_url": "https://github.com/BKopyIo",
      "followers_url": "https://api.github.com/users/BKopyIo/followers",
      "following_url": "https://api.github.com/users/BKopyIo/following{/other_user}",
      "gists_url": "https://api.github.com/users/BKopyIo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BKopyIo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BKopyIo/subscriptions",
      "organizations_url": "https://api.github.com/users/BKopyIo/orgs",
      "repos_url": "https://api.github.com/users/BKopyIo/repos",
      "events_url": "https://api.github.com/users/BKopyIo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BKopyIo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-17T23:38:27Z",
    "updated_at": "2022-08-17T23:38:27Z",
    "author_association": "NONE",
    "body": "is there some reason why signMessage works in tests on the transient node, but fails with \"personal_sign - Method not supported\" when run on a localhost persistent node?\r\n\r\nIn my tests I use `let sig = await signer.signMessage(ethers.utils.arrayify(hashSource));`\r\n\r\nwhich works fine when I run it a spec with hh test;\r\nbut when I use the same thing with `run script/test.ts --network localhost` I get all this:\r\n\r\n`ProviderError: Method personal_sign not found\r\n    at HttpProvider.request (/Users/joshkramer/Documents/VSCodeProjects/BKopy/bkopy-embedded-contracts/node_modules/hardhat/src/internal/core/providers/http.ts:78:19)\r\n    at AutomaticSenderProvider.request (/Users/joshkramer/Documents/VSCodeProjects/BKopy/bkopy-embedded-contracts/node_modules/hardhat/src/internal/core/providers/accounts.ts:351:34)\r\n    at AutomaticGasProvider.request (/Users/joshkramer/Documents/VSCodeProjects/BKopy/bkopy-embedded-contracts/node_modules/hardhat/src/internal/core/providers/gas-providers.ts:136:34)\r\n    at AutomaticGasPriceProvider.request (/Users/joshkramer/Documents/VSCodeProjects/BKopy/bkopy-embedded-contracts/node_modules/hardhat/src/internal/core/providers/gas-providers.ts:153:36)\r\n    at BackwardsCompatibilityProviderAdapter.send (/Users/joshkramer/Documents/VSCodeProjects/BKopy/bkopy-embedded-contracts/node_modules/hardhat/src/internal/core/providers/backwards-compatibility.ts:36:27)\r\n    at EthersProviderWrapper.send (/Users/joshkramer/Documents/VSCodeProjects/BKopy/bkopy-embedded-contracts/node_modules/@nomiclabs/hardhat-ethers/src/internal/ethers-provider-wrapper.ts:13:48)\r\n    at JsonRpcSigner.<anonymous> (/Users/joshkramer/Documents/VSCodeProjects/BKopy/bkopy-embedded-contracts/node_modules/@ethersproject/providers/src.ts/json-rpc-provider.ts:295:36)\r\n    at step (/Users/joshkramer/Documents/VSCodeProjects/BKopy/bkopy-embedded-contracts/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:48:23)\r\n    at Object.next (/Users/joshkramer/Documents/VSCodeProjects/BKopy/bkopy-embedded-contracts/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:29:53)\r\n    at fulfilled (/Users/joshkramer/Documents/VSCodeProjects/BKopy/bkopy-embedded-contracts/node_modules/@ethersproject/providers/lib/json-rpc-provider.js:20:58)`\r\n\r\n\r\n\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1218664218/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1219321295",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1981#issuecomment-1219321295",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981",
    "id": 1219321295,
    "node_id": "IC_kwDOB7jojM5IrV3P",
    "user": {
      "login": "fvictorio",
      "id": 417134,
      "node_id": "MDQ6VXNlcjQxNzEzNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417134?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fvictorio",
      "html_url": "https://github.com/fvictorio",
      "followers_url": "https://api.github.com/users/fvictorio/followers",
      "following_url": "https://api.github.com/users/fvictorio/following{/other_user}",
      "gists_url": "https://api.github.com/users/fvictorio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fvictorio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fvictorio/subscriptions",
      "organizations_url": "https://api.github.com/users/fvictorio/orgs",
      "repos_url": "https://api.github.com/users/fvictorio/repos",
      "events_url": "https://api.github.com/users/fvictorio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fvictorio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-18T10:27:58Z",
    "updated_at": "2022-08-18T10:27:58Z",
    "author_association": "MEMBER",
    "body": "@BKopyIo I started a `npx hardhat node` and then connected to it with `--network localhost` and the method is present. Maybe you are connecting to a different node?",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1219321295/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1220106708",
    "html_url": "https://github.com/NomicFoundation/hardhat/issues/1981#issuecomment-1220106708",
    "issue_url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/1981",
    "id": 1220106708,
    "node_id": "IC_kwDOB7jojM5IuVnU",
    "user": {
      "login": "BKopyIo",
      "id": 111377116,
      "node_id": "U_kgDOBqN63A",
      "avatar_url": "https://avatars.githubusercontent.com/u/111377116?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BKopyIo",
      "html_url": "https://github.com/BKopyIo",
      "followers_url": "https://api.github.com/users/BKopyIo/followers",
      "following_url": "https://api.github.com/users/BKopyIo/following{/other_user}",
      "gists_url": "https://api.github.com/users/BKopyIo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BKopyIo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BKopyIo/subscriptions",
      "organizations_url": "https://api.github.com/users/BKopyIo/orgs",
      "repos_url": "https://api.github.com/users/BKopyIo/repos",
      "events_url": "https://api.github.com/users/BKopyIo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BKopyIo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-19T00:27:30Z",
    "updated_at": "2022-08-19T00:27:30Z",
    "author_association": "NONE",
    "body": "Hm. Puzzling.  I started a new npx node on my terminal, as well, and just wrote a single test using signer.signMessage(string) using hh test â€“network localhost and got the same failure.\r\n\r\n\r\nFrom: Franco Victorio ***@***.***>\r\nReply-To: NomicFoundation/hardhat ***@***.***>\r\nDate: Thursday, August 18, 2022 at 3:28 AM\r\nTo: NomicFoundation/hardhat ***@***.***>\r\nCc: Josh Kramer ***@***.***>, Mention ***@***.***>\r\nSubject: Re: [NomicFoundation/hardhat] Implement personal_sign in Hardhat Network (Issue #1981)\r\n\r\n\r\n@BKopyIo<https://github.com/BKopyIo> I started a npx hardhat node and then connected to it with --network localhost and the method is present. Maybe you are connecting to a different node?\r\n\r\nâ€”\r\nReply to this email directly, view it on GitHub<https://github.com/NomicFoundation/hardhat/issues/1981#issuecomment-1219321295>, or unsubscribe<https://github.com/notifications/unsubscribe-auth/A2RXVXAITDZ4LZXXH5DNB3TVZYF3TANCNFSM5GQ374RQ>.\r\nYou are receiving this because you were mentioned.Message ID: ***@***.***>\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NomicFoundation/hardhat/issues/comments/1220106708/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
