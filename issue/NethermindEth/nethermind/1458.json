{
  "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1458",
  "repository_url": "https://api.github.com/repos/NethermindEth/nethermind",
  "labels_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1458/labels{/name}",
  "comments_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1458/comments",
  "events_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1458/events",
  "html_url": "https://github.com/NethermindEth/nethermind/issues/1458",
  "id": 567468787,
  "node_id": "MDU6SXNzdWU1Njc0Njg3ODc=",
  "number": 1458,
  "title": "invalid nonce in account proof if I specify the blockNumber",
  "user": {
    "login": "simon-jentzsch",
    "id": 10868622,
    "node_id": "MDQ6VXNlcjEwODY4NjIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/10868622?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/simon-jentzsch",
    "html_url": "https://github.com/simon-jentzsch",
    "followers_url": "https://api.github.com/users/simon-jentzsch/followers",
    "following_url": "https://api.github.com/users/simon-jentzsch/following{/other_user}",
    "gists_url": "https://api.github.com/users/simon-jentzsch/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/simon-jentzsch/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/simon-jentzsch/subscriptions",
    "organizations_url": "https://api.github.com/users/simon-jentzsch/orgs",
    "repos_url": "https://api.github.com/users/simon-jentzsch/repos",
    "events_url": "https://api.github.com/users/simon-jentzsch/events{/privacy}",
    "received_events_url": "https://api.github.com/users/simon-jentzsch/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2020-02-19T10:28:38Z",
  "updated_at": "2020-02-19T12:30:51Z",
  "closed_at": "2020-02-19T12:30:51Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "I create a account and send some transactions.\r\n\r\nWhen I try `eth_getProof` for an account, with a blockNumber before the first transaction I get this:\r\nrequest:\r\n```js\r\n{\r\n  \"id\":1,\r\n  \"jsonrpc\":\"2.0\",\r\n  \"method\":\"eth_getProof\",\r\n  \"params\":[\"0x99aeda42908b868b04671f6b0ee055f2adf499fa\",[],\"0x3c7\"]\r\n}\r\n```\r\nresponse:\r\n```js\r\n{\r\n  \"accountProof\": [\r\n    \"0xf90211a0ffe9ac322f5f7cbca84ad5f2157ea1606f959acf9b71f69df581ca83d25cf2f7a07a3912c9270a6dc0570bb0907e8b8e57898f875c7c4cf02bec747356e4dc82aea066f6da5c0ec1a1370e6107e99c9ce4af5322defe8139a21fbef8ce07aa673ec6a0d7a15fb76778678dddb04b95b4253fbe114075c4778500a0f74c539b6c2ab239a03f835e992185bc2ca430d819bc1bb611497de90e622bdc139e872683cf29aa71a0e0fcb2dfd9c7f7def0512ea32aae4bece3efabfa4b8c5588533e930185ee48dca0c9642c3a4ef60a9f6b65eef65e9ab5889587ceaf65c049300649271a01b6cca0a0da601eeacdd47d91ba32115b09dd64e7e680371b8b5581fc5dcef2fe12495861a0d76c9b555ace7f1f86d4f17cd23f9e13413c373f03d4053c5c669185db2b599ea0e85450b902da2748ea6b7fffef685065556706a5dd146ac3fd0e243b73be0bc4a0d5cf9acdcef9df6a7595a3bc42e7efed7282dbefeea9ac986a8980ce8f9f7194a0bd5ec8d61fb080164591bbec7351d1adfea6b27d0592f98e3cf3f93d34e669b0a0982db99da605835339a6ba77e4ec7d83c68c933048d9276e970514067386067ea0b5d9f6f01bf89e50cec54c77d35e4b2276fb22012bb0522386259fd8a2bdc124a0f25cf88f9b379e5576e9e76cb169d8908ac04ef8b57350fd51cc3e26252fe67fa07761045a4a69183c9d67b99444d208ae551193436673c185ea5133d533963cdc80\",\r\n    \"0xf901f1a0efebce0986b4d594fb895a7698f4f2426d8754629e9e96b9272f18dc50d080d0a061bfafa4b44ade95b7684449a390f8cc54b335a81c81fd31c839c08cecbf7d8da0ec250d2e2a51b4a015dfaed7693c25d41e05df84f7ec8c2d9b348dfca29deccda07444fea95d203af6c18e38e730a95b521d75ff44b44b15657b0b2f191414a01da04d78166b48044fdc28ed22d2fd39c8df6f8aaa04cb71d3a17286856f6893ff8380a035c73b98e5a42ac205835ee21e960d13491f26b0d29d7307d5d4026173b0dc69a05988520db7ec809ff9e949c2d0aa372c0e1fa42958f149af92cb5895b07bdec6a0d93caf4a5471e91e0a5a2b5a7364da11c17c8b17ef98ae187c9b2bfe760142a8a0a7948b58a23eda1762fd38e0067578f88867fafef0db7b88e9f2b95f636593eba04fac2f28a99935821ccfe07b4e19d4d511d1d5fbd868a81f16876f9e52a2d73ea0e3b149fb9037540ab7329c76d802786d55189070a01b3506a78b379730690a72a0e5f8ce11a3001016e47badfe8d187b28a9c232cca697efbca43aaf5d544e04d9a0a339be058504ca3d8f24ca35a1596132f4f53af345f03cc2ae733342fed9ec3ba00a2efbfd9a18c30be728e6c354f317b1ea3db5e7953deddb2cf3715fb917a397a00e2c3c9387f340094fc19049007ee51dfc70445d70867bccdd7ad2952ac6789380\",\r\n    \"0xf8d18080a066ae1c9328fafd55e10235fc8da9e880887ed48e69d8f071e96e3644040472ed80808080a0ccc77a7a1fce724eacfb029fb569e29f5d3ac76a6c1c90c3d6ea134ec50a783ba05d54363af5ac1e559a1adf5a03c116e5dc53df27a21da22d34947f43c447fb5b808080a04547ff736b3e3d2eefb4521b006b8e6c316ca8ad29ce8ec7f4a82d79a2dfa472a003f9499d588d68ec3f0649a623e070fde41c8a7dc0ee5c123b6e0088cc071d0d80a003ec76297dd86e63632ec96ddd784b5358b2af370477e7b989044467f202fab080\",\r\n    \"0xf8689f3aa0d9b39993a488c30c51fca1d5a0fc26082102a2c7e44b892b65f11c5bc4b846f8440180a044793d1fc2751d7b1d8225450654010f79feb3499976759eb880521fa132d786a0f081344097c1981565c77bf3af4b0f9ee3c194343e4fd8fcabdc8d8f35810285\"\r\n  ],\r\n  \"address\": \"0x99aeda42908b868b04671f6b0ee055f2adf499fa\",\r\n  \"balance\": \"0x0\",\r\n  \"codeHash\": \"0xf081344097c1981565c77bf3af4b0f9ee3c194343e4fd8fcabdc8d8f35810285\",\r\n  \"nonce\": \"0x1\",\r\n  \"storageHash\": \"0x44793d1fc2751d7b1d8225450654010f79feb3499976759eb880521fa132d786\",\r\n  \"storageProof\": []\r\n}\r\n```\r\n\r\nThe nonce should be 0 since at that time the account did not exist yet.\r\n\r\nIf I ask for `eth-getTransactionCount` with the same blockNumber, I get `0`, which is correct.\r\n\r\nAlso I tried to verify the account-proof, and it correctly points to a different account, proofing that the account does not exist. ",
  "closed_by": {
    "login": "tkstanczak",
    "id": 498913,
    "node_id": "MDQ6VXNlcjQ5ODkxMw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tkstanczak",
    "html_url": "https://github.com/tkstanczak",
    "followers_url": "https://api.github.com/users/tkstanczak/followers",
    "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
    "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
    "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
    "repos_url": "https://api.github.com/users/tkstanczak/repos",
    "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1458/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1458/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/588156393",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1458#issuecomment-588156393",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1458",
    "id": 588156393,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4ODE1NjM5Mw==",
    "user": {
      "login": "tkstanczak",
      "id": 498913,
      "node_id": "MDQ6VXNlcjQ5ODkxMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tkstanczak",
      "html_url": "https://github.com/tkstanczak",
      "followers_url": "https://api.github.com/users/tkstanczak/followers",
      "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
      "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
      "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
      "repos_url": "https://api.github.com/users/tkstanczak/repos",
      "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-19T10:44:07Z",
    "updated_at": "2020-02-19T10:44:07Z",
    "author_association": "MEMBER",
    "body": "is it on mainnet?",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/588156393/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/588158045",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1458#issuecomment-588158045",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1458",
    "id": 588158045,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4ODE1ODA0NQ==",
    "user": {
      "login": "simon-jentzsch",
      "id": 10868622,
      "node_id": "MDQ6VXNlcjEwODY4NjIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/10868622?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/simon-jentzsch",
      "html_url": "https://github.com/simon-jentzsch",
      "followers_url": "https://api.github.com/users/simon-jentzsch/followers",
      "following_url": "https://api.github.com/users/simon-jentzsch/following{/other_user}",
      "gists_url": "https://api.github.com/users/simon-jentzsch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/simon-jentzsch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/simon-jentzsch/subscriptions",
      "organizations_url": "https://api.github.com/users/simon-jentzsch/orgs",
      "repos_url": "https://api.github.com/users/simon-jentzsch/repos",
      "events_url": "https://api.github.com/users/simon-jentzsch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/simon-jentzsch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-19T10:48:22Z",
    "updated_at": "2020-02-19T10:48:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "no this just the same local testchain with`NethDev` that I'm using for the CI-Tests.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/588158045/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/588159025",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1458#issuecomment-588159025",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1458",
    "id": 588159025,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4ODE1OTAyNQ==",
    "user": {
      "login": "tkstanczak",
      "id": 498913,
      "node_id": "MDQ6VXNlcjQ5ODkxMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tkstanczak",
      "html_url": "https://github.com/tkstanczak",
      "followers_url": "https://api.github.com/users/tkstanczak/followers",
      "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
      "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
      "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
      "repos_url": "https://api.github.com/users/tkstanczak/repos",
      "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-19T10:50:55Z",
    "updated_at": "2020-02-19T10:50:55Z",
    "author_association": "MEMBER",
    "body": "I forgot that you enclosed the reproduce.zip, let me use it, thanks",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/588159025/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/588159707",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1458#issuecomment-588159707",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1458",
    "id": 588159707,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4ODE1OTcwNw==",
    "user": {
      "login": "tkstanczak",
      "id": 498913,
      "node_id": "MDQ6VXNlcjQ5ODkxMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tkstanczak",
      "html_url": "https://github.com/tkstanczak",
      "followers_url": "https://api.github.com/users/tkstanczak/followers",
      "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
      "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
      "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
      "repos_url": "https://api.github.com/users/tkstanczak/repos",
      "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-19T10:52:35Z",
    "updated_at": "2020-02-19T10:52:35Z",
    "author_association": "MEMBER",
    "body": "different issue, ok, confused the two reported\r\n\r\nso... this is the nonce of the account that was found, same for code hash and balance\r\nI will fix it",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/588159707/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/588169446",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1458#issuecomment-588169446",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1458",
    "id": 588169446,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4ODE2OTQ0Ng==",
    "user": {
      "login": "simon-jentzsch",
      "id": 10868622,
      "node_id": "MDQ6VXNlcjEwODY4NjIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/10868622?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/simon-jentzsch",
      "html_url": "https://github.com/simon-jentzsch",
      "followers_url": "https://api.github.com/users/simon-jentzsch/followers",
      "following_url": "https://api.github.com/users/simon-jentzsch/following{/other_user}",
      "gists_url": "https://api.github.com/users/simon-jentzsch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/simon-jentzsch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/simon-jentzsch/subscriptions",
      "organizations_url": "https://api.github.com/users/simon-jentzsch/orgs",
      "repos_url": "https://api.github.com/users/simon-jentzsch/repos",
      "events_url": "https://api.github.com/users/simon-jentzsch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/simon-jentzsch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-19T11:17:02Z",
    "updated_at": "2020-02-19T11:17:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "yes looks like you use the values from the last account instead of the requested one. \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/588169446/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/588201716",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1458#issuecomment-588201716",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1458",
    "id": 588201716,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4ODIwMTcxNg==",
    "user": {
      "login": "tkstanczak",
      "id": 498913,
      "node_id": "MDQ6VXNlcjQ5ODkxMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tkstanczak",
      "html_url": "https://github.com/tkstanczak",
      "followers_url": "https://api.github.com/users/tkstanczak/followers",
      "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
      "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
      "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
      "repos_url": "https://api.github.com/users/tkstanczak/repos",
      "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-19T12:30:48Z",
    "updated_at": "2020-02-19T12:30:48Z",
    "author_association": "MEMBER",
    "body": "fixed, the paths matcher was only checking the first matching Nibble instead of comparing the whole length of extension or leaf \r\n\r\nalso fixed the storage root of empty accounts which was incorrectly set to Rlp.OfEmptySequence instead of Rlp.EmptyTreeRoot",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/588201716/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
