{
  "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3094",
  "repository_url": "https://api.github.com/repos/NethermindEth/nethermind",
  "labels_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3094/labels{/name}",
  "comments_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3094/comments",
  "events_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3094/events",
  "html_url": "https://github.com/NethermindEth/nethermind/issues/3094",
  "id": 912242070,
  "node_id": "MDU6SXNzdWU5MTIyNDIwNzA=",
  "number": 3094,
  "title": "DoS vulnerability found",
  "user": {
    "login": "mous314anony",
    "id": 85397007,
    "node_id": "MDQ6VXNlcjg1Mzk3MDA3",
    "avatar_url": "https://avatars.githubusercontent.com/u/85397007?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mous314anony",
    "html_url": "https://github.com/mous314anony",
    "followers_url": "https://api.github.com/users/mous314anony/followers",
    "following_url": "https://api.github.com/users/mous314anony/following{/other_user}",
    "gists_url": "https://api.github.com/users/mous314anony/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mous314anony/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mous314anony/subscriptions",
    "organizations_url": "https://api.github.com/users/mous314anony/orgs",
    "repos_url": "https://api.github.com/users/mous314anony/repos",
    "events_url": "https://api.github.com/users/mous314anony/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mous314anony/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "marcindsobczak",
    "id": 77129288,
    "node_id": "MDQ6VXNlcjc3MTI5Mjg4",
    "avatar_url": "https://avatars.githubusercontent.com/u/77129288?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/marcindsobczak",
    "html_url": "https://github.com/marcindsobczak",
    "followers_url": "https://api.github.com/users/marcindsobczak/followers",
    "following_url": "https://api.github.com/users/marcindsobczak/following{/other_user}",
    "gists_url": "https://api.github.com/users/marcindsobczak/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/marcindsobczak/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/marcindsobczak/subscriptions",
    "organizations_url": "https://api.github.com/users/marcindsobczak/orgs",
    "repos_url": "https://api.github.com/users/marcindsobczak/repos",
    "events_url": "https://api.github.com/users/marcindsobczak/events{/privacy}",
    "received_events_url": "https://api.github.com/users/marcindsobczak/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "marcindsobczak",
      "id": 77129288,
      "node_id": "MDQ6VXNlcjc3MTI5Mjg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/77129288?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/marcindsobczak",
      "html_url": "https://github.com/marcindsobczak",
      "followers_url": "https://api.github.com/users/marcindsobczak/followers",
      "following_url": "https://api.github.com/users/marcindsobczak/following{/other_user}",
      "gists_url": "https://api.github.com/users/marcindsobczak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/marcindsobczak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/marcindsobczak/subscriptions",
      "organizations_url": "https://api.github.com/users/marcindsobczak/orgs",
      "repos_url": "https://api.github.com/users/marcindsobczak/repos",
      "events_url": "https://api.github.com/users/marcindsobczak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/marcindsobczak/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-06-05T12:31:21Z",
  "updated_at": "2021-06-11T04:13:49Z",
  "closed_at": "2021-06-11T04:13:49Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Bug Report: Low-cost DoS of Ethereum's transaction propagation by exploiting Nethermind's transaction replacement policy\r\n===\r\n\r\n- Time: May 24th, 2021\r\n- (We didn't find nethermind's bug bounty program, so post the report here).\r\n\r\nSummary\r\n---\r\n\r\nNethermind allows replacing an unconfirmed transaction in its txpool by another transaction at almost the same Gas price. Exploiting this policy, we design and validate a low-cost bandwidth DoS.\r\n\r\nConsider a network where all nodes run nethermind client. The attacker can send a series of N transactions to the network. All N transactions are of the same `sender` and `nonce`. In the sequence, a transaction has a slightly higher Gas price than a predecessor transaction (e.g., higher price by $1$ wei). \r\n\r\nIn this attack, the attacker pays essentially for one transaction but has the network to propagate N transactions. This  allows the attacker to unfairly use the network resource (bandwidth and per-node CPU) and to further deny its service.\r\n \r\nTo fix the above problem, Nethermind should set a similar minimum price bump for replacement transactions with Geth (Parity), such as 10% (12.5%).\r\n\r\nBackground\r\n---\r\n\r\nIt is common that Ethereum clients support replacement transactions. This feature allows transaction sender to prioritize the inclusion of their transactions by bidding a higher gas price in the new transactions and to replace a previous low-priced transaction sent earlier.\r\n\r\nAll Ethereum clients support such features.\r\n\r\nHowever, if the client does not limit the percentage of gas price raised in the replacement transactions, an attacker can exploit this vulnerability to congest the victim client by sending a large sequence of pending transactions.\r\n\r\nProof of Concept\r\n---\r\n\r\n- In the current implementation of Nethermind, a user can replace a previously sent pending transactions with a new transaction by bidding a slightly higher gas price. Support the gas price of the previous transaction is K, then the gas price of the replacement transaction is K+1.\r\n\r\nYou can verify this by running one Nethermind node in a private Ethereum network.\r\n\r\n1. Send one pending transaction with gas price being 1 Gwei (10<sup>9</sup>).\r\n2. Check if the pending transaction is accepted by txpool through RPC `{\"method\":\"txpool_content\",\"params\":[],\"id\":1,\"jsonrpc\":\"2.0\"}`.\r\n3. Send a replacement transaction of the same sender/nonce, with gas price being 1 Gwei + 1 (10<sup>9</sup>+1).\r\n4. Check if the replacement transaction is accepted by txpool through `{\"method\":\"txpool_content\",\"params\":[],\"id\":1,\"jsonrpc\":\"2.0\"}`.\r\n\r\n- You should be able to see that at step 4, in the txpool, the replacement transaction successfully replaced the transaction sent at step 1. \r\n\r\nMitigation \r\n---\r\n\r\nTo mitigate such a DoS attack, we propose the following defenses.\r\n\r\n1. __A practical defense__ is to set the minimum percentage for the gas price of replacement transactions in the `txpool`, such as 10% (12.5%) adopted by other Ethereum clients.\r\n",
  "closed_by": {
    "login": "mous314anony",
    "id": 85397007,
    "node_id": "MDQ6VXNlcjg1Mzk3MDA3",
    "avatar_url": "https://avatars.githubusercontent.com/u/85397007?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mous314anony",
    "html_url": "https://github.com/mous314anony",
    "followers_url": "https://api.github.com/users/mous314anony/followers",
    "following_url": "https://api.github.com/users/mous314anony/following{/other_user}",
    "gists_url": "https://api.github.com/users/mous314anony/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mous314anony/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mous314anony/subscriptions",
    "organizations_url": "https://api.github.com/users/mous314anony/orgs",
    "repos_url": "https://api.github.com/users/mous314anony/repos",
    "events_url": "https://api.github.com/users/mous314anony/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mous314anony/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3094/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3094/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/859250841",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/3094#issuecomment-859250841",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3094",
    "id": 859250841,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1OTI1MDg0MQ==",
    "user": {
      "login": "mous314anony",
      "id": 85397007,
      "node_id": "MDQ6VXNlcjg1Mzk3MDA3",
      "avatar_url": "https://avatars.githubusercontent.com/u/85397007?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mous314anony",
      "html_url": "https://github.com/mous314anony",
      "followers_url": "https://api.github.com/users/mous314anony/followers",
      "following_url": "https://api.github.com/users/mous314anony/following{/other_user}",
      "gists_url": "https://api.github.com/users/mous314anony/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mous314anony/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mous314anony/subscriptions",
      "organizations_url": "https://api.github.com/users/mous314anony/orgs",
      "repos_url": "https://api.github.com/users/mous314anony/repos",
      "events_url": "https://api.github.com/users/mous314anony/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mous314anony/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-11T04:13:49Z",
    "updated_at": "2021-06-11T04:13:49Z",
    "author_association": "NONE",
    "body": "Yes, thanks for fixing the bug!",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/859250841/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
