{
  "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/6024",
  "repository_url": "https://api.github.com/repos/NethermindEth/nethermind",
  "labels_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/6024/labels{/name}",
  "comments_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/6024/comments",
  "events_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/6024/events",
  "html_url": "https://github.com/NethermindEth/nethermind/issues/6024",
  "id": 1859155807,
  "node_id": "I_kwDOBggaLc5u0Hdf",
  "number": 6024,
  "title": "Receiving \"Reverted 0x\" on reverts instead of the actual error",
  "user": {
    "login": "marie-fourier",
    "id": 7760339,
    "node_id": "MDQ6VXNlcjc3NjAzMzk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7760339?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/marie-fourier",
    "html_url": "https://github.com/marie-fourier",
    "followers_url": "https://api.github.com/users/marie-fourier/followers",
    "following_url": "https://api.github.com/users/marie-fourier/following{/other_user}",
    "gists_url": "https://api.github.com/users/marie-fourier/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/marie-fourier/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/marie-fourier/subscriptions",
    "organizations_url": "https://api.github.com/users/marie-fourier/orgs",
    "repos_url": "https://api.github.com/users/marie-fourier/repos",
    "events_url": "https://api.github.com/users/marie-fourier/events{/privacy}",
    "received_events_url": "https://api.github.com/users/marie-fourier/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "emlautarom1",
    "id": 31224949,
    "node_id": "MDQ6VXNlcjMxMjI0OTQ5",
    "avatar_url": "https://avatars.githubusercontent.com/u/31224949?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/emlautarom1",
    "html_url": "https://github.com/emlautarom1",
    "followers_url": "https://api.github.com/users/emlautarom1/followers",
    "following_url": "https://api.github.com/users/emlautarom1/following{/other_user}",
    "gists_url": "https://api.github.com/users/emlautarom1/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/emlautarom1/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/emlautarom1/subscriptions",
    "organizations_url": "https://api.github.com/users/emlautarom1/orgs",
    "repos_url": "https://api.github.com/users/emlautarom1/repos",
    "events_url": "https://api.github.com/users/emlautarom1/events{/privacy}",
    "received_events_url": "https://api.github.com/users/emlautarom1/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "emlautarom1",
      "id": 31224949,
      "node_id": "MDQ6VXNlcjMxMjI0OTQ5",
      "avatar_url": "https://avatars.githubusercontent.com/u/31224949?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emlautarom1",
      "html_url": "https://github.com/emlautarom1",
      "followers_url": "https://api.github.com/users/emlautarom1/followers",
      "following_url": "https://api.github.com/users/emlautarom1/following{/other_user}",
      "gists_url": "https://api.github.com/users/emlautarom1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emlautarom1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emlautarom1/subscriptions",
      "organizations_url": "https://api.github.com/users/emlautarom1/orgs",
      "repos_url": "https://api.github.com/users/emlautarom1/repos",
      "events_url": "https://api.github.com/users/emlautarom1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emlautarom1/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2023-08-21T11:18:08Z",
  "updated_at": "2023-08-21T12:19:58Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "**Description**\r\nThe Nethermind JSON-RPC returns \"Reverted 0x\" instead of the actual value. This issue was partially address in here https://github.com/NethermindEth/nethermind/issues/5740 but the bug still appears on some requests.\r\n\r\n\r\n**Steps to Reproduce**\r\nThe reproduce the issue I'm calling `simulateHandleOp` method of the EntryPoint contract: https://github.com/eth-infinitism/account-abstraction/blob/develop/contracts/core/EntryPoint.sol#L207-L240 . This method always reverts with `ExecutionResult` error and with important data for the flow of [ERC-4337](https://eips.ethereum.org/EIPS/eip-4337)\r\n\r\nThe address of EntryPoint contract: [0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789](https://explorer.fuse.io/address/0x5FF137D4b0FDCD49DcA30c7CF57E578a026d2789)\r\n\r\nThe request:\r\n```sh\r\ncurl --location 'https://bundler.rpc.fuse.io' \\\r\n--header 'Content-Type: application/json' \\\r\n--data '{\r\n    \"method\": \"eth_call\",\r\n    \"params\": [\r\n        {\r\n            \"to\": \"0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789\",\r\n            \"data\": \"0xd6383f940000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003a00000000000000000000000000e3a7f84ac66d24238697e5a6efeffef459b9e8c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000001e00000000000000000000000000000000000000000000000000000000000989680000000000000000000000000000000000000000000000000000000000098968000000000000000000000000000000000000000000000000000000000000f42400000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000000000000000000000000000000002c000000000000000000000000000000000000000000000000000000000000000589406cc6185a346906296840746125a0e449764545fbfb9cf000000000000000000000000608a2b6957df6f06bae9f8d0c5d1eb79dc0929bb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000084b61d27f6000000000000000000000000608a2b6957df6f06bae9f8d0c5d1eb79dc0929bb000000000000000000000000000000000000000000000000000000e8d4a510000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000414e9399fa343cbb7ebb9ecfb410e207a32f133ffd696e06486443d0330d0f6f876964b64df62297e9df155de90652ba255b4116cfde8c0339f740d19df0d0f4171c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\"\r\n        },\r\n        \"latest\"\r\n    ],\r\n    \"id\": 57,\r\n    \"jsonrpc\": \"2.0\"\r\n}'\r\n```\r\n\r\n**Actual behavior**\r\n```json\r\n{\r\n    \"jsonrpc\": \"2.0\",\r\n    \"error\": {\r\n        \"code\": -32015,\r\n        \"message\": \"VM execution error.\",\r\n        \"data\": \"Reverted 0x\"\r\n    },\r\n    \"id\": 57\r\n}\r\n```\r\n\r\n**Expected behavior**\r\nThe data should contain the full error message. For example, this is what I get from https://rpc-mumbai.maticvigil.com which uses Bor\r\n```json\r\n{\r\n    \"jsonrpc\": \"2.0\",\r\n    \"id\": 445,\r\n    \"error\": {\r\n        \"code\": 3,\r\n        \"message\": \"execution reverted\",\r\n        \"data\": \"0x220266b600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001f414131302073656e64657220616c726561647920636f6e737472756374656400\"\r\n    }\r\n}\r\n```\r\n\r\n\r\n**Screenshots**\r\n![image](https://github.com/NethermindEth/nethermind/assets/7760339/be022937-1d11-4e4d-8d7e-95c593fb9b22)\r\n\r\n\r\n**Desktop (please complete the following information):**\r\nPlease provide the following information regarding your setup:\r\n - Operating System: Linux\r\n - Version: Nethermind/v1.20.1+b6e820ae/linux-x64/dotnet7.0.9\r\n - Installation Method: Docker\r\n - Consensus Client: N/A\r\n\r\n**Additional context**\r\nThe `eth_call` correctly reverts for some requests, like this one:\r\n```sh\r\ncurl --location 'https://bundler.rpc.fuse.io' \\\r\n--header 'Content-Type: application/json' \\\r\n--data '{\r\n    \"method\": \"eth_call\",\r\n    \"params\": [\r\n        {\r\n            \"to\": \"0x5ff137d4b0fdcd49dca30c7cf57e578a026d2789\",\r\n            \"data\": \"0x9b249f69000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000589406cc6185a346906296840746125a0e449764545fbfb9cf000000000000000000000000608a2b6957df6f06bae9f8d0c5d1eb79dc0929bb00000000000000000000000000000000000000000000000000000000000000000000000000000000\"\r\n        },\r\n        \"latest\"\r\n    ],\r\n    \"id\": 57,\r\n    \"jsonrpc\": \"2.0\"\r\n}'\r\n```\r\n\r\nThe response:\r\n```json\r\n{\r\n    \"jsonrpc\": \"2.0\",\r\n    \"error\": {\r\n        \"code\": -32015,\r\n        \"message\": \"VM execution error.\",\r\n        \"data\": \"Reverted 0x6ca7b8060000000000000000000000000e3a7f84ac66d24238697e5a6efeffef459b9e8c\"\r\n    },\r\n    \"id\": 57\r\n}\r\n```\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/6024/reactions",
    "total_count": 2,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 1
  },
  "timeline_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/6024/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[

]
