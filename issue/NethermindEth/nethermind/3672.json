{
  "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3672",
  "repository_url": "https://api.github.com/repos/NethermindEth/nethermind",
  "labels_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3672/labels{/name}",
  "comments_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3672/comments",
  "events_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3672/events",
  "html_url": "https://github.com/NethermindEth/nethermind/issues/3672",
  "id": 1072935435,
  "node_id": "I_kwDOBggaLc4_87IL",
  "number": 3672,
  "title": "Filter with ID ___ already exists, Filter with id: ___ does not exist",
  "user": {
    "login": "NoltaPulta",
    "id": 95600324,
    "node_id": "U_kgDOBbK-xA",
    "avatar_url": "https://avatars.githubusercontent.com/u/95600324?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/NoltaPulta",
    "html_url": "https://github.com/NoltaPulta",
    "followers_url": "https://api.github.com/users/NoltaPulta/followers",
    "following_url": "https://api.github.com/users/NoltaPulta/following{/other_user}",
    "gists_url": "https://api.github.com/users/NoltaPulta/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/NoltaPulta/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/NoltaPulta/subscriptions",
    "organizations_url": "https://api.github.com/users/NoltaPulta/orgs",
    "repos_url": "https://api.github.com/users/NoltaPulta/repos",
    "events_url": "https://api.github.com/users/NoltaPulta/events{/privacy}",
    "received_events_url": "https://api.github.com/users/NoltaPulta/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "LukaszRozmej",
    "id": 12445221,
    "node_id": "MDQ6VXNlcjEyNDQ1MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/12445221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/LukaszRozmej",
    "html_url": "https://github.com/LukaszRozmej",
    "followers_url": "https://api.github.com/users/LukaszRozmej/followers",
    "following_url": "https://api.github.com/users/LukaszRozmej/following{/other_user}",
    "gists_url": "https://api.github.com/users/LukaszRozmej/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/LukaszRozmej/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/LukaszRozmej/subscriptions",
    "organizations_url": "https://api.github.com/users/LukaszRozmej/orgs",
    "repos_url": "https://api.github.com/users/LukaszRozmej/repos",
    "events_url": "https://api.github.com/users/LukaszRozmej/events{/privacy}",
    "received_events_url": "https://api.github.com/users/LukaszRozmej/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "LukaszRozmej",
      "id": 12445221,
      "node_id": "MDQ6VXNlcjEyNDQ1MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/12445221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LukaszRozmej",
      "html_url": "https://github.com/LukaszRozmej",
      "followers_url": "https://api.github.com/users/LukaszRozmej/followers",
      "following_url": "https://api.github.com/users/LukaszRozmej/following{/other_user}",
      "gists_url": "https://api.github.com/users/LukaszRozmej/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LukaszRozmej/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LukaszRozmej/subscriptions",
      "organizations_url": "https://api.github.com/users/LukaszRozmej/orgs",
      "repos_url": "https://api.github.com/users/LukaszRozmej/repos",
      "events_url": "https://api.github.com/users/LukaszRozmej/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LukaszRozmej/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-12-07T05:38:37Z",
  "updated_at": "2021-12-07T17:43:52Z",
  "closed_at": "2021-12-07T17:43:52Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "When running ethereumetl against a full archive sync of Nethermind, and attempting to export all, I will randomly receive one of those two errors. Either the filter already exists, or the filter does not exist. I increased the rpc idle times to over an hour, and adjusted several other parameters, with no difference. It runs into this error within several minutes every run, anyways.\r\n\r\nAfter researching some, it sounded like the filter does not exist error might be an issue on the backend prematurely removing filters. Not really sure about the filter already exists error.\r\n\r\nI wanted to create this issue in case anyone else ever runs into it with ethereumetl +  Nethermind (openethereum going dark means Nethermind is now the best backend for analysis). \r\n\r\nI worked around the issue by making two minor code changes and recompiling. One overwrites a filter ID if it already exists, rather than throwing an error. The other change disables the uninstalling of all filters. The changes will certainly result in a memory leak, so make sure you're running on a machine with plenty of ram to spare. And after export, a restart of Nethermind is a good idea.\r\n\r\n*Updated the comment/patch after pulling the latest master changes from today that created a conflict which needed to be resolved.\r\n\r\nHere is the diff:\r\n\r\ndiff --git a/src/Nethermind/Nethermind.Blockchain/Filters/FilterStore.cs b/src/Nethermind/Nethermind.Blockchain/Filters/FilterStore.cs\r\nindex 0c0520ec7..3335590e1 100644\r\n--- a/src/Nethermind/Nethermind.Blockchain/Filters/FilterStore.cs\r\n+++ b/src/Nethermind/Nethermind.Blockchain/Filters/FilterStore.cs\r\n@@ -92,10 +92,13 @@ namespace Nethermind.Blockchain.Filters\r\n         {\r\n             if (_filters.ContainsKey(filter.Id))\r\n             {\r\n-                throw new InvalidOperationException($\"Filter with ID {filter.Id} already exists\");\r\n+                //throw new InvalidOperationException($\"Filter with ID {filter.Id} already exists\");\r\n             }\r\n-\r\n+\t    else\r\n+\t    {\r\n                 _nextFilterId = Math.Max(filter.Id + 1, _nextFilterId);\r\n+\t    }\r\n+\t    \r\n \t    _filters[filter.Id] = filter;\r\n         }\r\n \r\ndiff --git a/src/Nethermind/Nethermind.JsonRpc/Modules/Eth/EthRpcModule.cs b/src/Nethermind/Nethermind.JsonRpc/Modules/Eth/EthRpcModule.cs\r\nindex 7f2fd49d1..8bd4e09ec 100644\r\n--- a/src/Nethermind/Nethermind.JsonRpc/Modules/Eth/EthRpcModule.cs\r\n+++ b/src/Nethermind/Nethermind.JsonRpc/Modules/Eth/EthRpcModule.cs\r\n@@ -558,7 +558,7 @@ namespace Nethermind.JsonRpc.Modules.Eth\r\n \r\n         public ResultWrapper<bool?> eth_uninstallFilter(UInt256 filterId)\r\n         {\r\n-            _blockchainBridge.UninstallFilter((int)filterId);\r\n+            //_blockchainBridge.UninstallFilter((int)filterId);\r\n             return ResultWrapper<bool?>.Success(true);\r\n         }\r\n ",
  "closed_by": {
    "login": "LukaszRozmej",
    "id": 12445221,
    "node_id": "MDQ6VXNlcjEyNDQ1MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/12445221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/LukaszRozmej",
    "html_url": "https://github.com/LukaszRozmej",
    "followers_url": "https://api.github.com/users/LukaszRozmej/followers",
    "following_url": "https://api.github.com/users/LukaszRozmej/following{/other_user}",
    "gists_url": "https://api.github.com/users/LukaszRozmej/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/LukaszRozmej/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/LukaszRozmej/subscriptions",
    "organizations_url": "https://api.github.com/users/LukaszRozmej/orgs",
    "repos_url": "https://api.github.com/users/LukaszRozmej/repos",
    "events_url": "https://api.github.com/users/LukaszRozmej/events{/privacy}",
    "received_events_url": "https://api.github.com/users/LukaszRozmej/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3672/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3672/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/987586317",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/3672#issuecomment-987586317",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3672",
    "id": 987586317,
    "node_id": "IC_kwDOBggaLc463V8N",
    "user": {
      "login": "NoltaPulta",
      "id": 95600324,
      "node_id": "U_kgDOBbK-xA",
      "avatar_url": "https://avatars.githubusercontent.com/u/95600324?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NoltaPulta",
      "html_url": "https://github.com/NoltaPulta",
      "followers_url": "https://api.github.com/users/NoltaPulta/followers",
      "following_url": "https://api.github.com/users/NoltaPulta/following{/other_user}",
      "gists_url": "https://api.github.com/users/NoltaPulta/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NoltaPulta/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NoltaPulta/subscriptions",
      "organizations_url": "https://api.github.com/users/NoltaPulta/orgs",
      "repos_url": "https://api.github.com/users/NoltaPulta/repos",
      "events_url": "https://api.github.com/users/NoltaPulta/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NoltaPulta/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-07T05:39:40Z",
    "updated_at": "2021-12-07T07:24:48Z",
    "author_association": "NONE",
    "body": "[nethermind.diff.txt](https://github.com/NethermindEth/nethermind/files/7666312/nethermind.diff.txt)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/987586317/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/988134078",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/3672#issuecomment-988134078",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3672",
    "id": 988134078,
    "node_id": "IC_kwDOBggaLc465bq-",
    "user": {
      "login": "LukaszRozmej",
      "id": 12445221,
      "node_id": "MDQ6VXNlcjEyNDQ1MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/12445221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LukaszRozmej",
      "html_url": "https://github.com/LukaszRozmej",
      "followers_url": "https://api.github.com/users/LukaszRozmej/followers",
      "following_url": "https://api.github.com/users/LukaszRozmej/following{/other_user}",
      "gists_url": "https://api.github.com/users/LukaszRozmej/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LukaszRozmej/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LukaszRozmej/subscriptions",
      "organizations_url": "https://api.github.com/users/LukaszRozmej/orgs",
      "repos_url": "https://api.github.com/users/LukaszRozmej/repos",
      "events_url": "https://api.github.com/users/LukaszRozmej/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LukaszRozmej/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-07T17:35:54Z",
    "updated_at": "2021-12-07T17:36:07Z",
    "author_association": "MEMBER",
    "body": "fixed with https://github.com/NethermindEth/nethermind/commit/088d858b9ca4282f135262bc092ddbb77de3f6d4 (accidentally pushed directly to master)",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/988134078/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
