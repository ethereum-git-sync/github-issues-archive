{
  "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3740",
  "repository_url": "https://api.github.com/repos/NethermindEth/nethermind",
  "labels_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3740/labels{/name}",
  "comments_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3740/comments",
  "events_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3740/events",
  "html_url": "https://github.com/NethermindEth/nethermind/issues/3740",
  "id": 1096302047,
  "node_id": "I_kwDOBggaLc5BWD3f",
  "number": 3740,
  "title": "Incorrect block on `eth_getBlockByNumber` calls on kintsugi",
  "user": {
    "login": "pawanjay176",
    "id": 9890508,
    "node_id": "MDQ6VXNlcjk4OTA1MDg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9890508?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pawanjay176",
    "html_url": "https://github.com/pawanjay176",
    "followers_url": "https://api.github.com/users/pawanjay176/followers",
    "following_url": "https://api.github.com/users/pawanjay176/following{/other_user}",
    "gists_url": "https://api.github.com/users/pawanjay176/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pawanjay176/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pawanjay176/subscriptions",
    "organizations_url": "https://api.github.com/users/pawanjay176/orgs",
    "repos_url": "https://api.github.com/users/pawanjay176/repos",
    "events_url": "https://api.github.com/users/pawanjay176/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pawanjay176/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "MarekM25",
    "id": 9356351,
    "node_id": "MDQ6VXNlcjkzNTYzNTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9356351?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/MarekM25",
    "html_url": "https://github.com/MarekM25",
    "followers_url": "https://api.github.com/users/MarekM25/followers",
    "following_url": "https://api.github.com/users/MarekM25/following{/other_user}",
    "gists_url": "https://api.github.com/users/MarekM25/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/MarekM25/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/MarekM25/subscriptions",
    "organizations_url": "https://api.github.com/users/MarekM25/orgs",
    "repos_url": "https://api.github.com/users/MarekM25/repos",
    "events_url": "https://api.github.com/users/MarekM25/events{/privacy}",
    "received_events_url": "https://api.github.com/users/MarekM25/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "MarekM25",
      "id": 9356351,
      "node_id": "MDQ6VXNlcjkzNTYzNTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9356351?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarekM25",
      "html_url": "https://github.com/MarekM25",
      "followers_url": "https://api.github.com/users/MarekM25/followers",
      "following_url": "https://api.github.com/users/MarekM25/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarekM25/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarekM25/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarekM25/subscriptions",
      "organizations_url": "https://api.github.com/users/MarekM25/orgs",
      "repos_url": "https://api.github.com/users/MarekM25/repos",
      "events_url": "https://api.github.com/users/MarekM25/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarekM25/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2022-01-07T13:07:29Z",
  "updated_at": "2022-01-19T14:49:09Z",
  "closed_at": "2022-01-19T14:49:09Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "**Describe the bug**\r\nNote: The issue was already reported to the Nethermind team on discord. Just creating a tracking issue to link on the Lighthouse end :)\r\n\r\nCommit: `13bcc2100c97d2ac36410f0cfca3b5648b7bf16c/themerge_kintsugi`.\r\n\r\nI have seen multiple reports of nethermind returning non-canonical blocks on the kintsugi testnet with Lighthouse-Nethermind combo.\r\nThe issue was observed when building up the eth1 deposit tree on Lighthouse. In particular, we get this error on Lighthouse\r\n```\r\nFailedToInsertEth1Block(InconsistentTimestamp { parent: 1640268768, child: 1640268756 })\r\n``` \r\nThe error implies that nethermind is returning blocks with `parent.timestamp > block.timestamp`. \r\n\r\nHere's an example bad block from my local nethermind node.\r\nBlock 123887\r\n```json\r\n{\r\n  \"jsonrpc\": \"2.0\",\r\n  \"result\": {\r\n    \"author\": \"0x0000000000000000000000000000000000000000\",\r\n    \"difficulty\": \"0x0\",\r\n    \"extraData\": \"0x\",\r\n    \"gasLimit\": \"0x8f55ff\",\r\n    \"gasUsed\": \"0xd8fe\",\r\n    \"hash\": \"0xfbf1182a1a07081ac62b80c01100b9ac236891fcb08947da671c727d2e1d9fd1\",\r\n    \"logsBloom\": \"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000040000000008000000000000000000000000000000000000000000000000000800000008000000000000000000000000000000000000000000000000000000000000000000000000000000000001000200000010000000002000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000040000000000000000000000000000000000000004000000000000000000000000000000000000\",\r\n    \"miner\": \"0x0000000000000000000000000000000000000000\",\r\n    \"mixHash\": \"0x3e0ccaa2cebe30b7f7e329f9f780ca35012a58a73de220063007a081047c2dfb\",\r\n    \"nonce\": \"0x0000000000000000\",\r\n    \"number\": \"0x1e3ef\",\r\n    \"parentHash\": \"0x444a4d6cd1916ec49089c06ad04d9c4587ba52140bf7f8f8cec751cf36868f70\",\r\n    \"receiptsRoot\": \"0x2a9b92845d18f9413cfa5d7845ca21b641bc43210c24a09c6f565c1906bc93c1\",\r\n    \"sha3Uncles\": \"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347\",\r\n    \"size\": \"0x332\",\r\n    \"stateRoot\": \"0xd51e69b8ef4fd658502556d966a4fc954ec062ba17be1ec74cb05b4eaa953ab5\",\r\n    \"totalDifficulty\": \"0x12a0eee4a\",\r\n    \"timestamp\": \"0x61d40918\",\r\n    \"baseFeePerGas\": \"0x7\",\r\n    \"transactions\": [\r\n      \"0xf15f290ed40cb856e37395a5984b3820991df0f9ddb59d1d1f6fca6cb6dbd091\",\r\n      \"0x07a19005fe31d323e9f8c87a44518d239066050d6113f18e406eb8f73259e4ae\"\r\n    ],\r\n    \"transactionsRoot\": \"0xcf40ed613e3f498579f4b2b8dad775f2b9cc991f31cf12658922bf5cfe9ae9db\",\r\n    \"uncles\": []\r\n  },\r\n  \"id\": 2\r\n}\r\n```\r\nBlock 123888\r\n```json\r\n{\r\n  \"jsonrpc\": \"2.0\",\r\n  \"result\": {\r\n    \"author\": \"0xa18fd83a55a9bedb96d66c24b768259eed183be3\",\r\n    \"difficulty\": \"0x0\",\r\n    \"extraData\": \"0x\",\r\n    \"gasLimit\": \"0x8f55ff\",\r\n    \"gasUsed\": \"0x0\",\r\n    \"hash\": \"0x5f93410822f550a86ad2db4ac139b437db5c35938bd88ff4cbf02164ad3cd30a\",\r\n    \"logsBloom\": \"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\r\n    \"miner\": \"0xa18fd83a55a9bedb96d66c24b768259eed183be3\",\r\n    \"mixHash\": \"0x0e74645abda76193c3251aa023d770530c4ceb678384050f27159178cdb4a0cb\",\r\n    \"nonce\": \"0x0000000000000000\",\r\n    \"number\": \"0x1e3f0\",\r\n    \"parentHash\": \"0xbe480d3c1429f913e9cac54f49c45d2e1a09d2ea9ad66c099d1af995c551ba45\",\r\n    \"receiptsRoot\": \"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421\",\r\n    \"sha3Uncles\": \"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347\",\r\n    \"size\": \"0x200\",\r\n    \"stateRoot\": \"0xd8f39f30f53e6f01d13c47a42664203f2d2eeeaa8f03b0911f35736a72cd69ed\",\r\n    \"totalDifficulty\": \"0x12a0eee4a\",\r\n    \"timestamp\": \"0x61d40804\",\r\n    \"baseFeePerGas\": \"0x7\",\r\n    \"transactions\": [],\r\n    \"transactionsRoot\": \"0x56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421\",\r\n    \"uncles\": []\r\n  },\r\n  \"id\": 2\r\n}\r\n```\r\n\r\nAs you can see, `123887.timestamp > 123888.timestamp`. From cross checking with the explorer and local geth node, looks like 123887 is a bad block that isn't part of the canonical chain.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\nSync a Lighthouse-Nethermind kintsugi testnet. \r\n\r\n**Expected behavior**\r\nShould return canonical block. ",
  "closed_by": {
    "login": "MarekM25",
    "id": 9356351,
    "node_id": "MDQ6VXNlcjkzNTYzNTE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9356351?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/MarekM25",
    "html_url": "https://github.com/MarekM25",
    "followers_url": "https://api.github.com/users/MarekM25/followers",
    "following_url": "https://api.github.com/users/MarekM25/following{/other_user}",
    "gists_url": "https://api.github.com/users/MarekM25/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/MarekM25/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/MarekM25/subscriptions",
    "organizations_url": "https://api.github.com/users/MarekM25/orgs",
    "repos_url": "https://api.github.com/users/MarekM25/repos",
    "events_url": "https://api.github.com/users/MarekM25/events{/privacy}",
    "received_events_url": "https://api.github.com/users/MarekM25/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3740/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3740/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[

]
