{
  "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3510",
  "repository_url": "https://api.github.com/repos/NethermindEth/nethermind",
  "labels_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3510/labels{/name}",
  "comments_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3510/comments",
  "events_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3510/events",
  "html_url": "https://github.com/NethermindEth/nethermind/issues/3510",
  "id": 1022731523,
  "node_id": "I_kwDOBggaLc489aUD",
  "number": 3510,
  "title": "Docker non-root user fails to generate node key",
  "user": {
    "login": "skylenet",
    "id": 1500888,
    "node_id": "MDQ6VXNlcjE1MDA4ODg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1500888?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/skylenet",
    "html_url": "https://github.com/skylenet",
    "followers_url": "https://api.github.com/users/skylenet/followers",
    "following_url": "https://api.github.com/users/skylenet/following{/other_user}",
    "gists_url": "https://api.github.com/users/skylenet/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/skylenet/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/skylenet/subscriptions",
    "organizations_url": "https://api.github.com/users/skylenet/orgs",
    "repos_url": "https://api.github.com/users/skylenet/repos",
    "events_url": "https://api.github.com/users/skylenet/events{/privacy}",
    "received_events_url": "https://api.github.com/users/skylenet/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1024161790,
      "node_id": "MDU6TGFiZWwxMDI0MTYxNzkw",
      "url": "https://api.github.com/repos/NethermindEth/nethermind/labels/devops",
      "name": "devops",
      "color": "dbbd11",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "matilote",
    "id": 33068017,
    "node_id": "MDQ6VXNlcjMzMDY4MDE3",
    "avatar_url": "https://avatars.githubusercontent.com/u/33068017?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/matilote",
    "html_url": "https://github.com/matilote",
    "followers_url": "https://api.github.com/users/matilote/followers",
    "following_url": "https://api.github.com/users/matilote/following{/other_user}",
    "gists_url": "https://api.github.com/users/matilote/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/matilote/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/matilote/subscriptions",
    "organizations_url": "https://api.github.com/users/matilote/orgs",
    "repos_url": "https://api.github.com/users/matilote/repos",
    "events_url": "https://api.github.com/users/matilote/events{/privacy}",
    "received_events_url": "https://api.github.com/users/matilote/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "matilote",
      "id": 33068017,
      "node_id": "MDQ6VXNlcjMzMDY4MDE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33068017?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matilote",
      "html_url": "https://github.com/matilote",
      "followers_url": "https://api.github.com/users/matilote/followers",
      "following_url": "https://api.github.com/users/matilote/following{/other_user}",
      "gists_url": "https://api.github.com/users/matilote/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matilote/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matilote/subscriptions",
      "organizations_url": "https://api.github.com/users/matilote/orgs",
      "repos_url": "https://api.github.com/users/matilote/repos",
      "events_url": "https://api.github.com/users/matilote/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matilote/received_events",
      "type": "User",
      "site_admin": false
    },
    {
      "login": "AntiD2ta",
      "id": 46824157,
      "node_id": "MDQ6VXNlcjQ2ODI0MTU3",
      "avatar_url": "https://avatars.githubusercontent.com/u/46824157?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AntiD2ta",
      "html_url": "https://github.com/AntiD2ta",
      "followers_url": "https://api.github.com/users/AntiD2ta/followers",
      "following_url": "https://api.github.com/users/AntiD2ta/following{/other_user}",
      "gists_url": "https://api.github.com/users/AntiD2ta/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AntiD2ta/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AntiD2ta/subscriptions",
      "organizations_url": "https://api.github.com/users/AntiD2ta/orgs",
      "repos_url": "https://api.github.com/users/AntiD2ta/repos",
      "events_url": "https://api.github.com/users/AntiD2ta/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AntiD2ta/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2021-10-11T13:50:01Z",
  "updated_at": "2022-12-21T23:27:07Z",
  "closed_at": "2021-10-11T18:43:41Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "**Describe the bug**\r\n\r\nWhen running Nethermind as a docker container with a non-root user and mounting a volume that this user has access to, it fails to initialize and generate a key for the node. For whatever reason it seems to be trying to access `/nethermind/Nethermind` even when providing the `--datadir` flag.\r\n\r\nLogs:\r\n\r\n```\r\n2021-10-11 13-47-14.1385|Configuration initialized.                                                                                                                                        \r\n2021-10-11 13-47-14.1409|Setting BaseDbPath to: /data/nethermind_db/mainnet, from: nethermind_db/mainnet                                                                                   \r\n2021-10-11 13-47-14.1409|Setting KeyStoreDirectory to: /data/keystore, from: keystore                                                                                                      \r\n2021-10-11 13-47-14.1410|Setting LogDirectory to: /data/logs, from: logs\r\n...\r\n2021-10-11 13:37:17.2718|Generating private key for the node (no node key in configuration) - stored in plain + key store for JSON RPC unlocking                                           \r\n2021-10-11 13:37:19.0405|Store this password for unlocking the node key for JSON RPC - this is not secure - this log message will be in your log files. Use only in DEV contexts.          \r\n2021-10-11 13:37:19.0405|aeXUCyFi\r\n2021-10-11 13:37:19.0703|Step SetupKeyStore            failed after 1881ms System.Security.Cryptography.CryptographicException: An error occurred while trying to encrypt the provided data\r\n. Refer to the inner exception for more information.                                                                                                                                       \r\n ---> System.UnauthorizedAccessException: Access to the path '/nethermind/Nethermind' is denied.                                                                                           \r\n ---> System.IO.IOException: Permission denied                                                                                                                                             \r\n   --- End of inner exception stack trace ---                                                                                                                                              \r\n   at System.IO.FileSystem.CreateDirectory(String fullPath)                                                                                                                                \r\n   at System.IO.DirectoryInfo.Create()                                                                                                                                                     \r\n   at Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository.GetAllElementsCore()+MoveNext()                                                                             \r\n   at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)                                                                                                                    \r\n   at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)                                                                                                                         \r\n   at Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository.GetAllElements()                                                                                            \r\n   at Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager.GetAllKeys()                                                                                                         \r\n   at Microsoft.AspNetCore.DataProtection.KeyManagement.KeyRingProvider.CreateCacheableKeyRingCore(DateTimeOffset now, IKey keyJustAdded)                                                  \r\n   at Microsoft.AspNetCore.DataProtection.KeyManagement.KeyRingProvider.Microsoft.AspNetCore.DataProtection.KeyManagement.Internal.ICacheableKeyRingProvider.GetCacheableKeyRing(DateTimeOf\r\nfset now)                                                                                                                                                                                  \r\n   at Microsoft.AspNetCore.DataProtection.KeyManagement.KeyRingProvider.GetCurrentKeyRingCore(DateTime utcNow, Boolean forceRefresh)                                                       \r\n   at Microsoft.AspNetCore.DataProtection.KeyManagement.KeyRingProvider.GetCurrentKeyRing()                                                                                                \r\n   at Microsoft.AspNetCore.DataProtection.KeyManagement.KeyRingBasedDataProtector.Protect(Byte[] plaintext)                                                                                \r\n   --- End of inner exception stack trace ---                                                                                                                                              \r\n   at Microsoft.AspNetCore.DataProtection.KeyManagement.KeyRingBasedDataProtector.Protect(Byte[] plaintext)                                                                                \r\n   at Nethermind.Crypto.ProtectedData.AspNetWrapper.Protect(Byte[] userData, Byte[] optionalEntropy, DataProtectionScope scope) in /src/Nethermind/Nethermind.Crypto/ProtectedData.AspNetWr\r\napper.cs:line 34                                                                                                                                                                           \r\n   at Nethermind.Crypto.ProtectedData.Protect(Byte[] userData, Byte[] optionalEntropy, DataProtectionScope scope) in /src/Nethermind/Nethermind.Crypto/ProtectedData.cs:line 39            \r\n   at Nethermind.Crypto.ProtectedData`1.Protect(Byte[] data) in /src/Nethermind/Nethermind.Crypto/ProtectedData.T.cs:line 46                                                               \r\n   at Nethermind.Crypto.ProtectedData`1..ctor(Byte[] data, ICryptoRandom random, ITimestamper timestamper) in /src/Nethermind/Nethermind.Crypto/ProtectedData.T.cs:line 40                 \r\n   at Nethermind.Crypto.ProtectedPrivateKey..ctor(PrivateKey privateKey, ICryptoRandom random, ITimestamper timestamper) in /src/Nethermind/Nethermind.Crypto/ProtectedPrivateKey.cs:line 2\r\n5                                                                                                                                                                                          \r\n   at Nethermind.Wallet.NodeKeyManager.<LoadNodeKey>g__LoadKeyFromFile|9_0() in /src/Nethermind/Nethermind.Wallet/NodeKeyManager.cs:line 88                                                \r\n   at Nethermind.Wallet.NodeKeyManager.LoadNodeKey() in /src/Nethermind/Nethermind.Wallet/NodeKeyManager.cs:line 110                                                                       \r\n   at Nethermind.Init.Steps.SetupKeyStore.<>c__DisplayClass2_0.<Execute>b__0() in /src/Nethermind/Nethermind.Init/Steps/SetupKeyStore.cs:line 73                                           \r\n   at System.Threading.Tasks.Task.InnerInvoke()                                                                                                                                            \r\n   at System.Threading.Tasks.Task.<>c.<.cctor>b__277_0(Object obj)                                                                                                                         \r\n   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)                  \r\n--- End of stack trace from previous location ---                                                                                                                                          \r\n   at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, ContextCallback callback, Object state)                  \r\n   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)                                                                                   \r\n--- End of stack trace from previous location ---                                                                                                                                          \r\n   at Nethermind.Init.Steps.SetupKeyStore.Execute(CancellationToken cancellationToken) in /src/Nethermind/Nethermind.Init/Steps/SetupKeyStore.cs:line 44\r\n```\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Run the following command on your local machine (use a non root user):\r\n\r\n```sh\r\nmkdir -p data && docker run --rm -it -v $PWD/data:/data -u $UID nethermind/nethermind:latest --datadir=/data\r\n```\r\n2. Check the logs\r\n\r\n**Expected behavior**\r\nA new node key  to be created for the node within the  `/data/keystore` directory (--KeyStore.KeyStoreDirectory is by default \"keystore\") \r\n",
  "closed_by": {
    "login": "AntiD2ta",
    "id": 46824157,
    "node_id": "MDQ6VXNlcjQ2ODI0MTU3",
    "avatar_url": "https://avatars.githubusercontent.com/u/46824157?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AntiD2ta",
    "html_url": "https://github.com/AntiD2ta",
    "followers_url": "https://api.github.com/users/AntiD2ta/followers",
    "following_url": "https://api.github.com/users/AntiD2ta/following{/other_user}",
    "gists_url": "https://api.github.com/users/AntiD2ta/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AntiD2ta/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AntiD2ta/subscriptions",
    "organizations_url": "https://api.github.com/users/AntiD2ta/orgs",
    "repos_url": "https://api.github.com/users/AntiD2ta/repos",
    "events_url": "https://api.github.com/users/AntiD2ta/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AntiD2ta/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3510/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3510/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/940110090",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/3510#issuecomment-940110090",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3510",
    "id": 940110090,
    "node_id": "IC_kwDOBggaLc44CPEK",
    "user": {
      "login": "AntiD2ta",
      "id": 46824157,
      "node_id": "MDQ6VXNlcjQ2ODI0MTU3",
      "avatar_url": "https://avatars.githubusercontent.com/u/46824157?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AntiD2ta",
      "html_url": "https://github.com/AntiD2ta",
      "followers_url": "https://api.github.com/users/AntiD2ta/followers",
      "following_url": "https://api.github.com/users/AntiD2ta/following{/other_user}",
      "gists_url": "https://api.github.com/users/AntiD2ta/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AntiD2ta/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AntiD2ta/subscriptions",
      "organizations_url": "https://api.github.com/users/AntiD2ta/orgs",
      "repos_url": "https://api.github.com/users/AntiD2ta/repos",
      "events_url": "https://api.github.com/users/AntiD2ta/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AntiD2ta/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-11T15:02:34Z",
    "updated_at": "2021-10-11T15:02:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "@skylenet This is an issue we are faced before when we wanted to create a rootless docker image. When you bind a folder in your host with the volume folder inside the container, docker sets as `uid:gid` of that folder `root:root` even if we chown that folder inside the Dockerfile. Later we find out this is an [open issue](https://github.com/moby/moby/issues/2259) of docker. There are a lot of proposed workarounds but none of them worked for us.",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/940110090/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/940154673",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/3510#issuecomment-940154673",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3510",
    "id": 940154673,
    "node_id": "IC_kwDOBggaLc44CZ8x",
    "user": {
      "login": "skylenet",
      "id": 1500888,
      "node_id": "MDQ6VXNlcjE1MDA4ODg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1500888?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/skylenet",
      "html_url": "https://github.com/skylenet",
      "followers_url": "https://api.github.com/users/skylenet/followers",
      "following_url": "https://api.github.com/users/skylenet/following{/other_user}",
      "gists_url": "https://api.github.com/users/skylenet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/skylenet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/skylenet/subscriptions",
      "organizations_url": "https://api.github.com/users/skylenet/orgs",
      "repos_url": "https://api.github.com/users/skylenet/repos",
      "events_url": "https://api.github.com/users/skylenet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/skylenet/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-11T15:59:36Z",
    "updated_at": "2021-10-11T16:15:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "> @skylenet This is an issue we are faced before when we wanted to create a rootless docker image. When you bind a folder in your host with the volume folder inside the container, docker sets as `uid:gid` of that folder `root:root` even if we chown that folder inside the Dockerfile. Later we find out this is an [open issue](https://github.com/moby/moby/issues/2259) of docker. There are a lot of proposed workarounds but none of them worked for us.\r\n\r\nHey @AntiD2ta . Thanks for looking into it and pointing me to that docker issue. I've looked into it and I'm not sure if it's really related to that. In my case the volume is mounted with the correct UID and the Nethermind process does have access to write into it.\r\n\r\nAfter having a closer look into the stack trace and code, this seems to be happening around here: https://github.com/NethermindEth/nethermind/blob/1d2f21ba04d4fd14cada95479d57b8d368b70af7/src/Nethermind/Nethermind.Crypto/ProtectedData.AspNetWrapper.cs#L68 \r\n\r\nFrom what it seems like, it will try to create the  `/nethermind/Nethermind` directory for the DataProtectionProvider. I think this might be a bug and that this should also be somewhere within the keystore directory. \r\n\r\nAs a temporary workaround for docker users, you can additionally create a volume mount for `/nethermind/Nethermind` and then the key generation will work. Example:\r\n\r\n```bash\r\n# Create the directories with your user so that they will also have the right permissions when mounted\r\nmkdir data appdata  \r\n# Mount data and appdata dir\r\ndocker run --rm -it -v $PWD/data:/data -v $PWD/appdata:/nethermind/Nethermind -u $UID nethermind/nethermind:latest --datadir=/data\r\n```\r\n\r\n*Update:*\r\n\r\nAnother workaround can also be to change the workdir and the entrypoint so that the \"Nethermind\" directory will be created within a volume mount that has permissions . For example:\r\n\r\n```bash\r\nmkdir data\r\ndocker run --rm -it -v $PWD/data:/data --workdir=/data --entrypoint=/nethermind/Nethermind.Runner -u $UID nethermind/nethermind:latest --datadir=/data\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/940154673/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/940356471",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/3510#issuecomment-940356471",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3510",
    "id": 940356471,
    "node_id": "IC_kwDOBggaLc44DLN3",
    "user": {
      "login": "AntiD2ta",
      "id": 46824157,
      "node_id": "MDQ6VXNlcjQ2ODI0MTU3",
      "avatar_url": "https://avatars.githubusercontent.com/u/46824157?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AntiD2ta",
      "html_url": "https://github.com/AntiD2ta",
      "followers_url": "https://api.github.com/users/AntiD2ta/followers",
      "following_url": "https://api.github.com/users/AntiD2ta/following{/other_user}",
      "gists_url": "https://api.github.com/users/AntiD2ta/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AntiD2ta/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AntiD2ta/subscriptions",
      "organizations_url": "https://api.github.com/users/AntiD2ta/orgs",
      "repos_url": "https://api.github.com/users/AntiD2ta/repos",
      "events_url": "https://api.github.com/users/AntiD2ta/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AntiD2ta/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-11T18:43:41Z",
    "updated_at": "2021-10-11T18:43:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "@skylenet Thanks very much for the feedback, we will again look into it and try to build a rootless docker image so it will be easier for you to run a container as non-root.",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/940356471/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1356912662",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/3510#issuecomment-1356912662",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3510",
    "id": 1356912662,
    "node_id": "IC_kwDOBggaLc5Q4NgW",
    "user": {
      "login": "attila-lendvai",
      "id": 840345,
      "node_id": "MDQ6VXNlcjg0MDM0NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/840345?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/attila-lendvai",
      "html_url": "https://github.com/attila-lendvai",
      "followers_url": "https://api.github.com/users/attila-lendvai/followers",
      "following_url": "https://api.github.com/users/attila-lendvai/following{/other_user}",
      "gists_url": "https://api.github.com/users/attila-lendvai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/attila-lendvai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/attila-lendvai/subscriptions",
      "organizations_url": "https://api.github.com/users/attila-lendvai/orgs",
      "repos_url": "https://api.github.com/users/attila-lendvai/repos",
      "events_url": "https://api.github.com/users/attila-lendvai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/attila-lendvai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-19T00:12:37Z",
    "updated_at": "2022-12-19T00:28:36Z",
    "author_association": "NONE",
    "body": "EDIT: i have found the right open issue for the error i have reported below: \r\n\r\nhttps://github.com/NethermindEth/nethermind/issues/4305\r\n\r\n-------------------\r\n\r\ni'm also seeing this:\r\n\r\n```\r\nSystem.UnauthorizedAccessException: Access to the path '/Nethermind' is denied.\r\n```\r\n\r\nwhen starting it as:\r\n\r\n\r\n> /gnu/store/24zb6izdz5l0l6cd65fb8mmvlwb6gmwm-nethermind-binary-1.14.7/bin/Nethermind.Runner --Sync.UseGethLimitsInFastBlocks=true --Sync.FastSync=true --HealthChecks.UIEnabled=true --HealthChecks.Enabled=true --JsonRpc.JwtSecretFile=/var/lib/nethermind/gnosis/jwt-secret --JsonRpc.EnginePort=8551 --datadir=/var/lib/nethermind/gnosis --config=xdai\r\n\r\n\r\ncontext: working on a Guix service to start Nethermind. it's started as non-root, under a custom user and group.\r\n\r\n@AntiD2ta shall i report this as a new issue? or is this a user error?\r\n\r\nfull log:\r\n\r\n```\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.5317|Nethermind starting initialization.\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7028|Loading embedded plugins\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7029|  Found plugin type Nethermind.Consensus.AuRa.AuRaPlugin\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7029|  Found plugin type Nethermind.Consensus.Clique.CliquePlugin\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7030|  Found plugin type Nethermind.Consensus.Ethash.EthashPlugin\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7030|  Found plugin type Nethermind.Consensus.Ethash.NethDevPlugin\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7030|  Found plugin type Nethermind.Hive.HivePlugin\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7030|  Found plugin type Nethermind.UPnP.Plugin.UPnPPlugin\r\n2022-12-19 00:56:24 Resolved executing directory as /gnu/store/24zb6izdz5l0l6cd65fb8mmvlwb6gmwm-nethermind-binary-1.14.7/share/nethermind-binary-1.14.\r\n7.\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7553|Loading 9 assemblies from /gnu/store/24zb6izdz5l0l6cd65fb8mmvlwb6gmwm-nethermind-binary-1.14.7/share/neth\r\nermind-binary-1.14.7/plugins\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7555|Loading assembly Nethermind.Merge.AuRa\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7601|  Found plugin type Nethermind.Merge.AuRa\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7601|Loading assembly Nethermind.Merge.Plugin\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7690|  Found plugin type Nethermind.Merge.Plugin\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7690|Loading assembly Nethermind.HealthChecks\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7774|  Found plugin type Nethermind.HealthChecks\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7774|Loading assembly Nethermind.AccountAbstraction\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7828|  Found plugin type Nethermind.AccountAbstraction\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7828|Loading assembly Nethermind.Mev\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7909|  Found plugin type Nethermind.Mev\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7909|Loading assembly Nethermind.Init\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.7933|Loading assembly Nethermind.Consensus.AuRa\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.8001|Loading assembly Nethermind.Api\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.8053|Loading assembly Nethermind.EthStats\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.8074|  Found plugin type Nethermind.EthStats\r\n2022-12-19 00:56:24 2022-12-19 00-56-09.9664|Loading standard NLog.config file from /gnu/store/24zb6izdz5l0l6cd65fb8mmvlwb6gmwm-nethermind-binary-1.14\r\n.7/share/nethermind-binary-1.14.7/NLog.config.\r\n2022-12-19 00:56:24 2022-12-19 00-56-10.8489|NLog.config loaded in 882ms.\r\n2022-12-19 00:56:24 2022-12-19 00-56-10.8574|Reading config file from /gnu/store/24zb6izdz5l0l6cd65fb8mmvlwb6gmwm-nethermind-binary-1.14.7/share/nethe\r\nrmind-binary-1.14.7/configs/xdai.cfg\r\n2022-12-19 00:56:24 2022-12-19 00-56-11.6494|Configuration initialized.\r\n2022-12-19 00:56:24 2022-12-19 00-56-11.6607|Setting BaseDbPath to: /var/lib/nethermind/gnosis/nethermind_db/xdai, from: nethermind_db/xdai\r\n2022-12-19 00:56:24 2022-12-19 00-56-11.6608|Setting KeyStoreDirectory to: /var/lib/nethermind/gnosis/keystore, from: keystore\r\n2022-12-19 00:56:24 2022-12-19 00-56-11.6608|Setting LogDirectory to: /var/lib/nethermind/gnosis/logs, from: logs\r\n2022-12-19 00:56:24 2022-12-19 00:56:11.6960|RocksDb Version: 6.29.3 \r\n2022-12-19 00:56:24 2022-12-19 00:56:11.7353|Loading chainspec from embedded resources: /gnu/store/24zb6izdz5l0l6cd65fb8mmvlwb6gmwm-nethermind-binary-\r\n1.14.7/share/nethermind-binary-1.14.7/chainspec/xdai.json \r\n2022-12-19 00:56:24 2022-12-19 00:56:12.4086|Using http://ipv4.icanhazip.com to get external ip \r\n2022-12-19 00:56:24 2022-12-19 00:56:12.8262|Setting up memory allowances \r\n2022-12-19 00:56:24 2022-12-19 00:56:12.8262|  memory hint:        768MB \r\n2022-12-19 00:56:24 2022-12-19 00:56:12.8262|  general memory:     32MB \r\n2022-12-19 00:56:24 2022-12-19 00:56:12.8262|  peers memory:       50MB \r\n2022-12-19 00:56:24 2022-12-19 00:56:12.8297|  Netty memory:       33MB \r\n2022-12-19 00:56:24 2022-12-19 00:56:12.8297|  mempool memory:     114MB \r\n2022-12-19 00:56:24 2022-12-19 00:56:12.8297|  fast blocks memory: 53MB \r\n2022-12-19 00:56:24 2022-12-19 00:56:12.8297|  trie memory:        96MB \r\n2022-12-19 00:56:24 2022-12-19 00:56:12.8454|  DB memory:          387MB \r\n2022-12-19 00:56:24 2022-12-19 00:56:13.1844|Generating private key for the node (no node key in configuration) - stored in plain + key store for JSON\r\n RPC unlocking \r\n2022-12-19 00:56:24 2022-12-19 00:56:17.9453|Store this password for unlocking the node key for JSON RPC - this is not secure - this log message will \r\nbe in your log files. Use only in DEV contexts. \r\n2022-12-19 00:56:24 2022-12-19 00:56:18.0093|Step SetupKeyStore            failed after 4837ms System.Security.Cryptography.CryptographicException: An\r\n error occurred while trying to encrypt the provided data. Refer to the inner exception for more information. For more information go to http://aka.ms\r\n/dataprotectionwarning\r\n2022-12-19 00:56:24  ---> System.UnauthorizedAccessException: Access to the path '/Nethermind' is denied.\r\n2022-12-19 00:56:24  ---> System.IO.IOException: Permission denied\r\n2022-12-19 00:56:24    --- End of inner exception stack trace ---\r\n2022-12-19 00:56:24    at System.IO.FileSystem.CreateDirectory(String fullPath)\r\n2022-12-19 00:56:24    at System.IO.DirectoryInfo.Create()\r\n2022-12-19 00:56:24    at Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository.GetAllElementsCore()+MoveNext()\r\n2022-12-19 00:56:24    at System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)\r\n2022-12-19 00:56:24    at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)\r\n2022-12-19 00:56:24    at Microsoft.AspNetCore.DataProtection.Repositories.FileSystemXmlRepository.GetAllElements()\r\n2022-12-19 00:56:24    at Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager.GetAllKeys()\r\n2022-12-19 00:56:24    at Microsoft.AspNetCore.DataProtection.KeyManagement.KeyRingProvider.CreateCacheableKeyRingCore(DateTimeOffset now, IKey keyJus\r\ntAdded)\r\n2022-12-19 00:56:24    at Microsoft.AspNetCore.DataProtection.KeyManagement.KeyRingProvider.Microsoft.AspNetCore.DataProtection.KeyManagement.Internal\r\n.ICacheableKeyRingProvider.GetCacheableKeyRing(DateTimeOffset now)\r\n2022-12-19 00:56:24    at Microsoft.AspNetCore.DataProtection.KeyManagement.KeyRingProvider.GetCurrentKeyRingCore(DateTime utcNow, Boolean forceRefres\r\nh)\r\n2022-12-19 00:56:24    at Microsoft.AspNetCore.DataProtection.KeyManagement.KeyRingProvider.GetCurrentKeyRing()\r\n2022-12-19 00:56:24    at Microsoft.AspNetCore.DataProtection.KeyManagement.KeyRingBasedDataProtector.Protect(Byte[] plaintext)\r\n2022-12-19 00:56:24    --- End of inner exception stack trace ---\r\n2022-12-19 00:56:24    at Microsoft.AspNetCore.DataProtection.KeyManagement.KeyRingBasedDataProtector.Protect(Byte[] plaintext)\r\n2022-12-19 00:56:24    at Nethermind.Crypto.ProtectedData.AspNetWrapper.Protect(Byte[] userData, Byte[] optionalEntropy, DataProtectionScope scope)\r\n2022-12-19 00:56:24    at Nethermind.Crypto.ProtectedData.Protect(Byte[] userData, Byte[] optionalEntropy, DataProtectionScope scope)\r\n2022-12-19 00:56:24    at Nethermind.Crypto.ProtectedData`1.Protect(Byte[] data)\r\n2022-12-19 00:56:24    at Nethermind.Crypto.ProtectedData`1..ctor(Byte[] data, ICryptoRandom random, ITimestamper timestamper)\r\n2022-12-19 00:56:24    at Nethermind.Crypto.ProtectedPrivateKey..ctor(PrivateKey privateKey, ICryptoRandom random, ITimestamper timestamper)\r\n2022-12-19 00:56:24    at Nethermind.Wallet.NodeKeyManager.<LoadNodeKey>g__LoadKeyFromFile|9_0()\r\n2022-12-19 00:56:24    at Nethermind.Wallet.NodeKeyManager.LoadNodeKey()\r\n2022-12-19 00:56:24    at Nethermind.Init.Steps.SetupKeyStore.<>c__DisplayClass2_0.<Execute>b__0()\r\n2022-12-19 00:56:24    at System.Threading.Tasks.Task.InnerInvoke()\r\n2022-12-19 00:56:24    at System.Threading.Tasks.Task.<>c.<.cctor>b__272_0(Object obj)\r\n2022-12-19 00:56:24    at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, \r\nContextCallback callback, Object state)\r\n2022-12-19 00:56:24 --- End of stack trace from previous location ---\r\n2022-12-19 00:56:24    at System.Threading.ExecutionContext.RunFromThreadPoolDispatchLoop(Thread threadPoolThread, ExecutionContext executionContext, \r\nContextCallback callback, Object state)\r\n2022-12-19 00:56:24    at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)\r\n2022-12-19 00:56:24 --- End of stack trace from previous location ---\r\n2022-12-19 00:56:24    at Nethermind.Init.Steps.SetupKeyStore.Execute(CancellationToken cancellationToken)\r\n2022-12-19 00:56:24    at Nethermind.Init.Steps.EthereumStepsManager.ExecuteStep(IStep step, StepInfo stepInfo, CancellationToken cancellationToken)\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1356912662/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1359548287",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/3510#issuecomment-1359548287",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3510",
    "id": 1359548287,
    "node_id": "IC_kwDOBggaLc5RCQ9_",
    "user": {
      "login": "AntiD2ta",
      "id": 46824157,
      "node_id": "MDQ6VXNlcjQ2ODI0MTU3",
      "avatar_url": "https://avatars.githubusercontent.com/u/46824157?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AntiD2ta",
      "html_url": "https://github.com/AntiD2ta",
      "followers_url": "https://api.github.com/users/AntiD2ta/followers",
      "following_url": "https://api.github.com/users/AntiD2ta/following{/other_user}",
      "gists_url": "https://api.github.com/users/AntiD2ta/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AntiD2ta/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AntiD2ta/subscriptions",
      "organizations_url": "https://api.github.com/users/AntiD2ta/orgs",
      "repos_url": "https://api.github.com/users/AntiD2ta/repos",
      "events_url": "https://api.github.com/users/AntiD2ta/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AntiD2ta/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-20T15:16:21Z",
    "updated_at": "2022-12-20T15:16:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "@attila-lendvai thanks for reporting. It seems to me this is an user error. By any chance are you keen to join our discord server (general channel) and get a more dynamic and faster feedback flow? You will get all the help you need there. If you can't join our server, then please report this in a separate issue.\r\n\r\nYou can find our discord server URL in our official website: https://nethermind.io",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1359548287/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1362216350",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/3510#issuecomment-1362216350",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3510",
    "id": 1362216350,
    "node_id": "IC_kwDOBggaLc5RMcWe",
    "user": {
      "login": "attila-lendvai",
      "id": 840345,
      "node_id": "MDQ6VXNlcjg0MDM0NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/840345?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/attila-lendvai",
      "html_url": "https://github.com/attila-lendvai",
      "followers_url": "https://api.github.com/users/attila-lendvai/followers",
      "following_url": "https://api.github.com/users/attila-lendvai/following{/other_user}",
      "gists_url": "https://api.github.com/users/attila-lendvai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/attila-lendvai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/attila-lendvai/subscriptions",
      "organizations_url": "https://api.github.com/users/attila-lendvai/orgs",
      "repos_url": "https://api.github.com/users/attila-lendvai/repos",
      "events_url": "https://api.github.com/users/attila-lendvai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/attila-lendvai/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-21T23:27:06Z",
    "updated_at": "2022-12-21T23:27:06Z",
    "author_association": "NONE",
    "body": "@AntiD2ta since then i have found an open issue that seems to be about my error (with a proposed PR to fix it):\r\n\r\nhttps://github.com/NethermindEth/nethermind/issues/4305 \r\n\r\ni also joined the discord channel, you can catch me there, but i think we should use that issue to discuss it.",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1362216350/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
