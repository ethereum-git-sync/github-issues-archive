{
  "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2849",
  "repository_url": "https://api.github.com/repos/NethermindEth/nethermind",
  "labels_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2849/labels{/name}",
  "comments_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2849/comments",
  "events_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2849/events",
  "html_url": "https://github.com/NethermindEth/nethermind/issues/2849",
  "id": 823053960,
  "node_id": "MDU6SXNzdWU4MjMwNTM5NjA=",
  "number": 2849,
  "title": "DB problem when upgrading from 1.8 to 1.10",
  "user": {
    "login": "tkstanczak",
    "id": 498913,
    "node_id": "MDQ6VXNlcjQ5ODkxMw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tkstanczak",
    "html_url": "https://github.com/tkstanczak",
    "followers_url": "https://api.github.com/users/tkstanczak/followers",
    "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
    "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
    "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
    "repos_url": "https://api.github.com/users/tkstanczak/repos",
    "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2021-03-05T12:48:30Z",
  "updated_at": "2021-06-17T11:21:55Z",
  "closed_at": "2021-06-17T11:21:54Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Mar 05 07:14:03 archivenode101 Nethermind.Runner[25308]: 2021-03-05 07:14:03.5139|Found 11211 blocks to load from DB starting from current head block 11965316 (0xf7e2a2...82b397)\r\nMar 05 07:14:03 archivenode101 Nethermind.Runner[25308]: 2021-03-05 07:14:03.5654|BlockchainProcessor encountered an exception. System.IndexOutOfRangeException: Index was outside the bounds of the array.\r\nMar 05 07:14:03 archivenode101 Nethermind.Runner[25308]:    at Nethermind.Core.Caching.LruCache`2.NodeRemove(Int32 i, Boolean cleanValues)\r\nMar 05 07:14:03 archivenode101 Nethermind.Runner[25308]:    at Nethermind.Core.Caching.LruCache`2.Replace(TKey key, TValue value)\r\nMar 05 07:14:03 archivenode101 Nethermind.Runner[25308]:    at Nethermind.Core.Caching.LruCache`2.Set(TKey key, TValue val)",
  "closed_by": {
    "login": "tkstanczak",
    "id": 498913,
    "node_id": "MDQ6VXNlcjQ5ODkxMw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tkstanczak",
    "html_url": "https://github.com/tkstanczak",
    "followers_url": "https://api.github.com/users/tkstanczak/followers",
    "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
    "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
    "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
    "repos_url": "https://api.github.com/users/tkstanczak/repos",
    "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2849/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2849/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/797537567",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/2849#issuecomment-797537567",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2849",
    "id": 797537567,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5NzUzNzU2Nw==",
    "user": {
      "login": "rhaenni",
      "id": 30432101,
      "node_id": "MDQ6VXNlcjMwNDMyMTAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/30432101?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rhaenni",
      "html_url": "https://github.com/rhaenni",
      "followers_url": "https://api.github.com/users/rhaenni/followers",
      "following_url": "https://api.github.com/users/rhaenni/following{/other_user}",
      "gists_url": "https://api.github.com/users/rhaenni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rhaenni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rhaenni/subscriptions",
      "organizations_url": "https://api.github.com/users/rhaenni/orgs",
      "repos_url": "https://api.github.com/users/rhaenni/repos",
      "events_url": "https://api.github.com/users/rhaenni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rhaenni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-12T14:50:46Z",
    "updated_at": "2021-03-12T14:51:42Z",
    "author_association": "NONE",
    "body": "I encountered this problem. I have now also tested with 1.10.37 and instead of the LruCache error above I am getting a new error (and node doesn't process blocks):\r\n\r\n```\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]: 2021-03-12 15:43:43.7534|Building ethash cache for epoch 401\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]: 2021-03-12 15:43:43.7534|Building ethash cache for epoch 400\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]: 2021-03-12 15:43:43.9737|BlockchainProcessor encountered an exception. System.InvalidOperationException: The LinkedList is empty.\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at System.Collections.Generic.LinkedList`1.RemoveFirst()\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.Core.Caching.LruCache`2.Replace(TKey key, TValue value)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.Core.Caching.LruCache`2.Set(TKey key, TValue val)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.Trie.CachingStore.get_Item(Byte[] key)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.Trie.Pruning.TrieStore.LoadRlp(Keccak keccak)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.Trie.TrieNode.ResolveNode(ITrieNodeResolver tree)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.Trie.PatriciaTree.Run(Span`1 updatePath, Int32 nibblesCount, Byte[] updateValue, Boolean isUpdate, Boolean ignoreMissingDelete, Keccak startRootHash)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.Trie.PatriciaTree.Get(Span`1 rawKey, Keccak rootHash)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.State.StateTree.Get(Address address, Keccak rootHash)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.State.StateProvider.GetState(Address address)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.State.StateProvider.GetAndAddToCache(Address address)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.State.StateProvider.AccountExists(Address address)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.Evm.TransactionProcessor.Execute(Transaction transaction, BlockHeader block, ITxTracer txTracer, Boolean isCall)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.Evm.TransactionProcessor.Execute(Transaction transaction, BlockHeader block, ITxTracer txTracer)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.Blockchain.Processing.BlockProcessor.ProcessTransactions(Block block, ProcessingOptions processingOptions, IBlockTracer blockTracer)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.Blockchain.Processing.BlockProcessor.ProcessBlock(Block block, IBlockTracer blockTracer, ProcessingOptions options)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.Blockchain.Processing.BlockProcessor.ProcessOne(Block suggestedBlock, ProcessingOptions options, IBlockTracer blockTracer)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.Blockchain.Processing.BlockProcessor.Process(Keccak newBranchStateRoot, List`1 suggestedBlocks, ProcessingOptions options, IBlockTracer blockTracer)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.Blockchain.Processing.BlockchainProcessor.ProcessBranch(ProcessingBranch processingBranch, ProcessingOptions options, IBlockTracer tracer)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.Blockchain.Processing.BlockchainProcessor.Process(Block suggestedBlock, ProcessingOptions options, IBlockTracer tracer)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at Nethermind.Blockchain.Processing.BlockchainProcessor.RunProcessingLoop()\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at System.Threading.Tasks.Task.InnerInvoke()\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at System.Threading.Tasks.Task.<>c.<.cctor>b__277_0(Object obj)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]: --- End of stack trace from previous location ---\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)\r\nMar 12 15:43:43 archivenode101 Nethermind.Runner[197146]:    at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)\r\n```\r\n\r\nTo summarize: I have a node running perfectly fine on 1.8.105, when I upgrade nethermind to 1.10.x I encounter the problems mentioned here, when I revert back to 1.8.105 it runs fine again. ",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/797537567/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/798338175",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/2849#issuecomment-798338175",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2849",
    "id": 798338175,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5ODMzODE3NQ==",
    "user": {
      "login": "tkstanczak",
      "id": 498913,
      "node_id": "MDQ6VXNlcjQ5ODkxMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tkstanczak",
      "html_url": "https://github.com/tkstanczak",
      "followers_url": "https://api.github.com/users/tkstanczak/followers",
      "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
      "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
      "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
      "repos_url": "https://api.github.com/users/tkstanczak/repos",
      "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-13T13:01:36Z",
    "updated_at": "2021-03-13T13:01:36Z",
    "author_association": "MEMBER",
    "body": "@rhaenni can you check what is your --Init.MemoryHint setting?\r\n(do you keep it default or override it?)",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/798338175/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/798345792",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/2849#issuecomment-798345792",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2849",
    "id": 798345792,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5ODM0NTc5Mg==",
    "user": {
      "login": "rhaenni",
      "id": 30432101,
      "node_id": "MDQ6VXNlcjMwNDMyMTAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/30432101?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rhaenni",
      "html_url": "https://github.com/rhaenni",
      "followers_url": "https://api.github.com/users/rhaenni/followers",
      "following_url": "https://api.github.com/users/rhaenni/following{/other_user}",
      "gists_url": "https://api.github.com/users/rhaenni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rhaenni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rhaenni/subscriptions",
      "organizations_url": "https://api.github.com/users/rhaenni/orgs",
      "repos_url": "https://api.github.com/users/rhaenni/repos",
      "events_url": "https://api.github.com/users/rhaenni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rhaenni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-13T13:06:37Z",
    "updated_at": "2021-03-13T13:22:33Z",
    "author_association": "NONE",
    "body": "overridden in config file as ` \"MemoryHint\": 58304000000`",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/798345792/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/799834705",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/2849#issuecomment-799834705",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2849",
    "id": 799834705,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5OTgzNDcwNQ==",
    "user": {
      "login": "rhaenni",
      "id": 30432101,
      "node_id": "MDQ6VXNlcjMwNDMyMTAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/30432101?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rhaenni",
      "html_url": "https://github.com/rhaenni",
      "followers_url": "https://api.github.com/users/rhaenni/followers",
      "following_url": "https://api.github.com/users/rhaenni/following{/other_user}",
      "gists_url": "https://api.github.com/users/rhaenni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rhaenni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rhaenni/subscriptions",
      "organizations_url": "https://api.github.com/users/rhaenni/orgs",
      "repos_url": "https://api.github.com/users/rhaenni/repos",
      "events_url": "https://api.github.com/users/rhaenni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rhaenni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-15T23:43:25Z",
    "updated_at": "2021-03-15T23:43:25Z",
    "author_association": "NONE",
    "body": "I have tried setting MemoryHint to the default `\"MemoryHint\": 4096000000` and using 1.10.37 it now works fine! So only when I set MemoryHint to 58GB I am getting the LinkedList error above. ",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/799834705/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/819099930",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/2849#issuecomment-819099930",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2849",
    "id": 819099930,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxOTA5OTkzMA==",
    "user": {
      "login": "nuevoalex",
      "id": 3839700,
      "node_id": "MDQ6VXNlcjM4Mzk3MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3839700?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nuevoalex",
      "html_url": "https://github.com/nuevoalex",
      "followers_url": "https://api.github.com/users/nuevoalex/followers",
      "following_url": "https://api.github.com/users/nuevoalex/following{/other_user}",
      "gists_url": "https://api.github.com/users/nuevoalex/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nuevoalex/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nuevoalex/subscriptions",
      "organizations_url": "https://api.github.com/users/nuevoalex/orgs",
      "repos_url": "https://api.github.com/users/nuevoalex/repos",
      "events_url": "https://api.github.com/users/nuevoalex/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nuevoalex/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-13T22:45:06Z",
    "updated_at": "2021-04-13T22:45:06Z",
    "author_association": "NONE",
    "body": "This appears to still be an issue. I'm seeing this same error when upgrading from 1.10.46 to 1.10.56 and it is only resolved by dropping the memory hint. Is this on the radar to be addressed? Thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/819099930/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/863156382",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/2849#issuecomment-863156382",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2849",
    "id": 863156382,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MzE1NjM4Mg==",
    "user": {
      "login": "tkstanczak",
      "id": 498913,
      "node_id": "MDQ6VXNlcjQ5ODkxMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tkstanczak",
      "html_url": "https://github.com/tkstanczak",
      "followers_url": "https://api.github.com/users/tkstanczak/followers",
      "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
      "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
      "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
      "repos_url": "https://api.github.com/users/tkstanczak/repos",
      "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-17T11:21:54Z",
    "updated_at": "2021-06-17T11:21:54Z",
    "author_association": "MEMBER",
    "body": "Fixed @rhaenni @nuevoalex ",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/863156382/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
