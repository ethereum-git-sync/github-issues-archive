{
  "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2139",
  "repository_url": "https://api.github.com/repos/NethermindEth/nethermind",
  "labels_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2139/labels{/name}",
  "comments_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2139/comments",
  "events_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2139/events",
  "html_url": "https://github.com/NethermindEth/nethermind/issues/2139",
  "id": 657535172,
  "node_id": "MDU6SXNzdWU2NTc1MzUxNzI=",
  "number": 2139,
  "title": "Docker image - root and datadir",
  "user": {
    "login": "tkstanczak",
    "id": 498913,
    "node_id": "MDQ6VXNlcjQ5ODkxMw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tkstanczak",
    "html_url": "https://github.com/tkstanczak",
    "followers_url": "https://api.github.com/users/tkstanczak/followers",
    "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
    "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
    "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
    "repos_url": "https://api.github.com/users/tkstanczak/repos",
    "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1024161790,
      "node_id": "MDU6TGFiZWwxMDI0MTYxNzkw",
      "url": "https://api.github.com/repos/NethermindEth/nethermind/labels/devops",
      "name": "devops",
      "color": "dbbd11",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "matilote",
    "id": 33068017,
    "node_id": "MDQ6VXNlcjMzMDY4MDE3",
    "avatar_url": "https://avatars.githubusercontent.com/u/33068017?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/matilote",
    "html_url": "https://github.com/matilote",
    "followers_url": "https://api.github.com/users/matilote/followers",
    "following_url": "https://api.github.com/users/matilote/following{/other_user}",
    "gists_url": "https://api.github.com/users/matilote/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/matilote/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/matilote/subscriptions",
    "organizations_url": "https://api.github.com/users/matilote/orgs",
    "repos_url": "https://api.github.com/users/matilote/repos",
    "events_url": "https://api.github.com/users/matilote/events{/privacy}",
    "received_events_url": "https://api.github.com/users/matilote/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "matilote",
      "id": 33068017,
      "node_id": "MDQ6VXNlcjMzMDY4MDE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33068017?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matilote",
      "html_url": "https://github.com/matilote",
      "followers_url": "https://api.github.com/users/matilote/followers",
      "following_url": "https://api.github.com/users/matilote/following{/other_user}",
      "gists_url": "https://api.github.com/users/matilote/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matilote/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matilote/subscriptions",
      "organizations_url": "https://api.github.com/users/matilote/orgs",
      "repos_url": "https://api.github.com/users/matilote/repos",
      "events_url": "https://api.github.com/users/matilote/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matilote/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2020-07-15T17:43:10Z",
  "updated_at": "2021-07-30T08:36:23Z",
  "closed_at": "2021-01-05T13:25:55Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "AlexSSD7Today at 18:30\r\nok, got it\r\nI see your docker image is executed as root\r\n\r\nwhich is not good\r\nanyways, I tried to run with -u flag (which specifies the user)\r\nand it throws permission error because it cannot access the /nethermind directory\r\nis there a way to not use /nethermind directory?\r\nI have another docker volume where I want everything to be stored\r\nis it accomplishable?\r\ntkstanczakToday at 18:33\r\n@matilote willbe able to look at this - I think we had this conversation in the past and I would like to hear from him tomorrow if it would cause a lot of trouble to run it as a user\r\nyou can change the directory by configuring volumes mappings\r\nin your Dockerfile / Docker compose\r\nAlexSSD7Today at 18:34\r\nI don't use neither dockerfiles nor docker compose\r\ntkstanczakToday at 18:34\r\nhttps://docs.nethermind.io/nethermind/ethereum-client/dockers\r\nDockers\r\nNethermind Dockers instructions\r\n\r\nVolumes\r\nTo fully override a configuration file, you need to use a volume:\r\n-v /home/user/mainnet.cfg:/nethermind/configs/mainnet.cfg\r\nIn order to map an internal database to a local volume, you need to map /nethermind/nethermind_db/:\r\n-v /home/user/nethermind_db:/nethermind/nethermind_db\r\nLogs can be mapped with the following command:\r\n-v /home/user/logs:/nethermind/logs\r\nKeystore:\r\n-v /home/user/keystore:/nethermind/keystore\r\nNlog:\r\n-v /home/user/NLog.config:/nethermind/NLog.config\r\nMore detailed NLog configuration can be found here.\r\nAlexSSD7Today at 18:35\r\nI have a docker volume, and it is possible to mount it to only one directory\r\neverything is good unless it tries to access /nethermind/Nethermind directory\r\nwith geth I can just specify --datadir\r\nand everything will be placed right to that directory\r\nis it possible to do it with the nethermind?",
  "closed_by": {
    "login": "matilote",
    "id": 33068017,
    "node_id": "MDQ6VXNlcjMzMDY4MDE3",
    "avatar_url": "https://avatars.githubusercontent.com/u/33068017?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/matilote",
    "html_url": "https://github.com/matilote",
    "followers_url": "https://api.github.com/users/matilote/followers",
    "following_url": "https://api.github.com/users/matilote/following{/other_user}",
    "gists_url": "https://api.github.com/users/matilote/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/matilote/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/matilote/subscriptions",
    "organizations_url": "https://api.github.com/users/matilote/orgs",
    "repos_url": "https://api.github.com/users/matilote/repos",
    "events_url": "https://api.github.com/users/matilote/events{/privacy}",
    "received_events_url": "https://api.github.com/users/matilote/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2139/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2139/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/658914873",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/2139#issuecomment-658914873",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2139",
    "id": 658914873,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1ODkxNDg3Mw==",
    "user": {
      "login": "AlexSSD7",
      "id": 43043344,
      "node_id": "MDQ6VXNlcjQzMDQzMzQ0",
      "avatar_url": "https://avatars.githubusercontent.com/u/43043344?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AlexSSD7",
      "html_url": "https://github.com/AlexSSD7",
      "followers_url": "https://api.github.com/users/AlexSSD7/followers",
      "following_url": "https://api.github.com/users/AlexSSD7/following{/other_user}",
      "gists_url": "https://api.github.com/users/AlexSSD7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AlexSSD7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AlexSSD7/subscriptions",
      "organizations_url": "https://api.github.com/users/AlexSSD7/orgs",
      "repos_url": "https://api.github.com/users/AlexSSD7/repos",
      "events_url": "https://api.github.com/users/AlexSSD7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AlexSSD7/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-15T17:59:16Z",
    "updated_at": "2020-07-15T19:25:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "To improve the Nethermind DevOps experience, the docker image should be more portable and friendly for custom user permissions. Right now the docker image is being executed by root, which is not a good practice.\r\n\r\nThe permission problem can be solved by simply allowing the user to choose custom data directory. As example, I have one docker volume, and I want everything to be placed there.\r\n\r\nWith other ethereum clients, I can just do this:\r\n```sh\r\n# Geth\r\ndocker run -v my-volume:/ethdb ethereum/client-go --datadir /ethdb\r\n\r\n# OpenEthereum\r\ndocker run -v my-volume:/ethdb openethereum/openethereum --base-path /ethdb\r\n```\r\n\r\nTrying to run\r\n\r\n```\r\ndocker run -v my-volume:/ethdb nethermind/nethermind --baseDbPath /ethdb\r\n```\r\n\r\nfails because nethermind tries to access `/nethermind/Nethermind` directory, and custom user doesn't has any access to it.",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/658914873/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/659261332",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/2139#issuecomment-659261332",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2139",
    "id": 659261332,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1OTI2MTMzMg==",
    "user": {
      "login": "matilote",
      "id": 33068017,
      "node_id": "MDQ6VXNlcjMzMDY4MDE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33068017?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matilote",
      "html_url": "https://github.com/matilote",
      "followers_url": "https://api.github.com/users/matilote/followers",
      "following_url": "https://api.github.com/users/matilote/following{/other_user}",
      "gists_url": "https://api.github.com/users/matilote/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matilote/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matilote/subscriptions",
      "organizations_url": "https://api.github.com/users/matilote/orgs",
      "repos_url": "https://api.github.com/users/matilote/repos",
      "events_url": "https://api.github.com/users/matilote/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matilote/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-16T08:53:12Z",
    "updated_at": "2020-07-16T08:53:12Z",
    "author_association": "MEMBER",
    "body": "@AlexSSD7 I am aware of this non-root practice and it certainly might be helpful in some cases, however non-root containers are usually causing troubles when it comes their usage. You can always apply some extra security layers to your containers by using custom AppArmor profiles, dropping capabilities `--cap-drop ALL`  or you can use linux namespaces and user re-mapping (https://docs.docker.com/engine/security/userns-remap/).\r\n\r\nAs for the volume mapping, please try using this command instead:\r\n```\r\ndocker run my-volume:/ethdb/nethermind_db nethermind/nethermind --baseDbPath /ethdb\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/659261332/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/659263965",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/2139#issuecomment-659263965",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2139",
    "id": 659263965,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1OTI2Mzk2NQ==",
    "user": {
      "login": "AlexSSD7",
      "id": 43043344,
      "node_id": "MDQ6VXNlcjQzMDQzMzQ0",
      "avatar_url": "https://avatars.githubusercontent.com/u/43043344?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AlexSSD7",
      "html_url": "https://github.com/AlexSSD7",
      "followers_url": "https://api.github.com/users/AlexSSD7/followers",
      "following_url": "https://api.github.com/users/AlexSSD7/following{/other_user}",
      "gists_url": "https://api.github.com/users/AlexSSD7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AlexSSD7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AlexSSD7/subscriptions",
      "organizations_url": "https://api.github.com/users/AlexSSD7/orgs",
      "repos_url": "https://api.github.com/users/AlexSSD7/repos",
      "events_url": "https://api.github.com/users/AlexSSD7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AlexSSD7/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-16T08:57:57Z",
    "updated_at": "2020-07-16T09:03:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "Running non-system applications as root is very dangerous and is considered as a really bad practice.\r\n\r\nI'm talking about giving the ability to run containers as a non-root user. Not about dropping the root support completely.\r\n\r\nIf we're talking about security-critical production server deployment, there's no way you can use root.",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/659263965/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/659270493",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/2139#issuecomment-659270493",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2139",
    "id": 659270493,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1OTI3MDQ5Mw==",
    "user": {
      "login": "AlexSSD7",
      "id": 43043344,
      "node_id": "MDQ6VXNlcjQzMDQzMzQ0",
      "avatar_url": "https://avatars.githubusercontent.com/u/43043344?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AlexSSD7",
      "html_url": "https://github.com/AlexSSD7",
      "followers_url": "https://api.github.com/users/AlexSSD7/followers",
      "following_url": "https://api.github.com/users/AlexSSD7/following{/other_user}",
      "gists_url": "https://api.github.com/users/AlexSSD7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AlexSSD7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AlexSSD7/subscriptions",
      "organizations_url": "https://api.github.com/users/AlexSSD7/orgs",
      "repos_url": "https://api.github.com/users/AlexSSD7/repos",
      "events_url": "https://api.github.com/users/AlexSSD7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AlexSSD7/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-16T09:04:48Z",
    "updated_at": "2020-07-16T09:05:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "Improving production grade deployment experience will help Nethermind to become more popular.",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/659270493/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/659481180",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/2139#issuecomment-659481180",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2139",
    "id": 659481180,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1OTQ4MTE4MA==",
    "user": {
      "login": "matilote",
      "id": 33068017,
      "node_id": "MDQ6VXNlcjMzMDY4MDE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33068017?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matilote",
      "html_url": "https://github.com/matilote",
      "followers_url": "https://api.github.com/users/matilote/followers",
      "following_url": "https://api.github.com/users/matilote/following{/other_user}",
      "gists_url": "https://api.github.com/users/matilote/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matilote/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matilote/subscriptions",
      "organizations_url": "https://api.github.com/users/matilote/orgs",
      "repos_url": "https://api.github.com/users/matilote/repos",
      "events_url": "https://api.github.com/users/matilote/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matilote/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-16T15:18:10Z",
    "updated_at": "2021-07-30T08:36:23Z",
    "author_association": "MEMBER",
    "body": "I will try removing root from Dockerfile and see how it affects usage experience",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/659481180/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/754634705",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/2139#issuecomment-754634705",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2139",
    "id": 754634705,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NDYzNDcwNQ==",
    "user": {
      "login": "matilote",
      "id": 33068017,
      "node_id": "MDQ6VXNlcjMzMDY4MDE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33068017?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matilote",
      "html_url": "https://github.com/matilote",
      "followers_url": "https://api.github.com/users/matilote/followers",
      "following_url": "https://api.github.com/users/matilote/following{/other_user}",
      "gists_url": "https://api.github.com/users/matilote/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matilote/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matilote/subscriptions",
      "organizations_url": "https://api.github.com/users/matilote/orgs",
      "repos_url": "https://api.github.com/users/matilote/repos",
      "events_url": "https://api.github.com/users/matilote/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matilote/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-05T13:25:55Z",
    "updated_at": "2021-01-05T13:25:55Z",
    "author_association": "MEMBER",
    "body": "Fixed with #2580",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/754634705/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/754635440",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/2139#issuecomment-754635440",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/2139",
    "id": 754635440,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NDYzNTQ0MA==",
    "user": {
      "login": "matilote",
      "id": 33068017,
      "node_id": "MDQ6VXNlcjMzMDY4MDE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/33068017?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/matilote",
      "html_url": "https://github.com/matilote",
      "followers_url": "https://api.github.com/users/matilote/followers",
      "following_url": "https://api.github.com/users/matilote/following{/other_user}",
      "gists_url": "https://api.github.com/users/matilote/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/matilote/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/matilote/subscriptions",
      "organizations_url": "https://api.github.com/users/matilote/orgs",
      "repos_url": "https://api.github.com/users/matilote/repos",
      "events_url": "https://api.github.com/users/matilote/events{/privacy}",
      "received_events_url": "https://api.github.com/users/matilote/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-05T13:27:11Z",
    "updated_at": "2021-01-05T13:27:11Z",
    "author_association": "MEMBER",
    "body": "non-dockers -> https://docs.nethermind.io/nethermind/ethereum-client/configuration#datadir\r\n\r\ndockers -> https://docs.nethermind.io/nethermind/ethereum-client/dockers#datadir",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/754635440/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
