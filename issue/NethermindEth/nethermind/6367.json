{
  "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/6367",
  "repository_url": "https://api.github.com/repos/NethermindEth/nethermind",
  "labels_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/6367/labels{/name}",
  "comments_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/6367/comments",
  "events_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/6367/events",
  "html_url": "https://github.com/NethermindEth/nethermind/issues/6367",
  "id": 2039789961,
  "node_id": "I_kwDOBggaLc55lLmJ",
  "number": 6367,
  "title": "When changing the websocket port, specifiying the --Json.EnabledModules flag, disables the \"eth\" module on the websocket endpoint.",
  "user": {
    "login": "northwestnodes-eric",
    "id": 100448003,
    "node_id": "U_kgDOBfy3Aw",
    "avatar_url": "https://avatars.githubusercontent.com/u/100448003?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/northwestnodes-eric",
    "html_url": "https://github.com/northwestnodes-eric",
    "followers_url": "https://api.github.com/users/northwestnodes-eric/followers",
    "following_url": "https://api.github.com/users/northwestnodes-eric/following{/other_user}",
    "gists_url": "https://api.github.com/users/northwestnodes-eric/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/northwestnodes-eric/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/northwestnodes-eric/subscriptions",
    "organizations_url": "https://api.github.com/users/northwestnodes-eric/orgs",
    "repos_url": "https://api.github.com/users/northwestnodes-eric/repos",
    "events_url": "https://api.github.com/users/northwestnodes-eric/events{/privacy}",
    "received_events_url": "https://api.github.com/users/northwestnodes-eric/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-12-13T14:07:01Z",
  "updated_at": "2023-12-14T17:09:55Z",
  "closed_at": "2023-12-14T17:09:55Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "**Description**\r\nWhen changing the websocket port, and specifiying the --Json.EnabledModules flag, the \"eth\" module is not enabled for that websocket endpoint. The \"eth\" module only remains enabled for the http endpoint.\r\n\r\n**Steps to Reproduce**\r\nIn order to BREAK the functionality:\r\n1. Launch Nethermind WITH: `--JsonRpc.EnabledModules [eth,evm,net,web3,health]` set.\r\n2. Change the websocket port: `--JsonRpc.WebSocketsPort 8546`.\r\n3. Launch client.\r\n4. The \"eth\" module is now UNAVAILABLE on the websocket endpoint.\r\n\r\nIn order to RESTORE the functionality:\r\n1. Launch Nethermind WITHOUT: `--JsonRpc.EnabledModules [eth,evm,net,web3,health]` set.\r\n2. Change the websocket port: `--JsonRpc.WebSocketsPort 8546`.\r\n3. Launch client.\r\n4. The \"eth\" module is now AVAILABLE on the websocket endpoint.\r\n\r\n**Actual behavior**\r\nThe Client will launch, but will not accept connections on the websocket port, as per the logs:\r\n```\r\nError when handling ID 2, eth_subscribe(newHeads) | {\"jsonrpc\":\"2.0\",\"error\":{\"code\":-32600,\"message\":\"eth_subscribe found but the containing module is disabled for the url 'http://<IP>:8546/', consider adding module in JsonRpcConfig.AdditionalRpcUrls for additional url, or to JsonRpcConfig.EnabledModules for default url\"},\"id\":2}\r\n```\r\n\r\nEven though the summary of \"this node\" in the logs indicates that it should. Note the RPC modules line, as well as the JSON RPC line:\r\n```\r\nDec 13 13:05:29 vm-eastus-mainnet-ethereum-rpc-01 nethermind[2389]: This node    : enode://...\r\nDec 13 13:05:29 vm-eastus-mainnet-ethereum-rpc-01 nethermind[2389]: RPC modules  : Eth, Net, Parity, Personal, Proof, Rpc, Subscribe, Trace, TxPool, Web3\r\nDec 13 13:05:29 vm-eastus-mainnet-ethereum-rpc-01 nethermind[2389]: Node address : 0x... (do not use as an account)\r\nDec 13 13:05:29 vm-eastus-mainnet-ethereum-rpc-01 nethermind[2389]: Mem est tx   :    82 MB\r\nDec 13 13:05:29 vm-eastus-mainnet-ethereum-rpc-01 nethermind[2389]: Mem est DB   :    16 MB\r\nDec 13 13:05:29 vm-eastus-mainnet-ethereum-rpc-01 nethermind[2389]: JSON RPC     : http://<IP>:8545/ ; http://<IP>:8546/ ; http://<IP>:8551/\r\nDec 13 13:05:29 vm-eastus-mainnet-ethereum-rpc-01 nethermind[2389]: Genesis hash : <HASH>\r\nDec 13 13:05:29 vm-eastus-mainnet-ethereum-rpc-01 nethermind[2389]: External IP  : <IP>\r\nDec 13 13:05:29 vm-eastus-mainnet-ethereum-rpc-01 nethermind[2389]: Ethereum     : tcp://<IP>:30303\r\nDec 13 13:05:29 vm-eastus-mainnet-ethereum-rpc-01 nethermind[2389]: Discovery    : udp://<IP>:30303\r\nDec 13 13:05:29 vm-eastus-mainnet-ethereum-rpc-01 nethermind[2389]: Client id    : Nethermind/v1.23.0+bcd3b8ae/linux-x64/dotnet7.0.14\r\nDec 13 13:05:29 vm-eastus-mainnet-ethereum-rpc-01 nethermind[2389]: Chainspec    : chainspec/foundation.json\r\nDec 13 13:05:29 vm-eastus-mainnet-ethereum-rpc-01 nethermind[2389]: Chain head   : 18777366 (0x67209e...1576e7)\r\nDec 13 13:05:29 vm-eastus-mainnet-ethereum-rpc-01 nethermind[2389]: Chain ID     : Mainnet\r\n```\r\n\r\n**Expected behavior**\r\nI expect there to be no specific difference between the set RPC/WS URLs and their modules.\r\n\r\n**Screenshots**\r\nN/A\r\n\r\n**Desktop (please complete the following information):**\r\nPlease provide the following information regarding your setup:\r\n - Operating System: Linux Ubuntu\r\n - Version: 22.04\r\n - Installation Method: PPA\r\n - Consensus Client: Lighthouse v4.5.0\r\n\r\n**Additional context**\r\nClient version: `Nethermind/v1.23.0+bcd3b8ae/linux-x64/dotnet7.0.14`\r\n\r\n**Logs**\r\nSee above.\r\n",
  "closed_by": {
    "login": "rubo",
    "id": 337518,
    "node_id": "MDQ6VXNlcjMzNzUxOA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/337518?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rubo",
    "html_url": "https://github.com/rubo",
    "followers_url": "https://api.github.com/users/rubo/followers",
    "following_url": "https://api.github.com/users/rubo/following{/other_user}",
    "gists_url": "https://api.github.com/users/rubo/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rubo/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rubo/subscriptions",
    "organizations_url": "https://api.github.com/users/rubo/orgs",
    "repos_url": "https://api.github.com/users/rubo/repos",
    "events_url": "https://api.github.com/users/rubo/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rubo/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/6367/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/6367/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1856242657",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/6367#issuecomment-1856242657",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/6367",
    "id": 1856242657,
    "node_id": "IC_kwDOBggaLc5upAPh",
    "user": {
      "login": "rubo",
      "id": 337518,
      "node_id": "MDQ6VXNlcjMzNzUxOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/337518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rubo",
      "html_url": "https://github.com/rubo",
      "followers_url": "https://api.github.com/users/rubo/followers",
      "following_url": "https://api.github.com/users/rubo/following{/other_user}",
      "gists_url": "https://api.github.com/users/rubo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rubo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rubo/subscriptions",
      "organizations_url": "https://api.github.com/users/rubo/orgs",
      "repos_url": "https://api.github.com/users/rubo/repos",
      "events_url": "https://api.github.com/users/rubo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rubo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-12-14T17:09:55Z",
    "updated_at": "2023-12-14T17:09:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "Weirdly, the `eth_subscribe` and `eth_unsubscribe` [methods](https://docs.nethermind.io/interacting/json-rpc-ns/eth#eth_subscribe) are implemented in the `subscribe` separately from the rest of the `eth` methods. Thus, when you set those namespaces yourself with `--JsonRpc.EnabledModules [...]`, you must also include `subscribe`.\r\n\r\nFeel free to reopen the issue if this doesn't solve your problem.",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1856242657/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
