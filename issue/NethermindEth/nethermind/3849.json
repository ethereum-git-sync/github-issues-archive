{
  "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3849",
  "repository_url": "https://api.github.com/repos/NethermindEth/nethermind",
  "labels_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3849/labels{/name}",
  "comments_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3849/comments",
  "events_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3849/events",
  "html_url": "https://github.com/NethermindEth/nethermind/issues/3849",
  "id": 1155181620,
  "node_id": "I_kwDOBggaLc5E2qw0",
  "number": 3849,
  "title": "`TrieException` (node is missing) error on Gnosis Chain archive node",
  "user": {
    "login": "varasev",
    "id": 33550681,
    "node_id": "MDQ6VXNlcjMzNTUwNjgx",
    "avatar_url": "https://avatars.githubusercontent.com/u/33550681?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/varasev",
    "html_url": "https://github.com/varasev",
    "followers_url": "https://api.github.com/users/varasev/followers",
    "following_url": "https://api.github.com/users/varasev/following{/other_user}",
    "gists_url": "https://api.github.com/users/varasev/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/varasev/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/varasev/subscriptions",
    "organizations_url": "https://api.github.com/users/varasev/orgs",
    "repos_url": "https://api.github.com/users/varasev/repos",
    "events_url": "https://api.github.com/users/varasev/events{/privacy}",
    "received_events_url": "https://api.github.com/users/varasev/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "jmederosalvarado",
    "id": 46798594,
    "node_id": "MDQ6VXNlcjQ2Nzk4NTk0",
    "avatar_url": "https://avatars.githubusercontent.com/u/46798594?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jmederosalvarado",
    "html_url": "https://github.com/jmederosalvarado",
    "followers_url": "https://api.github.com/users/jmederosalvarado/followers",
    "following_url": "https://api.github.com/users/jmederosalvarado/following{/other_user}",
    "gists_url": "https://api.github.com/users/jmederosalvarado/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jmederosalvarado/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jmederosalvarado/subscriptions",
    "organizations_url": "https://api.github.com/users/jmederosalvarado/orgs",
    "repos_url": "https://api.github.com/users/jmederosalvarado/repos",
    "events_url": "https://api.github.com/users/jmederosalvarado/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jmederosalvarado/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "jmederosalvarado",
      "id": 46798594,
      "node_id": "MDQ6VXNlcjQ2Nzk4NTk0",
      "avatar_url": "https://avatars.githubusercontent.com/u/46798594?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jmederosalvarado",
      "html_url": "https://github.com/jmederosalvarado",
      "followers_url": "https://api.github.com/users/jmederosalvarado/followers",
      "following_url": "https://api.github.com/users/jmederosalvarado/following{/other_user}",
      "gists_url": "https://api.github.com/users/jmederosalvarado/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jmederosalvarado/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jmederosalvarado/subscriptions",
      "organizations_url": "https://api.github.com/users/jmederosalvarado/orgs",
      "repos_url": "https://api.github.com/users/jmederosalvarado/repos",
      "events_url": "https://api.github.com/users/jmederosalvarado/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jmederosalvarado/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-03-01T10:50:52Z",
  "updated_at": "2022-08-31T17:59:20Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Hi,\r\n\r\nWe have a problem with an archive node for Blockscout on Gnosis Chain. Working on v1.12.3. It caught the `TrieException` error twice during a few months. Restart didn't help. Resyncing from scratch takes long time and network traffic, so we had to temporarily switch our Nethermind archive node to OpenEthereum.\r\n\r\nError log:\r\n\r\n```\r\nethereum    | 2022-02-28 23:33:03.1438|BlockchainProcessor encountered an exception. Nethermind.Trie.TrieException: Node 0x5b3773ce8d5f355ac3c0a77718152beb777120e103864ac09c3927a82763c1c1 is missing from the DB\r\nethereum    |    at Nethermind.Trie.Pruning.TrieStore.LoadRlp(Keccak keccak, IKeyValueStore keyValueStore) in /src/Nethermind/Nethermind.Trie/Pruning/TrieStore.cs:line 331\r\nethereum    |    at Nethermind.Trie.Pruning.ReadOnlyTrieStore.LoadRlp(Keccak hash) in /src/Nethermind/Nethermind.Trie/Pruning/ReadOnlyTrieStore.cs:line 41\r\nethereum    |    at Nethermind.Trie.TrieNode.ResolveNode(ITrieNodeResolver tree) in /src/Nethermind/Nethermind.Trie/TrieNode.cs:line 234\r\nethereum    |    at Nethermind.Trie.PatriciaTree.Run(Span`1 updatePath, Int32 nibblesCount, Byte[] updateValue, Boolean isUpdate, Boolean ignoreMissingDelete, Keccak startRootHash) in /src/Nethermind/Nethermind.Trie/PatriciaTree.cs:line 401\r\nethereum    |    at Nethermind.Trie.PatriciaTree.Get(Span`1 rawKey, Keccak rootHash) in /src/Nethermind/Nethermind.Trie/PatriciaTree.cs:line 319\r\nethereum    |    at Nethermind.State.StateTree.Get(Address address, Keccak rootHash) in /src/Nethermind/Nethermind.State/StateTree.cs:line 49\r\nethereum    |    at Nethermind.State.StateProvider.GetState(Address address) in /src/Nethermind/Nethermind.State/StateProvider.cs:line 659\r\nethereum    |    at Nethermind.State.StateProvider.GetAndAddToCache(Address address) in /src/Nethermind/Nethermind.State/StateProvider.cs:line 674\r\nethereum    |    at Nethermind.State.StateProvider.GetThroughCache(Address address) in /src/Nethermind/Nethermind.State/StateProvider.cs:line 695\r\nethereum    |    at Nethermind.State.StateProvider.GetCodeHash(Address address) in /src/Nethermind/Nethermind.State/StateProvider.cs:line 311\r\nethereum    |    at Nethermind.State.IReadOnlyStateProvider.IsContract(Address address) in /src/Nethermind/Nethermind.State/IReadOnlyStateProvider.cs:line 39\r\nethereum    |    at Nethermind.Evm.TransactionProcessing.ReadOnlyTransactionProcessor.IsContractDeployed(Address address) in /src/Nethermind/Nethermind.Evm/TransactionProcessing/ReadOnlyTransactionProcessor.cs:line 55\r\nethereum    |    at Nethermind.Blockchain.Contracts.Contract.ConstantContract.CallRaw(CallInfo callInfo, IReadOnlyTransactionProcessor readOnlyTransactionProcessor) in /src/Nethermind/Nethermind.Blockchain/Contracts/Contract.ConstantContract.cs:line 111\r\nethereum    |    at Nethermind.Consensus.AuRa.Contracts.TransactionPermissionContract.PermissionConstantContract.CallRaw(CallInfo callInfo, IReadOnlyTransactionProcessor readOnlyTransactionProcessor) in /src/Nethermind/Nethermind.Consensus.AuRa/Contracts/TransactionPermissionContract.cs:line 135\r\nethereum    |    at Nethermind.Blockchain.Contracts.Contract.ConstantContract.Call(CallInfo callInfo) in /src/Nethermind/Nethermind.Blockchain/Contracts/Contract.ConstantContract.cs:line 104\r\nethereum    |    at Nethermind.Blockchain.Contracts.Contract.IConstantContract.Call[T](CallInfo callInfo) in /src/Nethermind/Nethermind.Blockchain/Contracts/Contract.ConstantContract.cs:line 43\r\nethereum    |    at Nethermind.Blockchain.Contracts.Contract.IConstantContract.Call[T](BlockHeader parentHeader, String functionName, Address sender, Object[] arguments) in /src/Nethermind/Nethermind.Blockchain/Contracts/Contract.ConstantContract.cs:line 52\r\nethereum    |    at Nethermind.Consensus.AuRa.Contracts.TransactionPermissionContract.ContractVersion(BlockHeader blockHeader) in /src/Nethermind/Nethermind.Consensus.AuRa/Contracts/TransactionPermissionContract.cs:line 82\r\nethereum    |    at Nethermind.Consensus.AuRa.Contracts.VersionedContract`1.ResolveVersion(BlockHeader blockHeader) in /src/Nethermind/Nethermind.Consensus.AuRa/Contracts/VersionedContract.cs:line 57\r\nethereum    |    at Nethermind.Consensus.AuRa.Transactions.PermissionBasedTxFilter.GetVersionedContract(BlockHeader blockHeader) in /src/Nethermind/Nethermind.Consensus.AuRa/Transactions/TxPermissionFilter.cs:line 109\r\nethereum    |    at Nethermind.Consensus.AuRa.Transactions.PermissionBasedTxFilter.GetPermissionsFromContract(Transaction tx, BlockHeader parentHeader, ValueTuple`2& key) in /src/Nethermind/Nethermind.Consensus.AuRa/Transactions/TxPermissionFilter.cs:line 79\r\nethereum    |    at Nethermind.Consensus.AuRa.Transactions.PermissionBasedTxFilter.GetPermissions(Transaction tx, BlockHeader parentHeader) in /src/Nethermind/Nethermind.Consensus.AuRa/Transactions/TxPermissionFilter.cs:line 65\r\nethereum    |    at Nethermind.Consensus.AuRa.Transactions.PermissionBasedTxFilter.IsAllowed(Transaction tx, BlockHeader parentHeader) in /src/Nethermind/Nethermind.Consensus.AuRa/Transactions/TxPermissionFilter.cs:line 55\r\nethereum    |    at Nethermind.Consensus.Transactions.CompositeTxFilter.IsAllowed(Transaction tx, BlockHeader parentHeader) in /src/Nethermind/Nethermind.Consensus/Transactions/CompositeTxFilter.cs:line 38\r\nethereum    |    at Nethermind.Consensus.AuRa.AuRaBlockProcessor.CheckTxPosdaoRules(AddingTxEventArgs args) in /src/Nethermind/Nethermind.Consensus.AuRa/AuRaBlockProcessor.cs:line 161\r\nethereum    |    at Nethermind.Consensus.AuRa.AuRaBlockProcessor.ValidateTxs(Block block) in /src/Nethermind/Nethermind.Consensus.AuRa/AuRaBlockProcessor.cs:line 126\r\nethereum    |    at Nethermind.Consensus.AuRa.AuRaBlockProcessor.ValidateAuRa(Block block) in /src/Nethermind/Nethermind.Consensus.AuRa/AuRaBlockProcessor.cs:line 103\r\nethereum    |    at Nethermind.Consensus.AuRa.AuRaBlockProcessor.ProcessBlock(Block block, IBlockTracer blockTracer, ProcessingOptions options) in /src/Nethermind/Nethermind.Consensus.AuRa/AuRaBlockProcessor.cs:line 89\r\nethereum    |    at Nethermind.Blockchain.Processing.BlockProcessor.ProcessOne(Block suggestedBlock, ProcessingOptions options, IBlockTracer blockTracer) in /src/Nethermind/Nethermind.Blockchain/Processing/BlockProcessor.cs:line 224\r\nethereum    |    at Nethermind.Blockchain.Processing.BlockProcessor.Process(Keccak newBranchStateRoot, List`1 suggestedBlocks, ProcessingOptions options, IBlockTracer blockTracer) in /src/Nethermind/Nethermind.Blockchain/Processing/BlockProcessor.cs:line 119\r\nethereum    |    at Nethermind.Blockchain.Processing.BlockchainProcessor.ProcessBranch(ProcessingBranch processingBranch, ProcessingOptions options, IBlockTracer tracer) in /src/Nethermind/Nethermind.Blockchain/Processing/BlockchainProcessor.cs:line 383\r\nethereum    |    at Nethermind.Blockchain.Processing.BlockchainProcessor.Process(Block suggestedBlock, ProcessingOptions options, IBlockTracer tracer) in /src/Nethermind/Nethermind.Blockchain/Processing/BlockchainProcessor.cs:line 295\r\nethereum    |    at Nethermind.Blockchain.Processing.BlockchainProcessor.RunProcessingLoop() in /src/Nethermind/Nethermind.Blockchain/Processing/BlockchainProcessor.cs:line 238\r\nethereum    |    at System.Threading.Tasks.Task.InnerInvoke()\r\nethereum    |    at System.Threading.Tasks.Task.<>c.<.cctor>b__272_0(Object obj)\r\nethereum    |    at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)\r\nethereum    | --- End of stack trace from previous location ---\r\nethereum    |    at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)\r\nethereum    |    at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)\r\n```\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3849/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3849/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1073705314",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/3849#issuecomment-1073705314",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3849",
    "id": 1073705314,
    "node_id": "IC_kwDOBggaLc4__3Fi",
    "user": {
      "login": "LukaszRozmej",
      "id": 12445221,
      "node_id": "MDQ6VXNlcjEyNDQ1MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/12445221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LukaszRozmej",
      "html_url": "https://github.com/LukaszRozmej",
      "followers_url": "https://api.github.com/users/LukaszRozmej/followers",
      "following_url": "https://api.github.com/users/LukaszRozmej/following{/other_user}",
      "gists_url": "https://api.github.com/users/LukaszRozmej/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LukaszRozmej/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LukaszRozmej/subscriptions",
      "organizations_url": "https://api.github.com/users/LukaszRozmej/orgs",
      "repos_url": "https://api.github.com/users/LukaszRozmej/repos",
      "events_url": "https://api.github.com/users/LukaszRozmej/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LukaszRozmej/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-21T10:01:07Z",
    "updated_at": "2022-03-21T10:01:13Z",
    "author_association": "MEMBER",
    "body": "You can run debug_resetHead to a block you definitely have state for and sync from this block.",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1073705314/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1154547196",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/3849#issuecomment-1154547196",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3849",
    "id": 1154547196,
    "node_id": "IC_kwDOBggaLc5E0P38",
    "user": {
      "login": "raymondjacobson",
      "id": 2731362,
      "node_id": "MDQ6VXNlcjI3MzEzNjI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2731362?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/raymondjacobson",
      "html_url": "https://github.com/raymondjacobson",
      "followers_url": "https://api.github.com/users/raymondjacobson/followers",
      "following_url": "https://api.github.com/users/raymondjacobson/following{/other_user}",
      "gists_url": "https://api.github.com/users/raymondjacobson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/raymondjacobson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/raymondjacobson/subscriptions",
      "organizations_url": "https://api.github.com/users/raymondjacobson/orgs",
      "repos_url": "https://api.github.com/users/raymondjacobson/repos",
      "events_url": "https://api.github.com/users/raymondjacobson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/raymondjacobson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-13T23:29:46Z",
    "updated_at": "2022-06-13T23:29:46Z",
    "author_association": "NONE",
    "body": "This issue prevents the node from coming online, so the RPC isn't live to send a debug_resetHead. Is there another way to send it via config / startup?",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1154547196/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1168611783",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/3849#issuecomment-1168611783",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3849",
    "id": 1168611783,
    "node_id": "IC_kwDOBggaLc5Fp5nH",
    "user": {
      "login": "LukaszRozmej",
      "id": 12445221,
      "node_id": "MDQ6VXNlcjEyNDQ1MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/12445221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LukaszRozmej",
      "html_url": "https://github.com/LukaszRozmej",
      "followers_url": "https://api.github.com/users/LukaszRozmej/followers",
      "following_url": "https://api.github.com/users/LukaszRozmej/following{/other_user}",
      "gists_url": "https://api.github.com/users/LukaszRozmej/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LukaszRozmej/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LukaszRozmej/subscriptions",
      "organizations_url": "https://api.github.com/users/LukaszRozmej/orgs",
      "repos_url": "https://api.github.com/users/LukaszRozmej/repos",
      "events_url": "https://api.github.com/users/LukaszRozmej/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LukaszRozmej/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-28T11:41:33Z",
    "updated_at": "2022-06-28T11:41:33Z",
    "author_association": "MEMBER",
    "body": "@raymondjacobson sorry for late reply, was this resolved with a resync?\r\nOtherwise we can  investigate - the order was changed for the merge as a workaround of some issues there, we can think if we can make it more sophisticated.",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1168611783/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
