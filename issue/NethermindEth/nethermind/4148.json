{
  "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4148",
  "repository_url": "https://api.github.com/repos/NethermindEth/nethermind",
  "labels_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4148/labels{/name}",
  "comments_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4148/comments",
  "events_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4148/events",
  "html_url": "https://github.com/NethermindEth/nethermind/issues/4148",
  "id": 1268238022,
  "node_id": "I_kwDOBggaLc5Ll8bG",
  "number": 4148,
  "title": "`eth_sendTransaction` returns `AlreadyKnown` error, should return transaction hash.",
  "user": {
    "login": "MicahZoltu",
    "id": 886059,
    "node_id": "MDQ6VXNlcjg4NjA1OQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/886059?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/MicahZoltu",
    "html_url": "https://github.com/MicahZoltu",
    "followers_url": "https://api.github.com/users/MicahZoltu/followers",
    "following_url": "https://api.github.com/users/MicahZoltu/following{/other_user}",
    "gists_url": "https://api.github.com/users/MicahZoltu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/MicahZoltu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/MicahZoltu/subscriptions",
    "organizations_url": "https://api.github.com/users/MicahZoltu/orgs",
    "repos_url": "https://api.github.com/users/MicahZoltu/repos",
    "events_url": "https://api.github.com/users/MicahZoltu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/MicahZoltu/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-06-11T11:13:19Z",
  "updated_at": "2023-03-07T13:10:13Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "**Describe the bug**\r\nIf you `eth_sendRawTransaction` for a transaction that is already in the mempool you receive an error of `AlreadyKnown`.  Instead, you should receive the transaction hash.\r\n\r\nThis is especially impactful when combined with other bugs like when you call `eth_sendRawTransaction` and get back a `FeeTooLow` error (no transaction hash) and then when you send it again you get `AlreadyKnown` error.  This means you never can receive the transaction hash for the transaction in question (unless you calculate it yourself) so you can't actually query it.\r\n\r\nIf the transaction is already in the mempool, a more appropriate response would be to return the transaction hash which would make `eth_sendRawTransaction` semi-idempotent (you could call it multiple times and get the same answer each time).\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Via JSON-RPC call `eth_sendRawTransaction` with some transaction.\r\n2. Call `eth_sandRawTransaction` again with the same transaction details.\r\n3. Notice that you receive `AlreadyKnown` error.\r\n\r\n**Expected behavior**\r\nYou get the transaction hash back.\r\n\r\n**Desktop (please complete the following information):**\r\n - OS: Docker\r\n - Browser: N/A\r\n - Version: 1.12.4\r\n\r\n**Additional context**\r\nI'm not sure what Geth does here, but even if it returns `AlreadyKnown` I think this is incorrect behavior since you *could* just return the transaction hash which would always be a correct response in this case.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4148/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4148/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1162879734",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/4148#issuecomment-1162879734",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4148",
    "id": 1162879734,
    "node_id": "IC_kwDOBggaLc5FUCL2",
    "user": {
      "login": "LukaszRozmej",
      "id": 12445221,
      "node_id": "MDQ6VXNlcjEyNDQ1MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/12445221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LukaszRozmej",
      "html_url": "https://github.com/LukaszRozmej",
      "followers_url": "https://api.github.com/users/LukaszRozmej/followers",
      "following_url": "https://api.github.com/users/LukaszRozmej/following{/other_user}",
      "gists_url": "https://api.github.com/users/LukaszRozmej/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LukaszRozmej/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LukaszRozmej/subscriptions",
      "organizations_url": "https://api.github.com/users/LukaszRozmej/orgs",
      "repos_url": "https://api.github.com/users/LukaszRozmej/repos",
      "events_url": "https://api.github.com/users/LukaszRozmej/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LukaszRozmej/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-22T09:40:04Z",
    "updated_at": "2022-06-22T09:40:04Z",
    "author_association": "MEMBER",
    "body": "Geth also sends AlreadyKnown:\r\nhttps://github.com/ethereum/go-ethereum/issues/22093\r\nhttps://github.com/ethereum/go-ethereum/issues/22093",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1162879734/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1162972932",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/4148#issuecomment-1162972932",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4148",
    "id": 1162972932,
    "node_id": "IC_kwDOBggaLc5FUY8E",
    "user": {
      "login": "MicahZoltu",
      "id": 886059,
      "node_id": "MDQ6VXNlcjg4NjA1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886059?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MicahZoltu",
      "html_url": "https://github.com/MicahZoltu",
      "followers_url": "https://api.github.com/users/MicahZoltu/followers",
      "following_url": "https://api.github.com/users/MicahZoltu/following{/other_user}",
      "gists_url": "https://api.github.com/users/MicahZoltu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MicahZoltu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MicahZoltu/subscriptions",
      "organizations_url": "https://api.github.com/users/MicahZoltu/orgs",
      "repos_url": "https://api.github.com/users/MicahZoltu/repos",
      "events_url": "https://api.github.com/users/MicahZoltu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MicahZoltu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-22T11:19:56Z",
    "updated_at": "2022-06-22T11:19:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think this is incorrect behavior, given that the send is functionally idempotent.  Is there anything that can be done to get Nethermind to be the first mover on fixing this \"bug\", or will you only change this if Geth changes it first?",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1162972932/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1162989318",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/4148#issuecomment-1162989318",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4148",
    "id": 1162989318,
    "node_id": "IC_kwDOBggaLc5FUc8G",
    "user": {
      "login": "LukaszRozmej",
      "id": 12445221,
      "node_id": "MDQ6VXNlcjEyNDQ1MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/12445221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LukaszRozmej",
      "html_url": "https://github.com/LukaszRozmej",
      "followers_url": "https://api.github.com/users/LukaszRozmej/followers",
      "following_url": "https://api.github.com/users/LukaszRozmej/following{/other_user}",
      "gists_url": "https://api.github.com/users/LukaszRozmej/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LukaszRozmej/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LukaszRozmej/subscriptions",
      "organizations_url": "https://api.github.com/users/LukaszRozmej/orgs",
      "repos_url": "https://api.github.com/users/LukaszRozmej/repos",
      "events_url": "https://api.github.com/users/LukaszRozmej/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LukaszRozmej/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-22T11:37:27Z",
    "updated_at": "2022-06-22T11:37:27Z",
    "author_association": "MEMBER",
    "body": "Yes, I agree it's controversial as the user doesn't care and would prefer not to handle this edge case. We will try changing this.",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1162989318/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
