{
  "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3415",
  "repository_url": "https://api.github.com/repos/NethermindEth/nethermind",
  "labels_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3415/labels{/name}",
  "comments_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3415/comments",
  "events_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3415/events",
  "html_url": "https://github.com/NethermindEth/nethermind/issues/3415",
  "id": 996177721,
  "node_id": "I_kwDOBggaLc47YHc5",
  "number": 3415,
  "title": "Use AsyncDisposable.",
  "user": {
    "login": "MicahZoltu",
    "id": 886059,
    "node_id": "MDQ6VXNlcjg4NjA1OQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/886059?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/MicahZoltu",
    "html_url": "https://github.com/MicahZoltu",
    "followers_url": "https://api.github.com/users/MicahZoltu/followers",
    "following_url": "https://api.github.com/users/MicahZoltu/following{/other_user}",
    "gists_url": "https://api.github.com/users/MicahZoltu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/MicahZoltu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/MicahZoltu/subscriptions",
    "organizations_url": "https://api.github.com/users/MicahZoltu/orgs",
    "repos_url": "https://api.github.com/users/MicahZoltu/repos",
    "events_url": "https://api.github.com/users/MicahZoltu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/MicahZoltu/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2019353920,
      "node_id": "MDU6TGFiZWwyMDE5MzUzOTIw",
      "url": "https://api.github.com/repos/NethermindEth/nethermind/labels/low%20priority",
      "name": "low priority",
      "color": "C2E0C6",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "dceleda",
    "id": 26231116,
    "node_id": "MDQ6VXNlcjI2MjMxMTE2",
    "avatar_url": "https://avatars.githubusercontent.com/u/26231116?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dceleda",
    "html_url": "https://github.com/dceleda",
    "followers_url": "https://api.github.com/users/dceleda/followers",
    "following_url": "https://api.github.com/users/dceleda/following{/other_user}",
    "gists_url": "https://api.github.com/users/dceleda/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dceleda/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dceleda/subscriptions",
    "organizations_url": "https://api.github.com/users/dceleda/orgs",
    "repos_url": "https://api.github.com/users/dceleda/repos",
    "events_url": "https://api.github.com/users/dceleda/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dceleda/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "dceleda",
      "id": 26231116,
      "node_id": "MDQ6VXNlcjI2MjMxMTE2",
      "avatar_url": "https://avatars.githubusercontent.com/u/26231116?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dceleda",
      "html_url": "https://github.com/dceleda",
      "followers_url": "https://api.github.com/users/dceleda/followers",
      "following_url": "https://api.github.com/users/dceleda/following{/other_user}",
      "gists_url": "https://api.github.com/users/dceleda/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dceleda/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dceleda/subscriptions",
      "organizations_url": "https://api.github.com/users/dceleda/orgs",
      "repos_url": "https://api.github.com/users/dceleda/repos",
      "events_url": "https://api.github.com/users/dceleda/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dceleda/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-09-14T15:53:26Z",
  "updated_at": "2022-08-31T18:15:14Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "https://github.com/NethermindEth/nethermind/blob/2ee8d40e1f24b60ed650244d7907ac32dc75081a/src/Nethermind/Nethermind.Sockets/ISocketsClient.cs#L26\r\n\r\nPretty much everything should use `AsyncDisposable` rather than `Disposable`, unless there is some good reason not to.  You can do synchronous disposals in an `AsyncDispose` method, but you can't do async disposals in a `Dispose` method.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3415/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3415/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/919377106",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/3415#issuecomment-919377106",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/3415",
    "id": 919377106,
    "node_id": "IC_kwDOBggaLc42zJTS",
    "user": {
      "login": "MicahZoltu",
      "id": 886059,
      "node_id": "MDQ6VXNlcjg4NjA1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886059?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MicahZoltu",
      "html_url": "https://github.com/MicahZoltu",
      "followers_url": "https://api.github.com/users/MicahZoltu/followers",
      "following_url": "https://api.github.com/users/MicahZoltu/following{/other_user}",
      "gists_url": "https://api.github.com/users/MicahZoltu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MicahZoltu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MicahZoltu/subscriptions",
      "organizations_url": "https://api.github.com/users/MicahZoltu/orgs",
      "repos_url": "https://api.github.com/users/MicahZoltu/repos",
      "events_url": "https://api.github.com/users/MicahZoltu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MicahZoltu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-14T17:46:51Z",
    "updated_at": "2021-09-14T17:46:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "Actually, on further investigation I think that `WebSocketHandler` should not be disposing the provided `WebSocket` because the web socket's lifetime should be managed by whoever instantiated it originally.  Similarly, `SocketClient` should not dispose of the provided `ISocketHandler` for the same reason.\r\n\r\nIn general, if you receive an object as an input parameter to a class constructor or function, you should *not* dispose of that object and instead you should assume that whoever called the constructor/function will manage the object's lifetimes.  The reason this is important as a standard practice is because people may have code like this:\r\n```cs\r\nusing (var disposable = Factory())\r\n{\r\n    using (var childDisposable = new Child(disposable))\r\n    {\r\n        ...\r\n    }\r\n    // if `Child` disposes of the `disposable` it was given, then the following will break because `disposable` is already disposed\r\n    using (var childDisposable = new Child(disposable))\r\n    {\r\n        ...\r\n    }\r\n}\r\n```\r\nSince the standard practice is to always have the object's creator manage object lifetime, someone writing code that instantiates a `SocketClient` will likely be disposing of the `WebSocket` themselves, because they are the creator thus they assume that they'll be in charge of the `WebSocket` lifetime.  If you then dispose of it in the `SocketHandler` (by way of the `SocketClient`), the object will be disposed twice, and possible at the wrong time in its lifecycle and possible result in failed cleanup or runtime errors.",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/919377106/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
