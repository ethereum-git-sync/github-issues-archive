{
  "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/5698",
  "repository_url": "https://api.github.com/repos/NethermindEth/nethermind",
  "labels_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/5698/labels{/name}",
  "comments_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/5698/comments",
  "events_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/5698/events",
  "html_url": "https://github.com/NethermindEth/nethermind/issues/5698",
  "id": 1710753753,
  "node_id": "I_kwDOBggaLc5l-AfZ",
  "number": 5698,
  "title": "State Sync branches stuck at 0.00 %",
  "user": {
    "login": "josepot",
    "id": 8620144,
    "node_id": "MDQ6VXNlcjg2MjAxNDQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8620144?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/josepot",
    "html_url": "https://github.com/josepot",
    "followers_url": "https://api.github.com/users/josepot/followers",
    "following_url": "https://api.github.com/users/josepot/following{/other_user}",
    "gists_url": "https://api.github.com/users/josepot/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/josepot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/josepot/subscriptions",
    "organizations_url": "https://api.github.com/users/josepot/orgs",
    "repos_url": "https://api.github.com/users/josepot/repos",
    "events_url": "https://api.github.com/users/josepot/events{/privacy}",
    "received_events_url": "https://api.github.com/users/josepot/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-05-15T20:09:31Z",
  "updated_at": "2023-05-15T20:28:11Z",
  "closed_at": "2023-05-15T20:27:22Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "**Description**\r\nI started running a nethermind client and at first everything was going well, until suddenly the `State Sync` logs started reporting that the `branches` progress went from 10.16% to 0.00%, and now it's stuck at 0% (it hasn't increased for the last 50 minutes). I have the logs of the moment when that happened:\r\n\r\n```bash\r\n2023-05-15 21:29:25.9798|Downloaded 17267226 / 17267258 | current     0.07bps | total    11.91bps                                                                                                                                                                                                                                                [901/1844]\r\n2023-05-15 21:29:26.9276|State Sync 00.01:18:15 | ~11.78 % | 13919.38MB / ~118210.00MB | branches: 10.16 % | kB/s:   343 | accounts 26831854 | nodes 159179476 | diagnostics: 25.78121748.03ms                                                                                                                                                             \r\n2023-05-15 21:29:27.0183|Changing state FastSync, StateNodes to StateNodes at processed:0|state:0|block:17267227|header:17267227|chain difficulty:58750003716598352816469|target block:17267259|peer block:17267259|peer total difficulty:58750003716598352816469                                                                                          \r\n2023-05-15 21:29:27.0183|Sync mode changed from FastSync, StateNodes to StateNodes                                                                                                                                                                                                                                                                         \r\n2023-05-15 21:29:27.9408|State Sync 00.01:18:16 | ~11.78 % | 13920.96MB / ~118210.00MB | branches: 10.16 % | kB/s:  1554 | accounts 26837752 | nodes 159194495 | diagnostics: 34.78140029.21ms                                                                                                                                                             \r\n2023-05-15 21:29:28.9847|Executing JSON RPC call eth_getBlockByNumber with params [0x1, False]                                                                                                                                                                                                                                                             \r\n2023-05-15 21:29:29.0038|State Sync 00.01:18:17 | ~11.78 % | 13921.74MB / ~118210.00MB | branches: 10.16 % | kB/s:   738 | accounts 26838375 | nodes 159205561 | diagnostics: 30.78153149.03ms                                                                                                                                                             \r\n2023-05-15 21:29:30.0126|State Sync 00.01:18:18 | ~11.78 % | 13922.28MB / ~118210.00MB | branches: 10.16 % | kB/s:   538 | accounts 26838844 | nodes 159214484 | diagnostics: 50.78163888.64ms                                                                                                                                                             \r\n2023-05-15 21:29:31.0140|State Sync 00.01:18:19 | ~11.78 % | 13923.47MB / ~118210.00MB | branches: 10.16 % | kB/s:  1186 | accounts 26838852 | nodes 159239555 | diagnostics: 40.78188964.46ms                                                                                                                                                             \r\n2023-05-15 21:29:32.0155|State Sync 00.01:18:20 | ~11.78 % | 13925.61MB / ~118210.00MB | branches: 10.16 % | kB/s:  2132 | accounts 26838855 | nodes 159277590 | diagnostics: 42.78216434.15ms                                                                                                                                                             \r\n2023-05-15 21:29:33.0211|State Sync 00.01:18:21 | ~11.78 % | 13926.84MB / ~118210.00MB | branches: 10.16 % | kB/s:  1227 | accounts 26838892 | nodes 159296836 | diagnostics: 30.78227780.94ms                                                                                                                                                             \r\n2023-05-15 21:29:34.0265|State Sync 00.01:18:22 | ~11.78 % | 13928.83MB / ~118210.00MB | branches: 10.16 % | kB/s:  1979 | accounts 26838905 | nodes 159329395 | diagnostics: 46.78254862.67ms                                                                                                                                                             \r\n2023-05-15 21:29:34.0647|Peers | with known best block: 117 | all: 117 |                                                                                                                                                                                                                                                                                   \r\n2023-05-15 21:29:35.0419|State Sync 00.01:18:23 | ~11.78 % | 13930.24MB / ~118210.00MB | branches: 10.16 % | kB/s:  1392 | accounts 26838910 | nodes 159353755 | diagnostics: 44.78274777.86ms                                                                                                                                                             \r\n2023-05-15 21:29:36.0562|State Sync 00.01:18:24 | ~11.79 % | 13931.65MB / ~118210.00MB | branches: 10.16 % | kB/s:  1388 | accounts 26838913 | nodes 159379320 | diagnostics: 33.78296689.42ms                                                                                                                                                             \r\n2023-05-15 21:29:37.0418|Received a new payload: 17267260 (0x48f5cf59abe275e79d27a939cb50817da04f1cd93c2d7d3f50d9ba7b7aeda3ad)                                                                                                                                                                                                                             \r\n2023-05-15 21:29:37.0432|Syncing... Inserting block 17267260 (0x48f5cf...eda3ad).                                                                                                                                                                                                                                                                          \r\n2023-05-15 21:29:37.0565|State Sync 00.01:18:25 | ~11.79 % | 13933.27MB / ~118210.00MB | branches: 10.16 % | kB/s:  1614 | accounts 26838913 | nodes 159407564 | diagnostics: 32.78317010.71ms                                                                                                                                                             \r\n2023-05-15 21:29:37.1922|Received: ForkchoiceState: (HeadBlockHash: 0x48f5cf59abe275e79d27a939cb50817da04f1cd93c2d7d3f50d9ba7b7aeda3ad, SafeBlockHash: 0x3334ac0db64c1971407c4895c74287cb7deeb5357d19616b91d70b72c39a474c, FinalizedBlockHash: 0x3911f9ff200c2ff4131dab3acfcd0945df2e7a73c4b5a5913fcdb55031853c3f)                                         \r\n2023-05-15 21:29:37.2079|Syncing beacon headers... Request: ForkchoiceState: (HeadBlockHash: 0x48f5cf59abe275e79d27a939cb50817da04f1cd93c2d7d3f50d9ba7b7aeda3ad, SafeBlockHash: 0x3334ac0db64c1971407c4895c74287cb7deeb5357d19616b91d70b72c39a474c, FinalizedBlockHash: 0x3911f9ff200c2ff4131dab3acfcd0945df2e7a73c4b5a5913fcdb55031853c3f) .              \r\n2023-05-15 21:29:37.9579|Changing state StateNodes to FastSync, StateNodes at processed:0|state:0|block:17267227|header:17267227|chain difficulty:58750003716598352816469|target block:17267260|peer block:17267260|peer total difficulty:58750003716598352816469                                                                                          \r\n2023-05-15 21:29:37.9579|Sync mode changed from StateNodes to FastSync, StateNodes                                                                                                                                                                                                                                                                         \r\n2023-05-15 21:29:38.2233|Downloaded 17267228 / 17267260 | current     0.16bps | total    11.89bps                                                                                                                                                                                                                                                          \r\n2023-05-15 21:29:38.3677|State Sync 00.01:18:26 | ~11.79 % | 13935.00MB / ~118210.00MB | branches: 10.16 % | kB/s:  1324 | accounts 26838918 | nodes 159433227 | diagnostics: 31.78334946.71ms                                                                                                                                                             \r\n2023-05-15 21:29:38.9573|Changing state FastSync, StateNodes to StateNodes at processed:0|state:0|block:17267228|header:17267228|chain difficulty:58750003716598352816469|target block:17267260|peer block:17267260|peer total difficulty:58750003716598352816469                                                                                          \r\n2023-05-15 21:29:38.9573|Sync mode changed from FastSync, StateNodes to StateNodes                                                                                                                                                                                                                                                                         \r\n2023-05-15 21:29:39.3766|State Sync 00.01:18:28 | ~11.79 % | 13936.73MB / ~118210.00MB | branches: 10.16 % | kB/s:  1715 | accounts 26838974 | nodes 159456460 | diagnostics: 42.78350695.52ms \r\n2023-05-15 21:29:40.5315|State Sync 00.01:18:29 | ~11.79 % | 13938.50MB / ~118210.00MB | branches: 10.16 % | kB/s:  1527 | accounts 26839010 | nodes 159481841 | diagnostics: 110.78377019.28ms                                                                                                                                                            \r\n2023-05-15 21:29:41.5366|State Sync 00.01:18:29 | ~11.79 % | 13939.71MB / ~118210.00MB | branches: 10.16 % | kB/s:  1213 | accounts 26839040 | nodes 159502081 | diagnostics: 25.78383402.77ms  \r\n2023-05-15 21:29:41.8733|Setting state sync state root to 17266838 0xa36fe0ffb3029b45322ddbd4cb0fcb3d4488222483ab8586a849c55d25ef933b                                                                                                                                                                                                                      \r\n2023-05-15 21:29:41.9579|Starting the node data sync from the 17267228 (0x0c6d53...035bb0) 0x72aec4e790db809865b64c6ce5156b6e62cf989cd9ccd84b99e985ee1dff69d0 root                                                                                                                                                                                         \r\n2023-05-15 21:29:41.9579|Setting state sync state root to 17267228 0x72aec4e790db809865b64c6ce5156b6e62cf989cd9ccd84b99e985ee1dff69d0                                                                                                                                                                                                                      \r\n2023-05-15 21:29:41.9579|Now syncing nodes starting from root of block 17267228                                                                                                                                                                                                                                                                            \r\n2023-05-15 21:29:42.1288|Executing JSON RPC call eth_chainId with params []                                                                                                                                                                                                                                                                                \r\n2023-05-15 21:29:42.1288|Executing JSON RPC call eth_syncing with params []                                                                                                                                                                                                                                                                                \r\n2023-05-15 21:29:42.9609|State Sync 00.01:18:29 | ~11.79 % | 13940.51MB / ~118210.00MB | branches: 0.00 % | kB/s:   790 | accounts 26839162 | nodes 159512288 | diagnostics: 25.78416006.40ms                                                                                                                                                              \r\n2023-05-15 21:29:42.9869|Executing JSON RPC call eth_getBlockByNumber with params [0x1, False]                                                                                                                                                                                                                                                             \r\n2023-05-15 21:29:43.9698|State Sync 00.01:18:30 | ~11.79 % | 13940.51MB / ~118210.00MB | branches: 0.00 % | kB/s:     1 | accounts 26839172 | nodes 159512298 | diagnostics: 23.78428576.27ms  \r\n2023-05-15 21:29:45.0622|State Sync 00.01:18:31 | ~11.79 % | 13940.51MB / ~118210.00MB | branches: 0.00 % | kB/s:     3 | accounts 26839204 | nodes 159512330 | diagnostics: 25.78432566.90ms  \r\n2023-05-15 21:29:46.0702|State Sync 00.01:18:33 | ~11.79 % | 13940.53MB / ~118210.00MB | branches: 0.00 % | kB/s:    14 | accounts 26839263 | nodes 159512395 | diagnostics: 23.78438155.05ms                                                                                                                                                              \r\n```\r\n\r\nI'm using the latest release:\r\n```\r\nVersion: 1.18.0+97e80dda\r\nCommit: 97e80dda9b35efbab57d51165836ed0dea059b76\r\nBuild Date: 2023-05-03 13:56:16Z\r\nOS: Linux x64\r\nRuntime: .NET 7.0.5\r\n```\r\n\r\nMy config file:\r\n\r\n```json\r\n{\r\n  \"Init\": {\r\n    \"ChainSpecPath\": \"chainspec/foundation.json\",\r\n    \"GenesisHash\": \"0xd4e56740f876aef8c010b86a40d5f56745a118d0906a34e69aec8c0db1cb8fa3\",\r\n    \"BaseDbPath\": \"nethermind_db/mainnet\",\r\n    \"LogFileName\": \"mainnet.logs.txt\",\r\n    \"MemoryHint\": 2048000000\r\n  },\r\n  \"Network\": {\r\n    \"MaxActivePeers\": 256\r\n  },\r\n  \"Sync\": {\r\n    \"FastSync\": true,\r\n    \"PivotNumber\": 17178000,\r\n    \"PivotHash\": \"0xfff67ab8df09e704d3704e0a9090aa53e459cf3b94a5cbfc798c5db9aaa36c3e\",\r\n    \"PivotTotalDifficulty\": \"58750003716598352816469\",\r\n    \"FastBlocks\": true,\r\n    \"AncientBodiesBarrier\": 11052984,\r\n    \"AncientReceiptsBarrier\": 11052984,\r\n    \"FastSyncCatchUpHeightDelta\": \"10000000000\"\r\n  },\r\n  \"EthStats\": {\r\n    \"Server\": \"wss://ethstats.net/api\"\r\n  },\r\n  \"Metrics\": {\r\n    \"NodeName\": \"Mainnet\"\r\n  },\r\n  \"Blocks\": {\r\n    \"TargetBlockGasLimit\": 30000000\r\n  },\r\n  \"JsonRpc\": {\r\n    \"Enabled\": true,\r\n    \"Timeout\": 20000,\r\n    \"Host\": \"127.0.0.1\",\r\n    \"Port\": 8545,\r\n    \"AdditionalRpcUrls\": [\r\n      \"http://localhost:8551|http;ws|net;eth;subscribe;engine;web3;client\"\r\n    ],\r\n    \"EnabledModules\": [\"Eth\", \"Subscribe\", \"Trace\", \"TxPool\", \"Web3\", \"Personal\", \"Proof\", \"Net\", \"Parity\", \"Health\"],\r\n    \"EnginePort\": 8551,\r\n    \"EngineHost\": \"127.0.0.1\",\r\n    \"JwtSecretFile\": \"/home/josep/jwtsecret.hex\"\r\n  },\r\n  \"Merge\": {\r\n    \"Enabled\": true\r\n  }\r\n}\r\n```\r\n\r\n**Steps to Reproduce**\r\nIn order to replicate the behavior, please provide a detailed list of steps:\r\n1. Get the latest release of nethermind on an Ubuntu 22.04.2 LTS\r\n2. Start the client with the config file that I shared above ^\r\n\r\n**Actual behavior**\r\nThe percentage of downloaded branches stays stuck at 0%\r\n\r\n**Expected behavior**\r\nThe percentage of downloaded branches should increase as the State Sync progresses\r\n\r\n**Desktop (please complete the following information):**\r\nPlease provide the following information regarding your setup:\r\n - Operating System: Ubuntu\r\n - Version: 22.04.2 LTS\r\n - Installation Method: GitHub Release\r\n - Consensus Client: teku v23.4.0\r\n\r\n**Logs**\r\nIn the description.\r\n",
  "closed_by": {
    "login": "josepot",
    "id": 8620144,
    "node_id": "MDQ6VXNlcjg2MjAxNDQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8620144?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/josepot",
    "html_url": "https://github.com/josepot",
    "followers_url": "https://api.github.com/users/josepot/followers",
    "following_url": "https://api.github.com/users/josepot/following{/other_user}",
    "gists_url": "https://api.github.com/users/josepot/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/josepot/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/josepot/subscriptions",
    "organizations_url": "https://api.github.com/users/josepot/orgs",
    "repos_url": "https://api.github.com/users/josepot/repos",
    "events_url": "https://api.github.com/users/josepot/events{/privacy}",
    "received_events_url": "https://api.github.com/users/josepot/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/5698/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/5698/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1548528592",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/5698#issuecomment-1548528592",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/5698",
    "id": 1548528592,
    "node_id": "IC_kwDOBggaLc5cTKvQ",
    "user": {
      "login": "josepot",
      "id": 8620144,
      "node_id": "MDQ6VXNlcjg2MjAxNDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8620144?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/josepot",
      "html_url": "https://github.com/josepot",
      "followers_url": "https://api.github.com/users/josepot/followers",
      "following_url": "https://api.github.com/users/josepot/following{/other_user}",
      "gists_url": "https://api.github.com/users/josepot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/josepot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/josepot/subscriptions",
      "organizations_url": "https://api.github.com/users/josepot/orgs",
      "repos_url": "https://api.github.com/users/josepot/repos",
      "events_url": "https://api.github.com/users/josepot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/josepot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-15T20:27:22Z",
    "updated_at": "2023-05-15T20:28:11Z",
    "author_association": "NONE",
    "body": "Ups! Sorry, after reading the docs a bit more carefully, I realized that this must be the normal behavior. My bad!\r\n\r\nI mean, it still is a bit confusing, though :sweat_smile: ",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1548528592/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
