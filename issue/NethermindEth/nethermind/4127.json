{
  "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4127",
  "repository_url": "https://api.github.com/repos/NethermindEth/nethermind",
  "labels_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4127/labels{/name}",
  "comments_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4127/comments",
  "events_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4127/events",
  "html_url": "https://github.com/NethermindEth/nethermind/issues/4127",
  "id": 1264465432,
  "node_id": "I_kwDOBggaLc5LXjYY",
  "number": 4127,
  "title": "RPC: trace_filter ignores params ToAddress / FromAddress",
  "user": {
    "login": "SinErgy84",
    "id": 17455315,
    "node_id": "MDQ6VXNlcjE3NDU1MzE1",
    "avatar_url": "https://avatars.githubusercontent.com/u/17455315?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/SinErgy84",
    "html_url": "https://github.com/SinErgy84",
    "followers_url": "https://api.github.com/users/SinErgy84/followers",
    "following_url": "https://api.github.com/users/SinErgy84/following{/other_user}",
    "gists_url": "https://api.github.com/users/SinErgy84/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/SinErgy84/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/SinErgy84/subscriptions",
    "organizations_url": "https://api.github.com/users/SinErgy84/orgs",
    "repos_url": "https://api.github.com/users/SinErgy84/repos",
    "events_url": "https://api.github.com/users/SinErgy84/events{/privacy}",
    "received_events_url": "https://api.github.com/users/SinErgy84/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "tanishqjasoria",
    "id": 11698398,
    "node_id": "MDQ6VXNlcjExNjk4Mzk4",
    "avatar_url": "https://avatars.githubusercontent.com/u/11698398?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tanishqjasoria",
    "html_url": "https://github.com/tanishqjasoria",
    "followers_url": "https://api.github.com/users/tanishqjasoria/followers",
    "following_url": "https://api.github.com/users/tanishqjasoria/following{/other_user}",
    "gists_url": "https://api.github.com/users/tanishqjasoria/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tanishqjasoria/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tanishqjasoria/subscriptions",
    "organizations_url": "https://api.github.com/users/tanishqjasoria/orgs",
    "repos_url": "https://api.github.com/users/tanishqjasoria/repos",
    "events_url": "https://api.github.com/users/tanishqjasoria/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tanishqjasoria/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "tanishqjasoria",
      "id": 11698398,
      "node_id": "MDQ6VXNlcjExNjk4Mzk4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11698398?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tanishqjasoria",
      "html_url": "https://github.com/tanishqjasoria",
      "followers_url": "https://api.github.com/users/tanishqjasoria/followers",
      "following_url": "https://api.github.com/users/tanishqjasoria/following{/other_user}",
      "gists_url": "https://api.github.com/users/tanishqjasoria/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tanishqjasoria/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tanishqjasoria/subscriptions",
      "organizations_url": "https://api.github.com/users/tanishqjasoria/orgs",
      "repos_url": "https://api.github.com/users/tanishqjasoria/repos",
      "events_url": "https://api.github.com/users/tanishqjasoria/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tanishqjasoria/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-06-08T09:33:32Z",
  "updated_at": "2022-07-21T11:54:58Z",
  "closed_at": "2022-07-06T14:39:09Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "**Describe the bug**\r\n\r\nHi everyone!\r\nWhile testing with the trace_filter method, I seem to have discovered a problem with filtering by address.\r\nOn the Ropsten network, I performed an \"internal transaction\" affecting the address 0x571aC301F47d68b2dcE5F1631Fb24474BacEd740. 10 ETH faucets were transferred to this address.\r\n\r\n![Auswahl_565](https://user-images.githubusercontent.com/17455315/172578329-d9ea6adc-c99d-41bf-b0b7-2f7f955fdf7c.png)\r\n\r\nhttps://ropsten.etherscan.io/address/0x571ac301f47d68b2dce5f1631fb24474baced740#internaltx\r\nhttps://ropsten.etherscan.io/tx/0x523140d30de3fc49fe0e07e3bba662eed1bb93e0cd07d03dd2ac599aa6acdcd5\r\n\r\nIf I use trace_filter only with the specification FromBlock #12348235 and ToBlock #12348235, I get a long output of all transactions, including the transaction on the address I am looking for.\r\n\r\nshortened output:\r\n```php\r\nArray\r\n(\r\n    [0] => stdClass Object\r\n        (\r\n            [action] => stdClass Object\r\n                (\r\n                    [callType] => call\r\n                    [from] => 0x0778a4625ec26e83c9cc17316b2250ba8ffbda23\r\n                    [gas] => 0x21c0\r\n                    [input] => 0x6886a992000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000183632613032613133306465386335356333366462366364650000000000000000\r\n                    [to] => 0xe2c7ffc92ce681a11ab145e735c5aee3b9e704b1\r\n                    [value] => 0xb1a2bc2ec50000\r\n                )\r\n\r\n            [blockHash] => 0x9d18fdc3d4a32319ef9aec8c11ee435c7db3f99bd8c987a32618885883848391\r\n            [blockNumber] => 12348235\r\n            [result] => stdClass Object\r\n                (\r\n                    [gasUsed] => 0x398\r\n                    [output] => 0x\r\n                )\r\n\r\n            [subtraces] => 0\r\n            [traceAddress] => Array\r\n                (\r\n                )\r\n\r\n            [transactionHash] => 0x9b743bf1e92749ba580a0a91d69aa9cfbf379a56d401f2c4b27849f4bafdc18f\r\n            [transactionPosition] => 0\r\n            [type] => call\r\n        )\r\n\r\n    [1] => stdClass Object\r\n        (\r\n            [action] => stdClass Object\r\n                (\r\n                    [callType] => call\r\n                    [from] => 0x9c71fbe2d28080b8afa88cea8a1e319de2c09d44\r\n                    [gas] => 0x7ee06\r\n                    [input] => 0xcd51b0930000000000000000000000000000000000000000000000008ac7230489e800000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000571ac301f47d68b2dce5f1631fb24474baced740000000000000000000000000ac2478ec5929b5e598b1e47ec2ba7de591499bcd0000000000000000000000002a8b5fed10c7dc0fe2fc15efb3c4dd4afeedf398000000000000000000000000f1651b81922cbe2914d49583c01ce1e626d3212200000000000000000000000094b7c35904b5125f32b5680f01a57f2a2ea485a8000000000000000000000000580784580013e936f00ed42b09d085f3ffca645d00000000000000000000000029a3f4acb10ebc6f741d7b77da8d846bcb66463d000000000000000000000000cca1647f53028144850bf0bb5ff8ad3c42c7413800000000000000000000000040f11dcedd1d7fe97f8ce7f3caac54fa1580bb9a0000000000000000000000004b1f095b26ac50395070895e88c4b9a26d95195b000000000000000000000000952aed26ec2df8f0e45556fca0f74227e960f7e40000000000000000000000001658abaaa6c1b15879751d3a685910a25ad83bf1\r\n                    [to] => 0x7917a2f6c13e1e13452f0d52157e5afad999d36b\r\n                    [value] => 0x0\r\n                )\r\n\r\n            [blockHash] => 0x9d18fdc3d4a32319ef9aec8c11ee435c7db3f99bd8c987a32618885883848391\r\n            [blockNumber] => 12348235\r\n            [result] => stdClass Object\r\n                (\r\n                    [gasUsed] => 0x3bc1d\r\n                    [output] => 0x\r\n                )\r\n\r\n            [subtraces] => 12\r\n            [traceAddress] => Array\r\n                (\r\n                )\r\n\r\n            [transactionHash] => 0x523140d30de3fc49fe0e07e3bba662eed1bb93e0cd07d03dd2ac599aa6acdcd5\r\n            [transactionPosition] => 1\r\n            [type] => call\r\n        )\r\n\r\n    [2] => stdClass Object\r\n        (\r\n            [action] => stdClass Object\r\n                (\r\n                    [callType] => call\r\n                    [from] => 0x7917a2f6c13e1e13452f0d52157e5afad999d36b\r\n                    [gas] => 0x7985a\r\n                    [input] => 0x\r\n                    [to] => 0x571ac301f47d68b2dce5f1631fb24474baced740\r\n                    [value] => 0x8ac7230489e80000\r\n                )\r\n\r\n            [blockHash] => 0x9d18fdc3d4a32319ef9aec8c11ee435c7db3f99bd8c987a32618885883848391\r\n            [blockNumber] => 12348235\r\n            [result] => stdClass Object\r\n                (\r\n                    [gasUsed] => 0x0\r\n                    [output] => 0x\r\n                )\r\n\r\n            [subtraces] => 0\r\n            [traceAddress] => Array\r\n                (\r\n                    [0] => 0\r\n                )\r\n\r\n            [transactionHash] => 0x523140d30de3fc49fe0e07e3bba662eed1bb93e0cd07d03dd2ac599aa6acdcd5\r\n            [transactionPosition] => 1\r\n            [type] => call\r\n        )\r\n\r\n       [...]\r\n\r\n)\r\n```\r\n\r\nIf you search for the address 0x571aC301F47d68b2dcE5F1631Fb24474BacEd740, it will be listed accordingly.\r\n\r\nNow when I use the trace_filter method with the constraints FromBlock 12348235, ToBlock 12348235 and ToAddress 0x571aC301F47d68b2dcE5F1631Fb24474BacEd740, I get no output / empty output.\r\n\r\nIt makes no difference whether I give the address in this notation or in lower case 0x571ac301f47d68b2dce5f1631fb24474baced740, as shown in the above output.\r\n\r\n```bash\r\ncurl --data '{\"method\":\"trace_filter\",\"params\":[{\"fromBlock\":\"0xbc6b4b\",\"toBlock\":\"0xbc6b4b\",\"toAddress\":[\"0x571ac301f47d68b2dce5f1631fb24474baced740\"]}],\"id\":1,\"jsonrpc\":\"2.0\"}' -H \"Content-Type: application/json\" -X POST nethermind:8545\r\n\r\n{\"jsonrpc\":\"2.0\",\"result\":[],\"id\":1}\r\n```\r\n\r\n**Expected behavior**\r\n\r\nOutput of a pre-filtered list concerning the submitted addresses.\r\n\r\n**Desktop (please complete the following information):**\r\n\r\nOS: Ubuntu 22.04 LTS\r\nnethermind 1.13.1\r\n\r\n**Additional debug output from client**\r\n\r\n```\r\n2022-06-08 12:26:24.6572|DEBUG|40|JSON RPC request ID 4, trace_filter({\r\n  \"fromBlock\": \"0xbc6b4b\",\r\n  \"toBlock\": \"0xbc6b4b\",\r\n  \"toAddress\": [\r\n    \"0x571ac301f47d68b2dce5f1631fb24474baced740\"\r\n  ]\r\n}) \r\n2022-06-08 12:26:24.6572|INFO|40|Executing JSON RPC call trace_filter with params [{\r\n  \"fromBlock\": \"0xbc6b4b\",\r\n  \"toBlock\": \"0xbc6b4b\",\r\n  \"toAddress\": [\r\n    \"0x571ac301f47d68b2dce5f1631fb24474baced740\"\r\n  ]\r\n}] \r\n2022-06-08 12:26:24.6665|TRACE|40|Checking if we should trace block 12348235 (0x9d18fd...848391), matching tx count: 0, after: 0 \r\n2022-06-08 12:26:24.6665|DEBUG|40|Responded to ID 4, trace_filter({\r\n  \"fromBlock\": \"0xbc6b4b\",\r\n  \"toBlock\": \"0xbc6b4b\",\r\n  \"toAddress\": [\r\n    \"0x571ac301f47d68b2dce5f1631fb24474baced740\"\r\n  ]\r\n}) \r\n2022-06-08 12:26:24.6665|TRACE|40|Sending JSON RPC response: {\"jsonrpc\":\"2.0\",\"result\":[],\"id\":4} \r\n2022-06-08 12:26:24.6669|DEBUG|40|  ID 4, trace_filter({\r\n  \"fromBlock\": \"0xbc6b4b\",\r\n  \"toBlock\": \"0xbc6b4b\",\r\n  \"toAddress\": [\r\n    \"0x571ac301f47d68b2dce5f1631fb24474baced740\"\r\n  ]\r\n}) handled in 8.8549ms \r\n2022-06-08 12:26:24.6669|INFO|40|Request finished HTTP/1.1 POST http://172.17.0.1:18545/ application/json 164 - 200 - application/json 9.3357ms\r\n```",
  "closed_by": {
    "login": "LukaszRozmej",
    "id": 12445221,
    "node_id": "MDQ6VXNlcjEyNDQ1MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/12445221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/LukaszRozmej",
    "html_url": "https://github.com/LukaszRozmej",
    "followers_url": "https://api.github.com/users/LukaszRozmej/followers",
    "following_url": "https://api.github.com/users/LukaszRozmej/following{/other_user}",
    "gists_url": "https://api.github.com/users/LukaszRozmej/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/LukaszRozmej/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/LukaszRozmej/subscriptions",
    "organizations_url": "https://api.github.com/users/LukaszRozmej/orgs",
    "repos_url": "https://api.github.com/users/LukaszRozmej/repos",
    "events_url": "https://api.github.com/users/LukaszRozmej/events{/privacy}",
    "received_events_url": "https://api.github.com/users/LukaszRozmej/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4127/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4127/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1167104687",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/4127#issuecomment-1167104687",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4127",
    "id": 1167104687,
    "node_id": "IC_kwDOBggaLc5FkJqv",
    "user": {
      "login": "LukaszRozmej",
      "id": 12445221,
      "node_id": "MDQ6VXNlcjEyNDQ1MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/12445221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LukaszRozmej",
      "html_url": "https://github.com/LukaszRozmej",
      "followers_url": "https://api.github.com/users/LukaszRozmej/followers",
      "following_url": "https://api.github.com/users/LukaszRozmej/following{/other_user}",
      "gists_url": "https://api.github.com/users/LukaszRozmej/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LukaszRozmej/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LukaszRozmej/subscriptions",
      "organizations_url": "https://api.github.com/users/LukaszRozmej/orgs",
      "repos_url": "https://api.github.com/users/LukaszRozmej/repos",
      "events_url": "https://api.github.com/users/LukaszRozmej/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LukaszRozmej/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-27T09:22:37Z",
    "updated_at": "2022-06-27T09:22:37Z",
    "author_association": "MEMBER",
    "body": "We are currently working on a fix.",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1167104687/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 1,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1191392717",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/4127#issuecomment-1191392717",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4127",
    "id": 1191392717,
    "node_id": "IC_kwDOBggaLc5HAzXN",
    "user": {
      "login": "Uxio0",
      "id": 6909403,
      "node_id": "MDQ6VXNlcjY5MDk0MDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6909403?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Uxio0",
      "html_url": "https://github.com/Uxio0",
      "followers_url": "https://api.github.com/users/Uxio0/followers",
      "following_url": "https://api.github.com/users/Uxio0/following{/other_user}",
      "gists_url": "https://api.github.com/users/Uxio0/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Uxio0/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Uxio0/subscriptions",
      "organizations_url": "https://api.github.com/users/Uxio0/orgs",
      "repos_url": "https://api.github.com/users/Uxio0/repos",
      "events_url": "https://api.github.com/users/Uxio0/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Uxio0/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-21T11:54:58Z",
    "updated_at": "2022-07-21T11:54:58Z",
    "author_association": "NONE",
    "body": "Hi @LukaszRozmej , are you releasing a new version with this fix?",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1191392717/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
