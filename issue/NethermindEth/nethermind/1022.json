{
  "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1022",
  "repository_url": "https://api.github.com/repos/NethermindEth/nethermind",
  "labels_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1022/labels{/name}",
  "comments_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1022/comments",
  "events_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1022/events",
  "html_url": "https://github.com/NethermindEth/nethermind/issues/1022",
  "id": 525638080,
  "node_id": "MDU6SXNzdWU1MjU2MzgwODA=",
  "number": 1022,
  "title": "Handle deep EVM call stack using separate thread",
  "user": {
    "login": "chfast",
    "id": 573380,
    "node_id": "MDQ6VXNlcjU3MzM4MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/573380?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/chfast",
    "html_url": "https://github.com/chfast",
    "followers_url": "https://api.github.com/users/chfast/followers",
    "following_url": "https://api.github.com/users/chfast/following{/other_user}",
    "gists_url": "https://api.github.com/users/chfast/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/chfast/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/chfast/subscriptions",
    "organizations_url": "https://api.github.com/users/chfast/orgs",
    "repos_url": "https://api.github.com/users/chfast/repos",
    "events_url": "https://api.github.com/users/chfast/events{/privacy}",
    "received_events_url": "https://api.github.com/users/chfast/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2019-11-20T08:02:08Z",
  "updated_at": "2022-08-31T18:35:03Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "In relation to the discussion about supporting EVMC, I did small research on the issue of causing native stack overflow when handling EVM call stack naively.\r\n\r\nWhat you can do is adapt a trick Aleth is using. At some EVM call depth height (e.g. 100, the number must be figured out experimentally)  you offload execution to a dedicated thread. The thread will have new system stack space and _you can specify the size of this stack_ in C# API. The execution is still sequential - we have to wait for the new thread to finish.\r\n\r\nWhat would be even better is to use coroutines or filbers. These also need to create a separate stack space but this can be implement in a library without the need of creating a thread (this requires asking OS for help). However, to my knowledge C# do not support these out-of-the-box.\r\n\r\nAleth code: https://github.com/ethereum/aleth/blob/master/libethereum/ExtVM.cpp#L34-L57.",
  "closed_by": {
    "login": "tkstanczak",
    "id": 498913,
    "node_id": "MDQ6VXNlcjQ5ODkxMw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tkstanczak",
    "html_url": "https://github.com/tkstanczak",
    "followers_url": "https://api.github.com/users/tkstanczak/followers",
    "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
    "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
    "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
    "repos_url": "https://api.github.com/users/tkstanczak/repos",
    "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1022/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1022/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/557486501",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1022#issuecomment-557486501",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1022",
    "id": 557486501,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzQ4NjUwMQ==",
    "user": {
      "login": "tkstanczak",
      "id": 498913,
      "node_id": "MDQ6VXNlcjQ5ODkxMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tkstanczak",
      "html_url": "https://github.com/tkstanczak",
      "followers_url": "https://api.github.com/users/tkstanczak/followers",
      "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
      "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
      "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
      "repos_url": "https://api.github.com/users/tkstanczak/repos",
      "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-22T10:52:02Z",
    "updated_at": "2019-11-22T10:52:02Z",
    "author_association": "MEMBER",
    "body": "hi @chfast not sure what you mean here? is that some issue with EVMC that would need to be handled specifically just to be able to support it?\r\n\r\nwe do not have a call stack per se - we have an iterative and not recursive approach",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/557486501/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/557496960",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1022#issuecomment-557496960",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1022",
    "id": 557496960,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzQ5Njk2MA==",
    "user": {
      "login": "chfast",
      "id": 573380,
      "node_id": "MDQ6VXNlcjU3MzM4MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/573380?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/chfast",
      "html_url": "https://github.com/chfast",
      "followers_url": "https://api.github.com/users/chfast/followers",
      "following_url": "https://api.github.com/users/chfast/following{/other_user}",
      "gists_url": "https://api.github.com/users/chfast/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/chfast/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/chfast/subscriptions",
      "organizations_url": "https://api.github.com/users/chfast/orgs",
      "repos_url": "https://api.github.com/users/chfast/repos",
      "events_url": "https://api.github.com/users/chfast/events{/privacy}",
      "received_events_url": "https://api.github.com/users/chfast/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-22T11:27:41Z",
    "updated_at": "2019-11-22T11:27:41Z",
    "author_association": "NONE",
    "body": "I don't think you will be able to support EVMC VMs with iterative approach.\r\n\r\nThis was mostly a brain dump. But this is a way to have recursive approach without exhausting system stack.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/557496960/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/558608919",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1022#issuecomment-558608919",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1022",
    "id": 558608919,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1ODYwODkxOQ==",
    "user": {
      "login": "tkstanczak",
      "id": 498913,
      "node_id": "MDQ6VXNlcjQ5ODkxMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tkstanczak",
      "html_url": "https://github.com/tkstanczak",
      "followers_url": "https://api.github.com/users/tkstanczak/followers",
      "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
      "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
      "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
      "repos_url": "https://api.github.com/users/tkstanczak/repos",
      "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-26T12:34:22Z",
    "updated_at": "2019-11-26T12:34:22Z",
    "author_association": "MEMBER",
    "body": "Controversial. I would prefer the EVMC VM to be able to execute everything by just being injected an interface to state, executioin env and tx. Why does it need to impose some requirements on how the Nethermind VM is designed?",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/558608919/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1233281420",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1022#issuecomment-1233281420",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1022",
    "id": 1233281420,
    "node_id": "IC_kwDOBggaLc5JgmGM",
    "user": {
      "login": "dceleda",
      "id": 26231116,
      "node_id": "MDQ6VXNlcjI2MjMxMTE2",
      "avatar_url": "https://avatars.githubusercontent.com/u/26231116?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dceleda",
      "html_url": "https://github.com/dceleda",
      "followers_url": "https://api.github.com/users/dceleda/followers",
      "following_url": "https://api.github.com/users/dceleda/following{/other_user}",
      "gists_url": "https://api.github.com/users/dceleda/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dceleda/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dceleda/subscriptions",
      "organizations_url": "https://api.github.com/users/dceleda/orgs",
      "repos_url": "https://api.github.com/users/dceleda/repos",
      "events_url": "https://api.github.com/users/dceleda/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dceleda/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-31T18:35:03Z",
    "updated_at": "2022-08-31T18:35:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "@tkstanczak is it still valid?",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1233281420/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
