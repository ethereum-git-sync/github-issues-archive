{
  "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1542",
  "repository_url": "https://api.github.com/repos/NethermindEth/nethermind",
  "labels_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1542/labels{/name}",
  "comments_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1542/comments",
  "events_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1542/events",
  "html_url": "https://github.com/NethermindEth/nethermind/issues/1542",
  "id": 581619430,
  "node_id": "MDU6SXNzdWU1ODE2MTk0MzA=",
  "number": 1542,
  "title": "EstimateGas results differ from geth",
  "user": {
    "login": "mmhh1910",
    "id": 35501465,
    "node_id": "MDQ6VXNlcjM1NTAxNDY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/35501465?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mmhh1910",
    "html_url": "https://github.com/mmhh1910",
    "followers_url": "https://api.github.com/users/mmhh1910/followers",
    "following_url": "https://api.github.com/users/mmhh1910/following{/other_user}",
    "gists_url": "https://api.github.com/users/mmhh1910/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mmhh1910/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mmhh1910/subscriptions",
    "organizations_url": "https://api.github.com/users/mmhh1910/orgs",
    "repos_url": "https://api.github.com/users/mmhh1910/repos",
    "events_url": "https://api.github.com/users/mmhh1910/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mmhh1910/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 674950059,
      "node_id": "MDU6TGFiZWw2NzQ5NTAwNTk=",
      "url": "https://api.github.com/repos/NethermindEth/nethermind/labels/bug",
      "name": "bug",
      "color": "ee0701",
      "default": true,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "tkstanczak",
    "id": 498913,
    "node_id": "MDQ6VXNlcjQ5ODkxMw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tkstanczak",
    "html_url": "https://github.com/tkstanczak",
    "followers_url": "https://api.github.com/users/tkstanczak/followers",
    "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
    "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
    "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
    "repos_url": "https://api.github.com/users/tkstanczak/repos",
    "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "tkstanczak",
      "id": 498913,
      "node_id": "MDQ6VXNlcjQ5ODkxMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tkstanczak",
      "html_url": "https://github.com/tkstanczak",
      "followers_url": "https://api.github.com/users/tkstanczak/followers",
      "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
      "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
      "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
      "repos_url": "https://api.github.com/users/tkstanczak/repos",
      "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 9,
  "created_at": "2020-03-15T10:44:56Z",
  "updated_at": "2020-08-30T21:47:39Z",
  "closed_at": "2020-08-30T21:47:39Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I've noticed that the results for gas estimations for token transfers differ from the results returned by geth. If the estimates from nethermind are used, the transactions will fail with \"Out of gas\" (meaning the numbers returned by geth are correct).\r\n\r\nThe gas needed is different depending on if the source balance goes down to zero (the complete balance is transfered, thus storage is freed in the token contract) and if the target address already holds some of the token (if not, gas for the storage in the token contract needs to be paid).\r\n\r\nBelow is the code for four test cases in python for geth and nethermind.\r\n\r\nCase 1: Transfer not all tokens to an address that already holds the token - no storage slot taken or freed\r\nCase 2: Transfer all tokens to an address that already holds the token - one storage slot freed\r\nCase 3: Transfer not all tokens to an address that does not hold the token yet - one storage slot taken\r\nCase 4: Transfer all tokens to an address that does not hold the token yet - one storage slot taken, one freed\r\n\r\nThe output for me is:\r\n\r\n```\r\nGeth:       37042 37042 52030 52030\r\nNethermind: 23384 23384 23320 23320\r\n```\r\n\r\nThere seems to be a general offset between geth and nethermind and additionally, nethermind does not seems to calculate correctly when the target account does not hold any of the token yet (case 3 and 4). \r\n\r\nFor whoever takes a look at this, my understanding is that estimateGas in geth returns more than the tx will actually need when storage is freed, since, as far as I understand, the bonus for freeing storage is only calculaed at the very end of the tx in the EVM. So, you can't substract this bonus upfront when sending the tx. This means that Geth does not actually return the gas needed for the tx, but the gas needed to not run into \"Out of gas\" along the way.\r\n\r\n```\r\nweb3_geth = Web3(HTTPProvider(\"...\"))\r\nweb3_nethermind = Web3(HTTPProvider(\"...\"))\r\n\r\ntoken_address=\"0x6B175474E89094C44Da98b954EedeAC495271d0F\" # DAI\r\nsource_address_with_dai=\"0x8AeCc5526F92A46718f8E68516D22038D8670E0D\" # random DAI token holder\r\n\r\ntarget_address_with_dai=\"0x6B175474E89094C44Da98b954EedeAC495271d0F\" # another random DAI token holder\r\ntarget_address_without_dai=\"0x6b175474e89094c44DA98b954eedeAC495271d00\" # unused/empty address\r\n\r\ntokenContract_geth = web3_geth.eth.contract(address=token_address, abi=TokenABI)\r\ntokenContract_nethermind = web3_nethermind.eth.contract(address=token_address, abi=TokenABI)\r\nGAS_TOKEN_TRANSFER = 150000\r\n\r\namount_con = tokenContract_geth.functions.balanceOf(Web3.toChecksumAddress(source_address_with_dai)).call()\r\n\r\nestimate1_geth = tokenContract_geth.functions.transfer(target_address_with_dai,   amount_con-1).estimateGas({'from': Web3.toChecksumAddress(source_address_with_dai), 'gas': GAS_TOKEN_TRANSFER})\r\nestimate2_geth = tokenContract_geth.functions.transfer(target_address_with_dai,   amount_con).  estimateGas({'from': Web3.toChecksumAddress(source_address_with_dai), 'gas': GAS_TOKEN_TRANSFER})\r\nestimate3_geth = tokenContract_geth.functions.transfer(target_address_without_dai,amount_con-1).estimateGas({'from': Web3.toChecksumAddress(source_address_with_dai), 'gas': GAS_TOKEN_TRANSFER})\r\nestimate4_geth = tokenContract_geth.functions.transfer(target_address_without_dai,amount_con).  estimateGas({'from': Web3.toChecksumAddress(source_address_with_dai), 'gas': GAS_TOKEN_TRANSFER})\r\nprint(estimate1_geth,estimate2_geth,estimate3_geth,estimate4_geth)\r\n\r\nestimate1_nethermind = tokenContract_nethermind.functions.transfer(target_address_with_dai,   amount_con-1).estimateGas({'from': Web3.toChecksumAddress(source_address_with_dai), 'gas': GAS_TOKEN_TRANSFER})\r\nestimate2_nethermind = tokenContract_nethermind.functions.transfer(target_address_with_dai,   amount_con).  estimateGas({'from': Web3.toChecksumAddress(source_address_with_dai), 'gas': GAS_TOKEN_TRANSFER})\r\nestimate3_nethermind = tokenContract_nethermind.functions.transfer(target_address_without_dai,amount_con-1).estimateGas({'from': Web3.toChecksumAddress(source_address_with_dai), 'gas': GAS_TOKEN_TRANSFER})\r\nestimate4_nethermind = tokenContract_nethermind.functions.transfer(target_address_without_dai,amount_con).  estimateGas({'from': Web3.toChecksumAddress(source_address_with_dai), 'gas': GAS_TOKEN_TRANSFER})\r\nprint(estimate1_nethermind,estimate2_nethermind,estimate3_nethermind,estimate4_nethermind)\r\n```",
  "closed_by": {
    "login": "tkstanczak",
    "id": 498913,
    "node_id": "MDQ6VXNlcjQ5ODkxMw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tkstanczak",
    "html_url": "https://github.com/tkstanczak",
    "followers_url": "https://api.github.com/users/tkstanczak/followers",
    "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
    "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
    "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
    "repos_url": "https://api.github.com/users/tkstanczak/repos",
    "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1542/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1542/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/599224973",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1542#issuecomment-599224973",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1542",
    "id": 599224973,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5OTIyNDk3Mw==",
    "user": {
      "login": "tkstanczak",
      "id": 498913,
      "node_id": "MDQ6VXNlcjQ5ODkxMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tkstanczak",
      "html_url": "https://github.com/tkstanczak",
      "followers_url": "https://api.github.com/users/tkstanczak/followers",
      "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
      "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
      "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
      "repos_url": "https://api.github.com/users/tkstanczak/repos",
      "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-03-15T15:28:04Z",
    "updated_at": "2020-03-15T15:28:04Z",
    "author_association": "MEMBER",
    "body": "Hi @mmhh1910 \r\nThere were significant changes to the gas estimator in the last month.\r\nI assume you executed this on the latest version?\r\n\r\nIt may be some edge case with refunds that I will need to analyze.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/599224973/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/599275017",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1542#issuecomment-599275017",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1542",
    "id": 599275017,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5OTI3NTAxNw==",
    "user": {
      "login": "mmhh1910",
      "id": 35501465,
      "node_id": "MDQ6VXNlcjM1NTAxNDY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/35501465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mmhh1910",
      "html_url": "https://github.com/mmhh1910",
      "followers_url": "https://api.github.com/users/mmhh1910/followers",
      "following_url": "https://api.github.com/users/mmhh1910/following{/other_user}",
      "gists_url": "https://api.github.com/users/mmhh1910/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mmhh1910/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mmhh1910/subscriptions",
      "organizations_url": "https://api.github.com/users/mmhh1910/orgs",
      "repos_url": "https://api.github.com/users/mmhh1910/repos",
      "events_url": "https://api.github.com/users/mmhh1910/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mmhh1910/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-03-15T22:43:12Z",
    "updated_at": "2020-03-15T22:43:12Z",
    "author_association": "NONE",
    "body": "Yes, I've used docker image nethermind/nethermind:1.6.25.",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/599275017/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/601483846",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1542#issuecomment-601483846",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1542",
    "id": 601483846,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwMTQ4Mzg0Ng==",
    "user": {
      "login": "tkstanczak",
      "id": 498913,
      "node_id": "MDQ6VXNlcjQ5ODkxMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tkstanczak",
      "html_url": "https://github.com/tkstanczak",
      "followers_url": "https://api.github.com/users/tkstanczak/followers",
      "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
      "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
      "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
      "repos_url": "https://api.github.com/users/tkstanczak/repos",
      "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-03-20T01:02:44Z",
    "updated_at": "2020-03-20T01:02:44Z",
    "author_association": "MEMBER",
    "body": "@mmhh1910 I may be able to pick this up this weekend, sorry for the delay, needed to finish the peering changes",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/601483846/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/602059453",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1542#issuecomment-602059453",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1542",
    "id": 602059453,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwMjA1OTQ1Mw==",
    "user": {
      "login": "mmhh1910",
      "id": 35501465,
      "node_id": "MDQ6VXNlcjM1NTAxNDY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/35501465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mmhh1910",
      "html_url": "https://github.com/mmhh1910",
      "followers_url": "https://api.github.com/users/mmhh1910/followers",
      "following_url": "https://api.github.com/users/mmhh1910/following{/other_user}",
      "gists_url": "https://api.github.com/users/mmhh1910/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mmhh1910/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mmhh1910/subscriptions",
      "organizations_url": "https://api.github.com/users/mmhh1910/orgs",
      "repos_url": "https://api.github.com/users/mmhh1910/repos",
      "events_url": "https://api.github.com/users/mmhh1910/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mmhh1910/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-03-21T15:20:24Z",
    "updated_at": "2020-03-21T15:20:24Z",
    "author_association": "NONE",
    "body": "With docker image nethermind/nethermind:1.7.3 I now get:\r\n\r\n```\r\nGeth:       37018 37018 52006 52006\r\nNethermind: 38519 38519 53507 53507\r\n```\r\n\r\nThis seems to be correct. Don't know where the off-by-1501 comes from, but at least the transactions using the these values will not result in  \"Out of gas\".",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/602059453/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/620784132",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1542#issuecomment-620784132",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1542",
    "id": 620784132,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMDc4NDEzMg==",
    "user": {
      "login": "tkstanczak",
      "id": 498913,
      "node_id": "MDQ6VXNlcjQ5ODkxMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tkstanczak",
      "html_url": "https://github.com/tkstanczak",
      "followers_url": "https://api.github.com/users/tkstanczak/followers",
      "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
      "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
      "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
      "repos_url": "https://api.github.com/users/tkstanczak/repos",
      "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-28T18:37:07Z",
    "updated_at": "2020-04-28T18:37:07Z",
    "author_association": "MEMBER",
    "body": "@mmhh1910 from what I have heard - Geth and Parity use binary search to estimate gas while we run a single pass estimator (which is not perfect but much faster)\r\n\r\nI remember one potential reason for difference so I need to go back to that code",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/620784132/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/640152402",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1542#issuecomment-640152402",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1542",
    "id": 640152402,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0MDE1MjQwMg==",
    "user": {
      "login": "MicahZoltu",
      "id": 886059,
      "node_id": "MDQ6VXNlcjg4NjA1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886059?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MicahZoltu",
      "html_url": "https://github.com/MicahZoltu",
      "followers_url": "https://api.github.com/users/MicahZoltu/followers",
      "following_url": "https://api.github.com/users/MicahZoltu/following{/other_user}",
      "gists_url": "https://api.github.com/users/MicahZoltu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MicahZoltu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MicahZoltu/subscriptions",
      "organizations_url": "https://api.github.com/users/MicahZoltu/orgs",
      "repos_url": "https://api.github.com/users/MicahZoltu/repos",
      "events_url": "https://api.github.com/users/MicahZoltu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MicahZoltu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-07T03:43:37Z",
    "updated_at": "2020-06-07T03:43:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "I *believe* Nethermind will incorrectly estimate the gas for a call to `incrementOncePerBlock` if the `latest` block had a call to the function.  I *suspect* that Nethermind is using `latest` block's timestamp for the timestamp of the estimator, which will result in this code incorrectly evaluating.\r\n```solidity\r\ncontract Apple {\r\n    uint256 value;\r\n    uint256 lastUpdate;\r\n    function incrementOncePerBlock() external {\r\n        if (lastUpdate == block.timestamp) return;\r\n        lastUpdate = block.timestamp;\r\n        value += 1;\r\n    }\r\n}\r\n```\r\nWhile I can appreciate that code that diverges by timestamp is nearly impossible to estimate correctly, I think the above pattern is common enough and simple enough to handle that it is worth fixing.  The pattern is used by Uniswap, for example, to save gas on all but the first transaction in each block.  I think having the estimator use latest block's timestamp +1 would be good enough, just to ensure that the estimator isn't using a timestamp that is *equal* to a block that has already mined.",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/640152402/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/640213321",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1542#issuecomment-640213321",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1542",
    "id": 640213321,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0MDIxMzMyMQ==",
    "user": {
      "login": "tkstanczak",
      "id": 498913,
      "node_id": "MDQ6VXNlcjQ5ODkxMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tkstanczak",
      "html_url": "https://github.com/tkstanczak",
      "followers_url": "https://api.github.com/users/tkstanczak/followers",
      "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
      "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
      "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
      "repos_url": "https://api.github.com/users/tkstanczak/repos",
      "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-07T12:42:44Z",
    "updated_at": "2020-06-07T12:42:44Z",
    "author_association": "MEMBER",
    "body": "https://github.com/NethermindEth/nethermind/pull/2008",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/640213321/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/683342227",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1542#issuecomment-683342227",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1542",
    "id": 683342227,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4MzM0MjIyNw==",
    "user": {
      "login": "tkstanczak",
      "id": 498913,
      "node_id": "MDQ6VXNlcjQ5ODkxMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/498913?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tkstanczak",
      "html_url": "https://github.com/tkstanczak",
      "followers_url": "https://api.github.com/users/tkstanczak/followers",
      "following_url": "https://api.github.com/users/tkstanczak/following{/other_user}",
      "gists_url": "https://api.github.com/users/tkstanczak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tkstanczak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tkstanczak/subscriptions",
      "organizations_url": "https://api.github.com/users/tkstanczak/orgs",
      "repos_url": "https://api.github.com/users/tkstanczak/repos",
      "events_url": "https://api.github.com/users/tkstanczak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tkstanczak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-29T21:09:05Z",
    "updated_at": "2020-08-29T21:09:05Z",
    "author_association": "MEMBER",
    "body": "@MicahZoltu I believe this is fixed and can be closed",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/683342227/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/683368178",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/1542#issuecomment-683368178",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/1542",
    "id": 683368178,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4MzM2ODE3OA==",
    "user": {
      "login": "MicahZoltu",
      "id": 886059,
      "node_id": "MDQ6VXNlcjg4NjA1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886059?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MicahZoltu",
      "html_url": "https://github.com/MicahZoltu",
      "followers_url": "https://api.github.com/users/MicahZoltu/followers",
      "following_url": "https://api.github.com/users/MicahZoltu/following{/other_user}",
      "gists_url": "https://api.github.com/users/MicahZoltu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MicahZoltu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MicahZoltu/subscriptions",
      "organizations_url": "https://api.github.com/users/MicahZoltu/orgs",
      "repos_url": "https://api.github.com/users/MicahZoltu/repos",
      "events_url": "https://api.github.com/users/MicahZoltu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MicahZoltu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-30T02:35:57Z",
    "updated_at": "2020-08-30T02:35:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "@tkstanczak I am not the person who opened the issue, so I cannot close it.  😃 \r\n\r\ncc @mmhh1910 ",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/683368178/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
