{
  "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4458",
  "repository_url": "https://api.github.com/repos/NethermindEth/nethermind",
  "labels_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4458/labels{/name}",
  "comments_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4458/comments",
  "events_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4458/events",
  "html_url": "https://github.com/NethermindEth/nethermind/issues/4458",
  "id": 1348647057,
  "node_id": "I_kwDOBggaLc5QYriR",
  "number": 4458,
  "title": "State sync stuck at 100%",
  "user": {
    "login": "dcposch",
    "id": 169280,
    "node_id": "MDQ6VXNlcjE2OTI4MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/169280?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dcposch",
    "html_url": "https://github.com/dcposch",
    "followers_url": "https://api.github.com/users/dcposch/followers",
    "following_url": "https://api.github.com/users/dcposch/following{/other_user}",
    "gists_url": "https://api.github.com/users/dcposch/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dcposch/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dcposch/subscriptions",
    "organizations_url": "https://api.github.com/users/dcposch/orgs",
    "repos_url": "https://api.github.com/users/dcposch/repos",
    "events_url": "https://api.github.com/users/dcposch/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dcposch/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "flcl42",
    "id": 630501,
    "node_id": "MDQ6VXNlcjYzMDUwMQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/630501?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/flcl42",
    "html_url": "https://github.com/flcl42",
    "followers_url": "https://api.github.com/users/flcl42/followers",
    "following_url": "https://api.github.com/users/flcl42/following{/other_user}",
    "gists_url": "https://api.github.com/users/flcl42/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/flcl42/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/flcl42/subscriptions",
    "organizations_url": "https://api.github.com/users/flcl42/orgs",
    "repos_url": "https://api.github.com/users/flcl42/repos",
    "events_url": "https://api.github.com/users/flcl42/events{/privacy}",
    "received_events_url": "https://api.github.com/users/flcl42/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "flcl42",
      "id": 630501,
      "node_id": "MDQ6VXNlcjYzMDUwMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/630501?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/flcl42",
      "html_url": "https://github.com/flcl42",
      "followers_url": "https://api.github.com/users/flcl42/followers",
      "following_url": "https://api.github.com/users/flcl42/following{/other_user}",
      "gists_url": "https://api.github.com/users/flcl42/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/flcl42/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/flcl42/subscriptions",
      "organizations_url": "https://api.github.com/users/flcl42/orgs",
      "repos_url": "https://api.github.com/users/flcl42/repos",
      "events_url": "https://api.github.com/users/flcl42/events{/privacy}",
      "received_events_url": "https://api.github.com/users/flcl42/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2022-08-23T23:24:59Z",
  "updated_at": "2022-09-12T17:32:07Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "**Describe the bug**\r\n\r\nI'm unable to get my Nethermind node to sync properly.\r\n\r\nHistory:\r\n- It synced fully in June. I stopped running Nethermind.\r\n- I restarted Nethermind two days ago. I have been unable to get it to catch up.\r\n- I tried enabling snap sync; this also has not worked.\r\n\r\nIt appears to be stuck at 100% completion on state sync?\r\n\r\n```\r\nAug 24 01:15:52 dce-1T Nethermind.Runner[33442]: 2022-08-24 01:15:52.0927|State Sync 00.21:11:52 | ~100.00% | 109388.08MB / ~99660.00MB | branches: 0.00% | kB/s:     0 | accounts 188272098 | nodes 1214166525 | diagnostics: 0.145.19ms\r\n```\r\n\r\nZooming out from the sync bug--it would be very helpful if Nethermind had a master status that prints, say, every 10 seconds. If synced and healthy, print that. If not, print exactly what it's currently attempting to do to get in sync.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Rent a server with 1T SSD.\r\n2. Install Ubuntu 22.04\r\n3. Install latest Nethermind via apt per [these instructions](https://github.com/NethermindEth/nethermind/releases/tag/1.14.0).\r\n\r\n**Expected behavior**\r\nSyncs mainnet.\r\n\r\n**Version**\r\n - OS: Ubuntu 22.04\r\n - Nethermind: **`Nethermind/v1.14.0-0-60f920b90-20220823/X64-Linux/6.0.8`**\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4458/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4458/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1227807007",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/4458#issuecomment-1227807007",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4458",
    "id": 1227807007,
    "node_id": "IC_kwDOBggaLc5JLtkf",
    "user": {
      "login": "dcposch",
      "id": 169280,
      "node_id": "MDQ6VXNlcjE2OTI4MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/169280?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dcposch",
      "html_url": "https://github.com/dcposch",
      "followers_url": "https://api.github.com/users/dcposch/followers",
      "following_url": "https://api.github.com/users/dcposch/following{/other_user}",
      "gists_url": "https://api.github.com/users/dcposch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dcposch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dcposch/subscriptions",
      "organizations_url": "https://api.github.com/users/dcposch/orgs",
      "repos_url": "https://api.github.com/users/dcposch/repos",
      "events_url": "https://api.github.com/users/dcposch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dcposch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-25T22:05:58Z",
    "updated_at": "2022-08-25T22:06:40Z",
    "author_association": "NONE",
    "body": "Still stuck at block 14990417.\r\n\r\n**`Changing state Disconnected to None at processed:14990417|state:14990417|block:15411005|header:15411240|chain difficulty:57195585512940781640941|peer block:15379000|peer total difficulty:56814286654281214516990`**\r\n\r\nContext:\r\n\r\n```\r\nAug 26 00:03:10 dce-1T Nethermind.Runner[94098]: 2022-08-26 00:03:10.6900|Waiting for peers... 21s\r\nAug 26 00:03:11 dce-1T Nethermind.Runner[94098]: 2022-08-26 00:03:11.6894|Waiting for peers... 22s\r\nAug 26 00:03:11 dce-1T Nethermind.Runner[94098]: 2022-08-26 00:03:11.8168|Changing state Disconnected to None at processed:14990417|state:14990417|block:15411005|header:15411240|chain difficulty:57195585512940781640941|peer block:15379000|peer total difficulty:56814286654281214516990\r\nAug 26 00:03:11 dce-1T Nethermind.Runner[94098]: 2022-08-26 00:03:11.8168|Sync mode changed from Disconnected to None\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1227807007/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1230083224",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/4458#issuecomment-1230083224",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4458",
    "id": 1230083224,
    "node_id": "IC_kwDOBggaLc5JUZSY",
    "user": {
      "login": "dcposch",
      "id": 169280,
      "node_id": "MDQ6VXNlcjE2OTI4MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/169280?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dcposch",
      "html_url": "https://github.com/dcposch",
      "followers_url": "https://api.github.com/users/dcposch/followers",
      "following_url": "https://api.github.com/users/dcposch/following{/other_user}",
      "gists_url": "https://api.github.com/users/dcposch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dcposch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dcposch/subscriptions",
      "organizations_url": "https://api.github.com/users/dcposch/orgs",
      "repos_url": "https://api.github.com/users/dcposch/repos",
      "events_url": "https://api.github.com/users/dcposch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dcposch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-29T10:13:15Z",
    "updated_at": "2022-08-29T10:13:15Z",
    "author_association": "NONE",
    "body": "### It looks like a number of nodes are stuck at 14990417\r\n\r\nVery strange.\r\n\r\nNethermind does look like it's successfully downloading newer blocks, then downloading state for those newer blocks.\r\n\r\n```\r\n1701341 Aug 29 11:27:18 dce-1T Nethermind.Runner[200183]: 2022-08-29 11:27:18.1986|Branch sync progress (do not extrapolate): 100.00% of block 15433302\r\n1701342 Aug 29 11:27:18 dce-1T Nethermind.Runner[200183]: ++1+++++++++1++++++1+1+++++++++1+1+++++++1+++++++++++++1++++++++\r\n1701343 Aug 29 11:27:18 dce-1T Nethermind.Runner[200183]: ++1+++++++++1++111++++++++11++++++++++++++++++++++++++1+++++++++\r\n1701344 Aug 29 11:27:18 dce-1T Nethermind.Runner[200183]: +++++++++++11+++++++++++++++++++++++1++++++++1++++++1++++++11+++\r\n1701345 Aug 29 11:27:18 dce-1T Nethermind.Runner[200183]: ++++++++++++++++++++++++1+++++++++++++++++++1++++++1++++++++++++\r\n1701346 Aug 29 11:27:18 dce-1T Nethermind.Runner[200183]: 2022-08-29 11:27:18.1986|Saving root 0x3dc50f0c3d4cb82039361502955d6de6861f309f8395e02d845c368cdf4804a4 of 15433302\r\n1701347 Aug 29 11:27:18 dce-1T Nethermind.Runner[200183]: 2022-08-29 11:27:18.2108|Setting state sync state root to 15433302 0x3dc50f0c3d4cb82039361502955d6de6861f309f8395e02d845c36\r\n1701348 Aug 29 11:27:18 dce-1T Nethermind.Runner[200183]: 2022-08-29 11:27:18.8576|Changing state StateNodes to Full at processed:14990417|state:15433302|block:15433268|header:15433\r\n1701349 Aug 29 11:27:18 dce-1T Nethermind.Runner[200183]: 2022-08-29 11:27:18.8576|Sync mode changed from StateNodes to Full\r\n1701350 Aug 29 11:27:32 dce-1T Nethermind.Runner[200183]: 2022-08-29 11:27:32.8208|Peers | with known best block: 99 | all: 99 |\r\n```\r\n\r\nHowever, it still reports block 14990417 as the tip.\r\n\r\n**What's strange is a number of peers are also stuck on this block.** Those peers appear to be running geth, not nethermind.\r\n\r\nHighlighted below:\r\n\r\n<img width=\"1265\" alt=\"image\" src=\"https://user-images.githubusercontent.com/169280/187178616-2335cb4e-3e0f-48a8-b116-757267950cef.png\">\r\n\r\nIf you need RPC (or other) access to my node for debugging, let me know.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1230083224/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1230385662",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/4458#issuecomment-1230385662",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4458",
    "id": 1230385662,
    "node_id": "IC_kwDOBggaLc5JVjH-",
    "user": {
      "login": "MarekM25",
      "id": 9356351,
      "node_id": "MDQ6VXNlcjkzNTYzNTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9356351?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarekM25",
      "html_url": "https://github.com/MarekM25",
      "followers_url": "https://api.github.com/users/MarekM25/followers",
      "following_url": "https://api.github.com/users/MarekM25/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarekM25/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarekM25/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarekM25/subscriptions",
      "organizations_url": "https://api.github.com/users/MarekM25/orgs",
      "repos_url": "https://api.github.com/users/MarekM25/repos",
      "events_url": "https://api.github.com/users/MarekM25/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarekM25/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-29T14:24:46Z",
    "updated_at": "2022-08-29T14:24:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hmmm I'm wondering if it is possible that it is connected to gray glacier: https://blog.ethereum.org/2022/06/16/gray-glacier-announcement\r\n\r\nWould you mind verifying your chainspec (setting Init.ChainSpecPath)?",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1230385662/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1230849629",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/4458#issuecomment-1230849629",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4458",
    "id": 1230849629,
    "node_id": "IC_kwDOBggaLc5JXUZd",
    "user": {
      "login": "dcposch",
      "id": 169280,
      "node_id": "MDQ6VXNlcjE2OTI4MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/169280?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dcposch",
      "html_url": "https://github.com/dcposch",
      "followers_url": "https://api.github.com/users/dcposch/followers",
      "following_url": "https://api.github.com/users/dcposch/following{/other_user}",
      "gists_url": "https://api.github.com/users/dcposch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dcposch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dcposch/subscriptions",
      "organizations_url": "https://api.github.com/users/dcposch/orgs",
      "repos_url": "https://api.github.com/users/dcposch/repos",
      "events_url": "https://api.github.com/users/dcposch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dcposch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-29T20:53:05Z",
    "updated_at": "2022-08-29T20:53:05Z",
    "author_association": "NONE",
    "body": "I didn't override that setting. Looking at `/usr/share/nethermind/configs/mainnet.cfg`, I see that it's defaulting to `chainspec/foundation.json`.\r\n\r\nLooking at that file, I can see it has the `terminalTotalDifficulty` set, which means it must be a recent configuration corresponding to my recent Nethermind version (see exact version string above).\r\n\r\n```\r\n$ less chainspec/foundation.json\r\n...\r\n    \"terminalTotalDifficulty\": \"C70D808A128D7380000\"\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1230849629/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1236646354",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/4458#issuecomment-1236646354",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4458",
    "id": 1236646354,
    "node_id": "IC_kwDOBggaLc5JtbnS",
    "user": {
      "login": "dcposch",
      "id": 169280,
      "node_id": "MDQ6VXNlcjE2OTI4MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/169280?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dcposch",
      "html_url": "https://github.com/dcposch",
      "followers_url": "https://api.github.com/users/dcposch/followers",
      "following_url": "https://api.github.com/users/dcposch/following{/other_user}",
      "gists_url": "https://api.github.com/users/dcposch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dcposch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dcposch/subscriptions",
      "organizations_url": "https://api.github.com/users/dcposch/orgs",
      "repos_url": "https://api.github.com/users/dcposch/repos",
      "events_url": "https://api.github.com/users/dcposch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dcposch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-05T07:39:15Z",
    "updated_at": "2022-09-05T07:39:15Z",
    "author_association": "NONE",
    "body": "Still stuck at 14990417.\r\n\r\n**My chainspec looks correct to me. The path is `/chainspec/foundation.json`:**\r\n\r\n<img width=\"1000\" alt=\"image\" src=\"https://user-images.githubusercontent.com/169280/188394621-a67b6fe5-b193-4da2-a751-23d875144719.png\">\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1236646354/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1244070749",
    "html_url": "https://github.com/NethermindEth/nethermind/issues/4458#issuecomment-1244070749",
    "issue_url": "https://api.github.com/repos/NethermindEth/nethermind/issues/4458",
    "id": 1244070749,
    "node_id": "IC_kwDOBggaLc5KJwNd",
    "user": {
      "login": "dcposch",
      "id": 169280,
      "node_id": "MDQ6VXNlcjE2OTI4MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/169280?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dcposch",
      "html_url": "https://github.com/dcposch",
      "followers_url": "https://api.github.com/users/dcposch/followers",
      "following_url": "https://api.github.com/users/dcposch/following{/other_user}",
      "gists_url": "https://api.github.com/users/dcposch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dcposch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dcposch/subscriptions",
      "organizations_url": "https://api.github.com/users/dcposch/orgs",
      "repos_url": "https://api.github.com/users/dcposch/repos",
      "events_url": "https://api.github.com/users/dcposch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dcposch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-12T17:32:07Z",
    "updated_at": "2022-09-12T17:32:07Z",
    "author_association": "NONE",
    "body": "@MarekM25 I'm going to delete my deata directory and sync from scratch. I've saved logs in case you want them for inspection.\r\n\r\n**Nethermind is receiving new blocks, but unable to progress past block 14990417.** It seems state sync is failing:\r\n\r\n```\r\nSep 12 19:24:46 dce-1T Nethermind.Runner[776631]: 2022-09-12 19:24:44.7461|Discovered new block 15522104 19:24:30 (0x431977...aca4d5), tx count: 127 miner 0x8b4de256180cfec54c436a470af50f9ee2813dbb, sent by [Peer|eth66|15522104| 100.37.162.177:30303]\r\nSep 12 19:24:46 dce-1T Nethermind.Runner[776631]: 2022-09-12 19:24:45.9916|State Sync 06.07:13:41 | ~100.00% | 159778.43MB / ~101060.00MB | branches: 0.00% | kB/s:   104 | accounts 205258631 | nodes 1390523791 | diagnostics: 8.281.30ms\r\n```\r\n\r\nNot sure what the perennial `branches: 0.00%` is about.",
    "reactions": {
      "url": "https://api.github.com/repos/NethermindEth/nethermind/issues/comments/1244070749/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
