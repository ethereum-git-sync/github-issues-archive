{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/1650",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1650/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1650/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1650/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/1650",
  "id": 401527018,
  "node_id": "MDU6SXNzdWU0MDE1MjcwMTg=",
  "number": 1650,
  "title": "truffle-compile: Better error text needed for \"Unexpected end of JSON input\"",
  "user": {
    "login": "wbt",
    "id": 563406,
    "node_id": "MDQ6VXNlcjU2MzQwNg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/563406?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wbt",
    "html_url": "https://github.com/wbt",
    "followers_url": "https://api.github.com/users/wbt/followers",
    "following_url": "https://api.github.com/users/wbt/following{/other_user}",
    "gists_url": "https://api.github.com/users/wbt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wbt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wbt/subscriptions",
    "organizations_url": "https://api.github.com/users/wbt/orgs",
    "repos_url": "https://api.github.com/users/wbt/repos",
    "events_url": "https://api.github.com/users/wbt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wbt/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1088150379,
      "node_id": "MDU6TGFiZWwxMDg4MTUwMzc5",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/error%20better",
      "name": "error better",
      "color": "f27915",
      "default": false,
      "description": "issue indicates improvement to error messaging"
    },
    {
      "id": 1675042241,
      "node_id": "MDU6TGFiZWwxNjc1MDQyMjQx",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/priority5%20%F0%9F%8C%80",
      "name": "priority5 ðŸŒ€",
      "color": "006b75",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2019-01-21T22:12:36Z",
  "updated_at": "2020-12-17T09:55:33Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "---------------------------\r\n## Setup:\r\nI have a Truffle project that normally compiles and migrates fine.  I have some background backup processes that occasionally read files and lock them up while doing backup.  For the purpose of this Issue report, let's assume that can't be changed.\r\n\r\n\r\n## Issue\r\nHere was a recent session, in which I attempted a migration from the start but the process got interrupted, apparently because a file was busy.  The handling of this issue was very far from graceful.  First, it just stopped the migrations process, and the process could not be restarted because the interruption had led to a corrupted JSON file.  Even attempting to re-run 'compile' failed because the JSON file that 'compile' would have replaced was corrupted.  Manually deleting the JSON files and re-compiling worked.  \r\n\r\nFirst session:\r\n```\r\n> truffle migrate --reset\r\nUsing network 'development'.\r\n\r\nRunning migration: 1_initial_migration.js\r\n  Replacing Migrations...\r\n  ... 0x6a0879a5d38bea2827a3e98fab20222b9158306118109b5b22a0cd65d08a666d\r\n  Migrations: 0x2f56a4a390cbecd3716aaf306c160cb1a38b96f6\r\nSaving successful migration to network...\r\n  ... 0x55686446be32b387b4af3651998fe2d46d4f3fbd1d5885cd9d36d9d7d8022b22\r\nSaving artifacts...\r\nRunning migration: 2_first_action.js\r\nSaving successful migration to network...\r\n  ... 0x72c22858638d4b0fec4622e41ee1fd6bdd39cbca0f78a3750fc57aeb6fe7559b\r\nSaving artifacts...\r\nError encountered, bailing. Network state unknown. Review successful transactions manually.\r\nError: EBUSY: resource busy or locked, open 'C:\\Users\\me\\projectDir\\build\\contracts\\Migrations.json'\r\n```\r\nAn arbitrary time period later (in my example, immediate, but could have been a while later):\r\n```\r\n> truffle migrate --reset\r\nSyntaxError: Unexpected end of JSON input\r\n    at JSON.parse (<anonymous>)\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\packages\\truffle-compile\\profiler.js:80:1\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\~\\async\\dist\\async.js:1140:1\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\~\\async\\dist\\async.js:473:1\r\n    at iteratorCallback (C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\~\\async\\dist\\async.js:1064:1)\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\~\\async\\dist\\async.js:969:1\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\~\\async\\dist\\async.js:1137:1\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\packages\\truffle-compile\\profiler.js:73:1\r\n    at FSReqWrap.readFileAfterClose [as oncomplete] (fs.js:528:3)\r\n> truffle migrate --reset\r\nSyntaxError: Unexpected end of JSON input\r\n    at JSON.parse (<anonymous>)\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\packages\\truffle-compile\\profiler.js:80:1\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\~\\async\\dist\\async.js:1140:1\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\~\\async\\dist\\async.js:473:1\r\n    at iteratorCallback (C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\~\\async\\dist\\async.js:1064:1)\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\~\\async\\dist\\async.js:969:1\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\~\\async\\dist\\async.js:1137:1\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\packages\\truffle-compile\\profiler.js:73:1\r\n    at FSReqWrap.readFileAfterClose [as oncomplete] (fs.js:528:3)\r\n> truffle compile\r\nSyntaxError: Unexpected end of JSON input\r\n    at JSON.parse (<anonymous>)\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\packages\\truffle-compile\\profiler.js:80:1\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\~\\async\\dist\\async.js:1140:1\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\~\\async\\dist\\async.js:473:1\r\n    at iteratorCallback (C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\~\\async\\dist\\async.js:1064:1)\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\~\\async\\dist\\async.js:969:1\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\~\\async\\dist\\async.js:1137:1\r\n    at C:\\Users\\me\\AppData\\Local\\node\\node_modules\\truffle\\build\\webpack:\\packages\\truffle-compile\\profiler.js:73:1\r\n    at FSReqWrap.readFileAfterClose [as oncomplete] (fs.js:528:3)\r\n    \r\n> rm -r build/contracts\r\n> truffle compile\r\nCompiling .\\contracts\\Migrations.sol...\r\n...(This works now)...\r\n```\r\n\r\n## Steps to Reproduce\r\n\r\nHave a file in the `build/contracts` directory with invalid JSON (e.g. remove a closing brace at the end of the file), and attempt to run `truffle compile` or `truffle migrate`.\r\n\r\n## Expected Behavior\r\n1. At the least, an error message that tells me *which* file is being parsed to give an \"unexpected end of JSON input.\"\r\n2. Maybe, an error message suggesting that I delete that file or the `build/contracts` directory and re-compile, to put me on a path towards a solution.\r\n3. Potentially better, if a command is expected to overwrite/replace a file that's producing a parse error, ignore the error as if the corrupt file just were not there at all (maybe print a warning), and just replace the file (optionally deleting it before overwrite if necessary).\r\n \r\n## Actual Results\r\nA confusing error message that requires me to recall specifics about something odd happening earlier in order to get a clue about how to proceed and address the issue.\r\n\r\n## Environment\r\n\r\n* Operating System: Windows 10 pro\r\n* Ethereum client: Ganache but irrelevant here\r\n* Truffle version (`truffle version`): 4.1.15\r\n* node version (`node --version`): 9.3.0\r\n* npm version (`npm --version`): 6.5.0\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/1650/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1650/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/472536481",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1650#issuecomment-472536481",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1650",
    "id": 472536481,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MjUzNjQ4MQ==",
    "user": {
      "login": "gnidan",
      "id": 151065,
      "node_id": "MDQ6VXNlcjE1MTA2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnidan",
      "html_url": "https://github.com/gnidan",
      "followers_url": "https://api.github.com/users/gnidan/followers",
      "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
      "organizations_url": "https://api.github.com/users/gnidan/orgs",
      "repos_url": "https://api.github.com/users/gnidan/repos",
      "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnidan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-13T17:55:52Z",
    "updated_at": "2019-03-13T17:55:52Z",
    "author_association": "MEMBER",
    "body": "Thanks for raising this! Nice suggestions. I like # 3",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/472536481/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/512825150",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1650#issuecomment-512825150",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1650",
    "id": 512825150,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxMjgyNTE1MA==",
    "user": {
      "login": "PyrateAkananto",
      "id": 11444373,
      "node_id": "MDQ6VXNlcjExNDQ0Mzcz",
      "avatar_url": "https://avatars.githubusercontent.com/u/11444373?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PyrateAkananto",
      "html_url": "https://github.com/PyrateAkananto",
      "followers_url": "https://api.github.com/users/PyrateAkananto/followers",
      "following_url": "https://api.github.com/users/PyrateAkananto/following{/other_user}",
      "gists_url": "https://api.github.com/users/PyrateAkananto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PyrateAkananto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PyrateAkananto/subscriptions",
      "organizations_url": "https://api.github.com/users/PyrateAkananto/orgs",
      "repos_url": "https://api.github.com/users/PyrateAkananto/repos",
      "events_url": "https://api.github.com/users/PyrateAkananto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PyrateAkananto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-07-18T13:52:53Z",
    "updated_at": "2019-07-18T13:52:53Z",
    "author_association": "NONE",
    "body": "I stumbled about this issue because of a `.gitkeep` file (using Truffle 5.0.9 or 5.0.27).\r\n\r\nIn the error message please at least output the file name of the file causing trouble. In addition I suggest to ignore all files without a `.json` extension.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/512825150/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/746860505",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1650#issuecomment-746860505",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1650",
    "id": 746860505,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0Njg2MDUwNQ==",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-16T19:16:22Z",
    "updated_at": "2020-12-16T19:16:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "Can anyone confirm that this kind of error messaging occurs on `0.5.xx`?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/746860505/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/747335056",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1650#issuecomment-747335056",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1650",
    "id": 747335056,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NzMzNTA1Ng==",
    "user": {
      "login": "PyrateAkananto",
      "id": 11444373,
      "node_id": "MDQ6VXNlcjExNDQ0Mzcz",
      "avatar_url": "https://avatars.githubusercontent.com/u/11444373?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/PyrateAkananto",
      "html_url": "https://github.com/PyrateAkananto",
      "followers_url": "https://api.github.com/users/PyrateAkananto/followers",
      "following_url": "https://api.github.com/users/PyrateAkananto/following{/other_user}",
      "gists_url": "https://api.github.com/users/PyrateAkananto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/PyrateAkananto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/PyrateAkananto/subscriptions",
      "organizations_url": "https://api.github.com/users/PyrateAkananto/orgs",
      "repos_url": "https://api.github.com/users/PyrateAkananto/repos",
      "events_url": "https://api.github.com/users/PyrateAkananto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/PyrateAkananto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-17T09:55:33Z",
    "updated_at": "2020-12-17T09:55:33Z",
    "author_association": "NONE",
    "body": "No, I cannot, sorry. I appreciate you still caring about this issue but I currently don't use Ethereum or Truffle anymore and don't have the time to get all my tools up and running again just for this. ðŸ˜¢ ",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/747335056/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
