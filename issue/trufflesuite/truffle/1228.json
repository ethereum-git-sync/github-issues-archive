{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/1228",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1228/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1228/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1228/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/1228",
  "id": 353998710,
  "node_id": "MDU6SXNzdWUzNTM5OTg3MTA=",
  "number": 1228,
  "title": "Mocha compatibility",
  "user": {
    "login": "krzkaczor",
    "id": 1814312,
    "node_id": "MDQ6VXNlcjE4MTQzMTI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1814312?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/krzkaczor",
    "html_url": "https://github.com/krzkaczor",
    "followers_url": "https://api.github.com/users/krzkaczor/followers",
    "following_url": "https://api.github.com/users/krzkaczor/following{/other_user}",
    "gists_url": "https://api.github.com/users/krzkaczor/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/krzkaczor/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/krzkaczor/subscriptions",
    "organizations_url": "https://api.github.com/users/krzkaczor/orgs",
    "repos_url": "https://api.github.com/users/krzkaczor/repos",
    "events_url": "https://api.github.com/users/krzkaczor/events{/privacy}",
    "received_events_url": "https://api.github.com/users/krzkaczor/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1041903922,
      "node_id": "MDU6TGFiZWwxMDQxOTAzOTIy",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/truffle%20test",
      "name": "truffle test",
      "color": "bfdadc",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2018-08-25T09:27:19Z",
  "updated_at": "2019-07-30T04:56:59Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Advantages\r\nAll advantages that I can see are around tooling support (mostly IDEs and editors). For example, things that would work out of the box if it was pure mocha:\r\n- support for seeing test results directly in your IDE with VS Code (plugins) or webstorm (built in)\r\n![Webstorm support](https://d3nmt5vlzunoa1.cloudfront.net/webstorm/files/2015/08/mocha-ui.png)\r\n- easy jumping to different test cases\r\n- run only one test case with single click\r\n\r\n## Implementation problems\r\nThe biggest problem right now is that without workarounds like [mocha-prepare](https://www.npmjs.com/package/mocha-prepare) or changes to mocha itself it's impossible to run all required async tasks before running tests itself.\r\n\r\nAnother problem, of course, is that `truffle` uses `contract` functions to describe tests suites instead of relying on `describe`. I am curious what's the reasoning behind it and could it be easily replaced with `describe`?\r\n\r\n\r\nIs there any pressure for bringing full compatibility with mocha? \r\n\r\n\r\n\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/1228/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1228/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/416110273",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1228#issuecomment-416110273",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1228",
    "id": 416110273,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNjExMDI3Mw==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-27T04:21:34Z",
    "updated_at": "2018-08-27T04:21:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @krzkaczor. Truffle does expose / consume a `mocha` object in truffle.js where you can set mocha options. \r\n\r\nThe syntax is:\r\n```javascript\r\nmodule.exports = {\r\n  networks: {\r\n    ...etc...\r\n  },\r\n  mocha: {\r\n    someOption: <some-value>,\r\n    anotherOption: <another-value>\r\n  }\r\n};\r\n```\r\nTruffle just passes mocha this object so anything that usually works with mocha should theoretically be fine. The `contract` abstraction aliases describe and passes in accounts and shouldn't interfere with anything.  \r\n\r\nAn example of mocha extensions working ok with truffle is [eth-gas-reporter](https://github.com/cgewecke/eth-gas-reporter)  which uses mocha's [third-party-reporter](https://github.com/mochajs/mocha/wiki/Third-party-reporters) feature. \r\n\r\nIf you have a chance could you see if `mocha-prepare` can be enabled through the config? ",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/416110273/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/417713566",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1228#issuecomment-417713566",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1228",
    "id": 417713566,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzcxMzU2Ng==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-31T16:12:17Z",
    "updated_at": "2018-08-31T16:12:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "@krzkaczor Do the mocha options in the config work for your use case? Is this closable?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/417713566/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/417765313",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1228#issuecomment-417765313",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1228",
    "id": 417765313,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzc2NTMxMw==",
    "user": {
      "login": "krzkaczor",
      "id": 1814312,
      "node_id": "MDQ6VXNlcjE4MTQzMTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1814312?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/krzkaczor",
      "html_url": "https://github.com/krzkaczor",
      "followers_url": "https://api.github.com/users/krzkaczor/followers",
      "following_url": "https://api.github.com/users/krzkaczor/following{/other_user}",
      "gists_url": "https://api.github.com/users/krzkaczor/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/krzkaczor/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/krzkaczor/subscriptions",
      "organizations_url": "https://api.github.com/users/krzkaczor/orgs",
      "repos_url": "https://api.github.com/users/krzkaczor/repos",
      "events_url": "https://api.github.com/users/krzkaczor/events{/privacy}",
      "received_events_url": "https://api.github.com/users/krzkaczor/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-31T19:20:34Z",
    "updated_at": "2018-08-31T19:20:34Z",
    "author_association": "NONE",
    "body": "@cgewecke thanks for your response. So I guess, what I am asking about is: can i run mocha cli (`node_modules/.bin/mocha`) with some set of parameters and have the same outcome as running `truffle test`. This would be cool since it would allow more easily to integrate with IDEs (things like: run this test only).",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/417765313/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/417772661",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1228#issuecomment-417772661",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1228",
    "id": 417772661,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNzc3MjY2MQ==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-31T19:53:28Z",
    "updated_at": "2018-08-31T19:53:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "@krzkaczor At the moment no - unless you write your own version of what happens at truffle in the test command. That code is mostly [here](https://github.com/trufflesuite/truffle/blob/develop/packages/truffle-core/lib/test.js) and the key resources injected into the test environment are [here](https://github.com/trufflesuite/truffle/blob/develop/packages/truffle-core/lib/test.js#L209-L213). Mocha's also passed the config options object and accounts are injected into `contract` test wrapper.\r\n\r\nIt *is* possible to write `contract.only` or `contract.skip` for more a little more control over what tests run. \r\n\r\n`truffle test` is one of next things on the schedule for a rewrite - I guess I would like to keep this open now. Agree we should try support the use case you identified, along with other test frameworks like jest etc. ",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/417772661/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
