{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/2612",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2612/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2612/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2612/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/2612",
  "id": 524595100,
  "node_id": "MDU6SXNzdWU1MjQ1OTUxMDA=",
  "number": 2612,
  "title": "Using deployed contracts packaged as npm",
  "user": {
    "login": "tuler",
    "id": 73850,
    "node_id": "MDQ6VXNlcjczODUw",
    "avatar_url": "https://avatars.githubusercontent.com/u/73850?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tuler",
    "html_url": "https://github.com/tuler",
    "followers_url": "https://api.github.com/users/tuler/followers",
    "following_url": "https://api.github.com/users/tuler/following{/other_user}",
    "gists_url": "https://api.github.com/users/tuler/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tuler/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tuler/subscriptions",
    "organizations_url": "https://api.github.com/users/tuler/orgs",
    "repos_url": "https://api.github.com/users/tuler/repos",
    "events_url": "https://api.github.com/users/tuler/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tuler/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1675041796,
      "node_id": "MDU6TGFiZWwxNjc1MDQxNzk2",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/priority3%20%F0%9F%94%A7",
      "name": "priority3 ðŸ”§",
      "color": "006b75",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "eggplantzzz",
    "id": 14827965,
    "node_id": "MDQ6VXNlcjE0ODI3OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/eggplantzzz",
    "html_url": "https://github.com/eggplantzzz",
    "followers_url": "https://api.github.com/users/eggplantzzz/followers",
    "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
    "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
    "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
    "repos_url": "https://api.github.com/users/eggplantzzz/repos",
    "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
    "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2019-11-18T20:15:09Z",
  "updated_at": "2023-03-16T17:59:16Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "- [x] I've asked for help in the [Truffle Gitter](http://gitter.im/Consensys/truffle) before filing this issue.\r\n\r\n---------------------------\r\n\r\n## Issue\r\n\r\nWhen importing contracts packaged as npm the deployment information for those contracts is not being used. The contract is being recompiled, and not resolving to the original dependency already compiled code.\r\n\r\n## Steps to Reproduce\r\n\r\nThe following test project has instructions on how to reproduce this:\r\nhttps://github.com/tuler/truffle-npm-test\r\n\r\n## Expected Behavior\r\n\r\nUse the files from `node_modules/<package>/build` if they exist, instead of recompiling all contracts.\r\n\r\n## Actual Results\r\n\r\nDependent solidity code is recompiled, generating a new set of `.json` files at `truffle-test-b/build`. Those files do not have deployment information (networks), so the migration of `truffle-test-b` fails.\r\n\r\n```\r\n2_deploy_app.js\r\n===============\r\n\r\nError: Error: SimpleStorage has no network configuration for its current network id (1574099427158).\r\n    at Object.run (/workspace/truffle-npm-test/truffle-test-b/node_modules/truffle/build/webpack:/packages/migrate/index.js:92:1)\r\n    at processTicksAndRejections (internal/process/task_queues.js:93:5)\r\n```\r\n\r\n## Environment\r\n\r\n* Operating System: macOS Catalina 10.15.1\r\n\r\n* Truffle version (`truffle version`):\r\nTruffle v5.1.0 (core: 5.1.0)\r\nSolidity v0.5.12 (solc-js)\r\nNode v12.13.0\r\nWeb3.js v1.2.2\r\n\r\n* node version (`node --version`): v12.13.0\r\n* npm version (`npm --version`): 6.12.0\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/2612/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2612/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/556250020",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2612#issuecomment-556250020",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2612",
    "id": 556250020,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NjI1MDAyMA==",
    "user": {
      "login": "fainashalts",
      "id": 8952139,
      "node_id": "MDQ6VXNlcjg5NTIxMzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8952139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fainashalts",
      "html_url": "https://github.com/fainashalts",
      "followers_url": "https://api.github.com/users/fainashalts/followers",
      "following_url": "https://api.github.com/users/fainashalts/following{/other_user}",
      "gists_url": "https://api.github.com/users/fainashalts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fainashalts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fainashalts/subscriptions",
      "organizations_url": "https://api.github.com/users/fainashalts/orgs",
      "repos_url": "https://api.github.com/users/fainashalts/repos",
      "events_url": "https://api.github.com/users/fainashalts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fainashalts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-20T19:00:16Z",
    "updated_at": "2019-11-20T19:00:16Z",
    "author_association": "MEMBER",
    "body": "Hi @tuler, thank you for bringing this up!\r\nThere may be no way to avoid re-compilation, but the issue here is that the artifacts from the previous compilation in the npm dependency are not being merged with the new compilation as they should, making you lose the networks info. We'll take a closer look at this issue once #2599 is resolved, which will lay some groundwork for fixing this.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/556250020/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/652565357",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2612#issuecomment-652565357",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2612",
    "id": 652565357,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MjU2NTM1Nw==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-01T17:59:04Z",
    "updated_at": "2020-07-01T17:59:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "Related to #1250.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/652565357/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1372680402",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2612#issuecomment-1372680402",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2612",
    "id": 1372680402,
    "node_id": "IC_kwDOAkfq-c5R0XDS",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-05T20:08:37Z",
    "updated_at": "2023-01-05T20:08:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "do npm packages still distribute with built Truffle artifact files?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1372680402/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1472457305",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2612#issuecomment-1472457305",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2612",
    "id": 1472457305,
    "node_id": "IC_kwDOAkfq-c5Xw-pZ",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-16T17:59:15Z",
    "updated_at": "2023-03-16T17:59:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "One thing to note is that normally when Truffle compiles and saves artifacts from a user's project (Solidity files that are by default in the `contracts` folder), we merge in the new one with the old. That way network information gets persisted across multiple compiles. Seems like we should probably do that here.\r\n\r\nHowever, the problem is a little bit bigger than that. If you import a Solidity file in your own Solidity files, compilation needs to happen and there is currently no way to feed that info to the compiler. Normally you would have to compile and then record the address of the deployed contract in the constructor of your new contract during deployment or use some other kind of setter. I'm not sure what there is to do about that part of the problem.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1472457305/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
