{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/1458",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1458/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1458/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1458/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/1458",
  "id": 384303763,
  "node_id": "MDU6SXNzdWUzODQzMDM3NjM=",
  "number": 1458,
  "title": "Cannot add custom Chai helpers",
  "user": {
    "login": "schuma7",
    "id": 3436123,
    "node_id": "MDQ6VXNlcjM0MzYxMjM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3436123?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/schuma7",
    "html_url": "https://github.com/schuma7",
    "followers_url": "https://api.github.com/users/schuma7/followers",
    "following_url": "https://api.github.com/users/schuma7/following{/other_user}",
    "gists_url": "https://api.github.com/users/schuma7/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/schuma7/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/schuma7/subscriptions",
    "organizations_url": "https://api.github.com/users/schuma7/orgs",
    "repos_url": "https://api.github.com/users/schuma7/repos",
    "events_url": "https://api.github.com/users/schuma7/events{/privacy}",
    "received_events_url": "https://api.github.com/users/schuma7/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1120350502,
      "node_id": "MDU6TGFiZWwxMTIwMzUwNTAy",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/stale",
      "name": "stale",
      "color": "ffffff",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2018-11-26T12:14:52Z",
  "updated_at": "2019-02-04T16:20:15Z",
  "closed_at": "2019-02-04T16:20:15Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "- [x] I've asked for help in the [Truffle Gitter](http://gitter.im/Consensys/truffle) before filing this issue.\r\n\r\n---------------------------\r\n\r\n## Issue\r\n\r\nI am trying to add custom Chai helpers as described [here](https://www.chaijs.com/guide/helpers/). I installed chai as a dev dependency, since it was not available as a global.\r\n\r\nWhen trying to apply the helper using ```expect(someObject).to.myCustomMatcher;``` the following error is thrown: \"Error: Invalid Chai property: myCustomMatcher\".\r\n\r\nHowever, if I use the expect function on the imported chai object ```chai.expect(someObject).to.myCustomMatcher;```the helper is working as expected.\r\n\r\nI guess truffle somehow uses a different chai reference and I am wondering what the proper approach is to adding a custom Chai helper. It'd also be great to know where I am expected to add these custom helpers so that they are available in all my test suites.\r\n\r\n## Steps to Reproduce\r\n\r\n```\r\nimport chai from 'chai';\r\n\r\nchai.use((localChai, utils) => {\r\n  const Assertion = localChai.Assertion;\r\n  utils.addProperty(Assertion.prototype, 'myCustomMatcher', function(\r\n    this: any,\r\n  ) {\r\n    this.assert(\r\n      this._obj instanceof Object,\r\n      'expected #{this} to be a Model',\r\n      'expected #{this} to not be a Model',\r\n    );\r\n  });\r\n});\r\n\r\ndescribe.only('config', () => {\r\n  it('should contain valid configuration values', () => {\r\n    const someObject = {};\r\n    expect(someObject).to.myCustomMatcher;\r\n  });\r\n});\r\n```\r\n\r\n## Expected Behavior\r\n\r\nThe custom helper should be available when using the expect function on the global object.\r\n\r\n## Actual Results\r\n\r\nIt throws the following error: \"Error: Invalid Chai property: myCustomMatcher\".\r\n\r\n## Environment\r\n\r\n* Operating System: Mac OS X 10.14.1\r\n* Ethereum client: Ganache 1.2.2\r\n* Truffle version (`truffle version`):  v4.1.14\r\n* node version (`node --version`): v10.5.0\r\n* npm version (`npm --version`): 6.4.1\r\n* installed Chai version: 4.1.2",
  "closed_by": {
    "login": "stale[bot]",
    "id": 26384082,
    "node_id": "MDM6Qm90MjYzODQwODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/stale%5Bbot%5D",
    "html_url": "https://github.com/apps/stale",
    "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/1458/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1458/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/442782108",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1458#issuecomment-442782108",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1458",
    "id": 442782108,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0Mjc4MjEwOA==",
    "user": {
      "login": "schuma7",
      "id": 3436123,
      "node_id": "MDQ6VXNlcjM0MzYxMjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3436123?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/schuma7",
      "html_url": "https://github.com/schuma7",
      "followers_url": "https://api.github.com/users/schuma7/followers",
      "following_url": "https://api.github.com/users/schuma7/following{/other_user}",
      "gists_url": "https://api.github.com/users/schuma7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/schuma7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/schuma7/subscriptions",
      "organizations_url": "https://api.github.com/users/schuma7/orgs",
      "repos_url": "https://api.github.com/users/schuma7/repos",
      "events_url": "https://api.github.com/users/schuma7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/schuma7/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-29T10:22:56Z",
    "updated_at": "2018-11-29T10:22:56Z",
    "author_association": "NONE",
    "body": "For anyone interested in a temporary workaround, I got around this issue by creating the following init-test.ts file:\r\n\r\n```\r\nimport chai from 'chai';\r\nimport { myCustomHelper } from './helpers/myCustomHelper';\r\n\r\nchai.use(myCustomHelper);\r\n\r\nglobal.assert = chai.assert;\r\nglobal.expect = chai.expect;\r\nglobal.should = chai.should;\r\n\r\ndeclare global {\r\n  namespace NodeJS {\r\n    interface Global {\r\n      assert: Chai.AssertStatic;\r\n      expect: Chai.ExpectStatic;\r\n      should(): Chai.Should;\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nThe main drawback of this solution is that you need to remember to require this file at the top of every test suite. But it does the trick until the truffle framework offers a way to add mocha test fixtures.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/442782108/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/458191841",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1458#issuecomment-458191841",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1458",
    "id": 458191841,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1ODE5MTg0MQ==",
    "user": {
      "login": "stale[bot]",
      "id": 26384082,
      "node_id": "MDM6Qm90MjYzODQwODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stale%5Bbot%5D",
      "html_url": "https://github.com/apps/stale",
      "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2019-01-28T16:06:17Z",
    "updated_at": "2019-01-28T16:06:17Z",
    "author_association": "NONE",
    "body": "Thank you for raising this issue! It has been automatically marked as stale because it has not had recent activity. It will be closed in 7 days if no further activity occurs. If you would like to keep this issue open, please respond with information about the current state of this problem.\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/458191841/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/460310728",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1458#issuecomment-460310728",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1458",
    "id": 460310728,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2MDMxMDcyOA==",
    "user": {
      "login": "stale[bot]",
      "id": 26384082,
      "node_id": "MDM6Qm90MjYzODQwODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stale%5Bbot%5D",
      "html_url": "https://github.com/apps/stale",
      "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2019-02-04T16:20:14Z",
    "updated_at": "2019-02-04T16:20:14Z",
    "author_association": "NONE",
    "body": "There has been no new activity on this issue since it was marked as stale 7 days ago, so it is being automatically closed.  If you'd like help with this or a different problem, please open a new issue. Thanks!\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/460310728/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
