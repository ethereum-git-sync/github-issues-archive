{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/834",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/834/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/834/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/834/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/834",
  "id": 302705769,
  "node_id": "MDU6SXNzdWUzMDI3MDU3Njk=",
  "number": 834,
  "title": "Sending balance from contract to contract fails with revert",
  "user": {
    "login": "carlosero",
    "id": 2349502,
    "node_id": "MDQ6VXNlcjIzNDk1MDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2349502?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/carlosero",
    "html_url": "https://github.com/carlosero",
    "followers_url": "https://api.github.com/users/carlosero/followers",
    "following_url": "https://api.github.com/users/carlosero/following{/other_user}",
    "gists_url": "https://api.github.com/users/carlosero/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/carlosero/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/carlosero/subscriptions",
    "organizations_url": "https://api.github.com/users/carlosero/orgs",
    "repos_url": "https://api.github.com/users/carlosero/repos",
    "events_url": "https://api.github.com/users/carlosero/events{/privacy}",
    "received_events_url": "https://api.github.com/users/carlosero/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2018-03-06T13:42:56Z",
  "updated_at": "2018-03-06T17:44:28Z",
  "closed_at": "2018-03-06T17:37:33Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Issue\r\n\r\nSending balance from one contract to a second contract's fallback function (`function () external payable`) fails.\r\n\r\nI have two contracts, FirstContract and SecondContract, when sending balance to a payable external function in FirstContract it works, but then sending from FirstContract to SecondContract returns error with revert. There is absolutely no require/assert validations at all.\r\n\r\nI did a repository with the issue for ease of reproducing it.\r\n\r\nI did search for it but everyone seems to have a different problem than this.\r\n\r\nI'm very sorry if this is trivial and everyone knows how to fix it, but this is driving me crazy. First time I've ever submitted an issue somewhere.\r\n\r\n## Steps to Reproduce\r\n\r\n1. Clone https://github.com/carlosero/truffle-issue\r\n2. Run `truffle test`\r\n3. Will return error \"revert\".\r\n\r\n## Expected Behavior\r\n\r\nSecondContract receives the balance from FirstContract.\r\n\r\n## Actual Results\r\n\r\nSecondContract rejects the transaction (fallback external transaction).\r\n\r\n## Environment\r\n\r\n* Operating System: Ubuntu 16.04\r\n* Ethereum client: --\r\n* Truffle version (`truffle version`): Truffle v4.0.7 (core: 4.0.7)\r\n* node version (`node --version`): v7.10.0\r\n* npm version (`npm --version`): 4.2.0\r\n",
  "closed_by": {
    "login": "carlosero",
    "id": 2349502,
    "node_id": "MDQ6VXNlcjIzNDk1MDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2349502?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/carlosero",
    "html_url": "https://github.com/carlosero",
    "followers_url": "https://api.github.com/users/carlosero/followers",
    "following_url": "https://api.github.com/users/carlosero/following{/other_user}",
    "gists_url": "https://api.github.com/users/carlosero/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/carlosero/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/carlosero/subscriptions",
    "organizations_url": "https://api.github.com/users/carlosero/orgs",
    "repos_url": "https://api.github.com/users/carlosero/repos",
    "events_url": "https://api.github.com/users/carlosero/events{/privacy}",
    "received_events_url": "https://api.github.com/users/carlosero/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/834/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/834/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/370864040",
    "html_url": "https://github.com/trufflesuite/truffle/issues/834#issuecomment-370864040",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/834",
    "id": 370864040,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MDg2NDA0MA==",
    "user": {
      "login": "carlosero",
      "id": 2349502,
      "node_id": "MDQ6VXNlcjIzNDk1MDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2349502?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/carlosero",
      "html_url": "https://github.com/carlosero",
      "followers_url": "https://api.github.com/users/carlosero/followers",
      "following_url": "https://api.github.com/users/carlosero/following{/other_user}",
      "gists_url": "https://api.github.com/users/carlosero/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/carlosero/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/carlosero/subscriptions",
      "organizations_url": "https://api.github.com/users/carlosero/orgs",
      "repos_url": "https://api.github.com/users/carlosero/repos",
      "events_url": "https://api.github.com/users/carlosero/events{/privacy}",
      "received_events_url": "https://api.github.com/users/carlosero/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-06T17:37:33Z",
    "updated_at": "2018-03-06T17:37:33Z",
    "author_association": "NONE",
    "body": "Closing this myself. This was rather simple. Solution if anyone has the same issue ever:\r\nWhen transfering from a contract to another using .transfer, and using fallback function, gas by default will be 2300, which will revert any kind of operation that uses more gas than that.\r\n\r\nhttps://consensys.github.io/smart-contract-best-practices/recommendations/#keep-fallback-functions-simple",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/370864040/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/370866249",
    "html_url": "https://github.com/trufflesuite/truffle/issues/834#issuecomment-370866249",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/834",
    "id": 370866249,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MDg2NjI0OQ==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-06T17:44:28Z",
    "updated_at": "2018-03-06T17:44:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "@carlosero Yes exactly. Thanks for producing such a clear example repository - this is a model bug report for what it's worth :) Glad you solved it.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/370866249/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
