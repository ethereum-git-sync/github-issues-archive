{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/506",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/506/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/506/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/506/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/506",
  "id": 244756377,
  "node_id": "MDU6SXNzdWUyNDQ3NTYzNzc=",
  "number": 506,
  "title": "Solidity contract functions not returning correctly with Truffle, but working on Remix",
  "user": {
    "login": "christian-valadez",
    "id": 22481651,
    "node_id": "MDQ6VXNlcjIyNDgxNjUx",
    "avatar_url": "https://avatars.githubusercontent.com/u/22481651?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/christian-valadez",
    "html_url": "https://github.com/christian-valadez",
    "followers_url": "https://api.github.com/users/christian-valadez/followers",
    "following_url": "https://api.github.com/users/christian-valadez/following{/other_user}",
    "gists_url": "https://api.github.com/users/christian-valadez/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/christian-valadez/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/christian-valadez/subscriptions",
    "organizations_url": "https://api.github.com/users/christian-valadez/orgs",
    "repos_url": "https://api.github.com/users/christian-valadez/repos",
    "events_url": "https://api.github.com/users/christian-valadez/events{/privacy}",
    "received_events_url": "https://api.github.com/users/christian-valadez/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2017-07-21T19:02:53Z",
  "updated_at": "2017-07-22T08:08:54Z",
  "closed_at": "2017-07-22T08:08:54Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I'm testing my contracts using Truffle, but my functions are not returning the correct uint, despite doing so when testing in Remix. This is my Test.js code:\r\n\r\n```\r\n    var EventContract = artifacts.require(\"./EventContract.sol\");\r\n    contract ('EventContract', function (accounts){\r\n    it(\"account1 purchases 4 tickets from ticketContract, which had 10 tickets to start with at a cost of 2\", function(){\r\n        var event;\r\n        var account1 = accounts[0];\r\n    \r\n        return EventContract.deployed()\r\n        .then(function(instance){\r\n          event = instance;\r\n            return event.buyTicketsFromContract.call(account1, 2, {from: account1, value: 4});\r\n        })\r\n        .then (function (success){\r\n          console.log(\"purchased from contract with success: \" + success);\r\n          assert.equal(true, success, \"bought 2 tickets for 4 ether\");\r\n          return event.getContractTicketBalance.call();\r\n        })\r\n        .then (function(contractBalance){\r\n          console.log(contractBalance.toNumber());\r\n    // Fails here\r\n          assert.equal(8, contractBalance.toNumber(), \"contract ticket balance is not 8\");\r\n          return event.getTicketBalance.call(account1);\r\n        })\r\n        .then (function(accountBalance){\r\n          assert.equal(2, accountBalance.toNumber(), \"account balance is not 2\");\r\n        })\r\n        ;\r\n      })\r\n      ;\r\n```\r\n\r\nIt fails because the contract ticket balance is 10 (initial amount), not 8. When using the same functions on Remix, the values returned are correct.  \r\n\r\nSomeone else on Github also had this issue a couple days ago: https://ethereum.stackexchange.com/questions/21483/why-contract-is-not-working-on-test-net-but-work-in-remix\r\n\r\n## Environment\r\n* Operating System: Windows 10\r\n* Truffle version: 3.4.5\r\n* Ethereum client: testRPC\r\n* node version: 8.1.4\r\n* npm version: 5.3.0 \r\n",
  "closed_by": {
    "login": "christian-valadez",
    "id": 22481651,
    "node_id": "MDQ6VXNlcjIyNDgxNjUx",
    "avatar_url": "https://avatars.githubusercontent.com/u/22481651?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/christian-valadez",
    "html_url": "https://github.com/christian-valadez",
    "followers_url": "https://api.github.com/users/christian-valadez/followers",
    "following_url": "https://api.github.com/users/christian-valadez/following{/other_user}",
    "gists_url": "https://api.github.com/users/christian-valadez/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/christian-valadez/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/christian-valadez/subscriptions",
    "organizations_url": "https://api.github.com/users/christian-valadez/orgs",
    "repos_url": "https://api.github.com/users/christian-valadez/repos",
    "events_url": "https://api.github.com/users/christian-valadez/events{/privacy}",
    "received_events_url": "https://api.github.com/users/christian-valadez/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/506/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/506/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/317165607",
    "html_url": "https://github.com/trufflesuite/truffle/issues/506#issuecomment-317165607",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/506",
    "id": 317165607,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxNzE2NTYwNw==",
    "user": {
      "login": "christian-valadez",
      "id": 22481651,
      "node_id": "MDQ6VXNlcjIyNDgxNjUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/22481651?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/christian-valadez",
      "html_url": "https://github.com/christian-valadez",
      "followers_url": "https://api.github.com/users/christian-valadez/followers",
      "following_url": "https://api.github.com/users/christian-valadez/following{/other_user}",
      "gists_url": "https://api.github.com/users/christian-valadez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/christian-valadez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/christian-valadez/subscriptions",
      "organizations_url": "https://api.github.com/users/christian-valadez/orgs",
      "repos_url": "https://api.github.com/users/christian-valadez/repos",
      "events_url": "https://api.github.com/users/christian-valadez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/christian-valadez/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-07-22T08:08:52Z",
    "updated_at": "2017-07-22T08:08:52Z",
    "author_association": "NONE",
    "body": "I was incorrectly using .call(), which is for read-only. ",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/317165607/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
