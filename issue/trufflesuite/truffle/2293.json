{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/2293",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2293/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2293/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2293/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/2293",
  "id": 480445123,
  "node_id": "MDU6SXNzdWU0ODA0NDUxMjM=",
  "number": 2293,
  "title": "contract.method.request() doesn't work and isn't very useful even if it did",
  "user": {
    "login": "haltman-at",
    "id": 35589221,
    "node_id": "MDQ6VXNlcjM1NTg5MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/haltman-at",
    "html_url": "https://github.com/haltman-at",
    "followers_url": "https://api.github.com/users/haltman-at/followers",
    "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
    "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
    "organizations_url": "https://api.github.com/users/haltman-at/orgs",
    "repos_url": "https://api.github.com/users/haltman-at/repos",
    "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
    "received_events_url": "https://api.github.com/users/haltman-at/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 230393326,
      "node_id": "MDU6TGFiZWwyMzAzOTMzMjY=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    },
    {
      "id": 230393328,
      "node_id": "MDU6TGFiZWwyMzAzOTMzMjg=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/enhancement",
      "name": "enhancement",
      "color": "84b6eb",
      "default": true,
      "description": null
    },
    {
      "id": 1675042241,
      "node_id": "MDU6TGFiZWwxNjc1MDQyMjQx",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/priority5%20%F0%9F%8C%80",
      "name": "priority5 ðŸŒ€",
      "color": "006b75",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2019-08-14T01:57:55Z",
  "updated_at": "2020-08-27T20:07:52Z",
  "closed_at": "2020-08-27T20:07:52Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Issue\r\n\r\nThis is something of a continuation of issue #381; not the original issue, mind you, but the issue raised below in the comments -- that as of Truffle v5, `contract.method.request()` no longer works.\r\n\r\nWhat I want to point out here is that, in addition to no longer working, the [intended] return value of `contract.method.request()` is not really as useful as it could be.\r\n\r\nAs best I can tell, the intended return value of `contract.method.request()` is that it's supposed to be the JSON for an RPC call (I'm assuming one that would send that transaction).  I think it would be much more useful if it returned a corresponding web3 transaction object instead.\r\n\r\nReasons:\r\n\r\n1. A JSON RPC object is specific to a specific method, whereas a web3 transaction object could be used for any of `sendTransaction`, `call`, or `estimateGas`.\r\n\r\n2. A web3 transaction object can easily be used with the widely-used web3 library, while using a JSON RPC requires doing one's own RPC calls.\r\n\r\n3. A JSON RPC object just contains a bunch of irrelevant information that most people won't want.\r\n\r\n4. ~~Continuing on the theme of (1), doing `request` this way would allow `sendTransaction`, `call`, and `estimateGas` to later be reimplemented as mostly wrappers around `request`, putting all the heavy lifting in one place, namely `request`.~~ Nevermind, this is what `prepare` does.\r\n\r\nNow, ordinarily, changing this behavior would be a breaking change... but seeing as `request` hasn't properly worked since Truffle v4 anyway, perhaps that's OK in this case?\r\n\r\nAnyway, I would like to suggest that:\r\n\r\n1. The `request` method be fixed, and\r\n\r\n2. Its return value be altered as above.\r\n\r\n**Edit**: I would also like to suggest that, as long as we're sort-of breaking things, perhaps its name could be changed to something more fitting.  Not sure what that would be, though.  ~~I was thinking perhaps `prepare`, but not sure that's clear enough, and that might be potentially confused with other things?~~  OK, see comment below.  What I'm describing is really what `prepare` does, so really we should just expose that instead of this.",
  "closed_by": {
    "login": "haltman-at",
    "id": 35589221,
    "node_id": "MDQ6VXNlcjM1NTg5MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/haltman-at",
    "html_url": "https://github.com/haltman-at",
    "followers_url": "https://api.github.com/users/haltman-at/followers",
    "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
    "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
    "organizations_url": "https://api.github.com/users/haltman-at/orgs",
    "repos_url": "https://api.github.com/users/haltman-at/repos",
    "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
    "received_events_url": "https://api.github.com/users/haltman-at/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/2293/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2293/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/521354323",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2293#issuecomment-521354323",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2293",
    "id": 521354323,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMTM1NDMyMw==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-14T18:03:22Z",
    "updated_at": "2019-08-14T18:03:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "Oh I guess actually `prepare` is exactly this, oops?  Yeah so IMO instead of fixing `request` it would make more sense to just expose `prepare`.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/521354323/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/521726142",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2293#issuecomment-521726142",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2293",
    "id": 521726142,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMTcyNjE0Mg==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-15T17:28:50Z",
    "updated_at": "2019-08-15T17:28:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "Although maybe `prepare` doesn't do what I think it does.  Anyway the point is what we should expose is what I described above, whether that's what `prepare` does or not.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/521726142/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/565150496",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2293#issuecomment-565150496",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2293",
    "id": 565150496,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NTE1MDQ5Ng==",
    "user": {
      "login": "CruzMolina",
      "id": 7537712,
      "node_id": "MDQ6VXNlcjc1Mzc3MTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7537712?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CruzMolina",
      "html_url": "https://github.com/CruzMolina",
      "followers_url": "https://api.github.com/users/CruzMolina/followers",
      "following_url": "https://api.github.com/users/CruzMolina/following{/other_user}",
      "gists_url": "https://api.github.com/users/CruzMolina/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CruzMolina/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CruzMolina/subscriptions",
      "organizations_url": "https://api.github.com/users/CruzMolina/orgs",
      "repos_url": "https://api.github.com/users/CruzMolina/repos",
      "events_url": "https://api.github.com/users/CruzMolina/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CruzMolina/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-12T19:30:06Z",
    "updated_at": "2019-12-12T19:30:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "Did some sleuthing a while back and it turns out `contract.method.request(params)` is not only super old, but also commented out in the [0.2x.x docs](https://github.com/ethereum/wiki/wiki/JavaScript-API#contract-methods)!\r\n\r\nIt also appears it was deprecated at some version of Web3.js 0.2x.x in favor of `contract.method.getData(params)`, which returns a bytestring. It's quite possible that `request` always returned a bytestring.\r\n\r\nFurthermore, it looks like `getData` didn't make it into Web3.js 1.x and got replaced by... [`contract.methods.method(params).encodeABI()`](https://web3js.readthedocs.io/en/v1.2.4/web3-eth-contract.html#methods-mymethod-encodeabi), which also returns a bytestring.\r\n\r\nSince this method already doesn't work and is not documented, I'm sure no one is really using or relying on it. Having whatever this future method becomes return a web3 tx object (while we still bundle web3) seems like a good idea!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/565150496/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
