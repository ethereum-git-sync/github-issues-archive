{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/697",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/697/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/697/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/697/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/697",
  "id": 278504202,
  "node_id": "MDU6SXNzdWUyNzg1MDQyMDI=",
  "number": 697,
  "title": "Getting int256 upper than or equal to 2^252 seems to bug",
  "user": {
    "login": "vrolland",
    "id": 4611986,
    "node_id": "MDQ6VXNlcjQ2MTE5ODY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4611986?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vrolland",
    "html_url": "https://github.com/vrolland",
    "followers_url": "https://api.github.com/users/vrolland/followers",
    "following_url": "https://api.github.com/users/vrolland/following{/other_user}",
    "gists_url": "https://api.github.com/users/vrolland/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vrolland/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vrolland/subscriptions",
    "organizations_url": "https://api.github.com/users/vrolland/orgs",
    "repos_url": "https://api.github.com/users/vrolland/repos",
    "events_url": "https://api.github.com/users/vrolland/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vrolland/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1120350502,
      "node_id": "MDU6TGFiZWwxMTIwMzUwNTAy",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/stale",
      "name": "stale",
      "color": "ffffff",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2017-12-01T15:37:03Z",
  "updated_at": "2018-11-15T10:10:12Z",
  "closed_at": "2018-11-15T10:10:12Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Issue\r\n\r\nTrying to get an int256 from a contract don't return the good value\r\n\r\n## Steps to Reproduce\r\nCreate a truffle project with this contract : \r\n```\r\npragma solidity 0.4.18;\r\n\r\ncontract Test {\r\n\r\n    int256 public testSignedInteger;\r\n\r\n    event Log(int256 testSignedIntegerBefore, int256 testSignedIntegerAfter, int256 amount );\r\n\r\n    function addition(int256 _amount)\r\n        external\r\n    {   \r\n        testSignedInteger = 0;\r\n        \r\n        int256 testSignedIntegerBefore = testSignedInteger;\r\n\r\n        testSignedInteger = testSignedInteger + _amount;\r\n\r\n        Log(testSignedIntegerBefore, testSignedInteger, _amount);\r\n    }\r\n}\r\n```\r\nand this test : \r\n```\r\nvar Test = artifacts.require(\"./Test.sol\");\r\nvar BigNumber = require('bignumber.js');\r\n\r\ncontract('Test', function(accounts) {\r\n\tit(\"test\", async function () {\r\n\t\tvar test = await Test.new();\r\n\r\n\t\tvar n = await test.addition(new BigNumber(2).pow(252).minus(1));\r\n\t\tconsole.log(\"------------------------\");\r\n\t\tconsole.log(\"addition new BigNumber(2).pow(252).minus(1) \");\r\n\t\tconsole.log(n.logs[0].args);\r\n\t\tconsole.log(\"------------------------\");\r\n\t\tconsole.log(\"------------------------\");\t\t\r\n\t\tvar testSignedInteger = await test.testSignedInteger.call();\r\n\t\tconsole.log(\"testSignedInteger new BigNumber(2).pow(252).minus(1) \");\r\n\t\tconsole.log(testSignedInteger);\r\n\t\tconsole.log(\"------------------------\");\r\n\r\n\t\tvar n = await test.addition(new BigNumber(2).pow(252));\r\n\t\tconsole.log(\"------------------------\");\r\n\t\tconsole.log(\"addition new BigNumber(2).pow(252)\");\r\n\t\tconsole.log(n.logs[0].args);\r\n\t\tconsole.log(\"------------------------\");\r\n\t\tconsole.log(\"------------------------\");\t\t\r\n\t\tvar testSignedInteger = await test.testSignedInteger.call();\r\n\t\tconsole.log(\"testSignedInteger new BigNumber(2).pow(252)\");\r\n\t\tconsole.log(testSignedInteger);\r\n\t\tconsole.log(\"------------------------\");\r\n\t});\r\n});\r\n```\r\n\r\n## Expected Behavior\r\n\r\nThe second \"test.testSignedInteger.call();\" should return :\r\n> BigNumber {\r\n>      s: 1,\r\n>      e: 75,\r\n>      c:\r\n>       [ 723700,\r\n>         55773322622139,\r\n>         73186563042994,\r\n>         24082937404160,\r\n>         25352524660990,\r\n>         494570602496 ] }\r\n\r\n\r\n## Actual Results\r\n\r\nIt actually returns : \r\n\r\n> BigNumber {\r\n>   s: -1,\r\n>   e: 77,\r\n>   c:\r\n>    [ 10855508,\r\n>      36599839332095,\r\n>      97798445644913,\r\n>      61244061062403,\r\n>      80287869914850,\r\n>      7418559037440 ] }\r\n\r\nBeside, if I retrieve \"testSignedInteger\" by my own (script nodejs with web3@1.0.0-beta.24) : \r\n```\r\nvar testContractABI = [...];\r\nvar _contractInstance = new web3.eth.Contract(testContractABI, \"0x6195590213bf0434450f2f61a90fb36597db4009\");\r\n_contractInstance.methods.testSignedInteger().call(function(err,data) {\r\n\tconsole.log(data);\r\n});\r\n```\r\nI get the right value :\r\n\"7237005577332262213973186563042994240829374041602535252466099000494570602496\"\r\n\r\n## Environment\r\n\r\n* Operating System: Windows10 (sadly..)\r\n* Truffle version: Truffle v4.0.1 (core: 4.0.1)\r\n* Ethereum client: EthereumJS TestRPC v6.0.3 (ganache-core: 2.0.2)\r\n* node version: 8.9.0\r\n* npm version:  5.5.1\r\n\r\n\r\n\r\n",
  "closed_by": {
    "login": "stale[bot]",
    "id": 26384082,
    "node_id": "MDM6Qm90MjYzODQwODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/stale%5Bbot%5D",
    "html_url": "https://github.com/apps/stale",
    "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/697/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/697/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/373868574",
    "html_url": "https://github.com/trufflesuite/truffle/issues/697#issuecomment-373868574",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/697",
    "id": 373868574,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3Mzg2ODU3NA==",
    "user": {
      "login": "mryellow",
      "id": 213575,
      "node_id": "MDQ6VXNlcjIxMzU3NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/213575?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mryellow",
      "html_url": "https://github.com/mryellow",
      "followers_url": "https://api.github.com/users/mryellow/followers",
      "following_url": "https://api.github.com/users/mryellow/following{/other_user}",
      "gists_url": "https://api.github.com/users/mryellow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mryellow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mryellow/subscriptions",
      "organizations_url": "https://api.github.com/users/mryellow/orgs",
      "repos_url": "https://api.github.com/users/mryellow/repos",
      "events_url": "https://api.github.com/users/mryellow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mryellow/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-16T23:09:13Z",
    "updated_at": "2018-03-16T23:14:10Z",
    "author_association": "NONE",
    "body": "It seems to be in the conversion between `int256` and `BigNumber`. \r\n\r\nThe number is correct inside Solidity however incorrect in CLI event log and Javascript.\r\n\r\nAn off-by-one here somewhere? Gets overflowed back to the negative end of the binary?\r\n\r\nThis code will also duplicate, showing correct outputs in Browser Solidity but then being output incorrectly in Javascript.\r\n\r\n```\r\npragma solidity ^0.4.18; // 21 also\r\n\r\ncontract Test {\r\n    int256 constant INT256_MIN = int256((uint256(1) << 255));\r\n    int256 constant INT256_MAX = int256(~bytes32((uint256(1) << 255)));\r\n    \r\n    function getMax() public pure returns(int256) {\r\n        return INT256_MAX;\r\n    }\r\n    \r\n    function getMin() public pure returns(int256) {\r\n        return INT256_MIN;\r\n    }\r\n}\r\n```\r\n\r\n```\r\ngetMin() = \r\n{ [String: '-5.7896044618658097711785492504343953926634992332820282019728792003956564819969e+76']\r\n  s: -1,\r\n  e: 76,\r\n  c: \r\n   [ 5789604,\r\n     46186580977117,\r\n     85492504343953,\r\n     92663499233282,\r\n     2820197287920,\r\n     3956564819969 ] }\r\n```\r\n\r\n```\r\ngetMax() = \r\n{ [String: '-5.7896044618658097711785492504343953926634992332820282019728792003956564819968e+76']\r\n  s: -1,\r\n  e: 76,\r\n  c: \r\n   [ 5789604,\r\n     46186580977117,\r\n     85492504343953,\r\n     92663499233282,\r\n     2820197287920,\r\n     3956564819968 ] }\r\n```\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/373868574/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/383742092",
    "html_url": "https://github.com/trufflesuite/truffle/issues/697#issuecomment-383742092",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/697",
    "id": 383742092,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4Mzc0MjA5Mg==",
    "user": {
      "login": "mryellow",
      "id": 213575,
      "node_id": "MDQ6VXNlcjIxMzU3NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/213575?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mryellow",
      "html_url": "https://github.com/mryellow",
      "followers_url": "https://api.github.com/users/mryellow/followers",
      "following_url": "https://api.github.com/users/mryellow/following{/other_user}",
      "gists_url": "https://api.github.com/users/mryellow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mryellow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mryellow/subscriptions",
      "organizations_url": "https://api.github.com/users/mryellow/orgs",
      "repos_url": "https://api.github.com/users/mryellow/repos",
      "events_url": "https://api.github.com/users/mryellow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mryellow/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-23T22:23:47Z",
    "updated_at": "2018-04-23T22:23:47Z",
    "author_association": "NONE",
    "body": "I'm getting passes on this. I didn't run these tests when the problem originally appears so I'm unsure if this is an improvement or if there is an oversight here somewhere which causes the problem.\r\n\r\n```\r\nContract: Test\r\n------------------------\r\naddition new BigNumber(2).pow(252).minus(1) \r\n{ testSignedIntegerBefore: BigNumber { s: 1, e: 0, c: [ 0 ] },\r\n  testSignedIntegerAfter: \r\n   BigNumber {\r\n     s: 1,\r\n     e: 75,\r\n     c: \r\n      [ 723700,\r\n        55773322622139,\r\n        73186563042994,\r\n        24082937404160,\r\n        25352524660990,\r\n        494570602495 ] },\r\n  amount: \r\n   BigNumber {\r\n     s: 1,\r\n     e: 75,\r\n     c: \r\n      [ 723700,\r\n        55773322622139,\r\n        73186563042994,\r\n        24082937404160,\r\n        25352524660990,\r\n        494570602495 ] } }\r\n------------------------\r\n------------------------\r\ntestSignedInteger new BigNumber(2).pow(252).minus(1) \r\nBigNumber {\r\n  s: 1,\r\n  e: 75,\r\n  c: \r\n   [ 723700,\r\n     55773322622139,\r\n     73186563042994,\r\n     24082937404160,\r\n     25352524660990,\r\n     494570602495 ] }\r\n------------------------\r\n------------------------\r\naddition new BigNumber(2).pow(252)\r\n{ testSignedIntegerBefore: BigNumber { s: 1, e: 0, c: [ 0 ] },\r\n  testSignedIntegerAfter: \r\n   BigNumber {\r\n     s: 1,\r\n     e: 75,\r\n     c: \r\n      [ 723700,\r\n        55773322622139,\r\n        73186563042994,\r\n        24082937404160,\r\n        25352524660990,\r\n        494570602496 ] },\r\n  amount: \r\n   BigNumber {\r\n     s: 1,\r\n     e: 75,\r\n     c: \r\n      [ 723700,\r\n        55773322622139,\r\n        73186563042994,\r\n        24082937404160,\r\n        25352524660990,\r\n        494570602496 ] } }\r\n------------------------\r\n------------------------\r\ntestSignedInteger new BigNumber(2).pow(252)\r\nBigNumber {\r\n  s: -1,\r\n  e: 77,\r\n  c: \r\n   [ 10855508,\r\n     36599839332095,\r\n     97798445644913,\r\n     61244061062403,\r\n     80287869914850,\r\n     7418559037440 ] }\r\n------------------------\r\n    ✓ test (300ms)\r\n\r\n\r\n  1 passing (330ms)\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/383742092/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/383742510",
    "html_url": "https://github.com/trufflesuite/truffle/issues/697#issuecomment-383742510",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/697",
    "id": 383742510,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4Mzc0MjUxMA==",
    "user": {
      "login": "mryellow",
      "id": 213575,
      "node_id": "MDQ6VXNlcjIxMzU3NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/213575?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mryellow",
      "html_url": "https://github.com/mryellow",
      "followers_url": "https://api.github.com/users/mryellow/followers",
      "following_url": "https://api.github.com/users/mryellow/following{/other_user}",
      "gists_url": "https://api.github.com/users/mryellow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mryellow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mryellow/subscriptions",
      "organizations_url": "https://api.github.com/users/mryellow/orgs",
      "repos_url": "https://api.github.com/users/mryellow/repos",
      "events_url": "https://api.github.com/users/mryellow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mryellow/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-23T22:25:37Z",
    "updated_at": "2018-04-23T22:25:37Z",
    "author_association": "NONE",
    "body": "Oh it passes because there are no assertions only logging.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/383742510/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/436927370",
    "html_url": "https://github.com/trufflesuite/truffle/issues/697#issuecomment-436927370",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/697",
    "id": 436927370,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjkyNzM3MA==",
    "user": {
      "login": "stale[bot]",
      "id": 26384082,
      "node_id": "MDM6Qm90MjYzODQwODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stale%5Bbot%5D",
      "html_url": "https://github.com/apps/stale",
      "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2018-11-08T09:22:09Z",
    "updated_at": "2018-11-08T09:22:09Z",
    "author_association": "NONE",
    "body": "Thank you for raising this issue! It has been automatically marked as stale because it has not had recent activity. It will be closed in 7 days if no further activity occurs. If you would like to keep this issue open, please respond with information about the current state of this problem.\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/436927370/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/438987315",
    "html_url": "https://github.com/trufflesuite/truffle/issues/697#issuecomment-438987315",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/697",
    "id": 438987315,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzODk4NzMxNQ==",
    "user": {
      "login": "stale[bot]",
      "id": 26384082,
      "node_id": "MDM6Qm90MjYzODQwODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stale%5Bbot%5D",
      "html_url": "https://github.com/apps/stale",
      "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2018-11-15T10:09:42Z",
    "updated_at": "2018-11-15T10:09:42Z",
    "author_association": "NONE",
    "body": "There has been no new activity on this issue since it was marked as stale 7 days ago, so it is being automatically closed.  If you'd like help with this or a different problem, please open a new issue. Thanks!\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/438987315/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
