{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/4165",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4165/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4165/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4165/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/4165",
  "id": 939916073,
  "node_id": "MDU6SXNzdWU5Mzk5MTYwNzM=",
  "number": 4165,
  "title": "Difference in behavior between absolute import paths starting with multiple slashes and ones starting with a single one",
  "user": {
    "login": "cameel",
    "id": 137030,
    "node_id": "MDQ6VXNlcjEzNzAzMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cameel",
    "html_url": "https://github.com/cameel",
    "followers_url": "https://api.github.com/users/cameel/followers",
    "following_url": "https://api.github.com/users/cameel/following{/other_user}",
    "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
    "organizations_url": "https://api.github.com/users/cameel/orgs",
    "repos_url": "https://api.github.com/users/cameel/repos",
    "events_url": "https://api.github.com/users/cameel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cameel/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1403343142,
      "node_id": "MDU6TGFiZWwxNDAzMzQzMTQy",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/needs%20investigated",
      "name": "needs investigated",
      "color": "b7410e",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2021-07-08T14:23:57Z",
  "updated_at": "2021-09-11T02:31:46Z",
  "closed_at": "2021-09-11T02:31:46Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Issue\r\nAs far as I can tell, Truffle no longer resolves absolute paths in imports (i.e. `/a/b/c.sol`) - it simply does not add the file to compiler's JSON input, which results in a compilation error. This is perhaps not the best way to report it (an explicit error saying that absolute paths are not supported would be better) but overall dropping support for them is a good thing in the light of #4119.\r\n\r\nThe problem is that a single leading slash is not the only way to specify an absolute path. `//a/b/c.sol` or `///a/b/c.sol` still results in an absolute path in compiler's input.\r\n\r\nI haven't checked this on Windows but `\\\\` or `C:\\\\` might be producing similar results. Note that paths starting with `//` (and `\\\\` on Windows) are actually [UNC paths](https://en.wikipedia.org/wiki/Path_(computing)#UNC). On Windows they are used for network shares while on Unix-like systems they often work like absolute paths, though they're still considered different - `//`, unlike `///` or more slashes is not squashed into a single `/` by shell.\r\n\r\n## Steps to Reproduce\r\n```bash\r\ncd /tmp/\r\nmkdir truffle-test/\r\ncd truffle-test/\r\nnpm install truffle\r\nnpx truffle init\r\necho 'module.exports.compilers.solc.version = \"0.8.6\";' >> truffle-config.js\r\n\r\necho 'contract C {}' > contracts/C.sol\r\necho 'import \"//tmp/truffle-test/contracts/C.sol\";' > contracts/D.sol\r\necho 'import \"///tmp/truffle-test/contracts/C.sol\";' > contracts/E.sol\r\nnpx truffle compile\r\n```\r\n## Actual Results\r\n```\r\n> Artifacts written to /tmp/truffle-test/build/contracts\r\n> Compiled successfully using:\r\n   - solc: 0.8.6+commit.11564f7e.Emscripten.clang\r\n\r\n\r\n> Duplicate contract names found for C.\r\n> This can cause errors and unknown behavior. Please rename one of your contracts.\r\n\r\n> Duplicate contract names found for C.\r\n> This can cause errors and unknown behavior. Please rename one of your contracts.\r\n```\r\n\r\nThe `sources` dict in the JSON input contains these entries:\r\n```json\r\n\"project:/contracts/C.sol\": { \"content\": \"contract C {}\\n\" },\r\n\"project:/contracts/D.sol\": { \"content\": \"import \\\"//tmp/truffle-test/contracts/C.sol\\\";\\n\" },\r\n\"project:/contracts/E.sol\": { \"content\": \"import \\\"///tmp/truffle-test/contracts/C.sol\\\";\\n\" },\r\n\"//tmp/truffle-test/contracts/C.sol\": { \"content\": \"contract C {}\\n\" },\r\n\"///tmp/truffle-test/contracts/C.sol\": { \"content\": \"contract C {}\\n\" }\r\n```\r\n\r\n## Expected Behavior\r\nPaths starting with more than one slash should be disallowed just like paths with a single slash:\r\n```bash\r\necho 'interface C {}' > contracts/C.sol\r\necho 'import \"/tmp/truffle-test/contracts/C.sol\";' > contracts/D.sol\r\nnpx truffle compile\r\n```\r\n```solidity\r\nParserError: Source \"/tmp/truffle-test/contracts/C.sol\" not found: File import callback not supported\r\n --> project:/contracts/D.sol:1:1:\r\n  |\r\n1 | import \"/tmp/truffle-test/contracts/C.sol\";\r\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n\r\nCompilation failed. See above.\r\n```\r\n\r\n## Environment\r\n\r\n* Operating System: Arch Linux\r\n* Truffle version: both `5.3.14` and current `develop` (abfb3646eea9d57e0a6f9186c12bb51680c181d8)\r\n* node version: `v16.4.2`\r\n* npm version: `7.17.0`\r\n",
  "closed_by": {
    "login": "haltman-at",
    "id": 35589221,
    "node_id": "MDQ6VXNlcjM1NTg5MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/haltman-at",
    "html_url": "https://github.com/haltman-at",
    "followers_url": "https://api.github.com/users/haltman-at/followers",
    "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
    "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
    "organizations_url": "https://api.github.com/users/haltman-at/orgs",
    "repos_url": "https://api.github.com/users/haltman-at/repos",
    "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
    "received_events_url": "https://api.github.com/users/haltman-at/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/4165/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4165/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/891365721",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4165#issuecomment-891365721",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4165",
    "id": 891365721,
    "node_id": "IC_kwDOAkfq-c41ISlZ",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-02T22:07:24Z",
    "updated_at": "2021-08-02T22:07:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "Huh, that's certainly odd.  Thanks for the report, I'll have to go see what's causing this.  I can reproduce the problem on latest develop, so this is definitely happening...",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/891365721/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/891370423",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4165#issuecomment-891370423",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4165",
    "id": 891370423,
    "node_id": "IC_kwDOAkfq-c41ITu3",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-02T22:15:48Z",
    "updated_at": "2021-08-02T22:15:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "Oh, I think I know why this is happening.\r\n\r\nThe problem is that absolute paths in imports *aren't* actually disallowed, per se.  Rather, they're just *effectively* disallowed because we transform paths to use `project:/` before feeding them to the compiler.  Something starting with a double-slash wouldn't be caught by that transformation, and so would get fed in with its double-slash path.\r\n\r\nI guess we could just filter out any absolute paths that don't start with the appropriate string (the project directory)?  That should do the trick, I think...",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/891370423/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/891373989",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4165#issuecomment-891373989",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4165",
    "id": 891373989,
    "node_id": "IC_kwDOAkfq-c41IUml",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-02T22:23:14Z",
    "updated_at": "2021-08-02T22:24:09Z",
    "author_association": "NONE",
    "body": "Does the transformation handle Windows absolute paths? Stuff like `C:\\path\\file.sol`, `C:/path/file.sol` or `C:///path/file.sol`? I could not easily test the Windows behavior (I only have access to a Windows VM in CI and it's a pain to use shell in that) so it might be worth checking if that's processed correctly too.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/891373989/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/891374685",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4165#issuecomment-891374685",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4165",
    "id": 891374685,
    "node_id": "IC_kwDOAkfq-c41IUxd",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-02T22:24:49Z",
    "updated_at": "2021-08-02T22:24:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm pretty sure that should already be handled, yes.  But @cds-amal is working on adding some Windows testing and fixing remaining Windows bugs though so he may want to take a look at that...",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/891374685/reactions",
      "total_count": 2,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 1
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/891408646",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4165#issuecomment-891408646",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4165",
    "id": 891408646,
    "node_id": "IC_kwDOAkfq-c41IdEG",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-02T23:58:13Z",
    "updated_at": "2021-08-02T23:58:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "(More specifically, the PR where @cds-amal is working on Windows stuff is #4206.)",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/891408646/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/917302791",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4165#issuecomment-917302791",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4165",
    "id": 917302791,
    "node_id": "IC_kwDOAkfq-c42rO4H",
    "user": {
      "login": "fainashalts",
      "id": 8952139,
      "node_id": "MDQ6VXNlcjg5NTIxMzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8952139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fainashalts",
      "html_url": "https://github.com/fainashalts",
      "followers_url": "https://api.github.com/users/fainashalts/followers",
      "following_url": "https://api.github.com/users/fainashalts/following{/other_user}",
      "gists_url": "https://api.github.com/users/fainashalts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fainashalts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fainashalts/subscriptions",
      "organizations_url": "https://api.github.com/users/fainashalts/orgs",
      "repos_url": "https://api.github.com/users/fainashalts/repos",
      "events_url": "https://api.github.com/users/fainashalts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fainashalts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-11T00:26:24Z",
    "updated_at": "2021-09-11T00:26:24Z",
    "author_association": "MEMBER",
    "body": "https://github.com/trufflesuite/truffle/pull/4216 is now live -- can this issue be closed, or is there more to do? Thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/917302791/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/917322797",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4165#issuecomment-917322797",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4165",
    "id": 917322797,
    "node_id": "IC_kwDOAkfq-c42rTwt",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-11T02:31:45Z",
    "updated_at": "2021-09-11T02:31:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm going to go ahead and just close this per normal process unless @cameel objects.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/917322797/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
