{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/1655",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1655/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1655/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1655/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/1655",
  "id": 402027504,
  "node_id": "MDU6SXNzdWU0MDIwMjc1MDQ=",
  "number": 1655,
  "title": "Error message \"<Contract> ran out of gas...\" is mistaken in some cases.",
  "user": {
    "login": "elliotolds",
    "id": 5849793,
    "node_id": "MDQ6VXNlcjU4NDk3OTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5849793?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/elliotolds",
    "html_url": "https://github.com/elliotolds",
    "followers_url": "https://api.github.com/users/elliotolds/followers",
    "following_url": "https://api.github.com/users/elliotolds/following{/other_user}",
    "gists_url": "https://api.github.com/users/elliotolds/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/elliotolds/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/elliotolds/subscriptions",
    "organizations_url": "https://api.github.com/users/elliotolds/orgs",
    "repos_url": "https://api.github.com/users/elliotolds/repos",
    "events_url": "https://api.github.com/users/elliotolds/events{/privacy}",
    "received_events_url": "https://api.github.com/users/elliotolds/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 230393328,
      "node_id": "MDU6TGFiZWwyMzAzOTMzMjg=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/enhancement",
      "name": "enhancement",
      "color": "84b6eb",
      "default": true,
      "description": null
    },
    {
      "id": 230393329,
      "node_id": "MDU6TGFiZWwyMzAzOTMzMjk=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/help%20wanted",
      "name": "help wanted",
      "color": "159818",
      "default": true,
      "description": null
    },
    {
      "id": 1088150379,
      "node_id": "MDU6TGFiZWwxMDg4MTUwMzc5",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/error%20better",
      "name": "error better",
      "color": "f27915",
      "default": false,
      "description": "issue indicates improvement to error messaging"
    },
    {
      "id": 1675042518,
      "node_id": "MDU6TGFiZWwxNjc1MDQyNTE4",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/priority6%20%F0%9F%92%AD",
      "name": "priority6 ðŸ’­",
      "color": "006b75",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2019-01-23T01:23:46Z",
  "updated_at": "2022-10-11T18:44:48Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "- [x] I've asked for help in the [Truffle Gitter](http://gitter.im/Consensys/truffle) before filing this issue.\r\n\r\n---------------------------\r\n\r\n## Issue\r\n\r\nDeployments can fail with the message \"<Contract Name> ran out of gas (using a value you set in your network config or deployment parameters.)\" when the problem is actually that the bytecode is too long. \r\n\r\n[EIP 170](https://github.com/ethereum/EIPs/blob/master/EIPS/eip-170.md) created the following consensus rule:\r\n\r\n> If block.number >= FORK_BLKNUM, then if contract creation initialization returns data with length of more than 0x6000 (2**14 + 2**13) bytes, contract creation fails with an out of gas error.\r\n\r\nI'm not sure why Vitalik wanted the error to be \"out of gas\" here, but when a developer sees this it can waste a lot of their time. Truffle should check whether the size of the bytecode is > 24576 and if so return a more informative error.\r\n\r\nNote that this is probably the root cause of https://github.com/trufflesuite/truffle/issues/1308 too.\r\n\r\n## Steps to Reproduce\r\n\r\nCreate a contract with a lot of code, such that the size of the bytecode when compiled is over 24576.\r\n\r\nRun \"truffle migrate\"\r\n\r\n## Expected Behavior\r\n\r\nThe error should indicate that the bytecode is too large to deploy.\r\n\r\n## Actual Results\r\n\r\n\"<Contract Name> ran out of gas (using a value you set in your network config or deployment parameters.)\"\r\n\r\n## Environment\r\n\r\n* Operating System: Linux Mint 18 \r\n* Ethereum client: just using truffle with ganache.\r\n* Truffle version (`truffle version`):  v5.0.0-beta.2 (core: 5.0.0-beta.2)\r\n* node version (`node --version`): v11.3.0\r\n* npm version (`npm --version`): 6.4.1\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/1655/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1655/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/474948858",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1655#issuecomment-474948858",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1655",
    "id": 474948858,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NDk0ODg1OA==",
    "user": {
      "login": "gnidan",
      "id": 151065,
      "node_id": "MDQ6VXNlcjE1MTA2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnidan",
      "html_url": "https://github.com/gnidan",
      "followers_url": "https://api.github.com/users/gnidan/followers",
      "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
      "organizations_url": "https://api.github.com/users/gnidan/orgs",
      "repos_url": "https://api.github.com/users/gnidan/repos",
      "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnidan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-20T17:36:18Z",
    "updated_at": "2019-03-20T17:36:18Z",
    "author_association": "MEMBER",
    "body": "The work here would be to intercept OOG exceptions and determine if the reason is EIP-170, not an actual out of gas error. This should be a fairly straightforward check to add on Truffle's side.\r\n\r\nThanks for suggesting this!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/474948858/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/477429742",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1655#issuecomment-477429742",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1655",
    "id": 477429742,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NzQyOTc0Mg==",
    "user": {
      "login": "w5pand",
      "id": 1818498,
      "node_id": "MDQ6VXNlcjE4MTg0OTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1818498?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/w5pand",
      "html_url": "https://github.com/w5pand",
      "followers_url": "https://api.github.com/users/w5pand/followers",
      "following_url": "https://api.github.com/users/w5pand/following{/other_user}",
      "gists_url": "https://api.github.com/users/w5pand/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/w5pand/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/w5pand/subscriptions",
      "organizations_url": "https://api.github.com/users/w5pand/orgs",
      "repos_url": "https://api.github.com/users/w5pand/repos",
      "events_url": "https://api.github.com/users/w5pand/events{/privacy}",
      "received_events_url": "https://api.github.com/users/w5pand/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-28T03:11:44Z",
    "updated_at": "2019-03-28T03:28:10Z",
    "author_association": "NONE",
    "body": "> The work here would be to intercept OOG exceptions and determine if the reason is EIP-170, not an actual out of gas error. This should be a fairly straightforward check to add on Truffle's side.\r\n> \r\n> Thanks for suggesting this!\r\n\r\nI have the same question,and i see \"Ganache-cli\" supported \"EIP-170\",but i prefer \"Gananche\".\r\nIs there a plan to add a setting to support for \"EIP-170\" in \"Gananche\"?\r\nIt would be nice to have this setting.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/477429742/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/481548732",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1655#issuecomment-481548732",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1655",
    "id": 481548732,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MTU0ODczMg==",
    "user": {
      "login": "wangxuw",
      "id": 10045739,
      "node_id": "MDQ6VXNlcjEwMDQ1NzM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/10045739?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wangxuw",
      "html_url": "https://github.com/wangxuw",
      "followers_url": "https://api.github.com/users/wangxuw/followers",
      "following_url": "https://api.github.com/users/wangxuw/following{/other_user}",
      "gists_url": "https://api.github.com/users/wangxuw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wangxuw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wangxuw/subscriptions",
      "organizations_url": "https://api.github.com/users/wangxuw/orgs",
      "repos_url": "https://api.github.com/users/wangxuw/repos",
      "events_url": "https://api.github.com/users/wangxuw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wangxuw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-10T06:15:44Z",
    "updated_at": "2019-04-10T06:15:44Z",
    "author_association": "NONE",
    "body": "Hi, I was trying to implement a decryption contract of AES algorithm and write the solidity code according to an C implementation version. And I encountered the same problem as below.\r\n```\r\nDeploying 'AES'\r\n   ---------------\r\nError:  *** Deployment Failed ***\r\n\r\n\"AES\" ran out of gas (using a value you set in your network config or deployment parameters.)\r\n   * Block limit:  0x201c061\r\n   * Gas sent:     6721975\r\n\r\n    at /usr/local/lib/node_modules/truffle/build/webpack:/packages/truffle-deployer/src/deployment.js:364:1\r\n    at processTicksAndRejections (internal/process/task_queues.js:86:5)\r\nTruffle v5.0.9 (core: 5.0.9)\r\nNode v11.13.0\r\n```\r\nI used the solc compiler to generate the OPCODE\r\n```\r\n       4    9082   49002 OPCODE.txt\r\n```\r\nand this is the wc output of the compiled OPCODE\r\n\r\n### Environment:\r\n- MacOS 10.14.4\r\n- Ganache CLI v6.4.1 (ganache-core: 2.5.3)\r\n\r\n\r\nI have tried to use ```--allowUnlimitedContractSize``` flag but it seems  only for debug use.\r\nThe question is should I split the contract into two or more parts to successfully deploy? Or any other best practice?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/481548732/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 2
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/575372802",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1655#issuecomment-575372802",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1655",
    "id": 575372802,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NTM3MjgwMg==",
    "user": {
      "login": "cliffhall",
      "id": 871933,
      "node_id": "MDQ6VXNlcjg3MTkzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/871933?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cliffhall",
      "html_url": "https://github.com/cliffhall",
      "followers_url": "https://api.github.com/users/cliffhall/followers",
      "following_url": "https://api.github.com/users/cliffhall/following{/other_user}",
      "gists_url": "https://api.github.com/users/cliffhall/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cliffhall/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cliffhall/subscriptions",
      "organizations_url": "https://api.github.com/users/cliffhall/orgs",
      "repos_url": "https://api.github.com/users/cliffhall/repos",
      "events_url": "https://api.github.com/users/cliffhall/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cliffhall/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-16T22:16:59Z",
    "updated_at": "2020-01-16T22:16:59Z",
    "author_association": "NONE",
    "body": "Getting the same issue with `ganache-cli 6.7.0`. Same question. Split contract or abandon ganache?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/575372802/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/575380970",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1655#issuecomment-575380970",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1655",
    "id": 575380970,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NTM4MDk3MA==",
    "user": {
      "login": "gnidan",
      "id": 151065,
      "node_id": "MDQ6VXNlcjE1MTA2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnidan",
      "html_url": "https://github.com/gnidan",
      "followers_url": "https://api.github.com/users/gnidan/followers",
      "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
      "organizations_url": "https://api.github.com/users/gnidan/orgs",
      "repos_url": "https://api.github.com/users/gnidan/repos",
      "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnidan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-16T22:41:34Z",
    "updated_at": "2020-01-16T22:41:34Z",
    "author_association": "MEMBER",
    "body": "Best practice probably dictates that splitting up contracts is the right move... We had to do this internally inside Truffle's [Assert.sol](https://github.com/trufflesuite/truffle/blob/develop/packages/core/lib/testing/Assert.sol), for instance.\r\n\r\nBut, it depends on your use case. If you're targeting mainnet for future deployment, then you probably want to make sure that your contract fits inside the bounds dictated by EIP-170, etc. If you are targeting a private network without those limitations, well, I believe Ganache's settings cover that?\r\n\r\nIt looks like this issue is specifically related to error message + extra detection. Is there something else actionable here?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/575380970/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
