{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/1276",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1276/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1276/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1276/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/1276",
  "id": 361057681,
  "node_id": "MDU6SXNzdWUzNjEwNTc2ODE=",
  "number": 1276,
  "title": "Improve debugger breaking",
  "user": {
    "login": "gnidan",
    "id": 151065,
    "node_id": "MDQ6VXNlcjE1MTA2NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gnidan",
    "html_url": "https://github.com/gnidan",
    "followers_url": "https://api.github.com/users/gnidan/followers",
    "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
    "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
    "organizations_url": "https://api.github.com/users/gnidan/orgs",
    "repos_url": "https://api.github.com/users/gnidan/repos",
    "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gnidan/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 971535002,
      "node_id": "MDU6TGFiZWw5NzE1MzUwMDI=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/Debugger",
      "name": "Debugger",
      "color": "7911ad",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2018-09-17T21:47:13Z",
  "updated_at": "2018-10-24T18:22:32Z",
  "closed_at": "2018-10-24T18:22:32Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "# Overview\r\n\r\nBreakpoints in Truffle's debugger are kind of useless.\r\n\r\n# Background\r\n\r\nCurrently, breakpoints can be set at a particular location in the code, but not set ahead of time. So a user has to step through the trace to the point of execution where they wish the debugger to `(b)`reak, and then `(c)`ontinue. The debugger then steps until it hits that point in the code on subsequent times.\r\n\r\nInternally, truffle-debugger library permits setting breakpoints at a given AST node or at a given line number. Setting breakpoints at lines is currently a bit wonky because of how EVM operations map to line number in practice. So the workaround is that breakpoints are toggled at the current AST node in the step, since this results in a more intuitive break after continuing.\r\n\r\n# Expected\r\n\r\n1. `truffle-debug` **should** support breakpoints at future code locations. Users should be able to specify a line number in either the current file or in other files used in the transaction.\r\n\r\n    Possible interface:\r\n\r\n    - `debug(...)> b`: Toggle (same as now)\r\n    - `debug(...)> b <line-number>`: Set a breakpoint at a given line in the current source file\r\n    - `debug(...)> b <filename>:<line-number>`: Set a breakpoint in another file. `<filename>` should be easy to type, so maybe it should accept a contract-name? Or at least it should accept the _basename_ for a given file, e.g. `MyContract` for `./contracts/MyContract.sol`.\r\n    - `debug(...)> ?`: Show watch expressions (current) **and** breakpoints (new)\r\n    - (maybe?) `debug(...)> b +<relative-line>`: Set a breakpoint for some number of lines ahead\r\n    - (maybe also?) `debug(...) b -<relative-line>`\r\n\r\n2. The debugger should be smart about translating line numbers to actual AST node breakpoints. Open question: How do we pick which AST node to use as the breakpoint for a given line? Do we want to set the breakpoint to left-most AST node in a line? To the AST node that most completely comprises a given line? This might involve playing with the operation in practice to see where it makes sense to break from a UI standpoint.",
  "closed_by": {
    "login": "haltman-at",
    "id": 35589221,
    "node_id": "MDQ6VXNlcjM1NTg5MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/haltman-at",
    "html_url": "https://github.com/haltman-at",
    "followers_url": "https://api.github.com/users/haltman-at/followers",
    "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
    "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
    "organizations_url": "https://api.github.com/users/haltman-at/orgs",
    "repos_url": "https://api.github.com/users/haltman-at/repos",
    "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
    "received_events_url": "https://api.github.com/users/haltman-at/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/1276/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1276/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/427547348",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1276#issuecomment-427547348",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1276",
    "id": 427547348,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyNzU0NzM0OA==",
    "user": {
      "login": "itstehkman",
      "id": 8936658,
      "node_id": "MDQ6VXNlcjg5MzY2NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8936658?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/itstehkman",
      "html_url": "https://github.com/itstehkman",
      "followers_url": "https://api.github.com/users/itstehkman/followers",
      "following_url": "https://api.github.com/users/itstehkman/following{/other_user}",
      "gists_url": "https://api.github.com/users/itstehkman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/itstehkman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/itstehkman/subscriptions",
      "organizations_url": "https://api.github.com/users/itstehkman/orgs",
      "repos_url": "https://api.github.com/users/itstehkman/repos",
      "events_url": "https://api.github.com/users/itstehkman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/itstehkman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-06T05:17:07Z",
    "updated_at": "2018-10-06T05:17:07Z",
    "author_association": "NONE",
    "body": "@gnidan I think this is a good question to look into. Without looking into it much, my intuition says the breakpoint should match with the left-most AST node, if that corresponds to the left-most part of the line of code. I am probably oversimplifying the problem and am wrong, but would love to hear some more about it.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/427547348/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/432773187",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1276#issuecomment-432773187",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1276",
    "id": 432773187,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMjc3MzE4Nw==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-24T18:22:32Z",
    "updated_at": "2018-10-24T18:22:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "So, the existing fix resolves this problem by interpreting line-based breakpoints not by associating them with a particular AST node, but rather by breaking whenever the trace enters that line from elsewhere (i.e., it associates it with the first AST node *chronologically*, which may be different each time the line is entered).  A major reason we decided to do it this way is that breaking earlier is better than later because you can (at present) go forward but not backward, so we decided to err on the side of safety.  In any case, the original issue has been addressed, so I'm going to go ahead and close this (really, I should've closed it when I merged in my changes, I just forgot); @itstehkman, if you think it makes sense to raise a further issue about this, feel free to do so.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/432773187/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
