{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/3291",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3291/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3291/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3291/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/3291",
  "id": 684077799,
  "node_id": "MDU6SXNzdWU2ODQwNzc3OTk=",
  "number": 3291,
  "title": "\"Migrations\" ran out of gas (using a value you set in your network config or deployment parameters.)",
  "user": {
    "login": "kevholder",
    "id": 60701112,
    "node_id": "MDQ6VXNlcjYwNzAxMTEy",
    "avatar_url": "https://avatars.githubusercontent.com/u/60701112?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kevholder",
    "html_url": "https://github.com/kevholder",
    "followers_url": "https://api.github.com/users/kevholder/followers",
    "following_url": "https://api.github.com/users/kevholder/following{/other_user}",
    "gists_url": "https://api.github.com/users/kevholder/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kevholder/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kevholder/subscriptions",
    "organizations_url": "https://api.github.com/users/kevholder/orgs",
    "repos_url": "https://api.github.com/users/kevholder/repos",
    "events_url": "https://api.github.com/users/kevholder/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kevholder/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2020-08-22T22:27:08Z",
  "updated_at": "2021-05-14T08:14:19Z",
  "closed_at": "2020-09-30T18:06:01Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "- [x ] I've asked for help in the [Truffle Gitter](http://gitter.im/Consensys/truffle) before filing this issue.\r\n\r\n---------------------------\r\n\r\n## Issue\r\n\r\nI'm writing a custom web3 provider for an Ethereum like blockchain. I suspect the error has to do with the way my provider implements an API call but I'm not sure which one. I tried to log the API requests/responses and there didn't seem to be anything related to gas/gas price. I also tried to set multiple different values for gas/gasPrice in my truffle-config.js but always getting that error or similar.\r\n\r\nHere's my truffle-config.js:\r\n\r\n```javascript\r\nconst {\r\n  default: createJavaTronProvider,\r\n} = require(\"@opentron/java-tron-provider\");\r\n\r\n\r\nmodule.exports = {\r\n  networks: {\r\n    shasta: {\r\n      provider: () => {\r\n        if (!process.env.PRIVATE_KEY_SHASTA) {\r\n          throw new Error(\"Missing PRIVATE_KEY_SHASTA environment variable\");\r\n        }\r\n        return createJavaTronProvider({\r\n          network: \"shasta\",\r\n          privateKey: process.env.PRIVATE_KEY_SHASTA,\r\n        });\r\n      },\r\n      network_id: \"*\",\r\n      production: true,\r\n      gas: 1,\r\n      gasPrice: 1,\r\n    },\r\n  },\r\n  mocha: { },\r\n  compilers: {\r\n    solc: { },\r\n  },\r\n};\r\n\r\n```\r\n\r\n## Expected Behavior\r\n\r\nDeploy succeeds.\r\n\r\n## Actual Results\r\n\r\n```\r\n$ DEBUG= truffle deploy --network shasta\r\n\r\nCompiling your contracts...\r\n===========================\r\n> Everything is up to date, there is nothing to compile.\r\n\r\n\r\n\r\nMigrations dry-run (simulation)\r\n===============================\r\n> Network name:    'shasta-fork'\r\n> Network id:      3\r\n> Block gas limit: 1000000000000 (0xe8d4a51000)\r\n\r\n\r\n1_initial_migration.js\r\n======================\r\n\r\n   Deploying 'Migrations'\r\n   ----------------------\r\n\r\nError:  *** Deployment Failed ***\r\n\r\n\"Migrations\" ran out of gas (using a value you set in your network config or deployment parameters.)\r\n   * Block limit:  1000000000000 (0xe8d4a51000)\r\n   * Gas sent:     1 (0x1)\r\n\r\n    at /usr/local/lib/node_modules/truffle/build/webpack:/packages/deployer/src/deployment.js:364:1\r\n    at processTicksAndRejections (internal/process/task_queues.js:97:5)\r\n    at Migration._deploy (/usr/local/lib/node_modules/truffle/build/webpack:/packages/migrate/Migration.js:68:1)\r\n    at Migration._load (/usr/local/lib/node_modules/truffle/build/webpack:/packages/migrate/Migration.js:55:1)\r\n    at Migration.run (/usr/local/lib/node_modules/truffle/build/webpack:/packages/migrate/Migration.js:171:1)\r\n    at Object.runMigrations (/usr/local/lib/node_modules/truffle/build/webpack:/packages/migrate/index.js:150:1)\r\n    at Object.runFrom (/usr/local/lib/node_modules/truffle/build/webpack:/packages/migrate/index.js:110:1)\r\n    at Object.run (/usr/local/lib/node_modules/truffle/build/webpack:/packages/migrate/index.js:87:1)\r\n    at runMigrations (/usr/local/lib/node_modules/truffle/build/webpack:/packages/core/lib/commands/migrate.js:269:1)\r\n    at setupDryRunEnvironmentThenRunMigrations (/usr/local/lib/node_modules/truffle/build/webpack:/packages/core/lib/commands/migrate.js:257:1)\r\n    at /usr/local/lib/node_modules/truffle/build/webpack:/packages/core/lib/commands/migrate.js:220:1\r\nTruffle v5.1.41 (core: 5.1.41)\r\nNode v12.18.3\r\n\r\n```\r\n\r\n## Environment\r\n\r\n* Operating System: macos\r\n* Ethereum client: custom provider\r\n* Truffle version (`truffle version`): Truffle v5.1.41 (core: 5.1.41)\r\n* node version (`node --version`): Node v12.18.3\r\n* npm version (`npm --version`): 6.14.6\r\n",
  "closed_by": {
    "login": "fainashalts",
    "id": 8952139,
    "node_id": "MDQ6VXNlcjg5NTIxMzk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8952139?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fainashalts",
    "html_url": "https://github.com/fainashalts",
    "followers_url": "https://api.github.com/users/fainashalts/followers",
    "following_url": "https://api.github.com/users/fainashalts/following{/other_user}",
    "gists_url": "https://api.github.com/users/fainashalts/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fainashalts/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fainashalts/subscriptions",
    "organizations_url": "https://api.github.com/users/fainashalts/orgs",
    "repos_url": "https://api.github.com/users/fainashalts/repos",
    "events_url": "https://api.github.com/users/fainashalts/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fainashalts/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/3291/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3291/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/681026208",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3291#issuecomment-681026208",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3291",
    "id": 681026208,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4MTAyNjIwOA==",
    "user": {
      "login": "gnidan",
      "id": 151065,
      "node_id": "MDQ6VXNlcjE1MTA2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnidan",
      "html_url": "https://github.com/gnidan",
      "followers_url": "https://api.github.com/users/gnidan/followers",
      "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
      "organizations_url": "https://api.github.com/users/gnidan/orgs",
      "repos_url": "https://api.github.com/users/gnidan/repos",
      "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnidan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-26T17:42:44Z",
    "updated_at": "2020-08-26T17:42:44Z",
    "author_association": "MEMBER",
    "body": "What happens if you omit the `gas` option? That option overrides how much gas is sent for each transaction, so from first glance, I can't imagine _any_ transaction would succeed if you give it only 1 gas.\r\n\r\nAlso, did you try setting `gas` to that value for the block gas limit (`0xe8d4a51000`)? Maybe that'll help.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/681026208/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/701553072",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3291#issuecomment-701553072",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3291",
    "id": 701553072,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMTU1MzA3Mg==",
    "user": {
      "login": "fainashalts",
      "id": 8952139,
      "node_id": "MDQ6VXNlcjg5NTIxMzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8952139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fainashalts",
      "html_url": "https://github.com/fainashalts",
      "followers_url": "https://api.github.com/users/fainashalts/followers",
      "following_url": "https://api.github.com/users/fainashalts/following{/other_user}",
      "gists_url": "https://api.github.com/users/fainashalts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fainashalts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fainashalts/subscriptions",
      "organizations_url": "https://api.github.com/users/fainashalts/orgs",
      "repos_url": "https://api.github.com/users/fainashalts/repos",
      "events_url": "https://api.github.com/users/fainashalts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fainashalts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-30T18:06:01Z",
    "updated_at": "2020-09-30T18:06:17Z",
    "author_association": "MEMBER",
    "body": "Hi @kevholder, thanks for opening this issue. I hope the comment above was helpful. We're closing this for issue maintenance, but if you still need help feel free to comment here or open a new issue. ",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/701553072/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/717467007",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3291#issuecomment-717467007",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3291",
    "id": 717467007,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNzQ2NzAwNw==",
    "user": {
      "login": "a20143071",
      "id": 49008442,
      "node_id": "MDQ6VXNlcjQ5MDA4NDQy",
      "avatar_url": "https://avatars.githubusercontent.com/u/49008442?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/a20143071",
      "html_url": "https://github.com/a20143071",
      "followers_url": "https://api.github.com/users/a20143071/followers",
      "following_url": "https://api.github.com/users/a20143071/following{/other_user}",
      "gists_url": "https://api.github.com/users/a20143071/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/a20143071/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/a20143071/subscriptions",
      "organizations_url": "https://api.github.com/users/a20143071/orgs",
      "repos_url": "https://api.github.com/users/a20143071/repos",
      "events_url": "https://api.github.com/users/a20143071/events{/privacy}",
      "received_events_url": "https://api.github.com/users/a20143071/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-27T18:57:39Z",
    "updated_at": "2020-10-27T18:57:39Z",
    "author_association": "NONE",
    "body": "Hi, I have the same problem. I think it happens because my contract is really big, but I dont know how to solve it.\r\n\r\n![asd](https://user-images.githubusercontent.com/49008442/97348592-5b22d780-185c-11eb-87a5-1a6afd84b4b0.PNG)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/717467007/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/734353847",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3291#issuecomment-734353847",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3291",
    "id": 734353847,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDM1Mzg0Nw==",
    "user": {
      "login": "ZentaChainAdmin",
      "id": 40530024,
      "node_id": "MDQ6VXNlcjQwNTMwMDI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/40530024?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ZentaChainAdmin",
      "html_url": "https://github.com/ZentaChainAdmin",
      "followers_url": "https://api.github.com/users/ZentaChainAdmin/followers",
      "following_url": "https://api.github.com/users/ZentaChainAdmin/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZentaChainAdmin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ZentaChainAdmin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZentaChainAdmin/subscriptions",
      "organizations_url": "https://api.github.com/users/ZentaChainAdmin/orgs",
      "repos_url": "https://api.github.com/users/ZentaChainAdmin/repos",
      "events_url": "https://api.github.com/users/ZentaChainAdmin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ZentaChainAdmin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-26T15:16:07Z",
    "updated_at": "2020-11-26T15:16:07Z",
    "author_association": "NONE",
    "body": "     gas: 0xfffffffffff,\t// <-- Use this high gas value\r\n     gasPrice: 0x01,\t// <-- Use this low gas price",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/734353847/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/841090877",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3291#issuecomment-841090877",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3291",
    "id": 841090877,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTA5MDg3Nw==",
    "user": {
      "login": "nishant8509",
      "id": 51108158,
      "node_id": "MDQ6VXNlcjUxMTA4MTU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/51108158?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nishant8509",
      "html_url": "https://github.com/nishant8509",
      "followers_url": "https://api.github.com/users/nishant8509/followers",
      "following_url": "https://api.github.com/users/nishant8509/following{/other_user}",
      "gists_url": "https://api.github.com/users/nishant8509/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nishant8509/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nishant8509/subscriptions",
      "organizations_url": "https://api.github.com/users/nishant8509/orgs",
      "repos_url": "https://api.github.com/users/nishant8509/repos",
      "events_url": "https://api.github.com/users/nishant8509/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nishant8509/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-14T08:14:19Z",
    "updated_at": "2021-05-14T08:14:19Z",
    "author_association": "NONE",
    "body": "I was having the same issue .... what I did was \r\n**step 1.** use this \r\nsolc: {\r\n      version: \"0.5.16\",\r\n\t  settings: {\r\n      optimizer: {\r\n        enabled: true, // Default: false\r\n        runs: 1000     // Default: 200\r\n      },\r\n      evmVersion: \"homestead\"  // Default: \"byzantium\"\r\n    }\r\n**Step 2** : install ganache cli then run \r\n_ganache-cli_\r\n**Step 3** : you get some output like this \r\n![image](https://user-images.githubusercontent.com/51108158/118241733-1c800200-b4ba-11eb-8e58-4c6704047715.png)\r\n**Step 4** :  paste Gas limit value and Gas Price\r\nrinkeby: {\r\n      provider: () => new HDWalletProvider(mnemonic, infura),\r\n        network_id: 4,\r\n        gas: 6721975, //from ganache-cli output\r\n        gasPrice: 20000000000, //From ganache-cli output\r\n    }\r\nI hope this will help, as it worked for me",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/841090877/reactions",
      "total_count": 5,
      "+1": 5,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
