{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/713",
  "id": 281553901,
  "node_id": "MDU6SXNzdWUyODE1NTM5MDE=",
  "number": 713,
  "title": "Deployed Contracts have no Network when using async/await",
  "user": {
    "login": "jleeh",
    "id": 10528926,
    "node_id": "MDQ6VXNlcjEwNTI4OTI2",
    "avatar_url": "https://avatars.githubusercontent.com/u/10528926?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jleeh",
    "html_url": "https://github.com/jleeh",
    "followers_url": "https://api.github.com/users/jleeh/followers",
    "following_url": "https://api.github.com/users/jleeh/following{/other_user}",
    "gists_url": "https://api.github.com/users/jleeh/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jleeh/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jleeh/subscriptions",
    "organizations_url": "https://api.github.com/users/jleeh/orgs",
    "repos_url": "https://api.github.com/users/jleeh/repos",
    "events_url": "https://api.github.com/users/jleeh/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jleeh/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 971534911,
      "node_id": "MDU6TGFiZWw5NzE1MzQ5MTE=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/Next",
      "name": "Next",
      "color": "5319e7",
      "default": false,
      "description": ""
    },
    {
      "id": 971535345,
      "node_id": "MDU6TGFiZWw5NzE1MzUzNDU=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/Fixed",
      "name": "Fixed",
      "color": "40c989",
      "default": false,
      "description": ""
    },
    {
      "id": 971536096,
      "node_id": "MDU6TGFiZWw5NzE1MzYwOTY=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/Migrations",
      "name": "Migrations",
      "color": "b887db",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 29,
  "created_at": "2017-12-12T22:05:32Z",
  "updated_at": "2019-01-16T18:41:45Z",
  "closed_at": "2019-01-16T18:41:45Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "- [x] I've asked for help in the [Truffle Gitter](http://gitter.im/Consensys/truffle) before filing this issue.\r\n\r\n---------------------------\r\n\r\n## Issue\r\n\r\nWhen my contracts are deployed using the `truffle migrate --reset` command, none of them have a network in the contract JSON even though the contracts are deployed. This causes the unit tests to fail saying the contract hasn't been deployed to the network.\r\n\r\nThis only happens with the contracts I'm working on as it works fine with different solidity projects.\r\n\r\nI've tested the contracts in question on Remix and they deploy fine.\r\n\r\n## Steps to Reproduce\r\n\r\n- `truffle migrate --reset`\r\n- `truffle test`\r\n\r\n## Expected Behavior\r\n\r\n- Contract has network assigned in JSON\r\n- Can test against the contract\r\n\r\n## Actual Results\r\n\r\n- Contract is deployed after a successful migration:\r\n```\r\nRunning migration: 1_initial_migration.js\r\n  Replacing Migrations...\r\n  ... 0xf893631620cee218dfdac5a5b118e950b39c411add85ccf5ce0891abc594b451\r\n  Migrations: 0x01afadc80ac64129f3100633b556f1a40a15a9c0\r\nSaving successful migration to network...\r\n  ... 0x0af95e5b3d45c4b37b56287395f0815b4e315d5b3a5bdc0bdcdc5134e444aeb4\r\nSaving artifacts...\r\nRunning migration: 2_deploy_linkpool.js\r\n  Replacing Arithmetic...\r\n  ... 0x5667313901deae25a423b2f5c9bc5554ef691491bf1d8d7cd8e71d40948f416d\r\n  Arithmetic: 0x9a3be86baaf7b84f60860b7be146963f5bc8a21b\r\nSaving successful migration to network...\r\n  Deploying PoolStorageLocator...\r\n  ... 0x6ed6122d0851c169df7d156341845ca884e232d455b91825a7e495196d54d6ae\r\nSaving artifacts...\r\n  ... 0x19ca0c89a2c079c8f7dd1c44db88e3520c4ac3781f907db58480e364a31d812f\r\n  PoolStorageLocator: 0xaed391873b70b273393ffc8cce46cfa34aeedc03\r\n  Deploying Node...\r\n  ... 0xbc09e15f761c95071533db92a3900bcdfdac68762bfde30abfa23e89a6434748\r\n  Node: 0xd17e00d08da375b61a10d36a25fb20fde1c8bc29\r\n  Deploying LinkPool...\r\n  ... 0xb6f889a1d8a8b9bd04fc8ecbdf58e58dac33dc014e940c266e15d6e2b181d050\r\n  LinkPool: 0x02961e046dfa5ed124013dac3893cc88af45d371\r\n  Deploying PoolStorage...\r\n  ... 0x2906e140275cab2ffb22d3198070ab325b1796daef5a18e935719d7d8fb3fb95\r\n  PoolStorage: 0xd8962788087a931eee12512267a5263ece988091\r\n  ... 0xe302b366dae309610d063a7bb3748e951fb1d7159ca496b82a29e6d27f26ed4c\r\n  Running step...\r\n```\r\n\r\n- JSON of contract (Bulk of contract redacted):\r\n```json\r\n  \"compiler\": {\r\n    \"name\": \"solc\",\r\n    \"version\": \"0.4.18+commit.9cf6e910.Emscripten.clang\"\r\n  },\r\n  \"networks\": {},\r\n  \"schemaVersion\": \"1.0.1\",\r\n  \"updatedAt\": \"2017-12-12T21:49:28.535Z\"\r\n```\r\n\r\n- Result of unit test:\r\n```\r\n  1) Contract: LinkPool \"before each\" hook for \"should add a node\":\r\n     Error: LinkPool has not been deployed to detected network (network/artifact mismatch)\r\n      at /usr/lib/node_modules/truffle/build/cli.bundled.js:318327:17\r\n      at <anonymous>\r\n      at process._tickCallback (internal/process/next_tick.js:188:7)\r\n```\r\n\r\n## Environment\r\n\r\n* Operating System: Windows 10 Pro Insider Preview 1709\r\n* Truffle version: Truffle v4.0.1 (core: 4.0.1), Solidity v0.4.18 (solc-js)\r\n* Ethereum client: Ganache CLI v6.0.3 (ganache-core: 2.0.2) (Same happens with testrpc, geth)\r\n* node version: 8.9.3\r\n* npm version: 5.6.0\r\n\r\nℹ️ I can provide access to the repo where the contracts are stored. I'm reluctant to publicly post the source of them until they're ready.\r\n",
  "closed_by": {
    "login": "gnidan",
    "id": 151065,
    "node_id": "MDQ6VXNlcjE1MTA2NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gnidan",
    "html_url": "https://github.com/gnidan",
    "followers_url": "https://api.github.com/users/gnidan/followers",
    "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
    "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
    "organizations_url": "https://api.github.com/users/gnidan/orgs",
    "repos_url": "https://api.github.com/users/gnidan/repos",
    "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gnidan/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/713/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/353575248",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-353575248",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 353575248,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MzU3NTI0OA==",
    "user": {
      "login": "olekon",
      "id": 29893822,
      "node_id": "MDQ6VXNlcjI5ODkzODIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/29893822?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/olekon",
      "html_url": "https://github.com/olekon",
      "followers_url": "https://api.github.com/users/olekon/followers",
      "following_url": "https://api.github.com/users/olekon/following{/other_user}",
      "gists_url": "https://api.github.com/users/olekon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/olekon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/olekon/subscriptions",
      "organizations_url": "https://api.github.com/users/olekon/orgs",
      "repos_url": "https://api.github.com/users/olekon/repos",
      "events_url": "https://api.github.com/users/olekon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/olekon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-22T11:00:15Z",
    "updated_at": "2017-12-22T11:00:15Z",
    "author_association": "NONE",
    "body": "I have the same issue.\r\nI also noticed one interesting thing. If you deploy several contracts in one migration file synchronously, i.e\r\n\r\n```\r\nawait deployer.deploy(contract1)\r\nawait deployer.deploy(contract2)\r\nawait deployer.deploy(contract3)\r\n```\r\nthen it updates only contract1 json file.\r\n\r\nHowever, if you rewrite it with Promise chain\r\n\r\n```\r\ndeployer.deploy(contract1).then(function() {\r\n  return deployer.deploy(contract2).then(function() {\r\n    return deployer.deploy(contract3).then(function() {\r\n        //do something else\r\n      })\r\n  })\r\n})\r\n```\r\nthen all 3 JSON files are updated with valid addresses\r\n\r\nI am using \r\nTruffle v4.0.4 (core: 4.0.4)\r\nSolidity v0.4.18 (solc-js)\r\nEthereumJS TestRPC v4.1.3 (ganache-core: 1.1.3)",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/353575248/reactions",
      "total_count": 7,
      "+1": 7,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/353576540",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-353576540",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 353576540,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MzU3NjU0MA==",
    "user": {
      "login": "jleeh",
      "id": 10528926,
      "node_id": "MDQ6VXNlcjEwNTI4OTI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/10528926?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jleeh",
      "html_url": "https://github.com/jleeh",
      "followers_url": "https://api.github.com/users/jleeh/followers",
      "following_url": "https://api.github.com/users/jleeh/following{/other_user}",
      "gists_url": "https://api.github.com/users/jleeh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jleeh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jleeh/subscriptions",
      "organizations_url": "https://api.github.com/users/jleeh/orgs",
      "repos_url": "https://api.github.com/users/jleeh/repos",
      "events_url": "https://api.github.com/users/jleeh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jleeh/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-22T11:07:41Z",
    "updated_at": "2017-12-22T20:16:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "Ahh, I recently migrated to use ES7 in my truffle scripts, so it sounds like that's the root cause? \r\n\r\nEDIT: Thanks @olekon, that fixed it. Closing.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/353576540/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/358507261",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-358507261",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 358507261,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1ODUwNzI2MQ==",
    "user": {
      "login": "Oxyaction",
      "id": 1942242,
      "node_id": "MDQ6VXNlcjE5NDIyNDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1942242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Oxyaction",
      "html_url": "https://github.com/Oxyaction",
      "followers_url": "https://api.github.com/users/Oxyaction/followers",
      "following_url": "https://api.github.com/users/Oxyaction/following{/other_user}",
      "gists_url": "https://api.github.com/users/Oxyaction/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Oxyaction/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Oxyaction/subscriptions",
      "organizations_url": "https://api.github.com/users/Oxyaction/orgs",
      "repos_url": "https://api.github.com/users/Oxyaction/repos",
      "events_url": "https://api.github.com/users/Oxyaction/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Oxyaction/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-18T01:28:36Z",
    "updated_at": "2018-01-18T01:28:36Z",
    "author_association": "NONE",
    "body": "Had the same issue with code \r\n```\r\nawait deployer.deploy(Registry);\r\nconst registry = await Registry.deployed()\r\nawait deployer.deploy(Store, registry.address);\r\n```\r\nwhen refactored to \r\n```\r\ndeployer.deploy(Registry)\r\n  .then(() => Registry.deployed())\r\n  .then(registry => deployer.deploy(Store, registry.address))\r\n```\r\nworks fine, thanks a lot @olekon ",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/358507261/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/359230049",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-359230049",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 359230049,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1OTIzMDA0OQ==",
    "user": {
      "login": "terraflops1048576",
      "id": 3110527,
      "node_id": "MDQ6VXNlcjMxMTA1Mjc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3110527?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/terraflops1048576",
      "html_url": "https://github.com/terraflops1048576",
      "followers_url": "https://api.github.com/users/terraflops1048576/followers",
      "following_url": "https://api.github.com/users/terraflops1048576/following{/other_user}",
      "gists_url": "https://api.github.com/users/terraflops1048576/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/terraflops1048576/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/terraflops1048576/subscriptions",
      "organizations_url": "https://api.github.com/users/terraflops1048576/orgs",
      "repos_url": "https://api.github.com/users/terraflops1048576/repos",
      "events_url": "https://api.github.com/users/terraflops1048576/events{/privacy}",
      "received_events_url": "https://api.github.com/users/terraflops1048576/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-21T07:42:40Z",
    "updated_at": "2018-01-21T08:09:26Z",
    "author_association": "NONE",
    "body": "Is there a reason for this? Is it a bug or intended behavior? I'm experiencing this issue, except that I deploy my contracts across multiple migration scripts; the workaround effectively makes me put everything in one migration script. I'm running Truffle v4.0.5.\r\n\r\nEDIT:\r\nEven that doesn't work. I get the same issue; Truffle prints out the addresses of the relevant contracts, but still doesn't store them in the JSON. Running ContractName.deployed() from the console gives the network/artifact mismatch stuff.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/359230049/reactions",
      "total_count": 7,
      "+1": 7,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/359983417",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-359983417",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 359983417,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1OTk4MzQxNw==",
    "user": {
      "login": "mjhm",
      "id": 431925,
      "node_id": "MDQ6VXNlcjQzMTkyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/431925?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mjhm",
      "html_url": "https://github.com/mjhm",
      "followers_url": "https://api.github.com/users/mjhm/followers",
      "following_url": "https://api.github.com/users/mjhm/following{/other_user}",
      "gists_url": "https://api.github.com/users/mjhm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mjhm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mjhm/subscriptions",
      "organizations_url": "https://api.github.com/users/mjhm/orgs",
      "repos_url": "https://api.github.com/users/mjhm/repos",
      "events_url": "https://api.github.com/users/mjhm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mjhm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-24T00:52:00Z",
    "updated_at": "2018-01-24T00:52:00Z",
    "author_association": "NONE",
    "body": "Me too. I would swear that this was working in Truffle v4.0.4.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/359983417/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/360141708",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-360141708",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 360141708,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM2MDE0MTcwOA==",
    "user": {
      "login": "bulgakovk",
      "id": 8983736,
      "node_id": "MDQ6VXNlcjg5ODM3MzY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8983736?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bulgakovk",
      "html_url": "https://github.com/bulgakovk",
      "followers_url": "https://api.github.com/users/bulgakovk/followers",
      "following_url": "https://api.github.com/users/bulgakovk/following{/other_user}",
      "gists_url": "https://api.github.com/users/bulgakovk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bulgakovk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bulgakovk/subscriptions",
      "organizations_url": "https://api.github.com/users/bulgakovk/orgs",
      "repos_url": "https://api.github.com/users/bulgakovk/repos",
      "events_url": "https://api.github.com/users/bulgakovk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bulgakovk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-24T13:53:48Z",
    "updated_at": "2018-01-24T13:53:48Z",
    "author_association": "NONE",
    "body": "Had the same issue. Rewriting **migrations** with Promises fixed my problem.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/360141708/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/372628825",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-372628825",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 372628825,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MjYyODgyNQ==",
    "user": {
      "login": "ZitRos",
      "id": 4989256,
      "node_id": "MDQ6VXNlcjQ5ODkyNTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4989256?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ZitRos",
      "html_url": "https://github.com/ZitRos",
      "followers_url": "https://api.github.com/users/ZitRos/followers",
      "following_url": "https://api.github.com/users/ZitRos/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZitRos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ZitRos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZitRos/subscriptions",
      "organizations_url": "https://api.github.com/users/ZitRos/orgs",
      "repos_url": "https://api.github.com/users/ZitRos/repos",
      "events_url": "https://api.github.com/users/ZitRos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ZitRos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-13T11:07:37Z",
    "updated_at": "2018-04-04T10:34:26Z",
    "author_association": "NONE",
    "body": "This issue needs to be reopened, as the behavior of smart contracts deployment is different when using ES7 async/await syntax, which is totally unexpected. The latest version of Truffle still has this issue.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/372628825/reactions",
      "total_count": 13,
      "+1": 13,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378452749",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-378452749",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 378452749,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3ODQ1Mjc0OQ==",
    "user": {
      "login": "macalinao",
      "id": 401263,
      "node_id": "MDQ6VXNlcjQwMTI2Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/401263?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macalinao",
      "html_url": "https://github.com/macalinao",
      "followers_url": "https://api.github.com/users/macalinao/followers",
      "following_url": "https://api.github.com/users/macalinao/following{/other_user}",
      "gists_url": "https://api.github.com/users/macalinao/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macalinao/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macalinao/subscriptions",
      "organizations_url": "https://api.github.com/users/macalinao/orgs",
      "repos_url": "https://api.github.com/users/macalinao/repos",
      "events_url": "https://api.github.com/users/macalinao/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macalinao/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-04T01:42:17Z",
    "updated_at": "2018-04-04T01:42:17Z",
    "author_association": "NONE",
    "body": "Still an issue!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378452749/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378556276",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-378556276",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 378556276,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3ODU1NjI3Ng==",
    "user": {
      "login": "ZitRos",
      "id": 4989256,
      "node_id": "MDQ6VXNlcjQ5ODkyNTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4989256?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ZitRos",
      "html_url": "https://github.com/ZitRos",
      "followers_url": "https://api.github.com/users/ZitRos/followers",
      "following_url": "https://api.github.com/users/ZitRos/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZitRos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ZitRos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZitRos/subscriptions",
      "organizations_url": "https://api.github.com/users/ZitRos/orgs",
      "repos_url": "https://api.github.com/users/ZitRos/repos",
      "events_url": "https://api.github.com/users/ZitRos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ZitRos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-04T10:36:44Z",
    "updated_at": "2018-04-04T10:37:43Z",
    "author_association": "NONE",
    "body": "@cgewecke should we open a new issue for this case? I will consider it pretty critical but possibly not as simple to fix. Thank you!\r\n\r\n> the behavior of smart contracts deployment is different when using ES7 async/await syntax, which is totally unexpected. The latest version of Truffle still has this issue.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378556276/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378691820",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-378691820",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 378691820,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3ODY5MTgyMA==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-04T18:03:45Z",
    "updated_at": "2018-04-04T18:03:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ZitRos Agree - we're actively working on this for the next release. In my view the issue here is semantic confusion caused by changes in JS norms around async. (Migrations was written before `await` became standard). \r\n\r\nI'd rather not re-open just because it's not a 'bug' per se - it's super counter-intuitive behavior relative to `await` and an interface design problem we'll need to address in the next iteration of the tool.   ",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378691820/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378743892",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-378743892",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 378743892,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3ODc0Mzg5Mg==",
    "user": {
      "login": "ZitRos",
      "id": 4989256,
      "node_id": "MDQ6VXNlcjQ5ODkyNTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4989256?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ZitRos",
      "html_url": "https://github.com/ZitRos",
      "followers_url": "https://api.github.com/users/ZitRos/followers",
      "following_url": "https://api.github.com/users/ZitRos/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZitRos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ZitRos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZitRos/subscriptions",
      "organizations_url": "https://api.github.com/users/ZitRos/orgs",
      "repos_url": "https://api.github.com/users/ZitRos/repos",
      "events_url": "https://api.github.com/users/ZitRos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ZitRos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-04T21:01:42Z",
    "updated_at": "2018-04-04T21:02:20Z",
    "author_association": "NONE",
    "body": "@cgewecke, I appreciate your work, thank you for sharing notes on this.\r\n\r\nI've checked the truffle code, the issue seems to be very trivial. Looks like we just need to await on the [possible] promise returned from [fn](https://github.com/trufflesuite/truffle-migrate/blob/cd1c1ca6b48d0fd80d9d0efcc1b5861a2af19760/index.js#L82), because finish() runs synchronously afterwards.\r\n\r\nIf you would like I can make a PR fixing this.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378743892/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378751412",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-378751412",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 378751412,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3ODc1MTQxMg==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-04T21:29:33Z",
    "updated_at": "2018-04-04T21:34:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ZitRos `truffle` is on Node 6.9.1 which doesn't support `await`. There may be a simple fix with conventional promises as well but unfortunately to address this in the current release we need to do it in a way that is backward compatible and doesn't assume people are on latest Node. The solution will need tests for the new behavior and will need to accommodate the existing use pattern. \r\n\r\n[EDIT - I just realized - even testing this is going to be an issue because of 6.9.1. I think we'd have to target a higher node version in CI or start using babel - that's something that we've been discussing for the next release.]\r\n\r\nYou're more than welcome to work on a PR - thank you! There's a guide to setting up truffle for development [here](https://github.com/trufflesuite/truffle/blob/develop/CONTRIBUTING.md) you might find useful. ",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378751412/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378754610",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-378754610",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 378754610,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3ODc1NDYxMA==",
    "user": {
      "login": "ZitRos",
      "id": 4989256,
      "node_id": "MDQ6VXNlcjQ5ODkyNTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4989256?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ZitRos",
      "html_url": "https://github.com/ZitRos",
      "followers_url": "https://api.github.com/users/ZitRos/followers",
      "following_url": "https://api.github.com/users/ZitRos/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZitRos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ZitRos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZitRos/subscriptions",
      "organizations_url": "https://api.github.com/users/ZitRos/orgs",
      "repos_url": "https://api.github.com/users/ZitRos/repos",
      "events_url": "https://api.github.com/users/ZitRos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ZitRos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-04T21:42:12Z",
    "updated_at": "2018-04-04T21:45:37Z",
    "author_association": "NONE",
    "body": "@cgewecke, of course NodeJS 6.9.1 doesn't supports `await` but promises. `await` is nothing more than `promise.then(...)` baked in a prettier way. So I mean [here](https://github.com/trufflesuite/truffle-migrate/blob/cd1c1ca6b48d0fd80d9d0efcc1b5861a2af19760/index.js#L82) you can put something like:\r\n\r\n```javascript\r\nlet result = fn(deployer, options.network, accounts);\r\nif (result && typeof result.then === \"function\") {\r\n  result.then(() => finish()).catch(() => \"...\");\r\n} else {\r\n  finish();\r\n}\r\n```\r\n\r\n...instead of calling `finish()` synchronously after the exported `fn` finishes. And this will eventually wait until the returned promise (async function) resolves. I'll take a look",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378754610/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378755402",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-378755402",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 378755402,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3ODc1NTQwMg==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-04T21:45:19Z",
    "updated_at": "2018-04-04T21:45:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ZitRos Right, ok excellent.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378755402/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378755867",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-378755867",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 378755867,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3ODc1NTg2Nw==",
    "user": {
      "login": "ZitRos",
      "id": 4989256,
      "node_id": "MDQ6VXNlcjQ5ODkyNTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4989256?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ZitRos",
      "html_url": "https://github.com/ZitRos",
      "followers_url": "https://api.github.com/users/ZitRos/followers",
      "following_url": "https://api.github.com/users/ZitRos/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZitRos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ZitRos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZitRos/subscriptions",
      "organizations_url": "https://api.github.com/users/ZitRos/orgs",
      "repos_url": "https://api.github.com/users/ZitRos/repos",
      "events_url": "https://api.github.com/users/ZitRos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ZitRos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-04T21:47:15Z",
    "updated_at": "2018-04-04T21:48:40Z",
    "author_association": "NONE",
    "body": "@cgewecke, another thing I wanted to catch here right away is that any exceptions thrown in `fn` doesn't prevent migration from its successful completion, which is also a strange behavior. Do you agree we need to fix this as well? (make the whole migration fail if any exceptions are thrown)",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378755867/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378760668",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-378760668",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 378760668,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3ODc2MDY2OA==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-04T22:07:47Z",
    "updated_at": "2018-04-04T22:07:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ZitRos I'm not certain about this, apologies. I need to look at the code a bit. . . .",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/378760668/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/384478076",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-384478076",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 384478076,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDQ3ODA3Ng==",
    "user": {
      "login": "klivin",
      "id": 200045,
      "node_id": "MDQ6VXNlcjIwMDA0NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/200045?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/klivin",
      "html_url": "https://github.com/klivin",
      "followers_url": "https://api.github.com/users/klivin/followers",
      "following_url": "https://api.github.com/users/klivin/following{/other_user}",
      "gists_url": "https://api.github.com/users/klivin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/klivin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/klivin/subscriptions",
      "organizations_url": "https://api.github.com/users/klivin/orgs",
      "repos_url": "https://api.github.com/users/klivin/repos",
      "events_url": "https://api.github.com/users/klivin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/klivin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-26T00:50:51Z",
    "updated_at": "2018-04-26T00:50:51Z",
    "author_association": "NONE",
    "body": "I had removed all references to `await` in my migration file, converted to promises, but I was still getting the issue where only libraries were getting an address field in their networks...\r\n\r\nWhat fixed it for me was removing all references to `async` in the file!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/384478076/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/384750032",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-384750032",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 384750032,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDc1MDAzMg==",
    "user": {
      "login": "emkman",
      "id": 275773,
      "node_id": "MDQ6VXNlcjI3NTc3Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/275773?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emkman",
      "html_url": "https://github.com/emkman",
      "followers_url": "https://api.github.com/users/emkman/followers",
      "following_url": "https://api.github.com/users/emkman/following{/other_user}",
      "gists_url": "https://api.github.com/users/emkman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emkman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emkman/subscriptions",
      "organizations_url": "https://api.github.com/users/emkman/orgs",
      "repos_url": "https://api.github.com/users/emkman/repos",
      "events_url": "https://api.github.com/users/emkman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emkman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-26T18:45:25Z",
    "updated_at": "2018-04-26T23:59:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "Just ran into this same issue, and agree this should be reopened until proper `async` support is provided either through @ZitRos suggestion or through integration of babel (though I much prefer native node 8 support to babel)",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/384750032/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/384750900",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-384750900",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 384750900,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDc1MDkwMA==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-26T18:48:15Z",
    "updated_at": "2018-04-26T18:48:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "Re-opening.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/384750900/reactions",
      "total_count": 4,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/386513076",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-386513076",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 386513076,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NjUxMzA3Ng==",
    "user": {
      "login": "ahester57",
      "id": 18651861,
      "node_id": "MDQ6VXNlcjE4NjUxODYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/18651861?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ahester57",
      "html_url": "https://github.com/ahester57",
      "followers_url": "https://api.github.com/users/ahester57/followers",
      "following_url": "https://api.github.com/users/ahester57/following{/other_user}",
      "gists_url": "https://api.github.com/users/ahester57/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ahester57/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ahester57/subscriptions",
      "organizations_url": "https://api.github.com/users/ahester57/orgs",
      "repos_url": "https://api.github.com/users/ahester57/repos",
      "events_url": "https://api.github.com/users/ahester57/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ahester57/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-04T06:10:07Z",
    "updated_at": "2018-05-04T08:17:10Z",
    "author_association": "NONE",
    "body": "This is occurring when running truffle test. I believe it is because of the testing \"clean-room\" environment.\r\n\r\n```solidity\r\nconst Contract1 = artifacts.require(\"./Contract1.sol\");\r\nconst Token = artifacts.require('./Token.sol');\r\n\r\nmodule.exports = function(deployer) {\r\n    deployer.deploy(Token).then(() => {\r\n        Token.deployed().then((instance) => {\r\n           return instance;\r\n        }).then((token) => {\r\n\t  deployer.deploy(Contract1, token.address);\r\n\t});\r\n    })\r\n};\r\n```\r\nThe above works fine when deploying to a chain, but ```truffle test``` does not seem to want to wait\r\nfor the promises to be resolved.  \r\n\r\nI can run tests successfully by giving the test the deployed address.\r\n```solidity\r\n  // Instead of \r\n  Contract1.deployed()\r\n  // say\r\n  Contract1.at(\"0x36a8054476cef7d35251fae816f87e09a49e7e43\")\r\n  .then((instance) => console.log);\r\n```\r\nThe above will display the contract and tests will pass, but the clean-room environment is thus rendered unused.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/386513076/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/386584484",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-386584484",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 386584484,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NjU4NDQ4NA==",
    "user": {
      "login": "ZitRos",
      "id": 4989256,
      "node_id": "MDQ6VXNlcjQ5ODkyNTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4989256?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ZitRos",
      "html_url": "https://github.com/ZitRos",
      "followers_url": "https://api.github.com/users/ZitRos/followers",
      "following_url": "https://api.github.com/users/ZitRos/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZitRos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ZitRos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZitRos/subscriptions",
      "organizations_url": "https://api.github.com/users/ZitRos/orgs",
      "repos_url": "https://api.github.com/users/ZitRos/repos",
      "events_url": "https://api.github.com/users/ZitRos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ZitRos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-04T12:21:19Z",
    "updated_at": "2018-05-04T12:21:45Z",
    "author_association": "NONE",
    "body": "@ahester57, I guess it may happen because you missed `return` statement on line 6 of your example code. Does it? (`return Token.deployed()....`)",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/386584484/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/386629104",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-386629104",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 386629104,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NjYyOTEwNA==",
    "user": {
      "login": "ahester57",
      "id": 18651861,
      "node_id": "MDQ6VXNlcjE4NjUxODYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/18651861?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ahester57",
      "html_url": "https://github.com/ahester57",
      "followers_url": "https://api.github.com/users/ahester57/followers",
      "following_url": "https://api.github.com/users/ahester57/following{/other_user}",
      "gists_url": "https://api.github.com/users/ahester57/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ahester57/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ahester57/subscriptions",
      "organizations_url": "https://api.github.com/users/ahester57/orgs",
      "repos_url": "https://api.github.com/users/ahester57/repos",
      "events_url": "https://api.github.com/users/ahester57/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ahester57/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-04T15:01:22Z",
    "updated_at": "2018-05-04T15:01:22Z",
    "author_association": "NONE",
    "body": "@ZitRos, Now that is something which simply ruins a night. I had to add returns before Token.deployed() and the second deployer.deploy() for tests to work.\r\n\r\nMy question: Why? Why does the migration work fine but the test suite not pick these up?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/386629104/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/386644492",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-386644492",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 386644492,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NjY0NDQ5Mg==",
    "user": {
      "login": "ZitRos",
      "id": 4989256,
      "node_id": "MDQ6VXNlcjQ5ODkyNTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4989256?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ZitRos",
      "html_url": "https://github.com/ZitRos",
      "followers_url": "https://api.github.com/users/ZitRos/followers",
      "following_url": "https://api.github.com/users/ZitRos/following{/other_user}",
      "gists_url": "https://api.github.com/users/ZitRos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ZitRos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ZitRos/subscriptions",
      "organizations_url": "https://api.github.com/users/ZitRos/orgs",
      "repos_url": "https://api.github.com/users/ZitRos/repos",
      "events_url": "https://api.github.com/users/ZitRos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ZitRos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-04T15:52:31Z",
    "updated_at": "2018-05-04T15:52:31Z",
    "author_association": "NONE",
    "body": "@ahester57, I guess that internally, in Truffle, `deployer.deploy(Token)` returns the promise, and Truffle waits until this promise resolves. Once it resolves, Truffle continues its pipeline.\r\n\r\nThus, by returning `undefined` from `then` callback the promise resolves almost immediately and doesn't wait until the nested promise resolves.\r\n\r\nI guess that the reason of why your code may work during the deployment to the real network is simply because of the delays during deployment (like saving successful migration to the network). Before terminating the process (which in tests happens immediately after promise resolves) transaction gets successfully published to the network.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/386644492/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/403031560",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-403031560",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 403031560,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMzAzMTU2MA==",
    "user": {
      "login": "roderik",
      "id": 16780,
      "node_id": "MDQ6VXNlcjE2Nzgw",
      "avatar_url": "https://avatars.githubusercontent.com/u/16780?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/roderik",
      "html_url": "https://github.com/roderik",
      "followers_url": "https://api.github.com/users/roderik/followers",
      "following_url": "https://api.github.com/users/roderik/following{/other_user}",
      "gists_url": "https://api.github.com/users/roderik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/roderik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/roderik/subscriptions",
      "organizations_url": "https://api.github.com/users/roderik/orgs",
      "repos_url": "https://api.github.com/users/roderik/repos",
      "events_url": "https://api.github.com/users/roderik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/roderik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-06T13:18:15Z",
    "updated_at": "2018-07-06T13:18:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "We were hit by some the same issue, where strangely enough all our contracts deploy correctly, all of them have a completed network section in the json file, **except** the Migrations.json. We make heavy use of async/await so I happened on this issue and tried to figure out what was wrong. \r\n\r\nI started with a clean `truffle init` and running migrate worked like expected. \r\n\r\n```js\r\nvar Migrations = artifacts.require('./Migrations.sol');\r\n\r\nmodule.exports = function(deployer) {\r\n  deployer.deploy(Migrations);\r\n};\r\n```\r\n\r\nNow for the async version, we like to use:\r\n\r\n```js\r\nvar Migrations = artifacts.require('Migrations');\r\n\r\nasync function performMigration(deployer, network, accounts) {\r\n  await deployer.deploy(Migrations);\r\n}\r\n\r\nmodule.exports = function(deployer, network, accounts) {\r\n  deployer\r\n    .then(() => performMigration(deployer, network, accounts))\r\n    .catch(error => {\r\n      console.log(error);\r\n      process.exit(1);\r\n    });\r\n};\r\n```\r\n\r\nThis one does not work, nothing in the networks section.\r\n\r\n... 🤦‍♂️ here goes an hour or two of trying things 🤦‍♂️ ...\r\n\r\nWhat I noticed is that it has nothing to do with the async awaits, but with the artifacts.require.\r\nIn the original one, it requires `./Migrations.sol`, and in our version just `Migrations`.\r\n\r\n```js\r\nvar Migrations = artifacts.require('Migrations');\r\n\r\nmodule.exports = function(deployer) {\r\n  deployer.deploy(Migrations);\r\n};\r\n``` \r\n\r\nThis does not work, and this does work:\r\n\r\n```js\r\nvar Migrations = artifacts.require('./Migrations.sol');\r\n\r\nasync function performMigration(deployer, network, accounts) {\r\n  await deployer.deploy(Migrations);\r\n}\r\n\r\nmodule.exports = function(deployer, network, accounts) {\r\n  deployer\r\n    .then(() => performMigration(deployer, network, accounts))\r\n    .catch(error => {\r\n      console.log(error);\r\n      process.exit(1);\r\n    });\r\n};\r\n```\r\n\r\nSo, now I only have to figure out why this does work for my other contracts, and not for the Migrations contract.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/403031560/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/403066763",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-403066763",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 403066763,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMzA2Njc2Mw==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-06T15:26:05Z",
    "updated_at": "2018-07-06T15:26:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @roderik, thanks for this report! \r\n\r\nWill investigate - at a minimum it looks like Truffle is hard-coding the Migrations.sol path internally [here](https://github.com/trufflesuite/truffle/blob/develop/packages/truffle-migrate/index.js#L49). @gnidan actually just picked this out as potentially problematic in a code review of a Migrations re-write referenced in the link above, although I'm not sure I understand why the resolver isn't handling this correctly. \r\n\r\nI will add a regression test for this and make sure it's fixed in the new version. ",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/403066763/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/406396722",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-406396722",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 406396722,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwNjM5NjcyMg==",
    "user": {
      "login": "pstuermlinger",
      "id": 485835,
      "node_id": "MDQ6VXNlcjQ4NTgzNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/485835?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pstuermlinger",
      "html_url": "https://github.com/pstuermlinger",
      "followers_url": "https://api.github.com/users/pstuermlinger/followers",
      "following_url": "https://api.github.com/users/pstuermlinger/following{/other_user}",
      "gists_url": "https://api.github.com/users/pstuermlinger/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pstuermlinger/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pstuermlinger/subscriptions",
      "organizations_url": "https://api.github.com/users/pstuermlinger/orgs",
      "repos_url": "https://api.github.com/users/pstuermlinger/repos",
      "events_url": "https://api.github.com/users/pstuermlinger/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pstuermlinger/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-19T20:01:37Z",
    "updated_at": "2018-07-19T22:09:03Z",
    "author_association": "NONE",
    "body": "Hello guys,\r\nI'm not sure if my issue fits 100% into this topic. Let's see:\r\n\r\nI deploy ContractA via truffle and as a result, the contracts artifact contains its address. However, I've got a 2nd contract which is not deployed by truffle but within the ContracA's constructor:\r\n```solidity\r\n// ContractA\r\nconstructor() public {\r\n    contractB = new ContractB();\r\n}\r\n```\r\nI prefer this method over single truffle deployments because it's about 1,000,000 gas cheaper (with Ganache - idk why). And as a side effect A owns B which is what I want. However, as a result, the **ContracB's artifact DOES NOT contain it's address.**\r\nThe question is: how can it be passed to Truffle so that Truffle will write it into the artifact?\r\n\r\n```javascript\r\nmodule.exports = function(deployer, network, accounts) {\r\n  return deployer.deploy(ContractA).then(() => {\r\n    return ContractA.deployed();\r\n  }).then(async (contractAInstance) => {\r\n    const contractB = await contractAInstance.contractB();\r\n    // How to tell truffle about contractB?\r\n  });\r\n};\r\n```\r\n**EDIT: solved**\r\n\r\n```javascript\r\nvar ContractA = artifacts.require(\"ContractA\");\r\nvar ContractB = artifacts.require(\"ContractB\");\r\n\r\nmodule.exports = function(deployer, network, accounts) {\r\n  return deployer.deploy(ContractA).then(() => {\r\n    return ContractA.deployed();\r\n  }).then(async (contractAInstance) => {\r\n    const contractB = await contractAInstance.contractB();\r\n    // Update artifact manually\r\n    ContractB.address = contractB;\r\n    ContractB.transactionHash = ContractA.transactionHash;\r\n  });\r\n};\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/406396722/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/418688388",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-418688388",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 418688388,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxODY4ODM4OA==",
    "user": {
      "login": "levino",
      "id": 1150767,
      "node_id": "MDQ6VXNlcjExNTA3Njc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1150767?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/levino",
      "html_url": "https://github.com/levino",
      "followers_url": "https://api.github.com/users/levino/followers",
      "following_url": "https://api.github.com/users/levino/following{/other_user}",
      "gists_url": "https://api.github.com/users/levino/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/levino/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/levino/subscriptions",
      "organizations_url": "https://api.github.com/users/levino/orgs",
      "repos_url": "https://api.github.com/users/levino/repos",
      "events_url": "https://api.github.com/users/levino/events{/privacy}",
      "received_events_url": "https://api.github.com/users/levino/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-05T10:54:02Z",
    "updated_at": "2018-09-05T10:54:18Z",
    "author_association": "NONE",
    "body": "So this works:\r\n\r\n```js\r\nmodule.exports = function(deployer) {\r\n  // You have to use the `then` of the first deployer instance. Do not try to wrap this in async / await\r\n  deployer.then(async () => {\r\n    console.log('Deploying token')\r\n    const token = await deployer.deploy(Token)\r\n    console.log('Deploying crowdsale')\r\n    const crowdsale = await deployer.deploy(\r\n      Crowdsale,\r\n      RATE,\r\n      TREASURY,\r\n      CAP,\r\n      token.address\r\n    )\r\n    console.log('Make crowdsale owner of token')\r\n    return token.transferOwnership(crowdsale.address)\r\n  })\r\n}\r\n```\r\nSo you have to start with one `deployer.then` call.\r\n\r\nThe problem is obviously also that the exported function is **not expected to return a promise**. You can see this because the following actually works:\r\n```js\r\nvar Migrations = artifacts.require('Migrations');\r\n\r\nmodule.exports = function(deployer) {\r\n  deployer.deploy(Migrations);\r\n};\r\n```\r\nWhile I actually would expect only this to work:\r\n```js\r\nvar Migrations = artifacts.require('Migrations');\r\n\r\nmodule.exports = function(deployer) {\r\n  return deployer.deploy(Migrations);\r\n};\r\n```\r\nSo instead of attaching some weird own `then` property to the deployer object, `truffle` should expect a promise to be returned from these functions. I think this is a really ugly antipattern here.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/418688388/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/418785238",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-418785238",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 418785238,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxODc4NTIzOA==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-05T15:59:43Z",
    "updated_at": "2018-09-05T15:59:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "@Levino Agree, this has been the source of confusion for a while. \r\n\r\n[truffle@beta](https://github.com/trufflesuite/truffle/releases/tag/v5.0.0-beta.0#new-migrations) includes a fix for it. The migrations can now be written  using `async/await` and behave more a little more intuitively:\r\n\r\n```javascript\r\nconst One = artifacts.require(\"One\");\r\nconst Two = artifacts.require(\"Two\");\r\n\r\nmodule.exports = async function(deployer) {\r\n  await deployer.deploy(One);\r\n\r\n  const one = await One.deployed();\r\n  const value = await one.value();\r\n\r\n  await deployer.deploy(Two, value);\r\n};\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/418785238/reactions",
      "total_count": 3,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 3,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/454892396",
    "html_url": "https://github.com/trufflesuite/truffle/issues/713#issuecomment-454892396",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/713",
    "id": 454892396,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NDg5MjM5Ng==",
    "user": {
      "login": "gnidan",
      "id": 151065,
      "node_id": "MDQ6VXNlcjE1MTA2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnidan",
      "html_url": "https://github.com/gnidan",
      "followers_url": "https://api.github.com/users/gnidan/followers",
      "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
      "organizations_url": "https://api.github.com/users/gnidan/orgs",
      "repos_url": "https://api.github.com/users/gnidan/repos",
      "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnidan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-16T18:41:45Z",
    "updated_at": "2019-01-16T18:41:45Z",
    "author_association": "MEMBER",
    "body": "Looks like this is fixed and released with the rest of v5. Closing this for issue maintenance, but please feel free to let us know and we will re-open. Thank you!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/454892396/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
