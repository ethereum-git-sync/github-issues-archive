{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/109",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/109/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/109/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/109/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/109",
  "id": 140101402,
  "node_id": "MDU6SXNzdWUxNDAxMDE0MDI=",
  "number": 109,
  "title": "Events emitted during test reports events emitted during suite",
  "user": {
    "login": "lastperson",
    "id": 6198746,
    "node_id": "MDQ6VXNlcjYxOTg3NDY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6198746?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/lastperson",
    "html_url": "https://github.com/lastperson",
    "followers_url": "https://api.github.com/users/lastperson/followers",
    "following_url": "https://api.github.com/users/lastperson/following{/other_user}",
    "gists_url": "https://api.github.com/users/lastperson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/lastperson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/lastperson/subscriptions",
    "organizations_url": "https://api.github.com/users/lastperson/orgs",
    "repos_url": "https://api.github.com/users/lastperson/repos",
    "events_url": "https://api.github.com/users/lastperson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/lastperson/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2016-03-11T06:31:08Z",
  "updated_at": "2018-11-10T00:19:14Z",
  "closed_at": "2016-03-18T15:17:16Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Consider following contract:\n\n```\ncontract Emitter {\n    event Called();\n    function emit() {\n        Called();\n    }\n}\n```\n\nAnd tests:\n\n```\ncontract('Emitter', function(accounts) {\n  it('should emit Called event and fail (shows 1 emitted)', function(done) {\n    var emitter = Emitter.deployed();\n    emitter.emit().then(function() {\n      assert.isTrue(false);\n    }).then(done).catch(done);\n  });\n  it('should emit Called event', function(done) {\n    var emitter = Emitter.deployed();\n    emitter.emit().then(function() {\n      done();\n    }).catch(done);\n  });\n  it('should emit Called event 2', function(done) {\n    var emitter = Emitter.deployed();\n    emitter.emit().then(function() {\n      done();\n    }).catch(done);\n  });\n  it('should emit Called event and fail 2 (shows 3 emitted)', function(done) {\n    var emitter = Emitter.deployed();\n    emitter.emit().then(function() {\n      assert.isTrue(false);      \n    }).then(done).catch(done);\n  });\n  it('should emit Called event and fail 3 (shows 1 emitted)', function(done) {\n    var emitter = Emitter.deployed();\n    emitter.emit().then(function() {\n      assert.isTrue(false);      \n    }).then(done).catch(done);\n  });\n});\n```\n\nOutput:\n\n```\nContract: Emitter\n    1) should emit Called event and fail (shows 1 emitted)\n    Events emitted during test:\n    ---------------------------\n    Called()\n    ---------------------------\n    ✓ should emit Called event\n    ✓ should emit Called event 2 (48ms)\n    2) should emit Called event and fail 2 (shows 3 emitted)\n    Events emitted during test:\n    ---------------------------\n    Called()\n    Called()\n    Called()\n    ---------------------------\n    3) should emit Called event and fail 3 (shows 1 emitted)\n    Events emitted during test:\n    ---------------------------\n    Called()\n    ---------------------------\n  2 passing (8s)\n  3 failing\n```\n\nAs you can see, when 3rd test fails, it reports the events emitted between last failed test (exclusive) and current test (inclusive).\n",
  "closed_by": {
    "login": "tcoulter",
    "id": 92629,
    "node_id": "MDQ6VXNlcjkyNjI5",
    "avatar_url": "https://avatars.githubusercontent.com/u/92629?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tcoulter",
    "html_url": "https://github.com/tcoulter",
    "followers_url": "https://api.github.com/users/tcoulter/followers",
    "following_url": "https://api.github.com/users/tcoulter/following{/other_user}",
    "gists_url": "https://api.github.com/users/tcoulter/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tcoulter/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tcoulter/subscriptions",
    "organizations_url": "https://api.github.com/users/tcoulter/orgs",
    "repos_url": "https://api.github.com/users/tcoulter/repos",
    "events_url": "https://api.github.com/users/tcoulter/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tcoulter/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/109/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/109/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/198405637",
    "html_url": "https://github.com/trufflesuite/truffle/issues/109#issuecomment-198405637",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/109",
    "id": 198405637,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5ODQwNTYzNw==",
    "user": {
      "login": "tcoulter",
      "id": 92629,
      "node_id": "MDQ6VXNlcjkyNjI5",
      "avatar_url": "https://avatars.githubusercontent.com/u/92629?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tcoulter",
      "html_url": "https://github.com/tcoulter",
      "followers_url": "https://api.github.com/users/tcoulter/followers",
      "following_url": "https://api.github.com/users/tcoulter/following{/other_user}",
      "gists_url": "https://api.github.com/users/tcoulter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tcoulter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tcoulter/subscriptions",
      "organizations_url": "https://api.github.com/users/tcoulter/orgs",
      "repos_url": "https://api.github.com/users/tcoulter/repos",
      "events_url": "https://api.github.com/users/tcoulter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tcoulter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-03-18T15:17:16Z",
    "updated_at": "2016-03-18T15:17:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi there,\n\nI had meant to respond to this sooner. Can you try out the 0.4.0 pre-release? https://github.com/ConsenSys/truffle/releases/tag/v0.3.9\n\nOne of the fixes/features is the following, which I believe fixes your issue:\n\n> **Better log processing during failing tests**. If one of your tests fail, Truffle will now better show the logs that applied to that specific failing test rather than display all logs fired over the course of the test run.\n\nPlease reopen if this does not fix your issue.\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/198405637/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/333408572",
    "html_url": "https://github.com/trufflesuite/truffle/issues/109#issuecomment-333408572",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/109",
    "id": 333408572,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMzQwODU3Mg==",
    "user": {
      "login": "cbruguera",
      "id": 2256202,
      "node_id": "MDQ6VXNlcjIyNTYyMDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2256202?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cbruguera",
      "html_url": "https://github.com/cbruguera",
      "followers_url": "https://api.github.com/users/cbruguera/followers",
      "following_url": "https://api.github.com/users/cbruguera/following{/other_user}",
      "gists_url": "https://api.github.com/users/cbruguera/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cbruguera/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cbruguera/subscriptions",
      "organizations_url": "https://api.github.com/users/cbruguera/orgs",
      "repos_url": "https://api.github.com/users/cbruguera/repos",
      "events_url": "https://api.github.com/users/cbruguera/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cbruguera/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-01T21:35:04Z",
    "updated_at": "2017-10-01T21:35:04Z",
    "author_association": "NONE",
    "body": "@tcoulter Hello, is there any way to display events emitted in all cases (even for succeeded tests)?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/333408572/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/374968554",
    "html_url": "https://github.com/trufflesuite/truffle/issues/109#issuecomment-374968554",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/109",
    "id": 374968554,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NDk2ODU1NA==",
    "user": {
      "login": "OTTTO",
      "id": 9601008,
      "node_id": "MDQ6VXNlcjk2MDEwMDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9601008?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/OTTTO",
      "html_url": "https://github.com/OTTTO",
      "followers_url": "https://api.github.com/users/OTTTO/followers",
      "following_url": "https://api.github.com/users/OTTTO/following{/other_user}",
      "gists_url": "https://api.github.com/users/OTTTO/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/OTTTO/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/OTTTO/subscriptions",
      "organizations_url": "https://api.github.com/users/OTTTO/orgs",
      "repos_url": "https://api.github.com/users/OTTTO/repos",
      "events_url": "https://api.github.com/users/OTTTO/events{/privacy}",
      "received_events_url": "https://api.github.com/users/OTTTO/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-21T15:01:06Z",
    "updated_at": "2018-03-21T15:01:13Z",
    "author_association": "NONE",
    "body": "@cbruguera Yes, I believe this should be an option; potentially a set option in the mocha config.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/374968554/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/379052682",
    "html_url": "https://github.com/trufflesuite/truffle/issues/109#issuecomment-379052682",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/109",
    "id": 379052682,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3OTA1MjY4Mg==",
    "user": {
      "login": "stefek99",
      "id": 249703,
      "node_id": "MDQ6VXNlcjI0OTcwMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/249703?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stefek99",
      "html_url": "https://github.com/stefek99",
      "followers_url": "https://api.github.com/users/stefek99/followers",
      "following_url": "https://api.github.com/users/stefek99/following{/other_user}",
      "gists_url": "https://api.github.com/users/stefek99/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stefek99/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stefek99/subscriptions",
      "organizations_url": "https://api.github.com/users/stefek99/orgs",
      "repos_url": "https://api.github.com/users/stefek99/repos",
      "events_url": "https://api.github.com/users/stefek99/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stefek99/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-05T19:38:10Z",
    "updated_at": "2018-04-05T19:38:10Z",
    "author_association": "NONE",
    "body": "@OTTTO @cbruguera @tcoulter Do you know how to log events at ALL times?\r\n\r\n`assert.equal(true, false); // failing on purpose to see log events`\r\n\r\nAny better options?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/379052682/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/437514386",
    "html_url": "https://github.com/trufflesuite/truffle/issues/109#issuecomment-437514386",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/109",
    "id": 437514386,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNzUxNDM4Ng==",
    "user": {
      "login": "flockonus",
      "id": 165553,
      "node_id": "MDQ6VXNlcjE2NTU1Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/165553?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/flockonus",
      "html_url": "https://github.com/flockonus",
      "followers_url": "https://api.github.com/users/flockonus/followers",
      "following_url": "https://api.github.com/users/flockonus/following{/other_user}",
      "gists_url": "https://api.github.com/users/flockonus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/flockonus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/flockonus/subscriptions",
      "organizations_url": "https://api.github.com/users/flockonus/orgs",
      "repos_url": "https://api.github.com/users/flockonus/repos",
      "events_url": "https://api.github.com/users/flockonus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/flockonus/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-09T22:26:13Z",
    "updated_at": "2018-11-10T00:19:14Z",
    "author_association": "NONE",
    "body": "+1 for a simple general event list.\r\n\r\nI'm having a case where I call contract A, which then calls contract B, and B emit events, those are not shown in the transaction logs, so I had to implement a whole listener on the side to capture those.\r\n\r\nSimple version:\r\n\r\n```js\r\nfunction getLastEvents(contract) {\r\n  return new Promise((resolve, reject) => {\r\n    const evFilter = contract.allEvents({\r\n      fromBlock: 'latest',\r\n      toBlock: 'latest',\r\n    });\r\n    evFilter.get((err, res) => {\r\n      if (err) return reject(err);\r\n      resolve(res);\r\n    });\r\n  });\r\n}\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/437514386/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
