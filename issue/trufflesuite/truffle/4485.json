{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/4485",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4485/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4485/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4485/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/4485",
  "id": 1070213797,
  "node_id": "I_kwDOAkfq-c4_yiql",
  "number": 4485,
  "title": "@truffle/fetch-and-compile should not require a @truffle/config object",
  "user": {
    "login": "gnidan",
    "id": 151065,
    "node_id": "MDQ6VXNlcjE1MTA2NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gnidan",
    "html_url": "https://github.com/gnidan",
    "followers_url": "https://api.github.com/users/gnidan/followers",
    "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
    "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
    "organizations_url": "https://api.github.com/users/gnidan/orgs",
    "repos_url": "https://api.github.com/users/gnidan/repos",
    "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gnidan/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1675041796,
      "node_id": "MDU6TGFiZWwxNjc1MDQxNzk2",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/priority3%20%F0%9F%94%A7",
      "name": "priority3 ðŸ”§",
      "color": "006b75",
      "default": false,
      "description": ""
    },
    {
      "id": 3628493077,
      "node_id": "LA_kwDOAkfq-c7YRmkV",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/fetch-and-compile",
      "name": "fetch-and-compile",
      "color": "19EC49",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2021-12-03T04:43:20Z",
  "updated_at": "2022-04-29T00:39:14Z",
  "closed_at": "2022-04-29T00:39:14Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "## Issue\r\n\r\nThe `fetchAndCompile` function accepts two arguments: an address and a TruffleConfig. The second argument **must** be a TruffleConfig because it relies heavily on that package's defined defaults for things like precedence order for which fetchers to use, supplying no defaults of its own.\r\n\r\nThis is fiddly. The interface here should be expanded to accept either the existing `config` object or a new options argument with the relevant parameters that are actually used in this flow. This alternate form should _strictly_ contain that which actually matters in this context (e.g. there's no need to allow configuring network name, network id, or anything about solc other than whether to use Docker â€“ none of that \"The `solc` option is an object of the form supplied to a `truffle-config.js` file's `compilers` configuration\", I say! ðŸ™Œ )\r\n",
  "closed_by": {
    "login": "haltman-at",
    "id": 35589221,
    "node_id": "MDQ6VXNlcjM1NTg5MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/haltman-at",
    "html_url": "https://github.com/haltman-at",
    "followers_url": "https://api.github.com/users/haltman-at/followers",
    "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
    "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
    "organizations_url": "https://api.github.com/users/haltman-at/orgs",
    "repos_url": "https://api.github.com/users/haltman-at/repos",
    "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
    "received_events_url": "https://api.github.com/users/haltman-at/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/4485/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4485/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1080984514",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4485#issuecomment-1080984514",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4485",
    "id": 1080984514,
    "node_id": "IC_kwDOAkfq-c5AboPC",
    "user": {
      "login": "gnidan",
      "id": 151065,
      "node_id": "MDQ6VXNlcjE1MTA2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnidan",
      "html_url": "https://github.com/gnidan",
      "followers_url": "https://api.github.com/users/gnidan/followers",
      "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
      "organizations_url": "https://api.github.com/users/gnidan/orgs",
      "repos_url": "https://api.github.com/users/gnidan/repos",
      "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnidan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-28T18:15:49Z",
    "updated_at": "2022-03-28T18:15:49Z",
    "author_association": "MEMBER",
    "body": "@haltman-at writes about the information that fetch-and-compile uses from the config:\r\n\r\n> 1. `sourceFetchers` -- list of source fetchers to check, in what order; defaults as you know to `[\"etherscan\", \"sourcify\"]`\r\n> 2. `network_id` -- the network ID. of course as you know on an actual config this is a getter that returns `config.networks[config.network].network_id`\r\n> 3. `etherscan`, `sourcify`, etc -- each fetcher name is taken as a config field w/options for that fetcher; currently only `etherscan` is currently used, it's where you can put your etherscan `apiKey` (of course you have noted that this sort of thing probably really belongs in user config rather than project config, but I don't think that's really relevant here and right now it's in project config)\r\n> 4. `compilers.solc.docker` -- are you using docker for solc? (and possibly in the future a similar option might exist for `vyper`?? not clear how that'd work, like what the alternative would be)\r\n> 5. (not checked deliberately by fetch-and-compile but I believe this accidentally has an effect... we should probably override this in fetch-and-compile to avoid issues, I should probably throw up a PR to fix this) it looks like `strict` gets passed through to compile-solidity and will cause errors on warnings (like I said, that's not deliberate and I should fix it)\r\n>     \r\n>     oh that one's probably meant to be an option rather than a config field though isn't it? so I guess actually I won't bother with that because people don't set that in the config (and it will not in fact make it through from the command-line options).\r\n\r\nThanks for this, @haltman-at!\r\n\r\n\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1080984514/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1081000689",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4485#issuecomment-1081000689",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4485",
    "id": 1081000689,
    "node_id": "IC_kwDOAkfq-c5AbsLx",
    "user": {
      "login": "gnidan",
      "id": 151065,
      "node_id": "MDQ6VXNlcjE1MTA2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnidan",
      "html_url": "https://github.com/gnidan",
      "followers_url": "https://api.github.com/users/gnidan/followers",
      "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
      "organizations_url": "https://api.github.com/users/gnidan/orgs",
      "repos_url": "https://api.github.com/users/gnidan/repos",
      "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnidan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-28T18:32:21Z",
    "updated_at": "2022-03-28T18:32:21Z",
    "author_association": "MEMBER",
    "body": "This being said, what about this:\r\n\r\n```typescript\r\nexport interface FetchAndCompileOptions {\r\n  network: {\r\n    networkId: number;\r\n  };\r\n  fetch?: {\r\n    sourceFetchers?: string[]; // eg. [\"etherscan\", \"sourcify\"]\r\n    etherscan?: {\r\n      apiKey?: string;\r\n    };\r\n    sourcify?: {\r\n      /* empty for now */\r\n    };\r\n  };\r\n  compile?: {\r\n    docker?: boolean;\r\n  }\r\n}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1081000689/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1081026514",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4485#issuecomment-1081026514",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4485",
    "id": 1081026514,
    "node_id": "IC_kwDOAkfq-c5AbyfS",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-28T19:01:59Z",
    "updated_at": "2022-03-28T19:01:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "Makes sense!  Note we have talked in the past about it possibly taking a provider for handling proxy contracts.  But I guess this could be expanded in the future with that?\r\n\r\nThe question to my mind is, how do we distinguish this from a config?  Or do we set it up so we don't need to?  (I guess the latter wouldn't be too difficult, although doing it in *Typescript* might be annoying.)",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1081026514/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1092176297",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4485#issuecomment-1092176297",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4485",
    "id": 1092176297,
    "node_id": "IC_kwDOAkfq-c5BGUmp",
    "user": {
      "login": "gnidan",
      "id": 151065,
      "node_id": "MDQ6VXNlcjE1MTA2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnidan",
      "html_url": "https://github.com/gnidan",
      "followers_url": "https://api.github.com/users/gnidan/followers",
      "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
      "organizations_url": "https://api.github.com/users/gnidan/orgs",
      "repos_url": "https://api.github.com/users/gnidan/repos",
      "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnidan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-07T20:34:06Z",
    "updated_at": "2022-04-07T20:34:06Z",
    "author_association": "MEMBER",
    "body": "> Note we have talked in the past about it possibly taking a provider for handling proxy contracts. But I guess this could be expanded in the future with that?\r\n\r\nYep, I left it out for now but figured we'd probably have to add it later.\r\n\r\n> The question to my mind is, how do we distinguish this from a config? Or do we set it up so we don't need to? (I guess the latter wouldn't be too difficult, although doing it in _Typescript_ might be annoying.)\r\n\r\nRight now, we only accept an actual TruffleConfig object, so maybe we can just go with the simple solution of doing an `instanceof` check! That way we don't need to do any sort of duck-typing matching :)",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1092176297/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1092177379",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4485#issuecomment-1092177379",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4485",
    "id": 1092177379,
    "node_id": "IC_kwDOAkfq-c5BGU3j",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-07T20:35:33Z",
    "updated_at": "2022-04-07T20:35:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Right now, we only accept an actual TruffleConfig object, so maybe we can just go with the simple solution of doing an `instanceof` check! That way we don't need to do any sort of duck-typing matching :)\r\n\r\nOh, I didn't even think of that!  Silly me... thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1092177379/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1112778333",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4485#issuecomment-1112778333",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4485",
    "id": 1112778333,
    "node_id": "IC_kwDOAkfq-c5CU6Zd",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-29T00:39:14Z",
    "updated_at": "2022-04-29T00:39:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "Now done in #5054.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1112778333/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
