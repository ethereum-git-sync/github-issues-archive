{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/630",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/630/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/630/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/630/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/630",
  "id": 267266499,
  "node_id": "MDU6SXNzdWUyNjcyNjY0OTk=",
  "number": 630,
  "title": "Truffle 4 beta.1: contracts installed from EPM do not properly deploy on test network (reproducible)",
  "user": {
    "login": "skmgoldin",
    "id": 6937058,
    "node_id": "MDQ6VXNlcjY5MzcwNTg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6937058?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/skmgoldin",
    "html_url": "https://github.com/skmgoldin",
    "followers_url": "https://api.github.com/users/skmgoldin/followers",
    "following_url": "https://api.github.com/users/skmgoldin/following{/other_user}",
    "gists_url": "https://api.github.com/users/skmgoldin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/skmgoldin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/skmgoldin/subscriptions",
    "organizations_url": "https://api.github.com/users/skmgoldin/orgs",
    "repos_url": "https://api.github.com/users/skmgoldin/repos",
    "events_url": "https://api.github.com/users/skmgoldin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/skmgoldin/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1120350502,
      "node_id": "MDU6TGFiZWwxMTIwMzUwNTAy",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/stale",
      "name": "stale",
      "color": "ffffff",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "gnidan",
    "id": 151065,
    "node_id": "MDQ6VXNlcjE1MTA2NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gnidan",
    "html_url": "https://github.com/gnidan",
    "followers_url": "https://api.github.com/users/gnidan/followers",
    "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
    "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
    "organizations_url": "https://api.github.com/users/gnidan/orgs",
    "repos_url": "https://api.github.com/users/gnidan/repos",
    "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gnidan/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "gnidan",
      "id": 151065,
      "node_id": "MDQ6VXNlcjE1MTA2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnidan",
      "html_url": "https://github.com/gnidan",
      "followers_url": "https://api.github.com/users/gnidan/followers",
      "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
      "organizations_url": "https://api.github.com/users/gnidan/orgs",
      "repos_url": "https://api.github.com/users/gnidan/repos",
      "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnidan/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2017-10-20T18:37:47Z",
  "updated_at": "2018-11-15T11:10:12Z",
  "closed_at": "2018-11-15T11:10:12Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Issue\r\n\r\nContracts installed using `truffle install` do not properly deploy on the test network when run with `truffle test`.\r\n\r\n## Steps to Reproduce\r\n\r\n```\r\ngit clone git@github.com:skmgoldin/dead-mans-switch.git\r\ncd dead-mans-switch\r\ngit checkout truffle4-bug\r\nnpm i\r\nnpm run compile\r\nnpm run test\r\n```\r\n\r\nNotice the `HumanStandardToken has not been deployed to detected network (network/artifact mismatch)` error (ignore any other errors, they're unrelated, this branch is from a WIP repo).\r\n\r\nIf you change the token imports in `migrations/3_token.js` and `test/dead.js` to `const Token = artifacts.require('./tokens/HumanStandardToken.sol');` (prepending a `./`, using the local copies in the `contracts` directory instead), that error goes away.\r\n\r\n## Expected Behavior\r\n\r\nContracts in the `installed_contracts` directory should be deployed on the test network.\r\n\r\n## Actual Results\r\n\r\nThey are not deployed on the test network.\r\n\r\n## Environment\r\n\r\n* Operating System: Ubuntu 16.04\r\n* Truffle version: beta.1\r\n* Ethereum client: Truffle internal test RPC\r\n* node version: 8.7.0\r\n* npm version: 5.4.2\r\n",
  "closed_by": {
    "login": "stale[bot]",
    "id": 26384082,
    "node_id": "MDM6Qm90MjYzODQwODI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/stale%5Bbot%5D",
    "html_url": "https://github.com/apps/stale",
    "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/630/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/630/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/339101188",
    "html_url": "https://github.com/trufflesuite/truffle/issues/630#issuecomment-339101188",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/630",
    "id": 339101188,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzOTEwMTE4OA==",
    "user": {
      "login": "tcoulter",
      "id": 92629,
      "node_id": "MDQ6VXNlcjkyNjI5",
      "avatar_url": "https://avatars.githubusercontent.com/u/92629?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tcoulter",
      "html_url": "https://github.com/tcoulter",
      "followers_url": "https://api.github.com/users/tcoulter/followers",
      "following_url": "https://api.github.com/users/tcoulter/following{/other_user}",
      "gists_url": "https://api.github.com/users/tcoulter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tcoulter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tcoulter/subscriptions",
      "organizations_url": "https://api.github.com/users/tcoulter/orgs",
      "repos_url": "https://api.github.com/users/tcoulter/repos",
      "events_url": "https://api.github.com/users/tcoulter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tcoulter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-24T19:17:34Z",
    "updated_at": "2017-10-24T19:17:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "@skmgoldin Sweet bug man. Thanks for the report.\r\n\r\nWe've identified the issue and will plan a fix for it, likely for after Truffle 4.0 is released. In the meantime, there's a very simple workaround. On [this line](https://github.com/skmgoldin/dead-mans-switch/blob/truffle4-bug/test/dead.js#L5) you have the following code:\r\n\r\n```\r\nconst Token = artifacts.require('tokens/HumanStandardToken.sol');\r\n```\r\n\r\nTo circumvent the issue (for now), change it to this:\r\n\r\n```\r\nconst Token = artifacts.require('HumanStandardToken');\r\n```\r\n\r\nFor technical reasons (I can go into detail if you like), this will still pull the `HumanStandardToken` contract you were expecting.\r\n\r\nFixing this issue for good will require some rework, as it identifies an EPM use case we didn't think about (and no one else seems to have exercised yet). Thanks for bringing this to our attention, and we'll let you know when it's fixed for good.\r\n\r\nThanks again!\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/339101188/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/339104300",
    "html_url": "https://github.com/trufflesuite/truffle/issues/630#issuecomment-339104300",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/630",
    "id": 339104300,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzOTEwNDMwMA==",
    "user": {
      "login": "skmgoldin",
      "id": 6937058,
      "node_id": "MDQ6VXNlcjY5MzcwNTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6937058?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/skmgoldin",
      "html_url": "https://github.com/skmgoldin",
      "followers_url": "https://api.github.com/users/skmgoldin/followers",
      "following_url": "https://api.github.com/users/skmgoldin/following{/other_user}",
      "gists_url": "https://api.github.com/users/skmgoldin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/skmgoldin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/skmgoldin/subscriptions",
      "organizations_url": "https://api.github.com/users/skmgoldin/orgs",
      "repos_url": "https://api.github.com/users/skmgoldin/repos",
      "events_url": "https://api.github.com/users/skmgoldin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/skmgoldin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-24T19:28:36Z",
    "updated_at": "2017-10-24T19:28:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks Tim! That workaround is fine.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/339104300/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/339108670",
    "html_url": "https://github.com/trufflesuite/truffle/issues/630#issuecomment-339108670",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/630",
    "id": 339108670,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzOTEwODY3MA==",
    "user": {
      "login": "tcoulter",
      "id": 92629,
      "node_id": "MDQ6VXNlcjkyNjI5",
      "avatar_url": "https://avatars.githubusercontent.com/u/92629?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tcoulter",
      "html_url": "https://github.com/tcoulter",
      "followers_url": "https://api.github.com/users/tcoulter/followers",
      "following_url": "https://api.github.com/users/tcoulter/following{/other_user}",
      "gists_url": "https://api.github.com/users/tcoulter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tcoulter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tcoulter/subscriptions",
      "organizations_url": "https://api.github.com/users/tcoulter/orgs",
      "repos_url": "https://api.github.com/users/tcoulter/repos",
      "events_url": "https://api.github.com/users/tcoulter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tcoulter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-24T19:44:49Z",
    "updated_at": "2017-10-24T19:44:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "Chatted with @skmgoldin about why this issue occurs. Putting the response here for posterity: \r\n\r\n> It has to do with the (we'll call it) artifact pipeline. When you compile/deploy an EPM contract, it actually creates an artifact for it in `./build/contracts` (it mingles with the artifacts of your own contracts). When you need to use it in your tests, we were supposed to then return that artifact, but instead we were returning an artifact from the package itself. \r\n> \r\n> Now, the quick fix is to just return _our_ artifact. But that's going to cause issues for your app, because _our_ artifact doesn't contain addresses for deployed versions that might exist in the package itself; that is to say, if you don't have the mainnet artifact you're expecting for certain types of EPM packages, you're going to have a bad time (the `token` package isn't one of these types; but I digress). So the real solution is to merge the artifacts the package has with the artifacts you create locally, essentially creating a \"master artifact\" that will work in all cases.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/339108670/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/436945575",
    "html_url": "https://github.com/trufflesuite/truffle/issues/630#issuecomment-436945575",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/630",
    "id": 436945575,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjk0NTU3NQ==",
    "user": {
      "login": "stale[bot]",
      "id": 26384082,
      "node_id": "MDM6Qm90MjYzODQwODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stale%5Bbot%5D",
      "html_url": "https://github.com/apps/stale",
      "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2018-11-08T10:22:10Z",
    "updated_at": "2018-11-08T10:22:10Z",
    "author_association": "NONE",
    "body": "Thank you for raising this issue! It has been automatically marked as stale because it has not had recent activity. It will be closed in 7 days if no further activity occurs. If you would like to keep this issue open, please respond with information about the current state of this problem.\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/436945575/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/439004217",
    "html_url": "https://github.com/trufflesuite/truffle/issues/630#issuecomment-439004217",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/630",
    "id": 439004217,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzOTAwNDIxNw==",
    "user": {
      "login": "stale[bot]",
      "id": 26384082,
      "node_id": "MDM6Qm90MjYzODQwODI=",
      "avatar_url": "https://avatars.githubusercontent.com/in/1724?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stale%5Bbot%5D",
      "html_url": "https://github.com/apps/stale",
      "followers_url": "https://api.github.com/users/stale%5Bbot%5D/followers",
      "following_url": "https://api.github.com/users/stale%5Bbot%5D/following{/other_user}",
      "gists_url": "https://api.github.com/users/stale%5Bbot%5D/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stale%5Bbot%5D/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stale%5Bbot%5D/subscriptions",
      "organizations_url": "https://api.github.com/users/stale%5Bbot%5D/orgs",
      "repos_url": "https://api.github.com/users/stale%5Bbot%5D/repos",
      "events_url": "https://api.github.com/users/stale%5Bbot%5D/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stale%5Bbot%5D/received_events",
      "type": "Bot",
      "site_admin": false
    },
    "created_at": "2018-11-15T11:09:42Z",
    "updated_at": "2018-11-15T11:09:42Z",
    "author_association": "NONE",
    "body": "There has been no new activity on this issue since it was marked as stale 7 days ago, so it is being automatically closed.  If you'd like help with this or a different problem, please open a new issue. Thanks!\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/439004217/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
