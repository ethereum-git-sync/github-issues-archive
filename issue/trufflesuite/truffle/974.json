{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/974",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/974/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/974/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/974/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/974",
  "id": 327913175,
  "node_id": "MDU6SXNzdWUzMjc5MTMxNzU=",
  "number": 974,
  "title": "Deploy on Ropsten fails but no message explaining why",
  "user": {
    "login": "rmi7",
    "id": 15264239,
    "node_id": "MDQ6VXNlcjE1MjY0MjM5",
    "avatar_url": "https://avatars.githubusercontent.com/u/15264239?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rmi7",
    "html_url": "https://github.com/rmi7",
    "followers_url": "https://api.github.com/users/rmi7/followers",
    "following_url": "https://api.github.com/users/rmi7/following{/other_user}",
    "gists_url": "https://api.github.com/users/rmi7/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rmi7/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rmi7/subscriptions",
    "organizations_url": "https://api.github.com/users/rmi7/orgs",
    "repos_url": "https://api.github.com/users/rmi7/repos",
    "events_url": "https://api.github.com/users/rmi7/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rmi7/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 10,
  "created_at": "2018-05-30T21:54:44Z",
  "updated_at": "2018-06-04T10:25:31Z",
  "closed_at": "2018-05-31T15:05:34Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "- [x] I've asked for help in the [Truffle Gitter](http://gitter.im/Consensys/truffle) before filing this issue.\r\n\r\n---------------------------\r\n\r\n## Issue\r\n\r\nso I‚Äôm deploying 3 contracts (+ Migrations.sol) on both ganache locally AND `‚Äîdry-run` on ropsten. both giving me the below output for deployment of the last contract of the 4:\r\n\r\n```\r\nRunning migration: 4_deploy_MyMagicalContract.js\r\nSaving successful migration to network...\r\n  ... 0x9609a386fc40ac5245137a352e8c8982e68a4ab20568921bd52bfa2241e5c86d\r\n  Deploying MyMagicalContract...\r\nSaving artifacts...\r\n  ... 0xd869cdfaf31256f873fa573454c852b3ba24816f30b148df30914fd10756c94f\r\n  MyMagicalContract: 0xcb7109f76e9da709c940fdda378211c9856e16fb\r\n  ... 0x676b922b9fff07deb9c5c468f88820a55406c715799a05e007b046167856fbd4\r\n  ... 0x9149a825552b2b84da23d728f5b5bf43f3b91c4a9a2d4b4db13a13393dc6400b\r\n```\r\n\r\nbut when I actually deploy on ropsten (so **no** dry run) I only get this for the last contract:\r\n\r\n```\r\nRunning migration: 4_deploy_MyMagicalContract.js\r\nSaving successful migration to network...\r\n  Deploying MyMagicalContract...\r\n  ... 0x8a25b59f32d78ca108dedb93e7173db9855b2691a884eb4052d999cddb71d5d2\r\n  ... 0x082a3ebedd92bae28e00a9a3476f5f67b31ad8779c01e0c15b1b66ba54247297\r\nSaving artifacts...\r\n```\r\n\r\n## Expected Behavior\r\n\r\nExpected either:\r\n- a successful deploy of `MyMagicalContract.sol` \r\n- an indication/error of why it won't deploy `MyMagicalContract.sol` \r\n\r\n## Actual Results\r\n\r\n- no deploy of `MyMagicalContract.sol`\r\n- no message explaining why it won't deploy `MyMagicalContract.sol` \r\n\r\n## Environment\r\n\r\n* Operating System: Mac OS\r\n* Ethereum client: Infura\r\n* Truffle version `4.1.11`\r\n* node version `8.9.4`\r\n* npm version `5.6.0`\r\n",
  "closed_by": {
    "login": "rmi7",
    "id": 15264239,
    "node_id": "MDQ6VXNlcjE1MjY0MjM5",
    "avatar_url": "https://avatars.githubusercontent.com/u/15264239?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/rmi7",
    "html_url": "https://github.com/rmi7",
    "followers_url": "https://api.github.com/users/rmi7/followers",
    "following_url": "https://api.github.com/users/rmi7/following{/other_user}",
    "gists_url": "https://api.github.com/users/rmi7/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/rmi7/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/rmi7/subscriptions",
    "organizations_url": "https://api.github.com/users/rmi7/orgs",
    "repos_url": "https://api.github.com/users/rmi7/repos",
    "events_url": "https://api.github.com/users/rmi7/events{/privacy}",
    "received_events_url": "https://api.github.com/users/rmi7/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/974/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/974/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393335453",
    "html_url": "https://github.com/trufflesuite/truffle/issues/974#issuecomment-393335453",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/974",
    "id": 393335453,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MzMzNTQ1Mw==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-30T22:07:15Z",
    "updated_at": "2018-05-30T22:07:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "@rmi7 Is this your contract deployed to Ropsten at [tx 0x082a3ebedd92bae28e00a9a3476f5f67b31ad8779c01e0c15b1b66ba54247297](https://ropsten.etherscan.io/tx/0x082a3ebedd92bae28e00a9a3476f5f67b31ad8779c01e0c15b1b66ba54247297) ?\r\n\r\nCould you look at the artifacts for `MyMagicalContract` and see if there is an address saved under the `networks` key for the Ropsten network?\r\n\r\nLooks like it should be:  0x8a5fa2e6035fb19880a54f4f974d1ef320290988",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393335453/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393347891",
    "html_url": "https://github.com/trufflesuite/truffle/issues/974#issuecomment-393347891",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/974",
    "id": 393347891,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MzM0Nzg5MQ==",
    "user": {
      "login": "rmi7",
      "id": 15264239,
      "node_id": "MDQ6VXNlcjE1MjY0MjM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/15264239?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rmi7",
      "html_url": "https://github.com/rmi7",
      "followers_url": "https://api.github.com/users/rmi7/followers",
      "following_url": "https://api.github.com/users/rmi7/following{/other_user}",
      "gists_url": "https://api.github.com/users/rmi7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rmi7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rmi7/subscriptions",
      "organizations_url": "https://api.github.com/users/rmi7/orgs",
      "repos_url": "https://api.github.com/users/rmi7/repos",
      "events_url": "https://api.github.com/users/rmi7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rmi7/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-30T23:06:57Z",
    "updated_at": "2018-05-30T23:10:50Z",
    "author_association": "NONE",
    "body": "Looks like it yes, \r\n\r\nand no, there is no update to the `networks:` of that file,\r\n\r\nfor all other migrations before this one there is an update to the `networks` section in their json file.\r\n\r\nare there any specific things that I could be doing inside a migration file which would prevent the `networks` section to update?\r\n\r\n**UPDATE** verified that that is indeed my contract, verified and added source code, still leaves the question why `network` is not updated and no output in truffle migration log",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393347891/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393384896",
    "html_url": "https://github.com/trufflesuite/truffle/issues/974#issuecomment-393384896",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/974",
    "id": 393384896,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MzM4NDg5Ng==",
    "user": {
      "login": "michaeljohnbennett",
      "id": 951378,
      "node_id": "MDQ6VXNlcjk1MTM3OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/951378?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaeljohnbennett",
      "html_url": "https://github.com/michaeljohnbennett",
      "followers_url": "https://api.github.com/users/michaeljohnbennett/followers",
      "following_url": "https://api.github.com/users/michaeljohnbennett/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaeljohnbennett/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaeljohnbennett/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaeljohnbennett/subscriptions",
      "organizations_url": "https://api.github.com/users/michaeljohnbennett/orgs",
      "repos_url": "https://api.github.com/users/michaeljohnbennett/repos",
      "events_url": "https://api.github.com/users/michaeljohnbennett/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaeljohnbennett/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-31T02:50:29Z",
    "updated_at": "2018-05-31T02:50:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm getting the same kind of timeout\r\n\r\nit seems it does update my version but still get a timeout.\r\n\r\nMy Versions:\r\n```\r\nTruffle v4.1.8 (core: 4.1.8)\r\nSolidity v0.4.23 (solc-js)\r\ntruffle-wallet-provider@0.0.5\r\n```\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393384896/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393387379",
    "html_url": "https://github.com/trufflesuite/truffle/issues/974#issuecomment-393387379",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/974",
    "id": 393387379,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MzM4NzM3OQ==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-31T03:08:12Z",
    "updated_at": "2018-05-31T03:08:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "@michaeljohnbennett The timeout problem should be fixed in 4.1.11 - recent changes to a dependency in the wallet provider resulted in commands failing to exit correctly. As a side note - it's now important that you wrap providers in a function in `truffle.js` if you've configured more than one network in your config. See example [here](http://truffleframework.com/docs/advanced/configuration#providers)\r\n\r\n@rmi7 Can you share your `migrations.js` and `truffle.js`? It's possible there's a promise you're not returning to the deployer at the very end of the sequence. ",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393387379/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393390715",
    "html_url": "https://github.com/trufflesuite/truffle/issues/974#issuecomment-393390715",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/974",
    "id": 393390715,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MzM5MDcxNQ==",
    "user": {
      "login": "michaeljohnbennett",
      "id": 951378,
      "node_id": "MDQ6VXNlcjk1MTM3OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/951378?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaeljohnbennett",
      "html_url": "https://github.com/michaeljohnbennett",
      "followers_url": "https://api.github.com/users/michaeljohnbennett/followers",
      "following_url": "https://api.github.com/users/michaeljohnbennett/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaeljohnbennett/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaeljohnbennett/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaeljohnbennett/subscriptions",
      "organizations_url": "https://api.github.com/users/michaeljohnbennett/orgs",
      "repos_url": "https://api.github.com/users/michaeljohnbennett/repos",
      "events_url": "https://api.github.com/users/michaeljohnbennett/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaeljohnbennett/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-31T03:32:33Z",
    "updated_at": "2018-05-31T03:32:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "I cleaned out node_modules and did a reinstall of 4.1.11 and it works. Also globally.\r\n\r\nI am using the lazy initialisation functions for wallet provider functions. \r\n\r\nYou should have that changed on master branch docs as well as its confusing all the variations on this piece caused me a lot of hassle at the beginning.\r\n\r\nThanks so much for you help.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393390715/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393416225",
    "html_url": "https://github.com/trufflesuite/truffle/issues/974#issuecomment-393416225",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/974",
    "id": 393416225,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MzQxNjIyNQ==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-31T06:09:19Z",
    "updated_at": "2018-05-31T06:09:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "Ah ok! Thanks for the tip about the docs, will check that out.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393416225/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393489750",
    "html_url": "https://github.com/trufflesuite/truffle/issues/974#issuecomment-393489750",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/974",
    "id": 393489750,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MzQ4OTc1MA==",
    "user": {
      "login": "rmi7",
      "id": 15264239,
      "node_id": "MDQ6VXNlcjE1MjY0MjM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/15264239?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rmi7",
      "html_url": "https://github.com/rmi7",
      "followers_url": "https://api.github.com/users/rmi7/followers",
      "following_url": "https://api.github.com/users/rmi7/following{/other_user}",
      "gists_url": "https://api.github.com/users/rmi7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rmi7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rmi7/subscriptions",
      "organizations_url": "https://api.github.com/users/rmi7/orgs",
      "repos_url": "https://api.github.com/users/rmi7/repos",
      "events_url": "https://api.github.com/users/rmi7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rmi7/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-31T10:37:59Z",
    "updated_at": "2018-05-31T13:07:48Z",
    "author_association": "NONE",
    "body": "`MyMagicContract.sol` == `ICO.sol` below\r\n\r\nthat didn't fix it for me, still working on ganache + ropsten dry run, but not actual deploy on ropsten, the last migration is the below, the other two contracts I require have been successfully deployed (their `networks: {}` is updated correct in their JSON file) in a separate migration before this one.\r\n\r\nResult =\r\nthe migration console output in the main issue text at the top of this page\r\n**+** \r\nnot getting an updated `networks: {}` section inside `ICO.json`\r\nthe only update in `ICO.sol` is the `updatedAt` value\r\n**+**\r\nthis statement is **not** executed: `  console.log('DEPLOYED ICO', ICO.address, (await ICO.deployed()).address);`\r\n\r\n## Last Migration\r\n```javascript\r\nconst ICO = artifacts.require('./ICO.sol');\r\nconst MyToken = artifacts.require('./MyToken.sol');\r\nconst Membership = artifacts.require('./Membership.sol');\r\n\r\nconst UnixTimestamp = jsTimestamp => (\r\n  Math.floor(jsTimestamp / 1000)\r\n);\r\n\r\nmodule.exports = async (deployer, network, accounts) => {\r\n  // get already deployed MyToken + Membership contracts\r\n  const token = await MyToken.deployed();\r\n  const member = await Membership.deployed();\r\n\r\n  // constructor args for Ico contract\r\n  const rate = 3000;               \r\n  const token = token.address;       \r\n  const tokenWallet = accounts[0]; \r\n  const membership = member.address;\r\n  let ethWallet;\r\n  let startTime;\r\n  let endTime;\r\n\r\n  if (network === 'mainnet') {\r\n    // ETH wallet is separate address\r\n    if (!process.env.ETH_WALLET_ADDRESS) {\r\n      throw new Error('need ETH_WALLET_ADDRESS env var to be set');\r\n    }\r\n    if (!web3.isAddress(process.env.ETH_WALLET_ADDRESS)) {\r\n      throw new Error(`env var ETH_WALLET_ADDRESS is not a vlid ETH address, value: ${process.env.ETH_WALLET_ADDRESS}`);\r\n    }\r\n    ethWallet = process.env.ETH_WALLET_ADDRESS;\r\n\r\n    startTime = 1529146400; \r\n    endTime   = 1535264399; \r\n  } else {\r\n    ethWallet = accounts[0];\r\n\r\n    startTime = UnixTimestamp(Date.now() + 60 * 1000 * 5); // 5 minutes from now\r\n    endTime = UnixTimestamp(Date.now() + 60 * 1000 * 60 * 24 * 14); // 14 days\r\n  }\r\n\r\n  // deploy Ico contract --> GAS USED: 2,291,944\r\n  await deployer.deploy(ICO, startTime, endTime, rate, ethWallet, token, tokenWallet, membership);\r\n  \r\n  console.log('DEPLOYED ICO', ICO.address, (await ICO.deployed()).address);\r\n  const ico = await ICO.deployed();\r\n  \r\n  // allow Ico contract to add members to membership contract\r\n  await member.addAdmin(ico.address);\r\n  \r\n  // get the max amount of tokens that this Ico contract will sell\r\n  // we can later update this to be even bigger if the need arises, using another token.approve from remix\r\n  const MAX_ICO_TOKENS = 14625000; // 19000000 + 150% of 19000000;                                      \r\n  \r\n  // allow Ico contract to transfer MAX_ICO_TOKENS NTS tokens\r\n  await token.approve(ico.address, web3.toWei(MAX_ICO_TOKENS))\r\n};\r\n```\r\n\r\n## `truffle.js`\r\n\r\n```javascript\r\nconst assert = require('assert');\r\nconst HDWalletProvider = require(\"truffle-hdwallet-provider\");\r\n\r\nrequire('dotenv').config({ path: require('path').join(__dirname, '.env') });\r\n\r\nassert(process.env.INFURA_API_TOKEN, 'missing INFURA_API_TOKEN in .env file');\r\nassert(process.env.HD_WALLET_MNEMONIC, 'missing HD_WALLET_MNEMONIC in .env file');\r\n\r\nmodule.exports = {\r\n  networks: {\r\n    development: {\r\n      host: \"localhost\",\r\n      port: 8545,\r\n      network_id: \"*\" // Match any network id\r\n    },\r\n    ropsten: {\r\n      provider: () => new HDWalletProvider(\r\n        process.env.HD_WALLET_MNEMONIC,\r\n        `https://ropsten.infura.io/${process.env.INFURA_API_TOKEN}`,\r\n      ),\r\n      gas: 4700000,\r\n      gasPrice: 17e9,\r\n      network_id: 3,\r\n    },\r\n    mainnet: {\r\n      provider: () => new HDWalletProvider(\r\n        process.env.HD_WALLET_MNEMONIC,\r\n        `https://mainnet.infura.io/${process.env.INFURA_API_TOKEN}`,\r\n      ),\r\n      gas: 5e6, // 5 million\r\n      gasPrice: 10e9, // 10 gwei\r\n      network_id: 1,\r\n    },\r\n  },\r\n};\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393489750/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393551800",
    "html_url": "https://github.com/trufflesuite/truffle/issues/974#issuecomment-393551800",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/974",
    "id": 393551800,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MzU1MTgwMA==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-31T14:37:23Z",
    "updated_at": "2018-05-31T14:37:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "@rmi7 Believe the problem is with async/await which Migrations only supports if it's wrapped in a `deployer.then` block. Apologies for this - Migrations was written before async/await became the norm and 'stages' deployments with it's own promise chain management logic.  (We're in the middle of rewriting that module so this shouldn't be an issue in a few weeks.) \r\n\r\nTLDR; everything should work if you wrap your async/await migrations logic like this:\r\n\r\n```javascript\r\nmodule.exports = function(deployer, network, accounts) {\r\n  deployer.then(async function(){\r\n     ... all your setup / deploys / etc\r\n   })\r\n```\r\n\r\nThere's a nice example of this [here](https://github.com/trufflesuite/truffle/issues/501#issuecomment-373886205) and the issue is being tracked at #501. ",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393551800/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393561260",
    "html_url": "https://github.com/trufflesuite/truffle/issues/974#issuecomment-393561260",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/974",
    "id": 393561260,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MzU2MTI2MA==",
    "user": {
      "login": "rmi7",
      "id": 15264239,
      "node_id": "MDQ6VXNlcjE1MjY0MjM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/15264239?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rmi7",
      "html_url": "https://github.com/rmi7",
      "followers_url": "https://api.github.com/users/rmi7/followers",
      "following_url": "https://api.github.com/users/rmi7/following{/other_user}",
      "gists_url": "https://api.github.com/users/rmi7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rmi7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rmi7/subscriptions",
      "organizations_url": "https://api.github.com/users/rmi7/orgs",
      "repos_url": "https://api.github.com/users/rmi7/repos",
      "events_url": "https://api.github.com/users/rmi7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rmi7/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-31T15:05:34Z",
    "updated_at": "2018-05-31T15:05:34Z",
    "author_association": "NONE",
    "body": "thanks @cgewecke, amazing that does it!!!\r\n\r\nüéáüòé‚òÑÔ∏è",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/393561260/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 2,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/394307518",
    "html_url": "https://github.com/trufflesuite/truffle/issues/974#issuecomment-394307518",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/974",
    "id": 394307518,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NDMwNzUxOA==",
    "user": {
      "login": "rmi7",
      "id": 15264239,
      "node_id": "MDQ6VXNlcjE1MjY0MjM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/15264239?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rmi7",
      "html_url": "https://github.com/rmi7",
      "followers_url": "https://api.github.com/users/rmi7/followers",
      "following_url": "https://api.github.com/users/rmi7/following{/other_user}",
      "gists_url": "https://api.github.com/users/rmi7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rmi7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rmi7/subscriptions",
      "organizations_url": "https://api.github.com/users/rmi7/orgs",
      "repos_url": "https://api.github.com/users/rmi7/repos",
      "events_url": "https://api.github.com/users/rmi7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rmi7/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-04T10:25:31Z",
    "updated_at": "2018-06-04T10:25:31Z",
    "author_association": "NONE",
    "body": "also relevant: https://github.com/trufflesuite/truffle-migrate/issues/29#issuecomment-389649903",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/394307518/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
