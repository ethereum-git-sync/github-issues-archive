{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/1817",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1817/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1817/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1817/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/1817",
  "id": 421006480,
  "node_id": "MDU6SXNzdWU0MjEwMDY0ODA=",
  "number": 1817,
  "title": "Truffle Test Not Working With Solidity v0.4.24",
  "user": {
    "login": "timbeiko",
    "id": 9390255,
    "node_id": "MDQ6VXNlcjkzOTAyNTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9390255?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/timbeiko",
    "html_url": "https://github.com/timbeiko",
    "followers_url": "https://api.github.com/users/timbeiko/followers",
    "following_url": "https://api.github.com/users/timbeiko/following{/other_user}",
    "gists_url": "https://api.github.com/users/timbeiko/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/timbeiko/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/timbeiko/subscriptions",
    "organizations_url": "https://api.github.com/users/timbeiko/orgs",
    "repos_url": "https://api.github.com/users/timbeiko/repos",
    "events_url": "https://api.github.com/users/timbeiko/events{/privacy}",
    "received_events_url": "https://api.github.com/users/timbeiko/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 971535345,
      "node_id": "MDU6TGFiZWw5NzE1MzUzNDU=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/Fixed",
      "name": "Fixed",
      "color": "40c989",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2019-03-14T13:04:48Z",
  "updated_at": "2019-03-22T16:52:25Z",
  "closed_at": "2019-03-21T19:57:38Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "- [x] I've asked for help in the [Truffle Gitter](http://gitter.im/Consensys/truffle) before filing this issue.\r\n\r\n---------------------------\r\n\r\n## Issue\r\nQuoted from a [StackOverflow post I opened](https://ethereum.stackexchange.com/questions/68223/truffle-test-issue-with-address-payable-and-compiler-version), and posted here after being asked by @gnidan on Gitter.\r\n\r\n> I am trying to run truffle test on an old contract which was written using pragma solidity 0.4.24;. While I am able to deploy the contracts using truffle migrate, I get the following error when running truffle test:\r\n\r\n```\r\nUsing network 'development'.\r\n\r\n\r\nCompiling your contracts...\r\n===========================\r\nError: CompileError: Error parsing truffle/DeployedAddresses.sol: ParsedContract.sol:4:55: ParserError: Expected ',' but got 'payable'\r\n  function Marketplace() public pure returns (address payable) { return 0x6395927945EA39aDD6B1E04144f1e1324B30DeFC; }\r\n                                                      ^-----^\r\nCompilation failed. See above.\r\n    at async.whilst.error (/usr/local/lib/node_modules/truffle/build/webpack:/packages/truffle-compile/profiler.js:369:1)\r\n    at /usr/local/lib/node_modules/truffle/build/webpack:/~/async/dist/async.js:969:1\r\n    at next (/usr/local/lib/node_modules/truffle/build/webpack:/~/async/dist/async.js:5222:1)\r\n    at Promise.all.then.results (/usr/local/lib/node_modules/truffle/build/webpack:/packages/truffle-compile/profiler.js:351:1)\r\n    at <anonymous>\r\nTruffle v5.0.7 (core: 5.0.7)\r\nNode v8.12.0\r\n```\r\n> `truffle/DeployedAddresses.sol: ParsedContract.sol:4:55` is not code I've written, nor is it part of my project. I suspect this error may be caused because Truffle is running solidity 0.4.24 to compile my contracts but that whatever it uses to execute internal tests is running solidity 0.5. Is there a way to verify/change this?\r\n\r\n> Here are the contents of `truffle.js` in the main directory:\r\n\r\n```\r\nmodule.exports = {\r\n  migrations_directory: \"./migrations\",\r\n  networks: {\r\n    development: {\r\n      host: \"localhost\",\r\n      port: 8545,\r\n      network_id: \"*\" // Match any network id\r\n    }, \r\n // ... Other configs specified here, removed because irrelevant\r\n // to SO question ... \r\n compilers: {\r\n  solc: {\r\n    version: \"0.4.24\",  \r\n    }\r\n  },\r\n  solc: {\r\n    optimizer: {\r\n      enabled: true,\r\n      runs: 500\r\n    }\r\n  } \r\n};\r\n```\r\n> and the contents of `truffle.js` under `/test`:\r\n\r\n```\r\nmodule.exports = {\r\n  // See <http://truffleframework.com/docs/advanced/configuration>\r\n  // for more about customizing your Truffle configuration!\r\n  networks: {\r\n    development: {\r\n      host: \"127.0.0.1\",\r\n      port: 7545,\r\n      network_id: \"*\" // Match any network id\r\n    }\r\n  }, \r\n  compilers: {\r\n  solc: {\r\n    version: \"0.4.24\",  \r\n    }\r\n  }\r\n};\r\n```\r\n\r\nWhile `truffle test` does not work, `truffle migrate` works fine both to deploy locally and to the Rinkeby testnet, so this does not seem to be an error with the Solidity code. Prior to Solidity v0.5.0, the tests ran fine. I considered upgrading my contracts to v0.5.0, but realized they imported several Zeppelin contracts which had `pragma ^0.4.11`.  I had both `.js` and `.sol` tests and neither worked, even when running single files. \r\n\r\n## Steps to Reproduce\r\n\r\n1. Write a contract using `pragma 0.4.xx` as the solidity version. \r\n2. Set the `compilers:solc` version to `0.4.xx` in `truffle.js`\r\n3. Write tests for the contract in (1)\r\n4. Try to run `truffle test` \r\n\r\n**OR**\r\n\r\n1. Git clone [this branch](https://github.com/timbeiko/solidity-marketplace/tree/solidity5) for my project\r\n2. Run `truffle test` from inside the main directory\r\n\r\n## Expected Behavior\r\n\r\n`truffle test` runs the tests.\r\n\r\n## Actual Results\r\n\r\nSee above. \r\n\r\n## Environment\r\n\r\n* Operating System: Mac OSx\r\n* Ethereum client: Ganache\r\n* Truffle version (`truffle version`): \r\n```\r\nTruffle v5.0.7 (core: 5.0.7)\r\nSolidity v0.5.0 (solc-js)\r\nNode v8.12.0\r\n```\r\n* node version (`node --version`): v8.12.0\r\n* npm version (`npm --version`): 6.4.1\r\n",
  "closed_by": {
    "login": "CruzMolina",
    "id": 7537712,
    "node_id": "MDQ6VXNlcjc1Mzc3MTI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7537712?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/CruzMolina",
    "html_url": "https://github.com/CruzMolina",
    "followers_url": "https://api.github.com/users/CruzMolina/followers",
    "following_url": "https://api.github.com/users/CruzMolina/following{/other_user}",
    "gists_url": "https://api.github.com/users/CruzMolina/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/CruzMolina/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/CruzMolina/subscriptions",
    "organizations_url": "https://api.github.com/users/CruzMolina/orgs",
    "repos_url": "https://api.github.com/users/CruzMolina/repos",
    "events_url": "https://api.github.com/users/CruzMolina/events{/privacy}",
    "received_events_url": "https://api.github.com/users/CruzMolina/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/1817/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1817/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/472925301",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1817#issuecomment-472925301",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1817",
    "id": 472925301,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MjkyNTMwMQ==",
    "user": {
      "login": "CruzMolina",
      "id": 7537712,
      "node_id": "MDQ6VXNlcjc1Mzc3MTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7537712?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CruzMolina",
      "html_url": "https://github.com/CruzMolina",
      "followers_url": "https://api.github.com/users/CruzMolina/followers",
      "following_url": "https://api.github.com/users/CruzMolina/following{/other_user}",
      "gists_url": "https://api.github.com/users/CruzMolina/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CruzMolina/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CruzMolina/subscriptions",
      "organizations_url": "https://api.github.com/users/CruzMolina/orgs",
      "repos_url": "https://api.github.com/users/CruzMolina/repos",
      "events_url": "https://api.github.com/users/CruzMolina/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CruzMolina/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-14T15:40:36Z",
    "updated_at": "2019-03-14T15:40:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hey @timbeiko ! Thanks for raising this. Currently working on a fix üëç ",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/472925301/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 2,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/475379798",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1817#issuecomment-475379798",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1817",
    "id": 475379798,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTM3OTc5OA==",
    "user": {
      "login": "CruzMolina",
      "id": 7537712,
      "node_id": "MDQ6VXNlcjc1Mzc3MTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7537712?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CruzMolina",
      "html_url": "https://github.com/CruzMolina",
      "followers_url": "https://api.github.com/users/CruzMolina/followers",
      "following_url": "https://api.github.com/users/CruzMolina/following{/other_user}",
      "gists_url": "https://api.github.com/users/CruzMolina/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CruzMolina/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CruzMolina/subscriptions",
      "organizations_url": "https://api.github.com/users/CruzMolina/orgs",
      "repos_url": "https://api.github.com/users/CruzMolina/repos",
      "events_url": "https://api.github.com/users/CruzMolina/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CruzMolina/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-21T19:57:38Z",
    "updated_at": "2019-03-21T19:58:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "Closing as this has been merged via #1820 & released in truffle `5.0.9`.\r\n\r\nPlease let us know if it works on your end!\r\n\r\nThanks for raising the issue @timbeiko !",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/475379798/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/475612850",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1817#issuecomment-475612850",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1817",
    "id": 475612850,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTYxMjg1MA==",
    "user": {
      "login": "timbeiko",
      "id": 9390255,
      "node_id": "MDQ6VXNlcjkzOTAyNTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9390255?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/timbeiko",
      "html_url": "https://github.com/timbeiko",
      "followers_url": "https://api.github.com/users/timbeiko/followers",
      "following_url": "https://api.github.com/users/timbeiko/following{/other_user}",
      "gists_url": "https://api.github.com/users/timbeiko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/timbeiko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/timbeiko/subscriptions",
      "organizations_url": "https://api.github.com/users/timbeiko/orgs",
      "repos_url": "https://api.github.com/users/timbeiko/repos",
      "events_url": "https://api.github.com/users/timbeiko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/timbeiko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-22T13:03:06Z",
    "updated_at": "2019-03-22T13:03:06Z",
    "author_association": "NONE",
    "body": "@CruzMolina just updated and my tests work again üòÑ Thank you for the rapid turnaround üí™üèªThere are some tests that used to pass but don't anymore, giving messages such as the ones attached, but I'll investigate those separately. \r\n\r\n<img width=\"582\" alt=\"Screen Shot 2019-03-22 at 9 02 19 AM\" src=\"https://user-images.githubusercontent.com/9390255/54824429-45f9c600-4c81-11e9-8513-d4984d7fdb6d.png\">\r\n<img width=\"426\" alt=\"Screen Shot 2019-03-22 at 9 02 56 AM\" src=\"https://user-images.githubusercontent.com/9390255/54824438-4befa700-4c81-11e9-98b1-75f548932470.png\">\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/475612850/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/475696082",
    "html_url": "https://github.com/trufflesuite/truffle/issues/1817#issuecomment-475696082",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/1817",
    "id": 475696082,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3NTY5NjA4Mg==",
    "user": {
      "login": "CruzMolina",
      "id": 7537712,
      "node_id": "MDQ6VXNlcjc1Mzc3MTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7537712?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CruzMolina",
      "html_url": "https://github.com/CruzMolina",
      "followers_url": "https://api.github.com/users/CruzMolina/followers",
      "following_url": "https://api.github.com/users/CruzMolina/following{/other_user}",
      "gists_url": "https://api.github.com/users/CruzMolina/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CruzMolina/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CruzMolina/subscriptions",
      "organizations_url": "https://api.github.com/users/CruzMolina/orgs",
      "repos_url": "https://api.github.com/users/CruzMolina/repos",
      "events_url": "https://api.github.com/users/CruzMolina/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CruzMolina/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-22T16:52:25Z",
    "updated_at": "2019-03-22T16:52:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "@timbeiko Great! Yes, there were a couple breaking changes in truffle v5, particularly in regards to tests.\r\n\r\nThose errors in particular seem to be in regards to changes to web3 1.0 0x bytes representation & a change to the revert error message.\r\n\r\nIf anything suspicious comes up, feel free to comment or open up another issue!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/475696082/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
