{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/2567",
  "id": 519222655,
  "node_id": "MDU6SXNzdWU1MTkyMjI2NTU=",
  "number": 2567,
  "title": "Add subscription support for @truffle/hdwallet-provider",
  "user": {
    "login": "MrRefactoring",
    "id": 10329528,
    "node_id": "MDQ6VXNlcjEwMzI5NTI4",
    "avatar_url": "https://avatars.githubusercontent.com/u/10329528?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/MrRefactoring",
    "html_url": "https://github.com/MrRefactoring",
    "followers_url": "https://api.github.com/users/MrRefactoring/followers",
    "following_url": "https://api.github.com/users/MrRefactoring/following{/other_user}",
    "gists_url": "https://api.github.com/users/MrRefactoring/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/MrRefactoring/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/MrRefactoring/subscriptions",
    "organizations_url": "https://api.github.com/users/MrRefactoring/orgs",
    "repos_url": "https://api.github.com/users/MrRefactoring/repos",
    "events_url": "https://api.github.com/users/MrRefactoring/events{/privacy}",
    "received_events_url": "https://api.github.com/users/MrRefactoring/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 230393326,
      "node_id": "MDU6TGFiZWwyMzAzOTMzMjY=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    },
    {
      "id": 230393329,
      "node_id": "MDU6TGFiZWwyMzAzOTMzMjk=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/help%20wanted",
      "name": "help wanted",
      "color": "159818",
      "default": true,
      "description": null
    },
    {
      "id": 644098328,
      "node_id": "MDU6TGFiZWw2NDQwOTgzMjg=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/needs%20reproduced",
      "name": "needs reproduced",
      "color": "fbca04",
      "default": false,
      "description": null
    },
    {
      "id": 1403343142,
      "node_id": "MDU6TGFiZWwxNDAzMzQzMTQy",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/needs%20investigated",
      "name": "needs investigated",
      "color": "b7410e",
      "default": false,
      "description": ""
    },
    {
      "id": 1675042518,
      "node_id": "MDU6TGFiZWwxNjc1MDQyNTE4",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/priority6%20%F0%9F%92%AD",
      "name": "priority6 ðŸ’­",
      "color": "006b75",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 14,
  "created_at": "2019-11-07T11:58:34Z",
  "updated_at": "2022-03-06T21:50:31Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "- [ ] I've asked for help in the [Truffle Gitter](http://gitter.im/Consensys/truffle) before filing this issue.\r\n\r\n---------------------------\r\n\r\n## Issue\r\n\r\nWhat the issue is, in broad strokes.\r\n\r\n## Steps to Reproduce\r\n\r\nAdd HDWalletProvider to drizzle store\r\n\r\n## Expected Behavior\r\n\r\nDrizzle successful subscribed to events\r\n\r\n## Actual Results\r\n\r\n![subscriptions problem](https://user-images.githubusercontent.com/10329528/68387283-0bd92800-016f-11ea-801c-0f5de2b44267.PNG)\r\n\r\n## Environment\r\n\r\n* Operating System: Win 10\r\n* Ethereum client: N/A\r\n* Truffle version (`truffle version`): v5.0.43\r\n* node version (`node --version`): 10.17.0\r\n* npm version (`npm --version`): 6.11.3\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/551140678",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2567#issuecomment-551140678",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567",
    "id": 551140678,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1MTE0MDY3OA==",
    "user": {
      "login": "gnidan",
      "id": 151065,
      "node_id": "MDQ6VXNlcjE1MTA2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnidan",
      "html_url": "https://github.com/gnidan",
      "followers_url": "https://api.github.com/users/gnidan/followers",
      "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
      "organizations_url": "https://api.github.com/users/gnidan/orgs",
      "repos_url": "https://api.github.com/users/gnidan/repos",
      "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnidan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-07T15:54:50Z",
    "updated_at": "2019-11-07T15:54:50Z",
    "author_association": "MEMBER",
    "body": "Hm, sounds like this is a Drizzle issue, for https://github.com/trufflesuite/drizzle/issues",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/551140678/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/551634152",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2567#issuecomment-551634152",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567",
    "id": 551634152,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1MTYzNDE1Mg==",
    "user": {
      "login": "MrRefactoring",
      "id": 10329528,
      "node_id": "MDQ6VXNlcjEwMzI5NTI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/10329528?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MrRefactoring",
      "html_url": "https://github.com/MrRefactoring",
      "followers_url": "https://api.github.com/users/MrRefactoring/followers",
      "following_url": "https://api.github.com/users/MrRefactoring/following{/other_user}",
      "gists_url": "https://api.github.com/users/MrRefactoring/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MrRefactoring/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MrRefactoring/subscriptions",
      "organizations_url": "https://api.github.com/users/MrRefactoring/orgs",
      "repos_url": "https://api.github.com/users/MrRefactoring/repos",
      "events_url": "https://api.github.com/users/MrRefactoring/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MrRefactoring/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-08T11:35:40Z",
    "updated_at": "2019-11-08T11:35:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "I am afraid that if I inherit from ProviderEngine this problem will be solved",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/551634152/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/553541589",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2567#issuecomment-553541589",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567",
    "id": 553541589,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1MzU0MTU4OQ==",
    "user": {
      "login": "fainashalts",
      "id": 8952139,
      "node_id": "MDQ6VXNlcjg5NTIxMzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8952139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fainashalts",
      "html_url": "https://github.com/fainashalts",
      "followers_url": "https://api.github.com/users/fainashalts/followers",
      "following_url": "https://api.github.com/users/fainashalts/following{/other_user}",
      "gists_url": "https://api.github.com/users/fainashalts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fainashalts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fainashalts/subscriptions",
      "organizations_url": "https://api.github.com/users/fainashalts/orgs",
      "repos_url": "https://api.github.com/users/fainashalts/repos",
      "events_url": "https://api.github.com/users/fainashalts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fainashalts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-13T18:37:16Z",
    "updated_at": "2019-11-13T18:37:16Z",
    "author_association": "MEMBER",
    "body": "Hi @MrRefactoring! I don't totally understand what you mean about ProviderEngine, can you clarify? Do you mean instead of accessing HDWalletProvider directly?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/553541589/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/554327833",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2567#issuecomment-554327833",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567",
    "id": 554327833,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDMyNzgzMw==",
    "user": {
      "login": "MrRefactoring",
      "id": 10329528,
      "node_id": "MDQ6VXNlcjEwMzI5NTI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/10329528?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MrRefactoring",
      "html_url": "https://github.com/MrRefactoring",
      "followers_url": "https://api.github.com/users/MrRefactoring/followers",
      "following_url": "https://api.github.com/users/MrRefactoring/following{/other_user}",
      "gists_url": "https://api.github.com/users/MrRefactoring/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MrRefactoring/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MrRefactoring/subscriptions",
      "organizations_url": "https://api.github.com/users/MrRefactoring/orgs",
      "repos_url": "https://api.github.com/users/MrRefactoring/repos",
      "events_url": "https://api.github.com/users/MrRefactoring/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MrRefactoring/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-15T11:39:01Z",
    "updated_at": "2019-11-15T11:39:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think that HDWalletProvider should inherit ProviderEngine, and not write an adapter for it",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/554327833/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/559211574",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2567#issuecomment-559211574",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567",
    "id": 559211574,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1OTIxMTU3NA==",
    "user": {
      "login": "gnidan",
      "id": 151065,
      "node_id": "MDQ6VXNlcjE1MTA2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnidan",
      "html_url": "https://github.com/gnidan",
      "followers_url": "https://api.github.com/users/gnidan/followers",
      "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
      "organizations_url": "https://api.github.com/users/gnidan/orgs",
      "repos_url": "https://api.github.com/users/gnidan/repos",
      "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnidan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-27T18:55:06Z",
    "updated_at": "2019-11-27T18:55:06Z",
    "author_association": "MEMBER",
    "body": "I'm generally opposed to inheritance in favor of composition, but that seems like an implementation detail. Is there more information about what is causing this not to work? Thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/559211574/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/574803585",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2567#issuecomment-574803585",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567",
    "id": 574803585,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NDgwMzU4NQ==",
    "user": {
      "login": "gnidan",
      "id": 151065,
      "node_id": "MDQ6VXNlcjE1MTA2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnidan",
      "html_url": "https://github.com/gnidan",
      "followers_url": "https://api.github.com/users/gnidan/followers",
      "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
      "organizations_url": "https://api.github.com/users/gnidan/orgs",
      "repos_url": "https://api.github.com/users/gnidan/repos",
      "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnidan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-15T19:01:23Z",
    "updated_at": "2020-01-15T19:01:23Z",
    "author_association": "MEMBER",
    "body": "Hey @MrRefactoring or maybe @adrianmcli, could either of you lend any clarity to this issue? Thanks in advance!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/574803585/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/574812110",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2567#issuecomment-574812110",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567",
    "id": 574812110,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NDgxMjExMA==",
    "user": {
      "login": "MrRefactoring",
      "id": 10329528,
      "node_id": "MDQ6VXNlcjEwMzI5NTI4",
      "avatar_url": "https://avatars.githubusercontent.com/u/10329528?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MrRefactoring",
      "html_url": "https://github.com/MrRefactoring",
      "followers_url": "https://api.github.com/users/MrRefactoring/followers",
      "following_url": "https://api.github.com/users/MrRefactoring/following{/other_user}",
      "gists_url": "https://api.github.com/users/MrRefactoring/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MrRefactoring/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MrRefactoring/subscriptions",
      "organizations_url": "https://api.github.com/users/MrRefactoring/orgs",
      "repos_url": "https://api.github.com/users/MrRefactoring/repos",
      "events_url": "https://api.github.com/users/MrRefactoring/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MrRefactoring/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-15T19:14:54Z",
    "updated_at": "2020-01-15T19:14:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "@gnidan I'm busy at work so far, I canâ€™t see this issue, sorry :(",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/574812110/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/623530229",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2567#issuecomment-623530229",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567",
    "id": 623530229,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMzUzMDIyOQ==",
    "user": {
      "login": "mikec",
      "id": 3124707,
      "node_id": "MDQ6VXNlcjMxMjQ3MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3124707?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mikec",
      "html_url": "https://github.com/mikec",
      "followers_url": "https://api.github.com/users/mikec/followers",
      "following_url": "https://api.github.com/users/mikec/following{/other_user}",
      "gists_url": "https://api.github.com/users/mikec/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mikec/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mikec/subscriptions",
      "organizations_url": "https://api.github.com/users/mikec/orgs",
      "repos_url": "https://api.github.com/users/mikec/repos",
      "events_url": "https://api.github.com/users/mikec/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mikec/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-04T15:23:58Z",
    "updated_at": "2020-05-04T15:23:58Z",
    "author_association": "NONE",
    "body": "The issue is that HDWalletProvider does not have an `on()` function, so web3 assumes no subscription support and throws an error. `Web3.providers.WebsocketProvider` implements `.on()` and supports subscription callbacks. HDWalletProvider uses WebsocketProvider when rpcUrl has `ws:` or `wss:`, but it's added via `web3-provider-engine`, which also doesn't support subscriptions by implementing `on()`. web3 looks for the `on()` function on the top level provider (HDWalletProvider) and can't find it.\r\n\r\nHere's the monkey patched workaround I'm using:\r\n\r\n```js\r\nconst Web3 = require('web3')\r\nconst HDWalletProvider = require('@truffle/hdwallet-provider')\r\n\r\nconst rpcUrl = 'http://localhost:8545'\r\nconst mnemonic = 'monkey patch bad ...'\r\n\r\nconst wsProvider = new Web3.providers.WebsocketProvider(rpcUrl)\r\nHDWalletProvider.prototype.on = wsProvider.on.bind(wsProvider)\r\nconst provider = new HDWalletProvider(mnemonic, wsProvider)\r\n\r\nconst web3 = new Web3(provider)\r\n\r\n// subscribe callbacks should work now\r\nweb3.eth.subscribe('newBlockHeaders', (error, block) => console.log(error || block))\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/623530229/reactions",
      "total_count": 12,
      "+1": 12,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/866934476",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2567#issuecomment-866934476",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567",
    "id": 866934476,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2NjkzNDQ3Ng==",
    "user": {
      "login": "MohamedLEGH",
      "id": 15138914,
      "node_id": "MDQ6VXNlcjE1MTM4OTE0",
      "avatar_url": "https://avatars.githubusercontent.com/u/15138914?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MohamedLEGH",
      "html_url": "https://github.com/MohamedLEGH",
      "followers_url": "https://api.github.com/users/MohamedLEGH/followers",
      "following_url": "https://api.github.com/users/MohamedLEGH/following{/other_user}",
      "gists_url": "https://api.github.com/users/MohamedLEGH/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MohamedLEGH/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MohamedLEGH/subscriptions",
      "organizations_url": "https://api.github.com/users/MohamedLEGH/orgs",
      "repos_url": "https://api.github.com/users/MohamedLEGH/repos",
      "events_url": "https://api.github.com/users/MohamedLEGH/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MohamedLEGH/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-23T15:24:42Z",
    "updated_at": "2021-06-23T15:24:42Z",
    "author_association": "NONE",
    "body": "Hello, any news on this ? Do we still need to do the \"hack\" mentioned above to make HDWalletProvider works with WebSockets ?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/866934476/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/875182973",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2567#issuecomment-875182973",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567",
    "id": 875182973,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NTE4Mjk3Mw==",
    "user": {
      "login": "Idiono-mfon",
      "id": 47476907,
      "node_id": "MDQ6VXNlcjQ3NDc2OTA3",
      "avatar_url": "https://avatars.githubusercontent.com/u/47476907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Idiono-mfon",
      "html_url": "https://github.com/Idiono-mfon",
      "followers_url": "https://api.github.com/users/Idiono-mfon/followers",
      "following_url": "https://api.github.com/users/Idiono-mfon/following{/other_user}",
      "gists_url": "https://api.github.com/users/Idiono-mfon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Idiono-mfon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Idiono-mfon/subscriptions",
      "organizations_url": "https://api.github.com/users/Idiono-mfon/orgs",
      "repos_url": "https://api.github.com/users/Idiono-mfon/repos",
      "events_url": "https://api.github.com/users/Idiono-mfon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Idiono-mfon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-07T00:50:18Z",
    "updated_at": "2021-07-07T00:50:18Z",
    "author_association": "NONE",
    "body": "Monkey patch is great but an official solution will be really appreciated. Thanks",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/875182973/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/881492383",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2567#issuecomment-881492383",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567",
    "id": 881492383,
    "node_id": "IC_kwDOAkfq-c40ioGf",
    "user": {
      "login": "KLM-GIT",
      "id": 21008818,
      "node_id": "MDQ6VXNlcjIxMDA4ODE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/21008818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/KLM-GIT",
      "html_url": "https://github.com/KLM-GIT",
      "followers_url": "https://api.github.com/users/KLM-GIT/followers",
      "following_url": "https://api.github.com/users/KLM-GIT/following{/other_user}",
      "gists_url": "https://api.github.com/users/KLM-GIT/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/KLM-GIT/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KLM-GIT/subscriptions",
      "organizations_url": "https://api.github.com/users/KLM-GIT/orgs",
      "repos_url": "https://api.github.com/users/KLM-GIT/repos",
      "events_url": "https://api.github.com/users/KLM-GIT/events{/privacy}",
      "received_events_url": "https://api.github.com/users/KLM-GIT/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-16T14:28:44Z",
    "updated_at": "2021-07-16T14:28:44Z",
    "author_association": "NONE",
    "body": "Thanks @mikec - monkey patch worked, but agree with @Idiono-mfon that official solution would be better - thanks.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/881492383/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/989896217",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2567#issuecomment-989896217",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567",
    "id": 989896217,
    "node_id": "IC_kwDOAkfq-c47AJ4Z",
    "user": {
      "login": "anibaljasin",
      "id": 14918358,
      "node_id": "MDQ6VXNlcjE0OTE4MzU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/14918358?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/anibaljasin",
      "html_url": "https://github.com/anibaljasin",
      "followers_url": "https://api.github.com/users/anibaljasin/followers",
      "following_url": "https://api.github.com/users/anibaljasin/following{/other_user}",
      "gists_url": "https://api.github.com/users/anibaljasin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/anibaljasin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/anibaljasin/subscriptions",
      "organizations_url": "https://api.github.com/users/anibaljasin/orgs",
      "repos_url": "https://api.github.com/users/anibaljasin/repos",
      "events_url": "https://api.github.com/users/anibaljasin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/anibaljasin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-09T14:20:37Z",
    "updated_at": "2021-12-09T14:20:37Z",
    "author_association": "NONE",
    "body": "> The issue is that HDWalletProvider does not have an `on()` function, so web3 assumes no subscription support and throws an error. `Web3.providers.WebsocketProvider` implements `.on()` and supports subscription callbacks. HDWalletProvider uses WebsocketProvider when rpcUrl has `ws:` or `wss:`, but it's added via `web3-provider-engine`, which also doesn't support subscriptions by implementing `on()`. web3 looks for the `on()` function on the top level provider (HDWalletProvider) and can't find it.\r\n> \r\n> Here's the monkey patched workaround I'm using:\r\n> \r\n> ```js\r\n> const Web3 = require('web3')\r\n> const HDWalletProvider = require('@truffle/hdwallet-provider')\r\n> \r\n> const rpcUrl = 'http://localhost:8545'\r\n> const mnemonic = 'monkey patch bad ...'\r\n> \r\n> const wsProvider = new Web3.providers.WebsocketProvider(rpcUrl)\r\n> HDWalletProvider.prototype.on = wsProvider.on.bind(wsProvider)\r\n> const provider = new HDWalletProvider(mnemonic, wsProvider)\r\n> \r\n> const web3 = new Web3(provider)\r\n> \r\n> // subscribe callbacks should work now\r\n> web3.eth.subscribe('newBlockHeaders', (error, block) => console.log(error || block))\r\n> ```\r\n\r\nThis workaround doesn't work for when trying to use an rpc from velas network like these `https://mainnet.velas.com/rpc`, `wss://api.velas.com`. I get this error:\r\n```\r\nError: connection not open on send()\r\n```\r\n\r\nDo you know if this is related to my rpc provider? or if it is related to `HDWalletProvider`?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/989896217/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1012486539",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2567#issuecomment-1012486539",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567",
    "id": 1012486539,
    "node_id": "IC_kwDOAkfq-c48WVGL",
    "user": {
      "login": "HassanAmed",
      "id": 38535048,
      "node_id": "MDQ6VXNlcjM4NTM1MDQ4",
      "avatar_url": "https://avatars.githubusercontent.com/u/38535048?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/HassanAmed",
      "html_url": "https://github.com/HassanAmed",
      "followers_url": "https://api.github.com/users/HassanAmed/followers",
      "following_url": "https://api.github.com/users/HassanAmed/following{/other_user}",
      "gists_url": "https://api.github.com/users/HassanAmed/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/HassanAmed/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/HassanAmed/subscriptions",
      "organizations_url": "https://api.github.com/users/HassanAmed/orgs",
      "repos_url": "https://api.github.com/users/HassanAmed/repos",
      "events_url": "https://api.github.com/users/HassanAmed/events{/privacy}",
      "received_events_url": "https://api.github.com/users/HassanAmed/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-13T20:21:46Z",
    "updated_at": "2022-01-13T20:21:46Z",
    "author_association": "NONE",
    "body": "It would be nice to have this feature. Is someone working on this? ",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1012486539/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1019087062",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2567#issuecomment-1019087062",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2567",
    "id": 1019087062,
    "node_id": "IC_kwDOAkfq-c48vgjW",
    "user": {
      "login": "Jntmkk",
      "id": 55786908,
      "node_id": "MDQ6VXNlcjU1Nzg2OTA4",
      "avatar_url": "https://avatars.githubusercontent.com/u/55786908?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Jntmkk",
      "html_url": "https://github.com/Jntmkk",
      "followers_url": "https://api.github.com/users/Jntmkk/followers",
      "following_url": "https://api.github.com/users/Jntmkk/following{/other_user}",
      "gists_url": "https://api.github.com/users/Jntmkk/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Jntmkk/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Jntmkk/subscriptions",
      "organizations_url": "https://api.github.com/users/Jntmkk/orgs",
      "repos_url": "https://api.github.com/users/Jntmkk/repos",
      "events_url": "https://api.github.com/users/Jntmkk/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Jntmkk/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-22T07:49:42Z",
    "updated_at": "2022-01-22T07:49:42Z",
    "author_association": "NONE",
    "body": "> The issue is that HDWalletProvider does not have an `on()` function, so web3 assumes no subscription support and throws an error. `Web3.providers.WebsocketProvider` implements `.on()` and supports subscription callbacks. HDWalletProvider uses WebsocketProvider when rpcUrl has `ws:` or `wss:`, but it's added via `web3-provider-engine`, which also doesn't support subscriptions by implementing `on()`. web3 looks for the `on()` function on the top level provider (HDWalletProvider) and can't find it.\r\n> \r\n> Here's the monkey patched workaround I'm using:\r\n> \r\n> ```js\r\n> const Web3 = require('web3')\r\n> const HDWalletProvider = require('@truffle/hdwallet-provider')\r\n> \r\n> const rpcUrl = 'http://localhost:8545'\r\n> const mnemonic = 'monkey patch bad ...'\r\n> \r\n> const wsProvider = new Web3.providers.WebsocketProvider(rpcUrl)\r\n> HDWalletProvider.prototype.on = wsProvider.on.bind(wsProvider)\r\n> const provider = new HDWalletProvider(mnemonic, wsProvider)\r\n> \r\n> const web3 = new Web3(provider)\r\n> \r\n> // subscribe callbacks should work now\r\n> web3.eth.subscribe('newBlockHeaders', (error, block) => console.log(error || block))\r\n> ```\r\n\r\nWhen using the above method to solve the websocket problem, it will cause the command \"truffle migration\" to fail and keep waiting for the block to complete, remove the above settings and revert to the previous method can be solved, change back when testing",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1019087062/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
