{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/3288",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3288/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3288/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3288/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/3288",
  "id": 683855882,
  "node_id": "MDU6SXNzdWU2ODM4NTU4ODI=",
  "number": 3288,
  "title": "Suggestion: Support @truffle/contract browser load without \"we will stop injecting web3 in Q4 2020\" warning",
  "user": {
    "login": "wbt",
    "id": 563406,
    "node_id": "MDQ6VXNlcjU2MzQwNg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/563406?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wbt",
    "html_url": "https://github.com/wbt",
    "followers_url": "https://api.github.com/users/wbt/followers",
    "following_url": "https://api.github.com/users/wbt/following{/other_user}",
    "gists_url": "https://api.github.com/users/wbt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wbt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wbt/subscriptions",
    "organizations_url": "https://api.github.com/users/wbt/orgs",
    "repos_url": "https://api.github.com/users/wbt/repos",
    "events_url": "https://api.github.com/users/wbt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wbt/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 230393326,
      "node_id": "MDU6TGFiZWwyMzAzOTMzMjY=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    },
    {
      "id": 1675041996,
      "node_id": "MDU6TGFiZWwxNjc1MDQxOTk2",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/priority4%20%F0%9F%93%8B",
      "name": "priority4 ðŸ“‹",
      "color": "006b75",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2020-08-21T22:20:40Z",
  "updated_at": "2020-10-15T16:11:56Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Issue\r\nWhen loading @truffle/contract [for browser usage](https://github.com/trufflesuite/truffle/tree/master/packages/contract#browser-usage), the following warning is triggered: \r\n\r\n>MetaMask: We will stop injecting web3 in Q4 2020.\r\nPlease see this article for more information: https://medium.com/metamask/no-longer-injecting-web3-js-4a899ad6e59e\r\n\r\n## Steps to Reproduce\r\nCreate the following HTML file:\r\n\r\n````html\r\n<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <title>Truffle-contract loading test</title>\r\n</head>\r\n<body>\r\n    This is just a test to see what happens when loading truffle-contract.<br>\r\n    If you open the console, you will probably see a MetaMask warning\r\n    \"We will stop injecting web3 in Q4 2020.\"\r\n    <script src=\"js/truffle-contract.js\"></script>\r\n</body>\r\n</html>\r\n````\r\n\r\nSet up a local web server (e.g. with Node/Express) to serve this file and /js/truffle-contract.js.  Access the file in a Metamask-enabled browser and open the console.\r\n\r\n## Expected Behavior\r\nIt should be possible to load this Javascript into memory without doing anything, so that the TruffleContract object is available, but there is no MetaMask warning unless/until the script attempts to access an injected global web3.  This permits truffle-contract to be loaded in parallel with other scripts in initial page-load, instead of requiring waiting until after initializing web3 with a provider.\r\n\r\n## Actual Results\r\nTruffleContract is trying to use the globally injected web3 object at the time of loading, triggering that warning. \r\n\r\n## Environment\r\n* Operating System: Windows 10\r\n* Ethereum client: N/A\r\n* @truffle/contract version: 4.2.19 (published 3 days ago)\r\n* Metamask version: 8.0.8\r\n* Browser: Google Chrome 84.0.4147.105Â (Official Build)Â (64-bit)\r\n\r\n\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/3288/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3288/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/681023988",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3288#issuecomment-681023988",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3288",
    "id": 681023988,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4MTAyMzk4OA==",
    "user": {
      "login": "gnidan",
      "id": 151065,
      "node_id": "MDQ6VXNlcjE1MTA2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnidan",
      "html_url": "https://github.com/gnidan",
      "followers_url": "https://api.github.com/users/gnidan/followers",
      "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
      "organizations_url": "https://api.github.com/users/gnidan/orgs",
      "repos_url": "https://api.github.com/users/gnidan/repos",
      "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnidan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-26T17:38:07Z",
    "updated_at": "2020-08-26T17:38:07Z",
    "author_association": "MEMBER",
    "body": "Yep! Should definitely not have that warning. Thanks for the issue @wbt!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/681023988/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/684973750",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3288#issuecomment-684973750",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3288",
    "id": 684973750,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NDk3Mzc1MA==",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-01T16:17:11Z",
    "updated_at": "2020-09-01T16:17:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "I don't think that this should cause a problem once MetaMask stops injecting web3 though the message is annoying. I believe this message comes from Truffle's own web3 dependency which checks to see if there is a global web3 around. In the future I think this will not find a global web3 and not use it.\r\n\r\nIt looks like this should be more of an issue for Drizzle I would think?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/684973750/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/685069834",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3288#issuecomment-685069834",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3288",
    "id": 685069834,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NTA2OTgzNA==",
    "user": {
      "login": "wbt",
      "id": 563406,
      "node_id": "MDQ6VXNlcjU2MzQwNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/563406?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wbt",
      "html_url": "https://github.com/wbt",
      "followers_url": "https://api.github.com/users/wbt/followers",
      "following_url": "https://api.github.com/users/wbt/following{/other_user}",
      "gists_url": "https://api.github.com/users/wbt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wbt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wbt/subscriptions",
      "organizations_url": "https://api.github.com/users/wbt/orgs",
      "repos_url": "https://api.github.com/users/wbt/repos",
      "events_url": "https://api.github.com/users/wbt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wbt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-01T18:58:35Z",
    "updated_at": "2020-09-01T18:58:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "Why does Truffle check to see if there is a global web3 around just when loading the Javascript file?  It should not be doing anything at that time.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/685069834/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/685774947",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3288#issuecomment-685774947",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3288",
    "id": 685774947,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4NTc3NDk0Nw==",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-02T14:30:11Z",
    "updated_at": "2020-09-02T14:30:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "`@truffle/contract` has a dependency on `web3`. At some point `web3` checks to see if there is a global provider. If you follow the stacktrace in the console it will lead you to `web3` code.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/685774947/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/708576565",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3288#issuecomment-708576565",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3288",
    "id": 708576565,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwODU3NjU2NQ==",
    "user": {
      "login": "fainashalts",
      "id": 8952139,
      "node_id": "MDQ6VXNlcjg5NTIxMzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8952139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fainashalts",
      "html_url": "https://github.com/fainashalts",
      "followers_url": "https://api.github.com/users/fainashalts/followers",
      "following_url": "https://api.github.com/users/fainashalts/following{/other_user}",
      "gists_url": "https://api.github.com/users/fainashalts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fainashalts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fainashalts/subscriptions",
      "organizations_url": "https://api.github.com/users/fainashalts/orgs",
      "repos_url": "https://api.github.com/users/fainashalts/repos",
      "events_url": "https://api.github.com/users/fainashalts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fainashalts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-14T18:18:12Z",
    "updated_at": "2020-10-14T18:18:12Z",
    "author_association": "MEMBER",
    "body": "Looking into this, we don't believe there will be an issue on the Truffle side from removing the warning. There may be problems from the Drizzle side of things. Do you have any thoughts @cds-amal? ",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/708576565/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/709432071",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3288#issuecomment-709432071",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3288",
    "id": 709432071,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwOTQzMjA3MQ==",
    "user": {
      "login": "wbt",
      "id": 563406,
      "node_id": "MDQ6VXNlcjU2MzQwNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/563406?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wbt",
      "html_url": "https://github.com/wbt",
      "followers_url": "https://api.github.com/users/wbt/followers",
      "following_url": "https://api.github.com/users/wbt/following{/other_user}",
      "gists_url": "https://api.github.com/users/wbt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wbt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wbt/subscriptions",
      "organizations_url": "https://api.github.com/users/wbt/orgs",
      "repos_url": "https://api.github.com/users/wbt/repos",
      "events_url": "https://api.github.com/users/wbt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wbt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-15T16:11:56Z",
    "updated_at": "2020-10-15T16:11:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think the best solution to this is that if Web3 is looking for a global provider, that is what should be changed...loading a library module should just define things and not do more. ",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/709432071/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
