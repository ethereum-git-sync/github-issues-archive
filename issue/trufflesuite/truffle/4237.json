{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/4237",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4237/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4237/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4237/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/4237",
  "id": 963120391,
  "node_id": "MDU6SXNzdWU5NjMxMjAzOTE=",
  "number": 4237,
  "title": "Events ignore quiet setting (so e.g. compilation warnings are displayed at inappropriate times)",
  "user": {
    "login": "haltman-at",
    "id": 35589221,
    "node_id": "MDQ6VXNlcjM1NTg5MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/haltman-at",
    "html_url": "https://github.com/haltman-at",
    "followers_url": "https://api.github.com/users/haltman-at/followers",
    "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
    "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
    "organizations_url": "https://api.github.com/users/haltman-at/orgs",
    "repos_url": "https://api.github.com/users/haltman-at/repos",
    "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
    "received_events_url": "https://api.github.com/users/haltman-at/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "eggplantzzz",
    "id": 14827965,
    "node_id": "MDQ6VXNlcjE0ODI3OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/eggplantzzz",
    "html_url": "https://github.com/eggplantzzz",
    "followers_url": "https://api.github.com/users/eggplantzzz/followers",
    "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
    "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
    "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
    "repos_url": "https://api.github.com/users/eggplantzzz/repos",
    "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
    "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2021-08-07T00:49:18Z",
  "updated_at": "2021-08-22T00:52:35Z",
  "closed_at": "2021-08-13T18:28:05Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Issue\r\n\r\nThe events system largely ignores the `quiet` setting.  This causes things to be printed to the console when they shouldn't be.  For instance, if you do `truffle debug --fetch-external`, and the downloaded contract has compilation warnings, you'll see those compilation warnings, even though the debugger makes sure to set `quiet: true` when performing compilation.\r\n\r\nNow, if you look at the code in `events`, you'll notice that there are a number of checks of `this.quiet`.  These checks do work.  But the problem is, `this.quiet` is only set on events system startup!  And often `quiet` is set to true *after* the events system is initialized.  So in order for `quiet` to work, somehow the event system would have to know that `quiet` was now true!\r\n\r\nBasically, the `quiet` option in the events system doesn't currently achieve the goal of letting us use `quiet: true` in the way we normally would.\r\n\r\nA possible stopgap would be to add manual `quiet` checks before emitting such events, but obviously that's not a great solution.  (Or maybe it's the right solution after all?  IDK.)\r\n\r\nAnother thing we could do for now is to re-initialize the events system everywhere that we set `quiet: true` after the events system has been initialized. Whee. :-/\r\n\r\nA third thing we could do for now would be to, everywhere we set `quiet: true` after the events system has been initialized, reach into the events system and manually set *its* `quiet` to true, assuming that's possible... :-/\r\n\r\nSo uh yeah none of this seems great but we ought to do *something* because right now starting up the debugger can show you compiler warnings.\r\n\r\n## Steps to Reproduce\r\n\r\nAs an example, try debugging mainnet transaction 0x4e67f687fbec1989df366e3a4b6a25e8b62bca8db80afe90918dcc8fbe425ec7 (the same one from #4235) with `--fetch-external`.  You'll see compilation warnings displayed as the debugger starts up.  Those shouldn't be shown during debugger startup.\r\n\r\n## Environment\r\n\r\n* Truffle version (`truffle version`): 5.4.5",
  "closed_by": {
    "login": "haltman-at",
    "id": 35589221,
    "node_id": "MDQ6VXNlcjM1NTg5MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/haltman-at",
    "html_url": "https://github.com/haltman-at",
    "followers_url": "https://api.github.com/users/haltman-at/followers",
    "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
    "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
    "organizations_url": "https://api.github.com/users/haltman-at/orgs",
    "repos_url": "https://api.github.com/users/haltman-at/repos",
    "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
    "received_events_url": "https://api.github.com/users/haltman-at/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/4237/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4237/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/897111107",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4237#issuecomment-897111107",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4237",
    "id": 897111107,
    "node_id": "IC_kwDOAkfq-c41eNRD",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-11T19:59:32Z",
    "updated_at": "2021-08-11T19:59:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks @haltman-at. Yeah, so the events system gets re-initialized every time a new config is loaded but, like you mentioned, it looks like the value of `quiet` must change without re-initializing a new config. The events system has a method for hooking into the settings called [`updateSubscriberOptions`](https://github.com/trufflesuite/truffle/blob/develop/packages/events/EventManager.js#L45-L49) that we can use to update the system. Fix incoming!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/897111107/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/897691811",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4237#issuecomment-897691811",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4237",
    "id": 897691811,
    "node_id": "IC_kwDOAkfq-c41gbCj",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-12T14:33:55Z",
    "updated_at": "2021-08-12T14:33:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "Actually I think there is a bug in the `with` method for @truffle/config. I don't think the values provided to `with` are getting set correctly in the Subscribers. I fixed this and pushed it up to the `fix/quiet-option` branch, is there any way you could test this out to see if it fixes your problem? Or are there other cases where `quiet` is set without the `with` method?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/897691811/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/898046283",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4237#issuecomment-898046283",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4237",
    "id": 898046283,
    "node_id": "IC_kwDOAkfq-c41hxlL",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-12T23:47:46Z",
    "updated_at": "2021-08-12T23:47:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "Good question!  I can only find places where it's set with `with`; I can't find any places where it's set directly.  I'll look a bit more but if I don't comment on the matter again you should assume I didn't find any.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/898046283/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/898047734",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4237#issuecomment-898047734",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4237",
    "id": 898047734,
    "node_id": "IC_kwDOAkfq-c41hx72",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-12T23:51:54Z",
    "updated_at": "2021-08-12T23:51:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "OK yeah as best I can tell, the only places where it's set are all in `core` and all use `with`.\r\n\r\nSpecifically, there's one instance in `debug/compiler.js`, one in `testing/SolidityTest.js`, two in `testing/Test.js`, and one in `testing/TestRunner.js`.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/898047734/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/898644729",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4237#issuecomment-898644729",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4237",
    "id": 898644729,
    "node_id": "IC_kwDOAkfq-c41kDr5",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-13T18:28:05Z",
    "updated_at": "2021-08-13T18:28:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "So uh turns out I was mistaken and this works fine! >_>  Sorry about that...",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/898644729/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
