{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/396",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/396/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/396/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/396/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/396",
  "id": 225402560,
  "node_id": "MDU6SXNzdWUyMjU0MDI1NjA=",
  "number": 396,
  "title": "Ethpm registry package installation fails",
  "user": {
    "login": "elenadimitrova",
    "id": 703848,
    "node_id": "MDQ6VXNlcjcwMzg0OA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/703848?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/elenadimitrova",
    "html_url": "https://github.com/elenadimitrova",
    "followers_url": "https://api.github.com/users/elenadimitrova/followers",
    "following_url": "https://api.github.com/users/elenadimitrova/following{/other_user}",
    "gists_url": "https://api.github.com/users/elenadimitrova/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/elenadimitrova/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/elenadimitrova/subscriptions",
    "organizations_url": "https://api.github.com/users/elenadimitrova/orgs",
    "repos_url": "https://api.github.com/users/elenadimitrova/repos",
    "events_url": "https://api.github.com/users/elenadimitrova/events{/privacy}",
    "received_events_url": "https://api.github.com/users/elenadimitrova/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "tcoulter",
    "id": 92629,
    "node_id": "MDQ6VXNlcjkyNjI5",
    "avatar_url": "https://avatars.githubusercontent.com/u/92629?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tcoulter",
    "html_url": "https://github.com/tcoulter",
    "followers_url": "https://api.github.com/users/tcoulter/followers",
    "following_url": "https://api.github.com/users/tcoulter/following{/other_user}",
    "gists_url": "https://api.github.com/users/tcoulter/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tcoulter/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tcoulter/subscriptions",
    "organizations_url": "https://api.github.com/users/tcoulter/orgs",
    "repos_url": "https://api.github.com/users/tcoulter/repos",
    "events_url": "https://api.github.com/users/tcoulter/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tcoulter/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "tcoulter",
      "id": 92629,
      "node_id": "MDQ6VXNlcjkyNjI5",
      "avatar_url": "https://avatars.githubusercontent.com/u/92629?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tcoulter",
      "html_url": "https://github.com/tcoulter",
      "followers_url": "https://api.github.com/users/tcoulter/followers",
      "following_url": "https://api.github.com/users/tcoulter/following{/other_user}",
      "gists_url": "https://api.github.com/users/tcoulter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tcoulter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tcoulter/subscriptions",
      "organizations_url": "https://api.github.com/users/tcoulter/orgs",
      "repos_url": "https://api.github.com/users/tcoulter/repos",
      "events_url": "https://api.github.com/users/tcoulter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tcoulter/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2017-05-01T08:11:50Z",
  "updated_at": "2017-05-16T20:13:06Z",
  "closed_at": "2017-05-16T20:13:06Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Issue\r\nInstalling the packages below from the ethpm registry fails with `Error: Could not find object at hash 'QmRoUvLLibQVBGVt4NMgWukjtt4TWVQQ12XBwpLFWRbKMm'`\r\n\r\nhttps://www.ethpm.com/registry/packages/25\r\nhttps://www.ethpm.com/registry/packages/8\r\n\r\n## Steps to Reproduce\r\nRun `truffle install zeppelin` or `truffle install mintable-standard-token`\r\n\r\n## Expected Behavior\r\nExpected to install these packages\r\n\r\n## Actual Results\r\n```\r\n$ truffle install zeppelin\r\n$ Error: Could not find object at hash 'QmexsaiGwyqruHyQic2KzWQDgZAFv4qB3MArgahW4WDjbT' in 5000ms\r\n    at Timeout._onTimeout (/.nvm/versions/node/v6.10.0/lib/node_modules/truffle/node_modules/ethpm/lib/hosts/ipfshost.js:47:14)\r\n    at ontimeout (timers.js:365:14)\r\n    at tryOnTimeout (timers.js:237:5)\r\n    at Timer.listOnTimeout (timers.js:207:5)\r\n$ truffle install multisig-wallet\r\n$ truffle install mintable-standard-token\r\nError: Could not find object at hash 'QmRoUvLLibQVBGVt4NMgWukjtt4TWVQQ12XBwpLFWRbKMm' in 5000ms\r\n    at Timeout._onTimeout (/.nvm/versions/node/v6.10.0/lib/node_modules/truffle/node_modules/ethpm/lib/hosts/ipfshost.js:47:14)\r\n    at ontimeout (timers.js:365:14)\r\n    at tryOnTimeout (timers.js:237:5)\r\n    at Timer.listOnTimeout (timers.js:207:5)\r\n```\r\n## Environment\r\n\r\n* Operating System: OSX\r\n* Truffle version: 3.2.1\r\n* node version: 6.10\r\n* npm version: 3.10.10\r\n",
  "closed_by": {
    "login": "tcoulter",
    "id": 92629,
    "node_id": "MDQ6VXNlcjkyNjI5",
    "avatar_url": "https://avatars.githubusercontent.com/u/92629?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tcoulter",
    "html_url": "https://github.com/tcoulter",
    "followers_url": "https://api.github.com/users/tcoulter/followers",
    "following_url": "https://api.github.com/users/tcoulter/following{/other_user}",
    "gists_url": "https://api.github.com/users/tcoulter/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tcoulter/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tcoulter/subscriptions",
    "organizations_url": "https://api.github.com/users/tcoulter/orgs",
    "repos_url": "https://api.github.com/users/tcoulter/repos",
    "events_url": "https://api.github.com/users/tcoulter/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tcoulter/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/396/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/396/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/298354297",
    "html_url": "https://github.com/trufflesuite/truffle/issues/396#issuecomment-298354297",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/396",
    "id": 298354297,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5ODM1NDI5Nw==",
    "user": {
      "login": "tcoulter",
      "id": 92629,
      "node_id": "MDQ6VXNlcjkyNjI5",
      "avatar_url": "https://avatars.githubusercontent.com/u/92629?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tcoulter",
      "html_url": "https://github.com/tcoulter",
      "followers_url": "https://api.github.com/users/tcoulter/followers",
      "following_url": "https://api.github.com/users/tcoulter/following{/other_user}",
      "gists_url": "https://api.github.com/users/tcoulter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tcoulter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tcoulter/subscriptions",
      "organizations_url": "https://api.github.com/users/tcoulter/orgs",
      "repos_url": "https://api.github.com/users/tcoulter/repos",
      "events_url": "https://api.github.com/users/tcoulter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tcoulter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-01T15:26:43Z",
    "updated_at": "2017-05-01T15:26:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "@elenadimitrova EthPM is in flux right now. EthPM uses IPFS to store data, and IPFS inherently has no mechanism to ensure data stays on the network -- it has a concept of \"pinning\", which should keep it, but unlike SWARM there's no financial incentive and thus is prone to data loss. For some reason, the IPFS installation we used (via Infura) lost data for some packages. The only solution is to ask those packages to release new versions to EthPM so it updates the files stored on IPFS. \r\n\r\nThe only way to fix this completely is to have a distributed file storage mechanisms that provide incentives for keeping data on the network. As far as I can tell that will best be solved via SWARM.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/298354297/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/299657154",
    "html_url": "https://github.com/trufflesuite/truffle/issues/396#issuecomment-299657154",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/396",
    "id": 299657154,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTY1NzE1NA==",
    "user": {
      "login": "pooleja",
      "id": 1794421,
      "node_id": "MDQ6VXNlcjE3OTQ0MjE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1794421?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pooleja",
      "html_url": "https://github.com/pooleja",
      "followers_url": "https://api.github.com/users/pooleja/followers",
      "following_url": "https://api.github.com/users/pooleja/following{/other_user}",
      "gists_url": "https://api.github.com/users/pooleja/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pooleja/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pooleja/subscriptions",
      "organizations_url": "https://api.github.com/users/pooleja/orgs",
      "repos_url": "https://api.github.com/users/pooleja/repos",
      "events_url": "https://api.github.com/users/pooleja/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pooleja/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-06T18:16:55Z",
    "updated_at": "2017-05-06T18:16:55Z",
    "author_association": "NONE",
    "body": "Is there a workaround for this while it gets sorted?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/299657154/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/299682147",
    "html_url": "https://github.com/trufflesuite/truffle/issues/396#issuecomment-299682147",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/396",
    "id": 299682147,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5OTY4MjE0Nw==",
    "user": {
      "login": "jbenet",
      "id": 138401,
      "node_id": "MDQ6VXNlcjEzODQwMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/138401?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jbenet",
      "html_url": "https://github.com/jbenet",
      "followers_url": "https://api.github.com/users/jbenet/followers",
      "following_url": "https://api.github.com/users/jbenet/following{/other_user}",
      "gists_url": "https://api.github.com/users/jbenet/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jbenet/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jbenet/subscriptions",
      "organizations_url": "https://api.github.com/users/jbenet/orgs",
      "repos_url": "https://api.github.com/users/jbenet/repos",
      "events_url": "https://api.github.com/users/jbenet/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jbenet/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-07T04:43:12Z",
    "updated_at": "2017-05-07T04:44:25Z",
    "author_association": "NONE",
    "body": "Hey everyone, some pointed me to this issue. IPFS dev here.\r\n\r\n> EthPM is in flux right now. EthPM uses IPFS to store data, and IPFS inherently has no mechanism to ensure data stays on the network -- it has a concept of \"pinning\", which should keep it, but unlike SWARM there's no financial incentive and thus is prone to data loss. \r\n\r\nThis is not representing IPFS properly. IPFS does have a mechanism for ensuring data stays on the network, and you described it: pinning. Pinning relies on _external-to-ipfs_ reasons for keeping around content. This is how the majority of all data in the world is distributed today (through ipfs, http, bittorrent, ftp, smtp, ...). And _all_ of that distribution of data works just fine, without in-transport financial incentives. What you mean is that IPFS _does not include an internal financial incentive structure_, and that's right. It was separated out into a separate protocol (WIP now), Filecoin.\r\n\r\nCompare to other registries. There is no financial incentive to keep around most registries of software packages in the world, from `apt` to `pypi` to `npm`. Linux sources and binaries, all programming languages, and so many more community infrastructures run _just fine_ without any kind of financial incentive structure in the transport. Of course, having easy ways to \"incent the network\" to store all the data, regardless of whether the network cares about the data, will be useful. Incentivized storage networks will be great. That said, you do not at all have to rely on those, nor to wait for such solutions to mature.\r\n\r\nPackage registries are **trivially small** amounts of data. even 2-5 different people offering to pin it as a community resource **will be dramatically cheaper** than the work required to get incentivized solutions to mature. (just measured in your dev time alone, integrating). All you need is 3-5 full copies, and a setup such that -- when people publish a package -- the ref is broadcast to every replica (eg a tool like [ipfs-cluster](https://github.com/ipfs/ipfs-cluster)).\r\n\r\nHere, I offer to replicate all your data for free. If your registry is less than 5TB (which i highly suspect it is) you can just pin everything to our storage hosts. We already replicate lots of data for other orgs. We're happy to give people access to our storage nodes. @tcoulter email me.\r\n\r\n> For some reason, the IPFS installation we used (via Infura) lost data for some packages. The only solution is to ask those packages to release new versions to EthPM so it updates the files stored on IPFS.\r\n\r\nThat's a bigger issue, and we should look into it. @tcoulter email me as i'd like to get to the bottom of that. Curious to find out why content was dropped, and where the issue lies. If it was in any of the IPFS code, we'd love to figure out the bug that caused it and fix it. We run very large archives (>TB) without any data loss, so this is quite surprising.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/299682147/reactions",
      "total_count": 5,
      "+1": 5,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/300068872",
    "html_url": "https://github.com/trufflesuite/truffle/issues/396#issuecomment-300068872",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/396",
    "id": 300068872,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMDA2ODg3Mg==",
    "user": {
      "login": "tcoulter",
      "id": 92629,
      "node_id": "MDQ6VXNlcjkyNjI5",
      "avatar_url": "https://avatars.githubusercontent.com/u/92629?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tcoulter",
      "html_url": "https://github.com/tcoulter",
      "followers_url": "https://api.github.com/users/tcoulter/followers",
      "following_url": "https://api.github.com/users/tcoulter/following{/other_user}",
      "gists_url": "https://api.github.com/users/tcoulter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tcoulter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tcoulter/subscriptions",
      "organizations_url": "https://api.github.com/users/tcoulter/orgs",
      "repos_url": "https://api.github.com/users/tcoulter/repos",
      "events_url": "https://api.github.com/users/tcoulter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tcoulter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-09T05:58:27Z",
    "updated_at": "2017-05-09T05:58:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks @jbenet. I have no information on how the data was lost, but just that it was. Unfortunately I don't run the EthPM file storage infrastructure (that's Infura), so I can't pinpoint whether or not it was a bug or a lack of proper configuration, such as clustering (though I can put you in touch with the Infura team, if needed). What I *can* say is that if EthPM's promise is to provide a decentralized package registry on top of Ethereum, it eventually needs a file storage mechanism that's similarly decentralized. Pinning to your infrastructure could help (and I appreciate it); that would be a stop gap until we get proper financial mechanisms for persisting data. \r\n\r\nI need to regroup with @pipermerriam to see what the way forward is. Will definitely reach out if I have questions. Thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/300068872/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/301901469",
    "html_url": "https://github.com/trufflesuite/truffle/issues/396#issuecomment-301901469",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/396",
    "id": 301901469,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMTkwMTQ2OQ==",
    "user": {
      "login": "tcoulter",
      "id": 92629,
      "node_id": "MDQ6VXNlcjkyNjI5",
      "avatar_url": "https://avatars.githubusercontent.com/u/92629?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tcoulter",
      "html_url": "https://github.com/tcoulter",
      "followers_url": "https://api.github.com/users/tcoulter/followers",
      "following_url": "https://api.github.com/users/tcoulter/following{/other_user}",
      "gists_url": "https://api.github.com/users/tcoulter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tcoulter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tcoulter/subscriptions",
      "organizations_url": "https://api.github.com/users/tcoulter/orgs",
      "repos_url": "https://api.github.com/users/tcoulter/repos",
      "events_url": "https://api.github.com/users/tcoulter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tcoulter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-16T20:13:06Z",
    "updated_at": "2017-05-16T20:13:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "This has been fixed (more specifically, worked around) in the latest version of Truffle, v3.2.3.\r\n\r\nTo get the fix, uninstall and reinstall your version of Truffle.\r\n\r\nBackground: I was wrong. This issue wasn't an issue with data loss, although Infura has lost data (unfortunately I can't speak to that in more detail). Instead, this issue was an issue with response times, where files were taking > 30s to resolve.\r\n\r\nI've isolated it to the specific API used against infura IPFS nodes, and have noticed similar behavior with `gateway.ipfs.io`. Here's an example:\r\n\r\n1. Infura, IPFS port, `/api/v0/cat` -> slow. This example shows a request resolving in 2 seconds. I've seen upwards of 30 seconds.\r\n```\r\n$ curl https://ipfs.infura.io:5001/api/v0/cat/QmVceYuBZpVzgbjsYXi7Zkma3jE1wNp3gWY68u21GmX56v -o /dev/null -w \"%{time_total}\\n\"\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100   283    0   283    0     0    128      0 --:--:--  0:00:02 --:--:--   128\r\n2.207\r\n```\r\n\r\n2. Infura, local port (i.e., not 5001), `/api/v0/cat` -> slow. Seems to be the same response time as the above.\r\n```\r\n$ curl https://ipfs.infura.io/api/v0/cat/QmVceYuBZpVzgbjsYXi7Zkma3jE1wNp3gWY68u21GmX56v -o /dev/null -w \"%{time_total}\\n\"\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100   283    0   283    0     0    138      0 --:--:--  0:00:02 --:--:--   138\r\n2.039\r\n```\r\n\r\n3. Infura, local port (not 5001), `/ipfs/` api -> much faster to resolve.\r\n\r\n```\r\n$ curl https://ipfs.infura.io/ipfs/QmVceYuBZpVzgbjsYXi7Zkma3jE1wNp3gWY68u21GmX56v -o /dev/null -w \"%{time_total}\\n\"\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100   283  100   283    0     0    547      0 --:--:-- --:--:-- --:--:--   547\r\n0.517\r\n```\r\n\r\nI've reworked Truffle's use of EthPM to use the third API, though I'm told this is requesting data from a specific node, and not from the IPFS network in general (correct me if I'm wrong). This is a workaround until we can get better response times over the full API. \r\n\r\nThanks for reporting the issue and my apologies for miscategorizing it above.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/301901469/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
