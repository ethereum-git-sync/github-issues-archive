{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/4884",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4884/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4884/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4884/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/4884",
  "id": 1171825933,
  "node_id": "I_kwDOAkfq-c5F2KUN",
  "number": 4884,
  "title": "Truffle 5.5.x or 5.4.x test against Rinkeby causes error saying \"Error: json: cannot unmarshal number into Go struct field params.fromBlock of type string\" ",
  "user": {
    "login": "3rdstage",
    "id": 2508220,
    "node_id": "MDQ6VXNlcjI1MDgyMjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2508220?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/3rdstage",
    "html_url": "https://github.com/3rdstage",
    "followers_url": "https://api.github.com/users/3rdstage/followers",
    "following_url": "https://api.github.com/users/3rdstage/following{/other_user}",
    "gists_url": "https://api.github.com/users/3rdstage/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/3rdstage/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/3rdstage/subscriptions",
    "organizations_url": "https://api.github.com/users/3rdstage/orgs",
    "repos_url": "https://api.github.com/users/3rdstage/repos",
    "events_url": "https://api.github.com/users/3rdstage/events{/privacy}",
    "received_events_url": "https://api.github.com/users/3rdstage/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-03-17T01:50:54Z",
  "updated_at": "2023-03-10T04:43:43Z",
  "closed_at": "2022-04-21T12:04:11Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "- [ ] I've [opened a support ticket](https://trufflesuite.zendesk.com/hc/en-us/requests/new) before filing this issue.\r\n\r\n---------------------------\r\n\r\n## Issue\r\n\r\nTruffle test on Javascript based test against Rinkeby with Truffle 5.5.x or 5.4.x  makes an error in \"after each\" hook saying **\"Error: json: cannot unmarshal number into Go struct field params.fromBlock of type string\"**  right after the first testcase.\r\n\r\nTruffle 5.5.x or 5.4.x with Node 14.x or 12.x shows the same problem when running against Rinkeby, although the test against local Ganache has no problem\r\n\r\nTruffle 5.3.14 with the same test runs well without the problem  \r\n\r\n\r\n## Expected Behavior\r\n\r\nTruffle test against Rinkeby is expected to run without error in 'after each' hook, like when running against local Ganache or with Truffle 5.3.x\r\n\r\n\r\n## Actual Results\r\n\r\n### Truffle configuration\r\n\r\n```javascript\r\nmodule.exports = {\r\n  networks: {\r\n     ...\r\n  \r\n     rinkeby: {\r\n        provider: () =>\r\n          new HDWalletProvider({\r\n            chainId: \"4\",\r\n            mnemonic: process.env.BIP39_MNEMONIC,\r\n            providerOrUrl: new Web3HttpProvider(\r\n              \"https://rinkeby.infura.io/v3/\" + process.env.INFURA_PROJECT_ID, httpOptions),\r\n            pollingInterval: \"5500\"\r\n          }),\r\n        network_id: \"4\",\r\n        // gas: 7E6,\r\n        // gasPrice: 1E10,\r\n        skipDryRun: true\r\n      },\r\n     ...\r\n  }\r\n...\r\n}\r\n```\r\n\r\n### Commandline result\r\n\r\n* The test (`TestERC721ExportableInRinkeby.js`) has 3 testcases.\r\n* `web3-providers-http` package is v1.5.3\r\n\r\n```bash\r\n$ truffle test --compile-none --migrate-none --show-events --network rinkeby test/token/TestERC721ExportableInRinkeby.js \r\nUsing network 'rinkeby'.\r\n\r\n\r\nCompiling your contracts...\r\n===========================\r\n> Compilation skipped because --compile-none option was passed.\r\n> Migration skipped because --migrate-none option was passed.\r\n\r\n....\r\n\r\n      âœ“ A token in normal state(owned by someone) can set to be exporting by the approved. (43851ms)\r\n      1) \"after each\" hook: after test for \"A token in normal state(owned by someone) can set to be exporting by the approved.\"\r\n\r\n\r\n  1 passing (49s)\r\n  1 failing\r\n\r\n  1) Contract: ERC721Exportable Contract Test Suite\r\n       \"after each\" hook: after test for \"A token in normal state(owned by someone) can set to be exporting by the approved.\":\r\n     Error: json: cannot unmarshal number into Go struct field params.fromBlock of type string\r\n      at /Users/3rdstage/Git/Repos/3rdstage/smart-contracts/node_modules/@trufflesuite/web3-provider-engine/subproviders/provider.js:18:36\r\n      at XMLHttpRequest.request.onreadystatechange (node_modules/web3-providers-http/lib/index.js:98:13)\r\n      at XMLHttpRequestEventTarget.dispatchEvent (node_modules/xhr2-cookies/xml-http-request-event-target.ts:44:13)\r\n      at XMLHttpRequest._setReadyState (node_modules/xhr2-cookies/xml-http-request.ts:219:8)\r\n      at XMLHttpRequest._onHttpResponseEnd (node_modules/xhr2-cookies/xml-http-request.ts:345:8)\r\n      at IncomingMessage.<anonymous> (node_modules/xhr2-cookies/xml-http-request.ts:311:39)\r\n      at endReadableNT (internal/streams/readable.js:1334:12)\r\n      at processTicksAndRejections (internal/process/task_queues.js:82:21)\r\n\r\n```\r\n\r\n## Environment\r\n\r\n* Operating System:  macOS 10.14.5 (Mojave) \r\n* Ethereum client:  Infura\r\n* Truffle version (`truffle version`):  v5.5.4\r\n* node version (`node --version`): v14.19.0\r\n* npm version (`npm --version`):  v6.14.16\r\n",
  "closed_by": {
    "login": "cds-amal",
    "id": 2529600,
    "node_id": "MDQ6VXNlcjI1Mjk2MDA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2529600?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cds-amal",
    "html_url": "https://github.com/cds-amal",
    "followers_url": "https://api.github.com/users/cds-amal/followers",
    "following_url": "https://api.github.com/users/cds-amal/following{/other_user}",
    "gists_url": "https://api.github.com/users/cds-amal/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cds-amal/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cds-amal/subscriptions",
    "organizations_url": "https://api.github.com/users/cds-amal/orgs",
    "repos_url": "https://api.github.com/users/cds-amal/repos",
    "events_url": "https://api.github.com/users/cds-amal/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cds-amal/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/4884/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4884/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1072494409",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4884#issuecomment-1072494409",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4884",
    "id": 1072494409,
    "node_id": "IC_kwDOAkfq-c4_7PdJ",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-18T15:00:30Z",
    "updated_at": "2022-03-18T15:00:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hey @3rdstage, I'm not familiar with this error message. Is your repo available on GitHub so we can use it to try and reproduce your error? That along with specific steps to do so would be super helpful in figuring out what is going on here. Thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1072494409/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1105116201",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4884#issuecomment-1105116201",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4884",
    "id": 1105116201,
    "node_id": "IC_kwDOAkfq-c5B3rwp",
    "user": {
      "login": "cds-amal",
      "id": 2529600,
      "node_id": "MDQ6VXNlcjI1Mjk2MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2529600?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cds-amal",
      "html_url": "https://github.com/cds-amal",
      "followers_url": "https://api.github.com/users/cds-amal/followers",
      "following_url": "https://api.github.com/users/cds-amal/following{/other_user}",
      "gists_url": "https://api.github.com/users/cds-amal/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cds-amal/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cds-amal/subscriptions",
      "organizations_url": "https://api.github.com/users/cds-amal/orgs",
      "repos_url": "https://api.github.com/users/cds-amal/repos",
      "events_url": "https://api.github.com/users/cds-amal/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cds-amal/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-21T12:04:11Z",
    "updated_at": "2022-04-21T12:04:11Z",
    "author_association": "MEMBER",
    "body": "Closing for issue maintenance.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1105116201/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1463253505",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4884#issuecomment-1463253505",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4884",
    "id": 1463253505,
    "node_id": "IC_kwDOAkfq-c5XN3oB",
    "user": {
      "login": "Aouchinx",
      "id": 71441807,
      "node_id": "MDQ6VXNlcjcxNDQxODA3",
      "avatar_url": "https://avatars.githubusercontent.com/u/71441807?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Aouchinx",
      "html_url": "https://github.com/Aouchinx",
      "followers_url": "https://api.github.com/users/Aouchinx/followers",
      "following_url": "https://api.github.com/users/Aouchinx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Aouchinx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Aouchinx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Aouchinx/subscriptions",
      "organizations_url": "https://api.github.com/users/Aouchinx/orgs",
      "repos_url": "https://api.github.com/users/Aouchinx/repos",
      "events_url": "https://api.github.com/users/Aouchinx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Aouchinx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-10T04:43:43Z",
    "updated_at": "2023-03-10T04:43:43Z",
    "author_association": "NONE",
    "body": "@cds-amal @3rdstage May I ask if this issue has been fixed? I also encountered this error when running the test script on the Goerli test network.\r\n```bash\r\n$ truffle version                                                                                                                                                                                                                                                                   \r\nTruffle v5.7.9 (core: 5.7.9)\r\nGanache v7.7.5\r\nSolidity - 0.8.19 (solc-js)\r\nNode v16.17.0\r\nWeb3.js v1.8.2\r\n```\r\n```javascript\r\ngoerli: {\r\n  provider: () => new HDWalletProvider(MNEMONIC, `https://goerli.infura.io/v3/${INFURA_PROJECT_ID}`),\r\n  network_id: 5,       // Goerli's id\r\n  confirmations: 2,    // # of confirmations to wait between deployments. (default: 0)\r\n  timeoutBlocks: 200,  // # of blocks before a deployment times out  (minimum/default: 50)\r\n  skipDryRun: true     // Skip dry run before migrations? (default: false for public nets )\r\n}\r\n```\r\n\r\n![image](https://user-images.githubusercontent.com/71441807/224225176-e2b73bd6-4be9-49c1-a1b1-c673e9fa0eed.png)\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1463253505/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
