{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/840",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/840/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/840/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/840/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/840",
  "id": 304065991,
  "node_id": "MDU6SXNzdWUzMDQwNjU5OTE=",
  "number": 840,
  "title": "When trying to deploy to a node that is not fully synced, get error: exceeds block gas limit",
  "user": {
    "login": "litch",
    "id": 465946,
    "node_id": "MDQ6VXNlcjQ2NTk0Ng==",
    "avatar_url": "https://avatars.githubusercontent.com/u/465946?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/litch",
    "html_url": "https://github.com/litch",
    "followers_url": "https://api.github.com/users/litch/followers",
    "following_url": "https://api.github.com/users/litch/following{/other_user}",
    "gists_url": "https://api.github.com/users/litch/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/litch/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/litch/subscriptions",
    "organizations_url": "https://api.github.com/users/litch/orgs",
    "repos_url": "https://api.github.com/users/litch/repos",
    "events_url": "https://api.github.com/users/litch/events{/privacy}",
    "received_events_url": "https://api.github.com/users/litch/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2018-03-10T12:11:16Z",
  "updated_at": "2018-03-10T17:28:36Z",
  "closed_at": "2018-03-10T17:28:36Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "- [x] I've asked for help in the [Truffle Gitter](http://gitter.im/Consensys/truffle) before filing this issue.\r\n\r\n---------------------------\r\n\r\n## Issue\r\n\r\nThe error message when trying to deploy to a geth node that is not fully synced yet is incorrect:\r\n\r\n`Error: exceeds block gas limit`\r\n\r\nThis led me to spend a couple hours trying to dig and research about what could by wrong with my gas settings, trying lots of gas settings, confirming that I could deploy on testrpc and rinkeby, and then being confused that I still couldn't deploy on mainnet.\r\n\r\n## Steps to Reproduce\r\n\r\n- Start a geth node syncing (maybe rename your chaindata directory first)\r\n- Try to deploy any contract (I was trying to just deploy `Migrations.sol` in this case)\r\n\r\n## Expected Behavior\r\n\r\nSuccess, or an error message about needing to wait for the node to sync\r\n\r\n## Actual Results\r\n\r\n```\r\ntruffle migrate --network mainnet\r\nUsing network 'mainnet'.\r\n\r\nRunning migration: 1_initial_migration.js\r\n  Deploying Migrations...\r\n  ... undefined\r\nError encountered, bailing. Network state unknown. Review successful transactions manually.\r\nError: exceeds block gas limit\r\n```\r\n\r\n## Environment\r\n\r\n* Operating System: Mac OS X\r\n* Ethereum client: geth 1.8.2\r\n* Truffle version (`truffle version`): v4.1.0 (core: 4.1.0) & v4.1.3 (core: 4.1.3)\r\n* node version (`node --version`): 8.9.1\r\n* npm version (`npm --version`): 5.6.0\r\n",
  "closed_by": {
    "login": "cgewecke",
    "id": 7332026,
    "node_id": "MDQ6VXNlcjczMzIwMjY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cgewecke",
    "html_url": "https://github.com/cgewecke",
    "followers_url": "https://api.github.com/users/cgewecke/followers",
    "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
    "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
    "organizations_url": "https://api.github.com/users/cgewecke/orgs",
    "repos_url": "https://api.github.com/users/cgewecke/repos",
    "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cgewecke/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/840/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/840/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/372045688",
    "html_url": "https://github.com/trufflesuite/truffle/issues/840#issuecomment-372045688",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/840",
    "id": 372045688,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MjA0NTY4OA==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-10T17:11:01Z",
    "updated_at": "2018-03-10T17:11:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "@litch This error comes from the client and Truffle reports it. Agree that it's not helpful but Truffle's current ability to evaluate the client state is limited to faithfully reflecting the signals it emits. For what it's worth, there's confusion over this response everywhere - [here's a case](https://github.com/ethereum/mist/issues/1660) at Mist.  \r\n\r\nThank you for opening this - it will make it much easier for someone searching the error to figure out what might be going on in their local environment. \r\n\r\nThat said, I'm going to slightly rename the issue and begin tracking this over at `truffle-migrate` where we are in the planning stages of a major upgrade.  More helpful error management will be a core focus. \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/372045688/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
