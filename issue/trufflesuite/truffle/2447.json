{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/2447",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2447/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2447/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2447/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/2447",
  "id": 505988145,
  "node_id": "MDU6SXNzdWU1MDU5ODgxNDU=",
  "number": 2447,
  "title": "artifacts.require of npm dependency artifacts does not work",
  "user": {
    "login": "frangio",
    "id": 481465,
    "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/frangio",
    "html_url": "https://github.com/frangio",
    "followers_url": "https://api.github.com/users/frangio/followers",
    "following_url": "https://api.github.com/users/frangio/following{/other_user}",
    "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
    "organizations_url": "https://api.github.com/users/frangio/orgs",
    "repos_url": "https://api.github.com/users/frangio/repos",
    "events_url": "https://api.github.com/users/frangio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/frangio/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 230393326,
      "node_id": "MDU6TGFiZWwyMzAzOTMzMjY=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    },
    {
      "id": 644098328,
      "node_id": "MDU6TGFiZWw2NDQwOTgzMjg=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/needs%20reproduced",
      "name": "needs reproduced",
      "color": "fbca04",
      "default": false,
      "description": null
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2019-10-11T18:09:51Z",
  "updated_at": "2019-10-28T22:04:01Z",
  "closed_at": "2019-10-28T22:04:00Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "`artifacts.require('<dependency>/<Contract>')` is supposed to create a Truffle contract class based on `node_modules/<dependency>/build/contracts/<Contract>.json`. We are not able to get this to work in tests or migrations.\r\n\r\nAfter some debugging we realized that the resolver is searching for this path under the working directory, which in tests and migrations is set to a directory like `/tmp/test-119911-21025-1qqm8cp.8l6k` that does not have a `node_modules` subdirectory.\r\n\r\nWe were also unable to pass a custom search path, which would've helped. `Resolver` has this functionality but it's not exposed, as shown below. I'm not sure if this is intentional.\r\n\r\nhttps://github.com/trufflesuite/truffle/blob/c0aab909fa9a53a2c114d7a07aae26c59b2f2ab5/packages/core/lib/test.js#L199\r\n\r\nSome context in https://github.com/OpenZeppelin/openzeppelin-test-helpers/issues/81.\r\n\r\nWe tested this in Truffle 5.0.29 and 5.0.39. cc @nventuro",
  "closed_by": {
    "login": "frangio",
    "id": 481465,
    "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/frangio",
    "html_url": "https://github.com/frangio",
    "followers_url": "https://api.github.com/users/frangio/followers",
    "following_url": "https://api.github.com/users/frangio/following{/other_user}",
    "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
    "organizations_url": "https://api.github.com/users/frangio/orgs",
    "repos_url": "https://api.github.com/users/frangio/repos",
    "events_url": "https://api.github.com/users/frangio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/frangio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/2447/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2447/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/542817405",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2447#issuecomment-542817405",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2447",
    "id": 542817405,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0MjgxNzQwNQ==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-16T17:51:25Z",
    "updated_at": "2019-10-16T17:51:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for raising this!  We'll look into it.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/542817405/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/545068240",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2447#issuecomment-545068240",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2447",
    "id": 545068240,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NTA2ODI0MA==",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T17:26:01Z",
    "updated_at": "2019-10-22T17:27:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "@frangio Do you have a project where this is not working that I could clone to reproduce your issue? As far as I know, the temporary folder that Truffle creates for the artifact files should also get populated with the dependencies of your contracts. In other words, if you import any artifacts as dependencies they should get compiled into that temp folder as well.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/545068240/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/545132119",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2447#issuecomment-545132119",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2447",
    "id": 545132119,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NTEzMjExOQ==",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T20:09:05Z",
    "updated_at": "2019-10-22T20:09:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "Unfortunately I don't have a project ready to share, but we were able to reproduce this easily on a freshly initialized project with `@openzeppelin/contracts` installed via npm.\r\n\r\n>if you import any artifacts as dependencies they should get compiled into that temp folder as well.\r\n\r\nHm, I'm not sure if we're talking about the same thing. I'm talking about contracts that are precompiled in the dependency, and that are not imported in any Solidity file. So there is nothing that Truffle should compile here. It only needs to give access to the artifact present in the dependency directory.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/545132119/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/545531004",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2447#issuecomment-545531004",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2447",
    "id": 545531004,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NTUzMTAwNA==",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-23T16:38:04Z",
    "updated_at": "2019-10-23T16:38:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "So in other words you are talking about importing JSON files with the artifact information instead of Solidity files. I'll take a look into this today. I'll get back to you about what I find, thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/545531004/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/546966588",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2447#issuecomment-546966588",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2447",
    "id": 546966588,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0Njk2NjU4OA==",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-28T14:16:52Z",
    "updated_at": "2019-10-28T14:16:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hey @frangio can you give me a link to some docs describing what you are doing or give me a small snippet demonstrating what you want to do? I'm trying to figure out how to test and reproduce your error.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/546966588/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/546977761",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2447#issuecomment-546977761",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2447",
    "id": 546977761,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0Njk3Nzc2MQ==",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-28T14:41:36Z",
    "updated_at": "2019-10-28T14:41:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "I tried using an ENS library to recreate your problem. I installed `@ensdomains/ens` and am able to successfully instantiate instances of `ENSRegistry` in both tests and migrations by doing the following...\r\n```\r\nconst registry = artifacts.require(\"@ensdomains/ens/ENSRegistry\");\r\n```\r\n\r\nIf you have a couple minutes and are able to provide a simple repro example then let me know! I would love to try and help you get to the bottom of the issue.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/546977761/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/547165335",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2447#issuecomment-547165335",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2447",
    "id": 547165335,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NzE2NTMzNQ==",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-28T22:04:00Z",
    "updated_at": "2019-10-28T22:04:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "Oh I see. It seems we are putting our artifacts under the wrong directory, in `build/*.json` instead of `build/contracts/*.json`.\r\n\r\n@eggplantzzz Thanks for looking into this! We'll fix our package",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/547165335/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
