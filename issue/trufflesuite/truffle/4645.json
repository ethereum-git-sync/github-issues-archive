{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/4645",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4645/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4645/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4645/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/4645",
  "id": 1113392743,
  "node_id": "I_kwDOAkfq-c5CXQZn",
  "number": 4645,
  "title": "Error: sender doesn't have enough funds to send tx.",
  "user": {
    "login": "liuzhonghao1998",
    "id": 26685677,
    "node_id": "MDQ6VXNlcjI2Njg1Njc3",
    "avatar_url": "https://avatars.githubusercontent.com/u/26685677?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/liuzhonghao1998",
    "html_url": "https://github.com/liuzhonghao1998",
    "followers_url": "https://api.github.com/users/liuzhonghao1998/followers",
    "following_url": "https://api.github.com/users/liuzhonghao1998/following{/other_user}",
    "gists_url": "https://api.github.com/users/liuzhonghao1998/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/liuzhonghao1998/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/liuzhonghao1998/subscriptions",
    "organizations_url": "https://api.github.com/users/liuzhonghao1998/orgs",
    "repos_url": "https://api.github.com/users/liuzhonghao1998/repos",
    "events_url": "https://api.github.com/users/liuzhonghao1998/events{/privacy}",
    "received_events_url": "https://api.github.com/users/liuzhonghao1998/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2022-01-25T03:52:26Z",
  "updated_at": "2022-03-02T19:50:36Z",
  "closed_at": "2022-03-02T19:50:36Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Migrations dry-run (simulation)\r\n===============================\r\n> Network name:    'mainnet-fork'\r\n> Network id:      1\r\n> Block gas limit: 30087828 (0x1cb1a94)\r\n\r\n\r\n1_initial_migration.js\r\n======================\r\n\r\n   Deploying 'Migrations'\r\n   ----------------------\r\n   > block number:        14066980\r\n   > block timestamp:     1643009346\r\n   > account:            ***********\r\n   > balance:             0.496162978371760148\r\n   > gas used:            233842 (0x39172)\r\n   > gas price:           70 gwei\r\n   > value sent:          0 ETH\r\n   > total cost:          0.01636894 ETH\r\n\r\n   -------------------------------------\r\n   > Total cost:          0.01636894 ETH\r\n\r\n\r\n2_deploy_contracts.js\r\n=====================\r\n\r\n   Deploying '*******'\r\n   -------------------\r\n   > block number:        14066982\r\n   > block timestamp:     1643009367\r\n   > account:              ***********\r\n   > balance:             0.125708628371760148\r\n   > gas used:            5264692 (0x505534)\r\n   > gas price:           70 gwei\r\n   > value sent:          0 ETH\r\n   > total cost:          0.36852844 ETH\r\n\r\nError: sender doesn't have enough funds to send tx. The upfront cost is: 371000000000000000 and the sender's account only has: 125708628371760148\r\n\r\n\r\nAccording to the simulation result, we can see I have enough balance to deploy my contract on mainnet, why the tuffle compares the upfront cost with the balance that has subtracted the upfront cost and return the error\r\n\r\n\r\n",
  "closed_by": {
    "login": "eggplantzzz",
    "id": 14827965,
    "node_id": "MDQ6VXNlcjE0ODI3OTY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/eggplantzzz",
    "html_url": "https://github.com/eggplantzzz",
    "followers_url": "https://api.github.com/users/eggplantzzz/followers",
    "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
    "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
    "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
    "repos_url": "https://api.github.com/users/eggplantzzz/repos",
    "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
    "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/4645/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4645/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1021333690",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4645#issuecomment-1021333690",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4645",
    "id": 1021333690,
    "node_id": "IC_kwDOAkfq-c484FC6",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-25T15:54:13Z",
    "updated_at": "2022-01-25T15:54:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "From the logs you provided it looks like you do not have enough funds for your second migrations (2_deploying_contracts.js). The `total cost` is `0.36...` and your `balance` is `0.12...`. Try using an account with a higher balance.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1021333690/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1021860010",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4645#issuecomment-1021860010",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4645",
    "id": 1021860010,
    "node_id": "IC_kwDOAkfq-c486Fiq",
    "user": {
      "login": "liuzhonghao1998",
      "id": 26685677,
      "node_id": "MDQ6VXNlcjI2Njg1Njc3",
      "avatar_url": "https://avatars.githubusercontent.com/u/26685677?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/liuzhonghao1998",
      "html_url": "https://github.com/liuzhonghao1998",
      "followers_url": "https://api.github.com/users/liuzhonghao1998/followers",
      "following_url": "https://api.github.com/users/liuzhonghao1998/following{/other_user}",
      "gists_url": "https://api.github.com/users/liuzhonghao1998/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/liuzhonghao1998/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/liuzhonghao1998/subscriptions",
      "organizations_url": "https://api.github.com/users/liuzhonghao1998/orgs",
      "repos_url": "https://api.github.com/users/liuzhonghao1998/repos",
      "events_url": "https://api.github.com/users/liuzhonghao1998/events{/privacy}",
      "received_events_url": "https://api.github.com/users/liuzhonghao1998/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-26T04:55:34Z",
    "updated_at": "2022-01-26T04:55:34Z",
    "author_association": "NONE",
    "body": "Yes, you are right, but I think there is a bug in ruffle. The total cost of deploying is 0.37... and my acount has about 0.5125 to deploy the contract. The balance shows in log, I think is the remain value which has cost the gas. As we can see, when the simulation finished, the balance has 0.125... and the simulation shuld successes. However, why the tuffle compares the remain balance with the total cost again? Obviously, It will return an error, which is nonsense.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1021860010/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1022347414",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4645#issuecomment-1022347414",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4645",
    "id": 1022347414,
    "node_id": "IC_kwDOAkfq-c4878iW",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-26T16:05:55Z",
    "updated_at": "2022-01-26T16:05:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "If you think there is a bug, could you please provide a repo and specific steps to reproduce this error? Are you deploying from the same account? If you could provide the repo and steps it would help me in troubleshooting this.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1022347414/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1022846732",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4645#issuecomment-1022846732",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4645",
    "id": 1022846732,
    "node_id": "IC_kwDOAkfq-c4892cM",
    "user": {
      "login": "liuzhonghao1998",
      "id": 26685677,
      "node_id": "MDQ6VXNlcjI2Njg1Njc3",
      "avatar_url": "https://avatars.githubusercontent.com/u/26685677?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/liuzhonghao1998",
      "html_url": "https://github.com/liuzhonghao1998",
      "followers_url": "https://api.github.com/users/liuzhonghao1998/followers",
      "following_url": "https://api.github.com/users/liuzhonghao1998/following{/other_user}",
      "gists_url": "https://api.github.com/users/liuzhonghao1998/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/liuzhonghao1998/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/liuzhonghao1998/subscriptions",
      "organizations_url": "https://api.github.com/users/liuzhonghao1998/orgs",
      "repos_url": "https://api.github.com/users/liuzhonghao1998/repos",
      "events_url": "https://api.github.com/users/liuzhonghao1998/events{/privacy}",
      "received_events_url": "https://api.github.com/users/liuzhonghao1998/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-27T04:52:18Z",
    "updated_at": "2022-01-27T04:52:18Z",
    "author_association": "NONE",
    "body": "Emmm, it may not a bug. Yesterday, I used the MetaMask to mint an NFT, I also meet the funds is not enough. So, I have a question. Is there a security strategy in Ethereum that if we want to make a transaction, we must satisfy the funds > 2 * costs and the transaction will be executed.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1022846732/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1023331149",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4645#issuecomment-1023331149",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4645",
    "id": 1023331149,
    "node_id": "IC_kwDOAkfq-c48_stN",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-27T15:25:41Z",
    "updated_at": "2022-01-27T15:25:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "It seems like you are basically asking for a strategy for very accurately calculating gas costs? I'm not too much of an expert on this kind of thing but maybe someone else might have some suggestions here?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1023331149/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1057315116",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4645#issuecomment-1057315116",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4645",
    "id": 1057315116,
    "node_id": "IC_kwDOAkfq-c4_BVks",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-02T19:50:36Z",
    "updated_at": "2022-03-02T19:50:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "Currently on mainnet it is impossible to predict the cost of a transaction because the base fee changes per block. Your best bet right now is to get a crude estimate of what it will all cost and pad your account, sorry :( Closing for issue maintenance!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1057315116/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
