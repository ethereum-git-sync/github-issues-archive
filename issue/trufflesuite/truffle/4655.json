{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/4655",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4655/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4655/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4655/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/4655",
  "id": 1114912539,
  "node_id": "I_kwDOAkfq-c5CdDcb",
  "number": 4655,
  "title": "Events is undefined. Unable to listen to events.",
  "user": {
    "login": "vinaykharayat",
    "id": 23337757,
    "node_id": "MDQ6VXNlcjIzMzM3NzU3",
    "avatar_url": "https://avatars.githubusercontent.com/u/23337757?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/vinaykharayat",
    "html_url": "https://github.com/vinaykharayat",
    "followers_url": "https://api.github.com/users/vinaykharayat/followers",
    "following_url": "https://api.github.com/users/vinaykharayat/following{/other_user}",
    "gists_url": "https://api.github.com/users/vinaykharayat/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/vinaykharayat/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/vinaykharayat/subscriptions",
    "organizations_url": "https://api.github.com/users/vinaykharayat/orgs",
    "repos_url": "https://api.github.com/users/vinaykharayat/repos",
    "events_url": "https://api.github.com/users/vinaykharayat/events{/privacy}",
    "received_events_url": "https://api.github.com/users/vinaykharayat/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "kevinweaver",
    "id": 1020682,
    "node_id": "MDQ6VXNlcjEwMjA2ODI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1020682?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kevinweaver",
    "html_url": "https://github.com/kevinweaver",
    "followers_url": "https://api.github.com/users/kevinweaver/followers",
    "following_url": "https://api.github.com/users/kevinweaver/following{/other_user}",
    "gists_url": "https://api.github.com/users/kevinweaver/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kevinweaver/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kevinweaver/subscriptions",
    "organizations_url": "https://api.github.com/users/kevinweaver/orgs",
    "repos_url": "https://api.github.com/users/kevinweaver/repos",
    "events_url": "https://api.github.com/users/kevinweaver/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kevinweaver/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "kevinweaver",
      "id": 1020682,
      "node_id": "MDQ6VXNlcjEwMjA2ODI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1020682?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kevinweaver",
      "html_url": "https://github.com/kevinweaver",
      "followers_url": "https://api.github.com/users/kevinweaver/followers",
      "following_url": "https://api.github.com/users/kevinweaver/following{/other_user}",
      "gists_url": "https://api.github.com/users/kevinweaver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kevinweaver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kevinweaver/subscriptions",
      "organizations_url": "https://api.github.com/users/kevinweaver/orgs",
      "repos_url": "https://api.github.com/users/kevinweaver/repos",
      "events_url": "https://api.github.com/users/kevinweaver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kevinweaver/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-01-26T11:25:57Z",
  "updated_at": "2022-03-16T18:46:42Z",
  "closed_at": "2022-03-16T18:46:42Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "- [ ] I've [opened a support ticket](https://trufflesuite.zendesk.com/hc/en-us/requests/new) before filing this issue.\r\n\r\n---------------------------\r\n\r\n## Issue\r\n\r\nWhen I am using latest version of Truffle-Contracts.min and Web3.min I am unable to listen to events.\r\nI am getting this error.\r\nUncaught (in promise) TypeError: instance.events is undefined\r\n``` javascript\r\nApp.contracts.UkTokenSale.deployed().then((instance)=>{\r\n      console.log(instance);\r\n        instance.events.Sell({\r\n            filter: {myIndexedParam: [20,23], myOtherIndexedParam: '0x123456789...'}, // Using an array means OR: e.g. 20 or 23\r\n            fromBlock: 0\r\n        }, function(error, event){ console.log(event); })\r\n        .on('data', function(event){\r\n            console.log(event); // same results as the optional callback above\r\n        })\r\n        .on('changed', function(event){\r\n            // remove event from local database\r\n        })\r\n        .on('error', console.error);\r\n});\r\n```\r\n\r\nLog for contract Instance ABI:-\r\n```\r\n[\r\n  {\r\n    \"inputs\": [\r\n      {\r\n        \"internalType\": \"contract UkToken\",\r\n        \"name\": \"_tokenContract\",\r\n        \"type\": \"address\"\r\n      },\r\n      {\r\n        \"internalType\": \"uint256\",\r\n        \"name\": \"_tokenPrice\",\r\n        \"type\": \"uint256\"\r\n      }\r\n    ],\r\n    \"stateMutability\": \"nonpayable\",\r\n    \"type\": \"constructor\"\r\n  },\r\n  {\r\n    \"anonymous\": false,\r\n    \"inputs\": [\r\n      {\r\n        \"indexed\": false,\r\n        \"internalType\": \"address\",\r\n        \"name\": \"_buyer\",\r\n        \"type\": \"address\"\r\n      },\r\n      {\r\n        \"indexed\": false,\r\n        \"internalType\": \"uint256\",\r\n        \"name\": \"_amount\",\r\n        \"type\": \"uint256\"\r\n      }\r\n    ],\r\n    \"name\": \"Sell\",\r\n    \"type\": \"event\",\r\n    \"signature\": \"0x5e5e995ce3133561afceaa51a9a154d5db228cd7525d34df5185582c18d3df09\"\r\n  },\r\n  {\r\n    \"inputs\": [],\r\n    \"name\": \"tokenContract\",\r\n    \"outputs\": [\r\n      {\r\n        \"internalType\": \"contract UkToken\",\r\n        \"name\": \"\",\r\n        \"type\": \"address\"\r\n      }\r\n    ],\r\n    \"stateMutability\": \"view\",\r\n    \"type\": \"function\",\r\n    \"constant\": true,\r\n    \"signature\": \"0x55a373d6\"\r\n  },\r\n  {\r\n    \"inputs\": [],\r\n    \"name\": \"tokenPrice\",\r\n    \"outputs\": [\r\n      {\r\n        \"internalType\": \"uint256\",\r\n        \"name\": \"\",\r\n        \"type\": \"uint256\"\r\n      }\r\n    ],\r\n    \"stateMutability\": \"view\",\r\n    \"type\": \"function\",\r\n    \"constant\": true,\r\n    \"signature\": \"0x7ff9b596\"\r\n  },\r\n  {\r\n    \"inputs\": [],\r\n    \"name\": \"tokensSold\",\r\n    \"outputs\": [\r\n      {\r\n        \"internalType\": \"uint256\",\r\n        \"name\": \"\",\r\n        \"type\": \"uint256\"\r\n      }\r\n    ],\r\n    \"stateMutability\": \"view\",\r\n    \"type\": \"function\",\r\n    \"constant\": true,\r\n    \"signature\": \"0x518ab2a8\"\r\n  },\r\n  {\r\n    \"inputs\": [\r\n      {\r\n        \"internalType\": \"uint256\",\r\n        \"name\": \"_numberOfTokens\",\r\n        \"type\": \"uint256\"\r\n      }\r\n    ],\r\n    \"name\": \"buyTokens\",\r\n    \"outputs\": [],\r\n    \"stateMutability\": \"payable\",\r\n    \"type\": \"function\",\r\n    \"payable\": true,\r\n    \"signature\": \"0x3610724e\"\r\n  },\r\n  {\r\n    \"inputs\": [],\r\n    \"name\": \"endSale\",\r\n    \"outputs\": [],\r\n    \"stateMutability\": \"nonpayable\",\r\n    \"type\": \"function\",\r\n    \"signature\": \"0x380d831b\"\r\n  }\r\n]\r\n```\r\n\r\n\r\n## Steps to Reproduce\r\n\r\n1. Create event\r\n2. Try to listen to event\r\n\r\n## Expected Behavior\r\n\r\nEvent should trigger\r\n\r\n## Actual Results\r\n\r\nGot this error Uncaught (in promise) TypeError: instance.events is undefined\r\n\r\n## Environment\r\n\r\n* Operating System: Fedora\r\n* Ethereum client: ganache-2.5.4\r\n* Truffle version (`truffle version`): v5.4.29\r\n* node version (`node --version`): v16.13.2\r\n* npm version (`npm --version`): v1.5.3\r\n",
  "closed_by": {
    "login": "MicaiahReid",
    "id": 17027138,
    "node_id": "MDQ6VXNlcjE3MDI3MTM4",
    "avatar_url": "https://avatars.githubusercontent.com/u/17027138?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/MicaiahReid",
    "html_url": "https://github.com/MicaiahReid",
    "followers_url": "https://api.github.com/users/MicaiahReid/followers",
    "following_url": "https://api.github.com/users/MicaiahReid/following{/other_user}",
    "gists_url": "https://api.github.com/users/MicaiahReid/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/MicaiahReid/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/MicaiahReid/subscriptions",
    "organizations_url": "https://api.github.com/users/MicaiahReid/orgs",
    "repos_url": "https://api.github.com/users/MicaiahReid/repos",
    "events_url": "https://api.github.com/users/MicaiahReid/events{/privacy}",
    "received_events_url": "https://api.github.com/users/MicaiahReid/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/4655/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4655/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1022536648",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4655#issuecomment-1022536648",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4655",
    "id": 1022536648,
    "node_id": "IC_kwDOAkfq-c488qvI",
    "user": {
      "login": "gnidan",
      "id": 151065,
      "node_id": "MDQ6VXNlcjE1MTA2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnidan",
      "html_url": "https://github.com/gnidan",
      "followers_url": "https://api.github.com/users/gnidan/followers",
      "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
      "organizations_url": "https://api.github.com/users/gnidan/orgs",
      "repos_url": "https://api.github.com/users/gnidan/repos",
      "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnidan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-26T19:37:26Z",
    "updated_at": "2022-01-26T19:37:26Z",
    "author_association": "MEMBER",
    "body": "Thanks for opening this @vinaykharayat! We'll take a look at this soon and see what we can figure out.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1022536648/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1033050787",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4655#issuecomment-1033050787",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4655",
    "id": 1033050787,
    "node_id": "IC_kwDOAkfq-c49kxqj",
    "user": {
      "login": "kevinweaver",
      "id": 1020682,
      "node_id": "MDQ6VXNlcjEwMjA2ODI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1020682?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kevinweaver",
      "html_url": "https://github.com/kevinweaver",
      "followers_url": "https://api.github.com/users/kevinweaver/followers",
      "following_url": "https://api.github.com/users/kevinweaver/following{/other_user}",
      "gists_url": "https://api.github.com/users/kevinweaver/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kevinweaver/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kevinweaver/subscriptions",
      "organizations_url": "https://api.github.com/users/kevinweaver/orgs",
      "repos_url": "https://api.github.com/users/kevinweaver/repos",
      "events_url": "https://api.github.com/users/kevinweaver/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kevinweaver/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-08T20:52:56Z",
    "updated_at": "2022-02-08T20:52:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @vinaykharayat, [web3 contracts](https://web3js.readthedocs.io/en/v1.2.11/web3-eth-contract.html#contract-events) have an `events` namespace, where as truffle contracts do not. Instead of calling `instance.events.Sell()`, please try `instance.Sell()` directly.  Also, keep in mind that you can only subscribe to events using a websockets provider and not an HTTP provider.  More on the differences [here](https://web3py.readthedocs.io/en/stable/providers.html) and an example of using that with HDWalletProvider [here](https://ethereum.stackexchange.com/questions/35197/how-to-connect-truffle-using-hdwallet-provider-to-websocket-powered-node/74590). Please let me know if that works, thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1033050787/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1069463006",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4655#issuecomment-1069463006",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4655",
    "id": 1069463006,
    "node_id": "IC_kwDOAkfq-c4_vrXe",
    "user": {
      "login": "MicaiahReid",
      "id": 17027138,
      "node_id": "MDQ6VXNlcjE3MDI3MTM4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17027138?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MicaiahReid",
      "html_url": "https://github.com/MicaiahReid",
      "followers_url": "https://api.github.com/users/MicaiahReid/followers",
      "following_url": "https://api.github.com/users/MicaiahReid/following{/other_user}",
      "gists_url": "https://api.github.com/users/MicaiahReid/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MicaiahReid/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MicaiahReid/subscriptions",
      "organizations_url": "https://api.github.com/users/MicaiahReid/orgs",
      "repos_url": "https://api.github.com/users/MicaiahReid/repos",
      "events_url": "https://api.github.com/users/MicaiahReid/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MicaiahReid/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-16T18:46:42Z",
    "updated_at": "2022-03-16T18:46:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "Closing for issue maintenance.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1069463006/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
