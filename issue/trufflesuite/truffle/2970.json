{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/2970",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2970/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2970/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2970/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/2970",
  "id": 601339649,
  "node_id": "MDU6SXNzdWU2MDEzMzk2NDk=",
  "number": 2970,
  "title": "Truffle debug with external contracts",
  "user": {
    "login": "matthieu-beteille",
    "id": 5712325,
    "node_id": "MDQ6VXNlcjU3MTIzMjU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5712325?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/matthieu-beteille",
    "html_url": "https://github.com/matthieu-beteille",
    "followers_url": "https://api.github.com/users/matthieu-beteille/followers",
    "following_url": "https://api.github.com/users/matthieu-beteille/following{/other_user}",
    "gists_url": "https://api.github.com/users/matthieu-beteille/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/matthieu-beteille/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/matthieu-beteille/subscriptions",
    "organizations_url": "https://api.github.com/users/matthieu-beteille/orgs",
    "repos_url": "https://api.github.com/users/matthieu-beteille/repos",
    "events_url": "https://api.github.com/users/matthieu-beteille/events{/privacy}",
    "received_events_url": "https://api.github.com/users/matthieu-beteille/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 230393328,
      "node_id": "MDU6TGFiZWwyMzAzOTMzMjg=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/enhancement",
      "name": "enhancement",
      "color": "84b6eb",
      "default": true,
      "description": null
    },
    {
      "id": 971535002,
      "node_id": "MDU6TGFiZWw5NzE1MzUwMDI=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/Debugger",
      "name": "Debugger",
      "color": "7911ad",
      "default": false,
      "description": ""
    },
    {
      "id": 1675042518,
      "node_id": "MDU6TGFiZWwxNjc1MDQyNTE4",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/priority6%20%F0%9F%92%AD",
      "name": "priority6 ðŸ’­",
      "color": "006b75",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2020-04-16T18:52:49Z",
  "updated_at": "2020-10-24T15:51:59Z",
  "closed_at": "2020-06-07T00:11:32Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "- [x] I've asked for help in the [Truffle Gitter](http://gitter.im/Consensys/truffle) before filing this issue.\r\n\r\n---------------------------\r\n\r\n## Issue\r\n\r\nI am using ganache-cli to fork main-net using the `--fork` flag, also unblocking a given address (using the `-u` flag) which has some tokens that I need to be able to run some transactions and test a few things.\r\n\r\nI have deployed my contract (A) that I compile with truffle to this local fork. This contract speaks to another existing contract already deployed on main-net (B), which speaks to another existing contract (C).\r\n\r\nNow it seems like my code is running fine and at some point calls a function of B which itself calls a function of C. \r\n\r\nAt some point within B or C (not sure), something wrong happens and I get a revert with no message allowing to understand what is wrong.\r\n\r\nWhen I run `truffle debug txHash`, I can see the list of addresses involved in the transaction, and truffle recognizes my contract properly (great!), but doesn't recognise the others (which makes sense to me as the source code is not in my repo). \r\n\r\nSo I can step through my code until it calls B and then it's impossible for me to debug further.\r\n\r\nI haven't found any recommendation around this kind of workflows, could you provide any guidance on how to debug what's happening in these other contracts?\r\n\r\nMy guess is that an ideal solution would involve me copying the contract's source, compiling it, and somehow telling truffle where this contract already lives?\r\n\r\nThank you for your help\r\n\r\n## Steps to Reproduce\r\n\r\nPlease provide the shortest amount of steps to reproduce your issue.\r\n\r\n## Expected Behavior\r\n\r\nWhat you expected to happen.\r\n\r\n## Actual Results\r\n\r\nWhat actually happened. Please give examples and support it with screenshots, copied output or error messages.\r\n\r\n## Environment\r\n\r\n* Operating System: \r\n* Ethereum client:\r\n* Truffle version (`truffle version`):\r\n* node version (`node --version`):\r\n* npm version (`npm --version`): \r\n",
  "closed_by": {
    "login": "haltman-at",
    "id": 35589221,
    "node_id": "MDQ6VXNlcjM1NTg5MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/haltman-at",
    "html_url": "https://github.com/haltman-at",
    "followers_url": "https://api.github.com/users/haltman-at/followers",
    "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
    "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
    "organizations_url": "https://api.github.com/users/haltman-at/orgs",
    "repos_url": "https://api.github.com/users/haltman-at/repos",
    "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
    "received_events_url": "https://api.github.com/users/haltman-at/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/2970/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2970/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/615345399",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2970#issuecomment-615345399",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2970",
    "id": 615345399,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNTM0NTM5OQ==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-17T16:35:16Z",
    "updated_at": "2020-04-17T16:35:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yes, unfortunately there's not a lot we can do here; the debugger depends on having source code and other debugging information.\r\n\r\nBy the way, note that it is *possible* to still step through an external contract to some extent; while the debugger will simply skip over external contracts when using the `n` command (or other similar ones), you can use `;` to step through one EVM instruction at a time.  That's tedious and not very enlightening, though, so I'm assuming that's not what you want.\r\n\r\nThe best solution is probably the one you mention -- include the source code for the external contract in your Truffle project so that the debugger knows about it.  As long as it ends up compiled with the artifacts in your build folder, you shouldn't need to do any additional work to let the debugger know about its address; the debugger can figure that out on its own.  (Or rather the other way around -- the debugger will read the bytecode at that address and see that it matches the contract you included in your project.)\r\n\r\nSo, that's what I would suggest trying first.  Hope that's helpful!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/615345399/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/617924258",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2970#issuecomment-617924258",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2970",
    "id": 617924258,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNzkyNDI1OA==",
    "user": {
      "login": "gnidan",
      "id": 151065,
      "node_id": "MDQ6VXNlcjE1MTA2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnidan",
      "html_url": "https://github.com/gnidan",
      "followers_url": "https://api.github.com/users/gnidan/followers",
      "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
      "organizations_url": "https://api.github.com/users/gnidan/orgs",
      "repos_url": "https://api.github.com/users/gnidan/repos",
      "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnidan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-22T17:34:53Z",
    "updated_at": "2020-04-22T17:34:53Z",
    "author_association": "MEMBER",
    "body": "There's likely a new feature or enhancement here to obtain source code when it's not available (e.g., Truffle could grab verified contract sources from Etherscan before starting the debugger.)\r\n\r\nMoving this to our backlog for when we get the chance. (Or anyone else who is interested in helping out with this, would very much appreciate it!)",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/617924258/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/640135107",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2970#issuecomment-640135107",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2970",
    "id": 640135107,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY0MDEzNTEwNw==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-07T00:11:28Z",
    "updated_at": "2020-06-07T00:11:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "This now exists! :D  Just pass the `--fetch-external` option to the debugger and it'll be able to download sources off Etherscan.  Support for getting them from Sourcify as well is planned.  Closing, hope you like it! :)",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/640135107/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 2,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/715917163",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2970#issuecomment-715917163",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2970",
    "id": 715917163,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNTkxNzE2Mw==",
    "user": {
      "login": "french-maxime-he",
      "id": 32144496,
      "node_id": "MDQ6VXNlcjMyMTQ0NDk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/32144496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/french-maxime-he",
      "html_url": "https://github.com/french-maxime-he",
      "followers_url": "https://api.github.com/users/french-maxime-he/followers",
      "following_url": "https://api.github.com/users/french-maxime-he/following{/other_user}",
      "gists_url": "https://api.github.com/users/french-maxime-he/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/french-maxime-he/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/french-maxime-he/subscriptions",
      "organizations_url": "https://api.github.com/users/french-maxime-he/orgs",
      "repos_url": "https://api.github.com/users/french-maxime-he/repos",
      "events_url": "https://api.github.com/users/french-maxime-he/events{/privacy}",
      "received_events_url": "https://api.github.com/users/french-maxime-he/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-24T13:43:18Z",
    "updated_at": "2020-10-24T13:43:18Z",
    "author_association": "NONE",
    "body": "Are the fetched contracts available on disk somewhere after they are fetched?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/715917163/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/715950985",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2970#issuecomment-715950985",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2970",
    "id": 715950985,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNTk1MDk4NQ==",
    "user": {
      "login": "gnidan",
      "id": 151065,
      "node_id": "MDQ6VXNlcjE1MTA2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/151065?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gnidan",
      "html_url": "https://github.com/gnidan",
      "followers_url": "https://api.github.com/users/gnidan/followers",
      "following_url": "https://api.github.com/users/gnidan/following{/other_user}",
      "gists_url": "https://api.github.com/users/gnidan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gnidan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gnidan/subscriptions",
      "organizations_url": "https://api.github.com/users/gnidan/orgs",
      "repos_url": "https://api.github.com/users/gnidan/repos",
      "events_url": "https://api.github.com/users/gnidan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gnidan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-24T15:51:59Z",
    "updated_at": "2020-10-24T15:51:59Z",
    "author_association": "MEMBER",
    "body": "> Are the fetched contracts available on disk somewhere after they are fetched?\r\n\r\nThey're not right now... this is something we can consider; could you open a new issue for that please?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/715950985/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
