{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/4305",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4305/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4305/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4305/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/4305",
  "id": 996482524,
  "node_id": "I_kwDOAkfq-c47ZR3c",
  "number": 4305,
  "title": "Support colorized Solidity errors and warnings",
  "user": {
    "login": "cameel",
    "id": 137030,
    "node_id": "MDQ6VXNlcjEzNzAzMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cameel",
    "html_url": "https://github.com/cameel",
    "followers_url": "https://api.github.com/users/cameel/followers",
    "following_url": "https://api.github.com/users/cameel/following{/other_user}",
    "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
    "organizations_url": "https://api.github.com/users/cameel/orgs",
    "repos_url": "https://api.github.com/users/cameel/repos",
    "events_url": "https://api.github.com/users/cameel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cameel/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 230393328,
      "node_id": "MDU6TGFiZWwyMzAzOTMzMjg=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/enhancement",
      "name": "enhancement",
      "color": "84b6eb",
      "default": true,
      "description": null
    },
    {
      "id": 1675041996,
      "node_id": "MDU6TGFiZWwxNjc1MDQxOTk2",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/priority4%20%F0%9F%93%8B",
      "name": "priority4 ðŸ“‹",
      "color": "006b75",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2021-09-14T22:12:49Z",
  "updated_at": "2021-09-27T17:44:32Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Feature description\r\n\r\nCurrently Truffle prints Solidity errors and warnings without any coloring even though the compiler provides enough information to format them nicely. This makes the output less readable than it could otherwise be. Truffle should start colorizing them.\r\n\r\nThe Standard JSON output includes both `formattedMessage` and all the components needed to reconstruct it with a custom formatting. The compiler uses the same information internally to colorize its own messages as you can see in the screenshot below.\r\n\r\nSpecific colors are not included but these are up to the tool and its choice of styling appropriate for the interface - for example RGB colors would not necessarily work in a terminal and ANSI sequences would be limiting (if not useless) in a GUI. Since CLI tools are very common, however, future versions of the compiler will likely also include a colorized message with embedded ANSI codes in Standard JSON output - equivalent to what `solc` itself prints to the console. See https://github.com/ethereum/solidity/issues/11507.\r\n\r\n## `solc` behavior\r\nA sample contract with a few bugs: (`C.sol`):\r\n```solidity\r\ncontract C {\r\n    function f() public {}\r\n}\r\n\r\ncontract D is C {\r\n    function f() internal\r\n    override {}\r\n}\r\n```\r\n\r\nThis is what the output of `solc C.sol --color` looks like:\r\n![solc-compiler-errors](https://user-images.githubusercontent.com/137030/133339180-eb132c51-2557-4d87-8d1e-2593612c5708.png)\r\n\r\n## Truffle behavior\r\nThis is what `truffle compile` outputs for the same contract:\r\n![truffle-compiler-errors](https://user-images.githubusercontent.com/137030/133339197-097fa85d-bc01-4296-8417-576474104f67.png)\r\n\r\nThe output is from Truffle v5.4.10 on nodejs v16.9.1 on Linux.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/4305/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4305/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/919556820",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4305#issuecomment-919556820",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4305",
    "id": 919556820,
    "node_id": "IC_kwDOAkfq-c42z1LU",
    "user": {
      "login": "axic",
      "id": 20340,
      "node_id": "MDQ6VXNlcjIwMzQw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20340?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/axic",
      "html_url": "https://github.com/axic",
      "followers_url": "https://api.github.com/users/axic/followers",
      "following_url": "https://api.github.com/users/axic/following{/other_user}",
      "gists_url": "https://api.github.com/users/axic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/axic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/axic/subscriptions",
      "organizations_url": "https://api.github.com/users/axic/orgs",
      "repos_url": "https://api.github.com/users/axic/repos",
      "events_url": "https://api.github.com/users/axic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/axic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-14T22:28:05Z",
    "updated_at": "2021-09-14T22:28:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "Here's a concrete proposal, happy to hear your opinions: https://github.com/ethereum/solidity/issues/11507#issuecomment-919556059",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/919556820/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/920171063",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4305#issuecomment-920171063",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4305",
    "id": 920171063,
    "node_id": "IC_kwDOAkfq-c422LI3",
    "user": {
      "login": "cds-amal",
      "id": 2529600,
      "node_id": "MDQ6VXNlcjI1Mjk2MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2529600?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cds-amal",
      "html_url": "https://github.com/cds-amal",
      "followers_url": "https://api.github.com/users/cds-amal/followers",
      "following_url": "https://api.github.com/users/cds-amal/following{/other_user}",
      "gists_url": "https://api.github.com/users/cds-amal/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cds-amal/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cds-amal/subscriptions",
      "organizations_url": "https://api.github.com/users/cds-amal/orgs",
      "repos_url": "https://api.github.com/users/cds-amal/repos",
      "events_url": "https://api.github.com/users/cds-amal/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cds-amal/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-15T16:26:04Z",
    "updated_at": "2021-09-15T16:26:04Z",
    "author_association": "MEMBER",
    "body": "Thanks @cameel .  This looks like it was specifically run against the native solc compiler. Adding notes for reproduction.\r\n1. install `solc`\r\n1. modify `truffle-config.js` to be\r\n```\r\nmodule.exports = {\r\n  compilers: {\r\n    solc: {\r\n      version: \"native\"\r\n    }\r\n  },\r\n};\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/920171063/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/920176087",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4305#issuecomment-920176087",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4305",
    "id": 920176087,
    "node_id": "IC_kwDOAkfq-c422MXX",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-15T16:33:08Z",
    "updated_at": "2021-09-15T17:42:12Z",
    "author_association": "NONE",
    "body": "I ran it against the soljson binary but I think that with the native compiler Truffle output will be the same because Truffle uses Standard JSON and the compiler does not color that.\r\n\r\nBut anyway, it's really a feature request, not a bug report. Maybe I should not have used the default issue template for this :)\r\nEDIT: I tweaked the description a bit to make it look less like a bug report ;)",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/920176087/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/920184082",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4305#issuecomment-920184082",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4305",
    "id": 920184082,
    "node_id": "IC_kwDOAkfq-c422OUS",
    "user": {
      "login": "cds-amal",
      "id": 2529600,
      "node_id": "MDQ6VXNlcjI1Mjk2MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2529600?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cds-amal",
      "html_url": "https://github.com/cds-amal",
      "followers_url": "https://api.github.com/users/cds-amal/followers",
      "following_url": "https://api.github.com/users/cds-amal/following{/other_user}",
      "gists_url": "https://api.github.com/users/cds-amal/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cds-amal/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cds-amal/subscriptions",
      "organizations_url": "https://api.github.com/users/cds-amal/orgs",
      "repos_url": "https://api.github.com/users/cds-amal/repos",
      "events_url": "https://api.github.com/users/cds-amal/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cds-amal/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-15T16:40:09Z",
    "updated_at": "2021-09-15T16:40:52Z",
    "author_association": "MEMBER",
    "body": "Thanks for the clarification on feature request :) I observed [different output when using default truffle compiler settings](https://asciinema.org/a/yZPDLW2xB8eJ8BkmridkIhk5v). Glad to have an opportunity to look at this.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/920184082/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/920227370",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4305#issuecomment-920227370",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4305",
    "id": 920227370,
    "node_id": "IC_kwDOAkfq-c422Y4q",
    "user": {
      "login": "cameel",
      "id": 137030,
      "node_id": "MDQ6VXNlcjEzNzAzMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/137030?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cameel",
      "html_url": "https://github.com/cameel",
      "followers_url": "https://api.github.com/users/cameel/followers",
      "following_url": "https://api.github.com/users/cameel/following{/other_user}",
      "gists_url": "https://api.github.com/users/cameel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cameel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cameel/subscriptions",
      "organizations_url": "https://api.github.com/users/cameel/orgs",
      "repos_url": "https://api.github.com/users/cameel/repos",
      "events_url": "https://api.github.com/users/cameel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cameel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-15T17:37:18Z",
    "updated_at": "2021-09-15T17:37:47Z",
    "author_association": "NONE",
    "body": "I think it's because you ran it with the default solc (0.5.17). I did not include a full repro in the description since the output I gave is just an example but here it is:\r\n```bash\r\nmkdir truffle-test/\r\ncd truffle-test/\r\nnpm install truffle\r\nnpx truffle init\r\necho 'module.exports.compilers.solc.version = \"0.8.7\";' >> truffle-config.js\r\n\r\ncat <<EOF > contracts/C.sol\r\ncontract C {\r\n    function f() public {}\r\n}\r\n\r\ncontract D is C {\r\n    function f() internal\r\n    override {}\r\n}\r\nEOF\r\n\r\nnpx truffle compile\r\n```\r\n\r\nIf I remove the line that modifies `truffle-config.js`, I get the same output as you.\r\n\r\nBy the way, why is Truffle still defaulting to 0.5.17? I get bitten by that from time to time too :) Would be nice if at least I could easily switch version with something like `truffle config set compilers.solc 0.8.7`.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/920227370/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/920297205",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4305#issuecomment-920297205",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4305",
    "id": 920297205,
    "node_id": "IC_kwDOAkfq-c422p71",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-15T19:00:02Z",
    "updated_at": "2021-09-15T19:00:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "For anyone (@cds-amal? :) ) wanting to working on this issue (and the related issue of all those commas :P ), let me make a few notes about where the relevant code is located.\r\n\r\nThe code for handling Solidity errors currently lives primarily in these two files:\r\n1. [This point](https://github.com/trufflesuite/truffle/blob/develop/packages/compile-solidity/run.js#L48) in run.js and the referenced `detectErrors` function -- this gets the errors & warnings from the output, then fires events and throws errors.  Note that the errors are returned as a joined-together string, but warnings and infos are arrays...?  So the error join happens here.\r\n2. [This file](https://github.com/trufflesuite/truffle/blob/develop/packages/events/defaultSubscribers/compile.js) -- responds to the events and prints messages. The warnings & infos joins happen here.\r\n\r\nNote that there's also a little bit of handling at [here](https://github.com/trufflesuite/truffle/blob/develop/packages/compile-solidity/index.js#L32) for printing a custom Yul warning (bypassing the events system), and of course there's analogous stuff in `compile-vyper`, specifically at [this point](https://github.com/trufflesuite/truffle/blob/develop/packages/compile-vyper/vyper-json.js#L71) in vyper-json.js and its referenced `detectErrors` function.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/920297205/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/921958157",
    "html_url": "https://github.com/trufflesuite/truffle/issues/4305#issuecomment-921958157",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/4305",
    "id": 921958157,
    "node_id": "IC_kwDOAkfq-c428_cN",
    "user": {
      "login": "cds-amal",
      "id": 2529600,
      "node_id": "MDQ6VXNlcjI1Mjk2MDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2529600?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cds-amal",
      "html_url": "https://github.com/cds-amal",
      "followers_url": "https://api.github.com/users/cds-amal/followers",
      "following_url": "https://api.github.com/users/cds-amal/following{/other_user}",
      "gists_url": "https://api.github.com/users/cds-amal/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cds-amal/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cds-amal/subscriptions",
      "organizations_url": "https://api.github.com/users/cds-amal/orgs",
      "repos_url": "https://api.github.com/users/cds-amal/repos",
      "events_url": "https://api.github.com/users/cds-amal/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cds-amal/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-17T17:20:37Z",
    "updated_at": "2021-09-27T17:44:32Z",
    "author_association": "MEMBER",
    "body": "> why is Truffle still defaulting to 0.5.17? I get bitten by that from time to time too :) Would be nice if at least I could easily switch version with something like truffle config set compilers.solc 0.8.7.\r\n\r\nUpdating to latest would be a breaking change to Truffle. It's not ideal. Perhaps we can improve the DX. Not sure what that would look like yet, but we'll be discussing this internally :/",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/921958157/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
