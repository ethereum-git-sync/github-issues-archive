{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/534",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/534/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/534/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/534/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/534",
  "id": 249610260,
  "node_id": "MDU6SXNzdWUyNDk2MTAyNjA=",
  "number": 534,
  "title": "Error: invalid address during migration process",
  "user": {
    "login": "LordotU",
    "id": 1268296,
    "node_id": "MDQ6VXNlcjEyNjgyOTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1268296?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/LordotU",
    "html_url": "https://github.com/LordotU",
    "followers_url": "https://api.github.com/users/LordotU/followers",
    "following_url": "https://api.github.com/users/LordotU/following{/other_user}",
    "gists_url": "https://api.github.com/users/LordotU/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/LordotU/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/LordotU/subscriptions",
    "organizations_url": "https://api.github.com/users/LordotU/orgs",
    "repos_url": "https://api.github.com/users/LordotU/repos",
    "events_url": "https://api.github.com/users/LordotU/events{/privacy}",
    "received_events_url": "https://api.github.com/users/LordotU/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2017-08-11T11:40:32Z",
  "updated_at": "2017-08-22T15:11:05Z",
  "closed_at": "2017-08-22T15:11:05Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "- [+] I've asked for help in the [Truffle Gitter](http://gitter.im/Consensys/truffle) before filing this issue.\r\n\r\n---------------------------\r\n\r\n## Issue\r\n\r\nI can't deploy my contract to Rinkeby network through `truffle migrate --reset --network rinkeby`.\r\n\r\n## Steps to Reproduce\r\n\r\nYou need to run geth in docker.\r\n\r\nInit blockchain from rinkeby genesis file (https://www.rinkeby.io/rinkeby.json - put it to the host directory _$HOME/.ethereum/rinkeby_ (create it if needed) ):\r\n\r\n```bash\r\ndocker run -it --name geth -p 8545:8545 -p 30303:30303 -p 30304:30304 -v $HOME/.ethereum:/root/.ethereum ethereum/client-go --datadir=/root/.ethereum/rinkeby init /root/.ethereum/rinkeby/rinkeby.json\r\n```\r\n\r\nStop and remove container via `docker stop geth && docker rm geth`. Then start it again:\r\n\r\n```bash\r\ndocker run -dit --name geth -p 8545:8545 -p 30303:30303 -p 30304:30304 -v $HOME/.ethereum:/root/.ethereum ethereum/client-go --rpc --rpcaddr 0.0.0.0 --rpccorsdomain=\"*\" --rpcapi admin,debug,eth,miner,net,personal,shh,txpool,web3 --networkid=4 --datadir=/root/.ethereum/rinkeby --cache=32 --syncmode=light '--ethstats=LordotU-Test-Rinkeby:All hail ETH!@stats.rinkeby.io' --bootnodes=enode://a24ac7c5484ef4ed0c5eb2d36620ba4e4aa13b8c84684e1b4aab0cebea2ae45cb4d375b77eab56516d34bfbd3c1a833fc51296ff084b770b94fb9028c4d25ccf@52.169.42.101:30303?discport=30304\r\n```\r\n\r\nYour host should have an ability to accept connections to 8545 inside local loop.\r\n\r\nThen you need to:\r\n\r\n- create one or several accounts (you may exec shell commands inside container via `docker exec -ti geth sh`), unlock it and get some eth from [rinkeby faucet](https://faucet.rinkeby.io/);\r\n- clone my repo from https://github.com/LordotU/secret-santa-smart-contract;\r\n- switch to truffle branch;\r\n- add rinkeby.js file to config/networks directory. File should contents:\r\n```javascript\r\nmodule.exports = {\r\n\tfrom       : 'your_unlocked_and_non_empty_wallet_addres',\r\n\tnetwork_id : 4,\r\n\tgas        : 2700000,\r\n\tgasPrice   : 20000000000,\r\n};\r\n```\r\n- run `truffle compile` and then - `truffle migrate --reset --network rinkeby`.\r\n\r\n## Expected Behavior\r\n\r\nI expect the same as in thecase of development/testrpc network - normal deployment of my contract. :-)\r\n\r\n## Actual Results\r\n\r\nActually I have an error like:\r\n\r\n```\r\nRunning migration: 1_initial_migration.js\r\n  Deploying Migrations...\r\n  ... 0x076235e944e70e561a0b9b6b14307157d07775d67a46689e44ffaf7675829b84\r\n/home/admin/.nvm/versions/node/v8.2.1/lib/node_modules/truffle/build/cli.bundled.js:30534\r\n    throw new Error('invalid address');\r\n    ^\r\n\r\nError: invalid address\r\n    at inputAddressFormatter (/home/admin/.nvm/versions/node/v8.2.1/lib/node_modules/truffle/build/cli.bundled.js:30534:11)\r\n    at /home/admin/.nvm/versions/node/v8.2.1/lib/node_modules/truffle/build/cli.bundled.js:36660:28\r\n    at Array.map (native)\r\n    at Method.formatInput (/home/admin/.nvm/versions/node/v8.2.1/lib/node_modules/truffle/build/cli.bundled.js:36659:32)\r\n    at Method.toPayload (/home/admin/.nvm/versions/node/v8.2.1/lib/node_modules/truffle/build/cli.bundled.js:36685:23)\r\n    at Eth.send [as getCode] (/home/admin/.nvm/versions/node/v8.2.1/lib/node_modules/truffle/build/cli.bundled.js:36710:30)\r\n    at Object.callback (/home/admin/.nvm/versions/node/v8.2.1/lib/node_modules/truffle/build/cli.bundled.js:241521:39)\r\n    at /home/admin/.nvm/versions/node/v8.2.1/lib/node_modules/truffle/build/cli.bundled.js:36713:25\r\n    at /home/admin/.nvm/versions/node/v8.2.1/lib/node_modules/truffle/build/cli.bundled.js:243485:9\r\n    at /home/admin/.nvm/versions/node/v8.2.1/lib/node_modules/truffle/build/cli.bundled.js:78847:11\r\n```\r\n\r\nThe most interesting thing is that I can find this transaction in blockchain explorer: https://rinkeby.etherscan.io/tx/0x076235e944e70e561a0b9b6b14307157d07775d67a46689e44ffaf7675829b84\r\n\r\n## Environment\r\n\r\n* Ubuntu 14.04: \r\n* Truffle v3.4.8:\r\n* Geth 1.7.0-unstable running in Docker (official image):\r\n* Node 8.2.1:\r\n* NPM 5.3.0: \r\n\r\nAll of it running inside one DigitalOcean droplet. _For example, yesterday I had a problem with connection to this Geth-node localy, but freely can connect from outside. The reason was in iptables rules._",
  "closed_by": {
    "login": "LordotU",
    "id": 1268296,
    "node_id": "MDQ6VXNlcjEyNjgyOTY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1268296?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/LordotU",
    "html_url": "https://github.com/LordotU",
    "followers_url": "https://api.github.com/users/LordotU/followers",
    "following_url": "https://api.github.com/users/LordotU/following{/other_user}",
    "gists_url": "https://api.github.com/users/LordotU/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/LordotU/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/LordotU/subscriptions",
    "organizations_url": "https://api.github.com/users/LordotU/orgs",
    "repos_url": "https://api.github.com/users/LordotU/repos",
    "events_url": "https://api.github.com/users/LordotU/events{/privacy}",
    "received_events_url": "https://api.github.com/users/LordotU/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/534/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/534/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/321796791",
    "html_url": "https://github.com/trufflesuite/truffle/issues/534#issuecomment-321796791",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/534",
    "id": 321796791,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMTc5Njc5MQ==",
    "user": {
      "login": "LordotU",
      "id": 1268296,
      "node_id": "MDQ6VXNlcjEyNjgyOTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1268296?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LordotU",
      "html_url": "https://github.com/LordotU",
      "followers_url": "https://api.github.com/users/LordotU/followers",
      "following_url": "https://api.github.com/users/LordotU/following{/other_user}",
      "gists_url": "https://api.github.com/users/LordotU/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LordotU/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LordotU/subscriptions",
      "organizations_url": "https://api.github.com/users/LordotU/orgs",
      "repos_url": "https://api.github.com/users/LordotU/repos",
      "events_url": "https://api.github.com/users/LordotU/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LordotU/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-11T12:10:41Z",
    "updated_at": "2017-08-11T12:10:41Z",
    "author_association": "NONE",
    "body": "I've made a little debug of _cli.bundled.js_ file.\r\n\r\nThis is what I get whe try to deploy in testrpc network:\r\n\r\n```\r\n... 0x34865735e70707919805f2850b823e67adb25ff0fe059d5ece5836d9430a7208\r\n[ [Function: inputAddressFormatter],\r\n  [Function: inputDefaultBlockNumberFormatter] ] [ '0x97280c75faa2e7e1b2a182e34fffcb77c58b9b56' ]\r\n  Migrations: 0x97280c75faa2e7e1b2a182e34fffcb77c58b9b56\r\n```\r\n\r\nAnd in Rinkeby network:\r\n\r\n```\r\n... 0xa2a4697161936052f320bbce9171600741cf155785d25ecf45d914f1445be648\r\n[ [Function: inputAddressFormatter],\r\n  [Function: inputDefaultBlockNumberFormatter] ] [ null ]\r\n```\r\n\r\nAs we can see, in the case of Rinkeby we have _null_ instead of valid contract address. But... why has it happened?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/321796791/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/321818142",
    "html_url": "https://github.com/trufflesuite/truffle/issues/534#issuecomment-321818142",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/534",
    "id": 321818142,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMTgxODE0Mg==",
    "user": {
      "login": "LordotU",
      "id": 1268296,
      "node_id": "MDQ6VXNlcjEyNjgyOTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1268296?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LordotU",
      "html_url": "https://github.com/LordotU",
      "followers_url": "https://api.github.com/users/LordotU/followers",
      "following_url": "https://api.github.com/users/LordotU/following{/other_user}",
      "gists_url": "https://api.github.com/users/LordotU/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LordotU/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LordotU/subscriptions",
      "organizations_url": "https://api.github.com/users/LordotU/orgs",
      "repos_url": "https://api.github.com/users/LordotU/repos",
      "events_url": "https://api.github.com/users/LordotU/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LordotU/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-11T13:52:54Z",
    "updated_at": "2017-08-11T14:23:16Z",
    "author_association": "NONE",
    "body": "Ok, I went deeper.\r\n\r\nSo, when executes this line (https://github.com/ethereum/web3.js/blob/develop/lib/web3/contract.js#L119) of web3.js code (line 222802 in Truffel's _cli.bundled.js_) we are getting answer with _null_ in _contractAddress_ field.\r\n\r\nFor example:\r\n\r\n```\r\n{ \r\n  blockHash: '0xd08cee7ec0d9e50185099ca403b53798081f94ba73bbb9caa7a72fa2afb2591f',\r\n  blockNumber: 696482,\r\n  contractAddress: null,\r\n  cumulativeGasUsed: 201492,\r\n  from: '0xdc2e0c6e3d08bc53200ea0a90ec4f550d9d1f616',\r\n  gasUsed: 0,\r\n  logs: [],\r\n  logsBloom: '0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000',\r\n  root: '0x4ae760bf36bd646016db7018f16f6e5fadc2200aee17a89337b6d0a26534fb03',\r\n  to: null,\r\n  transactionHash: '0x6863a10cc9e42f62056f5defebd9f249ced92c024c1cb2ed94ae1a1efb1a5cc5',\r\n  transactionIndex: 0 \r\n}\r\n```\r\n\r\nAnd example for testrpc which works properly:\r\n\r\n```\r\n{ \r\n  transactionHash: '0x55bb0dc39488b897ced17831ff6308741045b463993d3b2d239748434b134b89',\r\n  transactionIndex: 0,\r\n  blockHash: '0xa04dc4a145b6884dfa78cfc4d55888b4e6c2ed41b8888cff72458728b474f6da',\r\n  blockNumber: 15,\r\n  gasUsed: 201262,\r\n  cumulativeGasUsed: 201262,\r\n  contractAddress: '0x0bfed93fdbcd00323918ad1d361cd999ba291ce4',\r\n  logs: []\r\n }\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/321818142/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/322063323",
    "html_url": "https://github.com/trufflesuite/truffle/issues/534#issuecomment-322063323",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/534",
    "id": 322063323,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMjA2MzMyMw==",
    "user": {
      "login": "LordotU",
      "id": 1268296,
      "node_id": "MDQ6VXNlcjEyNjgyOTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1268296?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/LordotU",
      "html_url": "https://github.com/LordotU",
      "followers_url": "https://api.github.com/users/LordotU/followers",
      "following_url": "https://api.github.com/users/LordotU/following{/other_user}",
      "gists_url": "https://api.github.com/users/LordotU/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/LordotU/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/LordotU/subscriptions",
      "organizations_url": "https://api.github.com/users/LordotU/orgs",
      "repos_url": "https://api.github.com/users/LordotU/repos",
      "events_url": "https://api.github.com/users/LordotU/events{/privacy}",
      "received_events_url": "https://api.github.com/users/LordotU/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-13T19:49:50Z",
    "updated_at": "2017-08-13T19:49:50Z",
    "author_association": "NONE",
    "body": "I've found the reason.\r\n_contractAddress_ is _null_ because I'm using geth node in embedded/light mode - it hasn't enough information about blockchain.\r\nIssue may be closed.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/322063323/reactions",
      "total_count": 13,
      "+1": 13,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
