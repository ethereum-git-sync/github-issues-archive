{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/3867",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3867/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3867/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3867/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/3867",
  "id": 813841471,
  "node_id": "MDU6SXNzdWU4MTM4NDE0NzE=",
  "number": 3867,
  "title": "Deployer.deploy should return the deployed contract",
  "user": {
    "login": "haltman-at",
    "id": 35589221,
    "node_id": "MDQ6VXNlcjM1NTg5MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/haltman-at",
    "html_url": "https://github.com/haltman-at",
    "followers_url": "https://api.github.com/users/haltman-at/followers",
    "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
    "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
    "organizations_url": "https://api.github.com/users/haltman-at/orgs",
    "repos_url": "https://api.github.com/users/haltman-at/repos",
    "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
    "received_events_url": "https://api.github.com/users/haltman-at/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 230393328,
      "node_id": "MDU6TGFiZWwyMzAzOTMzMjg=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/enhancement",
      "name": "enhancement",
      "color": "84b6eb",
      "default": true,
      "description": null
    },
    {
      "id": 1675041996,
      "node_id": "MDU6TGFiZWwxNjc1MDQxOTk2",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/priority4%20%F0%9F%93%8B",
      "name": "priority4 ðŸ“‹",
      "color": "006b75",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2021-02-22T20:33:06Z",
  "updated_at": "2022-06-21T17:29:04Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Issue\r\n\r\nIn migrations, it's a pain to have to write\r\n\r\n```javascript\r\nawait deployer.deploy(Contract);\r\nlet instance = await Contract.deployed();\r\n```\r\n\r\nIt would be much more convenient to be able to write\r\n\r\n```javascript\r\nlet instance = await deployer.deploy(Contract);\r\n```\r\n\r\nSo, `deployer.deploy` ought to return (a promise that resolves to) the deployed contract.  Right now it doesn't return anything and you have to get the deployed contract in a separate step.\r\n\r\n## Environment\r\n\r\n* Truffle version (`truffle version`): 5.1.67\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/3867/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3867/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1158025771",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3867#issuecomment-1158025771",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3867",
    "id": 1158025771,
    "node_id": "IC_kwDOAkfq-c5FBhIr",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-16T18:56:50Z",
    "updated_at": "2022-06-16T18:56:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "Btw, this also applies to the (undocumented!) `deployer.new`.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1158025771/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1158102133",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3867#issuecomment-1158102133",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3867",
    "id": 1158102133,
    "node_id": "IC_kwDOAkfq-c5FBzx1",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-16T20:30:42Z",
    "updated_at": "2022-06-16T20:30:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hm, so I looked at this a bit and I'm uncertain whether it's possible to fix this without a breaking change.  In Truffle 6 we can rip out all the deferred chain nonsense, but obviously we can't do that yet.  It seems like right now in order for the deferred chain to work, `deployer.deploy` has to return the deferred chain instance, rather than the contract instance.  I'm pretty doubtful there's any way to make the former await to the latter...",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1158102133/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1158128516",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3867#issuecomment-1158128516",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3867",
    "id": 1158128516,
    "node_id": "IC_kwDOAkfq-c5FB6OE",
    "user": {
      "login": "sukanyaparashar",
      "id": 25079663,
      "node_id": "MDQ6VXNlcjI1MDc5NjYz",
      "avatar_url": "https://avatars.githubusercontent.com/u/25079663?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sukanyaparashar",
      "html_url": "https://github.com/sukanyaparashar",
      "followers_url": "https://api.github.com/users/sukanyaparashar/followers",
      "following_url": "https://api.github.com/users/sukanyaparashar/following{/other_user}",
      "gists_url": "https://api.github.com/users/sukanyaparashar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sukanyaparashar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sukanyaparashar/subscriptions",
      "organizations_url": "https://api.github.com/users/sukanyaparashar/orgs",
      "repos_url": "https://api.github.com/users/sukanyaparashar/repos",
      "events_url": "https://api.github.com/users/sukanyaparashar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sukanyaparashar/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-16T21:03:14Z",
    "updated_at": "2022-06-16T21:03:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Hm, so I looked at this a bit and I'm uncertain whether it's possible to fix this without a breaking change. In Truffle 6 we can rip out all the deferred chain nonsense, but obviously we can't do that yet. It seems like right now in order for the deferred chain to work, `deployer.deploy` has to return the deferred chain instance, rather than the contract instance. I'm pretty doubtful there's any way to make the former await to the latter...\r\n\r\nI have also looked into this issue but didn't find a proper way to return the contract instance. I have a draft PR opened for this but I think for now I might delete the draft as it seems we will have to wait for this to be resolved.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1158128516/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1161949553",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3867#issuecomment-1161949553",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3867",
    "id": 1161949553,
    "node_id": "IC_kwDOAkfq-c5FQfFx",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-21T15:57:12Z",
    "updated_at": "2022-06-21T15:57:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "@haltman-at would the breaking change be just for @truffle/deployer or would it be breaking for Truffle more generally?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1161949553/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1162057763",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3867#issuecomment-1162057763",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3867",
    "id": 1162057763,
    "node_id": "IC_kwDOAkfq-c5FQ5gj",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-06-21T17:29:04Z",
    "updated_at": "2022-06-21T17:29:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'd call it breaking for Truffle, as it would break lots of existing migrations code.  I suppose that's a question for @gnidan if we want to be sure, though.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/1162057763/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
