{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/3570",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3570/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3570/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3570/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/3570",
  "id": 753548508,
  "node_id": "MDU6SXNzdWU3NTM1NDg1MDg=",
  "number": 3570,
  "title": "Migrations contract should be Ownable so that it includes transferOwnership â€” helpful with Gnosis Safe workflow",
  "user": {
    "login": "marsrobertson",
    "id": 44369284,
    "node_id": "MDQ6VXNlcjQ0MzY5Mjg0",
    "avatar_url": "https://avatars.githubusercontent.com/u/44369284?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/marsrobertson",
    "html_url": "https://github.com/marsrobertson",
    "followers_url": "https://api.github.com/users/marsrobertson/followers",
    "following_url": "https://api.github.com/users/marsrobertson/following{/other_user}",
    "gists_url": "https://api.github.com/users/marsrobertson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/marsrobertson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/marsrobertson/subscriptions",
    "organizations_url": "https://api.github.com/users/marsrobertson/orgs",
    "repos_url": "https://api.github.com/users/marsrobertson/repos",
    "events_url": "https://api.github.com/users/marsrobertson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/marsrobertson/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2020-11-30T14:58:27Z",
  "updated_at": "2021-01-13T19:03:54Z",
  "closed_at": "2021-01-13T19:03:53Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Current `Migrations.sol`\r\n\r\nhttps://github.com/trufflesuite/truffle/blob/1f9ab16819b7e0ea994a9add63d35d6a74932985/packages/core/lib/commands/init/initSource/contracts/Migrations.sol#L4-L19\r\n\r\nCurrently **ONLY OWNER** can call the function.\r\n\r\nI suggest adding `transferOwnership` function so that the ownership can be passed to the Gnosis Safe Multisig.\r\n\r\nSuggested upgrade process:\r\n- `transferOwnership` to a EOA (externally owned account)\r\n- use that EOA to `prepareUpgrade`\r\n- use Gnosis Safe Multisig and OpenZeppelin app to actually trigger the upgrade\r\n- `transferOwnership` from EOA back to Gnosis Safe Multisig\r\n\r\nAdding the `transferOwnership` is trivial: making `Migrations` `Ownable`\r\n\r\nSource: https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable.sol \r\n\r\n**MAIN QUESTION:** are there any unintended consequences, negative side effects, problematic issues?\r\n\r\n### Related\r\n\r\nMassively inspired by this tutorial: https://forum.openzeppelin.com/t/openzeppelin-upgrades-step-by-step-tutorial-for-truffle/3579\r\n\r\n```\r\n// migrations/4_prepare_upgrade_boxv2.js\r\nconst Box = artifacts.require('Box');\r\nconst BoxV2 = artifacts.require('BoxV2');\r\n \r\nconst { prepareUpgrade } = require('@openzeppelin/truffle-upgrades');\r\n \r\nmodule.exports = async function (deployer) {\r\n  const box = await Box.deployed();\r\n  await prepareUpgrade(box.address, BoxV2, { deployer });\r\n};\r\n```\r\n\r\nIn my workflow, the ProxyAdmin and the guy who has all the permissions is Gnosis Safe. The deployer is EOA (regular account). I'm thinking about `transferOwnership` to Gnosis Safe. But it is not transferable... I think that adding `TransferOwnership` it is a simple acceptable change?",
  "closed_by": {
    "login": "fainashalts",
    "id": 8952139,
    "node_id": "MDQ6VXNlcjg5NTIxMzk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/8952139?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fainashalts",
    "html_url": "https://github.com/fainashalts",
    "followers_url": "https://api.github.com/users/fainashalts/followers",
    "following_url": "https://api.github.com/users/fainashalts/following{/other_user}",
    "gists_url": "https://api.github.com/users/fainashalts/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fainashalts/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fainashalts/subscriptions",
    "organizations_url": "https://api.github.com/users/fainashalts/orgs",
    "repos_url": "https://api.github.com/users/fainashalts/repos",
    "events_url": "https://api.github.com/users/fainashalts/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fainashalts/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/3570/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3570/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/737429569",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3570#issuecomment-737429569",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3570",
    "id": 737429569,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNzQyOTU2OQ==",
    "user": {
      "login": "eggplantzzz",
      "id": 14827965,
      "node_id": "MDQ6VXNlcjE0ODI3OTY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/14827965?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eggplantzzz",
      "html_url": "https://github.com/eggplantzzz",
      "followers_url": "https://api.github.com/users/eggplantzzz/followers",
      "following_url": "https://api.github.com/users/eggplantzzz/following{/other_user}",
      "gists_url": "https://api.github.com/users/eggplantzzz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eggplantzzz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eggplantzzz/subscriptions",
      "organizations_url": "https://api.github.com/users/eggplantzzz/orgs",
      "repos_url": "https://api.github.com/users/eggplantzzz/repos",
      "events_url": "https://api.github.com/users/eggplantzzz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eggplantzzz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-02T18:57:49Z",
    "updated_at": "2020-12-02T18:57:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hey @marsrobertson, thanks for the suggestion. Actually we are kind of moving in the direction of making the Migrations contract not part of the default Truffle workflow. In the future, we will continue to support this contract but it doesn't seem to really make sense for us to make it more robust. \r\n\r\nHowever, currently you are totally able to make whatever edits you want to this contract and it should be fine after migrations are complete. During migrations Truffle does need access to this contract because it interacts with this contract from an EOA. Is this ok or did you want to propose something different?",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/737429569/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/759654598",
    "html_url": "https://github.com/trufflesuite/truffle/issues/3570#issuecomment-759654598",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/3570",
    "id": 759654598,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1OTY1NDU5OA==",
    "user": {
      "login": "fainashalts",
      "id": 8952139,
      "node_id": "MDQ6VXNlcjg5NTIxMzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8952139?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fainashalts",
      "html_url": "https://github.com/fainashalts",
      "followers_url": "https://api.github.com/users/fainashalts/followers",
      "following_url": "https://api.github.com/users/fainashalts/following{/other_user}",
      "gists_url": "https://api.github.com/users/fainashalts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fainashalts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fainashalts/subscriptions",
      "organizations_url": "https://api.github.com/users/fainashalts/orgs",
      "repos_url": "https://api.github.com/users/fainashalts/repos",
      "events_url": "https://api.github.com/users/fainashalts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fainashalts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-13T19:03:53Z",
    "updated_at": "2021-01-13T19:03:53Z",
    "author_association": "MEMBER",
    "body": "Hi @marsrobertson we are closing this issue for maintenance, but if you need any help relating to this issue, feel free to open a new issue!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/759654598/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
