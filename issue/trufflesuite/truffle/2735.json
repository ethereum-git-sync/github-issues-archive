{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/2735",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2735/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2735/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2735/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/2735",
  "id": 547199616,
  "node_id": "MDU6SXNzdWU1NDcxOTk2MTY=",
  "number": 2735,
  "title": "Test isolation doesn't work when snapshots aren't available",
  "user": {
    "login": "haltman-at",
    "id": 35589221,
    "node_id": "MDQ6VXNlcjM1NTg5MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/haltman-at",
    "html_url": "https://github.com/haltman-at",
    "followers_url": "https://api.github.com/users/haltman-at/followers",
    "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
    "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
    "organizations_url": "https://api.github.com/users/haltman-at/orgs",
    "repos_url": "https://api.github.com/users/haltman-at/repos",
    "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
    "received_events_url": "https://api.github.com/users/haltman-at/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 230393326,
      "node_id": "MDU6TGFiZWwyMzAzOTMzMjY=",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/bug",
      "name": "bug",
      "color": "fc2929",
      "default": true,
      "description": null
    },
    {
      "id": 1675042518,
      "node_id": "MDU6TGFiZWwxNjc1MDQyNTE4",
      "url": "https://api.github.com/repos/trufflesuite/truffle/labels/priority6%20%F0%9F%92%AD",
      "name": "priority6 ðŸ’­",
      "color": "006b75",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2020-01-09T01:43:26Z",
  "updated_at": "2020-05-12T17:04:34Z",
  "closed_at": "2020-05-12T17:04:34Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Issue\r\n\r\nThis issue is a continuation of issue #2710.  When I broke test isolation in Truffle 5.1.5, what actually happened was that I broke `truffle test`'s ability to use snapshots.  Fortunately, Truffle has a fallback ready if snapshots aren't available: Doing a reset redeploy.  Unfortunately, it seems this fallback doesn't actually work for test isolation, which is why it caused a problem when I exposed it.\r\n\r\nSo what's going on here?  Well, the reset redeploy does occur.  Unfortunately, for whatever reason, the contract instance objects in the tests still have the old addresses, not the new addresses!  So they still point to the old contracts, and the tests fail to be isolated from one another.\r\n\r\n## Steps to Reproduce\r\n\r\nSee https://github.com/mrice32/truffle_example, but use an environment where snapshots are not available.  (Or, modify the `truffle test` code so that it always sees snapshots as unavailable.  Or, use Truffle 5.1.5-5.1.7, where I accidentally broke snapshotting in `truffle test`.)\r\n\r\n## Expected Behavior\r\n\r\nBoth tests should pass.\r\n\r\n## Actual Results\r\n\r\nThe second test fails.\r\n\r\n## Environment\r\n\r\n* Ethereum client: Ganache CLI v6.4.3 (ganache-core: 2.5.5)\r\n* Truffle version (`truffle version`): 5.1.7\r\n* node version (`node --version`): 10.15.3\r\n* npm version (`npm --version`):  6.13.0\r\n\r\n(Alternatively, see the original issue.)",
  "closed_by": {
    "login": "haltman-at",
    "id": 35589221,
    "node_id": "MDQ6VXNlcjM1NTg5MjIx",
    "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/haltman-at",
    "html_url": "https://github.com/haltman-at",
    "followers_url": "https://api.github.com/users/haltman-at/followers",
    "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
    "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
    "organizations_url": "https://api.github.com/users/haltman-at/orgs",
    "repos_url": "https://api.github.com/users/haltman-at/repos",
    "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
    "received_events_url": "https://api.github.com/users/haltman-at/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/2735/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2735/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/627471805",
    "html_url": "https://github.com/trufflesuite/truffle/issues/2735#issuecomment-627471805",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/2735",
    "id": 627471805,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNzQ3MTgwNQ==",
    "user": {
      "login": "haltman-at",
      "id": 35589221,
      "node_id": "MDQ6VXNlcjM1NTg5MjIx",
      "avatar_url": "https://avatars.githubusercontent.com/u/35589221?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haltman-at",
      "html_url": "https://github.com/haltman-at",
      "followers_url": "https://api.github.com/users/haltman-at/followers",
      "following_url": "https://api.github.com/users/haltman-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/haltman-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haltman-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haltman-at/subscriptions",
      "organizations_url": "https://api.github.com/users/haltman-at/orgs",
      "repos_url": "https://api.github.com/users/haltman-at/repos",
      "events_url": "https://api.github.com/users/haltman-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haltman-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-12T17:04:34Z",
    "updated_at": "2020-05-12T17:04:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "Closing this as discussion has moved to #3023!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/627471805/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
