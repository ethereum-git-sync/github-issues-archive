{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/859",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/859/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/859/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/859/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/859",
  "id": 307165686,
  "node_id": "MDU6SXNzdWUzMDcxNjU2ODY=",
  "number": 859,
  "title": "Truffle Error-VM Exception while processing transaction: revert",
  "user": {
    "login": "ayushtchetu",
    "id": 37119638,
    "node_id": "MDQ6VXNlcjM3MTE5NjM4",
    "avatar_url": "https://avatars.githubusercontent.com/u/37119638?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ayushtchetu",
    "html_url": "https://github.com/ayushtchetu",
    "followers_url": "https://api.github.com/users/ayushtchetu/followers",
    "following_url": "https://api.github.com/users/ayushtchetu/following{/other_user}",
    "gists_url": "https://api.github.com/users/ayushtchetu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ayushtchetu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ayushtchetu/subscriptions",
    "organizations_url": "https://api.github.com/users/ayushtchetu/orgs",
    "repos_url": "https://api.github.com/users/ayushtchetu/repos",
    "events_url": "https://api.github.com/users/ayushtchetu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ayushtchetu/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2018-03-21T09:13:34Z",
  "updated_at": "2018-03-22T04:26:16Z",
  "closed_at": "2018-03-22T04:26:16Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "- [ ] I've asked for help in the [Truffle Gitter](http://gitter.im/Consensys/truffle) before filing this issue.\r\n\r\n---------------------------\r\n\r\n## Issue\r\nI am creating test case of solidity in truffle and my solidity function is given below for which I am creating test cases\r\n```\r\nfunction isValidBuyer(uint256 buyTokenQty, uint256 senderValue) public  constant returns (bool)\r\n    {\r\n        if(!isUserExist(msg.sender))\r\n        {\r\n            msg.sender.transfer(senderValue); //Refund Ether\r\n            return false ; \r\n        }\r\n        else \r\n        {\r\n            return true ;\r\n        }\r\n    }\r\n\r\n```\r\nAnd my test cases is as given below\r\n```\r\nit('TCC001: should check invalid buyer and should return false',   async () => {\r\nlet tempRes1=await instChain.isValidBuyer(100,1,{from:account2,gas:'220000'});\r\n\r\n assert.isTrue(!tempRes1);\r\n}); \r\n\r\n```\r\nWhile testing if clause of function in this test I am getting error VM Exception while processing transaction: revert One interesting case is in function isValidBuyer() when I am passing 1 wei it gives above mentioned exception but when I send 0.99 or less it gets execute successfully without error and returms false as expected..\r\n\r\n## Expected Behavior\r\n\r\nShould transfer ethers and return false\r\n\r\n## Actual Results\r\n\r\n-VM Exception while processing transaction: revert\r\n\r\n## Environment\r\n\r\n* Operating System: Windows 8 64 bit\r\n* Ethereum client:\r\n* Truffle version (`truffle version`): 4.1.3\r\n* node version (`node --version`): 9.7.1\r\n* npm version (`npm --version`): 5.6.0\r\n",
  "closed_by": {
    "login": "cgewecke",
    "id": 7332026,
    "node_id": "MDQ6VXNlcjczMzIwMjY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cgewecke",
    "html_url": "https://github.com/cgewecke",
    "followers_url": "https://api.github.com/users/cgewecke/followers",
    "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
    "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
    "organizations_url": "https://api.github.com/users/cgewecke/orgs",
    "repos_url": "https://api.github.com/users/cgewecke/repos",
    "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cgewecke/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/859/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/859/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/374957026",
    "html_url": "https://github.com/trufflesuite/truffle/issues/859#issuecomment-374957026",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/859",
    "id": 374957026,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NDk1NzAyNg==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-21T14:30:17Z",
    "updated_at": "2018-03-21T14:30:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ayushtchetu. Your method changes state and will return a transaction receipt rather than boolean value.  \r\n\r\nCould you try removing the `constant` modifier as well as the function return logic? Instead of checking for true/false, test the recipient account for an increase of value after the method successfully executes using [web3 methods](https://github.com/ethereum/wiki/wiki/JavaScript-API#web3ethgetbalance). You might also want to test the contract balance before executing `isValidBuyer` to verify that the contract has ether to send. \r\n\r\nIf the value you transfer is tiny (1 wei is the lowest possible value) it will be dwarfed by the gas costs of executing the transaction. Your ganache accounts are automatically seeded with 100 ether so you should be able to send larger amounts without running out. ",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/374957026/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/375175897",
    "html_url": "https://github.com/trufflesuite/truffle/issues/859#issuecomment-375175897",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/859",
    "id": 375175897,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTE3NTg5Nw==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-22T04:26:16Z",
    "updated_at": "2018-03-22T04:26:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ayushtchetu I'm closing this because seems like a solidity usage issue rather than something truffle specific. Please feel free to re-open if you believe there is a bug on our end. Thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/375175897/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
