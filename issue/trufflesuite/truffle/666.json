{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/666",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/666/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/666/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/666/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/666",
  "id": 271169371,
  "node_id": "MDU6SXNzdWUyNzExNjkzNzE=",
  "number": 666,
  "title": "Test suite runs out of gas before finishing",
  "user": {
    "login": "ngan",
    "id": 16579,
    "node_id": "MDQ6VXNlcjE2NTc5",
    "avatar_url": "https://avatars.githubusercontent.com/u/16579?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ngan",
    "html_url": "https://github.com/ngan",
    "followers_url": "https://api.github.com/users/ngan/followers",
    "following_url": "https://api.github.com/users/ngan/following{/other_user}",
    "gists_url": "https://api.github.com/users/ngan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ngan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ngan/subscriptions",
    "organizations_url": "https://api.github.com/users/ngan/orgs",
    "repos_url": "https://api.github.com/users/ngan/repos",
    "events_url": "https://api.github.com/users/ngan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ngan/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2017-11-04T05:55:23Z",
  "updated_at": "2017-11-30T16:45:23Z",
  "closed_at": "2017-11-28T19:39:33Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "- [x] I've asked for help in the [Truffle Gitter](http://gitter.im/Consensys/truffle) before filing this issue.\r\n\r\n---------------------------\r\n\r\n## Issue\r\n\r\nI have a very large test suite that tests my contract very thoroughly. It also tests invalid calls, so when those tests run, ALL the gas for that transaction gets used up. Eventually, after a certain number of tests, the whole suite fails because of not enough gas to even start the next transaction. Is there a way to be able to have very large and expensive test suites finish completely? Is there a way to Ether to the default generated addresses? Is there a way to lower the gas price to 0 or something very very small automatically?",
  "closed_by": {
    "login": "tcoulter",
    "id": 92629,
    "node_id": "MDQ6VXNlcjkyNjI5",
    "avatar_url": "https://avatars.githubusercontent.com/u/92629?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tcoulter",
    "html_url": "https://github.com/tcoulter",
    "followers_url": "https://api.github.com/users/tcoulter/followers",
    "following_url": "https://api.github.com/users/tcoulter/following{/other_user}",
    "gists_url": "https://api.github.com/users/tcoulter/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tcoulter/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tcoulter/subscriptions",
    "organizations_url": "https://api.github.com/users/tcoulter/orgs",
    "repos_url": "https://api.github.com/users/tcoulter/repos",
    "events_url": "https://api.github.com/users/tcoulter/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tcoulter/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/666/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/666/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/343638298",
    "html_url": "https://github.com/trufflesuite/truffle/issues/666#issuecomment-343638298",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/666",
    "id": 343638298,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzYzODI5OA==",
    "user": {
      "login": "vladwulf",
      "id": 7473791,
      "node_id": "MDQ6VXNlcjc0NzM3OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7473791?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vladwulf",
      "html_url": "https://github.com/vladwulf",
      "followers_url": "https://api.github.com/users/vladwulf/followers",
      "following_url": "https://api.github.com/users/vladwulf/following{/other_user}",
      "gists_url": "https://api.github.com/users/vladwulf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vladwulf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vladwulf/subscriptions",
      "organizations_url": "https://api.github.com/users/vladwulf/orgs",
      "repos_url": "https://api.github.com/users/vladwulf/repos",
      "events_url": "https://api.github.com/users/vladwulf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vladwulf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-11T03:53:06Z",
    "updated_at": "2017-11-11T03:53:06Z",
    "author_association": "NONE",
    "body": "I suggest using testrpc with a large gas limit parameter:\r\n`testrpc --gasLimit 300000000` the default is 9000\r\nIf that is still a problem, put a high value (but lower than the one above) for the gas field in the truffle.js inside your project.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/343638298/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/347639827",
    "html_url": "https://github.com/trufflesuite/truffle/issues/666#issuecomment-347639827",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/666",
    "id": 347639827,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NzYzOTgyNw==",
    "user": {
      "login": "tcoulter",
      "id": 92629,
      "node_id": "MDQ6VXNlcjkyNjI5",
      "avatar_url": "https://avatars.githubusercontent.com/u/92629?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tcoulter",
      "html_url": "https://github.com/tcoulter",
      "followers_url": "https://api.github.com/users/tcoulter/followers",
      "following_url": "https://api.github.com/users/tcoulter/following{/other_user}",
      "gists_url": "https://api.github.com/users/tcoulter/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tcoulter/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tcoulter/subscriptions",
      "organizations_url": "https://api.github.com/users/tcoulter/orgs",
      "repos_url": "https://api.github.com/users/tcoulter/repos",
      "events_url": "https://api.github.com/users/tcoulter/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tcoulter/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-28T19:39:33Z",
    "updated_at": "2017-11-28T19:39:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "Are you running Solidity tests or Javascript tests?\n\nIn both Solidity and Javascript tests suites, tests are made up of many transactions -- not just one transaction. If your tests are running out of gas, it means your transactions are running out of gas (a bad thing; you should figure out why). \n\nNote that the only exception here is Solidity tests, in that you can you can write a single Solidity test that fills up the gas limit in a single transaction. To get around this, use the [available hooks](http://truffleframework.com/docs/getting_started/solidity-tests#before-after-hooks) in your solidity test suite break up your tests into multiple transactions.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/347639827/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/348247606",
    "html_url": "https://github.com/trufflesuite/truffle/issues/666#issuecomment-348247606",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/666",
    "id": 348247606,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0ODI0NzYwNg==",
    "user": {
      "login": "ngan",
      "id": 16579,
      "node_id": "MDQ6VXNlcjE2NTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/16579?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ngan",
      "html_url": "https://github.com/ngan",
      "followers_url": "https://api.github.com/users/ngan/followers",
      "following_url": "https://api.github.com/users/ngan/following{/other_user}",
      "gists_url": "https://api.github.com/users/ngan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ngan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ngan/subscriptions",
      "organizations_url": "https://api.github.com/users/ngan/orgs",
      "repos_url": "https://api.github.com/users/ngan/repos",
      "events_url": "https://api.github.com/users/ngan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ngan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-30T16:45:23Z",
    "updated_at": "2017-11-30T16:45:23Z",
    "author_association": "NONE",
    "body": "Hi @tcoulter I'm using javascript tests. I think what's happening is I'm testing error cases, and upon error the entire gas limit is used up for that transaction (even though I'm using `require` to stop the transaction). I thought in the latest Ethereum client specs, transactions are prorated when `require` throws an error instead of consuming all the gas.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/348247606/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
