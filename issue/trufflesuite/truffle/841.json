{
  "url": "https://api.github.com/repos/trufflesuite/truffle/issues/841",
  "repository_url": "https://api.github.com/repos/trufflesuite/truffle",
  "labels_url": "https://api.github.com/repos/trufflesuite/truffle/issues/841/labels{/name}",
  "comments_url": "https://api.github.com/repos/trufflesuite/truffle/issues/841/comments",
  "events_url": "https://api.github.com/repos/trufflesuite/truffle/issues/841/events",
  "html_url": "https://github.com/trufflesuite/truffle/issues/841",
  "id": 304180775,
  "node_id": "MDU6SXNzdWUzMDQxODA3NzU=",
  "number": 841,
  "title": "new BigNumber() not a number when deploying OpenZeppelin Crowdsale",
  "user": {
    "login": "reasv",
    "id": 7143787,
    "node_id": "MDQ6VXNlcjcxNDM3ODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7143787?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/reasv",
    "html_url": "https://github.com/reasv",
    "followers_url": "https://api.github.com/users/reasv/followers",
    "following_url": "https://api.github.com/users/reasv/following{/other_user}",
    "gists_url": "https://api.github.com/users/reasv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/reasv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/reasv/subscriptions",
    "organizations_url": "https://api.github.com/users/reasv/orgs",
    "repos_url": "https://api.github.com/users/reasv/repos",
    "events_url": "https://api.github.com/users/reasv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/reasv/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2018-03-11T18:22:20Z",
  "updated_at": "2018-10-28T10:27:34Z",
  "closed_at": "2018-03-14T15:56:42Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "- [x] I've asked for help in the [Truffle Gitter](http://gitter.im/Consensys/truffle) before filing this issue.\r\n\r\n---------------------------\r\n\r\n## Issue\r\nI am getting this when deploying the OpenZeppelin Crowdsale, and I don't really understand where the issue is.\r\n```\r\nBigNumber Error: new BigNumber() not a number: function TruffleContract() { \r\n    this.constructor = temp;\r\n    return Contract.apply(this, arguments);\r\n}\r\n```\r\nThe OpenZeppelin contract should be correct since I didn't change it, I just inherited from it.\r\n\r\n## Steps to Reproduce\r\nI deploy by running migrate from within truffle develop.\r\nMy deployment script is very barebones:\r\n```Javascript\r\nvar EToken = artifacts.require(\"EToken\");\r\nvar TestIco = artifacts.require(\"TestIco\");\r\n\r\nmodule.exports = function(deployer, network, accounts) {\r\n  deployer.deploy(EToken).then( function (){\r\n    deployer.deploy(TestIco, EToken)\r\n  });\r\n\r\n};\r\n```\r\nAs are the two smart contracts:\r\n`TestIco.sol`\r\n```Solidity\r\npragma solidity ^0.4.13;\r\n\r\nimport 'zeppelin-solidity/contracts/crowdsale/Crowdsale.sol';\r\n\r\n\r\ncontract TestIco is Crowdsale {\r\n\r\n  function TestIco(ERC20 _token) Crowdsale(100, msg.sender, _token) {     \r\n  }\r\n}\r\n\r\n```\r\n`EToken.sol`\r\n```Solidity\r\npragma solidity ^0.4.13;\r\n\r\nimport 'zeppelin-solidity/contracts/token/ERC20/MintableToken.sol';\r\n\r\ncontract EToken is MintableToken {\r\n  string public name = \"Test Token\";\r\n  string public symbol = \"TTK\";\r\n  uint8 public decimals = 18;\r\n}\r\n```\r\n\r\n## Full Output\r\n```\r\nUsing network 'develop'.\r\n\r\nRunning migration: 1_initial_migration.js\r\n  Deploying Migrations...\r\n  ... 0x4395ab278561f8d45ebdeeef4a8a8844ed695db2bd53fb3f2010ba3476170f9f\r\n  Migrations: 0x8cdaf0cd259887258bc13a92c0a6da92698644c0\r\nSaving successful migration to network...\r\n  ... 0xd7bc86d31bee32fa3988f1c1eabce403a1b5d570340a3a9cdba53a472ee8c956\r\nSaving artifacts...\r\nRunning migration: 2_deploy_contracts.js\r\n  Deploying EToken...\r\n  ... 0x10f312d5f409e3e118532f2aa4d7120115683bdb3846223c215947961c4965e6\r\n  EToken: 0x345ca3e014aaf5dca488057592ee47305d9b3e10\r\nSaving successful migration to network...\r\n  Deploying TestIco...\r\n  ... 0xf36163615f41ef7ed8f4a8f192149a0bf633fe1a2398ce001bf44c43dc7bdda0\r\n(node:18228) UnhandledPromiseRejectionWarning: Unhandled promise rejection (rejection id: 2): BigNumber Error: new BigNumber() not a number: function TruffleContract() {\r\n        this.constructor = temp;\r\n        return Contract.apply(this, arguments);\r\n      }\r\n(node:18228) [DEP0018] DeprecationWarning: Unhandled promise rejections are deprecated. In the future, promise rejections that are not handled will terminate the Node.js process with a non-zero exit code.\r\nSaving artifacts...\r\n```\r\n## Environment\r\n\r\n* Operating System: Debian Stretch\r\n* Ethereum client: n/a\r\n* Truffle version (`truffle version`): Truffle v4.1.3 (core: 4.1.3) Solidity v0.4.19 (solc-js)\r\n* node version (`node --version`): v8.9.4\r\n* npm version (`npm --version`): 5.7.1\r\n",
  "closed_by": {
    "login": "cgewecke",
    "id": 7332026,
    "node_id": "MDQ6VXNlcjczMzIwMjY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cgewecke",
    "html_url": "https://github.com/cgewecke",
    "followers_url": "https://api.github.com/users/cgewecke/followers",
    "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
    "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
    "organizations_url": "https://api.github.com/users/cgewecke/orgs",
    "repos_url": "https://api.github.com/users/cgewecke/repos",
    "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cgewecke/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/841/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/trufflesuite/truffle/issues/841/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/372144658",
    "html_url": "https://github.com/trufflesuite/truffle/issues/841#issuecomment-372144658",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/841",
    "id": 372144658,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MjE0NDY1OA==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-11T20:05:31Z",
    "updated_at": "2018-03-11T20:05:31Z",
    "author_association": "CONTRIBUTOR",
    "body": "@reasv It looks like there might be an issue with the way the `migrations.js` is written - [this](http://truffleframework.com/docs/getting_started/migrations#deployer) is a good first reference for how to deploy interdependent contracts. The pattern suggested there is:\r\n```javascript\r\n// Deploy A, then deploy B, passing in A's newly deployed address\r\ndeployer.deploy(A).then(function() {\r\n  return deployer.deploy(B, A.address);\r\n});\r\n```\r\n\r\nAlso not sure from your code what you're passing to the `TestICO` constructor in Solidity. It would make sense if it was an `address`. In your code I see the data type `ERC20` without any definition. \r\n\r\nAdditionally - to debug this issue, you might consider writing some simple [JS tests](http://truffleframework.com/docs/getting_started/javascript-tests) for the deployment. They're easier to work with than the `migrations` and you'll end up with a clearer understanding of what's going on. The Zeppelin unit tests are an excellent resource for how to do this. You should be able to pass a simple test first:\r\n```javascript\r\nit('should deploy', async function(){\r\n  const ico = await TestIco.new(); // <-- What should the constructor argument here be? \r\n})\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/372144658/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/373073628",
    "html_url": "https://github.com/trufflesuite/truffle/issues/841#issuecomment-373073628",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/841",
    "id": 373073628,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MzA3MzYyOA==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-14T15:56:42Z",
    "updated_at": "2018-03-14T15:56:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "@reasv Closing this for house-keeping, please re-open if you discover the underlying issue here is an error in the the way Truffle processes migrations.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/373073628/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/373582415",
    "html_url": "https://github.com/trufflesuite/truffle/issues/841#issuecomment-373582415",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/841",
    "id": 373582415,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MzU4MjQxNQ==",
    "user": {
      "login": "reasv",
      "id": 7143787,
      "node_id": "MDQ6VXNlcjcxNDM3ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7143787?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/reasv",
      "html_url": "https://github.com/reasv",
      "followers_url": "https://api.github.com/users/reasv/followers",
      "following_url": "https://api.github.com/users/reasv/following{/other_user}",
      "gists_url": "https://api.github.com/users/reasv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/reasv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/reasv/subscriptions",
      "organizations_url": "https://api.github.com/users/reasv/orgs",
      "repos_url": "https://api.github.com/users/reasv/repos",
      "events_url": "https://api.github.com/users/reasv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/reasv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-16T02:16:41Z",
    "updated_at": "2018-03-16T02:16:41Z",
    "author_association": "NONE",
    "body": "Yeah, sorry that I didn't reply. I'm using tests now and it works.",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/373582415/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/373587179",
    "html_url": "https://github.com/trufflesuite/truffle/issues/841#issuecomment-373587179",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/841",
    "id": 373587179,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MzU4NzE3OQ==",
    "user": {
      "login": "cgewecke",
      "id": 7332026,
      "node_id": "MDQ6VXNlcjczMzIwMjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7332026?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cgewecke",
      "html_url": "https://github.com/cgewecke",
      "followers_url": "https://api.github.com/users/cgewecke/followers",
      "following_url": "https://api.github.com/users/cgewecke/following{/other_user}",
      "gists_url": "https://api.github.com/users/cgewecke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cgewecke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cgewecke/subscriptions",
      "organizations_url": "https://api.github.com/users/cgewecke/orgs",
      "repos_url": "https://api.github.com/users/cgewecke/repos",
      "events_url": "https://api.github.com/users/cgewecke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cgewecke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-16T02:48:10Z",
    "updated_at": "2018-03-16T02:48:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks @reasv! ",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/373587179/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/375939785",
    "html_url": "https://github.com/trufflesuite/truffle/issues/841#issuecomment-375939785",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/841",
    "id": 375939785,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTkzOTc4NQ==",
    "user": {
      "login": "alsco77",
      "id": 5690430,
      "node_id": "MDQ6VXNlcjU2OTA0MzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5690430?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alsco77",
      "html_url": "https://github.com/alsco77",
      "followers_url": "https://api.github.com/users/alsco77/followers",
      "following_url": "https://api.github.com/users/alsco77/following{/other_user}",
      "gists_url": "https://api.github.com/users/alsco77/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alsco77/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alsco77/subscriptions",
      "organizations_url": "https://api.github.com/users/alsco77/orgs",
      "repos_url": "https://api.github.com/users/alsco77/repos",
      "events_url": "https://api.github.com/users/alsco77/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alsco77/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-25T02:08:25Z",
    "updated_at": "2018-03-25T02:39:47Z",
    "author_association": "NONE",
    "body": "I am having this same issue @reasv , can you please help me by telling me what you done to resolve this? Even the approach you took with testing?\r\n\r\nSolved: For anyone else - my problem as pointed out by @cgewecke was the passing of the full token object as oppose to its address. d'oh",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/375939785/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/433692784",
    "html_url": "https://github.com/trufflesuite/truffle/issues/841#issuecomment-433692784",
    "issue_url": "https://api.github.com/repos/trufflesuite/truffle/issues/841",
    "id": 433692784,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMzY5Mjc4NA==",
    "user": {
      "login": "besiwims",
      "id": 44117539,
      "node_id": "MDQ6VXNlcjQ0MTE3NTM5",
      "avatar_url": "https://avatars.githubusercontent.com/u/44117539?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/besiwims",
      "html_url": "https://github.com/besiwims",
      "followers_url": "https://api.github.com/users/besiwims/followers",
      "following_url": "https://api.github.com/users/besiwims/following{/other_user}",
      "gists_url": "https://api.github.com/users/besiwims/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/besiwims/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/besiwims/subscriptions",
      "organizations_url": "https://api.github.com/users/besiwims/orgs",
      "repos_url": "https://api.github.com/users/besiwims/repos",
      "events_url": "https://api.github.com/users/besiwims/events{/privacy}",
      "received_events_url": "https://api.github.com/users/besiwims/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-28T10:27:34Z",
    "updated_at": "2018-10-28T10:27:34Z",
    "author_association": "NONE",
    "body": "I am facing the same problem:\r\n\r\nError encountered, bailing. Network state unknown. Review successful transactions manually.\r\nBigNumber Error: new BigNumber() not a number: function TruffleContract() {\r\n        this.constructor = temp;\r\n        return Contract.apply(this, arguments);\r\n      }\r\n    at raise (C:\\Users\\Tobb Technologies\\AppData\\Roaming\\npm\\node_modules\\truffle\\build\\webpack:\\~\\bignumber.js\\bignumber.js:1177:1) \r\n\r\nThis came when I am deploying the OpenZeppelin version 2.0.0 Crowdsale. Thank you for your help.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/trufflesuite/truffle/issues/comments/433692784/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
