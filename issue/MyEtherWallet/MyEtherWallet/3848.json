{
  "url": "https://api.github.com/repos/MyEtherWallet/MyEtherWallet/issues/3848",
  "repository_url": "https://api.github.com/repos/MyEtherWallet/MyEtherWallet",
  "labels_url": "https://api.github.com/repos/MyEtherWallet/MyEtherWallet/issues/3848/labels{/name}",
  "comments_url": "https://api.github.com/repos/MyEtherWallet/MyEtherWallet/issues/3848/comments",
  "events_url": "https://api.github.com/repos/MyEtherWallet/MyEtherWallet/issues/3848/events",
  "html_url": "https://github.com/MyEtherWallet/MyEtherWallet/issues/3848",
  "id": 1243627417,
  "node_id": "I_kwDOB56xl85KID-Z",
  "number": 3848,
  "title": "WalletConnect: share chainId with wallet",
  "user": {
    "login": "Toporin",
    "id": 10826856,
    "node_id": "MDQ6VXNlcjEwODI2ODU2",
    "avatar_url": "https://avatars.githubusercontent.com/u/10826856?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Toporin",
    "html_url": "https://github.com/Toporin",
    "followers_url": "https://api.github.com/users/Toporin/followers",
    "following_url": "https://api.github.com/users/Toporin/following{/other_user}",
    "gists_url": "https://api.github.com/users/Toporin/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Toporin/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Toporin/subscriptions",
    "organizations_url": "https://api.github.com/users/Toporin/orgs",
    "repos_url": "https://api.github.com/users/Toporin/repos",
    "events_url": "https://api.github.com/users/Toporin/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Toporin/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-05-20T20:59:19Z",
  "updated_at": "2022-11-22T22:23:24Z",
  "closed_at": "2022-11-22T22:23:24Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "###### Info\r\n\r\nWith WalletConnect, the Dapp (MEW in this case) and the wallet client (the signing device) negociate the network (chainId) during session request. The process is roughly the following (see also https://docs.walletconnect.com/tech-spec#session-request):\r\n\r\n* After scanning the QR code, the client wallet recover the MyEtherWallet peerId and  suscribes to initiate the connection.\r\n\r\n* MEW then reply with a RPC request such as:\r\n`{\"id\":1653070343497318,\"jsonrpc\":\"2.0\",\"method\":\"wc_sessionRequest\",\"params\":[{\"peerId\":\"85a62a23-6834-4646-a7cf-fd7c63ac8511\",\"peerMeta\":{\"description\":\"MyEtherWallet (MEW) is a free, open-source, client-side interface for generating Ethereum wallets & more. Interact with the Ethereum blockchain easily & securely.\",\"url\":\"https://www.myetherwallet.com\",\"icons\":[\"https://www.myetherwallet.com/icons/icon192.png\",\"https://www.myetherwallet.com/favicon.png\",\"https://www.myetherwallet.com/img/icons/favicon-32x32.png\",\"https://www.myetherwallet.com/img/icons/favicon-16x16.png\",\"https://www.myetherwallet.com/img/icons/apple-touch-icon-152x152.png\",\"https://www.myetherwallet.com/img/icons/safari-pinned-tab.svg\"],\"name\":\"MyEtherWallet.com: Your Key to Ethereum\"},\"chainId\":null}]}`\r\n\r\nHere we can see that **chainId is null**, so MEW does not provide information the the client wallet on which network should be activated.\r\n\r\n* After that, the wallet client replies by providing a list of accounts (addresses managed by the wallet) and the chainId that it wants to use:\r\n`{\"result\": {\"approved\": true, \"chainId\": 3, \"accounts\": [\"0xdb8109a158ef6db939c9cfe16fff01779121e187\"], \"peerId\": \"41849101-10f9-4875-8b46-734472964619\", \"peerMeta\": {\"name\": \"Satochip-Bridge\", \"url\": \"https://satochip.io\", \"description\": \"Satochip - the open-source and affordable hardware wallet!\", \"icons\": []}}, \"jsonrpc\": \"2.0\", \"id\": 1653070343497318}`\r\n\r\nHere, **the client provide chainId 3**, corresponding to the Ropsten network. MyEtherWallet then open a session with the correct address, but on the Ethereum network by default (instead of Ropsten). Consequently, MEW is working on the Ethereum network while the wallet client thinks it is on Ropsten. If a transaction is sent to the client for signing, the WalletConnect protocol removes the chainId (if any), so the client has no way to know on which network it is supposed to operate. **If the user is not careful, he may approve a transaction thinking it is on one network while it is actually on another network!**\r\n\r\n- **Version**: v6.0.4 (current version)\r\n- **Browser**: Chrome\r\n- **OS**: Linux (Ubuntu)\r\n- **Page Url**: https://www.myetherwallet.com/wallet/access/mobile?type=overview\r\n\r\n###### Steps to reproduce\r\n\r\nThe issue has been tested on [trust wallet](https://trustwallet.com/):\r\n* Download the app and create a new multi-coin wallet\r\n* Connect to MEW via walletConnect (settings => WalletConnect) and Scan the QR-code\r\n* Before clicking on the 'connect' button, user can select the network on clicking on the address. Default is Ethereum but Binance Smart Chain can be selected instead.\r\n* Click on connect\r\n=> MEW displays the selected account, but on the Ethereum network\r\n\r\nThe issue is also present with Metamask mobile for Android.\r\n\r\n###### What do you expect to happen?\r\n\r\nShow MEW homepage on the network selected via WalletConnect using the chainId provided by the client wallet during session initialization.\r\n\r\n###### What happens instead?\r\n\r\nMEW displays the selected account on the Ethereum network instead\r\n\r\n",
  "closed_by": {
    "login": "gamalielhere",
    "id": 16236741,
    "node_id": "MDQ6VXNlcjE2MjM2NzQx",
    "avatar_url": "https://avatars.githubusercontent.com/u/16236741?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gamalielhere",
    "html_url": "https://github.com/gamalielhere",
    "followers_url": "https://api.github.com/users/gamalielhere/followers",
    "following_url": "https://api.github.com/users/gamalielhere/following{/other_user}",
    "gists_url": "https://api.github.com/users/gamalielhere/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gamalielhere/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gamalielhere/subscriptions",
    "organizations_url": "https://api.github.com/users/gamalielhere/orgs",
    "repos_url": "https://api.github.com/users/gamalielhere/repos",
    "events_url": "https://api.github.com/users/gamalielhere/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gamalielhere/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/MyEtherWallet/MyEtherWallet/issues/3848/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/MyEtherWallet/MyEtherWallet/issues/3848/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/MyEtherWallet/MyEtherWallet/issues/comments/1324315147",
    "html_url": "https://github.com/MyEtherWallet/MyEtherWallet/issues/3848#issuecomment-1324315147",
    "issue_url": "https://api.github.com/repos/MyEtherWallet/MyEtherWallet/issues/3848",
    "id": 1324315147,
    "node_id": "IC_kwDOB56xl85O73IL",
    "user": {
      "login": "gamalielhere",
      "id": 16236741,
      "node_id": "MDQ6VXNlcjE2MjM2NzQx",
      "avatar_url": "https://avatars.githubusercontent.com/u/16236741?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gamalielhere",
      "html_url": "https://github.com/gamalielhere",
      "followers_url": "https://api.github.com/users/gamalielhere/followers",
      "following_url": "https://api.github.com/users/gamalielhere/following{/other_user}",
      "gists_url": "https://api.github.com/users/gamalielhere/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gamalielhere/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gamalielhere/subscriptions",
      "organizations_url": "https://api.github.com/users/gamalielhere/orgs",
      "repos_url": "https://api.github.com/users/gamalielhere/repos",
      "events_url": "https://api.github.com/users/gamalielhere/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gamalielhere/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-22T22:23:24Z",
    "updated_at": "2022-11-22T22:23:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "Closing as this doesn't seem to be the case as of trustwallet 7.2.1",
    "reactions": {
      "url": "https://api.github.com/repos/MyEtherWallet/MyEtherWallet/issues/comments/1324315147/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
