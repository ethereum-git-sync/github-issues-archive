{
  "url": "https://api.github.com/repos/vyperlang/vyper/issues/498",
  "repository_url": "https://api.github.com/repos/vyperlang/vyper",
  "labels_url": "https://api.github.com/repos/vyperlang/vyper/issues/498/labels{/name}",
  "comments_url": "https://api.github.com/repos/vyperlang/vyper/issues/498/comments",
  "events_url": "https://api.github.com/repos/vyperlang/vyper/issues/498/events",
  "html_url": "https://github.com/vyperlang/vyper/issues/498",
  "id": 276422608,
  "node_id": "MDU6SXNzdWUyNzY0MjI2MDg=",
  "number": 498,
  "title": "TypeMismatchException doesn't show lineno if raised from `log` call",
  "user": {
    "login": "adhikasp",
    "id": 6151302,
    "node_id": "MDQ6VXNlcjYxNTEzMDI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6151302?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/adhikasp",
    "html_url": "https://github.com/adhikasp",
    "followers_url": "https://api.github.com/users/adhikasp/followers",
    "following_url": "https://api.github.com/users/adhikasp/following{/other_user}",
    "gists_url": "https://api.github.com/users/adhikasp/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/adhikasp/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/adhikasp/subscriptions",
    "organizations_url": "https://api.github.com/users/adhikasp/orgs",
    "repos_url": "https://api.github.com/users/adhikasp/repos",
    "events_url": "https://api.github.com/users/adhikasp/events{/privacy}",
    "received_events_url": "https://api.github.com/users/adhikasp/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2017-11-23T16:02:48Z",
  "updated_at": "2017-11-29T03:43:04Z",
  "closed_at": "2017-11-29T03:43:04Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### What's your issue about?\r\n\r\n`TypeMismatchException` doesn't show line number if the error was raised from `log` call.\r\n\r\n```py\r\nSomeLog: __log__({\r\n    _var: num256\r\n})\r\n\r\nsome_var: num\r\n\r\n@public\r\ndef some_func():\r\n    log.SomeLog(self.some_var) # Error here, should be typecasted\r\n```\r\n\r\nProduces the following error\r\n\r\n```\r\nOriginal exception was:\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/viper\", line 6, in <module>\r\n    exec(compile(open(__file__).read(), __file__, 'exec'))\r\n  File \"/mnt/c/Workspace/viper/bin/viper\", line 31, in <module>\r\n    print('0x' + compiler.compile(code).hex())\r\n  File \"/mnt/c/Workspace/viper/viper/compiler.py\", line 11, in compile\r\n    lll = optimizer.optimize(parser.parse_tree_to_lll(parser.parse(code), code))\r\n  File \"/mnt/c/Workspace/viper/viper/parser/parser.py\", line 369, in parse_tree_to_lll\r\n    o = parse_other_functions(o, otherfuncs, _globals, sigs, external_contracts, origcode)\r\n  File \"/mnt/c/Workspace/viper/viper/parser/parser.py\", line 334, in parse_other_functions\r\n    sub.append(parse_func(_def, _globals, {**{'self': sigs}, **external_contracts}, origcode))\r\n  File \"/mnt/c/Workspace/viper/viper/parser/parser.py\", line 452, in parse_func\r\n    ['seq'] + clampers + [parse_body(c, context) for c in code.body] + ['stop']\r\n  File \"/mnt/c/Workspace/viper/viper/parser/parser.py\", line 452, in <listcomp>\r\n    ['seq'] + clampers + [parse_body(c, context) for c in code.body] + ['stop']\r\n  File \"/mnt/c/Workspace/viper/viper/parser/parser.py\", line 463, in parse_body\r\n    return parse_stmt(code, context)\r\n  File \"/mnt/c/Workspace/viper/viper/parser/parser.py\", line 635, in parse_stmt\r\n    return Stmt(stmt, context).lll_node\r\n  File \"/mnt/c/Workspace/viper/viper/parser/stmt.py\", line 59, in __init__\r\n    self.lll_node = self.stmt_table[stmt_type]()\r\n  File \"/mnt/c/Workspace/viper/viper/parser/stmt.py\", line 66, in expr\r\n    return Stmt(self.stmt.value, self.context).lll_node\r\n  File \"/mnt/c/Workspace/viper/viper/parser/stmt.py\", line 59, in __init__\r\n    self.lll_node = self.stmt_table[stmt_type]()\r\n  File \"/mnt/c/Workspace/viper/viper/parser/stmt.py\", line 161, in call\r\n    inargs, inargsize, inarg_start = pack_logging_data(data_types, data, self.context)\r\n  File \"/mnt/c/Workspace/viper/viper/parser/parser.py\", line 705, in pack_logging_data\r\n    holder, maxlen = pack_args_by_32(holder, maxlen, arg, typ, context, context.new_placeholder(BaseType(32)))\r\n  File \"/mnt/c/Workspace/viper/viper/parser/parser.py\", line 664, in pack_args_by_32\r\n    input = base_type_conversion(input, input.typ, typ)\r\n  File \"/mnt/c/Workspace/viper/viper/parser/parser_utils.py\", line 438, in base_type_conversion\r\n    raise TypeMismatchException(\"Typecasting from base type %r to %r unavailable\" % (frm, to), pos)\r\nviper.exceptions.TypeMismatchException: Typecasting from base type num to num256 unavailable\r\n```\r\n\r\nNo information about lineno nor code snippet could be found in the stack trace.\r\n\r\n#### Cute Animal Picture\r\n\r\n![a cute animal picture here](https://cdn.pixabay.com/photo/2017/10/06/19/12/squirrel-2824272_960_720.jpg)\r\n",
  "closed_by": {
    "login": "DavidKnott",
    "id": 17552858,
    "node_id": "MDQ6VXNlcjE3NTUyODU4",
    "avatar_url": "https://avatars.githubusercontent.com/u/17552858?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/DavidKnott",
    "html_url": "https://github.com/DavidKnott",
    "followers_url": "https://api.github.com/users/DavidKnott/followers",
    "following_url": "https://api.github.com/users/DavidKnott/following{/other_user}",
    "gists_url": "https://api.github.com/users/DavidKnott/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/DavidKnott/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/DavidKnott/subscriptions",
    "organizations_url": "https://api.github.com/users/DavidKnott/orgs",
    "repos_url": "https://api.github.com/users/DavidKnott/repos",
    "events_url": "https://api.github.com/users/DavidKnott/events{/privacy}",
    "received_events_url": "https://api.github.com/users/DavidKnott/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/498/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/vyperlang/vyper/issues/498/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/346665603",
    "html_url": "https://github.com/vyperlang/vyper/issues/498#issuecomment-346665603",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/498",
    "id": 346665603,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NjY2NTYwMw==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-23T16:56:16Z",
    "updated_at": "2017-11-23T16:56:16Z",
    "author_association": "MEMBER",
    "body": "Definitely an issue, thanks for reporting.\r\n\r\nIn general, I think compiler errors shouldn't necessarily show the Python backtrace of what went wrong, only showing the code (file, line number, like 3-4 lines of the surrounding code for context) that produced the error. @DavidKnott @jacqueswww, what do you think?",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/346665603/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
