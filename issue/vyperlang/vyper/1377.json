{
  "url": "https://api.github.com/repos/vyperlang/vyper/issues/1377",
  "repository_url": "https://api.github.com/repos/vyperlang/vyper",
  "labels_url": "https://api.github.com/repos/vyperlang/vyper/issues/1377/labels{/name}",
  "comments_url": "https://api.github.com/repos/vyperlang/vyper/issues/1377/comments",
  "events_url": "https://api.github.com/repos/vyperlang/vyper/issues/1377/events",
  "html_url": "https://github.com/vyperlang/vyper/issues/1377",
  "id": 427776779,
  "node_id": "MDU6SXNzdWU0Mjc3NzY3Nzk=",
  "number": 1377,
  "title": "Vyper doesn't read bool returned by Solidity's modifying contracts after state is modified",
  "user": {
    "login": "michwill",
    "id": 740600,
    "node_id": "MDQ6VXNlcjc0MDYwMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/740600?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/michwill",
    "html_url": "https://github.com/michwill",
    "followers_url": "https://api.github.com/users/michwill/followers",
    "following_url": "https://api.github.com/users/michwill/following{/other_user}",
    "gists_url": "https://api.github.com/users/michwill/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/michwill/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michwill/subscriptions",
    "organizations_url": "https://api.github.com/users/michwill/orgs",
    "repos_url": "https://api.github.com/users/michwill/repos",
    "events_url": "https://api.github.com/users/michwill/events{/privacy}",
    "received_events_url": "https://api.github.com/users/michwill/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 479554962,
      "node_id": "MDU6TGFiZWw0Nzk1NTQ5NjI=",
      "url": "https://api.github.com/repos/vyperlang/vyper/labels/bug",
      "name": "bug",
      "color": "ee0701",
      "default": true,
      "description": "Bug that shouldn't change language semantics when fixed."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2019-04-01T15:38:46Z",
  "updated_at": "2019-07-02T04:03:58Z",
  "closed_at": "2019-07-02T04:03:58Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Version Information\r\n\r\n* vyper Version (output of `vyper --version`): 0.1.0b9\r\n* OS: linux\r\n* Python Version (output of `python --version`): 3.6.7\r\n* Environment (output of `pip freeze`): \r\n```\r\nasn1crypto==0.24.0\r\natomicwrites==1.3.0\r\nattrdict==2.0.1\r\nattrs==19.1.0\r\nbackcall==0.1.0\r\ncertifi==2019.3.9\r\ncffi==1.12.2\r\nchardet==3.0.4\r\ncryptography==2.6.1\r\ncytoolz==0.9.0.1\r\ndecorator==4.4.0\r\neth-abi==2.0.0b8\r\neth-account==0.3.0\r\neth-bloom==1.0.3\r\neth-hash==0.2.0\r\neth-keyfile==0.5.1\r\neth-keys==0.2.1\r\neth-rlp==0.1.2\r\neth-tester==0.1.0b37\r\neth-typing==2.0.0\r\neth-utils==1.4.1\r\nethpm==0.1.4a13\r\nhexbytes==0.1.0\r\nidna==2.8\r\nipfsapi==0.4.3\r\nipython==7.4.0\r\nipython-genutils==0.2.0\r\njedi==0.13.3\r\njsonschema==2.6.0\r\nlru-dict==1.1.6\r\nmore-itertools==7.0.0\r\nmypy-extensions==0.4.1\r\nparsimonious==0.8.1\r\nparso==0.3.4\r\npexpect==4.6.0\r\npickleshare==0.7.5\r\npluggy==0.9.0\r\nprompt-toolkit==2.0.9\r\nprotobuf==3.7.1\r\nptyprocess==0.6.0\r\npy==1.8.0\r\npy-ecc==1.4.7\r\npy-evm==0.2.0a39\r\npy-geth==2.1.0\r\npycparser==2.19\r\npycryptodome==3.8.0\r\npyethash==0.1.27\r\nPygments==2.3.1\r\npytest==4.4.0\r\npytest-ethereum==0.1.3a6\r\nrequests==2.21.0\r\nrlp==1.1.0\r\nsemantic-version==2.6.0\r\nsix==1.12.0\r\ntoolz==0.9.0\r\ntraitlets==4.3.2\r\ntrie==1.3.8\r\nurllib3==1.24.1\r\nvyper==0.1.0b9\r\nwcwidth==0.1.7\r\nweb3==5.0.0a5\r\nwebsockets==7.0\r\n```\r\n\r\n### What's your issue about?\r\n\r\nWhen a Vyper contract casts an address to an interface, and a modifying method is called, such as `InterfaceName(address).method()`, if the method returns `bool`, Vyper doesn't see that bool properly when the external contract deployed at `address` is written in Solidity.\r\n\r\nThe self-contained minimal test case (which should pass when fixed) is here: https://github.com/michwill/vyper-solidity-bug",
  "closed_by": {
    "login": "michwill",
    "id": 740600,
    "node_id": "MDQ6VXNlcjc0MDYwMA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/740600?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/michwill",
    "html_url": "https://github.com/michwill",
    "followers_url": "https://api.github.com/users/michwill/followers",
    "following_url": "https://api.github.com/users/michwill/following{/other_user}",
    "gists_url": "https://api.github.com/users/michwill/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/michwill/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michwill/subscriptions",
    "organizations_url": "https://api.github.com/users/michwill/orgs",
    "repos_url": "https://api.github.com/users/michwill/repos",
    "events_url": "https://api.github.com/users/michwill/events{/privacy}",
    "received_events_url": "https://api.github.com/users/michwill/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/1377/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/vyperlang/vyper/issues/1377/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/479191914",
    "html_url": "https://github.com/vyperlang/vyper/issues/1377#issuecomment-479191914",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1377",
    "id": 479191914,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3OTE5MTkxNA==",
    "user": {
      "login": "haydenadams",
      "id": 9343483,
      "node_id": "MDQ6VXNlcjkzNDM0ODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9343483?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haydenadams",
      "html_url": "https://github.com/haydenadams",
      "followers_url": "https://api.github.com/users/haydenadams/followers",
      "following_url": "https://api.github.com/users/haydenadams/following{/other_user}",
      "gists_url": "https://api.github.com/users/haydenadams/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haydenadams/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haydenadams/subscriptions",
      "organizations_url": "https://api.github.com/users/haydenadams/orgs",
      "repos_url": "https://api.github.com/users/haydenadams/repos",
      "events_url": "https://api.github.com/users/haydenadams/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haydenadams/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-02T20:41:05Z",
    "updated_at": "2019-04-02T20:41:05Z",
    "author_association": "NONE",
    "body": "Pretty sure this is not the case. If it was, this line in Uniswap would fail:\r\n\r\nhttps://github.com/Uniswap/contracts-vyper/blob/master/contracts/uniswap_exchange.vy#L132\r\n\r\nsince many tokens on Uniswap (pretty sure all) are written in Solidity.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/479191914/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/483097570",
    "html_url": "https://github.com/vyperlang/vyper/issues/1377#issuecomment-483097570",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1377",
    "id": 483097570,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MzA5NzU3MA==",
    "user": {
      "login": "michwill",
      "id": 740600,
      "node_id": "MDQ6VXNlcjc0MDYwMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/740600?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michwill",
      "html_url": "https://github.com/michwill",
      "followers_url": "https://api.github.com/users/michwill/followers",
      "following_url": "https://api.github.com/users/michwill/following{/other_user}",
      "gists_url": "https://api.github.com/users/michwill/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michwill/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michwill/subscriptions",
      "organizations_url": "https://api.github.com/users/michwill/orgs",
      "repos_url": "https://api.github.com/users/michwill/repos",
      "events_url": "https://api.github.com/users/michwill/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michwill/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-15T03:43:18Z",
    "updated_at": "2019-04-15T03:43:46Z",
    "author_association": "NONE",
    "body": "That is exactly how I discovered it: followed Uniswap as an example. However, Uniswap was compiled with vyper-0.1.0b4.\r\n@haydenadams I strongly suspect that this line you have mentioned will fail with the newest vyper when working with contracts written in solidity. But I have to admit that I didn't try to arrange this test with Uniswap",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/483097570/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/498719120",
    "html_url": "https://github.com/vyperlang/vyper/issues/1377#issuecomment-498719120",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1377",
    "id": 498719120,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5ODcxOTEyMA==",
    "user": {
      "login": "haydenadams",
      "id": 9343483,
      "node_id": "MDQ6VXNlcjkzNDM0ODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9343483?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/haydenadams",
      "html_url": "https://github.com/haydenadams",
      "followers_url": "https://api.github.com/users/haydenadams/followers",
      "following_url": "https://api.github.com/users/haydenadams/following{/other_user}",
      "gists_url": "https://api.github.com/users/haydenadams/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/haydenadams/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/haydenadams/subscriptions",
      "organizations_url": "https://api.github.com/users/haydenadams/orgs",
      "repos_url": "https://api.github.com/users/haydenadams/repos",
      "events_url": "https://api.github.com/users/haydenadams/events{/privacy}",
      "received_events_url": "https://api.github.com/users/haydenadams/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-06-04T15:22:59Z",
    "updated_at": "2019-06-04T15:25:23Z",
    "author_association": "NONE",
    "body": "@michwill appears you were right and I totally forgot about this issue until I spent an hour debugging it...\r\n\r\nIt's not solidity specific (or even bool specific). It's the same for external calls to vyper contracts an other variable types. It has to do with directly asserting the result of an external call:\r\n\r\nhttps://github.com/ethereum/vyper/issues/1468\r\n\r\nThe workaround is to set the result equal to a local variable before asserting:\r\n```python\r\nsuccess: bool = self.token.transferFrom(msg.sender, self, token_amount)\r\nassert success\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/498719120/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
