{
  "url": "https://api.github.com/repos/vyperlang/vyper/issues/2056",
  "repository_url": "https://api.github.com/repos/vyperlang/vyper",
  "labels_url": "https://api.github.com/repos/vyperlang/vyper/issues/2056/labels{/name}",
  "comments_url": "https://api.github.com/repos/vyperlang/vyper/issues/2056/comments",
  "events_url": "https://api.github.com/repos/vyperlang/vyper/issues/2056/events",
  "html_url": "https://github.com/vyperlang/vyper/issues/2056",
  "id": 646665621,
  "node_id": "MDU6SXNzdWU2NDY2NjU2MjE=",
  "number": 2056,
  "title": "Reorganize and refactor the test suite",
  "user": {
    "login": "iamdefinitelyahuman",
    "id": 35276322,
    "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iamdefinitelyahuman",
    "html_url": "https://github.com/iamdefinitelyahuman",
    "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
    "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
    "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
    "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
    "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
    "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2161345478,
      "node_id": "MDU6TGFiZWwyMTYxMzQ1NDc4",
      "url": "https://api.github.com/repos/vyperlang/vyper/labels/Refactor",
      "name": "Refactor",
      "color": "402eaa",
      "default": false,
      "description": "Issues related to refactoring the codebase"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2020-06-27T11:42:21Z",
  "updated_at": "2021-03-10T18:20:51Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## How it works now\r\nTests are disorganized and sometimes duplicated.  We have a lot of coverage but it can be hard to know where something is tested, or where to place a new test.\r\n\r\n## How it could be refactored\r\nOrganize tests into three base directories.\r\n\r\n* `functional`: Unit tests. Designed to execute quickly so they can be run locally in a matter of seconds.\r\n* `fuzzing`: Hypothesis tests. Can be very slow as they're meant to run in the CI.\r\n* `integration`: Large-scale tests that verify interactions across multiple components or the entire compiler process.  The majority of our test suite currently belongs in this category.\r\n\r\nWe should also add a readme in `tests/` to explain the structure to new contributors.\r\n\r\n## Why this is an improvement\r\n\r\n* With this structure we can split up how the CI runs and remove the need for the `fuzzing` marker. \r\n* It becomes very obvious which tests are new, and which are old. We can slowly migrate the old tests into these folders as we clean them up, and remove redundant test cases\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/2056/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/vyperlang/vyper/issues/2056/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/650560902",
    "html_url": "https://github.com/vyperlang/vyper/issues/2056#issuecomment-650560902",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/2056",
    "id": 650560902,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MDU2MDkwMg==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-27T13:24:23Z",
    "updated_at": "2020-06-27T13:24:23Z",
    "author_association": "MEMBER",
    "body": "An idea: we have a bunch of compilation test cases that either fail with a compiler exception or pass, and _maybe_ we do some simple checks. *What if* we used a TOML format for this? Like:\r\n```toml\r\ntype: failure\r\nexception: StructureException\r\nsource: |\r\n  @public\r\n  def foo\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/650560902/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 1
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/790264101",
    "html_url": "https://github.com/vyperlang/vyper/issues/2056#issuecomment-790264101",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/2056",
    "id": 790264101,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5MDI2NDEwMQ==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-04T03:35:49Z",
    "updated_at": "2021-03-10T18:20:51Z",
    "author_association": "MEMBER",
    "body": "Could use something like this to construct a test suite out of source files:\r\nhttps://docs.pytest.org/en/stable/example/nonpython.html#yaml-plugin\r\n\r\n`tests/.../no_function_name.vy`:\r\n```py\r\n\"\"\"\r\n@test\r\n@raises SyntaxError\r\n\"\"\"\r\n\r\n@external\r\ndef ():\r\n    pass  # Should fail w/ `SyntaxError` because no function name\r\n```\r\n\r\n`tests/.../return_from_inner.vy`:\r\n```py\r\n\"\"\"\r\n@test\r\n@type uint256 address ... \r\n\"\"\"\r\n\r\n@internal\r\ndef _inner(b: {type}) -> {type}:\r\n    return b\r\n\r\n@external\r\ndef outer(a: {type}) -> {type}:\r\n    return self._inner(a)\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/790264101/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/795856730",
    "html_url": "https://github.com/vyperlang/vyper/issues/2056#issuecomment-795856730",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/2056",
    "id": 795856730,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5NTg1NjczMA==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-10T18:18:36Z",
    "updated_at": "2021-03-10T18:18:36Z",
    "author_association": "MEMBER",
    "body": "cc @sabotagebeats",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/795856730/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 1
    },
    "performed_via_github_app": null
  }
]
