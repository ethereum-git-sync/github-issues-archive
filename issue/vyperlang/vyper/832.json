{
  "url": "https://api.github.com/repos/vyperlang/vyper/issues/832",
  "repository_url": "https://api.github.com/repos/vyperlang/vyper",
  "labels_url": "https://api.github.com/repos/vyperlang/vyper/issues/832/labels{/name}",
  "comments_url": "https://api.github.com/repos/vyperlang/vyper/issues/832/comments",
  "events_url": "https://api.github.com/repos/vyperlang/vyper/issues/832/events",
  "html_url": "https://github.com/vyperlang/vyper/issues/832",
  "id": 324978609,
  "node_id": "MDU6SXNzdWUzMjQ5Nzg2MDk=",
  "number": 832,
  "title": "VIP: Modify how RLPDecode works",
  "user": {
    "login": "fubuloubu",
    "id": 3859395,
    "node_id": "MDQ6VXNlcjM4NTkzOTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fubuloubu",
    "html_url": "https://github.com/fubuloubu",
    "followers_url": "https://api.github.com/users/fubuloubu/followers",
    "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
    "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
    "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
    "repos_url": "https://api.github.com/users/fubuloubu/repos",
    "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2018-05-21T16:27:53Z",
  "updated_at": "2019-05-03T19:54:40Z",
  "closed_at": "2019-05-03T19:54:31Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "## Preamble\r\nVIP: to be assigned\r\nTitle: Modify how RLPDecode works\r\nAuthor: @fubuloubu @jacqueswww\r\nType: Standard Track\r\nStatus: Draft\r\nCreated: 2018-05-21\r\n\r\n## Simple Summary\r\nRLP can be implemented as an implicit casting with additional runtime checks for structure. This could be implemented as a LLL macro for cheaper gas cost than a separately compiled and deployed library function, as is the current implemention of `RLPList`\r\n\r\n## Abstract\r\nThis is currently how RLP Decoding works:\r\n```python\r\n# encoded_message: bytes <= 134\r\nvalues = RLPList(encoded_message, [int128, bytes32, int128, int128])\r\nmy_val: int128 = values[3]\r\n```\r\n\r\nThis is a fairly obtuse syntax for what is essentially a conversion: we are trying to turn `encoded_message` into a tuple and assigning it to `values`\r\n\r\n## Motivation\r\nCurrently, `RLPList` is a separate contract, which gets compiled and linked to any Vyper program that uses it. For public usage, this linking would have to be deployed to a specific network address, and called and managed separately. This was done in order to save gas costs of employing a general-purpose RLP Decoder into each contract.\r\n\r\nThis proposal would turn RLP Decoding into an internal compiler macro that would analyze the required structure of the data, then make assets and assignments as necessary directly into the compiled code. This would reduce gas costs further because no external call would be necessary, as well as increase usability because no external contract would need to maintained and linked.\r\n\r\n## Specification\r\nProposed syntax would be like this\r\n```python\r\n# encoded_message: bytes <= 134\r\nvalues: tuple(int128, bytes32, int128, int128)\r\nvalues = RLPDecode(encoded_message)  # Structure of RLP is determined from assignment type\r\nmy_val: int128 = values[3]\r\n# OR\r\nmy_val: int128\r\n# _ values are ignored\r\n_, _, _, my_val = RLPDecode(encoded_message)\r\n# Structure of RLP is determined from assignment type, where '_' are skipped\r\n```\r\n\r\n[RLP Encoding](https://github.com/ethereum/wiki/wiki/RLP) gives us enough information for us to do this decoding and checking on the spot, and it would be cheapest execution-wise to have it hardcoded in each contract through a macro.\r\n\r\n## Backwards Compatibility\r\nThis would modify how `RLPList` operates, but we could deprecate that function as-is and introduce two new functions `RLPEncode` and `RLPDecode` that encode and decode all valid Vyper types with RLP.\r\n\r\n@jacqueswww has an alternative suggestion where each type has a `rlp_encode`/`rlp_decode` member function that performs this functionality as a function call getting the RLP encoding of a variable or setting a variable from an RLP-encoded variable (this would be a **mutating** call)\r\n\r\n## Copyright\r\nCopyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/)",
  "closed_by": {
    "login": "fubuloubu",
    "id": 3859395,
    "node_id": "MDQ6VXNlcjM4NTkzOTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fubuloubu",
    "html_url": "https://github.com/fubuloubu",
    "followers_url": "https://api.github.com/users/fubuloubu/followers",
    "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
    "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
    "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
    "repos_url": "https://api.github.com/users/fubuloubu/repos",
    "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/832/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/vyperlang/vyper/issues/832/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/390707795",
    "html_url": "https://github.com/vyperlang/vyper/issues/832#issuecomment-390707795",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/832",
    "id": 390707795,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MDcwNzc5NQ==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-21T16:30:45Z",
    "updated_at": "2018-05-21T16:30:45Z",
    "author_association": "MEMBER",
    "body": "In reviewing the limited materials present for RLP encoding, it is *possible* to write hardcoded optimizations for each decoding that *would* have a cheaper execution cost than what is current, however deployment costs would increase much more significantly than I originally anticipated because RLP is a *dynamic* encoding.\r\n\r\nThis is a trade-off that may be a non-starter, but it would alleviate the environmental complexity of managing the linking of an external binary through another contract address to use this functionality.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/390707795/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/421214480",
    "html_url": "https://github.com/vyperlang/vyper/issues/832#issuecomment-421214480",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/832",
    "id": 421214480,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMTIxNDQ4MA==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-14T02:50:11Z",
    "updated_at": "2018-09-14T02:50:11Z",
    "author_association": "MEMBER",
    "body": "@jacqueswww should we revisit this?",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/421214480/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/489220309",
    "html_url": "https://github.com/vyperlang/vyper/issues/832#issuecomment-489220309",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/832",
    "id": 489220309,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTIyMDMwOQ==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-03T19:54:30Z",
    "updated_at": "2019-05-03T19:54:30Z",
    "author_association": "MEMBER",
    "body": "Deprecating in favor of #1406",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/489220309/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
