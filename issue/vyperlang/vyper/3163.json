{
  "url": "https://api.github.com/repos/vyperlang/vyper/issues/3163",
  "repository_url": "https://api.github.com/repos/vyperlang/vyper",
  "labels_url": "https://api.github.com/repos/vyperlang/vyper/issues/3163/labels{/name}",
  "comments_url": "https://api.github.com/repos/vyperlang/vyper/issues/3163/comments",
  "events_url": "https://api.github.com/repos/vyperlang/vyper/issues/3163/events",
  "html_url": "https://github.com/vyperlang/vyper/issues/3163",
  "id": 1472153468,
  "node_id": "I_kwDOBGDvrM5Xv0d8",
  "number": 3163,
  "title": "Questions about storage layout of old vyper contracts",
  "user": {
    "login": "jeffchen006",
    "id": 37031265,
    "node_id": "MDQ6VXNlcjM3MDMxMjY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/37031265?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jeffchen006",
    "html_url": "https://github.com/jeffchen006",
    "followers_url": "https://api.github.com/users/jeffchen006/followers",
    "following_url": "https://api.github.com/users/jeffchen006/following{/other_user}",
    "gists_url": "https://api.github.com/users/jeffchen006/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jeffchen006/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jeffchen006/subscriptions",
    "organizations_url": "https://api.github.com/users/jeffchen006/orgs",
    "repos_url": "https://api.github.com/users/jeffchen006/repos",
    "events_url": "https://api.github.com/users/jeffchen006/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jeffchen006/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-12-02T00:47:47Z",
  "updated_at": "2022-12-04T04:26:34Z",
  "closed_at": "2022-12-04T04:26:34Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Sorry if it's the wrong place to post this question.\r\n\r\nI'm working on a research project which requires me to find storage layout of any contract, given the source code. \r\n\r\nI can handle Vyper contracts compiled with vyper-0.2.16 or after, because I can read outputs from \"vyper -f layout\". \r\n\r\nHowever, for contracts compiled with vyper-0.2.15 or before, there is no such an \"-f layout\" option so I really cannot find storage layout. \r\n\r\nI tried to compile contracts of version 0.2.4 with vyper-0.2.16, it successfully compiles but I realize the storage layout given vy the compiler is wrong. \r\n\r\nI wonder how can we figure out storage layout of these old vyper contracts? \r\n\r\nAlso, I notice vyper allows users to provide a storage-layout file to override the compiler's default results, I wonder in this case,  is there still a way to extract the storage layout of a deployed contract?",
  "closed_by": {
    "login": "jeffchen006",
    "id": 37031265,
    "node_id": "MDQ6VXNlcjM3MDMxMjY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/37031265?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jeffchen006",
    "html_url": "https://github.com/jeffchen006",
    "followers_url": "https://api.github.com/users/jeffchen006/followers",
    "following_url": "https://api.github.com/users/jeffchen006/following{/other_user}",
    "gists_url": "https://api.github.com/users/jeffchen006/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jeffchen006/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jeffchen006/subscriptions",
    "organizations_url": "https://api.github.com/users/jeffchen006/orgs",
    "repos_url": "https://api.github.com/users/jeffchen006/repos",
    "events_url": "https://api.github.com/users/jeffchen006/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jeffchen006/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/3163/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/vyperlang/vyper/issues/3163/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/1336209329",
    "html_url": "https://github.com/vyperlang/vyper/issues/3163#issuecomment-1336209329",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/3163",
    "id": 1336209329,
    "node_id": "IC_kwDOBGDvrM5PpO-x",
    "user": {
      "login": "charles-cooper",
      "id": 3867501,
      "node_id": "MDQ6VXNlcjM4Njc1MDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3867501?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/charles-cooper",
      "html_url": "https://github.com/charles-cooper",
      "followers_url": "https://api.github.com/users/charles-cooper/followers",
      "following_url": "https://api.github.com/users/charles-cooper/following{/other_user}",
      "gists_url": "https://api.github.com/users/charles-cooper/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/charles-cooper/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/charles-cooper/subscriptions",
      "organizations_url": "https://api.github.com/users/charles-cooper/orgs",
      "repos_url": "https://api.github.com/users/charles-cooper/repos",
      "events_url": "https://api.github.com/users/charles-cooper/events{/privacy}",
      "received_events_url": "https://api.github.com/users/charles-cooper/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-03T18:03:25Z",
    "updated_at": "2022-12-03T18:03:25Z",
    "author_association": "COLLABORATOR",
    "body": "> I wonder how can we figure out storage layout of these old vyper contracts?\r\n\r\nyou would need to patch the old compiler to give you that information\r\n\r\n> Also, I notice vyper allows users to provide a storage-layout file to override the compiler's default results, I wonder in this case, is there still a way to extract the storage layout of a deployed contract?\r\n\r\nthe layout file should be published as part of the source verification. if the layout does not match the layout file available to the verifier, the contract should not verify",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/1336209329/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/1336259182",
    "html_url": "https://github.com/vyperlang/vyper/issues/3163#issuecomment-1336259182",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/3163",
    "id": 1336259182,
    "node_id": "IC_kwDOBGDvrM5PpbJu",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-03T21:13:42Z",
    "updated_at": "2022-12-03T21:13:42Z",
    "author_association": "MEMBER",
    "body": "@banteg has a project that monkeypatches older versions of the compiler to print storage layouts ",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/1336259182/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/1336317598",
    "html_url": "https://github.com/vyperlang/vyper/issues/3163#issuecomment-1336317598",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/3163",
    "id": 1336317598,
    "node_id": "IC_kwDOBGDvrM5Pppae",
    "user": {
      "login": "jeffchen006",
      "id": 37031265,
      "node_id": "MDQ6VXNlcjM3MDMxMjY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/37031265?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jeffchen006",
      "html_url": "https://github.com/jeffchen006",
      "followers_url": "https://api.github.com/users/jeffchen006/followers",
      "following_url": "https://api.github.com/users/jeffchen006/following{/other_user}",
      "gists_url": "https://api.github.com/users/jeffchen006/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jeffchen006/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jeffchen006/subscriptions",
      "organizations_url": "https://api.github.com/users/jeffchen006/orgs",
      "repos_url": "https://api.github.com/users/jeffchen006/repos",
      "events_url": "https://api.github.com/users/jeffchen006/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jeffchen006/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-04T04:24:17Z",
    "updated_at": "2022-12-04T04:24:17Z",
    "author_association": "NONE",
    "body": "> > I wonder how can we figure out storage layout of these old vyper contracts?\r\n> \r\n> you would need to patch the old compiler to give you that information\r\n> \r\n> > Also, I notice vyper allows users to provide a storage-layout file to override the compiler's default results, I wonder in this case, is there still a way to extract the storage layout of a deployed contract?\r\n> \r\n> the layout file should be published as part of the source verification. if the layout does not match the layout file available to the verifier, the contract should not verify\r\n\r\nThanks very much for your answer! It all makes sense. I think I will find a workaround to handle it. Patching old compilers seems too much work :)",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/1336317598/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/1336317789",
    "html_url": "https://github.com/vyperlang/vyper/issues/3163#issuecomment-1336317789",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/3163",
    "id": 1336317789,
    "node_id": "IC_kwDOBGDvrM5Pppdd",
    "user": {
      "login": "jeffchen006",
      "id": 37031265,
      "node_id": "MDQ6VXNlcjM3MDMxMjY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/37031265?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jeffchen006",
      "html_url": "https://github.com/jeffchen006",
      "followers_url": "https://api.github.com/users/jeffchen006/followers",
      "following_url": "https://api.github.com/users/jeffchen006/following{/other_user}",
      "gists_url": "https://api.github.com/users/jeffchen006/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jeffchen006/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jeffchen006/subscriptions",
      "organizations_url": "https://api.github.com/users/jeffchen006/orgs",
      "repos_url": "https://api.github.com/users/jeffchen006/repos",
      "events_url": "https://api.github.com/users/jeffchen006/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jeffchen006/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-04T04:26:23Z",
    "updated_at": "2022-12-04T04:26:23Z",
    "author_association": "NONE",
    "body": "> @banteg has a project that monkeypatches older versions of the compiler to print storage layouts\r\n\r\n\r\nThank you very much for your answer! Yes. I also found that repo. It provides a new idea about tracking SHA3 and tracing back. It could be an alternative way if we don't know the source code.  ",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/1336317789/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
