{
  "url": "https://api.github.com/repos/vyperlang/vyper/issues/1761",
  "repository_url": "https://api.github.com/repos/vyperlang/vyper",
  "labels_url": "https://api.github.com/repos/vyperlang/vyper/issues/1761/labels{/name}",
  "comments_url": "https://api.github.com/repos/vyperlang/vyper/issues/1761/comments",
  "events_url": "https://api.github.com/repos/vyperlang/vyper/issues/1761/events",
  "html_url": "https://github.com/vyperlang/vyper/issues/1761",
  "id": 535972769,
  "node_id": "MDU6SXNzdWU1MzU5NzI3Njk=",
  "number": 1761,
  "title": "Potentially insufficient gas stipend for precompiled contract calls",
  "user": {
    "login": "daejunpark",
    "id": 5491770,
    "node_id": "MDQ6VXNlcjU0OTE3NzA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5491770?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/daejunpark",
    "html_url": "https://github.com/daejunpark",
    "followers_url": "https://api.github.com/users/daejunpark/followers",
    "following_url": "https://api.github.com/users/daejunpark/following{/other_user}",
    "gists_url": "https://api.github.com/users/daejunpark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/daejunpark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/daejunpark/subscriptions",
    "organizations_url": "https://api.github.com/users/daejunpark/orgs",
    "repos_url": "https://api.github.com/users/daejunpark/repos",
    "events_url": "https://api.github.com/users/daejunpark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/daejunpark/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 479554962,
      "node_id": "MDU6TGFiZWw0Nzk1NTQ5NjI=",
      "url": "https://api.github.com/repos/vyperlang/vyper/labels/bug",
      "name": "bug",
      "color": "ee0701",
      "default": true,
      "description": "Bug that shouldn't change language semantics when fixed."
    },
    {
      "id": 684449300,
      "node_id": "MDU6TGFiZWw2ODQ0NDkzMDA=",
      "url": "https://api.github.com/repos/vyperlang/vyper/labels/Easy%20Pickings",
      "name": "Easy Pickings",
      "color": "0e8a16",
      "default": false,
      "description": "Used to denote issues that should be easy to implement"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2019-12-10T20:21:13Z",
  "updated_at": "2019-12-17T22:58:14Z",
  "closed_at": "2019-12-17T22:58:14Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "### Version Information\r\n\r\n* vyper Version (output of `vyper --version`): `0.1.0b13+commit.375fb27`\r\n\r\n(confirmed the same behavior at `0.1.0b14+commit.49b201c` as well.)\r\n\r\n### What's your issue about?\r\n\r\nVyper utilizes the ID precompiled contract call for doing memcpy-like operations. That is, the compiled bytecode contains the opcode pattern `CALL GASCAP 4 0 SRC SIZE DEST SIZE` to copy the local memory region from SRC to DEST.\r\n\r\nThe problem is that the allocated gas stipend `GASCAP` for the call in the bytecode is constant-bounded, (e.g., 21 when SIZE == 32), which may not be sufficient in a future hardfork that modifies the gas schedule. Thus this may result in that any such future hardfork may be significantly delayed or long-lasting contracts (such as the deposit contract) may need to be redeployed.\r\n\r\nIs there a specific reason to have this tight gas cap bound?\r\n\r\nBTW, this behavior doesn't seem to be consistent. For example, when it calls to the SHA256 precompiled contract, it simply allocates all available gas for the call stipend.\r\n\r\n### How can it be fixed?\r\n\r\nAllocate all available gas (i.e., using the `GAS` opcode) when calling to precompiled contracts.\r\n",
  "closed_by": {
    "login": "fubuloubu",
    "id": 3859395,
    "node_id": "MDQ6VXNlcjM4NTkzOTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fubuloubu",
    "html_url": "https://github.com/fubuloubu",
    "followers_url": "https://api.github.com/users/fubuloubu/followers",
    "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
    "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
    "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
    "repos_url": "https://api.github.com/users/fubuloubu/repos",
    "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/1761/reactions",
    "total_count": 1,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 1
  },
  "timeline_url": "https://api.github.com/repos/vyperlang/vyper/issues/1761/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/564264817",
    "html_url": "https://github.com/vyperlang/vyper/issues/1761#issuecomment-564264817",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1761",
    "id": 564264817,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NDI2NDgxNw==",
    "user": {
      "login": "daejunpark",
      "id": 5491770,
      "node_id": "MDQ6VXNlcjU0OTE3NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5491770?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/daejunpark",
      "html_url": "https://github.com/daejunpark",
      "followers_url": "https://api.github.com/users/daejunpark/followers",
      "following_url": "https://api.github.com/users/daejunpark/following{/other_user}",
      "gists_url": "https://api.github.com/users/daejunpark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/daejunpark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daejunpark/subscriptions",
      "organizations_url": "https://api.github.com/users/daejunpark/orgs",
      "repos_url": "https://api.github.com/users/daejunpark/repos",
      "events_url": "https://api.github.com/users/daejunpark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/daejunpark/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-10T21:23:25Z",
    "updated_at": "2019-12-11T09:45:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "Question:  In case that this is indeed a bug, is it possible to release a hotfix version that fixes this issue on top of the beta 13 (not the beta 14)? That will significantly help re-run the deposit bytecode verification against the fixed bytecode, without going through all the changes made since the beta 13 release.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/564264817/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/564431863",
    "html_url": "https://github.com/vyperlang/vyper/issues/1761#issuecomment-564431863",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1761",
    "id": 564431863,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NDQzMTg2Mw==",
    "user": {
      "login": "jacqueswww",
      "id": 6917456,
      "node_id": "MDQ6VXNlcjY5MTc0NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6917456?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jacqueswww",
      "html_url": "https://github.com/jacqueswww",
      "followers_url": "https://api.github.com/users/jacqueswww/followers",
      "following_url": "https://api.github.com/users/jacqueswww/following{/other_user}",
      "gists_url": "https://api.github.com/users/jacqueswww/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jacqueswww/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jacqueswww/subscriptions",
      "organizations_url": "https://api.github.com/users/jacqueswww/orgs",
      "repos_url": "https://api.github.com/users/jacqueswww/repos",
      "events_url": "https://api.github.com/users/jacqueswww/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jacqueswww/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-11T08:24:58Z",
    "updated_at": "2019-12-11T08:25:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "This should just be changed to use `gas` opcode and not a pre-calculated value (like sha256 does it).\r\nhttps://github.com/vyperlang/vyper/blob/master/vyper/parser/parser_utils.py#L120",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/564431863/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/564434475",
    "html_url": "https://github.com/vyperlang/vyper/issues/1761#issuecomment-564434475",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1761",
    "id": 564434475,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NDQzNDQ3NQ==",
    "user": {
      "login": "daejunpark",
      "id": 5491770,
      "node_id": "MDQ6VXNlcjU0OTE3NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5491770?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/daejunpark",
      "html_url": "https://github.com/daejunpark",
      "followers_url": "https://api.github.com/users/daejunpark/followers",
      "following_url": "https://api.github.com/users/daejunpark/following{/other_user}",
      "gists_url": "https://api.github.com/users/daejunpark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/daejunpark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daejunpark/subscriptions",
      "organizations_url": "https://api.github.com/users/daejunpark/orgs",
      "repos_url": "https://api.github.com/users/daejunpark/repos",
      "events_url": "https://api.github.com/users/daejunpark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/daejunpark/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-11T08:32:35Z",
    "updated_at": "2019-12-11T08:32:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think this needs to be fixed as well:\r\nhttps://github.com/vyperlang/vyper/blob/master/vyper/parser/parser_utils.py#L168",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/564434475/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/564436514",
    "html_url": "https://github.com/vyperlang/vyper/issues/1761#issuecomment-564436514",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1761",
    "id": 564436514,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NDQzNjUxNA==",
    "user": {
      "login": "daejunpark",
      "id": 5491770,
      "node_id": "MDQ6VXNlcjU0OTE3NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5491770?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/daejunpark",
      "html_url": "https://github.com/daejunpark",
      "followers_url": "https://api.github.com/users/daejunpark/followers",
      "following_url": "https://api.github.com/users/daejunpark/following{/other_user}",
      "gists_url": "https://api.github.com/users/daejunpark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/daejunpark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daejunpark/subscriptions",
      "organizations_url": "https://api.github.com/users/daejunpark/orgs",
      "repos_url": "https://api.github.com/users/daejunpark/repos",
      "events_url": "https://api.github.com/users/daejunpark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/daejunpark/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-11T08:38:22Z",
    "updated_at": "2019-12-11T08:38:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "Indeed, there are other places whether the same thing happens, e.g.,\r\nhttps://github.com/vyperlang/vyper/blob/master/vyper/functions/functions.py#L452\r\nhttps://github.com/vyperlang/vyper/blob/master/vyper/functions/functions.py#L473\r\nhttps://github.com/vyperlang/vyper/blob/master/vyper/functions/functions.py#L490\r\nhttps://github.com/vyperlang/vyper/blob/master/vyper/functions/functions.py#L941-L942\r\n\r\nNot sure if there are more, though.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/564436514/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/564443460",
    "html_url": "https://github.com/vyperlang/vyper/issues/1761#issuecomment-564443460",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1761",
    "id": 564443460,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NDQ0MzQ2MA==",
    "user": {
      "login": "jacqueswww",
      "id": 6917456,
      "node_id": "MDQ6VXNlcjY5MTc0NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6917456?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jacqueswww",
      "html_url": "https://github.com/jacqueswww",
      "followers_url": "https://api.github.com/users/jacqueswww/followers",
      "following_url": "https://api.github.com/users/jacqueswww/following{/other_user}",
      "gists_url": "https://api.github.com/users/jacqueswww/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jacqueswww/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jacqueswww/subscriptions",
      "organizations_url": "https://api.github.com/users/jacqueswww/orgs",
      "repos_url": "https://api.github.com/users/jacqueswww/repos",
      "events_url": "https://api.github.com/users/jacqueswww/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jacqueswww/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-11T08:57:44Z",
    "updated_at": "2019-12-11T08:57:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yes indeed; thanks.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/564443460/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/565869402",
    "html_url": "https://github.com/vyperlang/vyper/issues/1761#issuecomment-565869402",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1761",
    "id": 565869402,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NTg2OTQwMg==",
    "user": {
      "login": "djrtwo",
      "id": 1433595,
      "node_id": "MDQ6VXNlcjE0MzM1OTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1433595?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/djrtwo",
      "html_url": "https://github.com/djrtwo",
      "followers_url": "https://api.github.com/users/djrtwo/followers",
      "following_url": "https://api.github.com/users/djrtwo/following{/other_user}",
      "gists_url": "https://api.github.com/users/djrtwo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/djrtwo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/djrtwo/subscriptions",
      "organizations_url": "https://api.github.com/users/djrtwo/orgs",
      "repos_url": "https://api.github.com/users/djrtwo/repos",
      "events_url": "https://api.github.com/users/djrtwo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/djrtwo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-16T01:17:59Z",
    "updated_at": "2019-12-16T01:17:59Z",
    "author_association": "NONE",
    "body": "I want second the request to hotfix this as a release on b13 in addition to incorporating it for further releases. Our formal verification efforts on the eth2 deposit contract are very near complete and bumping to b14+ to fix this bug would majorly set us back.\r\n\r\nThank you!",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/565869402/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/566107188",
    "html_url": "https://github.com/vyperlang/vyper/issues/1761#issuecomment-566107188",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1761",
    "id": 566107188,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NjEwNzE4OA==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-16T15:23:01Z",
    "updated_at": "2019-12-16T15:23:01Z",
    "author_association": "MEMBER",
    "body": "It should be possible to have a fix for this be easily based on b13. We'd like to avoid maintaining a fork of b13, but obviously want to help.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/566107188/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/566753158",
    "html_url": "https://github.com/vyperlang/vyper/issues/1761#issuecomment-566753158",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1761",
    "id": 566753158,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2Njc1MzE1OA==",
    "user": {
      "login": "daejunpark",
      "id": 5491770,
      "node_id": "MDQ6VXNlcjU0OTE3NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5491770?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/daejunpark",
      "html_url": "https://github.com/daejunpark",
      "followers_url": "https://api.github.com/users/daejunpark/followers",
      "following_url": "https://api.github.com/users/daejunpark/following{/other_user}",
      "gists_url": "https://api.github.com/users/daejunpark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/daejunpark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/daejunpark/subscriptions",
      "organizations_url": "https://api.github.com/users/daejunpark/orgs",
      "repos_url": "https://api.github.com/users/daejunpark/repos",
      "events_url": "https://api.github.com/users/daejunpark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/daejunpark/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-17T21:18:15Z",
    "updated_at": "2019-12-17T21:18:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jacqueswww I made a PR that fixes this.  Could you please take a look?\r\n@fubuloubu I don't think the custom hotfix release needs to be further maintained in the future.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/566753158/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
