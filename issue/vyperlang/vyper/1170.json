{
  "url": "https://api.github.com/repos/vyperlang/vyper/issues/1170",
  "repository_url": "https://api.github.com/repos/vyperlang/vyper",
  "labels_url": "https://api.github.com/repos/vyperlang/vyper/issues/1170/labels{/name}",
  "comments_url": "https://api.github.com/repos/vyperlang/vyper/issues/1170/comments",
  "events_url": "https://api.github.com/repos/vyperlang/vyper/issues/1170/events",
  "html_url": "https://github.com/vyperlang/vyper/issues/1170",
  "id": 395727282,
  "node_id": "MDU6SXNzdWUzOTU3MjcyODI=",
  "number": 1170,
  "title": "VIP Structs in Events",
  "user": {
    "login": "fubuloubu",
    "id": 3859395,
    "node_id": "MDQ6VXNlcjM4NTkzOTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fubuloubu",
    "html_url": "https://github.com/fubuloubu",
    "followers_url": "https://api.github.com/users/fubuloubu/followers",
    "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
    "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
    "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
    "repos_url": "https://api.github.com/users/fubuloubu/repos",
    "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 757250644,
      "node_id": "MDU6TGFiZWw3NTcyNTA2NDQ=",
      "url": "https://api.github.com/repos/vyperlang/vyper/labels/VIP:%20Approved",
      "name": "VIP: Approved",
      "color": "98f765",
      "default": false,
      "description": "VIP Approved"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": {
    "url": "https://api.github.com/repos/vyperlang/vyper/milestones/2",
    "html_url": "https://github.com/vyperlang/vyper/milestone/2",
    "labels_url": "https://api.github.com/repos/vyperlang/vyper/milestones/2/labels",
    "id": 5624309,
    "node_id": "MDk6TWlsZXN0b25lNTYyNDMwOQ==",
    "number": 2,
    "title": "v0.3.0 Release",
    "description": "",
    "creator": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 4,
    "closed_issues": 11,
    "state": "open",
    "created_at": "2020-07-06T18:39:04Z",
    "updated_at": "2022-06-08T21:08:17Z",
    "due_on": null,
    "closed_at": null
  },
  "comments": 6,
  "created_at": "2019-01-03T21:16:43Z",
  "updated_at": "2021-08-06T01:50:35Z",
  "closed_at": "2021-08-06T01:50:35Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "## Simple Summary\r\nAllow emitting structs in events\r\n\r\n## Abstract\r\nABIv2 will allow emitting structs inside events.\r\nThis behavior is not well-defined (@davesque please confirm).\r\n\r\n## Motivation\r\nWorking with structs as input arguments, it may be useful to emit structs inside events for the client-side to use after a transaction has been mined e.g. a Deposit transaction in Plasma.\r\n\r\nAs mentioned by @charles-cooper in #1019 \r\n\r\n## Specification\r\nSpecification is WIP, but here are a few possibilities:\r\n\r\nDirectly outputing a struct:\r\n```python\r\nstruct Transaction:\r\n    prevBlkNum: uint256\r\n    tokenId: uint256\r\n    newOwner: address\r\n    signature: bytes[65]  # VRS\r\n\r\nDepositAdded: event({txn: Transaction})\r\n\r\ndef foo(txn: Transaction):\r\n    log.DepositAdded(txn)\r\n```\r\n\r\nOutputting only certain members of a struct:\r\n```python\r\n# Should we allow indexing event args in this way?\r\nDepositAdded: event({tokenId: uint256, newOwner: address})\r\n\r\ndef foo(txn: Transaction):\r\n    # Compiles to `log.DepositAdded(txn.tokenId, txn.newOwner)`\r\n    log.DepositAdded(**txn)  # because who doesn't love kwargs?\r\n```\r\n\r\nIndexing:\r\n```python\r\n# Do we allow structs to be indexed? ABIv2 is inconclusive I believe\r\nDepositAdded: event({txn: indexed(Transaction)})\r\n\r\n# Should we allow indexing event args in this way?\r\nDepositAdded: event({tokenId: indexed(uint256), newOwner: address})\r\n\r\n# Should we allow indexing members indirectly?\r\nDepositAdded: event({txn: Transaction}, indexed=[txn.newOwner, txn.tokenId])\r\n```\r\n\r\n\r\n## Backwards Compatibility\r\nNo backwards compatibility issues\r\n\r\n## Copyright\r\nCopyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/)\r\n",
  "closed_by": {
    "login": "charles-cooper",
    "id": 3867501,
    "node_id": "MDQ6VXNlcjM4Njc1MDE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3867501?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/charles-cooper",
    "html_url": "https://github.com/charles-cooper",
    "followers_url": "https://api.github.com/users/charles-cooper/followers",
    "following_url": "https://api.github.com/users/charles-cooper/following{/other_user}",
    "gists_url": "https://api.github.com/users/charles-cooper/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/charles-cooper/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/charles-cooper/subscriptions",
    "organizations_url": "https://api.github.com/users/charles-cooper/orgs",
    "repos_url": "https://api.github.com/users/charles-cooper/repos",
    "events_url": "https://api.github.com/users/charles-cooper/events{/privacy}",
    "received_events_url": "https://api.github.com/users/charles-cooper/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/1170/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/vyperlang/vyper/issues/1170/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/451353036",
    "html_url": "https://github.com/vyperlang/vyper/issues/1170#issuecomment-451353036",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1170",
    "id": 451353036,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MTM1MzAzNg==",
    "user": {
      "login": "davesque",
      "id": 791437,
      "node_id": "MDQ6VXNlcjc5MTQzNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/791437?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/davesque",
      "html_url": "https://github.com/davesque",
      "followers_url": "https://api.github.com/users/davesque/followers",
      "following_url": "https://api.github.com/users/davesque/following{/other_user}",
      "gists_url": "https://api.github.com/users/davesque/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/davesque/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/davesque/subscriptions",
      "organizations_url": "https://api.github.com/users/davesque/orgs",
      "repos_url": "https://api.github.com/users/davesque/repos",
      "events_url": "https://api.github.com/users/davesque/events{/privacy}",
      "received_events_url": "https://api.github.com/users/davesque/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-04T04:50:44Z",
    "updated_at": "2019-01-04T04:50:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "@fubuloubu I believe that information included in an event is encoded as arguments of a functional call would be minus any function selector at the beginning.  This would include structs which would be encoded as tuples.  Source is second sentence in this section of the current ABI spec: https://solidity.readthedocs.io/en/develop/abi-spec.html#argument-encoding",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/451353036/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/451554527",
    "html_url": "https://github.com/vyperlang/vyper/issues/1170#issuecomment-451554527",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1170",
    "id": 451554527,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MTU1NDUyNw==",
    "user": {
      "login": "charles-cooper",
      "id": 3867501,
      "node_id": "MDQ6VXNlcjM4Njc1MDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3867501?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/charles-cooper",
      "html_url": "https://github.com/charles-cooper",
      "followers_url": "https://api.github.com/users/charles-cooper/followers",
      "following_url": "https://api.github.com/users/charles-cooper/following{/other_user}",
      "gists_url": "https://api.github.com/users/charles-cooper/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/charles-cooper/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/charles-cooper/subscriptions",
      "organizations_url": "https://api.github.com/users/charles-cooper/orgs",
      "repos_url": "https://api.github.com/users/charles-cooper/repos",
      "events_url": "https://api.github.com/users/charles-cooper/events{/privacy}",
      "received_events_url": "https://api.github.com/users/charles-cooper/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-04T20:08:03Z",
    "updated_at": "2019-01-04T20:08:25Z",
    "author_association": "COLLABORATOR",
    "body": "@fubuloubu I like the syntax for directly outputting a struct but I think the member selection is too magical. Users should have to specify which fields they want to log/index.\r\n\r\nRe. indexing on a struct, according the EVM spec, each LOG topic is one word, so we would have to apply a map from struct to uint256/bytes32 (e.g. keccak256) and I think that is overfunctioning on behalf of the user. Besides, the topic data is not accessible so I'm having trouble thinking of a case where somebody would want to index a struct but not already have the hash.\r\n\r\nI think Solidity uses the ABIv2 encoding but I'm not sure if it is packed or unpacked. For compatibility we should use whatever it uses.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/451554527/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/451995327",
    "html_url": "https://github.com/vyperlang/vyper/issues/1170#issuecomment-451995327",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1170",
    "id": 451995327,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MTk5NTMyNw==",
    "user": {
      "login": "charles-cooper",
      "id": 3867501,
      "node_id": "MDQ6VXNlcjM4Njc1MDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3867501?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/charles-cooper",
      "html_url": "https://github.com/charles-cooper",
      "followers_url": "https://api.github.com/users/charles-cooper/followers",
      "following_url": "https://api.github.com/users/charles-cooper/following{/other_user}",
      "gists_url": "https://api.github.com/users/charles-cooper/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/charles-cooper/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/charles-cooper/subscriptions",
      "organizations_url": "https://api.github.com/users/charles-cooper/orgs",
      "repos_url": "https://api.github.com/users/charles-cooper/repos",
      "events_url": "https://api.github.com/users/charles-cooper/events{/privacy}",
      "received_events_url": "https://api.github.com/users/charles-cooper/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-07T16:34:46Z",
    "updated_at": "2019-01-07T16:34:46Z",
    "author_association": "COLLABORATOR",
    "body": "According to solidity team https://gitter.im/ethereum/solidity-dev?at=5c3328241948ad07e8000c16\r\n> non-indexed structs should be abi-encoded, indexed structs should be packed and hashed.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/451995327/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/452004389",
    "html_url": "https://github.com/vyperlang/vyper/issues/1170#issuecomment-452004389",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1170",
    "id": 452004389,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MjAwNDM4OQ==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-07T17:00:29Z",
    "updated_at": "2019-01-07T17:00:29Z",
    "author_association": "MEMBER",
    "body": "\"packed and hashed\" hmm. So is it included both as a hash and as an ABI-encoded, unindexed data?",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/452004389/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/452005362",
    "html_url": "https://github.com/vyperlang/vyper/issues/1170#issuecomment-452005362",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1170",
    "id": 452005362,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MjAwNTM2Mg==",
    "user": {
      "login": "charles-cooper",
      "id": 3867501,
      "node_id": "MDQ6VXNlcjM4Njc1MDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3867501?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/charles-cooper",
      "html_url": "https://github.com/charles-cooper",
      "followers_url": "https://api.github.com/users/charles-cooper/followers",
      "following_url": "https://api.github.com/users/charles-cooper/following{/other_user}",
      "gists_url": "https://api.github.com/users/charles-cooper/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/charles-cooper/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/charles-cooper/subscriptions",
      "organizations_url": "https://api.github.com/users/charles-cooper/orgs",
      "repos_url": "https://api.github.com/users/charles-cooper/repos",
      "events_url": "https://api.github.com/users/charles-cooper/events{/privacy}",
      "received_events_url": "https://api.github.com/users/charles-cooper/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-07T17:03:10Z",
    "updated_at": "2019-01-07T17:03:10Z",
    "author_association": "COLLABORATOR",
    "body": "Not automatically. If you wanted to do that you would have to include it twice, like `event Log(indexed Foo foo, Foo foo)`. It seems cumbersome but since logging costs a decent amount of gas the programmer should have control over those things.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/452005362/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/452024228",
    "html_url": "https://github.com/vyperlang/vyper/issues/1170#issuecomment-452024228",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1170",
    "id": 452024228,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MjAyNDIyOA==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-07T18:00:36Z",
    "updated_at": "2019-01-07T18:00:36Z",
    "author_association": "MEMBER",
    "body": "I guess it would be helpful if the struct was a transaction, and you were waiting on it to be confirmed in the contract, sort of like \"transaction hash was mined!\"",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/452024228/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
