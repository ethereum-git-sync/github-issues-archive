{
  "url": "https://api.github.com/repos/vyperlang/vyper/issues/806",
  "repository_url": "https://api.github.com/repos/vyperlang/vyper",
  "labels_url": "https://api.github.com/repos/vyperlang/vyper/issues/806/labels{/name}",
  "comments_url": "https://api.github.com/repos/vyperlang/vyper/issues/806/comments",
  "events_url": "https://api.github.com/repos/vyperlang/vyper/issues/806/events",
  "html_url": "https://github.com/vyperlang/vyper/issues/806",
  "id": 320448117,
  "node_id": "MDU6SXNzdWUzMjA0NDgxMTc=",
  "number": 806,
  "title": "VIP: Merkle Proof built in function",
  "user": {
    "login": "haydenadams",
    "id": 9343483,
    "node_id": "MDQ6VXNlcjkzNDM0ODM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9343483?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/haydenadams",
    "html_url": "https://github.com/haydenadams",
    "followers_url": "https://api.github.com/users/haydenadams/followers",
    "following_url": "https://api.github.com/users/haydenadams/following{/other_user}",
    "gists_url": "https://api.github.com/users/haydenadams/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/haydenadams/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/haydenadams/subscriptions",
    "organizations_url": "https://api.github.com/users/haydenadams/orgs",
    "repos_url": "https://api.github.com/users/haydenadams/repos",
    "events_url": "https://api.github.com/users/haydenadams/events{/privacy}",
    "received_events_url": "https://api.github.com/users/haydenadams/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 13,
  "created_at": "2018-05-04T22:27:25Z",
  "updated_at": "2019-04-08T19:51:27Z",
  "closed_at": "2019-04-08T19:51:26Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Preamble\r\n\r\n    VIP: 806\r\n    Title: VIP Merkle Proof built in function\r\n    Author: @haydenadams @fubuloubu \r\n    Type: Standard Track \r\n    Status: Draft\r\n    Created: 2018-05-04\r\n\r\n\r\n## Simple Summary\r\nBuilt in function to generate merkle proofs. \r\n\r\n## Abstract\r\nImplement a built-in function for computing merkle roots from merkle proofs.\r\n\r\n## Motivation\r\nMerkle proofs are useful and awesome, and can be difficult to implement. Having a built in function similar to ecrecover would greatly simplify these proofs.\r\n\r\n## Specification\r\nIn order to implement as a constant time function, we need to specify a maximum depth of the tree that we can compute the root hash for. A depth of 32 would be 4bn leaves, which should sufficient for nearly all applications.\r\n\r\nThe function inputs would be a static array of 32 256-bit hashes in a merkle tree, in increasing order form, and an integer between 2-32 specifying the depth. \r\n\r\n\"Increasing Order Form\" means the first element is hashed with the second, which is hashed with the third, etc. until the depth is met. The caller would have to provide their proof in this structure.\r\n\r\nThis function will return the resulting merkle root of the proof, which can be compared to a stored value or stored itself.\r\n\r\n## Backwards Compatibility\r\nNew feature\r\n\r\n## Copyright\r\nCopyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/)",
  "closed_by": {
    "login": "fubuloubu",
    "id": 3859395,
    "node_id": "MDQ6VXNlcjM4NTkzOTU=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/fubuloubu",
    "html_url": "https://github.com/fubuloubu",
    "followers_url": "https://api.github.com/users/fubuloubu/followers",
    "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
    "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
    "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
    "repos_url": "https://api.github.com/users/fubuloubu/repos",
    "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/806/reactions",
    "total_count": 1,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 1,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/vyperlang/vyper/issues/806/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/386773560",
    "html_url": "https://github.com/vyperlang/vyper/issues/806#issuecomment-386773560",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/806",
    "id": 386773560,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4Njc3MzU2MA==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-05T02:41:07Z",
    "updated_at": "2018-05-05T02:41:07Z",
    "author_association": "MEMBER",
    "body": "Definitely post-beta but would be really useful for implementing plasma chain contracts!",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/386773560/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/386798323",
    "html_url": "https://github.com/vyperlang/vyper/issues/806#issuecomment-386798323",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/806",
    "id": 386798323,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4Njc5ODMyMw==",
    "user": {
      "login": "jacqueswww",
      "id": 6917456,
      "node_id": "MDQ6VXNlcjY5MTc0NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6917456?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jacqueswww",
      "html_url": "https://github.com/jacqueswww",
      "followers_url": "https://api.github.com/users/jacqueswww/followers",
      "following_url": "https://api.github.com/users/jacqueswww/following{/other_user}",
      "gists_url": "https://api.github.com/users/jacqueswww/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jacqueswww/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jacqueswww/subscriptions",
      "organizations_url": "https://api.github.com/users/jacqueswww/orgs",
      "repos_url": "https://api.github.com/users/jacqueswww/repos",
      "events_url": "https://api.github.com/users/jacqueswww/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jacqueswww/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-05T11:19:36Z",
    "updated_at": "2018-05-05T11:20:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "@haydenadams I had this lying around. I think this is the function you had in mind (to be placed in the 'stdlib') ?\r\n\r\n```python\r\n@constant\r\n@public\r\ndef verify(proofs: bytes32[100], root: bytes32, leaf: bytes32) -> bool:\r\n\r\n    computed_hash: bytes32 = leaf\r\n    for proof in proofs:\r\n        if leaf < proof:\r\n            computed_hash = sha3(concat(computed_hash, proof))\r\n        else:\r\n            computed_hash = sha3(concat(proof, computed_hash))\r\n\r\n    return computed_hash == root\r\n```\r\n\r\nThen I am not sure about generating proofs on contracts, what is the use case for that?",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/386798323/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/386807713",
    "html_url": "https://github.com/vyperlang/vyper/issues/806#issuecomment-386807713",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/806",
    "id": 386807713,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NjgwNzcxMw==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-05T14:01:39Z",
    "updated_at": "2018-05-05T14:01:39Z",
    "author_association": "MEMBER",
    "body": "By removing the root hash from this function, you can also compute a root hash for storage. It wouldn't lock you only to verification of the proof.\r\n\r\nAlso, in your implementation, why do you switch the hashes based on comparision? Does the merkle proof algorithm require strict ascending order?\r\n\r\nBest use case of this would be for implementation of Plasma contracts and other similar proof-based paradigms",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/386807713/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 2,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/421204878",
    "html_url": "https://github.com/vyperlang/vyper/issues/806#issuecomment-421204878",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/806",
    "id": 421204878,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQyMTIwNDg3OA==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-09-14T01:48:17Z",
    "updated_at": "2018-09-14T01:48:17Z",
    "author_association": "MEMBER",
    "body": "@jacqueswww should we explore this now?",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/421204878/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/431408735",
    "html_url": "https://github.com/vyperlang/vyper/issues/806#issuecomment-431408735",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/806",
    "id": 431408735,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTQwODczNQ==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-19T15:47:58Z",
    "updated_at": "2018-10-19T15:47:58Z",
    "author_association": "MEMBER",
    "body": "My suggestion for API:\r\n\r\nMerkle root calculator macro: `calc_merkle_root(leaf, path, proof) -> bytes32`\r\n1. `leaf` would be of a type that is hashable to obtain the leaf hash that starts the proof. This may include structs (which are RLP-encoded before being hashed), and basically any datatype we have that `keccak256(x)` accepts as an argument\r\n2. 'path' would be a basic type (less than 32 bytes) and is used to merkelize the branch to obtain the root. Note that LSB corresponds to the leaf hash, and each path choice corresponds to each bit moving up the path. The value is converted to an integer internally.\r\n3. `proof` would be a static list of `bytes32` objects. The size of this list determines the depth of the tree, as well as the height of the MSB corresponding to the root path choice in `path`.\r\n\r\nFor example, for a tree depth of 160 (length of an `address`, which we use as the `path`) and a leaf that is a `uint256` value, the signature would be `calc_merkle_root(leaf: uint256, path: address, proof: bytes32[160]) -> bytes32`.\r\n\r\nThis widget can be used to calculate roots for both validation against known roots and creation of new ones (Plasma Cash uses both).\r\n\r\nAdditional note: a constant `EMPTY_MERKLE_BRANCH[N]` should be added that corresponds to the default case of a tree with all leaves set to `bytes32(0)` for depth `N`. This is useful for creation of new roots, e.g. `calc_merkle_root(1, msg.sender, EMPTY_MERKLE_BRANCH[160]` in our previous example.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/431408735/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/444690658",
    "html_url": "https://github.com/vyperlang/vyper/issues/806#issuecomment-444690658",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/806",
    "id": 444690658,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NDY5MDY1OA==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-05T23:26:53Z",
    "updated_at": "2018-12-05T23:29:11Z",
    "author_association": "MEMBER",
    "body": "A modification of this proposal:\r\n\r\n`leaf` should be the node itself (the hashed content or value) and not the value at the child of the leaf node in the tree. This allows more flexibility in how this API would be used. The suggestion would look like:\r\n\r\n```python\r\nassert self.root_hash == calc_root(key, keccak256(value), proof)\r\n```\r\n\r\nInstead of\r\n\r\n```python\r\nassert self.root_hash == calc_root(key, value, proof)\r\n```\r\n\r\nCould also make the argument that `key` should have to be a 256-bit integer type and the path-length for the macro gets derived from the proof length, to make this as easy as possible to implement",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/444690658/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/451638574",
    "html_url": "https://github.com/vyperlang/vyper/issues/806#issuecomment-451638574",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/806",
    "id": 451638574,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MTYzODU3NA==",
    "user": {
      "login": "nrryuya",
      "id": 22876645,
      "node_id": "MDQ6VXNlcjIyODc2NjQ1",
      "avatar_url": "https://avatars.githubusercontent.com/u/22876645?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nrryuya",
      "html_url": "https://github.com/nrryuya",
      "followers_url": "https://api.github.com/users/nrryuya/followers",
      "following_url": "https://api.github.com/users/nrryuya/following{/other_user}",
      "gists_url": "https://api.github.com/users/nrryuya/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nrryuya/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nrryuya/subscriptions",
      "organizations_url": "https://api.github.com/users/nrryuya/orgs",
      "repos_url": "https://api.github.com/users/nrryuya/repos",
      "events_url": "https://api.github.com/users/nrryuya/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nrryuya/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-05T08:43:40Z",
    "updated_at": "2019-01-05T08:43:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "This is a different design from Bryant's proposal but I developed [an implementation](https://github.com/LayerXcom/verified-vyper-contracts/blob/master/contracts/merkle/MerkleTree.vy) and [a test](https://github.com/LayerXcom/verified-vyper-contracts/blob/master/tests/merkle/test_merkle.py) for people who use it before it gets built-in.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/451638574/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/451665063",
    "html_url": "https://github.com/vyperlang/vyper/issues/806#issuecomment-451665063",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/806",
    "id": 451665063,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MTY2NTA2Mw==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-05T15:33:12Z",
    "updated_at": "2019-01-05T15:36:12Z",
    "author_association": "MEMBER",
    "body": "@nrryuya should add your assumption of the layout on the variables like I did. It's important to get those right.\r\n\r\nThe reason why I did mine the way I did was that the depth of the tree grows the size of the list, so deeper elements would get pushed down further instead of appended in front. This matches the other implementations within https://github.com/ethereum/py-trie by @pipermerriam et al. The choice of MSB in the keypath was done similarly.\r\n\r\nReally important we are consistent with this.\r\n\r\nNOTE: I added an SMT class in py-trie. You should probably test against that. (Also log any inconsistencies in my approach)",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/451665063/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/451710189",
    "html_url": "https://github.com/vyperlang/vyper/issues/806#issuecomment-451710189",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/806",
    "id": 451710189,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MTcxMDE4OQ==",
    "user": {
      "login": "nrryuya",
      "id": 22876645,
      "node_id": "MDQ6VXNlcjIyODc2NjQ1",
      "avatar_url": "https://avatars.githubusercontent.com/u/22876645?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nrryuya",
      "html_url": "https://github.com/nrryuya",
      "followers_url": "https://api.github.com/users/nrryuya/followers",
      "following_url": "https://api.github.com/users/nrryuya/following{/other_user}",
      "gists_url": "https://api.github.com/users/nrryuya/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nrryuya/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nrryuya/subscriptions",
      "organizations_url": "https://api.github.com/users/nrryuya/orgs",
      "repos_url": "https://api.github.com/users/nrryuya/repos",
      "events_url": "https://api.github.com/users/nrryuya/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nrryuya/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-06T02:41:01Z",
    "updated_at": "2019-01-06T02:41:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "@fubuloubu \r\nThank you! I'll look into that.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/451710189/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/479974257",
    "html_url": "https://github.com/vyperlang/vyper/issues/806#issuecomment-479974257",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/806",
    "id": 479974257,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3OTk3NDI1Nw==",
    "user": {
      "login": "jacqueswww",
      "id": 6917456,
      "node_id": "MDQ6VXNlcjY5MTc0NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6917456?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jacqueswww",
      "html_url": "https://github.com/jacqueswww",
      "followers_url": "https://api.github.com/users/jacqueswww/followers",
      "following_url": "https://api.github.com/users/jacqueswww/following{/other_user}",
      "gists_url": "https://api.github.com/users/jacqueswww/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jacqueswww/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jacqueswww/subscriptions",
      "organizations_url": "https://api.github.com/users/jacqueswww/orgs",
      "repos_url": "https://api.github.com/users/jacqueswww/repos",
      "events_url": "https://api.github.com/users/jacqueswww/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jacqueswww/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-04T16:42:08Z",
    "updated_at": "2019-04-04T16:42:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "@fubuloubu I think it's time to get this into master;) is my suggested implementation ok or should I use FVyper one?",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/479974257/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/479982918",
    "html_url": "https://github.com/vyperlang/vyper/issues/806#issuecomment-479982918",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/806",
    "id": 479982918,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3OTk4MjkxOA==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-04T17:06:42Z",
    "updated_at": "2019-04-08T15:42:58Z",
    "author_association": "MEMBER",
    "body": "I think we should talk about this one at the next meeting. A couple things I would like to add for flexibility and correctness:\r\n1. The function args should be `key`, `leaf_hash`, and `proof[N]` where `N` is fixed and the size of the key.\r\n2. Branch/proof is provided in root -> leaf order, key is in MSB (root) to LSB (leaf) order\r\n3. The function name should be `calc_root` and only calculate the root from proofs and leaf hash, not verify it\r\n4. Allow the user to specify which hash function to use e.g. `calc_root(..., function=hash_function)`\r\n5. Allow list constants for empty proof with a helper function e.g. `EMPTY_BRANCH: bytes32[N] = generate_empty_proof(N, function=hash_function)`\r\n\r\nThis would produce an example that looks like this:\r\n```python\r\nN: constant(uint256) = # whatever depth the trie is\r\n\r\ndef validate_root(root_hash: bytes32, key: uint256, leaf: AnyType, proof: bytes32[N]):\r\n    leaf_hash: bytes32 = keccak256(leaf)\r\n    assert root_hash == calc_root(key, leaf_hash, proof, function=keccak256)\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/479982918/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/480903514",
    "html_url": "https://github.com/vyperlang/vyper/issues/806#issuecomment-480903514",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/806",
    "id": 480903514,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MDkwMzUxNA==",
    "user": {
      "login": "jacqueswww",
      "id": 6917456,
      "node_id": "MDQ6VXNlcjY5MTc0NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6917456?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jacqueswww",
      "html_url": "https://github.com/jacqueswww",
      "followers_url": "https://api.github.com/users/jacqueswww/followers",
      "following_url": "https://api.github.com/users/jacqueswww/following{/other_user}",
      "gists_url": "https://api.github.com/users/jacqueswww/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jacqueswww/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jacqueswww/subscriptions",
      "organizations_url": "https://api.github.com/users/jacqueswww/orgs",
      "repos_url": "https://api.github.com/users/jacqueswww/repos",
      "events_url": "https://api.github.com/users/jacqueswww/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jacqueswww/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-08T16:27:18Z",
    "updated_at": "2019-04-08T16:27:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "Meeting Notes: @fubuloubu please wrap the comment into a VIP, and then we can close this one in favour of this one.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/480903514/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/480981254",
    "html_url": "https://github.com/vyperlang/vyper/issues/806#issuecomment-480981254",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/806",
    "id": 480981254,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4MDk4MTI1NA==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-08T19:51:26Z",
    "updated_at": "2019-04-08T19:51:26Z",
    "author_association": "MEMBER",
    "body": "Deprecating in favor of #1391, which is more well-defined.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/480981254/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
