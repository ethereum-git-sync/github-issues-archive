{
  "url": "https://api.github.com/repos/vyperlang/vyper/issues/270",
  "repository_url": "https://api.github.com/repos/vyperlang/vyper",
  "labels_url": "https://api.github.com/repos/vyperlang/vyper/issues/270/labels{/name}",
  "comments_url": "https://api.github.com/repos/vyperlang/vyper/issues/270/comments",
  "events_url": "https://api.github.com/repos/vyperlang/vyper/issues/270/events",
  "html_url": "https://github.com/vyperlang/vyper/issues/270",
  "id": 233490591,
  "node_id": "MDU6SXNzdWUyMzM0OTA1OTE=",
  "number": 270,
  "title": "Error: Cannot send value to non-payable function",
  "user": {
    "login": "mikeshultz",
    "id": 1048089,
    "node_id": "MDQ6VXNlcjEwNDgwODk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1048089?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mikeshultz",
    "html_url": "https://github.com/mikeshultz",
    "followers_url": "https://api.github.com/users/mikeshultz/followers",
    "following_url": "https://api.github.com/users/mikeshultz/following{/other_user}",
    "gists_url": "https://api.github.com/users/mikeshultz/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mikeshultz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mikeshultz/subscriptions",
    "organizations_url": "https://api.github.com/users/mikeshultz/orgs",
    "repos_url": "https://api.github.com/users/mikeshultz/repos",
    "events_url": "https://api.github.com/users/mikeshultz/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mikeshultz/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2017-06-05T04:14:18Z",
  "updated_at": "2017-08-30T20:22:46Z",
  "closed_at": "2017-08-30T20:22:46Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Testing a simple deposit contract and getting a couple of issues.  I'll point the one out here and start a new ticket for the other problem.\r\n\r\n    Error: Cannot send value to non-payable function\r\n        at web3.js:4057:19\r\n        at <anonymous>:1:1\r\n\r\nHow to reproduce: \r\n\r\n# Contract\r\n\r\n    owner: address\r\n    depositors: wei_value[address]\r\n    depositorsNext: num\r\n\r\n    def __init__(_owner: address):\r\n        self.owner = _owner\r\n        self.depositorsNext = 1\r\n\r\n    def check_balance() -> wei_value:\r\n        # Return our current balance \r\n        return(self.balance)\r\n\r\n    def drain():\r\n        # Send all stored value to owner\r\n        send(self.owner, self.balance)\r\n\r\n    def deposit() -> bool:\r\n        # Deposit value in the contract and record the sender and value \r\n        \r\n        assert(msg.value > 0)\r\n\r\n        if self.depositors[msg.sender]:\r\n            self.depositors[msg.sender] += msg.value\r\n            return True\r\n        else:\r\n            self.depositors[msg.sender] = msg.value\r\n            return True\r\n\r\n# Deploy with geth\r\n\r\n    > var abi = [ { \"inputs\":[ {\"name\": \"beneficiary\", \"type\": \"address\"}, ], \"type\": \"constructor\" }, { \"type\": \"function\", \"name\": \"check_balance\", \"constant\": true, \"inputs\": [], \"outputs\": [{\"name\": \"balance\", \"type\": \"uint\"}] }, { \"type\": \"function\", \"name\": \"drain\", \"constant\": false, \"inputs\": [], \"outputs\": [] }, { \"type\": \"function\", \"name\": \"deposit\", \"constant\": false, \"inputs\": [], \"outputs\": [{\"name\": \"success\", \"type\": \"bool\"}] }]\r\n    > var bcode = \"0x600035601c52740100000000000000000000000000000000000000006020526fffffffffffffffffffffffffffffffff6040527fffffffffffffffffffffffffffffffff000000000000000000000000000000016060527402540be3fffffffffffffffffffffffffdabf41c006080527ffffffffffffffffffffffffdabf41c00000000000000000000000002540be40060a05260206020380360c03960c05160205181101558575060206020380360c03960c05160005560016002556101f456600035601c52740100000000000000000000000000000000000000006020526fffffffffffffffffffffffffffffffff6040527fffffffffffffffffffffffffffffffff000000000000000000000000000000016060527402540be3fffffffffffffffffffffffffdabf41c006080527ffffffffffffffffffffffffdabf41c00000000000000000000000002540be40060a0526398ba1d4660005114156100ad57303160005260206000f3005b639890220b60005114156100ce57600060006000600030316000546000f150005b63d0e30db06000511415610132576000341315585733600160c05260c06020200154156101175733600160c05260c06020200134815401815550600160005260206000f3610130565b3433600160c05260c06020200155600160005260206000f35b005b5b6100c16101f4036100c16000396100c16101f4036000f3\"\r\n    > ct = eth.contract(abi)\r\n    > ct.new(\"0xea4aca379b0c21b36e51380e5de936b61ca63176\", , {from: eth.accounts[0], data: bcode, gas: 4000000})\r\n\r\n# Deposit\r\n\r\n    > x = ct.at(\"0xdeadbeef...\")\r\n    > x.deposit.sendTransaction({from: eth.accounts[1], value: web3.toWei(1, \"ether\")})\r\n    Error: Cannot send value to non-payable function\r\n        at web3.js:4057:19\r\n        at <anonymous>:1:1\r\n\r\nPerhaps I'm missing something on how to send value to a function?",
  "closed_by": {
    "login": "mikeshultz",
    "id": 1048089,
    "node_id": "MDQ6VXNlcjEwNDgwODk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1048089?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mikeshultz",
    "html_url": "https://github.com/mikeshultz",
    "followers_url": "https://api.github.com/users/mikeshultz/followers",
    "following_url": "https://api.github.com/users/mikeshultz/following{/other_user}",
    "gists_url": "https://api.github.com/users/mikeshultz/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mikeshultz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mikeshultz/subscriptions",
    "organizations_url": "https://api.github.com/users/mikeshultz/orgs",
    "repos_url": "https://api.github.com/users/mikeshultz/repos",
    "events_url": "https://api.github.com/users/mikeshultz/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mikeshultz/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/270/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/vyperlang/vyper/issues/270/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/318586664",
    "html_url": "https://github.com/vyperlang/vyper/issues/270#issuecomment-318586664",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/270",
    "id": 318586664,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxODU4NjY2NA==",
    "user": {
      "login": "vbuterin",
      "id": 2230894,
      "node_id": "MDQ6VXNlcjIyMzA4OTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2230894?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vbuterin",
      "html_url": "https://github.com/vbuterin",
      "followers_url": "https://api.github.com/users/vbuterin/followers",
      "following_url": "https://api.github.com/users/vbuterin/following{/other_user}",
      "gists_url": "https://api.github.com/users/vbuterin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vbuterin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vbuterin/subscriptions",
      "organizations_url": "https://api.github.com/users/vbuterin/orgs",
      "repos_url": "https://api.github.com/users/vbuterin/repos",
      "events_url": "https://api.github.com/users/vbuterin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vbuterin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-07-28T07:52:51Z",
    "updated_at": "2017-07-28T07:52:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "Try now. I added a payable modifier to the language and the ABI, though any function that you want to send ether to will need an @payable decorator.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/318586664/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/318749202",
    "html_url": "https://github.com/vyperlang/vyper/issues/270#issuecomment-318749202",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/270",
    "id": 318749202,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxODc0OTIwMg==",
    "user": {
      "login": "mikeshultz",
      "id": 1048089,
      "node_id": "MDQ6VXNlcjEwNDgwODk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1048089?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mikeshultz",
      "html_url": "https://github.com/mikeshultz",
      "followers_url": "https://api.github.com/users/mikeshultz/followers",
      "following_url": "https://api.github.com/users/mikeshultz/following{/other_user}",
      "gists_url": "https://api.github.com/users/mikeshultz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mikeshultz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mikeshultz/subscriptions",
      "organizations_url": "https://api.github.com/users/mikeshultz/orgs",
      "repos_url": "https://api.github.com/users/mikeshultz/repos",
      "events_url": "https://api.github.com/users/mikeshultz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mikeshultz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-07-28T20:04:11Z",
    "updated_at": "2017-07-28T20:04:11Z",
    "author_association": "NONE",
    "body": "Using the `@payable` decorator on the `deposit` function on the test contract in this thread still results in the same error as before.  Using the latest from the `master` branch, though the `viper` executable still shows version `0.0.1`.  Double checked, and the new version of viper is putting out different bytecode, so I'm sure I'm not just running the old version.\r\n\r\nI tried removing the return value from the `deposit` function as well, no dice.  Let me know if there's more information I can provide.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/318749202/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/320161413",
    "html_url": "https://github.com/vyperlang/vyper/issues/270#issuecomment-320161413",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/270",
    "id": 320161413,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMDE2MTQxMw==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-04T05:41:45Z",
    "updated_at": "2017-08-04T05:41:45Z",
    "author_association": "MEMBER",
    "body": "@mikeshultz Adding `@payable` decorator to `deposit()` works in the latest. Any further issues with your example?",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/320161413/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/320170872",
    "html_url": "https://github.com/vyperlang/vyper/issues/270#issuecomment-320170872",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/270",
    "id": 320170872,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMDE3MDg3Mg==",
    "user": {
      "login": "mikeshultz",
      "id": 1048089,
      "node_id": "MDQ6VXNlcjEwNDgwODk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1048089?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mikeshultz",
      "html_url": "https://github.com/mikeshultz",
      "followers_url": "https://api.github.com/users/mikeshultz/followers",
      "following_url": "https://api.github.com/users/mikeshultz/following{/other_user}",
      "gists_url": "https://api.github.com/users/mikeshultz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mikeshultz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mikeshultz/subscriptions",
      "organizations_url": "https://api.github.com/users/mikeshultz/orgs",
      "repos_url": "https://api.github.com/users/mikeshultz/repos",
      "events_url": "https://api.github.com/users/mikeshultz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mikeshultz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-04T06:45:44Z",
    "updated_at": "2017-08-04T06:45:44Z",
    "author_association": "NONE",
    "body": "@fubuloubu You tested the example with `@payable` and it worked?  My tests failed, but I can try again if you've seen it work.  Maybe I missed something on my latest test.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/320170872/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/320274514",
    "html_url": "https://github.com/vyperlang/vyper/issues/270#issuecomment-320274514",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/270",
    "id": 320274514,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyMDI3NDUxNA==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-04T15:12:39Z",
    "updated_at": "2017-08-04T15:12:39Z",
    "author_association": "MEMBER",
    "body": "Yeah, just add the decorator above the function definition",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/320274514/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/325227149",
    "html_url": "https://github.com/vyperlang/vyper/issues/270#issuecomment-325227149",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/270",
    "id": 325227149,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTIyNzE0OQ==",
    "user": {
      "login": "DavidKnott",
      "id": 17552858,
      "node_id": "MDQ6VXNlcjE3NTUyODU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17552858?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DavidKnott",
      "html_url": "https://github.com/DavidKnott",
      "followers_url": "https://api.github.com/users/DavidKnott/followers",
      "following_url": "https://api.github.com/users/DavidKnott/following{/other_user}",
      "gists_url": "https://api.github.com/users/DavidKnott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DavidKnott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DavidKnott/subscriptions",
      "organizations_url": "https://api.github.com/users/DavidKnott/orgs",
      "repos_url": "https://api.github.com/users/DavidKnott/repos",
      "events_url": "https://api.github.com/users/DavidKnott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DavidKnott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-27T21:52:43Z",
    "updated_at": "2017-08-27T21:52:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "@mikeshultz Is the `@payable` decorator working for you now?",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/325227149/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/326107767",
    "html_url": "https://github.com/vyperlang/vyper/issues/270#issuecomment-326107767",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/270",
    "id": 326107767,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNjEwNzc2Nw==",
    "user": {
      "login": "mikeshultz",
      "id": 1048089,
      "node_id": "MDQ6VXNlcjEwNDgwODk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1048089?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mikeshultz",
      "html_url": "https://github.com/mikeshultz",
      "followers_url": "https://api.github.com/users/mikeshultz/followers",
      "following_url": "https://api.github.com/users/mikeshultz/following{/other_user}",
      "gists_url": "https://api.github.com/users/mikeshultz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mikeshultz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mikeshultz/subscriptions",
      "organizations_url": "https://api.github.com/users/mikeshultz/orgs",
      "repos_url": "https://api.github.com/users/mikeshultz/repos",
      "events_url": "https://api.github.com/users/mikeshultz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mikeshultz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-30T20:22:37Z",
    "updated_at": "2017-08-30T20:22:37Z",
    "author_association": "NONE",
    "body": "Yes, sorry about that, I screwed up my ABI.  This does indeed work now.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/326107767/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
