{
  "url": "https://api.github.com/repos/vyperlang/vyper/issues/2560",
  "repository_url": "https://api.github.com/repos/vyperlang/vyper",
  "labels_url": "https://api.github.com/repos/vyperlang/vyper/issues/2560/labels{/name}",
  "comments_url": "https://api.github.com/repos/vyperlang/vyper/issues/2560/comments",
  "events_url": "https://api.github.com/repos/vyperlang/vyper/issues/2560/events",
  "html_url": "https://github.com/vyperlang/vyper/issues/2560",
  "id": 1074756193,
  "node_id": "I_kwDOBGDvrM5AD3ph",
  "number": 2560,
  "title": "Question about calling payable functions of interface contracts",
  "user": {
    "login": "SebasKoel",
    "id": 66252156,
    "node_id": "MDQ6VXNlcjY2MjUyMTU2",
    "avatar_url": "https://avatars.githubusercontent.com/u/66252156?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/SebasKoel",
    "html_url": "https://github.com/SebasKoel",
    "followers_url": "https://api.github.com/users/SebasKoel/followers",
    "following_url": "https://api.github.com/users/SebasKoel/following{/other_user}",
    "gists_url": "https://api.github.com/users/SebasKoel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/SebasKoel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/SebasKoel/subscriptions",
    "organizations_url": "https://api.github.com/users/SebasKoel/orgs",
    "repos_url": "https://api.github.com/users/SebasKoel/repos",
    "events_url": "https://api.github.com/users/SebasKoel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/SebasKoel/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2021-12-08T19:25:08Z",
  "updated_at": "2021-12-09T15:01:53Z",
  "closed_at": "2021-12-09T14:58:09Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi,\r\n\r\nFirst of all great work you all are doing! I hope to be able to be of help when I'm more familiar with the code.\r\n\r\nI do have an issue which I tried to lookup but cannot find the answer to.\r\n\r\nI think one of the reasons why Vyper isn't really used yet is because the current state in cryptoland is that all tokens being launched are copy-paste from other contracts. Since I don't really like Java or Javascript I wanted to rewrite a Reflection Token contract in Vyper and open source a repo with Brownie and all tests included.\r\nI think creating a copy-paste option with tests and a walkthrough can really boost Vyper and maybe prevent some actually cool projects from failing due to contract issues.\r\n\r\nHowever I'm running into an issue:\r\nI want to call an Uniswap function via an interface and cannot figure out how this works.\r\n\r\nThis is the code:\r\n\r\n```\r\n\r\n    interface IUniswapV2Factory:\r\n        def createPair(token_A: address,token_B :address) -> address : view\r\n\r\n\r\n    interface IUniswapV2Router02:\r\n        def swapExactTokensForETHSupportingFeeOnTransferTokens(\r\n            amountIn: uint256,\r\n            amountOutMin: uint256,\r\n            path: address[2],\r\n            to: address,\r\n            deadline: uint256\r\n        ) : view\r\n        def factory() -> address : pure\r\n        def WETH() -> address : pure\r\n        def addLiquidityETH(\r\n            token: address,\r\n            amountTokenDesired: uint256,\r\n            amountTokenMin: uint256,\r\n            amountETHMin: uint256,\r\n            to: address,\r\n            deadline: uint256\r\n        ) -> (uint256, uint256, uint256): payable\r\n\r\n\r\n    @external\r\n    def create_pair_and_lp_uniswap() -> bool:\r\n        \"\"\"\r\n        @notice Creates a WETH/TOKEN pair contract on Uniswap V2\r\n            and deposits the ETH and Tokens in this contract into\r\n            the liquidity pool\r\n        @return True if succesfull, False otherwise \r\n        \"\"\"\r\n        assert self.owner == msg.sender, \"This function can only be called by the contract owner\"\r\n        assert self.uniswap_ready == False, \"Uniswap pair and liquidity pool already created\"\r\n        uniswap_router_address: address = 0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D\r\n        self.uniswap_contract = IUniswapV2Router02(uniswap_router_address)\r\n        self._approve(self, uniswap_router_address, self.totalSupply)\r\n        self.uniswap_factory = IUniswapV2Factory(self.uniswap_contract.factory())\r\n      \r\n        pair_address: address = self.uniswap_factory.createPair(self , self.uniswap_contract.WETH())\r\n        contract_balance: uint256 = self.r_balances[self] / (self.r_supply / self.totalSupply)\r\n\r\n        amountToken: uint256 = 0\r\n        amountETH: uint256 = 0\r\n        liquidity: uint256 = 0\r\n\r\n        #here we need to send a transaction to the Uniswap router with the token and the Eth to go into the liquidity pool.\r\n        # but cannot find how to send along Eth.\r\n        tx = self.uniswap_contract.addLiquidityETH(self, contract_balance,0,0,self.owner,block.timestamp)\r\n\r\n        self.uniswap_ready = True\r\n\r\n        return True\r\n\r\n\r\n```\r\nAnd this is the working code in Solidity:\r\n\r\n`\r\n        \r\n    function openTrading() external onlyOwner() {\r\n        require(!tradingOpen,\"trading is already open\");\r\n        IUniswapV2Router02 _uniswapV2Router = IUniswapV2Router02(0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D);\r\n        uniswapV2Router = _uniswapV2Router;\r\n        _approve(address(this), address(uniswapV2Router), _tTotal);\r\n        uniswapV2Pair = IUniswapV2Factory(_uniswapV2Router.factory()).createPair(address(this), _uniswapV2Router.WETH());\r\n        uniswapV2Router.addLiquidityETH{value: address(this).balance}(address(this),balanceOf(address(this)),0,0,owner(),block.timestamp);\r\n        IERC20(uniswapV2Pair).approve(address(uniswapV2Router), type(uint).max);\r\n    }\r\n`\r\n\r\n\r\nSo how do I call a payable function in Vyper?\r\n\r\nThanks in advance\r\n\r\nOhh and a cute animal pic:\r\n\r\n![squirell](https://user-images.githubusercontent.com/66252156/145271127-85284a6a-4397-4059-b19f-a6504fb221fa.jpeg)\r\n",
  "closed_by": {
    "login": "SebasKoel",
    "id": 66252156,
    "node_id": "MDQ6VXNlcjY2MjUyMTU2",
    "avatar_url": "https://avatars.githubusercontent.com/u/66252156?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/SebasKoel",
    "html_url": "https://github.com/SebasKoel",
    "followers_url": "https://api.github.com/users/SebasKoel/followers",
    "following_url": "https://api.github.com/users/SebasKoel/following{/other_user}",
    "gists_url": "https://api.github.com/users/SebasKoel/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/SebasKoel/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/SebasKoel/subscriptions",
    "organizations_url": "https://api.github.com/users/SebasKoel/orgs",
    "repos_url": "https://api.github.com/users/SebasKoel/repos",
    "events_url": "https://api.github.com/users/SebasKoel/events{/privacy}",
    "received_events_url": "https://api.github.com/users/SebasKoel/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/2560/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/vyperlang/vyper/issues/2560/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/989933346",
    "html_url": "https://github.com/vyperlang/vyper/issues/2560#issuecomment-989933346",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/2560",
    "id": 989933346,
    "node_id": "IC_kwDOBGDvrM47AS8i",
    "user": {
      "login": "SebasKoel",
      "id": 66252156,
      "node_id": "MDQ6VXNlcjY2MjUyMTU2",
      "avatar_url": "https://avatars.githubusercontent.com/u/66252156?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SebasKoel",
      "html_url": "https://github.com/SebasKoel",
      "followers_url": "https://api.github.com/users/SebasKoel/followers",
      "following_url": "https://api.github.com/users/SebasKoel/following{/other_user}",
      "gists_url": "https://api.github.com/users/SebasKoel/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SebasKoel/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SebasKoel/subscriptions",
      "organizations_url": "https://api.github.com/users/SebasKoel/orgs",
      "repos_url": "https://api.github.com/users/SebasKoel/repos",
      "events_url": "https://api.github.com/users/SebasKoel/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SebasKoel/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-09T15:01:52Z",
    "updated_at": "2021-12-09T15:01:52Z",
    "author_association": "NONE",
    "body": "The Factory interface function createpair should've been nonpayable. \r\n\r\nAs for calling payable functions an extra parameter with value should be added.\r\n\r\nLike this:\r\n\r\n`(amountToken, amountETH, liquidity) = self.uniswap_contract.addLiquidityETH(self, contract_balance, 0, 0, self.owner, block.timestamp, value=self.balance)`\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/989933346/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
