{
  "url": "https://api.github.com/repos/vyperlang/vyper/issues/2145",
  "repository_url": "https://api.github.com/repos/vyperlang/vyper",
  "labels_url": "https://api.github.com/repos/vyperlang/vyper/issues/2145/labels{/name}",
  "comments_url": "https://api.github.com/repos/vyperlang/vyper/issues/2145/comments",
  "events_url": "https://api.github.com/repos/vyperlang/vyper/issues/2145/events",
  "html_url": "https://github.com/vyperlang/vyper/issues/2145",
  "id": 694402708,
  "node_id": "MDU6SXNzdWU2OTQ0MDI3MDg=",
  "number": 2145,
  "title": "Allow implicit conversion from calldata to memory",
  "user": {
    "login": "iamdefinitelyahuman",
    "id": 35276322,
    "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iamdefinitelyahuman",
    "html_url": "https://github.com/iamdefinitelyahuman",
    "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
    "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
    "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
    "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
    "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
    "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 9,
  "created_at": "2020-09-06T14:32:52Z",
  "updated_at": "2021-11-11T23:35:35Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Take the following example:\r\n\r\n```python\r\n@external\r\ndef foo(a: uint256):\r\n    a += 42\r\n```\r\n\r\nThis fails to compile with `ImmutableViolation: Cannot write to calldata`. The common pattern around this is:\r\n\r\n```python\r\n@external\r\ndef foo(a: uint256):\r\n    _a = a + 42\r\n```\r\n\r\nI think it would make for a more pleasant dev experience if the compiler implicitly converted calldata variables to memory upon modification.  It would make for more readable code and I can't imagine a scenario where it allows someone to shoot themselves in the foot.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/2145/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/vyperlang/vyper/issues/2145/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/687850646",
    "html_url": "https://github.com/vyperlang/vyper/issues/2145#issuecomment-687850646",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/2145",
    "id": 687850646,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4Nzg1MDY0Ng==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-06T17:35:16Z",
    "updated_at": "2020-09-06T17:35:16Z",
    "author_association": "MEMBER",
    "body": "We'll have to be careful with internal calls, as those can occasionally be pass-by-reference for larger arrays. We still don't have a good story on pass-by-value vs. pass-by-reference for internal calls.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/687850646/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/688529186",
    "html_url": "https://github.com/vyperlang/vyper/issues/2145#issuecomment-688529186",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/2145",
    "id": 688529186,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4ODUyOTE4Ng==",
    "user": {
      "login": "jacqueswww",
      "id": 6917456,
      "node_id": "MDQ6VXNlcjY5MTc0NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6917456?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jacqueswww",
      "html_url": "https://github.com/jacqueswww",
      "followers_url": "https://api.github.com/users/jacqueswww/followers",
      "following_url": "https://api.github.com/users/jacqueswww/following{/other_user}",
      "gists_url": "https://api.github.com/users/jacqueswww/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jacqueswww/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jacqueswww/subscriptions",
      "organizations_url": "https://api.github.com/users/jacqueswww/orgs",
      "repos_url": "https://api.github.com/users/jacqueswww/repos",
      "events_url": "https://api.github.com/users/jacqueswww/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jacqueswww/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-07T22:33:16Z",
    "updated_at": "2020-09-07T22:35:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "well common annotation with underscores would be\r\n```python\r\n@external\r\ndef foo(_a: uint256):\r\n    a = _a + 42\r\n```\r\nright? Maybe add a more elaborate example were you do an `+=` increment which would shows it's use case better (I couldn't think of one haha)?\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/688529186/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/688554212",
    "html_url": "https://github.com/vyperlang/vyper/issues/2145#issuecomment-688554212",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/2145",
    "id": 688554212,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4ODU1NDIxMg==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-08T00:32:43Z",
    "updated_at": "2020-09-08T00:32:43Z",
    "author_association": "MEMBER",
    "body": "@jacqueswww I think his example was just a bit oversimplified, the idea was explore allowing mutations on calldata by casting to a memory variable if mutation is detected.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/688554212/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/965684394",
    "html_url": "https://github.com/vyperlang/vyper/issues/2145#issuecomment-965684394",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/2145",
    "id": 965684394,
    "node_id": "IC_kwDOBGDvrM45jyyq",
    "user": {
      "login": "charles-cooper",
      "id": 3867501,
      "node_id": "MDQ6VXNlcjM4Njc1MDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3867501?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/charles-cooper",
      "html_url": "https://github.com/charles-cooper",
      "followers_url": "https://api.github.com/users/charles-cooper/followers",
      "following_url": "https://api.github.com/users/charles-cooper/following{/other_user}",
      "gists_url": "https://api.github.com/users/charles-cooper/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/charles-cooper/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/charles-cooper/subscriptions",
      "organizations_url": "https://api.github.com/users/charles-cooper/orgs",
      "repos_url": "https://api.github.com/users/charles-cooper/repos",
      "events_url": "https://api.github.com/users/charles-cooper/events{/privacy}",
      "received_events_url": "https://api.github.com/users/charles-cooper/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-10T19:45:11Z",
    "updated_at": "2021-11-10T19:45:11Z",
    "author_association": "COLLABORATOR",
    "body": "I guess the broader question is whether function arguments should be mutable, at all. Right now no function arguments are mutable -- whether they are in calldata or memory, or if the function is external or internal",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/965684394/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/966509325",
    "html_url": "https://github.com/vyperlang/vyper/issues/2145#issuecomment-966509325",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/2145",
    "id": 966509325,
    "node_id": "IC_kwDOBGDvrM45m8MN",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-11T18:02:28Z",
    "updated_at": "2021-11-11T18:02:28Z",
    "author_association": "MEMBER",
    "body": "mutable function args would be very handy. sometimes I do something like this:\r\n\r\n```python\r\ndef foo(amount: uint256 = MAX_UINT256):\r\n    ...\r\n    if amount == MAX_UINT256:\r\n        amount = self.token.balanceOf(msg.sender)\r\n    ...\r\n```\r\n\r\nbut of course this doesn't work, so I have to create some sort of weird intermediate memory variable that either pulls directly from the calldata arg, or switches to _something else_",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/966509325/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/966525655",
    "html_url": "https://github.com/vyperlang/vyper/issues/2145#issuecomment-966525655",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/2145",
    "id": 966525655,
    "node_id": "IC_kwDOBGDvrM45nALX",
    "user": {
      "login": "charles-cooper",
      "id": 3867501,
      "node_id": "MDQ6VXNlcjM4Njc1MDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3867501?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/charles-cooper",
      "html_url": "https://github.com/charles-cooper",
      "followers_url": "https://api.github.com/users/charles-cooper/followers",
      "following_url": "https://api.github.com/users/charles-cooper/following{/other_user}",
      "gists_url": "https://api.github.com/users/charles-cooper/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/charles-cooper/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/charles-cooper/subscriptions",
      "organizations_url": "https://api.github.com/users/charles-cooper/orgs",
      "repos_url": "https://api.github.com/users/charles-cooper/repos",
      "events_url": "https://api.github.com/users/charles-cooper/events{/privacy}",
      "received_events_url": "https://api.github.com/users/charles-cooper/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-11T18:23:47Z",
    "updated_at": "2021-11-11T18:23:47Z",
    "author_association": "COLLABORATOR",
    "body": "Maybe this issue should change to: `make function arguments mutable`",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/966525655/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/966535842",
    "html_url": "https://github.com/vyperlang/vyper/issues/2145#issuecomment-966535842",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/2145",
    "id": 966535842,
    "node_id": "IC_kwDOBGDvrM45nCqi",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-11T18:39:08Z",
    "updated_at": "2021-11-11T18:39:08Z",
    "author_association": "MEMBER",
    "body": "> Maybe this issue should change to: `make function arguments mutable`\r\n\r\nsure. the core issue though is that calldata is immutable, so you can't modify it without creating a shadowed variable in memory",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/966535842/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/966536565",
    "html_url": "https://github.com/vyperlang/vyper/issues/2145#issuecomment-966536565",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/2145",
    "id": 966536565,
    "node_id": "IC_kwDOBGDvrM45nC11",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-11T18:40:10Z",
    "updated_at": "2021-11-11T18:40:10Z",
    "author_association": "MEMBER",
    "body": "> > Maybe this issue should change to: `make function arguments mutable`\r\n> \r\n> sure. the core issue though is that calldata is immutable, so you can't modify it without creating a shadowed variable in memory\r\n\r\nthe way you would do that is look ahead to see if a mutation occurs, then create a new memory variable with the same name and ensure it starts out with the same value from calldata (implicitly)",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/966536565/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/966700920",
    "html_url": "https://github.com/vyperlang/vyper/issues/2145#issuecomment-966700920",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/2145",
    "id": 966700920,
    "node_id": "IC_kwDOBGDvrM45nq94",
    "user": {
      "login": "charles-cooper",
      "id": 3867501,
      "node_id": "MDQ6VXNlcjM4Njc1MDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3867501?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/charles-cooper",
      "html_url": "https://github.com/charles-cooper",
      "followers_url": "https://api.github.com/users/charles-cooper/followers",
      "following_url": "https://api.github.com/users/charles-cooper/following{/other_user}",
      "gists_url": "https://api.github.com/users/charles-cooper/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/charles-cooper/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/charles-cooper/subscriptions",
      "organizations_url": "https://api.github.com/users/charles-cooper/orgs",
      "repos_url": "https://api.github.com/users/charles-cooper/repos",
      "events_url": "https://api.github.com/users/charles-cooper/events{/privacy}",
      "received_events_url": "https://api.github.com/users/charles-cooper/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-11T23:35:35Z",
    "updated_at": "2021-11-11T23:35:35Z",
    "author_association": "COLLABORATOR",
    "body": "The restriction is broader than it needs to be. For instance in the example you gave, keyword arguments already get copied to memory. So there is no EVM reason why they should not be mutable. But yeah in the limited cases where the argument is in calldata we would need to check for assignment and copy to memory if there is.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/966700920/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
