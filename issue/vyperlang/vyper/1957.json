{
  "url": "https://api.github.com/repos/vyperlang/vyper/issues/1957",
  "repository_url": "https://api.github.com/repos/vyperlang/vyper",
  "labels_url": "https://api.github.com/repos/vyperlang/vyper/issues/1957/labels{/name}",
  "comments_url": "https://api.github.com/repos/vyperlang/vyper/issues/1957/comments",
  "events_url": "https://api.github.com/repos/vyperlang/vyper/issues/1957/events",
  "html_url": "https://github.com/vyperlang/vyper/issues/1957",
  "id": 614628607,
  "node_id": "MDU6SXNzdWU2MTQ2Mjg2MDc=",
  "number": 1957,
  "title": "Type conversion with decimals",
  "user": {
    "login": "cbraem",
    "id": 63294422,
    "node_id": "MDQ6VXNlcjYzMjk0NDIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/63294422?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cbraem",
    "html_url": "https://github.com/cbraem",
    "followers_url": "https://api.github.com/users/cbraem/followers",
    "following_url": "https://api.github.com/users/cbraem/following{/other_user}",
    "gists_url": "https://api.github.com/users/cbraem/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cbraem/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cbraem/subscriptions",
    "organizations_url": "https://api.github.com/users/cbraem/orgs",
    "repos_url": "https://api.github.com/users/cbraem/repos",
    "events_url": "https://api.github.com/users/cbraem/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cbraem/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 479554962,
      "node_id": "MDU6TGFiZWw0Nzk1NTQ5NjI=",
      "url": "https://api.github.com/repos/vyperlang/vyper/labels/bug",
      "name": "bug",
      "color": "ee0701",
      "default": true,
      "description": "Bug that shouldn't change language semantics when fixed."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2020-05-08T09:35:09Z",
  "updated_at": "2020-06-28T10:10:41Z",
  "closed_at": "2020-06-28T10:10:40Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### Version Information\r\n\r\n* vyper Version (output of `vyper --version`): 0.1.0b17+commit.0671b7b\r\n* OS: osx\r\n* Python Version (output of `python --version`): Python 3.6.10 :: Anaconda, Inc.\r\n* Environment (output of `pip freeze`):\r\n  * asttokens==2.0.3\r\n  * certifi==2020.4.5.1\r\n  * pycryptodome==3.9.7\r\n  * six==1.14.0\r\n  * vyper==0.1.0b17\r\n\r\n### What's your issue about?\r\n\r\nAccording to the documentation, no type conversion is made implicitly. Therefore, it is very natural that `l1: decimal = 0` gets rejected since the integer literal is not compatible with the decimal type.\r\n\r\nBut if an Assign is used instead of an AnnAssign or an AugAssign vyper does not complain. Additionally, the error message using an invalid AugAssign is less informative than the one of the invalid AnnAssign.\r\n\r\n```python\r\n# accepted code\r\n@public\r\ndef foo():\r\n    l1: decimal = 0.0\r\n    l1 = 42\r\n```\r\n\r\n```python\r\n# rejected code with the following error message\r\n# Error compiling: test.vy\r\n# vyper.exceptions.TypeMismatch: line 11:4 Invalid type int128, expected: decimal\r\n#      2 def foo():\r\n# ---> 3     l1: decimal = 0\r\n# ------------^\r\n#      4\r\n\r\n@public\r\ndef foo():\r\n    l1: decimal = 0\r\n```\r\n\r\n\r\n```python\r\n# rejected code with the following error message\r\n# Error compiling: test.vy\r\n# vyper.exceptions.TypeMismatch: <exception str() failed>\r\n\r\n@public\r\ndef foo():\r\n    l1: decimal = 0.0\r\n    l1 += 42\r\n```\r\n\r\n#### Expected Behavior\r\n\r\nAll three contracts should get rejected and a correct error message should be generated (like in the example with the invalid AnnAssign).\r\n",
  "closed_by": {
    "login": "iamdefinitelyahuman",
    "id": 35276322,
    "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
    "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/iamdefinitelyahuman",
    "html_url": "https://github.com/iamdefinitelyahuman",
    "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
    "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
    "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
    "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
    "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
    "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
    "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/1957/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/vyperlang/vyper/issues/1957/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/650729005",
    "html_url": "https://github.com/vyperlang/vyper/issues/1957#issuecomment-650729005",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1957",
    "id": 650729005,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MDcyOTAwNQ==",
    "user": {
      "login": "iamdefinitelyahuman",
      "id": 35276322,
      "node_id": "MDQ6VXNlcjM1Mjc2MzIy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35276322?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/iamdefinitelyahuman",
      "html_url": "https://github.com/iamdefinitelyahuman",
      "followers_url": "https://api.github.com/users/iamdefinitelyahuman/followers",
      "following_url": "https://api.github.com/users/iamdefinitelyahuman/following{/other_user}",
      "gists_url": "https://api.github.com/users/iamdefinitelyahuman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/iamdefinitelyahuman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/iamdefinitelyahuman/subscriptions",
      "organizations_url": "https://api.github.com/users/iamdefinitelyahuman/orgs",
      "repos_url": "https://api.github.com/users/iamdefinitelyahuman/repos",
      "events_url": "https://api.github.com/users/iamdefinitelyahuman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/iamdefinitelyahuman/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-28T10:10:40Z",
    "updated_at": "2020-06-28T10:10:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "Fixed in #2029\r\n\r\n```python\r\nvyper.exceptions.InvalidType: Expected decimal but literal can only be cast as int128 or uint256\r\n           function 'foo', line 5:9 \r\n                4     l1: decimal = 0.0\r\n           ---> 5     l1 = 42\r\n           ----------------^\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/650729005/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
