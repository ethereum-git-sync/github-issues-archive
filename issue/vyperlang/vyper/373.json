{
  "url": "https://api.github.com/repos/vyperlang/vyper/issues/373",
  "repository_url": "https://api.github.com/repos/vyperlang/vyper",
  "labels_url": "https://api.github.com/repos/vyperlang/vyper/issues/373/labels{/name}",
  "comments_url": "https://api.github.com/repos/vyperlang/vyper/issues/373/comments",
  "events_url": "https://api.github.com/repos/vyperlang/vyper/issues/373/events",
  "html_url": "https://github.com/vyperlang/vyper/issues/373",
  "id": 261959701,
  "node_id": "MDU6SXNzdWUyNjE5NTk3MDE=",
  "number": 373,
  "title": "Parser can't do multiple calls to same event with indexed params",
  "user": {
    "login": "pdaian",
    "id": 565776,
    "node_id": "MDQ6VXNlcjU2NTc3Ng==",
    "avatar_url": "https://avatars.githubusercontent.com/u/565776?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/pdaian",
    "html_url": "https://github.com/pdaian",
    "followers_url": "https://api.github.com/users/pdaian/followers",
    "following_url": "https://api.github.com/users/pdaian/following{/other_user}",
    "gists_url": "https://api.github.com/users/pdaian/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/pdaian/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/pdaian/subscriptions",
    "organizations_url": "https://api.github.com/users/pdaian/orgs",
    "repos_url": "https://api.github.com/users/pdaian/repos",
    "events_url": "https://api.github.com/users/pdaian/events{/privacy}",
    "received_events_url": "https://api.github.com/users/pdaian/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2017-10-02T00:39:29Z",
  "updated_at": "2017-10-08T18:02:57Z",
  "closed_at": "2017-10-08T18:02:57Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "* viper Version: master\r\n* pyethereum Version: 2.0.4\r\n* OS: linux\r\n* Python Version (python --version): 3.6\r\n\r\n### What's your issue about?\r\n\r\nMultiple calls to the same event with indexed parameters makes the parser throw up.\r\n\r\nThe following minimal contract triggers the issue:\r\n\r\n```\r\nF: __log__({_from: indexed(num)})\r\n\r\ndef a():\r\n    log.F(0)\r\n\r\ndef b():\r\n    log.F(0)\r\n```\r\n\r\n`viper test.vy` yields:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/viper\", line 4, in <module>\r\n    __import__('pkg_resources').run_script('viper==0.0.2', 'viper')\r\n  File \"/home/phil/.local/lib/python3.6/site-packages/pkg_resources/__init__.py\", line 738, in run_script\r\n    self.require(requires)[0].run_script(script_name, ns)\r\n  File \"/home/phil/.local/lib/python3.6/site-packages/pkg_resources/__init__.py\", line 1506, in run_script\r\n    exec(script_code, namespace, namespace)\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/EGG-INFO/scripts/viper\", line 23, in <module>\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/viper/compiler.py\", line 11, in compile\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/viper/parser.py\", line 346, in parse_tree_to_lll\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/viper/parser.py\", line 436, in parse_func\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/viper/parser.py\", line 436, in <listcomp>\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/viper/parser.py\", line 447, in parse_body\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/viper/parser.py\", line 957, in parse_stmt\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/viper/parser.py\", line 1013, in parse_stmt\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/viper/parser.py\", line 1148, in pack_logging_topics\r\nIndexError: pop from empty list\r\n```\r\n\r\nSimilarly for my ERC20 code in #366, which on compilation yields:\r\n```\r\n$ sha256sum ERC20.v.py \r\n9d27b91fd6bb16f6036cca237e6531d9df18082a7088ef6b60ecf40308b211aa  ERC20.v.py\r\n\r\n$ viper ERC20.v.py \r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/viper\", line 4, in <module>\r\n    __import__('pkg_resources').run_script('viper==0.0.2', 'viper')\r\n  File \"/home/phil/.local/lib/python3.6/site-packages/pkg_resources/__init__.py\", line 738, in run_script\r\n    self.require(requires)[0].run_script(script_name, ns)\r\n  File \"/home/phil/.local/lib/python3.6/site-packages/pkg_resources/__init__.py\", line 1506, in run_script\r\n    exec(script_code, namespace, namespace)\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/EGG-INFO/scripts/viper\", line 23, in <module>\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/viper/compiler.py\", line 11, in compile\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/viper/parser.py\", line 346, in parse_tree_to_lll\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/viper/parser.py\", line 436, in parse_func\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/viper/parser.py\", line 436, in <listcomp>\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/viper/parser.py\", line 447, in parse_body\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/viper/parser.py\", line 957, in parse_stmt\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/viper/parser.py\", line 1013, in parse_stmt\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/viper/parser.py\", line 1156, in pack_logging_topics\r\n  File \"/usr/local/lib/python3.6/dist-packages/viper-0.0.2-py3.6.egg/viper/parser_utils.py\", line 416, in base_type_conversion\r\nviper.exceptions.TypeMismatchException: Typecasting from base type address to num256 unavailable\r\n```\r\n\r\n\r\n### How can it be fixed?\r\n\r\nHaven't looked, filing this for reference.  Will debug myself if nobody has gotten to it in a week or so.\r\n\r\n#### Cute Animal Picture\r\n\r\n```\r\n             .=     ,        =.\r\n     _  _   /'/    )\\,/,/(_   \\ \\\r\n      `//-.|  (  ,\\\\)\\//\\)\\/_  ) |\r\n      //___\\   `\\\\\\/\\\\/\\/\\\\///'  /\r\n   ,-\"~`-._ `\"--'_   `\"\"\"`  _ \\`'\"~-,_\r\n   \\       `-.  '_`.      .'_` \\ ,-\"~`/\r\n    `.__.-'`/   (-\\        /-) |-.__,'\r\n      ||   |     \\O)  /^\\ (O/  |\r\n      `\\\\  |         /   `\\    /\r\n        \\\\  \\       /      `\\ /\r\n         `\\\\ `-.  /' .---.--.\\\r\n           `\\\\/`~(, '()      ('\r\n            /(O) \\\\   _,.-.,_)\r\n           //  \\\\ `\\'`      /\r\n     jgs  / |  ||   `\"\"\"\"~\"`\r\n        /'  |__||\r\n              `o \r\n```\r\n",
  "closed_by": {
    "login": "DavidKnott",
    "id": 17552858,
    "node_id": "MDQ6VXNlcjE3NTUyODU4",
    "avatar_url": "https://avatars.githubusercontent.com/u/17552858?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/DavidKnott",
    "html_url": "https://github.com/DavidKnott",
    "followers_url": "https://api.github.com/users/DavidKnott/followers",
    "following_url": "https://api.github.com/users/DavidKnott/following{/other_user}",
    "gists_url": "https://api.github.com/users/DavidKnott/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/DavidKnott/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/DavidKnott/subscriptions",
    "organizations_url": "https://api.github.com/users/DavidKnott/orgs",
    "repos_url": "https://api.github.com/users/DavidKnott/repos",
    "events_url": "https://api.github.com/users/DavidKnott/events{/privacy}",
    "received_events_url": "https://api.github.com/users/DavidKnott/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/373/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/vyperlang/vyper/issues/373/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/333418454",
    "html_url": "https://github.com/vyperlang/vyper/issues/373#issuecomment-333418454",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/373",
    "id": 333418454,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzMzQxODQ1NA==",
    "user": {
      "login": "DavidKnott",
      "id": 17552858,
      "node_id": "MDQ6VXNlcjE3NTUyODU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17552858?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DavidKnott",
      "html_url": "https://github.com/DavidKnott",
      "followers_url": "https://api.github.com/users/DavidKnott/followers",
      "following_url": "https://api.github.com/users/DavidKnott/following{/other_user}",
      "gists_url": "https://api.github.com/users/DavidKnott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DavidKnott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DavidKnott/subscriptions",
      "organizations_url": "https://api.github.com/users/DavidKnott/orgs",
      "repos_url": "https://api.github.com/users/DavidKnott/repos",
      "events_url": "https://api.github.com/users/DavidKnott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DavidKnott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-02T00:40:24Z",
    "updated_at": "2017-10-02T00:40:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "@pdaian I'll look into this right away",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/333418454/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/335026163",
    "html_url": "https://github.com/vyperlang/vyper/issues/373#issuecomment-335026163",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/373",
    "id": 335026163,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNTAyNjE2Mw==",
    "user": {
      "login": "DavidKnott",
      "id": 17552858,
      "node_id": "MDQ6VXNlcjE3NTUyODU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/17552858?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DavidKnott",
      "html_url": "https://github.com/DavidKnott",
      "followers_url": "https://api.github.com/users/DavidKnott/followers",
      "following_url": "https://api.github.com/users/DavidKnott/following{/other_user}",
      "gists_url": "https://api.github.com/users/DavidKnott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DavidKnott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DavidKnott/subscriptions",
      "organizations_url": "https://api.github.com/users/DavidKnott/orgs",
      "repos_url": "https://api.github.com/users/DavidKnott/repos",
      "events_url": "https://api.github.com/users/DavidKnott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DavidKnott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-08T18:02:57Z",
    "updated_at": "2017-10-08T18:02:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "@pdaian Closing this due to PR #377.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/335026163/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
