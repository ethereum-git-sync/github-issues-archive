{
  "url": "https://api.github.com/repos/vyperlang/vyper/issues/1807",
  "repository_url": "https://api.github.com/repos/vyperlang/vyper",
  "labels_url": "https://api.github.com/repos/vyperlang/vyper/issues/1807/labels{/name}",
  "comments_url": "https://api.github.com/repos/vyperlang/vyper/issues/1807/comments",
  "events_url": "https://api.github.com/repos/vyperlang/vyper/issues/1807/events",
  "html_url": "https://github.com/vyperlang/vyper/issues/1807",
  "id": 545845749,
  "node_id": "MDU6SXNzdWU1NDU4NDU3NDk=",
  "number": 1807,
  "title": "VIP: allow generic decimal types",
  "user": {
    "login": "charles-cooper",
    "id": 3867501,
    "node_id": "MDQ6VXNlcjM4Njc1MDE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/3867501?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/charles-cooper",
    "html_url": "https://github.com/charles-cooper",
    "followers_url": "https://api.github.com/users/charles-cooper/followers",
    "following_url": "https://api.github.com/users/charles-cooper/following{/other_user}",
    "gists_url": "https://api.github.com/users/charles-cooper/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/charles-cooper/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/charles-cooper/subscriptions",
    "organizations_url": "https://api.github.com/users/charles-cooper/orgs",
    "repos_url": "https://api.github.com/users/charles-cooper/repos",
    "events_url": "https://api.github.com/users/charles-cooper/events{/privacy}",
    "received_events_url": "https://api.github.com/users/charles-cooper/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 751622094,
      "node_id": "MDU6TGFiZWw3NTE2MjIwOTQ=",
      "url": "https://api.github.com/repos/vyperlang/vyper/labels/VIP:%20Discussion",
      "name": "VIP: Discussion",
      "color": "000000",
      "default": false,
      "description": "Used to denote VIPs and more complex issues that are waiting discussion in a meeting"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2020-01-06T17:30:10Z",
  "updated_at": "2022-08-08T16:18:54Z",
  "closed_at": null,
  "author_association": "COLLABORATOR",
  "active_lock_reason": null,
  "body": "## Simple Summary\r\nAllow generic decimal types with parametrizable precision and bits settings.\r\n\r\n## Motivation\r\nFixed point math is generally useful for smart contracts as one of the most common use cases for smart contracts is to do accurate accounting. This is manifest in the fact that numerous ERCs and applications depend on fixed point math (ex. ERC20, various AMMs, ERC4626). This VIP proposes general decimal types which are\r\n- easy to declare in the usual case (\"I want decimals 18 x 256\")\r\n- tunable if the user wants to use a specific number of bits (\"I want decimals 10 x 112\")\r\n- compatible with ERC20 and other token standards (exposed ABI types are standard integer types)\r\n\r\n## Specification\r\nIntroduce new PEP484 style `Decimals` and `UDecimals` types which each accept two parameters (the latter of which is optional).\r\n\r\nExamples:\r\n- `UDecimals[18]` (i.e. unsigned decimals type with 18 decimals of precision and occupying 256 bits of space)\r\n- `UDecimals[18, 128]` (i.e. unsigned decimals with 18 decimals of precision and occupying 128 bits of space)\r\n- `Decimals[10, 168]` (equivalent to current decimals)\r\n\r\nThe existing `decimals` type will be considered a deprecated alias of `Decimals[10, 168]`.\r\n\r\nIn general, the ABI type of `Decimals[N, B]` will be `int_<B>`. The ABI type of `UDecimals[N, B]` will be `uint_<B>`.\r\n\r\n- TBD: safemath rules. Consider the rules with and without the availability of a MULDIV (EIP-5000) instruction.\r\n\r\n## Backwards Compatibility\r\n- Deprecates `decimal` type\r\n- Changes the ABI type of `decimal`.\r\n\r\n## Dependencies\r\nRequires some refactoring of the internal type system (probably will be done as work for #2431).\r\n\r\n## References\r\nhttps://github.com/vyperlang/vyper/issues/3039 Could be useful for use-site tuning of ERC20 or other token libraries.\r\n\r\n## Copyright\r\nCopyright and related rights waived via [CC0](https://creativecommons.org/publicdomain/zero/1.0/)\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/1807/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/vyperlang/vyper/issues/1807/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/571243731",
    "html_url": "https://github.com/vyperlang/vyper/issues/1807#issuecomment-571243731",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1807",
    "id": 571243731,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTI0MzczMQ==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-06T18:03:22Z",
    "updated_at": "2020-01-06T18:03:22Z",
    "author_association": "MEMBER",
    "body": "I don't think that you should have to specify the amount of bits the type takes up. We can calculate that.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/571243731/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/571244448",
    "html_url": "https://github.com/vyperlang/vyper/issues/1807#issuecomment-571244448",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1807",
    "id": 571244448,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTI0NDQ0OA==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-06T18:05:24Z",
    "updated_at": "2020-01-06T18:05:24Z",
    "author_association": "MEMBER",
    "body": "It would be really nice if we have the ability to create custom types (or type aliases) such that we could allow typing to be used by end users more directly, e.g. `ray := decimal(places=27)` for Maker codebase.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/571244448/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/571246359",
    "html_url": "https://github.com/vyperlang/vyper/issues/1807#issuecomment-571246359",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1807",
    "id": 571246359,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTI0NjM1OQ==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-06T18:10:11Z",
    "updated_at": "2020-01-06T18:10:11Z",
    "author_association": "MEMBER",
    "body": "Note: 38 decimal places is the most possible that can fit in 128 bits (corresponding to `fixed255x38`)",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/571246359/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/571247139",
    "html_url": "https://github.com/vyperlang/vyper/issues/1807#issuecomment-571247139",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1807",
    "id": 571247139,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MTI0NzEzOQ==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-06T18:11:56Z",
    "updated_at": "2020-01-06T18:21:14Z",
    "author_association": "MEMBER",
    "body": "List of decimals:\r\n1. `fixed132x1`\r\n1. `fixed135x2`\r\n1. `fixed138x3`\r\n1. `fixed142x4`\r\n1. `fixed145x5`\r\n1. `fixed148x6`\r\n1. `fixed152x7`\r\n1. `fixed155x8`\r\n1. `fixed158x9`\r\n1. `fixed162x10`\r\n1. `fixed165x11`\r\n1. `fixed168x12`\r\n1. `fixed172x13`\r\n1. `fixed175x14`\r\n1. `fixed178x15`\r\n1. `fixed182x16`\r\n1. `fixed185x17`\r\n1. `fixed188x18`\r\n1. `fixed192x19`\r\n1. `fixed195x20`\r\n1. `fixed198x21`\r\n1. `fixed202x22`\r\n1. `fixed205x23`\r\n1. `fixed208x24`\r\n1. `fixed212x25`\r\n1. `fixed215x26`\r\n1. `fixed218x27`\r\n1. `fixed222x28`\r\n1. `fixed225x29`\r\n1. `fixed228x30`\r\n1. `fixed231x31` (NOTE: doesn't fit pattern)\r\n1. `fixed235x32`\r\n1. `fixed238x33`\r\n1. `fixed241x34` (NOTE: doesn't fit pattern)\r\n1. `fixed245x35`\r\n1. `fixed248x36`\r\n1. `fixed251x37` (NOTE: doesn't fit pattern)\r\n1. `fixed255x38`",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/571247139/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/581478416",
    "html_url": "https://github.com/vyperlang/vyper/issues/1807#issuecomment-581478416",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1807",
    "id": 581478416,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MTQ3ODQxNg==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-03T15:48:24Z",
    "updated_at": "2020-02-03T15:48:24Z",
    "author_association": "MEMBER",
    "body": "Meeting notes: Pamp it",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/581478416/reactions",
      "total_count": 4,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 2,
      "confused": 0,
      "heart": 0,
      "rocket": 2,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/712617541",
    "html_url": "https://github.com/vyperlang/vyper/issues/1807#issuecomment-712617541",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1807",
    "id": 712617541,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxMjYxNzU0MQ==",
    "user": {
      "login": "fubuloubu",
      "id": 3859395,
      "node_id": "MDQ6VXNlcjM4NTkzOTU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3859395?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fubuloubu",
      "html_url": "https://github.com/fubuloubu",
      "followers_url": "https://api.github.com/users/fubuloubu/followers",
      "following_url": "https://api.github.com/users/fubuloubu/following{/other_user}",
      "gists_url": "https://api.github.com/users/fubuloubu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fubuloubu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fubuloubu/subscriptions",
      "organizations_url": "https://api.github.com/users/fubuloubu/orgs",
      "repos_url": "https://api.github.com/users/fubuloubu/repos",
      "events_url": "https://api.github.com/users/fubuloubu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fubuloubu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-20T06:10:08Z",
    "updated_at": "2020-10-20T06:10:08Z",
    "author_association": "MEMBER",
    "body": "Was thinking about this some more today. It could be something like the following:\r\n1. Internally, Vyper users only see the `Decimal` type, which is a fixed point type that is allowed to be any width decimal (using `fixed<M>x<N>` notation) as long as the calculations align at \"endpoints\" (internal type conversions or ABI boundaries)\r\n2. For interface definitions, `Decimal` takes an argument (e.g. `Decimal(fixed168x10)`) which defines the \"required\" shape of the `Decimal` type at that interface and pins that boundary to that particular ABI type\r\n3. When producing ABIs, Vyper statically determines the ABI type of `Decimal` and uses `fixed<M>x<N>` notation to denote that interface type. This can be overriden using the same trick for interface definitions e.g. `def myCall(val: Decimal(fixed168x10))` to pin to a particular type (useful for ERCs)\r\n4. All else is \"undefined behavior\", allowing the compiler to optimize towards the highest precision and lowest loss calculations based on all the mathematical interactions that are possible within an entire contract, given the constraints at the boundary points. This optimization should be statically determinable, so that it will always produce the same outcome given the same program (although different programs and constraint system can produce different results)\r\n\r\nThis design would be strictly better than doing uint256 math all over, with implicit assumptions about precision loss, and occasionally watching contract call failures from using SafeMath without due consideration to these scenarios. The compiler can also produce suggestions for the min/max size particular values can be at conversion boundary points in order to ensure correct operation of the algorithm.",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/712617541/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/1208332891",
    "html_url": "https://github.com/vyperlang/vyper/issues/1807#issuecomment-1208332891",
    "issue_url": "https://api.github.com/repos/vyperlang/vyper/issues/1807",
    "id": 1208332891,
    "node_id": "IC_kwDOBGDvrM5IBbJb",
    "user": {
      "login": "charles-cooper",
      "id": 3867501,
      "node_id": "MDQ6VXNlcjM4Njc1MDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3867501?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/charles-cooper",
      "html_url": "https://github.com/charles-cooper",
      "followers_url": "https://api.github.com/users/charles-cooper/followers",
      "following_url": "https://api.github.com/users/charles-cooper/following{/other_user}",
      "gists_url": "https://api.github.com/users/charles-cooper/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/charles-cooper/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/charles-cooper/subscriptions",
      "organizations_url": "https://api.github.com/users/charles-cooper/orgs",
      "repos_url": "https://api.github.com/users/charles-cooper/repos",
      "events_url": "https://api.github.com/users/charles-cooper/events{/privacy}",
      "received_events_url": "https://api.github.com/users/charles-cooper/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-08T16:18:54Z",
    "updated_at": "2022-08-08T16:18:54Z",
    "author_association": "COLLABORATOR",
    "body": "meeting notes: add an example, bring up for discussion again",
    "reactions": {
      "url": "https://api.github.com/repos/vyperlang/vyper/issues/comments/1208332891/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
