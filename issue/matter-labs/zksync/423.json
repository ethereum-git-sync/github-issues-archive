{
  "url": "https://api.github.com/repos/matter-labs/zksync/issues/423",
  "repository_url": "https://api.github.com/repos/matter-labs/zksync",
  "labels_url": "https://api.github.com/repos/matter-labs/zksync/issues/423/labels{/name}",
  "comments_url": "https://api.github.com/repos/matter-labs/zksync/issues/423/comments",
  "events_url": "https://api.github.com/repos/matter-labs/zksync/issues/423/events",
  "html_url": "https://github.com/matter-labs/zksync/issues/423",
  "id": 1598376498,
  "node_id": "I_kwDOC0aUls5fRUoy",
  "number": 423,
  "title": "zk init: genesis setup failed",
  "user": {
    "login": "yyjia",
    "id": 21003542,
    "node_id": "MDQ6VXNlcjIxMDAzNTQy",
    "avatar_url": "https://avatars.githubusercontent.com/u/21003542?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/yyjia",
    "html_url": "https://github.com/yyjia",
    "followers_url": "https://api.github.com/users/yyjia/followers",
    "following_url": "https://api.github.com/users/yyjia/following{/other_user}",
    "gists_url": "https://api.github.com/users/yyjia/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/yyjia/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/yyjia/subscriptions",
    "organizations_url": "https://api.github.com/users/yyjia/orgs",
    "repos_url": "https://api.github.com/users/yyjia/repos",
    "events_url": "https://api.github.com/users/yyjia/events{/privacy}",
    "received_events_url": "https://api.github.com/users/yyjia/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-02-24T10:45:26Z",
  "updated_at": "2023-04-04T15:08:01Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "runing zk init in macos 13.2.1 \r\n\r\n> build/index.js → dist/main.js...\r\ncreated dist/main.js in 2.8s\r\n✨  Done in 8.74s.\r\nyarn run v1.22.19\r\n$ yarn reading-tool build\r\n$ yarn workspace reading-tool build\r\n$ tsc\r\n✨  Done in 3.45s.\r\n✔ Compiling JS packages done (26372ms)\r\n\r\n----------------------\r\n> Checking PLONK setup\r\n✔ Checking PLONK setup done (0ms)\r\n\r\n------------------------------\r\n> Unpacking verification  keys\r\nKeys unpacked\r\n✔ Unpacking verification  keys done (14ms)\r\nUsing localhost database:\r\nDATABASE_URL = postgres://postgres@localhost/plasma\r\n\r\n---------------------\r\n> Setting up database\r\n   Compiling zksync_storage v1.0.0 (/Users/mac/devel/github.com/matter-labs/zksync/core/lib/storage)\r\n    Finished dev [unoptimized + debuginfo] target(s) in 17.74s\r\n✔ Setting up database done (30094ms)\r\n\r\n--------------------\r\n> Building contracts\r\nyarn run v1.22.19\r\n$ yarn workspace franklin-contracts build\r\n$ hardhat compile\r\nNothing to compile\r\nCreating Typechain artifacts in directory typechain for target ethers-v5\r\nSuccessfully generated Typechain artifacts!\r\n✨  Done in 8.87s.\r\n✔ Building contracts done (9088ms)\r\n\r\n----------------------------------\r\n> Deploying localhost ERC20 tokens\r\nRestarting zksync_dev-liquidity-token-watcher_1 ... done\r\nRestarting zksync_dev-ticker_1 ... done\r\n✔ Deploying localhost ERC20 tokens done (12262ms)\r\n\r\n--------------------------------------\r\n> Deploying localhost EIP1271 contract\r\nyarn run v1.22.19\r\n$ yarn workspace franklin-contracts deploy-eip1271\r\n$ ts-node scripts/deploy-eip1271.ts\r\n✨  Done in 7.63s.\r\n✔ Deploying localhost EIP1271 contract done (7838ms)\r\n\r\n----------------------------------------\r\n> Deploying withdrawal helpers contracts\r\nyarn run v1.22.19\r\n$ yarn workspace franklin-contracts deploy-withdrawal-helpers-contracts\r\n$ ts-node scripts/deploy-withdrawal-helpers.ts\r\n✨  Done in 7.33s.\r\n✔ Deploying withdrawal helpers contracts done (7515ms)\r\n\r\n------------------------------\r\n> Running server genesis setup\r\nDropping DB...\r\nUsing localhost database:\r\nDATABASE_URL = postgres://postgres@localhost/plasma\r\nError: Command failed: diesel database setup\r\nFailed to run migrations: Cannot perform this operation outside of a transaction",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/matter-labs/zksync/issues/423/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/matter-labs/zksync/issues/423/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/matter-labs/zksync/issues/comments/1447444036",
    "html_url": "https://github.com/matter-labs/zksync/issues/423#issuecomment-1447444036",
    "issue_url": "https://api.github.com/repos/matter-labs/zksync/issues/423",
    "id": 1447444036,
    "node_id": "IC_kwDOC0aUls5WRj5E",
    "user": {
      "login": "Niet-Pham",
      "id": 55547523,
      "node_id": "MDQ6VXNlcjU1NTQ3NTIz",
      "avatar_url": "https://avatars.githubusercontent.com/u/55547523?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Niet-Pham",
      "html_url": "https://github.com/Niet-Pham",
      "followers_url": "https://api.github.com/users/Niet-Pham/followers",
      "following_url": "https://api.github.com/users/Niet-Pham/following{/other_user}",
      "gists_url": "https://api.github.com/users/Niet-Pham/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Niet-Pham/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Niet-Pham/subscriptions",
      "organizations_url": "https://api.github.com/users/Niet-Pham/orgs",
      "repos_url": "https://api.github.com/users/Niet-Pham/repos",
      "events_url": "https://api.github.com/users/Niet-Pham/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Niet-Pham/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-28T01:52:34Z",
    "updated_at": "2023-02-28T01:52:34Z",
    "author_association": "NONE",
    "body": "I got the same issue when `Running server genesis setup` but the terminal showed another error:\r\n```\r\n> Running server genesis setup\r\nDropping DB...\r\nPassword for user postgres:\r\nPassword for user postgres:\r\nPassword for user postgres:\r\nUsing localhost database:\r\nDATABASE_URL = postgres://postgres@localhost/plasma\r\n   Compiling zksync_storage v1.0.0 (/home/niet/zk/zksync/core/lib/storage)\r\n    Finished dev [unoptimized + debuginfo] target(s) in 30.70s\r\nPassword for user postgres:\r\nError: Command failed: psql \"postgres://postgres@localhost/plasma\" -c \"INSERT INTO server_config (contract_addr, gov_contract_addr, nft_factory_addr)                                    VALUES ('0x70a0F165d6f8054d0d0CF8dFd4DD2005f0AF6B55', '0x5E6D086F5eC079ADFF4FB3774CDf3e8D6a34F7E9', '')                                         ON CONFLICT (id) DO UPDATE     SET (contract_addr, gov_contract_addr, nft_factory_addr)                          = ('0x70a0F165d6f8054d0d0CF8dFd4DD2005f0AF6B55', '0x5E6D086F5eC079ADFF4FB3774CDf3e8D6a34F7E9', '')\"\r\nERROR:  relation \"server_config\" does not exist\r\nLINE 1: INSERT INTO server_config (contract_addr, gov_contract_addr,...\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/matter-labs/zksync/issues/comments/1447444036/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/matter-labs/zksync/issues/comments/1479040017",
    "html_url": "https://github.com/matter-labs/zksync/issues/423#issuecomment-1479040017",
    "issue_url": "https://api.github.com/repos/matter-labs/zksync/issues/423",
    "id": 1479040017,
    "node_id": "IC_kwDOC0aUls5YKFwR",
    "user": {
      "login": "dylenfu",
      "id": 7406989,
      "node_id": "MDQ6VXNlcjc0MDY5ODk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7406989?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dylenfu",
      "html_url": "https://github.com/dylenfu",
      "followers_url": "https://api.github.com/users/dylenfu/followers",
      "following_url": "https://api.github.com/users/dylenfu/following{/other_user}",
      "gists_url": "https://api.github.com/users/dylenfu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dylenfu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dylenfu/subscriptions",
      "organizations_url": "https://api.github.com/users/dylenfu/orgs",
      "repos_url": "https://api.github.com/users/dylenfu/repos",
      "events_url": "https://api.github.com/users/dylenfu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dylenfu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-22T07:34:25Z",
    "updated_at": "2023-03-22T07:45:54Z",
    "author_association": "NONE",
    "body": "i got the same problem, and the error message as follow:\r\n```\r\n> Running server genesis setup\r\nDropping DB...\r\nUsing localhost database:\r\nDATABASE_URL = postgres://postgres@localhost/plasma\r\nError: Command failed: diesel database setup\r\nFailed to run migrations: Cannot perform this operation outside of a transaction\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/matter-labs/zksync/issues/comments/1479040017/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/matter-labs/zksync/issues/comments/1493523014",
    "html_url": "https://github.com/matter-labs/zksync/issues/423#issuecomment-1493523014",
    "issue_url": "https://api.github.com/repos/matter-labs/zksync/issues/423",
    "id": 1493523014,
    "node_id": "IC_kwDOC0aUls5ZBVpG",
    "user": {
      "login": "xin19961512",
      "id": 39741667,
      "node_id": "MDQ6VXNlcjM5NzQxNjY3",
      "avatar_url": "https://avatars.githubusercontent.com/u/39741667?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xin19961512",
      "html_url": "https://github.com/xin19961512",
      "followers_url": "https://api.github.com/users/xin19961512/followers",
      "following_url": "https://api.github.com/users/xin19961512/following{/other_user}",
      "gists_url": "https://api.github.com/users/xin19961512/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xin19961512/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xin19961512/subscriptions",
      "organizations_url": "https://api.github.com/users/xin19961512/orgs",
      "repos_url": "https://api.github.com/users/xin19961512/repos",
      "events_url": "https://api.github.com/users/xin19961512/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xin19961512/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-03T01:49:06Z",
    "updated_at": "2023-04-03T01:49:06Z",
    "author_association": "NONE",
    "body": "> i got same, and at the first, i get the :\r\n### Error: Command failed: diesel database setup.\r\nso, i use the command: \"createdb plasma\"create the db manually,the i get the same error like yous:\r\n### Error: Command failed: psql \"postgres://postgres@localhost/plasma\" -c \"INSERT INTO server_config (contract_addr, gov_contract_addr, nft_factory_addr)                                    VALUES ('0x70a0F165d6f8054d0d0CF8dFd4DD2005f0AF6B55', '0x5E6D086F5eC079ADFF4FB3774CDf3e8D6a34F7E9', '')                                         ON CONFLICT (id) DO UPDATE     SET (contract_addr, gov_contract_addr, nft_factory_addr)                          = ('0x70a0F165d6f8054d0d0CF8dFd4DD2005f0AF6B55', '0x5E6D086F5eC079ADFF4FB3774CDf3e8D6a34F7E9', '')\"\r\nERROR:  relation \"server_config\" does not exist\r\n\r\ndoes anyone deal with it ? maybe my diesel version is wrong?but i have try v1.14.0 and it do not works also.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/matter-labs/zksync/issues/comments/1493523014/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/matter-labs/zksync/issues/comments/1496141505",
    "html_url": "https://github.com/matter-labs/zksync/issues/423#issuecomment-1496141505",
    "issue_url": "https://api.github.com/repos/matter-labs/zksync/issues/423",
    "id": 1496141505,
    "node_id": "IC_kwDOC0aUls5ZLU7B",
    "user": {
      "login": "xin19961512",
      "id": 39741667,
      "node_id": "MDQ6VXNlcjM5NzQxNjY3",
      "avatar_url": "https://avatars.githubusercontent.com/u/39741667?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xin19961512",
      "html_url": "https://github.com/xin19961512",
      "followers_url": "https://api.github.com/users/xin19961512/followers",
      "following_url": "https://api.github.com/users/xin19961512/following{/other_user}",
      "gists_url": "https://api.github.com/users/xin19961512/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xin19961512/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xin19961512/subscriptions",
      "organizations_url": "https://api.github.com/users/xin19961512/orgs",
      "repos_url": "https://api.github.com/users/xin19961512/repos",
      "events_url": "https://api.github.com/users/xin19961512/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xin19961512/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-04T15:08:00Z",
    "updated_at": "2023-04-04T15:08:00Z",
    "author_association": "NONE",
    "body": "...It's diesel's bug.i chose use low version of it and it'sOk:\r\ncargo install diesel_cli --version=1.4.0\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/matter-labs/zksync/issues/comments/1496141505/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
