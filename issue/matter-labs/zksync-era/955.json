{
  "url": "https://api.github.com/repos/matter-labs/zksync-era/issues/955",
  "repository_url": "https://api.github.com/repos/matter-labs/zksync-era",
  "labels_url": "https://api.github.com/repos/matter-labs/zksync-era/issues/955/labels{/name}",
  "comments_url": "https://api.github.com/repos/matter-labs/zksync-era/issues/955/comments",
  "events_url": "https://api.github.com/repos/matter-labs/zksync-era/issues/955/events",
  "html_url": "https://github.com/matter-labs/zksync-era/issues/955",
  "id": 2103493145,
  "node_id": "I_kwDOI-FneM59YMIZ",
  "number": 955,
  "title": "bug: meet bug when build docker images",
  "user": {
    "login": "ChengYueJia",
    "id": 108982045,
    "node_id": "U_kgDOBn7vHQ",
    "avatar_url": "https://avatars.githubusercontent.com/u/108982045?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ChengYueJia",
    "html_url": "https://github.com/ChengYueJia",
    "followers_url": "https://api.github.com/users/ChengYueJia/followers",
    "following_url": "https://api.github.com/users/ChengYueJia/following{/other_user}",
    "gists_url": "https://api.github.com/users/ChengYueJia/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ChengYueJia/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ChengYueJia/subscriptions",
    "organizations_url": "https://api.github.com/users/ChengYueJia/orgs",
    "repos_url": "https://api.github.com/users/ChengYueJia/repos",
    "events_url": "https://api.github.com/users/ChengYueJia/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ChengYueJia/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 5157016638,
      "node_id": "LA_kwDOI-FneM8AAAABM2HUPg",
      "url": "https://api.github.com/repos/matter-labs/zksync-era/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2024-01-27T10:18:43Z",
  "updated_at": "2024-01-27T13:20:46Z",
  "closed_at": "2024-01-27T13:20:46Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "### 🐛 Bug Report\r\n\r\n#### 📝 Description\r\nMeet error when try to build docker image.\r\n\r\n#### 🔄 Reproduction Steps\r\nTwo ways to reproduction it: \r\n> PWD: project_root_dir\r\n1. `docker build -f ./docker/server-v2/Dockerfile .` \r\n2. `zk stack docker-setup` \r\n      will meet error when execute first image, the command as below: \r\n     * `DOCKER_BUILDKIT=1 docker buildx build -t us-docker.pkg.dev/matterlabs-infra/matterlabs-docker/server-v2:docker-linux-amd64 -t matterlabs/server-v2:doker-linux-amd64  --platform=linux/amd64  -f ./docker/server-v2/Dockerfile .`\r\n\r\n#### 🤔 Expected Behavior\r\nSuccessfully build images using both ways mentioned above.\r\n\r\n#### 😯 Current Behavior\r\nwill meet error \r\n#### 🖥️ Environment\r\n22.04.1-Ubuntu  x86_64\r\n\r\n#### 📋 Additional Context\r\n\r\nAdd any other context about the problem here. If applicable, add screenshots to help explain.\r\n\r\n#### 📎 Log Output\r\n```bash\r\n$ docker build -f ./docker/server-v2/Dockerfile .\r\n[+] Building 1.9s (7/23)                                                                                                                                docker:default\r\n => [internal] load .dockerignore                                                                                                                                 0.0s\r\n => => transferring context: 1.00kB                                                                                                                               0.0s\r\n => [internal] load build definition from Dockerfile                                                                                                              0.0s\r\n => => transferring dockerfile: 1.90kB                                                                                                                            0.0s\r\n => [internal] load metadata for docker.io/library/debian:bookworm-slim                                                                                           1.1s\r\n => CACHED [stage-1  1/14] FROM docker.io/library/debian:bookworm-slim@sha256:f4a83aa865a2b4a064ff142aa91c713180df9fcb86ce676b5de2981029379c37                    0.0s\r\n => CANCELED [internal] load build context                                                                                                                        0.6s\r\n => => transferring context: 90.29MB                                                                                                                              0.6s\r\n => CACHED [builder 2/6] WORKDIR /usr/src/zksync                                                                                                                  0.0s\r\n => ERROR [stage-1  2/14] RUN apt-get update && apt-get install -y curl libpq5 liburing-dev ca-certificates &&     rm -rf /var/lib/apt/lists/*                    0.6s\r\n------                                                                                                                                                                 \r\n > [stage-1  2/14] RUN apt-get update && apt-get install -y curl libpq5 liburing-dev ca-certificates &&     rm -rf /var/lib/apt/lists/*:                               \r\n0.285 Get:1 http://deb.debian.org/debian bookworm InRelease [151 kB]                                                                                                   \r\n0.297 Get:2 http://deb.debian.org/debian bookworm-updates InRelease [52.1 kB]                                                                                          \r\n0.298 Err:1 http://deb.debian.org/debian bookworm InRelease                                                                                                            \r\n0.298   Couldn't create temporary file /tmp/apt.conf.4gAomO for passing config to apt-key\r\n0.299 Err:2 http://deb.debian.org/debian bookworm-updates InRelease\r\n0.299   Couldn't create temporary file /tmp/apt.conf.QU9BTw for passing config to apt-key\r\n0.319 Get:3 http://deb.debian.org/debian-security bookworm-security InRelease [48.0 kB]\r\n0.321 Err:3 http://deb.debian.org/debian-security bookworm-security InRelease\r\n0.321   Couldn't create temporary file /tmp/apt.conf.XmagSH for passing config to apt-key\r\n0.324 Reading package lists...\r\n0.330 W: GPG error: http://deb.debian.org/debian bookworm InRelease: Couldn't create temporary file /tmp/apt.conf.4gAomO for passing config to apt-key\r\n0.330 E: The repository 'http://deb.debian.org/debian bookworm InRelease' is not signed.\r\n0.330 W: GPG error: http://deb.debian.org/debian bookworm-updates InRelease: Couldn't create temporary file /tmp/apt.conf.QU9BTw for passing config to apt-key\r\n0.330 E: The repository 'http://deb.debian.org/debian bookworm-updates InRelease' is not signed.\r\n0.330 W: GPG error: http://deb.debian.org/debian-security bookworm-security InRelease: Couldn't create temporary file /tmp/apt.conf.XmagSH for passing config to apt-key\r\n0.330 E: The repository 'http://deb.debian.org/debian-security bookworm-security InRelease' is not signed.\r\n------\r\nDockerfile:24\r\n--------------------\r\n  23 |     \r\n  24 | >>> RUN apt-get update && apt-get install -y curl libpq5 liburing-dev ca-certificates && \\\r\n  25 | >>>     rm -rf /var/lib/apt/lists/*\r\n  26 |     \r\n--------------------\r\nERROR: failed to solve: process \"/bin/sh -c apt-get update && apt-get install -y curl libpq5 liburing-dev ca-certificates &&     rm -rf /var/lib/apt/lists/*\" did not complete successfully: exit code: 100\r\n\r\n```\r\n",
  "closed_by": {
    "login": "ChengYueJia",
    "id": 108982045,
    "node_id": "U_kgDOBn7vHQ",
    "avatar_url": "https://avatars.githubusercontent.com/u/108982045?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ChengYueJia",
    "html_url": "https://github.com/ChengYueJia",
    "followers_url": "https://api.github.com/users/ChengYueJia/followers",
    "following_url": "https://api.github.com/users/ChengYueJia/following{/other_user}",
    "gists_url": "https://api.github.com/users/ChengYueJia/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ChengYueJia/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ChengYueJia/subscriptions",
    "organizations_url": "https://api.github.com/users/ChengYueJia/orgs",
    "repos_url": "https://api.github.com/users/ChengYueJia/repos",
    "events_url": "https://api.github.com/users/ChengYueJia/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ChengYueJia/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/matter-labs/zksync-era/issues/955/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/matter-labs/zksync-era/issues/955/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/matter-labs/zksync-era/issues/comments/1913155061",
    "html_url": "https://github.com/matter-labs/zksync-era/issues/955#issuecomment-1913155061",
    "issue_url": "https://api.github.com/repos/matter-labs/zksync-era/issues/955",
    "id": 1913155061,
    "node_id": "IC_kwDOI-FneM5yCG31",
    "user": {
      "login": "ChengYueJia",
      "id": 108982045,
      "node_id": "U_kgDOBn7vHQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/108982045?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ChengYueJia",
      "html_url": "https://github.com/ChengYueJia",
      "followers_url": "https://api.github.com/users/ChengYueJia/followers",
      "following_url": "https://api.github.com/users/ChengYueJia/following{/other_user}",
      "gists_url": "https://api.github.com/users/ChengYueJia/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ChengYueJia/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ChengYueJia/subscriptions",
      "organizations_url": "https://api.github.com/users/ChengYueJia/orgs",
      "repos_url": "https://api.github.com/users/ChengYueJia/repos",
      "events_url": "https://api.github.com/users/ChengYueJia/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ChengYueJia/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2024-01-27T13:20:46Z",
    "updated_at": "2024-01-27T13:20:46Z",
    "author_association": "NONE",
    "body": "* Reference: \r\nhttps://stackoverflow.com/questions/53950082/docker-images-lacking-tmp",
    "reactions": {
      "url": "https://api.github.com/repos/matter-labs/zksync-era/issues/comments/1913155061/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
