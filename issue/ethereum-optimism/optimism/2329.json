{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2329",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2329/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2329/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2329/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/2329",
  "id": 1169896980,
  "node_id": "I_kwDODjvEJM5FuzYU",
  "number": 2329,
  "title": "Have L2Geth sync in parallel with the DTL",
  "user": {
    "login": "smartcontracts",
    "id": 14298799,
    "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
    "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/smartcontracts",
    "html_url": "https://github.com/smartcontracts",
    "followers_url": "https://api.github.com/users/smartcontracts/followers",
    "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
    "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
    "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
    "repos_url": "https://api.github.com/users/smartcontracts/repos",
    "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
    "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2907832518,
      "node_id": "MDU6TGFiZWwyOTA3ODMyNTE4",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/C-enhancement",
      "name": "C-enhancement",
      "color": "C5DEF5",
      "default": false,
      "description": "Category: A PR with an enhancement or bugfix."
    },
    {
      "id": 3357535896,
      "node_id": "MDU6TGFiZWwzMzU3NTM1ODk2",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/M-l2geth",
      "name": "M-l2geth",
      "color": "FBCA04",
      "default": false,
      "description": "Module: l2geth"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-03-15T16:20:16Z",
  "updated_at": "2022-06-15T15:44:12Z",
  "closed_at": "2022-06-15T15:44:12Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "First, some background. Right now, the Optimism node software has two main components: the \"data transport layer\" (DTL for short) and L2Geth. A while back, we added some code that stops L2Geth from syncing if the DTL hasn't synced all the way to the tip yet. Here's where that code sits:\r\n\r\nhttps://github.com/ethereum-optimism/optimism/blob/17b11bee0ad164283ee7ccb92981249ec27216aa/l2geth/rollup/sync_service.go#L175-L188\r\n\r\nThis makes sync quite slow because the DTL has to sync to the tip first and then L2Geth has to start syncing. We want to try to have L2Geth sync in parallel with the DTL to speed things up.\r\n\r\nLet's talk about how to make this happen. I *think* it should be possible to simply remove the code that I linked above. I'm not 100% sure about that, but it seems reasonable. Hopefully that'll be the entire PR. Once that's done, try running the integration tests to make sure everything is working as expected.\r\n\r\nOnce all that's ready to go, we'll spin up a mainnet node using the old version of the code and another node with the new version of the code. We'll make sure both nodes are syncing correctly and then we'll also record the time savings. Hopefully it's pretty significant!\r\n",
  "closed_by": {
    "login": "mergify[bot]",
    "id": 37929162,
    "node_id": "MDM6Qm90Mzc5MjkxNjI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/10562?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mergify%5Bbot%5D",
    "html_url": "https://github.com/apps/mergify",
    "followers_url": "https://api.github.com/users/mergify%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/mergify%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/mergify%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mergify%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mergify%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/mergify%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/mergify%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/mergify%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mergify%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2329/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2329/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1068189801",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2329#issuecomment-1068189801",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2329",
    "id": 1068189801,
    "node_id": "IC_kwDODjvEJM4_q0hp",
    "user": {
      "login": "tonykogias",
      "id": 20843170,
      "node_id": "MDQ6VXNlcjIwODQzMTcw",
      "avatar_url": "https://avatars.githubusercontent.com/u/20843170?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tonykogias",
      "html_url": "https://github.com/tonykogias",
      "followers_url": "https://api.github.com/users/tonykogias/followers",
      "following_url": "https://api.github.com/users/tonykogias/following{/other_user}",
      "gists_url": "https://api.github.com/users/tonykogias/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tonykogias/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tonykogias/subscriptions",
      "organizations_url": "https://api.github.com/users/tonykogias/orgs",
      "repos_url": "https://api.github.com/users/tonykogias/repos",
      "events_url": "https://api.github.com/users/tonykogias/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tonykogias/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-15T16:25:35Z",
    "updated_at": "2022-03-15T16:25:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "I will give this a shot.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1068189801/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1068191312",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2329#issuecomment-1068191312",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2329",
    "id": 1068191312,
    "node_id": "IC_kwDODjvEJM4_q05Q",
    "user": {
      "login": "Inphi",
      "id": 3516807,
      "node_id": "MDQ6VXNlcjM1MTY4MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3516807?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Inphi",
      "html_url": "https://github.com/Inphi",
      "followers_url": "https://api.github.com/users/Inphi/followers",
      "following_url": "https://api.github.com/users/Inphi/following{/other_user}",
      "gists_url": "https://api.github.com/users/Inphi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Inphi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Inphi/subscriptions",
      "organizations_url": "https://api.github.com/users/Inphi/orgs",
      "repos_url": "https://api.github.com/users/Inphi/repos",
      "events_url": "https://api.github.com/users/Inphi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Inphi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-15T16:26:55Z",
    "updated_at": "2022-03-15T16:26:55Z",
    "author_association": "COLLABORATOR",
    "body": "It should be fine to do this for a verifier. But sequencing l2geth nodes should wait for the dtl, otherwise once it syncs the dtl to the stale index tip, it'll accept sendTxs RPCs and apply them out of order.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1068191312/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
