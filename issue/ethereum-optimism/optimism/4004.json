{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4004",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4004/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4004/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4004/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/4004",
  "id": 1449743676,
  "node_id": "I_kwDODjvEJM5WaVU8",
  "number": 4004,
  "title": "L2geth BatchIndex & L1TxHash",
  "user": {
    "login": "artjoma",
    "id": 15686738,
    "node_id": "MDQ6VXNlcjE1Njg2NzM4",
    "avatar_url": "https://avatars.githubusercontent.com/u/15686738?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/artjoma",
    "html_url": "https://github.com/artjoma",
    "followers_url": "https://api.github.com/users/artjoma/followers",
    "following_url": "https://api.github.com/users/artjoma/following{/other_user}",
    "gists_url": "https://api.github.com/users/artjoma/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/artjoma/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/artjoma/subscriptions",
    "organizations_url": "https://api.github.com/users/artjoma/orgs",
    "repos_url": "https://api.github.com/users/artjoma/repos",
    "events_url": "https://api.github.com/users/artjoma/events{/privacy}",
    "received_events_url": "https://api.github.com/users/artjoma/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2907832604,
      "node_id": "MDU6TGFiZWwyOTA3ODMyNjA0",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/C-question",
      "name": "C-question",
      "color": "C5DEF5",
      "default": false,
      "description": "User questions that are neither feature requests nor bug reports"
    },
    {
      "id": 3357535896,
      "node_id": "MDU6TGFiZWwzMzU3NTM1ODk2",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/M-l2geth",
      "name": "M-l2geth",
      "color": "FBCA04",
      "default": false,
      "description": "Module: l2geth"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2022-11-15T12:58:54Z",
  "updated_at": "2022-11-22T10:22:58Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "L2 geth: 0.5.27\r\nDifferent BatchIndex and L1Hash fields: \r\nhttps://optimistic.etherscan.io/tx/0x9010e5b4e8e4b818ee05fdf35c59cfdc0b665187082b102d7557ec312930f99f\r\nhttps://www.oklink.com/en/optimism/tx/0x9010e5b4e8e4b818ee05fdf35c59cfdc0b665187082b102d7557ec312930f99f\r\n\r\nUsing L2Geth internal API\r\n```\r\nmeta := rawdb.ReadTransactionMeta(api.eth.chainDb, block.Header().Number.Uint64())\r\nrawTx, err := api.eth.syncService.GetClient().GetRawTransaction(*meta.Index, api.eth.syncService.GetBackend())\r\nlog.Info(\"L1Block\", \"n\", rawTx.Batch.BlockNumber) // 15945350\r\nlog.Info(\"Batch\", \"i\", rawTx.Batch.Index) //271065\r\n```\r\nWhere I can get correct BatchIndex & L1BlockNumber using L2Geth internal API ? \r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4004/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4004/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1315969896",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4004#issuecomment-1315969896",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4004",
    "id": 1315969896,
    "node_id": "IC_kwDODjvEJM5OcBto",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-15T22:48:07Z",
    "updated_at": "2022-11-15T22:48:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm not sure if either of these are accessible inside L2Geth, cc @tynes?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1315969896/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1315973262",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4004#issuecomment-1315973262",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4004",
    "id": 1315973262,
    "node_id": "IC_kwDODjvEJM5OcCiO",
    "user": {
      "login": "tynes",
      "id": 6626818,
      "node_id": "MDQ6VXNlcjY2MjY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6626818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tynes",
      "html_url": "https://github.com/tynes",
      "followers_url": "https://api.github.com/users/tynes/followers",
      "following_url": "https://api.github.com/users/tynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/tynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tynes/subscriptions",
      "organizations_url": "https://api.github.com/users/tynes/orgs",
      "repos_url": "https://api.github.com/users/tynes/repos",
      "events_url": "https://api.github.com/users/tynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-15T22:52:09Z",
    "updated_at": "2022-11-15T22:52:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "Try using `block.number - 1` since there are not any transactions in the genesis block",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1315973262/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1316498964",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4004#issuecomment-1316498964",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4004",
    "id": 1316498964,
    "node_id": "IC_kwDODjvEJM5OeC4U",
    "user": {
      "login": "artjoma",
      "id": 15686738,
      "node_id": "MDQ6VXNlcjE1Njg2NzM4",
      "avatar_url": "https://avatars.githubusercontent.com/u/15686738?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/artjoma",
      "html_url": "https://github.com/artjoma",
      "followers_url": "https://api.github.com/users/artjoma/followers",
      "following_url": "https://api.github.com/users/artjoma/following{/other_user}",
      "gists_url": "https://api.github.com/users/artjoma/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/artjoma/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/artjoma/subscriptions",
      "organizations_url": "https://api.github.com/users/artjoma/orgs",
      "repos_url": "https://api.github.com/users/artjoma/repos",
      "events_url": "https://api.github.com/users/artjoma/events{/privacy}",
      "received_events_url": "https://api.github.com/users/artjoma/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-16T07:25:39Z",
    "updated_at": "2022-11-16T07:25:39Z",
    "author_association": "NONE",
    "body": "@tynes why this logic woks till 16200000 block number? After incorrect batch number. Looks very strange.\r\n```\r\nmeta := rawdb.ReadTransactionMeta(api.eth.chainDb, block.Header().Number.Uint64())\r\nrawTx, err := api.eth.syncService.GetClient().GetRawTransaction(*meta.Index, api.eth.syncService.GetBackend())\r\nlog.Info(\"L1Block\", \"n\", rawTx.Batch.BlockNumber) // 15945350\r\nlog.Info(\"Batch\", \"i\", rawTx.Batch.Index)  //271065\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1316498964/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1316832638",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4004#issuecomment-1316832638",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4004",
    "id": 1316832638,
    "node_id": "IC_kwDODjvEJM5OfUV-",
    "user": {
      "login": "artjoma",
      "id": 15686738,
      "node_id": "MDQ6VXNlcjE1Njg2NzM4",
      "avatar_url": "https://avatars.githubusercontent.com/u/15686738?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/artjoma",
      "html_url": "https://github.com/artjoma",
      "followers_url": "https://api.github.com/users/artjoma/followers",
      "following_url": "https://api.github.com/users/artjoma/following{/other_user}",
      "gists_url": "https://api.github.com/users/artjoma/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/artjoma/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/artjoma/subscriptions",
      "organizations_url": "https://api.github.com/users/artjoma/orgs",
      "repos_url": "https://api.github.com/users/artjoma/repos",
      "events_url": "https://api.github.com/users/artjoma/events{/privacy}",
      "received_events_url": "https://api.github.com/users/artjoma/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-16T11:17:49Z",
    "updated_at": "2022-11-16T11:24:21Z",
    "author_association": "NONE",
    "body": "`curl -s http://0.0.0.0:7878/batch/transaction/index/271065?backend=l1|jq > out.log`\r\nHas transaction input:\r\n```\r\n    {\r\n      \"index\": 37000008,\r\n      \"batchIndex\": 271065,\r\n      \"blockNumber\": 15945298,\r\n      \"timestamp\": 1668152471,\r\n      \"gasLimit\": \"0\",\r\n      \"target\": \"0x0000000000000000000000000000000000000000\",\r\n      \"origin\": null,\r\n      \"data\": \"0xf903094e830f42408302bb0d9469dd38645f7457be13571a847ffd905f9acbaf6d80b902a4f17a454600000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000001fb1cf07000000000000000000000000000000000000000000000000000000001f60abad000000000000000000000000d4a2269719276313aa6ab7b01f91d238eba96433000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000da10009cbd5d07dd0cecc66161fc93d7c9000da100000000000000000000000000000000000000000000001cd6fbad57dbd00000000000000000000000000000d4a2269719276313aa6ab7b01f91d238eba964330000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000007f5c764cbc14f9669b88837ca1490cca17c316070000000000000000000000000000000000000000000000000000000000000001000000000000000000000000abc6080b807feed53e22203caae04ccc4c7087dc0000000000000000000000000000000000000000000000000000000000000048010203000d0101010200ff000000000000000000000000000000000000000000427464d9434f99a3d942c60210ee2376166975ceda10009cbd5d07dd0cecc66161fc93d7c9000da100000000000000000000000000000000000000000000000037a0e35055dbfd6c58d60f83c145bcf62509f7a248ba642951b25d856ad7c005f233a0479d357a42894a55f1dec8ddc82d300508ee2de31ce4faadd5d76df249ea98ae\",\r\n      \"queueOrigin\": \"sequencer\",\r\n      \"value\": \"0x0\",\r\n      \"queueIndex\": null,\r\n      \"decoded\": {\r\n        \"nonce\": \"78\",\r\n        \"gasPrice\": \"1000000\",\r\n        \"gasLimit\": \"178957\",\r\n        \"value\": \"0x0\",\r\n        \"target\": \"0x69dd38645f7457be13571a847ffd905f9acbaf6d\",\r\n        \"data\": \"0xf17a454600000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000001a0000000000000000000000000000000000000000000000000000000001fb1cf07000000000000000000000000000000000000000000000000000000001f60abad000000000000000000000000d4a2269719276313aa6ab7b01f91d238eba96433000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000da10009cbd5d07dd0cecc66161fc93d7c9000da100000000000000000000000000000000000000000000001cd6fbad57dbd00000000000000000000000000000d4a2269719276313aa6ab7b01f91d238eba964330000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000007f5c764cbc14f9669b88837ca1490cca17c316070000000000000000000000000000000000000000000000000000000000000001000000000000000000000000abc6080b807feed53e22203caae04ccc4c7087dc0000000000000000000000000000000000000000000000000000000000000048010203000d0101010200ff000000000000000000000000000000000000000000427464d9434f99a3d942c60210ee2376166975ceda10009cbd5d07dd0cecc66161fc93d7c9000da1000000000000000000000000000000000000000000000000\",\r\n        \"sig\": {\r\n          \"v\": 0,\r\n          \"r\": \"0xe35055dbfd6c58d60f83c145bcf62509f7a248ba642951b25d856ad7c005f233\",\r\n          \"s\": \"0x479d357a42894a55f1dec8ddc82d300508ee2de31ce4faadd5d76df249ea98ae\"\r\n        }\r\n      },\r\n      \"confirmed\": true\r\n    },\r\n    \r\n```\r\n\r\nBatch 271067 not.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1316832638/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1323431042",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4004#issuecomment-1323431042",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4004",
    "id": 1323431042,
    "node_id": "IC_kwDODjvEJM5O4fSC",
    "user": {
      "login": "artjoma",
      "id": 15686738,
      "node_id": "MDQ6VXNlcjE1Njg2NzM4",
      "avatar_url": "https://avatars.githubusercontent.com/u/15686738?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/artjoma",
      "html_url": "https://github.com/artjoma",
      "followers_url": "https://api.github.com/users/artjoma/followers",
      "following_url": "https://api.github.com/users/artjoma/following{/other_user}",
      "gists_url": "https://api.github.com/users/artjoma/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/artjoma/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/artjoma/subscriptions",
      "organizations_url": "https://api.github.com/users/artjoma/orgs",
      "repos_url": "https://api.github.com/users/artjoma/repos",
      "events_url": "https://api.github.com/users/artjoma/events{/privacy}",
      "received_events_url": "https://api.github.com/users/artjoma/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-22T10:22:58Z",
    "updated_at": "2022-11-22T10:22:58Z",
    "author_association": "NONE",
    "body": "@smartcontracts ^^^",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1323431042/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
