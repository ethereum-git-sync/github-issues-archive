{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/6107",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/6107/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/6107/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/6107/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/6107",
  "id": 1770115998,
  "node_id": "I_kwDODjvEJM5pgdOe",
  "number": 6107,
  "title": "eth_getBlockByNumber vs eth_getBlockByHash responses discrepancies",
  "user": {
    "login": "yaanakbr",
    "id": 126090886,
    "node_id": "U_kgDOB4P-hg",
    "avatar_url": "https://avatars.githubusercontent.com/u/126090886?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/yaanakbr",
    "html_url": "https://github.com/yaanakbr",
    "followers_url": "https://api.github.com/users/yaanakbr/followers",
    "following_url": "https://api.github.com/users/yaanakbr/following{/other_user}",
    "gists_url": "https://api.github.com/users/yaanakbr/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/yaanakbr/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/yaanakbr/subscriptions",
    "organizations_url": "https://api.github.com/users/yaanakbr/orgs",
    "repos_url": "https://api.github.com/users/yaanakbr/repos",
    "events_url": "https://api.github.com/users/yaanakbr/events{/privacy}",
    "received_events_url": "https://api.github.com/users/yaanakbr/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-06-22T17:28:30Z",
  "updated_at": "2023-06-23T12:57:48Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "We are running a curl request for `eth_getBlockByNumber` vs `eth_getBlockByHash` responses, For block `46772657`, there is one transaction in the block. However, `eth_getBlockByHash` returns a `chainId` field in the transaction while eth_getBlockByNum does not return `chainId` field in the transaction.\r\n\r\nDo you know why there is a difference for this block?\r\n\r\nRPC backend version: `Geth/v0.1.0-unstable-0a77db9c/linux-amd64/go1.20.1`\r\n\r\ncurl request eth_getBlockByNumber: \r\n\r\n```\r\ncurl -s https://<QUIKNODE-ENDPOINT>/XXX -H \"Content-Type: application/json\" -d '{ \"jsonrpc\": \"2.0\", \"id\": 1, \"method\": \"eth_getBlockByNumber\", \"params\": [\"0x2c9b1b1\", true] }'\r\n```\r\n\r\nresponse: \r\n\r\n```\r\n{\r\n  \"jsonrpc\": \"2.0\",\r\n  \"id\": 1,\r\n  \"result\": {\r\n    \"difficulty\": \"0x2\",\r\n    \"extraData\": \"0xd98301090a846765746889676f312e31352e3133856c696e7578000000000000cebb9731665fbaa5bad7259f336e0e3bc3f4235bd023d41269ef1d692272ab932efd94784330c27ffeece1cb02bdd868baae3acc1684e120ce1c1545df7ad9b601\",\r\n    \"gasLimit\": \"0xe4e1c0\",\r\n    \"gasUsed\": \"0x5208\",\r\n    \"hash\": \"0xf58a82de42a8b12dd5bb9e0aee47ba9512832309e629027b81b5f23dcb4b3e71\",\r\n    \"logsBloom\": \"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\r\n    \"miner\": \"0x0000000000000000000000000000000000000000\",\r\n    \"mixHash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n    \"nonce\": \"0x0000000000000000\",\r\n    \"number\": \"0x2c9b1b1\",\r\n    \"parentHash\": \"0x454badb331c9cb14ae6897530011081492a3e58c47a364a6f62ce416dcf64a8c\",\r\n    \"receiptsRoot\": \"0x056b23fbba480696b65fe5a59b8f2148a1299103c4f57df839233af2cf4ca2d2\",\r\n    \"sha3Uncles\": \"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347\",\r\n    \"size\": \"0x2d0\",\r\n    \"stateRoot\": \"0x5307c8b991a8cf03eabfb96f1e0b8a05b0dc423734f759a39a4f9716de2bbaa0\",\r\n    \"timestamp\": \"0x6391d861\",\r\n    \"totalDifficulty\": \"0x5936363\",\r\n    \"transactions\": [\r\n      {\r\n        \"blockHash\": \"0xf58a82de42a8b12dd5bb9e0aee47ba9512832309e629027b81b5f23dcb4b3e71\",\r\n        \"blockNumber\": \"0x2c9b1b1\",\r\n        \"from\": \"0xb20c8dca769b63314d1965cebedb87e2a3a70715\",\r\n        \"gas\": \"0x5208\",\r\n        \"gasPrice\": \"0x10c8e0\",\r\n        \"hash\": \"0x8fb278a0ecaeaa660fd88c794dc51a1940cf9832ca543332e59ef3691d7680b7\",\r\n        \"input\": \"0x\",\r\n        \"nonce\": \"0xb\",\r\n        \"to\": \"0x6abf790d3b4a80ebfce25dccbfa07f6f8e5cab1a\",\r\n        \"transactionIndex\": \"0x0\",\r\n        \"value\": \"0x3c6568f12e8000\",\r\n        \"v\": \"0x38\",\r\n        \"r\": \"0xf4f4795c43f3699e2b2fe3fe629f11d274ed4252c6052015b9bc10182b3ab6c6\",\r\n        \"s\": \"0x68c5a331660b592d50ddd670a8df8953f75b8b71adb1dfe4febc47771f2a4e18\",\r\n        \"queueOrigin\": \"sequencer\",\r\n        \"l1TxOrigin\": null,\r\n        \"l1BlockNumber\": \"0xf646a0\",\r\n        \"l1Timestamp\": \"0x6391d861\",\r\n        \"index\": \"0x2c9b1b0\",\r\n        \"queueIndex\": null,\r\n        \"rawTransaction\": \"0xf8690b8310c8e0825208946abf790d3b4a80ebfce25dccbfa07f6f8e5cab1a873c6568f12e80008038a0f4f4795c43f3699e2b2fe3fe629f11d274ed4252c6052015b9bc10182b3ab6c6a068c5a331660b592d50ddd670a8df8953f75b8b71adb1dfe4febc47771f2a4e18\"\r\n      }\r\n    ],\r\n    \"transactionsRoot\": \"0x8917ef36a9e241c2cfc48d5fa49afef55c9638c70a73295c263d6f9283931a9a\",\r\n    \"uncles\": []\r\n  }\r\n}\r\n```\r\n\r\ncurl request eth_getBlockByHash: \r\n\r\n\r\n```\r\ncurl -s https://<QUIKNODE-ENDPOINT>/XXX -H \"Content-Type: application/json\" -d '{ \"jsonrpc\": \"2.0\", \"id\": 1, \"method\": \"eth_getBlockByHash\", \"params\": [\"0xf58a82de42a8b12dd5bb9e0aee47ba9512832309e629027b81b5f23dcb4b3e71\", true] }' \r\n```\r\n\r\nresponse: \r\n\r\n```\r\n{\r\n  \"jsonrpc\": \"2.0\",\r\n  \"id\": 1,\r\n  \"result\": {\r\n    \"difficulty\": \"0x2\",\r\n    \"extraData\": \"0xd98301090a846765746889676f312e31352e3133856c696e7578000000000000cebb9731665fbaa5bad7259f336e0e3bc3f4235bd023d41269ef1d692272ab932efd94784330c27ffeece1cb02bdd868baae3acc1684e120ce1c1545df7ad9b601\",\r\n    \"gasLimit\": \"0xe4e1c0\",\r\n    \"gasUsed\": \"0x5208\",\r\n    \"hash\": \"0xf58a82de42a8b12dd5bb9e0aee47ba9512832309e629027b81b5f23dcb4b3e71\",\r\n    \"logsBloom\": \"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\r\n    \"miner\": \"0x0000000000000000000000000000000000000000\",\r\n    \"mixHash\": \"0x0000000000000000000000000000000000000000000000000000000000000000\",\r\n    \"nonce\": \"0x0000000000000000\",\r\n    \"number\": \"0x2c9b1b1\",\r\n    \"parentHash\": \"0x454badb331c9cb14ae6897530011081492a3e58c47a364a6f62ce416dcf64a8c\",\r\n    \"receiptsRoot\": \"0x056b23fbba480696b65fe5a59b8f2148a1299103c4f57df839233af2cf4ca2d2\",\r\n    \"sha3Uncles\": \"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347\",\r\n    \"size\": \"0x2d0\",\r\n    \"stateRoot\": \"0x5307c8b991a8cf03eabfb96f1e0b8a05b0dc423734f759a39a4f9716de2bbaa0\",\r\n    \"timestamp\": \"0x6391d861\",\r\n    \"totalDifficulty\": \"0x5936363\",\r\n    \"transactions\": [\r\n      {\r\n        \"blockHash\": \"0xf58a82de42a8b12dd5bb9e0aee47ba9512832309e629027b81b5f23dcb4b3e71\",\r\n        \"blockNumber\": \"0x2c9b1b1\",\r\n        \"from\": \"0xb20c8dca769b63314d1965cebedb87e2a3a70715\",\r\n        \"gas\": \"0x5208\",\r\n        \"gasPrice\": \"0x10c8e0\",\r\n        \"hash\": \"0x8fb278a0ecaeaa660fd88c794dc51a1940cf9832ca543332e59ef3691d7680b7\",\r\n        \"input\": \"0x\",\r\n        \"nonce\": \"0xb\",\r\n        \"to\": \"0x6abf790d3b4a80ebfce25dccbfa07f6f8e5cab1a\",\r\n        \"transactionIndex\": \"0x0\",\r\n        \"value\": \"0x3c6568f12e8000\",\r\n        \"type\": \"0x0\",\r\n        \"chainId\": \"0xa\",\r\n        \"v\": \"0x38\",\r\n        \"r\": \"0xf4f4795c43f3699e2b2fe3fe629f11d274ed4252c6052015b9bc10182b3ab6c6\",\r\n        \"s\": \"0x68c5a331660b592d50ddd670a8df8953f75b8b71adb1dfe4febc47771f2a4e18\"\r\n      }\r\n    ],\r\n    \"transactionsRoot\": \"0x8917ef36a9e241c2cfc48d5fa49afef55c9638c70a73295c263d6f9283931a9a\",\r\n    \"uncles\": []\r\n  }\r\n}\r\n```\r\n\r\nThanks for the help in advance! :) ",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/6107/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/6107/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1603313548",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/6107#issuecomment-1603313548",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/6107",
    "id": 1603313548,
    "node_id": "IC_kwDODjvEJM5fkJ-M",
    "user": {
      "login": "tynes",
      "id": 6626818,
      "node_id": "MDQ6VXNlcjY2MjY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6626818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tynes",
      "html_url": "https://github.com/tynes",
      "followers_url": "https://api.github.com/users/tynes/followers",
      "following_url": "https://api.github.com/users/tynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/tynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tynes/subscriptions",
      "organizations_url": "https://api.github.com/users/tynes/orgs",
      "repos_url": "https://api.github.com/users/tynes/repos",
      "events_url": "https://api.github.com/users/tynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-22T21:04:26Z",
    "updated_at": "2023-06-22T21:04:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "Notice the first response has some additional fields, those are the legacy fields. `op-geth` will forward requests to `l2geth` (legacy) for some requests. Note that the block data exists in both. It looks like `op-geth` is forwarding the request for block by number but not for block by hash.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1603313548/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1603509731",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/6107#issuecomment-1603509731",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/6107",
    "id": 1603509731,
    "node_id": "IC_kwDODjvEJM5fk53j",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-23T01:30:59Z",
    "updated_at": "2023-06-23T01:30:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "@tynes seems like a bug to me",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1603509731/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1604247723",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/6107#issuecomment-1604247723",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/6107",
    "id": 1604247723,
    "node_id": "IC_kwDODjvEJM5fnuCr",
    "user": {
      "login": "yaanakbr",
      "id": 126090886,
      "node_id": "U_kgDOB4P-hg",
      "avatar_url": "https://avatars.githubusercontent.com/u/126090886?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yaanakbr",
      "html_url": "https://github.com/yaanakbr",
      "followers_url": "https://api.github.com/users/yaanakbr/followers",
      "following_url": "https://api.github.com/users/yaanakbr/following{/other_user}",
      "gists_url": "https://api.github.com/users/yaanakbr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yaanakbr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yaanakbr/subscriptions",
      "organizations_url": "https://api.github.com/users/yaanakbr/orgs",
      "repos_url": "https://api.github.com/users/yaanakbr/repos",
      "events_url": "https://api.github.com/users/yaanakbr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yaanakbr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-23T12:57:47Z",
    "updated_at": "2023-06-23T12:57:47Z",
    "author_association": "NONE",
    "body": "hey @smartcontracts what should be the expected behavior/result? 😄 ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1604247723/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
