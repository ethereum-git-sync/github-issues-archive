{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/7731",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/7731/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/7731/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/7731/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/7731",
  "id": 1950307617,
  "node_id": "I_kwDODjvEJM50P1Uh",
  "number": 7731,
  "title": "Testing Plan for Canyon Network Upgrade",
  "user": {
    "login": "trianglesphere",
    "id": 11803341,
    "node_id": "MDQ6VXNlcjExODAzMzQx",
    "avatar_url": "https://avatars.githubusercontent.com/u/11803341?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/trianglesphere",
    "html_url": "https://github.com/trianglesphere",
    "followers_url": "https://api.github.com/users/trianglesphere/followers",
    "following_url": "https://api.github.com/users/trianglesphere/following{/other_user}",
    "gists_url": "https://api.github.com/users/trianglesphere/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/trianglesphere/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/trianglesphere/subscriptions",
    "organizations_url": "https://api.github.com/users/trianglesphere/orgs",
    "repos_url": "https://api.github.com/users/trianglesphere/repos",
    "events_url": "https://api.github.com/users/trianglesphere/events{/privacy}",
    "received_events_url": "https://api.github.com/users/trianglesphere/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "trianglesphere",
    "id": 11803341,
    "node_id": "MDQ6VXNlcjExODAzMzQx",
    "avatar_url": "https://avatars.githubusercontent.com/u/11803341?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/trianglesphere",
    "html_url": "https://github.com/trianglesphere",
    "followers_url": "https://api.github.com/users/trianglesphere/followers",
    "following_url": "https://api.github.com/users/trianglesphere/following{/other_user}",
    "gists_url": "https://api.github.com/users/trianglesphere/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/trianglesphere/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/trianglesphere/subscriptions",
    "organizations_url": "https://api.github.com/users/trianglesphere/orgs",
    "repos_url": "https://api.github.com/users/trianglesphere/repos",
    "events_url": "https://api.github.com/users/trianglesphere/events{/privacy}",
    "received_events_url": "https://api.github.com/users/trianglesphere/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "trianglesphere",
      "id": 11803341,
      "node_id": "MDQ6VXNlcjExODAzMzQx",
      "avatar_url": "https://avatars.githubusercontent.com/u/11803341?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/trianglesphere",
      "html_url": "https://github.com/trianglesphere",
      "followers_url": "https://api.github.com/users/trianglesphere/followers",
      "following_url": "https://api.github.com/users/trianglesphere/following{/other_user}",
      "gists_url": "https://api.github.com/users/trianglesphere/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/trianglesphere/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/trianglesphere/subscriptions",
      "organizations_url": "https://api.github.com/users/trianglesphere/orgs",
      "repos_url": "https://api.github.com/users/trianglesphere/repos",
      "events_url": "https://api.github.com/users/trianglesphere/events{/privacy}",
      "received_events_url": "https://api.github.com/users/trianglesphere/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-10-18T17:40:39Z",
  "updated_at": "2023-10-30T05:56:46Z",
  "closed_at": null,
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "The features currently planned for canyon are the following:\r\n\r\n* Activating Shapella\r\n* Changing EIP-1559 parameters\r\n* Adjusting the channel ordering in the channel bank\r\n* Adding span batches\r\n* Fixing an op-geth receipt hashing bug\r\n* Adding the create2Deployer on base\r\n\r\n\r\nWe have unit tests for each of these features are part of our normal development process, but would like to test the activation & assert that the behavior is as expected before and after the network upgrade.\r\n\r\nTo test the above, we want to have scripts which do the following:\r\n\r\n\r\n* Shapella Before\r\n    * Block RLP **does not** contains withdrawals\r\n    * PUSH0 instruction **does not** work\r\n* Shalella After\r\n    * Block RLP **does** contains withdrawals\r\n    * PUSH0 instruction **does** work\r\n    * P2P gossip continues to work\r\n* EIP-1559 Changes\r\n    * Check that the new parameters are being used only after activation by calculating the basefee by the old formula & also by the new formula \r\n* Channel Ordering Fix\r\n    * Submit a dangling channel prior to the upgrade & observe a safe head stall\r\n    * Submit a dangling channel after the upgrade & observe no safe head stalls\r\n* Span Batches\r\n    * Submit span batches prior to activation & assert that no L2 blocks are derived from them.\r\n    * Submit span batches after activation & assert that the L2 safe chain advances.\r\n    * Submit normal batches after activation & assert that those still work.\r\n* op-geth receipt hashing bug\r\n    * Manually RLP encode & hash a pre & post canyon deposit receipt. Verify that the hash is in the receipts trie\r\n* create2Deployer\r\n    * Assert that the codehash pre-canyon is the empty code hash. Assert that post-canyon on specific chains that it is the expected code hash\r\n    * If testing the activation of multiple chains, it should remain the empty code hash on some chains\r\n    * Post-Canyon, send a transaction that uses this contract\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/7731/reactions",
    "total_count": 2,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 2,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/7731/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1769787171",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/7731#issuecomment-1769787171",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/7731",
    "id": 1769787171,
    "node_id": "IC_kwDODjvEJM5pfM8j",
    "user": {
      "login": "ajsutton",
      "id": 72675,
      "node_id": "MDQ6VXNlcjcyNjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/72675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajsutton",
      "html_url": "https://github.com/ajsutton",
      "followers_url": "https://api.github.com/users/ajsutton/followers",
      "following_url": "https://api.github.com/users/ajsutton/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajsutton/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajsutton/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajsutton/subscriptions",
      "organizations_url": "https://api.github.com/users/ajsutton/orgs",
      "repos_url": "https://api.github.com/users/ajsutton/repos",
      "events_url": "https://api.github.com/users/ajsutton/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajsutton/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-19T02:22:58Z",
    "updated_at": "2023-10-19T02:22:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "If its possible for span batches to be submitted across multiple transactions like regular batches, we should also test the behaviour when the span batch starts prior to the fork activating and is completed after the fork activates.\r\n\r\nProbably also worth a test to confirm that chain derivation works correctly when there is a mix of span and normal batches.\r\n\r\nOtherwise looks good.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1769787171/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1778286983",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/7731#issuecomment-1778286983",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/7731",
    "id": 1778286983,
    "node_id": "IC_kwDODjvEJM5p_oGH",
    "user": {
      "login": "trianglesphere",
      "id": 11803341,
      "node_id": "MDQ6VXNlcjExODAzMzQx",
      "avatar_url": "https://avatars.githubusercontent.com/u/11803341?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/trianglesphere",
      "html_url": "https://github.com/trianglesphere",
      "followers_url": "https://api.github.com/users/trianglesphere/followers",
      "following_url": "https://api.github.com/users/trianglesphere/following{/other_user}",
      "gists_url": "https://api.github.com/users/trianglesphere/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/trianglesphere/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/trianglesphere/subscriptions",
      "organizations_url": "https://api.github.com/users/trianglesphere/orgs",
      "repos_url": "https://api.github.com/users/trianglesphere/repos",
      "events_url": "https://api.github.com/users/trianglesphere/events{/privacy}",
      "received_events_url": "https://api.github.com/users/trianglesphere/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-10-25T00:38:26Z",
    "updated_at": "2023-10-25T00:38:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "Status Update. The following have testing scripts & I have confirmed that they work\r\n\r\n* Withdrawals in the L2 block body\r\n* Deposit Receipt Hash (there may be a bug in the json RPC being returned, but the block hash is working correctly)\r\n* 1559 Basefee calculation changes at the right time\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1778286983/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
