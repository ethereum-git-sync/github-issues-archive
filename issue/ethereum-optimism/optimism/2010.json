{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2010",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2010/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2010/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2010/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/2010",
  "id": 1103586863,
  "node_id": "I_kwDODjvEJM5Bx2Yv",
  "number": 2010,
  "title": "Several blocks with the same tx",
  "user": {
    "login": "ninjascant",
    "id": 22071646,
    "node_id": "MDQ6VXNlcjIyMDcxNjQ2",
    "avatar_url": "https://avatars.githubusercontent.com/u/22071646?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ninjascant",
    "html_url": "https://github.com/ninjascant",
    "followers_url": "https://api.github.com/users/ninjascant/followers",
    "following_url": "https://api.github.com/users/ninjascant/following{/other_user}",
    "gists_url": "https://api.github.com/users/ninjascant/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ninjascant/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ninjascant/subscriptions",
    "organizations_url": "https://api.github.com/users/ninjascant/orgs",
    "repos_url": "https://api.github.com/users/ninjascant/repos",
    "events_url": "https://api.github.com/users/ninjascant/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ninjascant/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2907832490,
      "node_id": "MDU6TGFiZWwyOTA3ODMyNDkw",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/C-bug",
      "name": "C-bug",
      "color": "C5DEF5",
      "default": false,
      "description": "Category: This is a bug."
    },
    {
      "id": 2981541772,
      "node_id": "MDU6TGFiZWwyOTgxNTQxNzcy",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/P-confirmed",
      "name": "P-confirmed",
      "color": "BFD4F2",
      "default": false,
      "description": "A confirmed bug"
    },
    {
      "id": 3152093041,
      "node_id": "MDU6TGFiZWwzMTUyMDkzMDQx",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/P-wontfix",
      "name": "P-wontfix",
      "color": "C5DEF5",
      "default": false,
      "description": "Something we won't fix because it's intended behavior"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-01-14T12:43:51Z",
  "updated_at": "2023-03-08T20:24:54Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!--\r\nNeed help?\r\nRefer to our contributing guidelines for additional information about making a good issue:\r\nhttps://github.com/ethereum-optimism/.github/blob/master/CONTRIBUTING.md\r\n-->\r\n\r\n**Describe the bug**\r\nWhile calling `eth_getBlockByNumber` on several block numbers, the response shows that the same transaction appears in several blocks\r\n\r\n**To Reproduce**\r\n1. getBlockByNumber on the block 985:\r\n```\r\ncurl -X POST --data '{\"jsonrpc\": \"2.0\", \"method\": \"eth_getBlockByNumber\", \"params\": [\"0x3d9\", false], \"id\": 1}' -H \"Content-Type: application/json\" https://mainnet.optimism.io\r\n```\r\nreturns: `\"transactions\":[\"0x9ed8f713b2cc6439657db52dcd2fdb9cc944915428f3c6e2a7703e242b259cb9\"]`\r\n\r\n2. getBlockByNumber on the block 19022:\r\n```\r\ncurl -X POST --data '{\"jsonrpc\": \"2.0\", \"method\": \"eth_getBlockByNumber\", \"params\": [\"0x4a4e\", false], \"id\": 1}' -H \"Content-Type: application/json\" https://mainnet.optimism.io\r\n```\r\nshows the same `transactions` value\r\n3. \r\n\r\n**Expected behavior**\r\nA transaction with a given hash can only appear in 1 block\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2010/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2010/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1013358417",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2010#issuecomment-1013358417",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2010",
    "id": 1013358417,
    "node_id": "IC_kwDODjvEJM48Zp9R",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-14T18:28:33Z",
    "updated_at": "2022-01-14T18:28:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "This was the result of a bug within the whitelisting logic. Specifically, if a user attempted to create a smart contract but wasn't whitelisted then the transaction would be executed but the user's nonce would not be incremented. If the user tried to deploy the same contract again, then the nonce would be the same and therefore the transaction hash would also be the same. You can confirm that this is the case by [looking at Etherscan](https://optimistic.etherscan.io/tx/0x9ed8f713b2cc6439657db52dcd2fdb9cc944915428f3c6e2a7703e242b259cb9).\r\n\r\nAre you being impacted by this bug? If this is somehow impacting client-side tooling, we may want to consider our options to remedy this issue after the fact. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1013358417/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1015816777",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2010#issuecomment-1015816777",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2010",
    "id": 1015816777,
    "node_id": "IC_kwDODjvEJM48jCJJ",
    "user": {
      "login": "tynes",
      "id": 6626818,
      "node_id": "MDQ6VXNlcjY2MjY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6626818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tynes",
      "html_url": "https://github.com/tynes",
      "followers_url": "https://api.github.com/users/tynes/followers",
      "following_url": "https://api.github.com/users/tynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/tynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tynes/subscriptions",
      "organizations_url": "https://api.github.com/users/tynes/orgs",
      "repos_url": "https://api.github.com/users/tynes/repos",
      "events_url": "https://api.github.com/users/tynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-18T20:41:18Z",
    "updated_at": "2022-01-18T20:41:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "The database indexes transactions by hash, so only the latest transaction with the matching hash will be accessible via \"get transaction by hash\".",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1015816777/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1460825277",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2010#issuecomment-1460825277",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2010",
    "id": 1460825277,
    "node_id": "IC_kwDODjvEJM5XEmy9",
    "user": {
      "login": "GCrispino",
      "id": 8827509,
      "node_id": "MDQ6VXNlcjg4Mjc1MDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8827509?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/GCrispino",
      "html_url": "https://github.com/GCrispino",
      "followers_url": "https://api.github.com/users/GCrispino/followers",
      "following_url": "https://api.github.com/users/GCrispino/following{/other_user}",
      "gists_url": "https://api.github.com/users/GCrispino/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/GCrispino/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/GCrispino/subscriptions",
      "organizations_url": "https://api.github.com/users/GCrispino/orgs",
      "repos_url": "https://api.github.com/users/GCrispino/repos",
      "events_url": "https://api.github.com/users/GCrispino/events{/privacy}",
      "received_events_url": "https://api.github.com/users/GCrispino/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-08T20:24:53Z",
    "updated_at": "2023-03-08T20:24:53Z",
    "author_association": "NONE",
    "body": "Hey @smartcontracts , I can see this has the P-wontfix label, so does this mean the whitelisting bug hasn't been fixed and won't be fixed? In other words, can we still have duplicated transactions in different blocks in the future?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1460825277/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
