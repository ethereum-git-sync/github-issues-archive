{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/2055",
  "id": 1112009173,
  "node_id": "I_kwDODjvEJM5CR-nV",
  "number": 2055,
  "title": "Replace Watcher with new SDK in integration tests",
  "user": {
    "login": "smartcontracts",
    "id": 14298799,
    "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
    "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/smartcontracts",
    "html_url": "https://github.com/smartcontracts",
    "followers_url": "https://api.github.com/users/smartcontracts/followers",
    "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
    "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
    "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
    "repos_url": "https://api.github.com/users/smartcontracts/repos",
    "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
    "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2907832712,
      "node_id": "MDU6TGFiZWwyOTA3ODMyNzEy",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/M-core-utils",
      "name": "M-core-utils",
      "color": "FBCA04",
      "default": false,
      "description": "Module: core-utils"
    },
    {
      "id": 2978714528,
      "node_id": "MDU6TGFiZWwyOTc4NzE0NTI4",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/good%20first%20issue",
      "name": "good first issue",
      "color": "C2E0C6",
      "default": true,
      "description": ""
    },
    {
      "id": 3662935689,
      "node_id": "LA_kwDODjvEJM7aU_aJ",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/M-sdk",
      "name": "M-sdk",
      "color": "FBCA04",
      "default": false,
      "description": "Module: sdk"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 15,
  "created_at": "2022-01-23T22:50:32Z",
  "updated_at": "2022-02-09T15:52:05Z",
  "closed_at": "2022-02-09T15:48:48Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "I'm labeling this as a \"good first issue\" but it could be more suited for contributors who have contributed to the codebase a few times already. It's definitely on the meatier side. A new contributor might prove me wrong, so it's worth a shot!\r\n\r\nWe are in the process of [replacing certain utilities with the new Optimism SDK](https://github.com/ethereum-optimism/optimism/discussions/1898). We are planning to remove the [`Watcher` class from the `core-utils` package](https://github.com/ethereum-optimism/optimism/blob/develop/packages/core-utils/src/watcher.ts). As part of this process, we need to remove any usage of the `Watcher` from within this repository.\r\n\r\nCurrently, the `Watcher` is only being used inside of this repository as part of the [integration tests](https://github.com/ethereum-optimism/optimism/tree/develop/integration-tests). The goal of this issue is to replace all usage of the `Watcher` in the integration tests with the utilities that can be found in the [`CrossChainProvider`](https://github.com/ethereum-optimism/optimism/blob/eb926e2f90b5eec4558f3c82746b639b19ddf9d5/packages/sdk/src/cross-chain-provider.ts#L37) class from the new `@eth-optimism/sdk` package.\r\n\r\nHere's how I think this needs to be done:\r\n1. Instead of [creating a `Watcher` when making the `OptimismEnv`](https://github.com/ethereum-optimism/optimism/blob/eb926e2f90b5eec4558f3c82746b639b19ddf9d5/integration-tests/test/shared/env.ts#L83), create a `CrossChainProvider` instead.\r\n2. Get rid of the [`watcher-utils`](https://github.com/ethereum-optimism/optimism/blob/develop/integration-tests/test/shared/watcher-utils.ts) file. The only useful function here is `waitForXDomainTransaction`, which is fully replaced by [`CrossChainProvider.waitForMessageReceipt`](https://github.com/ethereum-optimism/optimism/blob/eb926e2f90b5eec4558f3c82746b639b19ddf9d5/packages/sdk/src/cross-chain-provider.ts#L399).\r\n\r\nI *think* this is it, but there might be additional steps required. You don't actually need to delete the `Watcher` yet, we'll be doing a deprecation notice for that once we confirm this works as a good replacement for the `Watcher`. As always, feel free to ask clarifying questions here if you're interested in working on this but aren't 100% sure about something.\r\n\r\nBonus points if you're willing to give some feedback about how it feels to use the SDK!\r\n",
  "closed_by": {
    "login": "smartcontracts",
    "id": 14298799,
    "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
    "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/smartcontracts",
    "html_url": "https://github.com/smartcontracts",
    "followers_url": "https://api.github.com/users/smartcontracts/followers",
    "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
    "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
    "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
    "repos_url": "https://api.github.com/users/smartcontracts/repos",
    "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
    "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1022254916",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2055#issuecomment-1022254916",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055",
    "id": 1022254916,
    "node_id": "IC_kwDODjvEJM487l9E",
    "user": {
      "login": "jgresham",
      "id": 3721291,
      "node_id": "MDQ6VXNlcjM3MjEyOTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3721291?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jgresham",
      "html_url": "https://github.com/jgresham",
      "followers_url": "https://api.github.com/users/jgresham/followers",
      "following_url": "https://api.github.com/users/jgresham/following{/other_user}",
      "gists_url": "https://api.github.com/users/jgresham/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jgresham/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jgresham/subscriptions",
      "organizations_url": "https://api.github.com/users/jgresham/orgs",
      "repos_url": "https://api.github.com/users/jgresham/repos",
      "events_url": "https://api.github.com/users/jgresham/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jgresham/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-26T14:34:29Z",
    "updated_at": "2022-01-26T14:34:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "I've only made one small contribution, but will try to take a look at this. If this is more urgent, perhaps someone else should take it on. I'll update here if I think I am making good progress.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1022254916/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1022304220",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2055#issuecomment-1022304220",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055",
    "id": 1022304220,
    "node_id": "IC_kwDODjvEJM487x_c",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-26T15:22:48Z",
    "updated_at": "2022-01-26T15:22:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jgresham this isn't particularly urgent, feel free to have a go at it! I'll get back to this conversation later if we end up wanting to get this done faster but no urgency for now.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1022304220/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1022562986",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2055#issuecomment-1022562986",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055",
    "id": 1022562986,
    "node_id": "IC_kwDODjvEJM488xKq",
    "user": {
      "login": "jgresham",
      "id": 3721291,
      "node_id": "MDQ6VXNlcjM3MjEyOTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3721291?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jgresham",
      "html_url": "https://github.com/jgresham",
      "followers_url": "https://api.github.com/users/jgresham/followers",
      "following_url": "https://api.github.com/users/jgresham/following{/other_user}",
      "gists_url": "https://api.github.com/users/jgresham/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jgresham/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jgresham/subscriptions",
      "organizations_url": "https://api.github.com/users/jgresham/orgs",
      "repos_url": "https://api.github.com/users/jgresham/repos",
      "events_url": "https://api.github.com/users/jgresham/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jgresham/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-26T20:12:30Z",
    "updated_at": "2022-01-26T20:12:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "Without any changes, I'm trying to run integration tests. I followed this to run optimism local env https://community.optimism.io/docs/developers/build/dev-node/#option-2-building-from-source\r\n\r\nthen running `yarn test:integration` results in ~30% of tests failing. \r\n\r\nAre there any other steps to run integration tests for local env? I only see steps for live integration tests in integration tests README for https://github.com/ethereum-optimism/optimism/tree/eb926e2f90b5eec4558f3c82746b639b19ddf9d5/integration-tests",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1022562986/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1022571123",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2055#issuecomment-1022571123",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055",
    "id": 1022571123,
    "node_id": "IC_kwDODjvEJM488zJz",
    "user": {
      "login": "indeavr",
      "id": 22181177,
      "node_id": "MDQ6VXNlcjIyMTgxMTc3",
      "avatar_url": "https://avatars.githubusercontent.com/u/22181177?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/indeavr",
      "html_url": "https://github.com/indeavr",
      "followers_url": "https://api.github.com/users/indeavr/followers",
      "following_url": "https://api.github.com/users/indeavr/following{/other_user}",
      "gists_url": "https://api.github.com/users/indeavr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/indeavr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/indeavr/subscriptions",
      "organizations_url": "https://api.github.com/users/indeavr/orgs",
      "repos_url": "https://api.github.com/users/indeavr/repos",
      "events_url": "https://api.github.com/users/indeavr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/indeavr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-26T20:22:51Z",
    "updated_at": "2022-01-26T20:23:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Without any changes, I'm trying to run integration tests. I followed this to run optimism local env https://community.optimism.io/docs/developers/build/dev-node/#option-2-building-from-source\r\n> \r\n> then running `yarn test:integration` results in ~30% of tests failing.\r\n> \r\n> Are there any other steps to run integration tests for local env? I only see steps for live integration tests in integration tests README for https://github.com/ethereum-optimism/optimism/tree/eb926e2f90b5eec4558f3c82746b639b19ddf9d5/integration-tests\r\n\r\nWhat OS are you using ? \r\nYou can try with docker - \r\n```docker-compose run integration-tests```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1022571123/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1022675981",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2055#issuecomment-1022675981",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055",
    "id": 1022675981,
    "node_id": "IC_kwDODjvEJM489MwN",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-26T22:52:25Z",
    "updated_at": "2022-01-26T22:52:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jgresham can you try spinning up the system with `docker-compose up -f docker-compose.yml -f docker-compose.ts-batch-submitter.yml`? I think there might be an issue in the docs right now because we're testing a new batch submitter codebase.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1022675981/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1027312820",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2055#issuecomment-1027312820",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055",
    "id": 1027312820,
    "node_id": "IC_kwDODjvEJM49O4y0",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-01T21:38:37Z",
    "updated_at": "2022-02-01T21:38:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jgresham we're preparing to run an alpha test program of the SDK, I'm going to start digging around in the integration tests to see if I can use the SDK to make other improvements. You're more than welcome to continue work here, or if it's too much I can take the issue over.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1027312820/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1027329573",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2055#issuecomment-1027329573",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055",
    "id": 1027329573,
    "node_id": "IC_kwDODjvEJM49O84l",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-01T22:02:23Z",
    "updated_at": "2022-02-01T22:02:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yeah I didn't realize how many updates to the integration tests would be required to make this fully work. I'd be happy to take it over if it's too complex.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1027329573/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1029601021",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2055#issuecomment-1029601021",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055",
    "id": 1029601021,
    "node_id": "IC_kwDODjvEJM49Xnb9",
    "user": {
      "login": "jgresham",
      "id": 3721291,
      "node_id": "MDQ6VXNlcjM3MjEyOTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3721291?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jgresham",
      "html_url": "https://github.com/jgresham",
      "followers_url": "https://api.github.com/users/jgresham/followers",
      "following_url": "https://api.github.com/users/jgresham/following{/other_user}",
      "gists_url": "https://api.github.com/users/jgresham/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jgresham/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jgresham/subscriptions",
      "organizations_url": "https://api.github.com/users/jgresham/orgs",
      "repos_url": "https://api.github.com/users/jgresham/repos",
      "events_url": "https://api.github.com/users/jgresham/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jgresham/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-04T03:20:05Z",
    "updated_at": "2022-02-04T03:20:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "I was \"OOO\" this past week and haven't gotten further. \r\n\r\nI'll start digging around tomorrow and see what I can learn about the integration tests. That being said I don't know what all this takes and idk where the SDK is at, so don't feel like you're stepping on toes if you take it over :)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1029601021/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1030409132",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2055#issuecomment-1030409132",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055",
    "id": 1030409132,
    "node_id": "IC_kwDODjvEJM49asus",
    "user": {
      "login": "jgresham",
      "id": 3721291,
      "node_id": "MDQ6VXNlcjM3MjEyOTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3721291?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jgresham",
      "html_url": "https://github.com/jgresham",
      "followers_url": "https://api.github.com/users/jgresham/followers",
      "following_url": "https://api.github.com/users/jgresham/following{/other_user}",
      "gists_url": "https://api.github.com/users/jgresham/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jgresham/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jgresham/subscriptions",
      "organizations_url": "https://api.github.com/users/jgresham/orgs",
      "repos_url": "https://api.github.com/users/jgresham/repos",
      "events_url": "https://api.github.com/users/jgresham/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jgresham/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-04T22:45:13Z",
    "updated_at": "2022-02-04T22:57:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "I tried for this today. Commit on my fork [here](https://github.com/jgresham/optimism/commit/4a9461052a667136a8b7d3a577e53819acae3df7). About 5 tests in native-eth.spec.ts are failing on gas fee calculations.\r\n\r\nCouple questions @smartcontracts : \r\n1. Any quick guidance on how to calculate gas fees would be helpful. I see the [MessageReceipt](https://github.com/ethereum-optimism/optimism/blob/eb926e2f90b5eec4558f3c82746b639b19ddf9d5/packages/sdk/src/interfaces/types.ts#L198) returned from [CrossChainProvider.waitForMessageReceipt](https://github.com/ethereum-optimism/optimism/blob/eb926e2f90b5eec4558f3c82746b639b19ddf9d5/packages/sdk/src/cross-chain-provider.ts#L399) contains [TransactionReceipt](https://docs.ethers.io/v5/api/providers/types/#providers-TransactionReceipt) with numerous properties that could be used to calculate gas fees but I also see additional (`l1GasPrice`, `l1GasUsed`, `l1Fee`). I didn't see `effectiveGasPrice` set on deposit messages, but saw it set on withdraws.\r\n2. Do you want to keep `env.waitForXDomainTransaction` [(my implementation)](https://github.com/jgresham/optimism/commit/4a9461052a667136a8b7d3a577e53819acae3df7#diff-ddcad9599e1f38130f84505d2605b25aa8b5ef273c02d7244fa2162481c06ba8R149) as far as I can tell it would now just be a single line `return this.messenger.waitForMessageReceipt(tx)`?\r\nI can create a WIP PR, if you'd like to see it.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1030409132/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1031891863",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2055#issuecomment-1031891863",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055",
    "id": 1031891863,
    "node_id": "IC_kwDODjvEJM49gWuX",
    "user": {
      "login": "jgresham",
      "id": 3721291,
      "node_id": "MDQ6VXNlcjM3MjEyOTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3721291?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jgresham",
      "html_url": "https://github.com/jgresham",
      "followers_url": "https://api.github.com/users/jgresham/followers",
      "following_url": "https://api.github.com/users/jgresham/following{/other_user}",
      "gists_url": "https://api.github.com/users/jgresham/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jgresham/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jgresham/subscriptions",
      "organizations_url": "https://api.github.com/users/jgresham/orgs",
      "repos_url": "https://api.github.com/users/jgresham/repos",
      "events_url": "https://api.github.com/users/jgresham/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jgresham/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-07T20:31:00Z",
    "updated_at": "2022-02-07T20:31:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'll use this commit as a reference for making additional changes https://github.com/ethereum-optimism/optimism/commit/3535fb2f79e54c4e1e4af7fa7ddefe78c385ccba",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1031891863/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1031960777",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2055#issuecomment-1031960777",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055",
    "id": 1031960777,
    "node_id": "IC_kwDODjvEJM49gnjJ",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-07T21:44:25Z",
    "updated_at": "2022-02-07T21:46:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I'll use this commit as a reference for making additional changes [3535fb2](https://github.com/ethereum-optimism/optimism/commit/3535fb2f79e54c4e1e4af7fa7ddefe78c385ccba)\r\n\r\n@jgresham I think the best way to handle this is by slightly modifying `waitForXDomainTransaction` to use the CrossChainMessenger for now, see this commit: https://github.com/ethereum-optimism/optimism/pull/2160/commits/dac55f31194c8bc27ebb66a301c47094feeabaf2#diff-fb18fb2767f25c27f31de34f54e12e87ae6a0fb294bc0d8cbcca9f7b92420882R20\r\n\r\nDoing this allows you to only slightly modify those other tests without worrying about the gas issues: https://github.com/ethereum-optimism/optimism/commit/dac55f31194c8bc27ebb66a301c47094feeabaf2#diff-ddcad9599e1f38130f84505d2605b25aa8b5ef273c02d7244fa2162481c06ba8R156\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1031960777/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1031961041",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2055#issuecomment-1031961041",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055",
    "id": 1031961041,
    "node_id": "IC_kwDODjvEJM49gnnR",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-07T21:44:42Z",
    "updated_at": "2022-02-07T21:44:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "And then we can get rid of `waitForXDomainTransaction` in the future",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1031961041/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1031972530",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2055#issuecomment-1031972530",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055",
    "id": 1031972530,
    "node_id": "IC_kwDODjvEJM49gqay",
    "user": {
      "login": "jgresham",
      "id": 3721291,
      "node_id": "MDQ6VXNlcjM3MjEyOTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3721291?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jgresham",
      "html_url": "https://github.com/jgresham",
      "followers_url": "https://api.github.com/users/jgresham/followers",
      "following_url": "https://api.github.com/users/jgresham/following{/other_user}",
      "gists_url": "https://api.github.com/users/jgresham/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jgresham/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jgresham/subscriptions",
      "organizations_url": "https://api.github.com/users/jgresham/orgs",
      "repos_url": "https://api.github.com/users/jgresham/repos",
      "events_url": "https://api.github.com/users/jgresham/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jgresham/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-07T21:57:38Z",
    "updated_at": "2022-02-07T21:57:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "> @jgresham I think the best way to handle this is by slightly modifying `waitForXDomainTransaction` to use the CrossChainMessenger for now, see this commit: [dac55f3#diff-fb18fb2767f25c27f31de34f54e12e87ae6a0fb294bc0d8cbcca9f7b92420882R20](https://github.com/ethereum-optimism/optimism/commit/dac55f31194c8bc27ebb66a301c47094feeabaf2#diff-fb18fb2767f25c27f31de34f54e12e87ae6a0fb294bc0d8cbcca9f7b92420882R20)\r\n> \r\n> Doing this allows you to only slightly modify those other tests without worrying about the gas issues: [dac55f3#diff-ddcad9599e1f38130f84505d2605b25aa8b5ef273c02d7244fa2162481c06ba8R156](https://github.com/ethereum-optimism/optimism/commit/dac55f31194c8bc27ebb66a301c47094feeabaf2#diff-ddcad9599e1f38130f84505d2605b25aa8b5ef273c02d7244fa2162481c06ba8R156)\r\n\r\nLooks like I was missing quite a bit here... will take a closer look",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1031972530/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1031973729",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2055#issuecomment-1031973729",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055",
    "id": 1031973729,
    "node_id": "IC_kwDODjvEJM49gqth",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-07T21:59:16Z",
    "updated_at": "2022-02-07T21:59:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "I've also closed my other PR to give you a chance to tackle this!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1031973729/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1033909418",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2055#issuecomment-1033909418",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2055",
    "id": 1033909418,
    "node_id": "IC_kwDODjvEJM49oDSq",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-09T15:52:05Z",
    "updated_at": "2022-02-09T15:52:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "Amazing work here @jgresham! Not sure if you've already emailed me, but hit me up at [kelvin AT optimism DOT io] if you'd like a hand-drawn contributor NFT :-)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1033909418/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
