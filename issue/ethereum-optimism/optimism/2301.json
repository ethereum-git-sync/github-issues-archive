{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2301",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2301/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2301/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2301/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/2301",
  "id": 1164482010,
  "node_id": "I_kwDODjvEJM5FaJXa",
  "number": 2301,
  "title": "Have BaseServiceV2 add spaces to environment variable names",
  "user": {
    "login": "smartcontracts",
    "id": 14298799,
    "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
    "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/smartcontracts",
    "html_url": "https://github.com/smartcontracts",
    "followers_url": "https://api.github.com/users/smartcontracts/followers",
    "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
    "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
    "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
    "repos_url": "https://api.github.com/users/smartcontracts/repos",
    "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
    "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2907832518,
      "node_id": "MDU6TGFiZWwyOTA3ODMyNTE4",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/C-enhancement",
      "name": "C-enhancement",
      "color": "C5DEF5",
      "default": false,
      "description": "Category: A PR with an enhancement or bugfix."
    },
    {
      "id": 3912170241,
      "node_id": "LA_kwDODjvEJM7pLvsB",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/M-common-ts",
      "name": "M-common-ts",
      "color": "FBCA04",
      "default": false,
      "description": "Module: common-ts"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-03-09T21:55:30Z",
  "updated_at": "2022-03-10T23:23:58Z",
  "closed_at": "2022-03-10T23:23:58Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Currently, `BaseServiceV2` automatically generates environment variables based on the following piece of code:\r\n\r\nhttps://github.com/ethereum-optimism/optimism/blob/779709f275e8f69bba9941042d91affce4c71d4c/packages/common-ts/src/base-service/base-service-v2.ts#L114-L120\r\n\r\nNotice that the name of the variable ends with `optionName.toUpperCase()`. This creates a situation where environment variables look like:\r\n\r\n```\r\nMY_SERVICE_NAME__MYVARIABLENAME\r\n```\r\n\r\nHowever, we prefer to have variables like:\r\n\r\n```\r\nMY_SERVICE_NAME__MY_VARIABLE_NAME\r\n```\r\n\r\nI think the correct way to handle this is to turn the variable name into snake case, then make it upper case. There might be some issues later with the piece of code where we actually load these environment variables. If that does end up being a problem, we'll figure it out when we run into it:\r\n\r\nhttps://github.com/ethereum-optimism/optimism/blob/779709f275e8f69bba9941042d91affce4c71d4c/packages/common-ts/src/base-service/base-service-v2.ts#L152-L155\r\n\r\nOnce this is done, you will also have to update some places where the old variable style is used, for instance:\r\n\r\nhttps://github.com/ethereum-optimism/optimism/blob/779709f275e8f69bba9941042d91affce4c71d4c/ops/docker-compose.yml#L139-L141\r\n\r\nAnd:\r\n\r\nhttps://github.com/ethereum-optimism/optimism/blob/779709f275e8f69bba9941042d91affce4c71d4c/packages/message-relayer/.env.example#L1-L12\r\n\r\nThe only two services that use `BaseServiceV2` are the message-relayer and the replica-healthcheck. You should be able to find all places where the old environment variable style is used by searching for `MESSAGE_RELAYER` and `REPLICA_HEALTHCHECK` in the codebase.",
  "closed_by": {
    "login": "mslipper",
    "id": 67953,
    "node_id": "MDQ6VXNlcjY3OTUz",
    "avatar_url": "https://avatars.githubusercontent.com/u/67953?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mslipper",
    "html_url": "https://github.com/mslipper",
    "followers_url": "https://api.github.com/users/mslipper/followers",
    "following_url": "https://api.github.com/users/mslipper/following{/other_user}",
    "gists_url": "https://api.github.com/users/mslipper/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mslipper/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mslipper/subscriptions",
    "organizations_url": "https://api.github.com/users/mslipper/orgs",
    "repos_url": "https://api.github.com/users/mslipper/repos",
    "events_url": "https://api.github.com/users/mslipper/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mslipper/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2301/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2301/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1063414700",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2301#issuecomment-1063414700",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2301",
    "id": 1063414700,
    "node_id": "IC_kwDODjvEJM4_Ymus",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-09T21:59:05Z",
    "updated_at": "2022-03-09T21:59:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "@tonykogias is going to take a shot at this issue",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1063414700/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
