{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4792",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4792/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4792/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4792/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/4792",
  "id": 1557844594,
  "node_id": "I_kwDODjvEJM5c2tJy",
  "number": 4792,
  "title": "Current Optimism L2 devnet setup only supports up to 20 TPS",
  "user": {
    "login": "crypto-matto",
    "id": 74586409,
    "node_id": "MDQ6VXNlcjc0NTg2NDA5",
    "avatar_url": "https://avatars.githubusercontent.com/u/74586409?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/crypto-matto",
    "html_url": "https://github.com/crypto-matto",
    "followers_url": "https://api.github.com/users/crypto-matto/followers",
    "following_url": "https://api.github.com/users/crypto-matto/following{/other_user}",
    "gists_url": "https://api.github.com/users/crypto-matto/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/crypto-matto/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/crypto-matto/subscriptions",
    "organizations_url": "https://api.github.com/users/crypto-matto/orgs",
    "repos_url": "https://api.github.com/users/crypto-matto/repos",
    "events_url": "https://api.github.com/users/crypto-matto/events{/privacy}",
    "received_events_url": "https://api.github.com/users/crypto-matto/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-01-26T09:31:41Z",
  "updated_at": "2023-01-27T03:59:45Z",
  "closed_at": "2023-01-27T03:59:44Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "**Is your feature request related to a problem? Please describe.**\r\nHi dev team,\r\n\r\nI’ve setup 1 node for L1 and 1 node for L2 on 2 separate machines. I'm benchmarking the nodes by blasting a range of TPS to see their behaviors. I found some unexpected behaviors and would like to ask for advices. 🙌 \r\n\r\n```\r\nSpec of the node running L1:\r\nCPU: 8 core (ARM64)\r\nRAM memory: 6GM\r\nStorage: 80GB\r\n\r\nSpec of the node running L2:\r\nCPU: 4 core (x64)\r\nRAM memory: 6GM\r\nStorage: 80GB\r\n\r\nConfigs:\r\nGasLimit: 1000000\r\nGasPrice: 5000000000000\r\n```\r\n\r\n### Findings\r\n- L2 TPS is around 20 TPS only, while L1 TPS tolerance can go as high as 27 TPS. \r\n- Each CPU core usage under tx blasting are within 50% until TPS above certain level. RAM Memory usage seems not a big deal as its usage is pretty much same as when the node is in idle. Therefore, we're thinking whether the CPU is the main hardware bottleneck or not. \r\n- Above its highest TPS it could sustain (27TPS on L1, 20TPS on L2), let’s say I tried with blasting with a 50 TPS, L1 becomes unresponsive to most of the broadcasted transactions. The result drops to single digit, like less than 5 TPS. L2 may still sustain a 10+ TPS under similar circumstances.\r\n\r\n### Things we’d like to know\r\n- Am I using a proper `GasLimit` & `GasPrice`? What would you suggest to facilitate with L2 Optimism?\r\n- Is it normal & why is there a significant drop in TPS under high traffic?\r\n\r\nThanks.\r\n\r\n**Describe the solution you'd like**\r\nLooking for advices to increase the L2 TPS tolerance, e.g. 500+ TPS. Any optimizations ranging from Hardware, config setup, deployment environment, etc. \r\n\r\n**Describe alternatives you've considered**\r\nA clear and concise description of any alternative solutions or features you've considered.\r\n\r\n**Additional context**\r\nAdd any other context or screenshots about the feature request here.\r\n",
  "closed_by": {
    "login": "tynes",
    "id": 6626818,
    "node_id": "MDQ6VXNlcjY2MjY4MTg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6626818?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tynes",
    "html_url": "https://github.com/tynes",
    "followers_url": "https://api.github.com/users/tynes/followers",
    "following_url": "https://api.github.com/users/tynes/following{/other_user}",
    "gists_url": "https://api.github.com/users/tynes/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tynes/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tynes/subscriptions",
    "organizations_url": "https://api.github.com/users/tynes/orgs",
    "repos_url": "https://api.github.com/users/tynes/repos",
    "events_url": "https://api.github.com/users/tynes/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tynes/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4792/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4792/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1405376692",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4792#issuecomment-1405376692",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4792",
    "id": 1405376692,
    "node_id": "IC_kwDODjvEJM5TxFi0",
    "user": {
      "login": "tynes",
      "id": 6626818,
      "node_id": "MDQ6VXNlcjY2MjY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6626818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tynes",
      "html_url": "https://github.com/tynes",
      "followers_url": "https://api.github.com/users/tynes/followers",
      "following_url": "https://api.github.com/users/tynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/tynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tynes/subscriptions",
      "organizations_url": "https://api.github.com/users/tynes/orgs",
      "repos_url": "https://api.github.com/users/tynes/repos",
      "events_url": "https://api.github.com/users/tynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-26T17:51:03Z",
    "updated_at": "2023-01-26T17:51:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "Its not very meaningful to benchmark something without making it reproducible. Are you running bedrock or legacy? Are you using the legacy `ops` setup that uses hardhat as the L1? Also you shouldn't benchmark in TPS because not all transactions are created equally, you should benchmark in gas per second.\r\n\r\nIf you'd like to contribute to the Optimism Collective, please start a thread at https://gov.optimism.io/",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1405376692/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1405984323",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4792#issuecomment-1405984323",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4792",
    "id": 1405984323,
    "node_id": "IC_kwDODjvEJM5TzZ5D",
    "user": {
      "login": "crypto-matto",
      "id": 74586409,
      "node_id": "MDQ6VXNlcjc0NTg2NDA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/74586409?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/crypto-matto",
      "html_url": "https://github.com/crypto-matto",
      "followers_url": "https://api.github.com/users/crypto-matto/followers",
      "following_url": "https://api.github.com/users/crypto-matto/following{/other_user}",
      "gists_url": "https://api.github.com/users/crypto-matto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/crypto-matto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/crypto-matto/subscriptions",
      "organizations_url": "https://api.github.com/users/crypto-matto/orgs",
      "repos_url": "https://api.github.com/users/crypto-matto/repos",
      "events_url": "https://api.github.com/users/crypto-matto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/crypto-matto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-27T03:55:41Z",
    "updated_at": "2023-01-27T03:58:29Z",
    "author_association": "NONE",
    "body": "Hi @tynes ,\r\n> Are you running bedrock or legacy? \r\n\r\nYes I'm using legacy. I revise the original `ops` setup, breaks the original `docker-compose.yml` down into 2 so that I may deploy on 2 separate machines: \r\n`docker-compose-l1.yml`: L1 & indexing services\r\n`docker-compose-l2.yml`: L2 & all other services\r\n\r\n> Are you using the legacy ops setup that uses hardhat as the L1?\r\nThe L1 isn't running on hardhat, as I use my own image, which is running a real EVM client.\r\n\r\n> Also you shouldn't benchmark in TPS because not all transactions are created equally, you should benchmark in gas per second\r\n\r\nThat is a new point to me 👍🏻 I tried to blast a bunch of identical transfer transactions with the same `value`, `gasPrice` & `gasLimit`. I will see how the gas behavior is like actually. So do you know what is the maximum gas per second an Optimism network can handle, in theory? \r\n\r\n> If you'd like to contribute to the Optimism Collective, please start a thread at https://gov.optimism.io/\r\n\r\nI'll check it out. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1405984323/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1405986144",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4792#issuecomment-1405986144",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4792",
    "id": 1405986144,
    "node_id": "IC_kwDODjvEJM5TzaVg",
    "user": {
      "login": "tynes",
      "id": 6626818,
      "node_id": "MDQ6VXNlcjY2MjY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6626818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tynes",
      "html_url": "https://github.com/tynes",
      "followers_url": "https://api.github.com/users/tynes/followers",
      "following_url": "https://api.github.com/users/tynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/tynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tynes/subscriptions",
      "organizations_url": "https://api.github.com/users/tynes/orgs",
      "repos_url": "https://api.github.com/users/tynes/repos",
      "events_url": "https://api.github.com/users/tynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-27T03:59:44Z",
    "updated_at": "2023-01-27T03:59:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "I recommend using `ops-bedrock` over `ops`\r\n\r\nReopen if you have any issues",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1405986144/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
