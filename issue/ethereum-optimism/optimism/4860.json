{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4860",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4860/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4860/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4860/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/4860",
  "id": 1581327255,
  "node_id": "I_kwDODjvEJM5eQSOX",
  "number": 4860,
  "title": "SDK does not support Ethers.js providers that do not extend JsonRpcProvider",
  "user": {
    "login": "raymondfeng",
    "id": 540892,
    "node_id": "MDQ6VXNlcjU0MDg5Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/540892?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/raymondfeng",
    "html_url": "https://github.com/raymondfeng",
    "followers_url": "https://api.github.com/users/raymondfeng/followers",
    "following_url": "https://api.github.com/users/raymondfeng/following{/other_user}",
    "gists_url": "https://api.github.com/users/raymondfeng/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/raymondfeng/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/raymondfeng/subscriptions",
    "organizations_url": "https://api.github.com/users/raymondfeng/orgs",
    "repos_url": "https://api.github.com/users/raymondfeng/repos",
    "events_url": "https://api.github.com/users/raymondfeng/events{/privacy}",
    "received_events_url": "https://api.github.com/users/raymondfeng/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2907832490,
      "node_id": "MDU6TGFiZWwyOTA3ODMyNDkw",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/C-bug",
      "name": "C-bug",
      "color": "C5DEF5",
      "default": false,
      "description": "Category: This is a bug."
    },
    {
      "id": 2981541772,
      "node_id": "MDU6TGFiZWwyOTgxNTQxNzcy",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/P-confirmed",
      "name": "P-confirmed",
      "color": "BFD4F2",
      "default": false,
      "description": "A confirmed bug"
    },
    {
      "id": 3662935689,
      "node_id": "LA_kwDODjvEJM7aU_aJ",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/M-sdk",
      "name": "M-sdk",
      "color": "FBCA04",
      "default": false,
      "description": "Module: sdk"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "roninjin10",
    "id": 35039927,
    "node_id": "MDQ6VXNlcjM1MDM5OTI3",
    "avatar_url": "https://avatars.githubusercontent.com/u/35039927?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/roninjin10",
    "html_url": "https://github.com/roninjin10",
    "followers_url": "https://api.github.com/users/roninjin10/followers",
    "following_url": "https://api.github.com/users/roninjin10/following{/other_user}",
    "gists_url": "https://api.github.com/users/roninjin10/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/roninjin10/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/roninjin10/subscriptions",
    "organizations_url": "https://api.github.com/users/roninjin10/orgs",
    "repos_url": "https://api.github.com/users/roninjin10/repos",
    "events_url": "https://api.github.com/users/roninjin10/events{/privacy}",
    "received_events_url": "https://api.github.com/users/roninjin10/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "roninjin10",
      "id": 35039927,
      "node_id": "MDQ6VXNlcjM1MDM5OTI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/35039927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/roninjin10",
      "html_url": "https://github.com/roninjin10",
      "followers_url": "https://api.github.com/users/roninjin10/followers",
      "following_url": "https://api.github.com/users/roninjin10/following{/other_user}",
      "gists_url": "https://api.github.com/users/roninjin10/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/roninjin10/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/roninjin10/subscriptions",
      "organizations_url": "https://api.github.com/users/roninjin10/orgs",
      "repos_url": "https://api.github.com/users/roninjin10/repos",
      "events_url": "https://api.github.com/users/roninjin10/events{/privacy}",
      "received_events_url": "https://api.github.com/users/roninjin10/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-02-12T16:48:50Z",
  "updated_at": "2023-02-15T17:31:16Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!--\r\nNeed help?\r\nRefer to our contributing guidelines for additional information about making a good issue:\r\nhttps://github.com/ethereum-optimism/.github/blob/master/CONTRIBUTING.md\r\n-->\r\n\r\n**Describe the bug**\r\n\r\nThe [CrossChainMessenger constructor](https://github.com/ethereum-optimism/optimism/blob/develop/packages/sdk/src/cross-chain-messenger.ts#L135) accepts L1/L2 providers but some of the methods [blindly cast them to `JsonRpcProvider`](https://github.com/ethereum-optimism/optimism/blob/develop/packages/sdk/src/cross-chain-messenger.ts#L1359\r\n) to call `send()`. As a result, it throws an error saying `provider.send` is not a function.\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Create an instance of CrossChainMessenger with FallbackProvider from Ethers.js\r\n2. Call `withdrawERC20()`\r\n\r\n**Expected behavior**\r\nEthers.js providers that implements `providers.Provider` interface should be supported.\r\n\r\n**Screenshots**\r\nN/A\r\n\r\n**System Specs:**\r\n - OS: MacOS\r\n - Package Version (or commit hash): \"@eth-optimism/sdk\": \"^1.10.1\"\r\n\r\n**Additional context**\r\nWe're testing Optimism ERC20 token deposit from L1 to L2 and withdraw from L2 back to L1.\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4860/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4860/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1427107162",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4860#issuecomment-1427107162",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4860",
    "id": 1427107162,
    "node_id": "IC_kwDODjvEJM5VD-1a",
    "user": {
      "login": "roninjin10",
      "id": 35039927,
      "node_id": "MDQ6VXNlcjM1MDM5OTI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/35039927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/roninjin10",
      "html_url": "https://github.com/roninjin10",
      "followers_url": "https://api.github.com/users/roninjin10/followers",
      "following_url": "https://api.github.com/users/roninjin10/following{/other_user}",
      "gists_url": "https://api.github.com/users/roninjin10/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/roninjin10/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/roninjin10/subscriptions",
      "organizations_url": "https://api.github.com/users/roninjin10/orgs",
      "repos_url": "https://api.github.com/users/roninjin10/repos",
      "events_url": "https://api.github.com/users/roninjin10/events{/privacy}",
      "received_events_url": "https://api.github.com/users/roninjin10/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-12T18:59:28Z",
    "updated_at": "2023-02-12T18:59:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "@smartcontracts and I had ran into this before but haven't had the bandwith yet to fix the issue.   The workaround we did was to use a JSONRPC provider for only withdrawals.\r\n\r\nfwiw it's bad design that ethers.js have these niche incompatibilities between their providers.  All providers should inherit from JsonRpcProviders.  I'm hoping they fixed this in v6.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1427107162/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
