{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/5118",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/5118/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/5118/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/5118/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/5118",
  "id": 1621076710,
  "node_id": "I_kwDODjvEJM5gn6rm",
  "number": 5118,
  "title": "devnet does not initialize the liquidity pool of OptimismPortal",
  "user": {
    "login": "brew0722",
    "id": 70933233,
    "node_id": "MDQ6VXNlcjcwOTMzMjMz",
    "avatar_url": "https://avatars.githubusercontent.com/u/70933233?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/brew0722",
    "html_url": "https://github.com/brew0722",
    "followers_url": "https://api.github.com/users/brew0722/followers",
    "following_url": "https://api.github.com/users/brew0722/following{/other_user}",
    "gists_url": "https://api.github.com/users/brew0722/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/brew0722/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/brew0722/subscriptions",
    "organizations_url": "https://api.github.com/users/brew0722/orgs",
    "repos_url": "https://api.github.com/users/brew0722/repos",
    "events_url": "https://api.github.com/users/brew0722/events{/privacy}",
    "received_events_url": "https://api.github.com/users/brew0722/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-03-13T09:30:34Z",
  "updated_at": "2023-05-11T11:11:10Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!--\r\nNeed help?\r\nRefer to our contributing guidelines for additional information about making a good issue:\r\nhttps://github.com/ethereum-optimism/.github/blob/master/CONTRIBUTING.md\r\n-->\r\n\r\n**Is your feature request related to a problem? Please describe.**\r\nThis is not a bug report.\r\n\r\nHowever, it seems to be a bit of a headache for beginners trying to understand the Optimism structure based on `devnet`.\r\nDuring devnet's initialization, it doesn't initialize a sufficient liquidity pool for the `OptimismPortal`, causing `withdraw` to fail when running the bridge tutorials provided [here](https://github.com/ethereum-optimism/optimism-tutorial/tree/main/cross-dom-bridge-eth).\r\n\r\nMore little detail, If the liquidity pool of `OptimismPortal` is insufficient, the process of making a payable call to `relayMessage` of `L1CrossDomainMessenger` will fail.\r\nHowever, `OptimismPortal` uses `safecall` to ignore the revert and raise an event, making it very difficult to determine the cause of the failure.\r\n\r\nPlease consider initializing the liquidity pool from devnet though.\r\nhttps://github.com/ethereum-optimism/optimism/blob/35d4a37c2b9a59e9bf16fa4c5e22283f2348c3d2/packages/contracts-bedrock/contracts/L1/OptimismPortal.sol#L373\r\n\r\n\r\n \r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/5118/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/5118/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1466580600",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/5118#issuecomment-1466580600",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/5118",
    "id": 1466580600,
    "node_id": "IC_kwDODjvEJM5Xaj54",
    "user": {
      "login": "tynes",
      "id": 6626818,
      "node_id": "MDQ6VXNlcjY2MjY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6626818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tynes",
      "html_url": "https://github.com/tynes",
      "followers_url": "https://api.github.com/users/tynes/followers",
      "following_url": "https://api.github.com/users/tynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/tynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tynes/subscriptions",
      "organizations_url": "https://api.github.com/users/tynes/orgs",
      "repos_url": "https://api.github.com/users/tynes/repos",
      "events_url": "https://api.github.com/users/tynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-13T17:22:21Z",
    "updated_at": "2023-03-13T17:22:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "You should do some deposits to put eth in the portal",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1466580600/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1467333141",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/5118#issuecomment-1467333141",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/5118",
    "id": 1467333141,
    "node_id": "IC_kwDODjvEJM5XdboV",
    "user": {
      "login": "brew0722",
      "id": 70933233,
      "node_id": "MDQ6VXNlcjcwOTMzMjMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/70933233?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brew0722",
      "html_url": "https://github.com/brew0722",
      "followers_url": "https://api.github.com/users/brew0722/followers",
      "following_url": "https://api.github.com/users/brew0722/following{/other_user}",
      "gists_url": "https://api.github.com/users/brew0722/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brew0722/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brew0722/subscriptions",
      "organizations_url": "https://api.github.com/users/brew0722/orgs",
      "repos_url": "https://api.github.com/users/brew0722/repos",
      "events_url": "https://api.github.com/users/brew0722/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brew0722/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-14T04:18:53Z",
    "updated_at": "2023-03-14T05:11:46Z",
    "author_association": "NONE",
    "body": "Yes, but in the example provided in the tutorial, deposits are smaller than withdrawals.\r\nhttps://github.com/ethereum-optimism/optimism-tutorial/blob/d4f521ce1cc806c0820eaee9f8b8f3984faffb66/cross-dom-bridge-eth/index.js#L72\r\nhttps://github.com/ethereum-optimism/optimism-tutorial/blob/d4f521ce1cc806c0820eaee9f8b8f3984faffb66/cross-dom-bridge-eth/index.js#L94\r\n\r\nHowever, the test account used as an example sets a very large L1/L2 balance at devnet initialization.\r\nhttps://github.com/ethereum-optimism/optimism-tutorial/blob/d4f521ce1cc806c0820eaee9f8b8f3984faffb66/cross-dom-bridge-eth/.env.example#L2\r\nhttps://github.com/ethereum-optimism/optimism/blob/e251dac402c190c78b37c5d1d9f8313803aecb68/op-chain-ops/genesis/layer_two.go#L21\r\n\r\nSo it should be able to run even if the deposits are smaller than the withdrawals in the first place.\r\n\r\nIf don't have any balances on devnet L2, we're going to be bridging from L1 anyway, so it makes sense. \r\nHowever, This behavior is caused by the fact that devnet is also funding the test account on L2, but not the bridge pool.\r\nSo, I think pre-populating a liquidity pool in OptimismPortal at devnet initialization would reduce the mistake for newbies to get lost.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1467333141/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1543800331",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/5118#issuecomment-1543800331",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/5118",
    "id": 1543800331,
    "node_id": "IC_kwDODjvEJM5cBIYL",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-11T11:11:10Z",
    "updated_at": "2023-05-11T11:11:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yeah this could be useful for a devnet environment. More reflective of the \"real\" environment where the pool already has liquidity in it. But could also be confusing at the same time. Not super opinionated. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1543800331/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
