{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/708",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/708/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/708/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/708/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/708",
  "id": 871758287,
  "node_id": "MDU6SXNzdWU4NzE3NTgyODc=",
  "number": 708,
  "title": "Add script which deploys our contract to L1 & L2 as needed using ChugSplash",
  "user": {
    "login": "karlfloersch",
    "id": 706123,
    "node_id": "MDQ6VXNlcjcwNjEyMw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/706123?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/karlfloersch",
    "html_url": "https://github.com/karlfloersch",
    "followers_url": "https://api.github.com/users/karlfloersch/followers",
    "following_url": "https://api.github.com/users/karlfloersch/following{/other_user}",
    "gists_url": "https://api.github.com/users/karlfloersch/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/karlfloersch/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/karlfloersch/subscriptions",
    "organizations_url": "https://api.github.com/users/karlfloersch/orgs",
    "repos_url": "https://api.github.com/users/karlfloersch/repos",
    "events_url": "https://api.github.com/users/karlfloersch/events{/privacy}",
    "received_events_url": "https://api.github.com/users/karlfloersch/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2907832555,
      "node_id": "MDU6TGFiZWwyOTA3ODMyNTU1",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/C-feature-request",
      "name": "C-feature-request",
      "color": "C5DEF5",
      "default": false,
      "description": "Category: A feature request."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "annieke",
    "id": 15117059,
    "node_id": "MDQ6VXNlcjE1MTE3MDU5",
    "avatar_url": "https://avatars.githubusercontent.com/u/15117059?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/annieke",
    "html_url": "https://github.com/annieke",
    "followers_url": "https://api.github.com/users/annieke/followers",
    "following_url": "https://api.github.com/users/annieke/following{/other_user}",
    "gists_url": "https://api.github.com/users/annieke/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/annieke/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/annieke/subscriptions",
    "organizations_url": "https://api.github.com/users/annieke/orgs",
    "repos_url": "https://api.github.com/users/annieke/repos",
    "events_url": "https://api.github.com/users/annieke/events{/privacy}",
    "received_events_url": "https://api.github.com/users/annieke/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "annieke",
      "id": 15117059,
      "node_id": "MDQ6VXNlcjE1MTE3MDU5",
      "avatar_url": "https://avatars.githubusercontent.com/u/15117059?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/annieke",
      "html_url": "https://github.com/annieke",
      "followers_url": "https://api.github.com/users/annieke/followers",
      "following_url": "https://api.github.com/users/annieke/following{/other_user}",
      "gists_url": "https://api.github.com/users/annieke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/annieke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/annieke/subscriptions",
      "organizations_url": "https://api.github.com/users/annieke/orgs",
      "repos_url": "https://api.github.com/users/annieke/repos",
      "events_url": "https://api.github.com/users/annieke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/annieke/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2021-04-30T01:15:21Z",
  "updated_at": "2021-12-21T19:33:22Z",
  "closed_at": "2021-12-21T19:33:22Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "<!--\r\nNeed help?\r\nRefer to our contributing guidelines for additional information about making a good issue:\r\nhttps://github.com/ethereum-optimism/.github/blob/master/CONTRIBUTING.md\r\n-->\r\n\r\n**Is your feature request related to a problem? Please describe.**\r\nWith all of this chugsplash infrastructure, we need a script to actually automate a deployment. Additionally this script must be used in our CI in place of the current `deployer`.\r\n\r\n**Describe the solution you'd like**\r\nCreate a script which, using the smart contract work & off-chain scripts that were developed in: https://github.com/ethereum-optimism/optimism/issues/696 https://github.com/ethereum-optimism/optimism/issues/697 https://github.com/ethereum-optimism/optimism/issues/703 https://github.com/ethereum-optimism/optimism/issues/706 and https://github.com/ethereum-optimism/optimism/issues/707 performs a full chugsplash deployment.\r\n\r\nAfter this has been implemented and tested in a 1-off environment, this should be hooked up to our CI and replace our current `deployer`! In order for this to be possible, we will need to:\r\n1. Remove constructors from our contracts as all environment variables will be set in the deployment step. Additionally, remove our address manager as it will no longer be used to resolve contract addresses.\r\n2. Write a chugsplash deploy template for L1 and L2 contracts.\r\n3. Update the env of our `deployer` image & make sure it is now using the new deployment mechanism by updating `yarn deploy`\r\n\r\nAll integration tests should still pass even though we are now using a new deployment mechanism!\r\n\r\n**Blockers**\r\nhttps://github.com/ethereum-optimism/optimism/issues/696 https://github.com/ethereum-optimism/optimism/issues/697 https://github.com/ethereum-optimism/optimism/issues/703 https://github.com/ethereum-optimism/optimism/issues/706 and https://github.com/ethereum-optimism/optimism/issues/707",
  "closed_by": {
    "login": "smartcontracts",
    "id": 14298799,
    "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
    "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/smartcontracts",
    "html_url": "https://github.com/smartcontracts",
    "followers_url": "https://api.github.com/users/smartcontracts/followers",
    "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
    "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
    "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
    "repos_url": "https://api.github.com/users/smartcontracts/repos",
    "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
    "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/708/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/708/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/832876037",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/708#issuecomment-832876037",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/708",
    "id": 832876037,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzMjg3NjAzNw==",
    "user": {
      "login": "annieke",
      "id": 15117059,
      "node_id": "MDQ6VXNlcjE1MTE3MDU5",
      "avatar_url": "https://avatars.githubusercontent.com/u/15117059?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/annieke",
      "html_url": "https://github.com/annieke",
      "followers_url": "https://api.github.com/users/annieke/followers",
      "following_url": "https://api.github.com/users/annieke/following{/other_user}",
      "gists_url": "https://api.github.com/users/annieke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/annieke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/annieke/subscriptions",
      "organizations_url": "https://api.github.com/users/annieke/orgs",
      "repos_url": "https://api.github.com/users/annieke/repos",
      "events_url": "https://api.github.com/users/annieke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/annieke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-05T17:31:02Z",
    "updated_at": "2021-05-05T17:31:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "## Most minimal \r\n- Take a json contract file and turn it into a series of inputs to a smart contract\r\n- A script/service which will making transactions and sending them to the chain\r\n- Open Qs: How do we want to handle errors? We can parallelize sending transactions that don't depend on each other (order of actions doesn't matter! yay)\r\n- Error cases: two clients trying to upgrade at the same time, avoid conflicts by randomizing the ordering and handling how clashing is still handled\r\n\r\n## Notes\r\n- deploy.ts (https://github.com/ethereum-optimism/optimism/blob/eef1df4d63fd1b483beda63293ea1746861c3e2a/packages/contracts/bin/deploy.ts) is for layer 1 but we want to get this for layer 2\r\n- we should get everything working on layer 2 first and then port back to layer 1, so this ticket should just be scoped to l2 for now\r\n- Next steps: thinking about the whole process of automating all of this; end goal is that we merge to master and all upgrades just happen (continuous contract deployment)\r\n\r\n### Background\r\n- 3 types of contracts on l2: systems (must haves, eg execution manager, state manager, etc), predeployed contracts (useful but not CRUCIAL, contract wallets, messaging contracts), user contracts \r\n- execution manager really only needs to live on l2 until fraud proof, which requires a copy on l1 to verify execution\r\n- l2 contracts based on what we need: to prove correctness of executions - we need l2 smart contracts to match what an l1 smart contract would have done; blurry line of what should be executed by the sequencer: maybe everything should be written in go\r\n\r\n### L1 contracts \r\n- ideally: execution manager doesn't exist on l1; current version only gets deployed when there's a fraud proof\r\n- ctc, scc, fraud verifier are the only technically necessary contracts for l1; x-domain messaging contracts COULD be deployed by someone else \r\n\r\n\r\n## Action items\r\n- get https://github.com/ethereum-optimism/optimism/pull/749 running locally and see if can add tests\r\n- also need https://github.com/ethereum-optimism/optimism/pull/755 before working\r\n- spec out what exactly we want with @smartcontracts ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/832876037/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/999040484",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/708#issuecomment-999040484",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/708",
    "id": 999040484,
    "node_id": "IC_kwDODjvEJM47jCXk",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-21T19:33:22Z",
    "updated_at": "2021-12-21T19:33:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "Closing this, we'll be reworking the ChugSplash project plan",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/999040484/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
