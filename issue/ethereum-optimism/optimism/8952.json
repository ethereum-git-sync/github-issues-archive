{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/8952",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/8952/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/8952/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/8952/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/8952",
  "id": 2075917837,
  "node_id": "I_kwDODjvEJM57u_4N",
  "number": 8952,
  "title": "sender address missing in sdk for deposit and withdrawal gas estimation",
  "user": {
    "login": "bb111189",
    "id": 4401980,
    "node_id": "MDQ6VXNlcjQ0MDE5ODA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4401980?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bb111189",
    "html_url": "https://github.com/bb111189",
    "followers_url": "https://api.github.com/users/bb111189/followers",
    "following_url": "https://api.github.com/users/bb111189/following{/other_user}",
    "gists_url": "https://api.github.com/users/bb111189/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bb111189/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bb111189/subscriptions",
    "organizations_url": "https://api.github.com/users/bb111189/orgs",
    "repos_url": "https://api.github.com/users/bb111189/repos",
    "events_url": "https://api.github.com/users/bb111189/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bb111189/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "smartcontracts",
    "id": 14298799,
    "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
    "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/smartcontracts",
    "html_url": "https://github.com/smartcontracts",
    "followers_url": "https://api.github.com/users/smartcontracts/followers",
    "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
    "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
    "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
    "repos_url": "https://api.github.com/users/smartcontracts/repos",
    "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
    "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2024-01-11T07:10:03Z",
  "updated_at": "2024-01-16T04:29:50Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!--\r\nNeed help?\r\nRefer to our contributing guidelines for additional information about making a good issue:\r\nhttps://github.com/ethereum-optimism/.github/blob/master/CONTRIBUTING.md\r\n-->\r\n\r\n**Describe the bug**\r\nA clear and concise description of what the bug is.\r\nhttps://github.com/ethereum-optimism/optimism/blob/034a993e4e3662a8a7625f0492fcf0b7b21d68e8/packages/sdk/src/cross-chain-messenger.ts#L2042\r\nGas estimation for deposit and withdrawal of ETH and ERC20 do not consider the sender's address. It uses default which is 0x0, which can cause wrong estimation or error. \r\n\r\nIn the case for OP Sepolia 0x0 address only has 1 wei. Hence, when trying to deposit any amount bigger than 1 wei from any EOA, gas estimation will fail with the following error\r\n`insufficient funds for gas * price + value: address 0x0000000000000000000000000000000000000000 have 1 want 10000000000000000 (supplied gas 30000000`\r\n\r\nThis is because gas estimation is trying to compute the gas cost of transferring 1 wei from 0x0 to recipient instead of the actual sender to recipient. \r\n\r\nFor deposit and withdrawal of ETH or ERC20, sender address should be used in the gas estimate. \r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. Go to '...'\r\n2. Click on '....'\r\n3. Scroll down to '....'\r\n4. See error\r\n\r\n1. Setup a OP Stack (L3) on top of OP Sepolia\r\n2. Try bridging operation using the sdk\r\n\r\n**Expected behavior**\r\nA clear and concise description of what you expected to happen.\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n**System Specs:**\r\n - OS:\r\n - Package Version (or commit hash): OP SDK version 3.1.2\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/8952/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/8952/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1889620624",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/8952#issuecomment-1889620624",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/8952",
    "id": 1889620624,
    "node_id": "IC_kwDODjvEJM5woVKQ",
    "user": {
      "login": "tynes",
      "id": 6626818,
      "node_id": "MDQ6VXNlcjY2MjY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6626818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tynes",
      "html_url": "https://github.com/tynes",
      "followers_url": "https://api.github.com/users/tynes/followers",
      "following_url": "https://api.github.com/users/tynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/tynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tynes/subscriptions",
      "organizations_url": "https://api.github.com/users/tynes/orgs",
      "repos_url": "https://api.github.com/users/tynes/repos",
      "events_url": "https://api.github.com/users/tynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2024-01-12T16:39:16Z",
    "updated_at": "2024-01-12T16:39:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "You should consider migrating to viem as the sdk is going to be phased out eventually. viem natively supports op stack chains",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1889620624/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1893054004",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/8952#issuecomment-1893054004",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/8952",
    "id": 1893054004,
    "node_id": "IC_kwDODjvEJM5w1bY0",
    "user": {
      "login": "bb111189",
      "id": 4401980,
      "node_id": "MDQ6VXNlcjQ0MDE5ODA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4401980?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bb111189",
      "html_url": "https://github.com/bb111189",
      "followers_url": "https://api.github.com/users/bb111189/followers",
      "following_url": "https://api.github.com/users/bb111189/following{/other_user}",
      "gists_url": "https://api.github.com/users/bb111189/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bb111189/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bb111189/subscriptions",
      "organizations_url": "https://api.github.com/users/bb111189/orgs",
      "repos_url": "https://api.github.com/users/bb111189/repos",
      "events_url": "https://api.github.com/users/bb111189/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bb111189/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2024-01-16T04:29:49Z",
    "updated_at": "2024-01-16T04:29:49Z",
    "author_association": "NONE",
    "body": "> You should consider migrating to viem as the sdk is going to be phased out eventually. viem natively supports op stack chains\r\n\r\nDo you have a rough timeline on when the SDK will be phased out? ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1893054004/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
