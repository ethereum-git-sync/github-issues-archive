{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/4754",
  "id": 1551340261,
  "node_id": "I_kwDODjvEJM5cd5Ll",
  "number": 4754,
  "title": "l2geth hangs indefinitely when restarting during initial sync",
  "user": {
    "login": "kaladinlight",
    "id": 35275952,
    "node_id": "MDQ6VXNlcjM1Mjc1OTUy",
    "avatar_url": "https://avatars.githubusercontent.com/u/35275952?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/kaladinlight",
    "html_url": "https://github.com/kaladinlight",
    "followers_url": "https://api.github.com/users/kaladinlight/followers",
    "following_url": "https://api.github.com/users/kaladinlight/following{/other_user}",
    "gists_url": "https://api.github.com/users/kaladinlight/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/kaladinlight/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/kaladinlight/subscriptions",
    "organizations_url": "https://api.github.com/users/kaladinlight/orgs",
    "repos_url": "https://api.github.com/users/kaladinlight/repos",
    "events_url": "https://api.github.com/users/kaladinlight/events{/privacy}",
    "received_events_url": "https://api.github.com/users/kaladinlight/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2907832490,
      "node_id": "MDU6TGFiZWwyOTA3ODMyNDkw",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/C-bug",
      "name": "C-bug",
      "color": "C5DEF5",
      "default": false,
      "description": "Category: This is a bug."
    },
    {
      "id": 2930018676,
      "node_id": "MDU6TGFiZWwyOTMwMDE4Njc2",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/P-unconfirmed",
      "name": "P-unconfirmed",
      "color": "BFD4F2",
      "default": false,
      "description": "Issue might be valid, but itâ€™s not yet confirmed"
    },
    {
      "id": 3357535896,
      "node_id": "MDU6TGFiZWwzMzU3NTM1ODk2",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/M-l2geth",
      "name": "M-l2geth",
      "color": "FBCA04",
      "default": false,
      "description": "Module: l2geth"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 14,
  "created_at": "2023-01-20T19:28:49Z",
  "updated_at": "2023-03-20T17:11:11Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!--\r\nNeed help?\r\nRefer to our contributing guidelines for additional information about making a good issue:\r\nhttps://github.com/ethereum-optimism/.github/blob/master/CONTRIBUTING.md\r\n-->\r\n\r\n**Describe the bug**\r\n\r\nI have been attempting to sync an archive l2geth node for a long time now and have been unsuccessful due to sync hanging on restart of the node.\r\n\r\n**To Reproduce**\r\nI don't have a way to reliably reproduce this case as it just seems to happen when shutdown doesn't store the correct state and/or startup doesn't handle recovering state accurately\r\n\r\n**Expected behavior**\r\nl2geth picks up and continues sync gracefully\r\n\r\n**Screenshots**\r\nIf applicable, add screenshots to help explain your problem.\r\n\r\n![image](https://user-images.githubusercontent.com/35275952/213787112-ee89c3ea-9e0f-42bf-be89-7021a85eadcb.png)\r\n![image](https://user-images.githubusercontent.com/35275952/213787181-244579fd-5b3e-4c4a-a017-daa3fbcda1f8.png)\r\n![image](https://user-images.githubusercontent.com/35275952/213788691-98d228cd-403f-440d-b6dc-617944db11ad.png)\r\n![image](https://user-images.githubusercontent.com/35275952/213788758-f99674b7-4a9a-4128-bea3-f566b30f7b3d.png)\r\n\r\n**System Specs:**\r\n - OS: alpine linux\r\n - Package Version (or commit hash): ethereumoptimism/l2geth:0.5.31\r\n\r\n**Additional context**\r\n\r\nMy thought is this has something to do with the fact that the block index was rolled back as described here:\r\n```\r\nINFO [01-20|16:48:30.706] Found latest index                       index=46973939\r\nINFO [01-20|16:48:30.709] Block not found, resetting index         new=46973938 old=46973939\r\nINFO [01-20|16:48:30.709] Found latest queue index                 queue-index=228857\r\nINFO [01-20|16:48:30.731] Found correct staring queue index        queue-index=228857\r\n````\r\nand there is the corresponding short circuit in the `resultLoop` pictured above that prevents the block from ever being written to chain and the worker `mainLoop` just hangs waiting to read from `chainHeadCh` indefinitely as shown by the lack of `Miner got new head` debug log.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1407629084",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4754#issuecomment-1407629084",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754",
    "id": 1407629084,
    "node_id": "IC_kwDODjvEJM5T5rcc",
    "user": {
      "login": "zhaoxiangjunupi",
      "id": 101166067,
      "node_id": "U_kgDOBger8w",
      "avatar_url": "https://avatars.githubusercontent.com/u/101166067?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zhaoxiangjunupi",
      "html_url": "https://github.com/zhaoxiangjunupi",
      "followers_url": "https://api.github.com/users/zhaoxiangjunupi/followers",
      "following_url": "https://api.github.com/users/zhaoxiangjunupi/following{/other_user}",
      "gists_url": "https://api.github.com/users/zhaoxiangjunupi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zhaoxiangjunupi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zhaoxiangjunupi/subscriptions",
      "organizations_url": "https://api.github.com/users/zhaoxiangjunupi/orgs",
      "repos_url": "https://api.github.com/users/zhaoxiangjunupi/repos",
      "events_url": "https://api.github.com/users/zhaoxiangjunupi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zhaoxiangjunupi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-29T10:53:54Z",
    "updated_at": "2023-01-29T10:53:54Z",
    "author_association": "NONE",
    "body": "Have you solved this problem?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1407629084/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1408870901",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4754#issuecomment-1408870901",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754",
    "id": 1408870901,
    "node_id": "IC_kwDODjvEJM5T-an1",
    "user": {
      "login": "kaladinlight",
      "id": 35275952,
      "node_id": "MDQ6VXNlcjM1Mjc1OTUy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35275952?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaladinlight",
      "html_url": "https://github.com/kaladinlight",
      "followers_url": "https://api.github.com/users/kaladinlight/followers",
      "following_url": "https://api.github.com/users/kaladinlight/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaladinlight/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaladinlight/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaladinlight/subscriptions",
      "organizations_url": "https://api.github.com/users/kaladinlight/orgs",
      "repos_url": "https://api.github.com/users/kaladinlight/repos",
      "events_url": "https://api.github.com/users/kaladinlight/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaladinlight/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-30T15:55:00Z",
    "updated_at": "2023-01-30T15:55:00Z",
    "author_association": "NONE",
    "body": "> Have you solved this problem?\r\n\r\nNegative. My assumption is that l2geth is all but abandoned in favor of the bedrock upgrade and I'm just waiting on snapshots for legacy geth come that time. Considering op-geth is forked from a more recent version on geth, hopefully there will be more node stability come bedrock.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1408870901/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1419825095",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4754#issuecomment-1419825095",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754",
    "id": 1419825095,
    "node_id": "IC_kwDODjvEJM5UoM_H",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-06T21:52:57Z",
    "updated_at": "2023-02-06T21:52:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yeah sorry about that, we're all hands on deck pushing out the Bedrock release. `l2geth` is based on an extremely old version of Geth and has lots of stability issues. I'm taking a quick look at this to see if I can figure out what's going on.\r\n\r\nI think you're correct that likely what's happening is the following:\r\n- The block was written to DB but not added to the chain\r\n- The reset logic isn't detecting this case and removing the block from the DB\r\n- The short-circuit prevents the thing from starting again",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1419825095/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1419851276",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4754#issuecomment-1419851276",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754",
    "id": 1419851276,
    "node_id": "IC_kwDODjvEJM5UoTYM",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-06T22:14:07Z",
    "updated_at": "2023-02-06T22:14:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm going to create a canary release with an experimental fix that removes the short circuit. Just a sec...",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1419851276/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 2,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1419888604",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4754#issuecomment-1419888604",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754",
    "id": 1419888604,
    "node_id": "IC_kwDODjvEJM5Uocfc",
    "user": {
      "login": "kaladinlight",
      "id": 35275952,
      "node_id": "MDQ6VXNlcjM1Mjc1OTUy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35275952?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaladinlight",
      "html_url": "https://github.com/kaladinlight",
      "followers_url": "https://api.github.com/users/kaladinlight/followers",
      "following_url": "https://api.github.com/users/kaladinlight/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaladinlight/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaladinlight/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaladinlight/subscriptions",
      "organizations_url": "https://api.github.com/users/kaladinlight/orgs",
      "repos_url": "https://api.github.com/users/kaladinlight/repos",
      "events_url": "https://api.github.com/users/kaladinlight/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaladinlight/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-06T22:46:44Z",
    "updated_at": "2023-02-06T22:46:44Z",
    "author_association": "NONE",
    "body": "> I'm going to create a canary release with an experimental fix that removes the short circuit. Just a sec...\r\n\r\nWow, rock on! Was not expecting much response here so I appreciate you taking the time to attempt a quick fix. :crossed_fingers:\r\n\r\nAnd looking forward to the bedrock upgrade! ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1419888604/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 1,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1419956459",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4754#issuecomment-1419956459",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754",
    "id": 1419956459,
    "node_id": "IC_kwDODjvEJM5UotDr",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-06T23:48:38Z",
    "updated_at": "2023-02-06T23:48:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "Sorry for the delay here, got caught up with some other things. Can you try out this prerelease image and see if it fixes the deadlock? [prerelease-0.0.0-rc-l2g-init-deadlock](https://hub.docker.com/layers/ethereumoptimism/l2geth/prerelease-0.0.0-rc-l2g-init-deadlock/images/sha256-ef3558551afa46ad289de25d9f13d5e8fce965e5e9d05af0aa805bcaa0f09eed?context=explore)",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1419956459/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1421012590",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4754#issuecomment-1421012590",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754",
    "id": 1421012590,
    "node_id": "IC_kwDODjvEJM5Usu5u",
    "user": {
      "login": "kaladinlight",
      "id": 35275952,
      "node_id": "MDQ6VXNlcjM1Mjc1OTUy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35275952?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaladinlight",
      "html_url": "https://github.com/kaladinlight",
      "followers_url": "https://api.github.com/users/kaladinlight/followers",
      "following_url": "https://api.github.com/users/kaladinlight/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaladinlight/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaladinlight/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaladinlight/subscriptions",
      "organizations_url": "https://api.github.com/users/kaladinlight/orgs",
      "repos_url": "https://api.github.com/users/kaladinlight/repos",
      "events_url": "https://api.github.com/users/kaladinlight/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaladinlight/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-07T15:59:45Z",
    "updated_at": "2023-02-07T15:59:45Z",
    "author_association": "NONE",
    "body": "> Sorry for the delay here, got caught up with some other things. Can you try out this prerelease image and see if it fixes the deadlock? [prerelease-0.0.0-rc-l2g-init-deadlock](https://hub.docker.com/layers/ethereumoptimism/l2geth/prerelease-0.0.0-rc-l2g-init-deadlock/images/sha256-ef3558551afa46ad289de25d9f13d5e8fce965e5e9d05af0aa805bcaa0f09eed?context=explore)\r\n\r\nNo worries, I will have to spin things back up as I had already tore them down to save some money, but will let you know when I can confirm the fix. Thanks again!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1421012590/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1421088213",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4754#issuecomment-1421088213",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754",
    "id": 1421088213,
    "node_id": "IC_kwDODjvEJM5UtBXV",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-07T16:46:28Z",
    "updated_at": "2023-02-07T16:46:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "Ok!",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1421088213/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1421709723",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4754#issuecomment-1421709723",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754",
    "id": 1421709723,
    "node_id": "IC_kwDODjvEJM5UvZGb",
    "user": {
      "login": "kaladinlight",
      "id": 35275952,
      "node_id": "MDQ6VXNlcjM1Mjc1OTUy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35275952?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaladinlight",
      "html_url": "https://github.com/kaladinlight",
      "followers_url": "https://api.github.com/users/kaladinlight/followers",
      "following_url": "https://api.github.com/users/kaladinlight/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaladinlight/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaladinlight/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaladinlight/subscriptions",
      "organizations_url": "https://api.github.com/users/kaladinlight/orgs",
      "repos_url": "https://api.github.com/users/kaladinlight/repos",
      "events_url": "https://api.github.com/users/kaladinlight/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaladinlight/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-08T00:41:04Z",
    "updated_at": "2023-02-08T00:42:26Z",
    "author_association": "NONE",
    "body": "Sure enough, block sync picks back up!\r\n\r\nThe only thing that catches my eye is `Block not found, resetting index new=1547208 old=1547209`, but then the first block synced is the old index (not new) `Applying transaction to tip index=1547209`. This makes sense enough given the change, but I am just wondering if there will be any possible missed data from `1547208`. Can we be confident enough that all data was indexed from `1547208` if the stored block index had been incremented to `1547209` before shutdown? I am not familiar enough with geth internals to know if there is any sort of resync/reconfirm latest block on restart.\r\n\r\n![image](https://user-images.githubusercontent.com/35275952/217398459-8fdde2a6-4ef6-4e8b-9748-474e6ca5b5f6.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1421709723/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1421724693",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4754#issuecomment-1421724693",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754",
    "id": 1421724693,
    "node_id": "IC_kwDODjvEJM5UvcwV",
    "user": {
      "login": "kaladinlight",
      "id": 35275952,
      "node_id": "MDQ6VXNlcjM1Mjc1OTUy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35275952?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaladinlight",
      "html_url": "https://github.com/kaladinlight",
      "followers_url": "https://api.github.com/users/kaladinlight/followers",
      "following_url": "https://api.github.com/users/kaladinlight/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaladinlight/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaladinlight/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaladinlight/subscriptions",
      "organizations_url": "https://api.github.com/users/kaladinlight/orgs",
      "repos_url": "https://api.github.com/users/kaladinlight/repos",
      "events_url": "https://api.github.com/users/kaladinlight/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaladinlight/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-08T01:00:19Z",
    "updated_at": "2023-02-08T01:38:04Z",
    "author_association": "NONE",
    "body": "Also, looking at go-ethereum v1.10.26, the check is still in the codebase: https://github.com/ethereum/go-ethereum/blob/v1.10.26/miner/worker.go#L692.\r\n\r\nThis makes me believe there could still be runtime consensus edge case around block resubmit that would be removed versus as potential fix during shutdown cleanup or more robust recovery logic instead. Block resubmit edge case may not be relevant with rollup arch and syncing from data-transport-layer, but figured I would raise the thought.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1421724693/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1425547981",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4754#issuecomment-1425547981",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754",
    "id": 1425547981,
    "node_id": "IC_kwDODjvEJM5U-CLN",
    "user": {
      "login": "suiSuiSuisuisuiwalletelias",
      "id": 122233432,
      "node_id": "U_kgDOB0kiWA",
      "avatar_url": "https://avatars.githubusercontent.com/u/122233432?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/suiSuiSuisuisuiwalletelias",
      "html_url": "https://github.com/suiSuiSuisuisuiwalletelias",
      "followers_url": "https://api.github.com/users/suiSuiSuisuisuiwalletelias/followers",
      "following_url": "https://api.github.com/users/suiSuiSuisuisuiwalletelias/following{/other_user}",
      "gists_url": "https://api.github.com/users/suiSuiSuisuisuiwalletelias/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/suiSuiSuisuisuiwalletelias/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/suiSuiSuisuisuiwalletelias/subscriptions",
      "organizations_url": "https://api.github.com/users/suiSuiSuisuisuiwalletelias/orgs",
      "repos_url": "https://api.github.com/users/suiSuiSuisuisuiwalletelias/repos",
      "events_url": "https://api.github.com/users/suiSuiSuisuisuiwalletelias/events{/privacy}",
      "received_events_url": "https://api.github.com/users/suiSuiSuisuisuiwalletelias/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-10T10:02:19Z",
    "updated_at": "2023-02-10T10:02:19Z",
    "author_association": "NONE",
    "body": "it looks like this issue is solved right:)?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1425547981/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1426089173",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4754#issuecomment-1426089173",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754",
    "id": 1426089173,
    "node_id": "IC_kwDODjvEJM5VAGTV",
    "user": {
      "login": "kaladinlight",
      "id": 35275952,
      "node_id": "MDQ6VXNlcjM1Mjc1OTUy",
      "avatar_url": "https://avatars.githubusercontent.com/u/35275952?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kaladinlight",
      "html_url": "https://github.com/kaladinlight",
      "followers_url": "https://api.github.com/users/kaladinlight/followers",
      "following_url": "https://api.github.com/users/kaladinlight/following{/other_user}",
      "gists_url": "https://api.github.com/users/kaladinlight/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kaladinlight/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kaladinlight/subscriptions",
      "organizations_url": "https://api.github.com/users/kaladinlight/orgs",
      "repos_url": "https://api.github.com/users/kaladinlight/repos",
      "events_url": "https://api.github.com/users/kaladinlight/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kaladinlight/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-10T17:01:09Z",
    "updated_at": "2023-02-10T17:01:09Z",
    "author_association": "NONE",
    "body": "> it looks like this issue is solved right:)?\r\n\r\nYes, the fix release candidate image [prerelease-0.0.0-rc-l2g-init-deadlock](https://hub.docker.com/layers/ethereumoptimism/l2geth/prerelease-0.0.0-rc-l2g-init-deadlock/images/sha256-ef3558551afa46ad289de25d9f13d5e8fce965e5e9d05af0aa805bcaa0f09eed?context=explore) does fix the deadlock. I just had some follow up edge case questions, but I haven't noticed any issues at this time.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1426089173/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1475276736",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4754#issuecomment-1475276736",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754",
    "id": 1475276736,
    "node_id": "IC_kwDODjvEJM5X7u_A",
    "user": {
      "login": "giovannirco",
      "id": 34581682,
      "node_id": "MDQ6VXNlcjM0NTgxNjgy",
      "avatar_url": "https://avatars.githubusercontent.com/u/34581682?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/giovannirco",
      "html_url": "https://github.com/giovannirco",
      "followers_url": "https://api.github.com/users/giovannirco/followers",
      "following_url": "https://api.github.com/users/giovannirco/following{/other_user}",
      "gists_url": "https://api.github.com/users/giovannirco/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/giovannirco/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/giovannirco/subscriptions",
      "organizations_url": "https://api.github.com/users/giovannirco/orgs",
      "repos_url": "https://api.github.com/users/giovannirco/repos",
      "events_url": "https://api.github.com/users/giovannirco/events{/privacy}",
      "received_events_url": "https://api.github.com/users/giovannirco/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-19T14:28:36Z",
    "updated_at": "2023-03-19T21:29:27Z",
    "author_association": "NONE",
    "body": "I am having this same issue, actually caused by not enough disk space. I have bumped the disk size but it doesnt come back syncing. What is the source branch of this image you posted above @smartcontracts ? I am building l2geth from source and need to rebase from that branch with the fix\r\n\r\n--edit--\r\n\r\nFound it [here](https://github.com/ethereum-optimism/optimism/issues/4828#issuecomment-1422728952)\r\nthank you very much, using this branch fixed and l2geth is progressing again\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1475276736/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1476626659",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/4754#issuecomment-1476626659",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/4754",
    "id": 1476626659,
    "node_id": "IC_kwDODjvEJM5YA4jj",
    "user": {
      "login": "taxmeifyoucan",
      "id": 61149543,
      "node_id": "MDQ6VXNlcjYxMTQ5NTQz",
      "avatar_url": "https://avatars.githubusercontent.com/u/61149543?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/taxmeifyoucan",
      "html_url": "https://github.com/taxmeifyoucan",
      "followers_url": "https://api.github.com/users/taxmeifyoucan/followers",
      "following_url": "https://api.github.com/users/taxmeifyoucan/following{/other_user}",
      "gists_url": "https://api.github.com/users/taxmeifyoucan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/taxmeifyoucan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/taxmeifyoucan/subscriptions",
      "organizations_url": "https://api.github.com/users/taxmeifyoucan/orgs",
      "repos_url": "https://api.github.com/users/taxmeifyoucan/repos",
      "events_url": "https://api.github.com/users/taxmeifyoucan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/taxmeifyoucan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-03-20T17:11:11Z",
    "updated_at": "2023-03-20T17:11:11Z",
    "author_association": "NONE",
    "body": "I am running docker image `prerelease-0.0.0-rc-l2g-init-deadlock` on Goerli and the issue seems persisting. The sync gets stuck at block height `0x3df827`\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1476626659/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
