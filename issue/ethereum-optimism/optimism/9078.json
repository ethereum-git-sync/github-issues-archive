{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/9078",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/9078/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/9078/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/9078/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/9078",
  "id": 2088607211,
  "node_id": "I_kwDODjvEJM58fZ3r",
  "number": 9078,
  "title": "only-allow: not found / MODULE_NOT_FOUND",
  "user": {
    "login": "PeterBenc",
    "id": 22474126,
    "node_id": "MDQ6VXNlcjIyNDc0MTI2",
    "avatar_url": "https://avatars.githubusercontent.com/u/22474126?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/PeterBenc",
    "html_url": "https://github.com/PeterBenc",
    "followers_url": "https://api.github.com/users/PeterBenc/followers",
    "following_url": "https://api.github.com/users/PeterBenc/following{/other_user}",
    "gists_url": "https://api.github.com/users/PeterBenc/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/PeterBenc/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/PeterBenc/subscriptions",
    "organizations_url": "https://api.github.com/users/PeterBenc/orgs",
    "repos_url": "https://api.github.com/users/PeterBenc/repos",
    "events_url": "https://api.github.com/users/PeterBenc/events{/privacy}",
    "received_events_url": "https://api.github.com/users/PeterBenc/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2024-01-18T16:08:07Z",
  "updated_at": "2024-01-18T16:08:07Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Opening the issue, not because I am convinced that the source of the problem is here, but just to let you guys know that there is such issue, and possible fix.\r\n\r\n**Describe the bug**\r\n- we are using `optimism-sdk` as dependency\r\n- locally, all seem to work\r\n- on circleCI or on heroku, the `yarn install` command (seemingly randomly) fails with\r\n\r\n```\r\nExit code: 127\r\nCommand: npx only-allow pnpm\r\nArguments: \r\nDirectory: /home/circleci/repo/node_modules/@eth-optimism/core-utils\r\nOutput:\r\nnpm WARN exec The following package was not found and will be installed: only-allow@1.2.1\r\nsh: 1: only-allow: not found\r\ninfo Visit https://yarnpkg.com/en/docs/cli/install for documentation about this command.\r\n\r\nExited with code exit status 127\r\n```\r\n\r\nor \r\n\r\n```\r\nerror /home/circleci/repo/node_modules/@eth-optimism/contracts-bedrock: Command failed.\r\nExit code: 1\r\nCommand: npx only-allow pnpm\r\nArguments: \r\nDirectory: /home/circleci/repo/node_modules/@eth-optimism/contracts-bedrock\r\nOutput:\r\nnpm WARN exec The following package was not found and will be installed: only-allow@1.2.1\r\nnode:internal/modules/cjs/loader:1080\r\n  throw err;\r\n  ^\r\n\r\nError: Cannot find module '/home/circleci/.npm/_npx/0b83cd9ca5e1325c/node_modules/.bin/only-allow'\r\n    at Module._resolveFilename (node:internal/modules/cjs/loader:1077:15)\r\n    at Module._load (node:internal/modules/cjs/loader:922:27)\r\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:81:12)\r\n    at node:internal/main/run_main_module:23:47 {\r\n  code: 'MODULE_NOT_FOUND',\r\n  requireStack: []\r\n}\r\n\r\nNode.js v18.17.1\r\ninfo Visit https://yarnpkg.com/en/docs/cli/install for documentation about this command.\r\n```\r\n\r\n\r\n**To Reproduce**\r\n - hard to do, for us, the `yarn install` script was failing randomly, we haven't figured out what is it dependent on\r\n\r\n**Expected behavior**\r\n- yarn install works, only allow gets installed and is found\r\n\r\n**System Specs:**\r\n\"@eth-optimism/sdk\": \"^3.1.6\"\r\n\r\n**Additional context**\r\nPossibly related\r\nhttps://github.com/pnpm/only-allow/issues/11\r\nhttps://github.com/npm/cli/issues/2660\r\nhttps://github.com/Lightprotocol/light-protocol/issues/381\r\nhttps://github.com/juliencrn/usehooks-ts/issues/420\r\n\r\n**Possible fix**\r\n- we added `only-allow` package as `devDependency` which seemed to fix the issue.\r\n\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/9078/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/9078/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[

]
