{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2507",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2507/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2507/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2507/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/2507",
  "id": 1220565645,
  "node_id": "I_kwDODjvEJM5IwFqN",
  "number": 2507,
  "title": "docker container persistent issue",
  "user": {
    "login": "huahuayu",
    "id": 1725060,
    "node_id": "MDQ6VXNlcjE3MjUwNjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1725060?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/huahuayu",
    "html_url": "https://github.com/huahuayu",
    "followers_url": "https://api.github.com/users/huahuayu/followers",
    "following_url": "https://api.github.com/users/huahuayu/following{/other_user}",
    "gists_url": "https://api.github.com/users/huahuayu/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/huahuayu/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/huahuayu/subscriptions",
    "organizations_url": "https://api.github.com/users/huahuayu/orgs",
    "repos_url": "https://api.github.com/users/huahuayu/repos",
    "events_url": "https://api.github.com/users/huahuayu/events{/privacy}",
    "received_events_url": "https://api.github.com/users/huahuayu/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2907832555,
      "node_id": "MDU6TGFiZWwyOTA3ODMyNTU1",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/C-feature-request",
      "name": "C-feature-request",
      "color": "C5DEF5",
      "default": false,
      "description": "Category: A feature request."
    },
    {
      "id": 2907832834,
      "node_id": "MDU6TGFiZWwyOTA3ODMyODM0",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/M-ops",
      "name": "M-ops",
      "color": "FBCA04",
      "default": false,
      "description": "Module: ops"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2022-04-29T11:19:50Z",
  "updated_at": "2023-06-16T19:02:32Z",
  "closed_at": "2023-06-16T19:02:32Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi, my system disk is just 20GB, but have another 1T disk, so I want to use that disk for storage. But the docker compose file use `/var` dir as default.\r\n\r\nI suggest that add an environment variable in .env file for setting a base dir for storage.\r\n\r\nIf I am right, only `optimism/infra/op-replica/docker-compose/replica.yml` needs to change.",
  "closed_by": {
    "login": "tynes",
    "id": 6626818,
    "node_id": "MDQ6VXNlcjY2MjY4MTg=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6626818?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/tynes",
    "html_url": "https://github.com/tynes",
    "followers_url": "https://api.github.com/users/tynes/followers",
    "following_url": "https://api.github.com/users/tynes/following{/other_user}",
    "gists_url": "https://api.github.com/users/tynes/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/tynes/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/tynes/subscriptions",
    "organizations_url": "https://api.github.com/users/tynes/orgs",
    "repos_url": "https://api.github.com/users/tynes/repos",
    "events_url": "https://api.github.com/users/tynes/events{/privacy}",
    "received_events_url": "https://api.github.com/users/tynes/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2507/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2507/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1117073751",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2507#issuecomment-1117073751",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2507",
    "id": 1117073751,
    "node_id": "IC_kwDODjvEJM5ClTFX",
    "user": {
      "login": "huahuayu",
      "id": 1725060,
      "node_id": "MDQ6VXNlcjE3MjUwNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1725060?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huahuayu",
      "html_url": "https://github.com/huahuayu",
      "followers_url": "https://api.github.com/users/huahuayu/followers",
      "following_url": "https://api.github.com/users/huahuayu/following{/other_user}",
      "gists_url": "https://api.github.com/users/huahuayu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huahuayu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huahuayu/subscriptions",
      "organizations_url": "https://api.github.com/users/huahuayu/orgs",
      "repos_url": "https://api.github.com/users/huahuayu/repos",
      "events_url": "https://api.github.com/users/huahuayu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huahuayu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-04T08:54:14Z",
    "updated_at": "2022-05-04T08:54:14Z",
    "author_association": "NONE",
    "body": "These two local volumes consume all the disk space in the system disk. It should be configable.\r\n```bash\r\n$ sudo docker volume inspect op-replica_dtl\r\n[\r\n    {\r\n        \"CreatedAt\": \"2022-05-01T00:00:03Z\",\r\n        \"Driver\": \"local\",\r\n        \"Labels\": {\r\n            \"com.docker.compose.project\": \"op-replica\",\r\n            \"com.docker.compose.version\": \"2.4.1\",\r\n            \"com.docker.compose.volume\": \"dtl\"\r\n        },\r\n        \"Mountpoint\": \"/var/lib/docker/volumes/op-replica_dtl/_data\",\r\n        \"Name\": \"op-replica_dtl\",\r\n        \"Options\": null,\r\n        \"Scope\": \"local\"\r\n    }\r\n]\r\n\r\n$ sudo docker volume inspect op-replica_geth\r\n[\r\n    {\r\n        \"CreatedAt\": \"2022-04-29T11:21:05Z\",\r\n        \"Driver\": \"local\",\r\n        \"Labels\": {\r\n            \"com.docker.compose.project\": \"op-replica\",\r\n            \"com.docker.compose.version\": \"2.4.1\",\r\n            \"com.docker.compose.volume\": \"geth\"\r\n        },\r\n        \"Mountpoint\": \"/var/lib/docker/volumes/op-replica_geth/_data\",\r\n        \"Name\": \"op-replica_geth\",\r\n        \"Options\": null,\r\n        \"Scope\": \"local\"\r\n    }\r\n]\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1117073751/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1117091898",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2507#issuecomment-1117091898",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2507",
    "id": 1117091898,
    "node_id": "IC_kwDODjvEJM5ClXg6",
    "user": {
      "login": "huahuayu",
      "id": 1725060,
      "node_id": "MDQ6VXNlcjE3MjUwNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1725060?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huahuayu",
      "html_url": "https://github.com/huahuayu",
      "followers_url": "https://api.github.com/users/huahuayu/followers",
      "following_url": "https://api.github.com/users/huahuayu/following{/other_user}",
      "gists_url": "https://api.github.com/users/huahuayu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huahuayu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huahuayu/subscriptions",
      "organizations_url": "https://api.github.com/users/huahuayu/orgs",
      "repos_url": "https://api.github.com/users/huahuayu/repos",
      "events_url": "https://api.github.com/users/huahuayu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huahuayu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-04T09:14:57Z",
    "updated_at": "2022-05-04T09:14:57Z",
    "author_association": "NONE",
    "body": "Hi @optimisticben how do you think?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1117091898/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1117677342",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2507#issuecomment-1117677342",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2507",
    "id": 1117677342,
    "node_id": "IC_kwDODjvEJM5Cnmce",
    "user": {
      "login": "optimisticben",
      "id": 82120899,
      "node_id": "MDQ6VXNlcjgyMTIwODk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/82120899?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/optimisticben",
      "html_url": "https://github.com/optimisticben",
      "followers_url": "https://api.github.com/users/optimisticben/followers",
      "following_url": "https://api.github.com/users/optimisticben/following{/other_user}",
      "gists_url": "https://api.github.com/users/optimisticben/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/optimisticben/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/optimisticben/subscriptions",
      "organizations_url": "https://api.github.com/users/optimisticben/orgs",
      "repos_url": "https://api.github.com/users/optimisticben/repos",
      "events_url": "https://api.github.com/users/optimisticben/events{/privacy}",
      "received_events_url": "https://api.github.com/users/optimisticben/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-04T18:38:53Z",
    "updated_at": "2022-05-04T18:38:53Z",
    "author_association": "CONTRIBUTOR",
    "body": "I would rather use an overlay solution instead of adding more configuration to the setup.\r\n\r\nSomething like a new yaml file, and include this in the `COMPOSE_FILE` env list.\r\n```\r\n---\r\nversion: \"3.4\"\r\nx-logging: &logging\r\n  logging:\r\n    driver: json-file\r\n    options:\r\n      max-size: 10m\r\n      max-file: \"3\"\r\n\r\nservices:\r\n  data-transport-layer:\r\n    volumes:\r\n      - <PATH ON LOCALHOST>:/db\r\n  l2geth-replica:\r\n    volumes:\r\n      - <PATH ON LOCALHOST>:/geth\r\n```\r\n\r\nUsing host path mapping involves localhost issues I'd rather avoid in an example deployment 😁 ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1117677342/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1118419250",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2507#issuecomment-1118419250",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2507",
    "id": 1118419250,
    "node_id": "IC_kwDODjvEJM5Cqbky",
    "user": {
      "login": "huahuayu",
      "id": 1725060,
      "node_id": "MDQ6VXNlcjE3MjUwNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1725060?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/huahuayu",
      "html_url": "https://github.com/huahuayu",
      "followers_url": "https://api.github.com/users/huahuayu/followers",
      "following_url": "https://api.github.com/users/huahuayu/following{/other_user}",
      "gists_url": "https://api.github.com/users/huahuayu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/huahuayu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/huahuayu/subscriptions",
      "organizations_url": "https://api.github.com/users/huahuayu/orgs",
      "repos_url": "https://api.github.com/users/huahuayu/repos",
      "events_url": "https://api.github.com/users/huahuayu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/huahuayu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-05T10:56:46Z",
    "updated_at": "2022-05-05T10:56:46Z",
    "author_association": "NONE",
    "body": "Works for me. So will you merge it or not?\r\n\r\nHere is my script to run optimism\r\n\r\n```bash\r\n#!/usr/bin/env bash\r\nset -o errexit\r\nset -o nounset\r\nset -o pipefail\r\n\r\nSRC_DIR=$HOME\r\nVERSION=@eth-optimism/sdk@1.1.2\r\nETH_RPC=<rpc_url>\r\nDATA_DIR=/data/optimism\r\n\r\nmkdir -p $DATA_DIR/dtl/db\r\nmkdir -p $DATA_DIR/l2geth/geth\r\ncd $SRC_DIR\r\nif [[ -e $SRC_DIR/optimism ]]\r\nthen\r\n    cd $SRC_DIR/optimism\r\n    git reset --hard\r\n    git fetch --all\r\n    git checkout tags/$VERSION 1>/dev/null\r\nelse\r\n    git clone https://github.com/ethereum-optimism/optimism.git\r\n    git checkout tags/$VERSION 1>/dev/null\r\nfi\r\ncd $SRC_DIR/optimism/infra/op-replica/docker-compose/\r\ncp default-mainnet.env .env\r\nsed -i \"s|WONT_WORK_UNLESS_YOU_PROVIDE_A_VALID_ETHEREUM_L1_ENDPOINT|$ETH_RPC|\" .env\r\nsed -i 's|COMPOSE_FILE=replica.yml:replica-shared.yml:replica-toml.yml|COMPOSE_FILE=replica.yml:replica-shared.yml:replica-toml.yml:replica-volume.yml|' .env\r\ncat > replica-volume.yml <<EOF\r\n---\r\nversion: \"3.4\"\r\nx-logging: &logging\r\n  logging:\r\n    driver: json-file\r\n    options:\r\n      max-size: 10m\r\n      max-file: \"3\"\r\n\r\nservices:\r\n  data-transport-layer:\r\n    volumes:\r\n      - $DATA_DIR/dtl/db:/db\r\n  l2geth-replica:\r\n    volumes:\r\n      - $DATA_DIR/l2geth/geth:/geth\r\nEOF\r\n\r\nsudo docker-compose up -d\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1118419250/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1118637688",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2507#issuecomment-1118637688",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2507",
    "id": 1118637688,
    "node_id": "IC_kwDODjvEJM5CrQ54",
    "user": {
      "login": "optimisticben",
      "id": 82120899,
      "node_id": "MDQ6VXNlcjgyMTIwODk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/82120899?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/optimisticben",
      "html_url": "https://github.com/optimisticben",
      "followers_url": "https://api.github.com/users/optimisticben/followers",
      "following_url": "https://api.github.com/users/optimisticben/following{/other_user}",
      "gists_url": "https://api.github.com/users/optimisticben/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/optimisticben/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/optimisticben/subscriptions",
      "organizations_url": "https://api.github.com/users/optimisticben/orgs",
      "repos_url": "https://api.github.com/users/optimisticben/repos",
      "events_url": "https://api.github.com/users/optimisticben/events{/privacy}",
      "received_events_url": "https://api.github.com/users/optimisticben/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-05T14:40:43Z",
    "updated_at": "2022-05-05T14:40:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "LGTM!\r\n\r\nIf you create a PR for the infra/op-replica/docker-compose/contrib with a README on how the script is expected to be used, we'll get the team to review.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1118637688/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1139314220",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2507#issuecomment-1139314220",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2507",
    "id": 1139314220,
    "node_id": "IC_kwDODjvEJM5D6I4s",
    "user": {
      "login": "diwu1989",
      "id": 380950,
      "node_id": "MDQ6VXNlcjM4MDk1MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/380950?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/diwu1989",
      "html_url": "https://github.com/diwu1989",
      "followers_url": "https://api.github.com/users/diwu1989/followers",
      "following_url": "https://api.github.com/users/diwu1989/following{/other_user}",
      "gists_url": "https://api.github.com/users/diwu1989/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/diwu1989/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/diwu1989/subscriptions",
      "organizations_url": "https://api.github.com/users/diwu1989/orgs",
      "repos_url": "https://api.github.com/users/diwu1989/repos",
      "events_url": "https://api.github.com/users/diwu1989/events{/privacy}",
      "received_events_url": "https://api.github.com/users/diwu1989/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-27T06:10:15Z",
    "updated_at": "2022-05-27T06:10:15Z",
    "author_association": "NONE",
    "body": "Can we also introduce template variables to set the memory limit on L2Geth and DTL?\r\nI would like to put some sane memory limits on the services as well via env variable.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1139314220/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
