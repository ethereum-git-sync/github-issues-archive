{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2306",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2306/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2306/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2306/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/2306",
  "id": 1165390046,
  "node_id": "I_kwDODjvEJM5FdnDe",
  "number": 2306,
  "title": "callTracer returns TypeError exception for certarin txs",
  "user": {
    "login": "qk-santi",
    "id": 94850169,
    "node_id": "U_kgDOBadMeQ",
    "avatar_url": "https://avatars.githubusercontent.com/u/94850169?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/qk-santi",
    "html_url": "https://github.com/qk-santi",
    "followers_url": "https://api.github.com/users/qk-santi/followers",
    "following_url": "https://api.github.com/users/qk-santi/following{/other_user}",
    "gists_url": "https://api.github.com/users/qk-santi/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/qk-santi/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/qk-santi/subscriptions",
    "organizations_url": "https://api.github.com/users/qk-santi/orgs",
    "repos_url": "https://api.github.com/users/qk-santi/repos",
    "events_url": "https://api.github.com/users/qk-santi/events{/privacy}",
    "received_events_url": "https://api.github.com/users/qk-santi/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2907832490,
      "node_id": "MDU6TGFiZWwyOTA3ODMyNDkw",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/C-bug",
      "name": "C-bug",
      "color": "C5DEF5",
      "default": false,
      "description": "Category: This is a bug."
    },
    {
      "id": 3357535896,
      "node_id": "MDU6TGFiZWwzMzU3NTM1ODk2",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/M-l2geth",
      "name": "M-l2geth",
      "color": "FBCA04",
      "default": false,
      "description": "Module: l2geth"
    },
    {
      "id": 3762060515,
      "node_id": "LA_kwDODjvEJM7gPHzj",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/N-mainnet",
      "name": "N-mainnet",
      "color": "D4C5F9",
      "default": false,
      "description": "Network: mainnet"
    },
    {
      "id": 4266439918,
      "node_id": "LA_kwDODjvEJM7-TLTu",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/C-bedrock-fixes-this",
      "name": "C-bedrock-fixes-this",
      "color": "C5DEF5",
      "default": false,
      "description": "Category: Something Bedrock fixes"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-03-10T15:42:16Z",
  "updated_at": "2022-09-10T11:33:29Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "**Describe the bug**\r\n\r\nSome transactions raise an exception when using `debug_traceTransaction` with the `callTracer` tracer.\r\n\r\nThese transactions all have the same error in the Status at [Etherscan](https://optimistic.etherscan.io/tx/0xc033250c5a45f9d104fc28640071a776d146d48403cf5e95ed0015c712e26cb6):\r\n`Fail with error 'deployer address not whitelisted: 0xc6dbd69d69F22842832E93aE1Ede9995c583bFC1'`\r\n\r\nList of transactions detected:\r\n- [0xc033250c5a45f9d104fc28640071a776d146d48403cf5e95ed0015c712e26cb6](https://optimistic.etherscan.io/tx/0xc033250c5a45f9d104fc28640071a776d146d48403cf5e95ed0015c712e26cb6)\r\n- [0xcf6e46a1f41e1678fba10590f9d092690c5e8fd2e85a3614715fb21caa74655d](https://optimistic.etherscan.io/tx/0xcf6e46a1f41e1678fba10590f9d092690c5e8fd2e85a3614715fb21caa74655d)\r\n- [0x86f8c77cfa2b439e9b4e92a10f6c17b99fce1220edf4001e4158b57f41c576e5](https://optimistic.etherscan.io/tx/0x86f8c77cfa2b439e9b4e92a10f6c17b99fce1220edf4001e4158b57f41c576e5)\r\n- [0x0c38a734be0cd55ae21a9f40b7b7399cbbc957614a39e3e1ecd5e135496c6e9f](https://optimistic.etherscan.io/tx/0x0c38a734be0cd55ae21a9f40b7b7399cbbc957614a39e3e1ecd5e135496c6e9f)\r\n- [0x4ae94460e1550b430707d13f6c632422b89f2b8989fe50adeddb85464584b3a3](https://optimistic.etherscan.io/tx/0x4ae94460e1550b430707d13f6c632422b89f2b8989fe50adeddb85464584b3a3)\r\n- [0x9305aa567670acee152774543136e1e2cb756c04083f643f69de75bceba150c7](https://optimistic.etherscan.io/tx/0x9305aa567670acee152774543136e1e2cb756c04083f643f69de75bceba150c7)\r\n- [0x177a8debf83f65daf7e9eb75d676262949d91dc8a5ef62a859a31b0e6167fd17](https://optimistic.etherscan.io/tx/0x177a8debf83f65daf7e9eb75d676262949d91dc8a5ef62a859a31b0e6167fd17)\r\n- [0xc033250c5a45f9d104fc28640071a776d146d48403cf5e95ed0015c712e26cb6](https://optimistic.etherscan.io/tx/0xc033250c5a45f9d104fc28640071a776d146d48403cf5e95ed0015c712e26cb6)\r\n- [0xd171e2d41a1828f2986633ab004a613767811a962e6aa02b181ac1707e31212e](https://optimistic.etherscan.io/tx/0xd171e2d41a1828f2986633ab004a613767811a962e6aa02b181ac1707e31212e)\r\n\r\n**To Reproduce**\r\n\r\nSend `debug_traceTransaction` to an archive node:\r\n```\r\ncurl https://your-node \\\r\n  -X POST \\\r\n  -H \"Content-Type: application/json\" \\\r\n  --data '{\"method\":\"debug_traceTransaction\",\"params\":[\"0xc033250c5a45f9d104fc28640071a776d146d48403cf5e95ed0015c712e26cb6\", {\"tracer\": \"callTracer\"}],\"id\":1,\"jsonrpc\":\"2.0\"}'\r\n\r\n{\"jsonrpc\":\"2.0\",\"id\":1,\"error\":{\"code\":-32000,\"message\":\"TypeError: cannot read property 'toString' of undefined    in server-side tracer function 'result'\"}}\r\n```\r\n\r\n**Expected behavior**\r\nGet a response without an exception which is similar to other `callTracer` responses.\r\n\r\n**System Specs:**\r\n - OS: Ubuntu 20.04.3 LTS\r\n - Package Version (or commit hash): 0.5.11\r\n\r\n**Additional context**\r\nAdd any other context about the problem here.\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2306/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2306/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1064275047",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2306#issuecomment-1064275047",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2306",
    "id": 1064275047,
    "node_id": "IC_kwDODjvEJM4_b4xn",
    "user": {
      "login": "Inphi",
      "id": 3516807,
      "node_id": "MDQ6VXNlcjM1MTY4MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3516807?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Inphi",
      "html_url": "https://github.com/Inphi",
      "followers_url": "https://api.github.com/users/Inphi/followers",
      "following_url": "https://api.github.com/users/Inphi/following{/other_user}",
      "gists_url": "https://api.github.com/users/Inphi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Inphi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Inphi/subscriptions",
      "organizations_url": "https://api.github.com/users/Inphi/orgs",
      "repos_url": "https://api.github.com/users/Inphi/repos",
      "events_url": "https://api.github.com/users/Inphi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Inphi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-10T16:46:27Z",
    "updated_at": "2022-03-10T16:46:27Z",
    "author_association": "COLLABORATOR",
    "body": "yeah, the default call tracer doesn't handle null values correctly. Until this is fixed, for the time being, might I suggest using this [tracer](https://gist.github.com/Inphi/48c104db351a73a8ce0567362ac59129). The script does the same thing as the default call_tracer. You can supply a custom tracer to `debug_traceTransaction` by setting the \"tracer\" parameter to the script content.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1064275047/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1064359572",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2306#issuecomment-1064359572",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2306",
    "id": 1064359572,
    "node_id": "IC_kwDODjvEJM4_cNaU",
    "user": {
      "login": "qk-santi",
      "id": 94850169,
      "node_id": "U_kgDOBadMeQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/94850169?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/qk-santi",
      "html_url": "https://github.com/qk-santi",
      "followers_url": "https://api.github.com/users/qk-santi/followers",
      "following_url": "https://api.github.com/users/qk-santi/following{/other_user}",
      "gists_url": "https://api.github.com/users/qk-santi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/qk-santi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/qk-santi/subscriptions",
      "organizations_url": "https://api.github.com/users/qk-santi/orgs",
      "repos_url": "https://api.github.com/users/qk-santi/repos",
      "events_url": "https://api.github.com/users/qk-santi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/qk-santi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-10T18:20:35Z",
    "updated_at": "2022-03-10T18:20:35Z",
    "author_association": "NONE",
    "body": "@Inphi, thanks for the quick response!\r\n\r\nHow would be the way to send the code inside `params/tracer`?\r\nI've tried a few ways, but getting always:\r\n`{\"jsonrpc\":\"2.0\",\"id\":null,\"error\":{\"code\":-32600,\"message\":\"failed to parse request\"}}`",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1064359572/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1064367623",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2306#issuecomment-1064367623",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2306",
    "id": 1064367623,
    "node_id": "IC_kwDODjvEJM4_cPYH",
    "user": {
      "login": "Inphi",
      "id": 3516807,
      "node_id": "MDQ6VXNlcjM1MTY4MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3516807?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Inphi",
      "html_url": "https://github.com/Inphi",
      "followers_url": "https://api.github.com/users/Inphi/followers",
      "following_url": "https://api.github.com/users/Inphi/following{/other_user}",
      "gists_url": "https://api.github.com/users/Inphi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Inphi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Inphi/subscriptions",
      "organizations_url": "https://api.github.com/users/Inphi/orgs",
      "repos_url": "https://api.github.com/users/Inphi/repos",
      "events_url": "https://api.github.com/users/Inphi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Inphi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-10T18:30:24Z",
    "updated_at": "2022-03-10T18:30:49Z",
    "author_association": "COLLABORATOR",
    "body": "It's tricky to do this directly on the cmd line as the tracer script has to be escaped. If you don't mind using python, you can use this [convenient script](https://gist.github.com/Inphi/f76ce40c8737f84a7d3accfe14365f3f) that does it for you:\r\n```bash\r\nETH_RPC_URL=https://your-node python3 trace_tx.py <txhash> <path_to_tracer.js>\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1064367623/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1064385911",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2306#issuecomment-1064385911",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2306",
    "id": 1064385911,
    "node_id": "IC_kwDODjvEJM4_cT13",
    "user": {
      "login": "qk-santi",
      "id": 94850169,
      "node_id": "U_kgDOBadMeQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/94850169?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/qk-santi",
      "html_url": "https://github.com/qk-santi",
      "followers_url": "https://api.github.com/users/qk-santi/followers",
      "following_url": "https://api.github.com/users/qk-santi/following{/other_user}",
      "gists_url": "https://api.github.com/users/qk-santi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/qk-santi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/qk-santi/subscriptions",
      "organizations_url": "https://api.github.com/users/qk-santi/orgs",
      "repos_url": "https://api.github.com/users/qk-santi/repos",
      "events_url": "https://api.github.com/users/qk-santi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/qk-santi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-10T18:52:55Z",
    "updated_at": "2022-03-10T18:52:55Z",
    "author_association": "NONE",
    "body": "@Inphi Great! It works like a charm :smile:\r\nLeaving this gist with a test request and the code escaped in case it is useful for anyone:\r\nhttps://gist.github.com/qk-santi/c73f01788c2bf75d09cc330efe4d730d",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1064385911/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
