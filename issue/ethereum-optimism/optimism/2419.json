{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2419",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2419/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2419/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2419/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/2419",
  "id": 1193252744,
  "node_id": "I_kwDODjvEJM5HH5eI",
  "number": 2419,
  "title": "Last deploy task fails on Hardhat",
  "user": {
    "login": "jannikluhn",
    "id": 29854669,
    "node_id": "MDQ6VXNlcjI5ODU0NjY5",
    "avatar_url": "https://avatars.githubusercontent.com/u/29854669?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jannikluhn",
    "html_url": "https://github.com/jannikluhn",
    "followers_url": "https://api.github.com/users/jannikluhn/followers",
    "following_url": "https://api.github.com/users/jannikluhn/following{/other_user}",
    "gists_url": "https://api.github.com/users/jannikluhn/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jannikluhn/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jannikluhn/subscriptions",
    "organizations_url": "https://api.github.com/users/jannikluhn/orgs",
    "repos_url": "https://api.github.com/users/jannikluhn/repos",
    "events_url": "https://api.github.com/users/jannikluhn/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jannikluhn/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2907832490,
      "node_id": "MDU6TGFiZWwyOTA3ODMyNDkw",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/C-bug",
      "name": "C-bug",
      "color": "C5DEF5",
      "default": false,
      "description": "Category: This is a bug."
    },
    {
      "id": 2930018676,
      "node_id": "MDU6TGFiZWwyOTMwMDE4Njc2",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/P-unconfirmed",
      "name": "P-unconfirmed",
      "color": "BFD4F2",
      "default": false,
      "description": "Issue might be valid, but itâ€™s not yet confirmed"
    },
    {
      "id": 2981952422,
      "node_id": "MDU6TGFiZWwyOTgxOTUyNDIy",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/M-contracts",
      "name": "M-contracts",
      "color": "FBCA04",
      "default": false,
      "description": "Module: contracts"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-04-05T14:41:51Z",
  "updated_at": "2022-04-11T15:56:32Z",
  "closed_at": "2022-04-11T15:56:32Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "**Describe the bug**\r\nThe last deploy task, `016-fund-accounts.ts`, fails due to missing funds on Hardhat:\r\n\r\n```\r\nError HH604: Error running JSON-RPC server: ERROR processing .../packages/contracts/deploy/016-fund-accounts.ts:\r\nInvalidInputError: sender doesn't have enough funds to send tx. The max upfront cost is: 5306998372000000 and the sender's account only has: 0\r\n```\r\n\r\n**To Reproduce**\r\n1. create a hardhat deploy config (I just copied `local.ts` to `hardhat.ts` and renamed the network to `hardhat`)\r\n2. run `npx hardhat node`\r\n\r\n**Expected behavior**\r\nThe command should succeed.\r\n\r\n**System Specs:**\r\n - OS: Linux\r\n - Package Version (or commit hash): b4756bcba6b28e9901ff8bbe0717b659f2183ae5 (develop)\r\n\r\n**Additional context**\r\n\r\nThe problem seems to be that there's a mismatch between the [accounts defined in hardhat config file](https://github.com/ethereum-optimism/optimism/blob/develop/packages/contracts/hardhat.config.ts#L31) and the [accounts doing the  funding](https://github.com/ethereum-optimism/optimism/blob/develop/packages/contracts/deploy/016-fund-accounts.ts#L4). The former is ultimately [imported from waffle](https://github.com/ethereum-optimism/optimism/blob/develop/packages/contracts/test/helpers/constants.ts#L2), the latter [from a hardhat-internal variable](https://github.com/ethereum-optimism/optimism/blob/develop/packages/contracts/deploy/016-fund-accounts.ts#L4).\r\n\r\nHardhat accounts:\r\n\r\n```\r\n[\r\n  {\r\n    balance: '10000000000000000000000000000000000',\r\n    privateKey: '0x29f3edee0ad3abf8e2699402e0e28cd6492c9be7eaab00d732a791c33552f797'\r\n  },\r\n  {\r\n    balance: '10000000000000000000000000000000000',\r\n    privateKey: '0x5c8b9227cd5065c7e3f6b73826b8b42e198c4497f6688e3085d5ab3a6d520e74'\r\n  },\r\n  {\r\n    balance: '10000000000000000000000000000000000',\r\n    privateKey: '0x50c8b3fc81e908501c8cd0a60911633acaca1a567d1be8e769c5ae7007b34b23'\r\n  },\r\n...\r\n```\r\n\r\nFunding accounts:\r\n```\r\n{\r\n  initialIndex: 0,\r\n  count: 20,\r\n  path: \"m/44'/60'/0'/0\",\r\n  passphrase: '',\r\n  mnemonic: 'test test test test test test test test test test test junk',\r\n  accountsBalance: '10000000000000000000000'\r\n}\r\n[\r\n  {\r\n    privateKey: '0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80',\r\n    balance: '10000000000000000000000'\r\n  },\r\n  {\r\n    privateKey: '0x59c6995e998f97a5a0044966f0945389dc9e86dae88c7a8412f4603b6b78690d',\r\n    balance: '10000000000000000000000'\r\n  },\r\n  {\r\n    privateKey: '0x5de4111afa1a4b94908f83103eb1f1706367c2e68ca870fc3fb9a804cdab365a',\r\n    balance: '10000000000000000000000'\r\n  },\r\n...\r\n```",
  "closed_by": {
    "login": "mergify[bot]",
    "id": 37929162,
    "node_id": "MDM6Qm90Mzc5MjkxNjI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/10562?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mergify%5Bbot%5D",
    "html_url": "https://github.com/apps/mergify",
    "followers_url": "https://api.github.com/users/mergify%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/mergify%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/mergify%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mergify%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mergify%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/mergify%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/mergify%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/mergify%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mergify%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2419/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2419/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1089120586",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/2419#issuecomment-1089120586",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/2419",
    "id": 1089120586,
    "node_id": "IC_kwDODjvEJM5A6qlK",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-05T17:56:41Z",
    "updated_at": "2022-04-05T17:56:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "Good catch! Thank you. Let me see if I can put together a quick fix.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1089120586/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
