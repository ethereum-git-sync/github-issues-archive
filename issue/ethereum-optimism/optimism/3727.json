{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/3727",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/3727/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/3727/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/3727/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/3727",
  "id": 1412916142,
  "node_id": "I_kwDODjvEJM5UN2Ou",
  "number": 3727,
  "title": "Local rpc node is always 6-20 blocks behind compared to the optimism official rpc node.",
  "user": {
    "login": "JaydenLink",
    "id": 112839129,
    "node_id": "U_kgDOBrnJ2Q",
    "avatar_url": "https://avatars.githubusercontent.com/u/112839129?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/JaydenLink",
    "html_url": "https://github.com/JaydenLink",
    "followers_url": "https://api.github.com/users/JaydenLink/followers",
    "following_url": "https://api.github.com/users/JaydenLink/following{/other_user}",
    "gists_url": "https://api.github.com/users/JaydenLink/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/JaydenLink/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/JaydenLink/subscriptions",
    "organizations_url": "https://api.github.com/users/JaydenLink/orgs",
    "repos_url": "https://api.github.com/users/JaydenLink/repos",
    "events_url": "https://api.github.com/users/JaydenLink/events{/privacy}",
    "received_events_url": "https://api.github.com/users/JaydenLink/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2907832490,
      "node_id": "MDU6TGFiZWwyOTA3ODMyNDkw",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/C-bug",
      "name": "C-bug",
      "color": "C5DEF5",
      "default": false,
      "description": "Category: This is a bug."
    },
    {
      "id": 2930018676,
      "node_id": "MDU6TGFiZWwyOTMwMDE4Njc2",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/P-unconfirmed",
      "name": "P-unconfirmed",
      "color": "BFD4F2",
      "default": false,
      "description": "Issue might be valid, but itâ€™s not yet confirmed"
    },
    {
      "id": 3357535896,
      "node_id": "MDU6TGFiZWwzMzU3NTM1ODk2",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/M-l2geth",
      "name": "M-l2geth",
      "color": "FBCA04",
      "default": false,
      "description": "Module: l2geth"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2022-10-18T09:53:15Z",
  "updated_at": "2023-01-26T02:05:26Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "<!--\r\nNeed help?\r\nRefer to our contributing guidelines for additional information about making a good issue:\r\nhttps://github.com/ethereum-optimism/.github/blob/master/CONTRIBUTING.md\r\n-->\r\n\r\n**Describe the bug**\r\nLocal rpc node is always 6-20 blocks behind compared to the optimism official rpc node.\r\n\r\nThis is the configuration for docker-compose\r\n`COMPOSE_PROJECT_NAME=op-replica\r\nCOMPOSE_FILE=replica.yml:replica-shared.yml:replica-toml.yml\r\nETH_NETWORK=mainnet\r\nDATA_TRANSPORT_LAYER__L1_RPC_ENDPOINT=<Local L1 RPC NODE>\r\nDATA_TRANSPORT_LAYER__L2_RPC_ENDPOINT=https://mainnet.optimism.io\r\nSEQUENCER_CLIENT_HTTP=https://mainnet.optimism.io\r\nSHARED_ENV_PATH=../envs/mainnet\r\nGCMODE=archive\r\nL2GETH_IMAGE_TAG=0.5.24\r\nDTL_IMAGE_TAG=0.5.47\r\nHC_IMAGE_TAG=\r\nL2GETH_HTTP_PORT=9991\r\nL2GETH_WS_PORT=9992\r\nDTL_PORT=7878\r\nGETH_INIT_SCRIPT=check-for-chaindata-berlin.sh\r\nHEALTHCHECK__REFERENCE_RPC_PROVIDER=https://mainnet.optimism.io\r\nHEALTHCHECK__TARGET_RPC_PROVIDER=http://l2geth-replica:8545\r\nRESTART=unless-stopped\r\nROLLUP_BACKEND=l2\r\n\r\nDATA_TRANSPORT_LAYER__DEFAULT_BACKEND=l2\r\nDATA_TRANSPORT_LAYER__L1_GAS_PRICE_BACKEND=l2\r\nDATA_TRANSPORT_LAYER__SYNC_FROM_L1=false\r\nDATA_TRANSPORT_LAYER__SYNC_FROM_L2=true`\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/3727/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/3727/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1332945234",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/3727#issuecomment-1332945234",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/3727",
    "id": 1332945234,
    "node_id": "IC_kwDODjvEJM5PcyFS",
    "user": {
      "login": "tynes",
      "id": 6626818,
      "node_id": "MDQ6VXNlcjY2MjY4MTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6626818?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/tynes",
      "html_url": "https://github.com/tynes",
      "followers_url": "https://api.github.com/users/tynes/followers",
      "following_url": "https://api.github.com/users/tynes/following{/other_user}",
      "gists_url": "https://api.github.com/users/tynes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/tynes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/tynes/subscriptions",
      "organizations_url": "https://api.github.com/users/tynes/orgs",
      "repos_url": "https://api.github.com/users/tynes/repos",
      "events_url": "https://api.github.com/users/tynes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/tynes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-01T00:35:02Z",
    "updated_at": "2022-12-01T00:35:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "It takes some time for blocks to propagate throughout the network",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1332945234/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1402742115",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/3727#issuecomment-1402742115",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/3727",
    "id": 1402742115,
    "node_id": "IC_kwDODjvEJM5TnCVj",
    "user": {
      "login": "midas-glitch",
      "id": 88002158,
      "node_id": "MDQ6VXNlcjg4MDAyMTU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/88002158?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/midas-glitch",
      "html_url": "https://github.com/midas-glitch",
      "followers_url": "https://api.github.com/users/midas-glitch/followers",
      "following_url": "https://api.github.com/users/midas-glitch/following{/other_user}",
      "gists_url": "https://api.github.com/users/midas-glitch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/midas-glitch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/midas-glitch/subscriptions",
      "organizations_url": "https://api.github.com/users/midas-glitch/orgs",
      "repos_url": "https://api.github.com/users/midas-glitch/repos",
      "events_url": "https://api.github.com/users/midas-glitch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/midas-glitch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-24T21:55:11Z",
    "updated_at": "2023-01-24T21:55:11Z",
    "author_association": "NONE",
    "body": "> It takes some time for blocks to propagate throughout the network\r\n\r\nWould you be able to elaborate?  I tried running an Optimism node, and noticed it was always behind my reference alchemy node, and would process a batch of blocks every few seconds.  It seems like when you run your own Optimism node, it depends on the L2 DTL to keep your node up to date, and doesn't communicate at all with other nodes?  Is this how it is supposed to work?  For reference, I am running arbitrum, avax, polygon, aurora nodes, and they are all able to stay in sync perfectly.  What's the point of running an optimism node if its always so far behind.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1402742115/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1404459504",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/3727#issuecomment-1404459504",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/3727",
    "id": 1404459504,
    "node_id": "IC_kwDODjvEJM5Ttlnw",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-26T01:43:50Z",
    "updated_at": "2023-01-26T01:43:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Would you be able to elaborate? \r\n\r\nIt depends on how you're running the node. In the current (\"legacy\") version of the system, there are two operating modes, L1 sync and L2 sync. L1 sync is always behind the Sequencer because it only looks at L1 data. L2 sync should be much faster but has a trust assumption on the L2 node you're syncing from. So if you want fast sync, first make sure that you're using L2 sync. \r\n\r\nThe reason for this L1/L2 sync split is a bunch of legacy code from a long time ago. Bedrock improves on this significantly by removing the distinction between L1/L2 sync and by propagating \"unsafe\" blocks over a p2p network and marking them \"safe\" when those same blocks can be derived purely based on L1 data. This means Bedrock nodes should stay in sync almost perfectly, with some minor delay as blocks get propagated over the p2p network. You can run a Bedrock Goerli node to see this in action today. Bedrock is coming to mainnet soon(tm).",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1404459504/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1404465521",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/3727#issuecomment-1404465521",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/3727",
    "id": 1404465521,
    "node_id": "IC_kwDODjvEJM5TtnFx",
    "user": {
      "login": "midas-glitch",
      "id": 88002158,
      "node_id": "MDQ6VXNlcjg4MDAyMTU4",
      "avatar_url": "https://avatars.githubusercontent.com/u/88002158?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/midas-glitch",
      "html_url": "https://github.com/midas-glitch",
      "followers_url": "https://api.github.com/users/midas-glitch/followers",
      "following_url": "https://api.github.com/users/midas-glitch/following{/other_user}",
      "gists_url": "https://api.github.com/users/midas-glitch/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/midas-glitch/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/midas-glitch/subscriptions",
      "organizations_url": "https://api.github.com/users/midas-glitch/orgs",
      "repos_url": "https://api.github.com/users/midas-glitch/repos",
      "events_url": "https://api.github.com/users/midas-glitch/events{/privacy}",
      "received_events_url": "https://api.github.com/users/midas-glitch/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-26T01:52:09Z",
    "updated_at": "2023-01-26T01:52:09Z",
    "author_association": "NONE",
    "body": "> > Would you be able to elaborate?\r\n> \r\n> It depends on how you're running the node. In the current (\"legacy\") version of the system, there are two operating modes, L1 sync and L2 sync. L1 sync is always behind the Sequencer because it only looks at L1 data. L2 sync should be much faster but has a trust assumption on the L2 node you're syncing from. So if you want fast sync, first make sure that you're using L2 sync.\r\n> \r\n> The reason for this L1/L2 sync split is a bunch of legacy code from a long time ago. Bedrock improves on this significantly by removing the distinction between L1/L2 sync and by propagating \"unsafe\" blocks over a p2p network and marking them \"safe\" when those same blocks can be derived purely based on L1 data. This means Bedrock nodes should stay in sync almost perfectly, with some minor delay as blocks get propagated over the p2p network. You can run a Bedrock Goerli node to see this in action today. Bedrock is coming to mainnet soon(tm).\r\n\r\nSo you are saying that the p2p aspect would also improve the ability to stay synced from L2 is that correct? Because the delayed blocks we mentioned are even when syncing from L2 currently. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1404465521/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1404477127",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/3727#issuecomment-1404477127",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/3727",
    "id": 1404477127,
    "node_id": "IC_kwDODjvEJM5Ttp7H",
    "user": {
      "login": "smartcontracts",
      "id": 14298799,
      "node_id": "MDQ6VXNlcjE0Mjk4Nzk5",
      "avatar_url": "https://avatars.githubusercontent.com/u/14298799?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/smartcontracts",
      "html_url": "https://github.com/smartcontracts",
      "followers_url": "https://api.github.com/users/smartcontracts/followers",
      "following_url": "https://api.github.com/users/smartcontracts/following{/other_user}",
      "gists_url": "https://api.github.com/users/smartcontracts/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/smartcontracts/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/smartcontracts/subscriptions",
      "organizations_url": "https://api.github.com/users/smartcontracts/orgs",
      "repos_url": "https://api.github.com/users/smartcontracts/repos",
      "events_url": "https://api.github.com/users/smartcontracts/events{/privacy}",
      "received_events_url": "https://api.github.com/users/smartcontracts/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-26T02:05:26Z",
    "updated_at": "2023-01-26T02:05:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yes, that's correct, p2p should be much faster and you avoid the extra overhead of the DTL",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/1404477127/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
