{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/873",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/873/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/873/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/873/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/873",
  "id": 891552053,
  "node_id": "MDU6SXNzdWU4OTE1NTIwNTM=",
  "number": 873,
  "title": "Don't mix up OVM and EVM addresses",
  "user": {
    "login": "maurelian",
    "id": 23033765,
    "node_id": "MDQ6VXNlcjIzMDMzNzY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/23033765?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/maurelian",
    "html_url": "https://github.com/maurelian",
    "followers_url": "https://api.github.com/users/maurelian/followers",
    "following_url": "https://api.github.com/users/maurelian/following{/other_user}",
    "gists_url": "https://api.github.com/users/maurelian/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/maurelian/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/maurelian/subscriptions",
    "organizations_url": "https://api.github.com/users/maurelian/orgs",
    "repos_url": "https://api.github.com/users/maurelian/repos",
    "events_url": "https://api.github.com/users/maurelian/events{/privacy}",
    "received_events_url": "https://api.github.com/users/maurelian/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2907832583,
      "node_id": "MDU6TGFiZWwyOTA3ODMyNTgz",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/C-maintenance",
      "name": "C-maintenance",
      "color": "C5DEF5",
      "default": false,
      "description": "Category: PRs that clean code up or issues documenting cleanup."
    },
    {
      "id": 2978714528,
      "node_id": "MDU6TGFiZWwyOTc4NzE0NTI4",
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/labels/good%20first%20issue",
      "name": "good first issue",
      "color": "C2E0C6",
      "default": true,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 8,
  "created_at": "2021-05-14T03:01:00Z",
  "updated_at": "2021-10-10T11:32:29Z",
  "closed_at": "2021-10-10T11:32:29Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "The `address _contract` argument in `_handleExternalMessage` can be either an EVM or OVM address, depending on whether the intent is to make a `CALL` or `CREATE` (ie. indicated by the boolean arg). \r\n\r\nhttps://github.com/ethereum-optimism/optimism/blob/cb2e9ad2548788613f2c135258ae8a7e5ba917be/packages/contracts/contracts/optimistic-ethereum/OVM/execution/OVM_ExecutionManager.sol#L947-L952\r\n\r\nThis mixing of types hurts my heart. \r\n\r\nA better approach proposed by @ben-chain would be to pass them in different fields, and use their presence/absence to indicate whether to `CALL` or `CREATE`. \r\n\r\n```\r\n function _handleExternalMessage( \r\n     MessageContext memory _nextMessageContext, \r\n     uint256 _gasLimit, \r\n     address _contractToCall,\r\n     address _contractToCreate,\r\n     bytes memory _data\r\n) {\r\n   assert(_contractToCall  == address(0) || _contractToCreate == address(0)); // assert because this should be unreachable. \r\n   if (_contractToCreate != address(0)) {\r\n       // creation logic\r\n   } else {\r\n      // call logic \r\n\r\n  }\r\n}\r\n\r\n```\r\n---\r\n\r\nLonger term, it would be nice to get some proper type safety so that EVM and OVM addresses are not interchangeable. \r\n\r\nWe could use single field structs: \r\n```\r\nstruct EthAddress {\r\n   address addr\r\n}\r\nstruct OvmAddress {\r\n   address addr\r\n}\r\n```\r\nOr even just label one of them as `bytes20`? ðŸ™ˆ ",
  "closed_by": {
    "login": "maurelian",
    "id": 23033765,
    "node_id": "MDQ6VXNlcjIzMDMzNzY1",
    "avatar_url": "https://avatars.githubusercontent.com/u/23033765?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/maurelian",
    "html_url": "https://github.com/maurelian",
    "followers_url": "https://api.github.com/users/maurelian/followers",
    "following_url": "https://api.github.com/users/maurelian/following{/other_user}",
    "gists_url": "https://api.github.com/users/maurelian/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/maurelian/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/maurelian/subscriptions",
    "organizations_url": "https://api.github.com/users/maurelian/orgs",
    "repos_url": "https://api.github.com/users/maurelian/repos",
    "events_url": "https://api.github.com/users/maurelian/events{/privacy}",
    "received_events_url": "https://api.github.com/users/maurelian/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/873/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/873/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/840991470",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/873#issuecomment-840991470",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/873",
    "id": 840991470,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MDk5MTQ3MA==",
    "user": {
      "login": "prestwich",
      "id": 10149425,
      "node_id": "MDQ6VXNlcjEwMTQ5NDI1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10149425?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestwich",
      "html_url": "https://github.com/prestwich",
      "followers_url": "https://api.github.com/users/prestwich/followers",
      "following_url": "https://api.github.com/users/prestwich/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestwich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestwich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestwich/subscriptions",
      "organizations_url": "https://api.github.com/users/prestwich/orgs",
      "repos_url": "https://api.github.com/users/prestwich/repos",
      "events_url": "https://api.github.com/users/prestwich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestwich/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-14T04:04:18Z",
    "updated_at": "2021-05-14T04:04:18Z",
    "author_association": "NONE",
    "body": "> Or even just label one of them as bytes20? ðŸ™ˆ\r\n\r\nworth noting that this conversion costs a shift which can't be optimized out. `uint160()` should be free when optimized\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/840991470/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/841226947",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/873#issuecomment-841226947",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/873",
    "id": 841226947,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTIyNjk0Nw==",
    "user": {
      "login": "maurelian",
      "id": 23033765,
      "node_id": "MDQ6VXNlcjIzMDMzNzY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23033765?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maurelian",
      "html_url": "https://github.com/maurelian",
      "followers_url": "https://api.github.com/users/maurelian/followers",
      "following_url": "https://api.github.com/users/maurelian/following{/other_user}",
      "gists_url": "https://api.github.com/users/maurelian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maurelian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maurelian/subscriptions",
      "organizations_url": "https://api.github.com/users/maurelian/orgs",
      "repos_url": "https://api.github.com/users/maurelian/repos",
      "events_url": "https://api.github.com/users/maurelian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maurelian/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-14T12:57:18Z",
    "updated_at": "2021-05-14T12:57:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "Wait what? There's a meaningful difference between bytes20 and uint160?",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/841226947/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/841249307",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/873#issuecomment-841249307",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/873",
    "id": 841249307,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTI0OTMwNw==",
    "user": {
      "login": "prestwich",
      "id": 10149425,
      "node_id": "MDQ6VXNlcjEwMTQ5NDI1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10149425?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestwich",
      "html_url": "https://github.com/prestwich",
      "followers_url": "https://api.github.com/users/prestwich/followers",
      "following_url": "https://api.github.com/users/prestwich/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestwich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestwich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestwich/subscriptions",
      "organizations_url": "https://api.github.com/users/prestwich/orgs",
      "repos_url": "https://api.github.com/users/prestwich/repos",
      "events_url": "https://api.github.com/users/prestwich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestwich/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-14T13:36:41Z",
    "updated_at": "2021-05-14T14:52:31Z",
    "author_association": "NONE",
    "body": "alignment within the word. `bytes20` is left-aligned while `address` and `uint160` are right-aligned. Casting `address` to `bytes20` (or vice versa) requires a shift to change the alignment",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/841249307/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/841297213",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/873#issuecomment-841297213",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/873",
    "id": 841297213,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTI5NzIxMw==",
    "user": {
      "login": "prestwich",
      "id": 10149425,
      "node_id": "MDQ6VXNlcjEwMTQ5NDI1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10149425?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestwich",
      "html_url": "https://github.com/prestwich",
      "followers_url": "https://api.github.com/users/prestwich/followers",
      "following_url": "https://api.github.com/users/prestwich/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestwich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestwich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestwich/subscriptions",
      "organizations_url": "https://api.github.com/users/prestwich/orgs",
      "repos_url": "https://api.github.com/users/prestwich/repos",
      "events_url": "https://api.github.com/users/prestwich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestwich/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-14T14:58:45Z",
    "updated_at": "2021-05-14T14:58:45Z",
    "author_association": "NONE",
    "body": "to give some examples:\r\n\r\naddress: `0x000000000000000000000000abcdabcdabcdabcdabcdabcdabcdabcdabcdabcd`\r\nuint160: `0x000000000000000000000000abcdabcdabcdabcdabcdabcdabcdabcdabcdabcd`\r\nbytes20: `0xabcdabcdabcdabcdabcdabcdabcdabcdabcdabcd000000000000000000000000`",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/841297213/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/841298082",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/873#issuecomment-841298082",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/873",
    "id": 841298082,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTI5ODA4Mg==",
    "user": {
      "login": "prestwich",
      "id": 10149425,
      "node_id": "MDQ6VXNlcjEwMTQ5NDI1",
      "avatar_url": "https://avatars.githubusercontent.com/u/10149425?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/prestwich",
      "html_url": "https://github.com/prestwich",
      "followers_url": "https://api.github.com/users/prestwich/followers",
      "following_url": "https://api.github.com/users/prestwich/following{/other_user}",
      "gists_url": "https://api.github.com/users/prestwich/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/prestwich/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/prestwich/subscriptions",
      "organizations_url": "https://api.github.com/users/prestwich/orgs",
      "repos_url": "https://api.github.com/users/prestwich/repos",
      "events_url": "https://api.github.com/users/prestwich/events{/privacy}",
      "received_events_url": "https://api.github.com/users/prestwich/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-14T15:00:13Z",
    "updated_at": "2021-05-14T15:01:48Z",
    "author_association": "NONE",
    "body": "this is why we have to do\r\n`address(uint160(uint256(keccak256(pubkey))))`\r\n\r\n`address(bytes20(keccak256(pubkey)))` will produce the _first_ 20 bytes, as the cast from `bytes32` to `bytes20` preserves alignment",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/841298082/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/841314390",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/873#issuecomment-841314390",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/873",
    "id": 841314390,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MTMxNDM5MA==",
    "user": {
      "login": "maurelian",
      "id": 23033765,
      "node_id": "MDQ6VXNlcjIzMDMzNzY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23033765?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maurelian",
      "html_url": "https://github.com/maurelian",
      "followers_url": "https://api.github.com/users/maurelian/followers",
      "following_url": "https://api.github.com/users/maurelian/following{/other_user}",
      "gists_url": "https://api.github.com/users/maurelian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maurelian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maurelian/subscriptions",
      "organizations_url": "https://api.github.com/users/maurelian/orgs",
      "repos_url": "https://api.github.com/users/maurelian/repos",
      "events_url": "https://api.github.com/users/maurelian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maurelian/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-14T15:26:28Z",
    "updated_at": "2021-05-14T15:27:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "@prestwich I see. Thanks!\r\n\r\nI think this suggestion from @nventuro is a great option: \r\n\r\n>for address values, empty interfaces get you something like typedef. we've successfully used them in Bal v2: \r\nhttps://github.com/balancer-labs/balancer-core-v2/blob/6fb1006113f5598b4d40e60c554d2fd0ef9682db/pkg/core/contracts/vault/interfaces/IAsset.sol#L17-L26\r\n\r\nhttps://github.com/balancer-labs/balancer-core-v2/blob/6fb1006113f5598b4d40e60c554d2fd0ef9682db/pkg/core/contracts/lib/helpers/AssetHelpers.sol#L43",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/841314390/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/861751020",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/873#issuecomment-861751020",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/873",
    "id": 861751020,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MTc1MTAyMA==",
    "user": {
      "login": "maurelian",
      "id": 23033765,
      "node_id": "MDQ6VXNlcjIzMDMzNzY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23033765?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maurelian",
      "html_url": "https://github.com/maurelian",
      "followers_url": "https://api.github.com/users/maurelian/followers",
      "following_url": "https://api.github.com/users/maurelian/following{/other_user}",
      "gists_url": "https://api.github.com/users/maurelian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maurelian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maurelian/subscriptions",
      "organizations_url": "https://api.github.com/users/maurelian/orgs",
      "repos_url": "https://api.github.com/users/maurelian/repos",
      "events_url": "https://api.github.com/users/maurelian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maurelian/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-15T18:52:30Z",
    "updated_at": "2021-06-15T18:52:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "Mid-June review of my open issues: I still think this is worth doing.",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/861751020/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/939465684",
    "html_url": "https://github.com/ethereum-optimism/optimism/issues/873#issuecomment-939465684",
    "issue_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/873",
    "id": 939465684,
    "node_id": "IC_kwDODjvEJM43_xvU",
    "user": {
      "login": "maurelian",
      "id": 23033765,
      "node_id": "MDQ6VXNlcjIzMDMzNzY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23033765?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maurelian",
      "html_url": "https://github.com/maurelian",
      "followers_url": "https://api.github.com/users/maurelian/followers",
      "following_url": "https://api.github.com/users/maurelian/following{/other_user}",
      "gists_url": "https://api.github.com/users/maurelian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maurelian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maurelian/subscriptions",
      "organizations_url": "https://api.github.com/users/maurelian/orgs",
      "repos_url": "https://api.github.com/users/maurelian/repos",
      "events_url": "https://api.github.com/users/maurelian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maurelian/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-10T11:31:55Z",
    "updated_at": "2021-10-10T11:31:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "This was an EM/SM related matter. Closing. ",
    "reactions": {
      "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/comments/939465684/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
