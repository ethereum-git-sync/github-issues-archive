{
  "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/6606",
  "repository_url": "https://api.github.com/repos/ethereum-optimism/optimism",
  "labels_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/6606/labels{/name}",
  "comments_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/6606/comments",
  "events_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/6606/events",
  "html_url": "https://github.com/ethereum-optimism/optimism/issues/6606",
  "id": 1837522574,
  "node_id": "I_kwDODjvEJM5thl6O",
  "number": 6606,
  "title": "Why we filter out batches that were included too late?",
  "user": {
    "login": "cryptocifer",
    "id": 4777457,
    "node_id": "MDQ6VXNlcjQ3Nzc0NTc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4777457?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cryptocifer",
    "html_url": "https://github.com/cryptocifer",
    "followers_url": "https://api.github.com/users/cryptocifer/followers",
    "following_url": "https://api.github.com/users/cryptocifer/following{/other_user}",
    "gists_url": "https://api.github.com/users/cryptocifer/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cryptocifer/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cryptocifer/subscriptions",
    "organizations_url": "https://api.github.com/users/cryptocifer/orgs",
    "repos_url": "https://api.github.com/users/cryptocifer/repos",
    "events_url": "https://api.github.com/users/cryptocifer/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cryptocifer/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2023-08-05T02:08:06Z",
  "updated_at": "2023-08-05T02:11:20Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I met the \"batch was included too late\" issue on production and the blocks can never be proceeded.\r\n\r\nafter checking the code I found such filtering rule:\r\n\r\nhttps://github.com/ethereum-optimism/optimism/blob/develop/op-node/rollup/derive/batches.go#L64-L67\r\n\r\n```\r\n\t// Filter out batches that were included too late.\r\n\tif uint64(batch.Batch.EpochNum)+cfg.SeqWindowSize < batch.L1InclusionBlock.Number {\r\n\t\tlog.Warn(\"batch was included too late, sequence window expired\")\r\n\t\treturn BatchDrop\r\n\t}\r\n```\r\n\r\nIf for some reason our batcher stopped running, and then recovers and continues writing batches to L1, the batches will be written to newer L1 blocks so that be even \"late\".\r\nIf we filter out them here, the same batch will never be able to derived right?",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/6606/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/ethereum-optimism/optimism/issues/6606/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[

]
