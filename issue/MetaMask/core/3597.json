{
  "url": "https://api.github.com/repos/MetaMask/core/issues/3597",
  "repository_url": "https://api.github.com/repos/MetaMask/core",
  "labels_url": "https://api.github.com/repos/MetaMask/core/issues/3597/labels{/name}",
  "comments_url": "https://api.github.com/repos/MetaMask/core/issues/3597/comments",
  "events_url": "https://api.github.com/repos/MetaMask/core/issues/3597/events",
  "html_url": "https://github.com/MetaMask/core/issues/3597",
  "id": 2019574001,
  "node_id": "I_kwDOCBB0Cc54YEDx",
  "number": 3597,
  "title": "[assets-controllers] `TokenRatesController` state `contractExchangeRates` is stale after calling  `updateExchangeRatesByChainId`",
  "user": {
    "login": "Gudahtt",
    "id": 2459287,
    "node_id": "MDQ6VXNlcjI0NTkyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2459287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Gudahtt",
    "html_url": "https://github.com/Gudahtt",
    "followers_url": "https://api.github.com/users/Gudahtt/followers",
    "following_url": "https://api.github.com/users/Gudahtt/following{/other_user}",
    "gists_url": "https://api.github.com/users/Gudahtt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Gudahtt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Gudahtt/subscriptions",
    "organizations_url": "https://api.github.com/users/Gudahtt/orgs",
    "repos_url": "https://api.github.com/users/Gudahtt/repos",
    "events_url": "https://api.github.com/users/Gudahtt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Gudahtt/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 948148992,
      "node_id": "MDU6TGFiZWw5NDgxNDg5OTI=",
      "url": "https://api.github.com/repos/MetaMask/core/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    },
    {
      "id": 5330766523,
      "node_id": "LA_kwDOCBB0Cc8AAAABPb0Kuw",
      "url": "https://api.github.com/repos/MetaMask/core/labels/team-shared-libraries",
      "name": "team-shared-libraries",
      "color": "c5def5",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2023-11-30T21:55:44Z",
  "updated_at": "2023-11-30T21:59:54Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "When the method `updateExchangeRatesByChainId` is called directly, it never updates the `contractExchangeRates` state. It should update that state as well when appropriate (e.g. when the chain ID that we're fetching exchange rates for happens to be the current selected chain) so that the controller state does not become contradictory.\r\n\r\nTo give some context, at the moment this controller has two sets of exchange rates: one for the current selected chain, and another that is the same thing but for all chains (keyed by chain ID). The  `updateExchangeRatesByChainId` method is only updating the `contractExchangeRatesByChainId` state, not the `contractExchangeRates`  state.\r\n\r\nThis is risky because different parts of the application may be obtaining the same information (the exchange rates for a given network), and getting a different answer depending on which state they got the answer from.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/MetaMask/core/issues/3597/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/MetaMask/core/issues/3597/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[

]
