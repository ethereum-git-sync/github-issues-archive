{
  "url": "https://api.github.com/repos/MetaMask/core/issues/753",
  "repository_url": "https://api.github.com/repos/MetaMask/core",
  "labels_url": "https://api.github.com/repos/MetaMask/core/issues/753/labels{/name}",
  "comments_url": "https://api.github.com/repos/MetaMask/core/issues/753/comments",
  "events_url": "https://api.github.com/repos/MetaMask/core/issues/753/events",
  "html_url": "https://github.com/MetaMask/core/issues/753",
  "id": 1179856863,
  "node_id": "I_kwDOCBB0Cc5GUy_f",
  "number": 753,
  "title": "Merge the two network controllers",
  "user": {
    "login": "Gudahtt",
    "id": 2459287,
    "node_id": "MDQ6VXNlcjI0NTkyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2459287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Gudahtt",
    "html_url": "https://github.com/Gudahtt",
    "followers_url": "https://api.github.com/users/Gudahtt/followers",
    "following_url": "https://api.github.com/users/Gudahtt/following{/other_user}",
    "gists_url": "https://api.github.com/users/Gudahtt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Gudahtt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Gudahtt/subscriptions",
    "organizations_url": "https://api.github.com/users/Gudahtt/orgs",
    "repos_url": "https://api.github.com/users/Gudahtt/repos",
    "events_url": "https://api.github.com/users/Gudahtt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Gudahtt/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 948148996,
      "node_id": "MDU6TGFiZWw5NDgxNDg5OTY=",
      "url": "https://api.github.com/repos/MetaMask/core/labels/enhancement",
      "name": "enhancement",
      "color": "a2eeef",
      "default": true,
      "description": "New feature or request"
    },
    {
      "id": 3884427940,
      "node_id": "LA_kwDOCBB0Cc7nh6qk",
      "url": "https://api.github.com/repos/MetaMask/core/labels/Epic",
      "name": "Epic",
      "color": "4660F9",
      "default": false,
      "description": null
    },
    {
      "id": 5330766523,
      "node_id": "LA_kwDOCBB0Cc8AAAABPb0Kuw",
      "url": "https://api.github.com/repos/MetaMask/core/labels/team-shared-libraries",
      "name": "team-shared-libraries",
      "color": "c5def5",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2022-03-24T18:08:09Z",
  "updated_at": "2023-07-19T18:16:47Z",
  "closed_at": "2023-07-19T18:16:47Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "Merge the network controller in this repository with the extension network controller.\r\n\r\nGeneral guidelines:\r\n\r\n* Write comprehensive unit tests for both current network controllers\r\n  * This is the first step so that we can be certain how each controller behaves before we merge them. This will help ensure nothing changes unintentionally, especially breaking changes.\r\n  * We can test the \"configuration management\" and the \"RPC message handling\" layers separately. For both current controllers, most of the controller API is for configuration management. The RPC message handling is solely in the \"network client\" object, which we can test independently from the controller API.\r\n* Document all functional differences between each controller\r\n* Extract any API interactions or complex utility functions\r\n  * We want to minimize the direct responsibilities that our controllers have, so that they are simpler and easier to maintain. They need to be responsible for ensuring the integrity of our state, so that the wallet is always in a \"valid\" state, and to accomplish this goal the controllers will include most of the \"business logic\" of the wallet. But we can extract parts of this logic to other modules/libraries/middleware/etc. as appropriate, to keep the controllers focused on high-level operations and state management.\r\n  * At the moment, there are many RPC middleware steps setup by the extension network controller that have nothing to do with the network (see `createMetamaskMiddleware.js`). These can be extracted to be setup alongside the rest of our RPC pipeline.\r\n  * The extension network controller is also responsible at the moment for creating the \"provider proxy\" that we use internally. This could be extracted from the controller, it doesn't need to have this responsibility.\r\n* Normalize functionality across both controllers\r\n  * We can proceed one-at-a-time through the list of functional differences prepared earlier. For each difference, we can change one or both controllers to have the same behaviour. The fewer differences we have, the easier the final migration will be.\r\n  * It may not be practical to remove 100% of differences at this stage. Use your best judgement to decide whether a difference can be eliminated before the merge or not.\r\n* Migrate the `@metamask/controllers` network controller to BaseControllerV2\r\n  * This will serve as the basis for the merged controller.\r\n* Migrate the extension to use the `@metamask/controllers` network controller.",
  "closed_by": {
    "login": "xinnanyemm",
    "id": 116830388,
    "node_id": "U_kgDOBvawtA",
    "avatar_url": "https://avatars.githubusercontent.com/u/116830388?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/xinnanyemm",
    "html_url": "https://github.com/xinnanyemm",
    "followers_url": "https://api.github.com/users/xinnanyemm/followers",
    "following_url": "https://api.github.com/users/xinnanyemm/following{/other_user}",
    "gists_url": "https://api.github.com/users/xinnanyemm/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/xinnanyemm/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/xinnanyemm/subscriptions",
    "organizations_url": "https://api.github.com/users/xinnanyemm/orgs",
    "repos_url": "https://api.github.com/users/xinnanyemm/repos",
    "events_url": "https://api.github.com/users/xinnanyemm/events{/privacy}",
    "received_events_url": "https://api.github.com/users/xinnanyemm/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/MetaMask/core/issues/753/reactions",
    "total_count": 7,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 2,
    "confused": 0,
    "heart": 2,
    "rocket": 1,
    "eyes": 2
  },
  "timeline_url": "https://api.github.com/repos/MetaMask/core/issues/753/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/MetaMask/core/issues/comments/1087884078",
    "html_url": "https://github.com/MetaMask/core/issues/753#issuecomment-1087884078",
    "issue_url": "https://api.github.com/repos/MetaMask/core/issues/753",
    "id": 1087884078,
    "node_id": "IC_kwDOCBB0Cc5A18su",
    "user": {
      "login": "mcmire",
      "id": 7371,
      "node_id": "MDQ6VXNlcjczNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7371?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mcmire",
      "html_url": "https://github.com/mcmire",
      "followers_url": "https://api.github.com/users/mcmire/followers",
      "following_url": "https://api.github.com/users/mcmire/following{/other_user}",
      "gists_url": "https://api.github.com/users/mcmire/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mcmire/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mcmire/subscriptions",
      "organizations_url": "https://api.github.com/users/mcmire/orgs",
      "repos_url": "https://api.github.com/users/mcmire/repos",
      "events_url": "https://api.github.com/users/mcmire/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mcmire/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-04-04T18:34:44Z",
    "updated_at": "2022-04-04T18:35:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "Notes from standup today:\r\n\r\n* Currently we are using `web3-provider-engine` in mobile and `json-rpc-engine` in extension, which relies on `web3`. We should use `json-rpc-engine` in the shared version to remove that dependency.\r\n* Currently we use `eth-query` to talk to the network. We should consider using `ethers` instead, as it has a simpler, more piecemeal API and supports TypeScript. This requires that `eth-json-rpc-middleware` return a provider that is EIP-1194-compatible, so that it can be passed to `ethers`.\r\n\r\nTo do both of these, we should first write unit tests in the extension and in mobile for the JSON-RPC methods that are usable by the provider that NetworkController exposes. This way we can ensure that the behavior that our new version of NetworkController exposes supports all of the same functionality as the individual network controllers, and therefore it should be easier for the new version to be a drop-in replacement for the old.",
    "reactions": {
      "url": "https://api.github.com/repos/MetaMask/core/issues/comments/1087884078/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
