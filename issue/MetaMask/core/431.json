{
  "url": "https://api.github.com/repos/MetaMask/core/issues/431",
  "repository_url": "https://api.github.com/repos/MetaMask/core",
  "labels_url": "https://api.github.com/repos/MetaMask/core/issues/431/labels{/name}",
  "comments_url": "https://api.github.com/repos/MetaMask/core/issues/431/comments",
  "events_url": "https://api.github.com/repos/MetaMask/core/issues/431/events",
  "html_url": "https://github.com/MetaMask/core/issues/431",
  "id": 839732940,
  "node_id": "MDU6SXNzdWU4Mzk3MzI5NDA=",
  "number": 431,
  "title": "Redesign Keyring Controller API",
  "user": {
    "login": "Gudahtt",
    "id": 2459287,
    "node_id": "MDQ6VXNlcjI0NTkyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2459287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Gudahtt",
    "html_url": "https://github.com/Gudahtt",
    "followers_url": "https://api.github.com/users/Gudahtt/followers",
    "following_url": "https://api.github.com/users/Gudahtt/following{/other_user}",
    "gists_url": "https://api.github.com/users/Gudahtt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Gudahtt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Gudahtt/subscriptions",
    "organizations_url": "https://api.github.com/users/Gudahtt/orgs",
    "repos_url": "https://api.github.com/users/Gudahtt/repos",
    "events_url": "https://api.github.com/users/Gudahtt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Gudahtt/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 948148996,
      "node_id": "MDU6TGFiZWw5NDgxNDg5OTY=",
      "url": "https://api.github.com/repos/MetaMask/core/labels/enhancement",
      "name": "enhancement",
      "color": "a2eeef",
      "default": true,
      "description": "New feature or request"
    },
    {
      "id": 3884427940,
      "node_id": "LA_kwDOCBB0Cc7nh6qk",
      "url": "https://api.github.com/repos/MetaMask/core/labels/Epic",
      "name": "Epic",
      "color": "4660F9",
      "default": false,
      "description": null
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "Gudahtt",
    "id": 2459287,
    "node_id": "MDQ6VXNlcjI0NTkyODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2459287?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Gudahtt",
    "html_url": "https://github.com/Gudahtt",
    "followers_url": "https://api.github.com/users/Gudahtt/followers",
    "following_url": "https://api.github.com/users/Gudahtt/following{/other_user}",
    "gists_url": "https://api.github.com/users/Gudahtt/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Gudahtt/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Gudahtt/subscriptions",
    "organizations_url": "https://api.github.com/users/Gudahtt/orgs",
    "repos_url": "https://api.github.com/users/Gudahtt/repos",
    "events_url": "https://api.github.com/users/Gudahtt/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Gudahtt/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "Gudahtt",
      "id": 2459287,
      "node_id": "MDQ6VXNlcjI0NTkyODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2459287?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gudahtt",
      "html_url": "https://github.com/Gudahtt",
      "followers_url": "https://api.github.com/users/Gudahtt/followers",
      "following_url": "https://api.github.com/users/Gudahtt/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gudahtt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gudahtt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gudahtt/subscriptions",
      "organizations_url": "https://api.github.com/users/Gudahtt/orgs",
      "repos_url": "https://api.github.com/users/Gudahtt/repos",
      "events_url": "https://api.github.com/users/Gudahtt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gudahtt/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-03-24T13:37:45Z",
  "updated_at": "2023-04-27T11:37:32Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "The keyring controller API is confusing and difficult to extend.\r\n\r\nToday we have two \"keyring controllers\". The first is the original one, `eth-keyring-controller`, which is used by both projects. The second is `@metamask/keyring-controller`, which is used by mobile as a wrapper around `eth-keyring-controller`.\r\n\r\n`@metamask/keyring-controller` mainly serves to coordinate changes between `eth-keyring-controller` and other controllers. It also handles some keyring-interaction related tasks that aren't handled by `eth-keyring-controller`, such as input parsing for imported accounts.\r\n  * Side-note: In the extension, the closest equivalent to this wrapper class is a collection of keyring-related methods that are directly in `metamask-controller.js`. This collection of functions serves the same purpose that `@metamask/keyring-controller` does for mobile.\r\n\r\nMy questions are:\r\n* What is the KeyringController (`eth-keyring-controller`) responsible for exactly? Why are some keyring methods called _through_ the KeyringController, while others are called directly on keyrings?\r\n* What is the wrapper KeyringController class responsible for? Can we avoid the need for a wrapper class altogether?\r\n* How can we extend the capabilities of keyrings and integrate keyrings with additional setup requirements without requiring custom methods in the keyring controller? \r\n\r\nThe outcome of this task should be a proposal in Notion.\r\n\r\nRelated issues:\r\n* https://github.com/MetaMask/core/issues/1107\r\n* https://github.com/MetaMask/core/issues/1101\r\n\r\nEdit: Work towards this has begun, but there is a bunch of preparation required first. Here's a rough checklist of the work involved:\r\n\r\n- [x] Introduce new `Keyring` interface that matches existing APIs as closely as possible\r\n  - [x] Create the `types` repo and all necessary basic types\r\n  - [x] Create new Keyring interface (work in progress here: https://github.com/MetaMask/utils/pull/74)\r\n- [x] browser-passworder\r\n  - [x] Standardize and clean up the repository\r\n  - [x] Migrate to TypeScript\r\n  - [x] Rename the repository and package\r\n- [x] obs-store\r\n  - [x] Standardize and clean up the repository\r\n  - [x] Migrate to TypeScript\r\n  - [x] Rename the repository and package\r\n- [x] eth-sig-util\r\n  - [x] Standardize and clean up the repository\r\n  - [x] Migrate to TypeScript\r\n  - [x] Rename the repository and package\r\n- [x] eth-simple-keyring \r\n  - [x] Standardize and clean up the repository\r\n  - [x] Migrate to TypeScript (https://github.com/MetaMask/eth-simple-keyring/issues/135)\r\n  - [x] Rename the repository and package\r\n- [x] KeyringController\r\n  - [x] Standardize and clean up the repository\r\n  - [x] Migrate to TypeScript (https://github.com/MetaMask/KeyringController/issues/195)\r\n  - [x] Rename the repository and package\r\n- [x] eth-hd-keyring \r\n  - [x] Standardize and clean up the repository\r\n  - [x] Migrate to TypeScript (https://github.com/metamask/eth-hd-keyring/issues/84)\r\n  - [x] Rename the package\r\n- [x] eth-trezor-keyring \r\n  - [x] Standardize and clean up the repository (https://github.com/metamask/eth-trezor-keyring/issues/157)\r\n  - [x] Migrate to TypeScript (https://github.com/metamask/eth-trezor-keyring/issues/156)\r\n  - [x] Rename the package (https://github.com/MetaMask/eth-trezor-keyring/issues/158)\r\n- [x] eth-ledger-bridge-keyring \r\n  - [x] Standardize and clean up the repository (https://github.com/metamask/eth-ledger-bridge-keyring/issues/155)\r\n  - [x] Migrate to TypeScript (https://github.com/metamask/eth-ledger-bridge-keyring/issues/23)\r\n  - [x] Rename the package",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/MetaMask/core/issues/431/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/MetaMask/core/issues/431/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/MetaMask/core/issues/comments/805831645",
    "html_url": "https://github.com/MetaMask/core/issues/431#issuecomment-805831645",
    "issue_url": "https://api.github.com/repos/MetaMask/core/issues/431",
    "id": 805831645,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNTgzMTY0NQ==",
    "user": {
      "login": "Gudahtt",
      "id": 2459287,
      "node_id": "MDQ6VXNlcjI0NTkyODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2459287?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gudahtt",
      "html_url": "https://github.com/Gudahtt",
      "followers_url": "https://api.github.com/users/Gudahtt/followers",
      "following_url": "https://api.github.com/users/Gudahtt/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gudahtt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gudahtt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gudahtt/subscriptions",
      "organizations_url": "https://api.github.com/users/Gudahtt/orgs",
      "repos_url": "https://api.github.com/users/Gudahtt/repos",
      "events_url": "https://api.github.com/users/Gudahtt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gudahtt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-24T13:41:55Z",
    "updated_at": "2021-03-24T13:41:55Z",
    "author_association": "MEMBER",
    "body": "I'm not sure where I land yet on all of these questions. I have a draft answer for the first one though:\r\n\r\n* The KeyringController (`eth-keyring-controller`) holds references to all keyrings, and is responsible for locking/unlocking, but don't provide pass-through methods for interactiing with keyrings. The rest of the codebase interacts directly with keyrings when performing keyring-related operations.\r\n* The IdentityController holds the \"identities\" state currently in the PreferencesController, and handles most identity-related functionality that is currently provided by the KeyringController wrapper. Most of the rest of the codebase doesn't deal directly with keys or keyrings - they deal with this \"identity\" abstraction.\r\n* The AccountTrackerController remains basically as-is, responding to state updates from the IdentityController.",
    "reactions": {
      "url": "https://api.github.com/repos/MetaMask/core/issues/comments/805831645/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/MetaMask/core/issues/comments/880256105",
    "html_url": "https://github.com/MetaMask/core/issues/431#issuecomment-880256105",
    "issue_url": "https://api.github.com/repos/MetaMask/core/issues/431",
    "id": 880256105,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg4MDI1NjEwNQ==",
    "user": {
      "login": "Gudahtt",
      "id": 2459287,
      "node_id": "MDQ6VXNlcjI0NTkyODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2459287?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gudahtt",
      "html_url": "https://github.com/Gudahtt",
      "followers_url": "https://api.github.com/users/Gudahtt/followers",
      "following_url": "https://api.github.com/users/Gudahtt/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gudahtt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gudahtt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gudahtt/subscriptions",
      "organizations_url": "https://api.github.com/users/Gudahtt/orgs",
      "repos_url": "https://api.github.com/users/Gudahtt/repos",
      "events_url": "https://api.github.com/users/Gudahtt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gudahtt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-14T22:40:07Z",
    "updated_at": "2021-07-14T22:41:22Z",
    "author_association": "MEMBER",
    "body": "I've begun work to prepare for the new proposed Keyring APIs. It would have been challenging to move directly from what we have now to the new API because we've fallen behind in maintaining these repos and their dependencies. At the moment they're using JavaScript, they're full of inconsistencies and extra non-standard functions, they have outdated dependencies, they don't follow our standard lint rules, etc. So I'll be making an effort to clean them up and migrate them to TypeScript first. This will make more clear what their existing APIs are, so the proposed changes will be easier to understand, review, and implement.\r\n\r\nI've added a rough checklist of the work involved to the issue description.",
    "reactions": {
      "url": "https://api.github.com/repos/MetaMask/core/issues/comments/880256105/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/MetaMask/core/issues/comments/1076642265",
    "html_url": "https://github.com/MetaMask/core/issues/431#issuecomment-1076642265",
    "issue_url": "https://api.github.com/repos/MetaMask/core/issues/431",
    "id": 1076642265,
    "node_id": "IC_kwDOCBB0Cc5ALEHZ",
    "user": {
      "login": "mcmire",
      "id": 7371,
      "node_id": "MDQ6VXNlcjczNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7371?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mcmire",
      "html_url": "https://github.com/mcmire",
      "followers_url": "https://api.github.com/users/mcmire/followers",
      "following_url": "https://api.github.com/users/mcmire/following{/other_user}",
      "gists_url": "https://api.github.com/users/mcmire/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mcmire/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mcmire/subscriptions",
      "organizations_url": "https://api.github.com/users/mcmire/orgs",
      "repos_url": "https://api.github.com/users/mcmire/repos",
      "events_url": "https://api.github.com/users/mcmire/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mcmire/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-23T17:53:46Z",
    "updated_at": "2022-03-23T17:53:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "This may already be covered by the above, but linking this issue in case it gives us ideas: https://github.com/MetaMask/controllers/issues/35",
    "reactions": {
      "url": "https://api.github.com/repos/MetaMask/core/issues/comments/1076642265/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/MetaMask/core/issues/comments/1434942503",
    "html_url": "https://github.com/MetaMask/core/issues/431#issuecomment-1434942503",
    "issue_url": "https://api.github.com/repos/MetaMask/core/issues/431",
    "id": 1434942503,
    "node_id": "IC_kwDOCBB0Cc5Vh3wn",
    "user": {
      "login": "Gudahtt",
      "id": 2459287,
      "node_id": "MDQ6VXNlcjI0NTkyODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2459287?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Gudahtt",
      "html_url": "https://github.com/Gudahtt",
      "followers_url": "https://api.github.com/users/Gudahtt/followers",
      "following_url": "https://api.github.com/users/Gudahtt/following{/other_user}",
      "gists_url": "https://api.github.com/users/Gudahtt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Gudahtt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Gudahtt/subscriptions",
      "organizations_url": "https://api.github.com/users/Gudahtt/orgs",
      "repos_url": "https://api.github.com/users/Gudahtt/repos",
      "events_url": "https://api.github.com/users/Gudahtt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Gudahtt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-17T17:08:09Z",
    "updated_at": "2023-02-17T17:08:09Z",
    "author_association": "MEMBER",
    "body": "The scope of this issue was too broad. I split out [the identity state management](https://github.com/MetaMask/core/issues/1107) to a separate issue, as well as the [consolidation of keyring code between extension and mobile](https://github.com/MetaMask/core/issues/1101).",
    "reactions": {
      "url": "https://api.github.com/repos/MetaMask/core/issues/comments/1434942503/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
