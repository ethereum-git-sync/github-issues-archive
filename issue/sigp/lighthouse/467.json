{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/467",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/467/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/467/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/467/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/467",
  "id": 474395326,
  "node_id": "MDU6SXNzdWU0NzQzOTUzMjY=",
  "number": 467,
  "title": "Project directory restructure",
  "user": {
    "login": "paulhauner",
    "id": 6660660,
    "node_id": "MDQ6VXNlcjY2NjA2NjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/paulhauner",
    "html_url": "https://github.com/paulhauner",
    "followers_url": "https://api.github.com/users/paulhauner/followers",
    "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
    "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
    "organizations_url": "https://api.github.com/users/paulhauner/orgs",
    "repos_url": "https://api.github.com/users/paulhauner/repos",
    "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/paulhauner/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1232620456,
      "node_id": "MDU6TGFiZWwxMjMyNjIwNDU2",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/RFC",
      "name": "RFC",
      "color": "4aaa19",
      "default": false,
      "description": "Request for comment"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "paulhauner",
    "id": 6660660,
    "node_id": "MDQ6VXNlcjY2NjA2NjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/paulhauner",
    "html_url": "https://github.com/paulhauner",
    "followers_url": "https://api.github.com/users/paulhauner/followers",
    "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
    "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
    "organizations_url": "https://api.github.com/users/paulhauner/orgs",
    "repos_url": "https://api.github.com/users/paulhauner/repos",
    "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/paulhauner/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2019-07-30T06:21:38Z",
  "updated_at": "2020-05-18T11:24:24Z",
  "closed_at": "2020-05-18T11:24:24Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nOur current directory structure is not clear when it comes to the `eth2/utils` directory. For example:\r\n\r\n- `serde_hex` is not ethereum specific.\r\n- Why is `ssz` in `eth2/utils`, not in `eth2`? (and vice-versa for things in `eth2/`, why aren't they in `eth2/utils`?)\r\n\r\nI propose the following change.\r\n\r\n## Proposal\r\n\r\nHere are the directories that should live in the root:\r\n\r\n- `beacon_node`: binary + any crates that are specific to the binary.\r\n- `validator_client`: binary + any crates that are specific to the binary.\r\n- `account_manager`: binary + any crates that are specific to the binary.\r\n- `utils`: any non-ethereum-specific utility crates (e.g., logging, serde utils, etc).\r\n- `eth`: ethereum-specific libraries (may be related to eth1 or eth2).\r\n- `testing`: binaries or libraries that are exclusively for testing (e.g., ef tests, test harness).\r\n- `docs`: documentation\r\n\r\nHere's an example tree:\r\n```\r\n- beacon_node/\r\n  |- src/\r\n  |- client/\r\n  |- network/\r\n  |- Cargo.toml\r\n- validator_client/\r\n  |- src/\r\n  |- Cargo.toml\r\n- account_manager/\r\n  |- src/\r\n  |- Cargo.toml\r\n- utils/\r\n  |- logging/\r\n  |- serde_hex/\r\n- eth/\r\n  |- beacon_state_processing/\r\n  |- beacon_types\r\n  |- lmd_ghost\r\n  |- shard_types\r\n  |- ssz\r\n  |- tree_hash\r\n- testing/\r\n  |- ef_tests\r\n  |- test_harness\r\n- docs/\r\n  |- contributing.md\r\n```\r\nAdditionally, in order to have a clear name space between beacon chain things and shard chain things, I propose:\r\n\r\n- Prefix the existing `state_processing` and `types` crates with `beacon_`. When we add shard chain specific things, prefix with `shard_`. This is going to become important as the Quilt team contributes and we need to keep that code separate from the Phase 0 security review.\r\n\r\n## Summary\r\n\r\nThe changes are mostly around flattening the current `eth2/utils/` structure and making a distinction between general utils and ethereum-specific utils.\r\n\r\nKeen to hear people's thoughts.\r\n",
  "closed_by": {
    "login": "paulhauner",
    "id": 6660660,
    "node_id": "MDQ6VXNlcjY2NjA2NjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/paulhauner",
    "html_url": "https://github.com/paulhauner",
    "followers_url": "https://api.github.com/users/paulhauner/followers",
    "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
    "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
    "organizations_url": "https://api.github.com/users/paulhauner/orgs",
    "repos_url": "https://api.github.com/users/paulhauner/repos",
    "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/paulhauner/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/467/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/467/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/517050336",
    "html_url": "https://github.com/sigp/lighthouse/issues/467#issuecomment-517050336",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/467",
    "id": 517050336,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNzA1MDMzNg==",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-07-31T22:46:16Z",
    "updated_at": "2019-07-31T22:46:16Z",
    "author_association": "MEMBER",
    "body": "I quite like this restructure!\r\n\r\nI was thinking we should maybe use subdirectories for `beacon` and `shard` code, but actually I think the prefix is better because it trivially propagates to the crate name (you don't end up with two crates called `state_processing`).\r\n\r\nOne crate that's missing in the current plan is the operation pool, it could live under either `eth/beacon_op_pool` (similar to the current situation) or `beacon_node/op_pool` (possibly cleaner?)\r\n\r\nAlso, `eth2/validator_change`? I'd never noticed this crate, it seems to be dead code. We could delete it as part of the restructure, if not before.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/517050336/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/622248701",
    "html_url": "https://github.com/sigp/lighthouse/issues/467#issuecomment-622248701",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/467",
    "id": 622248701,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMjI0ODcwMQ==",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-01T04:58:24Z",
    "updated_at": "2020-05-01T04:58:24Z",
    "author_association": "MEMBER",
    "body": "As mentioned in #1089, it would be nice to have a separation of \"consensus critical\" code from other code. As such, here's an updated proposal:\r\n\r\n## Proposal\r\n\r\nHere are the directories that should live in the root:\r\n\r\n- `lighthouse`: binary that encapsulates `beacon_node`, `validator_client` and `account_manager`.\r\n- `beacon_node`: library + any crates that are specific to the binary.\r\n- `validator_client`: library + any crates that are specific to the binary.\r\n- `account_manager`: library + any crates that are specific to the binary.\r\n- `common`: any crate that is used by more than one other top-level crate, but is not consensus critical.\r\n- `consensus`: \"consensus critical\" eth2 libraries.\r\n- `testing`: binaries or libraries that are exclusively for testing (e.g., ef tests, test harness).\r\n- `lcli`: the testing CLI tool, separate from `lighthouse` since it isn't user-facing.\r\n- `book`: documentation\r\n\r\nOf course, \"consensus critical\" is a bit blurry so I don't think we can make a firm rule about it, but I think we could define it roughly as \"pure state transition logic\". I think we'll have to deal with this on a case-by-case.\r\n\r\nHere's an example tree:\r\n```\r\n- beacon_node/\r\n  |- src/\r\n  |- client/\r\n  |- network/\r\n  |- Cargo.toml\r\n- validator_client/\r\n  |- src/\r\n  |- Cargo.toml\r\n- account_manager/\r\n  |- src/\r\n  |- Cargo.toml\r\n- utils/\r\n  |- logging/\r\n  |- serde_hex/\r\n- consensus/\r\n  |- state_processing/\r\n  |- types\r\n  |- proto_array_fork_choice\r\n  |- eth2_ssz\r\n  |- eth2_hashing\r\n- testing/\r\n  |- ef_tests\r\n  |- test_harness\r\n- lcli/\r\n  |- src/\r\n- docs/\r\n  |- contributing.md\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/622248701/reactions",
      "total_count": 4,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/625045921",
    "html_url": "https://github.com/sigp/lighthouse/issues/467#issuecomment-625045921",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/467",
    "id": 625045921,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNTA0NTkyMQ==",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-07T05:59:26Z",
    "updated_at": "2020-05-07T05:59:26Z",
    "author_association": "MEMBER",
    "body": "I'm also in favour of adding a root-level `crypto/` dir which can contain things like:\r\n\r\n- `bls`\r\n- `merkle_hashing`\r\n- `eth2_keystore`\r\n- ..etc",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/625045921/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
