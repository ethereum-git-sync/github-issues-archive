{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/1732",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/1732/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/1732/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/1732/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/1732",
  "id": 714589056,
  "node_id": "MDU6SXNzdWU3MTQ1ODkwNTY=",
  "number": 1732,
  "title": "Update last seen peer store variable",
  "user": {
    "login": "AgeManning",
    "id": 7454587,
    "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AgeManning",
    "html_url": "https://github.com/AgeManning",
    "followers_url": "https://api.github.com/users/AgeManning/followers",
    "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
    "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
    "organizations_url": "https://api.github.com/users/AgeManning/orgs",
    "repos_url": "https://api.github.com/users/AgeManning/repos",
    "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AgeManning/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 985647284,
      "node_id": "MDU6TGFiZWw5ODU2NDcyODQ=",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/enhancement",
      "name": "enhancement",
      "color": "a2eeef",
      "default": true,
      "description": "New feature or request"
    },
    {
      "id": 2490305065,
      "node_id": "MDU6TGFiZWwyNDkwMzA1MDY1",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/A1",
      "name": "A1",
      "color": "223184",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2020-10-05T07:21:49Z",
  "updated_at": "2020-11-12T01:45:09Z",
  "closed_at": "2020-11-12T01:45:09Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nImprove the resolution of the peer state in the peer store. \r\n\r\n- Update the last-seen instant in our peer store when we receive a ping/pong. These values are mainly for up to date information in our peer store. Nothing relies on this variable.\r\n- Update the state of peers to dialing when they are being dialed (ensure that this is consistent throughout the code base). \r\n- Update the state of peers when attempting to disconnect",
  "closed_by": {
    "login": "AgeManning",
    "id": 7454587,
    "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AgeManning",
    "html_url": "https://github.com/AgeManning",
    "followers_url": "https://api.github.com/users/AgeManning/followers",
    "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
    "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
    "organizations_url": "https://api.github.com/users/AgeManning/orgs",
    "repos_url": "https://api.github.com/users/AgeManning/repos",
    "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AgeManning/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/1732/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/1732/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/725566230",
    "html_url": "https://github.com/sigp/lighthouse/issues/1732#issuecomment-725566230",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1732",
    "id": 725566230,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNTU2NjIzMA==",
    "user": {
      "login": "blacktemplar",
      "id": 3133334,
      "node_id": "MDQ6VXNlcjMxMzMzMzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3133334?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/blacktemplar",
      "html_url": "https://github.com/blacktemplar",
      "followers_url": "https://api.github.com/users/blacktemplar/followers",
      "following_url": "https://api.github.com/users/blacktemplar/following{/other_user}",
      "gists_url": "https://api.github.com/users/blacktemplar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/blacktemplar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/blacktemplar/subscriptions",
      "organizations_url": "https://api.github.com/users/blacktemplar/orgs",
      "repos_url": "https://api.github.com/users/blacktemplar/repos",
      "events_url": "https://api.github.com/users/blacktemplar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/blacktemplar/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-11T17:47:50Z",
    "updated_at": "2020-11-11T17:47:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "I had a look at this issue and I am not sure if anything needs to be done here or if the issue is just outdated:\r\n\r\n- Connected peers have no last-seen instant stored. We only store `since` variables for `Disconnected`/`Banned`/`Dialing`. For `Disconnected` and `Banned` we do not get any ping/pongs, for `Dialing` I am not sure. But also for `Dialing` the name since suggests that this is the time we started dialing (and not the time of the last ping/pong).\r\n- As far as I can tell there is only one point in the code where we start dialing a peer: https://github.com/sigp/lighthouse/blob/9ee71d6fec643cb00e3ffcd39f4e7dd5d2a453f0/beacon_node/eth2_libp2p/src/peer_manager/mod.rs#L124-L127\r\n And in `connect_peer` we call `dialing_peer` that sets the status to `Dialing`.\r\n- There are five situations in the code base where we create a `PeerManagerEvent::DisconnectPeer` event to disconnect a peer. As far as I can tell in all five situations we already update the status correctly (even though through different methods). There are two situations when we receive a disconnect from the other peer and in both situations the code contains a comment explicitly stating that we don't inform the peer manager about it. If this issue is about that and we should change this behaviour I can look into that, but I am not sure if that is what is wanted here.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/725566230/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/725773891",
    "html_url": "https://github.com/sigp/lighthouse/issues/1732#issuecomment-725773891",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1732",
    "id": 725773891,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNTc3Mzg5MQ==",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-12T01:45:09Z",
    "updated_at": "2020-11-12T01:45:09Z",
    "author_association": "MEMBER",
    "body": "Previously we were storing time last seen in the connected state. This was planned to be used to positive scores. This issue was originally designed to update these. \r\n\r\nSo it sounds this is out-dated. ",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/725773891/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
