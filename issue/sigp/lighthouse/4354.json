{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/4354",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/4354/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/4354/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/4354/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/4354",
  "id": 1732610888,
  "node_id": "I_kwDOCFeAzc5nRYtI",
  "number": 4354,
  "title": "Old mdbx-sys starting to become an issue on fresh/newer linux installs",
  "user": {
    "login": "DaveWK",
    "id": 13626476,
    "node_id": "MDQ6VXNlcjEzNjI2NDc2",
    "avatar_url": "https://avatars.githubusercontent.com/u/13626476?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/DaveWK",
    "html_url": "https://github.com/DaveWK",
    "followers_url": "https://api.github.com/users/DaveWK/followers",
    "following_url": "https://api.github.com/users/DaveWK/following{/other_user}",
    "gists_url": "https://api.github.com/users/DaveWK/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/DaveWK/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/DaveWK/subscriptions",
    "organizations_url": "https://api.github.com/users/DaveWK/orgs",
    "repos_url": "https://api.github.com/users/DaveWK/repos",
    "events_url": "https://api.github.com/users/DaveWK/events{/privacy}",
    "received_events_url": "https://api.github.com/users/DaveWK/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2023-05-30T16:36:32Z",
  "updated_at": "2023-07-04T21:09:34Z",
  "closed_at": "2023-07-04T21:09:34Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nI noticed that on some of my fresh linux installs that the old version of mdbx-sys that is included by default no longer compiles correctly.. In the build logs I see:\r\n\r\n```error: failed to run custom build command for `mdbx-sys v0.11.6-4 (https://github.com/sigp/libmdbx-rs?tag=v0.1.4#096da80a)`\r\n\r\nCaused by:\r\n  process didn't exit successfully: `/opt/src/lighthouse/target/maxperf/build/mdbx-sys-c3a9ecd0986e3970/build-script-build` (exit status: 101)\r\n  --- stderr\r\n  thread 'main' panicked at '\"MDBX_version_info_struct_(unnamed_at_/root/_cargo/git/checkouts/libmdbx-rs-c1b523f5b64ff08c/096da80/mdbx-sys/libmdbx/mdbx_h_611_3)\" is not a valid Ident', /root/.cargo/registry/src/github.com-1ecc6299db9ec823/proc-macro2-1.0.58/src/fallback.rs:811:9\r\n  note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\r\nwarning: build failed, waiting for other jobs to finish...```\r\n\r\nI believe this is due to more recent linux builds using a newer glibc version. I can work around this by doing:\r\n```\r\nCARGO_INSTALL_EXTRA_FLAGS=\"--no-default-features\" FEATURES=slasher-lmdb,modern,jemalloc PROFILE=maxperf make\r\n```\r\n\r\nbut wanted you to be aware that this was occurring. It seems like there's been some updates to mdbx (which still claims to support windows on newer versions?)\r\n\r\n## Version\r\nAny/all",
  "closed_by": {
    "login": "paulhauner",
    "id": 6660660,
    "node_id": "MDQ6VXNlcjY2NjA2NjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/paulhauner",
    "html_url": "https://github.com/paulhauner",
    "followers_url": "https://api.github.com/users/paulhauner/followers",
    "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
    "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
    "organizations_url": "https://api.github.com/users/paulhauner/orgs",
    "repos_url": "https://api.github.com/users/paulhauner/repos",
    "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/paulhauner/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/4354/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/4354/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1570174357",
    "html_url": "https://github.com/sigp/lighthouse/issues/4354#issuecomment-1570174357",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4354",
    "id": 1570174357,
    "node_id": "IC_kwDOCFeAzc5dlvWV",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-31T12:50:09Z",
    "updated_at": "2023-05-31T12:50:09Z",
    "author_association": "MEMBER",
    "body": "Thanks, we're aware of the issue. I've been mulling over the best way to deal with it. I think we have 2 options:\r\n\r\n1. Deprecate MDBX and avoid building it by default. We can switch back to LMDB by default.\r\n2. Update the MDBX bindings, possibly using work from the Reth devs (https://github.com/paradigmxyz/reth/pull/2703). This would retain Windows support and improve Linux distro compatibility. The note in our docs about Windows support being removed upstream was mostly to do with the old MBDX Rust bindings (from which Windows support was deleted), and statements from the MDBX author which I think he's now gone back on.\r\n\r\nOption 1 would also remove the need for https://github.com/sigp/lighthouse/pull/4305 or https://github.com/sigp/lighthouse/pull/4305.\r\n\r\nI have a slight preference for Option 1, because I'm personally sick of dealing with MDBX-related issues. But perhaps the pragmatic solution is Option 2 (or a combination of updating MDBX _and_ deprecating it).",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1570174357/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1570180683",
    "html_url": "https://github.com/sigp/lighthouse/issues/4354#issuecomment-1570180683",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4354",
    "id": 1570180683,
    "node_id": "IC_kwDOCFeAzc5dlw5L",
    "user": {
      "login": "DaveWK",
      "id": 13626476,
      "node_id": "MDQ6VXNlcjEzNjI2NDc2",
      "avatar_url": "https://avatars.githubusercontent.com/u/13626476?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DaveWK",
      "html_url": "https://github.com/DaveWK",
      "followers_url": "https://api.github.com/users/DaveWK/followers",
      "following_url": "https://api.github.com/users/DaveWK/following{/other_user}",
      "gists_url": "https://api.github.com/users/DaveWK/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DaveWK/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DaveWK/subscriptions",
      "organizations_url": "https://api.github.com/users/DaveWK/orgs",
      "repos_url": "https://api.github.com/users/DaveWK/repos",
      "events_url": "https://api.github.com/users/DaveWK/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DaveWK/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-31T12:54:20Z",
    "updated_at": "2023-05-31T12:54:20Z",
    "author_association": "NONE",
    "body": "Not sure if this is helpful or not , but did noticed this repo seems to be keeping up w/ the lmdbx revs: https://github.com/vorot93/libmdbx-rs  and according to #7 on the doc, it still has windows support: https://libmdbx.dqdkfa.ru/",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1570180683/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1570189558",
    "html_url": "https://github.com/sigp/lighthouse/issues/4354#issuecomment-1570189558",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4354",
    "id": 1570189558,
    "node_id": "IC_kwDOCFeAzc5dlzD2",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-05-31T12:59:45Z",
    "updated_at": "2023-05-31T12:59:45Z",
    "author_association": "MEMBER",
    "body": "Those are the bindings we used to use. I added Windows to support to them, and Artem deleted the support in this commit https://github.com/vorot93/libmdbx-rs/commit/bd749c2d6c740eb9b5ab0c07140f2413723a18bb.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1570189558/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
