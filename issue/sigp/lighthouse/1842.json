{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/1842",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/1842/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/1842/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/1842/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/1842",
  "id": 733700561,
  "node_id": "MDU6SXNzdWU3MzM3MDA1NjE=",
  "number": 1842,
  "title": "0.3.2: CPU incompatible error with Ubuntu AWS instance",
  "user": {
    "login": "gregbkr",
    "id": 5642000,
    "node_id": "MDQ6VXNlcjU2NDIwMDA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5642000?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/gregbkr",
    "html_url": "https://github.com/gregbkr",
    "followers_url": "https://api.github.com/users/gregbkr/followers",
    "following_url": "https://api.github.com/users/gregbkr/following{/other_user}",
    "gists_url": "https://api.github.com/users/gregbkr/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/gregbkr/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/gregbkr/subscriptions",
    "organizations_url": "https://api.github.com/users/gregbkr/orgs",
    "repos_url": "https://api.github.com/users/gregbkr/repos",
    "events_url": "https://api.github.com/users/gregbkr/events{/privacy}",
    "received_events_url": "https://api.github.com/users/gregbkr/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2020-10-31T11:40:36Z",
  "updated_at": "2020-11-02T23:35:24Z",
  "closed_at": "2020-11-02T23:35:24Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nHello!\r\n\r\nUsing the last version 0.3.2 with VPS ubuntu 20.04 on AWS (2CPU 4GB RAM):\r\n```\r\nwget https://github.com/sigp/lighthouse/releases/download/v0.3.2/lighthouse-v0.3.2-x86_64-unknown-linux-gnu.tar.gz\r\ntar -xvf lighthouse-v0.3.2-x86_64-unknown-linux-gnu.tar.gz lighthouse\r\n\r\n./lighthouse --testnet medalla beacon --http --http-address 0.0.0.0\r\nCPU incompatible with optimized binary, please try Lighthouse portable build\r\n\r\nuname -a\r\nLinux ip-172-31-5-242 5.4.0-1024-aws #24-Ubuntu SMP Sat Sep 5 06:19:55 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux\r\n```\r\n\r\n## Version\r\n\r\n0.3.2\r\nIt is fine with 0.3.0 or 0.3.1\r\n\r\n## Present Behaviour\r\n\r\nError : `CPU incompatible with optimized binary, please try Lighthouse portable build`\r\n\r\n## Expected Behaviour\r\n\r\nIt should work on this x64 VPS system.\r\n\r\n## Steps to resolve\r\n\r\nI will use 0.3.1 or the 0.3.2 portable then.\r\n\r\nThanks!",
  "closed_by": {
    "login": "bors[bot]",
    "id": 26634292,
    "node_id": "MDM6Qm90MjY2MzQyOTI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors%5Bbot%5D",
    "html_url": "https://github.com/apps/bors",
    "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/1842/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/1842/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/719931752",
    "html_url": "https://github.com/sigp/lighthouse/issues/1842#issuecomment-719931752",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1842",
    "id": 719931752,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxOTkzMTc1Mg==",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-31T13:10:26Z",
    "updated_at": "2020-10-31T13:11:23Z",
    "author_association": "MEMBER",
    "body": "It's strange that the previous non-portable builds worked for you, because in theory they should have been compiled with the same CPU features and would have just crashed with a SIGILL error on a CPU lacking those features ü§î. The explicit error is the main new part of 0.3.2\n\nEither way, best to stick to the portable builds for that VPS. If you upgrade your VPS at some point you could try to get an instance with ADX instruction support, because that's what the fast build requires. I think the AWS \"compute\" instances have ADX.\n\nI'll close this issue for now, but please let us know if you run into any other issues ‚ò∫Ô∏è",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/719931752/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/720171586",
    "html_url": "https://github.com/sigp/lighthouse/issues/1842#issuecomment-720171586",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1842",
    "id": 720171586,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyMDE3MTU4Ng==",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-01T23:46:22Z",
    "updated_at": "2020-11-01T23:46:22Z",
    "author_association": "MEMBER",
    "body": "I just ran into this same issue on my Vultr VPS. It seems that the cheap VPS providers are spoofing the CPUID instruction, even on CPUs that support ADX. For example, `cat /proc/cpuinfo` shows a Skylake CPU, but no ADX!\r\n\r\n```\r\nprocessor       : 0\r\nvendor_id       : GenuineIntel\r\ncpu family      : 6\r\nmodel           : 85\r\nmodel name      : Intel Xeon Processor (Skylake, IBRS)\r\nstepping        : 4\r\nmicrocode       : 0x1\r\ncpu MHz         : 2593.904\r\ncache size      : 16384 KB\r\nphysical id     : 0\r\nsiblings        : 4\r\ncore id         : 0\r\ncpu cores       : 4\r\napicid          : 0\r\ninitial apicid  : 0\r\nfpu             : yes\r\nfpu_exception   : yes\r\ncpuid level     : 13\r\nwp              : yes\r\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ht syscall nx pdpe1gb rdtscp lm constant_tsc rep_good nopl xtopology cpuid tsc_known_freq pni pclmulqdq ssse3 fma cx16 pcid sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand hypervisor lahf_lm abm cpuid_fault invpcid_single pti ssbd ibrs ibpb fsgsbase bmi1 hle avx2 smep bmi2 erms invpcid rtm avx512f avx512dq clwb avx512cd avx512bw avx512vl xsaveopt arat pku ospke\r\nbugs            : cpu_meltdown spectre_v1 spectre_v2 spec_store_bypass l1tf mds swapgs taa itlb_multihit\r\nbogomips        : 5187.80\r\nclflush size    : 64\r\ncache_alignment : 64\r\naddress sizes   : 40 bits physical, 48 bits virtual\r\npower management:\r\n```\r\n\r\nAnd the CPUID instruction also returns `false` for the ADX flag:\r\n\r\n```$ cpuid\r\nextended feature flags (7):\r\n      ...\r\n      ADX instructions                         = false\r\n```\r\n\r\nI'm going to test now whether actually executing ADX instructions fails",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/720171586/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 2
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/720222348",
    "html_url": "https://github.com/sigp/lighthouse/issues/1842#issuecomment-720222348",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1842",
    "id": 720222348,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyMDIyMjM0OA==",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-02T03:54:18Z",
    "updated_at": "2020-11-02T03:54:18Z",
    "author_association": "MEMBER",
    "body": "Executing ADX instructions works fine, at least on my VPS, so I've downgraded the error to a warning in this PR https://github.com/sigp/lighthouse/pull/1846",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/720222348/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
