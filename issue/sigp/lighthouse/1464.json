{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/1464",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/1464/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/1464/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/1464/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/1464",
  "id": 673201976,
  "node_id": "MDU6SXNzdWU2NzMyMDE5NzY=",
  "number": 1464,
  "title": "Increase capacity of logging channel",
  "user": {
    "login": "michaelsproul",
    "id": 4452260,
    "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/michaelsproul",
    "html_url": "https://github.com/michaelsproul",
    "followers_url": "https://api.github.com/users/michaelsproul/followers",
    "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
    "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
    "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
    "repos_url": "https://api.github.com/users/michaelsproul/repos",
    "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
    "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 985647286,
      "node_id": "MDU6TGFiZWw5ODU2NDcyODY=",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/good%20first%20issue",
      "name": "good first issue",
      "color": "7057ff",
      "default": true,
      "description": "Good for newcomers"
    },
    {
      "id": 1930671200,
      "node_id": "MDU6TGFiZWwxOTMwNjcxMjAw",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/low-hanging-fruit",
      "name": "low-hanging-fruit",
      "color": "5cbc18",
      "default": false,
      "description": "Easy to resolve, get it before someone else does!"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-08-05T02:22:01Z",
  "updated_at": "2020-09-03T01:19:46Z",
  "closed_at": "2020-09-03T01:19:46Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nThis is a relatively common occurrence:\r\n\r\n```\r\nAug 05 02:50:45.169 DEBG Invalid attestation from network        type: \"aggregated\", peer_id: 16Uiu2HAmUNnUNkc6HhU4i6fAEUxep9XdsCT56CkPQoCVZeGomFnE, block: 0x2cb7…28a7\r\nAug 05 02:50:45.169 DEBG Invalid attestation from network        type: \"aggregated\", peer_id: 16Uiu2HAmUNnUNkc6HhU4i6fAEUxep9XdsCT56CkPQoCVZeGomFnE, block: 0x2cb7…28a7\r\nAug 05 02:50:45.169 DEBG Invalid attestation from network        type: \"aggregated\", peer_id: 16Uiu2HAmUNnUNkc6HhU4i6fAEUxep9XdsCT56CkPQoCVZeGomFnE, block: 0x2cb7…28a7\r\nAug 05 02:50:45.169 DEBG Invalid attestation from network        type: \"aggregated\", peer_id: 16Uiu2HAmUNnUNkc6HhU4i6fAEUxep9XdsCT56CkPQoCVZeGomFnE, block: 0x2cb7…28a7\r\nAug 05 02:50:45.169 DEBG Invalid attestation from network        type: \"aggregated\", peer_id: 16Uiu2HAmUNnUNkc6HhU4i6fAEUxep9XdsCT56CkPQoCVZeGomFnE, block: 0x2cb7…28a7\r\nAug 05 02:50:45.169 DEBG Invalid attestation from network        type: \"aggregated\", peer_id: 16Uiu2HAmUNnUNkc6HhU4i6fAEUxep9XdsCT56CkPQoCVZeGomFnE, block: 0x2cb7…28a7\r\nAug 05 02:50:45.170 DEBG Invalid attestation from network        type: \"aggregated\", peer_id: 16Uiu2HAmUNnUNkc6HhU4i6fAEUxep9XdsCT56CkPQoCVZeGomFnE, block: 0x2cb7…28a7\r\nAug 05 02:50:45.170 DEBG Invalid attestation from network        type: \"aggregated\", peer_id: 16Uiu2HAmUNnUNkc6HhU4i6fAEUxep9XdsCT56CkPQoCVZeGomFnE, block: 0x2cb7…28a7\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 1\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 5\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 5\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 3\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 5\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 5\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 5\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 3\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 3\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 5\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 5\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 5\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 3\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 3\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 5\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 5\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 5\r\nAug 05 02:50:45.170 ERRO slog-async: logger dropped messages due to channel overflow, count: 3\r\nAug 05 02:50:45.170 DEBG Invalid attestation from network        type: \"aggregated\", peer_id: 16Uiu2HAmUNnUNkc6HhU4i6fAEUxep9XdsCT56CkPQoCVZeGomFnE, block: 0x2cb7…28a7\r\n```\r\n\r\n## Version\r\n\r\nLighthouse Lighthouse/v0.2.0/f26adc0a\r\nBLS Library: blst\r\n\r\n## Present Behaviour\r\n\r\nLog messages are frequently dropped.\r\n\r\n## Expected Behaviour\r\n\r\nLog messages should only be dropped in extreme cases, like #1463. Dropped logs could be obscuring important `CRIT` or `ERRO` messages -- as far as I can tell the logger doesn't prioritise these.\r\n\r\n## Steps to resolve\r\n\r\nIncrease the channel size as per https://github.com/slog-rs/async/issues/4 and confirm that a node running on Medalla experiences less dropped logs\r\n",
  "closed_by": {
    "login": "paulhauner",
    "id": 6660660,
    "node_id": "MDQ6VXNlcjY2NjA2NjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/paulhauner",
    "html_url": "https://github.com/paulhauner",
    "followers_url": "https://api.github.com/users/paulhauner/followers",
    "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
    "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
    "organizations_url": "https://api.github.com/users/paulhauner/orgs",
    "repos_url": "https://api.github.com/users/paulhauner/repos",
    "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/paulhauner/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/1464/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/1464/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/668964470",
    "html_url": "https://github.com/sigp/lighthouse/issues/1464#issuecomment-668964470",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1464",
    "id": 668964470,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2ODk2NDQ3MA==",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-05T03:53:01Z",
    "updated_at": "2020-08-05T03:53:01Z",
    "author_association": "MEMBER",
    "body": "PS: default capacity seems to be 128, we could go to 256/512 I reckon",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/668964470/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/679380578",
    "html_url": "https://github.com/sigp/lighthouse/issues/1464#issuecomment-679380578",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1464",
    "id": 679380578,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3OTM4MDU3OA==",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-24T21:39:42Z",
    "updated_at": "2020-08-24T21:39:42Z",
    "author_association": "MEMBER",
    "body": "@realbigsean this would also be quite valuable low-hanging-fruit :)",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/679380578/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/680193474",
    "html_url": "https://github.com/sigp/lighthouse/issues/1464#issuecomment-680193474",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1464",
    "id": 680193474,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4MDE5MzQ3NA==",
    "user": {
      "login": "realbigsean",
      "id": 5160426,
      "node_id": "MDQ6VXNlcjUxNjA0MjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5160426?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/realbigsean",
      "html_url": "https://github.com/realbigsean",
      "followers_url": "https://api.github.com/users/realbigsean/followers",
      "following_url": "https://api.github.com/users/realbigsean/following{/other_user}",
      "gists_url": "https://api.github.com/users/realbigsean/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/realbigsean/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/realbigsean/subscriptions",
      "organizations_url": "https://api.github.com/users/realbigsean/orgs",
      "repos_url": "https://api.github.com/users/realbigsean/repos",
      "events_url": "https://api.github.com/users/realbigsean/events{/privacy}",
      "received_events_url": "https://api.github.com/users/realbigsean/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-25T18:22:16Z",
    "updated_at": "2020-08-25T18:22:16Z",
    "author_association": "COLLABORATOR",
    "body": "I updated the channel size to 256 and tested it out using the local testnet scripts, 1024 validators, and trace logging.  It seemed to reduce the number of logs dropped (by about 10%)... but not completely eliminate the problem. I played around with other configurations but couldn't get zero logs dropped until using a channel size of 2048.  \r\n\r\nBecause the logging output scales with the # of validators, would it make sense to make this configurable? or have the default scale with the number of validators you're running?  Or are you guys happy with hard-coding a config greater than 128?",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/680193474/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/680915080",
    "html_url": "https://github.com/sigp/lighthouse/issues/1464#issuecomment-680915080",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1464",
    "id": 680915080,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4MDkxNTA4MA==",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-26T14:28:27Z",
    "updated_at": "2020-08-26T14:28:27Z",
    "author_association": "MEMBER",
    "body": "I'm happy for the size to hit 2048, it sounds like at most a few hundred KB in memory (2048 x 200 bytes per line)",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/680915080/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
