{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/4740",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/4740/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/4740/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/4740/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/4740",
  "id": 1899695612,
  "node_id": "I_kwDOCFeAzc5xOw38",
  "number": 4740,
  "title": "VC won't start without latest LH beacon connected to it",
  "user": {
    "login": "stefa2k",
    "id": 54934211,
    "node_id": "MDQ6VXNlcjU0OTM0MjEx",
    "avatar_url": "https://avatars.githubusercontent.com/u/54934211?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/stefa2k",
    "html_url": "https://github.com/stefa2k",
    "followers_url": "https://api.github.com/users/stefa2k/followers",
    "following_url": "https://api.github.com/users/stefa2k/following{/other_user}",
    "gists_url": "https://api.github.com/users/stefa2k/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/stefa2k/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/stefa2k/subscriptions",
    "organizations_url": "https://api.github.com/users/stefa2k/orgs",
    "repos_url": "https://api.github.com/users/stefa2k/repos",
    "events_url": "https://api.github.com/users/stefa2k/events{/privacy}",
    "received_events_url": "https://api.github.com/users/stefa2k/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-09-17T07:58:22Z",
  "updated_at": "2023-09-17T08:30:34Z",
  "closed_at": "2023-09-17T08:30:34Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nUpdated vc to `4.4.1` and it wouldn't properly do the liveness check and therefore stuck in doppelgänger.\r\n\r\n```\r\nERRO Liveness query omitted validators       requested: 500, current_epoch_response: 0, previous_epoch_response: 0, service: doppelganger\r\nCRIT Failed current epoch liveness query     current_epoch: 229461, error: Some endpoints failed, num_failed: 10 http://a.a.a.a:5052/ => Unavailable(Offline), http://b.b.b.b:5051/ => Unavailable(Offline), http://c.c.c.c:5052/ => Unavailable(Offline), http://d.d.d.d:9596/ => Unavailable(Offline), http://e.e.e.e:3500/ => Unavailable(Offline), http://a.a.a.a:5052/ => RequestFailed(\"Failed query for validator liveness: StatusCode(404)\"), http://b.b.b.b:5051/ => RequestFailed(\"Failed query for validator liveness: StatusCode(404)\"), http://d.d.d.d:5052/ => Unavailable(Offline), http://e.e.e.e:9596/ => Unavailable(Offline), http://f.f.f.f:3500/ => RequestFailed(\"Failed query for validator liveness: StatusCode(404)\"), service: doppelganger\r\n```\r\n\r\nNode a (Nimbus, latest version), node b (Teku, latest version), node f (Prysm, latest verion) are online and in sync. Teku beacon got liveness check enabled.\r\n\r\n## Version\r\n\r\n`4.4.1`\r\n\r\n## Present Behaviour\r\n\r\nVc stuck with doppelgänger\r\n\r\n## Expected Behaviour\r\n\r\nVc should be able to use nimbus/teku/prysm for doppelgänger check\r\n\r\n## Steps to resolve\r\n\r\nAdd lighthouse beacon",
  "closed_by": {
    "login": "stefa2k",
    "id": 54934211,
    "node_id": "MDQ6VXNlcjU0OTM0MjEx",
    "avatar_url": "https://avatars.githubusercontent.com/u/54934211?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/stefa2k",
    "html_url": "https://github.com/stefa2k",
    "followers_url": "https://api.github.com/users/stefa2k/followers",
    "following_url": "https://api.github.com/users/stefa2k/following{/other_user}",
    "gists_url": "https://api.github.com/users/stefa2k/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/stefa2k/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/stefa2k/subscriptions",
    "organizations_url": "https://api.github.com/users/stefa2k/orgs",
    "repos_url": "https://api.github.com/users/stefa2k/repos",
    "events_url": "https://api.github.com/users/stefa2k/events{/privacy}",
    "received_events_url": "https://api.github.com/users/stefa2k/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/4740/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/4740/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1722421728",
    "html_url": "https://github.com/sigp/lighthouse/issues/4740#issuecomment-1722421728",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4740",
    "id": 1722421728,
    "node_id": "IC_kwDOCFeAzc5mqhHg",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-17T08:15:05Z",
    "updated_at": "2023-09-17T08:15:05Z",
    "author_association": "MEMBER",
    "body": "I don't think this worked before. We didn't change anything in the Lighthouse VC doppelganger detection for v4.4.1, so it's still using the custom `/lighthouse/liveness` endpoint, same as previous versions. This should never have worked with Prysm/Nimbus/Teku or any other client apart from Lighthouse.\r\n\r\nSupport for using the standard liveness endpoint from the VC is being tracked here https://github.com/sigp/lighthouse/pull/4539, which we'll try to include in the next release. It's a recent addition to the API, and we just haven't switched the VC over to using it yet (and when we do it will break compatibility with old versions of Lighthouse that don't have the endpoint implemented).\r\n\r\nLet me know if I've missed something",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1722421728/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
