{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/3732",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/3732/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/3732/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/3732/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/3732",
  "id": 1451538729,
  "node_id": "I_kwDOCFeAzc5WhLkp",
  "number": 3732,
  "title": "Changing the log file permissions (at least under Windows)",
  "user": {
    "login": "xanatos",
    "id": 821344,
    "node_id": "MDQ6VXNlcjgyMTM0NA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/821344?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/xanatos",
    "html_url": "https://github.com/xanatos",
    "followers_url": "https://api.github.com/users/xanatos/followers",
    "following_url": "https://api.github.com/users/xanatos/following{/other_user}",
    "gists_url": "https://api.github.com/users/xanatos/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/xanatos/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/xanatos/subscriptions",
    "organizations_url": "https://api.github.com/users/xanatos/orgs",
    "repos_url": "https://api.github.com/users/xanatos/repos",
    "events_url": "https://api.github.com/users/xanatos/events{/privacy}",
    "received_events_url": "https://api.github.com/users/xanatos/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 985647286,
      "node_id": "MDU6TGFiZWw5ODU2NDcyODY=",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/good%20first%20issue",
      "name": "good first issue",
      "color": "7057ff",
      "default": true,
      "description": "Good for newcomers"
    },
    {
      "id": 3034786437,
      "node_id": "MDU6TGFiZWwzMDM0Nzg2NDM3",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/windows",
      "name": "windows",
      "color": "3B9ED5",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-11-16T12:44:22Z",
  "updated_at": "2022-12-01T06:59:57Z",
  "closed_at": "2022-12-01T06:59:57Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "The log file is created with the `.restrict_permissions(true)`\r\n\r\nhttps://github.com/sigp/lighthouse/blob/28aceaa213ad77a6a226242f12ea92b9fcac7342/lighthouse/environment/src/lib.rs#L223\r\n\r\nThis under Windows sets the file pemissions to OWNER_RIGHTS and nothing else (while normally under Windows files should inherit the permissions of the folder they are contained in), and it is quite a pain if you have the Lighthouse that is running under a user and you use another user to check the logs.\r\n\r\nWould it be possible to remove this restriction and/or to remove it under Windows?",
  "closed_by": {
    "login": "macladson",
    "id": 58379419,
    "node_id": "MDQ6VXNlcjU4Mzc5NDE5",
    "avatar_url": "https://avatars.githubusercontent.com/u/58379419?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/macladson",
    "html_url": "https://github.com/macladson",
    "followers_url": "https://api.github.com/users/macladson/followers",
    "following_url": "https://api.github.com/users/macladson/following{/other_user}",
    "gists_url": "https://api.github.com/users/macladson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/macladson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/macladson/subscriptions",
    "organizations_url": "https://api.github.com/users/macladson/orgs",
    "repos_url": "https://api.github.com/users/macladson/repos",
    "events_url": "https://api.github.com/users/macladson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/macladson/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/3732/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/3732/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1317750146",
    "html_url": "https://github.com/sigp/lighthouse/issues/3732#issuecomment-1317750146",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3732",
    "id": 1317750146,
    "node_id": "IC_kwDOCFeAzc5Oi0WC",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-16T22:20:30Z",
    "updated_at": "2022-11-16T22:20:30Z",
    "author_association": "MEMBER",
    "body": "Definitely something we can fix, just needs somebody willing to dig into Windows permissions and do it. Last time I attempted it with https://github.com/sigp/lighthouse/issues/2394 I got overwhelmed by the complexity of Windows file perms and gave up.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1317750146/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1319444967",
    "html_url": "https://github.com/sigp/lighthouse/issues/3732#issuecomment-1319444967",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3732",
    "id": 1319444967,
    "node_id": "IC_kwDOCFeAzc5OpSHn",
    "user": {
      "login": "macladson",
      "id": 58379419,
      "node_id": "MDQ6VXNlcjU4Mzc5NDE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58379419?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macladson",
      "html_url": "https://github.com/macladson",
      "followers_url": "https://api.github.com/users/macladson/followers",
      "following_url": "https://api.github.com/users/macladson/following{/other_user}",
      "gists_url": "https://api.github.com/users/macladson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macladson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macladson/subscriptions",
      "organizations_url": "https://api.github.com/users/macladson/orgs",
      "repos_url": "https://api.github.com/users/macladson/repos",
      "events_url": "https://api.github.com/users/macladson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macladson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-18T01:51:51Z",
    "updated_at": "2022-11-18T02:03:21Z",
    "author_association": "COLLABORATOR",
    "body": "To add more context to this, this is actually the behaviour of [Sloggers](https://github.com/sile/sloggers), the logging library responsible for the logfile. I think any changes should be made there, [see here](https://github.com/sile/sloggers/blob/master/src/permissions.rs#L43).\r\n\r\nI actually was the one that implemented the strict permissions in the library. The way it works is that it mirrors the behaviour on Linux (set the logfile to a umask of `600`). The rationale of this was that the logs contain certain sensitive information (validator indices/pubkeys) and so shouldn't be globally accessible.\r\n\r\nI'm by no means an expert in Windows file permissions so if this is improper behaviour for Windows specifically we should change it in Sloggers such that it also inherits the permissions of the folder.\r\n\r\nAlternatively we could implement a flag like `--logfile-no-restricted-perms` where we use `.restrict_permissions(false)` instead.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1319444967/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1321770599",
    "html_url": "https://github.com/sigp/lighthouse/issues/3732#issuecomment-1321770599",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3732",
    "id": 1321770599,
    "node_id": "IC_kwDOCFeAzc5OyJ5n",
    "user": {
      "login": "xanatos",
      "id": 821344,
      "node_id": "MDQ6VXNlcjgyMTM0NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/821344?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xanatos",
      "html_url": "https://github.com/xanatos",
      "followers_url": "https://api.github.com/users/xanatos/followers",
      "following_url": "https://api.github.com/users/xanatos/following{/other_user}",
      "gists_url": "https://api.github.com/users/xanatos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xanatos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xanatos/subscriptions",
      "organizations_url": "https://api.github.com/users/xanatos/orgs",
      "repos_url": "https://api.github.com/users/xanatos/repos",
      "events_url": "https://api.github.com/users/xanatos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xanatos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-21T09:39:28Z",
    "updated_at": "2022-11-21T09:39:28Z",
    "author_association": "NONE",
    "body": "> I'm by no means an expert in Windows file permissions so if this is improper behaviour for Windows specifically we should change it in Sloggers such that it also inherits the permissions of the folder.\r\n\r\nLet's say that it is unexpected. And even Linux has support for ACL.\r\nBut I do like the other proposal you made, this one:\r\n\r\n> Alternatively we could implement a flag like `--logfile-no-restricted-perms` where we use `.restrict_permissions(false)` instead.\r\n\r\nI do feel that there are different ways to setup a server and its services and its users, and your proposal lets the user choose how they want to handle everything.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1321770599/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1333296111",
    "html_url": "https://github.com/sigp/lighthouse/issues/3732#issuecomment-1333296111",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3732",
    "id": 1333296111,
    "node_id": "IC_kwDOCFeAzc5PeHvv",
    "user": {
      "login": "macladson",
      "id": 58379419,
      "node_id": "MDQ6VXNlcjU4Mzc5NDE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58379419?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macladson",
      "html_url": "https://github.com/macladson",
      "followers_url": "https://api.github.com/users/macladson/followers",
      "following_url": "https://api.github.com/users/macladson/following{/other_user}",
      "gists_url": "https://api.github.com/users/macladson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macladson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macladson/subscriptions",
      "organizations_url": "https://api.github.com/users/macladson/orgs",
      "repos_url": "https://api.github.com/users/macladson/repos",
      "events_url": "https://api.github.com/users/macladson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macladson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-01T06:59:57Z",
    "updated_at": "2022-12-01T06:59:57Z",
    "author_association": "COLLABORATOR",
    "body": "Closed by #3747 ",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1333296111/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
