{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/3315",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/3315/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/3315/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/3315/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/3315",
  "id": 1296660860,
  "node_id": "I_kwDOCFeAzc5NSXl8",
  "number": 3315,
  "title": "Failover not working for execution API in Sepolia test network",
  "user": {
    "login": "ronaldjmaas",
    "id": 32280203,
    "node_id": "MDQ6VXNlcjMyMjgwMjAz",
    "avatar_url": "https://avatars.githubusercontent.com/u/32280203?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ronaldjmaas",
    "html_url": "https://github.com/ronaldjmaas",
    "followers_url": "https://api.github.com/users/ronaldjmaas/followers",
    "following_url": "https://api.github.com/users/ronaldjmaas/following{/other_user}",
    "gists_url": "https://api.github.com/users/ronaldjmaas/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ronaldjmaas/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ronaldjmaas/subscriptions",
    "organizations_url": "https://api.github.com/users/ronaldjmaas/orgs",
    "repos_url": "https://api.github.com/users/ronaldjmaas/repos",
    "events_url": "https://api.github.com/users/ronaldjmaas/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ronaldjmaas/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 985647289,
      "node_id": "MDU6TGFiZWw5ODU2NDcyODk=",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/wontfix",
      "name": "wontfix",
      "color": "ffffff",
      "default": true,
      "description": "This will not be worked on"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-07-07T01:09:22Z",
  "updated_at": "2022-07-07T02:14:50Z",
  "closed_at": "2022-07-07T02:14:49Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nDuring testing the transition from PoW to Pos on Sepolia I noticed that failover to another execution client is not working as expected for the execution API\r\n\r\n## Version\r\n\r\nLighthouse v2.3.2-rc.0-45b2eb1\r\n\r\n## Present Behaviour\r\n\r\nI setup Lighthouse Beacon Node + Besu on localhost and Geth on a 2nd machine. Both eth1 endpoints and execution API end points are configured to connect to both Besu and Geth instances. Command line to start Lighthouse:\r\n\r\n/home/lighthouse/lighthouse-v2.3.2-rc0/sepolia/lighthouse bn --datadir /mnt/ethereum/lighthouse@/sepolia --network sepolia --port 9004 --eth1-endpoints http://localhost:8545,http://192.168.1.106:8545 --execution-endpoints http://localhost:8551,http://192.168.1.106:8551 --jwt-secrets /mnt/ethereum/lighthouse@/sepolia/jwt-besu-sepolia,/mnt/ethereum/lighthouse@/sepolia/jwt-geth-sepolia --staking --http\r\n\r\nAfter PoW > PoS transition first I shutdown the Geth (192.168.1.106) node and Lighthouse was working as expected. Then I started Geth and after a few minutes I shutdown the Besu (localhost), Lighthouse was unable to fail over to the Geth node and therefore unable to run without errors. Only after starting Besu Lighthouse was able to sync again.\r\n\r\nSecond experiment using a another command with Besu and Geth nodes reversed:\r\n\r\n/home/lighthouse/lighthouse-v2.3.2-rc0/sepolia/lighthouse bn --datadir /mnt/ethereum/lighthouse@/sepolia --network sepolia --port 9004 --eth1-endpoints http://192.168.1.106:8545,http://localhost:8545 --execution-endpoints http://192.168.1.106:8551,http://localhost:8551 --jwt-secrets /mnt/ethereum/lighthouse@/sepolia/jwt-geth-sepolia,/mnt/ethereum/lighthouse@/sepolia/jwt-besu-sepolia --staking --http\r\n\r\nNow with both Geth and Besu running Lighthouse was able to work as expected. Shutting down Besu (localhost) and Lighthouse keeps working as expected. Starting Besu and after a few minutes shutting down Geth (192.168.1.106) Lighthouse again was not able to failover to the working Besu node. Only after starting Geth Lighthouse was able to sync again. During this Besu continued printing a warning that no consensus layer client was connected to it.\r\n\r\n## Expected Behaviour\r\n\r\nLighthouse in the setup describe above should work properly when either Besu or Geth or both are up and running.\r\n\r\n## Steps to resolve\r\n\r\nHope you can investigate / fix why failover is not working when multiple nodes are specified in the --execution-endpoints and --jwt-secrets arguments. Thank you in advance.\r\n",
  "closed_by": {
    "login": "michaelsproul",
    "id": 4452260,
    "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/michaelsproul",
    "html_url": "https://github.com/michaelsproul",
    "followers_url": "https://api.github.com/users/michaelsproul/followers",
    "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
    "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
    "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
    "repos_url": "https://api.github.com/users/michaelsproul/repos",
    "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
    "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/3315/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/3315/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1176952866",
    "html_url": "https://github.com/sigp/lighthouse/issues/3315#issuecomment-1176952866",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3315",
    "id": 1176952866,
    "node_id": "IC_kwDOCFeAzc5GJuAi",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-07T01:52:32Z",
    "updated_at": "2022-07-07T01:52:32Z",
    "author_association": "MEMBER",
    "body": "Hey, sorry to hear you're having issues.\r\n\r\nExecution engine failover never worked particularly well and has been removed in our `unstable` branch as of this PR: https://github.com/sigp/lighthouse/pull/3214. The full rationale for removing this is described here: https://github.com/sigp/lighthouse/issues/3118. The solutions for multi-EL that exist today are:\r\n\r\n- https://github.com/karalabe/minority\r\n- https://github.com/TennisBowling/executionbackup",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1176952866/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1176959450",
    "html_url": "https://github.com/sigp/lighthouse/issues/3315#issuecomment-1176959450",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3315",
    "id": 1176959450,
    "node_id": "IC_kwDOCFeAzc5GJvna",
    "user": {
      "login": "ronaldjmaas",
      "id": 32280203,
      "node_id": "MDQ6VXNlcjMyMjgwMjAz",
      "avatar_url": "https://avatars.githubusercontent.com/u/32280203?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ronaldjmaas",
      "html_url": "https://github.com/ronaldjmaas",
      "followers_url": "https://api.github.com/users/ronaldjmaas/followers",
      "following_url": "https://api.github.com/users/ronaldjmaas/following{/other_user}",
      "gists_url": "https://api.github.com/users/ronaldjmaas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ronaldjmaas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ronaldjmaas/subscriptions",
      "organizations_url": "https://api.github.com/users/ronaldjmaas/orgs",
      "repos_url": "https://api.github.com/users/ronaldjmaas/repos",
      "events_url": "https://api.github.com/users/ronaldjmaas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ronaldjmaas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-07T02:05:46Z",
    "updated_at": "2022-07-07T02:05:46Z",
    "author_association": "NONE",
    "body": "Thanks for quick reaction. I understand the rationale and for the upcoming Goerli merge I make sure I setup 2 Lighthouse BNs each connecting to a single EL node.\r\n\r\nOnly ask for you and your team can do is updating the Lighthouse documentation + help text describing the --execution-endpoints and --jwt-secrets arguments.\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1176959450/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1176964714",
    "html_url": "https://github.com/sigp/lighthouse/issues/3315#issuecomment-1176964714",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3315",
    "id": 1176964714,
    "node_id": "IC_kwDOCFeAzc5GJw5q",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-07T02:14:49Z",
    "updated_at": "2022-07-07T02:14:49Z",
    "author_association": "MEMBER",
    "body": "Thanks, updating the docs is on our TODO list (tracked by this issue: https://github.com/sigp/lighthouse/issues/3260).",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1176964714/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
