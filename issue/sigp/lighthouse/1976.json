{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/1976",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/1976/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/1976/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/1976/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/1976",
  "id": 751094054,
  "node_id": "MDU6SXNzdWU3NTEwOTQwNTQ=",
  "number": 1976,
  "title": "Accessible API for monitoring of validator client",
  "user": {
    "login": "KaiRo-at",
    "id": 824140,
    "node_id": "MDQ6VXNlcjgyNDE0MA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/824140?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/KaiRo-at",
    "html_url": "https://github.com/KaiRo-at",
    "followers_url": "https://api.github.com/users/KaiRo-at/followers",
    "following_url": "https://api.github.com/users/KaiRo-at/following{/other_user}",
    "gists_url": "https://api.github.com/users/KaiRo-at/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/KaiRo-at/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/KaiRo-at/subscriptions",
    "organizations_url": "https://api.github.com/users/KaiRo-at/orgs",
    "repos_url": "https://api.github.com/users/KaiRo-at/repos",
    "events_url": "https://api.github.com/users/KaiRo-at/events{/privacy}",
    "received_events_url": "https://api.github.com/users/KaiRo-at/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2490305065,
      "node_id": "MDU6TGFiZWwyNDkwMzA1MDY1",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/A1",
      "name": "A1",
      "color": "223184",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-11-25T20:18:52Z",
  "updated_at": "2020-11-26T01:18:05Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nWe are running Lighthouse both as beacon node and validator client, in two separate docker containers. With the beacon API, we could create a python script running in a third contain that does decent monitoring of the beacon state and of on-chain knowledge of our validator(s). What is missing is actually being able to monitor the state of the validator client.\r\n\r\n## Version\r\n\r\nsigp/lighthouse:v1.0.0 image available from docker hub.\r\n\r\n## Present Behaviour\r\n\r\nCurrently, two problems exist: First, the validator API is not reachable from the python container as it's exposed only within its own container where nothing else can run. Second, the info that is nicely put in the validator log output is not nicely available in the API from what I can see.\r\n\r\n## Expected Behaviour\r\n\r\nI'd like to see an end point - available to a different docker container, at least with the right command line option - that gives me in machine-readable form what e.g. the most recent log line `Nov 25 19:18:13.001 INFO All validators active                   slot: 52590, epoch: 1643, total_validators: 1, active_validators: 1, proposers: 0, service: notifier` tells me as well. Ideally, I also get pubkeys or validator indexes of all validators in there so I can look up more details via the beacon node using that. Also nice would be last attestated slot/epoch for every validator.\r\n\r\n## Steps to resolve\r\n\r\nSorry, don't know what to put here right now ;-)\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/1976/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/1976/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/734004661",
    "html_url": "https://github.com/sigp/lighthouse/issues/1976#issuecomment-734004661",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1976",
    "id": 734004661,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDAwNDY2MQ==",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-26T00:22:23Z",
    "updated_at": "2020-11-26T00:23:33Z",
    "author_association": "MEMBER",
    "body": "> the most recent log line\r\n\r\nWe don't really have a connection from logs -> API at the moment, but it's something we could consider into in the medium term. In the meantime, I would suggest obtaining it from `syslogd` or whatever you're using to collect logs from the VC.\r\n\r\n> Ideally, I also get pubkeys or validator indexes of all validators in there so I can look up more details via the beacon node using that.\r\n\r\nThis exists here: https://lighthouse-book.sigmaprime.io/api-vc-endpoints.html#get-lighthousevalidators\r\n\r\n> Also nice would be last attestated slot/epoch for every validator.\r\n\r\nWe don't keep this in the VC presently, it's aiming to be as minimal as possible. It should be simple enough though, we could add this after genesis.\r\n\r\nAlso, this PR will be merged and released before genesis: https://github.com/sigp/lighthouse/pull/1954",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/734004661/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/734005616",
    "html_url": "https://github.com/sigp/lighthouse/issues/1976#issuecomment-734005616",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1976",
    "id": 734005616,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDAwNTYxNg==",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-26T00:26:06Z",
    "updated_at": "2020-11-26T00:26:06Z",
    "author_association": "MEMBER",
    "body": ">  First, the validator API is not reachable from the python container as it's exposed only within its own container where nothing else can run.\r\n\r\nOh right, your issue is that you can't listen on `0.0.0.0`? The idea with that is to stop people from exposing it on the internet. It should be fairly straight-forward to use SSH tunneling to reach it, a proxy or an `iptables` rule.\r\n\r\nWe could consider opening this port up to `0.0.0.0` but I'm very hesitant to allow people to do this. If you can't work around it on your end we can consider it.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/734005616/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/734006046",
    "html_url": "https://github.com/sigp/lighthouse/issues/1976#issuecomment-734006046",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1976",
    "id": 734006046,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDAwNjA0Ng==",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-26T00:27:51Z",
    "updated_at": "2020-11-26T00:27:51Z",
    "author_association": "MEMBER",
    "body": "Alright, I'll break this into separate points. Can you please confirm I've got it right.\r\n\r\n- Allow access to VC API via `0.0.0.0`.\r\n- View logs via VC API.\r\n- See some details about the last block/attestation for each validator, via the VC API.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/734006046/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/734018765",
    "html_url": "https://github.com/sigp/lighthouse/issues/1976#issuecomment-734018765",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1976",
    "id": 734018765,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDAxODc2NQ==",
    "user": {
      "login": "KaiRo-at",
      "id": 824140,
      "node_id": "MDQ6VXNlcjgyNDE0MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/824140?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/KaiRo-at",
      "html_url": "https://github.com/KaiRo-at",
      "followers_url": "https://api.github.com/users/KaiRo-at/followers",
      "following_url": "https://api.github.com/users/KaiRo-at/following{/other_user}",
      "gists_url": "https://api.github.com/users/KaiRo-at/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/KaiRo-at/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KaiRo-at/subscriptions",
      "organizations_url": "https://api.github.com/users/KaiRo-at/orgs",
      "repos_url": "https://api.github.com/users/KaiRo-at/repos",
      "events_url": "https://api.github.com/users/KaiRo-at/events{/privacy}",
      "received_events_url": "https://api.github.com/users/KaiRo-at/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-26T01:18:05Z",
    "updated_at": "2020-11-26T01:18:05Z",
    "author_association": "NONE",
    "body": "> Alright, I'll break this into separate points. Can you please confirm I've got it right.\r\n\r\nThose sound right from what I can tell, yes.\r\n\r\n> Oh right, your issue is that you can't listen on `0.0.0.0`? The idea with that is to stop people from exposing it on the internet. It should be fairly straight-forward to use SSH tunneling to reach it, a proxy or an `iptables` rule.\r\n\r\nYes, that seems to be one part of it. From what i see, that's pretty hard with the docker container (I surely wouldn't want to expose to the public, just to another container) as all those things I believe I can't do within the docker container you ship (which rightfully is pretty minimal is what it includes outside of lighthouse itself).\r\n\r\n>     * View logs via VC API.\r\n\r\nWell, I'm less interested in the logs themselves than in the data that is in the logs: summary \"everything is alright\" (is a bonus if it can be determined from other things), slot/epoch, total/active validators, etc.\r\n\r\nMain thing is I want to be able to monitor if my validator client is running fine, all validators active and doing their jobs, or if there is anything of concern I need to react to.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/734018765/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
