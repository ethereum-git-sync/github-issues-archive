{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/1616",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/1616/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/1616/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/1616/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/1616",
  "id": 700565371,
  "node_id": "MDU6SXNzdWU3MDA1NjUzNzE=",
  "number": 1616,
  "title": "Beacon node can not sync after a hard reset.",
  "user": {
    "login": "SimplyCorey",
    "id": 624784,
    "node_id": "MDQ6VXNlcjYyNDc4NA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/624784?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/SimplyCorey",
    "html_url": "https://github.com/SimplyCorey",
    "followers_url": "https://api.github.com/users/SimplyCorey/followers",
    "following_url": "https://api.github.com/users/SimplyCorey/following{/other_user}",
    "gists_url": "https://api.github.com/users/SimplyCorey/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/SimplyCorey/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/SimplyCorey/subscriptions",
    "organizations_url": "https://api.github.com/users/SimplyCorey/orgs",
    "repos_url": "https://api.github.com/users/SimplyCorey/repos",
    "events_url": "https://api.github.com/users/SimplyCorey/events{/privacy}",
    "received_events_url": "https://api.github.com/users/SimplyCorey/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2034355093,
      "node_id": "MDU6TGFiZWwyMDM0MzU1MDkz",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/consensus",
      "name": "consensus",
      "color": "5e59bf",
      "default": false,
      "description": "An issue/PR that touches consensus code, such as state_processing or block verification."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-09-13T12:57:12Z",
  "updated_at": "2022-11-09T05:02:30Z",
  "closed_at": "2020-09-22T03:38:05Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nBeacon node won't sync after a hard reset.\r\n\r\n## Version\r\n\r\nPlease provide your Lighthouse and Rust version. Are you building from\r\n`master`, which commit?\r\n\r\nlighthouse was built from the `sync-hack` branch.\r\n\r\nLighthouse v0.2.9-b3469c8\r\nBLS Library: blst\r\n\r\n## Present Behaviour\r\n\r\nThe beacon node won't sync after a hard reset.  The hard reset was caused by my docker container crashing.  It jumps between \"synced\" and \"syncing head chain\"\r\n\r\nTo reproduce:\r\nSet up a beacon node and fully sync it.  Have your computer (or container) hard reset.  Observe that the beacon node can not sync anymore.\r\n\r\n```\r\nSep 13 12:52:02.002 INFO Syncing                                 est_time: --, distance: 1112 slots (3 hrs 42 mins), peers: 10, service: slot_notifier\r\nSep 13 12:52:09.270 WARN Batch failed to download. Dropping chain scoring peers, batch_epoch: 8961, score_adjustment: Low Tolerance Error, chain: 15802250622902401264, service: sync\r\nSep 13 12:52:09.271 INFO Sync state updated                      new_state: Syncing Head Chain, old_state: Syncing Finalized Chain, service: sync\r\nSep 13 12:52:13.999 INFO Syncing                                 est_time: --, distance: 1113 slots (3 hrs 42 mins), peers: 10, service: slot_notifier\r\nSep 13 12:52:25.999 INFO Syncing                                 est_time: --, distance: 1114 slots (3 hrs 42 mins), peers: 10, service: slot_notifier\r\nSep 13 12:52:30.396 INFO Sync state updated                      new_state: Syncing Finalized Chain, old_state: Syncing Head Chain, service: sync\r\nSep 13 12:52:37.998 INFO Syncing                                 est_time: --, distance: 1115 slots (3 hrs 43 mins), peers: 12, service: slot_notifier\r\nSep 13 12:52:49.998 INFO Syncing                                 est_time: --, distance: 1116 slots (3 hrs 43 mins), peers: 12, service: slot_notifier\r\nSep 13 12:52:51.764 WARN Batch failed to download. Dropping chain scoring peers, batch_epoch: 8961, score_adjustment: Low Tolerance Error, chain: 6772112588494642972, service: sync\r\nSep 13 12:52:51.765 INFO Sync state updated                      new_state: Syncing Head Chain, old_state: Syncing Finalized Chain, service: sync\r\nSep 13 12:53:01.813 INFO Sync state updated                      new_state: Synced, old_state: Syncing Head Chain, service: sync\r\nSep 13 12:53:01.998 INFO Synced                                  slot: 287964, block:    …  empty, epoch: 8998, finalized_epoch: 8961, finalized_root: 0x655b…27d7, peers: 12, service: slot_notifier\r\nSep 13 12:53:03.532 INFO Sync state updated                      new_state: Syncing Finalized Chain, old_state: Synced, service: sync\r\nSep 13 12:53:03.781 INFO Sync state updated                      new_state: Synced, old_state: Syncing Finalized Chain, service: sync\r\nSep 13 12:53:13.997 INFO Synced                                  slot: 287965, block:    …  empty, epoch: 8998, finalized_epoch: 8961, finalized_root: 0x655b…27d7, peers: 13, service: slot_notifier\r\nSep 13 12:53:25.997 INFO Synced                                  slot: 287966, block:    …  empty, epoch: 8998, finalized_epoch: 8961, finalized_root: 0x655b…27d7, peers: 12, service: slot_notifier\r\nSep 13 12:53:35.227 INFO Sync state updated                      new_state: Syncing Finalized Chain, old_state: Synced, service: sync\r\nSep 13 12:53:37.994 INFO Syncing                                 est_time: --, distance: 1120 slots (3 hrs 44 mins), peers: 14, service: slot_notifier\r\nSep 13 12:53:49.998 INFO Syncing                                 est_time: --, distance: 1121 slots (3 hrs 44 mins), peers: 14, service: slot_notifier\r\nSep 13 12:53:52.622 WARN Batch failed to download. Dropping chain scoring peers, batch_epoch: 8961, score_adjustment: Low Tolerance Error, chain: 5973664732859605117, service: sync\r\nSep 13 12:53:52.622 INFO Sync state updated                      new_state: Syncing Head Chain, old_state: Syncing Finalized Chain, service: sync\r\nSep 13 12:53:57.006 INFO Sync state updated                      new_state: Syncing Finalized Chain, old_state: Syncing Head Chain, service: sync\r\nSep 13 12:54:01.994 INFO Syncing                                 est_time: --, distance: 1122 slots (3 hrs 44 mins), peers: 18, service: slot_notifier\r\nSep 13 12:54:08.768 WARN Batch failed to download. Dropping chain scoring peers, batch_epoch: 8961, score_adjustment: Low Tolerance Error, chain: 2264951190402208954, service: sync\r\nSep 13 12:54:08.769 INFO Sync state updated                      new_state: Syncing Head Chain, old_state: Syncing Finalized Chain, service: sync\r\nSep 13 12:54:13.996 INFO Syncing                                 est_time: --, distance: 1123 slots (3 hrs 44 mins), peers: 18, service: slot_notifier\r\nSep 13 12:54:22.187 INFO Sync state updated                      new_state: Synced, old_state: Syncing Head Chain, service: sync\r\nSep 13 12:54:25.994 INFO Synced                                  slot: 287971, block:    …  empty, epoch: 8999, finalized_epoch: 8961, finalized_root: 0x655b…27d7, peers: 17, service: slot_notifier\r\nSep 13 12:54:32.165 INFO Sync state updated                      new_state: Syncing Finalized Chain, old_state: Synced, service: sync\r\nSep 13 12:54:37.992 INFO Syncing                                 est_time: --, distance: 1125 slots (3 hrs 45 mins), peers: 25, service: slot_notifier\r\n```\r\n\r\n## Expected Behaviour\r\n\r\nHow _should_ the application behave?\r\n\r\nThe beacon node should sync.\r\n\r\n## Steps to resolve\r\n\r\nPlease describe the steps required to resolve this issue, if known.\r\n\r\nUnknown.  I tried for a few hours to get the beacon node to sync before purging the DB and starting over.",
  "closed_by": {
    "login": "bors[bot]",
    "id": 26634292,
    "node_id": "MDM6Qm90MjY2MzQyOTI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors%5Bbot%5D",
    "html_url": "https://github.com/apps/bors",
    "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/1616/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/1616/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/691750930",
    "html_url": "https://github.com/sigp/lighthouse/issues/1616#issuecomment-691750930",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1616",
    "id": 691750930,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5MTc1MDkzMA==",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-14T00:35:58Z",
    "updated_at": "2020-09-14T00:35:58Z",
    "author_association": "MEMBER",
    "body": "This looks potentially like a database error. \r\n\r\nCan you post some debug logs to find out. \r\n\r\nYou can run `lighthouse --debug-level debug bn ...` to get debug logs. \r\n\r\nI suspect this is a db error that occurred a few versions back. The DB needed to be re-downloaded to fully be resolved. \r\n\r\nI suspect doing doing a complete re-sync will resolve this. You can delete your db and start a resync from scratch by running:\r\n```\r\nlighthouse bn --purge-db ... \r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/691750930/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/691992971",
    "html_url": "https://github.com/sigp/lighthouse/issues/1616#issuecomment-691992971",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1616",
    "id": 691992971,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5MTk5Mjk3MQ==",
    "user": {
      "login": "SimplyCorey",
      "id": 624784,
      "node_id": "MDQ6VXNlcjYyNDc4NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/624784?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/SimplyCorey",
      "html_url": "https://github.com/SimplyCorey",
      "followers_url": "https://api.github.com/users/SimplyCorey/followers",
      "following_url": "https://api.github.com/users/SimplyCorey/following{/other_user}",
      "gists_url": "https://api.github.com/users/SimplyCorey/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/SimplyCorey/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/SimplyCorey/subscriptions",
      "organizations_url": "https://api.github.com/users/SimplyCorey/orgs",
      "repos_url": "https://api.github.com/users/SimplyCorey/repos",
      "events_url": "https://api.github.com/users/SimplyCorey/events{/privacy}",
      "received_events_url": "https://api.github.com/users/SimplyCorey/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-14T11:29:05Z",
    "updated_at": "2020-09-14T11:29:05Z",
    "author_association": "NONE",
    "body": "Thanks for getting back to me.\r\n\r\nThis error can not be caused by a bug that was present in a previous version.  This node has only ever run the latest version of lighthouse. It has never been upgraded. Unfortunately, I can't get the debug logs at this point as I already purged the database and re-synced it.  \r\n\r\nI will boot up another beacon node with debugging logs and try to make this happen again by forcing the container to stop repeatedly. ",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/691992971/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/694613735",
    "html_url": "https://github.com/sigp/lighthouse/issues/1616#issuecomment-694613735",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1616",
    "id": 694613735,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NDYxMzczNQ==",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-18T02:37:55Z",
    "updated_at": "2020-09-18T02:38:12Z",
    "author_association": "MEMBER",
    "body": "This should be resolved in #1629 \r\n\r\nMy assumption that a previous db error was causing this was invalid, in fact the issue was in fork choice.\r\n\r\nA new release is inbound with these corrections",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/694613735/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/695861903",
    "html_url": "https://github.com/sigp/lighthouse/issues/1616#issuecomment-695861903",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1616",
    "id": 695861903,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5NTg2MTkwMw==",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-21T01:01:37Z",
    "updated_at": "2020-09-21T01:01:37Z",
    "author_association": "MEMBER",
    "body": "There is still an issue with this we are looking into it. Will re-open this until its correctly resolved. ",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/695861903/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
