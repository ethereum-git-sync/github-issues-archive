{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/1855",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/1855/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/1855/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/1855/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/1855",
  "id": 735362676,
  "node_id": "MDU6SXNzdWU3MzUzNjI2NzY=",
  "number": 1855,
  "title": "Centralize the conditions used to classify the syncing state of a peer",
  "user": {
    "login": "divagant-martian",
    "id": 26765164,
    "node_id": "MDQ6VXNlcjI2NzY1MTY0",
    "avatar_url": "https://avatars.githubusercontent.com/u/26765164?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/divagant-martian",
    "html_url": "https://github.com/divagant-martian",
    "followers_url": "https://api.github.com/users/divagant-martian/followers",
    "following_url": "https://api.github.com/users/divagant-martian/following{/other_user}",
    "gists_url": "https://api.github.com/users/divagant-martian/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/divagant-martian/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/divagant-martian/subscriptions",
    "organizations_url": "https://api.github.com/users/divagant-martian/orgs",
    "repos_url": "https://api.github.com/users/divagant-martian/repos",
    "events_url": "https://api.github.com/users/divagant-martian/events{/privacy}",
    "received_events_url": "https://api.github.com/users/divagant-martian/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2020-11-03T14:25:22Z",
  "updated_at": "2020-11-03T14:53:29Z",
  "closed_at": "2020-11-03T14:53:29Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nThe conditions we use to decide if a peer is advanced, synced or behind, or relevant to the chain to begin with, are split over a couple of different parts of the code and it's not entirely clear how they get along. We should centralize this logic for maintainability and to reason about this more easily.\r\n\r\nParts that I identify:\r\n1. We have [the `process_status` function in the router's processor](https://github.com/sigp/lighthouse/blob/0a0f4daf9d3539ad75e4c50a96ccb910337e3813/beacon_node/network/src/router/processor.rs#L189-L310). This function for some cases disconnects a peer, for others it informs the sync manager and for other (\"naive\" peer it does nothing else). This last part seems interesting since the sync manages does have the logic to deal with behind peers.\r\n2. We also have the [`PeerSyncInfo`](https://github.com/sigp/lighthouse/blob/0a0f4daf9d3539ad75e4c50a96ccb910337e3813/beacon_node/network/src/sync/peer_sync_info.rs#L53-L108) where we get most of the sync status of a peer if it gets to the sync manager.\r\n3. We have [additional logic in the `SyncManager`](https://github.com/sigp/lighthouse/blob/0a0f4daf9d3539ad75e4c50a96ccb910337e3813/beacon_node/network/src/sync/manager.rs#L279-L308) for when a peer is said to be Advanced wrt to the `PeerSyncInfo`\r\n\r\n## Version\r\nmaster 0a0f4daf9d3539ad75e4c50a96ccb910337e3813",
  "closed_by": {
    "login": "divagant-martian",
    "id": 26765164,
    "node_id": "MDQ6VXNlcjI2NzY1MTY0",
    "avatar_url": "https://avatars.githubusercontent.com/u/26765164?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/divagant-martian",
    "html_url": "https://github.com/divagant-martian",
    "followers_url": "https://api.github.com/users/divagant-martian/followers",
    "following_url": "https://api.github.com/users/divagant-martian/following{/other_user}",
    "gists_url": "https://api.github.com/users/divagant-martian/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/divagant-martian/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/divagant-martian/subscriptions",
    "organizations_url": "https://api.github.com/users/divagant-martian/orgs",
    "repos_url": "https://api.github.com/users/divagant-martian/repos",
    "events_url": "https://api.github.com/users/divagant-martian/events{/privacy}",
    "received_events_url": "https://api.github.com/users/divagant-martian/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/1855/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/1855/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/721168035",
    "html_url": "https://github.com/sigp/lighthouse/issues/1855#issuecomment-721168035",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1855",
    "id": 721168035,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyMTE2ODAzNQ==",
    "user": {
      "login": "divagant-martian",
      "id": 26765164,
      "node_id": "MDQ6VXNlcjI2NzY1MTY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/26765164?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/divagant-martian",
      "html_url": "https://github.com/divagant-martian",
      "followers_url": "https://api.github.com/users/divagant-martian/followers",
      "following_url": "https://api.github.com/users/divagant-martian/following{/other_user}",
      "gists_url": "https://api.github.com/users/divagant-martian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/divagant-martian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/divagant-martian/subscriptions",
      "organizations_url": "https://api.github.com/users/divagant-martian/orgs",
      "repos_url": "https://api.github.com/users/divagant-martian/repos",
      "events_url": "https://api.github.com/users/divagant-martian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/divagant-martian/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-03T14:53:29Z",
    "updated_at": "2020-11-03T14:53:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "lame duplicate of #1856 ",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/721168035/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
