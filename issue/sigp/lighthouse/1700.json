{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/1700",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/1700/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/1700/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/1700/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/1700",
  "id": 712801201,
  "node_id": "MDU6SXNzdWU3MTI4MDEyMDE=",
  "number": 1700,
  "title": "Peer scoring questions",
  "user": {
    "login": "JustinDrake",
    "id": 731743,
    "node_id": "MDQ6VXNlcjczMTc0Mw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/731743?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/JustinDrake",
    "html_url": "https://github.com/JustinDrake",
    "followers_url": "https://api.github.com/users/JustinDrake/followers",
    "following_url": "https://api.github.com/users/JustinDrake/following{/other_user}",
    "gists_url": "https://api.github.com/users/JustinDrake/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/JustinDrake/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/JustinDrake/subscriptions",
    "organizations_url": "https://api.github.com/users/JustinDrake/orgs",
    "repos_url": "https://api.github.com/users/JustinDrake/repos",
    "events_url": "https://api.github.com/users/JustinDrake/events{/privacy}",
    "received_events_url": "https://api.github.com/users/JustinDrake/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2336800125,
      "node_id": "MDU6TGFiZWwyMzM2ODAwMTI1",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/t%20Networking",
      "name": "t Networking",
      "color": "40E0D0",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2020-10-01T12:34:48Z",
  "updated_at": "2020-10-20T21:57:20Z",
  "closed_at": "2020-10-19T06:12:21Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "I have a couple questions about `score.rs`:\r\n\r\n1) Is `PeerAction::_ValidMessage` used anywhere? (As far as I can tell it's not.) Does this mean peer scores always remain between `DEFAULT_SCORE` (0.0) and `MIN_SCORE` (-100.0)?\r\n2) The \"~15 occurrences will get the peer banned\" comment for `PeerAction::HighTolerance` doesn't seem to match the code. Should it be ~50 occurrences instead?",
  "closed_by": {
    "login": "AgeManning",
    "id": 7454587,
    "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AgeManning",
    "html_url": "https://github.com/AgeManning",
    "followers_url": "https://api.github.com/users/AgeManning/followers",
    "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
    "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
    "organizations_url": "https://api.github.com/users/AgeManning/orgs",
    "repos_url": "https://api.github.com/users/AgeManning/repos",
    "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AgeManning/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/1700/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/1700/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/703047596",
    "html_url": "https://github.com/sigp/lighthouse/issues/1700#issuecomment-703047596",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1700",
    "id": 703047596,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMzA0NzU5Ng==",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-03T05:03:00Z",
    "updated_at": "2020-10-03T05:03:23Z",
    "author_association": "MEMBER",
    "body": "> Is PeerAction::_ValidMessage used anywhere? (As far as I can tell it's not.) Does this mean peer scores always remain between DEFAULT_SCORE (0.0) and MIN_SCORE (-100.0)?\r\n\r\nWe used to provide positive scores, but found that they introduced a risk of gaming the system by pumping your score after doing naughty things. Positive scoring has been abandoned until we can devise an appropriate scheme.\r\n\r\n> The \"~15 occurrences will get the peer banned\" comment for PeerAction::HighTolerance doesn't seem to match the code. Should it be ~50 occurrences instead?\r\n\r\nI'd have to defer to @AgeManning or @divagant-martian for this.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/703047596/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/703164980",
    "html_url": "https://github.com/sigp/lighthouse/issues/1700#issuecomment-703164980",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1700",
    "id": 703164980,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMzE2NDk4MA==",
    "user": {
      "login": "divagant-martian",
      "id": 26765164,
      "node_id": "MDQ6VXNlcjI2NzY1MTY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/26765164?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/divagant-martian",
      "html_url": "https://github.com/divagant-martian",
      "followers_url": "https://api.github.com/users/divagant-martian/followers",
      "following_url": "https://api.github.com/users/divagant-martian/following{/other_user}",
      "gists_url": "https://api.github.com/users/divagant-martian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/divagant-martian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/divagant-martian/subscriptions",
      "organizations_url": "https://api.github.com/users/divagant-martian/orgs",
      "repos_url": "https://api.github.com/users/divagant-martian/repos",
      "events_url": "https://api.github.com/users/divagant-martian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/divagant-martian/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-03T21:08:20Z",
    "updated_at": "2020-10-04T23:57:14Z",
    "author_association": "COLLABORATOR",
    "body": "> Is PeerAction::_ValidMessage used anywhere? (As far as I can tell it's not.) Does this mean peer scores always remain between DEFAULT_SCORE (0.0) and MIN_SCORE (-100.0)?\n\r\nIt's been awhile since I last dealt with scores, but as far as I can tell our scores only go down atm with an exponential decay of `2^[-(time since updated) /600]`. The original idea was either make scores go up with successfully received messages or wrt the time they have been connected to us. Since a successfully received message might actually be a bad message, I think we ditched that part. For for a final explanation @AgeManning will be more up to date.\r\n\r\n> The \"~15 occurrences will get the peer banned\" comment for PeerAction::HighTolerance doesn't seem to match the code. Should it be ~50 occurrences instead?\n\r\nYou are right, this looks outdated, but I'm not sure what Age has in mind for this \r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/703164980/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/703328397",
    "html_url": "https://github.com/sigp/lighthouse/issues/1700#issuecomment-703328397",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1700",
    "id": 703328397,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwMzMyODM5Nw==",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-04T23:02:26Z",
    "updated_at": "2020-10-04T23:02:59Z",
    "author_association": "MEMBER",
    "body": "Yep. The scoring system is still experimental. We are tweaking as we go. \r\n\r\nWe've removed positive scoring as it was deemed too high of a risk and opens up lots of strategies to game the system. The negative scores (with decays) seem to be the safest approach for our current needs. It works such that we remove non-performant/malicious peers. \r\n\r\nIt seems to work particularly well when user's port forward. Once we've reached our target peer count of 50 (by default) we allow an additional 10% to connect to us. Every 30 seconds we prune excess peers keeping those with better scores and some other heuristics. \r\n\r\nThe comments need to be updated. \r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/703328397/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/711629146",
    "html_url": "https://github.com/sigp/lighthouse/issues/1700#issuecomment-711629146",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1700",
    "id": 711629146,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxMTYyOTE0Ng==",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-19T06:12:21Z",
    "updated_at": "2020-10-19T06:12:21Z",
    "author_association": "MEMBER",
    "body": "I'm considering this issue resolved.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/711629146/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/711851976",
    "html_url": "https://github.com/sigp/lighthouse/issues/1700#issuecomment-711851976",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1700",
    "id": 711851976,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxMTg1MTk3Ng==",
    "user": {
      "login": "JustinDrake",
      "id": 731743,
      "node_id": "MDQ6VXNlcjczMTc0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/731743?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JustinDrake",
      "html_url": "https://github.com/JustinDrake",
      "followers_url": "https://api.github.com/users/JustinDrake/followers",
      "following_url": "https://api.github.com/users/JustinDrake/following{/other_user}",
      "gists_url": "https://api.github.com/users/JustinDrake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JustinDrake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JustinDrake/subscriptions",
      "organizations_url": "https://api.github.com/users/JustinDrake/orgs",
      "repos_url": "https://api.github.com/users/JustinDrake/repos",
      "events_url": "https://api.github.com/users/JustinDrake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JustinDrake/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-19T08:36:39Z",
    "updated_at": "2020-10-19T08:36:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "@AgeManning: Is point 2 resolved? As far as I can tell the comment \"~15 occurrences will get the peer banned\" still needs fixing.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/711851976/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/713163481",
    "html_url": "https://github.com/sigp/lighthouse/issues/1700#issuecomment-713163481",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1700",
    "id": 713163481,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxMzE2MzQ4MQ==",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-20T21:57:20Z",
    "updated_at": "2020-10-20T21:57:20Z",
    "author_association": "MEMBER",
    "body": "Thanks for pointing this out. I'll update the comments in the PR I'm currently working on. Thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/713163481/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
