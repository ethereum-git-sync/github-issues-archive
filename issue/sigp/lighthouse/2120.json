{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/2120",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/2120/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/2120/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/2120/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/2120",
  "id": 774395869,
  "node_id": "MDU6SXNzdWU3NzQzOTU4Njk=",
  "number": 2120,
  "title": "libc dependency change GLIBC_2.25",
  "user": {
    "login": "syspulse",
    "id": 2284537,
    "node_id": "MDQ6VXNlcjIyODQ1Mzc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2284537?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/syspulse",
    "html_url": "https://github.com/syspulse",
    "followers_url": "https://api.github.com/users/syspulse/followers",
    "following_url": "https://api.github.com/users/syspulse/following{/other_user}",
    "gists_url": "https://api.github.com/users/syspulse/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/syspulse/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/syspulse/subscriptions",
    "organizations_url": "https://api.github.com/users/syspulse/orgs",
    "repos_url": "https://api.github.com/users/syspulse/repos",
    "events_url": "https://api.github.com/users/syspulse/events{/privacy}",
    "received_events_url": "https://api.github.com/users/syspulse/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2020-12-24T12:46:44Z",
  "updated_at": "2021-01-21T04:19:47Z",
  "closed_at": "2021-01-21T04:19:47Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nlibc dependency was upgraded in 1.0.5 build\r\nDefault Ubuntu 16.04 LTS is broken:\r\n`/lighthouse: /lib/x86_64-linux-gnu/libc.so.6: version 'GLIBC_2.25' not found (required by ./lighthouse)`\r\n\r\nThis is a bit \"painful\" since nobody wants validator downtime and it is not 5 minutes fix to make it work on existing setup\r\n\r\n## Version\r\n\r\n**lighthouse 1.0.5**\r\n**Ubuntu 16.04.7 LTS**\r\n\r\n## Present Behaviour\r\n\r\nPrevious versions are working against libc-2.23\r\n\r\n## Expected Behaviour\r\n\r\nIdeally minor version upgrades should not break core system libraries dependency where laborous upgrade/updage is required (manual recompile, OS install). \r\n\r\n## Steps to resolve\r\n\r\n1. Build from source. It is about 1h to start from scratch and build lighhouse (rust, make upgrade, etc.).\r\n2. Non-dynamic linking build option ?\r\n",
  "closed_by": {
    "login": "paulhauner",
    "id": 6660660,
    "node_id": "MDQ6VXNlcjY2NjA2NjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/paulhauner",
    "html_url": "https://github.com/paulhauner",
    "followers_url": "https://api.github.com/users/paulhauner/followers",
    "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
    "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
    "organizations_url": "https://api.github.com/users/paulhauner/orgs",
    "repos_url": "https://api.github.com/users/paulhauner/repos",
    "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/paulhauner/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/2120/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/2120/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/751519307",
    "html_url": "https://github.com/sigp/lighthouse/issues/2120#issuecomment-751519307",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2120",
    "id": 751519307,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1MTUxOTMwNw==",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-27T21:42:19Z",
    "updated_at": "2020-12-27T21:42:19Z",
    "author_association": "MEMBER",
    "body": "I'm not exactly sure why the `GLIBC_2.25` tends to break, but I suspect it's related to BLST and @michaelsproul might have more info. In my experience a `cargo clean` resolves it. You're getting that issue at *compile time* right, not runtime?\r\n\r\nIf you check out the [cross-compiling](https://lighthouse-book.sigmaprime.io/cross-compiling.html) section of the docs you can see how to build portable binaries. For our nodes, I build the binary on my desktop and then push it out to the servers. I can run the binary built with `make build-x86_64` on a brand new Ubuntu install, no dependencies needed at runtime; we purposefully use static linking wherever possibe. I would suggest you do the same thing, it means there's no downtime if you have issues compiling.\r\n\r\nI would also suggest upgrading to a newer Ubuntu, since 16 is now 4+ years old and you can get 18 and 20 in LTS now.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/751519307/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/751531011",
    "html_url": "https://github.com/sigp/lighthouse/issues/2120#issuecomment-751531011",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2120",
    "id": 751531011,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1MTUzMTAxMQ==",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-27T23:56:11Z",
    "updated_at": "2020-12-27T23:56:11Z",
    "author_association": "MEMBER",
    "body": "I don't think this is related to BLST\r\n\r\nIt could be related to the fact the new automated release flow stopped building the x86_64 binaries inside the Cross Docker containers:\r\n\r\nhttps://github.com/sigp/lighthouse/blob/9ed65a64f8fc518c98b381e628556df9bf906acb/.github/workflows/release.yml#L78-L84\r\n\r\nRunning `objdump -T lighthouse-v1.0.5 | grep GLIBC` on the portable binary reveals a dependency on `getentropy` that wasn't present in the v1.0.4 binary:\r\n\r\n```\r\n0000000000000000  w   DF *UND*  0000000000000000  GLIBC_2.25  getentropy\r\n```\r\n\r\nThe build might try to use `getentropy` if it's available, which would explain why this occurred when we stopped building inside the Cross image.\r\n\r\nI'm on leave until next week but can look into fixing it then (for v1.0.7). If you could continue building from source until then @syspulse it would be much appreciated :pray: ",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/751531011/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/751667390",
    "html_url": "https://github.com/sigp/lighthouse/issues/2120#issuecomment-751667390",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2120",
    "id": 751667390,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1MTY2NzM5MA==",
    "user": {
      "login": "syspulse",
      "id": 2284537,
      "node_id": "MDQ6VXNlcjIyODQ1Mzc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2284537?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/syspulse",
      "html_url": "https://github.com/syspulse",
      "followers_url": "https://api.github.com/users/syspulse/followers",
      "following_url": "https://api.github.com/users/syspulse/following{/other_user}",
      "gists_url": "https://api.github.com/users/syspulse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/syspulse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/syspulse/subscriptions",
      "organizations_url": "https://api.github.com/users/syspulse/orgs",
      "repos_url": "https://api.github.com/users/syspulse/repos",
      "events_url": "https://api.github.com/users/syspulse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/syspulse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-28T10:35:55Z",
    "updated_at": "2020-12-28T10:35:55Z",
    "author_association": "NONE",
    "body": "@paulhauner It's not so much about upgrading and using latest LTS, but amount of effort it might require if your infra setup is \"settled\" and validators are working fine. \r\nI do suspect that a lot of validators are well beyond old LTS distros. For me the source build is very simple and that's what I immediately did. I hope for others who encounter this issue it will be painless as well.\r\n@michaelsproul thanks for looking into it!",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/751667390/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/751914908",
    "html_url": "https://github.com/sigp/lighthouse/issues/2120#issuecomment-751914908",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2120",
    "id": 751914908,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1MTkxNDkwOA==",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-29T01:29:03Z",
    "updated_at": "2020-12-29T01:29:03Z",
    "author_association": "MEMBER",
    "body": "Yep, understood @syspulse. This was an unintentional break, so apologies for that.\r\n\r\n> It could be related to the fact the new automated release flow stopped building the x86_64 binaries inside the Cross Docker containers:\r\n\r\n@realbigsean, I forget why we couldn't use cross in the release CI..",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/751914908/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/751926323",
    "html_url": "https://github.com/sigp/lighthouse/issues/2120#issuecomment-751926323",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2120",
    "id": 751926323,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1MTkyNjMyMw==",
    "user": {
      "login": "realbigsean",
      "id": 5160426,
      "node_id": "MDQ6VXNlcjUxNjA0MjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5160426?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/realbigsean",
      "html_url": "https://github.com/realbigsean",
      "followers_url": "https://api.github.com/users/realbigsean/followers",
      "following_url": "https://api.github.com/users/realbigsean/following{/other_user}",
      "gists_url": "https://api.github.com/users/realbigsean/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/realbigsean/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/realbigsean/subscriptions",
      "organizations_url": "https://api.github.com/users/realbigsean/orgs",
      "repos_url": "https://api.github.com/users/realbigsean/repos",
      "events_url": "https://api.github.com/users/realbigsean/events{/privacy}",
      "received_events_url": "https://api.github.com/users/realbigsean/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-29T02:42:36Z",
    "updated_at": "2020-12-29T02:42:36Z",
    "author_association": "COLLABORATOR",
    "body": "> @realbigsean, I forget why we couldn't use cross in the release CI..\r\n\r\nWe can't use `cross` for macOS but we can use it for linux still.. I opted not to use it for either to keep the workflow simpler, so my bad here. I can update the workflow to use `cross` for linux in the next couple of days",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/751926323/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
