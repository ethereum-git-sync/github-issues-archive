{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/2058",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/2058/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/2058/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/2058/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/2058",
  "id": 758186619,
  "node_id": "MDU6SXNzdWU3NTgxODY2MTk=",
  "number": 2058,
  "title": "Running beacon node without eth1 endpoint even once makes eth1 sync fail forever",
  "user": {
    "login": "jtoomim",
    "id": 11898859,
    "node_id": "MDQ6VXNlcjExODk4ODU5",
    "avatar_url": "https://avatars.githubusercontent.com/u/11898859?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jtoomim",
    "html_url": "https://github.com/jtoomim",
    "followers_url": "https://api.github.com/users/jtoomim/followers",
    "following_url": "https://api.github.com/users/jtoomim/following{/other_user}",
    "gists_url": "https://api.github.com/users/jtoomim/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jtoomim/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jtoomim/subscriptions",
    "organizations_url": "https://api.github.com/users/jtoomim/orgs",
    "repos_url": "https://api.github.com/users/jtoomim/repos",
    "events_url": "https://api.github.com/users/jtoomim/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jtoomim/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-12-07T05:57:08Z",
  "updated_at": "2021-01-14T22:36:27Z",
  "closed_at": "2021-01-14T22:36:26Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "If I run `./lighthouse bn` once (with no connected eth1 endpoint) and let the chain sync, then restart lighthouse with `./lighthouse bn --eth1 --http --staking`, I consistently get these error messages:\r\n\r\n```\r\nDec 06 21:24:47.754 ERRO Failed to update eth1 cache             error: Failed to update eth1 cache: \"FailedToInsertDeposit(NonConsecutive { log_index: 459, expected: 0 })\", retry_millis: 7000, service: eth1_rpc\r\n```\r\n\r\nThe log_index and expected are always the same (459, 0). I get the same error if I use an openethereum local node, a geth local node, or if I use the Infura API. On Infura, the error shows up less commonly -- about once every 3 minutes rather than once every 50 seconds.\r\n\r\nThis error shows up when I use the lighthouse 1.0.3 amd64 linux portable executable as well as the lighthouse 1.0.2 one. I also compiled from source with the same result.\r\n\r\nAs a result of this error, the eth1 block cache never gets synced.\r\n\r\nHowever, if I delete the beacon chain -- `rm -r ~/.lighthouse/mainnet/beacon/` and restart using `./lighthouse bn --eth1 --http --staking`, the eth1 sync will work properly.",
  "closed_by": {
    "login": "paulhauner",
    "id": 6660660,
    "node_id": "MDQ6VXNlcjY2NjA2NjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/paulhauner",
    "html_url": "https://github.com/paulhauner",
    "followers_url": "https://api.github.com/users/paulhauner/followers",
    "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
    "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
    "organizations_url": "https://api.github.com/users/paulhauner/orgs",
    "repos_url": "https://api.github.com/users/paulhauner/repos",
    "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/paulhauner/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/2058/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/2058/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/739938645",
    "html_url": "https://github.com/sigp/lighthouse/issues/2058#issuecomment-739938645",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2058",
    "id": 739938645,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczOTkzODY0NQ==",
    "user": {
      "login": "pawanjay176",
      "id": 9890508,
      "node_id": "MDQ6VXNlcjk4OTA1MDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9890508?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pawanjay176",
      "html_url": "https://github.com/pawanjay176",
      "followers_url": "https://api.github.com/users/pawanjay176/followers",
      "following_url": "https://api.github.com/users/pawanjay176/following{/other_user}",
      "gists_url": "https://api.github.com/users/pawanjay176/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pawanjay176/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pawanjay176/subscriptions",
      "organizations_url": "https://api.github.com/users/pawanjay176/orgs",
      "repos_url": "https://api.github.com/users/pawanjay176/repos",
      "events_url": "https://api.github.com/users/pawanjay176/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pawanjay176/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-07T14:05:29Z",
    "updated_at": "2020-12-07T14:05:29Z",
    "author_association": "MEMBER",
    "body": "@jtoomim the most likely cause for this is that your local node wasn't completely in sync when you tried the first time. However, LH should start importing the deposit caches once your eth1 node was fully synced. \r\n\r\nCould you share which node was running locally (openethereum or geth) before wiping the beacon db and which node was running locally after wiping the beacon db.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/739938645/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/742830070",
    "html_url": "https://github.com/sigp/lighthouse/issues/2058#issuecomment-742830070",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2058",
    "id": 742830070,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MjgzMDA3MA==",
    "user": {
      "login": "Bombommi",
      "id": 75813465,
      "node_id": "MDQ6VXNlcjc1ODEzNDY1",
      "avatar_url": "https://avatars.githubusercontent.com/u/75813465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Bombommi",
      "html_url": "https://github.com/Bombommi",
      "followers_url": "https://api.github.com/users/Bombommi/followers",
      "following_url": "https://api.github.com/users/Bombommi/following{/other_user}",
      "gists_url": "https://api.github.com/users/Bombommi/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Bombommi/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Bombommi/subscriptions",
      "organizations_url": "https://api.github.com/users/Bombommi/orgs",
      "repos_url": "https://api.github.com/users/Bombommi/repos",
      "events_url": "https://api.github.com/users/Bombommi/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Bombommi/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-10T22:06:55Z",
    "updated_at": "2020-12-11T10:55:03Z",
    "author_association": "NONE",
    "body": "I use an openethereum local node and have same error...\r\n\r\n>Dec 10 21:44:23 instance-2 lighthouse[85132]: Dec 10 21:44:23.166 INFO UPnP Attempting to initialise routes    service: UPnP\r\nDec 10 21:44:23 instance-2 lighthouse[85132]: Dec 10 21:44:23.193 INFO HTTP API started                        listen_address: 127.0.0.1:5052\r\nDec 10 21:44:23 instance-2 lighthouse[85132]: Dec 10 21:44:23.354 INFO Sync state updated                      new_state: Syncing Finalized Chain, old_state: Stalled, service: sync\r\nDec 10 21:44:23 instance-2 lighthouse[85132]: Dec 10 21:44:23.872 INFO Address updated                         udp_port: 9000, ip: 34.121.126.165, service: libp2p\r\nDec 10 21:44:26 instance-2 lighthouse[85132]: Dec 10 21:44:26.517 INFO Sync state updated                      new_state: Stalled, old_state: Syncing Finalized Chain, service: sync\r\nDec 10 21:44:26 instance-2 lighthouse[85132]: Dec 10 21:44:26.949 INFO Starting database compaction            new_finalized_epoch: 2, old_finalized_epoch: 0, service: beacon\r\nDec 10 21:44:27 instance-2 lighthouse[85132]: Dec 10 21:44:27.153 INFO Database compaction complete            service: beacon\r\nDec 10 21:44:28 instance-2 lighthouse[85132]: Dec 10 21:44:28.611 INFO Sync state updated                      new_state: Syncing Finalized Chain, old_state: Stalled, service: sync\r\nDec 10 21:44:33 instance-2 lighthouse[85132]: Dec 10 21:44:33.369 INFO UPnP not available                      error: IO error: Resource temporarily unavailable (os error 11), service: UPnP\r\nDec 10 21:44:35 instance-2 lighthouse[85132]: Dec 10 21:44:35.773 ERRO Failed to update eth1 cache             error: Failed to update eth1 cache: \"FailedToInsertDeposit(NonConsecutive { log_index: 31373, expected: 0 })\", retry_millis: 7000, service: eth1_rpc`\r\n\r\nDelete database ~/.lighthouse/mainnet/beacon/ and restart lighthouse not working for me\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/742830070/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/746226716",
    "html_url": "https://github.com/sigp/lighthouse/issues/2058#issuecomment-746226716",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2058",
    "id": 746226716,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NjIyNjcxNg==",
    "user": {
      "login": "pawanjay176",
      "id": 9890508,
      "node_id": "MDQ6VXNlcjk4OTA1MDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9890508?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pawanjay176",
      "html_url": "https://github.com/pawanjay176",
      "followers_url": "https://api.github.com/users/pawanjay176/followers",
      "following_url": "https://api.github.com/users/pawanjay176/following{/other_user}",
      "gists_url": "https://api.github.com/users/pawanjay176/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pawanjay176/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pawanjay176/subscriptions",
      "organizations_url": "https://api.github.com/users/pawanjay176/orgs",
      "repos_url": "https://api.github.com/users/pawanjay176/repos",
      "events_url": "https://api.github.com/users/pawanjay176/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pawanjay176/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-16T12:37:30Z",
    "updated_at": "2020-12-16T12:37:30Z",
    "author_association": "MEMBER",
    "body": "@Bombommi sorry for the late reply. OE nodes seem to have a lot of issues with receipts.\r\nWarp syncs have a lot of missing receipts for certain ranges of blocks. You can use this script to check if your OE node has all receipts or not\r\nhttps://github.com/pawanjay176/deposits-checker/blob/master/main.py\r\nuse it as\r\n`python3 main.py <oe-endpoint> <trusted-endpoint (e.g. infura)>`",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/746226716/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/760520703",
    "html_url": "https://github.com/sigp/lighthouse/issues/2058#issuecomment-760520703",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2058",
    "id": 760520703,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MDUyMDcwMw==",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-14T22:36:26Z",
    "updated_at": "2021-01-14T22:36:26Z",
    "author_association": "MEMBER",
    "body": "Closing since it seems to be an OE issue.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/760520703/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
