{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/3724",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/3724/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/3724/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/3724/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/3724",
  "id": 1448980255,
  "node_id": "I_kwDOCFeAzc5WXa8f",
  "number": 3724,
  "title": "Validator metrics for UI",
  "user": {
    "login": "AgeManning",
    "id": 7454587,
    "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AgeManning",
    "html_url": "https://github.com/AgeManning",
    "followers_url": "https://api.github.com/users/AgeManning/followers",
    "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
    "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
    "organizations_url": "https://api.github.com/users/AgeManning/orgs",
    "repos_url": "https://api.github.com/users/AgeManning/repos",
    "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AgeManning/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2336800343,
      "node_id": "MDU6TGFiZWwyMzM2ODAwMzQz",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/HTTP-API",
      "name": "HTTP-API",
      "color": "5A63A2",
      "default": false,
      "description": ""
    },
    {
      "id": 4799962538,
      "node_id": "LA_kwDOCFeAzc8AAAABHhmdqg",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/gui",
      "name": "gui",
      "color": "46A79B",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "macladson",
    "id": 58379419,
    "node_id": "MDQ6VXNlcjU4Mzc5NDE5",
    "avatar_url": "https://avatars.githubusercontent.com/u/58379419?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/macladson",
    "html_url": "https://github.com/macladson",
    "followers_url": "https://api.github.com/users/macladson/followers",
    "following_url": "https://api.github.com/users/macladson/following{/other_user}",
    "gists_url": "https://api.github.com/users/macladson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/macladson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/macladson/subscriptions",
    "organizations_url": "https://api.github.com/users/macladson/orgs",
    "repos_url": "https://api.github.com/users/macladson/repos",
    "events_url": "https://api.github.com/users/macladson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/macladson/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "macladson",
      "id": 58379419,
      "node_id": "MDQ6VXNlcjU4Mzc5NDE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58379419?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macladson",
      "html_url": "https://github.com/macladson",
      "followers_url": "https://api.github.com/users/macladson/followers",
      "following_url": "https://api.github.com/users/macladson/following{/other_user}",
      "gists_url": "https://api.github.com/users/macladson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macladson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macladson/subscriptions",
      "organizations_url": "https://api.github.com/users/macladson/orgs",
      "repos_url": "https://api.github.com/users/macladson/repos",
      "events_url": "https://api.github.com/users/macladson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macladson/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-11-15T00:40:05Z",
  "updated_at": "2022-12-15T00:22:27Z",
  "closed_at": "2022-12-15T00:22:27Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nThe UI requires some extra metrics such as current active validator count and some effective measures of how well a validator is performing.\r\n\r\nAlthough the validator count can in principle be obtained from the standard HTTP API, it is not every efficient. \r\n\r\nWe should make some efficient version and put them under an endpoint like `lighthouse/ui/X`\r\n\r\nThe easiest first endpoint could be:\r\n`lighthouse/ui/validator_count`\r\n\r\nThis would read the state and return totals for validators in different states, i.e active, pending, withdrawing, slashed, etc. \r\n\r\nFor the effectiveness, we might want to measure variables off the form:\r\n- Number of missed head votes\r\n- Attestation rewards\r\n- Percentage missed head votes\r\n- Percentage of full attestation rewards achieved\r\n\r\nThis could be more complicated to get in an efficient manner. Ideally we would like an endpoint that can get and return these metrics for a list of validators. \r\n\r\nIf this proves too expensive, perhaps we can retain these metrics for subscribed validators using the validator monitor on the beacon node.",
  "closed_by": {
    "login": "AgeManning",
    "id": 7454587,
    "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AgeManning",
    "html_url": "https://github.com/AgeManning",
    "followers_url": "https://api.github.com/users/AgeManning/followers",
    "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
    "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
    "organizations_url": "https://api.github.com/users/AgeManning/orgs",
    "repos_url": "https://api.github.com/users/AgeManning/repos",
    "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AgeManning/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/3724/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/3724/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1333457630",
    "html_url": "https://github.com/sigp/lighthouse/issues/3724#issuecomment-1333457630",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3724",
    "id": 1333457630,
    "node_id": "IC_kwDOCFeAzc5PevLe",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-01T09:14:27Z",
    "updated_at": "2022-12-01T09:14:27Z",
    "author_association": "MEMBER",
    "body": "For the validator effectiveness, the current plan is to port the metrics that are obtained from the validator monitor, into a consumable endpoint for the UI. \r\n\r\nThere is a caveat with doing this however. The beacon node monitors only the validators that are attached to the node. As the UI connects to both a VC and a BN, there is no guarantee that the attached BN is connected to the attached VC (or the BN could be attached to many other VC's). This means it can happen that the validators returned from this endpoint may not match the validators required by the UI. There may be more or fewer validators monitored on the BN. \r\n\r\nThe endpoint should accept a list of validators to return. This will allow the UI to send a list of validator indexes (the validators the UI would like the metrics for) and the BN should return performance metrics of any of the validators it is monitoring. For any requested validators that are not being monitored by the BN, the BN should return an empty set. \r\n\r\nThis means the UI should request from the endpoint a list of validators that it knows about, and if the endpoint returns an empty set for one or any of the validators, the UI should simply not display the data and emit a warning alert indicating that the beacon node is \"not monitoring all validators\". \r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1333457630/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1352395370",
    "html_url": "https://github.com/sigp/lighthouse/issues/3724#issuecomment-1352395370",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3724",
    "id": 1352395370,
    "node_id": "IC_kwDOCFeAzc5Qm-pq",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-15T00:22:27Z",
    "updated_at": "2022-12-15T00:22:27Z",
    "author_association": "MEMBER",
    "body": "Resolved in #3760",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1352395370/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
