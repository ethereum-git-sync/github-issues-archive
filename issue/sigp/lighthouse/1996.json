{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/1996",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/1996",
  "id": 752510206,
  "node_id": "MDU6SXNzdWU3NTI1MTAyMDY=",
  "number": 1996,
  "title": "Logging should be enabled by default",
  "user": {
    "login": "dankrad",
    "id": 6130607,
    "node_id": "MDQ6VXNlcjYxMzA2MDc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6130607?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/dankrad",
    "html_url": "https://github.com/dankrad",
    "followers_url": "https://api.github.com/users/dankrad/followers",
    "following_url": "https://api.github.com/users/dankrad/following{/other_user}",
    "gists_url": "https://api.github.com/users/dankrad/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/dankrad/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/dankrad/subscriptions",
    "organizations_url": "https://api.github.com/users/dankrad/orgs",
    "repos_url": "https://api.github.com/users/dankrad/repos",
    "events_url": "https://api.github.com/users/dankrad/events{/privacy}",
    "received_events_url": "https://api.github.com/users/dankrad/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2336802021,
      "node_id": "MDU6TGFiZWwyMzM2ODAyMDIx",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/UX-and-logs",
      "name": "UX-and-logs",
      "color": "DB9046",
      "default": false,
      "description": ""
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "macladson",
    "id": 58379419,
    "node_id": "MDQ6VXNlcjU4Mzc5NDE5",
    "avatar_url": "https://avatars.githubusercontent.com/u/58379419?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/macladson",
    "html_url": "https://github.com/macladson",
    "followers_url": "https://api.github.com/users/macladson/followers",
    "following_url": "https://api.github.com/users/macladson/following{/other_user}",
    "gists_url": "https://api.github.com/users/macladson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/macladson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/macladson/subscriptions",
    "organizations_url": "https://api.github.com/users/macladson/orgs",
    "repos_url": "https://api.github.com/users/macladson/repos",
    "events_url": "https://api.github.com/users/macladson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/macladson/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "macladson",
      "id": 58379419,
      "node_id": "MDQ6VXNlcjU4Mzc5NDE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58379419?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macladson",
      "html_url": "https://github.com/macladson",
      "followers_url": "https://api.github.com/users/macladson/followers",
      "following_url": "https://api.github.com/users/macladson/following{/other_user}",
      "gists_url": "https://api.github.com/users/macladson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macladson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macladson/subscriptions",
      "organizations_url": "https://api.github.com/users/macladson/orgs",
      "repos_url": "https://api.github.com/users/macladson/repos",
      "events_url": "https://api.github.com/users/macladson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macladson/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 15,
  "created_at": "2020-11-28T00:04:56Z",
  "updated_at": "2021-11-30T05:08:13Z",
  "closed_at": "2021-11-30T05:08:13Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Logging currently has to be manually enabled using the `--logfile` command line parameter. I cannot imagine that anyone would run a beacon node without generating logs in case something needs debugging, so this should really be enabled by default in some sensible location.",
  "closed_by": {
    "login": "macladson",
    "id": 58379419,
    "node_id": "MDQ6VXNlcjU4Mzc5NDE5",
    "avatar_url": "https://avatars.githubusercontent.com/u/58379419?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/macladson",
    "html_url": "https://github.com/macladson",
    "followers_url": "https://api.github.com/users/macladson/followers",
    "following_url": "https://api.github.com/users/macladson/following{/other_user}",
    "gists_url": "https://api.github.com/users/macladson/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/macladson/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/macladson/subscriptions",
    "organizations_url": "https://api.github.com/users/macladson/orgs",
    "repos_url": "https://api.github.com/users/macladson/repos",
    "events_url": "https://api.github.com/users/macladson/events{/privacy}",
    "received_events_url": "https://api.github.com/users/macladson/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/1996/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/735016529",
    "html_url": "https://github.com/sigp/lighthouse/issues/1996#issuecomment-735016529",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996",
    "id": 735016529,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNTAxNjUyOQ==",
    "user": {
      "login": "JustinDrake",
      "id": 731743,
      "node_id": "MDQ6VXNlcjczMTc0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/731743?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JustinDrake",
      "html_url": "https://github.com/JustinDrake",
      "followers_url": "https://api.github.com/users/JustinDrake/followers",
      "following_url": "https://api.github.com/users/JustinDrake/following{/other_user}",
      "gists_url": "https://api.github.com/users/JustinDrake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JustinDrake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JustinDrake/subscriptions",
      "organizations_url": "https://api.github.com/users/JustinDrake/orgs",
      "repos_url": "https://api.github.com/users/JustinDrake/repos",
      "events_url": "https://api.github.com/users/JustinDrake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JustinDrake/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-28T00:19:29Z",
    "updated_at": "2020-12-11T18:18:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "It may make sense for the default configurations to even log to disk with a cap (e.g. 100MB of the most recent logs).",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/735016529/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/735051463",
    "html_url": "https://github.com/sigp/lighthouse/issues/1996#issuecomment-735051463",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996",
    "id": 735051463,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNTA1MTQ2Mw==",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-28T07:36:36Z",
    "updated_at": "2020-11-28T07:36:36Z",
    "author_association": "MEMBER",
    "body": "This is a good idea. \r\n\r\nThe screen output is currently tied to the log-level. Ideally we'd want to output default INFO log-level logs and write debug-level logs to disk. \r\n\r\nA lot of our users are running in docker containers or systemd scripts which save the logs, but again by default this is only INFO-level and not sufficient to debug any issues. \r\n\r\nWe should find a way to save debug-level logs to disk separately",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/735051463/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/735247643",
    "html_url": "https://github.com/sigp/lighthouse/issues/1996#issuecomment-735247643",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996",
    "id": 735247643,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNTI0NzY0Mw==",
    "user": {
      "login": "hukkin",
      "id": 3275109,
      "node_id": "MDQ6VXNlcjMyNzUxMDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3275109?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hukkin",
      "html_url": "https://github.com/hukkin",
      "followers_url": "https://api.github.com/users/hukkin/followers",
      "following_url": "https://api.github.com/users/hukkin/following{/other_user}",
      "gists_url": "https://api.github.com/users/hukkin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hukkin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hukkin/subscriptions",
      "organizations_url": "https://api.github.com/users/hukkin/orgs",
      "repos_url": "https://api.github.com/users/hukkin/repos",
      "events_url": "https://api.github.com/users/hukkin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hukkin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-28T15:51:05Z",
    "updated_at": "2020-11-28T15:51:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "[Lighthouse-docker](https://github.com/sigp/lighthouse-docker) might still want to keep this feature disabled. At least I prefer to configure logging driver (and disk cap etc.) in docker.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/735247643/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/743120495",
    "html_url": "https://github.com/sigp/lighthouse/issues/1996#issuecomment-743120495",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996",
    "id": 743120495,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0MzEyMDQ5NQ==",
    "user": {
      "login": "jamesmorgan",
      "id": 110869,
      "node_id": "MDQ6VXNlcjExMDg2OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/110869?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesmorgan",
      "html_url": "https://github.com/jamesmorgan",
      "followers_url": "https://api.github.com/users/jamesmorgan/followers",
      "following_url": "https://api.github.com/users/jamesmorgan/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesmorgan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesmorgan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesmorgan/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesmorgan/orgs",
      "repos_url": "https://api.github.com/users/jamesmorgan/repos",
      "events_url": "https://api.github.com/users/jamesmorgan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesmorgan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-11T10:44:52Z",
    "updated_at": "2020-12-11T10:44:52Z",
    "author_association": "NONE",
    "body": "Ive just been looking for logs to diagnose a problem but couldn't find them and then found this issue. I think having a sensible and default logging config defined and enabled is definitely required as well. Makes it hard to know whats happened when issues arise if I cant look back and easily see the problem.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/743120495/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947238232",
    "html_url": "https://github.com/sigp/lighthouse/issues/1996#issuecomment-947238232",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996",
    "id": 947238232,
    "node_id": "IC_kwDOCFeAzc44dbVY",
    "user": {
      "login": "macladson",
      "id": 58379419,
      "node_id": "MDQ6VXNlcjU4Mzc5NDE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58379419?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macladson",
      "html_url": "https://github.com/macladson",
      "followers_url": "https://api.github.com/users/macladson/followers",
      "following_url": "https://api.github.com/users/macladson/following{/other_user}",
      "gists_url": "https://api.github.com/users/macladson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macladson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macladson/subscriptions",
      "organizations_url": "https://api.github.com/users/macladson/orgs",
      "repos_url": "https://api.github.com/users/macladson/repos",
      "events_url": "https://api.github.com/users/macladson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macladson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-20T01:41:56Z",
    "updated_at": "2021-10-20T07:19:03Z",
    "author_association": "COLLABORATOR",
    "body": "Hi all, I've been spending some time working on this issue and am interested to hear some feedback.\r\nCurrently I can log to a file at `debug` level, and to stdout at `info` level simultaneously (currently working on making this as the default).\r\n\r\nBut I started looking into how I would go about adding log rotation (cycle through a variable number of log files where each file is limited to a certain size).\r\nAnd I found a few things:\r\n\r\n1. [`slog`](https://github.com/slog-rs/slog) doesn't support log rotation (at least that I could tell) although there has been some [recent movement on the topic](https://github.com/slog-rs/slog/issues/108) so it's possible it will be added sometime in the future\r\n1. [`sloggers`](https://github.com/sile/sloggers) does support log rotation, but does not support outputting to multiple log streams [in a single thread](https://github.com/sile/sloggers/issues/8). (This means to get the desired functionality, logging will run over 2 different async threads rather than 1.)\r\n1. [`tracing`](https://github.com/tokio-rs/tracing) supports log rotation but using this would involve a complete rewrite of our logging code ~~(although I suspect the in-code macros won't require many changes to be compatible so it might not be too bad)~~\r\n\r\n\r\nSo the main options I see seem to be.\r\n\r\n1. Forgo log rotation for now\r\n1. Continue using `slog` and I try to implement some form of log rotation myself (not sure if this will really even be feasible)\r\n1. Continue using `slog` and use `sloggers` to implement file logging in a separate thread (but with log rotation)\r\n1. Switch to `tracing`.\r\n\r\nSomething interesting to note about option 4, is that  the authors of `slog` actually recommend tracing for most users anyway and it seems more suited for async use cases. It is also maintained by the same group that maintains the [`tokio` runtime](https://github.com/tokio-rs/tokio) which we already use extensively throughout Lighthouse.\r\n\r\nIt could be an interesting switch to make for the long term as it is becoming the more popular logging library (better docs, more active dev, etc).\r\n\r\nI haven't looked into `tracing` much more than this though, so I'm not 100% sure it'll fully fit our requirements.\r\n\r\nWould be interested to hear others' thoughts on the topic.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947238232/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947259503",
    "html_url": "https://github.com/sigp/lighthouse/issues/1996#issuecomment-947259503",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996",
    "id": 947259503,
    "node_id": "IC_kwDOCFeAzc44dghv",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-20T02:21:18Z",
    "updated_at": "2021-10-20T02:21:48Z",
    "author_association": "MEMBER",
    "body": "If we are ignoring the overhead of the switch, i'm in favour of `tracing`. It does have some nice features for debugging async code and I've switched to it for the `discv5` protocol already. It has the added benefit that it integrates nicely with some of our sub-dependencies such as libp2p. \r\n\r\nIt integrates much nicer with the traditional `log` crate as well, whereas `slog` doesn't really do a good job of that. \r\n\r\nIIRC we went with `slog` initially because of its async logging, but I'm not convinced that's a huge benefit to us. \r\n\r\nIf someone wanted to take on the task of upgrading all our logs, I'd be for that. Otherwise I'd probably suggest option 1 and forgo the log rotation.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947259503/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947300382",
    "html_url": "https://github.com/sigp/lighthouse/issues/1996#issuecomment-947300382",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996",
    "id": 947300382,
    "node_id": "IC_kwDOCFeAzc44dqge",
    "user": {
      "login": "macladson",
      "id": 58379419,
      "node_id": "MDQ6VXNlcjU4Mzc5NDE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58379419?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macladson",
      "html_url": "https://github.com/macladson",
      "followers_url": "https://api.github.com/users/macladson/followers",
      "following_url": "https://api.github.com/users/macladson/following{/other_user}",
      "gists_url": "https://api.github.com/users/macladson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macladson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macladson/subscriptions",
      "organizations_url": "https://api.github.com/users/macladson/orgs",
      "repos_url": "https://api.github.com/users/macladson/repos",
      "events_url": "https://api.github.com/users/macladson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macladson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-20T03:49:23Z",
    "updated_at": "2021-10-20T03:49:23Z",
    "author_association": "COLLABORATOR",
    "body": "Sounds good then! Unless anyone has any objections, I would be happy to take it on and switch everything over to `tracing`.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947300382/reactions",
      "total_count": 3,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 1,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947302571",
    "html_url": "https://github.com/sigp/lighthouse/issues/1996#issuecomment-947302571",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996",
    "id": 947302571,
    "node_id": "IC_kwDOCFeAzc44drCr",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-20T03:56:53Z",
    "updated_at": "2021-10-20T03:59:08Z",
    "author_association": "MEMBER",
    "body": "I'm open to switching to `tracing`, it looks quite nice. It didn't exist when we chose `slog` for Lighthouse: LH added `slog` in July 2018 and `tracing` has their first commit in Sept 2018.\r\n\r\nI also fine to lose the `async` component, I can't think of anywhere we're emitting logs in fast-running loops, so waiting for stdout shouldn't hurt us. Another reason we chose `slog` was because it could do structured logs and drop them as rich JSON. I did a bit of this in the early days with AWS, but we didn't end up going down that path. I think `tracing` would support JSON output, and I don't think it matters even if it doesn't. \r\n\r\nBefore we commit to switching, it would be good to know if we can maintain the same (or at least similar-enough) log formatting. I know we generally don't treat the logs as a stable API, but it would nice to know how much we're going to break it before we're too far down the track.\r\n\r\nAlso, [tracing-flame](https://github.com/tokio-rs/tracing/tree/master/tracing-flame) looks really cool!",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947302571/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947303056",
    "html_url": "https://github.com/sigp/lighthouse/issues/1996#issuecomment-947303056",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996",
    "id": 947303056,
    "node_id": "IC_kwDOCFeAzc44drKQ",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-20T03:58:35Z",
    "updated_at": "2021-10-20T03:58:42Z",
    "author_association": "MEMBER",
    "body": "It's worth noting that we use custom `slog` formatting: https://github.com/sigp/lighthouse/blob/stable/common/logging/src/lib.rs",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947303056/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947307967",
    "html_url": "https://github.com/sigp/lighthouse/issues/1996#issuecomment-947307967",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996",
    "id": 947307967,
    "node_id": "IC_kwDOCFeAzc44dsW_",
    "user": {
      "login": "macladson",
      "id": 58379419,
      "node_id": "MDQ6VXNlcjU4Mzc5NDE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58379419?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macladson",
      "html_url": "https://github.com/macladson",
      "followers_url": "https://api.github.com/users/macladson/followers",
      "following_url": "https://api.github.com/users/macladson/following{/other_user}",
      "gists_url": "https://api.github.com/users/macladson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macladson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macladson/subscriptions",
      "organizations_url": "https://api.github.com/users/macladson/orgs",
      "repos_url": "https://api.github.com/users/macladson/repos",
      "events_url": "https://api.github.com/users/macladson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macladson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-20T04:07:01Z",
    "updated_at": "2021-10-20T04:07:01Z",
    "author_association": "COLLABORATOR",
    "body": "On first glance, it appears that `tracing` doesn't include the `crit` log level: https://docs.rs/tracing/0.1.29/tracing/struct.Level.html#implementations\r\n\r\nWe may need to decide if the `crit`'s we have in Lighthouse are fine as `error`'s or if we should work out something different.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947307967/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947313481",
    "html_url": "https://github.com/sigp/lighthouse/issues/1996#issuecomment-947313481",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996",
    "id": 947313481,
    "node_id": "IC_kwDOCFeAzc44dttJ",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-20T04:14:01Z",
    "updated_at": "2021-10-20T04:14:01Z",
    "author_association": "MEMBER",
    "body": "> On first glance, it appears that tracing doesn't include the crit log level: https://docs.rs/tracing/0.1.29/tracing/struct.Level.html#implementations\r\n\r\nOuch! In our production setup, `ERRO` sends an email and `CRIT` triggers a phone call (bypassing do-not-disturb). It has been working very nicely so far. One option would be to push all current `ERRO` into `WARN` and then reserve `ERRO` for what we used to have as `CRIT`.\r\n\r\nThat seems *reasonable enough* to me. I can't imagine it would break anyone's log parsing systems, we'd just have to make it very clear to them that you'll never see another `CRIT` and that `ERRO` is a big deal now.\r\n\r\nI'd probably need to sit on this one overnight at least..",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947313481/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947325280",
    "html_url": "https://github.com/sigp/lighthouse/issues/1996#issuecomment-947325280",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996",
    "id": 947325280,
    "node_id": "IC_kwDOCFeAzc44dwlg",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-20T04:46:58Z",
    "updated_at": "2021-10-20T04:46:58Z",
    "author_association": "MEMBER",
    "body": "I'm erring towards saying we should stick with `slog`, and adopt `sloggers` to get background file logging (option 3).\r\n\r\nThat way we can retain the `CRIT` level, and we don't have to rewrite a bunch of stuff to use `tracing`. It looks like the `tracing` macros work quite differently from `slog`: they don't take a `Logger`-like argument in the first position, and don't support the key-value syntax. It wouldn't be impossible to shim, but it seems like a lot of work for a small gain. On the other hand, `tracing` looks really cool and maybe we'll end up wanting more features from it as time goes on (e.g. `tracing-distributed`)?\r\n\r\nOther thoughts that spring to mind:\r\n\r\n* We should probably impose a hard limit on the size of the log file. When we say _log rotation_ I'm assuming we mean some kind of chunk-and-compress scheme? Making sure that we can also delete above a certain threshold is a must IMO (e.g. I have 30GB of debug logs since genesis).\r\n* We should carefully consider the interaction with `systemd`/`journald` as that's how most users run. Should we switch to logging DEBG on stderr when journald (or a pipe) is detected? Or should we continue debug logging to the separate file and require users to configure it themselves? The latter option seems a bit risky as the duplicated logs could end up using a lot more space",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947325280/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947353407",
    "html_url": "https://github.com/sigp/lighthouse/issues/1996#issuecomment-947353407",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996",
    "id": 947353407,
    "node_id": "IC_kwDOCFeAzc44d3c_",
    "user": {
      "login": "macladson",
      "id": 58379419,
      "node_id": "MDQ6VXNlcjU4Mzc5NDE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58379419?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macladson",
      "html_url": "https://github.com/macladson",
      "followers_url": "https://api.github.com/users/macladson/followers",
      "following_url": "https://api.github.com/users/macladson/following{/other_user}",
      "gists_url": "https://api.github.com/users/macladson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macladson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macladson/subscriptions",
      "organizations_url": "https://api.github.com/users/macladson/orgs",
      "repos_url": "https://api.github.com/users/macladson/repos",
      "events_url": "https://api.github.com/users/macladson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macladson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-20T06:00:26Z",
    "updated_at": "2021-10-20T06:00:26Z",
    "author_association": "COLLABORATOR",
    "body": "> When we say log rotation I'm assuming we mean some kind of chunk-and-compress scheme? Making sure that we can also delete above a certain threshold is a must IMO (e.g. I have 30GB of debug logs since genesis).\r\n\r\nSome notes on this:\r\nAs far as log rotation goes, `sloggers` seems to be more powerful than `tracing`.\r\nIt can:\r\n- Set the max size of log files,\r\n- Set the number of log files to rotate through,\r\n- Compress old log files,\r\nhttps://docs.rs/sloggers/2.0.2/sloggers/file/struct.FileLoggerBuilder.html\r\n\r\nBy contrast, `tracing` rotates a log file every minute/hour/day with (as far as I can see) no option to compress or remove old log files.\r\nhttps://docs.rs/tracing-appender/0.1.1/tracing_appender/rolling/struct.RollingFileAppender.html\r\n\r\n> We should carefully consider the interaction with systemd/journald as that's how most users run.\r\n\r\nIf we do go with `tracing`, [`tracing-journald`](https://github.com/tokio-rs/tracing/tree/master/tracing-journald) might be an option for this: ",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/947353407/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/957127718",
    "html_url": "https://github.com/sigp/lighthouse/issues/1996#issuecomment-957127718",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996",
    "id": 957127718,
    "node_id": "IC_kwDOCFeAzc45DJwm",
    "user": {
      "login": "macladson",
      "id": 58379419,
      "node_id": "MDQ6VXNlcjU4Mzc5NDE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58379419?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macladson",
      "html_url": "https://github.com/macladson",
      "followers_url": "https://api.github.com/users/macladson/followers",
      "following_url": "https://api.github.com/users/macladson/following{/other_user}",
      "gists_url": "https://api.github.com/users/macladson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macladson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macladson/subscriptions",
      "organizations_url": "https://api.github.com/users/macladson/orgs",
      "repos_url": "https://api.github.com/users/macladson/repos",
      "events_url": "https://api.github.com/users/macladson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macladson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-02T06:09:19Z",
    "updated_at": "2021-11-02T06:09:19Z",
    "author_association": "COLLABORATOR",
    "body": "Following up on my previous comment, I've decided to go with `sloggers` (see #2762). The main reasons are as follows:\r\n- The `CRIT` log level is used extensively throughout Lighthouse and losing that would require a significant reworking of Lighthouse.\r\n- Log macros in `tracing` are different enough to `slog` that it would be non-trivial to switch (although there could be some possibility of a shim to convert between the macros)\r\n- The file rotation in `sloggers` is significantly more powerful than other solutions that exist and offers the greatest flexibility in how users want to manage their logs.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/957127718/reactions",
      "total_count": 2,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/982290217",
    "html_url": "https://github.com/sigp/lighthouse/issues/1996#issuecomment-982290217",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1996",
    "id": 982290217,
    "node_id": "IC_kwDOCFeAzc46jI8p",
    "user": {
      "login": "macladson",
      "id": 58379419,
      "node_id": "MDQ6VXNlcjU4Mzc5NDE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58379419?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/macladson",
      "html_url": "https://github.com/macladson",
      "followers_url": "https://api.github.com/users/macladson/followers",
      "following_url": "https://api.github.com/users/macladson/following{/other_user}",
      "gists_url": "https://api.github.com/users/macladson/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/macladson/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/macladson/subscriptions",
      "organizations_url": "https://api.github.com/users/macladson/orgs",
      "repos_url": "https://api.github.com/users/macladson/repos",
      "events_url": "https://api.github.com/users/macladson/events{/privacy}",
      "received_events_url": "https://api.github.com/users/macladson/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-30T05:08:13Z",
    "updated_at": "2021-11-30T05:08:13Z",
    "author_association": "COLLABORATOR",
    "body": "Resolved in #2762 ",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/982290217/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
