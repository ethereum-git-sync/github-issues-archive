{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/1820",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/1820/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/1820/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/1820/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/1820",
  "id": 728260768,
  "node_id": "MDU6SXNzdWU3MjgyNjA3Njg=",
  "number": 1820,
  "title": "Endpoint /eth/v1/validator/beacon_committee_subscriptions does not accept valid input",
  "user": {
    "login": "mcdee",
    "id": 511384,
    "node_id": "MDQ6VXNlcjUxMTM4NA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/511384?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/mcdee",
    "html_url": "https://github.com/mcdee",
    "followers_url": "https://api.github.com/users/mcdee/followers",
    "following_url": "https://api.github.com/users/mcdee/following{/other_user}",
    "gists_url": "https://api.github.com/users/mcdee/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/mcdee/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/mcdee/subscriptions",
    "organizations_url": "https://api.github.com/users/mcdee/orgs",
    "repos_url": "https://api.github.com/users/mcdee/repos",
    "events_url": "https://api.github.com/users/mcdee/events{/privacy}",
    "received_events_url": "https://api.github.com/users/mcdee/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2020-10-23T14:22:20Z",
  "updated_at": "2020-11-09T00:36:28Z",
  "closed_at": "2020-11-09T00:36:28Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nThe API endpoint `/eth/v1/validator/beacon_committee_subscriptions` does not accept a valid input.\r\n\r\n## Version\r\n\r\nRecent master:\r\n\r\n```\r\ngit rev-parse HEAD\r\na741553028e6e1d461e16e12b23f6402b3f7994d\r\n```\r\n\r\n## Present Behaviour\r\n\r\nSent the following to the `/eth/v1/validator/beacon_committee_subscriptions` endpoint:\r\n\r\n```\r\n[\r\n  {\r\n    \"slot\": \"576391\",\r\n    \"committee_index\": \"8\",\r\n    \"committees_at_slot\": \"17\",\r\n    \"is_aggregator\": false\r\n  }\r\n]\r\n```\r\n\r\n(Note that the actual data was sent unformatted; this has been added for convenience of viewing.)\r\n\r\nReceived the response:\r\n\r\n```\r\n{\r\n  \"code\": 400,\r\n  \"message\": \"BAD_REQUEST: body deserialize error: Request body deserialize error: missing field `validator_index` at line 1 column 88\",\r\n  \"stacktraces\": []\r\n}\r\n```\r\n\r\n(Again, formatted for convenience.)\r\n\r\n## Expected Behaviour\r\n\r\nWould expect this to be accepted as it conforms to the format shown in https://ethereum.github.io/eth2.0-APIs/#/ValidatorRequiredApi/prepareBeaconCommitteeSubnet",
  "closed_by": {
    "login": "paulhauner",
    "id": 6660660,
    "node_id": "MDQ6VXNlcjY2NjA2NjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/paulhauner",
    "html_url": "https://github.com/paulhauner",
    "followers_url": "https://api.github.com/users/paulhauner/followers",
    "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
    "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
    "organizations_url": "https://api.github.com/users/paulhauner/orgs",
    "repos_url": "https://api.github.com/users/paulhauner/repos",
    "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/paulhauner/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/1820/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/1820/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/716886635",
    "html_url": "https://github.com/sigp/lighthouse/issues/1820#issuecomment-716886635",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1820",
    "id": 716886635,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNjg4NjYzNQ==",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-26T23:47:25Z",
    "updated_at": "2020-10-26T23:47:25Z",
    "author_association": "MEMBER",
    "body": "We'll check it out, it's not always easy conforming to the ever-changing API spec lol",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/716886635/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/716888282",
    "html_url": "https://github.com/sigp/lighthouse/issues/1820#issuecomment-716888282",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1820",
    "id": 716888282,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNjg4ODI4Mg==",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-26T23:52:46Z",
    "updated_at": "2020-10-26T23:52:46Z",
    "author_association": "MEMBER",
    "body": "Oh yeah, we need the `validator_index` field so that we can do the random subnet subscription.\r\n\r\nI had raised this somewhere on the APIs repo before, but I can't find it anymore. We've always had this in our API, I'm not sure why it never made it into the standard.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/716888282/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/716888307",
    "html_url": "https://github.com/sigp/lighthouse/issues/1820#issuecomment-716888307",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1820",
    "id": 716888307,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNjg4ODMwNw==",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-26T23:52:51Z",
    "updated_at": "2020-10-26T23:52:51Z",
    "author_association": "MEMBER",
    "body": "Yep I think we've had this discussion in the spec repository. \r\n\r\nWe require in addition to the current fields a `validator_index` field. We use this so that we know how many validators are subscribed during any epoch. We require this knowledge so that we can subscribe to a fixed number of long-lived subscriptions for each connected validator. \r\n\r\nFundamentally the beacon node needs to know how many unique validators are connected so that it can subscribe to a multiple of long-lived subnets. If there is another API endpoint that does this for us, perhaps we need to use that, this will involve changing the VC logic to use that endpoint. \r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/716888307/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/717022657",
    "html_url": "https://github.com/sigp/lighthouse/issues/1820#issuecomment-717022657",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1820",
    "id": 717022657,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNzAyMjY1Nw==",
    "user": {
      "login": "mcdee",
      "id": 511384,
      "node_id": "MDQ6VXNlcjUxMTM4NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/511384?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mcdee",
      "html_url": "https://github.com/mcdee",
      "followers_url": "https://api.github.com/users/mcdee/followers",
      "following_url": "https://api.github.com/users/mcdee/following{/other_user}",
      "gists_url": "https://api.github.com/users/mcdee/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mcdee/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mcdee/subscriptions",
      "organizations_url": "https://api.github.com/users/mcdee/orgs",
      "repos_url": "https://api.github.com/users/mcdee/repos",
      "events_url": "https://api.github.com/users/mcdee/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mcdee/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-27T06:42:19Z",
    "updated_at": "2020-10-27T06:42:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "There was a discussion at https://github.com/ethereum/eth2.0-APIs/issues/98 regarding this.  The number of validators can be estimated from the number of short-lived beacon committee subscriptions, to within a reasonable margin of error.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/717022657/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/723693034",
    "html_url": "https://github.com/sigp/lighthouse/issues/1820#issuecomment-723693034",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1820",
    "id": 723693034,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyMzY5MzAzNA==",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-09T00:36:28Z",
    "updated_at": "2020-11-09T00:36:28Z",
    "author_association": "MEMBER",
    "body": "Closing since the `validator_index` field has been added to the spec: https://github.com/ethereum/eth2.0-APIs/pull/110",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/723693034/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
