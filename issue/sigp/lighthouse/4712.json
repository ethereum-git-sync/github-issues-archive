{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/4712",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/4712/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/4712/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/4712/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/4712",
  "id": 1885437065,
  "node_id": "I_kwDOCFeAzc5wYXyJ",
  "number": 4712,
  "title": "Validator client shouldn't request aggregate with no aggregators",
  "user": {
    "login": "michaelsproul",
    "id": 4452260,
    "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/michaelsproul",
    "html_url": "https://github.com/michaelsproul",
    "followers_url": "https://api.github.com/users/michaelsproul/followers",
    "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
    "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
    "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
    "repos_url": "https://api.github.com/users/michaelsproul/repos",
    "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
    "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 985647286,
      "node_id": "MDU6TGFiZWw5ODU2NDcyODY=",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/good%20first%20issue",
      "name": "good first issue",
      "color": "7057ff",
      "default": true,
      "description": "Good for newcomers"
    },
    {
      "id": 1245875191,
      "node_id": "MDU6TGFiZWwxMjQ1ODc1MTkx",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/val-client",
      "name": "val-client",
      "color": "9cd6fc",
      "default": false,
      "description": "Relates to the validator client binary"
    },
    {
      "id": 1930671200,
      "node_id": "MDU6TGFiZWwxOTMwNjcxMjAw",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/low-hanging-fruit",
      "name": "low-hanging-fruit",
      "color": "5cbc18",
      "default": false,
      "description": "Easy to resolve, get it before someone else does!"
    },
    {
      "id": 1999784343,
      "node_id": "MDU6TGFiZWwxOTk5Nzg0MzQz",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/optimization",
      "name": "optimization",
      "color": "f9de40",
      "default": false,
      "description": "Something to make Lighthouse run more efficiently."
    },
    {
      "id": 5984399458,
      "node_id": "LA_kwDOCFeAzc8AAAABZLKwYg",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/v4.6.0",
      "name": "v4.6.0",
      "color": "B2837B",
      "default": false,
      "description": "ETA Q4 2023"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2023-09-07T09:02:20Z",
  "updated_at": "2023-09-20T09:24:01Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nThe validator client's logic for forming aggregate attestations will currently request an aggregate from the BN _before_ checking whether there are any aggregators that need to sign it:\r\n\r\nhttps://github.com/sigp/lighthouse/blob/2841f60686d642fcc0785c884d43e34e47a800dc/validator_client/src/attestation_service.rs#L494-L518\r\n\r\nThis is inefficient, but also liable to cause issues with other clients, which may not be expecting to produce an aggregate when they are not subscribed to the attestation subnet. Thanks to @nflaig from Lodestar for finding and reporting this bug.\r\n\r\n## Steps to resolve\r\n\r\nCheck whether there are any aggregators (at least one selection proof that is `Some`) before requesting an aggregate from the BN.\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/4712/reactions",
    "total_count": 2,
    "+1": 2,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/4712/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1727326398",
    "html_url": "https://github.com/sigp/lighthouse/issues/4712#issuecomment-1727326398",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4712",
    "id": 1727326398,
    "node_id": "IC_kwDOCFeAzc5m9Oi-",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-20T09:22:53Z",
    "updated_at": "2023-09-20T09:22:53Z",
    "author_association": "MEMBER",
    "body": "This also affects Lighthouse VC with a Prysm BN.\r\n\r\nFor easy searchability, the error produced is:\r\n\r\n> CRIT Error during attestation routine",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1727326398/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
