{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/4176",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/4176",
  "id": 1659711892,
  "node_id": "I_kwDOCFeAzc5i7TGU",
  "number": 4176,
  "title": "ERRO Error during execution engine upcheck error",
  "user": {
    "login": "WALL-E",
    "id": 736927,
    "node_id": "MDQ6VXNlcjczNjkyNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/736927?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/WALL-E",
    "html_url": "https://github.com/WALL-E",
    "followers_url": "https://api.github.com/users/WALL-E/followers",
    "following_url": "https://api.github.com/users/WALL-E/following{/other_user}",
    "gists_url": "https://api.github.com/users/WALL-E/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/WALL-E/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/WALL-E/subscriptions",
    "organizations_url": "https://api.github.com/users/WALL-E/orgs",
    "repos_url": "https://api.github.com/users/WALL-E/repos",
    "events_url": "https://api.github.com/users/WALL-E/events{/privacy}",
    "received_events_url": "https://api.github.com/users/WALL-E/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 16,
  "created_at": "2023-04-09T02:25:54Z",
  "updated_at": "2023-04-13T05:23:09Z",
  "closed_at": "2023-04-13T05:23:09Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\n> ERRO Error during execution engine upcheck error: Reqwest(reqwest::Error { kind: Request, url: Url { scheme: \"http\", cannot_be_a_base: false, username: \"\", password: None, host: Some(Ipv4(127.0.0.1)), port: Some(8551), path: \"/\", query: None, fragment: None }, source: TimedOut }), service: exec\r\n\r\n## Version\r\n\r\nGeth 1.11.5-stable\r\nLighthouse v4.0.1-a53830f\r\n\r\n## Present Behaviour\r\n\r\n> [50974577.173133] Out of memory: Kill process 30651 (geth) score 553 or sacrifice child\r\n> [50974577.179483] Killed process 30651 (geth) total-vm:17717724kB, anon-rss:8810628kB, file-rss:0kB, shmem-rss:0kB\r\n> [50974578.038730] oom_reaper: reaped process 30651 (geth), now anon-rss:0kB, file-rss:0kB, shmem-rss:0kB\r\n\r\n\r\n## Steps to resolve\r\n\r\nunable to reproduce test",
  "closed_by": {
    "login": "WALL-E",
    "id": 736927,
    "node_id": "MDQ6VXNlcjczNjkyNw==",
    "avatar_url": "https://avatars.githubusercontent.com/u/736927?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/WALL-E",
    "html_url": "https://github.com/WALL-E",
    "followers_url": "https://api.github.com/users/WALL-E/followers",
    "following_url": "https://api.github.com/users/WALL-E/following{/other_user}",
    "gists_url": "https://api.github.com/users/WALL-E/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/WALL-E/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/WALL-E/subscriptions",
    "organizations_url": "https://api.github.com/users/WALL-E/orgs",
    "repos_url": "https://api.github.com/users/WALL-E/repos",
    "events_url": "https://api.github.com/users/WALL-E/events{/privacy}",
    "received_events_url": "https://api.github.com/users/WALL-E/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/4176/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1501024506",
    "html_url": "https://github.com/sigp/lighthouse/issues/4176#issuecomment-1501024506",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176",
    "id": 1501024506,
    "node_id": "IC_kwDOCFeAzc5Zd9D6",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-09T02:40:32Z",
    "updated_at": "2023-04-09T02:40:32Z",
    "author_association": "MEMBER",
    "body": "Geth ran out of memory. If you can't add more RAM to the machine (I'm guessing it has 16GB) then you can minimize Lighthouse's memory usage by setting `_RJEM_MALLOC_CONF=\"abort_conf:true,narenas:1\"` as an environment variable when running Lighthouse. You might also be able to tweak Geth's `--cache` size, but that may cause severe performance degradation if you go too low.\r\n\r\nYou may also have some other processes running that are eating up your RAM. Lighthouse and Geth should fit comfortably in 16GB.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1501024506/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1501028175",
    "html_url": "https://github.com/sigp/lighthouse/issues/4176#issuecomment-1501028175",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176",
    "id": 1501028175,
    "node_id": "IC_kwDOCFeAzc5Zd99P",
    "user": {
      "login": "WALL-E",
      "id": 736927,
      "node_id": "MDQ6VXNlcjczNjkyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/736927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WALL-E",
      "html_url": "https://github.com/WALL-E",
      "followers_url": "https://api.github.com/users/WALL-E/followers",
      "following_url": "https://api.github.com/users/WALL-E/following{/other_user}",
      "gists_url": "https://api.github.com/users/WALL-E/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WALL-E/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WALL-E/subscriptions",
      "organizations_url": "https://api.github.com/users/WALL-E/orgs",
      "repos_url": "https://api.github.com/users/WALL-E/repos",
      "events_url": "https://api.github.com/users/WALL-E/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WALL-E/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-09T03:12:56Z",
    "updated_at": "2023-04-09T03:25:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "If there are no other memory-consuming applications, a computer with 8 cores and 16GB of memory can fully support both Geth and Lighthouse running on the same node ?\r\n\r\nAdditional information: It has been running smoothly for the past three months (8core16g), but in the last week, there were three instances of OOM (Out Of Memory) after upgrading Geth and Lighthouse to the latest version.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1501028175/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1501031466",
    "html_url": "https://github.com/sigp/lighthouse/issues/4176#issuecomment-1501031466",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176",
    "id": 1501031466,
    "node_id": "IC_kwDOCFeAzc5Zd-wq",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-09T03:42:51Z",
    "updated_at": "2023-04-09T03:43:24Z",
    "author_association": "MEMBER",
    "body": "How much RAM is Lighthouse using usually? It looks like Geth OOMed at 8.4 GiB, which implies Lighthouse was using the rest (~7 GiB). Normally Lighthouse will use 2-4 GiB.\r\n\r\nHave a look in `htop`, or if you want to monitor it over time try the Jemalloc Grafana dashboard: https://github.com/sigp/lighthouse-metrics/blob/master/dashboards/MallocInfoJemalloc.json. If you do, post some screenshots so we can interpret what Lighthouse is doing.\r\n\r\nWhich OS are you running on? ",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1501031466/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1501069260",
    "html_url": "https://github.com/sigp/lighthouse/issues/4176#issuecomment-1501069260",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176",
    "id": 1501069260,
    "node_id": "IC_kwDOCFeAzc5ZeH_M",
    "user": {
      "login": "WALL-E",
      "id": 736927,
      "node_id": "MDQ6VXNlcjczNjkyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/736927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WALL-E",
      "html_url": "https://github.com/WALL-E",
      "followers_url": "https://api.github.com/users/WALL-E/followers",
      "following_url": "https://api.github.com/users/WALL-E/following{/other_user}",
      "gists_url": "https://api.github.com/users/WALL-E/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WALL-E/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WALL-E/subscriptions",
      "organizations_url": "https://api.github.com/users/WALL-E/orgs",
      "repos_url": "https://api.github.com/users/WALL-E/repos",
      "events_url": "https://api.github.com/users/WALL-E/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WALL-E/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-09T07:57:14Z",
    "updated_at": "2023-04-09T08:05:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "Operating System: Amazon Linux 2\r\n\r\n<img width=\"1278\" alt=\"image\" src=\"https://user-images.githubusercontent.com/736927/230761565-aa3536bb-4014-4338-a3d3-866b4eaa0f75.png\">\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1501069260/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1501275453",
    "html_url": "https://github.com/sigp/lighthouse/issues/4176#issuecomment-1501275453",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176",
    "id": 1501275453,
    "node_id": "IC_kwDOCFeAzc5Ze6U9",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-10T01:19:37Z",
    "updated_at": "2023-04-10T01:19:57Z",
    "author_association": "MEMBER",
    "body": "I can see the memory usage of Lighthouse spiked on our fleet around 9:40am UTC 2023-04-06, is this around the time you saw the OOM?\r\n\r\nAs a temporary workaround you could set some swap space on your machine, so that it just slows down a bit if memory spikes, rather than crashing entirely. See: https://linuxize.com/post/create-a-linux-swap-file/",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1501275453/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1501310659",
    "html_url": "https://github.com/sigp/lighthouse/issues/4176#issuecomment-1501310659",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176",
    "id": 1501310659,
    "node_id": "IC_kwDOCFeAzc5ZfC7D",
    "user": {
      "login": "WALL-E",
      "id": 736927,
      "node_id": "MDQ6VXNlcjczNjkyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/736927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WALL-E",
      "html_url": "https://github.com/WALL-E",
      "followers_url": "https://api.github.com/users/WALL-E/followers",
      "following_url": "https://api.github.com/users/WALL-E/following{/other_user}",
      "gists_url": "https://api.github.com/users/WALL-E/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WALL-E/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WALL-E/subscriptions",
      "organizations_url": "https://api.github.com/users/WALL-E/orgs",
      "repos_url": "https://api.github.com/users/WALL-E/repos",
      "events_url": "https://api.github.com/users/WALL-E/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WALL-E/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-10T02:20:33Z",
    "updated_at": "2023-04-10T02:50:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thank you for the reminder. I increased the swap partition yesterday, and it did indeed solve the problem.\r\n\r\nThese are some logs I found that may help to locate the issue.\r\nThis system has been running for 591 days already, only three instances of OOM were found.\r\n\r\n```\r\n[2023/03/30 06:36:48] [50169379.082990] Killed process 16680 (lighthouse) total-vm:27597140kB, anon-rss:12025384kB, file-rss:0kB, shmem-rss:0kB\r\n[2023/04/08 14:16:46] [50974577.179483] Killed process 30651 (geth) total-vm:17717724kB, anon-rss:8810628kB, file-rss:0kB, shmem-rss:0kB\r\n[2023/04/09 14:36:19] [51062149.719775] Killed process 15606 (geth) total-vm:17238460kB, anon-rss:8926140kB, file-rss:0kB, shmem-rss:0kB\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1501310659/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1501328479",
    "html_url": "https://github.com/sigp/lighthouse/issues/4176#issuecomment-1501328479",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176",
    "id": 1501328479,
    "node_id": "IC_kwDOCFeAzc5ZfHRf",
    "user": {
      "login": "WALL-E",
      "id": 736927,
      "node_id": "MDQ6VXNlcjczNjkyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/736927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WALL-E",
      "html_url": "https://github.com/WALL-E",
      "followers_url": "https://api.github.com/users/WALL-E/followers",
      "following_url": "https://api.github.com/users/WALL-E/following{/other_user}",
      "gists_url": "https://api.github.com/users/WALL-E/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WALL-E/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WALL-E/subscriptions",
      "organizations_url": "https://api.github.com/users/WALL-E/orgs",
      "repos_url": "https://api.github.com/users/WALL-E/repos",
      "events_url": "https://api.github.com/users/WALL-E/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WALL-E/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-10T03:00:23Z",
    "updated_at": "2023-04-10T03:01:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "The screenshot captured just now, lighthouse beacon total-vm is ~29G\r\n\r\n<img width=\"928\" alt=\"image\" src=\"https://user-images.githubusercontent.com/736927/230816734-a8ab480d-2822-4243-8781-5fc785b6714e.png\">\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1501328479/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1501378795",
    "html_url": "https://github.com/sigp/lighthouse/issues/4176#issuecomment-1501378795",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176",
    "id": 1501378795,
    "node_id": "IC_kwDOCFeAzc5ZfTjr",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-10T04:29:38Z",
    "updated_at": "2023-04-10T04:29:38Z",
    "author_association": "MEMBER",
    "body": "The amount of virtual memory doesn't matter, it just represents address space used. The relevant number for how much RAM is being used is the resident set size (RES). For more info on this see https://www.baeldung.com/linux/resident-set-vs-virtual-memory-size",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1501378795/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1504517163",
    "html_url": "https://github.com/sigp/lighthouse/issues/4176#issuecomment-1504517163",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176",
    "id": 1504517163,
    "node_id": "IC_kwDOCFeAzc5ZrRwr",
    "user": {
      "login": "WALL-E",
      "id": 736927,
      "node_id": "MDQ6VXNlcjczNjkyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/736927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WALL-E",
      "html_url": "https://github.com/WALL-E",
      "followers_url": "https://api.github.com/users/WALL-E/followers",
      "following_url": "https://api.github.com/users/WALL-E/following{/other_user}",
      "gists_url": "https://api.github.com/users/WALL-E/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WALL-E/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WALL-E/subscriptions",
      "organizations_url": "https://api.github.com/users/WALL-E/orgs",
      "repos_url": "https://api.github.com/users/WALL-E/repos",
      "events_url": "https://api.github.com/users/WALL-E/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WALL-E/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-12T03:20:30Z",
    "updated_at": "2023-04-12T03:23:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "Lighthouse beacon use ~9 GiB when syncing, much greater than 4G @michaelsproul \r\n\r\n<img width=\"910\" alt=\"image\" src=\"https://user-images.githubusercontent.com/736927/231339908-68c7905d-cab3-4d88-875e-a3b88fefa267.png\">\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1504517163/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1504540581",
    "html_url": "https://github.com/sigp/lighthouse/issues/4176#issuecomment-1504540581",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176",
    "id": 1504540581,
    "node_id": "IC_kwDOCFeAzc5ZrXel",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-12T03:43:05Z",
    "updated_at": "2023-04-12T03:43:05Z",
    "author_association": "MEMBER",
    "body": "@WALL-E Interesting! What sort of syncing? Checkpoint sync? Sync from genesis? Reconstructing states?",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1504540581/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1504541186",
    "html_url": "https://github.com/sigp/lighthouse/issues/4176#issuecomment-1504541186",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176",
    "id": 1504541186,
    "node_id": "IC_kwDOCFeAzc5ZrXoC",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-12T03:43:36Z",
    "updated_at": "2023-04-12T03:43:36Z",
    "author_association": "MEMBER",
    "body": "Can you try the `_RJEM_MALLOC_CONF=\"abort_conf:true,narenas:1\"` environment variable?",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1504541186/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1505372804",
    "html_url": "https://github.com/sigp/lighthouse/issues/4176#issuecomment-1505372804",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176",
    "id": 1505372804,
    "node_id": "IC_kwDOCFeAzc5ZuiqE",
    "user": {
      "login": "WALL-E",
      "id": 736927,
      "node_id": "MDQ6VXNlcjczNjkyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/736927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WALL-E",
      "html_url": "https://github.com/WALL-E",
      "followers_url": "https://api.github.com/users/WALL-E/followers",
      "following_url": "https://api.github.com/users/WALL-E/following{/other_user}",
      "gists_url": "https://api.github.com/users/WALL-E/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WALL-E/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WALL-E/subscriptions",
      "organizations_url": "https://api.github.com/users/WALL-E/orgs",
      "repos_url": "https://api.github.com/users/WALL-E/repos",
      "events_url": "https://api.github.com/users/WALL-E/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WALL-E/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-12T14:24:47Z",
    "updated_at": "2023-04-12T14:26:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "> @WALL-E Interesting! What sort of syncing? Checkpoint sync? Sync from genesis? Reconstructing states?\r\n\r\nStarted with systemd, sync from genesis\r\n\r\n```\r\n[Unit]\r\nDescription=Lighthouse Consensus Client BN (Mainnet)\r\nWants=network-online.target\r\nAfter=network-online.target\r\n\r\n[Service]\r\nType=simple\r\nUser=lighthousebeacon\r\nGroup=lighthousebeacon\r\nRestart=always\r\nRestartSec=5\r\nExecStart=/usr/local/bin/lighthouse beacon_node \\\r\n  --network mainnet \\\r\n  --datadir /var/lib/lighthouse \\\r\n  --slots-per-restore-point 8192 \\\r\n  --http \\\r\n  --metrics \\\r\n  --execution-endpoint http://192.168.0.128:8551 \\\r\n  --execution-jwt /var/lib/lighthouse/beacon/jwtsecret\r\n\r\n[Install]\r\nWantedBy=multi-user.target\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1505372804/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1505474658",
    "html_url": "https://github.com/sigp/lighthouse/issues/4176#issuecomment-1505474658",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176",
    "id": 1505474658,
    "node_id": "IC_kwDOCFeAzc5Zu7hi",
    "user": {
      "login": "WALL-E",
      "id": 736927,
      "node_id": "MDQ6VXNlcjczNjkyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/736927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WALL-E",
      "html_url": "https://github.com/WALL-E",
      "followers_url": "https://api.github.com/users/WALL-E/followers",
      "following_url": "https://api.github.com/users/WALL-E/following{/other_user}",
      "gists_url": "https://api.github.com/users/WALL-E/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WALL-E/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WALL-E/subscriptions",
      "organizations_url": "https://api.github.com/users/WALL-E/orgs",
      "repos_url": "https://api.github.com/users/WALL-E/repos",
      "events_url": "https://api.github.com/users/WALL-E/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WALL-E/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-12T15:27:14Z",
    "updated_at": "2023-04-12T15:27:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Can you try the `_RJEM_MALLOC_CONF=\"abort_conf:true,narenas:1\"` environment variable?\r\n\r\nI'll give it a try. @michaelsproul ",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1505474658/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1506233026",
    "html_url": "https://github.com/sigp/lighthouse/issues/4176#issuecomment-1506233026",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176",
    "id": 1506233026,
    "node_id": "IC_kwDOCFeAzc5Zx0rC",
    "user": {
      "login": "WALL-E",
      "id": 736927,
      "node_id": "MDQ6VXNlcjczNjkyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/736927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WALL-E",
      "html_url": "https://github.com/WALL-E",
      "followers_url": "https://api.github.com/users/WALL-E/followers",
      "following_url": "https://api.github.com/users/WALL-E/following{/other_user}",
      "gists_url": "https://api.github.com/users/WALL-E/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WALL-E/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WALL-E/subscriptions",
      "organizations_url": "https://api.github.com/users/WALL-E/orgs",
      "repos_url": "https://api.github.com/users/WALL-E/repos",
      "events_url": "https://api.github.com/users/WALL-E/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WALL-E/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-13T02:22:00Z",
    "updated_at": "2023-04-13T02:34:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "@michaelsproul \r\n\r\n###  lighthouse version \r\n\r\n```\r\nLighthouse v4.0.1-a53830f\r\nBLS library: blst-portable\r\nSHA256 hardware acceleration: false\r\nAllocator: jemalloc\r\nSpecs: mainnet (true), minimal (false), gnosis (true)\r\n```\r\n\r\n### environment variable\r\n```\r\ncat /proc/`pgrep lighthouse`/environ  | tr '\\0' '\\n'\r\n\r\nLANG=en_US.UTF-8\r\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin\r\nHOME=/home/lighthousebeacon\r\nLOGNAME=lighthousebeacon\r\nUSER=lighthousebeacon\r\nSHELL=/sbin/nologin\r\n_RJEM_MALLOC_CONF=abort_conf:true,narenas:1\r\n```\r\n\r\n### after 5 minutes of startup\r\n<img width=\"813\" alt=\"image\" src=\"https://user-images.githubusercontent.com/736927/231630549-0f925f7a-9b48-4ab3-b0a8-f2c859bf07e7.png\">\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1506233026/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1506234460",
    "html_url": "https://github.com/sigp/lighthouse/issues/4176#issuecomment-1506234460",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176",
    "id": 1506234460,
    "node_id": "IC_kwDOCFeAzc5Zx1Bc",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-13T02:24:07Z",
    "updated_at": "2023-04-13T02:24:07Z",
    "author_association": "MEMBER",
    "body": "That looks a bit better @WALL-E. Have you also seen the latest v4.0.2-rc.0 release? It fixes an issue with exit processing that was causing memory spikes\r\n\r\nBtw, if you checkpoint sync and use reconstruct-historic-states that's usually faster than syncing from genesis. We no longer optimise for syncing from genesis",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1506234460/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1506255982",
    "html_url": "https://github.com/sigp/lighthouse/issues/4176#issuecomment-1506255982",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4176",
    "id": 1506255982,
    "node_id": "IC_kwDOCFeAzc5Zx6Ru",
    "user": {
      "login": "WALL-E",
      "id": 736927,
      "node_id": "MDQ6VXNlcjczNjkyNw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/736927?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/WALL-E",
      "html_url": "https://github.com/WALL-E",
      "followers_url": "https://api.github.com/users/WALL-E/followers",
      "following_url": "https://api.github.com/users/WALL-E/following{/other_user}",
      "gists_url": "https://api.github.com/users/WALL-E/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/WALL-E/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/WALL-E/subscriptions",
      "organizations_url": "https://api.github.com/users/WALL-E/orgs",
      "repos_url": "https://api.github.com/users/WALL-E/repos",
      "events_url": "https://api.github.com/users/WALL-E/events{/privacy}",
      "received_events_url": "https://api.github.com/users/WALL-E/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-13T02:52:34Z",
    "updated_at": "2023-04-13T02:52:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "###  lighthouse version \r\n\r\n```\r\nLighthouse v4.0.2-rc.0-35d8c98\r\nBLS library: blst-portable\r\nSHA256 hardware acceleration: false\r\nAllocator: jemalloc\r\nSpecs: mainnet (true), minimal (false), gnosis (true)\r\n```\r\n\r\n### after 5 minutes of startup\r\n<img width=\"813\" alt=\"image\" src=\"https://user-images.githubusercontent.com/736927/231635633-4cd22274-debd-4370-8756-ef10fec042a9.png\">\r\n\r\n@michaelsproul  Memory usage has indeed decreased significantly",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1506255982/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
