{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/3044",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/3044/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/3044/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/3044/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/3044",
  "id": 1153388716,
  "node_id": "I_kwDOCFeAzc5Ev1Cs",
  "number": 3044,
  "title": "Unable to sync beacon node after hard reset.",
  "user": {
    "login": "notrelatedtoanyone",
    "id": 100536824,
    "node_id": "U_kgDOBf4R-A",
    "avatar_url": "https://avatars.githubusercontent.com/u/100536824?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/notrelatedtoanyone",
    "html_url": "https://github.com/notrelatedtoanyone",
    "followers_url": "https://api.github.com/users/notrelatedtoanyone/followers",
    "following_url": "https://api.github.com/users/notrelatedtoanyone/following{/other_user}",
    "gists_url": "https://api.github.com/users/notrelatedtoanyone/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/notrelatedtoanyone/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/notrelatedtoanyone/subscriptions",
    "organizations_url": "https://api.github.com/users/notrelatedtoanyone/orgs",
    "repos_url": "https://api.github.com/users/notrelatedtoanyone/repos",
    "events_url": "https://api.github.com/users/notrelatedtoanyone/events{/privacy}",
    "received_events_url": "https://api.github.com/users/notrelatedtoanyone/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-02-27T20:32:34Z",
  "updated_at": "2022-05-18T07:00:54Z",
  "closed_at": "2022-05-18T07:00:53Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nAfter a period of downtime, I am unable to sync again. I have already tried purging the database and will try once more. \r\n\r\nIn the logs, I am seeing the following (after purging the db once already):\r\n```\r\nFeb 27 20:22:13.110 DEBG Missed snapshot cache                   block_delay: None, parent_root: 0x1dcad0c39f03315bb8da182b0d571bd5f7087121e3e5076568ae205b85adbaf7, parent_slot: 1687714, slot: 1687715, service: beacon\r\nFeb 27 20:22:13.646 DEBG Invalid block received                  outcome: StateRootMismatch { block: 0xe97dda6d6b914cabf49423136b68b2f4c74d7e0d5c9f56b6076157b0787e51fb, local: 0x196c4124b648df1b8f70adb24618c2fb08ae44562efa2227c47cf3b81768d81e }, msg: peer sent invalid block\r\nFeb 27 20:22:13.646 DEBG Batch processing failed                 service: sync, error: Peer sent invalid block. Reason: StateRootMismatch { block: 0xe97dda6d6b914cabf49423136b68b2f4c74d7e0d5c9f56b6076157b0787e51fb, local: 0x196c4124b648df1b8f70adb24618c2fb08ae44562efa2227c47cf3b81768d81e }, imported_blocks: 0, last_block_slot: 1687776, chain: 171210342189190087, first_block_slot: 1687714, batch_epoch: 52741\r\nFeb 27 20:22:13.646 DEBG Batch processing failed                 client: Prysm: version: e26cde5e091befe0c777992734c37e7a1e6c53c2, os_version: unknown, peer: 16Uiu2HAm3DcU6FztNfXnuRLsQm3Es9rvWPS7TuZXrZ7zykn1SZbX, batch_epoch: 52741, imported_blocks: false, chain: 171210342189190087, service: sync\r\nFeb 27 20:22:13.646 WARN Batch failed to download. Dropping chain scoring peers, batch_epoch: 52741, score_adjustment: None, chain: 171210342189190087, service: sync\r\nFeb 27 20:22:13.647 DEBG Chain removed                           op: batch processing result, reason: ChainFailed(Epoch(52741)), id: 171210342189190087, from: 52739, to: 102001, end_root: 0xad5câ€¦bdaa, current_target: 52741, batches: 7, peers: 9, validated_batches: 0, state: Syncing, sync_type: Finalized, service: sync\r\n```\r\n\r\n## Version\r\n\r\nstable, lastest version.\r\n\r\n## Present Behaviour\r\n\r\nBeacon node is unable to sync, \r\n\r\n## Expected Behaviour\r\n\r\nBeacon node is able to sync.\r\n\r\n## Steps to resolve\r\n\r\nNo clue.",
  "closed_by": {
    "login": "michaelsproul",
    "id": 4452260,
    "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/michaelsproul",
    "html_url": "https://github.com/michaelsproul",
    "followers_url": "https://api.github.com/users/michaelsproul/followers",
    "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
    "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
    "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
    "repos_url": "https://api.github.com/users/michaelsproul/repos",
    "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
    "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/3044/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/3044/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1053682404",
    "html_url": "https://github.com/sigp/lighthouse/issues/3044#issuecomment-1053682404",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3044",
    "id": 1053682404,
    "node_id": "IC_kwDOCFeAzc4-zerk",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-27T21:09:41Z",
    "updated_at": "2022-02-27T21:09:41Z",
    "author_association": "MEMBER",
    "body": "Sorry to hear you're having issues. If the DB corruption is happening consistently it could be an issue with the RAM or disk in your machine. Please try running a memory test using memtest86+ (it comes with most linux live distros).\n\nWe're also aware of one bug in the DB code that can cause corruption occasionally (https://github.com/sigp/lighthouse/issues/3011), but if you use checkpoint sync and _don't_ use `--reconstruct-historic-states` then it should be unlikely that you encounter it repeatedly. Which flags are you using to start the BN?",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1053682404/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1129644254",
    "html_url": "https://github.com/sigp/lighthouse/issues/3044#issuecomment-1129644254",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3044",
    "id": 1129644254,
    "node_id": "IC_kwDOCFeAzc5DVQDe",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-05-18T07:00:53Z",
    "updated_at": "2022-05-18T07:00:53Z",
    "author_association": "MEMBER",
    "body": "Closing as duplicate of #3011",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1129644254/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
