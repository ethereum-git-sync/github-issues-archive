{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/3432",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/3432/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/3432/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/3432/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/3432",
  "id": 1329941734,
  "node_id": "I_kwDOCFeAzc5PRUzm",
  "number": 3432,
  "title": "Error in VC when fee recipient is only set in the BN",
  "user": {
    "login": "realbigsean",
    "id": 5160426,
    "node_id": "MDQ6VXNlcjUxNjA0MjY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5160426?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/realbigsean",
    "html_url": "https://github.com/realbigsean",
    "followers_url": "https://api.github.com/users/realbigsean/followers",
    "following_url": "https://api.github.com/users/realbigsean/following{/other_user}",
    "gists_url": "https://api.github.com/users/realbigsean/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/realbigsean/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/realbigsean/subscriptions",
    "organizations_url": "https://api.github.com/users/realbigsean/orgs",
    "repos_url": "https://api.github.com/users/realbigsean/repos",
    "events_url": "https://api.github.com/users/realbigsean/events{/privacy}",
    "received_events_url": "https://api.github.com/users/realbigsean/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 985647281,
      "node_id": "MDU6TGFiZWw5ODU2NDcyODE=",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    },
    {
      "id": 2336802021,
      "node_id": "MDU6TGFiZWwyMzM2ODAyMDIx",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/UX-and-logs",
      "name": "UX-and-logs",
      "color": "DB9046",
      "default": false,
      "description": ""
    },
    {
      "id": 3743113288,
      "node_id": "LA_kwDOCFeAzc7fG2BI",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/bellatrix",
      "name": "bellatrix",
      "color": "A906A4",
      "default": false,
      "description": "Required to support the Bellatrix Upgrade"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-08-05T13:28:12Z",
  "updated_at": "2022-08-26T19:41:35Z",
  "closed_at": null,
  "author_association": "COLLABORATOR",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nThis was brought up in Discord: in the VC we log an error if the fee recipient isn't set *in the VC*. But it could be set with the BN's fee recipient flag. \r\n\r\nhttps://github.com/sigp/lighthouse/blob/stable/validator_client/src/preparation_service.rs#L273\r\n\r\nWe have to decide whether it should be possible for the BN's fee recipient to be used as the primary configuration. If we decide yes, we should make it possible to suppress the VC error, otherwise it seems fine to keep. \r\n\r\nThe only way I can think of to suppress the error is to add a flag to the VC, something like `--use-bn-fee-recipient`. But because there's no way to verify the BN actually has a fee recipient configured, it might be too dangerous a flag to add on its own. \r\n\r\nWe could potentially make an issue on the beacon APIs repo to add a GET `beacon_proposer_details` endpoint or something similar. And just check this endpoint if there's nothing configured in the VC.",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/3432/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/3432/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1220215572",
    "html_url": "https://github.com/sigp/lighthouse/issues/3432#issuecomment-1220215572",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3432",
    "id": 1220215572,
    "node_id": "IC_kwDOCFeAzc5IuwMU",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-19T03:41:59Z",
    "updated_at": "2022-08-19T03:41:59Z",
    "author_association": "MEMBER",
    "body": "I think this will cause blocks with 0 transactions to be proposed, because the beacon node will skip sending proposer preparation messages when it doesn't have any proposer preparation data, see:\r\n\r\nhttps://github.com/sigp/lighthouse/blob/c2604c47d6d286728f36563bb503a7a0d4a7bf57/beacon_node/beacon_chain/src/beacon_chain.rs#L3717-L3721\r\n\r\nAnd the VC avoids sending any proposer preparation data when it can't find a fee recipient:\r\n\r\nhttps://github.com/sigp/lighthouse/blob/df51a73272489fe154bd10995c96199062b6c3f7/validator_client/src/preparation_service.rs#L263-L284\r\n\r\nAs a temporary workaround for v3.0.0 I think we should recommend setting the fee recipient in the VC and not solely in the BN.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1220215572/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1228851201",
    "html_url": "https://github.com/sigp/lighthouse/issues/3432#issuecomment-1228851201",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3432",
    "id": 1228851201,
    "node_id": "IC_kwDOCFeAzc5JPsgB",
    "user": {
      "login": "realbigsean",
      "id": 5160426,
      "node_id": "MDQ6VXNlcjUxNjA0MjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5160426?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/realbigsean",
      "html_url": "https://github.com/realbigsean",
      "followers_url": "https://api.github.com/users/realbigsean/followers",
      "following_url": "https://api.github.com/users/realbigsean/following{/other_user}",
      "gists_url": "https://api.github.com/users/realbigsean/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/realbigsean/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/realbigsean/subscriptions",
      "organizations_url": "https://api.github.com/users/realbigsean/orgs",
      "repos_url": "https://api.github.com/users/realbigsean/repos",
      "events_url": "https://api.github.com/users/realbigsean/events{/privacy}",
      "received_events_url": "https://api.github.com/users/realbigsean/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-26T19:41:35Z",
    "updated_at": "2022-08-26T19:41:35Z",
    "author_association": "COLLABORATOR",
    "body": "We'd still get a chance to include transactions in the fallback here: https://github.com/sigp/lighthouse/blob/stable/beacon_node/execution_layer/src/lib.rs#L799\r\n\r\nBut this lack of delay between fcu and getPayload causes issues for some EE's so it's not good that we'd consistently get here.. so the `ERROR` seems like a good thing in potentially dissuading users from only configuring fee recipient in the BN, but the question still remains whether we should fully support BN-only fee recipient config or not.   A `--use-bn-fee-recipient` could have the effect of always sending proposal prep data as well. ",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1228851201/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
