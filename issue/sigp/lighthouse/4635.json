{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/4635",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/4635/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/4635/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/4635/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/4635",
  "id": 1855927601,
  "node_id": "I_kwDOCFeAzc5unzUx",
  "number": 4635,
  "title": "keymanager API `voluntary_exit` spec compliance",
  "user": {
    "login": "yorickdowne",
    "id": 71337066,
    "node_id": "MDQ6VXNlcjcxMzM3MDY2",
    "avatar_url": "https://avatars.githubusercontent.com/u/71337066?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/yorickdowne",
    "html_url": "https://github.com/yorickdowne",
    "followers_url": "https://api.github.com/users/yorickdowne/followers",
    "following_url": "https://api.github.com/users/yorickdowne/following{/other_user}",
    "gists_url": "https://api.github.com/users/yorickdowne/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/yorickdowne/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/yorickdowne/subscriptions",
    "organizations_url": "https://api.github.com/users/yorickdowne/orgs",
    "repos_url": "https://api.github.com/users/yorickdowne/repos",
    "events_url": "https://api.github.com/users/yorickdowne/events{/privacy}",
    "received_events_url": "https://api.github.com/users/yorickdowne/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 985647281,
      "node_id": "MDU6TGFiZWw5ODU2NDcyODE=",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/bug",
      "name": "bug",
      "color": "d73a4a",
      "default": true,
      "description": "Something isn't working"
    },
    {
      "id": 1245875191,
      "node_id": "MDU6TGFiZWwxMjQ1ODc1MTkx",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/val-client",
      "name": "val-client",
      "color": "9cd6fc",
      "default": false,
      "description": "Relates to the validator client binary"
    },
    {
      "id": 2894028867,
      "node_id": "MDU6TGFiZWwyODk0MDI4ODY3",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/backwards-incompat",
      "name": "backwards-incompat",
      "color": "FEF2C0",
      "default": false,
      "description": "Backwards-incompatible API change"
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": {
    "login": "jimmygchen",
    "id": 742762,
    "node_id": "MDQ6VXNlcjc0Mjc2Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/742762?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jimmygchen",
    "html_url": "https://github.com/jimmygchen",
    "followers_url": "https://api.github.com/users/jimmygchen/followers",
    "following_url": "https://api.github.com/users/jimmygchen/following{/other_user}",
    "gists_url": "https://api.github.com/users/jimmygchen/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jimmygchen/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jimmygchen/subscriptions",
    "organizations_url": "https://api.github.com/users/jimmygchen/orgs",
    "repos_url": "https://api.github.com/users/jimmygchen/repos",
    "events_url": "https://api.github.com/users/jimmygchen/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jimmygchen/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "jimmygchen",
      "id": 742762,
      "node_id": "MDQ6VXNlcjc0Mjc2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/742762?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jimmygchen",
      "html_url": "https://github.com/jimmygchen",
      "followers_url": "https://api.github.com/users/jimmygchen/followers",
      "following_url": "https://api.github.com/users/jimmygchen/following{/other_user}",
      "gists_url": "https://api.github.com/users/jimmygchen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jimmygchen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jimmygchen/subscriptions",
      "organizations_url": "https://api.github.com/users/jimmygchen/orgs",
      "repos_url": "https://api.github.com/users/jimmygchen/repos",
      "events_url": "https://api.github.com/users/jimmygchen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jimmygchen/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2023-08-18T02:02:15Z",
  "updated_at": "2023-09-11T13:22:40Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nWhen calling keymanager API `/eth/v1/validator/<pubkey>/voluntary_exit`, Lighthouse creates a JSON structure that does not place everything under `data`. By the spec, it should.\r\n\r\n```\r\n{\"message\":{\"epoch\":\"196868\",\"validator_index\":\"505597\"},\"signature\":\"0xhexsig\"}\r\n```\r\n\r\nby spec should be\r\n\r\n```\r\n{\"data\":{\"message\":{\"epoch\":\"196868\",\"validator_index\":\"505597\"},\"signature\":\"0xhexsig\"}}\r\n```\r\n\r\nTo be sure, the current behavior makes it easier to just `POST` the result to the CL. Spec, however, wants a `data` structure for `GET` and this not to be present for `POST`. :sweat_smile: \r\n\r\n## Version\r\n\r\n`v4.3.0`",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/4635/reactions",
    "total_count": 1,
    "+1": 1,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/4635/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1685433622",
    "html_url": "https://github.com/sigp/lighthouse/issues/4635#issuecomment-1685433622",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4635",
    "id": 1685433622,
    "node_id": "IC_kwDOCFeAzc5kda0W",
    "user": {
      "login": "jimmygchen",
      "id": 742762,
      "node_id": "MDQ6VXNlcjc0Mjc2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/742762?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jimmygchen",
      "html_url": "https://github.com/jimmygchen",
      "followers_url": "https://api.github.com/users/jimmygchen/followers",
      "following_url": "https://api.github.com/users/jimmygchen/following{/other_user}",
      "gists_url": "https://api.github.com/users/jimmygchen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jimmygchen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jimmygchen/subscriptions",
      "organizations_url": "https://api.github.com/users/jimmygchen/orgs",
      "repos_url": "https://api.github.com/users/jimmygchen/repos",
      "events_url": "https://api.github.com/users/jimmygchen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jimmygchen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-21T00:05:36Z",
    "updated_at": "2023-08-21T00:05:36Z",
    "author_association": "MEMBER",
    "body": "This is my bad, I added the spec after I did the implementation in Lighthouse.. not sure what I was thinking when I wrote the spec ü§¶‚Äç‚ôÇÔ∏è \r\nI can't think of a good reason to have the extra `data` layer, but looks like half of the clients have implemented this endpoint, people might reluctant to make changes now?",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1685433622/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1685620640",
    "html_url": "https://github.com/sigp/lighthouse/issues/4635#issuecomment-1685620640",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4635",
    "id": 1685620640,
    "node_id": "IC_kwDOCFeAzc5keIeg",
    "user": {
      "login": "yorickdowne",
      "id": 71337066,
      "node_id": "MDQ6VXNlcjcxMzM3MDY2",
      "avatar_url": "https://avatars.githubusercontent.com/u/71337066?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yorickdowne",
      "html_url": "https://github.com/yorickdowne",
      "followers_url": "https://api.github.com/users/yorickdowne/followers",
      "following_url": "https://api.github.com/users/yorickdowne/following{/other_user}",
      "gists_url": "https://api.github.com/users/yorickdowne/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yorickdowne/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yorickdowne/subscriptions",
      "organizations_url": "https://api.github.com/users/yorickdowne/orgs",
      "repos_url": "https://api.github.com/users/yorickdowne/repos",
      "events_url": "https://api.github.com/users/yorickdowne/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yorickdowne/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-08-21T04:25:25Z",
    "updated_at": "2023-08-21T04:25:25Z",
    "author_association": "NONE",
    "body": "I mean I for one am happy either way ‚Ä¶ but does spec usually do the data layer on GET, but not POST? Checking a bit of the CL API it seems to, but I am really not ‚Äúin‚Äù the spec to a degree where I can say what its usual patterns are.\r\n\r\nBroadly keeping to an existing pattern is probably worthwhile.\r\n\r\nAnd yes Prysm, Teku and Nimbus use the data layer. Lodestar hasn‚Äôt implemented yet.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1685620640/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1712642738",
    "html_url": "https://github.com/sigp/lighthouse/issues/4635#issuecomment-1712642738",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4635",
    "id": 1712642738,
    "node_id": "IC_kwDOCFeAzc5mFNqy",
    "user": {
      "login": "nflaig",
      "id": 38436224,
      "node_id": "MDQ6VXNlcjM4NDM2MjI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/38436224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nflaig",
      "html_url": "https://github.com/nflaig",
      "followers_url": "https://api.github.com/users/nflaig/followers",
      "following_url": "https://api.github.com/users/nflaig/following{/other_user}",
      "gists_url": "https://api.github.com/users/nflaig/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nflaig/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nflaig/subscriptions",
      "organizations_url": "https://api.github.com/users/nflaig/orgs",
      "repos_url": "https://api.github.com/users/nflaig/repos",
      "events_url": "https://api.github.com/users/nflaig/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nflaig/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-09T21:26:37Z",
    "updated_at": "2023-09-09T21:26:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "Just implemented this on Lodestar, got it wrong without data layer at first as well but noticed that after running spec tests. That got me thinking though, might it be worth to change the spec to use GET instead of POST for the API?\r\n- the operation is idempotent\r\n- would make it clearer that is does not actually submit the voluntary exit\r\n- would fix data inconsistency as it is only used for GET\r\n\r\nHaven't found any discussion on using GET vs POST for the API and there is no official release yet for this API so might still be ok to change the spec.\r\n\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1712642738/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1712801684",
    "html_url": "https://github.com/sigp/lighthouse/issues/4635#issuecomment-1712801684",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4635",
    "id": 1712801684,
    "node_id": "IC_kwDOCFeAzc5mF0eU",
    "user": {
      "login": "jimmygchen",
      "id": 742762,
      "node_id": "MDQ6VXNlcjc0Mjc2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/742762?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jimmygchen",
      "html_url": "https://github.com/jimmygchen",
      "followers_url": "https://api.github.com/users/jimmygchen/followers",
      "following_url": "https://api.github.com/users/jimmygchen/following{/other_user}",
      "gists_url": "https://api.github.com/users/jimmygchen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jimmygchen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jimmygchen/subscriptions",
      "organizations_url": "https://api.github.com/users/jimmygchen/orgs",
      "repos_url": "https://api.github.com/users/jimmygchen/repos",
      "events_url": "https://api.github.com/users/jimmygchen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jimmygchen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-10T12:29:51Z",
    "updated_at": "2023-09-10T12:29:51Z",
    "author_association": "MEMBER",
    "body": "Thanks for bringing this up, I agree GET would be cleaner too. It was an oversight - originally the endpoint was designed to submit to BN, and that functionality was removed but we didn't think about changing the method to GET. If we could get consensus on changing this, I'd be happy to see this change.. but not 100% sure if it's worth it since a few clients have implemented it, and it would be breaking changes for all users that have already integrated with it.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1712801684/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1713702090",
    "html_url": "https://github.com/sigp/lighthouse/issues/4635#issuecomment-1713702090",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4635",
    "id": 1713702090,
    "node_id": "IC_kwDOCFeAzc5mJQTK",
    "user": {
      "login": "nflaig",
      "id": 38436224,
      "node_id": "MDQ6VXNlcjM4NDM2MjI0",
      "avatar_url": "https://avatars.githubusercontent.com/u/38436224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nflaig",
      "html_url": "https://github.com/nflaig",
      "followers_url": "https://api.github.com/users/nflaig/followers",
      "following_url": "https://api.github.com/users/nflaig/following{/other_user}",
      "gists_url": "https://api.github.com/users/nflaig/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nflaig/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nflaig/subscriptions",
      "organizations_url": "https://api.github.com/users/nflaig/orgs",
      "repos_url": "https://api.github.com/users/nflaig/repos",
      "events_url": "https://api.github.com/users/nflaig/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nflaig/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-11T11:35:38Z",
    "updated_at": "2023-09-11T11:35:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "I don't have a strong opinion on changing  the spec but since this was mainly driven by Lighthouse and you have to break your API now anyways to be spec compliant it might be the last chance to get the change in. This API is not used by the client itself changing it doesn't introduce an incompatibility between versions there but might wanna get an overview of tooling that relies on this.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1713702090/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1713870143",
    "html_url": "https://github.com/sigp/lighthouse/issues/4635#issuecomment-1713870143",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4635",
    "id": 1713870143,
    "node_id": "IC_kwDOCFeAzc5mJ5U_",
    "user": {
      "login": "yorickdowne",
      "id": 71337066,
      "node_id": "MDQ6VXNlcjcxMzM3MDY2",
      "avatar_url": "https://avatars.githubusercontent.com/u/71337066?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/yorickdowne",
      "html_url": "https://github.com/yorickdowne",
      "followers_url": "https://api.github.com/users/yorickdowne/followers",
      "following_url": "https://api.github.com/users/yorickdowne/following{/other_user}",
      "gists_url": "https://api.github.com/users/yorickdowne/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/yorickdowne/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/yorickdowne/subscriptions",
      "organizations_url": "https://api.github.com/users/yorickdowne/orgs",
      "repos_url": "https://api.github.com/users/yorickdowne/repos",
      "events_url": "https://api.github.com/users/yorickdowne/events{/privacy}",
      "received_events_url": "https://api.github.com/users/yorickdowne/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-11T13:21:38Z",
    "updated_at": "2023-09-11T13:22:40Z",
    "author_association": "NONE",
    "body": "Afaik Eth Docker and Siren are the only tooling that use this endpoint at present. I‚Äôm ok with having the spec change if that makes it clearer and avoids technical debt in future, and special-casing by client in Eth Docker until all clients are spec-compliant again. ",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1713870143/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
