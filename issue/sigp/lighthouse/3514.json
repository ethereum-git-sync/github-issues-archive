{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/3514",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/3514/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/3514/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/3514/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/3514",
  "id": 1352531566,
  "node_id": "I_kwDOCFeAzc5Qnf5u",
  "number": 3514,
  "title": "Allow DURATION for monitoring_endpoint to be configurable",
  "user": {
    "login": "winksaville",
    "id": 1024284,
    "node_id": "MDQ6VXNlcjEwMjQyODQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1024284?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/winksaville",
    "html_url": "https://github.com/winksaville",
    "followers_url": "https://api.github.com/users/winksaville/followers",
    "following_url": "https://api.github.com/users/winksaville/following{/other_user}",
    "gists_url": "https://api.github.com/users/winksaville/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/winksaville/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/winksaville/subscriptions",
    "organizations_url": "https://api.github.com/users/winksaville/orgs",
    "repos_url": "https://api.github.com/users/winksaville/repos",
    "events_url": "https://api.github.com/users/winksaville/events{/privacy}",
    "received_events_url": "https://api.github.com/users/winksaville/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 985647284,
      "node_id": "MDU6TGFiZWw5ODU2NDcyODQ=",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/enhancement",
      "name": "enhancement",
      "color": "a2eeef",
      "default": true,
      "description": "New feature or request"
    },
    {
      "id": 985647286,
      "node_id": "MDU6TGFiZWw5ODU2NDcyODY=",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/good%20first%20issue",
      "name": "good first issue",
      "color": "7057ff",
      "default": true,
      "description": "Good for newcomers"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "michaelsproul",
    "id": 4452260,
    "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/michaelsproul",
    "html_url": "https://github.com/michaelsproul",
    "followers_url": "https://api.github.com/users/michaelsproul/followers",
    "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
    "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
    "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
    "repos_url": "https://api.github.com/users/michaelsproul/repos",
    "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
    "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 11,
  "created_at": "2022-08-26T17:09:16Z",
  "updated_at": "2022-09-26T03:36:06Z",
  "closed_at": "2022-09-26T03:36:06Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nFor me beaconcha.in is returning a StatusCode(429), \"Too many requests\", in response to a `Sending metrics` request when I use `--monitoring-endpoint`.\r\n\r\n## Version\r\n```\r\nwink@3900x 22-08-26T16:39:54.991Z:~/prgs/rust/forks/lighthouse (stable)\r\n$ git log -1 --format=short\r\ncommit 18c61a5e8be3e54226a86a69b96f8f4f7fd790e4 (HEAD -> stable, upstream/stable)\r\nAuthor: Paul Hauner <paul@paulhauner.com>\r\n\r\n    v3.0.0 (#3464)\r\nwink@3900x 22-08-26T16:40:18.885Z:~/prgs/rust/forks/lighthouse (stable)\r\n$ rustc --version\r\nrustc 1.52.1 (9bc8c42bb 2021-05-09)\r\nwink@3900x 22-08-26T16:40:45.797Z:~/prgs/rust/forks/lighthouse (stable)\r\n```\r\n## Present Behaviour\r\n\r\n```\r\nAug 26 08:31:15 robert lighthouse[253789]: Aug 26 15:31:15.629 INFO Sending metrics to remote endpoint      endpoint: https://beaconcha.in/, service: monitoring_client\r\nAug 26 08:31:15 robert lighthouse[253789]: Aug 26 15:31:15.831 ERRO Failed to send metrics to remote endpoint, error: StatusCode(429), service: monitoring_client\r\n```\r\n\r\nThe problem is that [beaconcha.in](https://beaconcha.in/pricing) has a rate limit of 30,000/mth on the free tier. But in monitoring_ap/src/lib.rs we see DURATION is 60 seconds:\r\n```\r\n/// Duration after which we collect and send metrics to remote endpoint.\r\npub const UPDATE_DURATION: u64 = 60;\r\n```\r\nAnd in `fn auto_update` we see this is the interval duration between send_metrics calls:\r\n```\r\n    /// Creates a task which periodically sends the provided process metrics\r\n    /// to the configured remote endpoint.\r\n    pub fn auto_update(self, executor: TaskExecutor, processes: Vec<ProcessType>) {\r\n        let mut interval = interval_at(\r\n            // Have some initial delay for the metrics to get initialized\r\n            Instant::now() + Duration::from_secs(25),\r\n            Duration::from_secs(UPDATE_DURATION),\r\n        );\r\n\r\n        info!(self.log, \"Starting monitoring api\"; \"endpoint\" => %self.monitoring_endpoint);\r\n\r\n        let update_future = async move {\r\n            loop {\r\n                interval.tick().await;\r\n                match self.send_metrics(&processes).await {\r\n                    Ok(()) => {\r\n                        debug!(self.log, \"Metrics sent to remote server\"; \"endpoint\" => %self.monitoring_endpoint);\r\n                    }\r\n                    Err(e) => {\r\n                        error!(self.log, \"Failed to send metrics to remote endpoint\"; \"error\" => %e)\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        executor.spawn(update_future, \"monitoring_api\");\r\n    }\r\n```\r\n\r\nThis means there are 1,440 per day * 30 is about 43,200/mth which exceeds the 30,000. In my particular beaconcha.in says I'm at 134,000/mth and thus they are rightly returning `StatusCode(429)`.\r\n\r\n## Expected Behaviour\r\n\r\nAn ERRO should not occur\r\n\r\n## Steps to resolve\r\n\r\nI suggest the default be set at 120secs or higher but ideally this should be configurable. In addition the documentation should\r\nprovide information on what metrics are actually being sent by providing a link to the relevant \"standards\".\r\n\r\nI can look at the code and I see that there are 3 ProcessTypes; BeaconNode, System and  Validator. I can guess that if I use `monitoring-endpoint` on a BN then the BeaconNode metrics are sent and for a VC the Validator metrics are sent, but under what conditions are System type sent?\r\n",
  "closed_by": {
    "login": "michaelsproul",
    "id": 4452260,
    "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/michaelsproul",
    "html_url": "https://github.com/michaelsproul",
    "followers_url": "https://api.github.com/users/michaelsproul/followers",
    "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
    "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
    "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
    "repos_url": "https://api.github.com/users/michaelsproul/repos",
    "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
    "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/3514/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/3514/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1231935339",
    "html_url": "https://github.com/sigp/lighthouse/issues/3514#issuecomment-1231935339",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3514",
    "id": 1231935339,
    "node_id": "IC_kwDOCFeAzc5Jbddr",
    "user": {
      "login": "winksaville",
      "id": 1024284,
      "node_id": "MDQ6VXNlcjEwMjQyODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1024284?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/winksaville",
      "html_url": "https://github.com/winksaville",
      "followers_url": "https://api.github.com/users/winksaville/followers",
      "following_url": "https://api.github.com/users/winksaville/following{/other_user}",
      "gists_url": "https://api.github.com/users/winksaville/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/winksaville/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/winksaville/subscriptions",
      "organizations_url": "https://api.github.com/users/winksaville/orgs",
      "repos_url": "https://api.github.com/users/winksaville/repos",
      "events_url": "https://api.github.com/users/winksaville/events{/privacy}",
      "received_events_url": "https://api.github.com/users/winksaville/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-30T17:06:07Z",
    "updated_at": "2022-08-30T17:06:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "@michaelsproul any thoughts on this issue?",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1231935339/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1232502320",
    "html_url": "https://github.com/sigp/lighthouse/issues/3514#issuecomment-1232502320",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3514",
    "id": 1232502320,
    "node_id": "IC_kwDOCFeAzc5Jdn4w",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-31T06:07:06Z",
    "updated_at": "2022-08-31T06:07:06Z",
    "author_association": "MEMBER",
    "body": "Seems like it should be a straight-forward fix. We're pretty flat out on getting ready for the merge but can probably squeeze it in for v3.1.1. I'll have a go at it now.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1232502320/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1232542915",
    "html_url": "https://github.com/sigp/lighthouse/issues/3514#issuecomment-1232542915",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3514",
    "id": 1232542915,
    "node_id": "IC_kwDOCFeAzc5JdxzD",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-31T07:03:22Z",
    "updated_at": "2022-08-31T07:03:22Z",
    "author_association": "MEMBER",
    "body": "Here you go @winksaville: https://github.com/sigp/lighthouse/pull/3530\r\n\r\nI wonder whether we should still change the default, as I recall beaconcha.in meters monitoring traffic differently to standard API traffic. CC @Buttaa",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1232542915/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1232635861",
    "html_url": "https://github.com/sigp/lighthouse/issues/3514#issuecomment-1232635861",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3514",
    "id": 1232635861,
    "node_id": "IC_kwDOCFeAzc5JeIfV",
    "user": {
      "login": "manuelsc",
      "id": 5877862,
      "node_id": "MDQ6VXNlcjU4Nzc4NjI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5877862?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/manuelsc",
      "html_url": "https://github.com/manuelsc",
      "followers_url": "https://api.github.com/users/manuelsc/followers",
      "following_url": "https://api.github.com/users/manuelsc/following{/other_user}",
      "gists_url": "https://api.github.com/users/manuelsc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/manuelsc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/manuelsc/subscriptions",
      "organizations_url": "https://api.github.com/users/manuelsc/orgs",
      "repos_url": "https://api.github.com/users/manuelsc/repos",
      "events_url": "https://api.github.com/users/manuelsc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/manuelsc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-31T08:34:12Z",
    "updated_at": "2022-08-31T08:34:12Z",
    "author_association": "NONE",
    "body": "> Here you go @winksaville: #3530\r\n> \r\n> I wonder whether we should still change the default, as I recall beaconcha.in meters monitoring traffic differently to standard API traffic. CC @Buttaa\r\n\r\nI think we should keep the default at 1min but provide the possibility to override. We'll check on our end whether there are any issues that count the metrics traffic wrongly.\r\n\r\nI'm not sure if you already utilize this but we added the possibility to batch all the metrics in one single request on our end: https://github.com/gobitfly/eth2-client-metrics\r\nThis could reduce traffic and fix edge cases for when a single request does not arrive for some reason (for example system metrics does not arrive while beacon node metrics arrive).",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1232635861/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1233055707",
    "html_url": "https://github.com/sigp/lighthouse/issues/3514#issuecomment-1233055707",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3514",
    "id": 1233055707,
    "node_id": "IC_kwDOCFeAzc5Jfu_b",
    "user": {
      "login": "winksaville",
      "id": 1024284,
      "node_id": "MDQ6VXNlcjEwMjQyODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1024284?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/winksaville",
      "html_url": "https://github.com/winksaville",
      "followers_url": "https://api.github.com/users/winksaville/followers",
      "following_url": "https://api.github.com/users/winksaville/following{/other_user}",
      "gists_url": "https://api.github.com/users/winksaville/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/winksaville/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/winksaville/subscriptions",
      "organizations_url": "https://api.github.com/users/winksaville/orgs",
      "repos_url": "https://api.github.com/users/winksaville/repos",
      "events_url": "https://api.github.com/users/winksaville/events{/privacy}",
      "received_events_url": "https://api.github.com/users/winksaville/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-31T15:01:04Z",
    "updated_at": "2022-08-31T15:01:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "@manuelsc, @michaelsproul my opinion the default should be 2min, so the default rate is below the 30,000/mth, but since the `--monitoring-endpoint-frequency` it's not a big deal either way.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1233055707/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1233067466",
    "html_url": "https://github.com/sigp/lighthouse/issues/3514#issuecomment-1233067466",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3514",
    "id": 1233067466,
    "node_id": "IC_kwDOCFeAzc5Jfx3K",
    "user": {
      "login": "manuelsc",
      "id": 5877862,
      "node_id": "MDQ6VXNlcjU4Nzc4NjI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5877862?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/manuelsc",
      "html_url": "https://github.com/manuelsc",
      "followers_url": "https://api.github.com/users/manuelsc/followers",
      "following_url": "https://api.github.com/users/manuelsc/following{/other_user}",
      "gists_url": "https://api.github.com/users/manuelsc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/manuelsc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/manuelsc/subscriptions",
      "organizations_url": "https://api.github.com/users/manuelsc/orgs",
      "repos_url": "https://api.github.com/users/manuelsc/repos",
      "events_url": "https://api.github.com/users/manuelsc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/manuelsc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-31T15:10:29Z",
    "updated_at": "2022-08-31T15:10:29Z",
    "author_association": "NONE",
    "body": "@winksaville The monitoring endpoint has a different API limit than the rest of beaconcha.in´s API and is not counted toward your normal limit. We'll review the limit on our end though since I'm not sure whether they are enough for unbatched metric reports. Ideally lighthouse adapts the batched metrics approach, alternatively we need to adapt the custom limit for the endpoint.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1233067466/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1233129050",
    "html_url": "https://github.com/sigp/lighthouse/issues/3514#issuecomment-1233129050",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3514",
    "id": 1233129050,
    "node_id": "IC_kwDOCFeAzc5JgA5a",
    "user": {
      "login": "winksaville",
      "id": 1024284,
      "node_id": "MDQ6VXNlcjEwMjQyODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1024284?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/winksaville",
      "html_url": "https://github.com/winksaville",
      "followers_url": "https://api.github.com/users/winksaville/followers",
      "following_url": "https://api.github.com/users/winksaville/following{/other_user}",
      "gists_url": "https://api.github.com/users/winksaville/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/winksaville/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/winksaville/subscriptions",
      "organizations_url": "https://api.github.com/users/winksaville/orgs",
      "repos_url": "https://api.github.com/users/winksaville/repos",
      "events_url": "https://api.github.com/users/winksaville/events{/privacy}",
      "received_events_url": "https://api.github.com/users/winksaville/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-31T16:00:22Z",
    "updated_at": "2022-08-31T16:00:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "> @winksaville The monitoring endpoint has a different API limit than the rest of beaconcha.in´s API and is not counted toward your normal limit. We'll review the limit on our end though since I'm not sure whether they are enough for unbatched metric reports. Ideally lighthouse adapts the batched metrics approach, alternatively we need to adapt the custom limit for the endpoint.\r\n\r\nHmm, what is actually counted in the request limit on beaconcha.in isn't clear to me at all. All I know is that in the on [this page](https://beaconcha.in/user/settings#api)account the monthly total is 120,000+ requests/mth which is above 30,000, there is a link to [upgrade plan](https://beaconcha.in/pricing) and the response from the send-metrics beaconcha.in was a 429 \"Too many requests\".\r\n\r\nSo AFAIK the only API I'm using from beaconch.in is the [POST /api/v1/client/metrics](https://beaconcha.in/api/v1/docs/index.html#/User/post_api_v1_client_metrics), which is issued when --monitoring-endpoint is enabled. What other information might geth or lighthouse be sending to them?\r\n\r\nNote; I'm running three nodes each with geth, lighthouse bn and lighthouse vc. Two nodes are on mainnet, one has 28 enabled validators the other has 0 and is a \"hot\" backup. The third node is associated with another account and its on prater, And it has 2 validators is registering 72,000 requests/mth. A week ago, when I raised this issue, I had --monitoring-endpoint enabled on the 6 lighthouse instances (3 bn's and 3 vc's), but currently there are no monitoring-endpoints enabled.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1233129050/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1233327227",
    "html_url": "https://github.com/sigp/lighthouse/issues/3514#issuecomment-1233327227",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3514",
    "id": 1233327227,
    "node_id": "IC_kwDOCFeAzc5JgxR7",
    "user": {
      "login": "pawanjay176",
      "id": 9890508,
      "node_id": "MDQ6VXNlcjk4OTA1MDg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9890508?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pawanjay176",
      "html_url": "https://github.com/pawanjay176",
      "followers_url": "https://api.github.com/users/pawanjay176/followers",
      "following_url": "https://api.github.com/users/pawanjay176/following{/other_user}",
      "gists_url": "https://api.github.com/users/pawanjay176/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pawanjay176/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pawanjay176/subscriptions",
      "organizations_url": "https://api.github.com/users/pawanjay176/orgs",
      "repos_url": "https://api.github.com/users/pawanjay176/repos",
      "events_url": "https://api.github.com/users/pawanjay176/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pawanjay176/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-31T19:17:39Z",
    "updated_at": "2022-08-31T19:17:39Z",
    "author_association": "MEMBER",
    "body": "> I'm not sure if you already utilize this but we added the possibility to batch all the metrics in one single request on our end:\r\n\r\nWe do send the beacon, validator and system metrics in a single request.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1233327227/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1234053036",
    "html_url": "https://github.com/sigp/lighthouse/issues/3514#issuecomment-1234053036",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3514",
    "id": 1234053036,
    "node_id": "IC_kwDOCFeAzc5Jjies",
    "user": {
      "login": "manuelsc",
      "id": 5877862,
      "node_id": "MDQ6VXNlcjU4Nzc4NjI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5877862?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/manuelsc",
      "html_url": "https://github.com/manuelsc",
      "followers_url": "https://api.github.com/users/manuelsc/followers",
      "following_url": "https://api.github.com/users/manuelsc/following{/other_user}",
      "gists_url": "https://api.github.com/users/manuelsc/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/manuelsc/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/manuelsc/subscriptions",
      "organizations_url": "https://api.github.com/users/manuelsc/orgs",
      "repos_url": "https://api.github.com/users/manuelsc/repos",
      "events_url": "https://api.github.com/users/manuelsc/events{/privacy}",
      "received_events_url": "https://api.github.com/users/manuelsc/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-01T10:04:40Z",
    "updated_at": "2022-09-01T10:04:40Z",
    "author_association": "NONE",
    "body": "> > @winksaville The monitoring endpoint has a different API limit than the rest of beaconcha.in´s API and is not counted toward your normal limit. We'll review the limit on our end though since I'm not sure whether they are enough for unbatched metric reports. Ideally lighthouse adapts the batched metrics approach, alternatively we need to adapt the custom limit for the endpoint.\r\n> \r\n> Hmm, what is actually counted in the request limit on beaconcha.in isn't clear to me at all. All I know is that in the on [this page](https://beaconcha.in/user/settings#api)account the monthly total is 120,000+ requests/mth which is above 30,000, there is a link to [upgrade plan](https://beaconcha.in/pricing) and the response from the send-metrics beaconcha.in was a 429 \"Too many requests\".\r\n> \r\n> So AFAIK the only API I'm using from beaconch.in is the [POST /api/v1/client/metrics](https://beaconcha.in/api/v1/docs/index.html#/User/post_api_v1_client_metrics), which is issued when --monitoring-endpoint is enabled. What other information might geth or lighthouse be sending to them?\r\n> \r\n> Note; I'm running three nodes each with geth, lighthouse bn and lighthouse vc. Two nodes are on mainnet, one has 28 enabled validators the other has 0 and is a \"hot\" backup. The third node is associated with another account and its on prater, And it has 2 validators is registering 72,000 requests/mth. A week ago, when I raised this issue, I had --monitoring-endpoint enabled on the 6 lighthouse instances (3 bn's and 3 vc's), but currently there are no monitoring-endpoints enabled.\r\n\r\nI see, I don't think that this is a lighthouse issue then. In order to track two nodes or two machines you need a premium beaconcha.in subscription of Goldfish or higher. Otherwise those errors you are seeing are perfectly normal since you have reached the limit of your free tier. If you are having a premium subscription please reach out to us and open an issue at the beaconcha.in explorer repo.\r\n\r\nI don't see an issue with lighthouse`s implementation then. I would suggest to leave the default at 1min.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1234053036/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1234142583",
    "html_url": "https://github.com/sigp/lighthouse/issues/3514#issuecomment-1234142583",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3514",
    "id": 1234142583,
    "node_id": "IC_kwDOCFeAzc5Jj4V3",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-01T11:23:55Z",
    "updated_at": "2022-09-01T11:23:55Z",
    "author_association": "MEMBER",
    "body": "Awesome, I've changed the default back to 1min in the PR",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1234142583/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1234374003",
    "html_url": "https://github.com/sigp/lighthouse/issues/3514#issuecomment-1234374003",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3514",
    "id": 1234374003,
    "node_id": "IC_kwDOCFeAzc5Jkw1z",
    "user": {
      "login": "winksaville",
      "id": 1024284,
      "node_id": "MDQ6VXNlcjEwMjQyODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1024284?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/winksaville",
      "html_url": "https://github.com/winksaville",
      "followers_url": "https://api.github.com/users/winksaville/followers",
      "following_url": "https://api.github.com/users/winksaville/following{/other_user}",
      "gists_url": "https://api.github.com/users/winksaville/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/winksaville/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/winksaville/subscriptions",
      "organizations_url": "https://api.github.com/users/winksaville/orgs",
      "repos_url": "https://api.github.com/users/winksaville/repos",
      "events_url": "https://api.github.com/users/winksaville/events{/privacy}",
      "received_events_url": "https://api.github.com/users/winksaville/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-01T14:38:00Z",
    "updated_at": "2022-09-01T14:38:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "> > I'm not sure if you already utilize this but we added the possibility to batch all the metrics in one single request on our end:\r\n> \r\n> We do send the beacon, validator and system metrics in a single request.\r\n\r\nI'd like to be to do this as it could save bandwidth and halve the request count!\r\n\r\nI've looked at the code AFAICT reporting metrics from beacon-chain sends [beacon and system metrics](https://github.com/sigp/lighthouse/blob/aa022f46855df2a1420a6a80a788c73dc2779aa7/beacon_node/client/src/builder.rs#L563) and reporting metrics from validator_client sends [validator and system metrics](https://github.com/sigp/lighthouse/blob/aa022f46855df2a1420a6a80a788c73dc2779aa7/validator_client/src/lib.rs#L156).\r\n\r\nI'm unable to find a single request that sends all three, could you point me to the code and how I can enable it?",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1234374003/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
