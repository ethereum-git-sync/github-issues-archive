{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/4512",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/4512/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/4512/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/4512/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/4512",
  "id": 1808873928,
  "node_id": "I_kwDOCFeAzc5r0TnI",
  "number": 4512,
  "title": "Add `inactivity` penalties to Altair attestation rewards endpoint response",
  "user": {
    "login": "jimmygchen",
    "id": 742762,
    "node_id": "MDQ6VXNlcjc0Mjc2Mg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/742762?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jimmygchen",
    "html_url": "https://github.com/jimmygchen",
    "followers_url": "https://api.github.com/users/jimmygchen/followers",
    "following_url": "https://api.github.com/users/jimmygchen/following{/other_user}",
    "gists_url": "https://api.github.com/users/jimmygchen/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jimmygchen/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jimmygchen/subscriptions",
    "organizations_url": "https://api.github.com/users/jimmygchen/orgs",
    "repos_url": "https://api.github.com/users/jimmygchen/repos",
    "events_url": "https://api.github.com/users/jimmygchen/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jimmygchen/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 2336800343,
      "node_id": "MDU6TGFiZWwyMzM2ODAwMzQz",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/HTTP-API",
      "name": "HTTP-API",
      "color": "5A63A2",
      "default": false,
      "description": ""
    }
  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-07-18T01:22:15Z",
  "updated_at": "2023-09-27T21:06:44Z",
  "closed_at": null,
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nA new `inactivity` field has been introduced to the attestation rewards endpoint response in #4474 for Phase 0, to include the inactivity penalty which is not part of the `head`/`target`/`souce` rewards. This hasn't been added to Altair and the implementation needs to be updated.\r\n\r\n- Consensus spec: [link](https://github.com/ethereum/consensus-specs/blob/dev/specs/altair/beacon-chain.md#modified-get_inactivity_penalty_deltas)\r\n- Beacon API spec (PR): [link](https://github.com/ethereum/beacon-APIs/pull/340)\r\n\r\n### Example response\r\n\r\n```json\r\n{\r\n  \"ideal_rewards\": [\r\n    {\r\n      \"effective_balance\": \"32000000000\",\r\n      \"head\": \"212426\",\r\n      \"target\": \"212426\",\r\n      \"source\": \"212426\",\r\n      \"inactivity\": \"0\"\r\n    }\r\n  ],\r\n  \"total_rewards\": [\r\n    {\r\n      \"validator_index\": \"0\",\r\n      \"head\": \"212426\",\r\n      \"target\": \"212426\",\r\n      \"source\": \"212426\",\r\n      \"inactivity\": \"0\"\r\n    }  \r\n  ]\r\n}\r\n````\r\n\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/4512/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/4512/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1737653356",
    "html_url": "https://github.com/sigp/lighthouse/issues/4512#issuecomment-1737653356",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4512",
    "id": 1737653356,
    "node_id": "IC_kwDOCFeAzc5nknxs",
    "user": {
      "login": "zack-scott",
      "id": 106991885,
      "node_id": "U_kgDOBmCRDQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/106991885?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zack-scott",
      "html_url": "https://github.com/zack-scott",
      "followers_url": "https://api.github.com/users/zack-scott/followers",
      "following_url": "https://api.github.com/users/zack-scott/following{/other_user}",
      "gists_url": "https://api.github.com/users/zack-scott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zack-scott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zack-scott/subscriptions",
      "organizations_url": "https://api.github.com/users/zack-scott/orgs",
      "repos_url": "https://api.github.com/users/zack-scott/repos",
      "events_url": "https://api.github.com/users/zack-scott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zack-scott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-27T15:43:25Z",
    "updated_at": "2023-09-27T15:49:50Z",
    "author_association": "NONE",
    "body": "@jimmygchen I am seeing inactivity field in the API response for Altair using version 4.5.0 node. Is the inactivity field correctly calculated in Altair and later versions?",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1737653356/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1737686422",
    "html_url": "https://github.com/sigp/lighthouse/issues/4512#issuecomment-1737686422",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4512",
    "id": 1737686422,
    "node_id": "IC_kwDOCFeAzc5nkv2W",
    "user": {
      "login": "zack-scott",
      "id": 106991885,
      "node_id": "U_kgDOBmCRDQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/106991885?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zack-scott",
      "html_url": "https://github.com/zack-scott",
      "followers_url": "https://api.github.com/users/zack-scott/followers",
      "following_url": "https://api.github.com/users/zack-scott/following{/other_user}",
      "gists_url": "https://api.github.com/users/zack-scott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zack-scott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zack-scott/subscriptions",
      "organizations_url": "https://api.github.com/users/zack-scott/orgs",
      "repos_url": "https://api.github.com/users/zack-scott/repos",
      "events_url": "https://api.github.com/users/zack-scott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zack-scott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-27T16:04:06Z",
    "updated_at": "2023-09-27T16:04:06Z",
    "author_association": "NONE",
    "body": "@jimmygchen Also, I am not seeing inclusion_delay field for anything besides phase0. Not sure if this is expected behavior or needs to be implemented for Altair and later versions?",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1737686422/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1737935254",
    "html_url": "https://github.com/sigp/lighthouse/issues/4512#issuecomment-1737935254",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4512",
    "id": 1737935254,
    "node_id": "IC_kwDOCFeAzc5nlsmW",
    "user": {
      "login": "jimmygchen",
      "id": 742762,
      "node_id": "MDQ6VXNlcjc0Mjc2Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/742762?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jimmygchen",
      "html_url": "https://github.com/jimmygchen",
      "followers_url": "https://api.github.com/users/jimmygchen/followers",
      "following_url": "https://api.github.com/users/jimmygchen/following{/other_user}",
      "gists_url": "https://api.github.com/users/jimmygchen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jimmygchen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jimmygchen/subscriptions",
      "organizations_url": "https://api.github.com/users/jimmygchen/orgs",
      "repos_url": "https://api.github.com/users/jimmygchen/repos",
      "events_url": "https://api.github.com/users/jimmygchen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jimmygchen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-27T19:07:42Z",
    "updated_at": "2023-09-27T19:07:42Z",
    "author_association": "MEMBER",
    "body": "@zack-scott `inclusion_delay` is a phase0 component and is not applicable to from altair due to changes in how attestation rewards are calculated, hence you won't see it on altair and later slots.\r\n\r\nThe `inactivity` calculation hasn't been implemented on this API for Altair, and is what this issue need to address.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1737935254/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1738035845",
    "html_url": "https://github.com/sigp/lighthouse/issues/4512#issuecomment-1738035845",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4512",
    "id": 1738035845,
    "node_id": "IC_kwDOCFeAzc5nmFKF",
    "user": {
      "login": "zack-scott",
      "id": 106991885,
      "node_id": "U_kgDOBmCRDQ",
      "avatar_url": "https://avatars.githubusercontent.com/u/106991885?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zack-scott",
      "html_url": "https://github.com/zack-scott",
      "followers_url": "https://api.github.com/users/zack-scott/followers",
      "following_url": "https://api.github.com/users/zack-scott/following{/other_user}",
      "gists_url": "https://api.github.com/users/zack-scott/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zack-scott/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zack-scott/subscriptions",
      "organizations_url": "https://api.github.com/users/zack-scott/orgs",
      "repos_url": "https://api.github.com/users/zack-scott/repos",
      "events_url": "https://api.github.com/users/zack-scott/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zack-scott/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-09-27T20:30:07Z",
    "updated_at": "2023-09-27T21:06:44Z",
    "author_association": "NONE",
    "body": "@jimmygchen okay, I was just wanting to ensure that the inactivity calculation is missing just on Altair only.\r\n\r\nJust to clarify, Phase0, Bellatrix, and Capella versions do have the correct inactivity calculation in place?\r\n\r\n\r\nThis match statement seems to point Altair, Bellatrix, and Capella toward the compute_attestation_rewards_altair function \r\nhttps://github.com/jimmygchen/lighthouse/blob/stable/beacon_node/beacon_chain/src/attestation_rewards.rs#L54, which would mean everything post Phase0 needs inactivity penalty implemented I believe?",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1738035845/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
