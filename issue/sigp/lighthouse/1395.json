{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/1395",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/1395/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/1395/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/1395/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/1395",
  "id": 665658573,
  "node_id": "MDU6SXNzdWU2NjU2NTg1NzM=",
  "number": 1395,
  "title": "Beacon node exit with code 132 in docker",
  "user": {
    "login": "bjaq",
    "id": 9341532,
    "node_id": "MDQ6VXNlcjkzNDE1MzI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9341532?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bjaq",
    "html_url": "https://github.com/bjaq",
    "followers_url": "https://api.github.com/users/bjaq/followers",
    "following_url": "https://api.github.com/users/bjaq/following{/other_user}",
    "gists_url": "https://api.github.com/users/bjaq/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bjaq/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bjaq/subscriptions",
    "organizations_url": "https://api.github.com/users/bjaq/orgs",
    "repos_url": "https://api.github.com/users/bjaq/repos",
    "events_url": "https://api.github.com/users/bjaq/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bjaq/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 10,
  "created_at": "2020-07-25T20:49:10Z",
  "updated_at": "2020-07-31T05:47:00Z",
  "closed_at": "2020-07-31T05:47:00Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nWhen running lighthouse with docker-compose in Ubuntu, my beacon node container exit quickly after starting, with an exit code 132. I see no errors in the logs apart from the docker exit code (see below). Geth and the validator client are running fine. I'm a bit lost. \r\n\r\n![Capture](https://user-images.githubusercontent.com/9341532/88465632-e9399b80-cec4-11ea-8c2e-35edc25d3bca.PNG)\r\n\r\n```\r\nbeacon_node_1       | Jul 25 19:49:19.292 DEBG Completed batch received                awaiting_batches: 4, blocks: 48, id: 1, service: sync\r\nbeacon_node_1       | Jul 25 19:49:19.294 DEBG HTTP API request successful             duration_ms: 0, path: /spec/eth2_config, service: http\r\nbeacon_node_1       | Jul 25 19:49:19.300 DEBG Completed batch received                awaiting_batches: 4, blocks: 58, id: 4, service: sync\r\nbeacon_node_1       | Jul 25 19:49:19.303 DEBG Requesting batch                        peer: 16Uiu2HAm9phNDb4SXXTDoMJDS2mLCGyf5LLTh6ZyxF8LdiGMTDNf, id: 7, end_slot: 448, start_slot: 384, chain_id: 8780547912560591702, service: sync\r\nvalidator_client_1  | Jul 25 19:49:19.304 INFO Genesis has already occurred            seconds_ago: 2272754\r\nbeacon_node_1       | Jul 25 19:49:19.304 DEBG HTTP API request successful             duration_ms: 0, path: /beacon/genesis_time, service: http\r\nbeacon_node_1       | Jul 25 19:49:19.305 DEBG HTTP API request successful             duration_ms: 0, path: /beacon/genesis_validators_root, service: http\r\nbeacon_node_1       | Jul 25 19:49:19.305 DEBG Processing batch                        end_slot: 63, start_slot: 0, blocks: 48, id: 1, service: sync\r\ngeth_1              | INFO [07-25|19:49:19.308] Upgrading chain index                    type=bloombits percentage=18\r\ngeth_1              | INFO [07-25|19:49:19.307] Loaded local transaction journal         transactions=0 dropped=0\r\ngeth_1              | INFO [07-25|19:49:19.314] Regenerated local transaction journal    transactions=0 accounts=0\r\nvalidator_client_1  | Jul 25 19:49:19.322 INFO Loaded validator keypair store          voting_validators: 0\r\nvalidator_client_1  | Jul 25 19:49:19.325 INFO Block production service started        service: block\r\nvalidator_client_1  | Jul 25 19:49:19.335 INFO Attestation production service started  next_update_millis: 9664, service: attestation\r\ngeth_1              | INFO [07-25|19:49:19.360] Allocated fast sync bloom                size=512.00MiB\r\ngeth_1              | ERROR[07-25|19:49:19.523] Failed to enumerate USB devices          hub=trezor vendor=4617  failcount=3 err=\"failed to initialize libusb: libusb: unknown error [code -99]\"\r\ngeth_1              | ERROR[07-25|19:49:19.523] Failed to enumerate USB devices          hub=trezor vendor=21324 failcount=3 err=\"failed to initialize libusb: libusb: unknown error [code -99]\"\r\ngeth_1              | ERROR[07-25|19:49:19.524] Failed to enumerate USB devices          hub=ledger vendor=11415 failcount=3 err=\"failed to initialize libusb: libusb: unknown error [code -99]\"\r\ngeth_1              | INFO [07-25|19:49:19.590] New local node record                    seq=12 id=821ecfdc008da69a ip=127.0.0.1 udp=30303 tcp=30303\r\ngeth_1              | INFO [07-25|19:49:19.617] Started P2P networking                   self=enode://f9b2771aeab9bc0dfc773916a1d7084888e9bb94e0f106ec685fd869672fb5d092fb224bd4223a8089c1cf9c5407c68a932a3fa6675234af8ea6cb63e7f4d310@127.0.0.1:30303\r\ngeth_1              | INFO [07-25|19:49:19.649] IPC endpoint opened                      url=/root/.ethereum/goerli/geth.ipc\r\ngeth_1              | INFO [07-25|19:49:19.679] HTTP endpoint opened                     url=http://[::]:8545/               cors= vhosts=*\r\nlighthouse-docker_beacon_node_1 exited with code 132\r\ngeth_1              | INFO [07-25|19:49:27.397] Initializing fast sync bloom             items=1763753 errorrate=0.000 elapsed=8.014s\r\ngeth_1              | INFO [07-25|19:49:27.450] Upgrading chain index                    type=bloombits percentage=21\r\ngeth_1              | INFO [07-25|19:49:29.625] Block synchronisation started\r\ngeth_1              | INFO [07-25|19:49:29.943] Disabling direct-ancient mode            origin=3109919 ancient=2818047\r\ngeth_1              | INFO [07-25|19:49:30.020] Imported new block headers               count=65 elapsed=39.546ms number=3110009 hash=\"4448ed…b29e43\" ignored=25\r\ngeth_1              | INFO [07-25|19:49:30.043] Downloader queue stats                   receiptTasks=0 blockTasks=0 itemSize=555.87B throttle=8192\r\ngeth_1              | INFO [07-25|19:49:30.048] Imported new block receipts              count=3  elapsed=\"313.016µs\" number=3109922 hash=\"9dc0e5…160134\" age=22m18s  size=1.79KiB\r\ngeth_1              | INFO [07-25|19:49:30.161] Imported new block receipts              count=23 elapsed=9.066ms     number=3109945 hash=\"54b52f…89191e\" age=16m33s  size=59.57KiB\r\ngeth_1              | INFO [07-25|19:49:30.297] Imported new state entries               count=17 elapsed=\"2.3µs\"     processed=9496404 pending=241 retry=0 duplicate=0 unexpected=0\r\ngeth_1              | INFO [07-25|19:49:31.241] Looking for peers                        peercount=2 tried=18 static=0\r\ngeth_1              | INFO [07-25|19:49:31.668] New local node record                    seq=13 id=821ecfdc008da69a ip=20.43.35.139 udp=30303 tcp=30303\r\ngeth_1              | INFO [07-25|19:49:31.753] Imported new state entries               count=241 elapsed=\"3.3µs\"     processed=9496645 pending=1636 retry=0 duplicate=0 unexpected=0\r\ngeth_1              | INFO [07-25|19:49:32.733] Imported new state entries               count=384 elapsed=\"2.7µs\"     processed=9497029 pending=6470 retry=0 duplicate=0 unexpected=0\r\ngeth_1              | INFO [07-25|19:49:33.190] Imported new state entries               count=774 elapsed=\"965.55µs\"  processed=9497803 pending=7903 retry=0 duplicate=0 unexpected=0\r\ngeth_1              | INFO [07-25|19:49:33.434] Imported new state entries               count=421 elapsed=\"948.349µs\" processed=9498224 pending=8227 retry=0 duplicate=0 unexpected=0\r\ngeth_1              | INFO [07-25|19:49:34.028] Imported new state entries               count=1480 elapsed=4.263ms     processed=9499704 pending=7971 retry=0 duplicate=0 unexpected=0\r\ngeth_1              | INFO [07-25|19:49:34.280] Imported new state entries               count=384  elapsed=1.486ms     processed=9500088 pending=8211 retry=0 duplicate=0 unexpected=0\r\ngeth_1              | INFO [07-25|19:49:34.501] Imported new state entries               count=384  elapsed=2.226ms     processed=9500472 pending=8403 retry=0 duplicate=0 unexpected=0\r\ngeth_1              | INFO [07-25|19:49:34.891] Imported new state entries               count=1152 elapsed=4.103ms     processed=9501624 pending=8554 retry=0 duplicate=0 unexpected=0\r\nvalidator_client_1  | Jul 25 19:49:35.009 ERRO Unable connect to beacon node           error: ReqwestError(reqwest::Error { kind: Request, url: \"http://beacon_node:5052/node/syncing\", source: hyper::Error(Connect, ConnectError(\"dns error\", Custom { kind: Other, error: \"failed to lookup address information: Name or service not known\" })) }), service: notifier\r\n```\r\n\r\nI'm also running a mainnet and ropsten nodes on the same VM, but I changed the ports in the docker-compose.yml to avoid any conflicts.\r\n\r\nHere is the docker-compose.yml :\r\n\r\n```\r\nversion: \"3.0\"\r\n\r\nservices:\r\n    beacon_node:\r\n        image: sigp/lighthouse:latest\r\n        volumes:\r\n            - ./.lighthouse:/root/.lighthouse\r\n            - ./scripts:/root/scripts\r\n            - ./network:/root/network\r\n        ports:\r\n            - 5052:5052/tcp\r\n            - 5053:5053/tcp\r\n            - 9000:9000/tcp\r\n            - 9000:9000/udp\r\n        env_file: .env\r\n        command: sh /root/scripts/start-beacon-node.sh\r\n    validator_client:\r\n        image: sigp/lighthouse:latest\r\n        volumes:\r\n            - ./.lighthouse:/root/.lighthouse\r\n            - ./scripts:/root/scripts\r\n        depends_on:\r\n            - beacon_node\r\n        env_file: .env\r\n        command: sh /root/scripts/start-validator-client.sh\r\n    geth:\r\n        build:\r\n            context: geth\r\n        volumes:\r\n            - geth:/root/.ethereum\r\n            - ./scripts:/root/scripts\r\n        env_file: .env\r\n        ports:\r\n            - 30305:30305/tcp\r\n            - 30305:30305/udp\r\n\r\nvolumes:\r\n    geth:\r\n\r\n```\r\n\r\n\r\n\r\n## Version\r\n\r\nI'm running the latest docker image within Ubuntu 18.04 on an azure VM.\r\n\r\nI followed the instructions on this page : https://lighthouse-book.sigmaprime.io/become-a-validator-docker.html\r\n",
  "closed_by": {
    "login": "bors[bot]",
    "id": 26634292,
    "node_id": "MDM6Qm90MjY2MzQyOTI=",
    "avatar_url": "https://avatars.githubusercontent.com/in/1847?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bors%5Bbot%5D",
    "html_url": "https://github.com/apps/bors",
    "followers_url": "https://api.github.com/users/bors%5Bbot%5D/followers",
    "following_url": "https://api.github.com/users/bors%5Bbot%5D/following{/other_user}",
    "gists_url": "https://api.github.com/users/bors%5Bbot%5D/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bors%5Bbot%5D/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bors%5Bbot%5D/subscriptions",
    "organizations_url": "https://api.github.com/users/bors%5Bbot%5D/orgs",
    "repos_url": "https://api.github.com/users/bors%5Bbot%5D/repos",
    "events_url": "https://api.github.com/users/bors%5Bbot%5D/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bors%5Bbot%5D/received_events",
    "type": "Bot",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/1395/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/1395/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/664064024",
    "html_url": "https://github.com/sigp/lighthouse/issues/1395#issuecomment-664064024",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1395",
    "id": 664064024,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NDA2NDAyNA==",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-27T00:42:17Z",
    "updated_at": "2020-07-27T00:42:17Z",
    "author_association": "MEMBER",
    "body": "Hi @bjaq, I think signal 132 could be a SIGILL exit code due to executing an illegal instruction (based on https://alinex.gitlab.io/concepts/exitcodes/). At a guess, this could be from the new BLS crypto library we've recently integrated (#1335).\r\n\r\nWhat CPU are you running on? Could you please `cat /proc/cpuinfo` and post the output here?",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/664064024/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/664064377",
    "html_url": "https://github.com/sigp/lighthouse/issues/1395#issuecomment-664064377",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1395",
    "id": 664064377,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NDA2NDM3Nw==",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-27T00:44:14Z",
    "updated_at": "2020-07-27T00:44:14Z",
    "author_association": "MEMBER",
    "body": "The last few lines of `dmesg` output immediately after triggering the bug could also be useful",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/664064377/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/664192470",
    "html_url": "https://github.com/sigp/lighthouse/issues/1395#issuecomment-664192470",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1395",
    "id": 664192470,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NDE5MjQ3MA==",
    "user": {
      "login": "bjaq",
      "id": 9341532,
      "node_id": "MDQ6VXNlcjkzNDE1MzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9341532?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bjaq",
      "html_url": "https://github.com/bjaq",
      "followers_url": "https://api.github.com/users/bjaq/followers",
      "following_url": "https://api.github.com/users/bjaq/following{/other_user}",
      "gists_url": "https://api.github.com/users/bjaq/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bjaq/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bjaq/subscriptions",
      "organizations_url": "https://api.github.com/users/bjaq/orgs",
      "repos_url": "https://api.github.com/users/bjaq/repos",
      "events_url": "https://api.github.com/users/bjaq/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bjaq/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-27T08:15:01Z",
    "updated_at": "2020-07-27T08:15:01Z",
    "author_association": "NONE",
    "body": "Hi @michaelsproul \r\nSo yesterday I was able to run my beacon node by pulling the stable image instead of latest. Today I tried recreating the bug by pulling the latest image again but everything is running fine. So maybe it was fixed in the meantime.\r\n\r\nFor reference I'm still going to provide my cpuinfo : \r\n```\r\nprocessor       : 0\r\nvendor_id       : GenuineIntel\r\ncpu family      : 6\r\nmodel           : 85\r\nmodel name      : Intel(R) Xeon(R) Platinum 8171M CPU @ 2.60GHz\r\nstepping        : 4\r\nmicrocode       : 0xffffffff\r\ncpu MHz         : 2095.147\r\ncache size      : 36608 KB\r\nphysical id     : 0\r\nsiblings        : 4\r\ncore id         : 0\r\ncpu cores       : 2\r\napicid          : 0\r\ninitial apicid  : 0\r\nfpu             : yes\r\nfpu_exception   : yes\r\ncpuid level     : 21\r\nwp              : yes\r\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ss ht syscall nx pdpe1gb rdtscp lm constant_tsc rep_good nopl xtopology cpuid pni pclmulqdq vmx ssse3 fma cx16 pcid sse4_1 sse4_2 movbe popcnt aes xsave avx f16c rdrand hypervisor lahf_lm abm 3dnowprefetch invpcid_single pti tpr_shadow vnmi ept vpid fsgsbase bmi1 hle avx2 smep bmi2 erms invpcid rtm mpx avx512f avx512dq rdseed adx smap clflushopt avx512cd avx512bw avx512vl xsaveopt xsavec xsaves\r\nbugs            : cpu_meltdown spectre_v1 spectre_v2 spec_store_bypass l1tf mds swapgs taa itlb_multihit\r\nbogomips        : 4190.29\r\nclflush size    : 64\r\ncache_alignment : 64\r\naddress sizes   : 44 bits physical, 48 bits virtual\r\npower management:\r\n\r\nprocessor       : 1\r\nvendor_id       : GenuineIntel\r\ncpu family      : 6\r\nmodel           : 85\r\nmodel name      : Intel(R) Xeon(R) Platinum 8171M CPU @ 2.60GHz\r\nstepping        : 4\r\nmicrocode       : 0xffffffff\r\ncpu MHz         : 2095.147\r\ncache size      : 36608 KB\r\nphysical id     : 0\r\nsiblings        : 4\r\ncore id         : 0\r\ncpu cores       : 2\r\napicid          : 1\r\ninitial apicid  : 1\r\nfpu             : yes\r\nfpu_exception   : yes\r\ncpuid level     : 21\r\nwp              : yes\r\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ss ht syscall nx pdpe1gb rdtscp lm constant_tsc rep_good nopl xtopology cpuid pni pclmulqdq vmx ssse3 fma cx16 pcid sse4_1 sse4_2 movbe popcnt aes xsave avx f16c rdrand hypervisor lahf_lm abm 3dnowprefetch invpcid_single pti tpr_shadow vnmi ept vpid fsgsbase bmi1 hle avx2 smep bmi2 erms invpcid rtm mpx avx512f avx512dq rdseed adx smap clflushopt avx512cd avx512bw avx512vl xsaveopt xsavec xsaves\r\nbugs            : cpu_meltdown spectre_v1 spectre_v2 spec_store_bypass l1tf mds swapgs taa itlb_multihit\r\nbogomips        : 4190.29\r\nclflush size    : 64\r\ncache_alignment : 64\r\naddress sizes   : 44 bits physical, 48 bits virtual\r\npower management:\r\n\r\nprocessor       : 2\r\nvendor_id       : GenuineIntel\r\ncpu family      : 6\r\nmodel           : 85\r\nmodel name      : Intel(R) Xeon(R) Platinum 8171M CPU @ 2.60GHz\r\nstepping        : 4\r\nmicrocode       : 0xffffffff\r\ncpu MHz         : 2095.147\r\ncache size      : 36608 KB\r\nphysical id     : 0\r\nsiblings        : 4\r\ncore id         : 1\r\ncpu cores       : 2\r\napicid          : 2\r\ninitial apicid  : 2\r\nfpu             : yes\r\nfpu_exception   : yes\r\ncpuid level     : 21\r\nwp              : yes\r\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ss ht syscall nx pdpe1gb rdtscp lm constant_tsc rep_good nopl xtopology cpuid pni pclmulqdq vmx ssse3 fma cx16 pcid sse4_1 sse4_2 movbe popcnt aes xsave avx f16c rdrand hypervisor lahf_lm abm 3dnowprefetch invpcid_single pti tpr_shadow vnmi ept vpid fsgsbase bmi1 hle avx2 smep bmi2 erms invpcid rtm mpx avx512f avx512dq rdseed adx smap clflushopt avx512cd avx512bw avx512vl xsaveopt xsavec xsaves\r\nbugs            : cpu_meltdown spectre_v1 spectre_v2 spec_store_bypass l1tf mds swapgs taa itlb_multihit\r\nbogomips        : 4190.29\r\nclflush size    : 64\r\ncache_alignment : 64\r\naddress sizes   : 44 bits physical, 48 bits virtual\r\npower management:\r\n\r\nprocessor       : 3\r\nvendor_id       : GenuineIntel\r\ncpu family      : 6\r\nmodel           : 85\r\nmodel name      : Intel(R) Xeon(R) Platinum 8171M CPU @ 2.60GHz\r\nstepping        : 4\r\nmicrocode       : 0xffffffff\r\ncpu MHz         : 2095.147\r\ncache size      : 36608 KB\r\nphysical id     : 0\r\nsiblings        : 4\r\ncore id         : 1\r\ncpu cores       : 2\r\napicid          : 3\r\ninitial apicid  : 3\r\nfpu             : yes\r\nfpu_exception   : yes\r\ncpuid level     : 21\r\nwp              : yes\r\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ss ht syscall nx pdpe1gb rdtscp lm constant_tsc rep_good nopl xtopology cpuid pni pclmulqdq vmx ssse3 fma cx16 pcid sse4_1 sse4_2 movbe popcnt aes xsave avx f16c rdrand hypervisor lahf_lm abm 3dnowprefetch invpcid_single pti tpr_shadow vnmi ept vpid fsgsbase bmi1 hle avx2 smep bmi2 erms invpcid rtm mpx avx512f avx512dq rdseed adx smap clflushopt avx512cd avx512bw avx512vl xsaveopt xsavec xsaves\r\nbugs            : cpu_meltdown spectre_v1 spectre_v2 spec_store_bypass l1tf mds swapgs taa itlb_multihit\r\nbogomips        : 4190.29\r\nclflush size    : 64\r\ncache_alignment : 64\r\naddress sizes   : 44 bits physical, 48 bits virtual\r\npower management:\r\n\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/664192470/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/665494251",
    "html_url": "https://github.com/sigp/lighthouse/issues/1395#issuecomment-665494251",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1395",
    "id": 665494251,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NTQ5NDI1MQ==",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-29T07:43:37Z",
    "updated_at": "2020-07-29T07:43:37Z",
    "author_association": "MEMBER",
    "body": "I've seen this issue when compiling the lighthouse binary on another machine and shifting the binary. \r\n\r\nLatest code seems to compile to use specific CPU instructions. Compiling locally resolved the issue for me. \r\n\r\nWas there a chance the binary was compiled on a machine of virtual machine that wasn't running it?",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/665494251/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/665554878",
    "html_url": "https://github.com/sigp/lighthouse/issues/1395#issuecomment-665554878",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1395",
    "id": 665554878,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NTU1NDg3OA==",
    "user": {
      "login": "bjaq",
      "id": 9341532,
      "node_id": "MDQ6VXNlcjkzNDE1MzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9341532?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bjaq",
      "html_url": "https://github.com/bjaq",
      "followers_url": "https://api.github.com/users/bjaq/followers",
      "following_url": "https://api.github.com/users/bjaq/following{/other_user}",
      "gists_url": "https://api.github.com/users/bjaq/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bjaq/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bjaq/subscriptions",
      "organizations_url": "https://api.github.com/users/bjaq/orgs",
      "repos_url": "https://api.github.com/users/bjaq/repos",
      "events_url": "https://api.github.com/users/bjaq/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bjaq/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-29T09:34:48Z",
    "updated_at": "2020-07-29T09:34:48Z",
    "author_association": "NONE",
    "body": "I'm using docker so yes indeed the binary was not compiled on my machine. I'm just pulling the pre-compiled binary from the docker hub : https://hub.docker.com/r/sigp/lighthouse.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/665554878/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/665592641",
    "html_url": "https://github.com/sigp/lighthouse/issues/1395#issuecomment-665592641",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1395",
    "id": 665592641,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NTU5MjY0MQ==",
    "user": {
      "login": "bjaq",
      "id": 9341532,
      "node_id": "MDQ6VXNlcjkzNDE1MzI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9341532?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bjaq",
      "html_url": "https://github.com/bjaq",
      "followers_url": "https://api.github.com/users/bjaq/followers",
      "following_url": "https://api.github.com/users/bjaq/following{/other_user}",
      "gists_url": "https://api.github.com/users/bjaq/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bjaq/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bjaq/subscriptions",
      "organizations_url": "https://api.github.com/users/bjaq/orgs",
      "repos_url": "https://api.github.com/users/bjaq/repos",
      "events_url": "https://api.github.com/users/bjaq/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bjaq/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-29T10:49:41Z",
    "updated_at": "2020-07-29T10:49:41Z",
    "author_association": "NONE",
    "body": "I tried again to reproduce the issue without success. Everything is running fine now for me so I will close for now and reopen if it happens again.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/665592641/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/665644215",
    "html_url": "https://github.com/sigp/lighthouse/issues/1395#issuecomment-665644215",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1395",
    "id": 665644215,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NTY0NDIxNQ==",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-29T12:50:08Z",
    "updated_at": "2020-07-29T12:50:08Z",
    "author_association": "MEMBER",
    "body": "This occurs when the lighthouse binary is built on one cpu architecture an ran on another.\r\n\r\nThis is of particular annoyance when building our docker image. We need to build the image in a more general way for all CPU's. \r\n\r\nReopening this as it seems #1416 does not resolve this",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/665644215/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/665692099",
    "html_url": "https://github.com/sigp/lighthouse/issues/1395#issuecomment-665692099",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1395",
    "id": 665692099,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NTY5MjA5OQ==",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-29T14:18:00Z",
    "updated_at": "2020-07-29T14:18:00Z",
    "author_association": "MEMBER",
    "body": "I suspect we need to tweak the C compiler options that BLST is compiled with, as that's a recent change likely to have introduced novel CPU instructions",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/665692099/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/666029196",
    "html_url": "https://github.com/sigp/lighthouse/issues/1395#issuecomment-666029196",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1395",
    "id": 666029196,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NjAyOTE5Ng==",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-30T01:43:57Z",
    "updated_at": "2020-07-30T01:43:57Z",
    "author_association": "MEMBER",
    "body": "Yep, it's definitely the BLS library. I just ran `lighthouse bn` under GDB and I get this backtrace on the SIGILL:\r\n\r\n```\r\n#0  0x0000555556ba55a1 in mulx_mont_384 ()\r\n#1  0x0000555556b9bf18 in POINTonE1_Uncompress ()\r\n#2  0x0000555556b8c5d1 in blst::min_pk::PublicKey::uncompress ()\r\n#3  0x0000555556b8a753 in bls::impls::blst::<impl bls::generic_public_key::TPublicKey for blst::min_pk::PublicKe\r\ny>::deserialize ()\r\n#4  0x00005555569357a3 in state_processing::per_block_processing::signature_sets::deposit_pubkey_signature_messa\r\nge ()\r\n#5  0x00005555565480d3 in eth1::deposit_log::DepositLog::from_log ()\r\n#6  0x0000555555f48fec in <core::iter::adapters::ResultShunt<I,E> as core::iter::traits::iterator::Iterator>::ne\r\nxt ()\r\n#7  0x000055555575b861 in <alloc::vec::Vec<T> as alloc::vec::SpecExtend<T,I>>::from_iter ()\r\n```\r\n\r\nThe `mulx_mont_384` function is here: https://github.com/supranational/blst/blob/d02b0d86e25d700ce4f4cb0eccac1f743aea6986/build/elf/mulx_mont_384-x86_64.s#L1710 and contains a `mulxq` instruction that looks suspect, I'll investigate.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/666029196/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/666521072",
    "html_url": "https://github.com/sigp/lighthouse/issues/1395#issuecomment-666521072",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1395",
    "id": 666521072,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2NjUyMTA3Mg==",
    "user": {
      "login": "andreogle",
      "id": 4114009,
      "node_id": "MDQ6VXNlcjQxMTQwMDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4114009?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/andreogle",
      "html_url": "https://github.com/andreogle",
      "followers_url": "https://api.github.com/users/andreogle/followers",
      "following_url": "https://api.github.com/users/andreogle/following{/other_user}",
      "gists_url": "https://api.github.com/users/andreogle/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/andreogle/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/andreogle/subscriptions",
      "organizations_url": "https://api.github.com/users/andreogle/orgs",
      "repos_url": "https://api.github.com/users/andreogle/repos",
      "events_url": "https://api.github.com/users/andreogle/events{/privacy}",
      "received_events_url": "https://api.github.com/users/andreogle/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-30T16:51:50Z",
    "updated_at": "2020-07-30T16:51:50Z",
    "author_association": "NONE",
    "body": "If it's any help, I'm getting this same issue on a fresh Ubuntu 20.04 instance on DigitalOcean",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/666521072/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
