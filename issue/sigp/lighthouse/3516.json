{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/3516",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/3516/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/3516/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/3516/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/3516",
  "id": 1353115442,
  "node_id": "I_kwDOCFeAzc5Qpucy",
  "number": 3516,
  "title": "VC: Publish to multiple BNs",
  "user": {
    "login": "lfinbob",
    "id": 99162861,
    "node_id": "U_kgDOBeka7Q",
    "avatar_url": "https://avatars.githubusercontent.com/u/99162861?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/lfinbob",
    "html_url": "https://github.com/lfinbob",
    "followers_url": "https://api.github.com/users/lfinbob/followers",
    "following_url": "https://api.github.com/users/lfinbob/following{/other_user}",
    "gists_url": "https://api.github.com/users/lfinbob/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/lfinbob/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/lfinbob/subscriptions",
    "organizations_url": "https://api.github.com/users/lfinbob/orgs",
    "repos_url": "https://api.github.com/users/lfinbob/repos",
    "events_url": "https://api.github.com/users/lfinbob/events{/privacy}",
    "received_events_url": "https://api.github.com/users/lfinbob/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 985647284,
      "node_id": "MDU6TGFiZWw5ODU2NDcyODQ=",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/enhancement",
      "name": "enhancement",
      "color": "a2eeef",
      "default": true,
      "description": "New feature or request"
    },
    {
      "id": 1245875191,
      "node_id": "MDU6TGFiZWwxMjQ1ODc1MTkx",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/val-client",
      "name": "val-client",
      "color": "9cd6fc",
      "default": false,
      "description": "Relates to the validator client binary"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-08-27T18:37:16Z",
  "updated_at": "2022-10-25T22:08:56Z",
  "closed_at": "2022-10-25T22:08:56Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I have my lighthouse VC connected to 2 BNs (primary and fallback).\r\nI propose to add a flag that makes the VC publish messages via _all_ connected BNs concurrently.\r\nThat would sidestep bad fall-back experiences (see [comment in 3002](https://github.com/sigp/lighthouse/issues/3002#issuecomment-1229185227)) with missed attestions/proposals/sync committees.\r\nIt would also increase the chances of messages being successfully published despite spotty internet connections with occasional packet loss on the beacon nodes.\r\n\r\nImplementing this would make #3001 and #3002 not required anymore for solid fall-back.",
  "closed_by": {
    "login": "paulhauner",
    "id": 6660660,
    "node_id": "MDQ6VXNlcjY2NjA2NjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/paulhauner",
    "html_url": "https://github.com/paulhauner",
    "followers_url": "https://api.github.com/users/paulhauner/followers",
    "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
    "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
    "organizations_url": "https://api.github.com/users/paulhauner/orgs",
    "repos_url": "https://api.github.com/users/paulhauner/repos",
    "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/paulhauner/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/3516/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/3516/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1265053204",
    "html_url": "https://github.com/sigp/lighthouse/issues/3516#issuecomment-1265053204",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3516",
    "id": 1265053204,
    "node_id": "IC_kwDOCFeAzc5LZy4U",
    "user": {
      "login": "lfinbob",
      "id": 99162861,
      "node_id": "U_kgDOBeka7Q",
      "avatar_url": "https://avatars.githubusercontent.com/u/99162861?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lfinbob",
      "html_url": "https://github.com/lfinbob",
      "followers_url": "https://api.github.com/users/lfinbob/followers",
      "following_url": "https://api.github.com/users/lfinbob/following{/other_user}",
      "gists_url": "https://api.github.com/users/lfinbob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lfinbob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lfinbob/subscriptions",
      "organizations_url": "https://api.github.com/users/lfinbob/orgs",
      "repos_url": "https://api.github.com/users/lfinbob/repos",
      "events_url": "https://api.github.com/users/lfinbob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lfinbob/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-03T07:39:12Z",
    "updated_at": "2022-10-03T07:39:12Z",
    "author_association": "NONE",
    "body": "Here's an additional use-case for this:\r\n\r\nMy lighthouse VC is connected to 2 different BNs. I then switched the first BN's EC from Besu to Geth, requiring a Geth sync. Which takes many hours.\r\nFor all that time the VC dumbly uses the degraded BN instead of switching to the healthy fallback BN.\r\n\r\nThe VC continues to log that it is connected to 2 BNs:\r\n> INFO Connected to beacon node(s)             synced: 2, available: 2, total: 2, service: notifier\r\n\r\nMeanwhile the VC still chooses the unhealthy BN to publish attestations. The unhealthy BN logs:\r\n> WARN Execution endpoint is not synced\r\n> ERRO Error updating deposit contract cache\r\n> WARN Head is optimistic [...] chain not fully verified, block and attestation production disabled until execution engine syncs\r\n> Attestation included in aggregate       validator: [...]\r\n> INFO Attestation included in block           validator: [...]\r\n\r\nThis makes fall back system pretty useless if one has to resync the EC.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1265053204/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1265288065",
    "html_url": "https://github.com/sigp/lighthouse/issues/3516#issuecomment-1265288065",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3516",
    "id": 1265288065,
    "node_id": "IC_kwDOCFeAzc5LasOB",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-03T11:13:59Z",
    "updated_at": "2022-10-03T11:13:59Z",
    "author_association": "MEMBER",
    "body": "@lfinbob We're aware of the issues with the current fallback implementation and have opened a tracking issue to gather feedback, and refine the design: https://github.com/sigp/lighthouse/issues/3613. I think the behaviour you observed is a textbook instance of the problem described in that issue, and that the flood-publishing of this issue could be implemented in addition to improvements to the fallback system.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1265288065/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1265363569",
    "html_url": "https://github.com/sigp/lighthouse/issues/3516#issuecomment-1265363569",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3516",
    "id": 1265363569,
    "node_id": "IC_kwDOCFeAzc5La-px",
    "user": {
      "login": "lfinbob",
      "id": 99162861,
      "node_id": "U_kgDOBeka7Q",
      "avatar_url": "https://avatars.githubusercontent.com/u/99162861?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/lfinbob",
      "html_url": "https://github.com/lfinbob",
      "followers_url": "https://api.github.com/users/lfinbob/followers",
      "following_url": "https://api.github.com/users/lfinbob/following{/other_user}",
      "gists_url": "https://api.github.com/users/lfinbob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/lfinbob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/lfinbob/subscriptions",
      "organizations_url": "https://api.github.com/users/lfinbob/orgs",
      "repos_url": "https://api.github.com/users/lfinbob/repos",
      "events_url": "https://api.github.com/users/lfinbob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/lfinbob/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-03T12:23:51Z",
    "updated_at": "2022-10-03T12:23:51Z",
    "author_association": "NONE",
    "body": "Great to read you guys are working on this, much appreciated.\r\nI think flood publishing might be the fast & easy improvement, maybe a low-hanging fruit even. \r\nAlso it should have the secondary benefit of getting marginally better inclusion distances.\r\n\r\nI vote for implementing this quickly, giving more time and thought to the more thorough enhancements described in #3613.\r\nThat would make the common two-machine-setup (1 primary, 1 fallback) for solo stakers and Rocket Pool node operators work smoothly with lighthouse immediately.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1265363569/reactions",
      "total_count": 3,
      "+1": 3,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1271481894",
    "html_url": "https://github.com/sigp/lighthouse/issues/3516#issuecomment-1271481894",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3516",
    "id": 1271481894,
    "node_id": "IC_kwDOCFeAzc5LyUYm",
    "user": {
      "login": "xrchz",
      "id": 181254,
      "node_id": "MDQ6VXNlcjE4MTI1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/181254?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/xrchz",
      "html_url": "https://github.com/xrchz",
      "followers_url": "https://api.github.com/users/xrchz/followers",
      "following_url": "https://api.github.com/users/xrchz/following{/other_user}",
      "gists_url": "https://api.github.com/users/xrchz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/xrchz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/xrchz/subscriptions",
      "organizations_url": "https://api.github.com/users/xrchz/orgs",
      "repos_url": "https://api.github.com/users/xrchz/repos",
      "events_url": "https://api.github.com/users/xrchz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/xrchz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-07T11:40:43Z",
    "updated_at": "2022-10-07T11:40:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "I had a block proposal fail to use the builder network on my fallback because my primary was still syncing - I suspect flood publishing would have avoided this. Very keen to see it soon.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1271481894/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
