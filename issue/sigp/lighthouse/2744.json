{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/2744",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/2744/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/2744/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/2744/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/2744",
  "id": 1034275103,
  "node_id": "I_kwDOCFeAzc49pckf",
  "number": 2744,
  "title": "Bootnode warning about invalid ENR",
  "user": {
    "login": "k1rill-fedoseev",
    "id": 29590423,
    "node_id": "MDQ6VXNlcjI5NTkwNDIz",
    "avatar_url": "https://avatars.githubusercontent.com/u/29590423?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/k1rill-fedoseev",
    "html_url": "https://github.com/k1rill-fedoseev",
    "followers_url": "https://api.github.com/users/k1rill-fedoseev/followers",
    "following_url": "https://api.github.com/users/k1rill-fedoseev/following{/other_user}",
    "gists_url": "https://api.github.com/users/k1rill-fedoseev/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/k1rill-fedoseev/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/k1rill-fedoseev/subscriptions",
    "organizations_url": "https://api.github.com/users/k1rill-fedoseev/orgs",
    "repos_url": "https://api.github.com/users/k1rill-fedoseev/repos",
    "events_url": "https://api.github.com/users/k1rill-fedoseev/events{/privacy}",
    "received_events_url": "https://api.github.com/users/k1rill-fedoseev/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2021-10-23T22:18:37Z",
  "updated_at": "2021-11-02T03:13:43Z",
  "closed_at": "2021-11-02T03:13:43Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nI am trying to run a boot node for some private testnet.\r\nI see a lot of warnings in the logs like:\r\n```\r\nWARN Session has invalid ENR. Enr socket: Some(<IP>:12000), Node: 0x5df1..d0fd, addr: <IP>:1024\r\n```\r\n\r\n## Version\r\n\r\nLighthouse v2.0.1\r\nBeacon node is run in docker container\r\nBootnode is run natively (it didn't work in docker at all)\r\n\r\n## Present Behaviour\r\n\r\nWarnings in the logs.\r\n\r\n## Expected Behaviour\r\n\r\nNode should be able to connect to boot node without issues.\r\n",
  "closed_by": {
    "login": "AgeManning",
    "id": 7454587,
    "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AgeManning",
    "html_url": "https://github.com/AgeManning",
    "followers_url": "https://api.github.com/users/AgeManning/followers",
    "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
    "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
    "organizations_url": "https://api.github.com/users/AgeManning/orgs",
    "repos_url": "https://api.github.com/users/AgeManning/repos",
    "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AgeManning/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/2744/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/2744/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/951408553",
    "html_url": "https://github.com/sigp/lighthouse/issues/2744#issuecomment-951408553",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2744",
    "id": 951408553,
    "node_id": "IC_kwDOCFeAzc44tVep",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-25T23:16:05Z",
    "updated_at": "2021-10-25T23:16:05Z",
    "author_association": "MEMBER",
    "body": "These warnings are telling you that the node that is trying to connect to you is supplying you with the wrong ENR. \r\n\r\nThe node connecting node is saying, hey i'm at IP:12000 but really they are connecting to you on IP:1024. This can happen due to NAT'ing for example. Node's that falsely advertise their ENR's we reject, because if we added their ENR to our routing table, they would not be contactable, and we'd be passing around non-contactable ENR's to those who ask for peers (which is a waste of our resources and also DHT space). \r\n\r\nThere are two solutions: \r\n\r\n1. The connecting node should not set their IP/port if they don't know their external contactable port (or if they don't have port forwards). ENR's do not require this field to be set. If this node is behind a NAT and non-contactable, then your bootnode will still respond to their requests, but will not add them to the DHT (because they are non-contactable). \r\n\r\nIf the node is actually contactable, and it can connect to 10 (this is a default parameter) other nodes, then it will automatically update its ENR to the correct value based on what the other nodes see. \r\n\r\n2. Set the correct IP:Port that matches the external port forward for the node. \r\n\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/951408553/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/951410397",
    "html_url": "https://github.com/sigp/lighthouse/issues/2744#issuecomment-951410397",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2744",
    "id": 951410397,
    "node_id": "IC_kwDOCFeAzc44tV7d",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-25T23:18:53Z",
    "updated_at": "2021-10-25T23:18:53Z",
    "author_association": "MEMBER",
    "body": "We do have scripts that help you set up private testnets also. They are here for reference: https://github.com/sigp/lighthouse/tree/stable/scripts/local_testnet",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/951410397/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/957062165",
    "html_url": "https://github.com/sigp/lighthouse/issues/2744#issuecomment-957062165",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2744",
    "id": 957062165,
    "node_id": "IC_kwDOCFeAzc45C5wV",
    "user": {
      "login": "AgeManning",
      "id": 7454587,
      "node_id": "MDQ6VXNlcjc0NTQ1ODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7454587?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AgeManning",
      "html_url": "https://github.com/AgeManning",
      "followers_url": "https://api.github.com/users/AgeManning/followers",
      "following_url": "https://api.github.com/users/AgeManning/following{/other_user}",
      "gists_url": "https://api.github.com/users/AgeManning/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AgeManning/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AgeManning/subscriptions",
      "organizations_url": "https://api.github.com/users/AgeManning/orgs",
      "repos_url": "https://api.github.com/users/AgeManning/repos",
      "events_url": "https://api.github.com/users/AgeManning/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AgeManning/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-02T03:13:43Z",
    "updated_at": "2021-11-02T03:13:43Z",
    "author_association": "MEMBER",
    "body": "I'm closing this issue as I think its addressed and is becoming stale.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/957062165/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
