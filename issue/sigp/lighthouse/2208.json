{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/2208",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/2208/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/2208/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/2208/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/2208",
  "id": 810408622,
  "node_id": "MDU6SXNzdWU4MTA0MDg2MjI=",
  "number": 2208,
  "title": "Validator node does not start after updating from v1.1.0 to v1.1.1",
  "user": {
    "login": "maurodelazeri",
    "id": 1005120,
    "node_id": "MDQ6VXNlcjEwMDUxMjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1005120?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/maurodelazeri",
    "html_url": "https://github.com/maurodelazeri",
    "followers_url": "https://api.github.com/users/maurodelazeri/followers",
    "following_url": "https://api.github.com/users/maurodelazeri/following{/other_user}",
    "gists_url": "https://api.github.com/users/maurodelazeri/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/maurodelazeri/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/maurodelazeri/subscriptions",
    "organizations_url": "https://api.github.com/users/maurodelazeri/orgs",
    "repos_url": "https://api.github.com/users/maurodelazeri/repos",
    "events_url": "https://api.github.com/users/maurodelazeri/events{/privacy}",
    "received_events_url": "https://api.github.com/users/maurodelazeri/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-02-17T17:57:13Z",
  "updated_at": "2021-02-17T21:36:40Z",
  "closed_at": "2021-02-17T18:58:38Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nPlease provide a brief description of the issue.\r\n\r\nI use the client with docker... I cant update from the previous version to the new version\r\n\r\nPrevious version:\r\n\r\n```\r\nLighthouse v1.1.0-e4b6213\r\nBLS Library: blst-portable\r\nSpecs: mainnet (true), minimal (false), v0.12.3 (false)\r\n```\r\n\r\nNew version: latest\r\n\r\n## Version\r\n\r\nPlease provide your Lighthouse and Rust version. Are you building from\r\n`stable` or `unstable`, which commit?\r\n\r\n```\r\nLighthouse v1.1.0-e4b6213\r\nBLS Library: blst-portable\r\nSpecs: mainnet (true), minimal (false), v0.12.3 (false)\r\n```\r\n\r\n## Present Behaviour\r\n\r\nThe beacon node works fine, but the validator does not start, it shows the follows:\r\n\r\n```\r\nroot@venus:~/eth2-stack/stack/testnet# docker logs validator_node --follow --tail 10\r\nversionnote: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\r\n: Lighthouse/v1.1.1-f819ba5\r\nFeb 17 17:29:07.054 INFO Configured for network                  name: pyrmont\r\nFeb 17 17:29:07.054 INFO Starting validator client               validator_dir: \"/var/lib/lighthouse/validators\", beacon_nodes: [\"http://beacon_node:5052\"]\r\nFeb 17 17:35:03.227 INFO Shutting down..\r\nFeb 17 17:35:07.823 INFOthread 'tokio-runtime-worker' panicked at 'missing scheme', /usr/local/cargo/registry/src/github.com-1ecc6299db9ec823/warp-0.3.0/src/filters/cors.rs:620:37\r\nnote: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\r\n Lighthouse started                      version: Lighthouse/v1.1.1-f819ba5\r\nFeb 17 17:35:07.823 INFO Configured for network                  name: pyrmont\r\nFeb 17 17:35:07.824 INFO Starting validator client               validator_dir: \"/var/lib/lighthouse/validators\", beacon_nodes: [\"http://beacon_node:5052\"]\r\n^C\r\n```\r\n\r\nand with `RUST_BACKTRACE=1`\r\n\r\n```\r\nroot@venus:~/eth2-stack/stack/testnet# docker logs validator_node --follow --tail 10\r\n  12: tokio::runtime::task::harness::Harness<T,S>::poll\r\n  13: std::thread::local::LocalKey<T>::with\r\n  14: tokio::runtime::thread_pool::worker::Context::run_task\r\n  15: tokio::runtime::thread_pool::worker::Context::run\r\n  16: tokio::macros::scoped_tls::ScopedKey<T>::set\r\n  17: tokio::runtime::thread_pool::worker::run\r\n  18: tokio::loom::std::unsafe_cell::UnsafeCell<T>::with_mut\r\n  19: <std::panic::AssertUnwindSafe<F> as core::ops::function::FnOnce<()>>::call_once\r\n  20: tokio::runtime::task::harness::Harness<T,S>::poll\r\nnote: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.\r\n```\r\n\r\n\r\nDescribe the present behaviour of the application, with regards to this\r\nissue.\r\n\r\n## Expected Behaviour\r\n\r\nshould work, if I rollback to the previous version it works fine\r\n\r\n## Steps to resolve\r\n\r\nYou can use the docker-composer bellow:\r\n\r\n```\r\nversion: \"3\"\r\n\r\nnetworks:\r\n  monitor-net:\r\n    driver: bridge\r\n\r\nservices:\r\n  validator_node:\r\n    image: sigp/lighthouse\r\n    networks:\r\n      - monitor-net\r\n    container_name: validator_node\r\n    hostname: validator_node\r\n    restart: unless-stopped\r\n    ports:\r\n      - 5064:5064/tcp     # metrics endpoint\r\n    volumes:\r\n      - ./lighthouse:/var/lib/lighthouse\r\n    depends_on:\r\n        - beacon_node\r\n        - geth\r\n    stop_signal: SIGINT\r\n    stop_grace_period: 2m\r\n    command:\r\n      - lighthouse\r\n      - vc\r\n      - --network \r\n      - pyrmont\r\n      - --metrics\r\n      - --metrics-address\r\n      - \"0.0.0.0\"\r\n      - --metrics-allow-origin\r\n      - \"*\"\r\n      - --metrics-port\r\n      - \"5064\"\r\n      - --beacon-nodes\r\n      - http://beacon_node:5052\r\n      - --graffiti \r\n      - \"House Stark Dev\"\r\n      - --datadir \r\n      - /var/lib/lighthouse\r\n    logging:\r\n      driver: \"json-file\"\r\n      options:\r\n        max-size: \"2m\"\r\n        max-file: \"10\"\r\n        \r\n  beacon_node:\r\n    image: sigp/lighthouse\r\n    networks:\r\n      - monitor-net\r\n    container_name: beacon_node\r\n    hostname: beacon_node\r\n    restart: unless-stopped\r\n    ports:\r\n      - 5052:5052/tcp\r\n      - 5053:5053/tcp\r\n      - 5054:5054/tcp     # metrics endpoint\r\n      - 9000:9000/tcp\r\n      - 9000:9000/udp\r\n    volumes:\r\n      - ./lighthouse:/var/lib/lighthouse\r\n    depends_on:\r\n        - geth\r\n    stop_signal: SIGINT\r\n    stop_grace_period: 2m\r\n    command:\r\n      - lighthouse\r\n      - bn\r\n      - --validator-monitor-auto\r\n      - --slasher\r\n      - --debug-level \r\n      - debug\r\n      - --slasher-dir\r\n      - /var/lib/lighthouse\r\n      - --slasher-history-length \r\n      - \"256\" \r\n      - --slasher-max-db-size \r\n      - \"16\"\r\n      - --network\r\n      - pyrmont\r\n      - --datadir\r\n      - /var/lib/lighthouse\r\n      - --staking\r\n      - --metrics\r\n      - --metrics-address\r\n      - \"0.0.0.0\"\r\n      - --metrics-allow-origin\r\n      - \"*\"\r\n      - --metrics-port\r\n      - \"5054\"\r\n      - --http\r\n      - --http-allow-origin\r\n      - \"*\"\r\n      - --http-address\r\n      - \"0.0.0.0\"\r\n      - --subscribe-all-subnets\r\n      - --import-all-attestations\r\n      - --eth1-endpoints\r\n      - http://geth:8545\r\n    logging:\r\n      driver: \"json-file\"\r\n      options:\r\n        max-size: \"2m\"\r\n        max-file: \"10\"\r\n  geth:\r\n    image: ethereum/client-go:v1.9.25\r\n    networks:\r\n      - monitor-net\r\n    container_name: geth\r\n    hostname: geth\r\n    restart: unless-stopped\r\n    ports:\r\n      - \"30303:30303\"\r\n      - \"30303:30303/udp\"\r\n      - \"8545:8545\"\r\n      - \"8546:8546\"\r\n      - \"6060:6060\"\r\n    volumes:\r\n      - ./goethereum:/var/lib/goethereum\r\n    stop_signal: SIGINT\r\n    stop_grace_period: 2m\r\n    command:\r\n      - --goerli\r\n      - --nousb\r\n      - --http\r\n      - --syncmode=fast\r\n      - --nousb\r\n      - --cache=4096\r\n      - --maxpeers=50\r\n      - --metrics\r\n      - --pprof\r\n      - --pprof.addr=0.0.0.0\r\n      - --http.addr=0.0.0.0\r\n      - --http.vhosts=*\r\n      - --http.corsdomain=*\r\n      - --ws\r\n      - --ws.origins=*\r\n      - --ws.addr=0.0.0.0\r\n      - --ws.api\r\n      - \"eth,net,web3\"\r\n      - --datadir\r\n      - \"/var/lib/goethereum\"\r\n    logging:\r\n      driver: \"json-file\"\r\n      options:\r\n        max-size: \"2m\"\r\n        max-file: \"10\"\r\n\r\n  nodeexporter:\r\n    image: prom/node-exporter:v1.0.1\r\n    hostname: nodeexporter\r\n    ports:\r\n      - 9100:9100/tcp\r\n    networks:\r\n      - monitor-net\r\n    container_name: nodeexporter\r\n    volumes:\r\n      - /proc:/host/proc:ro\r\n      - /sys:/host/sys:ro\r\n      - /:/rootfs:ro\r\n    command:\r\n      - '--path.procfs=/host/proc'\r\n      - '--path.rootfs=/rootfs'\r\n      - '--path.sysfs=/host/sys'\r\n      - '--collector.filesystem.ignored-mount-points=^/(sys|proc|dev|host|etc)($$|/)'\r\n    restart: unless-stopped\r\n    labels:\r\n      org.label-schema.group: \"monitoring\"\r\n    logging:\r\n      driver: \"json-file\"\r\n      options:\r\n        max-size: \"2m\"\r\n        max-file: \"10\"\r\n\r\n  cadvisor:\r\n    image: gcr.io/cadvisor/cadvisor:v0.38.7\r\n    hostname: nodeexporter\r\n    ports:\r\n      - 8080:8080/tcp\r\n    networks:\r\n      - monitor-net\r\n    container_name: cadvisor\r\n    volumes:\r\n      - /:/rootfs:ro\r\n      - /var/run:/var/run:rw\r\n      - /sys:/sys:ro\r\n      - /var/lib/docker/:/var/lib/docker:ro\r\n      - /cgroup:/cgroup:ro\r\n    restart: unless-stopped\r\n    labels:\r\n      org.label-schema.group: \"monitoring\"\r\n    logging:\r\n      driver: \"json-file\"\r\n      options:\r\n        max-size: \"2m\"\r\n        max-file: \"10\"\r\n```",
  "closed_by": {
    "login": "realbigsean",
    "id": 5160426,
    "node_id": "MDQ6VXNlcjUxNjA0MjY=",
    "avatar_url": "https://avatars.githubusercontent.com/u/5160426?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/realbigsean",
    "html_url": "https://github.com/realbigsean",
    "followers_url": "https://api.github.com/users/realbigsean/followers",
    "following_url": "https://api.github.com/users/realbigsean/following{/other_user}",
    "gists_url": "https://api.github.com/users/realbigsean/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/realbigsean/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/realbigsean/subscriptions",
    "organizations_url": "https://api.github.com/users/realbigsean/orgs",
    "repos_url": "https://api.github.com/users/realbigsean/repos",
    "events_url": "https://api.github.com/users/realbigsean/events{/privacy}",
    "received_events_url": "https://api.github.com/users/realbigsean/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/2208/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/2208/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/780739376",
    "html_url": "https://github.com/sigp/lighthouse/issues/2208#issuecomment-780739376",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2208",
    "id": 780739376,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDczOTM3Ng==",
    "user": {
      "login": "maurodelazeri",
      "id": 1005120,
      "node_id": "MDQ6VXNlcjEwMDUxMjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1005120?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maurodelazeri",
      "html_url": "https://github.com/maurodelazeri",
      "followers_url": "https://api.github.com/users/maurodelazeri/followers",
      "following_url": "https://api.github.com/users/maurodelazeri/following{/other_user}",
      "gists_url": "https://api.github.com/users/maurodelazeri/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maurodelazeri/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maurodelazeri/subscriptions",
      "organizations_url": "https://api.github.com/users/maurodelazeri/orgs",
      "repos_url": "https://api.github.com/users/maurodelazeri/repos",
      "events_url": "https://api.github.com/users/maurodelazeri/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maurodelazeri/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-17T17:59:01Z",
    "updated_at": "2021-02-17T17:59:01Z",
    "author_association": "NONE",
    "body": "the example above is the `testnet`, I normally leave it running for a while before put it in the mainnet",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/780739376/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/780776684",
    "html_url": "https://github.com/sigp/lighthouse/issues/2208#issuecomment-780776684",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2208",
    "id": 780776684,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDc3NjY4NA==",
    "user": {
      "login": "realbigsean",
      "id": 5160426,
      "node_id": "MDQ6VXNlcjUxNjA0MjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5160426?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/realbigsean",
      "html_url": "https://github.com/realbigsean",
      "followers_url": "https://api.github.com/users/realbigsean/followers",
      "following_url": "https://api.github.com/users/realbigsean/following{/other_user}",
      "gists_url": "https://api.github.com/users/realbigsean/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/realbigsean/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/realbigsean/subscriptions",
      "organizations_url": "https://api.github.com/users/realbigsean/orgs",
      "repos_url": "https://api.github.com/users/realbigsean/repos",
      "events_url": "https://api.github.com/users/realbigsean/events{/privacy}",
      "received_events_url": "https://api.github.com/users/realbigsean/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-17T18:58:24Z",
    "updated_at": "2021-02-17T18:59:24Z",
    "author_association": "COLLABORATOR",
    "body": "Hi @maurodelazeri , this is because the wildcard symbol`'*'` isn't available for the `--http-allow-origin` and `--metrics-allow-origin` flags at the moment. It isn't supported in one of our upstream dependencies, and we had added it into a forked version as a workaround, but during latest lighthouse update we've moved back to the original dependency. So you could either remove the flags entirely (I'm not sure about your set up but it's very possible this will have no impact to you) or you could be explicit about which \"origins\" you'd like to enable CORS for. We are working on either adding the feature to the upstream or updating our forked version\r\n\r\nRelevant issue: #2205",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/780776684/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/780776826",
    "html_url": "https://github.com/sigp/lighthouse/issues/2208#issuecomment-780776826",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2208",
    "id": 780776826,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDc3NjgyNg==",
    "user": {
      "login": "realbigsean",
      "id": 5160426,
      "node_id": "MDQ6VXNlcjUxNjA0MjY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5160426?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/realbigsean",
      "html_url": "https://github.com/realbigsean",
      "followers_url": "https://api.github.com/users/realbigsean/followers",
      "following_url": "https://api.github.com/users/realbigsean/following{/other_user}",
      "gists_url": "https://api.github.com/users/realbigsean/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/realbigsean/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/realbigsean/subscriptions",
      "organizations_url": "https://api.github.com/users/realbigsean/orgs",
      "repos_url": "https://api.github.com/users/realbigsean/repos",
      "events_url": "https://api.github.com/users/realbigsean/events{/privacy}",
      "received_events_url": "https://api.github.com/users/realbigsean/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-17T18:58:38Z",
    "updated_at": "2021-02-17T18:58:38Z",
    "author_association": "COLLABORATOR",
    "body": "Closing this because it's a duplicate of #2205 ",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/780776826/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/780870371",
    "html_url": "https://github.com/sigp/lighthouse/issues/2208#issuecomment-780870371",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2208",
    "id": 780870371,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDg3MDM3MQ==",
    "user": {
      "login": "maurodelazeri",
      "id": 1005120,
      "node_id": "MDQ6VXNlcjEwMDUxMjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1005120?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maurodelazeri",
      "html_url": "https://github.com/maurodelazeri",
      "followers_url": "https://api.github.com/users/maurodelazeri/followers",
      "following_url": "https://api.github.com/users/maurodelazeri/following{/other_user}",
      "gists_url": "https://api.github.com/users/maurodelazeri/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maurodelazeri/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maurodelazeri/subscriptions",
      "organizations_url": "https://api.github.com/users/maurodelazeri/orgs",
      "repos_url": "https://api.github.com/users/maurodelazeri/repos",
      "events_url": "https://api.github.com/users/maurodelazeri/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maurodelazeri/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-17T21:36:31Z",
    "updated_at": "2021-02-17T21:36:40Z",
    "author_association": "NONE",
    "body": "hey @realbigsean got it... I will keep running the 1.1.0 and follow the #2205\r\nThanks",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/780870371/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
