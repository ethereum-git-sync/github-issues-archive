{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/4450",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/4450/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/4450/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/4450/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/4450",
  "id": 1781498693,
  "node_id": "I_kwDOCFeAzc5qL4NF",
  "number": 4450,
  "title": "UPnP error after ENR is initialised although port 9000 is forwarded (manually) in the router management. ",
  "user": {
    "login": "Etherdrake",
    "id": 67021215,
    "node_id": "MDQ6VXNlcjY3MDIxMjE1",
    "avatar_url": "https://avatars.githubusercontent.com/u/67021215?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Etherdrake",
    "html_url": "https://github.com/Etherdrake",
    "followers_url": "https://api.github.com/users/Etherdrake/followers",
    "following_url": "https://api.github.com/users/Etherdrake/following{/other_user}",
    "gists_url": "https://api.github.com/users/Etherdrake/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Etherdrake/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Etherdrake/subscriptions",
    "organizations_url": "https://api.github.com/users/Etherdrake/orgs",
    "repos_url": "https://api.github.com/users/Etherdrake/repos",
    "events_url": "https://api.github.com/users/Etherdrake/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Etherdrake/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2023-06-29T20:51:01Z",
  "updated_at": "2023-06-29T21:34:28Z",
  "closed_at": "2023-06-29T21:34:28Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nLighthouse does not seem to work with my Reth installation. \r\n\r\n## Version\r\n\r\nv4.2.0-c547a11\r\n\r\n## Present Behaviour\r\n\r\nThere seems to be an error with UPnP on my route. These are the logs in which an ERROR appears after ENR is initialised: \r\n\r\n```\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.414 INFO Timer service started                   service: node_timer\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.414 INFO UPnP Attempting to initialise routes    service: UPnP\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.415 INFO ENR Initialised                         udp6: None, tcp6: None, tcp4: Some(9000), udp4: Some(9000), ip4: Some(77.25.145.224), id: 0x90a0..8cc1, seq: 2, enr: enr:-Ly4QCnHUIc8cZ3bGm7nSS_-SF-c9H2lkYDJJsPhUZ_Jo0dsUKyEWwR6rf7yEg7sI9i_xQ0h4AhEF2sZE20-3bhu1vYCh2F0dG5ldHOIAAAAAAAAAACEZXRoMpC7pNqWAwAAAP__________gmlkgnY0gmlwhE0ZkeCJc2VjcDI1NmsxoQPSHk4AiOQ-84tEY78VDZH2vSUot3Hxc8YNfjdnuZW1_IhzeW5jbmV0cwCDdGNwgiMog3VkcIIjKA, service: libp2p\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.415 INFO Libp2p Starting                         bandwidth_config: 3-Average, peer_id: 16Uiu2HAmSoCmYSiS6FCAcEJ1KtCy5mhh39iDRk5xYDcDHSAkSW2w, service: libp2p\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.415 INFO Listening established                   address: /ip4/0.0.0.0/tcp/9000/p2p/16Uiu2HAmSoCmYSiS6FCAcEJ1KtCy5mhh39iDRk5xYDcDHSAkSW2w, service: libp2p\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.422 INFO UPnP TCP route not set                  error: Request error. Invalid response from gateway: <s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\" s:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\">\r\n22:30:04 SERVER-01 lighthouse[38453]: <s:Body>\r\n22:30:04 SERVER-01 lighthouse[38453]: <s:Fault>\r\n22:30:04 SERVER-01 lighthouse[38453]: <faultcode>s:Client</faultcode>\r\n22:30:04 SERVER-01 lighthouse[38453]: <faultstring>UPnPError</faultstring>\r\n22:30:04 SERVER-01 lighthouse[38453]: <detail>\r\n22:30:04 SERVER-01 lighthouse[38453]: <UPnPError xmlns=\"urn:schemas-upnp-org:control-1-0\">\r\n22:30:04 SERVER-01 lighthouse[38453]: <errorCode>-111</errorCode>\r\n22:30:04 SERVER-01 lighthouse[38453]: <errorDescription>Invalid Action</errorDescription>\r\n22:30:04 SERVER-01 lighthouse[38453]: </UPnPError>\r\n22:30:04 SERVER-01 lighthouse[38453]: </detail>\r\n22:30:04 SERVER-01 lighthouse[38453]: </s:Fault>\r\n22:30:04 SERVER-01 lighthouse[38453]: </s:Body>\r\n22:30:04 SERVER-01 lighthouse[38453]: </s:Envelope>\r\n22:30:04 SERVER-01 lighthouse[38453]: , service: UPnP\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.423 INFO UPnP TCP route not set                  error: Request error. Invalid response from gateway: <s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\" s:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\">\r\n22:30:04 SERVER-01 lighthouse[38453]: <s:Body>\r\n22:30:04 SERVER-01 lighthouse[38453]: <s:Fault>\r\n22:30:04 SERVER-01 lighthouse[38453]: <faultcode>s:Client</faultcode>\r\n22:30:04 SERVER-01 lighthouse[38453]: <faultstring>UPnPError</faultstring>\r\n22:30:04 SERVER-01 lighthouse[38453]: <detail>\r\n22:30:04 SERVER-01 lighthouse[38453]: <UPnPError xmlns=\"urn:schemas-upnp-org:control-1-0\">\r\n22:30:04 SERVER-01 lighthouse[38453]: <errorCode>-111</errorCode>\r\n22:30:04 SERVER-01 lighthouse[38453]: <errorDescription>Invalid Action</errorDescription>\r\n22:30:04 SERVER-01 lighthouse[38453]: </UPnPError>\r\n22:30:04 SERVER-01 lighthouse[38453]: </detail>\r\n22:30:04 SERVER-01 lighthouse[38453]: </s:Fault>\r\n22:30:04 SERVER-01 lighthouse[38453]: </s:Body>\r\n22:30:04 SERVER-01 lighthouse[38453]: </s:Envelope>\r\n22:30:04 SERVER-01 lighthouse[38453]: , service: UPnP\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.431 INFO HTTP API started                        listen_address: 127.0.0.1:5052\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.432 ERRO Failed jwt authorization                error: InvalidToken, service: exec\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.432 WARN Execution engine call failed            error: Auth(InvalidToken), service: exec\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.432 ERRO Unable to get transition config         error: Api { error: Auth(InvalidToken) }, service: exec\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.432 WARN Execution engine call failed            error: Auth(InvalidToken), service: exec\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.432 ERRO Failed to check transition config       error: EngineError(Api { error: Auth(InvalidToken) }), service: exec\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.432 WARN Error whilst processing payload status  error: Api { error: Auth(InvalidToken) }, service: exec\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.432 WARN Failed to update head on execution engines, error: ExecutionForkChoiceUpdateFailed(EngineError(Api { error: Auth(InvalidToken) }))\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.432 ERRO Failed jwt authorization                error: InvalidToken, service: exec\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.432 ERRO Failed jwt authorization                error: InvalidToken, service: exec\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.432 ERRO Failed jwt authorization                error: InvalidToken, service: exec\r\n22:30:04 SERVER-01 lighthouse[38453]: Jun 29 20:30:04.600 INFO Execution payloads are pruned           service: freezer_db\r\n22:30:05 SERVER-01 lighthouse[38453]: Jun 29 20:30:05.419 INFO Sync state updated                      new_state: Syncing Finalized Chain, old_state: Stalled, service: sync\r\n22:30:08 SERVER-01 lighthouse[38453]: Jun 29 20:30:08.775 INFO Sync state updated                      new_state: Stalled, old_state: Syncing Finalized Chain, service: sync\r\n22:30:10 SERVER-01 lighthouse[38453]: Jun 29 20:30:10.590 INFO Sync state updated                      new_state: Syncing Finalized Chain, old_state: Stalled, service: sync\r\n22:30:16 SERVER-01 lighthouse[38453]: Jun 29 20:30:16.433 ERRO Failed jwt authorization                error: InvalidToken, service: exec\r\n22:30:17 SERVER-01 lighthouse[38453]: Jun 29 20:30:17.021 INFO Syncing                                 est_time: --, distance: 16373 slots (2 days 6 hrs), peers: 10, service: slot_notifier\r\n22:30:28 SERVER-01 lighthouse[38453]: Jun 29 20:30:28.435 ERRO Failed jwt authorization                error: InvalidToken, service: exec\r\n22:30:29 SERVER-01 lighthouse[38453]: Jun 29 20:30:29.002 INFO Syncing                                 est_time: --, distance: 16374 slots (2 days 6 hrs), peers: 22, service: slot_notifier\r\n22:30:40 SERVER-01 lighthouse[38453]: Jun 29 20:30:40.436 ERRO Failed jwt authorization                error: InvalidToken, service: exec\r\n22:30:41 SERVER-01 lighthouse[38453]: Jun 29 20:30:41.001 INFO Syncing                                 est_time: --, distance: 16375 slots (2 days 6 hrs), peers: 33, service: slot_notifier\r\n22:30:52 SERVER-01 lighthouse[38453]: Jun 29 20:30:52.437 ERRO Failed jwt authorization                error: InvalidToken, service: exec\r\n22:30:53 SERVER-01 lighthouse[38453]: Jun 29 20:30:53.001 INFO Syncing                                 est_time: --, distance: 16376 slots (2 days 6 hrs), peers: 42, service: slot_notifier\r\n22:31:04 SERVER-01 lighthouse[38453]: Jun 29 20:31:04.434 WARN Execution engine call failed            error: Auth(InvalidToken), service: exec\r\n22:31:04 SERVER-01 lighthouse[38453]: Jun 29 20:31:04.434 ERRO Unable to get transition config         error: Api { error: Auth(InvalidToken) }, service: exec\r\n22:31:04 SERVER-01 lighthouse[38453]: Jun 29 20:31:04.434 ERRO Failed to check transition config       error: EngineError(Api { error: Auth(InvalidToken) }), service: exec\r\n22:31:04 SERVER-01 lighthouse[38453]: Jun 29 20:31:04.435 ERRO Failed jwt authorization                error: InvalidToken, service: exec\r\n22:31:04 SERVER-01 lighthouse[38453]: Jun 29 20:31:04.437 ERRO Failed jwt authorization                error: InvalidToken, service: exec\r\n22:31:05 SERVER-01 lighthouse[38453]: Jun 29 20:31:05.001 INFO Syncing                                 est_time: --, distance: 16377 slots (2 days 6 hrs), peers: 54, service: slot_notifier\r\n22:31:16 SERVER-01 lighthouse[38453]: Jun 29 20:31:16.439 ERRO Failed jwt authorization                error: InvalidToken, service: exec\r\n22:31:17 SERVER-01 lighthouse[38453]: Jun 29 20:31:17.001 INFO Syncing                                 est_time: --, distance: 16378 slots (2 days 6 hrs), peers: 70, service: slot_notifier\r\n22:31:28 SERVER-01 lighthouse[38453]: Jun 29 20:31:28.440 ERRO Failed jwt authorization                error: InvalidToken, service: exec\r\n22:31:29 SERVER-01 lighthouse[38453]: Jun 29 20:31:29.001 INFO Syncing                                 est_time: --, distance: 16379 slots (2 days 6 hrs), peers: 74, service: slot_notifier\r\n22:31:40 SERVER-01 lighthouse[38453]: Jun 29 20:31:40.441 ERRO Failed jwt authorization                error: InvalidToken, service: exec\r\n22:31:41 SERVER-01 lighthouse[38453]: Jun 29 20:31:41.001 INFO Syncing                                 est_time: --, distance: 16380 slots (2 days 6 hrs), peers: 81, service: slot_notifier\r\n22:31:47 SERVER-01 systemd[1]: Stopping Lighthouse CL Client...\r\n```\r\n\r\n## Expected Behaviour\r\n\r\nIt should not fail as I have forwarded port 9000 in my router config panel. \r\n\r\n",
  "closed_by": {
    "login": "Etherdrake",
    "id": 67021215,
    "node_id": "MDQ6VXNlcjY3MDIxMjE1",
    "avatar_url": "https://avatars.githubusercontent.com/u/67021215?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Etherdrake",
    "html_url": "https://github.com/Etherdrake",
    "followers_url": "https://api.github.com/users/Etherdrake/followers",
    "following_url": "https://api.github.com/users/Etherdrake/following{/other_user}",
    "gists_url": "https://api.github.com/users/Etherdrake/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Etherdrake/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Etherdrake/subscriptions",
    "organizations_url": "https://api.github.com/users/Etherdrake/orgs",
    "repos_url": "https://api.github.com/users/Etherdrake/repos",
    "events_url": "https://api.github.com/users/Etherdrake/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Etherdrake/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/4450/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/4450/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1613807719",
    "html_url": "https://github.com/sigp/lighthouse/issues/4450#issuecomment-1613807719",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4450",
    "id": 1613807719,
    "node_id": "IC_kwDOCFeAzc5gMMBn",
    "user": {
      "login": "divagant-martian",
      "id": 26765164,
      "node_id": "MDQ6VXNlcjI2NzY1MTY0",
      "avatar_url": "https://avatars.githubusercontent.com/u/26765164?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/divagant-martian",
      "html_url": "https://github.com/divagant-martian",
      "followers_url": "https://api.github.com/users/divagant-martian/followers",
      "following_url": "https://api.github.com/users/divagant-martian/following{/other_user}",
      "gists_url": "https://api.github.com/users/divagant-martian/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/divagant-martian/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/divagant-martian/subscriptions",
      "organizations_url": "https://api.github.com/users/divagant-martian/orgs",
      "repos_url": "https://api.github.com/users/divagant-martian/repos",
      "events_url": "https://api.github.com/users/divagant-martian/events{/privacy}",
      "received_events_url": "https://api.github.com/users/divagant-martian/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-29T21:04:22Z",
    "updated_at": "2023-06-29T21:04:22Z",
    "author_association": "COLLABORATOR",
    "body": "you have two unrelated issues there. \r\n\r\nThe upnp failure (while peculiar) is not related to the jwt failure. If you forwarded the port manually in your router, the upnp error is not even stopping your node from talking with other peers (you are successfully connecting to 80+ peers at the end)\r\n\r\nThe real problem is that it seems to be something wrong with your configuration regarding reth",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1613807719/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1613836602",
    "html_url": "https://github.com/sigp/lighthouse/issues/4450#issuecomment-1613836602",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/4450",
    "id": 1613836602,
    "node_id": "IC_kwDOCFeAzc5gMTE6",
    "user": {
      "login": "Etherdrake",
      "id": 67021215,
      "node_id": "MDQ6VXNlcjY3MDIxMjE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/67021215?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Etherdrake",
      "html_url": "https://github.com/Etherdrake",
      "followers_url": "https://api.github.com/users/Etherdrake/followers",
      "following_url": "https://api.github.com/users/Etherdrake/following{/other_user}",
      "gists_url": "https://api.github.com/users/Etherdrake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Etherdrake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Etherdrake/subscriptions",
      "organizations_url": "https://api.github.com/users/Etherdrake/orgs",
      "repos_url": "https://api.github.com/users/Etherdrake/repos",
      "events_url": "https://api.github.com/users/Etherdrake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Etherdrake/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-29T21:34:28Z",
    "updated_at": "2023-06-29T21:34:28Z",
    "author_association": "NONE",
    "body": "The issue was indeed with my Reth unit file which did not correctly execute the jwt param due to a human error in my unit file. ",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1613836602/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
