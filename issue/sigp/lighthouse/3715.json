{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/3715",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/3715/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/3715/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/3715/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/3715",
  "id": 1445692430,
  "node_id": "I_kwDOCFeAzc5WK4QO",
  "number": 3715,
  "title": "Backfilling is not resumed after paused",
  "user": {
    "login": "wmitsuda",
    "id": 28685,
    "node_id": "MDQ6VXNlcjI4Njg1",
    "avatar_url": "https://avatars.githubusercontent.com/u/28685?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wmitsuda",
    "html_url": "https://github.com/wmitsuda",
    "followers_url": "https://api.github.com/users/wmitsuda/followers",
    "following_url": "https://api.github.com/users/wmitsuda/following{/other_user}",
    "gists_url": "https://api.github.com/users/wmitsuda/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wmitsuda/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wmitsuda/subscriptions",
    "organizations_url": "https://api.github.com/users/wmitsuda/orgs",
    "repos_url": "https://api.github.com/users/wmitsuda/repos",
    "events_url": "https://api.github.com/users/wmitsuda/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wmitsuda/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "open",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2022-11-11T16:08:40Z",
  "updated_at": "2023-02-02T12:30:28Z",
  "closed_at": null,
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I'm bootstraping a new LH mainnet instance, I'm noticing that during the backfilling process stops after some time running.\r\n\r\nI don't know why it stops (lack of peers, maybe?), but what's worse is that is does not resume until LH restarts. I left it running overnight and it resumed immediately after a restart.\r\n\r\nrecent log (I don't have last night logs, but it was already stuck at the same distance):\r\n\r\n```\r\nNov 11 16:02:05.001 INFO Downloading historical blocks           est_time: --, distance: 2868897 slots (56 weeks 6 days), service: slot_notifier\r\nNov 11 16:02:05.001 INFO Synced                                  slot: 5113208, block: 0x51bc…4375, epoch: 159787, fin\r\n```\r\n\r\nStrange that the distance is not updated over time, even thought the sync process continues on the chain tip, like the backfilling process is somehow stuck.\r\n\r\nafter restart:\r\n\r\n```\r\nNov 11 16:06:53.001 INFO Downloading historical blocks           est_time: 1 week 1 days, speed: 4.00 slots/sec, distance: 2868065 slots (56 weeks 6 days), service: slot_notifier\r\nNov 11 16:06:53.001 WARN Head is optimistic                      execution_block_hash: 0x542c53b6791439b21552877d4a7dd\r\n```\r\n\r\n```\r\nNov 11 16:07:53.000 INFO Downloading historical blocks           est_time: 14 hrs 55 mins, speed: 53.34 slots/sec, distance: 2865313 slots (56 weeks 5 days), service: slot_notifier\r\n```\r\n",
  "closed_by": null,
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/3715/reactions",
    "total_count": 3,
    "+1": 3,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/3715/timeline",
  "performed_via_github_app": null,
  "state_reason": null
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1311944708",
    "html_url": "https://github.com/sigp/lighthouse/issues/3715#issuecomment-1311944708",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3715",
    "id": 1311944708,
    "node_id": "IC_kwDOCFeAzc5OMrAE",
    "user": {
      "login": "wmitsuda",
      "id": 28685,
      "node_id": "MDQ6VXNlcjI4Njg1",
      "avatar_url": "https://avatars.githubusercontent.com/u/28685?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wmitsuda",
      "html_url": "https://github.com/wmitsuda",
      "followers_url": "https://api.github.com/users/wmitsuda/followers",
      "following_url": "https://api.github.com/users/wmitsuda/following{/other_user}",
      "gists_url": "https://api.github.com/users/wmitsuda/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wmitsuda/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wmitsuda/subscriptions",
      "organizations_url": "https://api.github.com/users/wmitsuda/orgs",
      "repos_url": "https://api.github.com/users/wmitsuda/repos",
      "events_url": "https://api.github.com/users/wmitsuda/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wmitsuda/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-11T16:55:55Z",
    "updated_at": "2022-11-11T16:55:55Z",
    "author_association": "NONE",
    "body": "Update: I was able to find the logs where it apparently stops the backfilling process.\r\n\r\nThe main issue here I think is identifying if there is some bug in the resume process, but I find it strange why is keeps stopping.\r\n\r\n```\r\nNov 11 16:10:09.131 INFO Backfill sync paused                    reason: insufficient_synced_peers, service: sync\r\nNov 11 16:10:09.131 INFO Sync state updated                      new_state: Synced, old_state: Syncing Historical Blocks, service: sync\r\nNov 11 16:10:11.950 INFO Backfill sync paused                    reason: insufficient_synced_peers, service: sync\r\nNov 11 16:10:17.002 WARN Low peer count                          peer_count: 1, service: slot_notifier\r\nNov 11 16:10:17.002 INFO Historical block download complete      service: slot_notifier\r\nNov 11 16:10:17.002 WARN Head is optimistic                      execution_block_hash: 0x48a49309bcc36aed156f0f57c2aba492c0a758b5705fdad4d8594c99fc85cfdc, info: chain not fully verified, block and attestation production disabled until execution engine syncs, service: slot_notifier\r\nNov 11 16:10:17.002 INFO Synced                                  slot: 5113249, block:    …  empty, epoch: 159789, finalized_epoch: 159787, finalized_root: 0xa33a…d380, exec_hash: 0x48a4…cfdc (unverified), peers: 1, service: slot_notifier\r\nNov 11 16:10:17.561 INFO Sync state updated                      new_state: Syncing Historical Blocks, old_state: Synced, service: sync\r\nNov 11 16:10:17.574 ERRO Backfill sync failed                    error: BatchDownloadFailed(Epoch(89393)), service: sync\r\nNov 11 16:10:17.574 INFO Sync state updated                      new_state: Synced, old_state: Syncing Historical Blocks, service: sync\r\nNov 11 16:10:17.648 INFO Sync state updated                      new_state: Syncing Historical Blocks, old_state: Synced, service: sync\r\nNov 11 16:10:17.649 ERRO Backfill sync failed                    error: BatchDownloadFailed(Epoch(89437)), service: sync\r\nNov 11 16:10:17.649 INFO Sync state updated                      new_state: Synced, old_state: Syncing Historical Blocks, service: sync\r\nNov 11 16:10:29.001 WARN Low peer count                          peer_count: 0, service: slot_notifier\r\nNov 11 16:10:29.001 WARN Head is optimistic                      execution_block_hash: 0x48a49309bcc36aed156f0f57c2aba492c0a758b5705fdad4d8594c99fc85cfdc, info: chain not fully verified, block and attestation production disabled until execution engine syncs, service: slot_notifier\r\nNov 11 16:10:29.001 INFO Synced                                  slot: 5113250, block:    …  empty, epoch: 159789, finalized_epoch: 159787, finalized_root: 0xa33a…d380, exec_hash: 0x48a4…cfdc (unverified), peers: 0, service: slot_notifier\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1311944708/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1341208467",
    "html_url": "https://github.com/sigp/lighthouse/issues/3715#issuecomment-1341208467",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3715",
    "id": 1341208467,
    "node_id": "IC_kwDOCFeAzc5P8TeT",
    "user": {
      "login": "stefanosstef",
      "id": 57360288,
      "node_id": "MDQ6VXNlcjU3MzYwMjg4",
      "avatar_url": "https://avatars.githubusercontent.com/u/57360288?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/stefanosstef",
      "html_url": "https://github.com/stefanosstef",
      "followers_url": "https://api.github.com/users/stefanosstef/followers",
      "following_url": "https://api.github.com/users/stefanosstef/following{/other_user}",
      "gists_url": "https://api.github.com/users/stefanosstef/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/stefanosstef/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/stefanosstef/subscriptions",
      "organizations_url": "https://api.github.com/users/stefanosstef/orgs",
      "repos_url": "https://api.github.com/users/stefanosstef/repos",
      "events_url": "https://api.github.com/users/stefanosstef/events{/privacy}",
      "received_events_url": "https://api.github.com/users/stefanosstef/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-07T16:11:39Z",
    "updated_at": "2022-12-07T16:11:39Z",
    "author_association": "NONE",
    "body": "I'm having the same issue",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1341208467/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1413664973",
    "html_url": "https://github.com/sigp/lighthouse/issues/3715#issuecomment-1413664973",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3715",
    "id": 1413664973,
    "node_id": "IC_kwDOCFeAzc5UQtDN",
    "user": {
      "login": "aivarasko",
      "id": 4294924,
      "node_id": "MDQ6VXNlcjQyOTQ5MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4294924?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aivarasko",
      "html_url": "https://github.com/aivarasko",
      "followers_url": "https://api.github.com/users/aivarasko/followers",
      "following_url": "https://api.github.com/users/aivarasko/following{/other_user}",
      "gists_url": "https://api.github.com/users/aivarasko/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aivarasko/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aivarasko/subscriptions",
      "organizations_url": "https://api.github.com/users/aivarasko/orgs",
      "repos_url": "https://api.github.com/users/aivarasko/repos",
      "events_url": "https://api.github.com/users/aivarasko/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aivarasko/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-02-02T12:30:27Z",
    "updated_at": "2023-02-02T12:30:27Z",
    "author_association": "NONE",
    "body": "Having the same issue with not progress `Downloading historical blocks`",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1413664973/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
