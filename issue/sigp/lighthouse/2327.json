{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/2327",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/2327/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/2327/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/2327/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/2327",
  "id": 870625984,
  "node_id": "MDU6SXNzdWU4NzA2MjU5ODQ=",
  "number": 2327,
  "title": "Optimize against ValidatorPubkeyCache timeouts",
  "user": {
    "login": "paulhauner",
    "id": 6660660,
    "node_id": "MDQ6VXNlcjY2NjA2NjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/paulhauner",
    "html_url": "https://github.com/paulhauner",
    "followers_url": "https://api.github.com/users/paulhauner/followers",
    "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
    "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
    "organizations_url": "https://api.github.com/users/paulhauner/orgs",
    "repos_url": "https://api.github.com/users/paulhauner/repos",
    "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/paulhauner/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 985647284,
      "node_id": "MDU6TGFiZWw5ODU2NDcyODQ=",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/enhancement",
      "name": "enhancement",
      "color": "a2eeef",
      "default": true,
      "description": "New feature or request"
    },
    {
      "id": 1999784343,
      "node_id": "MDU6TGFiZWwxOTk5Nzg0MzQz",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/optimization",
      "name": "optimization",
      "color": "f9de40",
      "default": false,
      "description": "Something to make Lighthouse run more efficiently."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": {
    "login": "michaelsproul",
    "id": 4452260,
    "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/michaelsproul",
    "html_url": "https://github.com/michaelsproul",
    "followers_url": "https://api.github.com/users/michaelsproul/followers",
    "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
    "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
    "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
    "repos_url": "https://api.github.com/users/michaelsproul/repos",
    "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
    "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
    "type": "User",
    "site_admin": false
  },
  "assignees": [
    {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    }
  ],
  "milestone": null,
  "comments": 9,
  "created_at": "2021-04-29T05:30:40Z",
  "updated_at": "2023-01-11T23:18:19Z",
  "closed_at": "2023-01-11T23:18:19Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nA user in Discord recently posted the following log:\r\n\r\n```\r\nApr 28 19:09:08.447 CRIT Beacon block processing error           error: ValidatorPubkeyCacheLockTimeout, service: beacon\r\nApr 28 19:09:08.447 WARN BlockProcessingFailure                  outcome: ValidatorPubkeyCacheLockTimeout, msg: unexpected condition in processing block.\r\n```\r\n\r\nThis user was not the first one, I've personally seen quite a few users report this same rror.\r\n\r\nThe `validator_pubkey_cache` is protected by a `TimeoutRwLock`. This means there can only be lock contention when something holds the *write lock*.\r\n\r\nI think (it's worth confirming) this is the only place we take a write-lock on the pubkey cache:\r\n\r\nhttps://github.com/sigp/lighthouse/blob/3a24ca5f14c6e6d6612fd43eca82aa0c1e6aba16/beacon_node/beacon_chain/src/beacon_chain.rs#L1633-L1641\r\n\r\nI think (also worth confirming) that bulk of the time holding the write-lock is spent inside this function:\r\n\r\nhttps://github.com/sigp/lighthouse/blob/3a24ca5f14c6e6d6612fd43eca82aa0c1e6aba16/beacon_node/beacon_chain/src/validator_pubkey_cache.rs#L124-L169\r\n\r\nSo, it stands to reason that if we can optimize out some time spent in `ValidatorPubkeyCache::import` then we can avoid `ValidatorPubkeyCacheLockTimeout` errors.\r\n\r\nI think the first step should be to add metrics to `ValidatorPubkeyCache::import` and determine what's taking the longest.\r\n\r\n## Potential Optimization\r\n\r\nI'm *guessing* that the write-to-disk part is taking the longest.\r\n\r\nIt's really important that we retain the current behaviour where the on-disk \"backing\" is updated somewhat-atomically with the internal `Vec`s and `HashMap`. \r\n\r\nOne potential option is to have a \"prepare\" step where we can copy the backing to a new random file and add the new keys to it. Then, we have a \"commit\" phase where we replace the old backing with the new (only a single file copy operation) and update the internal structures.\r\n\r\nThe \"prepare\" step only needs a read-lock, whist the \"commit\" still needs a write-lock (but is hopefully much faster).\r\n\r\nOnce we determine it is indeed writing to disk that's slow we can expand upon this.\r\n\r\n",
  "closed_by": {
    "login": "paulhauner",
    "id": 6660660,
    "node_id": "MDQ6VXNlcjY2NjA2NjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/paulhauner",
    "html_url": "https://github.com/paulhauner",
    "followers_url": "https://api.github.com/users/paulhauner/followers",
    "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
    "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
    "organizations_url": "https://api.github.com/users/paulhauner/orgs",
    "repos_url": "https://api.github.com/users/paulhauner/repos",
    "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/paulhauner/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/2327/reactions",
    "total_count": 3,
    "+1": 3,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/2327/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/828968201",
    "html_url": "https://github.com/sigp/lighthouse/issues/2327#issuecomment-828968201",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2327",
    "id": 828968201,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyODk2ODIwMQ==",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-29T06:16:54Z",
    "updated_at": "2021-04-29T06:16:54Z",
    "author_association": "MEMBER",
    "body": "The default backing is the DB now (since https://github.com/sigp/lighthouse/pull/2234), so we can't use an intermediate file per se, although I agree we can probably do a prepare/commit step with a read lock initially during the DB write, and then a write lock during the mutation.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/828968201/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/828977665",
    "html_url": "https://github.com/sigp/lighthouse/issues/2327#issuecomment-828977665",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2327",
    "id": 828977665,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyODk3NzY2NQ==",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-29T06:38:07Z",
    "updated_at": "2021-04-29T06:38:07Z",
    "author_association": "MEMBER",
    "body": "> The default backing is the DB now\r\n\r\nOh yeah, I forgot about this.\r\n\r\n>  I agree we can probably do a prepare/commit step with a read lock initially during the DB write, and then a write lock during the mutation.\r\n\r\nWe just need to maintain some sort of mechanism to ensure we mutate the DB and in-memory cache in lock-step. That might involve moving the locks inside `ValidatorPubkeyCache`.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/828977665/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/834095226",
    "html_url": "https://github.com/sigp/lighthouse/issues/2327#issuecomment-834095226",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2327",
    "id": 834095226,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzNDA5NTIyNg==",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-07T06:09:14Z",
    "updated_at": "2021-05-07T06:11:11Z",
    "author_association": "MEMBER",
    "body": "It took me ages to find, but an `upgrade`-able lock might be useful for this: https://docs.rs/lock_api/0.4.2/lock_api/struct.RwLockUpgradableReadGuard.html#method.upgrade\r\n\r\nhttps://docs.rs/lock_api/0.4.2/lock_api/struct.RwLock.html#method.upgradable_read",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/834095226/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1243026931",
    "html_url": "https://github.com/sigp/lighthouse/issues/2327#issuecomment-1243026931",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2327",
    "id": 1243026931,
    "node_id": "IC_kwDOCFeAzc5KFxXz",
    "user": {
      "login": "noslav",
      "id": 26611201,
      "node_id": "MDQ6VXNlcjI2NjExMjAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/26611201?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/noslav",
      "html_url": "https://github.com/noslav",
      "followers_url": "https://api.github.com/users/noslav/followers",
      "following_url": "https://api.github.com/users/noslav/following{/other_user}",
      "gists_url": "https://api.github.com/users/noslav/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/noslav/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/noslav/subscriptions",
      "organizations_url": "https://api.github.com/users/noslav/orgs",
      "repos_url": "https://api.github.com/users/noslav/repos",
      "events_url": "https://api.github.com/users/noslav/events{/privacy}",
      "received_events_url": "https://api.github.com/users/noslav/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-11T19:24:51Z",
    "updated_at": "2022-09-11T19:24:51Z",
    "author_association": "NONE",
    "body": "Hi lighthouse team, we're currently experiencing issues related to this please find the following log\r\n\r\n```log\r\nSep 09 21:41:21 cqt-operator-p1 systemd[1]: Started lighthouse eth2 service.\r\nSep 11 02:00:38 cqt-operator-p1 lighthouse[179796]: Sep 11 02:00:38.094 CRIT Beacon block processing error           error: ValidatorPubkeyCacheLockTimeout, service: beacon\r\nSep 11 02:25:18 cqt-operator-p1 lighthouse[179796]: Sep 11 02:25:18.922 CRIT Chain removed                           op: batch processing result, reason: WrongBatchState(\"Validation failed for batch in wrong state: AwaitingProcessing(16Uiu2HAm8HcQWjTmpEeqW96nDeYRs5c9bYV7SMPYSyeVGbEdPExU, 63 blocks)\"), id: 12382284213649068281, from: 60234, to: 145933, end_root: 0x8093…fac2, current_target: 60238, batches: 7, peers: 4, validated_batches: 0, state: Syncing, sync_type: Finalized, service: sync\r\nSep 11 09:22:16 cqt-operator-p1 lighthouse[179796]: Sep 11 09:22:16.746 CRIT Beacon block processing error           error: ValidatorPubkeyCacheLockTimeout, service: beacon\r\nSep 11 10:44:41 cqt-operator-p1 lighthouse[179796]: Sep 11 10:44:41.898 CRIT Beacon block processing error           error: ValidatorPubkeyCacheLockTimeout, service: beacon\r\nSep 11 16:18:41 cqt-operator-p1 lighthouse[179796]: Sep 11 16:18:41.779 CRIT Beacon block processing error           error: ValidatorPubkeyCacheLockTimeout, service: beacon\r\n```\r\n\r\nThe bn is running with the following config - \r\n```\r\nlighthouse \\\r\n--network mainnet \\\r\nbeacon_node \\\r\n--datadir /scratch/lighthouse \\\r\n--debug-level crit \\\r\n--http \\\r\n--checkpoint-sync-url https://beaconstate.ethstaker.cc \\\r\n--execution-endpoint http://localhost:8551 \\\r\n--execution-jwt /scratch/node/eth-mainnet/geth/jwtsecret\r\n\r\n```\r\n\r\nTo add we've no idea of the status of the beacon node sync from the above log but a quick size scan of the datadir gave me the following -\r\n\r\n```\r\nroot@cqt-operator-p1:/scratch/lighthouse/beacon# sudo du -sh *\r\n42G\tchain_db\r\n6.3G\tfreezer_db\r\n590M\tlogs\r\n16K\tnetwork\r\n```\r\n\r\nthe running CL version -\r\n\r\n```log\r\nlighthouse --version\r\nLighthouse v3.1.0-aa022f4\r\nBLS library: blst\r\nSHA256 hardware acceleration: true\r\nSpecs: mainnet (true), minimal (false), gnosis (false)\r\n```\r\n\r\nin conjunction with EL version -\r\n\r\n```log\r\nGeth\r\nVersion: 1.10.23-stable\r\nGit Commit: 5774d758f4f1e45c23ff6c81b957445b6bfcc5e8\r\nGit Commit Date: 20220910\r\nArchitecture: amd64\r\nGo Version: go1.18.1\r\nOperating System: linux\r\n```\r\n\r\nOS -\r\n```\r\nLinux cqt-operator-p1 #15-Ubuntu SMP Fri Jun 10 11:30:24 UTC 2022 x86_64 x86_64 x86_64 GNU/Linux\r\n```\r\n\r\nKindly advise on how to proceed!",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1243026931/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1243053776",
    "html_url": "https://github.com/sigp/lighthouse/issues/2327#issuecomment-1243053776",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2327",
    "id": 1243053776,
    "node_id": "IC_kwDOCFeAzc5KF37Q",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-11T22:15:35Z",
    "updated_at": "2022-09-11T22:15:35Z",
    "author_association": "MEMBER",
    "body": "@noslav Try turning on the `--disable-lock-timeouts` flag. It will silence the error and prevent spurious retries but _will not_ make the node process blocks any faster (the fundamental reason for the timeout). You might want to look into improving the CPU and or I/O performance of your hardware as well.\n\nThis issue is about improving our handling of the cache, which will not be available until a future release.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1243053776/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1243078160",
    "html_url": "https://github.com/sigp/lighthouse/issues/2327#issuecomment-1243078160",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2327",
    "id": 1243078160,
    "node_id": "IC_kwDOCFeAzc5KF94Q",
    "user": {
      "login": "noslav",
      "id": 26611201,
      "node_id": "MDQ6VXNlcjI2NjExMjAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/26611201?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/noslav",
      "html_url": "https://github.com/noslav",
      "followers_url": "https://api.github.com/users/noslav/followers",
      "following_url": "https://api.github.com/users/noslav/following{/other_user}",
      "gists_url": "https://api.github.com/users/noslav/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/noslav/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/noslav/subscriptions",
      "organizations_url": "https://api.github.com/users/noslav/orgs",
      "repos_url": "https://api.github.com/users/noslav/repos",
      "events_url": "https://api.github.com/users/noslav/events{/privacy}",
      "received_events_url": "https://api.github.com/users/noslav/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-12T00:17:48Z",
    "updated_at": "2022-09-12T00:17:48Z",
    "author_association": "NONE",
    "body": "> @noslav Try turning on the `--disable-lock-timeouts` flag. It will silence the error and prevent spurious retries but _will not_ make the node process blocks any faster (the fundamental reason for the timeout). You might want to look into improving the CPU and or I/O performance of your hardware as well.\r\n> \r\n> This issue is about improving our handling of the cache, which will not be available until a future release.\r\n\r\nthank you for the quick turnaround! ",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1243078160/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1244409143",
    "html_url": "https://github.com/sigp/lighthouse/issues/2327#issuecomment-1244409143",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2327",
    "id": 1244409143,
    "node_id": "IC_kwDOCFeAzc5KLC03",
    "user": {
      "login": "noslav",
      "id": 26611201,
      "node_id": "MDQ6VXNlcjI2NjExMjAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/26611201?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/noslav",
      "html_url": "https://github.com/noslav",
      "followers_url": "https://api.github.com/users/noslav/followers",
      "following_url": "https://api.github.com/users/noslav/following{/other_user}",
      "gists_url": "https://api.github.com/users/noslav/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/noslav/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/noslav/subscriptions",
      "organizations_url": "https://api.github.com/users/noslav/orgs",
      "repos_url": "https://api.github.com/users/noslav/repos",
      "events_url": "https://api.github.com/users/noslav/events{/privacy}",
      "received_events_url": "https://api.github.com/users/noslav/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-12T20:35:28Z",
    "updated_at": "2022-09-12T20:35:28Z",
    "author_association": "NONE",
    "body": "@michaelsproul your suggestion helped, thank you! However, I'm wondering why in my logs I don't get the mentioned line here in the [faq section](https://lighthouse-book.sigmaprime.io/merge-migration.html) on the merge migration page\r\n\r\n```\r\nINFO Ready for the merge, current_difficulty: 10789363, terminal_total_difficulty: 10790000\r\n```\r\nlogs currently only show the following \r\n\r\n```\r\nSep 12 00:19:41 cqt-operator-p1 systemd[1]: Stopped lighthouse eth2 service.\r\nSep 12 00:19:41 cqt-operator-p1 systemd[1]: lighthouse.service: Consumed 12h 27min 57.266s CPU time.\r\nSep 12 00:19:41 cqt-operator-p1 systemd[1]: Started lighthouse eth2 service.\r\n|\r\n```\r\n\r\nhas this anything to do with my EL configuration?",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1244409143/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1244505654",
    "html_url": "https://github.com/sigp/lighthouse/issues/2327#issuecomment-1244505654",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2327",
    "id": 1244505654,
    "node_id": "IC_kwDOCFeAzc5KLaY2",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-09-12T21:26:16Z",
    "updated_at": "2022-09-12T21:26:16Z",
    "author_association": "MEMBER",
    "body": "@noslav Remove the flag `--debug-level crit`, that flag is causing your node to _only_ log critical errors, which is quite a strange configuration and probably not what you want!",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1244505654/reactions",
      "total_count": 3,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1318083139",
    "html_url": "https://github.com/sigp/lighthouse/issues/2327#issuecomment-1318083139",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/2327",
    "id": 1318083139,
    "node_id": "IC_kwDOCFeAzc5OkFpD",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-11-17T05:06:01Z",
    "updated_at": "2022-11-17T05:06:01Z",
    "author_association": "MEMBER",
    "body": "I've overhauled the pubkey cache on the `tree-states` branch by making it into a generic cache for all validator information. I might try a new approach there using a CoW map for the data so that we can clone it when reading, and then mutate a copy while writing to disk, which then gets swapped into place.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1318083139/reactions",
      "total_count": 2,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
