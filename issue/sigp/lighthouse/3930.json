{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/3930",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/3930/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/3930/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/3930/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/3930",
  "id": 1561682515,
  "node_id": "I_kwDOCFeAzc5dFWJT",
  "number": 3930,
  "title": "Can't change EPOCHS_PER_ETH1_VOTING_PERIOD on local testnet",
  "user": {
    "login": "samlaf",
    "id": 9342524,
    "node_id": "MDQ6VXNlcjkzNDI1MjQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/9342524?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/samlaf",
    "html_url": "https://github.com/samlaf",
    "followers_url": "https://api.github.com/users/samlaf/followers",
    "following_url": "https://api.github.com/users/samlaf/following{/other_user}",
    "gists_url": "https://api.github.com/users/samlaf/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/samlaf/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/samlaf/subscriptions",
    "organizations_url": "https://api.github.com/users/samlaf/orgs",
    "repos_url": "https://api.github.com/users/samlaf/repos",
    "events_url": "https://api.github.com/users/samlaf/events{/privacy}",
    "received_events_url": "https://api.github.com/users/samlaf/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 985647282,
      "node_id": "MDU6TGFiZWw5ODU2NDcyODI=",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/duplicate",
      "name": "duplicate",
      "color": "cfd3d7",
      "default": true,
      "description": "This issue or pull request already exists"
    },
    {
      "id": 985647288,
      "node_id": "MDU6TGFiZWw5ODU2NDcyODg=",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/question",
      "name": "question",
      "color": "d876e3",
      "default": true,
      "description": "Further information is requested"
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2023-01-30T03:32:39Z",
  "updated_at": "2023-04-28T08:50:03Z",
  "closed_at": "2023-04-28T08:50:03Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nI'm working with the [local_testnet](https://github.com/sigp/lighthouse/tree/stable/scripts/local_testnet) scripts.\r\nI'm trying to test deposits and withdrawal_credentials repointing, so I need to change `EPOCHS_PER_ETH1_VOTING_PERIOD` because I simply can't wait the default 64 epochs before a deposit is even considered.\r\n\r\nHowever, nothing seems to work.\r\nthe [lcli new-testnet](https://github.com/sigp/lighthouse/blob/38514c07f222ff7783834c48cf5c0a6ee7f346d0/scripts/local_testnet/setup.sh#L26) command does not have a --epochs-per-eth1-voting-period (I tried grepping a bunch of related terms), and manually adding `EPOCHS_PER_ETH1_VOTING_PERIOD: \"1\"` to the generated config file `~/.lighthouse/local-testnet/testnet/config.yaml` doesn't work either.\r\n\r\nWhen I run `curl localhost:$VN_HTTP_API_PORT/lighthouse/spec -H \"Authorization: Bearer $(curl localhost:$VN_HTTP_API_PORT/lighthouse/auth | jq .token_path | xargs cat)\" | jq .data.EPOCHS_PER_ETH1_VOTING_PERIOD` I always get 64. Is it even possible to change this variable in lighthouse? How else should I go about integration testing deposits + withdrawals?\r\n\r\n## Version\r\n\r\n```\r\nLighthouse v3.4.0\r\nBLS library: blst\r\nSHA256 hardware acceleration: false\r\nSpecs: mainnet (true), minimal (false), gnosis (false)\r\n```\r\n\r\n",
  "closed_by": {
    "login": "michaelsproul",
    "id": 4452260,
    "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/michaelsproul",
    "html_url": "https://github.com/michaelsproul",
    "followers_url": "https://api.github.com/users/michaelsproul/followers",
    "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
    "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
    "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
    "repos_url": "https://api.github.com/users/michaelsproul/repos",
    "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
    "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/3930/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/3930/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1407963677",
    "html_url": "https://github.com/sigp/lighthouse/issues/3930#issuecomment-1407963677",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3930",
    "id": 1407963677,
    "node_id": "IC_kwDOCFeAzc5T69Id",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-30T04:06:51Z",
    "updated_at": "2023-01-30T04:06:51Z",
    "author_association": "MEMBER",
    "body": "The deposit voting period is a compile-time constant. In Ethereum spec terms it's part of the [preset](https://github.com/ethereum/consensus-specs/tree/dev/presets), which is represented in Lighthouse by the `EthSpec` trait and the types that implement it:\r\n\r\nhttps://github.com/sigp/lighthouse/blob/stable/consensus/types/src/eth_spec.rs\r\n\r\nWe support 3 presets: minimal, mainnet and Gnosis. You could use the minimal preset which sets `EPOCHS_PER_ETH1_VOTING_PERIOD` to `4`. On `lcli` you can do this by supplying `--spec minimal`. You'll need to make sure that you compile Lighthouse with minimal spec support, as we usually only use the minimal preset for tests and our released binaries have it disabled. The feature is called `spec-minimal` and can be enabled using the `FEATURES` env var when building, see: https://lighthouse-book.sigmaprime.io/installation-source.html#feature-flags\r\n\r\nYou might also be interested in #3033, which goes in to more detail about how we could improve this in future.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1407963677/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1408626285",
    "html_url": "https://github.com/sigp/lighthouse/issues/3930#issuecomment-1408626285",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3930",
    "id": 1408626285,
    "node_id": "IC_kwDOCFeAzc5T9e5t",
    "user": {
      "login": "samlaf",
      "id": 9342524,
      "node_id": "MDQ6VXNlcjkzNDI1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9342524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/samlaf",
      "html_url": "https://github.com/samlaf",
      "followers_url": "https://api.github.com/users/samlaf/followers",
      "following_url": "https://api.github.com/users/samlaf/following{/other_user}",
      "gists_url": "https://api.github.com/users/samlaf/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/samlaf/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/samlaf/subscriptions",
      "organizations_url": "https://api.github.com/users/samlaf/orgs",
      "repos_url": "https://api.github.com/users/samlaf/repos",
      "events_url": "https://api.github.com/users/samlaf/events{/privacy}",
      "received_events_url": "https://api.github.com/users/samlaf/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-30T13:23:56Z",
    "updated_at": "2023-01-30T13:23:56Z",
    "author_association": "NONE",
    "body": "Hah, thanks for explaining! I've flipped through the specs a hundred times already, but never realized the difference between presets and configs. Feels weird that presets being compile-time is mandated by the specs... is the code really that different between the three supported specs that most of the spec variables couldn't be passed at runtime without significantly affecting resource usage?\r\n\r\nSo it seems like right now the best way to test a full deposit->withdrawal loop is to use the minimal present and the configs in the local_testnet, which should give deposit times of 32 seconds (`EPOCHS_PER_ETH1_VOTING_PERIOD` * `SLOTS_PER_EPOCH` = 4 * 8). And if I need faster than that I would need to create a new custom spec and build from source.\r\n\r\nThanks, I'll give the minimal preset a spin.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1408626285/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1409161662",
    "html_url": "https://github.com/sigp/lighthouse/issues/3930#issuecomment-1409161662",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3930",
    "id": 1409161662,
    "node_id": "IC_kwDOCFeAzc5T_hm-",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-01-30T18:55:31Z",
    "updated_at": "2023-01-30T18:55:31Z",
    "author_association": "MEMBER",
    "body": "> Feels weird that presets being compile-time is mandated by the specs... is the code really that different between the three supported specs that most of the spec variables couldn't be passed at runtime without significantly affecting resource usage?\n\nIt's not that it's _mandated_ but allowed. Having compile-time values lends itself nicely to incorporating those values into types like `VariableList<T, N>` and `FixedVector<T, N>`, which saves passing `N` (the length/max length) around at runtime and enables simpler generic code. We _could_ change everything to be dynamic at runtime for minimal performance impact but it would be a huge refactor at this point as the compile-time constants are everywhere. Some other clients do the same as us (Nimbus) while others are dynamic (AFAIK Lodestar, maybe some others).",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1409161662/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1527210750",
    "html_url": "https://github.com/sigp/lighthouse/issues/3930#issuecomment-1527210750",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/3930",
    "id": 1527210750,
    "node_id": "IC_kwDOCFeAzc5bB2L-",
    "user": {
      "login": "michaelsproul",
      "id": 4452260,
      "node_id": "MDQ6VXNlcjQ0NTIyNjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4452260?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/michaelsproul",
      "html_url": "https://github.com/michaelsproul",
      "followers_url": "https://api.github.com/users/michaelsproul/followers",
      "following_url": "https://api.github.com/users/michaelsproul/following{/other_user}",
      "gists_url": "https://api.github.com/users/michaelsproul/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/michaelsproul/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/michaelsproul/subscriptions",
      "organizations_url": "https://api.github.com/users/michaelsproul/orgs",
      "repos_url": "https://api.github.com/users/michaelsproul/repos",
      "events_url": "https://api.github.com/users/michaelsproul/events{/privacy}",
      "received_events_url": "https://api.github.com/users/michaelsproul/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-04-28T08:50:03Z",
    "updated_at": "2023-04-28T08:50:03Z",
    "author_association": "MEMBER",
    "body": "Closing as dupe",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/1527210750/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
