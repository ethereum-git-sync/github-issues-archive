{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/218",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/218/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/218/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/218/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/218",
  "id": 410085512,
  "node_id": "MDU6SXNzdWU0MTAwODU1MTI=",
  "number": 218,
  "title": "Deposit contract log processing",
  "user": {
    "login": "paulhauner",
    "id": 6660660,
    "node_id": "MDQ6VXNlcjY2NjA2NjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/paulhauner",
    "html_url": "https://github.com/paulhauner",
    "followers_url": "https://api.github.com/users/paulhauner/followers",
    "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
    "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
    "organizations_url": "https://api.github.com/users/paulhauner/orgs",
    "repos_url": "https://api.github.com/users/paulhauner/repos",
    "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/paulhauner/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 1157252215,
      "node_id": "MDU6TGFiZWwxMTU3MjUyMjE1",
      "url": "https://api.github.com/repos/sigp/lighthouse/labels/major-task",
      "name": "major-task",
      "color": "c18d3f",
      "default": false,
      "description": "A significant amount of work or conceptual task."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2018-12-11T01:00:50Z",
  "updated_at": "2019-07-29T07:08:57Z",
  "closed_at": "2019-07-29T07:08:56Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "## Description\r\n\r\nThis is a \"mega issue\" which contains multiple discreet tasks. Mega issues exist to avoid cluttering the issues page a multitude of small tasks.\r\n\r\nIf you wish to work on one of these tasks, comment below and a maintainer will break the task out into a separate issue.\r\n\r\n## Log Processing\r\n\r\nValidators enter the 2.0 chain through \"deposit\" smart contract on the 1.0 chain. Therefore, it is necessary for Lighthouse to connect to an existing 1.0 client (e.g., geth, parity) and process logs from the 1.0 chain.\r\n\r\nThere are two obvious methods for obtaining the logs:\r\n\r\n1. Poll the 1.0 client and store the logs in disk/memory.\r\n2. Request the logs whenever they are required.\r\n\r\nOption (2) seems to be the most attractive at this point. it involves less moving parts (no polling logic, data storage, etc.) However we might run into issues if there's significant lag in hitting the client, but I can't see this being the case\r\n\r\nAssuming log-obtaining-method (2), we need the following:\r\n\r\n- An ability to determine the range of blocks from which we should withdraw logs. (I.e., \"get logs from block `x` to `y`\").\r\n- A method to parse a `Deposit` log into a `ValidatorRegistration`.\r\n- The ability to process a `ChainStart` log.\r\n\r\nFurthermore, we will need an integration testing environment to check integration between Lighthouse and the 1.0 client (e.g., Geth, Parity-Ethereum, etc.)\r\n\r\n## Immediate Tasks\r\n\r\n- Consider the two log-obtaining methods and come to an agreement upon this.\r\n",
  "closed_by": {
    "login": "paulhauner",
    "id": 6660660,
    "node_id": "MDQ6VXNlcjY2NjA2NjA=",
    "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/paulhauner",
    "html_url": "https://github.com/paulhauner",
    "followers_url": "https://api.github.com/users/paulhauner/followers",
    "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
    "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
    "organizations_url": "https://api.github.com/users/paulhauner/orgs",
    "repos_url": "https://api.github.com/users/paulhauner/repos",
    "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
    "received_events_url": "https://api.github.com/users/paulhauner/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/218/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/218/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/452080594",
    "html_url": "https://github.com/sigp/lighthouse/issues/218#issuecomment-452080594",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/218",
    "id": 452080594,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MjA4MDU5NA==",
    "user": {
      "login": "ralexstokes",
      "id": 3113781,
      "node_id": "MDQ6VXNlcjMxMTM3ODE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3113781?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ralexstokes",
      "html_url": "https://github.com/ralexstokes",
      "followers_url": "https://api.github.com/users/ralexstokes/followers",
      "following_url": "https://api.github.com/users/ralexstokes/following{/other_user}",
      "gists_url": "https://api.github.com/users/ralexstokes/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ralexstokes/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ralexstokes/subscriptions",
      "organizations_url": "https://api.github.com/users/ralexstokes/orgs",
      "repos_url": "https://api.github.com/users/ralexstokes/repos",
      "events_url": "https://api.github.com/users/ralexstokes/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ralexstokes/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-07T21:02:26Z",
    "updated_at": "2019-01-07T21:02:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "i'm w/ you in leanings towards not storing a bunch of logs and handling all the serde and related disk IO... my concern w/ \"request on-demand\" just comes down to the event where there are many Deposit messages in a given epoch and then Lighthouse slows down waiting on an Eth1.0 endpoint. we would need to benchmark this to know if its worth the work.\r\n\r\nanother option which afaik is possible w/ any of the Eth1.0 clients which is to set up a notification interface for the relevant `Deposit` events. with this option we just keep an in-memory cache of the most recent `Deposit` events (up to some number or size in memory) and can make one heavy call (enough to fill the cache) upon boot, then w/ some cache policy fill events as they come in via subscription.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/452080594/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/453287302",
    "html_url": "https://github.com/sigp/lighthouse/issues/218#issuecomment-453287302",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/218",
    "id": 453287302,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MzI4NzMwMg==",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-10T22:52:19Z",
    "updated_at": "2019-01-10T22:52:29Z",
    "author_association": "MEMBER",
    "body": "I agree, caching will likely be ideal.\r\n\r\nWe could take an approach where we implement without caching at first, but we design the interface such that caching can be implemented later with minimal changes required to calling functions.",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/453287302/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/515872745",
    "html_url": "https://github.com/sigp/lighthouse/issues/218#issuecomment-515872745",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/218",
    "id": 515872745,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUxNTg3Mjc0NQ==",
    "user": {
      "login": "paulhauner",
      "id": 6660660,
      "node_id": "MDQ6VXNlcjY2NjA2NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6660660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paulhauner",
      "html_url": "https://github.com/paulhauner",
      "followers_url": "https://api.github.com/users/paulhauner/followers",
      "following_url": "https://api.github.com/users/paulhauner/following{/other_user}",
      "gists_url": "https://api.github.com/users/paulhauner/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paulhauner/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paulhauner/subscriptions",
      "organizations_url": "https://api.github.com/users/paulhauner/orgs",
      "repos_url": "https://api.github.com/users/paulhauner/repos",
      "events_url": "https://api.github.com/users/paulhauner/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paulhauner/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-07-29T07:08:56Z",
    "updated_at": "2019-07-29T07:08:56Z",
    "author_association": "MEMBER",
    "body": "Superseded by #463",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/515872745/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
