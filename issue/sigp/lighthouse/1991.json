{
  "url": "https://api.github.com/repos/sigp/lighthouse/issues/1991",
  "repository_url": "https://api.github.com/repos/sigp/lighthouse",
  "labels_url": "https://api.github.com/repos/sigp/lighthouse/issues/1991/labels{/name}",
  "comments_url": "https://api.github.com/repos/sigp/lighthouse/issues/1991/comments",
  "events_url": "https://api.github.com/repos/sigp/lighthouse/issues/1991/events",
  "html_url": "https://github.com/sigp/lighthouse/issues/1991",
  "id": 752306455,
  "node_id": "MDU6SXNzdWU3NTIzMDY0NTU=",
  "number": 1991,
  "title": "error when launched from script",
  "user": {
    "login": "jupiter126",
    "id": 487608,
    "node_id": "MDQ6VXNlcjQ4NzYwOA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/487608?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jupiter126",
    "html_url": "https://github.com/jupiter126",
    "followers_url": "https://api.github.com/users/jupiter126/followers",
    "following_url": "https://api.github.com/users/jupiter126/following{/other_user}",
    "gists_url": "https://api.github.com/users/jupiter126/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jupiter126/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jupiter126/subscriptions",
    "organizations_url": "https://api.github.com/users/jupiter126/orgs",
    "repos_url": "https://api.github.com/users/jupiter126/repos",
    "events_url": "https://api.github.com/users/jupiter126/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jupiter126/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 1,
  "created_at": "2020-11-27T14:52:39Z",
  "updated_at": "2020-11-29T08:30:42Z",
  "closed_at": "2020-11-29T08:30:41Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## Description\r\nI did a quick update script so lighthouse remains up to date, lighthouse --version works but gives an error:\r\n\r\nthread 'main' panicked at 'Error writing Error to stdout: Os { code: 32, kind: BrokenPipe, message: \"Broken pipe\" }', /cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.33.3/src/errors.rs:401:55\r\nnote: run with `RUST_BACKTRACE=1` environment variable to display a backtrace\r\n\r\n## Version\r\n\r\n1.0.0 and 1.0.1\r\n\r\n## Present Behaviour\r\noutput of script with export RUST_BACKTRACE=full\r\n\r\nroot@eth:~# ./upgrade_lighthouse.sh    \r\n0\r\n1\r\n2\r\nup to date (v1.0.1 = v1.0.1 )\r\nroot@eth:~# ./upgrade_lighthouse.sh \r\n0\r\n1\r\n2\r\nup to date (v1.0.1 = v1.0.1 )\r\nroot@eth:~# ./upgrade_lighthouse.sh \r\n0\r\nthread 'main' panicked at 'Error writing Error to stdout: Os { code: 32, kind: BrokenPipe, message: \"Broken pipe\" }', /cargo/registry/src/github.com-1ecc6299db9ec823/clap-2.33.3/src/errors.rs:401:55\r\nstack backtrace:\r\n   0:     0x55e2f47fb840 - std::backtrace_rs::backtrace::libunwind::trace::h72c2fb8038f1bbee\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/std/src/../../backtrace/src/backtrace/libunwind.rs:96\r\n   1:     0x55e2f47fb840 - std::backtrace_rs::backtrace::trace_unsynchronized::h1e3b084883f1e78c\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/std/src/../../backtrace/src/backtrace/mod.rs:66\r\n   2:     0x55e2f47fb840 - std::sys_common::backtrace::_print_fmt::h3bf6a7ebf7f0394a\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/std/src/sys_common/backtrace.rs:79\r\n   3:     0x55e2f47fb840 - <std::sys_common::backtrace::_print::DisplayBacktrace as core::fmt::Display>::fmt::h2e8cb764b7fe02e7\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/std/src/sys_common/backtrace.rs:58\r\n   4:     0x55e2f48203cc - core::fmt::write::h7a1184eaee6a8644\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/core/src/fmt/mod.rs:1080\r\n   5:     0x55e2f47f2572 - std::io::Write::write_fmt::haeeb374d93a67eac\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/std/src/io/mod.rs:1516\r\n   6:     0x55e2f47fe00d - std::sys_common::backtrace::_print::h1d14a7f6ad632dc8\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/std/src/sys_common/backtrace.rs:61\r\n   7:     0x55e2f47fe00d - std::sys_common::backtrace::print::h301abac8bb2e3e81\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/std/src/sys_common/backtrace.rs:48\r\n   8:     0x55e2f47fe00d - std::panicking::default_hook::{{closure}}::hde0cb80358a6920a\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/std/src/panicking.rs:208\r\n   9:     0x55e2f47fdcb8 - std::panicking::default_hook::h9b1a691049a0ec8f\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/std/src/panicking.rs:227\r\n  10:     0x55e2f47fe6f1 - std::panicking::rust_panic_with_hook::h2bdec87b60580584\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/std/src/panicking.rs:577\r\n  11:     0x55e2f47fe299 - std::panicking::begin_panic_handler::{{closure}}::h101ca09d9df5db47\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/std/src/panicking.rs:484\r\n  12:     0x55e2f47fbcac - std::sys_common::backtrace::__rust_end_short_backtrace::h3bb85654c20113ca\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/std/src/sys_common/backtrace.rs:153\r\n  13:     0x55e2f47fe259 - rust_begin_unwind\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/std/src/panicking.rs:483\r\n  14:     0x55e2f481dfc1 - core::panicking::panic_fmt::h48c31e1e3d550146\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/core/src/panicking.rs:85\r\n  15:     0x55e2f481dde3 - core::option::expect_none_failed::h6154dc750ae47ade\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/core/src/option.rs:1234\r\n  16:     0x55e2f47c526a - core::result::Result<T,E>::expect::hb8e9f4ca0dfd10c6\r\n  17:     0x55e2f47c790e - clap::errors::Error::exit::h461c17a27a008ee8\r\n  18:     0x55e2f47acf1e - clap::app::App::get_matches_from::{{closure}}::ha5b8e0cd19ea5977\r\n  19:     0x55e2f47acca9 - clap::app::App::get_matches::h9785f996fe45732b\r\n  20:     0x55e2f31491bf - lighthouse::main::hfc2165d50efa0d27\r\n  21:     0x55e2f2bed5a3 - std::sys_common::backtrace::__rust_begin_short_backtrace::ha251ca927d50258a\r\n  22:     0x55e2f2bef719 - std::rt::lang_start::{{closure}}::h2c4cc5af0df1d705\r\n  23:     0x55e2f47fec07 - core::ops::function::impls::<impl core::ops::function::FnOnce<A> for &F>::call_once::he179d32a5d10d957\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/core/src/ops/function.rs:259\r\n  24:     0x55e2f47fec07 - std::panicking::try::do_call::hcb3d5e7be089b2b4\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/std/src/panicking.rs:381\r\n  25:     0x55e2f47fec07 - std::panicking::try::h7ac93b0cd56fb701\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/std/src/panicking.rs:345\r\n  26:     0x55e2f47fec07 - std::panic::catch_unwind::h7b40e396c93a4fcd\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/std/src/panic.rs:382\r\n  27:     0x55e2f47fec07 - std::rt::lang_start_internal::h142b9cc66267fea1\r\n                               at /rustc/7eac88abb2e57e752f3302f02be5f3ce3d7adfb4/library/std/src/rt.rs:51\r\n  28:     0x55e2f314f502 - main\r\n  29:     0x7f39d74cc0b3 - __libc_start_main\r\n  30:     0x55e2f2a33b69 - _start\r\n  31:                0x0 - <unknown>\r\n1\r\n2\r\nup to date (v1.0.1 = v1.0.1 )\r\n\r\n## Expected Behaviour\r\n\r\nmain should not panic\r\n\r\n## Steps to resolve\r\n\r\nThe script works (returns version), but I don't know why the panic.  don't know how to solve or even if it is important, but I prefer reporting issue just in case!\r\nnote: system is ubuntu 20.04 on a VPS\r\ncalling code with culprit line in bold\r\ncat upgrade_lighthouse.sh\r\n\r\nexport RUST_BACKTRACE=full\r\necho 0\r\n**currentver=\"$(/usr/local/bin/lighthouse --version|head -n1|cut -f 2 -d' '|cut -f1 -d'-')\"**\r\necho 1\r\nlatestver=$(curl -s https://github.com/sigp/lighthouse/releases/latest|cut -f2 -d'\"'|rev|cut -f1 -d'/'|rev)\r\necho 2\r\n\r\nif [[ \"$currentver\" != \"$latestver\" ]]; then\r\n        echo \"requires update ($currentver != $latestver )\"\r\n        wget -q \"https://github.com/sigp/lighthouse/releases/download/$latestver/lighthouse-$latestver-x86_64-unknown-linux-gnu.tar.gz\"\r\n        tar -xzf \"lighthouse-$latestver-x86_64-unknown-linux-gnu.tar.gz\"\r\n        systemctl stop lighthousebeacon lighthousevalidator && sleep 2 && chown root:root lighthouse && chmod 755 lighthouse && mv lighthouse /usr/local/bin/\r\n        rm \"lighthouse-$latestver-x86_64-unknown-linux-gnu.tar.gz\"\r\n        systemctl start lighthousebeacon lighthousevalidator\r\nelse\r\n        echo \"up to date ($currentver = $latestver )\"\r\nfi\r\n",
  "closed_by": {
    "login": "jupiter126",
    "id": 487608,
    "node_id": "MDQ6VXNlcjQ4NzYwOA==",
    "avatar_url": "https://avatars.githubusercontent.com/u/487608?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jupiter126",
    "html_url": "https://github.com/jupiter126",
    "followers_url": "https://api.github.com/users/jupiter126/followers",
    "following_url": "https://api.github.com/users/jupiter126/following{/other_user}",
    "gists_url": "https://api.github.com/users/jupiter126/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jupiter126/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jupiter126/subscriptions",
    "organizations_url": "https://api.github.com/users/jupiter126/orgs",
    "repos_url": "https://api.github.com/users/jupiter126/repos",
    "events_url": "https://api.github.com/users/jupiter126/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jupiter126/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/1991/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/sigp/lighthouse/issues/1991/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/735360819",
    "html_url": "https://github.com/sigp/lighthouse/issues/1991#issuecomment-735360819",
    "issue_url": "https://api.github.com/repos/sigp/lighthouse/issues/1991",
    "id": 735360819,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNTM2MDgxOQ==",
    "user": {
      "login": "jupiter126",
      "id": 487608,
      "node_id": "MDQ6VXNlcjQ4NzYwOA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/487608?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jupiter126",
      "html_url": "https://github.com/jupiter126",
      "followers_url": "https://api.github.com/users/jupiter126/followers",
      "following_url": "https://api.github.com/users/jupiter126/following{/other_user}",
      "gists_url": "https://api.github.com/users/jupiter126/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jupiter126/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jupiter126/subscriptions",
      "organizations_url": "https://api.github.com/users/jupiter126/orgs",
      "repos_url": "https://api.github.com/users/jupiter126/repos",
      "events_url": "https://api.github.com/users/jupiter126/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jupiter126/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-29T08:30:41Z",
    "updated_at": "2020-11-29T08:30:41Z",
    "author_association": "NONE",
    "body": "seems mostly fixed in 1.0.2.  \r\nMy script issues a warning 1 on 20 runs now instead of 1 panic 9 out of 10 runs. was probably a race condition somewhere",
    "reactions": {
      "url": "https://api.github.com/repos/sigp/lighthouse/issues/comments/735360819/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
