{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2637",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2637/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2637/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2637/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2637",
  "id": 862816071,
  "node_id": "MDU6SXNzdWU4NjI4MTYwNzE=",
  "number": 2637,
  "title": "Issue with a crowdsale contract",
  "user": {
    "login": "ValoisProtocol",
    "id": 80161018,
    "node_id": "MDQ6VXNlcjgwMTYxMDE4",
    "avatar_url": "https://avatars.githubusercontent.com/u/80161018?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ValoisProtocol",
    "html_url": "https://github.com/ValoisProtocol",
    "followers_url": "https://api.github.com/users/ValoisProtocol/followers",
    "following_url": "https://api.github.com/users/ValoisProtocol/following{/other_user}",
    "gists_url": "https://api.github.com/users/ValoisProtocol/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ValoisProtocol/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ValoisProtocol/subscriptions",
    "organizations_url": "https://api.github.com/users/ValoisProtocol/orgs",
    "repos_url": "https://api.github.com/users/ValoisProtocol/repos",
    "events_url": "https://api.github.com/users/ValoisProtocol/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ValoisProtocol/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 5,
  "created_at": "2021-04-20T13:25:09Z",
  "updated_at": "2021-04-21T08:57:01Z",
  "closed_at": "2021-04-20T15:24:00Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi, I an experiencing an issue with a crowdsale contract. The crowdsale has been deployed and the withdraw function when called returns the following error Fail with error 'safeERC20': low-level call failed.I am aware this error returns when the Contract address has no tokens but in this situation the Contract has tokens in it. Below is the Contract code and the crowdsale contract itself that produces this error. The participants have deposited bnb however no tokens was returned to them instead when they recieve that error above. \r\n\r\n<https://bscscan.com/address/0xa228fb40bc32b555ef6af1b5ab62f89b48381864#writeContract\r\n\r\n**ðŸ’» Environment**\r\n\r\nRemix compiler 0.8.3 \r\n\r\n\r\nIs there an issue in the Contract or deployment? If so how to rectify it. Cheers ",
  "closed_by": {
    "login": "frangio",
    "id": 481465,
    "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/frangio",
    "html_url": "https://github.com/frangio",
    "followers_url": "https://api.github.com/users/frangio/followers",
    "following_url": "https://api.github.com/users/frangio/following{/other_user}",
    "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
    "organizations_url": "https://api.github.com/users/frangio/orgs",
    "repos_url": "https://api.github.com/users/frangio/repos",
    "events_url": "https://api.github.com/users/frangio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/frangio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2637/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2637/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/823363340",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2637#issuecomment-823363340",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2637",
    "id": 823363340,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMzM2MzM0MA==",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-20T15:22:59Z",
    "updated_at": "2021-04-20T15:22:59Z",
    "author_association": "MEMBER",
    "body": "There may be something wrong with your contract code. I don't have enough data to debug what is happening. It does sound like there may not be enough balance of the token. You will need to try to debug the function call to exactly what is failing.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/823363340/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/823364835",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2637#issuecomment-823364835",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2637",
    "id": 823364835,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMzM2NDgzNQ==",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-20T15:24:39Z",
    "updated_at": "2021-04-20T15:24:39Z",
    "author_association": "MEMBER",
    "body": "We don't have enough bandwidth right now to guide you through debugging the code. Let us know if you get more information and we can try to help based on that.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/823364835/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/823643236",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2637#issuecomment-823643236",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2637",
    "id": 823643236,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMzY0MzIzNg==",
    "user": {
      "login": "ValoisProtocol",
      "id": 80161018,
      "node_id": "MDQ6VXNlcjgwMTYxMDE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/80161018?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ValoisProtocol",
      "html_url": "https://github.com/ValoisProtocol",
      "followers_url": "https://api.github.com/users/ValoisProtocol/followers",
      "following_url": "https://api.github.com/users/ValoisProtocol/following{/other_user}",
      "gists_url": "https://api.github.com/users/ValoisProtocol/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ValoisProtocol/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ValoisProtocol/subscriptions",
      "organizations_url": "https://api.github.com/users/ValoisProtocol/orgs",
      "repos_url": "https://api.github.com/users/ValoisProtocol/repos",
      "events_url": "https://api.github.com/users/ValoisProtocol/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ValoisProtocol/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-20T22:38:32Z",
    "updated_at": "2021-04-20T22:38:32Z",
    "author_association": "NONE",
    "body": "Hi Frangio. We still couldn't identify the issue \n. All the steps seem to be have done correctly. Can you please check \n\nIf you see the link above, the tokens native to the project are in there. The only issue is that when people come to withdraw, they get that error. ",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/823643236/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/823861773",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2637#issuecomment-823861773",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2637",
    "id": 823861773,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMzg2MTc3Mw==",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-21T07:59:00Z",
    "updated_at": "2021-04-21T07:59:00Z",
    "author_association": "COLLABORATOR",
    "body": "@ValoisProtocol \r\nHere is my understanding of your issue:\r\n\r\n- The balance of the sale contract `0xa228fB40bc32B555eF6AF1b5aB62f89b48381864` on the token `0xeb27c43BE8b0a1DD0377F2c66b4f6353290c0F27` is currently `150000000000000`\r\n- In this transaction, a user https://bscscan.com/tx/0x2369b7c68f046ce2eb7b2273c6e533741a0340ce27ee20c80e6526aa17a9ca9c a user bought an amount of `7560000000000000000000`.\r\n\r\nEven if you just plan to deliver 10%, 7560000000000000000000*10% is way more then the sales contract balance. An address cannot transfer more then the balance, so the transfer reverts.\r\n\r\nThere is nothing wrong with the contract (that I can spot) The problem is either that you allowed sale to sell too many tokens, or that you did not give enough tokens to sale in the first place.\r\n\r\nFYI, total token sold are `1321041998134693812600000` so one would expect the balance to the sale contract to at least match that",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/823861773/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/823899833",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2637#issuecomment-823899833",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2637",
    "id": 823899833,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMzg5OTgzMw==",
    "user": {
      "login": "ValoisProtocol",
      "id": 80161018,
      "node_id": "MDQ6VXNlcjgwMTYxMDE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/80161018?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ValoisProtocol",
      "html_url": "https://github.com/ValoisProtocol",
      "followers_url": "https://api.github.com/users/ValoisProtocol/followers",
      "following_url": "https://api.github.com/users/ValoisProtocol/following{/other_user}",
      "gists_url": "https://api.github.com/users/ValoisProtocol/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ValoisProtocol/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ValoisProtocol/subscriptions",
      "organizations_url": "https://api.github.com/users/ValoisProtocol/orgs",
      "repos_url": "https://api.github.com/users/ValoisProtocol/repos",
      "events_url": "https://api.github.com/users/ValoisProtocol/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ValoisProtocol/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-21T08:57:01Z",
    "updated_at": "2021-04-21T08:57:01Z",
    "author_association": "NONE",
    "body": "Thank you, this issue was in the decimals for rate. Uint was 18 decimals. And so this was causing the error. Thank you ",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/823899833/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
