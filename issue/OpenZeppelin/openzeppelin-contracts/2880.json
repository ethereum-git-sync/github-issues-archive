{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2880",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2880/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2880/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2880/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2880",
  "id": 1005105787,
  "node_id": "I_kwDOA9tCBs476LJ7",
  "number": 2880,
  "title": "Error: \"This method only supports Buffer but input was...\" on ARM based Mac M1",
  "user": {
    "login": "itinance",
    "id": 1758597,
    "node_id": "MDQ6VXNlcjE3NTg1OTc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1758597?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/itinance",
    "html_url": "https://github.com/itinance",
    "followers_url": "https://api.github.com/users/itinance/followers",
    "following_url": "https://api.github.com/users/itinance/following{/other_user}",
    "gists_url": "https://api.github.com/users/itinance/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/itinance/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/itinance/subscriptions",
    "organizations_url": "https://api.github.com/users/itinance/orgs",
    "repos_url": "https://api.github.com/users/itinance/repos",
    "events_url": "https://api.github.com/users/itinance/events{/privacy}",
    "received_events_url": "https://api.github.com/users/itinance/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2021-09-23T07:34:12Z",
  "updated_at": "2021-10-06T19:43:36Z",
  "closed_at": "2021-10-06T19:43:36Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "<!-- Briefly describe the issue you're experiencing. Tell us what you were trying to do and what happened instead. -->\r\n\r\nRunning the test suite will cause an important warning and an error on Mac M1, which both won't happen on Intel-based Mac:\r\n\r\n1. The Warning of exceedes code size:\r\n\r\n```\r\nWarning: Contract code size exceeds 24576 bytes (a limit introduced in Spurious Dragon). This contract may not be deployable on mainnet. Consider enabling the optimizer (with a low \"runs\" value!), turning off revert strings, or using libraries.\r\n --> contracts/mocks/GovernorCompatibilityBravoMock.sol:9:1:\r\n  |\r\n9 | contract GovernorCompatibilityBravoMock is GovernorCompatibilityBravo, GovernorTimelockCompound, GovernorVotesComp {\r\n  | ^ (Relevant source part starts here and spans across multiple lines).\r\n```\r\n\r\n2. The Error:\r\n\r\n```\r\nCompilation finished successfully\r\nAn unexpected error occurred:\r\n\r\nError: This method only supports Buffer but input was: 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80\r\n    at Object.exports.assertIsBuffer (/private/tmp/openzeppelin-contracts/node_modules/ethereumjs-util/src/helpers.ts:21:11)\r\n    at Object.exports.privateToPublic (/private/tmp/openzeppelin-contracts/node_modules/ethereumjs-util/src/account.ts:275:3)\r\n    at exports.privateToAddress (/private/tmp/openzeppelin-contracts/node_modules/ethereumjs-util/src/account.ts:285:26)\r\n    at /private/tmp/openzeppelin-contracts/node_modules/@nomiclabs/hardhat-truffle5/src/index.ts:140:41\r\n    at Array.map (<anonymous>)\r\n    at describeContract (/private/tmp/openzeppelin-contracts/node_modules/@nomiclabs/hardhat-truffle5/src/index.ts:139:11)\r\n    at /private/tmp/openzeppelin-contracts/node_modules/@nomiclabs/hardhat-truffle5/src/index.ts:162:20\r\n    at env.contract (/private/tmp/openzeppelin-contracts/hardhat/env-contract.js:8:5)\r\n    at Object.<anonymous> (/private/tmp/openzeppelin-contracts/test/access/AccessControl.test.js:7:1)\r\n    at Module._compile (node:internal/modules/cjs/loader:1101:14)\r\n    at Object.Module._extensions..js (node:internal/modules/cjs/loader:1153:10)\r\n    at Module.load (node:internal/modules/cjs/loader:981:32)\r\n    at Function.Module._load (node:internal/modules/cjs/loader:822:12)\r\n    at Module.require (node:internal/modules/cjs/loader:1005:19)\r\n    at require (node:internal/modules/cjs/helpers:94:18)\r\n    at /private/tmp/openzeppelin-contracts/node_modules/mocha/lib/mocha.js:349:36\r\ner\r\n```\r\n\r\n<!-- Remember, this is not a place to ask for help debugging code. For that, we welcome you in the OpenZeppelin Community Forum: https://forum.openzeppelin.com/. -->\r\n\r\n**üíª Environment**\r\n\r\nMacBook Pro M1 (ARM) with 16 GB RAM\r\nMacOS BigSur 11.4\r\n\r\nNode: tested with several versions:\r\n- 16.7.0\r\n- 15.4.0\r\n- 14.17.5\r\n- 12.22.5\r\n\r\n**üìù Details**\r\n\r\n<!-- Describe the problem you have been experiencing in more detail. Include as much information as you think is relevant. Keep in mind that transactions can fail for many reasons; context is key here. -->\r\n\r\n```\r\ngit clone git@github.com:OpenZeppelin/openzeppelin-contracts.git\r\ncd openzeppelin-contracts\r\nnpm install\r\nnpm run test\r\n```\r\n\r\nImportantly, on Intel-based Macs, this error does not occur, no matter which of the Node versions listed above I tested with.\r\n\r\n**üî¢ Code to reproduce bug**\r\n\r\n<!-- We will be able to better help if you provide a minimal example that triggers the bug. -->\r\n\r\nno code changes made here, just used master branch\r\n\r\n",
  "closed_by": {
    "login": "frangio",
    "id": 481465,
    "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/frangio",
    "html_url": "https://github.com/frangio",
    "followers_url": "https://api.github.com/users/frangio/followers",
    "following_url": "https://api.github.com/users/frangio/following{/other_user}",
    "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
    "organizations_url": "https://api.github.com/users/frangio/orgs",
    "repos_url": "https://api.github.com/users/frangio/repos",
    "events_url": "https://api.github.com/users/frangio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/frangio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2880/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2880/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/925608382",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2880#issuecomment-925608382",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2880",
    "id": 925608382,
    "node_id": "IC_kwDOA9tCBs43K6m-",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-23T08:34:52Z",
    "updated_at": "2021-09-23T08:34:52Z",
    "author_association": "COLLABORATOR",
    "body": "Hello @itinance \r\n\r\nThe first issue is known: Tests are running without optimization for easier debugging, and this contract is too large to deploy unless optimizations are enabled. It is not a serious issue (people should always deploy an optimized version) and is not related to your particular environment.\r\n\r\nI do not have a Mac machine to reproduce your second issue, but it looks like it's outside our scope. `openzeppelin-contracts/test/access/AccessControl.test.js:7:1` is the first \"describe\" in the first test file that is running ... and error looks like it originates from somewhere in `hardhat-truffle5` or `ethereumjs-utils`. I'd love to know more, but it is likely there is a more serious issue between your ARM based machine and one of these packages. \r\n\r\nHave you been able to run any truffle-based tests from another project? What about waffle/ethers? (migrating to that would require tremendous work though)",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/925608382/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/925645266",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2880#issuecomment-925645266",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2880",
    "id": 925645266,
    "node_id": "IC_kwDOA9tCBs43LDnS",
    "user": {
      "login": "itinance",
      "id": 1758597,
      "node_id": "MDQ6VXNlcjE3NTg1OTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1758597?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/itinance",
      "html_url": "https://github.com/itinance",
      "followers_url": "https://api.github.com/users/itinance/followers",
      "following_url": "https://api.github.com/users/itinance/following{/other_user}",
      "gists_url": "https://api.github.com/users/itinance/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/itinance/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/itinance/subscriptions",
      "organizations_url": "https://api.github.com/users/itinance/orgs",
      "repos_url": "https://api.github.com/users/itinance/repos",
      "events_url": "https://api.github.com/users/itinance/events{/privacy}",
      "received_events_url": "https://api.github.com/users/itinance/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-23T09:26:44Z",
    "updated_at": "2021-09-23T09:26:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @Amxx, I had also `ethereum-utils` or `hardhat-truffle` already in my mind and try to figure out, if I can get more informations (and probably get in contact with them then). I will keep you guys updated here in this thread.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/925645266/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/926848742",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2880#issuecomment-926848742",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2880",
    "id": 926848742,
    "node_id": "IC_kwDOA9tCBs43Ppbm",
    "user": {
      "login": "swaylock",
      "id": 23582496,
      "node_id": "MDQ6VXNlcjIzNTgyNDk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/23582496?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/swaylock",
      "html_url": "https://github.com/swaylock",
      "followers_url": "https://api.github.com/users/swaylock/followers",
      "following_url": "https://api.github.com/users/swaylock/following{/other_user}",
      "gists_url": "https://api.github.com/users/swaylock/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/swaylock/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/swaylock/subscriptions",
      "organizations_url": "https://api.github.com/users/swaylock/orgs",
      "repos_url": "https://api.github.com/users/swaylock/repos",
      "events_url": "https://api.github.com/users/swaylock/events{/privacy}",
      "received_events_url": "https://api.github.com/users/swaylock/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-24T18:48:19Z",
    "updated_at": "2021-09-24T18:57:53Z",
    "author_association": "NONE",
    "body": "@itinance I'm also seeing this. There's an issue over on Hardhat that is tracking this as well:\r\n\r\nhttps://github.com/nomiclabs/hardhat/issues/1885\r\n\r\nYour report that this bug doesn't occur on Intel based Macs is worrying indeed, but I'm not sure it's limited to M1 machines.\r\nHere's the specs on my machine:\r\n\r\nOS: Big Sur 11.5.2\r\nModel Name:\tMacBook Pro\r\nModel Identifier:\tMacBookPro15,3\r\nProcessor Name:\t6-Core Intel Core i9\r\nMemory:\t32 GB\r\n\r\nLet's continue the conversation at the issue linked above?",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/926848742/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/927100460",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2880#issuecomment-927100460",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2880",
    "id": 927100460,
    "node_id": "IC_kwDOA9tCBs43Qm4s",
    "user": {
      "login": "itinance",
      "id": 1758597,
      "node_id": "MDQ6VXNlcjE3NTg1OTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1758597?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/itinance",
      "html_url": "https://github.com/itinance",
      "followers_url": "https://api.github.com/users/itinance/followers",
      "following_url": "https://api.github.com/users/itinance/following{/other_user}",
      "gists_url": "https://api.github.com/users/itinance/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/itinance/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/itinance/subscriptions",
      "organizations_url": "https://api.github.com/users/itinance/orgs",
      "repos_url": "https://api.github.com/users/itinance/repos",
      "events_url": "https://api.github.com/users/itinance/events{/privacy}",
      "received_events_url": "https://api.github.com/users/itinance/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-25T10:22:12Z",
    "updated_at": "2021-09-25T10:22:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "I can report that this issue seems to be solved right now.\r\n\r\nSince I kept the older folder of \"git clone\"-output of openzeppelin I could check the difference between the state when this issue was happening and the state of today:\r\n\r\n`/usr/bin/diff /tmp/openzeppelin-contracts/package.json /tmp/o/openzeppelin-contracts/package.json`\r\n\r\n```\r\n53c53\r\n<     \"@nomiclabs/hardhat-truffle5\": \"^2.0.1\",\r\n---\r\n>     \"@nomiclabs/hardhat-truffle5\": \"^2.0.0\",\r\n70c70\r\n<     \"hardhat\": \"^2.6.4\",\r\n---\r\n>     \"hardhat\": \"^2.0.6\",\r\n72c72\r\n72c72\r\n<     \"keccak256\": \"^1.0.3\",\r\n---\r\n>     \"keccak256\": \"^1.0.2\",\r\n75,78c75,78\r\n<     \"merkletreejs\": \"^0.2.24\",\r\n<     \"micromatch\": \"^4.0.4\",\r\n<     \"prettier\": \"^2.4.1\",\r\n<     \"prettier-plugin-solidity\": \"^1.0.0-beta.18\",\r\n---\r\n>     \"merkletreejs\": \"^0.2.13\",\r\n>     \"micromatch\": \"^4.0.2\",\r\n>     \"prettier\": \"^2.3.0\",\r\n>     \"prettier-plugin-solidity\": \"^1.0.0-beta.16\",\r\n81,85c81,85\r\n<     \"solidity-ast\": \"^0.4.26\",\r\n<     \"solidity-coverage\": \"^0.7.17\",\r\n<     \"solidity-docgen\": \"^0.5.14\",\r\n<     \"web3\": \"^1.5.3\",\r\n<     \"yargs\": \"^17.2.0\"\r\n---\r\n>     \"solidity-ast\": \"^0.4.25\",\r\n>     \"solidity-coverage\": \"^0.7.11\",\r\n>     \"solidity-docgen\": \"^0.5.3\",\r\n>     \"web3\": \"^1.3.0\",\r\n>     \"yargs\": \"^16.2.0\"\r\n```\r\n\r\n(I left out all lines that belongs to unit testing and linting here)\r\n\r\nI was running successfully \r\n\r\n```\r\ngit clone git@github.com:OpenZeppelin/openzeppelin-contracts.git\r\ncd openzeppelin-contracts\r\nnpm install\r\nnpm run test\r\n```\r\n\r\nboth on Intel based Macs (where this issue never appeared for me) and ARM based Mac M1, where this issue was happening reproducable.\r\n\r\n\r\n\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/927100460/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/931407156",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2880#issuecomment-931407156",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2880",
    "id": 931407156,
    "node_id": "IC_kwDOA9tCBs43hCU0",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-30T15:05:31Z",
    "updated_at": "2021-09-30T15:05:31Z",
    "author_association": "COLLABORATOR",
    "body": "Experiencing that on x86-64 archlinux ...\r\nHopefully I find a fix in what you previously experimented ",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/931407156/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/936993631",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2880#issuecomment-936993631",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2880",
    "id": 936993631,
    "node_id": "IC_kwDOA9tCBs432WNf",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-06T19:43:36Z",
    "updated_at": "2021-10-06T19:43:36Z",
    "author_association": "MEMBER",
    "body": "This was an issue in Hardhat that was fixed on a recent release. ",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/936993631/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
