{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2526",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2526/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2526/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2526/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2526",
  "id": 809779141,
  "node_id": "MDU6SXNzdWU4MDk3NzkxNDE=",
  "number": 2526,
  "title": "Apparent Bug in ERC721 Transfer Event",
  "user": {
    "login": "JF0001",
    "id": 11094435,
    "node_id": "MDQ6VXNlcjExMDk0NDM1",
    "avatar_url": "https://avatars.githubusercontent.com/u/11094435?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/JF0001",
    "html_url": "https://github.com/JF0001",
    "followers_url": "https://api.github.com/users/JF0001/followers",
    "following_url": "https://api.github.com/users/JF0001/following{/other_user}",
    "gists_url": "https://api.github.com/users/JF0001/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/JF0001/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/JF0001/subscriptions",
    "organizations_url": "https://api.github.com/users/JF0001/orgs",
    "repos_url": "https://api.github.com/users/JF0001/repos",
    "events_url": "https://api.github.com/users/JF0001/events{/privacy}",
    "received_events_url": "https://api.github.com/users/JF0001/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2021-02-17T01:35:51Z",
  "updated_at": "2021-02-18T02:02:54Z",
  "closed_at": "2021-02-17T21:31:54Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I had initially reported an issue at the following link:\r\nhttps://forum.openzeppelin.com/t/how-to-pass-values-in-transfer-event/5809\r\n\r\nAfter doing more testing, I am experiencing something that looks like a bug, although it is quite possible that I am doing something wrong.\r\n\r\nAs explained in the issue referenced above, when I declare the ERC721 Transfer event using only the tokenId parameter (i.e. event Transfer(uint256 tokenId);), a value for the 3 parameters of the emit (returnValues with the \"from\", \"to\" and \"tokenId\" fields) are sent to my front-end.\r\n\r\nMeanwhile, when I declare the Transfer event using the 3 parameters (event Transfer(address indexed from, address indexed to, uint256 tokenId);), I am obtaining the following error in the front-end: TypeError: Cannot read property 'returnValues' of undefined\r\n\r\nNo other modifications are made to either the smart contract or my front-end.\r\n\r\nThank you. J\r\n",
  "closed_by": {
    "login": "JF0001",
    "id": 11094435,
    "node_id": "MDQ6VXNlcjExMDk0NDM1",
    "avatar_url": "https://avatars.githubusercontent.com/u/11094435?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/JF0001",
    "html_url": "https://github.com/JF0001",
    "followers_url": "https://api.github.com/users/JF0001/followers",
    "following_url": "https://api.github.com/users/JF0001/following{/other_user}",
    "gists_url": "https://api.github.com/users/JF0001/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/JF0001/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/JF0001/subscriptions",
    "organizations_url": "https://api.github.com/users/JF0001/orgs",
    "repos_url": "https://api.github.com/users/JF0001/repos",
    "events_url": "https://api.github.com/users/JF0001/events{/privacy}",
    "received_events_url": "https://api.github.com/users/JF0001/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2526/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2526/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/780418843",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2526#issuecomment-780418843",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2526",
    "id": 780418843,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDQxODg0Mw==",
    "user": {
      "login": "zemse",
      "id": 22412996,
      "node_id": "MDQ6VXNlcjIyNDEyOTk2",
      "avatar_url": "https://avatars.githubusercontent.com/u/22412996?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zemse",
      "html_url": "https://github.com/zemse",
      "followers_url": "https://api.github.com/users/zemse/followers",
      "following_url": "https://api.github.com/users/zemse/following{/other_user}",
      "gists_url": "https://api.github.com/users/zemse/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zemse/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zemse/subscriptions",
      "organizations_url": "https://api.github.com/users/zemse/orgs",
      "repos_url": "https://api.github.com/users/zemse/repos",
      "events_url": "https://api.github.com/users/zemse/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zemse/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-17T09:19:29Z",
    "updated_at": "2021-02-17T09:19:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'd like to help. When you change `Transfer(uint256 tokenId)` to `Transfer(address indexed from, address indexed to, uint256 tokenId)`, that changes the signature of the event (so that changes your ABI). As you said \"No other modifications to my front-end\", if you are using the old ABI, try updating it in your front end.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/780418843/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/780534506",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2526#issuecomment-780534506",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2526",
    "id": 780534506,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDUzNDUwNg==",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-17T12:50:21Z",
    "updated_at": "2021-02-17T12:50:21Z",
    "author_association": "COLLABORATOR",
    "body": "Hello @JF0001.\r\nYour problem looks to be frontend related, and not specific to OpenZeppelin's contracts. I'm not right sure this is the right place to raise an issue.\r\nI would personnally say that having multiple event signature use the same name is not a good idea, as it can lead to confusion between inconsistent mapping between name and signature in you frontend. Additionnaly, I'm curious why you need an extra `Transfer(uint256)` event (which is not standard) in addition to the existing one, that already contains the tokenId information you want.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/780534506/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/780582569",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2526#issuecomment-780582569",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2526",
    "id": 780582569,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDU4MjU2OQ==",
    "user": {
      "login": "JF0001",
      "id": 11094435,
      "node_id": "MDQ6VXNlcjExMDk0NDM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/11094435?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JF0001",
      "html_url": "https://github.com/JF0001",
      "followers_url": "https://api.github.com/users/JF0001/followers",
      "following_url": "https://api.github.com/users/JF0001/following{/other_user}",
      "gists_url": "https://api.github.com/users/JF0001/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JF0001/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JF0001/subscriptions",
      "organizations_url": "https://api.github.com/users/JF0001/orgs",
      "repos_url": "https://api.github.com/users/JF0001/repos",
      "events_url": "https://api.github.com/users/JF0001/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JF0001/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-17T14:11:32Z",
    "updated_at": "2021-02-17T14:11:32Z",
    "author_association": "NONE",
    "body": "Thank you @zemse I have obviously re-deployed the contract on my test chain and included the updated ABI in my front-end. (My apologies for not including this detail.) If that were not the case, I wouldn't have been able to compare the two outputs.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/780582569/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/780588350",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2526#issuecomment-780588350",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2526",
    "id": 780588350,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDU4ODM1MA==",
    "user": {
      "login": "JF0001",
      "id": 11094435,
      "node_id": "MDQ6VXNlcjExMDk0NDM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/11094435?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JF0001",
      "html_url": "https://github.com/JF0001",
      "followers_url": "https://api.github.com/users/JF0001/followers",
      "following_url": "https://api.github.com/users/JF0001/following{/other_user}",
      "gists_url": "https://api.github.com/users/JF0001/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JF0001/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JF0001/subscriptions",
      "organizations_url": "https://api.github.com/users/JF0001/orgs",
      "repos_url": "https://api.github.com/users/JF0001/repos",
      "events_url": "https://api.github.com/users/JF0001/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JF0001/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-17T14:20:53Z",
    "updated_at": "2021-02-17T14:20:53Z",
    "author_association": "NONE",
    "body": "Hi @Amxx \r\nI am not using the two different signatures at once within my contract. I have discovered the discrepancy of the output from each signature by chance. I had initially mistakenly used the  Transfer(uint256 tokenId) signature by mistake, not including the other two parameters (from and to) in my declaration. This signature was actually working properly, returning all the parameters in the event (even if they were actually not found in my declaration). Having realised my mistake, I have then modified the signature so that it does actually contain all three parameters. Having change only this signature in my smart contract and nothing else in my front-end, my code stopped working, thus realising after outputting the result that the returnValues were no longer returned as previously.\r\nThank you again.\r\nJ",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/780588350/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/780709165",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2526#issuecomment-780709165",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2526",
    "id": 780709165,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDcwOTE2NQ==",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-17T17:12:20Z",
    "updated_at": "2021-02-17T17:12:20Z",
    "author_association": "COLLABORATOR",
    "body": "@JF0001 Again, I'm not sure how dis relates the OpenZeppelin contracts. Are you using our implementation of ERC721, and is there any issue with it ? If not, I'd like to close this issue and encourage you to continue the discussion somewhere else (in the forum) since this space is specifically about the @OpenZeppelin/contracts package.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/780709165/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/780727006",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2526#issuecomment-780727006",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2526",
    "id": 780727006,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDcyNzAwNg==",
    "user": {
      "login": "JF0001",
      "id": 11094435,
      "node_id": "MDQ6VXNlcjExMDk0NDM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/11094435?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JF0001",
      "html_url": "https://github.com/JF0001",
      "followers_url": "https://api.github.com/users/JF0001/followers",
      "following_url": "https://api.github.com/users/JF0001/following{/other_user}",
      "gists_url": "https://api.github.com/users/JF0001/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JF0001/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JF0001/subscriptions",
      "organizations_url": "https://api.github.com/users/JF0001/orgs",
      "repos_url": "https://api.github.com/users/JF0001/repos",
      "events_url": "https://api.github.com/users/JF0001/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JF0001/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-17T17:39:17Z",
    "updated_at": "2021-02-17T17:41:20Z",
    "author_association": "NONE",
    "body": "Hi @Amxx Yes indeed, I am using the OpenZeppelin implementation of ERC721. I am importing the ERC721.sol code (without modifying it) within my contract. As explained above, in my contract, if I include in my declaration of the Transfer Event, only the tokenId parameter, I am obtaining the output above, in which one can see that all 3 parameters are emitted by my smart contract (and received in my front-end), while if I actually declare the 3 parameters in my declaration of the Transfer Event, these values are no longer emitted, as displayed in the second output above. Thus, the issue appears to be related to the OpenZeppelin code found in the ERC721.sol file.\r\nThank you. J",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/780727006/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/780867867",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2526#issuecomment-780867867",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2526",
    "id": 780867867,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MDg2Nzg2Nw==",
    "user": {
      "login": "JF0001",
      "id": 11094435,
      "node_id": "MDQ6VXNlcjExMDk0NDM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/11094435?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JF0001",
      "html_url": "https://github.com/JF0001",
      "followers_url": "https://api.github.com/users/JF0001/followers",
      "following_url": "https://api.github.com/users/JF0001/following{/other_user}",
      "gists_url": "https://api.github.com/users/JF0001/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JF0001/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JF0001/subscriptions",
      "organizations_url": "https://api.github.com/users/JF0001/orgs",
      "repos_url": "https://api.github.com/users/JF0001/repos",
      "events_url": "https://api.github.com/users/JF0001/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JF0001/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-17T21:31:46Z",
    "updated_at": "2021-02-17T21:31:46Z",
    "author_association": "NONE",
    "body": "Hi @Amxx I was able to make it work properly using the following:\r\n\r\nevent Transfer(address indexed _from, address indexed _to, uint256 indexed _tokenId);\r\n\r\nInstead of:\r\nevent Transfer(address indexed from, address indexed to, uint256 tokenId);\r\n\r\nAs previously.\r\n\r\nRegards, J",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/780867867/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
