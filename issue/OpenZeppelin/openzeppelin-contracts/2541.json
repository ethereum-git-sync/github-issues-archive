{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2541",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2541/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2541/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2541/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2541",
  "id": 816276306,
  "node_id": "MDU6SXNzdWU4MTYyNzYzMDY=",
  "number": 2541,
  "title": "Slither: contract sets array length with a user-controlled value (ERC20Snapshot)",
  "user": {
    "login": "wschwab",
    "id": 31592931,
    "node_id": "MDQ6VXNlcjMxNTkyOTMx",
    "avatar_url": "https://avatars.githubusercontent.com/u/31592931?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wschwab",
    "html_url": "https://github.com/wschwab",
    "followers_url": "https://api.github.com/users/wschwab/followers",
    "following_url": "https://api.github.com/users/wschwab/following{/other_user}",
    "gists_url": "https://api.github.com/users/wschwab/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wschwab/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wschwab/subscriptions",
    "organizations_url": "https://api.github.com/users/wschwab/orgs",
    "repos_url": "https://api.github.com/users/wschwab/repos",
    "events_url": "https://api.github.com/users/wschwab/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wschwab/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2021-02-25T09:56:02Z",
  "updated_at": "2021-03-01T13:53:32Z",
  "closed_at": "2021-03-01T13:53:32Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Hi! Slither turns up an issue with `ERC20Snapshot` that it defines as \"high criticality\". I wanted to bring it to your attention, even though I assume it's not a problem.\r\n\r\nThis is the `_updateSnapshot` function ([link](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/extensions/ERC20Snapshot.sol#L164)):\r\n```solidity\r\nfunction _updateSnapshot(Snapshots storage snapshots, uint256 currentValue) private {\r\n        uint256 currentId = _currentSnapshotId.current();\r\n        if (_lastSnapshotId(snapshots.ids) < currentId) {\r\n            snapshots.ids.push(currentId);\r\n            snapshots.values.push(currentValue);\r\n        }\r\n    }\r\n```\r\nabout the last line (`snapshots.values.push(currentValue);`) Slither says:\r\n```\r\nERC20Snapshot (flattened.sol#1731-1878) contract sets array length with a user-controlled value:\r\n        - snapshots.values.push(currentValue) (flattened.sol#1867)\r\n```\r\n\r\nI just wanted to bring this to your attention. Thanks for the awesome contracts!",
  "closed_by": {
    "login": "frangio",
    "id": 481465,
    "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/frangio",
    "html_url": "https://github.com/frangio",
    "followers_url": "https://api.github.com/users/frangio/followers",
    "following_url": "https://api.github.com/users/frangio/following{/other_user}",
    "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
    "organizations_url": "https://api.github.com/users/frangio/orgs",
    "repos_url": "https://api.github.com/users/frangio/repos",
    "events_url": "https://api.github.com/users/frangio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/frangio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2541/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2541/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/786132045",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2541#issuecomment-786132045",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2541",
    "id": 786132045,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4NjEzMjA0NQ==",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-25T19:04:50Z",
    "updated_at": "2021-02-25T19:04:50Z",
    "author_association": "MEMBER",
    "body": "Thanks for sharing this! What version of the library was this reported for?\r\n\r\nThe issue description is weird, because it is not true that the array length is set to a user-controlled value. It is true in some cases that a user can cause the array to grow, but since the array is always pushed to, it can only grow in increments of one. Projects can restrict what users have this power, but even if it is open to anyone, the consequences are very well contained. More details in the [documentation for ERC20Snapshot](https://docs.openzeppelin.com/contracts/3.x/api/token/erc20#ERC20Snapshot).",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/786132045/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/786146813",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2541#issuecomment-786146813",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2541",
    "id": 786146813,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4NjE0NjgxMw==",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-25T19:29:40Z",
    "updated_at": "2021-02-25T19:29:55Z",
    "author_association": "COLLABORATOR",
    "body": "Also, this functions pushes value to both `snapshots.ids` and `snapshots.values` ... but the warning is only triggered in the second case.\r\nThe only difference I see is that in the first case, the value that is being pushed is produced by the contract itself, while in the second case its a user provided value.\r\n\r\nIt feels like this warning is more of a \"_contract sets array **value** with a user-controlled value_\" ... which I don't see as being an issue.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/786146813/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/787419170",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2541#issuecomment-787419170",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2541",
    "id": 787419170,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4NzQxOTE3MA==",
    "user": {
      "login": "wschwab",
      "id": 31592931,
      "node_id": "MDQ6VXNlcjMxNTkyOTMx",
      "avatar_url": "https://avatars.githubusercontent.com/u/31592931?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wschwab",
      "html_url": "https://github.com/wschwab",
      "followers_url": "https://api.github.com/users/wschwab/followers",
      "following_url": "https://api.github.com/users/wschwab/following{/other_user}",
      "gists_url": "https://api.github.com/users/wschwab/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wschwab/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wschwab/subscriptions",
      "organizations_url": "https://api.github.com/users/wschwab/orgs",
      "repos_url": "https://api.github.com/users/wschwab/repos",
      "events_url": "https://api.github.com/users/wschwab/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wschwab/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-28T08:57:14Z",
    "updated_at": "2021-02-28T08:57:14Z",
    "author_association": "NONE",
    "body": "> What version of the library was this reported for?\r\n\r\n`3.4.0`\r\n\r\nI was also a bit surprised by the flag, and couldn't figure out how the length would be able to be arbitrarily set by a user-controlled value (other than incrementing by one, which is a feature, not a bug), and figured it was probably just Slither accidentally tripping over something. That being said, I figured I'd at least point it out, ya know, just in case and stuff. Feel free to close if you don't see anything here that needs any further attention.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/787419170/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/787965405",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2541#issuecomment-787965405",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2541",
    "id": 787965405,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4Nzk2NTQwNQ==",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-01T13:53:32Z",
    "updated_at": "2021-03-01T13:53:32Z",
    "author_association": "MEMBER",
    "body": "Thanks for reporting!",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/787965405/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
