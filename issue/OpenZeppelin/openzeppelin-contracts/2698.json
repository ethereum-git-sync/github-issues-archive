{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2698",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2698/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2698/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2698/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2698",
  "id": 905607447,
  "node_id": "MDU6SXNzdWU5MDU2MDc0NDc=",
  "number": 2698,
  "title": "[AccessControl] Ability to deny admins from revoking other admins",
  "user": {
    "login": "bogdan",
    "id": 122436,
    "node_id": "MDQ6VXNlcjEyMjQzNg==",
    "avatar_url": "https://avatars.githubusercontent.com/u/122436?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/bogdan",
    "html_url": "https://github.com/bogdan",
    "followers_url": "https://api.github.com/users/bogdan/followers",
    "following_url": "https://api.github.com/users/bogdan/following{/other_user}",
    "gists_url": "https://api.github.com/users/bogdan/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/bogdan/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/bogdan/subscriptions",
    "organizations_url": "https://api.github.com/users/bogdan/orgs",
    "repos_url": "https://api.github.com/users/bogdan/repos",
    "events_url": "https://api.github.com/users/bogdan/events{/privacy}",
    "received_events_url": "https://api.github.com/users/bogdan/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2021-05-28T15:27:38Z",
  "updated_at": "2021-06-08T14:04:22Z",
  "closed_at": "2021-06-07T16:01:30Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "**üßê Motivation**\r\n<!-- Is your feature request related to a specific problem? Is it just a crazy idea? Tell us about it! -->\r\n\r\nSuppose we have common roles hierarchy like: Operator Admin => Operators.\r\nOperators can do certain daily operations.  Operator Admins can manage operators. Admins can also add other admins or renounce themselves. This is OK.\r\n\r\nBut what if one of admin's private key leaks to public? In this case, we want to prevent this admin from revoking other admins to maintain a partial control over the system. Otherwise leaked private key can be used to add another hacker's private key and revoke all other operator admins from the system capturing and sealing hackers permission over operators forever.\r\n\r\nSo it make it a better permission model to disallow any member to revoke other member of its kind (same role) for the top role in the hierarchy.\r\n\r\n**BTW**\r\n\r\nIt was the case in the v2.3.0 for Whitelisted Admin role but I am not sure why it was changed: I don't see the ability for an admin to revoke other admin here: https://github.com/OpenZeppelin/openzeppelin-contracts/blob/release-v2.3.0/contracts/access/roles/WhitelistAdminRole.sol. \r\n\r\nIt looks like a downgrade in security model. \r\n\r\n**üìù Details**\r\n<!-- Please describe your feature request in detail. -->\r\n\r\nAs far as I understand, `AccessControl.sol` can not be configured this way right now.\r\nWe need an addtional configuration option in `RoleData` like:\r\n\r\n``` solidity\r\n struct RoleData {        \r\n   mapping (address => bool) members;        \r\n   byters32 adminRole;\r\n   bool revokingOtherMembers;    \r\n }\r\n```\r\n\r\nThis option can determine if a member can revoke other member.\r\n\r\n\r\n<!-- Make sure that you have reviewed the OpenZeppelin Contributor Guidelines. -->\r\n<!-- https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/CONTRIBUTING.md -->\r\n",
  "closed_by": {
    "login": "Amxx",
    "id": 2432299,
    "node_id": "MDQ6VXNlcjI0MzIyOTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Amxx",
    "html_url": "https://github.com/Amxx",
    "followers_url": "https://api.github.com/users/Amxx/followers",
    "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
    "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
    "organizations_url": "https://api.github.com/users/Amxx/orgs",
    "repos_url": "https://api.github.com/users/Amxx/repos",
    "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Amxx/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2698/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2698/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/850524147",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2698#issuecomment-850524147",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2698",
    "id": 850524147,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MDUyNDE0Nw==",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-28T16:11:28Z",
    "updated_at": "2021-05-28T16:11:57Z",
    "author_association": "COLLABORATOR",
    "body": "Hello @bogdan \r\n\r\nAFAIK, the simplest option to implement that by overriding the `revokeRole` function.\r\n\r\n```\r\nfunction revokeRole(bytes32 role, address account) external virtual override {\r\n    require(role != OperatorAdminRole, \"Cannot revoke and operator admin\");\r\n    super.revokeRole(role, account);\r\n}\r\n```\r\n\r\nWould that work for you ?",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/850524147/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/856066013",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2698#issuecomment-856066013",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2698",
    "id": 856066013,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1NjA2NjAxMw==",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-07T16:03:27Z",
    "updated_at": "2021-06-07T16:03:27Z",
    "author_association": "COLLABORATOR",
    "body": "This issue as been inactive for a while, so I am closing it. Please reopen if you still have concerns with AccessControl.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/856066013/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/856072115",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2698#issuecomment-856072115",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2698",
    "id": 856072115,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1NjA3MjExNQ==",
    "user": {
      "login": "bogdan",
      "id": 122436,
      "node_id": "MDQ6VXNlcjEyMjQzNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/122436?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bogdan",
      "html_url": "https://github.com/bogdan",
      "followers_url": "https://api.github.com/users/bogdan/followers",
      "following_url": "https://api.github.com/users/bogdan/following{/other_user}",
      "gists_url": "https://api.github.com/users/bogdan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bogdan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bogdan/subscriptions",
      "organizations_url": "https://api.github.com/users/bogdan/orgs",
      "repos_url": "https://api.github.com/users/bogdan/repos",
      "events_url": "https://api.github.com/users/bogdan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bogdan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-07T16:11:45Z",
    "updated_at": "2021-06-07T16:11:45Z",
    "author_association": "NONE",
    "body": "Yes, that works thanks. ",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/856072115/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/856324966",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2698#issuecomment-856324966",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2698",
    "id": 856324966,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1NjMyNDk2Ng==",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-07T23:23:43Z",
    "updated_at": "2021-06-07T23:23:43Z",
    "author_association": "MEMBER",
    "body": "> But what if one of admin's private key leaks to public? In this case, we want to prevent this admin from revoking other admins to maintain a partial control over the system.\r\n\r\nI also want to point out that this wouldn't happen unless operator admins are the role admin for operator admins themselves.\r\n\r\nI mentioned this in my [AccessControl workshop](https://blog.openzeppelin.com/workshop-recap-setting-up-access-control-for-smart-contracts/) (video). Whenever you have a role that is its own admin, it should probably only ever be granted to multisig contracts or highly secured keys (possibly cold storage keys that would serve as a backup).",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/856324966/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/856682720",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2698#issuecomment-856682720",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2698",
    "id": 856682720,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1NjY4MjcyMA==",
    "user": {
      "login": "bogdan",
      "id": 122436,
      "node_id": "MDQ6VXNlcjEyMjQzNg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/122436?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bogdan",
      "html_url": "https://github.com/bogdan",
      "followers_url": "https://api.github.com/users/bogdan/followers",
      "following_url": "https://api.github.com/users/bogdan/following{/other_user}",
      "gists_url": "https://api.github.com/users/bogdan/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bogdan/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bogdan/subscriptions",
      "organizations_url": "https://api.github.com/users/bogdan/orgs",
      "repos_url": "https://api.github.com/users/bogdan/repos",
      "events_url": "https://api.github.com/users/bogdan/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bogdan/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-08T11:27:43Z",
    "updated_at": "2021-06-08T11:27:43Z",
    "author_association": "NONE",
    "body": "> I also want to point out that this wouldn't happen unless operator admins are the role admin for operator admins themselves\r\n\r\nAgreed. This can only happen for the top role in the hierarchy.\r\n\r\n> it should probably only ever be granted to multisig contracts or highly secured keys\r\n\r\nThis vision is too theoretical. Companies are not made just to be secure, they have to be make money in the first place. If you can make system more secure without creating more operational work - you should take this opportunity even if it is not THAT secure.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/856682720/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/856797754",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2698#issuecomment-856797754",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2698",
    "id": 856797754,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1Njc5Nzc1NA==",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-08T14:04:22Z",
    "updated_at": "2021-06-08T14:04:22Z",
    "author_association": "COLLABORATOR",
    "body": "@bogdan if you want to try doing contract maintenance/administration easily, and using a multisig transparently, I recommend you check out [defender](https://openzeppelin.com/defender/)",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/856797754/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
