{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2242",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2242/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2242/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2242/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2242",
  "id": 623072814,
  "node_id": "MDU6SXNzdWU2MjMwNzI4MTQ=",
  "number": 2242,
  "title": "Support for native-meta transaction in contract3.X standard",
  "user": {
    "login": "sanchaymittal",
    "id": 31698676,
    "node_id": "MDQ6VXNlcjMxNjk4Njc2",
    "avatar_url": "https://avatars.githubusercontent.com/u/31698676?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sanchaymittal",
    "html_url": "https://github.com/sanchaymittal",
    "followers_url": "https://api.github.com/users/sanchaymittal/followers",
    "following_url": "https://api.github.com/users/sanchaymittal/following{/other_user}",
    "gists_url": "https://api.github.com/users/sanchaymittal/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sanchaymittal/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sanchaymittal/subscriptions",
    "organizations_url": "https://api.github.com/users/sanchaymittal/orgs",
    "repos_url": "https://api.github.com/users/sanchaymittal/repos",
    "events_url": "https://api.github.com/users/sanchaymittal/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sanchaymittal/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-05-22T09:16:18Z",
  "updated_at": "2020-05-26T17:00:37Z",
  "closed_at": "2020-05-26T17:00:37Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "**üßê Motivation**\r\nContracts3.X doesn't support Native Meta-Transaction support. It's not compatible with any of the meta-transaction out there in the market.\r\n\r\n**üìù Details**\r\nAs contract 3.X uses v0.6.6 standard of solidity, And function _msgSender in Context contract is virtual so it can only be overridden in parent contract which inherits the ERC20 standard. That means, the existing solutions for meta transaction are not compatible anymore. To give some context, Meta-Transaction relayers uses _msgSender, For instance Gas station network uses this implementation.\r\n\r\n```\r\n    function _msgSender() internal view returns (address payable) {\r\n        if (msg.sender == address(this)) {\r\n            bytes20 userAddress;\r\n            uint256 dataLength = msg.data.length;\r\n            assembly {\r\n                calldatacopy(0x0, sub(dataLength, 40), sub(dataLength, 20))\r\n                userAddress := mload(0x0)\r\n            }\r\n            return address(uint160(userAddress));\r\n        } else {\r\n            return msg.sender;\r\n        }\r\n    }\r\n```\r\n\r\nI propose that we should include this change in Context contract itself or make changes so _msgSender() can be overridden by the other contracts too.\r\n\r\n<!-- Make sure that you have reviewed the OpenZeppelin Contributor Guidelines. -->\r\n<!-- https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/CONTRIBUTING.md -->\r\n",
  "closed_by": {
    "login": "frangio",
    "id": 481465,
    "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/frangio",
    "html_url": "https://github.com/frangio",
    "followers_url": "https://api.github.com/users/frangio/followers",
    "following_url": "https://api.github.com/users/frangio/following{/other_user}",
    "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
    "organizations_url": "https://api.github.com/users/frangio/orgs",
    "repos_url": "https://api.github.com/users/frangio/repos",
    "events_url": "https://api.github.com/users/frangio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/frangio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2242/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2242/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/632920462",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2242#issuecomment-632920462",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2242",
    "id": 632920462,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMjkyMDQ2Mg==",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-22T21:44:56Z",
    "updated_at": "2020-05-22T21:44:56Z",
    "author_association": "MEMBER",
    "body": "Thank you for reaching out @sanchaymittal.\r\n\r\nI wasn't able to understand the problem that you point out.\r\n\r\n`Context._msgSender` was specifically built for the GSN. The inheritance changes in Solidity 0.6 made it a bit more cumbersome to use, but everything should work. `GSNRecipient` defines the [override for `_msgSender`](https://docs.openzeppelin.com/contracts/3.x/api/gsn#GSNRecipient-_msgSender--).\r\n\r\nUnfortunately in Solidity 0.6 inheriting from `GSNRecipient` will likely result in a contract that doesn't compile because the compiler doesn't know if it should use `Context._msgSender` or `GSNRecipient._msgSender`, but this is fixed by adding the following lines to your contract:\r\n\r\n```solidity\r\nfunction _msgSender() internal view override(Context, GSNRecipient) returns (address payable) {\r\n    return super._msgSender();\r\n}\r\n\r\nfunction _msgData() internal view override(Context, GSNRecipient) returns (bytes memory) {\r\n    return super._msgData();\r\n}\r\n```\r\n\r\nBy using `super` we specify that we want to use the \"most specific\" implementation of `_msgData` according to the Solidity linearization, and that will be `GSNRecipient`'s.\r\n\r\nWe definitely should have specifically this bit of code in the docs, but I couldn't find it. cc @nventuro ",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/632920462/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/632967635",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2242#issuecomment-632967635",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2242",
    "id": 632967635,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMjk2NzYzNQ==",
    "user": {
      "login": "abcoathup",
      "id": 28278242,
      "node_id": "MDQ6VXNlcjI4Mjc4MjQy",
      "avatar_url": "https://avatars.githubusercontent.com/u/28278242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/abcoathup",
      "html_url": "https://github.com/abcoathup",
      "followers_url": "https://api.github.com/users/abcoathup/followers",
      "following_url": "https://api.github.com/users/abcoathup/following{/other_user}",
      "gists_url": "https://api.github.com/users/abcoathup/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/abcoathup/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/abcoathup/subscriptions",
      "organizations_url": "https://api.github.com/users/abcoathup/orgs",
      "repos_url": "https://api.github.com/users/abcoathup/repos",
      "events_url": "https://api.github.com/users/abcoathup/events{/privacy}",
      "received_events_url": "https://api.github.com/users/abcoathup/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-23T01:57:13Z",
    "updated_at": "2020-05-23T01:57:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "We have notes on the required overrides for GSN in the release notes for v3: https://github.com/OpenZeppelin/openzeppelin-contracts/releases/tag/v3.0.0",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/632967635/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/633415811",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2242#issuecomment-633415811",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2242",
    "id": 633415811,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMzQxNTgxMQ==",
    "user": {
      "login": "sanchaymittal",
      "id": 31698676,
      "node_id": "MDQ6VXNlcjMxNjk4Njc2",
      "avatar_url": "https://avatars.githubusercontent.com/u/31698676?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sanchaymittal",
      "html_url": "https://github.com/sanchaymittal",
      "followers_url": "https://api.github.com/users/sanchaymittal/followers",
      "following_url": "https://api.github.com/users/sanchaymittal/following{/other_user}",
      "gists_url": "https://api.github.com/users/sanchaymittal/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sanchaymittal/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sanchaymittal/subscriptions",
      "organizations_url": "https://api.github.com/users/sanchaymittal/orgs",
      "repos_url": "https://api.github.com/users/sanchaymittal/repos",
      "events_url": "https://api.github.com/users/sanchaymittal/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sanchaymittal/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-25T07:08:11Z",
    "updated_at": "2020-05-25T07:08:11Z",
    "author_association": "NONE",
    "body": "Thanks a lot guys!!! @frangio @abcoathup.\r\nGot it resolved... \r\n```\r\npragma solidity \"0.6.6\";\r\n\r\nimport { ERC20 } from \"@openzeppelin/contracts/token/ERC20/ERC20.sol\";\r\nimport \"@opengsn/gsn/contracts/BaseRelayRecipient.sol\";\r\n\r\ncontract TestToken is ERC20, BaseRelayRecipient {\r\n  constructor() \r\n    ERC20(\"Test Token\", \"TST\")\r\n    public \r\n  {\r\n    uint256 value = 10**10 * (10**18);\r\n    _mint(_msgSender(), value);\r\n  }\r\n\r\nfunction _msgSender() internal view override(Context, BaseRelayRecipient) returns (address payable) {\r\n    return BaseRelayRecipient._msgSender();\r\n}\r\n}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/633415811/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/634151274",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2242#issuecomment-634151274",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2242",
    "id": 634151274,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNDE1MTI3NA==",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-26T17:00:37Z",
    "updated_at": "2020-05-26T17:00:37Z",
    "author_association": "MEMBER",
    "body": "Awesome!",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/634151274/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
