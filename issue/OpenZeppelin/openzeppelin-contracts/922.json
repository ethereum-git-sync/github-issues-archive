{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/922",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/922/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/922/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/922/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/922",
  "id": 318942784,
  "node_id": "MDU6SXNzdWUzMTg5NDI3ODQ=",
  "number": 922,
  "title": "my token is from AllowanceCrowdsale,but failed",
  "user": {
    "login": "jackoelv",
    "id": 10348409,
    "node_id": "MDQ6VXNlcjEwMzQ4NDA5",
    "avatar_url": "https://avatars.githubusercontent.com/u/10348409?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jackoelv",
    "html_url": "https://github.com/jackoelv",
    "followers_url": "https://api.github.com/users/jackoelv/followers",
    "following_url": "https://api.github.com/users/jackoelv/following{/other_user}",
    "gists_url": "https://api.github.com/users/jackoelv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jackoelv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jackoelv/subscriptions",
    "organizations_url": "https://api.github.com/users/jackoelv/orgs",
    "repos_url": "https://api.github.com/users/jackoelv/repos",
    "events_url": "https://api.github.com/users/jackoelv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jackoelv/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2018-04-30T15:59:47Z",
  "updated_at": "2018-05-01T14:54:10Z",
  "closed_at": "2018-05-01T14:54:10Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "## 🎉 Description\r\n\r\nI am newer to OpenZeppelin, newer to solidity.\r\ncode is here , I want to create a AllowanceCrowdsale, but when somebody pay eth to the contract address, the app crashed , after debugging, I found error occured here:\r\n **_require(_value <= allowed[_from][msg.sender]);_**\r\nthen called \r\n\r\n47:   function approve(address _spender, uint256 _value) public returns (bool) {\r\n48:     allowed[msg.sender][_spender] = _value;\r\n**_49:     emit Approval(msg.sender, _spender, _value);_**\r\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ \r\n\r\nwhat`s happened ? May I wrote wrong? thanks a lot~\r\n\r\n- [x ] 🐛 This is a bug report.\r\n\r\n\r\n## 💻 Environment\r\n\r\nNext, we need to know what your environment looks like.\r\n\r\n- Which version of OpenZeppelin are you using? the code pulled from Github just now.\r\n- What network are you deploying to? Ganache\r\n- How are you deploying your OpenZeppelin-backed contracts? truffle\r\n\r\n## 📝 Details\r\n\r\n\r\n\r\n## 🔢 Code To Reproduce Issue [ Good To Have ]\r\n\r\n> msccrowdsale.sol\r\n\r\n`pragma solidity 0.4.23;\r\n\r\nimport './MSCCoin.sol';\r\n\r\nimport 'openzeppelin-solidity/contracts/crowdsale/emission/AllowanceCrowdsale.sol';\r\n\r\n//import 'openzeppelin-solidity/contracts/crowdsale/validation/TimedCrowdsale.sol';\r\n\r\ncontract MSCCrowdsale is AllowanceCrowdsale {\r\nfunction MSCCrowdsale\r\n    (\r\n        uint256 _rate,\r\n        address _wallet,\r\n        StandardToken _token\r\n    )\r\n    public   \r\n    Crowdsale(_rate, _wallet, _token)\r\n    AllowanceCrowdsale(_wallet){\r\n    }\r\n}\r\n\r\n`\r\n\r\n> msccoin.sol\r\n\r\n`pragma solidity 0.4.23;\r\n\r\nimport 'openzeppelin-solidity/contracts/token/ERC20/StandardToken.sol';\r\nimport 'openzeppelin-solidity/contracts/ownership/Ownable.sol';\r\n\r\ncontract MSCCoin is StandardToken,Ownable {\r\n    string public name = \"test Coin\";\r\n    string public symbol = \"MSC\";\r\n    uint8 public decimals = 18;\r\n    uint256 public constant INITIAL_SUPPLY = 500000000 * (10 ** uint256(decimals));\r\n\r\n\r\n\r\n   \tfunction MSCCoin() public {\r\n    \tbalances[msg.sender] = INITIAL_SUPPLY;\r\n    \temit Transfer(0x0, msg.sender, INITIAL_SUPPLY);\r\n \r\n    }\r\n\r\n\r\n}\r\n\r\n`\r\n\r\n\r\n\r\n## 👍 debug Information\r\n`debug(development:0x7d4ff2d8...)> \r\n\r\nStandardToken.sol:\r\n\r\n26:     require(_to != address(0));\r\n27:     require(_value <= balances[_from]);\r\n28:     require(_value <= allowed[_from][msg.sender]);\r\n                          ^^^^^^^                     \r\n\r\ndebug(development:0x7d4ff2d8...)> v\r\n\r\n    _from: '0x690be2c9c7a85d9ca9d26bf46d612b93fed1adb4'\r\n      _to: '0x1f6c0e9a57071c98a7c8b2b9bec495a53d80c174'\r\n   _value: 1.6e+22\r\n         : true\r\n  allowed: undefined`\r\n\r\n\r\ndebug(development:0x7d4ff2d8...)> i\r\n\r\nStandardToken.sol:\r\n\r\n26:     require(_to != address(0));\r\n27:     require(_value <= balances[_from]);\r\n28:     require(_value <= allowed[_from][msg.sender]);\r\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ \r\n\r\ndebug(development:0x7d4ff2d8...)> i\r\n\r\nStandardToken.sol:\r\n\r\n47:   function approve(address _spender, uint256 _value) public returns (bool) {\r\n48:     allowed[msg.sender][_spender] = _value;\r\n**_49:     emit Approval(msg.sender, _spender, _value);_**\r\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ \r\n\r\ndebug(development:0x7d4ff2d8...)> v\r\n\r\n  _spender: undefined\r\n    _value: undefined\r\n          : undefined\r\n   allowed: undefined\r\n\r\ndebug(development:0x7d4ff2d8...)> i\r\n\r\nTransaction halted with a RUNTIME ERROR.\r\n\r\nThis is likely due to an intentional halting expression, like assert(), require() or revert(). It can also be due to out-of-gas exceptions. Please inspect your transaction parameters and contract code to determine the meaning of this error.\r\nMacBook:myproject jack$ \r\n\r\n",
  "closed_by": {
    "login": "jackoelv",
    "id": 10348409,
    "node_id": "MDQ6VXNlcjEwMzQ4NDA5",
    "avatar_url": "https://avatars.githubusercontent.com/u/10348409?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/jackoelv",
    "html_url": "https://github.com/jackoelv",
    "followers_url": "https://api.github.com/users/jackoelv/followers",
    "following_url": "https://api.github.com/users/jackoelv/following{/other_user}",
    "gists_url": "https://api.github.com/users/jackoelv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/jackoelv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/jackoelv/subscriptions",
    "organizations_url": "https://api.github.com/users/jackoelv/orgs",
    "repos_url": "https://api.github.com/users/jackoelv/repos",
    "events_url": "https://api.github.com/users/jackoelv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/jackoelv/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/922/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/922/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/385631696",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/922#issuecomment-385631696",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/922",
    "id": 385631696,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTYzMTY5Ng==",
    "user": {
      "login": "jackoelv",
      "id": 10348409,
      "node_id": "MDQ6VXNlcjEwMzQ4NDA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/10348409?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jackoelv",
      "html_url": "https://github.com/jackoelv",
      "followers_url": "https://api.github.com/users/jackoelv/followers",
      "following_url": "https://api.github.com/users/jackoelv/following{/other_user}",
      "gists_url": "https://api.github.com/users/jackoelv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jackoelv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jackoelv/subscriptions",
      "organizations_url": "https://api.github.com/users/jackoelv/orgs",
      "repos_url": "https://api.github.com/users/jackoelv/repos",
      "events_url": "https://api.github.com/users/jackoelv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jackoelv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-01T09:16:41Z",
    "updated_at": "2018-05-01T09:16:41Z",
    "author_association": "NONE",
    "body": "I think i got answer, should Call \r\n    await this.token.approve(this.crowdsale.address, tokenAllowance, { from: tokenWallet });\r\nCall the aprove function manually in truffle console.\r\nwhen back home,try it, check if it can work.\r\n\r\nthanks",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/385631696/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/385690740",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/922#issuecomment-385690740",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/922",
    "id": 385690740,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTY5MDc0MA==",
    "user": {
      "login": "jackoelv",
      "id": 10348409,
      "node_id": "MDQ6VXNlcjEwMzQ4NDA5",
      "avatar_url": "https://avatars.githubusercontent.com/u/10348409?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jackoelv",
      "html_url": "https://github.com/jackoelv",
      "followers_url": "https://api.github.com/users/jackoelv/followers",
      "following_url": "https://api.github.com/users/jackoelv/following{/other_user}",
      "gists_url": "https://api.github.com/users/jackoelv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jackoelv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jackoelv/subscriptions",
      "organizations_url": "https://api.github.com/users/jackoelv/orgs",
      "repos_url": "https://api.github.com/users/jackoelv/repos",
      "events_url": "https://api.github.com/users/jackoelv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jackoelv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-01T14:54:10Z",
    "updated_at": "2018-05-01T14:54:10Z",
    "author_association": "NONE",
    "body": "problem solved.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/385690740/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
