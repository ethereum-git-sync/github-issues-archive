{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2980",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2980/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2980/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2980/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2980",
  "id": 1059198752,
  "node_id": "I_kwDOA9tCBs4_Ihcg",
  "number": 2980,
  "title": "Add CANCEL_ROLE to TimelockController",
  "user": {
    "login": "cygnusv",
    "id": 2564234,
    "node_id": "MDQ6VXNlcjI1NjQyMzQ=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2564234?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/cygnusv",
    "html_url": "https://github.com/cygnusv",
    "followers_url": "https://api.github.com/users/cygnusv/followers",
    "following_url": "https://api.github.com/users/cygnusv/following{/other_user}",
    "gists_url": "https://api.github.com/users/cygnusv/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/cygnusv/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/cygnusv/subscriptions",
    "organizations_url": "https://api.github.com/users/cygnusv/orgs",
    "repos_url": "https://api.github.com/users/cygnusv/repos",
    "events_url": "https://api.github.com/users/cygnusv/events{/privacy}",
    "received_events_url": "https://api.github.com/users/cygnusv/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2021-11-20T18:06:35Z",
  "updated_at": "2022-03-08T21:28:20Z",
  "closed_at": "2022-03-08T21:28:20Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "**üßê Motivation**\r\nIn the forthcoming Threshold Network DAO, there's a council with veto power over proposals. The only way to allow this with current implementation of `TimelockController` would be to grant the council the `PROPOSER_ROLE`, but this council shouldn't be able to make proposals, according to our governance design. We need something like a `CANCEL_ROLE` that's different from `PROPOSER_ROLE` and `EXECUTION_ROLE`. This feature could also be a solution for the [\"Proposer fight\" problem](https://docs.openzeppelin.com/contracts/4.x/api/governance#timelock-proposer) that's discussed in the documentation.\r\n\r\n**Discussion**\r\nI wanted to do this by creating a contract that inherits from `TimelockController`, but since its variables and functions are marked as private it's being difficult. In particular, we need to further restrict the cancel operation to a different role than proposers, but the modifier in `cancel()` forces us to override it and re-implement it, and we encounter the problem of `_timestamps` being private.\r\n\r\nAnyway, if you find this interesting, I'd love to help, since I'm working on that anyway.",
  "closed_by": {
    "login": "frangio",
    "id": 481465,
    "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/frangio",
    "html_url": "https://github.com/frangio",
    "followers_url": "https://api.github.com/users/frangio/followers",
    "following_url": "https://api.github.com/users/frangio/following{/other_user}",
    "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
    "organizations_url": "https://api.github.com/users/frangio/orgs",
    "repos_url": "https://api.github.com/users/frangio/repos",
    "events_url": "https://api.github.com/users/frangio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/frangio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2980/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2980/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/974695716",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2980#issuecomment-974695716",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2980",
    "id": 974695716,
    "node_id": "IC_kwDOA9tCBs46GK0k",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-20T18:56:22Z",
    "updated_at": "2021-11-20T18:56:22Z",
    "author_association": "COLLABORATOR",
    "body": "Hello @cygnusv \r\n\r\nThis is definitely an interesting discussion, but changes like that will take time to make. In the meantime, I believe you could fix that by having an Ownable or AccessControl contract, that would be a proposer for the timelock, and which only function (on top of the Ownable or AccessControl) would be a cancel forwarder.\r\n\r\nThat way your council could cancel through this relayer, but not propose.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/974695716/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/980061657",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2980#issuecomment-980061657",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2980",
    "id": 980061657,
    "node_id": "IC_kwDOA9tCBs46ao3Z",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-26T15:33:23Z",
    "updated_at": "2021-11-26T15:37:07Z",
    "author_association": "MEMBER",
    "body": "We can add a `_cancel` function without access control check so you can define the function with a new role.\r\n\r\nIn the meantime, there is a somewhat hacky workaround you can implement as an override:\r\n\r\n```solidity\r\nfunction cancel(bytes32 id) public virtual override onlyRole(CANCEL_ROLE) {\r\n    bool isProposer = hasRole(PROPOSER_ROLE, msg.sender);\r\n    if (!isProposer) _grantRole(PROPOSER_ROLE, msg.sender);\r\n    super.cancel(id);\r\n    if (!isProposer) _revokeRole(PROPOSER_ROLE, msg.sender);\r\n}\r\n```\r\n\r\n(Note: This requires the latest version of OZ Contracts for the internal grant and revoke functions.)",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/980061657/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/980107866",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2980#issuecomment-980107866",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2980",
    "id": 980107866,
    "node_id": "IC_kwDOA9tCBs46a0Ja",
    "user": {
      "login": "cygnusv",
      "id": 2564234,
      "node_id": "MDQ6VXNlcjI1NjQyMzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2564234?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cygnusv",
      "html_url": "https://github.com/cygnusv",
      "followers_url": "https://api.github.com/users/cygnusv/followers",
      "following_url": "https://api.github.com/users/cygnusv/following{/other_user}",
      "gists_url": "https://api.github.com/users/cygnusv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cygnusv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cygnusv/subscriptions",
      "organizations_url": "https://api.github.com/users/cygnusv/orgs",
      "repos_url": "https://api.github.com/users/cygnusv/repos",
      "events_url": "https://api.github.com/users/cygnusv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cygnusv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-26T16:29:52Z",
    "updated_at": "2021-11-26T16:29:52Z",
    "author_association": "NONE",
    "body": "Thanks @frangio and @Amxx ! \r\n\r\nAfter playing around with the idea of a cancel proxy I realized that we actually want the cancel functionality to happen at the Governor level, and since it's already a proposer in the timelock, it can cancel. We then just add an access control check in `Governor.cancel()` ",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/980107866/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1026141345",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2980#issuecomment-1026141345",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2980",
    "id": 1026141345,
    "node_id": "IC_kwDOA9tCBs49Kayh",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-01-31T19:42:09Z",
    "updated_at": "2022-01-31T19:42:09Z",
    "author_association": "MEMBER",
    "body": "@cygnusv We've been thinking about adding a cancel role, how did you solve this in your governor? Who has the ability to cancel?",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1026141345/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1027042408",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2980#issuecomment-1027042408",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2980",
    "id": 1027042408,
    "node_id": "IC_kwDOA9tCBs49N2xo",
    "user": {
      "login": "cygnusv",
      "id": 2564234,
      "node_id": "MDQ6VXNlcjI1NjQyMzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2564234?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cygnusv",
      "html_url": "https://github.com/cygnusv",
      "followers_url": "https://api.github.com/users/cygnusv/followers",
      "following_url": "https://api.github.com/users/cygnusv/following{/other_user}",
      "gists_url": "https://api.github.com/users/cygnusv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cygnusv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cygnusv/subscriptions",
      "organizations_url": "https://api.github.com/users/cygnusv/orgs",
      "repos_url": "https://api.github.com/users/cygnusv/repos",
      "events_url": "https://api.github.com/users/cygnusv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cygnusv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-01T16:37:52Z",
    "updated_at": "2022-02-01T16:37:52Z",
    "author_association": "NONE",
    "body": "@frangio We decided to add a cancel role in the Governor contract and implement `cancel()` there. Since all proposers for the Timelock can cancel, and in our setting only the Governor contract is a proposer, anyone with the cancel role can cancel in the timelock via the Governor contract. \r\nSee https://github.com/threshold-network/solidity-contracts/commit/9002bdb33060c74c55d9648dbf5a8b2bcb732d34#diff-9762b5e3ad775b50a9ae4df345a244e7a6d73f45103be32b229cc8ae2b032686",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1027042408/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1027252865",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2980#issuecomment-1027252865",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2980",
    "id": 1027252865,
    "node_id": "IC_kwDOA9tCBs49OqKB",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-01T20:23:00Z",
    "updated_at": "2022-02-01T20:23:00Z",
    "author_association": "MEMBER",
    "body": "I see. And in practice who has veto power?",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1027252865/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1027359099",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2980#issuecomment-1027359099",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2980",
    "id": 1027359099,
    "node_id": "IC_kwDOA9tCBs49PEF7",
    "user": {
      "login": "cygnusv",
      "id": 2564234,
      "node_id": "MDQ6VXNlcjI1NjQyMzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2564234?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cygnusv",
      "html_url": "https://github.com/cygnusv",
      "followers_url": "https://api.github.com/users/cygnusv/followers",
      "following_url": "https://api.github.com/users/cygnusv/following{/other_user}",
      "gists_url": "https://api.github.com/users/cygnusv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cygnusv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cygnusv/subscriptions",
      "organizations_url": "https://api.github.com/users/cygnusv/orgs",
      "repos_url": "https://api.github.com/users/cygnusv/repos",
      "events_url": "https://api.github.com/users/cygnusv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cygnusv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-02-01T22:42:11Z",
    "updated_at": "2022-02-01T22:42:11Z",
    "author_association": "NONE",
    "body": "In the Threshold DAO, it was decided that a council multisig has veto power in case there's a dangerous proposal (see https://forum.threshold.network/t/threshold-network-dao-proposal-v2/57)",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1027359099/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
