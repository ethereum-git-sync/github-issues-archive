{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/4316",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/4316/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/4316/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/4316/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/4316",
  "id": 1742084600,
  "node_id": "I_kwDOA9tCBs5n1hn4",
  "number": 4316,
  "title": "Add `state` getter in TimelockController using `OperationState` enum",
  "user": {
    "login": "ernestognw",
    "id": 33379285,
    "node_id": "MDQ6VXNlcjMzMzc5Mjg1",
    "avatar_url": "https://avatars.githubusercontent.com/u/33379285?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/ernestognw",
    "html_url": "https://github.com/ernestognw",
    "followers_url": "https://api.github.com/users/ernestognw/followers",
    "following_url": "https://api.github.com/users/ernestognw/following{/other_user}",
    "gists_url": "https://api.github.com/users/ernestognw/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/ernestognw/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/ernestognw/subscriptions",
    "organizations_url": "https://api.github.com/users/ernestognw/orgs",
    "repos_url": "https://api.github.com/users/ernestognw/repos",
    "events_url": "https://api.github.com/users/ernestognw/events{/privacy}",
    "received_events_url": "https://api.github.com/users/ernestognw/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [
    {
      "id": 503650860,
      "node_id": "MDU6TGFiZWw1MDM2NTA4NjA=",
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/labels/feature",
      "name": "feature",
      "color": "b9db64",
      "default": false,
      "description": "New contracts, functions, or helpers."
    },
    {
      "id": 1000230196,
      "node_id": "MDU6TGFiZWwxMDAwMjMwMTk2",
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/labels/breaking%20change",
      "name": "breaking change",
      "color": "b60205",
      "default": false,
      "description": "Changes that break backwards compatibility of the public API."
    }
  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/milestones/11",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/milestone/11",
    "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/milestones/11/labels",
    "id": 7990184,
    "node_id": "MI_kwDOA9tCBs4Aeeuo",
    "number": 11,
    "title": "5.0",
    "description": null,
    "creator": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "open_issues": 31,
    "closed_issues": 47,
    "state": "open",
    "created_at": "2022-05-17T19:52:44Z",
    "updated_at": "2023-07-04T18:23:47Z",
    "due_on": null,
    "closed_at": null
  },
  "comments": 6,
  "created_at": "2023-06-05T16:00:38Z",
  "updated_at": "2023-07-04T18:23:47Z",
  "closed_at": "2023-07-04T18:23:46Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "### Description\r\n\r\nWe introduced an enum of `OperationState`s for custom errors in #4261. However, it feels weird that such enum is only used for custom errors.\r\n\r\nWe should use the same enum for retrieving the state. We might also want to replace the state getters with this new `state(bytes32 id)` getter.",
  "closed_by": {
    "login": "frangio",
    "id": 481465,
    "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/frangio",
    "html_url": "https://github.com/frangio",
    "followers_url": "https://api.github.com/users/frangio/followers",
    "following_url": "https://api.github.com/users/frangio/following{/other_user}",
    "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
    "organizations_url": "https://api.github.com/users/frangio/orgs",
    "repos_url": "https://api.github.com/users/frangio/repos",
    "events_url": "https://api.github.com/users/frangio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/frangio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/4316/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/4316/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1594345585",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/4316#issuecomment-1594345585",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/4316",
    "id": 1594345585,
    "node_id": "IC_kwDOA9tCBs5fB8hx",
    "user": {
      "login": "clauBv23",
      "id": 26546018,
      "node_id": "MDQ6VXNlcjI2NTQ2MDE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/26546018?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/clauBv23",
      "html_url": "https://github.com/clauBv23",
      "followers_url": "https://api.github.com/users/clauBv23/followers",
      "following_url": "https://api.github.com/users/clauBv23/following{/other_user}",
      "gists_url": "https://api.github.com/users/clauBv23/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/clauBv23/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/clauBv23/subscriptions",
      "organizations_url": "https://api.github.com/users/clauBv23/orgs",
      "repos_url": "https://api.github.com/users/clauBv23/repos",
      "events_url": "https://api.github.com/users/clauBv23/events{/privacy}",
      "received_events_url": "https://api.github.com/users/clauBv23/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-16T08:50:48Z",
    "updated_at": "2023-06-16T09:03:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi there, \r\n\r\nI have been taking a look at this task and, have some concerns regarding it.\r\nCurrently, the states are not restrictive, I mean, an operation could be in both the pending and ready state. Due to that, there are some places where this is taken as an advantage to check the minimal needed restrictions like in https://github.com/OpenZeppelin/openzeppelin-contracts/blob/cd48b3eab380254b08d7893a5a7bf568a33c5259/contracts/governance/extensions/GovernorTimelockControl.sol#L65-L66 where with a single check covers the pending and the ready state.\r\n\r\nA solution for that case using a state-getter could be to check if the operation is either pending or ready like is being done in the proposed PR, but by doing it more checks will be needed to do the same. \r\nAlso to check a specific operation state, will be needed to ensure it is not in other ones (to know if is ready should check if is not pending or vice-versa).\r\n\r\nSo in general, Even though I agree it will be more descriptive and clean, it will likely increase the amount of checks needed to do the same that is being done at this time.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1594345585/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1594383181",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/4316#issuecomment-1594383181",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/4316",
    "id": 1594383181,
    "node_id": "IC_kwDOA9tCBs5fCFtN",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-16T09:19:54Z",
    "updated_at": "2023-06-16T09:20:13Z",
    "author_association": "COLLABORATOR",
    "body": "We could rename \"Pending\" into \"Waiting\" in the enum, and consider that `Pending == Waiting || Ready`. We would keepn the isOperationPending getter for compatibility (governor uses that)\r\n\r\n@ernestognw WDYT?",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1594383181/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1596738342",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/4316#issuecomment-1596738342",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/4316",
    "id": 1596738342,
    "node_id": "IC_kwDOA9tCBs5fLEsm",
    "user": {
      "login": "clauBv23",
      "id": 26546018,
      "node_id": "MDQ6VXNlcjI2NTQ2MDE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/26546018?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/clauBv23",
      "html_url": "https://github.com/clauBv23",
      "followers_url": "https://api.github.com/users/clauBv23/followers",
      "following_url": "https://api.github.com/users/clauBv23/following{/other_user}",
      "gists_url": "https://api.github.com/users/clauBv23/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/clauBv23/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/clauBv23/subscriptions",
      "organizations_url": "https://api.github.com/users/clauBv23/orgs",
      "repos_url": "https://api.github.com/users/clauBv23/repos",
      "events_url": "https://api.github.com/users/clauBv23/events{/privacy}",
      "received_events_url": "https://api.github.com/users/clauBv23/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-19T08:25:41Z",
    "updated_at": "2023-06-19T08:33:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "That will definitely work, but due to \"Ready\" and \"Pending\" being opposite it could sound contradictory. Maybe going with `Active == Pending || Ready`?",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1596738342/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1596796796",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/4316#issuecomment-1596796796",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/4316",
    "id": 1596796796,
    "node_id": "IC_kwDOA9tCBs5fLS98",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-19T09:03:50Z",
    "updated_at": "2023-06-19T09:03:50Z",
    "author_association": "COLLABORATOR",
    "body": "`Active == Pending || Ready` sounds great, but then what would `isOperationPending` return ?\r\n\r\nRemember that the governor does a `isOperationPending` lookup to check is the operation was queued. With the change you propose the governor should look if the operation is active... \r\n\r\nSo again, either `isOperationPending` returns true is the operation is Active (and that doesn't sound right) ... or the govenor does an `isOperationActive` on the timelock controller ... but that reverts for old instances of the timelock\r\n\r\nan option would be for the governor to do\r\n```solidity\r\nfunction isOperationActiveWithFallback(bytes32 queueId) private view returns (bool) {\r\n  try _timelock.isOperationActive(queueId) returns (bool isActive) {\r\n    return isActive;\r\n  } catch {\r\n    // assume old governor\r\n    return _timelock.isOperationPending(queueId);\r\n  }\r\n}\r\n```\r\n\r\nBefore any decision is made, we should discuss that with the team",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1596796796/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1596827946",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/4316#issuecomment-1596827946",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/4316",
    "id": 1596827946,
    "node_id": "IC_kwDOA9tCBs5fLakq",
    "user": {
      "login": "clauBv23",
      "id": 26546018,
      "node_id": "MDQ6VXNlcjI2NTQ2MDE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/26546018?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/clauBv23",
      "html_url": "https://github.com/clauBv23",
      "followers_url": "https://api.github.com/users/clauBv23/followers",
      "following_url": "https://api.github.com/users/clauBv23/following{/other_user}",
      "gists_url": "https://api.github.com/users/clauBv23/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/clauBv23/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/clauBv23/subscriptions",
      "organizations_url": "https://api.github.com/users/clauBv23/orgs",
      "repos_url": "https://api.github.com/users/clauBv23/repos",
      "events_url": "https://api.github.com/users/clauBv23/events{/privacy}",
      "received_events_url": "https://api.github.com/users/clauBv23/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-19T09:22:41Z",
    "updated_at": "2023-06-19T09:22:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yeap, you are right, changing to `Active` will break the previous instances, and even though it could be solved as you mentioned, it might not be worth it. And `pending` being `ready` has worked so far.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1596827946/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1603673460",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/4316#issuecomment-1603673460",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/4316",
    "id": 1603673460,
    "node_id": "IC_kwDOA9tCBs5flh10",
    "user": {
      "login": "RenanSouza2",
      "id": 28443115,
      "node_id": "MDQ6VXNlcjI4NDQzMTE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/28443115?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/RenanSouza2",
      "html_url": "https://github.com/RenanSouza2",
      "followers_url": "https://api.github.com/users/RenanSouza2/followers",
      "following_url": "https://api.github.com/users/RenanSouza2/following{/other_user}",
      "gists_url": "https://api.github.com/users/RenanSouza2/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/RenanSouza2/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/RenanSouza2/subscriptions",
      "organizations_url": "https://api.github.com/users/RenanSouza2/orgs",
      "repos_url": "https://api.github.com/users/RenanSouza2/repos",
      "events_url": "https://api.github.com/users/RenanSouza2/events{/privacy}",
      "received_events_url": "https://api.github.com/users/RenanSouza2/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2023-06-23T04:45:20Z",
    "updated_at": "2023-06-23T04:45:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "The current documentation says this\r\n```\r\n** *Unset:* An operation that is not part of the timelock mechanism.\r\n** *Pending:* An operation that has been scheduled, before the timer expires.\r\n** *Ready:* An operation that has been scheduled, after the timer expires.\r\n** *Done:* An operation that has been executed.\r\n```\r\n\r\nSo whatever is the final decision on the names I will update the documents as wel",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1603673460/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
