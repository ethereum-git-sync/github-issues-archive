{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/1882",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/1882/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/1882/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/1882/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/1882",
  "id": 480452950,
  "node_id": "MDU6SXNzdWU0ODA0NTI5NTA=",
  "number": 1882,
  "title": "ERC20Mintable contract application returns a strange wrong number.",
  "user": {
    "login": "northeusunshine",
    "id": 40818211,
    "node_id": "MDQ6VXNlcjQwODE4MjEx",
    "avatar_url": "https://avatars.githubusercontent.com/u/40818211?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/northeusunshine",
    "html_url": "https://github.com/northeusunshine",
    "followers_url": "https://api.github.com/users/northeusunshine/followers",
    "following_url": "https://api.github.com/users/northeusunshine/following{/other_user}",
    "gists_url": "https://api.github.com/users/northeusunshine/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/northeusunshine/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/northeusunshine/subscriptions",
    "organizations_url": "https://api.github.com/users/northeusunshine/orgs",
    "repos_url": "https://api.github.com/users/northeusunshine/repos",
    "events_url": "https://api.github.com/users/northeusunshine/events{/privacy}",
    "received_events_url": "https://api.github.com/users/northeusunshine/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2019-08-14T02:36:41Z",
  "updated_at": "2019-08-14T05:51:20Z",
  "closed_at": "2019-08-14T04:33:23Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "Based on OpenZeppilin ERC20Mintable contract, I add a function to limit maximum minterable token amount.  I add a static variable `uint256 MaxSupply` to record and want to make `MaxSupply`  accessiable to  contract owner only.\r\nBut when I use `onlyMinter` modifier, It retruns a long strange number,like below:\r\n```\r\nToken Balance : 1000000000000000000000\r\nToken current supply : 1000000000000000000000\r\nToken MaxSupply: 3963877391197344453575983046348115674221700746820753546331534351508065746944\r\n```\r\nHowever, when remove `onlyMinter` modifier, the result is correct as expectation:\r\n```\r\nToken Balance : 1000000000000000000000\r\nToken current supply : 1000000000000000000000\r\nToken MaxSupply: 1100000000000000000000\r\n```\r\n\r\n**💻 Environment**\r\nThe OpenZeppelin version should be latest. I got it by run:\r\n`git clone https://github.com/OpenZeppelin/openzeppelin-contracts.git`\r\nand copy all the used .sol file to a folder.\r\n\r\nthe solidity version is `solc@0.5.9`, **higer** than declared version in  solidity source code.\r\n\r\n**📝 Details**\r\n\r\nI call the contract using the following code:\r\n```\r\nvar tokenContractAddress = \"0x*****************\";\r\nvar myAddress = \"0x******************\";\r\nvar async = require('asyncawait/async');\r\nvar await = require('asyncawait/await');\r\nconst Web3 = require('web3');\r\nconst web3 = new Web3('http://localhost:8545');\r\nconst main = async () => {\r\n    var abi = JSON.parse(fs.readFileSync('/root/Mintable/abi.json', 'utf-8'));\r\n    const contract = new web3.eth.Contract(abi, tokenContractAddress);\r\n    await web3.eth.personal.unlockAccount(myAddress, \"******\", 600);\r\n\r\n    var balance_from = await contract.methods.balanceOf(myAddress).call();\r\n    var totalsupply = await contract.methods.totalSupply().call();\r\n    var MaxSupply = await contract.methods.ViewMaxSupply().call();\r\n\r\n    console.log(`Token Balance : ${balance_from}`);\r\n    console.log(`Token current supply : ${totalsupply}`);\r\n    console.log(`Token MaxSupply: ${MaxSupply}`);\r\n};\r\nmain();\r\n```\r\n\r\n**🔢 Code to reproduce bug**\r\n```\r\npragma solidity ^0.5.0;\r\nimport \"./ERC20.sol\";\r\nimport \"./MinterRole.sol\";\r\ncontract ERC20MintableMaxSupply is ERC20, MinterRole {\r\n    string public name;\r\n    string public symbol;\r\n    uint8 public decimals;\r\n    uint256 MaxMintAmount;//max minerable amount after first issue\r\n    uint256 MaxSupply;//initial issue amount plus MaxMintAmount\r\n\r\n    constructor(\r\n        string memory _name,\r\n        string memory _symbol,\r\n        uint8 _decimals,\r\n        uint256  _initSupply,\r\n        uint256  _MaxMintAmount\r\n        ) public {\r\n        name = _name;\r\n        symbol = _symbol;\r\n        decimals = _decimals;\r\n        MaxMintAmount = _MaxMintAmount;\r\n        MaxSupply = _initSupply + _MaxMintAmount;\r\n        _mint(msg.sender, _initSupply  * (10 ** uint256(decimals)));\r\n    }\r\n    function mint(address account,uint256 MintAmount) public onlyMinter returns (bool) {\r\n      uint256 curSupply;\r\n      curSupply = totalSupply() + MintAmount * (10 ** uint256(decimals));\r\n      require( curSupply <= ( MaxSupply * (10 ** uint256(decimals)) ), \"error: not permitted to exceed maximun supply.\");\r\n      _mint(account, MintAmount * (10 ** uint256(decimals)));\r\n      return true;\r\n    }\r\n    function ViewMaxSupply() public view returns (uint256) {\r\n     return ( MaxSupply * (10 ** uint256(decimals)) );\r\n    }\r\n}\r\n```\r\n",
  "closed_by": {
    "login": "abcoathup",
    "id": 28278242,
    "node_id": "MDQ6VXNlcjI4Mjc4MjQy",
    "avatar_url": "https://avatars.githubusercontent.com/u/28278242?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/abcoathup",
    "html_url": "https://github.com/abcoathup",
    "followers_url": "https://api.github.com/users/abcoathup/followers",
    "following_url": "https://api.github.com/users/abcoathup/following{/other_user}",
    "gists_url": "https://api.github.com/users/abcoathup/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/abcoathup/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/abcoathup/subscriptions",
    "organizations_url": "https://api.github.com/users/abcoathup/orgs",
    "repos_url": "https://api.github.com/users/abcoathup/repos",
    "events_url": "https://api.github.com/users/abcoathup/events{/privacy}",
    "received_events_url": "https://api.github.com/users/abcoathup/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/1882/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/1882/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/521086418",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/1882#issuecomment-521086418",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/1882",
    "id": 521086418,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMTA4NjQxOA==",
    "user": {
      "login": "abcoathup",
      "id": 28278242,
      "node_id": "MDQ6VXNlcjI4Mjc4MjQy",
      "avatar_url": "https://avatars.githubusercontent.com/u/28278242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/abcoathup",
      "html_url": "https://github.com/abcoathup",
      "followers_url": "https://api.github.com/users/abcoathup/followers",
      "following_url": "https://api.github.com/users/abcoathup/following{/other_user}",
      "gists_url": "https://api.github.com/users/abcoathup/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/abcoathup/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/abcoathup/subscriptions",
      "organizations_url": "https://api.github.com/users/abcoathup/orgs",
      "repos_url": "https://api.github.com/users/abcoathup/repos",
      "events_url": "https://api.github.com/users/abcoathup/events{/privacy}",
      "received_events_url": "https://api.github.com/users/abcoathup/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-14T03:16:26Z",
    "updated_at": "2019-08-14T03:16:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi @northeusunshine \r\n\r\nTo have a mintable token with a capped (maximum) supply you can use OpenZeppelin ERC20Capped https://docs.openzeppelin.com/contracts/2.x/api/token/erc20#ERC20Capped\r\n\r\nA simple token example using this:\r\n```solidity\r\npragma solidity ^0.5.0;\r\n\r\nimport \"@openzeppelin/contracts/token/ERC20/ERC20Capped.sol\";\r\nimport \"@openzeppelin/contracts/token/ERC20/ERC20Detailed.sol\";\r\n\r\ncontract MyToken is ERC20Capped, ERC20Detailed {\r\n    constructor ()\r\n    public\r\n    ERC20Capped(1000000*10**18)\r\n    ERC20Detailed(\"My Token\", \"TKN\", 18)\r\n    {\r\n        // solhint-disable-previous-line no-empty-blocks\r\n    }\r\n}\r\n```\r\n\r\nFor support questions it is best to ask in the OpenZeppelin Community Forum: https://forum.openzeppelin.com/ so that the entire community can answer your question.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/521086418/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/521089627",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/1882#issuecomment-521089627",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/1882",
    "id": 521089627,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMTA4OTYyNw==",
    "user": {
      "login": "northeusunshine",
      "id": 40818211,
      "node_id": "MDQ6VXNlcjQwODE4MjEx",
      "avatar_url": "https://avatars.githubusercontent.com/u/40818211?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/northeusunshine",
      "html_url": "https://github.com/northeusunshine",
      "followers_url": "https://api.github.com/users/northeusunshine/followers",
      "following_url": "https://api.github.com/users/northeusunshine/following{/other_user}",
      "gists_url": "https://api.github.com/users/northeusunshine/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/northeusunshine/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/northeusunshine/subscriptions",
      "organizations_url": "https://api.github.com/users/northeusunshine/orgs",
      "repos_url": "https://api.github.com/users/northeusunshine/repos",
      "events_url": "https://api.github.com/users/northeusunshine/events{/privacy}",
      "received_events_url": "https://api.github.com/users/northeusunshine/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-14T03:37:15Z",
    "updated_at": "2019-08-14T03:37:15Z",
    "author_association": "NONE",
    "body": "Do you have advice about how to fix the error? I have no idea why the modifer lead to the error.\r\nI will try the ERC20Capped.Thanks.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/521089627/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/521091718",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/1882#issuecomment-521091718",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/1882",
    "id": 521091718,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMTA5MTcxOA==",
    "user": {
      "login": "abcoathup",
      "id": 28278242,
      "node_id": "MDQ6VXNlcjI4Mjc4MjQy",
      "avatar_url": "https://avatars.githubusercontent.com/u/28278242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/abcoathup",
      "html_url": "https://github.com/abcoathup",
      "followers_url": "https://api.github.com/users/abcoathup/followers",
      "following_url": "https://api.github.com/users/abcoathup/following{/other_user}",
      "gists_url": "https://api.github.com/users/abcoathup/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/abcoathup/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/abcoathup/subscriptions",
      "organizations_url": "https://api.github.com/users/abcoathup/orgs",
      "repos_url": "https://api.github.com/users/abcoathup/repos",
      "events_url": "https://api.github.com/users/abcoathup/events{/privacy}",
      "received_events_url": "https://api.github.com/users/abcoathup/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-14T03:50:56Z",
    "updated_at": "2019-08-14T05:33:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "I reproduced the error when adding `onlyMinter` modifier to the view function and called from a non minter account.\r\n```solidity\r\nfunction ViewMaxSupply() public view onlyMinter returns (uint256) {\r\n     return ( MaxSupply * (10 ** uint256(decimals)) );\r\n}\r\n```\r\nThis is an issue with web3:\r\nhttps://github.com/ethereum/web3.js/issues/1903\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/521091718/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/521097911",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/1882#issuecomment-521097911",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/1882",
    "id": 521097911,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyMTA5NzkxMQ==",
    "user": {
      "login": "abcoathup",
      "id": 28278242,
      "node_id": "MDQ6VXNlcjI4Mjc4MjQy",
      "avatar_url": "https://avatars.githubusercontent.com/u/28278242?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/abcoathup",
      "html_url": "https://github.com/abcoathup",
      "followers_url": "https://api.github.com/users/abcoathup/followers",
      "following_url": "https://api.github.com/users/abcoathup/following{/other_user}",
      "gists_url": "https://api.github.com/users/abcoathup/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/abcoathup/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/abcoathup/subscriptions",
      "organizations_url": "https://api.github.com/users/abcoathup/orgs",
      "repos_url": "https://api.github.com/users/abcoathup/repos",
      "events_url": "https://api.github.com/users/abcoathup/events{/privacy}",
      "received_events_url": "https://api.github.com/users/abcoathup/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-14T04:33:23Z",
    "updated_at": "2019-08-14T05:51:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for posting in the forum.  \r\nhttps://forum.openzeppelin.com/t/erc20mintable-contract-application-returns-a-strange-wrong-number/1178\r\n\r\nI will close this Issue here as now being discussed in the forum.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/521097911/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
