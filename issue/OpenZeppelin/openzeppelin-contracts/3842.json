{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3842",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3842/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3842/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3842/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3842",
  "id": 1471681690,
  "node_id": "I_kwDOA9tCBs5XuBSa",
  "number": 3842,
  "title": "Upgrade `TimelockController` to use `AccessControlEnumerable` ",
  "user": {
    "login": "DeFiFoFum",
    "id": 78645267,
    "node_id": "MDQ6VXNlcjc4NjQ1MjY3",
    "avatar_url": "https://avatars.githubusercontent.com/u/78645267?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/DeFiFoFum",
    "html_url": "https://github.com/DeFiFoFum",
    "followers_url": "https://api.github.com/users/DeFiFoFum/followers",
    "following_url": "https://api.github.com/users/DeFiFoFum/following{/other_user}",
    "gists_url": "https://api.github.com/users/DeFiFoFum/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/DeFiFoFum/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/DeFiFoFum/subscriptions",
    "organizations_url": "https://api.github.com/users/DeFiFoFum/orgs",
    "repos_url": "https://api.github.com/users/DeFiFoFum/repos",
    "events_url": "https://api.github.com/users/DeFiFoFum/events{/privacy}",
    "received_events_url": "https://api.github.com/users/DeFiFoFum/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-12-01T17:23:07Z",
  "updated_at": "2023-02-22T15:16:39Z",
  "closed_at": "2022-12-05T17:41:54Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "**üßê Motivation**\r\n<!-- Is your feature request related to a specific problem? Is it just a crazy idea? Tell us about it! -->\r\n\r\nThe current implementation of the [TimelockController](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/24d1bb668a1152528a6e6d71c2e285d227ed19d9/contracts/governance/TimelockController.sol#L6) uses `AccessControl` to manage roles. \r\n\r\nAs Timelock contracts are extremely role sensitive, this makes reviewing and verifying the roles of a particular Timelock difficult by needing to go back through the events and verify the role setup.\r\n\r\n\r\n**üìù Details**\r\n<!-- Please describe your feature request in detail. -->\r\n(_https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3842#issuecomment-1335956232 provides a usable extension if needed_)\r\n~~- [ ] Upgrade the `AccessControl` import with [AccessControlEnumerable](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/AccessControlEnumerable.sol) to make these Timelock contracts more user friendly.~~\r\n\r\n<!-- Make sure that you have reviewed the OpenZeppelin Contracts Contributor Guidelines. -->\r\n<!-- https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/CONTRIBUTING.md -->\r\n",
  "closed_by": {
    "login": "DeFiFoFum",
    "id": 78645267,
    "node_id": "MDQ6VXNlcjc4NjQ1MjY3",
    "avatar_url": "https://avatars.githubusercontent.com/u/78645267?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/DeFiFoFum",
    "html_url": "https://github.com/DeFiFoFum",
    "followers_url": "https://api.github.com/users/DeFiFoFum/followers",
    "following_url": "https://api.github.com/users/DeFiFoFum/following{/other_user}",
    "gists_url": "https://api.github.com/users/DeFiFoFum/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/DeFiFoFum/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/DeFiFoFum/subscriptions",
    "organizations_url": "https://api.github.com/users/DeFiFoFum/orgs",
    "repos_url": "https://api.github.com/users/DeFiFoFum/repos",
    "events_url": "https://api.github.com/users/DeFiFoFum/events{/privacy}",
    "received_events_url": "https://api.github.com/users/DeFiFoFum/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3842/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3842/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1335956232",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3842#issuecomment-1335956232",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3842",
    "id": 1335956232,
    "node_id": "IC_kwDOA9tCBs5PoRMI",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-02T23:25:29Z",
    "updated_at": "2022-12-02T23:25:29Z",
    "author_association": "MEMBER",
    "body": "\r\n\r\n> reviewing and verifying the roles of a particular Timelock difficult\r\n\r\nWe have a prototype of an application to inspect roles at [Access Control Explorer](https://accesscontrol-explorer.netlify.app/). Feel free to use it.\r\n\r\n---\r\n\r\nWe are unlikely to use AccessControlEnumerable in TimelockController by default. But in case you're not aware you can make this change yourself fairly easily:\r\n\r\n```solidity\r\n// SPDX-License-Identifier: MIT\r\npragma solidity 0.8.17;\r\n\r\nimport \"@openzeppelin/contracts/governance/TimelockController.sol\";\r\nimport \"@openzeppelin/contracts/access/AccessControlEnumerable.sol\";\r\n\r\ncontract TimelockControllerEnumerable is TimelockController, AccessControlEnumerable {\r\n    constructor(uint256 minDelay, address[] memory proposers, address[] memory executors, address admin)\r\n        TimelockController(minDelay, proposers, executors, admin)\r\n    {}\r\n\r\n    function supportsInterface(bytes4 interfaceId) public view virtual override(TimelockController, AccessControlEnumerable) returns (bool) {\r\n        return super.supportsInterface(interfaceId);\r\n    }\r\n\r\n    function _revokeRole(bytes32 role, address account) internal virtual override(AccessControl, AccessControlEnumerable) {\r\n        return super._revokeRole(role, account);\r\n    }\r\n\r\n    function _grantRole(bytes32 role, address account) internal virtual override(AccessControl, AccessControlEnumerable) {\r\n        return super._grantRole(role, account);\r\n    }\r\n}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1335956232/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1337826974",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3842#issuecomment-1337826974",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3842",
    "id": 1337826974,
    "node_id": "IC_kwDOA9tCBs5PvZ6e",
    "user": {
      "login": "DeFiFoFum",
      "id": 78645267,
      "node_id": "MDQ6VXNlcjc4NjQ1MjY3",
      "avatar_url": "https://avatars.githubusercontent.com/u/78645267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DeFiFoFum",
      "html_url": "https://github.com/DeFiFoFum",
      "followers_url": "https://api.github.com/users/DeFiFoFum/followers",
      "following_url": "https://api.github.com/users/DeFiFoFum/following{/other_user}",
      "gists_url": "https://api.github.com/users/DeFiFoFum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DeFiFoFum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DeFiFoFum/subscriptions",
      "organizations_url": "https://api.github.com/users/DeFiFoFum/orgs",
      "repos_url": "https://api.github.com/users/DeFiFoFum/repos",
      "events_url": "https://api.github.com/users/DeFiFoFum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DeFiFoFum/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-05T17:41:53Z",
    "updated_at": "2022-12-05T17:41:53Z",
    "author_association": "NONE",
    "body": "> Access Control Explorer\r\n\r\nIncredible, thanks @frangio. \r\n\r\nBetween the **Access Control Explorer** and being able to extend the `TimelockController` this will certainly work for our needs. \r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1337826974/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1337855395",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3842#issuecomment-1337855395",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3842",
    "id": 1337855395,
    "node_id": "IC_kwDOA9tCBs5Pvg2j",
    "user": {
      "login": "DeFiFoFum",
      "id": 78645267,
      "node_id": "MDQ6VXNlcjc4NjQ1MjY3",
      "avatar_url": "https://avatars.githubusercontent.com/u/78645267?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DeFiFoFum",
      "html_url": "https://github.com/DeFiFoFum",
      "followers_url": "https://api.github.com/users/DeFiFoFum/followers",
      "following_url": "https://api.github.com/users/DeFiFoFum/following{/other_user}",
      "gists_url": "https://api.github.com/users/DeFiFoFum/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DeFiFoFum/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DeFiFoFum/subscriptions",
      "organizations_url": "https://api.github.com/users/DeFiFoFum/orgs",
      "repos_url": "https://api.github.com/users/DeFiFoFum/repos",
      "events_url": "https://api.github.com/users/DeFiFoFum/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DeFiFoFum/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-05T17:53:49Z",
    "updated_at": "2022-12-06T01:00:44Z",
    "author_association": "NONE",
    "body": "For reference, this is the code that I adapted from above which complies. \r\n\r\nedit: As per the comment below, this is for `@openzeppelin/contracts < v4.8.0`\r\n\r\n```solidity\r\n// SPDX-License-Identifier: MIT\r\npragma solidity 0.8.17;\r\n\r\nimport \"@openzeppelin/contracts/governance/TimelockController.sol\";\r\nimport \"@openzeppelin/contracts/access/AccessControlEnumerable.sol\";\r\n\r\ncontract TimelockControllerEnumerable is TimelockController, AccessControlEnumerable {\r\n    constructor(uint256 minDelay, address[] memory proposers, address[] memory executors, address admin)\r\n        TimelockController(minDelay, proposers, executors)\r\n    {\r\n        // Setup admin role and revoke deployer admin role\r\n        _setupRole(TIMELOCK_ADMIN_ROLE, admin);\r\n        _revokeRole(TIMELOCK_ADMIN_ROLE, _msgSender());\r\n    }\r\n\r\n    function supportsInterface(bytes4 interfaceId) public view virtual override(AccessControl, AccessControlEnumerable) returns (bool) {\r\n        return super.supportsInterface(interfaceId);\r\n    }\r\n\r\n    function _revokeRole(bytes32 role, address account) internal virtual override(AccessControl, AccessControlEnumerable) {\r\n        return super._revokeRole(role, account);\r\n    }\r\n\r\n    function _grantRole(bytes32 role, address account) internal virtual override(AccessControl, AccessControlEnumerable) {\r\n        return super._grantRole(role, account);\r\n    }\r\n}\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1337855395/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1338006934",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3842#issuecomment-1338006934",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3842",
    "id": 1338006934,
    "node_id": "IC_kwDOA9tCBs5PwF2W",
    "user": {
      "login": "frangio",
      "id": 481465,
      "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/frangio",
      "html_url": "https://github.com/frangio",
      "followers_url": "https://api.github.com/users/frangio/followers",
      "following_url": "https://api.github.com/users/frangio/following{/other_user}",
      "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
      "organizations_url": "https://api.github.com/users/frangio/orgs",
      "repos_url": "https://api.github.com/users/frangio/repos",
      "events_url": "https://api.github.com/users/frangio/events{/privacy}",
      "received_events_url": "https://api.github.com/users/frangio/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-12-05T19:16:38Z",
    "updated_at": "2022-12-05T19:16:38Z",
    "author_association": "MEMBER",
    "body": "FYI, the code I shared is for v4.8.0 and your code is for an earlier version. The constructor for TimelockController had a [breaking change](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/v4.8.0/CHANGELOG.md#breaking-changes) in v4.8.0, the deployer no longer automatically receives the admin role, and instead there is an explicit admin argument. This is handled as well by the code you shared, so both are good, but I wanted to give this explanation of the compilation error.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1338006934/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
