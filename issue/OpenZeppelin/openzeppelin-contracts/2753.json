{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2753",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2753/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2753/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2753/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2753",
  "id": 937407480,
  "node_id": "MDU6SXNzdWU5Mzc0MDc0ODA=",
  "number": 2753,
  "title": "MultiCall Tests:  Is an assertion missing? ",
  "user": {
    "login": "crazyrabbitLTC",
    "id": 1938013,
    "node_id": "MDQ6VXNlcjE5MzgwMTM=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1938013?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/crazyrabbitLTC",
    "html_url": "https://github.com/crazyrabbitLTC",
    "followers_url": "https://api.github.com/users/crazyrabbitLTC/followers",
    "following_url": "https://api.github.com/users/crazyrabbitLTC/following{/other_user}",
    "gists_url": "https://api.github.com/users/crazyrabbitLTC/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/crazyrabbitLTC/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/crazyrabbitLTC/subscriptions",
    "organizations_url": "https://api.github.com/users/crazyrabbitLTC/orgs",
    "repos_url": "https://api.github.com/users/crazyrabbitLTC/repos",
    "events_url": "https://api.github.com/users/crazyrabbitLTC/events{/privacy}",
    "received_events_url": "https://api.github.com/users/crazyrabbitLTC/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 3,
  "created_at": "2021-07-05T23:16:44Z",
  "updated_at": "2021-07-06T15:56:25Z",
  "closed_at": "2021-07-06T14:57:16Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Maybe I don't understand exactly how this test is working, but are we missing some sort of assertion here? Is it enough to `await` this function call, if it reverts does an error message bubble up to the test? \r\n\r\nI would have expected an explicit test condition like  (psuedoCode) `shouldNotRevert` to be explicit that the test past.\r\n\r\nhttps://github.com/OpenZeppelin/openzeppelin-contracts/blob/23869e5b2a7c6b9c3e27dee4289615b8cf50e36b/test/utils/Multicall.test.js#L34",
  "closed_by": {
    "login": "Amxx",
    "id": 2432299,
    "node_id": "MDQ6VXNlcjI0MzIyOTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Amxx",
    "html_url": "https://github.com/Amxx",
    "followers_url": "https://api.github.com/users/Amxx/followers",
    "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
    "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
    "organizations_url": "https://api.github.com/users/Amxx/orgs",
    "repos_url": "https://api.github.com/users/Amxx/repos",
    "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Amxx/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2753/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2753/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/874834466",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2753#issuecomment-874834466",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2753",
    "id": 874834466,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NDgzNDQ2Ng==",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-06T14:57:15Z",
    "updated_at": "2021-07-06T14:57:15Z",
    "author_association": "COLLABORATOR",
    "body": "Hello @crazyrabbitLTC \r\n\r\nIf any of the call reverts, then the entire batch of calls does revert.\r\n\r\nThis is tested between lines 37 and 56 of `test/utils/Multicall.test.js`",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/874834466/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/874871387",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2753#issuecomment-874871387",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2753",
    "id": 874871387,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NDg3MTM4Nw==",
    "user": {
      "login": "crazyrabbitLTC",
      "id": 1938013,
      "node_id": "MDQ6VXNlcjE5MzgwMTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1938013?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/crazyrabbitLTC",
      "html_url": "https://github.com/crazyrabbitLTC",
      "followers_url": "https://api.github.com/users/crazyrabbitLTC/followers",
      "following_url": "https://api.github.com/users/crazyrabbitLTC/following{/other_user}",
      "gists_url": "https://api.github.com/users/crazyrabbitLTC/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/crazyrabbitLTC/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/crazyrabbitLTC/subscriptions",
      "organizations_url": "https://api.github.com/users/crazyrabbitLTC/orgs",
      "repos_url": "https://api.github.com/users/crazyrabbitLTC/repos",
      "events_url": "https://api.github.com/users/crazyrabbitLTC/events{/privacy}",
      "received_events_url": "https://api.github.com/users/crazyrabbitLTC/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-06T15:42:49Z",
    "updated_at": "2021-07-06T15:42:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "@Amxx I understand the revert part, what I'm confused about is does the javascript test notice the revert? \r\n\r\n```  \r\nit('returns an array with the result of each call', async function () {\r\n    const MulticallTest = artifacts.require('MulticallTest');\r\n    const multicallTest = await MulticallTest.new({ from: deployer });\r\n    await this.multicallToken.transfer(multicallTest.address, amount, { from: deployer });\r\n    expect(await this.multicallToken.balanceOf(multicallTest.address)).to.be.bignumber.equal(new BN(amount));\r\n\r\n    const recipients = [alice, bob];\r\n    const amounts = [amount / 2, amount / 3].map(n => new BN(n));\r\n\r\n    await multicallTest.testReturnValues(this.multicallToken.address, recipients, amounts);\r\n  });\r\n```\r\n\r\nWhat I mentally would expect would happen is that the `await` would wait for the tx, which would revery, but my test reporter would tell me that the test passed since I'm not testing to see the tx reverted or failed. Am I understanding what would happen in this test incorrectly? Does just having a reverted transaction cause the javascript test to fail?\r\n  \r\n  ",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/874871387/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/874882193",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2753#issuecomment-874882193",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2753",
    "id": 874882193,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg3NDg4MjE5Mw==",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-06T15:56:24Z",
    "updated_at": "2021-07-06T15:56:24Z",
    "author_association": "COLLABORATOR",
    "body": "`multicallTest.testReturnValues` does a call to `multicallToken.multicall` under the hood. If the `multicall` reverts (solidity), then `testReturnValues` transaction will also fail (solidity), which will then cause the js promise to revert.\r\n\r\nWhen you await a promise that reverts, the revert arguments are thrown. ",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/874882193/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
