{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3631",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3631/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3631/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3631/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3631",
  "id": 1342839102,
  "node_id": "I_kwDOA9tCBs5QChk-",
  "number": 3631,
  "title": "ERC777: Incompatible ERC1820 registry address with hardhat",
  "user": {
    "login": "satya1807",
    "id": 102351469,
    "node_id": "U_kgDOBhnCbQ",
    "avatar_url": "https://avatars.githubusercontent.com/u/102351469?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/satya1807",
    "html_url": "https://github.com/satya1807",
    "followers_url": "https://api.github.com/users/satya1807/followers",
    "following_url": "https://api.github.com/users/satya1807/following{/other_user}",
    "gists_url": "https://api.github.com/users/satya1807/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/satya1807/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/satya1807/subscriptions",
    "organizations_url": "https://api.github.com/users/satya1807/orgs",
    "repos_url": "https://api.github.com/users/satya1807/repos",
    "events_url": "https://api.github.com/users/satya1807/events{/privacy}",
    "received_events_url": "https://api.github.com/users/satya1807/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2022-08-18T09:37:54Z",
  "updated_at": "2022-08-18T09:57:39Z",
  "closed_at": "2022-08-18T09:57:39Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "\r\nWhen trying to deploy a ERC777 token I have got the following error.\r\n\r\n\r\n![image](https://user-images.githubusercontent.com/102351469/185360671-d76d1189-496e-48a5-835a-ec7744bc6b0c.png)\r\n\r\nAfter debugging I have found that the ERC777 constructor is making a call to the ERC1820 registry the interface in [this](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/54dec0cad5bd52ec95cc4a042cae133e9388465c/contracts/token/ERC777/ERC777.sol#L74) line.\r\n\r\nThen after searching the address on the etherscan.io, it is confirmed that the address mentioned is the ERC1820 registry contract deployed on Ethereum mainnet.\r\n\r\n**ðŸ’» Environment**\r\n\r\n- Hardhat\r\n- Solidity version 0.8.6\r\n- OpenZeppelin version - 4.7.1\r\n\r\n**ðŸ”¢ Code to reproduce bug**\r\n\r\n```\r\ncontract Token777 is ERC777, Ownable {\r\n    constructor(\r\n        string memory name_,\r\n        string memory symbol_,\r\n        address[] memory initial_operators,\r\n        uint256 _reserved,\r\n        uint256 _amount,\r\n        address _user\r\n    ) ERC777(name_, symbol_, initial_operators) {\r\n        require(\r\n            _start >= block.timestamp && _end > _start,\r\n            \"Invalid time stamps\"\r\n        );\r\n        require(_tokenPrice > 0, \"Invalid token price\");\r\n        require(_reserved > 0, \"Invalid reserved amount\");\r\n        require(_amount > 0, \"Invalid amount\");\r\n        require(_user != address(0), \"Invalid owner\");\r\n\r\n        \r\n\r\n        _mint(address(this), _amount, \"\", \"\", false);\r\n        _mint(_user, reserved, \"\", \"\", false);\r\n        _transferOwnership(_user);\r\n    }\r\n```",
  "closed_by": {
    "login": "Amxx",
    "id": 2432299,
    "node_id": "MDQ6VXNlcjI0MzIyOTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Amxx",
    "html_url": "https://github.com/Amxx",
    "followers_url": "https://api.github.com/users/Amxx/followers",
    "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
    "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
    "organizations_url": "https://api.github.com/users/Amxx/orgs",
    "repos_url": "https://api.github.com/users/Amxx/repos",
    "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Amxx/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3631/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3631/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1219290859",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3631#issuecomment-1219290859",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3631",
    "id": 1219290859,
    "node_id": "IC_kwDOA9tCBs5IrObr",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-18T09:56:12Z",
    "updated_at": "2022-08-18T09:56:12Z",
    "author_association": "COLLABORATOR",
    "body": "Hello @satya1807 \r\n\r\nThis is an unfortunate requirement of ERC-777. It depends on ERC-1820 which dictates that the registry contract must be at address `0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24`.\r\n\r\n[You can find that, and the transaction that is used to deploy the registry, in the EIP document](https://eips.ethereum.org/EIPS/eip-1820)\r\n\r\nFor your tests, there is an helper that you can use:\r\n\r\n```\r\nconst { singletons } = require('@openzeppelin/test-helpers');\r\n\r\n// ...\r\nbeforeEach(async function () {\r\n    this.erc1820 = await singletons.ERC1820Registry(<address of an account that has funds to pay for the deployment>);\r\n});\r\n```\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1219290859/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1219292220",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3631#issuecomment-1219292220",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3631",
    "id": 1219292220,
    "node_id": "IC_kwDOA9tCBs5IrOw8",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-08-18T09:57:39Z",
    "updated_at": "2022-08-18T09:57:39Z",
    "author_association": "COLLABORATOR",
    "body": "Relevant documentation: https://docs.openzeppelin.com/test-helpers/0.5/api#singletons",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1219292220/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
