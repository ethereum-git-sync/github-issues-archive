{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3233",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3233/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3233/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3233/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3233",
  "id": 1155628637,
  "node_id": "I_kwDOA9tCBs5E4X5d",
  "number": 3233,
  "title": "Beacon for UUPS Proxy",
  "user": {
    "login": "wiasliaw",
    "id": 37038019,
    "node_id": "MDQ6VXNlcjM3MDM4MDE5",
    "avatar_url": "https://avatars.githubusercontent.com/u/37038019?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wiasliaw",
    "html_url": "https://github.com/wiasliaw",
    "followers_url": "https://api.github.com/users/wiasliaw/followers",
    "following_url": "https://api.github.com/users/wiasliaw/following{/other_user}",
    "gists_url": "https://api.github.com/users/wiasliaw/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wiasliaw/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wiasliaw/subscriptions",
    "organizations_url": "https://api.github.com/users/wiasliaw/orgs",
    "repos_url": "https://api.github.com/users/wiasliaw/repos",
    "events_url": "https://api.github.com/users/wiasliaw/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wiasliaw/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2022-03-01T17:46:16Z",
  "updated_at": "2022-03-02T15:44:24Z",
  "closed_at": "2022-03-02T15:44:24Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "**üßê Motivation**\r\n\r\nCurrently, beacon is based on transparent proxy. It still can be used to setup with UUPS, but not all compatible.\r\n\r\n**üìù Details**\r\n\r\nIssue:\r\n1. UUPS's upgrade logic is placed in logic contract. Upgrade call will setup new implementation address in proxy's storage, not beacon.\r\n2. Upgrade in beacon doesn't check if the new implementation had imeplemented `proxiableUUID()`.\r\n\r\nPrototype:\r\nI made up a [prototype repo](https://github.com/wiasliaw/uups-beacon) about UUPS beacon. The implementation detail is written in README.\r\n",
  "closed_by": {
    "login": "wiasliaw",
    "id": 37038019,
    "node_id": "MDQ6VXNlcjM3MDM4MDE5",
    "avatar_url": "https://avatars.githubusercontent.com/u/37038019?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/wiasliaw",
    "html_url": "https://github.com/wiasliaw",
    "followers_url": "https://api.github.com/users/wiasliaw/followers",
    "following_url": "https://api.github.com/users/wiasliaw/following{/other_user}",
    "gists_url": "https://api.github.com/users/wiasliaw/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/wiasliaw/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/wiasliaw/subscriptions",
    "organizations_url": "https://api.github.com/users/wiasliaw/orgs",
    "repos_url": "https://api.github.com/users/wiasliaw/repos",
    "events_url": "https://api.github.com/users/wiasliaw/events{/privacy}",
    "received_events_url": "https://api.github.com/users/wiasliaw/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3233/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3233/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1055836909",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3233#issuecomment-1055836909",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3233",
    "id": 1055836909,
    "node_id": "IC_kwDOA9tCBs4-7srt",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-01T20:37:04Z",
    "updated_at": "2022-03-02T14:56:51Z",
    "author_association": "COLLABORATOR",
    "body": "I'm not sure what you mean by \"beacon is based on transparent proxy\".\r\n\r\nThe beacon pattern relies on two contracts:\r\n- The [BeaconProxy](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/proxy/beacon/BeaconProxy.sol)\r\n- The [UpgradeableBeacon](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/proxy/beacon/UpgradeableBeacon.sol)\r\n\r\nThe first one relies on the second one to notify it of what logic to use. The second one is ownable, and can be updated, which is how you \"upgrade\".\r\n\r\nIt is completely independent of by the TransparentProxy and the UUPSProxy.\r\n\r\nWhat you clarify what you'd like to do ?",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1055836909/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1056986141",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3233#issuecomment-1056986141",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3233",
    "id": 1056986141,
    "node_id": "IC_kwDOA9tCBs4_AFQd",
    "user": {
      "login": "wiasliaw",
      "id": 37038019,
      "node_id": "MDQ6VXNlcjM3MDM4MDE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/37038019?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wiasliaw",
      "html_url": "https://github.com/wiasliaw",
      "followers_url": "https://api.github.com/users/wiasliaw/followers",
      "following_url": "https://api.github.com/users/wiasliaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/wiasliaw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wiasliaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wiasliaw/subscriptions",
      "organizations_url": "https://api.github.com/users/wiasliaw/orgs",
      "repos_url": "https://api.github.com/users/wiasliaw/repos",
      "events_url": "https://api.github.com/users/wiasliaw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wiasliaw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-02T14:24:13Z",
    "updated_at": "2022-03-02T14:24:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "UUPS can be setup with beacon with these two contract. However,, there will be some issues.\r\n\r\n1. Upgradeable logic is in UUPS contract. It is spare to use beacon's upgradeable logic.\r\n2. Using beacon's upgradeable logic cannot check if new implementation implement `proxiableUUID()`.\r\n3. It might cause bug if proxy calls UUPS's upgradeable logic.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1056986141/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1057028897",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3233#issuecomment-1057028897",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3233",
    "id": 1057028897,
    "node_id": "IC_kwDOA9tCBs4_APsh",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-02T15:00:51Z",
    "updated_at": "2022-03-02T15:00:51Z",
    "author_association": "COLLABORATOR",
    "body": "> UUPS can be setup with beacon with these two contract.\r\n\r\nWhat do you mean? The [BeaconProxy](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/proxy/beacon/BeaconProxy.sol) does not read the \"implementation slot\" that UUPS uses. So if your logic includes UUPS, this will have no effect. It will NOT upgrade the contract.\r\n\r\n`proxiableUUID()` is used as protection, so that an UUPS proxy doesn't upgrade to a non UUPS implementation (that would prevent any further upgrades). In the context of beacons, the upgrade happens through the beacon, which itself is not upgradeable (or at least is not expected to be) ... so we don't have the same threat. As long as the Beacon's admin is not lost, we can do upgrades.\r\n\r\nA beacon proxy could be an upgradeable contract, I don't really see why you would do that, but you technically could. Is that what your usecase ?",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1057028897/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1057075105",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3233#issuecomment-1057075105",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3233",
    "id": 1057075105,
    "node_id": "IC_kwDOA9tCBs4_Aa-h",
    "user": {
      "login": "wiasliaw",
      "id": 37038019,
      "node_id": "MDQ6VXNlcjM3MDM4MDE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/37038019?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/wiasliaw",
      "html_url": "https://github.com/wiasliaw",
      "followers_url": "https://api.github.com/users/wiasliaw/followers",
      "following_url": "https://api.github.com/users/wiasliaw/following{/other_user}",
      "gists_url": "https://api.github.com/users/wiasliaw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/wiasliaw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/wiasliaw/subscriptions",
      "organizations_url": "https://api.github.com/users/wiasliaw/orgs",
      "repos_url": "https://api.github.com/users/wiasliaw/repos",
      "events_url": "https://api.github.com/users/wiasliaw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/wiasliaw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-03-02T15:44:20Z",
    "updated_at": "2022-03-02T15:44:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "OK, I got it.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1057075105/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
