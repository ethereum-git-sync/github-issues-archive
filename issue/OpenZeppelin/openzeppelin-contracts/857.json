{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/857",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/857/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/857/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/857/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/857",
  "id": 310212580,
  "node_id": "MDU6SXNzdWUzMTAyMTI1ODA=",
  "number": 857,
  "title": "Crowdsale.sol contract has a bug in setting rate",
  "user": {
    "login": "sheraz104",
    "id": 37038761,
    "node_id": "MDQ6VXNlcjM3MDM4NzYx",
    "avatar_url": "https://avatars.githubusercontent.com/u/37038761?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/sheraz104",
    "html_url": "https://github.com/sheraz104",
    "followers_url": "https://api.github.com/users/sheraz104/followers",
    "following_url": "https://api.github.com/users/sheraz104/following{/other_user}",
    "gists_url": "https://api.github.com/users/sheraz104/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/sheraz104/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/sheraz104/subscriptions",
    "organizations_url": "https://api.github.com/users/sheraz104/orgs",
    "repos_url": "https://api.github.com/users/sheraz104/repos",
    "events_url": "https://api.github.com/users/sheraz104/events{/privacy}",
    "received_events_url": "https://api.github.com/users/sheraz104/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": true,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 7,
  "created_at": "2018-03-31T04:49:58Z",
  "updated_at": "2018-05-23T18:09:08Z",
  "closed_at": "2018-04-03T11:35:26Z",
  "author_association": "NONE",
  "active_lock_reason": "resolved",
  "body": "The **Wei** received in transaction to fallback function are **multiplied** to rate and there is a check for rate in constructor  (see second screenshot) for it to be **greater than 0**. Currently, if we want to set rate for a single token to 10000 **Wei**, we would have to pass rate's value in the format of 0.000000000000001 and the transaction will **fail** and will only pass if we set the rate such that\r\nwe can set rate of **2 token for 1** **Wei**, but not **1 token for 2** **Wei**.\r\n\r\n![image](https://user-images.githubusercontent.com/37038761/38159676-41410382-34b6-11e8-92bf-e27d1d37855e.png)\r\n\r\n![image](https://user-images.githubusercontent.com/37038761/38159682-5127aad0-34b6-11e8-8831-771fd727ad52.png)\r\n\r\n\r\nI made the code work by using division instead of multiply and providing the rate's value in the format of 1000000000000..\r\n\r\n",
  "closed_by": {
    "login": "shrugs",
    "id": 1535001,
    "node_id": "MDQ6VXNlcjE1MzUwMDE=",
    "avatar_url": "https://avatars.githubusercontent.com/u/1535001?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/shrugs",
    "html_url": "https://github.com/shrugs",
    "followers_url": "https://api.github.com/users/shrugs/followers",
    "following_url": "https://api.github.com/users/shrugs/following{/other_user}",
    "gists_url": "https://api.github.com/users/shrugs/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/shrugs/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/shrugs/subscriptions",
    "organizations_url": "https://api.github.com/users/shrugs/orgs",
    "repos_url": "https://api.github.com/users/shrugs/repos",
    "events_url": "https://api.github.com/users/shrugs/events{/privacy}",
    "received_events_url": "https://api.github.com/users/shrugs/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/857/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/857/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/377668809",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/857#issuecomment-377668809",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/857",
    "id": 377668809,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NzY2ODgwOQ==",
    "user": {
      "login": "jacktang",
      "id": 44341,
      "node_id": "MDQ6VXNlcjQ0MzQx",
      "avatar_url": "https://avatars.githubusercontent.com/u/44341?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jacktang",
      "html_url": "https://github.com/jacktang",
      "followers_url": "https://api.github.com/users/jacktang/followers",
      "following_url": "https://api.github.com/users/jacktang/following{/other_user}",
      "gists_url": "https://api.github.com/users/jacktang/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jacktang/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jacktang/subscriptions",
      "organizations_url": "https://api.github.com/users/jacktang/orgs",
      "repos_url": "https://api.github.com/users/jacktang/repos",
      "events_url": "https://api.github.com/users/jacktang/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jacktang/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-31T05:56:15Z",
    "updated_at": "2018-03-31T05:56:37Z",
    "author_association": "NONE",
    "body": "@sheraz104 check the `rate` comment in `Crowdsale.sol`, it said `How many token units a buyer gets per wei`. `1 token for 2 Wei` means the `price` not the `rate`.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/377668809/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/377680897",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/857#issuecomment-377680897",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/857",
    "id": 377680897,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NzY4MDg5Nw==",
    "user": {
      "login": "Hashedhash",
      "id": 8158351,
      "node_id": "MDQ6VXNlcjgxNTgzNTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8158351?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Hashedhash",
      "html_url": "https://github.com/Hashedhash",
      "followers_url": "https://api.github.com/users/Hashedhash/followers",
      "following_url": "https://api.github.com/users/Hashedhash/following{/other_user}",
      "gists_url": "https://api.github.com/users/Hashedhash/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Hashedhash/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Hashedhash/subscriptions",
      "organizations_url": "https://api.github.com/users/Hashedhash/orgs",
      "repos_url": "https://api.github.com/users/Hashedhash/repos",
      "events_url": "https://api.github.com/users/Hashedhash/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Hashedhash/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-31T09:47:46Z",
    "updated_at": "2018-03-31T09:47:46Z",
    "author_association": "NONE",
    "body": "@jacktang If token supply is more or equal 1e18 the current implementation works. What if there are only 100 tokens in the contract?  ",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/377680897/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/377685281",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/857#issuecomment-377685281",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/857",
    "id": 377685281,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NzY4NTI4MQ==",
    "user": {
      "login": "sheraz104",
      "id": 37038761,
      "node_id": "MDQ6VXNlcjM3MDM4NzYx",
      "avatar_url": "https://avatars.githubusercontent.com/u/37038761?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sheraz104",
      "html_url": "https://github.com/sheraz104",
      "followers_url": "https://api.github.com/users/sheraz104/followers",
      "following_url": "https://api.github.com/users/sheraz104/following{/other_user}",
      "gists_url": "https://api.github.com/users/sheraz104/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sheraz104/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sheraz104/subscriptions",
      "organizations_url": "https://api.github.com/users/sheraz104/orgs",
      "repos_url": "https://api.github.com/users/sheraz104/repos",
      "events_url": "https://api.github.com/users/sheraz104/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sheraz104/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-31T11:08:39Z",
    "updated_at": "2018-03-31T11:12:48Z",
    "author_association": "NONE",
    "body": "@jacktang exactly. Even when the tokens are 1e18, which is a huge amount, if I'm not wrong the crowdsale can be bought out for 1 ether.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/377685281/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/377789348",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/857#issuecomment-377789348",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/857",
    "id": 377789348,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3Nzc4OTM0OA==",
    "user": {
      "login": "shyheim103",
      "id": 33836641,
      "node_id": "MDQ6VXNlcjMzODM2NjQx",
      "avatar_url": "https://avatars.githubusercontent.com/u/33836641?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shyheim103",
      "html_url": "https://github.com/shyheim103",
      "followers_url": "https://api.github.com/users/shyheim103/followers",
      "following_url": "https://api.github.com/users/shyheim103/following{/other_user}",
      "gists_url": "https://api.github.com/users/shyheim103/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shyheim103/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shyheim103/subscriptions",
      "organizations_url": "https://api.github.com/users/shyheim103/orgs",
      "repos_url": "https://api.github.com/users/shyheim103/repos",
      "events_url": "https://api.github.com/users/shyheim103/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shyheim103/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-01T14:09:17Z",
    "updated_at": "2018-04-01T14:09:17Z",
    "author_association": "NONE",
    "body": "@sheraz104 agreed. I've been trying to figure out why it was written this way for the past week. Glad someone else has noticed this. ",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/377789348/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/378219267",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/857#issuecomment-378219267",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/857",
    "id": 378219267,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3ODIxOTI2Nw==",
    "user": {
      "login": "shrugs",
      "id": 1535001,
      "node_id": "MDQ6VXNlcjE1MzUwMDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1535001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrugs",
      "html_url": "https://github.com/shrugs",
      "followers_url": "https://api.github.com/users/shrugs/followers",
      "following_url": "https://api.github.com/users/shrugs/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrugs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrugs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrugs/subscriptions",
      "organizations_url": "https://api.github.com/users/shrugs/orgs",
      "repos_url": "https://api.github.com/users/shrugs/repos",
      "events_url": "https://api.github.com/users/shrugs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrugs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-03T11:35:26Z",
    "updated_at": "2018-04-03T11:35:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "note that there's a difference between `1 TKN` and `1 TKNbit` where what people usually call \"one token\" is actually `1 * 1e18 TKNbits`. This is the same relationship that ether and wei have. And what you're always doing calculations in is `TKNbits`.\r\n\r\nSo if you want to issue someone \"one token for every 2 wei\" and your decimals are `18`, your rate is actually something like `0.5e17`. Then, when I send you 2 wei, you issue me `2 * 0.5e17 TKNbits`, which is exactly equal to `1 TKN`.\r\n\r\nAnd, to show the answer to the first question, \"one token for 10000 Wei\", your rate should be `1e14`. Then, for each wei that is sent, I'm issued `1e14 TKNbits`, which, once You send 10000 wei will be `10000 * 1e14 === 1e18`. And then because your decimals are `18`, that's displayed as `1 TKN`.\r\n\r\n---\r\n\r\nIssuing less than 1 TKNbit/wei isn't really useful in practice, but there are a few ways to do it:\r\n\r\nYou're correct that because of the multiplication, you can't issue less TKNbits than the wei that was provided, but you _can_ issue less TKN, total, by changing your decimals. If you change your decimals to `10`, for example, you can now use a rate of `1` to say that \"one TKNbit for one wei\", meaning that it costs `10 Gwei` to own `1 TKN`. \r\n\r\nIf you don't want to change your decimals, you can also just inherit from crowdsale and (i) change the rate to a divisor and then (ii) change `_getTokenAmount ` to use div and (iii) tell your users to just ignore the rounding errors",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/378219267/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/391283676",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/857#issuecomment-391283676",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/857",
    "id": 391283676,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MTI4MzY3Ng==",
    "user": {
      "login": "linkdesu",
      "id": 858724,
      "node_id": "MDQ6VXNlcjg1ODcyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858724?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/linkdesu",
      "html_url": "https://github.com/linkdesu",
      "followers_url": "https://api.github.com/users/linkdesu/followers",
      "following_url": "https://api.github.com/users/linkdesu/following{/other_user}",
      "gists_url": "https://api.github.com/users/linkdesu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/linkdesu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/linkdesu/subscriptions",
      "organizations_url": "https://api.github.com/users/linkdesu/orgs",
      "repos_url": "https://api.github.com/users/linkdesu/repos",
      "events_url": "https://api.github.com/users/linkdesu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/linkdesu/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-23T09:31:20Z",
    "updated_at": "2018-05-23T09:31:20Z",
    "author_association": "NONE",
    "body": "Finally found the truth after hours of debug , THX ! 😂\r\n\r\nBut why not write things so important in document ?!?!",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/391283676/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/391444897",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/857#issuecomment-391444897",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/857",
    "id": 391444897,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MTQ0NDg5Nw==",
    "user": {
      "login": "shrugs",
      "id": 1535001,
      "node_id": "MDQ6VXNlcjE1MzUwMDE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1535001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrugs",
      "html_url": "https://github.com/shrugs",
      "followers_url": "https://api.github.com/users/shrugs/followers",
      "following_url": "https://api.github.com/users/shrugs/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrugs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrugs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrugs/subscriptions",
      "organizations_url": "https://api.github.com/users/shrugs/orgs",
      "repos_url": "https://api.github.com/users/shrugs/repos",
      "events_url": "https://api.github.com/users/shrugs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrugs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-23T18:08:42Z",
    "updated_at": "2018-05-23T18:09:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "@linkdesu You should always, always operate in the smallest number of a currency when doing automatic operations on it. This is generally-well-known programming best practice.\r\n\r\nWe will add a specific note to this contract, thank you for your report.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/391444897/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
