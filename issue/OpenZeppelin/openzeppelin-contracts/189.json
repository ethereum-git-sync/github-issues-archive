{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/189",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/189/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/189/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/189/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/189",
  "id": 220510456,
  "node_id": "MDU6SXNzdWUyMjA1MTA0NTY=",
  "number": 189,
  "title": "Add totalPayments uint on PullPayment.sol",
  "user": {
    "login": "AugustoL",
    "id": 7763867,
    "node_id": "MDQ6VXNlcjc3NjM4Njc=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7763867?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/AugustoL",
    "html_url": "https://github.com/AugustoL",
    "followers_url": "https://api.github.com/users/AugustoL/followers",
    "following_url": "https://api.github.com/users/AugustoL/following{/other_user}",
    "gists_url": "https://api.github.com/users/AugustoL/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/AugustoL/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/AugustoL/subscriptions",
    "organizations_url": "https://api.github.com/users/AugustoL/orgs",
    "repos_url": "https://api.github.com/users/AugustoL/repos",
    "events_url": "https://api.github.com/users/AugustoL/events{/privacy}",
    "received_events_url": "https://api.github.com/users/AugustoL/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 2,
  "created_at": "2017-04-10T00:08:32Z",
  "updated_at": "2017-04-18T14:42:49Z",
  "closed_at": "2017-04-18T14:42:49Z",
  "author_association": "CONTRIBUTOR",
  "active_lock_reason": null,
  "body": "Im using the PullPayment contract on my contracts and I realized that there is no way to now the balance that is owned completely by the contract owner, so my proposal is to upgrade the totalPayments variable on the contract to keep tracking of how much of the contract balance can be withdrawn.\r\n\r\nIt would look like this:\r\n```\r\npragma solidity ^0.4.8;\r\n\r\n\r\nimport '../SafeMath.sol';\r\n\r\n\r\n/*\r\n * PullPayment\r\n * Base contract supporting async send for pull payments.\r\n * Inherit from this contract and use asyncSend instead of send.\r\n */\r\ncontract PullPayment is SafeMath {\r\n  mapping(address => uint) public payments;\r\n  uint public totalPayments;\r\n\r\n  // store sent amount as credit to be pulled, called by payer\r\n  function asyncSend(address dest, uint amount) internal {\r\n    payments[dest] = safeAdd(payments[dest], amount);\r\n    totalPayments = safeSub(totalPayments, amount);\r\n  }\r\n\r\n  // withdraw accumulated balance, called by payee\r\n  function withdrawPayments() {\r\n    address payee = msg.sender;\r\n    uint payment = payments[payee];\r\n    \r\n    if (payment == 0) {\r\n      throw;\r\n    }\r\n\r\n    if (this.balance < payment) {\r\n      throw;\r\n    }\r\n\r\n    totalPayments = safeSub(totalPayments, payment);\r\n    payments[payee] = 0;\r\n\r\n    if (!payee.send(payment)) {\r\n      throw;\r\n    }\r\n  }\r\n}\r\n\r\n```\r\n\r\nThis changes not affect the function definitions, since the actual functions will still be receiving the same amount/type of parameters.",
  "closed_by": {
    "login": "maraoz",
    "id": 287189,
    "node_id": "MDQ6VXNlcjI4NzE4OQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/287189?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/maraoz",
    "html_url": "https://github.com/maraoz",
    "followers_url": "https://api.github.com/users/maraoz/followers",
    "following_url": "https://api.github.com/users/maraoz/following{/other_user}",
    "gists_url": "https://api.github.com/users/maraoz/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/maraoz/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/maraoz/subscriptions",
    "organizations_url": "https://api.github.com/users/maraoz/orgs",
    "repos_url": "https://api.github.com/users/maraoz/repos",
    "events_url": "https://api.github.com/users/maraoz/events{/privacy}",
    "received_events_url": "https://api.github.com/users/maraoz/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/189/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/189/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/292823425",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/189#issuecomment-292823425",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/189",
    "id": 292823425,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MjgyMzQyNQ==",
    "user": {
      "login": "AugustoL",
      "id": 7763867,
      "node_id": "MDQ6VXNlcjc3NjM4Njc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7763867?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AugustoL",
      "html_url": "https://github.com/AugustoL",
      "followers_url": "https://api.github.com/users/AugustoL/followers",
      "following_url": "https://api.github.com/users/AugustoL/following{/other_user}",
      "gists_url": "https://api.github.com/users/AugustoL/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AugustoL/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AugustoL/subscriptions",
      "organizations_url": "https://api.github.com/users/AugustoL/orgs",
      "repos_url": "https://api.github.com/users/AugustoL/repos",
      "events_url": "https://api.github.com/users/AugustoL/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AugustoL/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-04-10T00:09:21Z",
    "updated_at": "2017-04-10T00:09:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "@maraoz tell me what you think, if you agree I can create the PR.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/292823425/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/293280501",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/189#issuecomment-293280501",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/189",
    "id": 293280501,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MzI4MDUwMQ==",
    "user": {
      "login": "maraoz",
      "id": 287189,
      "node_id": "MDQ6VXNlcjI4NzE4OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/287189?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/maraoz",
      "html_url": "https://github.com/maraoz",
      "followers_url": "https://api.github.com/users/maraoz/followers",
      "following_url": "https://api.github.com/users/maraoz/following{/other_user}",
      "gists_url": "https://api.github.com/users/maraoz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/maraoz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/maraoz/subscriptions",
      "organizations_url": "https://api.github.com/users/maraoz/orgs",
      "repos_url": "https://api.github.com/users/maraoz/repos",
      "events_url": "https://api.github.com/users/maraoz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/maraoz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-04-11T14:26:42Z",
    "updated_at": "2017-04-11T14:26:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "LGTM",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/293280501/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
