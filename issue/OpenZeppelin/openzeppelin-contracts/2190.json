{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2190",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2190/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2190/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2190/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2190",
  "id": 600529525,
  "node_id": "MDU6SXNzdWU2MDA1Mjk1MjU=",
  "number": 2190,
  "title": "Document workarounds for ECDSA.recover with Ganache",
  "user": {
    "login": "frangio",
    "id": 481465,
    "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/frangio",
    "html_url": "https://github.com/frangio",
    "followers_url": "https://api.github.com/users/frangio/followers",
    "following_url": "https://api.github.com/users/frangio/following{/other_user}",
    "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
    "organizations_url": "https://api.github.com/users/frangio/orgs",
    "repos_url": "https://api.github.com/users/frangio/repos",
    "events_url": "https://api.github.com/users/frangio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/frangio/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 4,
  "created_at": "2020-04-15T19:17:16Z",
  "updated_at": "2022-10-14T13:34:00Z",
  "closed_at": "2021-06-01T20:59:24Z",
  "author_association": "MEMBER",
  "active_lock_reason": null,
  "body": "In 2.2.0 we introduced protections against malleability of ECDSA signatures. More details can be found in https://github.com/OpenZeppelin/openzeppelin-solidity/pull/1622.\r\n\r\nOne unfortunate side effect of this has been that `ECDSA.recover` stopped working with Ganache-generated signatures, because they use the signatures parameters that the library rejects. This seems to be a problem with Ganache only. There seems to be plans to fix it in the next major version of Ganache, with an unknown ETA. The relevant issues are https://github.com/trufflesuite/ganache-core/issues/451, https://github.com/trufflesuite/ganache-core/issues/556.\r\n\r\nWe evaluated rolling back the changes to ECDSA in Contracts 3.0. Given that we think malleability protection makes sense in general, that the issue only affects the current version of Ganache, and that there are workarounds, we decided to keep the current behavior and instead improve the documentation by including the workarounds that are required to make it work in Ganache, and more details about the issue to understand it.\r\n\r\nThe workaround can be found in [`test/helpers/sign.js: fixSignature`](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/b6513f6ad7f8a31c2bbfd9a8e0a85e78ea5b0df5/test/helpers/sign.js#L9-L19). We should move it to test-helpers to make it available as a complement to the documentation.",
  "closed_by": {
    "login": "frangio",
    "id": 481465,
    "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/frangio",
    "html_url": "https://github.com/frangio",
    "followers_url": "https://api.github.com/users/frangio/followers",
    "following_url": "https://api.github.com/users/frangio/following{/other_user}",
    "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
    "organizations_url": "https://api.github.com/users/frangio/orgs",
    "repos_url": "https://api.github.com/users/frangio/repos",
    "events_url": "https://api.github.com/users/frangio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/frangio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2190/reactions",
    "total_count": 4,
    "+1": 4,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2190/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/614251212",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2190#issuecomment-614251212",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2190",
    "id": 614251212,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNDI1MTIxMg==",
    "user": {
      "login": "nventuro",
      "id": 2530770,
      "node_id": "MDQ6VXNlcjI1MzA3NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2530770?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nventuro",
      "html_url": "https://github.com/nventuro",
      "followers_url": "https://api.github.com/users/nventuro/followers",
      "following_url": "https://api.github.com/users/nventuro/following{/other_user}",
      "gists_url": "https://api.github.com/users/nventuro/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nventuro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nventuro/subscriptions",
      "organizations_url": "https://api.github.com/users/nventuro/orgs",
      "repos_url": "https://api.github.com/users/nventuro/repos",
      "events_url": "https://api.github.com/users/nventuro/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nventuro/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-15T20:00:48Z",
    "updated_at": "2020-04-15T20:00:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "I want to add a short clarification, given a bit of context is needed to understand this. \r\n\r\nThe current ECDSA code is correct, safe, and will work as intended in all testnets and the main Ethereum network. This is a side-effect of an issue with how a Ganache node behaves on `eth_sign` RPC requests, which on the worst case will lead to head-scratching while developing locally against a ganache node.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/614251212/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/768960914",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2190#issuecomment-768960914",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2190",
    "id": 768960914,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2ODk2MDkxNA==",
    "user": {
      "login": "shinsuny",
      "id": 19986226,
      "node_id": "MDQ6VXNlcjE5OTg2MjI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/19986226?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shinsuny",
      "html_url": "https://github.com/shinsuny",
      "followers_url": "https://api.github.com/users/shinsuny/followers",
      "following_url": "https://api.github.com/users/shinsuny/following{/other_user}",
      "gists_url": "https://api.github.com/users/shinsuny/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shinsuny/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shinsuny/subscriptions",
      "organizations_url": "https://api.github.com/users/shinsuny/orgs",
      "repos_url": "https://api.github.com/users/shinsuny/repos",
      "events_url": "https://api.github.com/users/shinsuny/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shinsuny/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-28T10:37:22Z",
    "updated_at": "2021-01-28T10:49:52Z",
    "author_association": "NONE",
    "body": "This side effect took my 16 hrs of debugging.\r\n@frangio Thanks for listing the issue.\r\n\r\nWithout fix Ganache will throw:\r\n`ECDSA: invalid signature 'v' value`\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/768960914/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/769488893",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2190#issuecomment-769488893",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2190",
    "id": 769488893,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2OTQ4ODg5Mw==",
    "user": {
      "login": "nventuro",
      "id": 2530770,
      "node_id": "MDQ6VXNlcjI1MzA3NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2530770?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nventuro",
      "html_url": "https://github.com/nventuro",
      "followers_url": "https://api.github.com/users/nventuro/followers",
      "following_url": "https://api.github.com/users/nventuro/following{/other_user}",
      "gists_url": "https://api.github.com/users/nventuro/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nventuro/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nventuro/subscriptions",
      "organizations_url": "https://api.github.com/users/nventuro/orgs",
      "repos_url": "https://api.github.com/users/nventuro/repos",
      "events_url": "https://api.github.com/users/nventuro/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nventuro/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-29T00:29:02Z",
    "updated_at": "2021-01-29T00:29:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "> which on the worst case will lead to head-scratching while developing locally against a ganache node.\r\n\r\n:sweat_smile: sorry this caused you so much trouble @sarveshwar-singh!",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/769488893/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 1,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1279009307",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2190#issuecomment-1279009307",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2190",
    "id": 1279009307,
    "node_id": "IC_kwDOA9tCBs5MPCIb",
    "user": {
      "login": "giuseppeg",
      "id": 711311,
      "node_id": "MDQ6VXNlcjcxMTMxMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/711311?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/giuseppeg",
      "html_url": "https://github.com/giuseppeg",
      "followers_url": "https://api.github.com/users/giuseppeg/followers",
      "following_url": "https://api.github.com/users/giuseppeg/following{/other_user}",
      "gists_url": "https://api.github.com/users/giuseppeg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/giuseppeg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/giuseppeg/subscriptions",
      "organizations_url": "https://api.github.com/users/giuseppeg/orgs",
      "repos_url": "https://api.github.com/users/giuseppeg/repos",
      "events_url": "https://api.github.com/users/giuseppeg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/giuseppeg/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-10-14T13:26:44Z",
    "updated_at": "2022-10-14T13:34:00Z",
    "author_association": "NONE",
    "body": "Hello there. I just stumbled upon this issue and would appreciate any help:\r\n\r\nI signed a message with `web3.eth.sign(message, myAddress)` using MM `10.20.0` and web3 `1.8.0` and still need to fix the signature otherwise `ECDSA.recover` 4.7.3 fails with \r\n\r\n```\r\nECDSA: invalid signature 'v' value\r\n```\r\n\r\nLooking [at this commit](https://github.com/OpenZeppelin/openzeppelin-contracts/pull/2619/files) though it seems that the workaround shouldn't be needed anymore.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1279009307/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
