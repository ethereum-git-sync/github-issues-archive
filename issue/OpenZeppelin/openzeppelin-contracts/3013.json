{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3013",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3013/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3013/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3013/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3013",
  "id": 1077349816,
  "node_id": "I_kwDOA9tCBs5ANw24",
  "number": 3013,
  "title": "NFT minted using ERC721URIStorage shows totalSupply 0 on Etherscan",
  "user": {
    "login": "takwaiw",
    "id": 7789092,
    "node_id": "MDQ6VXNlcjc3ODkwOTI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7789092?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/takwaiw",
    "html_url": "https://github.com/takwaiw",
    "followers_url": "https://api.github.com/users/takwaiw/followers",
    "following_url": "https://api.github.com/users/takwaiw/following{/other_user}",
    "gists_url": "https://api.github.com/users/takwaiw/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/takwaiw/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/takwaiw/subscriptions",
    "organizations_url": "https://api.github.com/users/takwaiw/orgs",
    "repos_url": "https://api.github.com/users/takwaiw/repos",
    "events_url": "https://api.github.com/users/takwaiw/events{/privacy}",
    "received_events_url": "https://api.github.com/users/takwaiw/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 6,
  "created_at": "2021-12-11T01:31:46Z",
  "updated_at": "2022-07-20T09:26:19Z",
  "closed_at": "2021-12-13T21:36:56Z",
  "author_association": "NONE",
  "active_lock_reason": null,
  "body": "I followed the https://docs.openzeppelin.com/contracts/4.x/erc721 to create a simple NFT contract. When I mint the token, Etherscan shows totalSupply is 0.\r\n\r\n**ðŸ’» Environment**\r\n\r\nOpenSzeepelin: 4.4.0\r\nBrownie\r\n\r\n**ðŸ“ Details**\r\n\r\nSince ERC721URIStorage does not implement totalSupply, it always show 0. totalSupply shoule be 1 because I just minted the token. I see that totalSupply is declared on the IERC721Enumerable interface. I will submit a PR with a new wrapper contract that returns the correct totalSupply.\r\n\r\n**ðŸ”¢ Code to reproduce bug**\r\n\r\n// Use the example https://docs.openzeppelin.com/contracts/4.x/erc721\r\n// Or the following contract:\r\n\r\n// SPDX-License-Identifier: MIT\r\npragma solidity >=0.6.6 <0.9.0;\r\n\r\nimport \"@openzeppelin/contracts/token/ERC721/extensions/ERC721URIStorage.sol\";\r\nimport \"@openzeppelin/contracts/utils/Counters.sol\";\r\n\r\n\r\ncontract SimpleCollectible is ERC721URIStorage {\r\n    using Counters for Counters.Counter;\r\n    Counters.Counter private tokenIds;\r\n\r\n    constructor() ERC721(\"Doggie\", \"DOG\") {}\r\n\r\n    function createCollectible(string memory tokenURI)\r\n        public\r\n        returns (uint256)\r\n    {\r\n        uint256 newTokenId = tokenIds.current();\r\n        _mint(msg.sender, newTokenId);\r\n        _setTokenURI(newTokenId, tokenURI);\r\n        tokenIds.increment();\r\n        return newTokenId;\r\n    }\r\n}\r\n\r\n=========================================\r\n# brownie deploy.py:\r\n\r\nfrom brownie import SimpleCollectible\r\nfrom scripts.helpful_scripts import get_account, OPENSEA_URL\r\n\r\nSAMPLE_TOKEN_URL = \"https://ipfs.io/ipfs/Qmd9MCGtdVz2miNumBHDbvj8bigSgTwnr4SbyH6DNnpWdt?filename=0-PUG.json\"\r\n\r\n\r\ndef deploy_simple_collectible():\r\n    print(\"Deploying SimpleCollectible DOG...\")\r\n    account = get_account()\r\n    simple_collectible = SimpleCollectible.deploy({\"from\": account})\r\n    tx = simple_collectible.createCollectible(SAMPLE_TOKEN_URL, {\"from\": account})\r\n    tx.wait(1)\r\n    tokenId = simple_collectible.getLastTokenId()\r\n    print(\r\n        f\"You can view your NFT at {OPENSEA_URL.format(simple_collectible.address, tokenId)}\"\r\n    )\r\n    print(\"May need to wait up to 20 mintes, and hit the refresh button.\")\r\n\r\n\r\ndef main():\r\n    deploy_simple_collectible()\r\n\r\n\r\n==================================\r\n\r\n# helpful_scripts.py\r\n\r\nfrom brownie import accounts, config, network\r\n\r\nFORKED_LOCAL_ENVIRONMENTS = [\"mainnet-fork\", \"mainnet-fork-dev\"]\r\nLOCAL_BLOCKCHAIN_ENVIRONENTS = [\r\n    \"development\",\r\n    \"geth-dev\",\r\n    \"hardhat\",\r\n    \"hardhat-fork\",\r\n    \"ganache-local\",\r\n]\r\nOPENSEA_URL = \"https://testnets.opensea.io/assets/{}/{}\"\r\n\r\n\r\ndef get_account(index=None, id=None):\r\n    if index:\r\n        return accounts[index]\r\n    if id:\r\n        return accounts.load(id)\r\n    if (\r\n        network.show_active() in LOCAL_BLOCKCHAIN_ENVIRONENTS\r\n        or network.show_active() in FORKED_LOCAL_ENVIRONMENTS\r\n    ):\r\n        return accounts[0]\r\n    return accounts.add(config[\"wallets\"][\"from_key\"])\r\n",
  "closed_by": {
    "login": "takwaiw",
    "id": 7789092,
    "node_id": "MDQ6VXNlcjc3ODkwOTI=",
    "avatar_url": "https://avatars.githubusercontent.com/u/7789092?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/takwaiw",
    "html_url": "https://github.com/takwaiw",
    "followers_url": "https://api.github.com/users/takwaiw/followers",
    "following_url": "https://api.github.com/users/takwaiw/following{/other_user}",
    "gists_url": "https://api.github.com/users/takwaiw/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/takwaiw/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/takwaiw/subscriptions",
    "organizations_url": "https://api.github.com/users/takwaiw/orgs",
    "repos_url": "https://api.github.com/users/takwaiw/repos",
    "events_url": "https://api.github.com/users/takwaiw/events{/privacy}",
    "received_events_url": "https://api.github.com/users/takwaiw/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3013/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3013/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/991979714",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3013#issuecomment-991979714",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3013",
    "id": 991979714,
    "node_id": "IC_kwDOA9tCBs47IGjC",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-12T22:10:11Z",
    "updated_at": "2021-12-12T22:10:11Z",
    "author_association": "COLLABORATOR",
    "body": "Hello @takwaiw \r\n\r\nAFAIK, the total supply visible on etherscan is computed base on the number of existing tokens (if any) or by the `totalSupply()` function is available.\r\n\r\nThis is why [this token](https://etherscan.io/token/0x6d0de90cdc47047982238fcf69944555d27ecb25) (that is ERC721Enumerable) shows a total supply of 445 (at the time of writing this message) while [this other token](https://etherscan.io/token/0xe9f3037c7e035ab4ad286ccb6ce0be60836446cf), that implements its own fixed `totalSupply()` function, shows 10000.\r\n\r\nThis all has nothing to do with `ERC721URIStorage` but with the presence or absence of the `totalSupply()` function, and what you decided to have it return.",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/991979714/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/992710480",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3013#issuecomment-992710480",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3013",
    "id": 992710480,
    "node_id": "IC_kwDOA9tCBs47K49Q",
    "user": {
      "login": "takwaiw",
      "id": 7789092,
      "node_id": "MDQ6VXNlcjc3ODkwOTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7789092?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takwaiw",
      "html_url": "https://github.com/takwaiw",
      "followers_url": "https://api.github.com/users/takwaiw/followers",
      "following_url": "https://api.github.com/users/takwaiw/following{/other_user}",
      "gists_url": "https://api.github.com/users/takwaiw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takwaiw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takwaiw/subscriptions",
      "organizations_url": "https://api.github.com/users/takwaiw/orgs",
      "repos_url": "https://api.github.com/users/takwaiw/repos",
      "events_url": "https://api.github.com/users/takwaiw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takwaiw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-13T17:34:47Z",
    "updated_at": "2021-12-13T17:34:47Z",
    "author_association": "NONE",
    "body": "Thanks for the explanation. Sorry, I'm new to this space. Very eager and excited to contribute, so I jumped in without fully understanding the semantics of totalSupply. When I minted my own NFT using the OpenZeppellin ERC721URIStorage version 4.4.0, it wasn't shown on OpenSea. While trying to figure out what's wrong, I noticed that the totalSupply in Etherscan always show 0, even days later. I then dropped back to ERC721URIToken version 3.x - OpenSea picked it up. When Iooked at Etherscan, the totalSupply is 1. That made me think that totalSupply is a required function that is missing in ERC721URIStorage.\r\n\r\nHere is an example of totalSupply 0 when minted with version ERC721URIStorage 4.x:\r\nhttps://rinkeby.etherscan.io/token/0xce0091d9d5cc59bf5d604488b7f1855f6d9132a8\r\n\r\nMinted with my version that implements totalSupply: https://rinkeby.etherscan.io/token/0xd271ed7c0e52ab9cb0beeac72c03875737d2cb4a\r\n\r\nIf I inherit from ERC721URIStorage version 4.x, and I don't implement totalSupply, it looks like it is always 0. Is that an expected behavior?\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/992710480/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/992892703",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3013#issuecomment-992892703",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3013",
    "id": 992892703,
    "node_id": "IC_kwDOA9tCBs47Llcf",
    "user": {
      "login": "Amxx",
      "id": 2432299,
      "node_id": "MDQ6VXNlcjI0MzIyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Amxx",
      "html_url": "https://github.com/Amxx",
      "followers_url": "https://api.github.com/users/Amxx/followers",
      "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
      "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
      "organizations_url": "https://api.github.com/users/Amxx/orgs",
      "repos_url": "https://api.github.com/users/Amxx/repos",
      "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Amxx/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-13T20:48:10Z",
    "updated_at": "2021-12-13T20:48:26Z",
    "author_association": "COLLABORATOR",
    "body": "`ERC721URIStorage` is absolutely not related to all of this.\r\n\r\nIn version 3.x, `ERC721` included the full interface, including the enumerability part. In version 4.x, `ERC721` doesn't include enumerability by default, and the `totalSupply()` function is thus not present. In 4.x, if you want the supply tracked, you need to enable the `ERC721Enumerability` module in addition to any other module that you may have.\r\n\r\n[I strongly encourage you try out the wizard for that](https://wizard.openzeppelin.com/#erc721)",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/992892703/reactions",
      "total_count": 3,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 2,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/992932728",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3013#issuecomment-992932728",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3013",
    "id": 992932728,
    "node_id": "IC_kwDOA9tCBs47LvN4",
    "user": {
      "login": "takwaiw",
      "id": 7789092,
      "node_id": "MDQ6VXNlcjc3ODkwOTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7789092?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/takwaiw",
      "html_url": "https://github.com/takwaiw",
      "followers_url": "https://api.github.com/users/takwaiw/followers",
      "following_url": "https://api.github.com/users/takwaiw/following{/other_user}",
      "gists_url": "https://api.github.com/users/takwaiw/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/takwaiw/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/takwaiw/subscriptions",
      "organizations_url": "https://api.github.com/users/takwaiw/orgs",
      "repos_url": "https://api.github.com/users/takwaiw/repos",
      "events_url": "https://api.github.com/users/takwaiw/events{/privacy}",
      "received_events_url": "https://api.github.com/users/takwaiw/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-13T21:36:37Z",
    "updated_at": "2021-12-13T21:36:37Z",
    "author_association": "NONE",
    "body": "I see. Got it. I will check out the wizard. Thanks!",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/992932728/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1183646080",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3013#issuecomment-1183646080",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3013",
    "id": 1183646080,
    "node_id": "IC_kwDOA9tCBs5GjQGA",
    "user": {
      "login": "JeffyJeff1980",
      "id": 5229997,
      "node_id": "MDQ6VXNlcjUyMjk5OTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5229997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeffyJeff1980",
      "html_url": "https://github.com/JeffyJeff1980",
      "followers_url": "https://api.github.com/users/JeffyJeff1980/followers",
      "following_url": "https://api.github.com/users/JeffyJeff1980/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeffyJeff1980/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeffyJeff1980/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeffyJeff1980/subscriptions",
      "organizations_url": "https://api.github.com/users/JeffyJeff1980/orgs",
      "repos_url": "https://api.github.com/users/JeffyJeff1980/repos",
      "events_url": "https://api.github.com/users/JeffyJeff1980/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeffyJeff1980/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-13T20:28:26Z",
    "updated_at": "2022-07-13T20:28:26Z",
    "author_association": "NONE",
    "body": "@Amxx Wow! That wizard really does the job!!",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1183646080/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1190042840",
    "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3013#issuecomment-1190042840",
    "issue_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/3013",
    "id": 1190042840,
    "node_id": "IC_kwDOA9tCBs5G7pzY",
    "user": {
      "login": "alijafri001",
      "id": 99478102,
      "node_id": "U_kgDOBe3qVg",
      "avatar_url": "https://avatars.githubusercontent.com/u/99478102?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/alijafri001",
      "html_url": "https://github.com/alijafri001",
      "followers_url": "https://api.github.com/users/alijafri001/followers",
      "following_url": "https://api.github.com/users/alijafri001/following{/other_user}",
      "gists_url": "https://api.github.com/users/alijafri001/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/alijafri001/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/alijafri001/subscriptions",
      "organizations_url": "https://api.github.com/users/alijafri001/orgs",
      "repos_url": "https://api.github.com/users/alijafri001/repos",
      "events_url": "https://api.github.com/users/alijafri001/events{/privacy}",
      "received_events_url": "https://api.github.com/users/alijafri001/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2022-07-20T09:26:19Z",
    "updated_at": "2022-07-20T09:26:19Z",
    "author_association": "NONE",
    "body": "> `ERC721URIStorage` is absolutely not related to all of this.\r\n> \r\n> In version 3.x, `ERC721` included the full interface, including the enumerability part. In version 4.x, `ERC721` doesn't include enumerability by default, and the `totalSupply()` function is thus not present. In 4.x, if you want the supply tracked, you need to enable the `ERC721Enumerability` module in addition to any other module that you may have.\r\n> \r\n> [I strongly encourage you try out the wizard for that](https://wizard.openzeppelin.com/#erc721)\r\n\r\nOhh man, really does the job without manually checking what to override , thanks mate",
    "reactions": {
      "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/comments/1190042840/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }
]
