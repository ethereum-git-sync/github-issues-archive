{
  "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2564",
  "repository_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts",
  "labels_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2564/labels{/name}",
  "comments_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2564/comments",
  "events_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2564/events",
  "html_url": "https://github.com/OpenZeppelin/openzeppelin-contracts/issues/2564",
  "id": 823073339,
  "node_id": "MDU6SXNzdWU4MjMwNzMzMzk=",
  "number": 2564,
  "title": "Add an internal _useNonce(address) function in ERC20Permit",
  "user": {
    "login": "Amxx",
    "id": 2432299,
    "node_id": "MDQ6VXNlcjI0MzIyOTk=",
    "avatar_url": "https://avatars.githubusercontent.com/u/2432299?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/Amxx",
    "html_url": "https://github.com/Amxx",
    "followers_url": "https://api.github.com/users/Amxx/followers",
    "following_url": "https://api.github.com/users/Amxx/following{/other_user}",
    "gists_url": "https://api.github.com/users/Amxx/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/Amxx/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/Amxx/subscriptions",
    "organizations_url": "https://api.github.com/users/Amxx/orgs",
    "repos_url": "https://api.github.com/users/Amxx/repos",
    "events_url": "https://api.github.com/users/Amxx/events{/privacy}",
    "received_events_url": "https://api.github.com/users/Amxx/received_events",
    "type": "User",
    "site_admin": false
  },
  "labels": [

  ],
  "state": "closed",
  "locked": false,
  "assignee": null,
  "assignees": [

  ],
  "milestone": null,
  "comments": 0,
  "created_at": "2021-03-05T13:14:32Z",
  "updated_at": "2021-03-10T15:24:13Z",
  "closed_at": "2021-03-10T15:24:13Z",
  "author_association": "COLLABORATOR",
  "active_lock_reason": null,
  "body": "**üßê Motivation**\r\nThe ERC20Permit contract is great in that it provide a building block which is both ERC20 & ERC712 compliant. It also include some features, like nonce management, which are not by default in ERC712 but are required to do proper signature checking in the permit function.\r\n\r\nHowever, when wanting to expand the ERC712 compliant features beyound the simple `permit` function, it is not possible to increment the counter (private slot). This means that if I wanted to add a `transferFromBySig` or any other feature using ERC712, I would have to use an independent nonce. This is really not great.\r\n\r\n**üìù Details**\r\nA simple, yet effective, solution is to add an internal function that lets you \"consumed\" a nonce:\r\n\r\n```\r\nfunction _useNonce(address owner) internal  virtual returns (uint256 current) {\r\n    Counters.Counter storage nonce = _nonces[owner];\r\n    current = nonce.current();\r\n    nonce.increment();\r\n}\r\n```\r\n\r\nSince this function only increment, it doesn't create any security issue that would allow signed messages to be replayed.",
  "closed_by": {
    "login": "frangio",
    "id": 481465,
    "node_id": "MDQ6VXNlcjQ4MTQ2NQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/481465?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/frangio",
    "html_url": "https://github.com/frangio",
    "followers_url": "https://api.github.com/users/frangio/followers",
    "following_url": "https://api.github.com/users/frangio/following{/other_user}",
    "gists_url": "https://api.github.com/users/frangio/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/frangio/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/frangio/subscriptions",
    "organizations_url": "https://api.github.com/users/frangio/orgs",
    "repos_url": "https://api.github.com/users/frangio/repos",
    "events_url": "https://api.github.com/users/frangio/events{/privacy}",
    "received_events_url": "https://api.github.com/users/frangio/received_events",
    "type": "User",
    "site_admin": false
  },
  "reactions": {
    "url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2564/reactions",
    "total_count": 0,
    "+1": 0,
    "-1": 0,
    "laugh": 0,
    "hooray": 0,
    "confused": 0,
    "heart": 0,
    "rocket": 0,
    "eyes": 0
  },
  "timeline_url": "https://api.github.com/repos/OpenZeppelin/openzeppelin-contracts/issues/2564/timeline",
  "performed_via_github_app": null,
  "state_reason": "completed"
}
[

]
